identifying subpopulations within a study and inferring intercontinental ancestry of the samples are important steps in genome wide association studies.
two software packages are widely used in analysis of substructure: structure and eigenstrat.
the results from fastpop are highly consistent with those obtained by structure across the  <dig> samples we studied.
the correlations of the results between fastpop and structure are  <dig> ,  <dig>  and  <dig>  for european, african and asian ancestry scores, respectively.
we conducted an analysis of  <dig> hapmap samples with european, african or asian ancestry along with  <dig> additional samples of unknown ancestry.
it requires considerable computational time when dealing with thousands of samples and lacks the ability to create scores that could be used as covariates.
we developed fastpop, an efficient r package that fills the gap between structure and eigenstrat.
we also present application of the method for studying four continental populations .
additionally the pca derived scores can be applied to multiple data sets to ensure the same ancestry analysis is applied to all studies.
fastpop also provided scores based on snp weights so the scores of reference population can be applied to other studies provided the same set of markers are used.
compared with structure, fastpop is more efficient as it finished ancestry inference for  <dig> samples in 16 min compared with 21–24 h required by structure.
it can:  <dig>  generate pca scores that identify ancestral origins and can be used for multiple studies;  <dig>  infer ancestry information for data arising from two or more intercontinental origins.
we developed an algorithm that can infer ancestries on data involving two or more intercontinental origins.
structure assigns each individual to a population by using a bayesian method with multiple tuning parameters.
however, it does not readily provide information directly relevant to ancestral origin; the eigenvectors generated by eigenstrat are sample specific and thus cannot be generalized to other individuals.
