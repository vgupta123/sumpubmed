BACKGROUND
mass spectrometry has become the analytical method of choice in metabolomics research. the identification of unknown compounds is the main bottleneck. in addition to the precursor mass, tandem ms spectra carry informative fragment peaks, but the coverage of spectral libraries of measured reference compounds are far from covering the complete chemical space. compound libraries such as pubchem or kegg describe a larger number of compounds, which can be used to compare their in silico fragmentation with spectra of unknown metabolites.


RESULTS
we created the metfrag suite to obtain a candidate list from compound libraries based on the precursor mass, subsequently ranked by the agreement between measured and in silico fragments. in the evaluation metfrag was able to rank most of the correct compounds within the top  <dig> candidates returned by an exact mass query in kegg. compared to a previously published study, metfrag obtained better results than the commercial massfrontier software. especially for large compound libraries, the candidates with a good score show a high structural similarity or just different stereochemistry, a subsequent clustering based on chemical distances reduces this redundancy. the in silico fragmentation requires less than a second to process a molecule, and metfrag performs a search in kegg or pubchem on average within  <dig> to  <dig> seconds, respectively, on an average desktop pc.


CONCLUSIONS
we presented a method that is able to identify small molecules from tandem ms measurements, even without spectral reference data or a large set of fragmentation rules. with today's massive general purpose compound libraries we obtain dozens of very similar candidates, which still allows a confident estimate of the correct compound class. our tool metfrag improves the identification of unknown substances from tandem ms spectra and delivers better results than comparable commercial software. metfrag is available through a web application, web services and as java library. the web frontend allows the end-user to analyse single spectra and browse the results, whereas the web service and console application are aimed to perform batch searches and evaluation.

