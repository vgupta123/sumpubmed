BACKGROUND
it is difficult to accurately interpret chromosomal correspondences such as true orthology and paralogy due to significant divergence of genomes from a common ancestor. analyses are particularly problematic among lineages that have repeatedly experienced whole genome duplication  events. to compare multiple "subgenomes" derived from genome duplications, we need to relax the traditional requirements of "one-to-one" syntenic matchings of genomic regions in order to reflect "one-to-many" or more generally "many-to-many" matchings. however this relaxation may result in the identification of synteny blocks that are derived from ancient shared wgds that are not of interest. for many downstream analyses, we need to eliminate weak, low scoring alignments from pairwise genome comparisons. our goal is to objectively select subset of synteny blocks whose total scores are maximized while respecting the duplication history of the genomes in comparison. we call this "quota-based" screening of synteny blocks in order to appropriately fill a quota of syntenic relationships within one genome or between two genomes having wgd events.


RESULTS
we have formulated the synteny block screening as an optimization problem known as "binary integer programming" , which is solved using existing linear programming solvers. the computer program quota-align performs this task by creating a clear objective function that maximizes the compatible set of synteny blocks under given constraints on overlaps and depths . such a procedure is useful for any pairwise synteny alignments, but is most useful in lineages affected by multiple wgds, like plants or fish lineages. for example, there should be a 1: <dig> ploidy relationship between genome a and b if genome b had an independent wgd subsequent to the divergence of the two genomes. we show through simulations and real examples using plant genomes in the rosid superorder that the quota-based screening can eliminate ambiguous synteny blocks and focus on specific genomic evolutionary events, like the divergence of lineages  and the most recent wgd .


CONCLUSIONS
the quota-align algorithm screens a set of synteny blocks to retain only those compatible with a user specified ploidy relationship between two genomes. these blocks, in turn, may be used for additional downstream analyses such as identifying true orthologous regions in interspecific comparisons. there are two major contributions of quota-align: 1) reducing the block screening task to a bip problem, which is novel; 2) providing an efficient software pipeline starting from all-against-all blast to the screened synteny blocks with dot plot visualizations. python codes and full documentations are publicly available http://github.com/tanghaibao/quota-alignment. quota-align program is also integrated as a major component in synmap http://genomevolution.com/coge/synmap.pl, offering easier access to thousands of genomes for non-programmers.

