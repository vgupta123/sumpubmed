BACKGROUND
the outstanding features of human mitochondrial dna  – such as its high mutation rate, absence of recombination, stability and the large number of genome copies per cell – have led to its wide utilization in various disciplines, including population, medical and forensic genetics. for the past few years, scientific controversy has surrounded the large numbers of errors detected in much of the previously published mtdna data  <cit> . in extreme cases erroneous data can alter the main conclusion of a study  <cit> , requiring confirmation of the absence of errors before proceeding to further analysis or drawing meaningful conclusions. since phylogenetic investigations and database screening could have detected prevalent errors in published data sets, methodologies based on mtdna haplogroup determination and comparisons with existing mtdna haplotypes were proposed for preventing mtdna errors  <cit> . in particular, the phylogenetic approach – which is the key tool used to understand the structure of the mtdna data under study – was shown to be very useful for systematic reanalysis of an mtdna data set. according to data and part of the phylogeny, it was reported to detect approximately 50% of all sequence errors  <cit>  and hence has formed a starting point to localizing a sequence to a part of the phylogeny, at least to the level of the haplogroup for systematic error detection. refinement of mtdna phylogeny with more diagnostic mutations would facilitate the detection of more errors in mtdna sequence data since it is based on mutation motifs, and if haplogroup determination fails, a neighbourhood search for sequences in the available database could identify a subset of potentially closely related sequences, thereby allowing researchers to pinpoint errors in the sequence by comparing the sequence in question with a limited subset of the total database  <cit> . however, manual haplogroup estimation requires a thorough understanding of the worldwide mtdna phylogeny, and database screening for systematic error detection requires high-quality databases that are publicly available.

the human mitochondrial database  has been designed and implemented using automatically running bioinformatics tools to facilitate mtdna haplogroup determination  <cit> . the hmtdb is a database of  <dig> human mitochondrial genomes annotated with population and variability data that allows researchers to analyse their own mtdna sequences and to automatically predict their haplogroups, yielding a list of haplogroups that match. however, haplogroup determination is carried out by comparing the complete mitochondrial genome sequences with the updated mtdna haplogroup classification based on information of the coding-region single nucleotide polymorphisms  for about  <dig> mtdna haplogroups and subhaplogroups. accordingly, haplogroup estimation using the hmtdb would be useful for researchers dealing with complete mitochondrial genome sequences, but would not be applicable to the detection of possible errors when researchers have only mtdna control-region sequences.

as for the database, the ednap  mtdna population database  is notable because it was established through a collaborative project in order to provide reliable frequency estimates for routine forensic casework  <cit> . the empop was designed to be a high-quality, web-based mtdna database where primary sequence-lane data are permanently linked to compiled sequences, and phylogenetic quality control analyses are applied to data to check for errors  <cit> . currently, the empop contains  <dig> high-quality mtdna haplotypes that are classified into sub-saharan african, west eurasian, east asian and southeast asian metapopulations, and thus enables users to assess the rarity of a forensic mtdna haplotype in various populations. however, due to somewhat narrow query options and inconvenient method used to display the results, its query tool appears to be optimized for calculating frequency estimates for random matches rather than for database screening to detect possible mtdna errors. also, the empop does not allow batch analyses. in addition to the accessibility of high-quality databases to generate reliable frequency estimates, the addition of batch analysis of mtdna sequence data and the construction of a user's database would be greatly beneficial to forensic staff.

here we present a web-based bioinformatics resource called mtdnamanager that provides a convenient interface supporting the management and quality analysis of mtdna sequence data. the mtdnamanager performs computations on mtdna control-region sequences for estimating the most-probable mtdna haplogroups, and retrieves similar sequences from a selected database. the aims of mtdnamanager are  to allow researchers to automatically estimate the most-probable mtdna haplogroups of their mtdna control-region sequences,  to facilitate database screening with improved query tools and  to provide researchers with a convenient interface for managing and analysing their own data in batch mode. a query system in mtdnamanager allows researchers to find sequences in the database that include queried nucleotide polymorphisms or to exhibit matches from either a selected population or the entire population. inputted mtdna sequences, which are either partial or whole mtdna control-region sequences, are entered as differences relative to the revised cambridge reference sequence   <cit> . during sequence searches, mtdnamanager automatically estimates corresponding haplogroups for submitted data and calculates frequency estimates for random matches. retrieved sequences are also annotated with the estimated haplogroup affiliation to highlight nucleotide polymorphisms that are specific to a certain group of mtdna haplotypes. this application provides the first publicly available interface to automatically estimate the most-probable mtdna haplogroups according to control-region mutation motifs, thereby facilitating data comparisons from a phylogenetic perspective.

implementation
the mtdnamanager interface was designed to allow researchers to easily query the database and immediately view results on a single page. the mtdnamanager web interfaces were implemented using php and asynchronous javascript and xml . ajax makes web pages more responsive by exchanging small amounts of data with a server in the background, and thus mtdnamanager web pages do not have to be reloaded after each user request. this design aimed at increasing the interactivity, speed, functionality and usability of mtdnamanager. the mtdnamanager system is optimized for internet explorer version  <dig>  or later.

mtdnamanager has a multithreaded and multiuser sql database management system designed and implemented using mysql. the mtdnamanager database currently comprises seven tables containing human mtdna control-region sequences, data related to the samples and results of haplogroup estimation obtained by the mtdna haplogroup-estimating resource that runs automatically .

the most-probable haplogroup of a given mtdna sequence is estimated using a mathematical algorithm based on propositional logic via hierarchical verification of the presence or absence of haplogroup-specific diagnostic mutations. for that purpose, reliable control-region mutation motifs  for the assignment of more than  <dig> mtdna haplogroups and subhaplogroups were first identified based on well-characterized mtdna phylogenies   <cit> . mutation motifs of most of the haplogroups could immediately be read from the mtdna tree. however, since each position of the mutation motif displays different mutation rates and homoplasy mutations are also observed in multiple motifs, individual diagnostic positions were weighted in each haplogroup background. to this end, polymorphisms of representative haplotypes allocated to the corresponding haplogroup or subhaplogroup were screened against other closely related mtdna haplotypes. according to the mutation stability and specificity in each haplogroup background, individual diagnostic sites were classified into clearer diagnostic mutations and their accompanying mutations. to obtain mutation frequencies, published high-quality data were mostly used, but the data found on internet resources were also used. the clear key diagnostic mutations of a certain haplogroup could be a single mutation or a combination of multiple mutations. they were selected from the polymorphic sites observed in every haplotype of the corresponding haplogroup  and mostly were not shared with any other haplogroups. on the other hand, accompanying mutations are also observed in almost every haplotype of the corresponding haplogroup , but could include polymorphic sites observed in another haplogroups. based on these haplogroup-specific mutation motifs, the bioinformatics tools of mtdnamanager designates the "expected haplogroup" when a queried data sequence possesses clear diagnostic mutations, and designates the "estimated haplogroup" when the data indicate the presence of accompanying mutations additional to the clear diagnostic mutations.

this haplogroup-estimation workflow gives priority to certain haplogroups according to their degree of specificity to corresponding population groups. therefore, the bioinformatics tools of mtdnamanager have a hierarchy consisting of several levels of mutation motifs. since all of the key diagnostic mutations equally have very high specificity for their corresponding haplogroups or subhaplogroups, the levels of mutation motifs in haplogroup designation were determined by the mutation stability of each mutation motif. therefore, within a certain haplogroup branch, subhaplogroups have a higher priority than their root haplogroups, and among haplogroups of different branches, haplogroups associated with key diagnostic sites that have a lower mutation frequency in a certain population group have a higher priority. however, since mutation frequencies and specificities differ among population groups, the order of haplogroup designations in a hierarchical analysis of diagnostic mutations varied with the population group represented in the queried sequence. in addition, for two different haplogroups with identical key diagnostic mutations, the haplogroup with the highest prevalence in a certain population group has designation priority.

the data set used to test the bioinformatics tools of mtdnamanager contained more than  <dig> mtdna control-region sequences whose haplogroup affiliations were available from previous publications or on the internet. actually, the bioinformatics tools of mtdnamanager allowed more than 98% of mtdna to be allocated to an appropriate mtdna haplogroup or subhaplogroup. for data sets with haplogroup information confirmed by coding-region snps, relatively good concordance was also observed between the expected and reference haplogroups   <cit> .

RESULTS
content and design of the open database
the current open database of mtdnamanager contains  <dig> mtdna control-region sequences grouped in the following five subsets: african , west eurasian , east asian , oceanian and admixed   <cit> . all of the mtdna control-region sequences were annotated with estimated haplogroup affiliations using the mtdnamanager bioinformatics tools. in cases where a data sequence had been assigned to a certain haplogroup in a previous study, relevant haplogroup information is provided in the output results.

the query system of mtdnamanager retrieves sequences that include queried nucleotide polymorphisms from a selected population or the entire population group of its open database by default . since any combination of nucleotide polymorphisms or any partial control-region sequences can be analysed using the include setting, mtdnamanager is very useful for analysing partial sequences or comparing similar sequences that share the same nucleotide polymorphisms . with the alternative setting of match, mtdnamanager also searches sequences that match the queried sequence data from the database. mtdnamanager provides match options to select specific regions to be analysed , ignore heteroplasmic insertions in poly c-stretches and permit mismatches in order to overcome differences in data reporting between laboratories due to variability in the analysis region, ambiguities with respect to mtdna nomenclature and different treatment of length variants .

the frequency of a queried nucleotide polymorphism or sequence is estimated from the number of times  that it appears in a database of size n  while taking into account uncertainty due to sampling errors. this frequency is therefore estimated as /  <cit> , and is represented as the "match probability".

design of user database
upon registration, mtdnamanager provides web interfaces through which users can submit and store their data in batch mode and search for sequences that show a match or include queried nucleotide polymorphisms from their databases as well as mtdnamanager's open database. the sample system allows users to submit their own data in batch mode and store data in groups while simultaneously characterizing them by the automatically running haplogroup-estimating workflow . the match system permits cross-matches of all sequence data between two selected groups as well as the retrieval of matched sequences for a sample of the user's database from their own database or mtdnamanager's open database, which will facilitate casework in disasters involving many individuals . in addition, the query system enables users to search sequences that show a match or include the queried nucleotide polymorphisms from their own databases or mtdnamanager's open database, thus assisting the analysis of the increasing amount of mtdna data available worldwide.

input
input queries are entered as differences relative to the rcrs according to isfg  guidelines  <cit> . when a difference between sequence data and the rcrs is observed, only the site  and nucleotide differing from the reference standard are recorded . insertions are recorded by first noting the site immediately 5' to the insertion followed by a decimal point and a "1" , a "2"  and so on, and then the nucleotide that is inserted is recorded . deletions are recorded by listing the missing site followed by a "d" . for convenience, transition mutations can be recorded by listing the site and omitting the indication of the nucleotide difference. however, transversion mutations are recorded in every case  in which the nucleotide differs from the reference standard. polymorphic sites can be separated using a space, return or comma character. sequence searches are allowed to show matches even when no data  have been submitted, since some europeans possess mtdna control-region sequences identical to the rcrs. the frequencies of nucleotide polymorphisms that are identical to the rcrs can also be obtained by entering the site and nucleotide polymorphisms of the rcrs or by entering the site with "="  using the include setting.

• input sequence example 1: 16304c 73g 249d 263g  <dig> c

• input sequence example 2:  <dig>  <dig> 249d  <dig>  <dig> c

to import data through the sample system in batch mode, the sample group should first be generated by the user. user-defined sample groups are added to the group list by clicking the "add" button and entering their names and properties. then, batch input files are prepared in a text file to be imported into a specific, user-defined group. input files are initially prepared as excel files that contain both the mtdna sequence data and descriptions of the properties of the data . the mtdna sequence data are entered using the same method as input queries. the excel file is then saved as a text file  that is imported to a specific user-defined group of the sample system. input sequences can also be uploaded one by one using the "add" button on the sample list.

output
results from mtdnamanager are displayed on the same page on which the query was submitted . while showing retrieved sequences, mtdnamanager shows frequency estimates for random matches from a selected group and the automatically estimated haplogroup affiliations for submitted data. queried nucleotide polymorphisms that are either identical to the rcrs or entered as iupac  codes for point heteroplasmy are indicated as such under "comments". frequency estimates for all of the population groups in the database can be obtained by clicking the "worldwide frequency" button, and the cross-match result can be obtained by clicking the "match all" button. the retrieved sequences are displayed with estimated haplogroup affiliations , nucleotide polymorphisms and, if available, the haplogroup affiliations obtained from previous reports. therefore, mtdnamanager should facilitate the comparison of sequences that share the same nucleotide polymorphisms from a phylogenetic perspective. in addition to the web-page presentation tools, retrieved sequences can be exported as an excel file for user convenience.

discussion
the mtdnamanager can be used to manage large amounts of mtdna data as well as to estimate the quality of mtdna data and compare such data with similar sequences from a phylogenetic perspective. the application provides systematic routines for error detection and strategies for screening mtdna databases by enabling researchers to automatically estimate the most-probable mtdna haplogroups and search the database with two alternative settings .

in particular, the phased designation of haplogroups  facilitates systematic error detection by allowing the respective confirmation of the presence of clearer key diagnostic mutations and accompanying mutations. specifically, if a certain mtdna sequence was annotated with the same expected and estimated haplogroups, this means that the sequence possessed the complete mutation motif for the corresponding haplogroup. likewise, if a sequence was annotated with only the expected haplogroup, this suggests a lack of accompanying mutations for the expected haplogroup, which was determined by the presence of key diagnostic mutations . from an mtdna phylogenetic perspective, this would mean that a given mtdna haplotype is located at a previously unsampled interior node of the tree such as a back mutation  <cit> . accordingly, in this case, it would be necessary to recheck the entire set of haplogroup-specific mutation sites in a given sequence data. more importantly, data without both of the haplogroup affiliations or that showed discordance between expected and estimated haplogroups would also imply a need to recheck the sequence for possible errors due to contamination or a sample mix-up during the sequencing and documentation process . since mtdna haplotypes that could only be obtained from separate amplifications of several smaller fragments – such as those found in highly degraded samples – are prone to these errors, using mtdnamanager to confirm the absence of these errors after data generation will help to authenticate the sequence data in highly degraded samples. for user convenience, currently identified haplogroup-specific control-region mutation motifs for more than  <dig> haplogroups are available on the mtdnamanager home page. from a phylogenetic perspective, mtdna control-region sequence information might not be sufficient for assigning certain mtdnas into respective haplogroups as reliably as the coding-region information, but the control-region mutation motifs of mtdnamanager will at least suggest candidate sites or regions that need reinvestigation.

frequency estimates and sequences retrieved using the include setting indicate the rarity of a nucleotide polymorphism in databases and show similar sequences that share queried nucleotide polymorphisms. accordingly, mtdnamanager can reveal unusual, private mutations  and suggest a subset of potentially close relatives annotated with estimated haplogroup affiliations even when the haplogroup estimation of a queried sequence data fails . this will highlight nucleotide polymorphisms that are specific to the retrieved group of mtdna haplotypes and help to distinguish sites that should be analysed further. in other cases, retrieved sequences with estimated haplogroup affiliations will contribute to completing and refining haplogroup classification by revealing mutation sites that are specific to a new branch of phylogeny. therefore, to improve mtdna database screening, we will continue to collect and integrate high-quality mtdna control-region sequence data that are publicly available.

in addition, mtdnamanager provides a convenient interface that allows users to construct and analyse their own databases. therefore, users can collect high-quality data from public databases  or direct sequencing results to construct their own databases. mtdnamanager will suggest the most-probable mtdna haplogroups for all of the sequences in the database, allowing users to also easily estimate the quality of the database. researchers will therefore be able to select and use the most appropriate database for error detection based on their own evaluation of the quality of the available databases.

CONCLUSIONS
the mtdnamanager supports the management and quality analysis of mtdna sequence data using software that performs computations on mtdna control-region sequences for estimating the most-probable mtdna haplogroups. mtdnamanager will help in checking the quality of data and facilitate data comparisons from a phylogenetic perspective by displaying information – estimated haplogroup affiliations and nucleotide polymorphisms – of all sequences on a single page. in addition, mtdnamanager provides researchers with a convenient interface for managing and analysing their own data in batch mode. therefore, this tool could be very useful for population, medical and forensic studies that involve mtdna analysis.

availability and requirements
project name: a web-based tool for the management and quality analysis of mitochondrial dna control-region sequences

project home page: 

operating system: microsoft windows

programming language: php, asynchronous javascript and xml

other requirements: optimized for internet explorer version  <dig>  or later

any restrictions to use by non-academics: none

authors' contributions
kjs initiated the concept of mtdnamanager. is and kjs developed the major modules of mtdnamanager, and is, hyl and kjs designed the graphical user interface. kjs reviewed and tested the software. hyl wrote this manuscript, and eh, sbc and wiy helped to draft it.

