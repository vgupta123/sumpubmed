BACKGROUND
the completion of genome sequencing projects has led to the identification of novel proteins at an unprecedented rate  <cit> . in many cases, sequence similarities with previously characterized proteins yield obvious insights into function. by comparison, many novel proteins fail to exhibit significant similarity to other proteins or exhibit similarity only to proteins of unknown activity. even in cases where proteins exhibit extensive conservation with homologues of known biological function, their actions may remain poorly defined because the specific domains required for function are unclear.

one innovative experimental approach with the capacity to identify domains and possibly even specific amino acid residues that are required for function is a genetic strategy known as unigenic evolution, developed by deminoff et al  <cit> . unigenic evolution involves random mutagenesis of a gene whose loss gives rise to a selectable phenotype  <cit> . randomly mutagenized variants of the gene that retain function are subsequently isolated and characterized by dna sequencing. an underlying assumption for the unigenic evolution strategy is that regions of the protein that are required for function will be conserved whereas regions that are dispensable for function will be extensively mutated in variants that retain function. however, by itself, this selection does not exclude the possibility that missense mutations within specific domains or residues are infrequently observed simply because of differences in transition and transversion rates, or due to the degeneracy of the genetic code. to address this issue, deminoff et al. <cit> , developed a statistical analysis that involves comparison of the expected frequency of mutation to the observed frequency of mutation for each residue. to increase statistical power, the calculated mutability indices for individual residues are averaged using a sliding window of a pre-defined length. this procedure allows putative hypomutable regions within the protein to be identified by visual inspection. the statistical significance of each putative region is then determined by computing χ <dig> .

the results of the statistical analysis described by deminoff et al. <cit>  depend on the number of residues that are averaged in calculating mutability, that is, on the length of the sliding window, which is chosen arbitrarily. we have therefore developed a region-independent chi-square analysis to improve the identification of hypomutable regions. since not all transitions and transversions were equally likely in our laboratory, we also refined the calculation of the expected frequency of mutation to include each base-to-base mutation rate. finally, we extended the analysis of deminoff et al. <cit>  to address an experimentally critical question of whether an individual residue has not been mutated simply because an insufficient population of mutated variants has been analyzed. collectively, these advances provide for the unbiased identification of hypomutable regions and for assessing the confidence levels for individual hypomutable regions or conserved residues, based on the number of functional variants that have been analysed. we illustrate our technique using data generated by the unigenic evolution of the human peptidyl-prolyl isomerase pin <dig>  <cit> .

RESULTS
since the goal of unigenic evolution is to identify residues that are critical to protein function  <cit> , we focus our attention on residues for which no missense amino acid substitutions are observed in any of the sequenced functional molecules. rather than conveying functional importance, some of these non-mutated residues may represent codons for which missense mutations are intrinsically less likely, due to the degeneracy of the genetic code. to distinguish between these possibilities, we must assess the inherent mutability of each residue within the protein. in a later section, we will consider another important possibility: that some residues have remained non-mutated in all the functional sequences simply by chance.

since the mutational data generated by unigenic evolution contains both missense and silent nucleotide substitutions, an observed frequency of missense mutations  for each codon in the protein can be calculated. following deminoff et al.  <cit>  this frequency is defined as the number of missense mutations divided by the total number of mutations :

fobs. missense = # missense mutations# missense mutations + # silent mutations     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdawgaawcbagaee4ba8maeeoyaimaee4camnaeeola4iaeeiiaaiaeeyba0maeeyaakmaee4camnaee4camnaeeyzaumaeeoba4maee4camnaeeyzaugabeaakiabbccagiabb2da9iabbccagmaalaaabagaee4iamiaeeiiaaiaeeyba0maeeyaakmaee4camnaee4camnaeeyzaumaeeoba4maee4camnaeeyzaumaeeiiaaiaeeyba0maeeydaunaeeidaqnaeeyyaemaeeidaqnaeeyaakmaee4ba8maeeoba4maee4camhabagaee4iamiaeeiiaaiaeeyba0maeeyaakmaee4camnaee4camnaeeyzaumaeeoba4maee4camnaeeyzaumaeeiiaaiaeeyba0maeeydaunaeeidaqnaeeyyaemaeeidaqnaeeyaakmaee4ba8maeeoba4maee4camnaeeiiaaiaee4kasiaeeiiaaiaee4iamiaeeiiaaiaee4camnaeeyaakmaeeibawmaeeyzaumaeeoba4maeeidaqnaeeiiaaiaeeyba0maeeydaunaeeidaqnaeeyyaemaeeidaqnaeeyaakmaee4ba8maeeoba4maee4camhaaiaaxmaacawljawaaewaaeaacqaixaqmaiaawicacaglpaaaaaa@92c5@

this observed frequency of missense mutations can then be compared to the expected frequency of missense mutations for each corresponding codon. the expected frequency of missense mutation is calculated by observing that each codon has a characteristic potential for producing a silent or missense mutation given one nucleotide change. looking at all possible single base changes, the expected frequency of missense mutations can be easily calculated. this "first pass" technique assumes that all single nucleotide substitutions are equally likely.

deminoff et al. <cit>  improved this technique by correcting for a significant bias in the mutation frequencies in unigenic evolution data; in particular, in their study they noted that 80% of observed base changes were transitions and 20% transversions. this is largely a consequence of the fact that errors made by the mutagenic agent, taq dna polymerase, are heavily biased toward purine to purine and pyrimidine to pyrimidine base changes. we have observed a very similar ratio  in the functional variants characterized in our experimental work  <cit> . a more accurate value of fexp. missense for each codon can therefore be calculated by determining the frequencies of missense substitutions created by either transitions or transversions, and weighting these expectations by the observed frequency of transitions and transversions in the database  <cit> .

normalizing the frequency of expected missense mutations  to the transition/transversion ratios observed in functional clones greatly improves the accuracy of the expected value. however, this technique assumes i) that all transitions  are equally likely and ii) that substitutions observed in functional clones are representative of all substitutions that occur in unigenic evolution. since selection for viable mutants results in a bias toward mutations that are tolerated by functional molecules, we expect that each of these assumptions may result in some substitution frequencies that are over- or under-represented. we therefore extended the analysis presented in deminoff et al.  <cit>  to take into account the individual substitution frequencies incurred during unigenic evolution in our hands, and evaluated the extent to which these two assumptions hold.

mutation frequencies from a random pool
to remove any possible bias caused by considering only the mutations in functional clones, we analyzed a stratified random sample of protein clones , where the libraries contained all functional and non-functional clones. we then determined the frequency of each substitution for each nucleotide in this random pool. the distribution of observed nucleotide substitutions in the random pool is given in table  <dig>  note that the transition/transversion ratio observed in this dataset was 74: <dig>  in contrast to the 79: <dig> ratio observed in functional clones  <cit> . furthermore, the transition/transversion ratio for adenine was  <dig> : <dig>  providing evidence that all possible transitions and all transversions are not equally likely.

using the nucleotide substitution data that was observed within this random sample of clones, equations were formulated to calculate the expected frequency of missense mutations  for each codon. the first step in this analysis is to estimate the underlying mutation rates for each base. the probability that a base, b, is replaced by substitution in one run through pcr is defined as mb. since the substitution may actually have occured on the complementary strand, we treat a mutation from a to g, for example, as equivalent to a substitution from t to c. thus the probability of mutating an adenine to any other nucleotide is given by:

ma= +  +  +  +  + 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgtbqbdawgaawcbagaeeyqaeeabeaakiabg2da9maalaaabagaeiikagiaee4iamiaeeyqaekaeeyla0iaee4rackaeeykakiaeeiiaaiaee4kasiaeeiiaaiaeeikagiaee4iamiaeeivaqlaeeyla0iaee4qamkaeeykakiaeeiiaaiaee4kasiaeeiiaaiaeeikagiaee4iamiaeeyqaekaeeyla0iaee4qamkaeeykakiaeeiiaaiaee4kasiaeeiiaaiaeeikagiaee4iamiaeeivaqlaeeyla0iaee4rackaeeykakiaeeiiaaiaee4kasiaeeiiaaiaeeikagiaee4iamiaeeyqaekaeeyla0iaeeivaqlaeeykakiaeeiiaaiaee4kasiaeeiiaaiaeeikagiaee4iamiaeeivaqlaeeyla0iaeeyqaekaeeykakcabagaeeikagiaeeivaqlaee4ba8maeeidaqnaeeyyaemaeeibawmaeeiiaaiaee4iamiaeeiiaaiaee4ba8maeeozaymaeeiiaaiaeeyqaekaee4jaciaee4camnaeeiiaaiaee4kasiaeeiiaaiaeeidaqnaee4ba8maeeidaqnaeeyyaemaeeibawmaeeiiaaiaee4iamiaeeiiaaiaee4ba8maeeozaymaeeiiaaiaeeivaqlaee4jaciaee4camnaeeiiaaiaeeyaakmaeeoba4maeeiiaaiaee4camnaeeyzaumaeeycaenaeeydaunaeeyzaumaeeoba4maee4yammaeeyzaumaeeykakiaeeikagiaee4iamiaeeiiaaiaee4ba8maeeozaymaeeiiaaiaeeouailaeeyyaemaeeoba4maeeizaqmaee4ba8maeeyba0maeeiiaaiaee4qamkaeeibawmaee4ba8maeeoba4maeeyzaumaee4camnaeeiiaaiaee4uamlaeeyzaumaeeycaenaeeydaunaeeyzaumaeeoba4maee4yammaeeyzaumaeeizaqmaeeykakcaaaaa@b54f@

where  represents the number of a to g substitutions observed in the random pool of functional and non-functional clones .

similarly, probabilities for individual nucleotide substitutions  can by calculated using the same mutational data from the random pool. as a sample dataset, a summary of the nucleotide substitution rates observed in the random pool of clones is given in table  <dig> 

based on these mutation probabilities, the frequency of expected missense substitutions for each codon can be calculated. an amino acid with more than one codon such as cys  will exhibit distinct fexp. missense values for each codon. for example, the frequency of expected missense substitutions for cys  was calculated using the following equation:

fexp. missense cys  = 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdawgaawcbagaeeyzaumaeeieagnaeeicaanaeeola4iaeeiiaaiaeeyba0maeeyaakmaee4camnaee4camnaeeyzaumaeeoba4maee4camnaeeyzaugabeaakiabbccagiabboeadjabbmha5jabbohazjabbccagiabbicaoiabbsfaujabbeeahjabboeadjabbmcapiabbccagiabb2da9iabbccagmaalaaabagaeeikagiaeeyba02aasbaasqaaiabbsfaubqabagccqghrawkcqqgtbqbdawgaawcbagaee4raceabeaakiabgucariabcufabjabb2gatnaabaaaleaacqqgdbwqcqqgtaqlcqqghbwraeqaaogaey4kasiaeeyba02aasbaasqaaiabboeadjabb2catiabbgeabbqabagccqggdbqxcqggpaqkaeaacqggoaakcqqgtbqbdawgaawcbagaeeivaqfabeaakiabgucariabb2gatnaabaaaleaacqqghbwraeqaaogaey4kasiaeeyba02aasbaasqaaiabboeadbqabagccqggpaqkaaaaaa@6d34@

note that it is possible that some missense mutations may actually be nonsense . to avoid a priori assumptions about whether nonsense mutations would be deleterious, we did not exclude these from the frequency of expected missense mutations calculated above.

again, as a sample dataset, calculated values of fexp. missense for each codon in pin <dig> are given in table 3; corresponding values of the transition/transversion normalized mutation rates from the functional pool of molecules as determined by deminoff et al. <cit>  are shown for comparison. although values for some codons are similar, in most cases results obtained by the two methods differ by 5% or more. this issue will be taken up again in the conclusions.

identifying hypomutable regions
the observed frequency of missense mutations for each codon in the protein calculated from equation  can be compared to the expected frequency  to determine the mutability of each residue. when the observed missense frequency is less than our expected value, we use the standard measure:

h=fexp. missense
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgibascqgh9aqpdawcaaqaaiabcicaoiabdagamnaabaaaleaacqqgvbwbcqqgibgycqqgzbwccqqguaglcqqggaaicqqgtbqbcqqgpbqacqqgzbwccqqgzbwccqqglbqzcqqgubgbcqqgzbwccqqglbqzaeqaaogaeyoei0iaemozay2aasbaasqaaiabbwgaljabbiha4jabbchawjabb6cauiabbccagiabb2gatjabbmgapjabbohazjabbohazjabbwgaljabb6gaujabbohazjabbwgalbqabagccqggpaqkaeaacqwgmbgzdawgaawcbagaeeyzaumaeeieagnaeeicaanaeeola4iaeeiiaaiaeeyba0maeeyaakmaee4camnaee4camnaeeyzaumaeeoba4maee4camnaeeyzaugabeaaaaaaaa@689a@

to determine the hypomutability of the residue. the value of h will range between  <dig> and - <dig>  where - <dig> reflects maximal hypomutability and occurs when we observe zero missense mutations; zero occurs when the observed frequency equals the expected frequency.

when the observed missense frequency is greater than the expected value, however, h ranges between zero and m = /fexp. missense. since m is a  number that varies from one codon to the next, we normalize hypermutability in this case by dividing h by the theoretical maximum, m, for that residue. this normalized hypermutability has a minimum of zero and a maximum value of + <dig>  which only occurs if all mutations observed are missense mutations. to plot these results, the mutability of individual residues is averaged over a window of a specified number of codons. the average hypo- or hypermutability is then plotted in the center of the specified window, and the window is shifted downstream one codon at a time. note that this normalization and plotting technique, although described in different terms, is equivalent to the method previously described by deminoff et al. <cit> .

since no objective means for choosing the length of the averaging window have been established, we investigated the dependence of our results on this length. accordingly, we applied the procedure described above with window lengths ranging from 1– <dig> codons to the sample dataset . at one extreme, the window length of one produces a plot of hypo-and hypermutable residues, as opposed to regions. however, as discussed in a later section, the reliability of this latter plot is questionable since our data set does not contain sufficient information to generate statistically significant mutation frequencies for each residue. increasing the window size between  <dig> and  <dig> codons decreases the number of hypomutable regions; using a 5-codon window at least  <dig> discrete hypomutable regions are apparent, while a 25-codon window reveals only  <dig> discrete hypomutable regions. since delineation of the boundaries of each hypomutable region using the strategy of deminoff et al. <cit>  depends on the initial identification of hypomutable regions by visual inspection, it is clear from this example that window length can have a dramatic influence on the analysis.

determining region boundaries and significance
in addition to the influence of the window size on the number of hypomutable regions, it is important to recognize that the boundaries of each hypomutable region are not always clearly defined. to determine the significance of putative hypomutable regions and to define their boundaries statistically, a chi-square  analysis of each region is performed. for a series of residues corresponding to each apparently hypomutable region, χ <dig> can be determined using the expression:

χ2=2total # expected missense+2total # expected silent
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqaaceqaaiabee8ajnaacaaaleqabagaegomaidaaogaeyypa0zaasaaaeaacqggoaakcqqghbqycqqgibgycqqgzbwccqqggaaicqqgbbwwcqqg0badcqqgvbwbcqqg0badcqqghbqycqqgsbabcqqggaaicqqgjawicqqggaaicqqgvbwbcqqgibgycqqgzbwccqqglbqzcqqgybgccqqg2bgdcqqglbqzcqqgkbazcqqggaaicqqgtbqbcqqgpbqacqqgzbwccqqgzbwccqqglbqzcqqgubgbcqqgzbwccqqglbqzcqqggaaicqqgtaqlcqqggaaicqqg0badcqqgvbwbcqqg0badcqqghbqycqqgsbabcqqggaaicqqgjawicqqggaaicqqglbqzcqqg4baecqqgwbaccqqglbqzcqqgjbwycqqg0badcqqglbqzcqqgkbazcqqggaaicqqgtbqbcqqgpbqacqqgzbwccqqgzbwccqqglbqzcqqgubgbcqqgzbwccqqglbqzcqqggaaicqqgdbqxcqqggaaicqqgtaqlcqqggaaicqqgwaamcqqguaglcqqg1aqncqqgpaqkdaahaawcbeqaaiabbkdayaaaaoqaaiabbsha0jabb+gavjabbsha0jabbggahjabbygasjabbccagiabbocajiabbccagiabbwgaljabbiha4jabbchawjabbwgaljabbogajjabbsha0jabbwgaljabbsgakjabbccagiabb2gatjabbmgapjabbohazjabbohazjabbwgaljabb6gaujabbohazjabbwgalbaaaeaacqghrawkdawcaaqaaiabcicaoiabbggahjabbkgaijabbohazjabbccagiabbufabjabbsha0jabb+gavjabbsha0jabbggahjabbygasjabbccagiabbocajiabbccagiabb+gavjabbkgaijabbohazjabbwgaljabbkhayjabbaha2jabbwgaljabbsgakjabbccagiabbohazjabbmgapjabbygasjabbwgaljabb6gaujabbsha0jabbccagiabb2catiabbccagiabbsha0jabb+gavjabbsha0jabbggahjabbygasjabbccagiabbocajiabbccagiabbwgaljabbiha4jabbchawjabbwgaljabbogajjabbsha0jabbwgaljabbsgakjabbccagiabbohazjabbmgapjabbygasjabbwgaljabb6gaujabbsha0jabb2fadjabbccagiabb2catiabbccagiabbcdawiabb6cauiabbwda1iabbmcapmaacaaaleqabagaeeomaidaaagcbagaeeidaqnaee4ba8maeeidaqnaeeyyaemaeeibawmaeeiiaaiaee4iamiaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeyzaumaee4yammaeeidaqnaeeyzaumaeeizaqmaeeiiaaiaee4camnaeeyaakmaeeibawmaeeyzaumaeeoba4maeeidaqhaaaaaaa@0d47@

in this equation, the total number of expected missense mutations for each hypomutable region is calculated by multiplying the total number of mutations  observed in a hypomutable region by the average value of fexp. missense for all codons within the region; the expected number of silent mutations in the region is calculated similarly. the yates correction has been used  <cit>  since the outcomes fall into only two classes: silent or missense mutations. the p value for each hypomutable region can then be evaluated for one degree of freedom.

deminoff et al.  <cit>  suggest considering a subset of residues in the center of each putative hypomutable region and gradually expanding the boundaries, calculating a new χ <dig> value for each series of residues until p falls below significance. using this technique, and identifying putative regions based on the graph obtained with an 11-codon window for the pin <dig> data, we identified four significantly hypomutable regions with the following levels of significance: region a, p < <dig> ; region b, p <  <dig> ; region c, p <  <dig> ; region d, p <  <dig> .

using this technique, however, we found that delineation of the boundaries of each region was somewhat arbitrary. for example, a region of  <dig> residues might be significant. if the 9th residue is added to the region, significance is lost. however if both the 9th and 10th residues are added, significance is regained. similarly, we found that region boundaries were sensitive to the initial choice of "central" residues, and to the direction in which the region was first expanded.

we therefore developed a region-independent method for identifying significant hypomutable regions. in this method, we consider region lengths up to  <dig> residues long. for each region length, we calculate χ <dig> for every possible region of that length in our sequence. this corresponds once again to sliding a window of the appropriate length along the sequence, however in this case we are not averaging across the window, but computing the significance of the region within the window as a whole. thus, for example, computing the χ <dig> value for an 11-codon region is not equivalent to computing the average hypomutability in a window of the same length.

with these values in hand, we produce a 3-dimensional plot of the χ <dig> value for each region of every length ; the region length and the residues which constitute the region give the two independent axes. we plot the entire region for all regions whose χ <dig> value exceeded the α =  <dig>  significance level. this unusually strict level of significance was used to correct for multiple significance testing, as described below. note that χ <dig> does not distinguish between significantly hypo- or hypermutable regions, thus we only plot χ <dig> for significantly hypomutable regions . the figure reveals four hypomutable regions, corresponding relatively closely to regions a through d described above. we find that region a is only significant for fairly short region lengths. region b is significant over a wider range of lengths, and the χ <dig> value associated with the region changes depending on region length. in region c, we observe the effect described previously: regions of length  <dig> and  <dig> are significant, but significance is lost for regions of length  <dig> through  <dig>  if the region is expanded to lengths of  <dig> through  <dig>  however, significance is regained. region d is significant for almost any region length, reaching its highest χ <dig> values for region lengths of about  <dig> residues.

although a plot such as figure  <dig> does not completely remove the arbitrariness in determining region boundaries, it greatly clarifies decisions regarding which regions to consider in further biochemical analyses. furthermore, this strategy ensures that no statistically-significant hypomutable regions are missed because an inappropriate window length has been used. due to multiple significance testing, however, we expect some regions to appear significant simply by chance. although a bonferroni correction is not appropriate for the highly non-independent tests illustrated here, we can instead estimate the expected number of such false positives. a conservative approach is to consider the number of non-overlapping  regions tested in each row of the figure. for a window length of one codon, we have  <dig> independent regions and at α =  <dig> , we expect on average  <dig>  false positives. the false positive rate falls rapidly as the window length increases, however. for a window length of three codons, we have 164/ <dig> non-overlapping regions and expect  <dig>  false positives. thus there is about a  <dig> in  <dig> chance that each of the two significant regions illustrated in figure  <dig> for region length  <dig> appears to be hypomutable only by chance. the appropriate level of tolerance for false positives will clearly differ depending on the experimental protocol; we recommend that the value of α be chosen accordingly.

significance of non-mutated codons
as stated previously, the observed hypomutability of residues or regions within a protein could result from selection against mutations located within essential regions, through differences in the mutation frequency of various codons, or simply by chance. the overall goal of unigenic evolution is to identify residues for which the first of these factors is important  <cit> . the analysis in the previous sections is designed to normalize for the second of these factors, variable mutation rates. this leaves us with one further question: for a specific codon in the protein, what is the probability a missense substitution never occurred at this codon simply by chance? when this probability is sufficiently low for all codons in the protein, we can conclude with some confidence that we have sequenced "enough" functional molecules – enough, that is, to draw statistically meaningful conclusions about those codons which remain conserved. in order to answer this question we consider each codon in the protein in turn, and calculate q: the probability that in all sequenced functional clones, a missense substitution was never observed at this codon simply because not enough functional clones were sequenced. we use lowercase q to denote the per clone "quality" factor: the probability that a missense mutation did not occur at a specific codon following a single round of pcr-mediated mutagenesis. if f functional clones were sequenced in total, q is then given by q = qf. thus q is the probability that mutagenesis missed this codon by chance in one functional clone, and q is the probability that mutagenesis missed this codon in f functional clones.

as with the expected mutation rates calculated in previous sections, q values should be calculated using data obtained from a random sample of mutant clones, including both functional and non-functional sequences. given such data, we determine the probability that each codon is conserved during a single run through the pcr using our estimates of the underlying mutation rates. for example, to calculate the probability that a methionine  residue was conserved in a single run through pcr, we evaluate:

qmet = 

for an amino acid with multiple codons such as cysteine  q values are determined as follows:

qcys  =  

the latter equation follows from the fact that a mutation of the first two nucleotides  to any other nucleotide results in an amino acid change, while a mutation of the third base results in a missense substitution only if mutated to a g or a.

once again we provide a sample dataset from the unigenic evolution of pin <dig> in table  <dig>  the table gives the calculated q values for each of the  <dig> residues from positions 7– <dig> in pin <dig> that were not mutated by unigenic evolution.  fifteen of the  <dig> conserved residues in this example have q values >  <dig> . this implies there was more than a 5% probability that no mutations occurred at these residues simply because not enough functional molecules had been analyzed to observe a change.

for the  <dig> residues with q <  <dig> , we must also take into account the issue of multiple significance testing. the average value of q for these residues is  <dig> . thus there is on average less than a 2% chance that mutagenesis missed each of these codons. overall the expected number of false positives is therefore  <dig> * <dig> =  <dig> , or less than one of the  <dig> residues.

discussion
building on previous analytical work in this area  <cit> , we set out to present a detailed description of data analysis for unigenic evolution, including new statistical considerations and relaxing some of the limiting assumptions. an experimental data set was used to evaluate the extent to which results obtained by our method differ from those generated by previous techniques.

to refine the analysis of deminoff et al.  <cit>  who based the frequency of expected mutations on the transition and transversion frequencies observed in functional clones, we used a random pool of both functional and non-functional clones to estimate the underlying base-to-base substitution rates in our experimental protocol. as expected, the number of nucleotide substitutions observed within the random pool of  <dig> clones was nearly double that within the  <dig> functional clones, demonstrating that selection for functional clones eliminated most clones that were subject to a large number of amino acid changes. furthermore, it would be expected that certain amino acid substitutions would be more or less frequent in functional clones.

comparison of fexp. missense values for all codons in our sample data set revealed that this was indeed the case . although several codons exhibited similar expected mutation frequencies when calculated by both methods, the fexp. missense values of most codons differed. specifically, the expected frequency of missense mutations differed by 5% or more for  <dig> of  <dig> codons. this indicates that mutation rates in the population of functional clones were not necessarily representative of mutation rates within the entire library of mutant alleles .

interestingly, an initial comparison of mutability plots generated using data from the random pool of clones  to a plot generated using the transition/transversion ratio in functional clones  <cit>  produced plots with similar overall patterns of mutability . however, a chi-square analysis of the four hypomutable regions revealed that the p values of hypomutable regions a, b, and d were strikingly more significant when the fexp. missense values were calculated using data from the random pool. the p values generated using base-to-base mutations in the random pool were: region a p< <dig> ; region b, p <  <dig> ; region c p <  <dig> ; region d, p <  <dig> . as a comparison, p values generated using transitions/transversions in functional clones were: region a p <  <dig> ; region b, p <  <dig> , region c, p <  <dig> ; region d p <  <dig> .

the data presented in figure  <dig> also illustrate the influence of the size of the averaging window on the identification of hypomutable regions and consequently the delineation of the boundaries of these regions. our analysis clearly illustrates that an averaging window that is too narrow  can result in the appearance of hypomutable regions that are not statistically significant, while an averaging window that is too broad  results in the disappearance of hypomutable regions that are in fact significant. by automating the process of the chi-square analysis over all possible region lengths, and by computing the significance of the region within the window as a whole without averaging, our strategy ensures that all statistically-significant hypomutable regions are identified.

we believe that another major practical contribution of this work is the derivation of q = qf, where q gives the probability that a missense mutation has not occurred at a particular codon by chance. as described above, when this probability is sufficiently low for all codons of interest in the protein, we can be reasonably certain that we have sequenced enough functional molecules to draw meaningful conclusions about those residues that remain conserved. we add the caveat that for some residues, sequencing "enough" functional molecules may not be feasible. as shown in table  <dig>  arginine  exhibited the highest q value in our sample data set; the chance that missense substitutions were not observed at these non-mutated residues as a consequence of not analyzing enough functional clones exceeded 16%. this is a consequence of exceptionally low mutational frequencies, for example mc-g and mg-c in table  <dig>  similar arguments can be applied to proline, alanine, and glycine codons. however, with the exception of these residues it was evident from analysis of the q values that the probabilities of not observing missense substitutions simply by chance for the remaining  <dig> non-mutated residues were low. thus, our method for identification of the boundaries of hypomutable regions facilitates additional "local" mutagenesis of these specific regions, for example by using random oligonucleotides, to further ensure that non-mutated residues are present because they are functionally critical.

throughout this study, we used data obtained from the unigenic evolution of the peptidyl-prolyl isomerase pin <dig> to illustrate our techniques. we used unigenic evolution in this case because the enzyme is highly conserved in eukaryotic organisms, and it was therefore difficult to identify functionally critical residues from a sequence alignment. the unigenic evolution strategy represents an unbiased approach that makes no a priori assumptions about which residues should be subjected to mutagenesis; furthermore, because residues other than alanine can be substituted in non-critical positions, new information about the amino acid chemistry required at each position is obtained. in the case of pin <dig>  unigenic evolution revealed four hypomutable regions, defined using the methods outlined in the current manuscript. two of these functionally critical regions were subjected to saturating mutagenesis using random oligonucleotides, and functional clones were selected  <cit> . these experiments provided a more precise description of the functional importance of individual residues. for example, the crystal structure of pin <dig>  <cit>  revealed the presence of three residues, lys <dig>  arg <dig>  and arg <dig> that participate in recognition of phosphorylated residues within the catalytic domain of pin <dig>  although earlier studies had suggested that arg <dig> and arg <dig> are the two important residues within this region, our unigenic evolution analysis revealed that these residues were not conserved in all functional pin <dig> clones. instead, lys <dig> was conserved with a very low q value  suggesting that this residue is an essential residue for pin <dig> function.

CONCLUSIONS
based on the results that we obtained in our experimental dataset, it can be readily envisaged that unigenic evolution together with the statistical methods that are described in this paper will be a powerful strategy for elucidating functional domains and, in some cases, specific residues that are essential for protein function.

