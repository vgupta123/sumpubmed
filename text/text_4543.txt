BACKGROUND
among the annotations that can be attached to a protein, domains occupy a key position. protein domains are sequential and structural motifs that are found independently in different proteins, in different combinations. as such, domains seem to be functional subunits of proteins above the raw amino acid sequence level  <cit> . several approaches have been developed to define and identify protein domains. some are based on a structural classification scheme  <cit> , while others are inferred by clustering conserved sub-sequences  <cit> . one of the most widely used domain schemata is the pfam database  <cit> . in pfam, each domain family is defined using a set of distinct representative protein sequences which are manually selected and aligned, and used to learn a hidden markov model   <cit>  of the domain. hmms are probabilistic models which use match states to model the conserved positions of the multiple sequence alignment, and handle the gaps with specific  states.

the pfam database  offers a collection of  <dig>  <dig> hmms/domains, which cover over 73% of all proteins in the uniprot database  <cit> . the interpro consortium  <cit>  has functionally annotated a subset of pfam hmms using the gene ontology   <cit> . according to the interpro annotation policy, a domain is annotated with a given go term if all proteins where this domain is known also share this go term. this stringent rule allows, when a new domain is detected in a protein, to transfer its annotations to this protein. enhancing domain detection is thus a fundamental step for improving structural and functional annotations of proteins.

when analyzing a new protein sequence, each pfam hmm is used to compute a score that measures the similarity between the sequence and the domain. if the score is above a given threshold provided by pfam , then the presence of the domain is asserted in the protein. this threshold is referred to as the gathering threshold and is manually curated to ensure few false positives among detected domains  <cit>  however, when applied to highly divergent proteins, this strategy may miss numerous domains. this is the case with plasmodium falciparum, the main causal agent of human malaria, which kills nearly  <dig>  <dig> people each year among the  <dig> malaria-endemic countries  <cit> . no pfam domains are detected in nearly 50% of p. falciparum proteins, while many domain types seem to be missing from its repertory. although this situation may be explained by the existence of genes that are unique to this organism, it is further exacerbated by the high evolutionary distance between p. falciparum and the classical model organisms that were used to build the hmms. accurately estimating the number of pfam domains that remain to be discovered in p. falciparum is challenging. in classical model eukaryotes, the number of pfam occurrences per proteins is above  <dig>  . assuming a coverage of  <dig> , a total ∼ <dig> pfam occurrences should be present in the proteome of p. falciparum. subtracting the number of currently annotated domains from the expected  <dig> would suggest that around  <dig>  <dig> domains are yet to be detected. these “missing” occurrences might be explained by the highly atypical genome of p. falciparum, which is composed of above 80% a+t, and involves long low-complexity insertions of unknown function believed to form non-globular domains  <cit> . this strongly biases the amino-acid composition of p. falciparum proteins, in which six amino acids account for more than 50% of the protein composition  <cit> . in this context, fitting the hmm library to the specificities of the target proteome may help identify additional domains not detected by the standard library.

to the best of our knowledge, two studies address this problem. first, an a posteriori correction of domain scores has been introduced by coin et al. <cit> . this correction takes the prior probability of each domain family in the target species into account. prior probabilities are estimated using asserted domain occurrences in the closest relatives of the species. a second approach is to build taxon-specific models by integrating known domain occurrences from the nearest species into the multiple sequence alignment. for example, this method has been successfully applied to fungi by alam et al. <cit>  thanks to the availability of  <dig> fungal genomes. however, both approaches have an obvious drawback: they can only discover new occurrences of domain families already asserted in the target or its closest relatives.

here, we propose two new approaches to circumvent this limitation by correcting the entire hmm library. the principle of these approaches is to learn overall correction rules which are applied to the emission probabilities of the match states of all hmms. in the first approach, an amino-acid substitution matrix dedicated to the target organism is estimated and applied to the emission probabilities of the match states to mimic the evolution toward the amino-acid composition of the target species. our second approach involves partitioning all match states of the pfam library in clusters with similar amino-acid emission probabilities, and to use the known domain occurrences in the target species to learn specific correction rules for each class of match state.

once a new hmm library has been built, it is used to detect new domain occurrences with low e-values. as explained above, the original pfam library provides, with each hmm, a manually curated threshold which ensures very low false positive rates among the detected domains. however, after hmm correction, these thresholds can no longer be safely used. we propose a simple approach to estimate the false discovery rate  of the newly discovered domains of each corrected library. this procedure enables us to compare the results achieved by each correction method at equivalent fdr.

in the following, we first review the previously described approaches to fit an hmm library to a target species. we describe our own approaches, and present the statistical procedure for fdr estimation. the four correction methods are used to detect new domain occurrences in the p. falciparum genome. in these experiments, we distinguish two cases depending on whether genomes close to the target organism are available or not. finally, we use the corrected libraries to find additional domains with the co-occurrence domain discovery  procedure we have recently proposed  <cit> . this procedure identifies divergent domain occurrences on the basis of co-occurrence properties, and uses its own procedure to estimate fdrs associated with the results. all predictions achieved with the corrected libraries have been integrated into a dedicated website and can be browsed at http://www.lirmm.fr/∼terrapon/hmmﬁt/. a program implementing the two proposed approaches is available at the same address.

method
in the following, the target species is denoted as s. the known domain occurrences of a species are all domain occurrences identified with the original pfam library using the recommended thresholds.

previous approaches
to the best of our knowledge, two approaches, summarized below, have been proposed to fit an hmm library to a target species.

score adjustment
coin et al. <cit>  proposed an a posteriori correction of the score function of hmms. in this solution, the correction does not involve hmms but rather the function used to score domain occurrences. this is done by incorporating information about the specific domain-frequency of the target organism. the adjusted domain scores  are obtained by adding the term log/p) to the original score function, where p denotes the prior probability of domain d , and p denotes the corresponding probability in the target organism. this correction increases the score of domains that are more likely in the species, and decreases the score of other domains. p is estimated from a weighted average of the frequency of d in the already known domains of s and in that of the other sequenced species of its genus, class, phylum and kingdom. this is done according to the recursive formula 

  p=0·5·nntot+0·5·p,fori=m−1to <dig>  

where s <dig> is the target organism ssi is the ith parent taxon, sm is the kingdom, n is the number of domains d in taxon si, and ntot is the total number of domains in si. for i=m we use p=nntot.

enriched alignments
a simple approach to fit an hmm to a target species is to enrich the alignment used to learn the hmm with known domain occurrences in the species or its close relatives . given an hmm library and a set of protein sequences from the closest species of the target organism, the procedure involves: 

 <dig>  identifying all domain occurrences in the selected species using the original library with recommended thresholds,

 <dig>  building new multiple sequence alignments by integrating the identified domains into the original alignments using the viterbi algorithm  <cit> ,

 <dig>  building new hmms from new alignments using hmmer software  <cit> .

two new approaches
both previous approaches have the same drawback: only domain families already known in the target or its close relatives may benefit from detection improvement. we propose to circumvent this limitation by learning global correction rules that are applied to match states of all hmms, in order to build a new and complete adapted library. we focus on match states because they model the conserved positions of the domains and thus bring most of the information contained in the alignments. the challenge is to derive rules that simulate the drift that separates the target organism sequences from the sequences used to train the hmm, while preserving as much position-specific information of the hmms as possible. we propose two approaches for this, that are described below. in the following, x denotes the set of all match states of all hmms. each state x∈x is described by a vector i∈where xi is the probability to emit the amino acid i in state x.

substitution matrix
substitution matrices  are essential for computing substitution probabilities along branches in phylogenies, and thus for computing the likelihood of the data  <cit> . we distinguish the substitution rate matrix containing the instantaneous rates of change from any amino acid to another, and the substitution probability matrix which contains the probabilities of change from one amino acid to another when elapsed time is t. these matrices are associated with a stationary distribution of amino acids; when t is large enough, the probability of any amino acid tends towards its stationary probability, regardless of the initial probability distribution. here, we use this property to move the amino-acid distribution of match states toward the distribution of the target species, thus simulating the evolution of conserved positions under the constraints characteristic of this species.

let q= be the rate matrix and p=) be the probability matrix associated with t, where i and j denote two amino acids and ij the change from i to j. we use a general time reversible  model, and thus q is composed of two parts: the stationary amino-acid distribution π= and the symmetric exchangeability matrix r=, using equality: qij=rijΠj . the diagonal elements are such that the row sums are all zero. q is normalized, that is −∑iΠiqii= <dig>  so that an evolutionary time t of  <dig> corresponds to an expected number of substitutions per site equal to  <dig>  here we use the r matrix of the lg model  <cit> , which refines previous general purpose models such as jtt or wag, and a πdistribution computed from p. falciparum proteins . p is obtained by matrix exponentiation: p=eqt.

the new hmm library  is built by applying p to the probability distributions of all match states  using equation: x∗=x·p, where x is the original distribution vector of the match state, x∗ the new one, and both are row vectors. the evolutionary time t has to be carefully chosen: if too large, then all x∗ distributions tend toward π and are uninformative; if too small, then x∗∼ xand the correction has no effect. several values ranging from  <dig>  to  <dig>  were tested in our experiments .

match-state clustering
in profile hmms, match states model the amino-acid distribution of conserved positions. this distribution reflects the physical and chemical constraints associated with the position. thus, positions with similar distribution are likely to undergo similar constraints. the principle of the second approach is to cluster the match states of hmms according to their amino-acid distribution, and then to learn correction rules for each of the cluster of match state . first, the k-means algorithm  <cit>  is applied on the set x. this algorithm takes as input the number of clusters  k, and outputs a partition of xi.e. each state x∈x is associated with a unique class cx∈. next, using the known domain occurrences in the proteins of the target species and its close relatives, the match states of the original hmms are aligned on these proteins with the viterbi algorithm  <cit> . from these alignments, we count, for each state class, the number of times each amino acid is aligned on a state of this class . these counts are used to compute an amino-acid distribution of the state class, which reflects how the physical and chemical constraints of this class translate into the target species. the new hmm library is built by mixing the original distribution of each match state with the estimated distribution of its class, i.e.:

  x∗=x·p+a·, 

where p is the mixture proportion, and a is the amino-acid distribution associated with class cx. note that while other clustering algorithms could be used, the k-means algorithm provides a fair tradeoff between run time  and the quality of the results.

estimating the error rate of an hmm library
evaluating and comparing hmm libraries is a difficult task. as explained above, the original pfam library provides, with each hmm, a manually-curated score-threshold which ensures few false positives among the detected domains. one effect of the hmm-fitting approaches described above  is to move the amino-acid composition of hmms toward the composition of the target organism. globally, this tends to increase the score of proteins of the organism for any hmm. hence, the recommended thresholds cannot be safely used with the modified libraries. we propose here a simple procedure to estimate the proportion of false positives among the new domains identified with a particular library. d denotes the set of new domain occurrences identified by the library  under the e-value threshold e. we want to estimate the fdr associated with , i.e. the probability pr for d∈d.

a well known tendency of protein domains is to appear preferentially with a few other favourite domains within a protein  <cit> . we show here how this property can be used to estimate the fdr associated with . the first step is to identify, from the whole set of annotated uniprot proteins, domain pairs that are conditionally dependent, i.e. that are observed in the same proteins a significantly higher than expected number of times. this is achieved with the fisher’s exact test, to cope with potentially small sample sizes  <cit> . a p-value is computed for each domain pair, and the pairs below a given threshold are stored in a set c of conditionally dependent pairs . next, from the target-species proteins that possess both known and new domains, we build a list of  domain pairs l, by randomly associating each new domain with one of the already known domains of the same protein. we denote as  a pair of  domains of l. the list l is used to estimate the fdr of . we assume that the proportion of false positives among the new domains dn of l is globally the same as in all domains of d. in particular, this assumes that, for a given e-value threshold, the proportion of false positives in domains of multi-domain proteins  is the same as in domains of mono-domain proteins . although domains of mono- and multi-domain proteins are usually different, they globally share the same amino-acid composition, and there is no reason to believe that hmms are more prone to false positives for either type.

let |l| be the number of pairs in l. now, we denote as  the probability that a pair in l belongs to the set of cdps c, given that the potential domain is a true positive; similarly,  is the probability that a pair in l belongs to c, given that the potential domain is a false positive. we can express the expected number of pairs in l that belong to c as 

  e|lc|=|l|·pr∈c)=|l|·pr∈c|dn=true)×pr+pr∈c|dn=false)×pr=|l|·풯·+Ƒ·fdr. 

thus, we have 

  fdr=1−e|lc||l|−ℱ풯−ℱ· 

|l| is known, and e|lc| is estimated by the observed number of pairs in l that belong to c. for , a list l′ is created by randomly permuting new domains of the pairs in l. this is equivalent to randomly permuting the new domains in the proteins of the target species, and thus simulates a situation where almost all new domains are likely false positives.  is estimated by the proportion of l″pairs that are in c. the procedure is repeated several times and averaged to obtain a better estimate. for , we use the known domain occurrences. a list l′is created from all  domain pairs observed in proteins with at least two known domains. this simulates the situation where all new domains are true positives, and  is estimated by the proportion of l′pairs that are in c.

one issue with expression  is that the estimated value may depend on the p-value threshold used to build the set of cdps. however, in experiments on the p. falciparum proteome , we do not observe this dependency, and standard thresholds between 10−2and 10−4give very similar results . furthermore, it is important to note that  and  have very different estimated values. the value of  is above 99%, while that of  lies between 1% and 2%, independent of the considered library and e-value threshold . hence, expression  could be simplified as fdr∼1−e|lc||l|. based on this equation, the fdr is simply equal to the proportion of domain pairs in l which do not belong to the set c. in other words, almost every correct new-domain in l is in a pair that is in the set c, and a new domain from a pair that is not in c is most likely incorrect. this astonishing fact clearly illustrates the strong correlations that exist between domains in multi-domain proteins. it also reveals that almost all the correlations between domains can be deduced from the set of uniprot proteins, i.e. most domain associations have already been observed a significantly high number of times.

another issue is the statistical error induced by the sample l in our fdr estimate. we address this issue with a classical bootstrap procedure  <cit> , in which a bootstrapped list lb is build by randomly sampling with replacement |l| pairs of l. from this list, we compute a new fdr estimate fdrbusing the procedure described above—i.e. we compute a new estimate of  and e|lc|—, and the entire procedure is repeated a large number of times b . we then have a sample of b independent bootstrap replications of the fdr estimate, and we use the standard deviation of this sample as an estimate of the standard error.

RESULTS
we applied the four approaches described above—i.e. score adjustment, enriched alignment, substitution matrix and match-state clustering—to the proteome of p. falciparum , using the pfam hmm library . there are a total of  <dig> proteins in p. falciparum,  <dig> of which have a known domain occurrence. in our substitution matrix approach, we must choose a stationary distribution. we tried two solutions for this. the first one corresponds to the average amino-acid distribution of p. falciparum proteins. however, p. falciparum proteins are known to exhibit low-complexity inserts with very biased amino-acid distribution which are responsible for an average increase of 20% in the total length of the proteins  <cit> . these low-complexity segments are usually found between domains, but may also reside within a domain. following pizzi and frontali  <cit> , we used the seg algorithm  <cit>  to remove low-complexity segments and to compute an amino-acid distribution of high-complexity regions which is utilized as an alternative stationary distribution. for the time parameter t, which represents the mutation probability at each position, we tried seven values:  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig> . finally, for the match-state clustering approach, different numbers of classes ranging from k= <dig> to k= <dig>  as well as three mixture proportions  were tested.

for each correction method and parameter value, a new hmm library is built. each library is then calibrated with exception of the score-adjustment method derived library. calibration is achieved by fitting the gumbel distributions used for e-value computations to the new models . after this step, each library is used to search for new domain occurrences below a given e-value threshold in p. falciparum proteins. in the following, we use the modified libraries for two problems. first, the aim is to identify new domains with low e-values; second, the aim is to identify more divergent domain occurrences  with the help of the codd procedure we have recently proposed  <cit> .

results for low e-value occurrences
the new libraries were first used to find new domains at low e-value . for each library, the fdr associated with the newly identified domains was estimated with the procedure described above.

in a first experiment, we used all known domains of available alveolata proteins to fit the hmms. this includes domains from  <dig> completly sequenced apicomplexa species—six plasmodium, three cryptosporidium, two theileria, babesia bovis and t. gondii—, the ciliate paramecium tetraurelia, and numerous translated orfs of isolated alveolata sequences. for the score-adjustment approach, the six plasmodium species are in the genus ), the two theileria species and babesia bovis are in the aconoidasida class , the three cryptosporidium species and t. gondii are in the apicomplexa phylum , and the kindom  incorporates all eukaryotes.

the additional file 1: figure s <dig> shows the results achieved by the substitution matrices and match-state clustering approaches for different parameter values. for the substitution-matrices approach, removing low-complexity regions before computing the stationary distribution increases the number of new domains, at equivalent error rate. as for the time parameter, the best results are achieved with t= <dig> . for match-state clustering, the curves suggest that 75% is the best mixture proportion. at low fdrs, the differences between the performance achieved by the different values of k are small, but k= <dig> seems to be the best. the investigated parameter values were chosen to span relatively large and a priori sound intervals. however, a more systematic exploration of the parameter space—especially for the time parameters t and the mixture proportion p—may slightly improve the results. however, we have chosen not to embark further on the parameter space exploration, as expected improvements are likely moderate, and as this allows for a fair comparison with the score-adjustment and enriched-alignment methods which both lack parameters. figure  <dig> compares the best results achieved by the four approaches when using the known domains of alveolata species. for comparison, we also show the results achieved with the original pfam library at the same e-value thresholds . all methods discover several additional domains not identified with the standard library. the enriched alignment approach  achieves the best results. even if this approach cannot reconstruct all hmms, the reconstructed models correspond to the most frequent families in the taxon. the match-state clustering approach  and substitution matrices  also identify additional domains. the weaker results obtained by the latter method may be due to the standard substitution schema that was employed. indeed, exchangeability matrices model “universal” evolutionary mechanics, while p. falciparum is constrained by more extreme evolutionary circumstances. moreover, this is the only approach that does not use information from close species. finally, the score correction approach also discovers some domains not identified with the original pfam library with the standard scoring function.

we also estimated the standard error of the fdr estimate using the bootstrap procedure previously described. figure  <dig> illustrates the fdr standard-error with respect to the number of newly identified domains for the different libraries. it shows that when the number of new domains is above  <dig> , the standard error ranges from 3%  to 5% . however, when the number of new domains is smaller, the fdr standard-error increases, and the fdr estimate become unreliable. to understand this sudden increase in standard error, one must recall that the fdr is estimated on the basis of a subset of the new domains—those that are in a protein where a domain is already known. hence, when the number of new domains is around  <dig>  the number of domains actually used in the fdr estimate is between  <dig> and  <dig> depending on the library. figure  <dig> summarizes the predictions achieved with the enriched alignment, match-state clustering and pfam standard library approaches at 10% fdr. we observe that the corrected libraries include most of the domains also identified with the standard pfam library when relaxing the e-value thresholds. on the contrary, the domains solely identified by the corrected libraries are more diverse, and many new predicted occurrences are specific to one of the approaches. all results obtained with the different libraries at 10% fdr are summarized in table  <dig> . the results suggest that although the enriched-alignment approach identifies the largest number of new domain occurrences, the match-state clustering approach provides close results in terms of domain diversities , and identifies slightly more domain families that were previously unknown in the apicomplexa phylum .

number of new domains , domain families of the new domains , domain families previously thought to be absent in p. falciparum , and domain families previously thought to be absent in all alveolata , identified by the correction approaches and the standard pfam library at 10% fdr.

to further assess the newly discovered domains, we next looked at the other interpro domains that do not belong to the pfam database. the interpro database incorporates several domain databases  into a single resource. this meta-database organizes entries in interpro families that pool all representations of the same domain  <cit> . the different databases behind interpro use their own domain definition and representation, and thus present a heterogeneous view of protein domains. taken altogether, predictions of these different databases are more sensitive than that of the pfam database only, but they may also be less accurate. table  <dig> reports the number and proportion of newly identified pfam domains  that belong to an already known interpro family in the same protein. for comparison purpose, we also computed the proportion of matches achieved on random domains, by randomly permuting the new domains across proteins . for every hmm-fitting procedure, around 50% of new domains match with a known interpro entry of the protein. this is a high proportion compared with what is expected on random domains , which indicates that this 50% domains are likely true positives. moreover, although the entire interpro database is more complete than the pfam database only, it is far from being exhaustive. hence, this result does not imply that the remaining ∼50% new domains that do not belong to a known interpro family in the same protein are false positives.

interpro cov.: number and proportion  of new domains belonging to an interpro family previously known for the protein, for the different correction approaches and the standard pfam library, at 10% fdr; interpro cov. h0: proportion of matches on random domains.

apart from the substitution-matrix method, all approaches make use of the already known domains of p. falciparum and of the other available alveolata species. to compare the performance of the methods depending on whether species close to the target were available or not, we conducted a second series of experiments using only known pfam domains of the p. falciparum genome to fit the libraries . for the score-adjustment approach, this involves using only two levels: s <dig> for p. falciparum, and s1for the kingdom . in these conditions, the results strongly differ from the previous ones. the number of new domains identified by the enriched alignment approach drops off, and even passes below the number of domains identified by the original pfam library at low fdr. on the contrary, the match-state clustering approach still provides numerous additional domains. with the substitution-matrix approach, it appears to be the best approach when no close species are available. while for p. falciparum the practical interest is limited, this illustrates the potential of such approaches for all genome sequencing projects of organisms from poorly known phyla, with no already sequenced close-species.

results for more divergent occurrences
we next investigated the performance of the modified libraries for identifying divergent domain occurrences using the codd procedure we have recently proposed  <cit> . codd improves the sensitivity of hmm domain detection by directly exploiting the co-occurrence domain tendency used in the fdr estimation method described above. given a set of new domain occurrences below a permissive e-value threshold , codd selects those that form, together with another domain of the same protein, a pair previously identified as being conditionally dependent . the domains selected this way are said to be certified. the certification can be done on the basis of the already known pfam domains of the protein, but also on the basis of the other known interpro  domains, or even on the basis of the other new pfam domains that are below the e-value threshold. moreover, codd uses a shuffling procedure to provide its own estimate of the fdr associated with the certified domains  <cit> . because domain co-occurrence is a strong indicator of real occurrence, codd can certify the presence of a domain with low fdr even for very high e-values. in the following, it is used to certify the presence of domains with e-values up to ten, far higher than the highest e-values considered in the previous section . as codd also certifies the presence of domains with low e-values, part of the certified domains are already considered in the previous section. however, note that codd is obviously limited to the certification of domains from multi-domain proteins, and thus that a large part of the previously considered domains  cannot be certified. moreover, it is worth noting that, contrary to the previous fdr, which involves all domains below a given e-value threshold, the fdr estimated by codd only concerns the certified domains.

as with low e-value thresholds, the substitution-matrix approach outperforms the original pfam library, but does not achieve as good results as the match-state clustering approach. it is worth noting that the stationary distribution used in these experiments—i.e. the one obtained when removing low-complexity regions from p. falciparum proteins—is closer to the classical equilibrium amino-acid frequencies  than the global p. falciparum distribution is. thus, for comparison, we also built different hmm libraries using the wag equilibrium frequencies as stationary distribution. the results achieved with different time parameter values are in additional file 1: figure s <dig>  although the wag equilibrium frequencies never achieved results as good as the p. falciparum distribution without low-complexity regions, it also outperforms the standard pfam library. this seems to indicate that simply smoothing the match-state distribution of the hmms is an adequate strategy for increasing the number of discovered domains in divergent organisms like p. falciparum.

we also applied a bootstrap procedure similar to that described above to estimate the standard error associated with the codd fdr. irrespective of the library, the standard error remains quite low, ranging from  <dig> % for the highest fdrs to  <dig> % for the smallest ones . table  <dig> reports the results achieved by codd on the different libraries at 10% . note that contrary to figure  <dig> which only reports the number of domains certified with the known pfam domain occurrences, this table combines the certifications achieved with all known domain occurrences  as well as with the other new domain occurrences below the considered threshold.

number of new domains , domain families of the new domains , domain families previously thought to be absent in p. falciparum , and domain families previously thought to be absent in all alveolata , identified by codd with the different libraries at 10% fdr. numbers in parenthesis refer to domains/families that are new compared to table  <dig> for the same library.

annotation of p. falciparum proteins
any item or feature that would help assigning a function to a gene is precious for biologists. we thus investigated go annotations that could be deduced from all newly identified domains. as described in the introduction, some domains have been associated with specific go terms by the interpro consortium. the policy is to associate, with a given domain, annotations shared by all annotated proteins possessing this domain. moreover, by extending this policy to domain combinations , several additional go terms can be deduced from the combination of two or more domains. to this end, we enumerated all pfam domain combinations in the proteins of swiss-prot, and identified, for each combination, the go terms shared by all annotated proteins where the combination is present . we found  <dig> pfam domain combinations associated with at least one specific go annotation:  <dig> domain pairs,  <dig> domain triplets and  <dig> quartet. all associations between domain combinations and go terms are available at http://www.lirmm.fr/∼terrapon/hmmﬁt/. altogether, single domains and domain combinations improve the annotations of several p. falciparum proteins. table  <dig> gives the number of new annotations brought by the new domains identified at low e-values or with the help of the codd procedure at 10% fdr . for example, the new domains identified with the match-state clustering library leads to the discovery of  <dig> new go annotations, i.e.∼6% of the  <dig> already known go annotations of this organism. all predictions on p. falciparum achieved using the alveolata species have been integrated into a dedicated website which gathers all known and newly discovered domains and go annotations for the proteins of this organism. the site provides details on e-values, fdrs and alignments, and includes useful links to pfam, interpro and plasmodb websites. moreover, when a new domain has been certified with codd, this information, along with details of the certification process, are included on the website.

number of new go annotations brought by the different correction methods and by the original pfam library at 10% fdr. “new go” is the total number of go annotations, and “unan. prot.” is the number of proteins without known annotation for which an annotation has been proposed.

although the expected number of false positives in predictions with 10% fdr is low, it is not equal to zero. hence, an expert examination of the predictions is recommended to identify the 10% false positives. this can be done in several ways: by looking at the predictions shared with the other corrected libraries, by checking if a prediction agrees with known protein annotations , and by carefully looking at the protein alignments.

among the predictions, several putative domains have attracted our attention as they might provide insights into important biological functions essential to understand the biology of the parasite, including the control of gene expression, the mechanisms of cell proliferation, the biogenesis of intracellular organelles and the parasitic metabolism. hereafter, we give a few examples that have been identified using the codd procedure on the modified libraries.

regarding the control of gene expression, it is now established that an important general process in this parasite involves the control of chromatin condensation via chemical modifications of histones and/or of dna bases  <cit> . pfd0840w encodes a conserved hypothetical protein in which we have detected, with the match-state clustering library, a dna binding and a dna methylation domain that would make this protein an important actor in the control of the genetic expression in plasmodium. in the same context, the putative role of pfb0290c in the control of gene transcription is further consolidated by the detection of domains functionally associated with dna binding and transcription from rna polymerase iii promoters .

the paucity of genes involved in important metabolic pathways has also been highlighted in a series of in silico analyses of the malaria genome  and expectations in the reannotation with respect to the discovery of missing or novel metabolic enzymes are high. a striking feature is the apparent lack of glycosyltransferases , suggesting that this eukaryote would only catalyze eight hexosyl-transfer reactions and only one glycosyl-hydrolase. this lends support to the notion that a parasitic lifestyle does not require the utilization of exogenous linked sugar sources. here, we identified domains in the mal13p <dig>  protein sequence that suggest a possible interaction with carbohydrates, including the transport of sugars and/or the catalysis of a glycosyl-transfer similar to that catalyzed by enzymes of the glycosyltransferase family  <dig> of the cazy classification . future experimental studies of the corresponding gene and proteins should be conducted as mal13p <dig>  may prove to be an important protein in the carbohydrate metabolism of p. falciparum.

regarding the biogenesis of intracellular organelles, the vital importance of the apicoplast has stimulated numerous studies geared at functionally dissecting the import and maturation of nuclear encoded proteins . pf14_ <dig>  which encodes a hypothetical protein of the apicoplast previously reported as possibly associated with the organelle membrane, is suspected to harbour a peptidyl-prolyl cis-trans isomerase activity by the occurrence of domains trigger_c  and fkbp_c  . it could therefore play an important role in the accurate folding of imported proteins when they reach stroma of the apicoplast. these examples illustrate how the detection of novel domains might be helpful for further studies of this essential, yet poorly understood, parasite proteome.

discussion and 
CONCLUSIONS
we have proposed two new methods to fit an hmm library to a target organism. these methods have been implemented in a software freely available at http://www.lirmm.fr/∼terrapon/hmmﬁt/. our methods learn global correction rules that are applied to match states of the entire library, thus enabling the discovery of domains that were previously unknown in a given organism. the two methods concentrate on modification of the amino-acid distribution of match states. this is because match-states model conserved positions of the proteins, and thus likely contain most of the information of the sequence alignments. however, several other solutions can be explored, such as modifying the number of states, the probabilities of between-state transitions, the amino-acid distributions associated with insertion states, or the null model used for computing scores and e-values.

additionally, we have presented a simple procedure to estimate the proportion of false positives in a set of newly identified domains. using p. falciparum as a case study, we assessed the performances of our methods and of two previous approaches that rely on a specific adjustment of the score function, or on the enrichment of sequence alignments. note that several other approaches address related issues. for example, kumar and cowen  <cit>  propose to augment the sequence alignments with artificial sequences generated by simulated evolution. similarly, several studies propose to improve the training of profile hmms and the scoring of sequences using negative examples . however, the aim of these methods differs from ours. instead of fitting hmms to a particular species, their goal is to distinguish the different sub-families within a large protein family. consequently, we have not considered these studies further in the presented work.

in p. falciparum, our experiments show that when several close genomes are available, the approach which integrates known domain occurrences into the sequence alignments provides the best results in terms of number of new occurrences. although our approach based on match-state clustering identifies fewer new domains, it provides similar results in terms of domain diversity, and discovers slightly more new domain families. moreover, when there is no closely related species available, our two approaches outperform the other methods in terms of occurrence number, domain diversity and number of previously unknown families. this is also the case when the modified libraries are used to detect divergent domain occurrences with the help of the codd procedure.

in summary, the fitted libraries identify in p. falciparum several hundred domains that are not identified with the original pfam library. at low e-value thresholds, the pfam standard library identifies  <dig> new domains at 10% fdr, while the enriched alignment and match-state clustering libraries identify  <dig> and  <dig> new domains, respectively, at the same fdr. with the help of the codd procedure, the original library identifies  <dig> new domains at 10% fdr, while the enriched alignment and match-state clustering libraries identify  <dig> and  <dig> new domains, respectively. additionally, the newly identified domains often provide new go annotations for p. falciparum proteins. for example, the enriched alignment and match-state clustering libraries lead to an additional  <dig> and  <dig> new go annotations, respectively. all new domains discovered on p. falciparum have been integrated into a dedicated website which pools all known/new annotations of protein domains and functions for this organism.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
nt, og and lb conceived and designed the method and experiments. nt implemented the approach. em analysed the biological results. nt and lb drafted the manuscript. og initiated the project. all authors have read and approved the final manuscript.

supplementary material
addtional file 1
supplementary figures and tables. this pdf file contains four supplementary figures, and three supplementary tables.

click here for file

 acknowledgements
this research was supported by the plasmoexplore and plasmoexpress projects  of the french national research agency.
