BACKGROUND
as the volume, complexity and breadth of biological data collected on model organisms increases, more flexible and extensible systems for data collection, integration and analysis are required. existing systems often focus on data obtained in a specific context. for example, the knockout mouse project  <cit>  aims to generate mouse embryonic stem cells containing a null mutation in every gene in the mouse genome; the mouse phenome project  <cit>  and the mouse genome database  <cit>  aim to gather and disseminate baseline phenotypic data for a defined set of inbred mouse strains; the mouse tumor biology database  <cit>  maintains information on the mouse as a model system of hereditary cancer; and pathbase  <cit>  is a database of histopathology images derived from mutant or genetically manipulated mice annotated using a systematized ontology . although these systems expand our understanding of particular phenotypes, they focus on experimental observations associated with classes of animals rather than multiple types of data linked to individual animals, thereby prohibiting researchers from integrating diverse data collected by their own laboratories or others on individual animals.

the preliminary hurdle for working with animal data is its collection. open-source applications like mousetracs  <cit>  provide mechanisms for mouse colony and protocol management with some facilities for the collection of animal phenotype data. mutrack  <cit>  also provides mechanisms for animal management and data collection in a collaborative context. musdb  <cit>  is a communications platform based on multiple applications for management of husbandry, mating, enu injection, sample management, and phenotypic screens. these centralized resources provide mechanisms for collection of basic phenotype data for comparison among animals. however, these data collection systems are husbandry oriented and do not address integration and analysis of histopathological data or "omics" data.

systems that describe data with complex relationships require the use of expert-curated ontologies for interoperability and precision  <cit> . the open biomedical ontologies  initiative is a collection of orthogonal ontologies and includes the adult mouse anatomical dictionary  <cit>  and the mpath mouse pathology ontology  <cit> . the mammalian phenotype  ontology  <cit>  annotates "mammalian phenotypes in the context of mutations, quantitative trait loci and strains that are used as models of human biology and disease". these formalizations of pathology and anatomy terms represent community involvement in the development of standardized methodologies for the description of where  and what  in a computer readable format. the individual ontologies are orthogonal and do not typically define relationships between terminologies.

once primary data is collected, the capacity to combine disparate data sets is a critical component of the ability to generate biological hypotheses  <cit> . in order to facilitate integrated phenotypic analysis of normal, genetically modified or environmentally perturbed mice at the level of single animals, we developed a computational framework for data collection, management and integrated discovery that we call the mouse phenotype analysis system   <cit> .

the three main features of mphasys are 1) a centralized framework for the collection and analysis of animal data, 2) applications for management, analysis and visualization of animal data using this framework and 3) specifications for standardized collection  and dissemination of animal data through an open and extensible data document format. as a framework, mphasys unifies and utilizes disparate data related to clinical, pathological and molecular variables obtained from individual animals within the context of existing data sources such as ncbi gene  <cit>  and the gene ontology   <cit> . in mphasys, the individual animal constitutes the fundamental biological unit to which all data are related. this leads to an animal in a study being a "phenome", i.e., a collection of the measured phenotypic variables that describe the animal. an animal-centric schema defines the relationships of the data and links them to relational databases. the data entry application built upon this framework is a tool designed to provide high quality data collection at the bench with simultaneous access to tools for analysis of the data. the entry of data are guided by means of an interrelated set of ontologies and users are required to enter a minimally defined set of terms for each phenotypic variable. the application provides for the capture of high quality data by requiring that data is complete, matches the format of the data in the database, and prevents inadvertent modification of existing records. this report describes the implementation of the mphasys system and presents a case-study using data collected from mice harboring a specific germline mutation in the dna repair and transcription-specific gene xpd. this mouse model mimics the human mutation which gives rise to trichothiodystrophy .

implementation
the mphasys system was written in the java programming language. an animal-centric schema was designed based on animal data relationships and hibernate was employed to map data and relationships to relational databases . existing data such as ncbi gene were mapped using the data relationships defined by its creators. mapped data sources were linked using the spring framework  <cit>  thereby allowing multiple hibernate-mediated data sources to be compared. internally, the mphasys framework allows comparison and selection across databases using namespace/identifier pairs which are represented by unique lsid  <cit>  identifiers, allowing data from different databases to be joined via these unique individual animal identifiers. web based applications were written in java and run on the jboss  <cit>  platform. the mphasys data entry application was written in java and uses java web-start for distribution.

the protégé ontology editor and knowledge-base framework  <cit>  was utilized for development and ontology management. the mphasys pathology ontology is based on the national toxicology project  pathology code tables  from the niehs  <cit> ; mpath pathological instance codes  <cit> ; studies of aging phenotypes in wild-type and dna-repair deficient mice  <cit> ; standardized reference texts  <cit> ; and interaction with rodent pathologists. terms are entered into protégé utilizing property slots that encode relationships between terms, organs and scores .

animal and pathology data were entered into mphasys using the java data entry tool and standardized xml document formats designed for loading data from files. data, applications and detailed descriptions of the systems architecture and pathology ontology are available online  <cit> .

RESULTS
design of system architecture
the architecture of the system is based around the activities of scientists at the bench in order to maximize the probability of accurately capturing data. figure  <dig> depicts the workflow of investigators at each stage of data collection and figure  <dig> depicts the architecture of the system. mphasys is designed to be flexible in how its use and its databases are configured, allowing applications to be written to meet the needs of different data collection and analysis schemes. mphasys-based applications can operate independently of each other and data merged via a common document format, they can operate simultaneously using the same database, or external data can be translated to a common document format and imported into the system.

modeling animal data and xml schemata
the heart of mphasys is its object-relational mapping of animal measurements to individual animals. figure  <dig> shows the primary classes representing the animal data that are persisted within the system. the "animal" class represents the primary meta-data for individual animals and includes date of birth, date and circumstance of death, unique identifiers and identifiers representing the animal's parents. the animal model specifies the pieces of information collected about an animal, their relationships and the context in which they are to be analyzed. "organs" are modeled as a many-to-one part-of relationship with the animal.

organs as well as animals can have "measurements" which are pre-defined classes of measurement types  or individually defined ontology-mediated measurement types . organs can be assigned other measurement types .

unique identifiers are central to maintaining data integrity within the system. mphasys utilizes the life science identifiers   <cit>  universal resource name  style for describing unique entities. all entities which might be interchangeable  or non-unique between systems  utilize a lsid for its unique identifier. animal identifiers represent a slightly different usage of the lsid urn format, as each lab is its own naming authority. therefore, individual laboratories define their own namespaces to keep animal identifiers unique .

a standardized document format was designed using xml schema  <cit> . this document format, termed mouseml  <cit> , provides a methodology for saving, exchanging, and generating animal data, which validates that the data is complete and properly formatted. mouseml replicates the definitions defined by the animal model and defines a polymorphic measurement type, allowing for later expansion of measurement types and the addition of new ontologies or the use of alternate ontologies. mphasys is able to read and write animal data documents that satisfy the constraints of the schema. when loading documents, they are automatically evaluated by the system against the schema, ensuring the integrity of the document's structure. documents conforming to the mouseml schema extend the notion of identifying entities via a unique identifier to allow for safe exchange of data across laboratories. the mouseml schema definition files and additional information are available online  <cit> .

mphasys ontology
general considerations
the emphasis on clinico-pathological phenotypes stems from the importance of multiple pathology as the main criterion for judging the possible effects of germline genotypic changes and/or environmental exposures. while genome-scale, molecular data sets are important, pathophysiological alterations remain the primary basis for characterizing the phenotypes of mouse models. to address this need, we generated a structured mouse-specific pathology ontology based on the ntp pct  <cit> . this terminology describes topography , morphologies  and qualifiers  as well as the morphology-topography and morphology-qualifier relationships. our interest in the histopathological analysis of dna repair-deficient mutant mice and studies of exposure of these models to dna damaging agents makes the ntp pct well-suited as a basis for our terminology: the ntp pct represent terms developed for rodent exposure studies and are unique in establishing linkages between rodent anatomy and pathology, and over  <dig> studies of rodent exposure studies performed using these terms are available for download  <cit> .

in addition to the core terms and relationships adopted from the ntp terminology, the lexicon was broadened by the addition of age-related phenotype terms. these terms were collected from several complete life-span studies of wild-type and mutant mice harboring knock-out mutations and mutational mimics of human progeroid syndromes in dna repair related proteins . these terms were normalized to remove duplicated terms  and separate topography-morphology term pairs. the mphasys ontology was then expanded to include terms from existing terminologies . as the mphasys ontology is a synthesis of multiple terminology types, it can also provide relationships between existing terminologies; i.e. the ontology links morphologies to topographies and qualifiers using property slots that represent "malignancy type", "micro/gross type", "morphology-organ link", "morphology-qualifier link", "site-organ link", "sex-specificity", and slots for ma, mpath, and ntp codes. finally, because of the modular nature of mphasys, and its use of unique identifiers at every level, it would also be possible to replace the current mphasys ontology with another if required.

topography terminology
the topography component of the mphasys ontology describes locations of findings. the terminology is organ based, organizing organs into a partof hierarchy that defines the animal as the root of a directed acyclic graph, and organs are classified into classes of organ systems. associations of anatomical sub-structures  are defined per organ, and organs are labeled with sex specificity. additionally, locative qualifiers are defined to give more specific detail to description of location within sites. organs have been annotated with their corresponding mouse anatomical dictionary  organ codes.

pathology terminology
the pathology  terminology is an isa hierarchy of terms divided into three primary classes: "neoplastic", "non-neoplastic", and "not remarkable". all terms are linked to the organs for which they are appropriate to describe, allowing data entry and analysis systems to provide a level of data validation. each term has a link to appropriate types of scores  for each term. terms are classified as either appropriate for gross- or micropathological examination. additionally, neoplastic terms are described as malignant and/or benign. finally, the mphasys ontology was updated to completely subsume terms in the mpath ontology, and existing terms have been annotated with mpath codes. the pathology terminology currently consists of  <dig> unique terms.

scores, measurements and clinical observations
terms directly defined by the ontology include qualifiers, or morphology specific scores, and clinical observations. qualifiers represent quantitative measures of number, differentiation stage, distribution type, duration, level of inflammation, and severity. clinical observations describe gross and behavioral findings of animals over the course of their life span, as observed by animal handlers. classes of clinical observations are behavior, general , clinical lesion, site of application , and cause of death.

the mphasys application itself defines a measurement class and several measurement types as well as definitions of units appropriate for recording them. these include weight and lifespan.

software engineering and framework implementation
based upon the animal data model and ontology specifications, a framework was designed to manage and analyze data. we utilized the hibernate object-relational mapping tool  <cit>  to create an animal-centric schema  which defines data relationships and maps them to a relational database, programmatically representing the animal data and relationships as objects and persisting them in the underlying database. in addition to the core animal data, mphasys utilizes data from external sources  as ontologies to describe genotypes, molecular data and functional relationships. these external databases were mapped using hibernate to model the relationships defined by the developers of the data. mphasys was designed to provide a mechanism for updating these databases from public repositories.

these mapped data sources were linked using the spring framework  <cit>  thereby allowing multiple hibernate-mediated data sources to be compared. each sub-system within mphasys is configured such that new systems can be integrated easily or existing ones can be replaced .

using unique identifiers, mphasys links data from the disparate databases integrated within. functions were written that provide a mechanism for selecting and partitioning animals based on user-defined criteria. first, the user selects the animals to be analyzed based on a definition of which studies, genotypes, sex and measurements they wish to incorporate . second, these animals are partitioned into different comparison groups . by default, these groups are generated by dividing animals first by study, then by genotype and finally by sex. however, multiple criteria can also be defined such as divide by presence or absence of a specific pathology and these criteria can be grouped using logical "and" and "or" clauses. the system automatically selects animals based on the selection criteria and performs statistical tests and graphical representation based on divisions defined by the series criteria. mphasys provides for unit conversion, annotation and comparison of pathology data utilizing the mphasys ontology and visualization and analysis of animal data using the defined selection criteria. finally, the framework provides analysis tools that are accessible through a web-server.

data entry client application
in order to facilitate accurate collection of animal data, a data entry application was written which utilized the framework. the data entry application , was written in java and utilizes java web-start for distribution. the client application was designed around the animal model and the following steps in data collection: 1) study design and genotype definition, 2) entry of individual animals and generation of cage cards, 3) collection of life-span data , 4) collection and gross examination of organs by a prosector and 5) histopathological analysis of organ sections.

forms were designed for entering study protocol, meta-data and genotypes. the system relies upon ncbi gene as the basis for annotating genetic interventions and the database tracks an animal's allelic make-up. forms for annotating individual animals allow the entry of date of birth, sex, genotype, parental data and identifiers . once animals are entered into the system, cage cards may be generated that contain information about the animal, including identifying meta-data  and a barcode that can be used to quickly select the animal using the client. once an animal is selected, the application presents the user with forms for management and entry of life-span data, organ data  and histopathology. forms for entering life-span data  minimize keystrokes and are compatible with automated data entry equipment . forms for clinical observations, gross- and micro-pathology query the framework for relevant terms based on rules defined by the mphasys ontology. keystrokes can be used to quickly subset terms  and navigate through menus to select appropriate terms. the system displays only morphological terms and morphology-related qualifiers where appropriate to the selected organ.

data analysis and visualization
a significant motivation for the generation of mphasys is the ability to analyze and share data. in addition to the capabilities of the data entry tool for analysis of animal data, the framework was used to create web-based analysis tools to present and analyze data via a web-browser. animal data from multiple collection points can be entered into a single server running the web application and the data can be compared across studies. a user can define selection criteria for analyzing animal data and visualize the results within the application. using these criteria, the system can be used to visualize clinical variables for individual animals as a function of age or life span. charts are interactive and can be used to gain specific information about individual animals via tooltips.

image data
the framework has programmatic tools for uploading, annotation and display of histopathological images. images that are captured by histopathologists at the microscope can be loaded into mphasys through a the application, where they are associated with the individual animal and the pathological finding . images are presented through the web interface and automatically annotated with codes from the ontology.

access modes
finally, the application can be configured to either operate in a single- or multi-user environment. the single user mode  utilizes a local embedded hsqldb database while the multi-user mode accesses a stand-alone database server . use of a common database server allows for multi-user access to common animal data. studies can be exported and shared as mouseml documents, allowing investigators a method of integrating published data into their own analyses. when documents are shared and loaded, the application not only validates the data to ensure it is of the proper type, but will keep an audit trail of any changes made to existing data. for additional information on configuration of mphasys access modes, please see the online documentation  <cit> .

example: collection and analysis of wild-type and xpdttd mouse data
the mouse data used to illustrate the features and functions of mphasys were taken from a published study of aging-related pathologies in xpdttd mice  <cit>  and unpublished data. xpdttd mice harbor a hypomorphic mutation in the ercc <dig> gene that mimics the human disease trichothiodystrophy. these animals present reduced life-span and enhanced age-related pathology. data related to the wild-type and xpdttd animals were entered using the client application  and spreadsheet bulk-loading tools based on the framework . data collection through the forms-based client application offers a significant advantage over the more traditional spreadsheet-based data collection, in that there is a much lower chance for data corruption by accidental deletion/alteration or well-intentioned but deleterious reformatting by spreadsheet software.

using the web application or the data entry tool, selection criteria can be defined to select subsets of animals. selecting female xpdttd animals and their wild-type counterparts allows for analysis of their properties in the analysis modules by choosing genotypes and sex  or by building a logical expression . the charting tools demonstrate significant xpdttd-related changes in life-span and weight for the animals selected in this example  as reported in  <cit> . inspection of the weight charts indicates that a precipitous drop in weight is associated with death in wild-type animals, but generally not in the already underweight xpdttd animals. the charts also indicate that overweight animals tend to die at a younger age. the data visualization tools also allow direct inspection of individual animals for histopathological characteristics that may offer clues to their premature demise. for example, clicking on an animal in the web application takes you to the individual animal's record where histopathology can be inspected . choosing abnormally heavy animals for inspection would indicate, for example, that animals with high body weight are not associated with neoplastic pathologies. this report also presents an animal's weight in the context of its own genotype and sex for comparison. images that are associated with pathologies can be inspected for comparison. for example, uv micrographs of lipofuscin pigmentation of the liver were captured for xpdttd and wild-type animals, demonstrating an xpdttd-related increase in the deposition of the aging-related pigment lipofuscin  <cit>  .

future design goals
the extensible core of the mphasys framework provides a convenient mechanism for integration of biologically meaningful data. for example, molecular data, e.g. gene expression data, can be linked to the organs of individual animals to enable correlation of gene expression with specific pathologies. with a complete picture of how within an individual organism clinical, pathological and molecular variables interrelate, a broader, more extensible analysis will be attainable. mphasys will provide direct access to such primary animal data as well as new tools for data visualization, data mining and hypothesis generation.

for example, patterns of individual pathology can be mined using unsupervised classification in order to find age, genotype, and treatment related patterns of histopathology. these patterns can then be correlated with patterns of gene expression to propose questions about molecular processes and their involvement in aging and responses to dna damage.

CONCLUSIONS
we have developed a new computational platform that allows the collection of high-quality data from individual animals including their specific patterns of pathology in an ontology mediated protocol. this platform serves as the basis for tools for data capture and validation as well as analysis. mphasys utilizes a code-based ontology for collection of data as a tool for rapid and accurate collection of pathology data. as the tools for working with ontologies evolve and are incorporated into intelligent systems  or opencyc), data collected using mphasys will have adequate descriptions to be utilized. as more data from studies on these and other animals are obtained and used to populate mphasys, it will be possible to conduct in silico studies, test hypotheses and design new ones. the future integration of different types of data  on individual animals will generate more complete individual animal phenomic signatures that can be compared across experiments in a validated well defined format that can be shared with other investigators. comparisons can be made with animal phenomes from other studies, without the need to re-integrate legacy data into a new analysis. mphasys provides tools for data entry, analysis and dissemination of animal data. the data model is designed in such a way that other forms of data can easily be associated with individual animals.

availability and requirements
the mphasys application framework and client application are freely available and distributed under the gnu lgpl license  <cit> . it has been developed in the java programming language and requires a virtual machine of version  <dig> . <dig> or higher.

project name: mphasys

project home page: 

operating system: platform independent

programming language: java

other requirements: java  <dig> . <dig> or higher

license: gnu lgplv2

any restrictions to use by non-academics: none

authors' contributions
jv conceived and supervised the study, and obtained the funding for it. design and modeling by rbc, ism and phml. architecture and implementation by rbc. animal data, analysis and additional terms by rbb and hvs. all authors read and approved the final version of this manuscript.

