BACKGROUND
single nucleotide polymorphisms  are highly abundant markers which are evenly distributed throughout the genome and can be functionally relevant <cit> . they are suitable markers for fine mapping of genes and candidate gene association studies aimed at identifying alleles potentially affecting important traits. technologies that enable simultaneous analysis of thousands of snps have permitted genome-wide association studies for complex traits in humans  <cit> , chicken  <cit> , cattle  <cit>  and sheep  <cit> . additionally, reduced representation libraries and pyrosequencing technologies have facilitated the high throughput discovery of snps  <cit> . developing a large set of snp markers for genome analyses in rainbow trout will facilitate fine mapping of qtl and will improve the identification and exploitation of genes affecting important traits and enable selective breeding through genomic selection.

since  <dig>  the national center for cool and cold water aquaculture  has selectively bred rainbow trout broodstock for improvement of aquaculture production traits. the primary objectives have been to reduce the negative impacts of specifc bacterial pathogens on rainbow trout culture and to improve growth performance  <cit> . currently, additional economically important traits such as stress tolerance  <cit>  and meat/fillet quality are being evaluated. molecular genetic technologies have the potential of increasing the rate of genetic gain of traditional selective breeding schemes  <cit> . most production traits are controlled by multiple genes and inherited as quantitative traits. analysis of quantitative trait loci  to identify loci for use in marker assisted selection  strategies can be used to optimize genetic improvement of desired traits  <cit> . to this end the ncccwa is developing molecular resources for rainbow trout, including cdna and bac  libraries, microsatellite markers and a linkage map  <cit> . the map was based on a panel of five families that represent the starting genetic material of the selective breeding program. at present, the linkage map consists of  <dig>  microsatellite loci falling into  <dig> linkage groups, with an average sex distance of  <dig>  cm and an average resolution of  <dig>  cm. a recent linkage disequilibrium  study by rexroad et al.  <cit>  found significant ld blocks at distances of  <dig> cm or less, implying that, to be used in qtl mapping, there is a need of a larger number of markers to be included in the map.

expressed sequence tags  have been used for snp discovery in several non-model organisms, including salmonids  <cit> . however, when using est data for snp identification, the salmonid pseudo-tetraploid genome  <cit>  can lead to assemblies of paralogous sequences and false positive snp identification  <cit> . initially, we attempted an snp discovery approach based on alignments of ests. the genbank unigene build # <dig> http://www.ncbi.nlm.nih.gov/sites/entrez?db=unigene presents over  <dig>  rainbow trout est sequences. we first used custom bioinformatic pipelines to assemble the available ests and discover snps in rainbow trout. the occurrence of the genome duplication led to the assembly of paralogous sequences and resulted in a high number of false positive putative snps. next, we sequenced genomic dna based on est sequences which proved to be a more efficient method for snp discovery in rainbow trout, genomic dna sequencing would allow the representation of the entire genome, and not just the transcriptomes, as that is the case with ests. however, this procedure was also extremely time consuming and not suitable for high throughput snp discovery and it became clear that an alternative approach would be necessary to achieve the goal of a dense set of markers spanning the entire rainbow trout genome. in this study, we present the use of a high-throughput methodology to discover snps in rainbow trout based on pyrosequencing technology to generate data from a reduced representation library  constructed with genomic dna pooled from  <dig> unrelated rainbow trout individuals, and evaluate the efficiency of this approach.

RESULTS
construction of reduced representation libraries
restriction enzymes hpych4v and bstui did not entirely digest the rainbow trout dna, therefore, they were not considered for further procedures. trout dna of an individual animal was completely digested with alui, bstui and haeiii. in contrast with bovine dna <cit> , and similar to swine <cit> , repetitive dna bands were not observed when separating the fragmented dna in polyacrylamide gels with any of the three enzymes. the restriction enzyme haeiii  was selected for the library construction based on analysis of sequence data of  <dig> clones containing fragments from the approximately  <dig> bp size range: 94% of the sequenced fragments were unique and only 12% of the unique sequences matched other sequences when blasted against the ncbi salmonids nucleotide dna database, indicating acceptably low content of repetitive dna in the fragment pool.

after digesting the pooled dna from  <dig> unrelated individuals with haeiii, the  <dig> bp fragments were selected for library construction . an aliquot of the recovered fragments was cloned and sanger sequenced before proceeding with the library construction protocols: 89% of  <dig>  sequenced fragments were unique and 33% of the analyzed bases masked to the cgrasp salmon repeat masker database http://lucy.ceh.uvic.ca/repeatmasker/cbr_repeatmasker.py.

sequencing results and snp discovery
the genome sequencer flx system produces about  <dig>  reads  per run, therefore, to cover 1% of the trout genome and to achieve a 6× average coverage,  <dig>  runs were carried out, which resulted in  <dig> , <dig> reads that contained a total of  <dig> , <dig> bases for an average of  <dig> bp/read. the distribution of read lengths is rather asymmetric with a thick tail on the shorter side of the most common read length, which is  <dig> bp. after repeat masking, culling reads with less than  <dig> consecutive base pairs of non-repetitive content, and trimming repetitive ends, the result is  <dig> , <dig> reads with an average length of  <dig> bp. less than 15% of these reads contained internal repetitive content. the newbler assembly of the  <dig> million unmasked reads resulted in  <dig>  contigs with an average length of  <dig> bp and an average depth of coverage of  <dig> . one-quarter of the contigs covered the length of the restriction fragments by connecting the reads from each end that overlap sufficiently in the middle. the rest of the contigs had lengths consistent with the read lengths. the estimate of the number of loci given in table  <dig> counts each long contig as one locus and each short contig as half a locus. multiplying the estimated number of loci by the length of the restriction fragments indicates that  <dig>  million base pairs of the trout genome were represented in this study. for reasons described below, a second assembly of the reads was constructed using the velvet algorithm. the computational hardware available at the time did not allow an assembly of all the reads, but did enable an assembly of the smaller set of masked, culled and trimmed reads, resulting in  <dig>  contigs with an average length of  <dig> bp/contig and an average depth of coverage of  <dig> . only 9% of the contigs spanned the restriction fragments. using ssaha <dig> to compare the velvet and newbler assemblies showed that 77% of the velvet contigs matched  to newbler contigs.

in order to discover snps present only in non-repetitive regions, the set of masked reads were mapped onto the two assemblies, with 75% mapping to the newbler assembly and 63% mapping to the velvet assembly. both assemblies had similar distributions of coverage depth: ~40% less than 4×, ~10% greater than 10× and ~50% 4-10×. the average read depth at snps was skewed to the high end, ~9×. despite the similarities, the two methods discussed thus far produced widely different predictions for the number of snps:  <dig>  for newbler and  <dig>  for velvet. the distribution of the snps across the contigs reveals that the vast majority of snps in the newbler set came from contigs with  <dig> or more predicted snps. filtering out such snps from both sets leaves  <dig>  for newbler and  <dig>  for velvet. previous experience with snp discovery in swine using a reduced representation library showed a much more reasonable distribution of putative snps across the assembled contigs  <cit> . one of the two attempts to lower the high rate of false positives was to use velvet to create a different assembly. the other was to add an additional layering of filtering at the mapping stage . n <dig> predicted  <dig>  snps before filtering out the contigs with  <dig> or more snps and  <dig>  after applying the filter. results of the three analyses are summarized in table  <dig> 

a comparison of the snps from the three methods was done on a contig by contig basis, allowing for imperfect matches between velvet contigs and newbler contigs, as well as the occasionally varying numbers of predicted snps for the contigs. while compiling the lists of testable snps, some moderate filtering was performed to ensure sufficient quality and quantity of flanking sequence. as stated above, the two assemblies were more alike than different, yet the largest subgroup of snps is v <dig>  indicating that the contigs unique to the velvet assembly contain either a rich source of false positives or the best source of true snps. the next largest subgroup is n <dig>  despite the fact that most of its potential snps were filtered out due to their presence in contigs with 5+ snps. the false positives seem to be infiltrating the unfiltered contigs as well. the third largest subgroup contains the snps predicted by all three methods, giving some assurance that the three approaches are similar enough to warrant comparison of validation rates as a means to incrementally improve the computational methods for snp discovery. even though the reads mapped in n <dig> were a subset  of those mapped in n <dig>  n <dig> contained snps not predicted in n <dig>  these were from contigs that had  <dig> or more snps predicted by n <dig> but fewer than  <dig> predicted in n <dig>  snps from each of the subgroups were tested and the validation results are discussed in the next section.

snp validation
goldengate genotyping assays resulted in the validation of  <dig>  of the tested putative snps ;  <dig>  were homozygous;  <dig>  showed paralogous sequences without allelic variation . it was not possible to obtain satisfactory genotyping results from the remaining sequences , due to either unacceptable genotyping quality or the presence of paralogous sequences with allelic variation, therefore not conclusive to contemporary approach. table  <dig> shows the validation rates within each group of predicted snps, which gives an indication of the merits of each computational method. the three highest validation rates all involved velvet contigs, and three of the four lowest rates involved newbler contigs that did not have a velvet homologue, indicating that velvet built a superior assembly with the difficult trout genome. within the newbler assembly that did not overlap the velvet assembly, n <dig> produced better results than n <dig>  but within the contigs common to both assemblies, n <dig> performed better than n <dig> .

n <dig>  n <dig> and v <dig> represent snps predicted by only one of those three analyses; n1n <dig>  v1n <dig>  v1n <dig>  and v1n1n <dig> indicate snps predicted by multiple analyses. tested percentage refers to the number of markers in each group compared to all; the rate of validation within each approach is given as the validated percentage.

call frequencies; minor allele frequencies and expected/observed heterozygosis of the validated snps are reported in additional file  <dig>  call frequencies were higher than 90% for all markers and minor allele frequencies ranged from  <dig> % to  <dig> %. the double haploid samples were of great assistance for the validation process. both whale rock samples were monomorphic for all validated markers; skookumchuck, hot creek and swanson were polymorphic for only one marker  and klamath for three markers . the wga dna sample was successfully genotyped, 100% genotypes being equal to the original sample. using snapshot, four snps were cross-validated. genotyping results of the double-haploid fish were equal in both methods and 96% of the genotypes from the discovery samples were also equivalent.

blast analysis of the potential snp sequences revealed that  <dig>  are associated with  <dig> ests/tcs in the rainbow trout transcriptome . the validated snp sequences have  <dig> sequences associated with rainbow trout transcripts including proteins involved in lipocalin-type prostaglandin metabolism and immune system-toll-like receptors .

validated markers were also genotyped using the ncccwa mapping families and  <dig> markers were polymorphic and mapped to the rainbow trout second generation map <cit> . in additional file  <dig>  the position of the snp markers in the linkage map is indicated. the positions are based on the two-point distance of the snp markers to the closest linked marker in the map with the highest confidence in map location. the newly developed markers were distributed along all linkage groups of the rainbow trout map; there are at least two markers in each linkage group.

discussion
in our first attempts to find snps in rainbow trout we evaluated multiple bioinformatic pipelines for their ability to detect snps from est data . the occurrence of the genome duplication resulted in many assemblies of paralogous sequences, which led to the identification of a large proportion of false positives . in addition, a high number of the putative markers were not validated due to pcr amplification problems caused by incorrect assemblies of sequences; presence of introns in the amplicons and unspecific binding of primers . similar results were observed in other salmonid species  <cit>  and were attributed to the amplification of both paralogs of the same loci. a customized snp discovery process using only 3' ests was then developed, which used stringent assembly parameters  were set to overcome issues associated with the genome duplication. 3' est sequences were selected to avoid intron/exon boundaries; increase primer binding specificity and to raise the probability of finding snps in utrs. however, the results were not improved and no markers were validated. the next approach was to sequence genomic dna based on ests sequences, which proved to be an effective method of snp identification in rainbow trout. twenty putative snps were tested and  <dig> snps representing  <dig> different genes were validated on the double haploid samples;  <dig> of the validated snps were successfully genotyped on the  <dig> ncccwa broodstock unrelated individuals . however, this methodology is extremely time consuming and not suitable for high throughput snp discovery.

using a high throughput technology, over  <dig>  putative snps were identified,  <dig> were tested and  <dig> validated; 90% of the validated markers were placed and widely distributed in the rainbow trout linkage map. a blast analysis was performed to identify coding regions in validated snp sequences and 2% of the validated markers were associated with relevant genes. snps found within or near a coding sequence, are of particular interest because they are more likely to alter the biological function of a protein. this class of snps is especially important for species without a genome sequence such as aquaculture species. gene-associated snps serve as suitable markers for mapping in comparative genome studies and in mas of economically important traits  <cit> .

recent reports of using highly parallel sequencing methodologies in combination with reduced representation libraries  for snp discovery in cattle and swine reported validation rates above 92%  <cit> . these species do not have the complication of recent whole genome duplication that is a prominent feature of the salmonid genome, which resulted in the dramatically reduced validation rate of approximately 48% reported here. nevertheless, the rrl approach proved much more efficient than previous approaches used for trout snp detection, providing tens of thousands of putative snps at a fraction of the cost of generating them by pcr and sanger sequencing and in a much shorter time. future work will attempt to revise the method to more efficiently avoid the class of putative snps resulting from comparisons between paralogous loci, by sequencing rrl produced from a double haploid strain in parallel to the pool of discovery, diploid animals. additional gains may be made by refinement of filtering strategies by incorporating flanking sequence data more effectively, especially as developments in the pyrosequencing platform increase read lengths later this year permitting creation of rrl with longer fragments and increasing the ability to discriminate paralogs. we anticipate that future studies using rrl and pyrosequencing will approach the 90% success of other organisms, although we recognize that the tetraploid genome of rainbow trout will necessitate a much larger ratio of dna sequenced to valid snps discovered than in species with less complex genomes.

CONCLUSIONS
the use of reduced representation libraries and pyrosequencing technology proved to be an effective strategy for the discovery of a high number of snps in rainbow trout. over  <dig>  putative snps were discovered and  <dig> were tested, resulting in a 48% validation rate. a hundred and eighty three markers were validated and  <dig>  of those markers were polymorphic and placed in the rainbow trout linkage map. according to the validation results, it could be implied that at least  <dig>  putative snps from this data set would be validated and useful in future genomic studies. however, it is still necessary to dramatically decrease the false discovery rate.

