BACKGROUND
single nucleotide polymorphisms  are valuable markers for the construction of genetic and physical maps, genome sequencing, marker-assisted selection, and for other genetic and genomic applications. resequencing is the most efficient approach for a large scale, genome-wide snp discovery. for example, resequencing with the sanger sequencing technology using an annotated genome sequence as a reference has been an effective strategy for genome-wide snp discovery in low or moderately complex genomes  <cit> . compared to sanger sequencing, massively parallel sequencing technologies, such as the  <dig> gs flx instrument , solexa , and solid , offer high sequencing throughputs at greatly reduced costs. each of these sequencing platforms has its own set of advantages and disadvantages. roche  <dig> generates longer sequences  than solexa  or solid , but solid and solexa have higher throughputs than roche  <dig> with the same cost and time investment. greatly enhanced throughput at reduced cost and time investment is common to all next-generation sequencing  platforms and allows for deep genome coverage sequencing, a prerequisite for genome-wide snp discovery in the complex genomes of plants and animals.

many plants have large and complex genomes with a great abundance of repeated sequences. polyploidy, a frequent evolutionary strategy in the plant kingdom, further increases genome size and complexity. these attributes are common in the tribe triticeae, which includes such economically important plants as wheat, barley and rye. these features of the triticeae genomes present a formidable challenge to genome-wide snp discovery with ngs platforms, primarily because the abundance of highly repetitive sequences makes alignment and clustering of the short reads generated by some of the ngs platforms difficult.

strategies are available to ameliorate these difficulties. reduced representation libraries  include only a subset of sequences present in a complex genome. the rrl subset is then used for resequencing, sequence alignment, assembly, and snp discovery  <cit> . in plants, rrls have been used for snp discovery in maize  <cit> , rice  <cit> , soybean  <cit> , and common bean  <cit> . the use of cdna libraries for ngs is another and frequently used approach to reduce complexity, avoid repetitive sequences and target coding sequences for snp discovery. deep transcriptome resequencing with ngs platforms has been used for snp discovery in maize  <cit>  and the polyploid brassica napus  <cit> . while both strategies can dramatically reduce sequence complexity, each has limitations. for example, transcriptome sequencing ignores polymorphism in introns and other genic regions absent from mrna.

an undesirable feature of transcriptome resequencing for snp discovery is unavailability of potentially useful transposable element -derived polymorphisms. in contrast to snps embedded within repeated sequences , the junctions of neighbouring repeated sequences are potentially unique  <cit> , can be assayed  <cit>  and snps in them can be treated as single-copy markers. repeat junctions  are created by insertions of tes into each other, into genes, or into other dna sequences  <cit> . a high-throughput assay for rj markers has been reported  <cit> . because snps at rjs are dispersed over a whole genome, they are well suited for the construction of dense, genome-wide snp genetic maps. an important application of such maps is in the anchoring and the ordering of contigs of bacterial artificial chromosome  clones during the construction of physical maps or ordering of scaffolds during genome sequencing. to use rjs in snp discovery, dedicated annotations of ngs reads are required and relevant computational tools for rj identification have been developed  <cit> .

a genomic sequence serving as a reference has been the basis of genome-wide snp discovery utilizing ngs technologies. tremendous progress has been achieved in the development of algorithms and software tools for mapping short reads from different ngs platforms to a reference genome and then identifying variants between individual sequences and the reference genome sequences  <cit> . however only a few attempts have been reported utilizing ngs to discover snps when such a reference is unavailable  <cit> . a computational pipeline called dial  was recently released for the identification of snps between two closely related genotypes without the help of a reference genome sequence  <cit> . this tool first masks repetitive sequences and then clusters short reads from the genotypes. the clustered reads are assembled with a de novo assembler to identify variants. this tool can be used for the clustering of reads of genome and transcriptome sequences from roche  <dig> and solexa even with a shallow depth of genome coverage. however, the tool has been tested only on relatively low- or moderately-complex genomes. it does not allow snp discovery in repeat junctions and is applicable only to base-space reads, such as with roche  <dig> and illumina solexa, but is not applicable to the two-base encoded, color space solid reads.

we report here an annotation-based genome-wide snp discovery pipeline using ngs data for complex genomes without a reference genome sequence. in this pipeline, roche  <dig> shotgun reads with low genome coverage of one genotype are annotated to distinguish single-copy reads covering genes, repeat junctions and other sequences from repetitive sequences and paralogous gene sequences. the annotation dramatically reduces the complexity of the genomic sequences by removing undesirable sequences. resulting reads are assembled into sequence contigs if possible. the assembled roche  <dig> contig and singleton sequences mimic a reference sequence. shotgun short reads of another genotype with high genome coverage generated with the solid or solexa ngs platforms are then mapped to the annotated single-copy roche  <dig> reads/contigs to identify snps in single copy dna across the entire genome including repeat junctions. based on this strategy, the pipeline program package, agsnp, was developed and used for snp discovery between two accessions of ae. tauschii , the parents of the f <dig> mapping population used for the construction of an ae. tauschii genetic map  <cit> . aegilops tauschii contains the core genome of the triticum-aegilops alliance  <cit>  and is the diploid source of the wheat d genome  <cit> . its genome size is  <dig>  gb  <cit>  and 90% of its genome is composed of repetitive sequences  <cit> . it is also an important source of germplasm in wheat breeding and a diploid model for the wheat d-genome.

methods
next-generation sequencing
in order to test snp discovery efficiency in different sequencing platforms, three next-generation sequencing platforms  were used to sequence two ae. tauschii genotypes  . genomic dna of al8/ <dig> was sequenced using only the roche  <dig> whereas genomic dna of as <dig> was sequenced using all three ngs platforms. in addition, cdna of as <dig> was also sequenced using the abi solid platform to verify snps identified in genic regions.

 genome sizes were estimated based on the  <dig>  gb genome size of aegilops tauchii  <cit> .  the total size of the  <dig> bacs is  <dig>  mb.  only  <dig> bases were used for mapping.  genome coverage was estimated on the basis of average coverage depth of solid cdna reads mapping to al8/ <dig> shotgun reads.

to estimate sequencing error rates intrinsic to each platform and variant calling errors in different sequencing platforms, dnas of  <dig> ae. tauschii  bac clones were separately fragmented and shotgun sequenced with an abi  <dig> xl . these sanger sequences were used as a reference in the estimation of sequencing error rates. pooled dnas of the  <dig> ae. tauschii bac clones were sequenced on three platforms to depths ranging from  <dig> x for roche  <dig> to  <dig> x for solid .

roche  <dig> sequencing
preparation and sequencing of the  <dig> sequencing library was performed according to the manufacturer's instructions . in brief, ten micrograms of ae. tauschii genomic dna or pooled dna of  <dig> ae. tauschii bacs were sheared by nebulization and fractionated on agarose gel to isolate 400- <dig> base fragments. these were used to construct a single-stranded shotgun library that was used as a template for single-molecule pcr. the amplified template beads were recovered after emulsion breaking and selective enrichment. the genome sequencer flx titanium flows  <dig> cycles of four solutions containing either dttp, αsdatp, dctp and dgtp reagents, in that order, over the cell.

illumina solexa sequencing
the as <dig> library of genomic dna or the al8/ <dig> library of pooled dna of  <dig> bacs was quantified by analysis on an agilent bioanalyzer , using the instrument software to select a region comprising the main library peak. based on the calculated value, the library was applied to an illumina single read flow cell at  <dig> pm concentration and clusters were generated according to manufacturer's instructions. sequencing was carried out on an illumina genome analyzer gaiix for  <dig> cycles. two, version  <dig>   <dig> cycle, kits were used. data was generated following completion of the run using the illumina pipeline  <dig>  from the sequencing images. a phix control lane was used to generate phasing and matrix values that were then applied to the experimental samples for basecalling analyses.

abi solid sequencing
dna was isolated from nuclei of ae. tauschii accession as <dig> as described in dvorak et al.  <dig>  <cit> . a fragment library was constructed according to manufacturers' instructions using the applied biosystems fragment library construction kit . in brief,  <dig> ug of dna was sheared using the covaristm s <dig> system , the sheared dna was end-repaired, adaptors p <dig> and p <dig> were ligated to the end-repaired dna, and the dna was size-selected on a gel. the size-selected dna was nick translated and then amplified for  <dig> cycles to generate the fragment library. the fragment library was quantified using the agilent dna high-sensitivity kit on an agilent  <dig> bioanalyzer .

to construct a cdna library, ae. tauschii line as <dig> was grown in a solution culture containing  <dig> x hoagland solution and total rna was isolated from both roots and shoots according to manufacturer's instructions using the ambion rnaqueous kit and the ambion plant rna isolation aid . mrna was isolated from total rna according to manufacturer's instructions using the applied biosystems poly purist kit . the transcriptome library was constructed according to manufacturers' instructions using the whole trascriptome anaysis kit from applied biosystems . in brief, mrna was fragmented using rnase iii and size-selected. the size-selected rna was reverse transcribed, and the cdna size selected. the size-selected cdna was amplified using  <dig> cycles to create the transcriptome library. this library was quantified using the agilent dna high-sensitivity kit on an agilent  <dig> bioanalyzer . the root and shoot cdnas were combined.

templated beads were prepared from both the fragment library and the transcriptome library according to manufacturer's instructions using the epcr kit v. <dig> and the bead enrichment kit from applied biosystems  for solid <dig>  workflow analysis was done after the first round of templated bead preparation for each library according to manufacturer's instructions using the workflow analysis kit from applied biosystems  to check library quality and the amount of templated beads generated per epcr. an additional workflow analysis was done for both libraries after it was estimated that a sufficient number of templated beads were produced. templated beads were deposited on slides according to manufacturers' instructions using the bead deposition kit from applied biosystems . one full slide was run for the transcriptome library, while  <dig> full slides  were run for the fragment genomic library.

sequencing errors of ngs platforms and variant calling error
single read based sequencing errors
the single read sequencing error rate of the roche  <dig> gs-flx titanium platform was estimated by comparing the single read alignment of al8/ <dig> reads in a pool of  <dig> bac clones previously sequenced with the sanger method. because sanger bac sequences were based on the shotgun sequencing method they had a negligible error rate. alignments were obtained using blastn of roche  <dig> reads against  <dig> al8/ <dig> bac sequences. insertion and deletion , and single base substitutions were counted. the sequencing error rate was calculated as total erroneous bases divided by the total length in bp of roche  <dig> reads.

consensus-based sequencing errors
al8/ <dig> reads from roche  <dig>  solid or solexa were mapped to the  <dig> bac sequences generated by the sanger method using the bwa package  <cit>  at default parameters and consensus sequence of mapped reads were generated using samtools  <cit> . indel and single substitutions were counted by comparing sanger sequences and mapped read consensus sequences. a consensus sequencing error rate of a sequencing platform was calculated as the total erroneous bases divided by the total mapped bases.

variant calling errors based on roche  <dig> single reads as a reference sequence
al8/ <dig> reads from solid, solexa or roche  <dig> were mapped to roche  <dig> genomic contigs or singletons using the bwa package  <cit>  at default parameters. consensus sequences of mapped reads were generated using samtools  <cit> . the same method was used to count indel errors and single-base substitutions and to calculate variant calling error rates.

snp discovery pipeline
rationale and strategy
genome-wide snp discovery involves two basic steps:  the alignment of sequences of two or more genotypes and  variant calling in the aligned sequences. alignment of ngs on a reference genome sequence is called read mapping to the reference sequence. when a reference genome sequence is available, even short reads can be relatively easily mapped and aligned for the purpose of variant calling. in the absence of a genome sequence, long reads  from different genotypes can be clustered and aligned via multiple alignment algorithms  <cit> . difficulties emerge if no reference sequence is available, especially if only short reads generated by the solid or solexa sequencing platforms are available and genome is highly repetitive. in the strategy used here and similarly reported by hyten et al.   <cit> , the relatively long roche  <dig> reads are substituted for the reference genome sequence. roche  <dig> reads are annotated, i.e., they are classified on the basis of their sequence homology and copy number in the genome. single-copy sequences and unique repeat junction sequences are subsequently used as a reference sequence for the alignment of the solid or solexa reads and for snp discovery.

the following rationale is used to identify  roche  <dig> single-copy sequences. it is assumed that most genes are in a single-copy dose in a genome and sequences of duplicated genes are usually diverged to such an extent that most of their reads do not cluster together. therefore, the read depth  mapped to coding sequences of known genes estimates the expected read depth of all single-copy sequences in a genome. sequences showing greater read depth are assumed to be from duplicated or repeated sequences. to implement this rationale, shallow genome coverage by long roche  <dig> sequences is used to identify genic sequences by homology search against gene databases. multiple genome coverages of short solid or solexa sequences are then used to estimate the read depth of genic sequences in a population of solid or solexa reads. the estimate is in turn used to identify  the remaining single-copy roche  <dig> reads. this combination of roche  <dig> and solid or solexa platforms combines the long length of roche  <dig> reads with the high coverage of the solid/solexa sequencing platforms, thus reducing costs associated with the development of reference sequence, as already pointed out by hyten et al.   <cit> . short solid or solexa reads are mapped and aligned to the roche  <dig> reads and contigs with short-read mapping tools  <cit> . after the annotation of all sequences, snps are called and filtered.

annotation of roche  <dig> reads
the aim of read annotation is to classify the roche  <dig> reads on the basis of their homology and copy number. for annotation of a large volume of roche  <dig> shotgun reads from multiple runs, a substantial amount of time and computer resources is required. annotation was therefore divided into several steps, and a corresponding program was developed for each step. figure  <dig> and table s <dig> in additional file  <dig> show the annotation pipeline and the corresponding pipeline script programs, respectively.

pre-processing of roche  <dig> reads of ae. tauschii accession al8/78
the purpose of pre-processing of reads is to remove the chloroplast and mitochondrial sequences. blastn against complete wheat chloroplast and mitochondrial genome sequences  was performed at an e value of 1e- <dig>  a total of  <dig> , <dig> roche  <dig> reads of the al8/ <dig> genomic library were processed. after the removal of chloroplast and mitochondrial reads, artificial replicates of reads were filtered out using the cd-hit- <dig> program  <cit>  at 98% alignment identity and 90% sequence coverage. artificial replicates are intrinsic artifacts of 454-based pyrosequencing occurring in all currently available  <dig> technologies, leading to overpresentation of >10% of the original dna sequencing templates. those sequences start at the same position and are identical  or vary in length, or contain a sequence discrepancy  <cit> .

characterized-repeat annotation
the first annotation step is to identify reads of known  repeats. to extract all characterized repetitive reads, all possible plant repeat databases used in rjprimers  <cit> , including repbase <dig> , mips redat v <dig>   <cit> , the complete trep , the maize transposable element database  , and  <dig> tigr repeat databases  <cit> , were adopted to perform a blast search at an e-value of 1e- <dig>  the extracted characterized repeat reads were further annotated using the repeat junction annotation pipeline  to identify unique rjs, which are used for snp identification.

gene annotation
homology search against known genes is a fundamental approach to identify genes among the sequences generated. the reads remaining after removing repetitive reads were used to search for homology against databases of genes, proteins and unigenes in all species evolutionally related to the targeted genome, ae. tauschii, including the following: complete genome gene databases of brachypodium , rice    <cit> , sorghum , and maize; the unigene database of wheat , rice , sorghum , sugarcane , barley , maize  and arabidopsis ; the uniprot protein database , and the brachypodium protein database . an e value of 1e- <dig> was used for both blastn and blastx searches. reads related to transposable elements existing in protein or unigene databases were also removed. some unknown gene reads were further identified using solid cdna reads of as <dig>  mapping to the roche  <dig> reads of al8/ <dig> with the pipeline program . all known and uncharacterized gene reads of roche  <dig> were assembled at a higher stringency  using gsassembler  .

single-copy read annotation
after the removal of characterized and uncharacterized gene reads, the remaining roche  <dig> reads consist of uncharacterized repeats and other uncharacterized sequences, including introns, promoters, pseudogenes, unknown genes, and single-copy sequences in intergenic spaces. since many of these sequences are single-copy, they are desirable targets for snp discovery. they were identified on the basis of the rationale described above. solid or solexa reads of ae. tauschii accession as <dig> were mapped to known gene reads obtained in the gene annotation routine using the mapping pipeline . a depth frequency distribution of solid or solexa reads mapped to characterized gene reads approximates an extreme value distribution  <cit>  . this distribution is used to estimate the single-copy read depth of solid or solexa sequences. mean  and standard deviation  of mapped read depth are calculated from the fitted extreme value distribution. the x¯ + 2s of read depths is used as a cut-off value for single-copy sequences. if a read depth is < the cut-off value, the reads are considered to be single-copy sequences; if it is > the cut-off value, they are assumed to be repeated. for instance, the mapping of as <dig> solid genomic reads  to roche  <dig> characterized gene reads generated a depth distribution with an x¯ of  <dig>  and an s of  <dig>  . thus, the read depth cut-off value was  <dig> reads. roche  <dig> sequences with depth <  <dig> reads were considered single-copy. approximately 77% of characterized gene reads or 92% of assembled gene contigs/singletons were included in this single-copy class. remaining gene reads may be duplicated genes. reads from other sequencing platforms were separately mapped to known roche  <dig> gene reads and empirical distributions of mapped read depths were generated for each sequencing platform . a read depth cut-off value of  <dig> reads was used for solexa and roche  <dig> genomic reads . these cut-off values were used as a criterion for annotation of single-copy gene sequences and repeat junctions among the total reads produced by the various platforms for subsequent snp discovery.

snp discovery
the snp discovery procedure is diagrammed in figure  <dig>  reads mapped to roche  <dig> annotated contigs or singletons  were analyzed separately for the different sequencing platforms. the mapping tool bwa  <cit>  is employed because of its suitability for mapping either long reads such as roche  <dig> and sanger or short reads . all possible variants including insertions/deletions  and snps, are then called from aligned sequences using the samtools program  <cit> . because most sequencing errors in roche  <dig> arise from homopolymers that result in indel errors , short indel variants are considered erroneous if roche  <dig> sequences are used as a reference. therefore, only single nucleotide substitutions are considered snps in the pipeline.

snp filtering criteria
to filter out potentially false positive snps, additional filtering criteria are imposed on snps called by samtools in the pipeline program "snp_filter_pipeline.pl" . long roche  <dig> reads or contigs  are beneficial to primer design for snp genotyping. a minimum read depth of  <dig> reads is used to minimize false alignments of reads on the reference sequence. the mapped read depth cut-off value is a critical criterion to filter out snps located in repetitive sequence and paralogous genes. the consensus base ratio is the number of reads to the total number reads derived from a single dna source mapped to a reference sequence having a nucleotide that differs from the corresponding nucleotide in the reference sequence. if the consensus base ratio is  <dig> , there is a high confidence in the snp. if the ratio is <  <dig> , some reads have the same nucleotide as the reference sequence, and there is less confidence in the snp. such snps are either caused by heterozygosity of the dna source or by a sequencing error. thus, a highly stringent criterion  is imposed to exclude heterozygous loci or false positive snps due to alignment errors.

solexa:≤ 10
solid genomic reads: ≤ 50
two types of quality scores are used for reference sequences and mapped reads. a mapping quality score is provided by the bwa tool  <cit>  to measure the mapping quality of short reads aligned to a reference sequence;  <dig> is suggested for high quality mapping  <cit> . for the reference sequences , a snp base quality score  and a neighbourhood quality standard   <dig> base score  are applied which together can filter out over 70% of substitution sequence errors . homopolymer-induced sequence errors are the major error source in roche  <dig> sequencing, accounting for 85% of all errors. thus, all snps with the same base string longer than or equal to  <dig> bp are removed. in addition, if two snps are separated by  <dig> bp or less, then most of them are assumed to be caused by incorrect alignments or short reads mapped on a wrong reference sequence. those snps are also filtered out.

sequence quality deteriorates with the length of a roche  <dig> read. hence, there is less confidence in snps on the 3' end of a reference sequence than on the 5' end . therefore, the quality of bases is related to their relative location in a read . we found a significant correlation between base location in a read and number of error bases  in roche  <dig> sequences. the 3' end bases of a read have an increasingly higher error rate. thus, snps with ≤ <dig> bp on the 3' end of single reads or contigs are ignored.

in addition, illumina's goldengate or infinium assays require a minimum of  <dig> bp  of sequence on either side of each snp and a minimum of  <dig> bp between two contiguous snps. these requirements for illumina genotyping are optionally applied in the pipeline program.

more stringent snp filtering criteria are imposed for uncharacterized reads because most of them should be unknown low-copy repetitive sequences. we set the maximum mapped read depth cut-off to  <dig> reads instead of  <dig> for both roche  <dig> and solexa reads, and  <dig> instead of  <dig> for solid with the aim to eliminate snps in potentially low-copy repetitive sequences. in addition, reads with only one snp are retained.

all annotated al8/ <dig> single-copy gene-related sequences, rjs, and uncharacterized single-copy sequences were used as a reference sequence in mapping reads from roche  <dig>  illumina solexa and abi solid of ae. tauschii accession as <dig> . variants  were called using the read mapping and snp calling pipeline  with the bwa  <cit>  and samtools package  <cit> . all called variants from different sequencing platforms and dna sources  were merged and filtered using the snp filter pipeline program . all short indels were excluded and only high-quality snps were retained.

pcr validation
a total of  <dig> gene-related sequences,  <dig> repeat junction sequences and  <dig> uncharacterized sequences with at least one snp were randomly selected among the identified snps for pcr validation. primers flanking snps were designed with batchprimer <dig>  <cit> . dna targets in both ae. tauschii al8/ <dig> and as <dig> were pcr amplified. amplicons were sequenced using the pcr primers as sequencing primers with an abi  <dig> xl dna analyzer as described by choi et al.   <cit> .

RESULTS
estimation of ngs error rates
sequencing errors may potentially be an important source of snp errors, particularly since only  <dig> x genome equivalents of roche  <dig> sequences were used to construct the reference sequence. the single read error rate of roche  <dig> was estimated to be  <dig> %. single read error rates could not be estimated for the other two platforms because of short reads. consensus sequences generated from multiple read alignments can efficiently correct single read errors. consensus error rates of solexa and solid appeared to be similar  and lower than the roche  <dig> consensus error rate, which was  <dig> % . errors of roche  <dig> are primarily due to indels, which account for 75%-80% of all consensus sequence errors, while indel errors in solexa and solid reads accounted for 22% and 66% of all consensus sequence errors, respectively. after removing indel errors, the three ngs platforms appeared to have similar consensus base substitution error rates,  <dig> %,  <dig> %, and  <dig> % for solid, solexa, and roche  <dig>  respectively . the low base substitution rate error of the solid platform most likely reflected the di-base encoding and color space scheme in solid sequencing technology.

to estimate snp errors, a random half of roche  <dig> reads constructed for the  <dig> ae. tauschii bacs were used as references. then solid and solexa bac reads or another half of roche  <dig> bac reads were compared with roche  <dig> reference sequences. in this case, errors on both sides contributed to error rates. the consensus base substitution error rates were  <dig> %,  <dig> % and  <dig> % for solid, solexa and roche  <dig>  respectively . because snps with low quality scores  are filtered out in the snp filtering pipeline , ~70% of snp errors can be eliminated . therefore, much lower snp error rates are expected , about  <dig> % for solid,  <dig> % for solexa and  <dig> % for roche  <dig> .

annotation of roche  <dig> reads of ae. tauschii accession al8/78
a total of  <dig> , <dig> roche  <dig> reads was generated by shotgun sequencing of genomic dna of ae. tauschii accession al8/ <dig>  the average read length was  <dig>  bp and the genome coverage was  <dig> x genome equivalents. after removing chloroplast and mitochondrial reads ,  <dig> , <dig> reads were retained. a total of  <dig> , <dig> reads  was classified as artificial replicates detected with the cd-hit- <dig> software  <cit> . after their removal,  <dig> , <dig> reads were retained . blast searches against all available plant repeat databases  <cit>  characterized a total of 59% of these reads as repeat reads. among them,  <dig> % of repeat reads were identified as containing repeat junctions using the repeat junction annotation pipeline with rjprimers  <cit>  .

 number of reads after removing chloroplast and mitochondrial reads and artificial replicates using the cd-hit- <dig> program  <cit>  at 98% alignment identity and 90% of sequence coverage.  repeat junctions are identified from characterized repeat sequences using the repeat junction annotation pipeline program .

after removing characterized repeats, gene annotation was performed. a total of  <dig>  gene-related reads were detected, which is  <dig> % of a total of  <dig> , <dig> reads . in order to identify unknown gene reads, solid cdna reads were mapped to the roche  <dig> reads. a total of  <dig>  unknown gene reads  were obtained. combined with characterized gene reads,  <dig> , <dig> reads were gene-related reads, accounting for  <dig> % of the total reads. thus, both gene and repeat reads accounted for  <dig> % of the total reads. the remaining  <dig> % were uncharacterized reads, which contained single-copy and multi-copy reads. single copy read prediction was comparable on different sequencing platforms. using the single-copy read prediction method,  <dig> ,  <dig>  and  <dig>  single-copy reads were identified in roche  <dig> reads of al8/ <dig> with solid, solexa, and roche  <dig> genomic reads of as <dig>  respectively . contingency χ  <dig> tests showed that despite low genome coverage of solexa or roche  <dig> reads, the single-copy prediction method yielded comparable numbers of single-copy reads. a total of  <dig>  of the  <dig> x roche  <dig> reads were predicted to be single-copy gene reads,  <dig>  reads were rjs and  <dig> , <dig> reads were single-copy reads from uncharacterized regions .

 number of roche  <dig> contigs to which reads generated with an indicated platform and solid were mapped.  the coverage estimate is the average depth of sequences mapped to roche  <dig> contigs.

genome-wide snp discovery and characterization
snps were discovered with the snp discovery pipeline using the predicted roche  <dig> single-copy reads in genes, rjs and uncharacterized regions as a reference sequence . a total of  <dig>  snps were discovered in gene regions, which included  <dig>  and  <dig>  snps in characterized and uncharacterized gene regions, respectively . in addition,  <dig>  snps were discovered in repeat junctions and  <dig>  in uncharacterized regions . relatively more snps were in repeat junctions  than in genes . the snp frequency in uncharacterized regions cannot be compared with those in repeat junctions and genes because more stringent criteria were applied to snp discovery in those regions .

of the  <dig>  snps in characterized genes,  <dig>  snps were in gene sequences that showed blast homology to  <dig>  different wheat unigenes,  <dig>  to rice genes, and  <dig>  to brachypodium distachyon genes, covering a total of  <dig>  different genes. a total of  <dig>  snps were in sequences homologous to  <dig>  bin-mapped wheat ests with an average of  <dig> snps per bin and a standard deviation of  <dig> snps. sequences with  <dig>  snps were homologous to genes in the brachypodium genome yielding  <dig> snps per mb of the brachypodium genome. sequences harbouring  <dig>  snps were homologous to genes in the rice genome yielding  <dig> snps per mb of the rice genome. gene sequences harbouring snps in ae. tauschii were distributed across the entire rice genome , suggesting that those snps were also distributed cross the entire ae. tauschii genome.

different ngs platforms and dna sources can be used for snp discovery . the snp discovery pipeline contains two major steps implemented in two separate programs : read mapping and snp calling , and snp filtering . the read mapping and snp calling are performed separately for data of each individual sequencing platform. however, the snp filtering procedure can use either merged snps called from all available platforms or snps called from one sequencing platform at a time. in this study, we performed snp discovery from sequences of three ngs platforms. if the merged snps called from three sequencing platforms were used for snp filtering, a total of  <dig>  putative gene-related snps were obtained, but if snp filtering was carried out separately for each sequencing platform, only a total of  <dig>  putative gene-related snps  were detected , suggesting that combining sequence data from multiple ngs platforms will help increase snp discovery rate. this is because for many sequence regions, the mapped read depth was low  in a single sequencing platform and no snps can be called according to the snp filtering criteria. merged alignment data from several sequencing platforms increased mapped read depth and thus more snps can be identified.

 three different sequencing platforms  and two dna sources  were used in snp discovery. snps were counted by combinations of sequencing platforms and dna sources or individual sequencing platform/dna sources.  genome coverage in parentheses was estimated from the length of mapped gene reference sequences and mapped read depths .  if snps were filtered by merged snps from three sequencing platforms, the total number of snps and reference sequences with at least one snp are  <dig>  and  <dig> , respectively. because the same snps may be discovered by both cdna and genomic reads, or by more than one sequencing platforms, the sum of snps in grouping by single sequencing platform or dna source exceeds the actual number of snps. the difference will be the number shared by two dna sources or multiple sequencing platforms. the same is true for number of reference sequences and percentage values in the table.  if snps were filtered by individual sequencing platforms , the total number of unique snps discovered and reference sequences with at least one snp were  <dig>  and  <dig> , respectively. for the same reason as , the sum of snps discovered by single sequencing platform or dna source exceeds the actual snps.

the varying numbers of snps were discovered with different ngs platforms because of their varying genome coverage . genome coverage of reads was significantly correlated with the numbers of snps discovered with a ngs platform .

the same snps identified by two or more sequencing platforms account for  <dig> %  of all putative gene-related snps . the percentage of the same snps identified by two sequencing platforms should be associated with overlapping percentage of reads between two sequencing platforms, which depends on genome coverage of reads obtained from sequencing. simulation results showed that if the percentage of the same snps in two sequencing platforms is  <dig> %, the overlapping percentage of reads generated from two sequencing platforms must be over 12%. if this overlapping percentage reaches to 80%, the percentage of the same snps will be 79% . twice as many snps were identified using solid sequencing of genomic dna than cdna, which is not surprising since snp discovery in cdna is limited by the number of genes sampled by the cdna library.

validation of ae. tauschii snps
in order to assess the veracity of discovered snps and estimate false-positive snp discovery rate,  <dig> gene sequences with at least one snp were randomly chosen from snp reference sequences with a dataset of  <dig>  gene-based snps used for illumina infinium genotyping . snp flanking primers were designed with batchprimer <dig>  <cit> . only  <dig> of  <dig> primer pairs generated pcr products in both al8/ <dig> and as <dig>  failure to amplify target dna by some primer pairs was primarily due to unoptimized pcr conditions which was confirmed by using the optimized pcr conditions in the second run of pcr amplification for one plate of these primers. the products were sequenced with an abi  <dig> xl and sequences were aligned. the  <dig> aligned regions were expected to contain  <dig> putative snps discovered with the pipeline, of which  <dig> snps were present. hence, the snp validation rate was 84%. of  <dig> false positive snps,  <dig>  were due to solid or solexa consensus sequencing errors or to incorrect alignments and only  <dig> snps  were due to roche  <dig> sequencing errors .

 only loci with pcr products and sanger sequences in both ae. tauschii accessions  were included in the table. one primer pair for each locus was designed for pcr amplification.  since some snps were identified by more than one sequencing platform, the total numbers of snps therefore exceed  <dig> 

a total of  <dig> rj sequences were randomly chosen from the predicted single-copy rj sequences with a snp within  <dig> bp of rj location. target dna at  <dig> rj sequences did not amplify in pcr. of the remaining  <dig> rj targets,  <dig> amplified either only the al8/ <dig> dna target  or had no alignments in the snp locations  reflecting diversity between al8/ <dig> and as <dig> in repeated sequences. the remaining  <dig> rj targets could be amplified in both dnas and were expected to contain  <dig> putative snps in the aligned regions. of these  <dig> putative snps,  <dig>  were present . the snp validation success rate in rjs was similar to that in gene sequences, showing that single-copy rjs are a productive source of useful snps.

similarly snps discovered in uncharacterized sequences were also verified. a subset of  <dig> uncharacterized sequences were randomly sampled from the reference sequences with  <dig>  uncharacterized snps. out of  <dig> sequences,  <dig> sequences did not amplify in both accessions  and  <dig> sequences amplified only in one of two accessions or their target sequences had no alignments in the snp locations. the high failure rate of pcr amplification is likely due to diversity between al8/ <dig> and as <dig> in uncharacterized regions because most of snps in uncharacterized sequences should be located in non-coding regions. the remaining  <dig> sequences amplified in both dnas were expected to have  <dig> putative snps in the aligned regions. of these  <dig> putative snps,  <dig>  were validated . the snp validation rate in the uncharacterized regions was slightly lower than that in gene and rj sequences.

snp validation rates associated with individual ngs platforms were assessed . solid and solexa had similar snp validation rates . validation of putative snps discovered by mapping roche  <dig> reads to roche  <dig> reference sequence revealed a 71% snp validation rate. the most likely cause of the lower rate associated with roche  <dig> was the shallow depth of roche  <dig> read mapping.

a set of snps between ae. tauschii accessions al8/ <dig> and as <dig> was previously discovered by sanger sequencing of single-copy genes  <cit> . a total of  <dig>  snps located in  <dig> genes were genotyped with the illumina goldengate snp assays and mapped on an ae. tauchii genetic map  <cit> . of the  <dig> genes,  <dig> shared sequence with ngs genic sequences generated here. there were  <dig> snps in these  <dig> genes, of which  <dig>  were shared by both data sets, indicating they can be genotyped with illumina goldengate assays and mapped.

discussion
annotation-based genome-wide snp discovery pipeline, agsnp
we report here the development of a pipeline for large-scale, genome-wide snp discovery in large and complex genomes with ngs platforms. this pipeline does not require a reference genome sequence, and its utility is illustrated using the  <dig>  gb genome of ae. tauschii. the large volume of ngs data that must be processed places great demands on computer resources. the pipeline was therefore split into multiple sub-pipelines to perform individual tasks and accomplish its two principal objectives. the first objective is the assignment  of roche  <dig> reads of a single genotype to three categories:  characterized gene reads,  characterized repeats, and  uncharacterized reads. the second objective is predicting single-copy reads and identifying the putative snps by mapping multiple genome equivalents of solid, solexa or roche  <dig> reads to the annotated, single-copy roche  <dig> reads. the use of single-copy reads in the reference sequence dramatically reduces data processing and computation time to a manageable amount during the snp discovery phase.

an asset of the pipeline is that it employs computational tools for read mapping and snp calling that are applicable to any ngs platform. the pipeline is consequently of a universal utility with the existing and future ngs platforms. the roche  <dig> platform used here to generate long reads for the construction of the reference sequence can be replaced by any platform that produces reads of a comparable or greater length, particularly if it would have higher throughput than the roche  <dig>  flexible and stringent snp filtering criteria implemented in the pipeline result in the discovery of large numbers of snps and low false-positive snp rates. a total of  <dig>  snps was identified, of which  <dig>  were in genes. snps in genes had an 84% validation rate, those in rjs had an 88% validation rate, and those in uncharacterized sequences had 81% validation.

in the pipeline, a reference sequence of relatively shallow genome coverage of one genotype is compared with reads of another genotype with deep coverage. the latter reads can be short, and although any of the current ngs platforms can in theory be used, the overriding requirement is that the platform has a very high throughput to minimize sequencing costs. this requirement is particularly critical for large and complex genomes, such as that of ae. tauschii or related wheat.

the pipeline can be used to discover snps in both genomic dna and cdna. because genomic dna is more complex than most cdna resources, more than twice as many snps were identified in genomic dna than cdna here. genomic dna is therefore preferable for snp discovery over cdna. even for a genome as large as that of ae. tauschii, only  <dig>  runs with the solid v <dig> were needed to generate a sufficient number of genomic reads to control error during snp discovery. a single run of solid v <dig> would be needed to achieve the same coverage. an additional disadvantage of using data of cdna alone, in addition to the labour associated with the construction of a cdna library, is that it does not facilitate the annotation of uncharacterized single-copy sequences in the reference sequence; only genes can be used for snp discovery. therefore, the use of cdna for snp discovery limits the total amount of dna used for snp discovery and hence the total number of snps discovered.

another advantage of using genomic dna for snp discovery is access to rjs, which are an important source of polymorphisms. snps were  <dig>  times more frequent per kb in rj than in genic regions, while having equally high validation rate. higher polymorphism in rj makes them particularly valuable for plants with generally low levels of snp. the rjprimers program used in one of the sub-pipelines in the agsnp pipeline, facilitates the identification of single-copy repeat junctions. snps in repeat junction regions can by genotyped in a high-throughput mode, e.g., with illumina's goldengate assay  <cit> , which makes them a valuable marker system.

error sources during snp discovery with ngs platforms
errors in snp discovery have two major sources:  sequencing errors and  errors in mapping of short reads to roche  <dig> reference sequence. the sequencing errors for ngs platforms are less than 1%. the vast number of sequencing errors in all three ngs platforms is indels  <cit> . filtering indels and homopolymers and the use of multiple genome equivalents can reduce sequencing error rate  <cit> . the base substitution error rates in consensus sequences of solexa and solid were very low, about four bases in  <dig> . the combined error rate of the roche  <dig> reference sequence and mapped reads were  <dig> %,  <dig> % and  <dig> % for solid, solexa, and roche  <dig>  therefore, since sequencing errors are an insignificant source of false-positive snp rates, the major source of snp errors is mapping errors. the use of single-copy reads in the pipeline helps to reduce those errors.

the validation rate of rj snps  was as high as that of gene snps . all rj snps used for validation were randomly selected from a set of the predicted single-copy rj sequences with a snp within  <dig> bp of rj locations, which are illumina genotyping-ready. previous study indicated that in the illumina goldengate genotyping assays the success rate was higher when a repeat junction was in the vicinity of the target snp as compared with rj snps without a repeat junction  <cit> . rj snps in vicinity of repeat junctions must also have a high snp validation rate and should therefore be selected as a first priority for rj snp markers.

the 84%, 88% and 81% snp validation rate for genes, rjs and uncharacterized regions achieved here with genomic dna is comparable to that reported by others with ngs of cdna libraries; an 83% snp validation rate was reported for eucalyptus grandis cdna sequenced with roche  <dig>  <cit> , an 85% validation rate was achieved in maize cdna sequenced with roche  <dig>  <cit> , and an  <dig> % validation rate was reported in brassica napus cdna sequenced with solexa  <cit> . our validation rate was somewhat lower than those reported for snps discovered in rrl. validation rates of 79%- <dig> % were reported in soybean rrl sequenced with solexa  <cit> ,  <dig> % and  <dig> % validation rates were respectively reported in rice and soybean rrl sequenced with solexa  <cit> , and an 86% validation rate was reported for rrl library in common bean sequenced with a combination of roche  <dig> and solexa  <cit> . however, complete reference genomes were used in those snp discovery projects. in addition, none of these genomes is equal in size and complexity to the genome of ae. tauschii, which underscores the general utility of the agsnp pipeline, its high snp discovery rate, and its particular utility for snp discovery in large and complex genomes, such as those of many plants.

snp discovery in ae. tauschii
a total of  <dig>  snps in genes and  <dig>  snps in repeat junctions were discovered in this study. the snp frequencies were one snp per  <dig> bp for genes, and one snp per  <dig> bp for repeat junctions, respectively. repeat junctions have a higher snp frequency than genes, which is consistent with the results from paux et al.   <cit> . but this is still lower than the frequency observed previously in coding regions of wheat with ranges from one snp per  <dig> bp  <cit>  to one snp per  <dig> bp  <cit> , or in the coding region of ae. tauschii with one snp per  <dig> bp  <cit> . in the genic regions of ae. tauschii, nucleotide polymorphism was estimated to be  <dig>  × 10- <dig>  <cit> , which is equivalent to one snp every  <dig> bp between two randomly selected haplotypes. the expected snp frequency in genes is therefore at least  <dig> -fold higher than that obtained in the snp discovery here . taking into account the fact that the accession al8/ <dig> and as <dig> were not selected in random - they were selected because they differed greatly on the basis of rflp  <cit>  - the number of snps discovered in this project, although very high, is fully realistic for these two accessions.

several major factors impact genome-wide snp discovery in the ae. tauschii genome using next generation sequencing and account for the fact that only about one half of genic snps expected were discovered.  low genome coverage  of roche  <dig> sequences of one genotype al8/ <dig> was used as reference sequences. according to simulation results from  <dig> ae. tauschii bacs , ~70% of gene sequences are covered at ~ <dig> x genome coverage of roche  <dig> reads. at least 3x coverage genome equivalents are required for over 90% coverage of gene sequences .  the second factor is genome coverage of mapping reads sequenced in another genotype . the total number of discovered snps is significantly correlated with genome coverage of mapping reads . increasing genomic coverage of mapping reads can increase coverage percentage and mapped read depth to a reference sequence, resulting in the increase in snp discovery rate.  the last factor, which is of general significance, is the number of diverse lines used for snp discovery. in this study, only two genotypes were used. simulation results with simplified assumptions showed that over 90% of expected number of snps can be discovered when more than  <dig> genotypes are sequenced . this fact should be taken into account in projects targeting species-wide snp discovery.

CONCLUSIONS
we demonstrated here that high numbers of genome-wide snps can be discovered by sequencing total genomic dna of a complex genome with ngs platforms without a reference genome sequence. using the agsnp pipeline,  <dig>  putative snps in genes,  <dig>  putative snps in repeat junctions and  <dig>  putative snps in uncharacterized reads were discovered in genomic sequences of two accessions of ae. tauschii. the snp validation rates obtained here were comparable to those obtained with the cdnas of less complex plant genomes. the strategy described here and the associated pipeline yielded more snps while being otherwise comparable to cdna or rrl approaches.

availability and requirements
project name: annotation-based genome-wide snp discovery pipeline

project home page: http://avena.pw.usda.gov/wheatd/agsnp.shtml

availability: freely available

operating systems: linux

programming language: perl and java

other requirements: bwa, samtools, gsassembler , cd-hit-454

license: gnu pgl

any restrictions to use by non-academics: none

authors' contributions
fmy, yqg, mcl, dl, pem, jd, and oda planed the work. nh and yqg performed roche  <dig> sequencing and krd, mcl, and jd performed solid sequencing. solexa sequencing was performed in uc davis genome center. nh, yqg, and krd performed bac sequencing with the sanger method. fmy performed pipeline development, data analysis and snp discovery. nh and yqg performed snp validation. fmy and jd drafted the manuscript. all authors read and approved the final draft of the manuscript.

supplementary material
additional file 1
supplementary tables and figures. the file contains table s <dig>  figure s <dig>  s <dig> and s <dig>  table s <dig> lists all pipeline scripts for annotation-based snp discovery. figure s <dig> shows the relationship of percentage of the same snps identified by two ngs platforms with overlapping percentage of reads generated between two ngs platforms. figure s <dig> presents gene coverage of ngs reads with different genome coverage of ngs reads and with different sequencing platforms. figure s <dig> depicts the relationship of the number of detected snps with the number of genotypes used for snp discovery.

click here for file

 acknowledgements
this work is supported in part by us national science foundation . authors thank charles m. nicolet for performing solexa sequencing and dawei lin and joseph fass for their collaboration in the physical mapping project.
