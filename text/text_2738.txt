BACKGROUND
for appraising evolutionary significance of variable protein-coding sequences among diverged species in a quantitative fashion, one of the powerful tools is to compute nonsynonymous and synonymous substitution rates, termed as ka and ks, respectively  <cit> . since ka and ks represent the numbers of substitutions per nonsynonymous and synonymous site, respectively, these parameters  are used to partition the targeted sequences into three basic scenarios: negative  selection when ka < ks , positive  selection when ka > ks , and neutral mutation when ka = ks .

approximate methods for estimating ka and ks normally involve three steps: numbering synonymous  and nonsynonymous  sites, counting synonymous  and nonsynonymous  substitutions, and correcting for multiple substitutions. over the past two decades, several methods have been developed  <cit> , which are based on different mutation  models with subtle yet significant differences  <cit> . among them, yang and nielsen made a valuable attempt to consider differences among transitional and transversional substitutions as well as codon frequency bias  <cit> , and their method , based on the more realistic hky model  <cit>  and implemented in paml , has become increasingly popular in the field of molecular evolution studies. however, it does not exclude the possibility that methods based on simpler models have some favorable properties  <cit> . there are always tradeoffs between incorporating more features into models and avoiding over-parameterization for more accurate captures of evolutionary information  <cit> . in this report, we propose an improved method, a modified yn algorithm or myn, based on the tamura-nei model, in which transitional changes  are not assumed to occur with an equal frequency  <cit> . we also review the basics involved in estimating ka and ks , explain differences between the two methods, and provide our comparative results as an in-depth evaluation for the new method.

RESULTS
to compare the performance of yn and myn, we need to generate simulated and empirical datasets with careful considerations on possible features in evolution of diverged protein-coding sequences, such as biases in transitional rates and codon frequencies. we simulated hypothetical common ancestral sequences according to codon frequencies that were derived from three basic datasets:  equal codon frequencies ,  human codon frequencies , and  rice codon frequencies . we used the formula 100% × / to calculate percentage errors for assessing relative biases between estimated and expected values.

consistency analysis
we first used a set of data that collectively contain  <dig> million codons, assuming that a good approximate method should not deviate too far from the real value with near infinite amount of data  <cit> . although the selective strength, reflected in ω, differs from gene to gene, some representative values can be set based on analyses of empirical data; we use ω =  <dig> ,  <dig>  and  <dig> as such values for negative, neutral, and positive mutations, respectively  <cit> . we fix t =  <dig>  for the initial analysis and the effect of t is examined later. since genuine values for κ often range from  <dig>  to  <dig>  we take  <dig>  as a representative one. considering that myn differentiates κy from κr, we always fix one of them to  <dig>  and allow the other to vary from  <dig> to  <dig>  we plotted percentage errors for ω between data generated with yn and myn against κr  for different expected values, using the three codon frequencies from our test datasets . similar results are readily obtained for fixed κr and variable κy .

different codon frequencies have minor influence on the performance of yn and myn. ignoring the difference between κr and κy, yn gives estimates close to the expected values only if κr ≈ κy. for instance, when κr =  <dig>  the percentage errors for ω calculated with yn under human codon frequencies are  <dig> %,  <dig> %, and  <dig> % when ω =  <dig> ,  <dig>  and  <dig>  respectively . when κr ≠ κy, yn gives rise to obviously biased ω; it tend to underestimate ω when κr < κy and to overestimate ω when κr > κy. the percentage errors for ω =  <dig> ,  <dig>  and  <dig>  when human codon frequencies are used, are - <dig> %, - <dig> % and - <dig> % when κr =  <dig>  and are  <dig> %,  <dig> %, and  <dig> % when κr =  <dig>  respectively. compared to yn, myn appears to produce lower percentage errors in ω estimations in most cases. when κr ≈ κy, myn performs in a similar way as yn .

we also compared yn and myn in ks estimations. we took a similar approach as what tzeng and co-workers used to evaluate the expected values of ks  <cit> . we plotted percentage errors of ks against κr  based on human codon frequencies, showing similar results when taking equal or rice codon frequencies . yn and myn give similar estimates of ks when κr ≈ κy. when κr =  <dig>  the percentage errors of the estimated ks generated by yn and myn are - <dig> % and - <dig> % for ω =  <dig> , - <dig> % and - <dig> % for ω =  <dig>  - <dig> % and - <dig> % for ω =  <dig>  respectively. yn tends to overestimate ks when κr < κy and to underestimate ks when κr > κy and the bias becomes serious with increasing κr. myn sometimes gives rise to larger biases than yn when κr < κy, but it overall performs better for most of the parameter combinations tested, especially when κr > κy.

effects of κr and κy
we examined the effects of κr and κy with a set of simulated sequences, three ω values , and two t values . we considered the case of κr ≥ κy and four parameter sets:  κr =  <dig> and κy =  <dig> ,  κr =  <dig> and κy =  <dig> ,  κr =  <dig> and κy =  <dig>   κr = κy =  <dig> . to avoid stochastic errors, we generated  <dig>  pairs of sequences with  <dig> codons each for all the tests. we only described the results when human codon frequencies were used since similar results were obtained for equal or rice codon frequencies. the average estimates of ka, ks, and ω were computed with yn and myn as well as expected values of ka and ks .

note: the values were averaged over  <dig>  pairs of simulated sequences that each had  <dig> codons.

without considering the difference between κr and κy, yn produces minor bias when κr = κy, and underestimates ks and overestimates ω when κr > κy. myn is less biased compared with yn for most parameter combinations. the results agree with the infinite data test for consistency. for example, when κr > κy, yn gives positive values for ω and negative values for ks in percentage errors for the infinite data. as a result, it overestimates ω and underestimates ks for sequences with normal length such as  <dig> codons albeit far from dramatic.

effect of t
we let t vary from  <dig>  to  <dig> to evaluate its effect. we again used the human codon frequencies for simulations , and tested three different parameter combinations:  ω =  <dig> , κr =  <dig> and κy = 1;  ω =  <dig>  κr =  <dig> and κy = 1;  ω =  <dig>  κy =  <dig> and κr =  <dig>  we plotted average estimates of ω with yn and myn against t for the parameter combinations .

both yn and myn have a nearly parallel overall trend when t varies from  <dig>  to  <dig> but myn deviates less from the expected values. they both tend to overestimate ω for purifying selection and to underestimate ω for positive selection, whereas t has little influence on ω for neutral mutation. yn overestimates ω when κr > κy and underestimates ω when κr < κy, which is consistent with those found in the infinite data test. myn tends to overestimate ω for the expected ω =  <dig>  and this overestimation becomes severe with increasing t, but it is relatively subtle when compared to yn. when ω =  <dig> and  <dig>  myn gives closer ω estimates than yn over most of the parameter combinations.

effect of sequence length
to examine the effect of variable protein length , we took the human codon frequencies,  <dig>  pairs of sequences for each case, and two sets of parameters for the analysis:  ω =  <dig> , κr =  <dig>  κy =  <dig>  and t = 1;  ω =  <dig>  κr =  <dig>  κy =  <dig>  and t =  <dig> . we calculated the average ω estimates when numbers of codons vary from  <dig> to  <dig>  for the simulated sequences . yn and myn both give larger biases for short sequences . despite the fact that yn and myn do not perform satisfactorily when target sequences are rather short, myn is less biased than yn for most of the parameter settings.

note: the parameters used were κr =  <dig>  κy =  <dig> and t =  <dig> for purifying selection , and κr =  <dig>  κy =  <dig>  and t =  <dig>  for positive selection . the ω values were averaged over  <dig>  pairs of simulated sequences.

testing real data
we collected three orthologous datasets from ncbi homologene database :  <dig>  pairs of human-mouse,  <dig>  pairs of human-dog, and  <dig>  pairs of mouse-rat. for a more comprehensive display, we examined the cumulative percentage of κr - κy , emphasizing different transitional substitutions with unequal frequencies. for instance, the cumulative percentages for κr - κy >  <dig> for human-mouse, human-dog, and mouse-rat orthologs are  <dig> %,  <dig> %, and  <dig> %, respectively, and those for κr - κy < - <dig> are all approximately 15%. the rest, for | κr - κy | ≤  <dig>  are  <dig> %,  <dig> %, and  <dig> % for the three ortholog groups, respectively.

to evaluate the performance of myn, we compared a set of values  generated with three other selected methods in a similar way, considering κr - κy >  <dig>  κr - κy < - <dig>  and | κr - κy | ≤  <dig> . other than yn, we used another approximate method developed by li  and by pamilo and bianchi  independently , and a maximum likelihood method proposed by goldman and yang  . despite the fact that all four methods yield similar ka estimates, they do show some differences in other parameter settings. as a whole, lpb tends to overestimate ω and to underestimate ks when compared to myn. gy performs similarly as yn does since both consider transition/transversion rate bias and nucleotide  frequency bias. for instance, if κr - κy < - <dig>  both methods, compared to myn, underestimate s% and ω, and overestimate ks as we have demonstrated in the simulation studies. in the case of | κr - κy | ≤  <dig>  yn and myn work in a similar way. when confined to κr - κy >  <dig>  gy and yn both overestimate s% and ω, and underestimate ks, compared to myn. taking the ks estimates as an example, they are  <dig>  and  <dig>  for human-mouse orthologs,  <dig>  and  <dig>  for human-dog orthologs, and  <dig>  and  <dig>  for mouse-rat orthologs, calculated with yn and myn, respectively. similarly, the estimated ω with yn and myn are  <dig>  and  <dig>  for human-mouse orthologs,  <dig>  and  <dig>  for human-dog orthologs, and  <dig>  and  <dig>  for mouse-rat orthologs, respectively.

note: the values were calculated from concatenated sequences according to the three scenarios of κr and κy. the methods compared in addition to yn and myn were lpb, an approximate method developed by li  and by pamilo and bianchi  independently, and gy, a maximum likelihood method proposed by goldman and yang . when gy was used, codon frequencies were calculated from nucleotide frequencies of three codon positions.

discussion
myn, proposed as a modified yn in this paper, allows for unequal transitional rates between purines and between pyrimidines as well as transversional rate and nucleotide  frequencies. our comparative analyses indicate that ignoring unequal transitional rates often results in closer estimates only when κr ≈ κy but rather biased estimates when κr > κy or κr < κy, and that myn is more robust in simulations and real datasets by comparison with other methods, especially with yn. therefore, it is important to take account of unequal transitional rates for accurately capturing evolutionary information  when unequal transitional rates among compared sequences exist. in addition, unequal transitional rates can also be implemented in a maximum likelihood framework  <cit>  that allows model evaluation for choosing a better suit to a dataset and therefore allows users to obtain more reliable estimates.

how does κ lead to biased estimates of ka and ks?
all approximate methods for ka and ks estimations may one way or another give rise to biased results for at least some parameter combinations. we examined κ, which is used not only in estimating s and n, but also in generating a transition probability matrix for estimating sd and nd. since the sum of sd and nd between the two compared sequences is always smaller than the sum of possible sites , the influence of κ on s and n is significantly stronger than that on sd and nd. hence, let us focus on the effect of κ on s and n. yn uses κ and codon frequencies to estimate s and n. since codon frequencies are constant, estimated from targeted sequences, and transitions between two codons are more likely to be synonymous especially at the third codon positions, s thus  is positively correlated to κ. furthermore, the values of ks depend on s . therefore, an overestimated κ could give rise to overestimation of s and underestimation of ks, which results in overestimation of ω. likewise, underestimation of κ leads to overestimation of ks and underestimation of ω. therefore, κ correlates negatively with ks and positively with ω and such correlations are also applicable to κr and κy.

let us examine how κ affects ka and ks in our simulations. when κr < κy, yn tends to underestimate ω and to overestimate ks, which results from the underestimation of κ by assuming κy equal to κr. the trend sometimes is less obvious, because about 4% loss of sites are due to mutations leading to stop codons, resulting in slightly underestimated ka and ks  <cit> . similarly, when κr > κy, yn overestimates κ, resulting in overestimation of ω and underestimation of ks. the bias of ω becomes more pronounced as the bias of κ varies to extremes, when κr >> κy or κr << κy. in addition, κr and κy can also affect the estimates from myn. since transitions are more likely to occur than transversions, a decrease in κr can be related to more drastic reduction of transversions than transitions between purines, resulting in overestimated κr; this overestimation becomes severer for purifying selection due to a higher occurrence of synonymous substitutions than nonsynonymous ones, and synonymous substitutions are also more likely to be transitional. as a result, ω can be overestimated  and ks can be underestimated , especially when κr values are smaller. therefore, to acquire more reliable estimates on ka and ks, it is essential to have a less biased estimate of κ, or both κr and κy.

influences of t and sequence length
divergence time  and sequence length both influence the estimation of ka and ks. since κ in yn, κr and κy in myn are all deduced from fourfold-degenerate sites at the third codon positions and non-degenerate sites , larger t leads to multiple substitutions between the two compared codons, resulting in under-counts of substitution events  for estimating κ, κr and κy. therefore, extreme t tends to decrease the effective sampling size and short sequences tend to exaggerate this effect, resulting in biased estimates of κ, κr and κy. we indeed found that both yn and myn tend to overestimate ω for purifying selection and underestimate ω for positive selection and these biases become severe as t increases . these biased estimations are in fact indirect results of biased estimates of κ, κr and κy. the fact is that synonymous substitutions are more likely resulted from transitions than nonsynonymous ones are, such as the cases of two-fold degenerate codons, so the bias between κr and κy does exist. in addition, since for negative selection, synonymous substitutions have higher possibilities to occur than nonsynonymous ones, transitions are more likely to occur than transversions. therefore, with a decreasing effective sampling size caused by the increasing t, yn tends to underestimate transversional rate and thus to overestimate κ. in the case of positive selection, yn underestimates transitional rate and κ in a similar way. as to neutral mutation, yn tends to simultaneously underestimate both transitional and transversional rates so that the varying t has no apparent effect. since myn adopts a similar approach as yn estimates κ, it shows a similar trend. short sequences have similar effect as smaller sampling size, and therefore, both yn and myn may give rise to biased estimates κ, κr and κy, albeit myn's better performance in less extreme cases.

CONCLUSIONS
we compared myn with other methods, especially with yn, by examining infinitely long sequences, performing computer simulations and analyzing real datasets, and found that myn has minimal deviation even when parameters vary within normal ranges defined by empirical data. in addition, these results indicate that biased estimates of ka and ks primarily stem from biased estimates of κ, or both κr and κy, which can be influenced by t and sequence length.

