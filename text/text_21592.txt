BACKGROUND
biological imaging such as confocal fluorescence microscopy and electron microscopy require the use of protein-labeling techniques to localize individual proteins within cells. biological markers such as green fluorescence protein  <cit>  and a variety of fluorescent dyes  <cit>  for fluorescence microscopy, and colloidal gold  <cit>  for electron microscopy are widely used. molecules labeled with biological markers are generally observed as small specific spots against a background of high brightness. quantitative comprehension of the localization and statistical distribution of the spots are essential for deciphering biological information. in general, cellular microscopic images have a low signal-to-noise ratio  and the differences in intensity between signal spot and background are not always clear. moreover, the texture of those backgrounds is complicated. for these reasons, microscopy images are often difficult to manage computationally. currently, there are several automatic processing and recognition systems for biological images and they have been applied in the quantitative analysis of biological objects ranging from molecules to cells to whole organisms  <cit> .

the purpose of this study was to extract and characterize biological spots of intricate morphology and low contrast in an automatic manner. current standard techniques for spot extraction consist of edge enhancement for image morphology, including discrete convolution by a high-pass mask and the use of first- or second-order differential operators, based on the magnitude of the spatial differences of the spots  <cit> . one major problem with this approach, however, results from the blurring and degradation of the image contrast during image acquisition. for some spots with weak contrast, edge extraction is not sufficient. in real-world applications, most biological images contain object boundaries, artifacts, and noise. therefore, edge enhancement filters may cause difficulties in distinguishing the exact edge of the object's structure from artifacts such as trivial geometric features. additionally, these techniques can amplify background noise in the image while enhancing the object edge  <cit> .

in other methods based on conventional frequency-selective filters  <cit> , the precise localization of low-contrast spots may not be possible. high-density areas resulting from the integration of many spots may not allow the isolation of individual spots through frequency-selective filters. in addition, the parameter settings are often so complex as to require their modification whenever the target spot images are changed  <cit> . furthermore, these methods cannot deal with the varied morphology of the spots.

spot extraction methods based on conventional mathematical morphology  <cit>  effectively capture the spots' location and their shape information  <cit> . these methods employ a morphological algorithm for background subtraction known as the top-hat transformation  <cit>  or rolling-ball transformation  <cit> . it is well recognized that the principle of these methods is very effective for extracting a target object from a wide variety of image types  <cit> .

morphological operations use small synthetic images called structuring elements , which are a fundamental tool in mathematical morphology. the se used as a probe moves along each pixel of the image. to apply morphological filtering for spot extraction from various types of biological images, the procedure to determine the shape and size of the se is very important. a commonly used se shape is the square or disk. in the rolling-ball transformation, a ball-shaped se  is used. in the above-described methods for spot extraction, these ses were also used. however, most small contiguous spots cannot be individually distinguished, such that several spots are extracted as one connected region because the size  of the ses is wider than the minimum distance between the peaks of adjacent spots. a suitable se shape for spot extraction includes a straight-line segment ; however, since processing by common morphological operations with a single line-segment se is not isotropic, it cannot consider the geometrical details of an intricate image. thus, for spot extraction, conventional morphological processing is not effective.

advanced morphological processing with multiple ses has been reported  <cit> . in this approach, multiple sets of line-segment ses generated by rotation of the single line-segment se in different directions are applied. however, in the discrete space of the images, it is difficult to generate a straight line-segment as the se that can be rotated in an arbitrary direction. this restriction in the rotational direction of the se prevents adequate spot detection in complicated biomedical images.

in this study, we solved these problems by introducing a simple and practical approach, an extended mathematical morphology, into the automatic detection of spots in biological images. this technique is based on top-hat transformation with a single se as the straight line-segment. in our algorithm, an original image can be rotated in arbitrary directions with respect to the single se. this novel method, which we named rotational morphological processing , can homogeneously treat with geometrical features in an image under various orientations. top-hat transformation based on rmp has been applied to spot extraction, in the absence of any hypotheses to fit the spots by 2-d gaussian shape or minimal intensity. finally, by isotropic processing with the line-segment se, contiguous spots can be segmented into individual parts. our novel method was developed in order to automatically extract spots, such as biological markers consisting of antibodies conjugated with fluorescent molecules, from a biological image of intricate morphology and low contrast.

smal et al. evaluated the spot detection methods most frequently used in fluorescence microscopy  <cit> , including wavelet-based multiscale detecting  <cit> , morphological based methods  <cit> , and the machine learning method  <cit> . in this study, we compared the performance of our proposed method with other morphological based methods, such as conventional top-hat transformation and h-dome transformation, by using synthetic-noise images.

this report is organized as follows. a brief introduction describing the basics of conventional mathematical morphology is followed, in the methods section, by a detailed presentation of our spot extraction technique. in the results section, the application of the detection method to synthetic images as well as to real image data from electron and fluorescence micrographs is discussed. in the final section, the effectiveness of our novel method is summarized and evaluated.

conventional mathematical morphology
mathematical morphology is based on set-theory concepts of the shape of an objective image  <cit> . an image can be represented by a set of pixels. morphological operations always deal with a set of two images: an objective image and a se. each se has shape and size characteristics as parameters of the operation. let f denote a gray-scale image function from z <dig> into , where i is a positive integer. let b denote a binary se. the fundamental operators of mathematical morphology are dilation and erosion.

dilation:   

erosion:   

where df and db are the domains of the functions f and b, respectively. the opening and closing operations are delivered from dilation and erosion.

opening:   

closing:   

the top-hat transformation is one of the commonly used morphological operations for extracting local bright objects from a low contrast image in gray-scale  <cit> . it is obtained by subtracting from the original image f the opening image γb using the se b.

top-hat:   

it yields an image in which all the residual features  are subtracted by the opening operation. adding these residual features to the original images has the effect of accentuating objective structures with high intensity  <cit> . if the difference in intensity between the target objects and the background of the image is markedly small, it is difficult to detect these differences with the human eye. however, these low-contrast objects can be extracted and enhanced by the top-hat transformation.

another method to extract the local bright object in biological images, based on mathematical morphology, is the h-dome transformation  <cit> .

h-dome:   

where dh is the h-dome image of a gray-scale image f,  represents the result of subtracting a constant value h from the gray-scale image, and ρf the morphological reconstruction of the gray-scale image from f-h. the gray-level reconstruction is obtained by iterative geodesic dilation of f-h under f until stability is reached  <cit> .

method
spot extraction filter: top-hat transformation by rmp
the essential elements required for the spot extraction filter are processing of the biomedical image isotropically and isolation of the adjacent spots from the image background. in order to fulfill these requirements, our method proposes that the objective image can be rotated in arbitrary directions with respect to a single straight line-segment se whose width has only  <dig> pixel. the width of this se ensures determination of the minimum distance between two different spots for isolation. by using this se, spots separated by distances of only  <dig> pixel can be distinguished individually. the length of the se should be adjusted so that it is longer than the size of the target spot. a spot that is smaller than the length of this se is extracted by the top-hat transformation.

this top-hat transformation by rmp with the straight line-segment se consists of the following steps:

algorithm  <dig> 
 <dig>  original image rotation. the original image f  is rotated in a clockwise direction with respect to the center of the image frame. assume that dividing a half of the circle  into n equiangles gives us each direction at an angle of π/n  , which is an increment angle. namely, fi  denotes the rotated image of f with the angle of π i/n , where i =  <dig>   <dig> ..., n- <dig> 

 <dig>  opening. all rotated images are subjected to an opening operation with the straight line-segment se b . the opening operations of the rotated image fi are represented as γb .

 <dig>  opened image rotation. the opened images ) are rotated π·i/n  in an anticlockwise direction. the rotation at i times of the opened image is denoted by hi .

 <dig>  union of the rotated and opened images . the processed images  are unified. in union processing, the maximum intensity value, which corresponds to the same pixel coordinate among all opened images, is taken to generate the whole image.

 <dig>  top-hat transformation by rmp. the unified opened image ) is subtracted from the original image .

figures 1a and 1b show the original image f and the straight line-segment se b, respectively. figure 1c illustrates a setting of the rotation angles. the process in the rmp opening with the straight line-segment se is represented in figure 1d. rmp opening is defined as follows:   

the image γ'b is defined as the maximum value of h <dig> , h <dig> ,..., hn- <dig>  the top-hat transformation by rmp is also given by the following equation:   

this operation is used as the spot extraction filter in our proposed method.

in this study, we utilized the top-hat transform by rmp for spot extraction from biological images obtained with electron and fluorescence microscopy. the entire practical process consists of the following steps:

algorithm  <dig> 
 <dig>  noise reduction: noise, which is less than the resolution limit of the micrograph or target spot, is removed via opening by rmp ) with the straight line-segment se. the length of the se is set to be smaller than the diameter of the target spots.

 <dig>  spot extraction: the spots are extracted by the top-hat transformation by rmp ) with the straight line-segment se. the length of se is set to be larger than the diameter of the target spots.

 <dig>  binarization: the extracted spots are binarized by equation  for recognition and measurement of the spots computationally.

binarization is performed according to the thresholding approach:   

namely, the pixels of residual regions by the top-hat transformation by rmp are assigned an intensity of  <dig> in an 8-bit gray-scale value.

in several cases, the subtraction process and the binarization process leave the small isolated pixels on the image such that they represent residual background noise. the conventional opening operation ) can also be applied to remove the remaining noise. this post-processing should be adapted to the particular application.

RESULTS
isolation of overlapped spots
the performance of our proposed method in the isolation of overlapped spots was compared with that of conventional top-hat transformation. figure 2a shows the model image of adjacent spots . on the left of figure 2a is the original gray-scale image f and on the right is the 3-d topographic map of f. the vertical height of the map represents the intensity. in top-hat transformation, the original image f is first opened and then this opened surface is subtracted from the original surface. in this example, the straight line-segment se bl  was used in our method, and the flat disk se bd  was used in the conventional top-hat transformation. the difference between f and its opening by rmp with bl  is shown in figure 2b. the result of conventional top-hat transformation with bd of f is shown in figure 2c. in figure 2d, the black line is the profile of the spots image f , which denotes the surface of the spots. the red line is the result of the opening by rmp with bl of f . the green line is the result of the conventional opening with bd. figure 2b shows that the two overlapped spots were segmented clearly by our method.

the opening operation can be geometrically processed by pressing the se up against the surface of the original image f and sliding it underneath the entire surface. the surface of the opened image is constructed from the highest point in the region reached by the se. since the line-segment se bl has a width of  <dig> pixel, in the process of rmp opening the se fits the narrow intervening space between the spots. thus, line-segment se reaches the baseline of the individual spots . in contrast, the disk se bd has a width of  <dig> pixels as diameter. since it is larger than the intervening space of the spots, the se cannot fit the space. thus, the disk se cannot reach the level at which the two spots are distinguished. accordingly, the spots were not isolated by the conventional top-hat transformation.

verification of optimal number of rotational direction
the optimal number of the image rotational directions  was determined. for this experiment, we used a model image containing several artifacts. the image was reconstructed by rmp opening with the straight line-segment se set at various values for the rotational direction. peak signal-to-noise ratio  was used to provide a quantitative evaluation of this performance. assuming pixel values in the range of , the psnr is calculated using the following formula:   

where f denotes the original image, f' the filtered image by rmp opening, and m <dig> × m <dig> the total number of pixels.

figures 3a and 3b show the original 8-bit gray-scale image  and the model image overlapped by artifacts, respectively. some of the round objects  are regarded as artifacts to be removed. the rmp opening with the straight line-segment se  of n =  <dig> allowed removal of the artifacts but also of some of the elongated target objects . at n =  <dig>  artifacts were removed while the other objects were well preserved . the graph in figure 3e shows the variation of psnr with n, which ranged from  <dig> to  <dig> directions. the range of small values of n  is enlarged in the insertion. the black line denotes the result of this operation. the highest value of psnr was obtained at n =  <dig> and it subsequently remained at almost the same level. in terms of the performance of reconstruction and the computational cost of processing, it is reasonable to assume that the optimal number of image rotational directions is  <dig> 

in addition to this experiment, performance was also tested using the multiple ses method, shown as a red line in figure 3e. the straight line-segment se was used for these tests. in the case of n =  <dig>  the single se  was applied; at n =  <dig>  two ses  were used, and at n =  <dig>  four ses  were used. these results showed that reconstruction by the multiple ses was insufficient.

noise reduction
the noise reduction technique in our method , i.e., rmp opening with line-segment se, was used. figure 4a shows the spot model with background noises. these noises were removed by rmp opening . the length of the line-segment se was determined from the spatial resolution of the microscopic image, with objects having a shape size smaller than the resolution limit regarded as noise. if the spot size is known in advance, the se length should be set to remove objects smaller than the spot size.

comparison with conventional morphological methods by using synthetic-noise images
the ability of the proposed method was compared with that of conventional morphological methods, such as the conventional top-hat and h-dome transformations. synthetic-noise images were generated to evaluate the quantitative performance of spot detection. ten source images of size  <dig> ×  <dig> pixels were generated, with one such example shown in figure 5a. each image contained  <dig> spots, which were modeled as a 2-d gaussian distribution in random locations. this distribution is a good approximation of the theoretical shape of the spot  <cit> . two types of spot models with different intensity levels  were generated . first, a 2-d gaussian distribution with kernel width =  <dig>  and standard deviation σ =  <dig>  was generated. this distribution was then expanded to the normalized gray-scale range of 0- <dig>  for the second spot model, the distribution was expanded to the range of 0- <dig> 

the poisson-distributed noise was added to each source image with a uniform  and a gradient  background . this is one of the main sources of noise in fluorescence microscopy imaging  <cit> .

the psnr between each source image and the corresponding noise-added image was calculated. the average value of the psnr of the type-a image set was  <dig>  ±  <dig>   db, while for the type-b image set it was  <dig>  ±  <dig>  db.

since the spots in the synthetic image are prospectively known, the recall, precision, and f-measure rates can be calculated. let tp denote the number of spots detected correctly, fn the number of spots missing detection, and fp the number of spots false alarmed. if adjacent spots are not separated, those spots are regarded as fn. the recall and precision rates are defined by the equations tp/ and tp/, respectively. the f-measure rate is the harmonic mean recall and precision rate and takes into account both measures:   

in each image type, the synthetic images had a total of  <dig> spots; thus, tp + fn =  <dig>  the results detected by our proposed method were compared with those of the conventional top-hat and h-dome transformations.

in this experiment, noise-added images were first smoothed with the gaussian filter .

processing by our proposed method followed algorithm  <dig>  since the width of the spot domain was  <dig> pixels , any structure smaller than this width was regarded as noise or artifact. in step  <dig>  the straight line-segment se of  <dig> ×  <dig> pixels was used, and in step  <dig>  the straight line-segment se of  <dig> ×  <dig> pixels. in both steps, the rotational direction number  of rmp processing was  <dig>  the subtracted image was binarized by the method in step  <dig> 

for the method based on the conventional top-hat transformation, the processing in step  <dig> differs from that of the proposed method. top-hat transformation was applied with disk se  and the subtracted image was binarized by the method in step  <dig> 

for the method based on h-dome transformation, this transformation was applied to the smoothed image obtained in step <dig> of algorithm  <dig>  we set the value of parameter h to  <dig>  and the subtracted image  was binarized by the method in step  <dig> 

finally, binary images obtained from these methods were cleaned by the conventional opening with disk se  as post-processing.

the results of the spot extraction are seen in figure 5c. the type-a and type-b images are shown in the top and bottom row, respectively. all spots were correctly detected by our proposed method but not by the other methods. figure 5d shows the actual values of recall, precision, and f-measure for each type image set. the performance in terms of the f-measure for the proposed method was consistently 100% in all type images. thus, the proposed method is more tolerant of poisson noise images than other methods.

in addition, the performance of our method was tested using synthetic images under various noise levels. for the source image , nine degrees of poisson-distributed noise images with uniform background were generated, with the psnr decreasing from  <dig>  to  <dig>  db. the upper part of figure 5e shows the synthetic images, captured only in the rectangular region in figure 5a. the proposed method was applied to these synthetic images with the same procedure and ses as in the previous experiment. the bottom of figure 5e shows that the scores for the recall, precision, and f-measure rates were consistently 100% in the psnr range of  <dig>  to  <dig>  db. subsequently, the recall rate decreased with decreasing psnr although the precision rate remained at 100%. this indicates that fp was zero and ensures the accuracy of our method for spot detection.

spot extraction of colloidal gold particles
the proposed method was applied to electron microscopic images to evaluate its performance in spot extraction. electron micrographs containing colloidal gold particles were used as test images, with two different sizes of particles . figure 6a  shows a part of the original micrograph with 10-nm-diameter gold particles . the spatial resolution was  <dig>  nm/pixel. figure 6b  shows a part of the original micrograph with  <dig> -nm-diameter gold particles -nitrilotriaceticacid-nanogold, nano probes). the spatial resolution of this image was  <dig>  nm/pixel. these images were on an 8-bit gray-scale, the intensity values of the routine image quality were inverted. the purpose of this test was to verify whether the diameter of the extracted gold-particle spot as determined by our method was consistent with the nominal diameter.

processing of the spot extraction was carried out with algorithm  <dig>  in the case of the micrograph containing 10-nm gold particles, line-segment se with a size of  <dig> ×  <dig> pixels  and  <dig> ×  <dig> pixels  was used in noise reduction and spot extraction, respectively. the extracted spots were binarized and overlaid as seen in the red region on the original image. the result is shown on the right side of figure 6a. for the electron micrograph containing the  <dig> -nm gold particles, line-segment se with a size of  <dig> ×  <dig> pixels  and  <dig> ×  <dig> pixels  was used for noise reduction and spot extraction, respectively. the result is shown on the right side of figure 6b. for all extracted particles, the averaged feret's diameter was calculated. the mean ± sd of the diameter of the extracted spots was  <dig>  ±  <dig>  nm  for the 10-nm gold particles, and  <dig>  ±  <dig>  nm  for the  <dig> -nm gold particles. this result shows that the diameter of the extracted spots was consistent with the nominal diameter.

spot extraction of fluorescent antibodies
our proposed spot extraction method was applied to fluorescence microscopy images in which caveolin- <dig> molecules in fibroblasts were stained with secondary fluorescent antibodies . this image had an 8-bit gray-scale and a spatial resolution of  <dig> nm/pixel. line-segment se with a size of  <dig> ×  <dig> pixels  and  <dig> ×  <dig> pixels  was used for noise reduction and spot extraction, respectively.

by visual observation, the diameter of each spot was found to be about  <dig> pixels . therefore, a se length longer than the diameter of the target spots was selected for the spot extraction process. binarization was carried out using equation . the regions of the extracted spots were superimposed on the original image as red-colored regions . from this micrograph, the  <dig> spots were extracted. the quantitative estimation of the bright spots corresponding to the caveolae is provided in figure 7c. the sum of the intensity of the pixel values in each extracted spot region was calculated and the distribution depicted in a histogram. the total number of extracted spots was  <dig> from five micrographs . the median of the histogram was  <dig>  the largest cluster can be seen centered at the histogram's median value.

as shown in figure  <dig>  the proposed method was applied to the various shapes of the fluorescent spots :  gaussian-like shape ,  gaussian-like shape ,  irregular shape, and  volcano shape. the 3-d maps of the original images are shown in the middle row, which illustrates the relief of the pixel surface. the 3-d maps of the extracted spots, as determined by our method, are shown in the bottom row. all spots were well extracted even though they had intricate shapes.

discussion and 
CONCLUSIONS
our novel method to extract the spots in electron and fluorescence microscopic images uses the extended morphological filter through the top-hat transformation by rmp. we have successfully shown that the method is useful for extracting spots in biomedical images in which the conventional method is inadequate. the key concepts of our spot extraction method are the use of a straight line-segment se and the rotation of the original image. by changing the length of se, target spots of various sizes can be extracted. the method avoids the technical difficulties of traditional morphological processing and its performance is robust in the processing of biomedical images. the main advantages of our method are that it is computationally simple and easily modified for the extraction of target spots of different sizes and shapes, and that it can handle images in various conditions, e.g., aggregated target spots, poor snr, and a background with large variations in intensity. the method yields directional information regarding the spatial distribution of spots within the cell as well as the frequency distribution of the size and intensity of the spots.

our method is based on a line-segment se with a 1-pixel width as the minimum separation distance and therefore allowed two or more target spots located close to each other to be clearly distinguished . with conventional morphological top-hat transformation using the common se shape , it is difficult to separate such spots. a similar difficulty arises when the "ball" se is used. since it has a radius that is larger than the inter-space distance between adjacent spots, it cannot fit within the space. the top surface obtained during opening with the rolling ball cannot reach the baseline allowing for separation of the spots.

to verify the optimality of the number of rotational directions  shown in figure  <dig>  we investigated how an artifacts-contaminated image  could be restored by the rmp opening with increasing n. the experimental result  showed that n =  <dig> was a better trade-off because the value of psnr was low for n <  <dig> while for n >  <dig> the processing time became longer. in our method, a large computational cost, which is proportional to the size of the input images, is inevitable.

we compared our spot extraction method with the conventional top-hat and h-dome transformations. as seen in figure  <dig>  our method outperformed the others with respect to the three criteria . for the proposed method, the performance in terms of f-measure rate was maintained at 100% among all background typed images. the precision rate of the conventional top-hat transformation was much lower due to its higher fp value  in detection of the noise. furthermore, conventional top-hat transformation could not separate adjacent spots, as it used the disk se. meanwhile, the recall rate of the h-dome transformation was much lower due to its higher fn value . thus, the number of undetected true spots was large.

we further investigated the change in the three measurements as a function of decreasing psnr from  <dig>  to  <dig>  db . the f-measure rate was maintained at 100% until psnr decreased to about  <dig> db. subsequently, when psnr decreased further, the f-measure rate decreased as well due to a decreasing recall rate ; however, the precision rate was constantly 100%. these results showed that our method is accurate in spot detection.

in the measurement of gold particles in the electron micrograph , the value of the averaged feret's diameter of the extracted spots and the value of the nominal diameter of the gold particles were in close agreement. thus, our method effectively extracted spots of the specified size with high accuracy.

furthermore, our method allows effective extraction of various shaped spots. since it is based on the top-hat transformation, the spots are extracted independently in terms of the shape of the surface relief, which is based on variations in the intensity value within a spot region . in the conventional spot detection methods that rely on matched filtering, a 2-d gaussian distribution is commonly used for the matched filter, assuming that a point-spread function of a signal spot has a 2-d gaussian distribution. however, because most spots have an irregular topology, as in the example in figure  <dig>  accurate spot extraction is difficult using the matched filtering method.

signal spots extracted by our method can be transformed into a 2-d gaussian distribution as a normalization of spot shape. this allows the application of our method to the conventional automatic tracking system of individual fluorescent particles  <cit> .

the rmp-based method enables a shape and intensity analysis for various types of biomedical images . it can be applied not only to spot extraction but also to a wide variety of important image processing techniques, such as segmentation, smoothing, and pattern extraction  <cit> . overall, it provides a wide-ranging analytical approach to biological and biomedical informatics.

authors' contributions
yk conceived the study, developed the algorithms, carried out the testing and fine-tuning of the algorithms using the programming language c/c + +, and wrote the first draft of the paper. nb provided useful comments on methodology and helped to revise the manuscript. nm carried out all of the lm, tem, and molecular biology experiments, supervised the work, and edited and revised the manuscript. all authors read and approved the final manuscript.

