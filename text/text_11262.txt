BACKGROUND
present knowledge indicates that genes in genomes operate in multilayered hierarchical gene regulatory networks  to control biological processes and pathways . a typical hgrn contains a few high hierarchical regulators, some middle-level regulators and many terminal/structural genes at bottom layer. studies have shown high hierarchical regulators seem to be global modulators that respond to various cellular signals  <cit>  and environmental cues  <cit> . the middle-level genes play the manager-like roles, through which the commands from high hierarchical regulators at upper layers are synthesized and then passed down to terminal genes at bottom layer for execution  <cit> . in general, the high hierarchical regulators at the top levels have more pleiotropic effect while terminal or structural genes have more specific functions. genes involved in various metabolic or canonical pathways are regulated by ml-hgrns  <cit> . to understand how pathways are regulated, we should develop methods for constructing ml-hgrns that operate above biological pathways and processes. this kind of ml-hgrns can provide a hierarchy in addition to connectivity of regulators, which are essential in understanding wired complex regulation on metabolic or canonical pathways through multiple chains-of-command  <cit> .

despite the critical importance of ml-hgrns, there is a lack of computational algorithms for directly building ml-hgrns from gene expression data. reverse engineering of ml-hgrn governing a biological pathway or process remains challenging, and the algorithms that are well suited for building ml-hgrns have not yet been established. although several algorithms have been developed for reverse-engineering grns, they are not specifically tailored for constructing the ml-hgrns that mimic the hierarchical regulation  <cit> . currently, the majority of gene expression data in public repositories are static data, namely, non-time-course data or time course data with large time intervals that vary from a few hours to even several days  <cit> . these types of data often miss some regulatory events and interactions between two adjacent time intervals, nullifying dynamic methods that include differential equation  <cit> , finite state  <cit> , dynamic bayesian network  <cit> , control logic  <cit> , boolean network  <cit> , and stochastic networks  <cit> . in general, the methods that are of more useful to static data include various static methods that comprise ggm  <cit> , mutual information based-rn  <cit> , algorithm for the reconstruction of accurate cellular networks   <cit> , context likelihood of relatedness   <cit> , c3net  <cit> , mi <dig>  <cit> , and probabilistic based--bayesian network  <cit> . bayesian network, a probabilistic graphic model that represents a set of variables and their conditional dependencies via a directed acyclic graph, has been used to infer the “optimal” structure of a set of genes. however, due to astronomical number of possible structures and the computational complexity, approximate inference methods, such as gibbs sampling, metropolis–hastings algorithms and other variant methods, instead of the original probability method of bayesian network, were used to approximate the inference of the possible structures of grns  <cit> , and these methods are capable of producing a local interacting dependence variables containing causality relationships. aracne is the other widely used algorithm for building graphic dependency network using mutual information-based method. it can identify both linear and non-linear dependence relationships between genes while eliminating potential indirect gene–gene interactions through implementing data processing inequality . another information-theory-based algorithm is the context likelihood of relatedness , which scores all possible pairwise interactions based on mutual information and compared that to an interaction specific background distribution. although computationally less complicated, most of the methods that evaluate pairwise relationships among genes can easily lead to spurious relationships when the number of rna-seq or microarray data sets is small. finally, ggm uses the partial correlation as a measure of dependency and interaction between any pair of genes by removing effect of third one  <cit> , allowing to distinguish direct from indirect interactions  <cit> . recently, ggm with a limited-order partial correlation function, which estimates correlations conditional on one or two, but not all other genes, and has been used to infer gene networks from arabidopsis  <cit>  and yeast  <cit>  transcript profiles. however, as aforementioned, these methods are not specifically designed and tuned for inferring ml-hgrns.

although mathematical models are critically important in capturing the causality relationships for reconstructing gene networks, what is also very important is the biological regulatory models, which, when integrated into mathematical models, can empower efficiency of the network construction algorithms substantially. biological regulatory model, in this study, refers to the defined regulatory structure to which the input genes can be functionally fitted in and then evaluated as a building block during network construction process. the integration of a biologically valid regulatory model into an algorithm demands seamless design that can enhance the recognition of the causal regulatory relationships of input genes. in this study, we developed a novel algorithm, named as bottom-up ggm algorithm, specifically for reverse engineering of ml-hgrns that govern a biological pathway or process through integration of ggm algorithm with an authentic biological regulatory model. the input files for bottom-up ggm algorithm include:  the transcriptomic profiles of differentially expressed genes  involved in a known metabolic pathway, or a canonical pathway defined by a gene ontology  the transcriptomic profiles of differentially expressed transcription factors  or all tfs under experimental condition. we evaluated bottom-up ggm algorithm for several pathways or biological processes and found it in general performs well for constructing ml-hgrns. we believe the algorithm can meet the great needs for constructing ml-hgrns using small- to medium-sized gene expression data sets, and the ml-hgrns built will be instrumental for us to understand the hierarchical regulation of many biological processes and pathways.

RESULTS
selection of genes for bottom-layer and top regulatory layers
we applied our bottom-up ggm algorithm to multiple pathways for reverse-engineering ml-hgrns, each is considered to govern a given pathway or biological process. for each pathway, there were two files: one contained the gene expression profiles of pathway genes of interest, and the other file contains the expression profiles of all tf genes. the genes involved in a pathway are generally non-regulatory genes,, which can be obtained from existing annotation of metabolic pathways. certainly, genes involved in a biological process, for example, as defined by a gene ontology that is enriched in differentially expressed genes, can be treated as a canonical pathway, and used to replace the pathway genes.

reverse-engineering of ml-hgrn governing lignocellulosic pathway
the plant lignocellulosic pathway controls the biosynthesis of wide variety of secondary metabolic compounds including cellulose and lignin  <cit> . in addition to their roles in the structure and protection of the plants, cellulose and lignin have important roles in the structural integrity of plant cell walls, and the stiffness and strength of stems  <cit> .

the inputs for our bottom-up ggm algorithm include the profiles of  <dig> pathway genes, and  <dig> tfs extracted from the  <dig> pooled arabidopsis microarray data sets under short-day condition that is known to induce secondary wall biosynthesis. we constructed a ml-hgrn using these  <dig> pathway genes used as bottom layer and these tfs as candidates for top layers. the construction of ml-hgrn was a dynamic process in our pipeline software with the parameters predetermined by users. these parameters include the number of layers, significant levels of p values for correlation and partial correlation and their differences, and a percentage of genes to be kept for each layer above the bottom one. the pipeline first built the second layer immediately above the bottom  layer, and then used the second layer as the bottom layer, and repeated the above procedure to obtain the third layer and so on. for this ml-hgrn , we obtained  <dig>   <dig>  and  <dig> tfs for second, third and fourth layer respectively above the bottom layer. the detailed results that include correlations and p-values for all the interfering tfs are given in . there are  <dig> tfs in the second layer , out of which  <dig> tfs  were positive tfs known to regulate lignocellulosic biosynthesis  <cit> . nac domain proteins: nst <dig>  <cit> , nst <dig>  <cit> , and snd <dig>   <cit>  are key regulators of secondary wall biosynthesis. nst <dig>  nst <dig> and nst <dig> are key regulators involved in wall thickenings in various tissues when expressed ectopically  <cit> . the expressions of snd <dig>  snd <dig>  myb <dig>  and myb <dig> are regulated by snd <dig> and all are developmentally associated with cells undergoing secondary wall thickening . the snd <dig> regulates genes involved in secondary cell wall development in arabidopsis fibres, and increases fibre cell area in eucalyptus  <cit> . myb <dig> regulates the biosynthesis pathways of cellulose, xylan, and lignin  <cit>  and gata <dig>  <cit>  controls xylem vessel differentiation. in the third layer, there are  <dig> positive tfs . the myb <dig> is known to be involved in the activation of lignin biosynthetic pathway during secondary wall formation in arabidopsis. the tf myb <dig> controls stomatal aperture in arabidopsis  <cit>  and is required for mucilage deposition and extrusion in the seed coat  <cit> . myb <dig> regulates the accumulation of the uv-protectant compound sinapoylmalate by repressing the transcription of the gene encoding the lignocellulosic enzyme cinnamate 4-hydroxylase  <cit> , and the myb <dig> regulates the thickening of secondary wall of cells  <cit> . in fourth layer, there are  <dig> tfs. most appear to be the high hierarchical regulators. some of them are known to be responsive to various environmental cues and intercellular cues, for example, slr  <cit>  and hb <dig>  <cit>  are auxin-inducible whereas erf <dig>  <cit>  and obp <dig>  <cit>  are responsive to ethylene and salicylic acid, respectively. in this layer, the shp <dig>  also referred as to be shatterproof <dig>  is known to control the differentiation of the dehiscence zone where it promotes the lignification of adjacent cells  <cit>  while hb <dig> boosts vascular development in meristem  <cit> .fig.  <dig> construction of ml-hgrn for lignocellulosic pathway. a. four-layered hgrn built with ggm bottom-up algorithm. the gene ids represented by each symbol can be found in additional file 1: table s <dig>  b. the gene association network of lignocellulosic pathway built with aracne algorithm that identifies expression profile-dependent genes. the input files for both bottom-up ggm algorithm and arance include the profiles of  <dig> transcription factors and  <dig> lignocellulosic pathway genes. the nodes with coral  color highlight in both networks are known regulatory tfs for lignocellulosic pathway in existing knowledgebase. the gene ids represented by each symbol can be found in additional file 1: table s2



although we have indicated there are currently no computational algorithms for directly building ml-hgrns from gene expression data, arance can take the same inputs as our bottom-up ggm algorithm and obtain tfs that have dependency on pathway genes. these tfs can serve as rough controls and allow us to obtain some idea of the performance of our bottom-up ggm algorithm. we input these expression profiles of  <dig> pathway genes and  <dig> tfs to arance, and obtained the tfs that have dependency with at least two pathway genes with mutual information >  <dig>  . of the  <dig> tfs obtained, there are  <dig> positive tfs . ten of them are common with the ml-hgrn built with bottom-up ggm algorithm. although bottom-up ggm failed to capture three tfs, vnd <dig>  myb <dig> and xnd <dig>  which were recognized by arance, it identified eight more positive tfs that included gata <dig>  myb <dig>  myb <dig>  myb <dig>  grf <dig>  myb <dig>  shp <dig>  and hb <dig> 

construction of ml-hgrn that controls human embryonic pluripotency renewal
there are three master transcription factors, nanog, pou5f <dig>  and sox <dig>  which are known to govern the pluripotentcy renewal in human embryonic stem cells  <cit> . early studies have identified some target genes that can be bound by the above three transcription factors using chip-seq experiments  <cit> . we assume that these target genes belong to a canonical pathway that plays key roles in pluripotency renewal. we would like to test if we could infer these three master transcription factors by building a one-layered hgrn using our bottom-up ggm algorithm. the  <dig> microarray data sets  <cit>  for human stem cells was collected from  <dig> experiments in which hes cells were treated with various differentiation reagents. therefore, these datasets include states involved in many regulatory events underpinning pluripotency, such as es maintenance, exiting the pluripotent state, and differentiation. we used  <dig> target genes as bottom-layer, all tfs in human as inputs, and then used our bottom-up ggm algorithm to build one regulatory layer above these  <dig> pathway genes. the network we obtained is shown in fig. 2a, with  <dig> top genes shown in second layer. all above three transcription factors were shown up in top  <dig> tfs captured . when the same inputs were used for arance, and the network obtained is shown in fig. 2b. we also kept top  <dig> tfs based on the mutual information  on the second layer but none of above three tfs was present in these  <dig> genes. we searched the rankings of above three tfs in the arance output sorted by mi, and found sox <dig> and nanog ranked at  <dig> and  <dig>  respectively.fig.  <dig> construction of ml-hgrn for putative pluripotency renewal pathway in human embryonic stem cells. a. two-layered hgrn built with bottom-up ggm algorithm. the gene ids represented by each symbol can be found in additional file 1: table s <dig>  b. the network built with aracne algorithm. the input files for both bottom-up ggm algorithm and arance include the expression profiles  of  <dig> transcription factors and  <dig> putative pathway genes identified from literature  <cit> . only one layer was built and red nodes in the second layer represent the three master transcription factors known to control the pluripotency renewal. the gene ids represented by each symbol can be found in additional file 1: table s4



implementation of the bottom-up ggm to synthetic yeast data
we generated a set of synthetic compendium gene expression data sets using the syntren software  <cit>  and the regulatory network models based upon yeast experimental data as original seeds. there are  <dig> genes each with  <dig> expression values. from these  <dig> genes, we randomly selected  <dig> non-regulatory genes, which are presumably the pathway genes, and were used as bottom layer. the remaining genes are regulatory genes that contained  <dig> positive tfs. the results are shown in additional file 1: table s <dig>  we constructed only one layer in order to make a better comparison with the result generated with arcne method. the list of top  <dig> tfs yielded from bottom-up ggm algorithm contains  <dig> the positive tfs, whereas, the top  <dig> tfs yielded from arance contain  <dig> positive tfs, indicating the evaluation of triplet genes for causal relationships may have some advantages over pairwise evaluation used by arance.

performance comparison between the networks constructed by bottom-up ggm and aracne
we ran bottom-up ggm and arance algorithm with the  <dig> wood formation genes as bottom layer, and five groups of  <dig> tfs as candidates for regulatory layer. based on the number of positive tfs that were built-in regulatory layer, we calculated the sensitivities and specificities for eight different numbers of tf cutoffs, namely, the number of tfs retained in the second layer. for arcne, we just kept those tfs that were directly dependent on wood formation genes and counted their frequencies. after the same tf cut-offs as bottom-up ggm algorithm were applied, we calculated the sensitivities and specificities. for both bottom-up ggm and aracne, we plotted roc curves ) . the dashed curves shown in fig.  <dig>  correspond to the five groups of tf inputs and the solid curve is the average of the five curves. the cohesion of dashed curves suggests that the performance of our algorithms was persistent and did not change much with different groups of tfs. we also calculated the f-scores from the averaged curves and plotted against the different tf cutoffs for both bottom-up ggm algorithm and arance . higher f-score represents better performance. to see how the performance of the bottom-up ggm algorithm changes with the size of the data set , we calculated and plotted the true positive rates  against different number of tfs in the input for same tf cutoffs . we used  <dig> tf cutoff to find the tpr in fig. 3d as there are  <dig> positive tfs in the input file. it is obvious that the bottom-up ggm has significantly higher tpr than aracne.fig.  <dig> the efficiency of bottom-up ggm algorithm. a. roc curves of bottom-up ggm algorithm resulted from five testing data sets, each contains  <dig> tfs, and  <dig> pathway genes. b. roc curves of aracne resulted from five testing data sets, each contains  <dig> tfs, and  <dig> pathway genes. c. f scores of bottom-up ggm and aracne in terms of different tf-cutoffs. d. the relationship between true positive rates  and different numbers of tfs as inputs. the tpr of aracne is uniform because it captured just one positive for various numbers of tf inputs varying from  <dig> to 1500



discussion
like ggm, we have used the first order partial correlation but adopted a biological and mathematical model integrated approach to infer ml-hgrns. our approach is based on a biological theory that when a tf exerted its control over a pair of genes, the correlation between these two genes will be either enhanced or impaired. the change in correlation is represented by a significant difference between the correlation of the pair of genes , namely, rxy, and the correlation of the same pair of genes at the absence of this tf, namely rxy| z. we implemented a multivariate delta method  <cit>  to test the significance of difference d = rxy − rxy| z in four different circumstances where the null hypothesis of zero difference. the higher accuracy of method can be at least partially ascribed to the integration of biological triplet gene regulatory model, which played significantly roles in the following aspects:  gene  reduction. by fitting differentially expressed regulatory genes and a group of pathway genes into the model based on their annotation, the dimensionality of gene space can be significantly reduced.  noise reduction. by filtering out the irrelevant genes that do not fit the biological model, we significantly reduced the noise, enabling the true regulatory relationships to be easily emerged.  reduction in gene dimensionality and explicitly defined roles of input genes in turn empowered mathematical modeling for capturing true regulatory relationships. in addition to the integration of biological regulatory model that enhanced the efficiency of the approach, the association of two paired genes under same regulatory mechanism was achieved by spearman method, a non-parametric method that measures the strength of association between two ranked variables, which was demonstrated to be extremely well-suited for associating functionally relevant genes as compared to seven other gene association methods  <cit> . spearman correlation method makes no assumption about the distribution of the data, and spearman rho measures the strength of linear/non-linear monotonic relationship between two variables  <cit> . in addition, the bottom-up ggm algorithm performs exhaustive combinations of genes, providing numerous evaluation opportunities for positive genes to be eventually emerged from large number of candidates. finally, we integrated weighted sparse canonical correlation analysis method  to determine the number of genes being kept for each layer, which in general could produce ideal number of regulators for each layer. to identify the tfs with higher interference frequency to pathway genes, one can double the λ value.

the efficiency of triplet gene model utilized in this study was experimentally validated in our earlier study  <cit> . in that study, we used a probability model and triple gene model combined approach to build a snd1-mediated two-layered hgrn in a top-down fashion with  <dig> rna-seq libraries as input. up to 97 % regulatory relationships in the built network were successfully proven by chip-pcr using snd <dig> antibodies and again verified by rt-pcr in stable transgenic lines where these targets were activated by overexpressed snd <dig>  <cit> , indicating the efficiency of triplet gene regulatory model. in addition, the early version of this bottom-up ggm algorithm was implemented to nine rna-seq libraries generated from nine independent poplar overexpression transgenic lines of microrna397a  <cit> . microrna397a targets mrnas species of different laccase genes whose proteins catalyze polymerization reactions of s, g, and h monomers during lignin biosynthesis  <cit> . we constructed a three-layered hgrns with  <dig> differentially expressed laccase genes as bottom-layer. the algorithm successfully identified microrna397a from  <dig> regulatory genes and constructed it into the secondary layer, where it directly regulated  <dig> laccase genes at the bottom layer. we chose seven laccase genes to validate using 5’race, and five of them were proven to be down-regulated in the microrna397a transgenic lines. in the network built, several transcription factors that were known to govern lignin biosynthesis were recognized by our triple gene model and built into the regulatory layers. these experimental results implicate that the networks built from our bottom-up ggm algorithm are highly accurate and trustworthy.

finally, the bottom-up ggm algorithm we developed can be used to obtain a hierarchy of tfs that are coordinated to pathway genes in expression profiles at the bottom layer. we believe these hierarchical tfs contain significantly enriched positive genes that govern the underlying pathway either directly or indirectly, allowing biologists to initiate the experimental validation. our method is compliant with the present knowledge that when the gene expression profile of a transcription factor and the profile of target gene are correlated, it is more likely that the target genes are authentic targets  <cit> . we employed robust spearman-rank correlation that has been proven to be efficiently in associating loosely and functionally coordinated genes as shown earlier  <cit>  to augment the recognition of real hierarchical tfs that collectively control underlying pathway genes. the computational validation with test data sets has shown the positive regulatory genes can be significantly enriched in the built ml-hgrns. we believe the algorithm is instrumental for constructing the hgrns that govern pathways or biological processes.

CONCLUSIONS
a bottom-up graphic gaussian model  algorithm was developed for constructing a multilayered hierarchical gene regulatory network that operates above a given metabolic or canonical pathway using small- to medium-sized microarray or rna-seq data sets. the algorithm was validated with both synthetic and real gene expression data sets, leading to the networks that were dominated with significantly enriched known positive regulatory genes in most of the cases. we believe the algorithm is in particular instrumental for biologists to identify the hierarchical regulators associated with a given biological pathway of interest for experimental validation.

