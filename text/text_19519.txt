BACKGROUND
in recent years, rna expression studies have relied on two major technologies: microarrays and high-throughput sequencing. although both of these methods have proven their utility in biological assays  <cit> , each has its limitations. microarray analyses offer low cost, transcriptome-wide assays, but are hindered by a low dynamic range of detection  <cit> . rna-seq experiments offer greater sensitivity and digital measurements of transcript abundance, but require complex sequence analysis and have a relatively high cost  <cit> . the nanostring ncounter is a novel rna-based technology whose costs and abilities place it firmly between microarrays and rna-seq  <cit> .

the ncounter allows digital quantification of multiplexed target molecules through the use of color-coded molecular barcodes and a single-molecule imaging system  <cit> . by providing discrete counts of rna transcripts, the ncounter overcomes the saturation limitations of microarrays while avoiding the complex sequence analysis necessitated by rna-seq. the platform can quantify up to  <dig> different rna targets simultaneously in up to  <dig> samples per run, making the system ideal for studying differential expression and microrna expression assays. hands-on time for the assay is under one hour and the full process from input rna to data output can be completed in one to two days.

differential expression analysis is performed differently for microarrays and rna-seq because of distinctions in the underlying technologies. microarrays measure expression levels using optical detection of fluorescent intensities. two-sided t-tests are normally used with microarray data as log normalized fluorescent intensity levels are well modelled by the gaussian distribution. rna-seq uses sequence coverage as a measurement of expression, producing discrete rather than continuous data. the use of a discrete distribution like the poisson, or more appropriately the negative binomial  <cit> , is appropriate in this case. the nanostring ncounter is most similar to rna-seq in that it processes discrete counts of measurement similar to rna-seq; as such, it is more appropriate to utilize differential expression analysis tools developed for rna-seq for data generated by the nanostring ncounter. for historical reasons and to allow comparisons, our server allows for both t-tests as well as a negative binomial-based test for the discovery of differentially expressed genes, a feature that allows us to offer an array of options in the web-based data analysis package described below.

although the technology overcomes major limitations of microarrays and high throughput sequencing, the data produced by the nanostring ncounter is not in a directly usable format and must be compiled, normalized, and analyzed using a variety of statistical methods. guidelines to achieve this are provided by the company; however, the process is complex and generally requires the use of microsoft excel running on a windows system. moreover, performing statistical analysis of the data to explore relevant trends and produce differential expression maps requires familiarity with r and associated packages like bioconductor and deseq. the use of this software and an understanding of which analyses must be performed and in what order is not part of most biologists' skill sets and so acts as a needless impediment to their effective use of ncounter data.

our nanostring web application, nanostring differential expression , provides a configurable, extremely simple-to-use interface as a front end to a fully automated analysis pipeline of r libraries and perl scripts. ncounter data is uploaded directly to the website. processed data with a differential expression heatmap is made available for download within minutes.

implementation
controls and normalization
nanostride intelligently applies positive and negative corrections, as well as a sample content normalization as per manufacturer guidelines to the raw data. the first stage applied to the data is a correction to positive controls. each nanostring experiment contains synthetic spike-in controls in the early stage preparatory mix that allow for the correction of sample-to-sample variation due to assay-specific factors such as differences in amount of input material or reagents. the positive correction is calculated by

  c×ms 

where c is count data for a gene in a given sample, m is the mean of the sum of the positive controls across all samples, and s is the sum of all of the positive controls for that given sample. the positive correction is applied to the data only if the t-test or one-way anova was chosen. deseq and one-way anova  using deseq anodev uses deseq's built in normalization methods.

after the positive correction is applied, one of four negative correction methods is employed. the negative correction subtracts background noise from the positively-corrected data using counts of sequence tags known to be absent from the assay. the first three choices of negative correction use:  the mean of the negative controls for a given sample,  the mean of the negative controls summed with  <dig> standard deviations of the negative controls, or  the maximum of the negative controls. for these choices, the negative control is applied by

  c-nforc-n≥00forc-n< <dig> 

where c is the count data and n is one of the values for the aforementioned negative controls. the fourth choice of negative control that can be applied is a one-tailed student's t-test using the negative controls as one group against all samples of a given gene as the other group, and using this to determine the significance of a given gene with a p-value cutoff. this fourth type of negative correction is applied by

  c-mforp-value<pand≥00forp-value<pand<0orforp-value≥p 

where c is all count data for a given gene, m is the mean of the count data for that gene across all samples, and p is the p-value cutoff used. if the p-value is at or above the provided cutoff , the counts for the gene are not significant and are set to  <dig> for all samples. if the p-value is below the provided cutoff, the mean for the count data for the gene are subtracted from the counts for the gene and count values that fall below zero are set to zero. as with the positive correction, the negative correction is applied to the data only if the t-test or one-way anova was chosen. deseq and one-way anova  using deseq anodev uses deseq's built in normalization methods.

the normalization employed after the positive and negative correction steps depend on the type of statistical analysis selected. if deseq or one-way anova  was chosen for the differential expression, then the normalization process used within deseq is applied to the data and the sample content normalization is not applied to the data as application of the sample content normalization and the deseq normalization would be redundant. refer to deseq for the details of the normalization process applied  <cit> . if the t-test or either one-way anova is chosen for the differential expression, then one of three sample content normalization choices is applied:

option 1: normalize to the mrna housekeeping genes. this normalization is applied by using formula  <dig>  where c is the count data, m is the mean of the sum of the housekeeping genes across all samples, and s is the sum of the housekeeping genes for a given sample.

option 2: normalize to the entire mirna sample. the normalization is employed by using formula  <dig>  where c is the count data, m is the mean of the sums of the counts for each sample, and s is the sum of all of the counts for each sample.

option 3: normalize to the highest mirna in an assayed sample. unlike option  <dig>  which uses all of the genes, this option normalizes the data to only the highest mirna counts  for a given sample  for the normalization factor.

differential expression
after all of the relevant correction and normalization steps have been applied, statistical tests are applied to determine differentially expressed genes. if the data is assumed to be distributed normally, a t-test  or one-way anova  can be performed on the sample content-normalized data to determine statistical significance. if a negative binomial distribution is assumed, deseq  or a one-way anodev  can be used on the deseq normalized to determine statistical significance. when estimating the dispersion factors in deseq used for normalization, different parameters are implemented. if only single replicates are used for each condition, the blind method is used to estimate dispersions with a fit-only sharing mode. if any condition has only two biological replicates, the pooled method is used with a fit-only sharing mode. if neither of the previous two conditions is met, a pooled method with a maximum sharing mode is used to estimate the dispersions.

heatmap generation and downloadable output
only a subset of genes whose change in expression level are statistically significant are selected for visualization in a heatmap. a user-defined p-value threshold applied to the results from differential expression analysis removes any genes with p-values at or above the cutoff value. this cutoff is applied to either the p-value or to an adjusted p-value as specified by the user. the bonferroni, holm, hochberg, hommel, benjamini & hochberg, and benjamini & yekutieli p-value corrections are available as valid adjusted p-value options. a mean cutoff is applied using the subset from the p-value cutoff, removing any genes with a final normalized count mean at or below the cutoff value. if there are two or more remaining genes, a heatmap representative of the differential expression analysis is generated on a log scale across the rows. refer to figure  <dig> for a view of the interface used to upload multiple raw data files and figure  <dig> for an overview of the normalization, differential expression analysis, and heatmap generation steps.

RESULTS
nanostride is configured to be easily accessible to biologists who employ ncounter to perform sophisticated experiments, so that they may complete their analyses without specialized training in biostatistics. a user's guide outlining how to use the website as well as details on all options and warnings is available on the nanostride website. the analyzed data from a completed job can be downloaded in a number of stages and formats from nanostride. corrected raw, normalized data, results of differential expression analysis for all probes, user settings, and customized readme file are available for download in text format.

CONCLUSIONS
the nanostride web application was developed to assist biologists with performing and interpreting differential expression analaysis from nanostring ncounter system data. the high resolution heatmaps produced by nanostride are suitable for use as figures in publications. if the user wishes to independently perform differential analysis on the data, the normalized data is additionally provided in the output of the completed job. nanostride was designed for ease of use allowing biologists with limited computational experience to perform sophisticated differential expression analysis.

availability and requirements
project name: nanostride

project homepage: http://nanostride.soe.ucsc.edu

operating system: platform independent

programming language: perl, php, r

other requirements: modern html  <dig> compliant web browser 

license: nanostride is freely available under the gpl v <dig> license and can be found on the nanostride web page on the license page.

authors' contributions
cdb designed and implemented the web interface and the corresponding backend scripts required to run the pipeline. hjk and mg participated in its design and helped to draft the manuscript. np conceived of the study, participated in its coordination and helped to draft the manuscript. all authors read and approved the final manuscript.

