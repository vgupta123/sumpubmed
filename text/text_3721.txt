BACKGROUND
tiling microarrays are widely used to detect enriched dna or rna fragments generated by, for example, chromatin immunoprecipitation or expression profiling. tiling microarrays allow for detecting simultaneously the enrichment of many fragments on a genome wide scale in an unbiased manner. this is facilitated by a high number of small probes, usually in the range of  <dig> to  <dig> nucleotides long. in order to achieve high coverage of the genomic sequence it is not possible to select the probes for their hybridization properties. thus, the affinity of the probes towards their targets varies in a sequence-dependent manner. recently, a number of approaches have been developed in order to remove the bias introduced by the sequence-dependent hybridization properties of the probes . these approaches have been shown to enhance the ability to detect enriched dna fragments compared to other methods. however, mat, ma2c and pmt not only normalize the measured intensities by removing the sequence-dependent bias but also implement a peak calling procedure that is different to other methods. hence, the improved ability to detect enriched regions may be due to the peak calling procedure.

in order to test this possibility, we employed recently published data obtained by so-called spike-in experiments  <cit> . we compared the effect of sequence-dependent probe-level normalization on the ability to detect enriched genomic regions, whose genomic locations we know beforehand. specifically, we tested three normalization methods: mat  <cit> , ma2c  <cit>  and an updated version of pmt developed by us  <cit> . as control, we normalized the measured intensities by subtracting the mean and scaling the resulting deviations from the mean such that they have a variance of  <dig> on a logarithmic scale, referred to as standard normal normalization . to separate the effects of the normalization procedure from peak calling we used the normalized intensities as input for a single peak-calling algorithm. to our surprise we found that the three sequence-based normalization methods showed an almost identical performance compared to snn. thus, the sequence-dependent probe level normalization has only a minor impact on the ability to detect enriched genomic regions. we propose that the intensities measured for the control samples are the best guide to remove sequence-dependent biases.

RESULTS
comparison of normalization methods
in order to assess the effect of sequence-dependent probe-level normalization on the ability to detect enriched genomic regions, we analyzed the data generated by so-called spike-in experiments  <cit> . the spike-in samples contained about  <dig> dna fragments of approximately  <dig> base pair length at different concentrations. otherwise the spike-in samples were exactly the same as the control samples consisting of sonicated whole genome dna. spike-in and control samples were either directly labeled and hybridized to tiling microarrays or were diluted such that these samples required amplification prior to hybridization. moreover, different microarray platforms were used, namely tiling microarrays manufactured by affymetrix, agilent and nimblegen covering the encode regions.

we used three sequence-dependent  and one sequence-independent normalization procedure ; this study). we implemented all four methods in r  <cit>  in order to assure that the same input data is used for normalization . we selected for each of the tiling microarray platforms datasets, which were performed on both amplified and unamplified samples, namely the ones provided by the struhl and gingeras , farnham and green  and mccuine  labs. we did so because we wanted to compare the effect of the amplification step on the ability to detect enriched genomic regions.

we used the raw data as input for the four normalization strategies. the resulting normalized intensities  were subsequently used in a single peak calling procedure adapted from johnson et al.   <cit> . thereafter, the predicted spike-in regions were ordered by their enrichment score and represented by the start and end coordinates of the scored window. we considered predictions, which overlapped the spike-in region as true positive and all others as false positive. in order to assure that each spike-in region is counted only once as true positive prediction, we removed all lower ranking predictions falling within the boundaries of already predicted spike-in regions.

we adopted the same assessment approach as in the original study . briefly, we determined the cumulative number of true and false positives by traversing the rank ordered list of the predictions. these numbers were divided by the total number of spike-in regions . we determined the area under this roc -like curve . here, the auc is bounded by zero  and one . in the original study, the auc is determined only in the interval between  <dig> and 10% false positives and than multiplied by  <dig> , i.e. there are only about  <dig> false positive predictions allowed. in order to compare our results to the findings reported by the original study, we adhered to this procedure.

the results of this analysis are summarized in figure  <dig>  we included as a reference the auc of the best performing algorithm using the data of each lab. note that we used the ranked list for each of these algorithms and calculated the auc values by our method, i.e. we removed multiple hits to the same spike-in region. irrespective of the platform and the sample type we found that the three sequence-dependent normalization methods perform very similarly to each other. moreover, we observed that none of them performed better than the sequence-independent snn approach. the auc values of each of the four methods compared to the best performing one were in almost all cases only  <dig>  smaller. however, our implementation of the mat method performs worse than the original implementation using both the unamplified  and amplified sample . we recomputed ranked lists using the original implementation and the same input data provided to our implementation. performance analysis revealed that auc values obtained by the recomputed ranked lists are very similar to our implementation of mat , suggesting that different input data and/or parameters led to the different results rather than errors in our implementation of the mat approach. the other exception was the auc value obtained by mat in the amplified sample hybridized to an agilent microarray by the mccuine lab . given that the confidence interval of the auc value has been determined to be around Â±  <dig>   <cit> , we conclude that sequence-dependent normalization does not increase the ability to detect enriched genomic regions.

in contrast to our conclusion, earlier studies reported that sequence-dependent probe-level normalization increases the ability to identify enriched genomic regions  <cit> . we think that the major performance increase is not due to the normalization procedure but rather due to the peak calling approach utilized after pre-processing the raw data. peaks are predicted by calculating the trimmed mean of signal values in a sliding window, where the 10% highest and lowest values are discarded. the resulting trimmed mean is multiplied by the square root of probes contained in the corresponding window  <cit> ). we refer to this approach as trimmed mean, which seems to perform very well compared to other methods  <cit> .

in order to check whether the trimmed mean approach performs exceptionally well, we compared the performance of this approach to algorithms that have been reported to perform best for the respective dataset  <cit> . in almost all cases the trimmed mean procedure received auc values within the aforementioned confidence interval of the best performing algorithm. only for the amplified sample hybridized to the agilent microarray by the mccuine lab the results for ma2c, pmt and snn were much better than for the reported adm- <dig> algorithm. however, we note that most of the ranked lists reported by the original study contained only a single chromosomal coordinate per predicted spike-in region, such that the auc results may not be directly comparable. irrespective of this concern, we conclude that the trimmed mean procedure is not better but also not worse than other existing methods.

finally, we compared the performance of the four normalization methods in the two types of samples, i.e. amplified or unamplified. we reasoned that we could minimize the effects of different experimental procedures by comparing datasets generated by the same lab. amplification had a negative impact on the ability to detect enriched regions only in the experiment employing affymetrix tiling arrays, while it had no effect using agilent or nimblegen arrays . the decrease in specificity was due to a decline of the recall rate across all spike-in concentrations in the experiments involving affymetrix tilling arrays. comparison of the concentration-dependent recall rates for the amplified and unamplified samples interrogated by agilent and nimblegen tiling arrays showed no such behavior . however, we think that this negative effect of amplification cannot be attributed to the affymetrix platform, as datasets generated by the brown lab interrogating an amplified sample by another affymetrix tiling array yielded comparable results to the ones obtained by struhl and gingeras using an unamplified sample . the difference between the two affymetrix tiling arrays is the number of probes spotted on the array, i.e. the spatial resolution. the array used by the struhl and gingeras lab had ~ <dig> times more probes than the one used by the brown lab. we speculate that pcr amplification results in a preferential enrichment of short dna fragments, which are more easily mistaken for real enrichment in tiling arrays with higher spatial resolution. thus, we conclude that amplification per se has no negative impact on the ability to detect enriched genomic regions, but limits the detection of these loci using tiling arrays with high spatial resolution. furthermore, we speculate that the lower performance of the affymetrix array interrogating the unamplified sample has a similar explanation. based on this assumption we propose that tiling arrays with high spatial resolution require a refined peak calling procedure that accounts for the possibility of false positive detection of small dna fragments.

standard normal normalization
contrary to our expectation that sequence-dependent probe-level normalization increases the ability to detect enriched genomic regions, we found no evidence for such an effect. our "control" normalization procedure, snn, performed in most of the cases similar to the three sequence-dependent normalization approaches, suggesting that it effectively removes biases due the sequence composition. the snn procedure consists of three steps:  transformation of the intensities to a logarithmic scale ;  subtraction of the mean log intensity, which is intended to remove systematic shifts in the intensity distribution between arrays ;  division by the standard deviation, which is intended to remove differences in the intensity scales.

these operations are in general not able to remove the sequence-dependent biases of the intensities measured by each individual array and/or channel. the correlation between the snn normalized intensities and, for example, the gc content remained unchanged. the picture dramatically changes if we consider the dependency between the ratio of the intensities measured for the spike-in and the control samples on a logarithmic scale  and the gc content. here, we found that the division of the standard deviation effectively removed most of the sequence inherent biases observed by only subtracting the mean log-intensity . thus, the control hybridization is the best guide to remove sequence-dependent biases, but it has to be properly rescaled in order to display its normalizing character.

CONCLUSIONS
we have demonstrated that sequence-dependent normalization hardly improves the detection of enriched genomic regions. we were able to draw this conclusion by utilizing spike-in experiments, which emphasize the requirement of clear-cut benchmarks to recover the advantages and disadvantages of analysis approaches. we found that the "success" of the sequence-independent normalization method, referred to as snn, can be attributed to the normalizing character of the control experiment, which depends on a proper scaling of the measured intensities.

