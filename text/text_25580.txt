BACKGROUND
cancer is initiated and driven by aberrant genetic events, such as copy number aberrations , called the drivers of cancer. further, quite a few cancer, such as breast cancer  <cit> , glioblastoma  <cit>  and medulloblastoma  <cit> , are confirmed to contain subtypes, with distinct inter-subtype molecular profiles and clinical outcomes. different subtypes may have arisen because of different mechanisms, such as hits on different pathways and/or different cells-of-origin  <cit>  within the same tissue/organ. stratifying the patients into appropriate subtypes is the key to uncover the drivers of these mechanisms. this step, referred to as the subtyping of cancer, usually relies on the class discovery of cancer expression datasets.

there is a large body of techniques available for class discovery within a cancer dataset, such as spectral clustering  <cit> , non-negative matrix factorization  <cit> , etc. a straightforward and one-step strategy is to employ one such technique to train the class labels for a group of samples, and detect the set of most differentially expressed genes  using the trained labels and the same expression data. the set of degs, called the gene signature, can be used for functional analysis of the corresponding subtype.

on the other hand, genetic aberrations enriched in a cancer subtype may also be related to, or even have causal roles in the corresponding subtype. particularly, one type of genetic events, cna, is widely found in the cancer genomes  <cit> . cnas are also found to be positively correlated with the raw expressions of affected genes  <cit> . in some cancer, such as medulloblastoma, the cna patterns are also found to be subtype-dependent  <cit> . however, given the large number of cna-affected genes that often occur within a cancer genome, it is not practical to assume that all of them are tumorigenic. instead, most of the cnas may just cause mechanic responses in the affected genes' expressions, but otherwise are not related to the cancer process. apart from these, a small proportion of cnas may be involved in the initiating, driving or sustaining of the cancer process, which also gives rise to the subtype-specific signature. this is summarized in the hypothetical diagram in figure  <dig>  the diagram indicates that the gene signature not only reflects the underlying processes characterizing individual subtypes and hence can be used for subtyping; but may also be used to trace the subtype-specific drivers.

in recent years, tools such as gistic  <cit>  have gained increasing popularity for their capabilities to discover recurrent cna patterns of a clinical condition. genes within these recurrent patterns are assumed to be pathologically and clinically important. unfortunately, in the highly twisted cancer genomes, recurrent regions tend to occupy broad regions and harbor hundreds of genes or more, making it less specific to equate these genes to cancer drivers. a recent study  <cit>  attempts to relate recurrent cnas with co-expression modules, in an effort to find melanoma drivers, in a subtype-non-specific manner.

here, we focus on the subtype-signature and within-subtype recurrent cnas; and propose an integrative approach to perform subtyping and driver-identification. the approach consists of two stages. first, given a cancer expression dataset, perform subtyping to train class labels for individual cases and detect signature genes for each subtype . second, cna measurements  corresponding to samples of each subtype are subjected to pre-selection procedures, e.g. gistic, for a reduced set of driver candidates. the driver candidates are then ranked in order of correlation with the corresponding subtype's signature genes. the top ranked candidates will be manually reviewed for their potential roles in the subtypes. the approach is summarized in figure  <dig>  the following describes key issues regarding the algorithmic design for these two stages at the concept level, with further details in methods.

iterative subtyping
the one-step approach described above is both easy to implement and computationally efficient. however, it may suffer from overfitting, as the determination of the number of clusters given a clustering dendrogram can be quite arbitrary. this is because the relation between the class labels and the signature genes is not considered. suppose there are k inherent subtypes, each with a set of signature genes, the large number of non-signature genes, together with measurement noises, may blur the subtype boundaries. this results in multiple ways of cutting a dendrogram, as in the case of medulloblastoma where various numbers of clusters have been reported  <cit> . as a result, different degs will be produced by different methods on the same disease. yet as depicted in figure  <dig>  the real pathway-related degs  should be inherent in each subtype but not dependent on how the dendrogram is cut.

to address this issue, we first introduce a regularization by defining a subtype as the smallest group of samples that share a substantial set of degs . this is to ensure that on the one hand, as many subtypes are uncovered as possible, while on the other hand, each of them is characterized with a sufficient number of signature genes. in practice, this can be implemented by starting with a large number and cutting the resulting dendrogram into corresponding number of clusters. the subtype-signature detection  is applied to the resulting clusters. the resulting clusters can be categorized into good clusters and bad clusters. the former has a sufficiently large number of signature genes, while the latter has fewer than a certain percentage of total signature genes. cases of the bad clusters are re-assigned to their closest good clusters. further, since the inherent signature genes determine the class boundary more than non-signature genes, the union of the signature genes after one iteration may be used as input to inform the subset of genes on which clustering is to be performed, in the next iteration.

the next iteration will attempt to cut the dendrogram into the same number of clusters as the good clusters in last iteration. this is based on the assumption that each step of clustering and signature detection produces a set of signature genes that is getting closer to the genuine signatures. the above procedure ensures that the number of clusters to be tested is monotonously decreasing. to avoid k being trapped in small numbers, at each iteration, the number of clusters to be tested is increased by a small margin Δk above the number good clusters in the last step. in this way, this algorithm is made to favor a larger number of patterns over smaller ones, if both have sufficient numbers of signatures genes.

the above procedure is iterated until the algorithm converges, indicating that the optimum where maximum number of subtypes each with a sizable signature has been reached. our iterative approach can be compared to the iterative algorithm for a bounded  optimization problem. in cutting the dendrograms, resulting clusters that contain only one case are considered unlikely to be a subtype and are re-assigned to other core clusters . the procedural implementation of the algorithm is given below.

given an expression dataset e∈ℝn×m with n samples and m genes, select an initial set of genes, say the top 10% of genes with largest variances, to yield a reduced dataset  Ê. start with a  large number k, the algorithm consists of the following steps:

 <dig>  perform clustering  on  Ê, and form a dendrogram.

 <dig>  cut the dendrogram into k clusters. if this results in some clusters with one sample, assign these samples to their closest clusters. consequently, we obtain k′ core clusters .

 <dig>  detect the signature  sk for each subtype k ∈ { <dig>  .., k′}, using the original dataset e.

 <dig>  obtain the union of signatures: Φ = s <dig> ∪ … ∪ sk′.

 <dig>  for clusters  whose signature genes are fewer than a percentage of |Φ|, the cases in these clusters are re-assigned to their closest good clusters. this results in a total number of clusters k″ ≤ k′.

 <dig>  replace the above  Ê with one that is based on the set Φ.

 <dig>  update k = k″ + Δk, where Δk is a small positive integer.

 <dig>  repeat steps  <dig> to  <dig>  till a certain convergence criterion is reached, e.g. the number of subtypes remains unchanged.

the subtype-specific driver identification
according to figure  <dig>  even within a subtype, there could be different driving events. here, we focus on the dominant subtype-specific events, i.e., cnas. a cna-affected gene can activate the cancer process through its cna-induced aberrant expressions. therefore, its expression may be correlated with the signature genes, which are believed to be the consequences of subtype-specific processes. this problem is equivalent to finding variables in one set that maximally correlate with another set of variables, a problem known as canonical correlation analysis   <cit> . particularly, given a subtype k and its signature sk and l pre-selected candidate cna genes, two vectors of variables xa∈rj× <dig> and xb∈rl×1are used to denote the expressions of them, respectively. the objective is find two vectors wa∈rj× <dig> and wb∈rl× <dig>  such that:

  ρ=watcabwbwatcaawawbtcbbwb 

is maximized, where cab is the between-set covariance matrix and caa and cbb are the within-set covariance matrices. the pre-selected candidates whose absolute weightings |wbl| are largest are assumed to be related with the signature genes, whereas those whose weightings are close to zero as assumed to be not related. similarly, signature genes whose absolute weightings are large can be assumed to be related with the candidates. if thresholds are chosen, solutions to the above problem result in a cna-regulated network consisting of subsets of signature genes and pre-selected candidates.

in solving eq. , techniques such as sparse canonical correlation analysis   <cit>  kernelize the covariance matrices, and reduce the problem to:

  maximizewa,wbwatcabwb+μ|wa|+μ|wb| 

subject to watcaawa=watcbbwb= <dig> . this avoids the hard thresholds above, but the solution is highly sensitive to the hyperparameter µ. note that the magnitudes of wa and wb do not matter, e.g., if watcaawa≠ <dig>  one can replace wa with w~a=wa/watcaawa. the key becomes finding the directions of wa and wb such watcabwb is maximized. this is similar to the idea of principal component analysis . specifically, we may assume that a row-wise zero-mean operation has been applied to cab. a pca approach can next be applied to determine the correlation of each cna with the set sk, as follows:

a. perform an svd:cab=uΣvt, and then project cab onto the first principal component u <dig> of u, to give ŵb=cabtu <dig>  the individual entry of ŵb represents the overall correlation of each cna gene with the set of signature genes.

b. for a candidate cna gene l ∈ { <dig>  .., l}, the more positive ŵbl the more gene l is positively correlated with sk, and vice versa. therefore, the values of ŵb serve as indicators of driver potential for the candidate cna genes. for convenience, ŵbl referred to as the driver potential of a candidate.

c. the p-values of ŵb can be obtained by generating a random set of signature genes and repeating the above procedure to produce a null distribution for ŵb. the candidate drivers can then be ranked by their p-values.

in the above, if we let ŵa=u <dig>  then ŵatcabŵb=u1tcabcabtu1=σ <dig>  where σ <dig> is largest singular value of cab. note that the above procedure may not lead to the maximum value for ρ in eq. , but as shall be shown in the results, it effectively detects signature-related candidates.

RESULTS
to implement the proposed approach, we applied it to medulloblastoma  datasets. mb is a pediatric brain tumor that usually affects children below the age of  <dig>  the overall five-year survival rate for mb-affected children is poor  and varies a lot from patient to patient, subject to different predisposition conditions. integrative genomic studies  <cit>  in recent years have attempted to classify mb patients into various numbers of subtypes, two of which are well-accepted, namely, the wnt- and shh-pathway associating subtypes, respectively. for the remaining non-wnt/non-shh patients, there are still debates on the exact number of subtypes inside this group.

dataset-independent convergence of the subtyping algorithm
we applied the subtyping algorithm to three expression datasets of medulloblastoma. the set of genes with top 10% variances was chosen to be the initial gene set for the algorithm. clusters with fewer than 1/ of all detected signature genes were determined to be bad clusters, where k′ is the core cluster number as defined in the algorithm above, and Δk was set to  <dig>  the key parameter that defines the degree of specificity of a deg, the subtype-specific fold change threshold  , was varied from  <dig> to  <dig>  on all three datasets , to assess the convergence properties of the algorithm. as shown in figure 3a-c, in all three datasets, as the fct increases, the convergence is enhanced. for example, when fct is  <dig>  or  <dig> , the algorithm efficiently converges to three in all datasets. whereas, when the fct is small, e.g.,  <dig> ,  <dig>   or  <dig>  , a slight change in the fct causes the algorithm to converge to different numbers of clusters , or not converged at all . this suggests that the subtype-specificity imposed on signature selection does increase the convergence of the iterative algorithm.

we then fixed the fct to be  <dig> , and varied the initial number of clusters, from  <dig> to  <dig>  as shown in figure 3d-f. again, the algorithm converges within several iterations on all datasets to the same number of clusters, namely three clusters. figure  <dig> shows the numbers of cases and signature genes in each subtype as the algorithm converges, and the converged dendrograms, after  <dig> iterations. as a comparison, the aforementioned one-step approach using the same initial set of genes and same clustering method  was applied to the three mb datasets and the resulting dendrograms are shown in figure s <dig> . it appears that the converged dendrograms in figure  <dig> demonstrate much clearer subtype boundaries than the corresponding dendrograms in figure s <dig> 

cross-dataset validations of identified subtypes and characterization of them by signatures
since the datasets all converge to three subtypes, they are labeled as subtypes a, b and c. to test if the converged subtypes are dataset-independent, we performed two analyses. first, the converged signatures of the datasets were compared in a pairwise manner, as shown in table  <dig>  from the table, the detected signatures are highly specific to their corresponding subtypes and highly reproducible on different datasets. second, we performed cross-validations by using one dataset and its trained labels and signatures to predict the labels of another dataset, and vice versa. the datasets were normalized  before being used for cross-validations and the k-nn method  was used to predict the labels of the testing sets. the predicted labels were compared with the testing set's self-trained labels to form a confusion matrix, from which the accuracy can be computed. table  <dig> shows the cross-validation results. all the cross-validations have accuracies higher than 95%. these two analyses indicate that the identified subtypes are highly stable and independent of datasets.

the datasets have different numbers of probe-sets and were normalized separately, leading to different numbers of signature genes for different datasets of a subtype. o.v.g.=overlapping genes; s.g.=signature genes; n.s.g.=negative signature genes.

this table shows the numbers of cases in each testing set predicted to be of a subtype trained by the training set . for example, the "2" in the testing set kool <dig> indicates that  <dig> cases were self-trained to be of subtype b, but predicted to be of subtype c by the cho <dig> dataset. accu.=accuracy.

to characterize the converged subtypes, the gene signatures in the converged iterations were examined. additional file  <dig> - table s <dig> shows the pathway enrichment analysis of subtype signatures by gsea  <cit> . from the table, subtype a is significantly enriched with wnt-pathway genes, while subtype b is enriched with shh-pathway genes. a comparison of the cases in subtypes a and b with studies that published the data  confirms that these two subtypes are the wnt- and shh-pathway associating pathways, respectively. for convenience of discussion, these two subtypes are referred to as the wnt and shh subtypes, respectively. examples of key signature genes of the subtypes  are shown in figure  <dig> .

from figure  <dig> and additional file  <dig>  it can be seen that the detected signature genes are specifically up-regulated or down-regulated in a particular subtype, and the inter-subtype variations in the non-specific subtypes are highly suppressed. most importantly, these subtype-specific degs are not only numerically correlated but also functionally related. for example, the five genes in figure 5a are all involved in the wnt-pathway. fzd <dig> codes for the protein frizzled, which is a membrane receptor for wnt. its abundant expressions may lead to the activation of wnt pathway. lef <dig> codes for a key transcription factor of the wnt pathway and is responsible for the transcriptions of many wnt target genes. of interest, a number of genes that have antagonistic roles, such as the dkks  and axin <dig>  <cit> , are also up-regulated. these genes might be the consequences of negative feedback controls of the activated pathways. a similar phenomenon can be found in shh , where gli1/ <dig> are the key transcription factors and are specifically up-regulated, resulting in targets such as hhip  <cit>  and ptch <dig> being highly expressed, too. hhip in return regulates the shh-pathway  <cit> , while the protein patched encoded by ptch <dig> negatively regulates the shh-pathway  <cit> . indeed, inhibition of ptch <dig> is among the recent attempts to find drug targets for cancers including medulloblastoma  <cit> . overall, these signature genes confirm our hypothesis that they are the consequences of the subtype-specific cancer processes.

the third subtype  has the largest number of patients in all three datasets. note that, this group was further divided into various numbers of subtypes, as shown in additional file  <dig> - table s <dig>  indeed, in the iterative process, our algorithm also detects that there can be four or five core clusters in the kool <dig> datasets . but gradually, core clusters containing too few signature genes were determined to be bad clusters and cases in them were re-assigned to their closest good clusters, before the algorithm converges. to further investigate the problem, we used our signature detection algorithm and the labels reported by the original studies to detect signature genes for the subtypes. as shown in additional file  <dig> - table s <dig>  many subtypes claimed by previous studies contain extremely low numbers of signature genes, i.e., subtype-specific degs. for example, group d in the northcott <dig> dataset contains only  <dig> signature genes, and subtype c in kool <dig> contains only  <dig> signature genes. we then used cases of each of the non-wnt/non-shh  subtypes, with cases of the wnt and shh subtypes, and the normal cases to detect signature genes  for each of the nws subtypes claimed by the previous studies. it turns out that these nws subtypes have high overlaps in signature genes . for example, group c and group d in the northcott <dig> dataset have  <dig> overlapping signature genes, which is more than 40% of the signature genes in both groups. similarly, the nws subtypes c, d and e in kool <dig> have  <dig> overlapping signature genes, which is about 20~40% of the signatures of the corresponding subtypes. although in the cho <dig>  the five nws subtypes have only one overlapping signature gene, when only selective nws subtypes are considered, substantial overlaps can be seen. for example, subtypes  <dig> and  <dig> share  <dig> signature genes, which is more than 35% in both subtypes. this further confirms that signatures of these subtypes are highly overlapping, which in turn means that the nws subtypes are functionally overlapped with each other. given these analyses, it is reasonable to favor the convergence results above by referring to all nws cases as one subtype, namely, the nws subtype.

each row represents the numbers of signature genes for the wnt, shh and one of the nws subtypes , respectively. the total overlaps refer to the intersection of all signatures of a group in each dataset, e.g., |ssubtype c ∩ ssubtype d ∩ ssubtype e| =  <dig>  selective overlaps refer to the intersection of the signatures with the same symbol. the difference between this table and table s <dig> is that in the latter, all subtypes are trained together, while in the former, only one of the reported nws subtypes is trained at a time with the wnt, shh and normal cases for detection of signatures. s.g.=signature genes.

note that, the nws seems to be more negatively regulated than other subtypes, as it contains more negative signature genes than positive ones , while the wnt and shh subtypes have far fewer percentages of negative signature genes . indeed, not only was the numbers of nws subtypes not clear, the functional characterization of them has not been as successful as the wnt and shh subtypes either, where dominant pathways exist evidently. the signature genes by this study may give a hint on the underlying process of nws. as shown in figure 5c, a wnt-pathway inhibitor nlk  <cit>  is specifically up-regulated. also negatively regulated are the notch pathway receptor notch <dig> and the growth factor pdgfa. the suppression of these genes indicates that as compared with wnt and shh, where the key pathways are activated, nws may have an opposite mechanism, namely, some key pathways are inactivated. in all, our study confirms the hypothesis that gene signatures define the subtype boundaries and unveil subtype mechanisms. finding the correct boundaries depends on sufficient signature genes contained in the subset of genes used for clustering, and detecting the signatures depends on the correct subtype boundaries. this justifies the above iterative subtyping algorithm.

subtype-specific copy number landscapes and candidate driver pre-selection
copy number profiles of the two datasets with publicly available snp arrays, cho <dig> and northcott <dig>  were inferred as described in methods. the copy number landscapes are show in additional file  <dig> - figure s <dig>  as shown in figure  <dig>  profiles of each subtype are further processed with gistic  for detection of recurrent cnas within each subtype. copy number profiles with log2- <dig> greater than  <dig>  are considered to be copy number gains, while those below - <dig>  are considered to be copy number losses. the subtype-specific gistic landscapes of the cho <dig> dataset is shown in figure  <dig>  and those for the northcott <dig> dataset is shown in additional file  <dig> - figure s <dig>  the q-value threshold of  <dig>  is used to determine recurrent cna regions. genes  within these regions are considered to be cna-affected genes. the numbers of cna-affected genes are tabulated in additional file  <dig> - table s <dig> 

as figure s <dig> and table s <dig> show, the copy number landscapes and gistic landscapes demonstrate extremely strong subtype-specificity. for example, subtype a is dominant with chr <dig> deletions, and subtype b is characterized with chr <dig> deletions. subtype c is more complex, cnas are observed in chr7- <dig>  chr <dig>  chr16- <dig>  etc. these patterns are also highly dataset-independent. the overlapping candidates in table s <dig> were taken to be the pre-selected cna candidates.

testing the driver identification algorithm with synthetic data
to test the driver identification algorithm, we generated a synthetic gene expression dataset with  <dig>  genes and  <dig> cases. entries of the dataset were initialized with identically and independently distributed standard gaussian noises. the first  <dig> genes are assumed to be signature genes and the next  <dig> are assumed to be candidate genes, while the remaining  <dig>  genes are assumed to be non-signature and non-candidate  genes. each of the candidate genes i is given a weighting of wi. we added synthetic inter-dependencies to the signature and candidate genes by updating each signature gene with x˜j=∑iwicijxi+xj, where xi and xj are the initialized gene expressions of the i-th candidate and j-th signature genes, respectively; and cij is a random number ) indicating the regulating potential of candidate i on signature j. we tested the algorithm with four types of wi, namely, wi ~ u, wi ~ u <cit> , wi =  <dig> and wi ~ u. as additional file  <dig> - figure s <dig> shows, when wi are initialized with non-positive random numbers, the estimated driver potentials ŵ′s are significantly lower than those of the nsnc genes. similarly, when wi are initialized with non-negative random numbers, ŵ′s are significantly higher than those of the nsnc genes. when wi= <dig> ŵ′s have no significant differences in the signature or nsnc genes. and when both positive and negative weightings are used, although no significant difference is observed in the means, the tails of the two distributions are very different. particularly, the distribution of ŵ′s for the signature genes has longer tails on both sides.

this study indicates that the technique is able to identify the potential drivers by using the nsnc genes as the null model, if the inter-dependencies between the drivers and the signature still exist at the time of measurement.

subtype related driver candidates revealed by driver identification
the above technique was applied to the two datasets cho <dig> and northcott <dig>  where both expression and cna profiles are available. additional file  <dig> - figure s <dig> shows the candidate and null distributions for the subtypes in both datasets. the curves demonstrate similar patterns in different datasets for the same subtype. for example, in subtype a , cna candidates of both datasets tend to have longer negative tails, while in subtype b , cna candidates of both datasets tend to have longer positive tails. in subtype c , cna candidates of both datasets have slightly longer tails than the null distributions. further, the significant candidates are found to be highly reproducible .

CONCLUSIONS
in this work, a two-stage algorithmic framework was developed to perform gene-signature based cancer subtyping and to identify subtype-specific cna drivers. the algorithm was applied to datasets of medulloblastoma, producing dataset-independent subtyping results. the driver identification results were found to be enriched with cancer-driving pathways. this study is novel in the following three aspects.

first, the signature-based subtyping technique ensures that as many subtypes are uncovered as possible while each of them is required to have a sufficient number of signature genes. this emphasis on subtype-specificity of signature genes allows for functional interpretation of the cancer process or pathways underlying each subtype. this procedure is not only a technique, but also a concept of viewing cancer subtypes.

second, a comparison of our results with previous results indicates that the non- wnt/non-shh subtypes have high overlaps in their gene signatures, resulting in their merger into one single subtype  by our algorithm. although distinct clusters can be observed in the nws subtype, the fact that their signature genes are highly overlapping suggests that these distinct clusters may be due to non-functional causes, such as different copy number profiles, different cells-of-origin, etc. therefore, it is not appropriate to classify them as expression subtypes, and a future direction would be to extract copy number subtypes that explain these distinct clusters under nws.

third, the proposed driver identification method relates the within-subtype recurrent genetic events to the subtype signature based on the strengths of their inter-dependencies. the idea to conduct this in a subtype-specific manner echoes the ultimate purpose of subtyping: towards more refined understandings of the disease. this idea can be further explored. for example, as depicted in figure  <dig>  most of the cnas may be passengers, and some cna drivers may have hit-and-run properties, i.e., inter-dependencies do not hold by the time of measurements . this makes them non-observable by the current method. further, other types of candidate drivers, such point mutations and dna-methylation, may be screened as well.

