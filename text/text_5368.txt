BACKGROUND
the affymetrix exon  <dig> st arrays contain approximately  <dig>  million probes which are grouped into  <dig>  million probesets, targeting over  <dig> million exons. the data generated from these probe signals can be summarised into probeset signals to provide a measure of expression of individual exons. these probesets in turn can be assembled into virtual transcript clusters based on annotations of gene structure. by combining signals from probesets mapping to the same transcript cluster, an expression measure for that transcript cluster  can be calculated. the arrays make it possible to observe differential exon inclusion or skipping, therefore providing an extra dimension of genomic information beyond the classical gene expression results from microarrays  <cit> .

gene-level summary and analysis
the main challenge for gene-level analysis is estimating reliable gene expression measures from the probe signals. probesets are associated only with exons and the grouping of exon probesets into genes is a dynamic post-design process  <cit>  based on genome annotations obtained from sources of varying quality . the array design includes probesets targeting predicted exons, which though have lower confidence annotations, enable the detection of novel exons and splicing events. however, including such probesets to estimate gene expression can have a negative as exons with low confidence annotation, such as computational exon predictions, will have a lower probability of being present in the cell compared with well-annotated exons. affymetrix have therefore classed probesets into  <dig> categories: core probesets , extended probesets  and full probesets . analysis of exon array data by xing et al.  <cit>  suggests that extended and full probes are usually poor indicators of overall gene expression. estimating gene-level expression is further affected by the degree of alternative splicing and the number of cross-hybridising probes . if a gene contains a large number of core probesets that target alternatively spliced regions this may lead to under-estimation of overall gene expression, while a large number of cross-hybridising probesets may lead to over-estimation of overall gene expression.

there are two commonly used algorithms for generating gene-level summaries from the raw exon array data: rma   <cit>  and plier   <cit> . these are implemented in the affymetrix power tools  software which is freely available from the affymetrix website. apt allows the selection of either the core, extended or full affymetrix transcript cluster annotations for gene-level signal estimation. the affymetrix transcript cluster library files, which are used by apt to determine which probesets should be used for generating gene signals, only include unique probesets. this reduces errant gene signal estimations due to cross-hybridising probes. robust methods such as rma and plier should be minimally affected by a limited amount of alternative splicing at a particular locus  <cit> , but are still prone to misestimates when a large number of exons are differentially spliced.

once the gene-level summaries have been generated, the data can be analysed to identify differentially expressed genes between sample groups, using a statistical method of choice. a very popular bioconductor  <cit>  package used for differential expression analysis is the linear models for microarray analysis   <cit> . the package simplifies the analysis of complex experiments by using linear models to analyse the data, making it possible to simultaneously carry out multiple comparisons between sample groups. the analysis uses a moderated t-statistic which has the same interpretation as an ordinary t-statistic except that the standard errors are adjusted using an empirical bayes method, making the analyses stable even for experiments with small array numbers  <cit> . a differential gene analysis using limma on rma-summarised tissue data from the human genome u <dig> plus  <dig> , human exon  <dig> st and human gene  <dig> st arrays showed that gene-level reproducibility and differential expression detection are quite similar across the three platforms  <cit> .

alternative splicing analysis
the simplest method to detect alternative splicing is the splice index  method  <cit> . this assumes that in the absence of splicing the observed signal from each exon will have a constant ratio with the observed signal from the corresponding gene. the exon/gene  ratios are referred to as gene-normalised exon intensities. if this ratio differs between two groups it is indicative of splicing. several tools are available, including apt, which apply an anova model to the gene-normalised exon intensities. in the case of two sample groups the anova model reduces to a t-test. for multiple sample groups, the anova model will provide only a single p-value indicating the probability that a transcript has differential alternative splicing. to determine in which sample groups the exon splicing is occurring either a post-hoc tukey analysis can be done or a contrast matrix including all comparisons can be constructed. the limma package in bioconductor has the framework for the latter, and conveniently reports statistics for all comparisons as well as handling the multiple testing problem. limma also uses an emperical bayes approach for estimating sample variances. the moderated t-statistic calculated by limma is more robust than the ordinary t-statistic with small sample sizes  <cit> . for these reasons we chose to use limma instead of anova. it is already a widely used package but so far has only been used for differential gene expression analysis. in this paper we propose a workflow for detecting differential exon splicing using limma. the workflow is designed to reduce false positives by including filtering steps, which are discussed later. apt is used initially to generate the gene and exon summaries, as the software has been optimised for this memory-intensive step. all subsequent steps in the workflow are carried out using r and bioconductor. the packages included in the standard bioconductor  installation are sufficient to carry out the alternative splicing analysis and no additional packages, software or database installations are required.

the use of the si method with limma , though successful at identifying tissue-specific splicing events, was prone to false positives resulting from inaccurate gene-level estimations. the si/limma method is also sensitive to large differences in gene expression level between sample groups which can amplify the noise  <cit> . to tackle this issue we introduce the concept of a gene correlation coefficient to identify differential gene splicing. this approach was proposed after observing that for many genes the probesets expression signals were found to be highly variable , but the expression pattern of the probesets across a gene was highly correlated in all samples when differential splicing was absent i.e. if a probeset had a lower intensity signal than the adjacent 5' probeset but higher than the adjacent 3' probeset in one sample, this pattern was seen in all other samples. in the presence of differential splicing, the probeset expression pattern for a gene will be disrupted in one group leading to a decrease in correlation between the two groups. we hypothesise that in the absence of differential splicing we would expect a correlation coefficient close to  <dig>  differences in splicing and therefore differences in probeset signal pattern between the two groups will result in lower correlation. the advantage of using a correlation coefficient approach is that it does not require gene-level estimates.

we applied the si/limma and correlation methods to the affymetrix human tissue public dataset  to identify tissue-specific splice events. the data set consists of  <dig> samples . the limma analysis identified several tissue-specific splicing events that were supported by previous experimental studies. these tissue-specific splice events were also found to have the lowest correlation coefficients in the respective tissue comparisons. we also compare results from previous exon array studies. our results indicate that the si/limma approach is better for identifying genes that have only single or few exons differentially spliced while the correlation approach is better for identifying larger differences in transcript structures. the si/limma method also works better when probeset expression within a gene has low variability as this allows for more robust estimations of gene signals while the correlation coefficient obviously works well when probeset expression within a gene is highly variable. the two methods can therefore work complimentary to identify different subsets of differentially spliced genes.

RESULTS
using limma to identify splice events
gene and exon-level summaries were generated using the rma algorithm implemented in apt. we restricted our analysis to identify differential splicing of well-annotated exons and therefore used only core probesets and transcript clusters for generating gene- and exon-level summaries. to find statistically significant tissue-specific splicing events, limma was applied to the gene-normalised exon intensities, which were calculated in r. eleven contrasts were made simultaneously . for each probeset in each contrast limma reported the log fold change , moderated t-statistic, the raw p-values and the adjusted p-values . probesets with benjamini-hochberg-adjusted p-values less than  <dig>  were considered statistically significant.  <dig> probesets mapping to  <dig> transcript clusters passed the stringent p-value threshold in at least one out of the eleven comparisons. upon visual inspection of the exon expression levels using expression plots, a large number of the significant probesets were found to be false positives. these probesets were misidentified  when a probeset is non-responsive or an exon is not expressed in all samples   and when a probeset is cross-hybridising .

filtering expression data to reduce false positives
to reduce false predictions of alternative splicing events filtering steps were applied to the data prior to limma analysis:

 <dig>  affymetrix has categorised probesets as either unique , similar  or mixed . probesets that are not unique were removed from the exon-level data.

 <dig>  to reduce false positives caused by unexpressed genes and/or exons spliced out in all samples, a simple approach was used where probesets and transcript clusters that were found in the lower quartile of the intensity distribution in all  <dig> samples were filtered out .

 <dig>  despite the fact that the splicing index approach is designed to mitigate differences in gene expression level, previous experience has shown that very large differences in gene expression level can amplify the noise leading to potential false positives  <cit> . therefore, the analysis was also done on a subset of low variance genes. transcript clusters found in the quartile containing the highest sample-to-sample variation were excluded.

the workflow incorporating these steps is shown in figure  <dig>  the limma analysis was performed on unfiltered data, data filtered for cross-hybridising probesets and low/unexpressed probesets and transcript clusters  and data using a subset of low-variant transcript clusters from the filtered dataset a .

the number of probesets with benjamini-hochberg-adjusted p-values less than  <dig> , for each data set, is shown in table  <dig>  more than half  of the probesets that had passed the p-value cut-off in the unfiltered data were removed as they were either cross-hybridising or had very low signal in all samples . we used the affymetrix annotation files to obtain probeset and gene annotation. expression plots and transcript structures from the x:map genome browser  <cit>   were used to map probesets to exons and to try and deduce which transcripts were being expressed in the different tissues.

the table shows the number of probesets with benjamini-hochberg-corrected p-values less than  <dig>  in each of the  <dig> comparisons for the unfiltered and filtered datasets. the table also shows the number of transcript clusters  that were found to contain at least one significant probeset.

several known tissue-specific splice events were identified in all  <dig> datasets, with their significance ranking and p-values greatly improving when the data was filtered . to validate some of the splicing events identified by the analysis, we tried to map the expression data to known transcript structures and searched for literature evidence supporting the tissue-specific expression of the exons. below are examples of  <dig> genes identified by si/limma to have tissue-specific splicing in at least one tissue

table showing the effect of filtering on the ranking of real splice events. all the probesets in the table had a benjamini-hochberg-corrected p-value less than  <dig>  and for each there is literature evidence of the identified splicing events.

wnk lysine deficient protein kinase  <dig> 
wnk- <dig> codes for a serine-threonine protein kinase which controls sodium and chloride ion transport and it is known to be expressed in a wide variety of tissues  <cit> . the kidney vs. non-kidney limma analysis of filtered dataset b identified  <dig> probesets with benjamini-hochberg-corrected p-values less than  <dig> , all of which mapped to exons 1– <dig> of the wnk- <dig> gene . three of these ranked within the top  <dig> most significant probesets in the kidney vs. non-kidney comparison of the filtered dataset b. the expression plot for this gene  suggests that the dominant transcript in kidney lacks the first four exons. in human and mouse, multiple wnk <dig> mrna species are expressed that arise by alternative promoter usage and splicing  <cit> . in the kidney, in addition to the originally described "long" wnk <dig>   <cit> , the most prominently expressed wnk <dig> is a shorter transcript  <cit> . this shorter kidney-specific wnk <dig>  is initiated at an alternative promoter and lacks the first four exons that include the kinase domain of wnk <dig>  <cit> .

solute carrier family  <dig>  member  <dig> 
slc25a <dig> codes for the mitochondrial phosphate-carrier protein, pic. two probesets,  <dig> and  <dig> , mapping to the slc25a <dig> gene had benjamini-hochberg-adjusted p-values less than  <dig>  in the muscle vs. non-muscle comparison and the heart vs. non-heart comparison . probeset  <dig> was also significant in the thyroid vs. non-thyroid analysis. the two probesets map to exon 3a and exon 3b, respectively . without any prior knowledge about transcript structures, our results would indicate that exon 3a is expressed only in muscle, heart and thyroid tissues and exon b is expressed in all tissues. however, it is known that exon 3a and 3b are two mutually exclusive exons that give rise to ensembl transcripts enst <dig>  and enst <dig> . exon 3a was found to be highly expressed in heart, muscle and thyroid tissues but had very low expression in all other tissues. all exons had highest expression in heart and muscle tissue, with the exception of exon 3b which had the lowest expression in these two tissues . taking into account known transcript structures, the expression plots and significant probesets suggest that transcript enst <dig>  is expressed in heart, muscle and thyroid but not in the other tissues, and enst <dig>  is ubiquitously expressed but is not the major transcript in heart and muscle. in thyroid tissues both transcripts may be expressed in roughly equal amounts. previous studies in mammals have shown that pic has two distinct isoforms, pic-a and pic-b  <cit> , which originate from alternatively spliced transcripts that differ by the mutually exclusive exons 3a and 3b. the two transcripts have displayed different substrate affinities and transport rates in vitro  <cit> . the exon array results are concordant with mayr et al.  <cit>  who showed that pic-a, the transcript containing exon 3a, has tissue-specific expression in heart and muscle, while pic-b is expressed ubiquitously.

intersectin  <dig> 
the itsn protein functions in clathrin-mediated endocytosis and in map kinase signalling. nine probesets mapping to the terminal  <dig> exons of itsn <dig> had benjamini-hochberg-corrected p-values less than  <dig>  in the cerebellum vs. non-cerebellum analysis of filtered dataset b . the expression plot of itsn <dig>  clearly showed that the exons at the 3' end of the gene are expressed only in cerebellum. there are two major itsn <dig> transcripts described in mammals: a ubiquitously-expressed short transcript and a brain-specific long transcript which arises due to brain-specific alternative splicing in a stop codon  <cit> . the proteins coded by the two transcripts both contain five src homology  <dig>  domains, two eps <dig> homology  domains and an apha-helix-forming domain. the longer brain-specific transcript encodes three additional domains   <cit> .

kinesin family member 1b 
the kif1b protein belongs to the kinesin superfamily which are microtubule-dependent molecular motors involved in important intracellular functions such as organelle transport and cell division. five out of six probesets mapping to an exon  in the kif1b gene had benjamini-hochberg-corrected p-values less than  <dig>  in the heart vs. non-heart, cerebellum vs. non-cerebellum , muscle vs. non-muscle and thyroid vs. non-thyroid comparisons . there are several known isoforms of kif1b, which are either the long or short forms  <cit> . the short isoforms lack more than twenty exons from the 3'end and have a terminal 3' exon  that is absent from the long isoforms. ense <dig> was found to be retained in muscle, heart and thyroid but spliced out in cerebellum. figure  <dig> shows that all the probesets had a higher intensity signal in the cerebellum tissue compared to non-cerebellum samples, with the exception of the probesets mapping to the 5' utr and those mapping to ense <dig>  figure  <dig> shows the exons common to both the long and short isoforms have the same expression levels in cerebellum and muscle. however, exons unique to the short isoforms have higher expression in muscle while exons unique to the long isoform have higher expression in cerebellum. the results indicate that the short transcript is dominant in the heart, muscle and thyroid while the long transcript is dominant in cerebellum. other tissues may have similar expression for both the long and short transcripts. the kif <dig> proteins share a conserved motor domain at their amino-termini. the c-terminal sequences differ widely and are thought to be responsible for their cargo-selection specificity  <cit> . the two isoforms kif1balpha  and kif1bbeta <dig>  differ by the c-terminal cargo-binding domain. the analysis of the exon array data indicates that the dominant transcript in cerebellum tissue has an extended c-terminus . nakumara et al.  <cit>  showed that the longer kif1bbeta <dig> transcript was detected in all rat tissues examined, including kidney, liver, spleen, ovary and heart, but was significantly abundant in brain.

inner membrane protein, mitochondrial 
immt codes for mitofilin  and is thought to play a role in controlling mitochondrial cristae morphology . probeset  <dig> was the most significant splice event in the heart vs. non-heart in the limma analysis of the filtered dataset b . it maps to exon  <dig> of the immt gene. all the probesets had the highest intensity signal in the heart except for the one targeting exon  <dig> which had the lowest expression in the heart samples . there are  <dig> known ensembl transcripts for this gene. transcript  <dig>  and transcript  <dig>  differ only by exon  <dig>   <cit> . the third transcript  contains exon  <dig> but lacks several other exons. the exon array data suggest that the dominant transcript in heart tissues lacks exon  <dig>  and is therefore likely to be enst <dig> 

we chose the above genes as the expression pattern could be mapped to know transcript structures. wnk <dig>  slc25a <dig> and immt were chosen as examples as they contained at least one probeset that ranked within the top  <dig> most significant probesets in the respective comparisons . however, kif1b and especially itsn <dig>  though they had significant p-values, were ranked much lower. this illustrates that it is essential to manually inspect all significant probesets, however large the list, as real splice events will not always be ranked highly by the limma analysis. both these genes have a much larger number of differentially spliced exons than wnk <dig>  immt and slc25a <dig>  this undoubtedly affects the estimation of accurate gene signal estimates, and in turn the si, under-estimating the extent of differential splicing. this highlights one of the pitfalls of the si approach.

a similar study was done on a tissue panel data set  using the affymetrix research exon arrays  <cit> . the design of this array differs to that of the huex  <dig> st arrays as they consisted of a genechip array set of  <dig> chips and each probeset had up to  <dig> perfect match  and mismatch  probe pairs. the data set consisted of  <dig> brain tissues  and  <dig> non-brain tissues . their analysis included all core, extended and full category probesets. the data was normalised using probesets from  <dig> empirically derived housekeeping genes shown to be consistent across many tissues. to identify significant probesets, multiple t-tests were applied to the gene-normalised exon intensities and an un-corrected p-value cut-off of  <dig>  was used to identify significant probesets. gel profiles of the top-ranking probesets as well as probesets with the highest si in the brain vs. non-brain comparison were validated by rt-pcr. to check if any of the rt-pcr validated cerebellum-specific splice events were significant in our cerebellum vs. non-cerebellum analysis we had to first map the probeset ids from the affymetrix research exon array to the corresponding huex <dig>  st array probeset ids. we obtained the sequence covered by the probeset  from the geo platform annotation  and did a blat search against the ensembl database  to obtain the genomic location of the target regions. we then used the x:map genome browser to identify huex  <dig> st probesets targeting these regions. our search was restricted to exons targeted by huex  <dig> st core probesets as our analysis was done only on core probesets. we were able to map huex  <dig> st core probesets for  <dig> of the cerebellum-specific rt-pcr validated splice events. though the array platform, tissue panel, pre-processing and analysis methods used by clark et al.  <cit>  were different to the dataset and analysis used in this paper,  <dig> out of these  <dig> probesets had benjamini-hochberg-corrected p-values less than  <dig>  and  <dig> had benjamini-hochberg-corrected p-values less than  <dig>  in our si/limma analysis of the unfiltered data .

we also looked at results from a recently published analysis method by purdom et al.  <cit>  called firma . firma scores each exon as to whether its probes systematically deviate from the expected gene expression level. they specifically looked at exons which were previously validated by das et al.  <cit>  as being enriched in muscle and heart tissue as well as reported other top scoring probesets. out of the  <dig> core probesets presented by purdom et al., firma scored highly for  <dig> in the heart and/or muscle tissue. all  <dig> of these had benajmini-corrected p-values less than  <dig>  in our muscle vs. non-muscle and/or heart vs. non-heart si/limma comparison .

using pearson's correlation to identify differentially spliced genes
plotting signal intensities of probesets across a gene provided a better understanding of the nature of the data. we found that for large proportion of genes the probeset signals were quite variable, but the pattern of expression was highly correlated in the different sample groups. we hypothesise that in the absence of splicing the probeset expression pattern between two groups should be highly correlated, with a pearson correlation coefficient close to  <dig>  differences in splicing and therefore differences in probeset signal pattern between the two groups will result in a decrease in the gene's correlation.

to test this hypothesis, for each tissue comparison  we calculated the pearson correlation coefficient for each transcript cluster  in the filtered dataset a  using the mean probeset log <dig> intensities . transcript clusters that contained only one core probeset were removed as no correlation coefficient could be calculated and transcript clusters that contained only two probesets were also excluded, as these had a correlation coefficient of  <dig> or - <dig>  over 80% of transcript clusters that showed no cerebellum-specific splicing  had a correlation coefficient of  <dig>  or higher , while only around 30% of the transcript clusters that had cerebellum-specific splicing  had a correlation coefficient of  <dig>  or higher . similar distributions were observed for the other tissue comparisons . though the correlation coefficient can be calculated from  <dig> or more probesets, it is important to note that low correlation coefficients for genes with a large number of exons are more reliable than those for genes with only a small number of exons.

we looked at the correlation coefficients across all  <dig> comparisons for the  <dig> genes mentioned above. in all  <dig> genes the lowest correlation coefficients coincided with the comparisons that contained the most significant probesets . for example, itsn is known to have a cerebellum-specific transcript which is much longer than the dominant short isoform expressed in other tissues. all of the tissue comparisons for itsn had a pearson correlation coefficient above  <dig>  except for the cerebellum vs. non-cerebellum comparison, where the correlation coefficient was  <dig> . as expected, genes with large number of exons being differentially spliced  had much lower correlation coefficients than genes with single or few exons being differentially spliced . with slc25a <dig> the correlation coefficients in the heart and muscle tissue comparisons are  <dig>  and  <dig>  respectively, while all other tissues had coefficients higher than  <dig> . though this is a small difference it is a significant one. we compared all the correlation coefficients for slc25a <dig> to its highest correlation coefficient  using a statistical test for the significance of the difference between two coefficients using a fisher r-to-z transformation  <cit> . the heart and muscle correlation coefficients had z-scores greater than  <dig>  while all other tissue comparisons had z-scores less than  <dig> . the si/limma correctly identified thyroid-specific splicing of slc25a <dig> but the correlation coefficient for the thyroid vs. non-thyroid comparison was not significantly different. this may be due to a combination of only a single exon being differentially spliced between thyroid and non-thyroid and the fact that the muscle and heart tissues show the same splicing but are included in the non-thyroid group, giving a mixture of signals for the non-thyroid group. this is also an issue with the si/limma approach, but can be overcome by carrying out an all-versus-all comparison instead of grouping tissues together and then looking for significant probesets common in all comparisons.

pearson correlation coefficients of the  <dig> genes  calculated for all eleven tissue comparisons using the unfiltered dataset. values in bold indicate that the gene had a significant p-value  in that si/limma group comparison. the highest and lowest correlation coefficients for each gene were found to be significantly different .

the correlation approach is based on the assumption that the probeset expression varies within a gene but the pattern is maintained in the absence of splicing. however, we have seen a small number of genes where there is little variation in the probeset expression level. these genes tend to have low very correlation coefficients when very slight changes in intensity, likely due to noise, occur. however, these cases are few and can be easily identified and removed by looking at the probeset expression variance for each gene.

discussion
the aim of this paper was to propose an analysis workflow for analysing differential splicing using freely available software packages that have already been developed and widely used for gene expression analysis. the limma package provides a framework for analysing experiments with multiple sample groups and provides robust statistics, but as yet has not been applied to exon array data to identify alternative exon splicing analysis. we applied limma to an affymetrix exon array tissue panel dataset to identify tissue-specific splicing. the main issue with the si approach is obtaining accurate estimates of gene expression. during this process we explored the data extensively using expression plots and came to the realisation that probeset signals within a gene, though variable maintained the same pattern in all biological groups. differential exon splicing between two groups introduced differences in the signal patterns of probesets within a gene, with the patterns reducing in similarity when exons were differentially spliced. this led to the concept of using a pearson correlation coefficient to identify genes with differential splicing between two biological groups, where genes with lower correlation coefficients are more likely to be differentially spliced between two biological groups. this approach avoids the issue of inaccurate gene estimates.

our initial limma analysis of the data was done on unfiltered data and it became obvious from looking at expression plots that a large number of highly ranked probesets were false positives. it was therefore necessary to introduce filtering steps prior to the limma analysis of the gene-normalised exon intensities which greatly improved the rankings of true positives. the filtering steps taken here are specific for this data set and our objective. we recommend removing low/unexpressed probesets and genes. unfortunately, there is no direct way of determining whether a gene is expressed or not. we observed that the rma intensity distribution consisted of two peaks. the first peak generally contains negative controls and noise, while the second peak contains most of the signal. our lower quartile filtering steps were aimed at reducing the noise, by removing genes falling in the first peak . removing 25% of the data is very stringent, but our objective was to reduce the false positive rate and this will inevitably mean a trade-off with the loss of true positives. the proportion of the data filtered will be dependent on the dataset, as the intensity distributions are likely to vary. we do not recommend only analysing low variant genes. however, analysing this subset separately can help identify unambiguous splicing events.

the significance ranking of probesets was found to be lower when an exon was retained or spliced out in several tissues. for example, in slc25a <dig> exon 3a is retained in heart, muscle and thyroid but spliced out in the rest of the tissues . the probeset mapping to this exon is ranked much lower than the probeset mapping to exon 3b even though the expression plot shows a much larger change in intensity for exon 3a between muscle and non-muscle . this is because the heart and thyroid tissues were grouped with the rest of the non-muscle tissues, resulting in a higher mean intensity and higher within-group variance for exon 3a in the non-muscle group, leading to a less significant p-value. this is also the case for kif1b where some tissues are expressing the short transcript while others the long isoform. for kif1b this is also evident in the correlation coefficients which range widely between the different comparisons. to overcome this, an all-vs-all comparison may be more appropriate, where one tissue is compared to another tissue individually. despite these issues, such differential splice events do pass the strict p-value threshold and this indicates that the probesets ranked lower down are as important as the ones ranked highly with the most significant p-values.

the limma approach also appeared to work better when a gene had only a single or very few exons differentially spliced. genes that had a large number of differentially spliced exons  were ranked much lower. this is likely due to the effect of splicing on the gene signal estimation. if a gene has equal expression in two samples, its gene signal estimation by the summarisation algorithms in the absence of splicing will be the same for both samples. however, if there are many exons differentially spliced between the two groups, some probesets will have high signals in one group  but low expression in the other group . the algorithms may misestimate the gene signal to be lower in the group where there are many exons spliced which in turn will affect the gene-normalised exon values and may result in less significant p-values. an advantage of the correlation coefficient over methods such as si is that it does not require gene level estimates, which can be inaccurate, especially when there are a large number of exons differentially spliced within a gene. the correlation coefficients for genes with many differentially spliced exons were much lower and these genes would therefore rank better than genes with single exon splicing. for the  <dig> example genes, the lower correlation coefficients coincided with the splice events identified by si/limma. the coefficients were much lower for itsn and kif1b, where multiple exons were differentially spliced.

though the use of correlation coefficients has not been studied extensively, the preliminary results suggest that it could be used as an informative measure to identify differentially spliced genes. we found that 94% of genes not detected to have differential splicing by the limma analysis had a correlation coefficient greater than  <dig> . therefore, genes with correlation coefficients less than  <dig>  are most likely to undergo differential splicing. correlation coefficients higher than  <dig>  could either indicate no splicing or few splicing events. it would be difficult to differentiate between these two using just correlation. the p-values from limma and the gene correlation coefficients therefore should be used together as an indication of whether a gene is likely to be differentially spliced and what the extent of splicing is likely to be.

it is important to emphasize that regardless of the method used to identify differential splicing, the splice events must be manually inspected with the help of expression plots and the use of genome browsers such as x:map, where array probesets can be mapped to transcript information. we presented our results as an html table with links to all the required information , making it is easier to inspect the results and separate false positives and ambiguous splice events from obvious tissue-splice events. analysing such plots highlighted the difficulty in mapping exon expression data to know transcript structures. it is also not always clear whether the expression pattern observed is as a result of novel transcripts or a mixture of transcript structures being expressed simultaneously, unless prior knowledge of exon expression is known. the results suggest that there are a large number of transcript variants yet to be discovered, even when using only core annotated exons.

it may be desirable to analyse the full annotation probesets in order to identify novel splice events and confirm expression of predicted exons. however, including these probesets increases noise as a large number of predicted exons will not be real and will not be expressed in all samples. the false positive rate when using the full annotation is expected to be much higher and stringent filtering becomes crucial when including these probesets. this is evident in intensity distributions for full datasets , where the peak at low intensities is much larger than in the core dataset. in this case a larger proportion of the data would need to be filtered to remove unexpressed/noisy probesets and genes. as for the correlation coefficient, using extended and full data will increase the number of data points from which to calculate correlation. there are many genes which have only a few core probesets but several extended and full probesets. if all of these are used it may avoid artificially low correlation coefficients. however, the degree of splicing may also be underestimated if the majority of these probesets are not measuring expressed exons. one way of avoiding this is to use the full dataset but to filter the data to remove unexpressed probesets. this way predicted exons that are expressed will still be retained.

there are several exons that are represented by more than one probeset. we have seen several cases from the si/limma analysis, especially in the terminal exons, where some probesets mapping to the same exon are significant but others are not. these could be as a result of alternative exon splice sites or alternative utrs. the correlation approach could potentially be used for identifying alternative acceptor and donor sites by calculating a correlation coefficient for each exon rather than a gene. for this application you would need to use the probe-level data. if an exon has a low correlation coefficient this may be indicative of an alternative splice site. however, it is important to bear in mind that analysis with probe-level data is much more computationally intensive and may not be feasible for current standard desktop computers.

further work
one aspect that needs to be explored is the data filtering. the filtering approach used is not very sophisticated and it is likely that viable splice candidates may be filtered out using a quartile filter. the use of the affymetrix detection above background  algorithm to filter absent probesets and genes may be a more suitable option which will be explored in the future. most of our effort will, however, be put into exploring the use of correlation coefficients for identifying differential splicing, particularly looking at the genes in the overlapping region of the correlation coefficient distributions, which may be false positives or false negatives. another factor to consider when calculating correlation coefficients is the number of exons/probesets in the gene. if a gene has only  <dig> exons and one exon is differentially spliced the correlation coefficient will be lower than a gene with  <dig> exons and only a single exon differentially spliced. the number of exons can be taken into account by using z-scores to determine if two correlation coefficients are significantly different or is the difference simply due to the difference in the number of exons. z-scores can be used in the case where there are multiple biological groups and comparisons and may be a better alternative for selecting genes instead of correlation coefficient cut-off. but in the case of a single comparison between two groups a correlation coefficient threshold would have to be used for selecting differentially spliced genes. in the mean time using a combination of p-value and correlation coefficients would appear to be an efficient way to select genes that are most likely to be differentially spliced.

CONCLUSIONS
we can confidently say our approach using si/limma can successfully identify differential exon splicing, but lack of any gold standard data set makes it difficult to benchmark this method and any other method without wet-lab validation. however, we were able to use previous experimental studies to support our results. it is also difficult to directly compare the correlation results as it gives a measure for each transcript cluster  while all other methods, including si/limma, give p-values for a probeset . but we have shown that the distribution of correlation coefficients in transcripts without splicing is significantly different to the distribution in transcripts with splicing as identified by the si/limma analysis. thus low correlations are indicative of differentially spliced genes. though further work would be necessary to develop the use of correlation coefficients into a complete analysis approach, the preliminary results demonstrate their usefulness for identifying differentially spliced genes.

availability and requirements
the r scripts are available upon request from the authors.

