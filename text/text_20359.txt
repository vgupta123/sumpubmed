BACKGROUND
sequence comparison has become a major tool for biological research in the post-genomic era, forming the basis for functional annotation, classification, and analysis of evolutionary relationships. at the residue level, however, the relation between sequence, structure and function can often be obscure, and examples abound of proteins with a clear functional and homologous relationship but sharing negligible similarity at the sequence level.

structural alignment therefore is the method of choice for reliable homology assessment and derived features like functional classification and phylogeny. this importance is reflected in the number of tools available for structural alignment, such as dali  <cit> , ssap  <cit> , structal  <cit> , mammoth  <cit> , ce  <cit>  and comparer  <cit>  . databases for functional classification such as cath  <cit> , fssp  <cit>  and pass <dig>  <cit>  each derive directly from the use of one or more of these methods, whereas for scop expert input in the structural classification is deemed critical  <cit> . structural alignments are also routinely used for benchmarking sequence alignment methods. a number of databases have been developed for this purpose, among which balibase  <cit> , homstrad  <cit>  and sabmark  <cit>  are widely used. these databases often rely on expert knowledge and include a notion of 'core blocks', i.e. where alignment ambiguity does not occur and hence can be trusted. the general problem of uncertainty in sequence alignment has recently been discussed by wong et al.  <cit> . due to the complexity of interpreting non-trivial alignment regions, these are often omitted in large-scale evolutionary analyses, even though there is ample evidence for their fundamental importance  <cit> . an approach to pinpointing alignment ambiguity is the generation of ensembles of suboptimal alignments  <cit> , but computational demands remain prohibitive for genome wide studies.

recent structural alignment methods have started to place emphasis on dealing with structural flexibility, such as fatcat  <cit> , multiprot  <cit> , matt  <cit>  and rapido  <cit> . this may increase the consistency of alignments produced by each of these methods, but does not address the intrinsic ambiguity arising from structural divergence. the fundamental issue is whether a one-to-one equivalence exists between residues from different proteins that could be expressed as one definite alignment between sequences  <cit> . this is illustrated in figure  <dig>  where we show that a single insertion can lead to ambiguity in the functional correspondence between most residues in the loop.

to further elucidate the effect of structural diversity on structural alignment, we prepared two distinct comprehensive sets of alternative structures for proteins from the homstrad database of homologous protein families. the first set comprises proteins for which alternative crystal structures are available. the other set is derived from molecular dynamics simulations to explore a more extensive spectrum of possible structures. an overview of our analysis procedure is outlined in figure  <dig> 

our main results show that in many cases structural variation strongly affects structural alignments, even for highly similar sequences. moreover, the derived alignment appears to be highly sensitive to even small conformational changes of the proteins. the uncertainty in pairing up structural equivalent residues makes it difficult to determine which alignment alternative would describe most closely the functional relationship between the proteins. to address this issue, we show how alternative alignment visualizations may be used to exploit the information contained within variable alignment regions.

RESULTS
structural diversity and alignment stability
the relation between the variation of the alternative structures  and the corresponding alignment similarity  is shown in figure  <dig> . it is clear that the structural variation between crystal structures  is much smaller  than that of the simulation snapshots . a crucial aspect is that even for small  and modest  structural differences, alignments can easily vary up to 20% and sometimes as much as 40% or more in their sp score. on the other hand, a considerable number of alignments appear robust to larger  and even extreme  structural variations. additionally, for the crystal structures, the sequence similarity has no effect on the variation in structural alignments . for the simulation snapshots, however, there seems to be a slight but distinct tendency for more similar sequences to have less variation in structural alignments, but this can be mainly attributed to the larger variations  in structure that arise from the simulations . as an alternative for rmsd measurements we also tested the rho-score  <cit> , a protein size-independent measure, which resulted in the same trend .

a quite interesting example of the impact that small structural variations can have on the structural alignment is found in the groes so-called 'mobile loop', which is the main region for interaction with groel and therefore is a crucial component of the groel/es chaperonin machinery  <cit> . the structural variations for this loop in e. coli groes  are almost negligible . it is therefore surprising that the corresponding dali sequence alignments with m. tuberculosis groes show remarkable variation in this region . to pinpoint the source of this variation, we also used three other structural alignment programs: ce, matt and fatcat. the latter two explicitly take structural flexibility into account and this leads to more consistent alignments in the variable loop . on the other hand, two regions  are aligned consistently by dali but show inconsistencies when aligned by ce and the two flexibility-aware methods. strikingly, there is no overall consistency between the four methods, which is in line with several other studies where several structural alignment methods are compared  <cit> . it should be stressed that the focus of this paper is not on comparing the performance of the various methods but rather on the effects of structural diversity. a comprehensive overview of the groes variability is given by the alignment matrix and the consistency plots . the alignment matrix scores the occurrence of aligned residue pairs over all alignments, similar to the dot-plot  <cit> . consistency plots show for each residue the standard deviation from the alignment position of the consensus pair. the alignment matrix and associated consistency plots allow a detailed visualization of the variability while enabling easy interpretation of the ensemble of alternative alignments.

although alignment uncertainty has been shown to have a great impact on large scale sequence analysis  <cit> , the relation with structural variation has not been widely explored  <cit> . this is remarkable given that structural alignments are generally employed to benchmark sequence alignment methods. we demonstrate that in many cases structural alignments can vary dramatically even for small structural changes. trends observed in the set of crystal structures corroborate those observed in the set of simulation snapshots, albeit alignment differences in the latter set are more pronounced due to larger structural variations.

a depository for alignment variability
it is questionable whether a single reference alignment captures the full width of naturally occurring sequence variability  <cit> . yet, current visualization and alignment methods are not designed to take variable regions into account, and they are typically ignored in sequence alignment benchmark protocols. since variable regions are often important structurally and/or functionally, new approaches for visualization, alignment and benchmarking are desirable.

to this end we have constructed a database of 'flexible' reference alignments. this database is available online  and contains all structures and alignments used in this study. for each alignment in our database, variation is visualized using alignment matrices and consistency plots as shown in figure 4b. in addition the database contains the ensemble 'master-slave' alignments as shown in figure 4a. this pinpoints alignment regions that are affected by variability.

CONCLUSIONS
structural variation, as presented here by alternative crystal structures and molecular dynamics simulations, has a profound effect on structural alignment. the sensitivity to structural variation is a bottleneck for the effective application of structural alignment approaches. this undermines the current basis of all sequence alignment methodologies and is an underestimated problem for the homology assessment used in structural and functional classification. the groes 'mobile loop' example demonstrates how functionally essential protein regions can coincide with variable structural alignment segments. our database should therefore be useful for alignment verification and delineation of functionally important protein regions.

