BACKGROUND
protein structure comparison plays an important role in predicting functions of novel proteins  <cit>  and several methods have been developed for pairwise  <cit>  and multiple  <cit>  comparisons. most existing methods of structure comparison treat proteins as rigid bodies; however, protein structures are flexible and conformationally changeable in response to binding another molecules relating with biological functions such as immune protection, enzymatic catalysis and cellular locomotion  <cit> . such structural variations caused rigid-body algorithms unable to generate correct alignments or retrieve similar structures with large deformations. therefore, flexibility of proteins should be taken into account when comparing structures and searching for similarities to a query structure.

alignment methods
flexible structure comparison has received much attention in recent years. for instance, flexprot found congruent rigid fragment pairs between two proteins and the flexible regions , and then a clustering procedure was performed to join consecutive fragment pairs into congruent domain pairs  <cit> . fatcat connected aligned fragment pairs based on a dynamic programming algorithm which introduced penalty scores for gaps and twists between consecutive aligned fragment pairs  <cit> . compared with flexprot, fatcat generates alignments with less twists but similar root mean square deviations  and lengths. the tops++fatcat algorithm reduced the number of aligned fragment pairs during fatcat comparison processes by applying topological constraints obtained from the alignment of secondary structure elements  of tops +  <cit> . therefore, tops++fatcat is more than  <dig> times faster compared to fatcat. both flexprot and fatcat are sequential alignment algorithms thus unable to identify non-sequential alignments. fase  <cit>  and flexsnap  <cit>  were designed to tackle the problem of non-sequential flexible structure alignment. fase compares structures starting from aligned pairs of sses with an assumption that an optimal superposition of pairs of structures must have at least one pair of well-aligned sses. flexsnap applies a greedy algorithm for connecting aligned fragment pairs and possesses competitive results against other state-of-the-art pairwise comparison methods. matt, one of the most popular and accurate flexible multiple structure alignment methods, is also based on the approach of chaining aligned fragment pairs which are allowed translations and rotations during assembling  <cit> .

non-alignment methods
the alignment/superposition based comparison methods are inefficient for blasting similar structures from a structure database in real-time  <cit> . therefore, several non-alignment approaches based on different descriptors of molecular shapes were proposed. these descriptors are usually represented by histograms or vectors, and a similarity score between two molecules is calculated from corresponding descriptors without any alignment  <cit> . for example, daras et al. applied the spherical trace transform method to produce rotational invariant descriptor vectors constituted by weighted geometry- and attribute-based vectors for protein classification  <cit> . the 3d zernike descriptor represented a protein structure by  <dig> numbers based on a series expansion of 3d functions for fast retrieval of similarities, and which demonstrated that low-resolution structures were also applicable  <cit> . abu deeb et al. proposed a global descriptor on protein surface, and which was constructed from local patch descriptors defined by residue-specific distance distributions between cα atoms and the numbers of pairwise residue co-occurrences within each surface patch  <cit> . yin et al. compared local surface of proteins by geometric fingerprints of each surface patch  <cit> . a fingerprint consists of  <dig>  bins corresponding to the geodesic-distance-dependent distribution of curvatures.

nevertheless, most non-alignment methods treated proteins as rigid bodies and neglected flexibility of protein conformations required for performing biological functions. to confront the issue of flexibility, liu and fang et al. proposed several histogram based descriptors for flexible molecules comparison. for instance, a local diameter descriptor for depicting the local characteristics of boundary points  <cit> , and another descriptor, inner distance, defined as the shortest path between landmark points  <cit> . both methods are sensitive to self-connection problems during molecular shape deformation. accordingly, an improved method named diffusion distance shape descriptor  was proposed, which is based on an average distance instead of the shortest distance between two landmark points  <cit> . although ddsd is superior to local diameter, inner distance and other descriptors in terms of retrieving similar protein structures, its performance is still unsatisfied with an f1-measure of  <dig> %.

proposed method
non-alignment or descriptor based approaches are generally fast enough to search a large database in a real-time manner, but do not provide corresponding information of residues which might provide crucial information for biologists. combining the ideas of alignment and descriptor based approaches, we propose a novel and efficient descriptor called local average distance  which is based on either geodesic distances  or euclidean distances  for pairwise flexible protein structure comparison. each protein structure is firstly transformed into its corresponding lad profile, and the similarity between two proteins is calculated according to pairwise local alignment on transformed profiles. the hinge atlas and hinge atlas gold datasets  <cit>  from the molmovdb  <cit>  were employed to evaluate the performance of proposed lad descriptors and to compare with several non-alignment and rigid/flexible structure alignment methods.

methods
the proposed protein structure comparison algorithm is based on the lad profile which is built from pairwise residue distances  within a protein. the workflow of generating profiles from atomic coordinates of proteins is shown in figure  <dig>  the similarity between two proteins is determined by a local pairwise alignment of their corresponding lad profiles. the core procedures can be decomposed into triangular surface construction, surface simplification, ed/gd calculation, profile construction and profile comparison. details of each step are introduced in the following sections.

triangular surface construction and simplification
the solvent-accessible surface   <cit>  and solvent-excluded surface  <cit>   are the most widely used definitions for protein surface analysis. each atom of a protein is represented as a sphere with its van der waals radius. the sas is traced out by the center of a solvent probe sphere rolling over the spherical atoms, whereas the ses is formed by the inward-facing surface of the probe consisting of contact surface and re-entrant surface. for a more complete description of both sas and ses please refer to  <cit> . many algorithms have been developed to build sas and/or ses such as gauss-bonnet theorem  <cit> , level-set  <cit> , alpha shape  <cit> , beta shape  <cit> , euclidean distance transform  <cit> , ray-casting  <cit> et al. <cit> . one common area-based method defines a residue as a surface residue if its surface area is greater than a specific threshold  <cit> . the other area-based methods consider a residue with relative solvent accessibility larger than a threshold as a surface residue  <cit> . the relative solvent accessibility is defined by taking a residue’s solvent-accessible area divided by the maximum area of that residue  <cit> . in recent years, novel atom-depth-based approaches were proposed as alternative ways to define surface residues  <cit> . different algorithms employed various definitions of atom depth which could be defined as the distance of an atom from the nearest water molecule surrounding the protein, from the molecular surface, or from its closest solvent-accessible neighbor  <cit> .

the input for building an lad profile is a standard pdb file. owing to the requirement of triangular surface meshes for gd calculation, one of the most used and fastest surface program, msms v <dig> . <dig>  <cit> , is applied to construct triangular surface meshes from coordinates of all backbone atoms of the protein . all the parameters of msms are remained as default settings. this tool usually generates high resolution meshes  for proteins. however, it is time-consuming and memory exhausted during the calculation of gds among mesh vertices. to reduce the resolution of msms-generated meshes, an open source tool, meshlab v <dig> . <dig> , is adopted to downsample original meshes. the outputs of msms are converted into polygon file format  as meshlab’s inputs. the algorithm of quadric edgecollapse, a variant of the well-known quadric error metric algorithm  <cit>  , is employed to simplify meshes . as a result, the face number of each msms-generated mesh could be reduced by 85% generally in this research.

calculation of pairwise residue distances
the simplified meshes are then used to identify surface residues, and the gds and eds of surface residue pairs can be obtained. each vertex of a simplified mesh belongs to the closest backbone atom of the protein. in other words, an atom could possess more than one vertex. we defined that the vertices belong to an atom as the associated vertices of that atom. a residue is regarded as a surface residue if its backbone atoms have at least one vertex.

gd is the shortest path along the surface from source to destination points. we adopted the previously published open source program provided by danil kirsanov  to calculate gds between any two vertices from simplified meshes. the gd between two atoms, ai and aj is defined by taking average of gds from all associated vertices and represented as the following:

 gdai,aj=∑x=1m∑y=1ngdvix,vjym×n 

where gd is the average gd from the ith atom to the jth atom, vix and vjy represent the xth vertex of the ith atom and the yth vertex of the jth atom respectively. the symbols m and n indicate the number of vertices associated with the ith atom and the jth atom, and gdvix,vjy is the gd from vertex vix to vertex vjy. the atoms possessing no associated vertices won’t be considered, hence m and n must be strictly larger than zero. in contrast to the measurement of gd, an ed between two atoms can be easily obtained from their coordinates. once the two different distance measures between any two atoms are obtained, the distance measures between any two residues can be calculated similarly by taking an average of gds or eds from all associated backbone atoms.

construction of lad profiles
lad is proposed to retain local characteristics of each residue in sequential relationship. the lad profile for a protein consists of average distance values which are built by employing a sliding window scanning from n- to c-terminus. in this study, we have tried different odd window sizes ranging from  <dig> to  <dig>  and the window size of  <dig> residues provided the best performance on the training dataset . hence, a window size of  <dig> is applied to build all lad profiles. we have implemented two types of lad profiles; one is based on ed feature  and the other is based on gd  feature. given a residue at position i  in the sequence, the ladi for the residuei is defined by taking average distance from residuei to both side neighbouring residues within the window.

lad diversity
the pairwise structure comparison in this study is based on evaluating the similarities of two lad profiles from two individual proteins. a variation of smith-waterman algorithm is performed to obtain the correspondence of residues between two proteins by comparing lads instead of amino acid contents. the similarity score between two residues, residuei and residuej, for dynamic programming is inversely proportional to the absolute difference between ladi and ladj.

the similarity of two proteins is quantified by the result of pairwise profile alignment. a novel scoring function named as lad diversity  is proposed, which considers the number of equivalent  residues  and the root-mean-square deviation  of lads for aligned residues. the laddiv is defined in the following equation where nq and ns are lengths of the query and the subject proteins respectively. the symbols d and α are used to adjust the effect of rmsd on the laddiv. since ne must be less than or equal to nq and ns, the value of laddiv is between  <dig> and  <dig>  and smaller values represent higher similarities.

 laddiv=1-nemeannq,ns1+rmsddα 

profile alignment of a similar structure pair tends to hold a low rmsd and a large ne, and therefore results in a low laddiv. for example, a domain swapping protein pair illustrated in the section of self-connection problem possessing  of  and  for laded and ladgd respectively. conversely, a dissimilar structure pair possesses a high laddiv with a large rmsd and a low ne simultaneously. figure  <dig> shows an instance of profile alignment for a non-homologous protein pair which possesses different conformations, and accordingly, the laded profiles obtained high values of  as  compared to the previous example.

variables d and α were trained by the dataset l <cit>  which contains  <dig> known domain swapping homologous pairs ,  <dig> common homologous pairs  and  <dig> non-homologous pairs  of protein structures. both lds and lch were considered as a positive dataset in which each pair was anticipated possessing low laddiv values. conversely, lnh was considered as a negative dataset which was expected possessing high laddiv values for each pairs. let lds< <dig>  and lch< <dig>  denote the number of pairs whose laddiv is less than  <dig>  for both lds and lch. the lnh≥  <dig>  represents the number of pairs whose laddiv is larger than or equal to  <dig> . we have evaluated d ranging from  <dig>  to  <dig> with an interval of  <dig> , and a range of  <dig> to  <dig> with an interval of  <dig>  for α. hence, a total of  <dig>  combinations of d and α were evaluated and the one with maximum lds< <dig>  + lch< <dig>  + lnh≥  <dig>  was selected. finally,  =  and  =  were selected for laded and ladgd respectively.

structural diversity
there are many different ways to measure protein structural similarity of aligned results, and many of them have been reviewed in  <cit> . according to our previous research  <cit> , the structure diversity   <cit>  showed superior performances on distinguishing homologous proteins from non-homologous ones upon various structural comparison methods. therefore, structdiv was employed in this study to compare existing rigid/flexible structural alignment tools with our proposed method. structdiv is defined as:

 structdiv=rmsdnemeannq,ns <dig>  

where rmsd is the root mean square deviation of the distances between the aligned cα atoms. like laddiv, structural alignment of a similar structure pair tends to have both low rmsd and large ne, and low structdiv.

testing datasets
there were two testing datasets applied in this research to validate our method and compare with existing methods. the first one is hinge atlas dataset which contains  <dig> protein structures of  <dig> non-redundant morphs exhibiting hinge bending motions. the lengths of proteins range from  <dig> to  <dig> residues. a morph is a group of structures  comprising two homologous proteins with different conformations and several interpolated structures between these two initial structures. about 97% of morphs in the dataset possess three or less hinge points. figure  <dig> shows an example of morph with a large conformational change for the protein groel containing  <dig> residues. neither laded and ladgd descriptors are sensitive to the deformation, especially for laded. the second dataset provided by liu et al. was a subset of hinge atlas  <cit>  and hinge atlas gold datasets, and which was applied in the previous study  <cit> . the liu’s dataset contains  <dig> protein structures of  <dig> groups with large degrees of conformational changes.

RESULTS
comparison with structural alignment methods
lad descriptors were compared with  <dig> rigid and  <dig> flexible structural alignment methods on the hinge atlas dataset in terms of retrieving similar structures which belong to the same group  as the query structure. the first structure in each group was regarded as the representative for that group, and the remaining  <dig> proteins were considered as query structures. each query protein compared with  <dig> representatives, and there were a total of  <dig>  pairwise comparisons. the results for each query were sorted according to the diversity scores , and it was regarded as a successful retrieval if the representative belonging to the same group as query proteins was ranked at the first place. the retrieval performance for lad and other structural alignment methods on the hinge atlas dataset were summarized in table  <dig>  the results have shown that laded and ladgd performed better than other methods and achieved retrieval success rates of  <dig> % and 95% respectively. the structural alignment methods generated unsatisfied alignment results even though the relevant structures were successfully retrieved at the first place. for example, all methods ranked the relevant structure of ff <dig> at the top position for the query structure of ff <dig> from the morph group of va2ezna-1l5ba, and it is a domain-swapped dimer of cyanovirin-n . in this case, laded, ladgd, flexprot, flexsnap and jfatcat  could align the protein pair completely, but fase , fast , matt-rigid  and matt-flexible  only aligned half portion of the structure.

*rigid alignment method.

the results are ordered by the success rates and show that both laded and ladgd outperform other methods.

in addition to the measure of successful retrieval rates, we also evaluated the performances for the hinge atlas dataset based on the precision-recall curve of 11-point interpolated average precision which is a common measurement in information retrieval systems  <cit> . it should be noted that the  <dig> representatives were treated as query structures individually, and each of them compared with the remaining  <dig> structures in order to search structures belonging to the same group. a precision rate is the fraction of retrieved structures that are relevant to the query protein, and a recall rate is the fraction of relevant structures that are successfully retrieved. precision and recall rates are defined in the following equations:

 precision=tptp+fp 

 recall=tptp+fn 

true positive  is the number of successful retrieved structures; false positive  represents the number of inaccurately retrieved structures; false negative  denotes the number of structures belonging to the same group as query but not being retrieved. the interpolated precision for a specific recall r is defined as the maximum precision over any recall r ' ≥ r <cit> . for each query, a set of  <dig> interpolated precisions at  <dig> recall levels  were determined, then averages of interpolated precisions for  <dig> queries at each level were calculated. according to the precision-recall curves , both laded and ladgd outperformed other methods since they possessed larger area under the curve.

r-precision and mean average precision  are the other common quantitative measures for evaluating overall performance of information retrieval systems. if there are total r relevant structures for a query, r-precision is defined as the number of relevant structures in the top r retrieved structures divided by r. for a query, average precision is an average of precisions for each relevant structure. map is defined as the mean of the average precisions for a set of queries. for more details of calculating these measures please refer to  <cit> . the average r-precision and map of  <dig> queries for different methods are shown in table  <dig>  the results have shown that both laded and ladgd performed superior to other methods, and laded achieves an average of  <dig> % for r-precision and  <dig> % for map.

r
comparison with non-alignment methods
the liu’s dataset was employed to compare lad descriptor with non-alignment methods. in order to compare with the results in  <cit> , only the top  <dig> retrieved structures for each query were used to compute the precision and recall rates. the f1-measure is the harmonic mean of recall and precision rates defined as:

 f1-measure=2×precision×recallprecision+recall 

where the maximum value is  <dig>  in contrast to the arithmetic mean, both precision and recall rates need to be high to obtain a high f1-measure. the retrieval performance of f1-measure is listed in table  <dig>  laded and ladgd achieved  <dig> % and  <dig> % of f1-measure respectively and outperformed the other  <dig> non-alignment methods with a highest f1-measure of  <dig> %.

1
the results are taken from  <cit>  except laded and ladgd.

discussion
self-connection problem
figure  <dig> is an example of bona fide domain swapping protein pair holding self-connection on surface caused by a large hinge bending motion. the difficulty is that a self-connection leads to topology changes, hence the inner distance method considering all landmark points cannot solve this problem  <cit> . however, this type of deformation can be overcome by our proposed descriptor especially for laded approach since an lad only considers the local geometric properties which are not sensitive to global topology changes. figure 6d and figure 6e have shown a high consistency of laded and ladgd profiles between open-form  and close-form  of ribonuclease a respectively. it is obvious that laded is more consistent than ladgd in this case, but both laddiv are close to zero representing highly similar conformations. the  for laded is  and  for ladgd.

in general, lad descriptors are insensitive to self-connection cases; however, an ladgd profile is sometimes not consistent at the location of self-connecting regions. given another domain swapping example in figure  <dig>  an open-form ribonuclease a  changes to a closed-form . the swapped domain  bends and intertwines with the protein body  via conformational changes of highly flexible hinge loops  . in figure 7c, it is obvious that the laded varies slightly between the open- and close-form states from h <dig> to a <dig> residues . in contrast, the ladgd of close-form state is higher than that of open-form state at corresponding highlighted regions . for a detailed illustration, it can be imagined a path from the residue h <dig> to its + <dig> position . when the swapped domain locates apart from the protein body in the open-form state, the gd between these two residues is the shortest path along the white surface. the gd and ed between the two residues in the open-form state are  <dig>  Å and  <dig>  Å respectively. however, the path was changed while the swapped domain bending to the body and intertwining with the white surface region forming a self-connection case. the gd is increased significantly due to an additional mountain  obstructing the original path from residue h <dig> to v <dig>  the ed maintained high similarity since its path directly passed through the mountain instead of along on the surface. the gd and ed between the two residues of the close-form state are  <dig>  Å and  <dig>  respectively. this phenomenon is the main reason why an ladgd descriptor more sensitive to the topological changes than laded.

differences between the previous and proposed ed/gd based methods
in previous studies  <cit> , ed and gd were shown to be sensitive to shape deformation and not feasible for flexible molecular shape comparison. however, it is interesting that relying on the proposed lad methods, both features become insensitive to topological changes and reveal deformation invariant properties to tackle with the flexibility problems. the reason for sensitive ed and gd features in previous studies is that both distances were computed among all global landmark points. on the contrary, the lad exploits the characterization of local geometric features for each residue and its neighbouring residues. therefore, ed and gd features become much less sensitive to global topological changes.

computational time
pairwise comparison of lad profiles was performed by a modification of smith-waterman algorithm and possessed the same time complexity. the goal of a sequence alignment problem is to identify the correspondence of residues between two given proteins, while a structure alignment emphasizes on finding both an alignment and a spatial superposition. possible combinations of corresponding residues are countable while possibilities of special superposition are innumerable. therefore, the computational complexity of the proposed algorithm is inherently less than most commonly used structure alignment methods  <cit> . the lad algorithm was implemented by c# .net running on an intel core i5- <dig>  <dig> ghz computer with 16gb ram. according to the  <dig> pairwise comparisons mentioned in the result section, it only cost an average computational time of  <dig>  and  <dig>  milliseconds per comparison for laded and ladgd profiles respectively.

CONCLUSIONS
we proposed a novel profile-based alignment method, named lad, for pairwise flexible protein structure comparison. it can be constructed in a sense of any kind of spatial measures of local neighbouring residues within a specific sliding window. here, gd and ed were used to build ladgd and laded profiles. the idea of lad improves the ed- and gd-based descriptors which were previously shown to be sensitive to molecular shape deformation, in particular to topologically structural changes. the effectiveness of lad descriptor has been evaluated on two datasets of hinge bending motions from the molmovdb. our methods are robust to deformed flexible molecules and achieve good performance regarding assignment of the queries to different classes of molecules with conformational changes, and the results have shown superior performance compared to existing alignment- and nonalignment-based tools. finally, the reasons of lad descriptor being insensitive to flexible proteins with self-connection circumstance was described by taking 3d domain swapping cases as examples, and further discussion of laded possessing more robust properties than ladgd was also explained. required computational time for pairwise laded/ladgd profile comparisons was analyzed to demonstrate its feasibility for constructing an on-line structure comparison system. the proposed descriptor is indeed effective in retrieving deformed proteins and it could be an alternative approach for database search, discovery of previously unknown conformational relationships, and reorganization of protein structure classification.

availability of supporting data
the training and testing datasets for our method can be obtained from previously published papers by chu ch  <cit>  and flores sc  <cit> .

abbreviations
lad: local average distance; ed: euclidean distance; gd: geodesic distance; map: mean average precision.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
hww, chc and twp conceived the algorithm. hww and chc implemented the algorithm, performed the experiments and wrote the manuscript. twp and wcw proofread and revised the manuscript. all authors read and approved the final manuscript.

