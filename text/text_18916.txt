BACKGROUND
next-generation sequencing technologies produce massive amount of data at greatly reduced costs, making it possible to routinely sequence the genomes of various organisms. this is especially true for bacteria, whose genomes are typically less than  <dig> million base pairs . a standard illumina sequencing operation can easily generate enough data to cover the genome of a bacterium more than  <dig> times, which often results in a near-complete genome assembly in a single attempt. in recent years, encouraging progress has been made in de novo sequencing for both small  and large  genomes. methods for alignment and assembly  <cit>  and evaluations  <cit>  have also been developed. nevertheless, no method is all-purpose, and the effectiveness of a method is often subject to constraints, such as genome size as well as the quality, length, and abundance of the reads. in addition, software and hardware environment can also play a role. as a consequence, despite the sheer volume of sequencing data and the highly sophisticated software dedicated to handling these types of data, gaps are commonly found in draft assemblies. besides the limitations of assembling software, two other factors can lead to gaps: the nature of dna templates and sequencing errors. between them, the nature of dna is more critical. for example, some regions of the genome are inherently prone to physical degradation while some others are resistant to amplification due to secondary structures. both of these scenarios result in underrepresentation of the affected sequences in the data set, and therefore, leave gaps.

the presence of gaps often leads to errors in gene finding, annotation, and functional studies. a complete genome is thus preferred or even required in a study. one straightforward way of closing gaps is conducting wet lab experiments, that is, primer walking and sanger sequencing. however, this approach can be prohibitive, in terms of costs. here we report a pipeline aimed to assembling complete genomes with a combination of in silico and wet lab approaches. the input of the pipeline is paired-end sequence reads generated by the illumina technology, and the output is a high quality complete genome sequence. the genome being used as an example belongs to the hyperthermophilic bacterium thermotoga sp. strain rq <dig>  which has a circular genome about  <dig>  ~  <dig>  mb, as estimated based on its close relatives. thermotoga are potential producers of biohydrogen gas  <cit> , a type of clean, renewable fuel.

methods
polymerase chain reaction 
the genomic dna of t. sp. strain rq <dig> was prepared by three rounds of phenol extraction  <cit> . primers used in all pcr reactions were designed with the assistance of primer <dig>  <cit>  and clone manger <cit> . the sequences of pcr products were determined by sanger sequencing. all wet lab experiments were performed according to standard procedures.

pipeline of scaffold assembling and gap closure
a modular pipeline consisting of seven components  was developed to meet our assembling needs:

step  <dig>  de novo assembling with the soap package. three sequencing libraries, with inserts in sizes of  <dig> bp,  <dig> bp, and  <dig> bp, were prepared from the genomic dna of t. sp. strain rq <dig>  paired-end sequencing was performed with each library, which generated reads of  <dig> bp for the  <dig> bp library and of  <dig> bp for the other two libraries. a total of  <dig> mb clean data were collected and were assembled by soapdenovo  <cit>  with k =  <dig>  k value determines the quality of assembly, as measured by the size of the assembly and the number of "n"s it has. larger k values generate longer contigs, but require deeper sequencing depth and longer reads  <cit> . when assembling microbial genomes from illumina data, k is often set between  <dig> and  <dig>  in this work the kmer was empirically set at  <dig> for best results. after the assembling, an initial gap filling and a single base correction were undertaken with soapaligner  <cit> . this part of the work was done by bgi americas  under a service agreement.

step  <dig>  comparative genomics and wet lab validation. a comparative genomics study was performed to evaluate the above assembly and to identify the closest relatives of the t. sp. strain rq <dig>  pcr and sanger sequencing were conducted to validate the analyses.

step  <dig>  integration of the assembly based on a reference genome. an independent assembling effort was taken using the commercial software package clc genomics workbench  <cit> , based on the complete genome sequence of a close relative, which had been identified in step  <dig>  this assembly was combined with the one obtained in step  <dig> to give rise to a hybrid assembly, which was further updated in later steps.

step  <dig>  integration of public data. public databases were searched for sequences belonging to t. sp. strain rq <dig>  the retrieved sequences were used to validate the assembly of step  <dig> and to fill in the gaps in the hybrid assembly.

step  <dig>  "bait-and-fish". this step intends to close the remaining gaps with gapfish , an in-house program written in python. gapfish adopts the "bait-and-fish"  scheme. the input of the program is a sequence found upstream of the gap, which is used as the "bait". the output is a sorted list of all sequences  located in the same reads with the "bait" but immediately downstream of them. the list is evaluated for consensus sequences, and new "bait" is formulated, which is usually the second or third longest "fish". the process is iterated until the gap is filled . a gap is considered filled when the new sequence is mapped to the other side of the gap and the total length of the new sequences is about the size of the gap. when there are competing consensus sequences, the search process will be branched out until a fished out sequence matches to the downstream of the original gap. this process requires human intervention after each search cycle. depending on the context of each gap, the user can define the length and the location of the "bait" and specify the source data set to search within. by this stage, only the most problematic gaps remain, which demands constant monitoring and intervening from the user. in this work, we typically started from the immediate upstream of a gap. the baits were ~ <dig> bp in length, and the source data were the two files containing  <dig> bp reads. the expected size of the fished out sequences were ~ <dig> bp or less, depending on the position of the bait in the matched read. the further the "bait" toward the 5' of the read, the longer the "fish" will be. gapfish can be downloaded from http://personal.bgsu.edu/~zxu/.

step  <dig>  closing the remaining gaps with primer walking and sanger sequencing. this was to fill in the remaining gaps and to validate the results of the previous steps. optimization of dna preparation and pcr conditions were frequently required. as expected, this was the most costly, time-consuming, and labor-intensive step.

step  <dig>  final review with gapfish. although gapfish was originally written to fill in the difficult gaps, we found it was also handy in the final review stage. it was used to double check the overall assembly, especially the sites surrounding the original gaps. errors, introduced when replacing the "n"s with specified sequences, were corrected. gapfish was also useful in circularizing the genome. it was used to remove overlapping region at the ends of the linear assembly. in case the ends of the linear assembly do not meet, gapfish can be used to fill in the gap between the ends.

RESULTS
completing the genome
illumina sequencing generated  <dig> mb of clean data, which was expected to cover the genome of t. sp. strain rq <dig> more than  <dig> times. after assembling with soapdenovo and gap-filling with soapaligner , a scaffold of  <dig> , <dig> bp  was available , which corresponds to ~98% of the complete genome. the scaffold had  <dig> gaps in the range of  <dig> bp to  <dig>  kb, represented by strings of "n"s. each of these gaps seemed to be small enough to be closed by a single pcr reaction; thus these gaps were referred to as minigaps.

*coverage was calculated by comparing the total number of nucleotides  assembled  to the size of the complete genome of t. sp. strain rq <dig> 

a comparative genomics study  was conducted by examining the assembly against all publicly available thermotoga genomes. it was found that the genome of t. sp. strain rq <dig> was most similar to that of t. neapolitana, indicating that the two strains are more closely related to each other than to any other thermotoga strains. this finding is in agreement with the results based on 16s rrna analysis  <cit> . therefore, the genome of t. neapolitana was used as the reference genome in later part of the study. meanwhile, it did not escape our attention that although the genomes of t. sp. strain rq <dig> and t. neapolitana shared a high level of synteny, small scales of insertions, deletions, and rearrangements were common. most strikingly, a region of ~ <dig> kb found in t. neapolitana was missing in the assembly of t. sp. strain rq <dig>  further investigation indicated that this region was conserved among other thermotoga genomes . this unusually large deletion, observed only in the current assembly of t. sp. strain rq <dig>  prompted us to test the authenticity of the deletion by wet lab experiments. five genes of the region were arbitrarily selected for amplification. pcr primers were designed based on the conserved parts of these genes, and genomic dna from four species was tested, namely, t. neapolitana, t. maritima, t. sp. strain rq <dig>  and t. sp. strain rq <dig>  the pcr profiles and the following sanger sequencing results revealed that all of the  <dig> tested genes were present in t. sp. strain rq <dig>  which means, in addition to the  <dig> minigaps, the current assembly contained a hidden big gap of ~ <dig> kb.


t. maritima
t. neapolitana
comparative analysis of the ~ <dig> kb big gap region among four thermotoga genomes, showing the synteny and conservation. this region was missing from the initial assembly of the t. sp. strain rq <dig> genome but was included after combining the data from the clc assembly and the primer walking effort. the asterisks  indicate the presence of a homolog that is not annotated as a gene in a particular genome. absent indicates the complete deletion of the orf in a particular genome.

in order to reduce the gap number and/or their sizes, a commercial software package clc genomics workbench was employed to re-assemble the entire set of illumina reads of t. sp. strain rq <dig>  using t. neapolitana as the reference genome . an assembly of  <dig> , <dig> bp  was generated, which had  <dig> gaps, ranging from  <dig> bp to  <dig> kb . the scaffolds generated by the clc package filled  <dig> of the  <dig> minigaps found in the soap assembly. after patching in the sequences of the  <dig> minigaps, we obtained a hybrid assembly of  <dig> , <dig> bp . furthermore,  <dig> fragments totalling up to  <dig>  bp were assigned to the big gap, which brought the total assembled nucleotides to  <dig> , <dig> bp .

*: "n"s are not counted. assemblies in steps 1- <dig> have overlapping end sequences . as a result, the assembly in step  <dig> appeared to be slightly bigger than the final assembly.

searching of genbank  identified  <dig> entries belonging to t. sp. strain rq <dig>  which were sanger reads previously deposited by other researchers. among them,  <dig> fell into the assembled regions and  <dig> into the unfilled minigaps. after that, gapfish  successfully closed  <dig> more minigaps. the last remaining minigap, located in a highly repetitive region, could only be reliably determined by wet lab experiment. in addition, we were able to use gapfish to correct  <dig> locations that had been previously misassembled by either the soap package or the clc package. however, the attempt to fill in the big gap with gapfish revealed that there were no additional reads in the data set that belonged to the big gap. this surprising finding suggested that sequences of this region were severely underrepresented in the original data set. under such circumstances, we had to appeal to the wet lab approach for the remaining tasks.

primer walking and sanger sequencing  were sought after to solve the last mini-gap, to validate the filling of other minigaps containing repetitive sequences, and to close the big gap. the closure of the big gap was achieved by using freshly prepared dna template  and optimizing pcr conditions. the requirement of fresh dna templates indicated the physical instability of the region, which could have led to the underrepresentation of the corresponding sequence reads. eventually, the total size of the big gap was determined to be  <dig>  bp. this region of the t. sp. strain rq <dig> genome was compared to the counterparts of t. neapolitana, t. maritima, and t. sp. strain rq <dig>  most of the predicted gene products are hypothetical proteins with unknown functions . after a final review , the complete genome was determined to be  <dig> , <dig> bp, with a gc content of  <dig> %. the statistics of the assembling process is summarized in table  <dig>  to highlight the effectiveness of the pipeline, the final assembly was compared to the assemblies obtained just from the soap or clc package . because our pipeline integrates results from both packages, it is clearly superior to either of them employed alone. by further integration of the data from other sources, including the public data, the gapfish analyses, and the wet lab experimental data, the pipeline was able to deliver a complete genome in the end. in our pipeline, the results of each step were evaluated and validated multiple times in the following steps, which ensures high quality of the final assembly. the genome of t. sp. strain rq <dig> has been deposited to genbank with the accession number cp <dig> 

differentially annotated genes
because gaps in draft genomes may contain start and stop codons, closing the gaps is likely to alter the annotation results of the affected regions. compared to the initial draft assembly of the soap package, the complete genome of t. sp. strain rq <dig> recovered  <dig> genes that were previously missing, changed the sizes of  <dig> genes, and dismissed  <dig> false open reading frames  . the affected genes were predicted to take part in many essential cellular processes, such as sugar transportation and utilization, chemotaxis, rna/dna processing, sulfur metabolism, and transcription regulations. missing or false annotation of these genes could lead to erroneous interpretation of the biology of the organism, which could result in great loss if follow-up work was pursued with these genes.

discussion
this work distinguishes itself from similar studies  <cit>  from the aspect of multi-phase interactions between computational and biological approaches . the pipeline started from a de novo assembly of paired-end reads, followed by a comparative genomics analysis and wet lab verification, which led to the identification of a reference genome as well as the discovery of a hidden big gap. the genome was then re-assembled based on the reference genome, providing additional contigs. public databases were then utilized to reduce the number of gaps, prior to another round of customized gap closure effort, using gapfish. when in silico options were exhausted, wet lab methods were introduced again; by then, the number of required lab work had been reduced to the minimum. the pipeline ended with an in silico final review.

the robustness of the pipeline relies upon the intimate interaction of in silico and wet lab approaches from an early stage. rich biological information deduced from the previous step of computation can be used to guide the next stage of work, either in silico or in a wet lab setting. because in silico methods are more efficient and less expensive, we should take full advantage of their benefits. in this work, software products from various sources were utilized, including the free ware soapdenovo and soapaligner, the commercial package clc genomics workbench, and the in-house program gapfish. they accomplished complementary tasks, and each played a critical role at different stages. on the other hand, technologies have their shortcomings. computational results should always be carefully evaluated in a biological context and be validated with wet lab experiments.

the pipeline is intrinsically flexible to allow customization of the modules. for instance, one can simply skip step  <dig> if there are no public data available for the target genome. in addition, it is worthwhile to point out that the reference genome used in step  <dig> refers to the most related genome sequence currently available. the reference genome would be most helpful if it is from the same species as the target genome, but it could still provide useful regional assemblies if they just share the genus . bypassing this step is also acceptable, although it will shift the workload to the later steps.

CONCLUSIONS
in this study, we developed a genome assembling pipeline using commonly available tools and resources. it stresses the intimate, multi-phase interactions between in silico and wet lab approaches. the application of the pipeline was established via the delivery of the complete genome sequence of t. sp. strain rq <dig>  the constituting principles and methods are applicable to a variety of similar studies with both prokaryotes and eukaryotes.

competing interests
the authors declare that they have no competing interests.

authors' contributions
rp conducted all pcr experiments and performed most part of the data analysis. jw, gq, rz, and zx participated in data analysis. rp, gq, and rz also contributed to drafting the manuscript. zx conceived and coordinated the study, wrote the gapfish software, and drafted the manuscript. all authors read and approved the final manuscript.

