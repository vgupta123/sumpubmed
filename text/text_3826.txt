BACKGROUND
bacteria use sophisticated mechanisms to sense, predict and respond to environmental changes in time and across space. chemotaxis directs the movement of individual cells towards their likes  and away from their dislikes  while quorum sensing and cell-signaling help bacteria coordinate their behavior at the population level  <cit> . bacteria growing together in a common location actively change their surroundings by depleting nutrients, producing metabolites, and secreting signaling-molecules  <cit> . this collective conditioning of the environment, combined with the individual response of cells to their changing environment, can lead to the formation of complex patterns in spatiotemporal cell distributions  <cit> .

in spatially structured habitats, migration and colonization are important features of population dynamics. in his classic work, adler showed that escherichia coli can spread on agar plates as traveling population waves  <cit> . the formation and migration of these waves is driven by chemotaxis along gradients in nutrient concentration, bacteria form these gradients as they consume nutrients  <cit> . moreover, on plates initially lacking any chemoattractants, both e. coli and salmonella typhimurium can form symmetrical patterns consisting of spots and rings, caused by chemotaxis towards self-secreted attractants  <cit> . many species, including e. coli, can also form complex patterns consisting of branching colony structures  <cit> . despite the fact that such colony development is influenced by a myriad of environmental factors, regularities in these patterns have been described  <cit> .

previous studies that illuminated important aspects of microbial life in spatial environments used habitats  that lack fine spatial structure. however, natural environments of bacteria such as soil  <cit>  and the gut  <cit>  have structure at multiple spatial scales, including the micrometer to millimeter range. in these heterogeneous  environments, metapopulations  are likely to develop  <cit> . recently, microfluidic devices have become a powerful tool to study bacteria in such spatially structured environments. microfluidic devices have been used to study the behavior of single cells within collectively moving populations  <cit>  and the effects of spatially structured habitats  <cit>  and heterogeneously distributed nutrients  <cit>  on population dynamics.

most work so far has studied a single population colonizing a new habitat. however, in natural systems different populations can invade habitats from multiple locations. previous work using agar plates has shown how interactions between populations originating from separate inoculations of the same strain can lead to the development of complex macroscopic patterns  <cit>  however, a microscopic investigation of these interactions is currently lacking.

here, we investigate the invasion of spatially structured habitats by two separate populations in microscopic detail. time-lapse fluorescence microscopy of two differentially labeled strains of e. coli allows us to resolve dynamics within the interacting populations down to the single cell level. in order to approximate the natural patchy environment of bacteria, we make use of microfabrication to create spatially structured habitats, consisting of coupled arrays of habitat patches. we focus on three related questions  how are these patchy habitats colonized?  how do the two strains invading from opposite ends of the landscape interact during the colonization of the habitat? and  how reproducible are the colonization patterns?

we found that cells colonize a habitat from opposite sides by a series of traveling waves followed by an expansion front. the populations invading from opposite ends do not mix in the habitat, rather, colonization waves collide and expansion fronts compete for the landscape. we demonstrate that these interactions are mediated by diffusible chemicals. we found that the qualitative features of the colonization patterns are similar for all experiments, even though population distributions vary widely between experiments. however, when parallel habitats located on the same device are inoculated from the same initial cultures, we observe strikingly similar population distributions.

RESULTS
using microfabrication we created devices consisting of five parallel habitats, each consisting of an array of  <dig> patches connected by narrow connectors . habitats are connected to either individual inlets , or to a single shared inlet  used for inoculation. unless noted otherwise, two differentially labeled, but otherwise isogenic, strains of e. coli were inoculated at opposite sides of the habitats. we refer to cells and populations of these strains as ‘green’  and ‘red’ . the neutrality of the two markers was demonstrated in previous work  <cit>  and verified here by measuring growth in bulk conditions .

colliding waves decompose into distinct components
after inoculation, the populations initially grow in the inlet holes and start to colonize the habitats after  <dig> to 4 hours. during the first phase of colonization typically three waves enter the habitat, as can be seen in figure 1d. the first two waves  are of relatively low cell density , while the third wave  is a high-density wave at the leading edge of an expansion front . in most  habitats, three waves with densities and velocities similar to figure 1d are seen for at least one of the two strains, while in all  <dig> habitats  at least a single wave is observed. these colonization waves require chemotaxis, as a smooth-swimming, non-chemotactic, chey knockout strain did not form any waves . bacteria in a wave remain tightly packed while traveling throughout the patchy habitat, although there is some limited dispersion of the wave profile . the observed wave profiles  and velocities  compare well to those described in previous work, where wave velocities of  <dig>  to  <dig>  μm/s were reported for linear channels  <cit> , while waves in large unstructured chambers traveled at  <dig>  μm/s  <cit> . this indicates that a patchy spatial structure does not interfere with the formation and propagation of bacterial population waves. interestingly, the waves span multiple  patches, indicating that traveling populations are formed at scales larger than that of the habitat patches.

when two waves coming from opposite inlets collide, they give rise to complex but reproducible spatiotemporal patterns . figure 2a shows data depicting a green wave coming from the left and a red wave coming from the right. after their collision, most green cells remain grouped with other green cells, either in the reflected wave traveling back towards the left inlet, or in a large stationary population . the red cells show a similar post-collision distribution, consisting of a reflected wave and a stationary population spatially separated from their green counterpart . as most cells stay with their original population, it is still possible to distinguish between ‘red’ and ‘green’ populations after the collision. notice, however, that a small number of cells do mix into the other population as can be seen in patch  <dig> in figure 2c, for example. it is interesting to note that the reflected wave reverses direction within 10 minutes, without first forming a detectable stationary subpopulation, contrary to previous observations where reflected waves reverse direction on much longer time scales , after first forming a stationary population  <cit> . we observe similar collision patterns between colonization waves even when both sides of the habitat are inoculated with cells from the same strain, indicating that these collisions are not an artifact of the fluorescent markers .we observe that patterns of wave collisions are similar in habitats on the same device , however, there is a large variation in the collision patterns between habitats on different devices inoculated with cells from a different set of initial cultures . for each wave the post-collision outcome can be decomposed in three components:  part of the wave is reflected back, continuing to travel as a wave after quickly  having reversed its direction;  part of the wave disintegrates and a local  population is formed;  part of the wave is ‘refracted’, continuing to travel as a wave in the same direction as before the collision, although typically with a lower velocity. the distribution of bacteria from the incoming wave over these three components can vary strongly between devices, as can be seen in figure  <dig>  for example: in figure 3a the green and red α-waves both have strong reflected parts , in figure 3b the red α-wave completely disintegrates and in figure 3c a large part  of the red α-wave is refracted. the patterns can become more complex if subsequent incoming waves interact with the subpopulations formed in the initial collision. for example in figure 3c, a red β-wave merges with a green stationary populations and a combined, two-strain wave , is formed and starts traveling to the left of the habitat.

incoming expansion fronts remain spatially segregated
following the colonization waves, two expansion fronts enter the habitat from opposite ends . upon encountering each other, these fronts form a boundary that exhibits a gradual transition from a majority of green cells to a majority of red cells over a distance of  <dig> to  <dig> patches . except for this relatively narrow transition zone, the two strains remain spatially segregated over the course of the experiment. however, individual cells do move across the entire habitat  suggesting that there is no physical barrier for cells to cross the boundary.

in  <dig> out of  <dig> devices  the boundary between the two expansion fronts remains in the same location . however, in the other cases  the location of the boundary shifts over time and one of the populations eventually occupies at least two-thirds of the habitat . on average both strains take over the habitat an equal number of times indicating that they are neutral when averaged over many experiments . to confirm this, we inoculated a device on both sides with cells from a 1: <dig> mixed culture of the two strains. the habitats are colonized by waves and expansion fronts consisting of a mixed  community of the two strains . over the course of the experiment both strains remained mixed both on the local  and global  scale with a high degree of overlap in the spatial distribution of the two strains , showing that the two strains are neutral when growing in patchy habitats. furthermore, this shows that when the same two strains are cultured and inoculated separately they remain spatially segregated, while if they are cultured and inoculated together, they remain mixed.

we further investigated whether the success of a strain in the structured habitats, measured as the area fraction of the habitat that they occupy , can be predicted from their growth in batch culture. to do so, we investigated the relation between growth properties of the initial cultures and the occupancy obtained in the habitat. we found that there is a significant positive correlation between the relative doubling times of the two initial cultures in bulk and the relative occupancies they obtain in the habitat . this indicates that the slowest growing culture  in bulk conditions tends to colonize the largest part of the habitat. it should be noted that both strains have similar doubling times and can obtain a majority fraction of the habitat . this suggests that although the two strains are neutral when averaged over many experiments, in each individual experiment small differences between the initial cultures translate into different outcomes of the colonization process. we observe a similar trend when looking at the occupancy averaged over the entire colonization process  while there are no, or only weak, effects of other properties of the initial cultures .interestingly, one strain can drive the other out of the habitat before their expansion fronts physically meet: figure 4e shows a green population front that reverses direction shortly after  a red population front entered the habitat from the right, even though the two fronts are separated by approximately 1 cm at that time. figure 4f shows a green population that stops and reverses direction before a single cell of the red population has reached the green front .

interactions between populations are chemically mediated
as a consequence of the observations described above, we hypothesized that chemical interactions  but not physical interactions  are the main mechanisms underlying the collisions of colonization waves as well as the interactions between expansion fronts. we believe so for three reasons:  wave collisions occur even at low cell densities ,  populations remain spatially segregated even though cells could pass freely across the boundary, and  two fronts interact over large distances or when they are separated by vacant patches. to test this hypothesis, we designed a third type of device  consisting of two parallel, diffusionally coupled arrays of patches . these two habitats are coupled by 200 nm deep nanoslits, which allow for the diffusion of nutrients, metabolites and signaling molecules while being too shallow for bacteria to pass through  <cit> , thereby confining each metapopulation to a single habitat.

the two coupled habitats were inoculated from top-left and bottom-right ends with cells from the same initial culture . figure 5b and c show that ‘collisions’ of waves and expansion fronts also occur between these physically separated, but chemically coupled clonal populations. for example, the wave in the top habitat coming from the right  stopped and formed a stationary population when it reached the  wave coming from the left in the bottom habitat . furthermore, the high-density regions in the top and bottom habitats remain largely segregated in space , indicating that even though these populations inhabit two different habitats they still avoid being close to one another. thus demonstrating the importance of chemical interactions in structuring the spatiotemporal distribution of bacterial populations.

the degree of similarity between population distributions is influenced by the initial culture
we observed that the population distribution in habitats on the same device, which were inoculated with cells coming from the same set of initial cultures, are highly similar to each other . even in the early phases of colonization, when there are only about a thousand cells present in the entire habitat, patterns are similar to each other . conversely, we observed a large variation between the population distributions in habitats located on different devices that were inoculated with cells coming from different sets of initial cultures .

we performed a quantitative analysis to investigate whether there is a significant difference in the degree of similarity between habitats located on the same device, which were inoculated from the same cultures, compared to habitats located on different devices, which were inoculated from different cultures. the similarity of patterns was quantified by calculating the difference between the patterns using eq.  <dig> , which ranges from d =  <dig> for identical patterns to d =  <dig> for maximally different patterns. we found that the average difference between the population distributions in habitats located on the same device and inoculated from the same set of initial cultures  is significantly smaller than the average difference between patterns of habitats inoculated with different sets of initial cultures . this is the case both for devices with independent inlets  as well as for devices with a shared inlet .

the similarity of population distributions in habitats in the same device could potentially be caused by a coupling between habitats , an identical response of the bacteria to device-wide gradients  or by other extrinsic variation. we tested for these possibilities using two sets of experiments. first, we used a type- <dig> device that consists of two habitats separated by  <dig>  mm, which are inoculated in reverse order . the patterns in these two habitats were similar to each other , suggesting that spatial proximity is not a necessity for obtaining similar population distributions in replicate habitats.

secondly, we used devices of type- <dig> consisting of four parallel habitats, which were inoculated from two sets of initial cultures such that neighboring habitats were colonized by different cultures . we found that neighboring habitats inoculated from different initial cultures do not become more similar due to their proximity to each other, with a median difference between patterns in habitats located on the same device, but inoculated from different cultures, of d
different
 =  <dig>  , which is similar to the observed value of the difference between patterns in habitats located on separate type- <dig> and  <dig> devices, which were inoculated from different cultures, of d
different
 =  <dig>  . this demonstrates that population distributions in neighboring habitats that were inoculated from the same initial cultures are not similar just because of their location next to each other on the same device.

for the type- <dig> devices the difference between habitats inoculated from different initial cultures is calculated by comparing habitats on the same device, while for the type- <dig> and  <dig> devices this difference is calculated by comparing habitats located on different devices. to make sure that the calculated values are comparable, we also calculated the difference between habitats located on different devices  for the type- <dig> devices. here we find a median difference of d
different
 =  <dig>   which is similar to that of the type- <dig> and  <dig> devices , indicating that the calculated values for the differences between population distributions are comparable between the type- <dig> and the type- <dig> and  <dig> devices.

the results of the type- <dig> and  <dig> devices  show that neighboring habitats do not become similar when they are inoculated from different cultures, while habitats inoculated from the same cultures remain similar even when they are separated in space and invaded in reverse orientation. this strongly suggests the higher degree of similarity in population distributions between habitats on the same device, colonized by the same culture sets, as observed in the type- <dig> and  <dig> devices  is not a consequence of abiotic factors or other extrinsic variation, but rather that it is caused by an underlying biological mechanism intrinsic to the colonizing populations.

we hypothesized that the similarity between replicate habitats was a consequence of inoculating them with the same initial cultures. however, when we compare the two habitats on type- <dig> devices that were inoculated from the same culture set we found that the difference between population distribution in habitats inoculated from the same culture set  is not significantly different from the difference between habitats inoculated from different culture sets .

which mechanisms are instead causing the observed similarity in population distributions between the replicate habitats in device types- <dig> and  <dig> is currently unclear. nevertheless, our results do suggest that colonization patterns are strongly affected by some  deterministic factors, while stochastic effects during the colonization process have only a limited influence.

discussion
we consistently observe colonization waves entering the habitat from both ends with wave profiles and velocities  comparable to those reported for population waves in previous studies  <cit> . this indicates that the qualitative features of bacterial colonization waves are robust to changes in habitat geometry and suggests that our results could be of importance in natural habitats with complex spatial structure ranging from the micrometer to the millimeter scale. our habitats are typically colonized by two waves of low cell density  followed by a single high-density wave . this succession of multiple waves is reminiscent of the observations by adler, who showed that multiple waves can form both in capillary tubes and on agar plates, where each wave consumes a different set of nutrients  <cit> . we further studied the local interaction between colliding waves and observed, similar to previous work on agar plates, that when waves collide  they can either reflect back, continue in the same direction with an altered velocity , or collapse to form a distinct and localized sessile population  <cit> . moreover by using differentially labeled cells we have shown that although mixing does occur to some degree, the bacteria traveling within a wave remain mostly together after colliding with another wave. we observed two main differences in relation to earlier experiments:  previously  <cit> , waves have been observed to either reflect, refract or collapse  but not to split into simultaneous combinations of these options. we observe that all three outcomes are simultaneously possible at a single collision, although there is a large variation between experiments in the distribution of the incoming wave over these components ;  previously  <cit> , it has been observed that a localized population  can emit a reflected wave after about one hour . in contrast, the reflected waves observed in our devices reverse direction within 10 minutes, without first forming an observable stationary population.

driven by the results described above we designed a third type of device  with which we demonstrated that traveling populations confined to separate, but chemically coupled, habitats still influence each others colonization dynamics and exhibit “collisions”, despite having exclusive access to vacant patches . this shows that chemical interactions are the main mechanisms underlying the collision patterns of colonization waves as well as of expansion fronts. these interactions could possibly be mediated by small diffusible molecules. using a typical diffusion constant of d = 5·10−6 cm2/s for such molecules, we find that diffusion between the two coupled habitats takes place on the order of  <dig>  s, while the diffusional range at the time-scales probed in this study  is on the order of 1 mm . therefore diffusible molecules could indeed be involved in the observed interactions of population waves and in the short-range interactions between population fronts. the long distance interactions  however, happen at time scales much faster  than those of diffusion . these interactions might therefore be mediated by different mechanisms. nevertheless, it is likely that at least the short range  interactions are caused by some form of habitat conditioning  and/or by cell-signaling.

it is interesting to note that when two strains are co-cultured together before inoculation, they colonize a habitat together and form a mixed metapopulation . in contrast, if the strains are cultured independently and invade the habitat from opposite ends, they form two distinct and competing metapopulations that do not mix when they meet in the habitats . furthermore, we have demonstrated that population waves and expansion fronts from opposite sides remain spatially segregated, even if they originate from the same culture  and consist of cells of the same strain.

these observations, together with the observed interactions of colonization waves and expansion fronts, suggest that the spatial segregation of different populations is caused by some sort of avoidance mechanism. observations in other microbial species could hint at possible mechanisms for such avoidance between different populations. for example, in bacillus subtilis and paenibacillus dendritiformis chemo-repellents have been suggested to cause self-avoidance of colony branches  <cit> . in p. dendritiformis the excretion of a growth inhibiting lethal factor causes the formation of a well defined boundary between sibling populations  <cit> . a genetic system for self- versus non-self recognition was found to mediate boundary formation between different proteus mirabilis strains  <cit>  and in dictyostelium discoideum the cell cycle phase and nutritional status of subpopulations has been shown to affect their relative contribution to spore and stalk cell populations  <cit> . however, to the best of our knowledge, such mechanisms have not  been shown to be of importance in e. coli. furthermore, it would be interesting to see if the current models of population waves  <cit>  are capable of producing the local collision patterns on the timescales we observed in our experiments.

in the type- <dig> and  <dig> devices we observed a remarkable similarity between colonization patterns in replicate habitats on the same device. population distributions in habitats on the same device, which were inoculated from the same set of initial cultures, are significantly more similar to each other  than to the patterns in habitats on different devices which were inoculated from different culture sets . using a device of type- <dig> we showed that population distributions in habitats inoculated from the same cultures are similar even when the habitats are not parallel to each other , while using devices of type- <dig> we showed that population distributions in habitats inoculated with different cultures do not become similar when the habitats are located next to each other on the same device . together these data strongly suggest that the observed similarity between replicate habitats in type- <dig> and  <dig> devices is not an artifact of our experimental design, but is rather caused by a biological mechanism.

all devices were prepared by strictly adhering to the experimental protocol ; therefore, we suspected that the variation in colonization patterns between different devices was caused by differences in the initial cultures used to inoculate the habitats. we tested this hypothesis using the type- <dig> devices, however, for these devices we found that habitats located on the same device and inoculated from the same set of initial cultures were not more similar to each other than to habitats located on the same device but inoculated from different culture sets . we therefore have no conclusive evidence that the degree of similarity between habitats is caused by the initial cultures used to inoculate them, however, our results suggest that the initial cultures might affect colonization patterns to some degree. at the moments it is unclear which other mechanism causes the observed similarity between the replicate habitats in the type- <dig> and  <dig> devices.

it should be noted that the actual habitats in all device types are identical and that the only differences are in the number of parallel habitats, the inlets and the inoculation procedure . therefore, the only two differences between type- <dig> and  <dig> devices and type  <dig> devices are:  the reduced number of replicate-habitats . additional file  <dig> shows that in some cases there is substantial variation between the population distributions in replicate habitats on the same device . therefore, having only two replicate habitats could reduce the likelihood of detecting a significant effect of the initial culture on the similarity in population distributions;  in type- <dig> devices habitats inoculated from the same cultures are further apart  and are separated by a habitat inoculated from a different culture set; and  for the type- <dig> devices variation in the preparation of overnight cultures was reduced: instead of taking a sample  of the frozen −80°c stock, a defined volume of a thawed aliquot of this stock was used to start the overnight cultures .

our results show that spatial proximity is not sufficient to make patterns of different cultures similar , nor is it required to keep patterns of the same cultures similar . nevertheless, we cannot rule out that there is some limited coupling between the habitats. there is a possibility that weak coupling works in concert with culture history to produce similar patterns, but is not sufficient to produce an effect on its own if neighboring populations do not originate from the same initial cultures.

nevertheless, we do observe a striking and significant degree of similarity between neighboring habitats located on the same device and inoculated from the same initial cultures  that to the best of our knowledge cannot be explained by any abiotic factors. despite the many open questions, our results do show that colonization patterns are in a large part shaped by  deterministic factors, while stochastic effects are only of limited importance.

CONCLUSIONS
we studied the invasion and colonization of spatially structured habitats by two neutrally labeled strains of e. coli. one-dimensional arrays of habitat patches were colonized by a succession of colonization waves followed by an expansion front. the interactions between the two invading populations lead to complex, but reproducible, spatiotemporal patterns which are dominated by the collisions of colonization waves and expansion fronts. colliding colonization waves each split into a combination of a stationary population, a reflected wave, and a refracted wave; while expansion fronts entering from opposite sides remain spatially segregated and compete for habitat space. as these interactions also occur when the two populations are in separate, but diffusionally coupled habitats, we can conclude that interactions between populations are mediated by chemical fields and do not require physical contact.

finally, we showed that the outcome of the colonization process is influenced by a culture’s history, as the relative doubling time of the initial cultures in bulk conditions correlates with the relative occupancies obtained in the habitats. together, our data show the important roles of chemical coupling between populations and culture history in determining the colonization of spatially structured habitats.

