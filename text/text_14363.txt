BACKGROUND
it is well established that gene expression can vary significantly from cell to cell, even in the same clonal population , in no small part due to the stochastic nature of transcription events in any single cell  <cit> . much work has been done to computationally model gene expression networks, including the well-characterized galactose utilization network  in yeast. many of those models , however, are deterministic models and therefore could provide only limited insights on what happens at the single-cell level. the shortcomings of this approach is demonstrated by previous work  <cit>  that showed that stochastic noise could generate bimodality in a system whose deterministic models predict no bistability.

therefore, to understand these inherently stochastic processes at the single-cell level, stochastic models are all but required. many such models in recently published works  <cit> , however, suffer from several deficiencies. these models usually do not take into account variations in rates of transcription, translation, or cell growth among isogenic cells. nor do they take into account the cell cycle, whose impact on transcription has recently been suggested to be capable of accounting for most of the noise in gene expression  <cit> . in essence, they model a cell that is stuck indefinitely in the g <dig> phase of the cell cycle. such approximations could be acceptable if the simulations lasted for a time period much shorter than the duration of the cell cycle, but they would be questionable for longer simulation durations.

here we introduce a detailed stochastic model of gene network activity that can be applied to any eukaryotic gene network. the model takes into account real-time changes in cell volume and cell cycle, and it can time-dynamically track the lineage of individual cells while each cell changes its size and gene expression content. to show the efficiency and predictive power of our model, we applied it to the well-characterized gal network. using the yellow fluorescent protein  driven by the gal <dig> promoter  as a reporter, we experimentally quantified its expression levels from single cells at two different time points and used these data for fitting, followed by model predictions without any fit parameters. our model could effectively capture several details of these single cell expression distributions as well as phenotypic switching rates by using a minimal set of free parameters.

RESULTS
modeling cell volume growth and division
our stochastic single-cell model consists of two interrelated modules. the first module models the dynamics of cell volume growth and division. for this, we modeled cell growth and division in the asymmetrically growing budding yeast s. cerevisiae. based on a previous experimental characterization  <cit> , we divided the cell cycle into two stages, one consisting of g <dig> and the other consisting of s/g2/m. as illustrated in fig. 1a, the cell volume grows linearly in both stages but at different rates. it was previously shown  <cit>  that the volume at which start is reached  is linearly related to the growth rate in g <dig>  while the volume growth in s/g2/m is mostly attributable to the bud, and determines the size of the daughter cell.fig.  <dig> the two modules of the stochastic single-cell model. a. illustration of a model of cell growth with asymmetric division  <cit> . the cell grows at different rates in the cell cycle stages of g <dig> and s-g2-m, with the volume increase in s-g2-m being primarily attributable to the daughter compartment. b. the seven stochastic reactions associated with each gene in the network and the rate constants. the promoter switches between on and off states. the on state promoter is transcribed to produce mrna, while the off state promoter also has some basal, leaky transcription. mrna is translated to produce protein; and both mrna and protein can be degraded



the cell cycle is divided into two stages  and three time blocks  . t <dig> consists of the beginning of g <dig> until start; t <dig> from start until the end of g1; and t <dig> consists of the entire second stage of the cell cycle . the value of t <dig> for each cell follows the following equation: t1=min,vs=kr1+b where t1' provides a lower bound to the length of t <dig>  v <dig> is the volume of the cell at the beginning of the cell cycle, vs is the volume of the cell at start, r <dig> is the rate of volume growth in g <dig>  and k and b are model parameters relating r <dig> to vs. the model parameters consist of the mean and standard deviations of the initial volume of the starting cells , the growth rate in g <dig> , the overall growth rate in s/g2/m , the mother compartment’s growth rate in s/g2/m , the minimum length of t <dig> , the duration from start to s phase entry , and the duration of s/g2/m , each of which is assumed to follow a normal distribution, along with k and b.

at each cell division, daughter cells inherit a certain degree of the parameters of their parent. the exact level of inheritance is described by an additional model parameter, c, such that for a given parameter p, pdaughter=cpparent+1−cpfresh where pfresh is a value sampled from the distribution of p.

modeling the activity of an n-component gene network
the second module of our model is a stochastic model of an n-component gene network. the genes composing the network are under the control of a master transcription factor that controls the activation rate of the network promoters. we denote the genes inside the network by g <dig>  g <dig>  …, gn, and have the activity of the network be reported by a fluorescent reporter gene denoted by g <dig>  the reporter gene’s activity is determined by the network’s activity. we model the promoter of each gene to switch between two states, off and on, with full-strength transcription only occurring in the on state. we denote the mrna corresponding to gx  as rx, and the protein as px. the number of copies of promoters of gene gx in off  state is denoted as proff,x . then, for each gene gx including the reporter, we construct a set of seven stochastic reactions, as illustrated in fig. 1b. for a cell with volume v, the reaction rates for each reaction are: promoter activation:ron, x proff,x

promoter inactivation:roff, x pron, x

mrna synthesis from inactive promoter:rm,xbxproff,xvrefv

mrna synthesis from active promoter:rm,xpron,xvrefv

mrna degradation:dm,xrxvrefv

protein synthesis:rp,xrxvrefv

protein degradation:dp,xpxvrefv



 vref is a constant scaling factor equal to the average volume of the entire population of cells. we introduced it to make the value of reaction parameters more comparable to experimental measurements. the stochastic reactions are governed by the parameters roff,x, ron,x, rm,x, bx,rp,x, dm,x, and dp,x. the parameter ron,x is determined by the following equation: ron,x=rxfinducer,p <dig> p <dig> …,pn where rx is the maximum activation rate of the promoter of gx. f is a function relating the concentrations of the inducer and p <dig>  p <dig>  …, pn to the overall activity of the network, and is called the functional form of the network.

we further opted to use as a model parameter not the promoter inactivation rate roff,x, but instead the fraction of time a promoter spends active when fully induced. we define this fraction, fx, as fx=rxrx+roff,x 

both fx and rx are model parameters for all x =  <dig>   <dig>  …, n.

further, in our actual model, we use not the actual mrna synthesis rate per promoter rm,x, but the observed mrna synthesis rate r'm,x. the two are related by the equation rm,x′=rm,xfx+bxrm,x 

this implementation reflects that, even in fully induced cells, the promoters are only being transcribed at maximum rate a portion  of the time. similarly, we use the observed basal expression level b'x, instead of the actual ratio between off-state and on-state transcription rates bx. the two are related by the equation bx′rm,x′=bxrm,x 

to summarize, for each network component , there are seven stochastic reactions described by seven parameters: rx, fx, r'm,x, b'x, rp,x, dm,x, and dp,x.

combining the gene network activity model with the cell growth and division model
next, we incorporated cell volume growth and division into our stochastic gene network model by including cell volume as an additional stochastic reaction. the rate at which the reaction fires is determined by the current cell volume growth rate as calculated by the volume model, and each time the stochastic reaction fires, the cell volume is increased by a small, fixed amount determined by the volume model. this change in cell volume in turn changes the rates of the stochastic reactions.

our model also takes into account the changes in the number of copies of the genetic material during cell cycle. during dna replication, when an active promoter replicates into two promoters, we assume that both promoters remain active. similarly, an inactive promoter is assumed to replicate into two inactive promoters during dna replication. further, during cell division, we distribute the mrna and protein contents between mother and daughter cells in accordance with a binomial distribution whose probability p is equal to the ratio of the volume of the daughter cell to the total volume.

simulations using the combined stochastic model
using this single-cell level model, we simulated populations of cells for 22 h and 5 h, which were also the time periods we used for growing the cells in our experiments.

however, due to exponential growth of the population size, with any reasonable size for the initial population of cells, it is impractical to simulate all of its descendants for 22 h. hence, we added a sampling step . for the 22 h simulation, we started from an initial population of  <dig> cells, ran the simulation for 11 h and randomly sampled  <dig> cells from the resulting population of ~ <dig>  cells, and then simulated those cells for another 11 h for a final population of ~ <dig>  cells.fig.  <dig> overview of the gal network and the simulation process. a. the gal network in s. cerevisiae with its activity reported by a pgal1-yfp reporter. transcription of gal <dig>  gal <dig>  gal <dig>  and the reporter are controlled by the transcription factor gal4p. gal80p represses gal4p and is in turn repressed by the inducer gal3p and gal1p in the presence of galactose. b. as a cell grows, both the volume and the number of gene and network copies will change. c. the simulation and sampling process for the 22-h simulation. each cell in the figure represents  <dig> cells; the initial population is simulated for 11 h, resulting in a population of ~ <dig>  cells; from this population  <dig> cells are sampled and simulated for an additional 11 h to produce the final population of cells



for the 5 h simulation, to minimize the effect of the initial state on the result of the simulation , an initial population of  <dig>  cells were simulated for 5 h in basal conditions, a sample of  <dig>  cells were taken, the inducer was introduced to the system, and the sampled cells were simulated for an additional 5 h.

we repeated this simulation and sampling process for several different inducer concentrations . the output of the simulation with a given set of parameters and inducer concentration was a set of reporter protein counts in the final population of cells, which we converted to simulated fluorescence measurements by using a fitting procedure .fig.  <dig> comparison between fitting results and experimental measurements. comparison of the fitting results and experimentally-measured single-cell fluorescence distributions at the specified galactose concentrations, for the 5-h  and 22-h  experiments. bars indicate experimentally measured distributions. error bars represent sem. red dots indicate results produced by the simulation using parameters obtained from fitting



application of the model to the canonical gal network in yeast
we tested the efficiency and predictive power of our model by applying it to the gal network of the yeast s. cerevisiae. the gal network is arguably the most suitable gene network to test our model due to the network’s well-characterized  nature in terms of its components and their interaction topology. choosing a canonical gene network allows one to study principles affecting gene network activity that are broadly applicable to eukaryotic cells.

the activity of the gal network is governed by a master transcription factor gal4p that binds to the network promoters to activate their transcription . previous work has shown that two additional regulatory proteins , as well as the galactokinase gal1p, play key roles in setting the activity of the gal network . gal80p is a repressor that binds to gal4p to repress it, gal3p is an inducer that binds to gal80p in the presence of galactose and relieves the repression, and gal1p  is also an inducer, although significantly weaker than gal3p.

the dual positive feedback loops formed by gal <dig> and gal <dig>  together with the inherent nonlinearities of the gal network, result in a bimodal expression profile  <cit> . the functional form that we used for the gal network  captures all of these interactions.

for the parameters governing the dynamics of the gal gene network activity, we fixed several of them in ranges described in published literature. these included the rates of rna synthesis and decay  <cit> , translation  <cit> , and protein degradation  <cit> , as well as basal transcription levels for the gal network promoters  <cit> . since inside our model a scaling parameter, subject to fitting, is applied to each protein, we do not expect inaccuracies in these values to have substantial effects on the predictive power of our model.

to simulate global transcriptional noise in cells, we applied a random perturbation to each rate parameter for each individual cell. inside each cell, the rate parameters for each process  are perturbed by the same fraction for all network components, to reflect that these perturbations are caused by global noise extrinsic to the particular gene.

the only free parameters that we used in our model were the ones governing the transitions of the network promoters between the off and on states, and the parameters setting the scale of action for network proteins, which were determined by sweeping over discrete values followed by fitting to experimental data. for this, the monte carlo simulation generated a distribution of reporter protein levels in the final population of cells and this was then fitted to experimental measurements obtained from a yeast strain carrying the pgal1-yfp reporter construct. the gal <dig> promoter is a faithful reporter of the network activity, as it is bound and activated by the gal <dig> proteins.

to experimentally obtain the pgal1-yfp expression distributions at the single-cell level, we induced the yeast cells for  <dig> and 22 h in media containing seven different galactose concentrations. using a flow cytometer, we then measured the yfp expression levels from ~ <dig>  cells and obtained the expression histograms depicted in fig.  <dig>  we then binned the expression levels to obtain  <dig> regions on each histogram, and fitted our model to these experimental results obtained at  <dig> and 22 h, producing the fit results depicted in fig.  <dig>  the parameter values obtained from the fitting procedure are shown in additional file 1: table s <dig>  as can be seen, the fit results are in good agreement with the experimentally obtained values.

to test the predictive power of our model, we performed additional experimental measurements in two more media conditions containing  <dig>  % and  <dig>  % galactose, for both experimental durations , and compared the experimental measurements with the predictions of the model without using any free parameters. we selected these concentrations because, as shown in fig. 4a and c, they are in the ‘linear’ range in which changes in inducer concentration causes significant changes in the fraction of on cells. as shown in fig.  <dig>  the predictions of our model for those concentrations are in good agreement with the experimental observations, both in terms of the fraction of on cells and in terms of the single-cell fluorescence distributions.fig.  <dig> the predictive power of the model. a, c, fraction of on cells as a function of galactose concentration for 5-h  and 22-h  experiments: experimental  vs. fitted  and predicted . error bars represent sem. b, d, single-cell fluorescence distributions of s. cerevisiae with a pgal1-yfp reporter are measured at two additional galactose concentrations  after 5 h  and 22 h  of induction and compared against predictions from the model fitted without these data. bars represent experimental measurements; error bars represent sem. the model predictions without any fitting are in red



tracking the lineage-specific changes in cell size and protein content in real time
our model also allows users to track lineages of individual cells and how their size and gene expression contents change as a function of time. in fig.  <dig>  we selected a representative cell from a simulation run at  <dig>  % galactose using the parameters obtained from the fitting procedure described above, and tracked the single-cell reporter content  and cell size  of all of its descendants born during the first 660 min of the simulation. our model also allows users to perform more detailed analyses such as comparing the gene expression and cell size characteristics of the descendants of different cells.fig.  <dig> demonstration of the model’s capability to track individual cells and lineages. traces of reporter protein concentration  and cell volume  in descendants of an individual cell  for the first 660 min of the simulation. protein concentrations are in arbitrary units. each horizontal line represents a cell. dotted gray lines indicate cell division. the scale bar in  is 50 fl. galactose  is introduced into the system at t = 0



a final demonstration for the predictive power of our model was made by experimentally measuring the phenotypic switching rates between the off and on states of the gal network, followed by predicting the rates by our model without using any additional fit parameters. using a detailed log produced by the simulation, each cell was classified as either on or off at each time point recorded based on the number of reporter proteins in the cell. then, the rates at which off cells switch to the on state and on cells switch to off state were calculated. as shown in fig.  <dig>  the results of our model are generally consistent with the estimated phenotypic switching rates extracted by applying a simple two-state model  to experimental data obtained from two different initial conditions  <cit>  . the experimental method we used to extract the switching rates is an alternative to the more direct but prohibitively time-taking method of microscopically tracking thousands of individual cells for multiple hours in the presence of cell-crowding and focusing issues. we expected that our experimental method would underestimate the switching rates and indeed the values we extracted from data were lower than the ones predicted by the simulation. this expectation was due to the fact that our method would not count the phenotypic switching events if, for example, a cell switched between the two phenotypic states for an even number of times.fig.  <dig> comparison between experimentally measured and model predicted phenotypic switching rates. experimentally measured  and model predicted  phenotypic switching rates, as a function of galactose concentration. circles indicate off-to-on switching rates; triangles indicate on-to-off switching rates



discussion
using computational analysis to guide experimental testing has significant advantages over the traditional purely experimental approach. by using the computational predictions as a guide, the researcher can avoid the inefficiencies associated with a purely experimental approach, while still producing results that can be actually tested and confirmed in a biological system.

the volume of a cell and the cell cycle stage it goes through can have significant impact on the activity of a gene network in that cell. doubling the volume effectively halves the gene network dosage, which can significantly change the network activity level for non-dosage-compensated networks  <cit> . similarly, it has been suggested that the cell cycle, and the transcription changes it causes, is a major contributor to gene expression noise observed in a population of cells  <cit> . to fully understand the complex interactions at play, one needs a model that accounts for both the cell volume and cell cycle, and the network itself.

here we present such a single-cell level stochastic model and demonstrate its predictive power by using the gal network in s. cerevisiae. we validated our model by comparing its predictions for single-cell gene expression distributions with experimental results obtained at different galactose induction levels that were not used to select model parameter values. our model is also able to generate detailed single-cell level lineage-specific time-course data for gene expression, cell volume, and cell division. using this data, we calculated the phenotypic switching rates for the cells in the simulation and saw that the results were in reasonably good agreement with the switching rate estimates obtained from additional experiments.

we note that our volume model results in a steadily increasing cell volume as the cells age. this is consistent with experimental observations  <cit>  on s. cerevisiae cells, whose volume indeed increase steadily until they reach a relatively constant maximal volume and enter senescence. our volume model does not attempt to capture senescence, for two reasons. first, the time scale of our simulations  is well below the average replicative lifespan for yeast cells , so that few cells would be expected to reach such a state. second, in an exponentially growing population of cells, the fraction of old cells is extremely small due to geometric distribution , and would not appreciably affect our results.

CONCLUSIONS
in this paper, we present a single-cell level stochastic model that accounts for the cell volume and the cell cycle in addition to the gene network it models, and demonstrate its predictive power by using the gal network in s. cerevisiae. our model can easily be adapted for other gene networks and other cell types, and can also be easily extended in other ways. for instance, researchers working with different cell types  need only create a volume model reflecting the size-control mechanism in those cells, without having to reinvent the gene network part of the model. as another example, by having the gene network part of the model affect the volume growth and cell division rates via a fitness function, one can easily modify the model to perform in silico evolution experiments to track and understand how gene networks evolve time dynamically.

