BACKGROUND
obtaining the sequence of numerous genomes and subsequent identification of the encoded proteome has created the need for large-scale systematic approaches to understand the functions of the tens of thousands of proteins at the cellular level  <cit> . high-throughput automated fluorescent microscope imaging technologies enable the experimental determination of a protein's sub-cellular localization and its dynamic trafficking within a range of cellular contexts. these approaches generate vast numbers of images including multiple fluorophores for cells under a variety of experimental conditions  <cit> . furthermore, cells may now be imaged in 3d, or indeed 4d with 3d stacks captured over time to observe protein trafficking in live cells  <cit> . the desire and the ability to carry out high-throughput screenings of protein localization and trafficking for applications such as drug discovery  <cit>  is leading to a rapid growth in cell images in need of analysis on a scale comparable to that of the genomic revolution. it has been estimated that to take a single image for each combination of protein, cell type and timescale would require of the order of  <dig> billion images  <cit> . currently, image databases such as the yeast gfp fusion localization database  <cit> , the locate mouse protein sub-cellular localization database  <cit>  and the lifedb database for the integration and dissemination of functional data  <cit>  offer the possibility to present, integrate and search the vast amounts of data being created by high throughput cell imaging. however, to a large degree the analysis and comparison of localizations are still performed by the slow, coarse-grained and possibly biased process of manual inspection. to deal with the scale of the data becoming available automated annotation, analysis, comparison, classification and storage of cellular images is essential.

image statistics have proven to be of great utility in the automated analysis of cellular images. haralick texture measures define a variety of statistics based on the spatial dependence of individual pixel intensities across an image  <cit> . zernike moments  <cit>  calculate the decomposition of an image onto an orthogonal set of polynomials in much the same way that fourier coefficients may be used to decompose a time series. these and other  <cit>  measures may be used to generate a vector of numbers for a given cell image, and have a wide range of applications. for a given set of images, a representative image may be chosen by selecting the image with vector closest to the mean vector of the entire image set  <cit> . images may be clustered  <cit>  or ranked by distance from a given image to find similar images  <cit> . and given two sets of sub-cellular localization images under differing experimental conditions, image statistics can be used to assess whether there is a statistically significant difference, even to the extent that visually indistinguishable images of distinct localizations may be differentiated  <cit> . one important application is in automated sub-cellular localization classification. here, a machine learning technique such as a neural network  <cit>  or support vector machine   <cit>  is trained on image vectors of known localization, and subsequently used to predict those of unknown localization. with accuracies of well over 90%  <cit>  such predictors have proved very successful, and have exceeded human classification accuracy  <cit> . once statistical techniques such as the above are fully integrated into cell image databases, a much greater degree of refinement, content searching, unbiased clustering and hypothesis testing will be enabled.

while image statistics have performed well in sub-cellular localization classification, they often suffer from high computational cost and require individual cells to be cropped from an image, hence limiting the extent to which they may be applied. here, we introduce threshold adjacency statistics , a simple and fast morphological measure for distinguishing sub-cellular localization.

RESULTS
algorithm
threshold adjacency statistics are generated by first applying a threshold to the image to create a binary image , with a threshold chosen as follows. the average intensity, μ, of those pixels with intensity at least  <dig> is calculated for the image, the cut off  <dig> chosen as intensities below this value are in general background, and is considered in more detail below in the testing subsection . the experimental image is then binary thresholded to the range μ- <dig> to μ+ <dig> . the range was selected to maximise the visual difference of threshold images for which the localisation images had distinct localisations but were visually similar, as in figure  <dig>  the following nine statistics were designed to exploit the dissimilarity seen in the threshold images. for each white pixel, the number of adjacent white pixels is counted -). the first threshold statistic is then the number of white pixels with no white neighbours; the second is the number with one white neighbour, and so forth up to the maximum of eight. the nine statistics are normalised by dividing each by the total number of white pixels in the threshold image. two other sets of threshold adjacency statistics are also calculated as above, but for binary threshold images with pixels in the ranges μ- <dig> to  <dig> and μ to  <dig>  giving in total  <dig> statistics. a variety of other thresholds ranges were tested but found to give lower performance in later classification tests .

testing
to test the utility of threshold adjacency statistics, we created two epi-fluorescent image collections, each with approximately  <dig> images per sub-cellular location. one for which an endogenous protein or feature of the specific organelle was detected with a fluorescent antibody or other probe . the second a set for which an epitope- or gfp-tagged protein was transiently expressed in the specific organelle and subsequently detected . each image contained between  <dig> and  <dig> cells. details of markers used are given in table  <dig>  and  sample images are shown in figures  <dig> and  <dig>  the efficacy of threshold adjacency statistics in predicting sub-cellular localization was then tested by generating statistics for the endogenous and transfected images, and creating a svm for each. for the endogenous set, a 5-fold cross validation classification accuracy  of  <dig> % was obtained, while the cross validation accuracy on the transfected set was  <dig> %. to ensure against potential data bias in cross validation, each data set was randomly split  into 4/5ths for training and 1/5th for testing. a svm was then trained on the training set and the overall and by localization class classification accuracies on the test set were recorded. random data splitting, training and testing was then repeated  <dig> times. the overall average classification accuracy on the  <dig> endogenous test sets was then  <dig> %, and  <dig> % for the transfected test sets. the classification accuracies for each class of localization for the endogenous set were all high being in the range  <dig> % to  <dig> %, while the transfected set accuracies showed a wider variation ranging from  <dig> % to  <dig> % . the classes with lower classification accuracy such as mitochondria, er and plasma membrane appear to be those that exhibit higher visual similarity to each other than to other classes.

the accuracies  are averaged over  <dig> random division of each data set into 4/5ths for training and 1/5th for testing. the overall average classification accuracies on the test sets were  <dig> % and  <dig> % on the endogenous and transfected sets, respectively.

both the haralick texture measures and the magnitudes of the zernike moments have previously been shown to be useful in distinguishing sub-cellular localization  <cit> . to compare performance with that of threshold adjacency statistics, a set of  <dig> haralick measures and  <dig> zernike measures were selected. the haralick measures were chosen from a list of those shown to be good for distinguishing sub-cellular localization in conrad et al.  <cit> , and have previously been described and tested in the automated sub-cellular phenotype classification  system  <cit> . the zernike measures chosen were the magnitudes associated with the first  <dig> zernike polynomials, and have also previously been applied to sub-cellular localization  <cit> .

zernike measures require single cell images, and hence the aspic automated cropping system was used to select cells from the image. this gave  <dig> cell images from the endogenous image set, and  <dig> from the transfected set. haralick, zernike and threshold adjacency statistics were then generated for each cropped image, and each class of statistics tested using a svm and 5-fold cross validation. on the cropped endogenous image set, threshold adjacency statistics had a predictive accuracy of  <dig> %, the haralick statistics gave  <dig> %, and the zernike moments gave  <dig> % . for the cropped transfected image set, threshold adjacency statistics gave an accuracy of  <dig> %, haralick statistics  <dig> %, while zernike moments gave  <dig> %. hence threshold adjacency statistics had comparable or better results in all cases, with the zernike moments having significantly lower accuracy than the other two types of image measure. there is a clear trend for the three types of statistics tested to give lower predictive accuracy on the transfected data set.

the 5-fold classification accuracies  are shown for each of type of statistic tested. the first tas column shows accuracies obtained on un-cropped the endogenous  and transfected  data sets. the remaining columns refer to when individual cells were been selected from the endogenous and transfected data sets, giving  <dig> and  <dig> cell images, respectively. the 5-fold classification accuracies obtained on the cell selected images using each of tas, haralick, zernike or tas combined with haralick are then shown.

to test if the information contained within the threshold adjacency statistics and the haralick texture measures was complementary, svms were trained that combined both types of statistics for each cropped image. in this case, 5-fold cross validated accuracies of  <dig> % and  <dig> % were obtained on the endogenous and transfected sets, respectively, showing a significant improvement over either individual class of statistic.

the high predictive accuracy when applying haralick and zernike statistics comes with the expense of relatively high computational complexity. to compare the computational cost of haralick, zernike and threshold adjacency statistics the time taken to calculate each was recorded for the endogenous data set of  <dig> images. since the haralick measures are usually applied to single cell images and zernike measures require them, the time to crop the  <dig> images to create  <dig> single cell images was first benchmarked and found to be  <dig> minutes  <dig> seconds. generation of  <dig> haralick measures then took  <dig> minutes  <dig> seconds, and  <dig> zernike moments took  <dig> minutes  <dig> seconds. this compares to  <dig> seconds to generate threshold adjacency statistics directly with no cropping for the  <dig> images. more detailed timing of just the function call to calculate the  <dig> threshold statistics once the image was loaded into memory, showed an average time to calculate the  <dig> statistics of  <dig> ms per image. threshold adjacency statistics are hence an order of magnitude faster to calculate than either the haralick or zernike measures.

in general, segmentation of cell images into cellular and non-cellular regions is a difficult problem. when calculating the average intensity μ of pixels whose intensity is at least  <dig>  the lower bound  <dig> was chosen as intensities below this value are in general background for the endogenous and transfected image sets. the sensitivity of the predictive accuracy using tas for different choices of lower bound was tested as follows. as described above, a lower bound of  <dig> gave a 5-fold cross validation accuracy of  <dig> % on the endogenous set. further tests with a lower bound of  <dig> gave an accuracy of  <dig> %, and a lower bound of  <dig> gave an accuracy of  <dig> %. tests with the transfected image set yielded similarly small variation . hence, while there is some variation in accuracy, threshold adjacency statistics appear relatively insensitive to the choice of threshold.

a commonly used auto-thresholding scheme is to find a threshold intensity t, such that t is  the average of the average intensity of those pixels with intensity less than or equal to t, and the average intensity of those pixels with intensity greater than t . using such a scheme on the endogenous image set with threshold adjacency statistics gave a 5-fold classification accuracy of  <dig> %. visually examining the selections showed auto-thresholding had had variable success in highlighting the cellular regions of the images. one particular problem was that there was a general trend to under-select cells, that is to miss regions. to compensate for this a lower bound of the auto threshold value minus  <dig> was tested and gave an accuracy of  <dig> %. hence auto-thresholding, while performing reasonably well, is computationally more expensive and is not as effective as choosing a fixed threshold when applying threshold adjacency statistics. it is possible that another variable thresholding scheme or segmentation algorithm might give better cell region selection results and hence better predictive accuracy with threshold adjacency statistics, but the computational complexity of such a scheme is likely to be high.

another point to consider is that cell populations may not be heterogeneous due to variations in cell cycle. in preparing the image sets, dapi images were examined to exclude those cells that were not in interphase. for non-heterogeneous populations an interesting and useful addition could be to apply an automated cell phase predictor such as is described in by pham et al. in  <cit>  prior to classification. cells that are not in interphase could then either be excluded or treated separately.

CONCLUSIONS
threshold adjacency statistics have been shown to be well suited to sub-cellular localization classification, and offer a number of advantages over other image statistics. with a classification accuracy of up to 95% they offer comparable or better accuracy than the haralick texture measures, while being an order of magnitude faster to calculate. while comparison with previous literature is problematic in that each group has distinct image sets with different sub-cellular classes and varying degrees of automation, threshold adjacency statistics appear at least on par with a reported 92% accuracy previously obtained  <cit> . automated region selection and cropping of cells for classification can be exceptionally difficult and computationally expensive, especially when cells are highly confluent. threshold adjacency statistics require no cropping and are additive, hence giving better statistics the more cells there are in an image. another advantage is that every image presented is classified. with automated cropping/selection systems a wide range of images are dealt with, and so it is not uncommon to fail to locate a cell within an image because it is relatively faint, or some other criteria. further, for applications in which speed of calculation is not critical, the use of threshold adjacency statistics in combination with haralick texture measures give an accuracy of up to 98%. finally, with 3d and 4d cell imaging become more widespread, new methods are required to distinguish and classify protein localization. while automated classification of 3d sub-cellular localization using image statistics has proved very successful  <cit> , the addition of an extra dimension greatly increases the computational expense, and hence application of threshold adjacency statistics to 3d has the potential to significantly increase classification throughput.

