BACKGROUND
research in the field of drug discovery is increasingly driven by the data mining of large-scale pharmacological, screening, patent, literature and other bioactivity data. such approaches have led to interesting concepts that challenge historical dogma - for example the view that many small molecules and indeed drugs exert their effect through interactions with multiple rather than a single target  <cit> . new targets have been predicted for fda approved drugs through analysis of large-scale bioactivity databases  <cit>  and side-effect data mined from package inserts  <cit> .

the discipline of combining small molecule bioactivity, the 'ligand space', with bioinformatics analyses of the 'target space' is also known under the name chemogenomics  <cit> . chemogenomic approaches can be used to systematically examine and explore the binding of small molecules to large target families such as kinases  <cit>  or g-protein coupled receptors   <cit>  or for the design of compounds targeting multiple proteins  <cit> . one of the current limitations of these approaches is the biased distribution of data that is available for individual targets. while there are a few prominent target classes such as certain gpcr families, protein kinases and various protease families, for which the bioactivity of many thousands of ligands has been measured, most targets have measured bioactivities for only a few compounds or no annotation at all  <cit> . to partially address this limitation, we propose an indexing of target space at a structural domain level, allowing aggregating ligands known to bind targets containing a given structural domain into a larger bioactivity class. the practical implication for the analysis of large-scale bioactivity data is a necessity to automatically and reliably annotate large numbers of protein targets with a domain containing the site of small molecule binding. we therefore propose to map small molecule binding to structural domains and present an initial implementation for targets in the chembl database  <cit>  . previous studies have statistically associated small molecule binding to protein domains  <cit>  and direct mapping has been applied to ligands in crystallographic structures  <cit> . here we extrapolate these mappings to pharmacologically relevant interactions described in the chembl database.

structural domains are independent folding units that form the basic evolutionary and architectural 'building blocks' of proteins  <cit> . while there can be large sequence differences between members of a domain family, the fold of the peptide backbone is generally conserved  <cit> , even though  cases of homologous proteins with differing folds have been identified and discussed  <cit> . a small protein would typically consist of one domain, while longer proteins are often an assembly of more than one domain  <cit> . in some eukaryotic proteins, the underlying intron-exon structure of the gene reflects this structural domain segmentation  <cit> . for the mapping of small molecule binding, targets consisting of combinations of domains impose a challenge because the binding site for the ligand might lie in either domain and in addition more than one domain in a protein might interact with the same or different ligands. domain assignment information is available from a number of publicly available resources. scop  <cit>  and cath  <cit>  are databases that define protein architecture based on hierarchical definitions of 3d structural domains. pfam-a  <cit>  is a database of hidden markov chain models of non-overlapping full domain sequence alignments. pfam-a domain definitions are also manually annotated and curated. interpro  <cit>  is a database that integrates different domain models into a comprehensive set of protein domains. for our purposes, the pfam-a database with its non-overlapping, non-hierarchical architecture and extensive coverage of protein families, is ideal to map ligand binding to a given protein domain. in this study, we propose a simple heuristic to map the site of small molecule binding to pfam-a domains and compare our results with binding site information from the protein sequence database uniprot  <cit>  and pdbe  <cit> , a repository of crystallographic protein structures.

RESULTS
domain content of the human proteome and chembl targets
the domain content of a human protein-protein interaction dataset has been described in a study by patil et al.  <cit> . according to this work,  <dig> percent of all proteins from the interaction data set were found to contain more than one pfam domain. we analyzed the pfam domain content of the chembl target dictionary and as a subset all human proteins within the chembl target dictionary. we also queried the ensembl database  <cit>   for all protein coding genes in the human genome and analyzed the pfam domain content for this set. the queries used to obtain this data are described in the methods section code and queries. the results of this analysis are summarized in figure  <dig>  additional file  <dig> provides a table with domain annotations for all targets in the analysis. similar to patil's interaction data set,  <dig>  percent of the human targets in the chembl target dictionary have more than one pfam domain. in contrast, only  <dig>  percent in the set of protein coding sequences from the human genome have more than one domain and  <dig>  percent have no pfam domain assigned. it appears therefore that while patil's interaction set and the chembl target dictionary are well covered by pfam domain models, coverage of the entire set of human proteins is not complete.

in order to assess the impact of incomplete annotation for our set of chembl targets, we determined for each target the number of residues belonging to a pfam domain as a fraction of the number of residues in the overall protein sequence. we found that for the entire set of human proteins, the median of this fraction is  <dig>  and about a quarter of all proteins have less than  <dig> percent of all residues assigned to a pfam domain. the low ratio of residues within pfam domains is likely due to incomplete coverage of pfam-a models for the human proteome. for human protein targets in the chembl database, the ratio of residues within pfam domains is significantly higher : the median proportion of pfam residues relative to sequence length is  <dig> . in comparison, this ratio is  <dig>  for all protein targets in the chembl database, including non-human protein targets. previous works suggests that proteins consist mainly of highly structured regions  <cit> . therefore, we propose that coverage of pfam-a domain annotation is almost complete for most chembl targets but not for the entire set of human proteins. this is most likely due to the preference of drug discovery programs for well-characterized targets and the priority of disease-related proteins in functional and structural studies.

binding of small molecules within domain boundaries
our attempt at mapping of ligand binding to discrete pfam domains is based on the assumption that small molecule binding takes place within the structurally conserved region of a protein domain rather than in the surrounding non-pfam domain regions. following this premise, and assuming that the annotation with pfam domains for our set of chembl targets is complete, the mapping of small molecule binding is immediately achieved for proteins with a single domain. thus, with our initial assumption, the heuristic covers 50% of all protein targets in the chembl target dictionary. to estimate the accuracy of the outlined assumptions, we carried out systematic queries against uniprotkb/swiss-prot and pdbe and systematically evaluated the overlap of binding sites annotations and pfam domain predictions. the methods section code and queries describes the queries in detail.

uniprotkb/swiss-prot is a resource providing protein sequence and reviewed, manual annotation data. binding site information is provided in the form of residue positions, in many cases focusing only on the most important residue. we queried uniprot to retrieve all binding site information available for human protein targets in the chembl database. the query was limited to human proteins to avoid a bias for targets with orthologs in the chembl target dictionary, yielding binding site information for  <dig>  targets. a comparison of binding site residue positions and pfam domain boundaries revealed that  <dig>   of annotated binding sites from uniprotkb/swiss-prot lie completely within a pfam domain and only  <dig>  entirely outside. binding sites defined by a set of residues of which some are within and others outside of a pfam domain are likely associated with the pfam domain and therefore support our proposal that small molecule binding is associated to conserved sequence defined domains. the empirical cumulative distribution function  shown in figure 2a describes the results of our query in greater detail. in analogy to the above, we queried the crystallographic structure data repository pdbe for binding site information and evaluated the overlap with pfam domain predictions. unlike in the manually annotated uniprotkb/swiss-prot, binding site information in pdbe is derived from molecular coordinates and encompasses all residues involved in a small molecule binding interaction. we retrieved binding site information for  <dig> human chembl targets. of all targets evaluated,  <dig>  have all their binding site residues within a pfam domain, and only  <dig>  have all binding site residues outside any pfam domain. the corresponding cdf is shown in figure 2b. compared to the cdf that represents the uniprot query, there is a higher fraction of proteins having binding site residues both within and outside of pfam domain boundaries. we attribute this to the greater detail of binding site annotation in pdbe, which encompasses all, rather than only one or few of the residues involved in ligand binding. nevertheless, the majority of binding sites described in this analysis have a substantial number of residues within a pfam domain, supporting our assumption that small molecule binding is associated to the defined and annotated regions in a protein that are detectable using pfam domain models.

predicting binding sites for multi-domain proteins
given that about half of all proteins in the chembl target dictionary have more than one domain, we investigated ways to expand our mapping of small molecule binding from targets with only a single domain to targets with multiple domains. we had observed with high probability that small molecule binding in single domain protein takes place between the boundaries of a domain. we prepared a set of single domain protein targets from the chembl data base by selecting each protein that had at least one ligand tested against it in a binding assay with a reported activity value less or equal  <dig> μm . the occurrence of a domain in this set is thus a validation of a domain's potential to mediate a small molecule binding interaction. in the following, we consider all domains from this set as 'seed' domains with the potential to mediate small molecule binding. if such a 'seed' domain co-occurs with one or more 'non-seed' domains, our mapping defaults to this previously established seed domain. hence, the mapping follows a heuristic based on the assumption that domains with known ligands take precedence over domains that do not occur in single domain proteins with known ligands. for example, in protein kinase akt- <dig> , which also contains a pkinase_c and ph domain, the target of small molecule binding is the pkinase domain. in total, our mapping covers  <dig>  activities. a table with all mappings is provided in additional file  <dig> 

we benchmarked our mapping against manually curated binding site annotations from uniprot and also against annotation extracted from crystallographic structures in pdbe. we queried the pdbe for protein structures with ligands matching our predictions and identified  <dig> entries that could be used to evaluate our mapping for multi-domain proteins. the comparison with binding site annotation retrieved from uniprot was carried out in the same fashion and we identified  <dig> entries that could be used to evaluate the mapping. we considered predictions correct if at least half of all binding residues are located within the predicted domain. details of the benchmarking are discussed in the methods section validation. unsurprisingly, the accuracy of predictions made for single domain targets is high . for multi-domain proteins, the accuracy is at around  <dig> percent for both benchmarks. benchmarking results of this validation are summarized in table  <dig> 

benchmarking results against binding site information from uniprot and pdbemotif are summarized in the first and second row respectively.  specified in parentheses indicates how many targets were assessed in each benchmark. the total number of predictions made for single- and multi-domain targets is provided in the bottom row # total predictions.

one limitation to our approach is its blindness towards ligand-binding pfam domains that always occur in combination with at least one other pfam domain. to account for the most important cases, we identified all pfam domains that occur only in combination with other domains and occur one hundred or more times in the chembl target dictionary. based on a pdbe database survey of those domains , we selected the pkinase_tyr domain to be included in the list of seed domains. another blind spot of this heuristic are ligand interactions that take place at the interface of two or more domains and thus are mediated by a combination of pfam domains. in order to obtain an estimate of the importance of this type of interaction, we carried out a systematic query against pdbe to identify interactions that are reported in chembl and fall into this category. we identified  <dig> targets , all of which are enzymes. figure  <dig> shows four examples of small molecule binding at the interface of two domains. additional files  <dig> and  <dig> contain graphics and session files for all  <dig> examples.

listed are all domains that occur in multi-domain targets of the chembl target dictionary at least one hundred times but never in a single domain target. the occurrence of each domain in the target dictionary is specified in the column # chembl targets. the number of pdbe entries  that describe small molecule interactions with any listed domain is indicated in the column # pdbe accessions.

summary of small molecule binding mediated through more than one domain. combinations of pfam-a domains are specified in the left-most column. the column pdbe provides one exemplary structure accession  and 'ratios' specifies the ratio of binding site residues within the corresponding domain over all binding site residues. # chembl targets indicates the number of targets in chembl containing a given domain combination.

small molecule binding to pfam domains from a chemogenomic perspective
we used the mapping described in the previous sections to analyze the numbers of ligands tested for individual pfam families and set these in a relationship with the genomic frequencies of pfam domains. table  <dig> lists the numbers of ligands tested in binding assays against the top  <dig> pfam domains. these  <dig> domains cover almost three quarters of all reported binding events . this highly skewed distribution is reminiscent of the genomic frequency distributions of pfam domains. the frequency of protein domains in bacterial and eukaryotic genomes follows a power-law distribution  <cit>  with a small number of very frequent domains while the vast majority of domains has only few occurrences. in this study, we examined the distribution of occurrences of pfam domains in human protein coding genes as well as the distribution of known ligands per pfam domain following a state-of-the-art protocol  <cit> . according to this protocol, we calculated the scale-parameter alpha and the smallest number of occurrence  to which the power-law still applies. we then used kolmogorov-smirnov testing  to estimate the goodness-of-fit. the resulting p-value is a measure for the plausibility of a power-law hypothesis. in a final step, we used a maximum likelihood ratio test to compare the power-law with alternative hypotheses. figure  <dig> and table  <dig> summarize the results of our analysis, which is described in the methods section statistical analysis of power-law distributions. the results of our analysis confirm that the distribution of pfam domains in the set of protein coding genes follows a power-law. a power-law equally applies to large parts of the distribution of known ligands per pfam domain, covering a range of observed instances  that is shifted up one order of magnitude compared to pfam domain frequencies. in contrast to the distribution of pfam domains and known ligands per pfam domain, the highest numbers of ligands for individual proteins appear to be limited and the number of targets with very few ligands is smaller than would be expected by a power-law. the frequency of pfam domains in the human genome is dictated by gene duplication under selective pressure and models describing this process have been presented previously  <cit> . in analogy, the distribution of known small molecule ligands for pfam domains is shaped by the slow and incremental exploration of target classes in drug discovery. target families with known ligands are more likely to gain new ligands, for example through lead-optimization studies and selectivity screens. once a target is economically exploited, lead-optimization projects are halted  or directed towards other targets within the same family. target families without known ligands on the other hand only become subject to investigation if extensive scientific evidence suggest favorable future outcomes.

shown are the  <dig> pfam-a domains with most associated ligands. pfam-a specifies the domain name, #cmpds the number of ligands tested in binding assays with potency no weaker than  <dig> μm.

parameters of the power-law functions fitted to the observed distributions of pfam-a domain frequencies , number of ligands associated with each pfam-a domain  and number of ligands associated with individual targets  are shown in columns 'xmin' and 'alpha'. 'goodness of fit' indicates the p-value calculated from a ks goodness of fit test. the rows vs_lognormal, vs_exponential, vs_weibull indicate outcomes of maximum-likelihood tests against alternative distributions. 'yes' indicates significant support for a power-law distribution, 'no' indicates support for the alternative over a power-law. 'magnitude' specifies the orders of magnitude in the distribution spanned by a power-law and 'support for power-law' is the summary outcome for each distribution.

ligand sets
we conducted a survey of the chemical space occupied by ligands of given pfam domains. here, we focus on  <dig> pfam domains of high relevance for drug discovery, protein kinase , tyrosine kinase , cytochrome p <dig> , retroviral aspartyl protease , sodium neurotransmitter symporter  and the serine protease trypsin . for each of these, figure 5a depicts the chemical space of known ligands in terms of two simple descriptors, molecular weight and the calculated partitioning coefficient logp. specifically, these plots show the relative density of ligands at a given point in projected chemical space. it is obvious from the overlap on these plots that true separation of ligands cannot be achieved based solely on these two descriptors. however, judging from the distinct distribution peaks for ligands of each domain it is conceivable that probability density functions for combinations of simple descriptors could enable target class prediction based on chemical structure. to explore this further, we used six basic molecular descriptors of all ligands associated with either of the chosen domains as input for a principal component analysis . those six descriptors are molecular weight, the oil/water partition coefficient , polar surface area , the number of rotable bonds, the number of hydrogen bond donors and the number of hydrogen bond acceptors. in preparation for the pca we removed from each set of descriptor values the distribution outliers and subsequently scaled all values to unit variance. the loadings of components obtained after pca are summarized in table  <dig>  we used the first principal component to project the molecular variability of ligand sets onto one-dimensional distributions of component values for each domain family . we observed that the obtained distributions reflect the relationships between different domain families. for example, there is a relatively large overlap between ligand sets of the related pkinase and pkinase_tyr domains, which are both dominated by analogues of the kinase substrate adenosine triphosphate. pair-wise student t-tests confirmed that the descriptor spaces of ligands for each domain class are distinct . hence, the distributions obtained here can be exploited to assess the binding potential of a given small molecule to a pfam domain family, based on a combination of simple descriptors. to retain predictive power, this approach requires that the scope of the search is limited to a selection of domains. prior knowledge about a given small molecule can instruct the selection of domains, for example if information about co-localization with protein complexes is available.

shown are the factor correlation coefficients for individual components.

CONCLUSIONS
in this study, we show that small molecule binding sites are associated with the regions in a protein that map to a pfam domain, and hence typically have a discrete structure defined by a conserved sequence profile. we exploit this knowledge to map small molecule binding to pfam domains in single- and multi-domain proteins. the integration of small molecule bioactivity data from the chembl database and  structural data from pfam will drive cross-linking across databases and deeper semantic annotation for chemical biology. in addition, our mapping allowed for an analysis of the distribution of known small molecule ligands per pfam domain. the power-law behavior of this distribution mirrors the genomic distribution of protein folds and the incremental progression of drug discovery.

the heuristic presented here is simple and efficient. however, the mapping does not address two naturally occurring edge cases. firstly, a number of pfam domains occur only in combination with other domains and hence are not picked up in the initial seeding step. we address this partially by manually including such domains if they occur in more than one hundred chembl targets. the second case is the relatively rare occurrence of ligand binding at the interface of domains, as discussed in the section on mapping small molecule binding to multidomain proteins.

one incentive to annotate recorded activities of small molecules against multi-domain proteins is a phenomenon we term 'domain poisoning' - where the presence of a common 'spectator domain' links together targets on the basis of sequence searches, but the ligand-binding domain is absent from the identified homologue. to avoid false positives, we were previously forced to use very conservative cut-offs for sequence similarity  because we found that without this safeguard, known drug targets were associated with a query protein through high conservation in regions that are not involved in small molecule binding and thus 'poisoned' our query results with irrelevant compounds. for example, when querying the chembl target dictionary for targets similar to tyrosine-protein phosphatase syp , the presence of sh <dig> domains would result in relatively strong association with tyrosine kinases such as tyrosine-protein kinase syk  and poison the query with kinase inhibitors . in such a case, a query using only the domain relevant to small molecule binding would automatically filter out targets that are associated through domains not relevant to ligand binding.

the mapping described in this study further provides ligand sets for the development of methods to predict bioactivity for new compounds and gives an estimate of the chemical space of ligands associated with each domain. we also used these sets as a starting point to explore the selectivity of small molecules within and across protein families following the pfam domain definitions. mappings and ligand sets resulting from this study will be kept up-to-date with new chembl releases and are available at http://www.ebi.ac.uk/~fkrueger/mapchemblpfam, along with documentation.

