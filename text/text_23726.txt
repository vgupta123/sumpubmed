BACKGROUND
sources of noise in microarray experiments may be numerous  <cit> , thus most researchers try to minimize its influence or estimate it through various quality control, normalization and outlier filtering procedures  <cit> . one source of variation is cross-hybridization , which occurs when unintended sequences hybridize to a probe alongside the intended target. in the case of affymetrix arrays, which use a set of short  oligonucleotide probes to target a transcript, hybridization conditions are carefully controlled with the aim of minimizing the effect of ch due to non-specific binding  <cit> . in addition, each perfect match  probe is accompanied by a mismatch probe , in which the middle residue has been changed. the intention is that this can be used to provide a measure of the level of ch associated with each pm probe. a more detailed discussion of ch in short oligo arrays may be found in  <cit> . from october  <dig>  affymetrix also started to display brief summaries of cross-hybridization within their own netaffx service  <cit> .

in some circumstances, probes may match exactly to more than one transcript. this is important because these probes can no longer be identified with a unique transcript, but are instead dependent on more than one gene product. the situation is rendered somewhat more complex by the fact that affymetrix arrays use more than one probe  to target each transcript. recently, several databases have been built to provide a mapping of affymetrix probesets to known transcripts  <cit> , to sequences from cdna microarrays  <cit> , or for applying algorithmic approaches to cross-platform or cross-species comparisons  <cit> . a recent paper  <cit>  presents a global overview of the interpretation of genechip arrays, and the need to update annotation to match the continued evolution of genomic databases. the solution includes the redefinition of cdf files, similar to what was proposed initially in  <cit> , which may be sufficient in many cases.

the issue of 'multiply targeted' probes is important because they have the potential to result in cross-talk between the probesets they are part of. if their effects are significant, and expression summarizing algorithms are unable to control for them, then one outcome of this will be that otherwise unrelated probesets will appear correlated, since they are being driven by a shared signal.

the adapt database  <cit>  was used to investigate the extent and significance of multiply-targeted probesets in affymetrix expression data . use is made of the fact that the platform's combination of short oligos and strict hybridization conditions, which are designed to maximize binding to the pm probes whilst minimizing binding to the mm ones. this makes it viable to use in silico methods to identify which probes are likely to bind with 100% identity to which transcripts. we refer to cases of exact matches between probe and transcript as multiple targeting , to distinguish from the more general case of cross-hybridization, in which matches with less than 100% identity may occur.

particular attention is directed at the influence mt can have on the apparent correlation between probesets' expression measurements. since pearson correlation is scale independent, it is not influenced by the overall magnitude of either signal being compared, but rather on the similarity in their shapes. although it may seem counter-intuitive, when two signals are superimposed, the amount of correlation found between each of the original signals and the combined one is driven by the relative variance of those two signals, not by their mean intensity . many microarray data analysis techniques rely on correlation analysis, with the majority of methodologies aiming to draw a distinction between genes that are, in some way, co-occurring, co-expressed or correlated and those that do not follow a significant common pattern. methodologies such as hierarchical clustering  <cit>  and relevance networks  <cit>  make direct use of the pearson correlation coefficient of expression values between probesets, whilst others , are ultimately based on correlation-like principles.

RESULTS
affymetrix arrays use a series of probes to target a transcript. these probes are grouped together to form a probeset; expression processing algorithms such as mas <dig>  <cit> , rma  <cit>  and gcrma  <cit>  combine the signals from each probe in a probeset to provide a single summary value representing an estimate of the concentration of that transcript in solution. the issue of mt arises because certain probes are capable of hybridizing to more than one transcript, leading to non-independence, while in other situations probes from more than one probeset are capable of hybridizing to a single transcript . in general, these interactions combine to form a complex lattice .

in this paper, we consider the extent and structure of these relationships, followed by an investigation of how much effect they have both on signal strength and on the correlation between probesets.

the prevalence of multiple targeting in oligo arrays
an analysis of the hg_u133a array reveals that many transcripts  are matched with multiple probesets  while almost half  of the total  <dig>  probesets  show exact matches  to more than one ensembl  or refseq  transcript . for comparison,  <dig>  probesets were found to match to at least one well-known transcript.

the effect of mm probes is minimal: the number of mm probes that can hybridize exactly to known transcripts is about  <dig>  times smaller  – most of them singleton matches to unrelated sequences. thus we exclude mm probes from subsequent analyses. since mm probes were not considered, and rma makes no use of these probes in its computations, rma processed data is used for all calculations presented here, although similar effects were also observed with mas <dig> processing.

affymetrix probeset names are supposed to identify probesets that are associated with multiple targeting. in particular, those marked "_x_at" are identified as being non-specific. similarly, "_s_at" probesets are identified as potentially targeting different gene family members or splice variants. the analysis shows that many of the probesets associated with mt are not identified in this way and are simply annotated " _at" . these numbers are likely to be underestimates because adapt was built using only well characterized sequences. thus, a significant number of the standard "_at" probesets are involved in mt.

structures of multiple targeting in oligo arrays
basic motifs
the two basic building blocks of mt interaction networks are probeset-transcript-probeset  motifs , and transcript-probeset-transcript  motifs . depending on the robustness of the analysis algorithms used to process array data, the presence of either motif can be expected to lead to non-independence between the expression profiles of the participating probesets.

a search for both types of motifs confirms the prevalence of mt in oligo arrays. table  <dig> summarizes the rates of occurrence of both motifs for a variety of affymetrix arrays. the ptp motif is especially common – it involves almost half the probesets on the hg_u133a array and over a third of those on the hg_u133plus <dig>  generally, the more recent arrays have a larger proportion of probesets involved in mt.

families of related probesets
probesets may be involved in multiple ptp and tpt motifs, resulting in an mt-network. this can be expressed as a graph in which nodes represent transcripts and probesets, while edges represent matches between transcripts and probesets, labelled with the number of matching probes involved in the interaction. such graphs are informative because so many probesets have the potential to be involved in mt . since affymetrix arrays measure the binding of crna sequences to sequence-specific probes, the searches used to define mt help catalogue which binding events are possible. knowledge of mt interactions is important because it begins to describe what is actually being measured in a microarray experiment.

to build families, the database was queried to identify all ptp motifs. then, a simple search algorithm used to identify the maximal graph that can be reached from a starting probeset using the identified motifs. probesets that are not involved in any ptp motifs result in trivial families that consist of just a single probeset. an additional step is used to eliminate "hub probesets", as described below.

for hg_u133a arrays, this process results in the identification of  <dig>  families containing at least  <dig> probesets . the mean number of probesets in the family is not high -about  <dig> . interestingly,  <dig> families , were found in which family members were annotated to different genes. importantly, these families were not simply comprised of "_x_at" probesets:  <dig> were annotated "_at" and  <dig> – "_s_at".

a full list of mt families is included in the supplementary data , along with an applet that allows the exploration of these families, attached to exemplary expression data .

hub probesets
there is a group of probesets  that match a large number of transcripts, usually with a small number of probes. they may be called "hub" probesets, because their expression combines signals from many available transcripts. in the network of probeset-transcript relationships, hub probesets often join together smaller families of probesets, often many at a time. a typical example of a hub probeset is "221992_at" which matches to  <dig> refseq or ensembl transcripts, with an average  <dig>  probes per match, or "210524_x_at" .

hubs were selected for the family search algorithm described above if the average number of matching probes was less than  <dig> and the total number of transcripts greater than  <dig>  or if the total number of transcript matches was greater than  <dig>  this resulted in  <dig> hub probesets being selected, allowing the granularity of families to be kept to a reasonable level .

quantitation of the effect of multiple targeting
probes found by the database searches to target multiple transcripts, generally have a higher measured signal than those that target unique transcripts. for example, the average measured expression level in the gene atlas data is 16% higher for multiply targeted pm probes and over 80% higher when the pm – mm difference for individual pm:mm probe pairs is considered.

these numbers refer to differences in the raw probe intensities, which are subsequently grouped into probesets and processed by an expression summary tool such as mas <dig> or rma. the following sections investigate whether these changes at the probe level are carried through to the mas <dig> or rma processed expression summaries, and the influence they have on pearson correlation.

real data, same transcript
simulation data
intensity
correlation
in a second simulation experiment, spiking was achieved by adding the signals from a second set of probes to the first set. in this way, the case shown in figure 1b was simulated – i.e., a probeset hybridizing to two different transcripts . the second group of probesets was produced by randomly selecting up to  <dig> probesets. variance filtering was performed to ensure that at least one of the transcripts had an expression profile that varied. since pearson correlation is not dependent on the mean intensity of the signals, but rather the similarity of their shapes, filtering was performed on variance, not intensity. pearson correlation, r was calculated between each member of the first list and its corresponding partner in the second. before spiking, the two sets should be uncorrelated; spiking is expected to increase correlation. as in the real data, the signal from the spiked probes contributes significantly to the correlation, even when only a small number of probes are involved. it can be seen from figure  <dig> that even when high variance probesets are the recipients of additional spiked signals changes in r are possible. thus, the effects are not restricted to probesets with low signal .

intensity vs. correlation
both real and artificial datasets demonstrate that mt can have a significant effect on correlation, even when only a small proportion of probesets are involved in the interaction. algorithms such as rma and mas <dig> successfully employ robust averaging techniques  to reduce the effect of outliers. thus, when only a small number of probes in a probeset are involved in mt, changes in measured expression level are expected to be generally small. this is confirmed in both the real and simulation datasets.

however, even when overall changes in intensity are minimal, increase in pearson correlation can still be high. this is because pearson correlation is driven by similarity in profile shape, not intensity; small amounts of stray signal can lead to large increases in r, even if the overall mean between probesets are very different. since pearson correlation centers each variable about its mean, and scales it by its standard deviation, correlation is entirely dependent on the relative shape and variance of the two signals, not their overall intensity. when two signals, a and b are compared to their sum, s, the signal that is most correlated with s depends not on their relative sizes, but on their relative variance. this is counter-intuitive but important to recognize when considering the effects of interacting signals on correlation .

this effect can be demonstrated by varying the amount of contribution made by the spiking probes  to the resulting value. figure  <dig> shows that even when only 5% of the spike signal was present, the influence on pearson correlation can still be large, even though the resultant fold change is generally small.

together figures  <dig> and  <dig> show that increases in correlation are not simply confined to those cases in which a large and varying signal is being added to a low-variance probesets.

in situations where probesets are already strongly correlated, the addition of extra signal due to cross hybridization with another transcript might be expected to reduce correlation. spiking experiments found this to be the case . interestingly, however, even though there are occasions where r is reduced by multiple targeting, the general tendency is towards significantly increased correlation .

false positive rates will also be raised because otherwise absent probesets with signals resulting only from background levels of non-specific hybridization can experience additional, structured, signal due to exact matches to transcripts other than the intended target.

functional homogeneity and spurious correlations in families of probesets
analysis of mt-families shows that out of the  <dig>  shown in figure  <dig>   <dig> contained probesets annotated  to  <dig> or more unigene clusters. when gene symbols are considered, annotation becomes even more ambiguous:  <dig> families contained transcripts annotated to different genes. thus, even though the majority of families are homogenous with respect to unigene and gene symbols – some 10–15%  may be annotated to different genes. this translates to about  <dig> probesets.

as we have shown using both real and artificial data, mt leads to increased correlation. a consequence of this is that probesets associated by mt should be drawn closer to one another in dendrograms, such as those used to cluster probesets for visualisation using heatmaps. for example, the heatmap in figure  <dig> was created using three groups of probesets. the first , was identified in  <cit>  as discriminating between standard-risk and high-risk tel-aml <dig> cytogenetic abnormalities. non of these probesets are associated by mt and can thus be considered to form a "well behaving" biological family. the second set  constitute another biological family, but they are also associated by mt to each other, as well as to other tubulin genes. this family thus represents a mixed biological – mt family. the third group of probesets are associated with rps <dig>  but also to numerous pseudogene transcripts. this group represents an "mt family" where the relationship is expected to be artefactual. these three sets of probesets were added to a further set of randomly selected probesets, to act as "background", and then clustered. the mt-family, the tubulins and the biological family are found as separate clusters , demonstrating that the hierarchical clustering is unable to make a distinction between probable real  and probably artefactual  clusters.

discussion
it is clear that multiple targeting is an important artefact within microarray data: nearly half of all probesets on the hg_u133a array are associated with mt. when real expression data are considered, it can be seen that these probesets are significantly more correlated than would be expected by chance. these results are also supported by simulation experiments, using datasets derived from real experimental data, that allow mt to be considered in a more controlled framework. mt can lead to increased correlation between associated probesets, even when only a small proportion of their probes are involved. although expression summary algorithms are successful at reducing the effects of outlier probes, the do not remove them completely, and small amounts of stray signal can still have a significant influence on correlation. the reason for this apparent paradox is the scale-invariance of pearson correlation; absolute signal is not important. what is important are the variance and  the relative similarity in shape of the expression profiles. for this reason, particular care must be taken when analysing expression data using correlation-based approaches. the situation is also further complicated by the fact that mt occurs at a probe level – adding additional signal to individual probes within a probeset – but correlation is calculated after normalization and expression summarization using an algorithm such as rma or mas <dig>  this additional complexity makes it difficult to reliably predict what will happen when signals are combined. however, empirical data  show that influence on correlation is dependent on the relative variance of the two probesets being combined. as expected, high variance spiked probes generally have more of an effect than low variance spikes, but interestingly, adding low variance spikes to low variance data  has more of an effect than adding high variance spikes to low variance data . this is likely to be a consequence of the expression summarization and normalization that is imposed on the data.

one consequence of mt is that because it serves to add structure to otherwise random probesets with no genuine signal, it can lead to the detection of false positives unless the presence of cross-matching probesets is known. analysis of the intensity distributions for mt and non-mt probesets shows a considerable degree of overlap . this means that mt probesets cannot be removed simply by filtering on intensity. in fact, because mt generally increases signal strength, such filtering might actually serve to enrich for mt probes.

mt is ultimately a sequence-based event; it occurs when two sequences show 100% identity across the 25bp targeted by a probe. at the level of a probeset, this is most likely to occur when transcripts show a high degree of sequence similarity. the relationships is troublesome, because a major use of expression data is to identify probesets  with correlated expression profiles, and to use these relationships to infer functional similarities. since sequence similarity is itself often the basis by which common function is inferred  <cit> , sequence similarity combined with mt has the potential to become a self-fulfilling prophecy.

a search of the database found that about 5% of family members contained probesets annotated to different genes. thus, the chances of finding a spurious functional relationship due to mt between a pair of randomly selected genes is small. however, this is optimistic, because microarray analysis generally involves filtering to produce a set of significant probesets . the result of such filtering is to enrich the final 'hit list' not only for real biological effects, but also for anything else that is consistent, including biochemical or sequence based artefacts such as mt. this is illustrated by the heatmap in the figure 8; mt families fall into separate clusters against a background of randomly selected probesets.

one possible solution to mt is to redefine probesets so that probes targeting the same transcript are placed into larger probesets representing the entire sequence, as proposed by  <cit> . this is the approach taken also by  <cit> , but authors conclude that "under many circumstances it is not possible to generate transcript-specific probe sets for genes with multiple transcripts based on probes available on the current generation of genechips". thus they may be used to make distinction at the level of genes, but not at the level of transcripts or splice variants – mt with all its consequences, still exists. there is a compromise to be made between generalisation and maintaining the ability to resolve subtle differences between transcripts and, for example, splice variants.

the issue becomes more significant with the new generation of microarrays such as the affymetrix exon array  <cit>  that deliberately use multiple probesets to distinguish between individual transcripts from within a set of splice variants expressed by a particular gene. the result is a many-many relationship between gene, transcript and probeset.

annotation schemes that attempt to compress these many-many relationships into a one-to-one mapping lose the complexities inherent in the system. grouping together a probeset that targets more than one transcript with probesets that target one or more individual transcripts, results in mt occurring between the new probeset and all the other transcripts it shares probes with. from one perspective, many these issues are simply down to annotation. the apparent aretefacts in the data only exist because the probeset annotations do not accurately reflect the transcripts they bind to.

with all solutions, including those that attempt to solve the problem by aggregating probes into larger probesets, annotation is crucial, since inaccuracies will arise unless all the many-many relationships that occur within the data are represented explicitly.

CONCLUSIONS
cross hybridization between probesets is a significant effect that has real consequences for the interpretation of microarray data. it may cause a variety of problems during analysis including false positives and negatives, and generally increased correlation between multiply-targeted probesets. although the results presented here are for affymetrix arrays, it is reasonable to expect similar effects to occur with other expression-based technologies. the use of short oligos and strict hybridization conditions makes it possible to perform the in silico searches required to identify mt within affymetrix data. however, ch is not exclusive to any one platform, and similar behaviour is likely to be seen elsewhere. expression summary algorithms must correct not only for variation across arrays, but also for variation between individual probes within a probeset. this is generally performed using some kind of robust averaging procedure, but even small amounts of stray signal can lead to high correlations between probesets. although algorithms such as rma and mas <dig> do a very good job of significantly reducing the influence of outlier probes, they do not always remove it completely – and this is manifested by significantly increased correlation between probesets, even when only a small subset of probes are involved.

many of the issues described above can be avoided with more detailed annotation. often the terms 'gene', 'transcript' and 'probeset' are used interchangeably. this is dangerous, because the relationship is not one-one-one, and the existence of mt networks can lead to apparent biological relationships that are, in fact, artefactual. expression data that is presented simply as a gene list is difficult to interpret properly, since the complexities of the interaction networks implicit within the data are lost. the community should ensure that the actual probeset ids are always available alongside gene names or transcript accessions. this allows the graph structures associated with gene-transcript-probeset mappings to be explored where necessary and used to fully interpret the complexities of gene expression data.

