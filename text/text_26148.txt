BACKGROUND
a principal goal of metagenomics  <cit>  is to sample microbiomes and recover genetic material without isolating single organisms, thereby mitigating the problem of limiting genomic analysis to a small percentage of existing culturable species. eventually, this will help extend the tree of life  <cit> , enrich sequence libraries, and expand analysis from genomic to metagenomic .

recent advances in genome sequencing technology have made metagenomics more feasible. second generation sequencing technology, such as roche  <dig>  abi solid, and illumina  <cit> , provide a greater amount of sequenced data at lower cost. sequencing metagenomes sampled from their natural habitat is already physically achievable. however, there are important computational challenges. complete assemblies of genomes in environmental samples are rarely achievable for several reasons.

the first obstacle is the population characteristics of the microbiome communities. while dominant species are represented in the samples by a greater number of clones, proportional to the abundant number of individuals, less abundant species are sparsely represented or in some cases, not captured due to incomplete sampling  <cit> , resulting in their low representation, or absence, in the metagenome. the assembled contigs from metagenome reads are generally shorter than the contigs obtained from the sequencing of single genomes. the average contig length is frequently around a few kilobase pairs . for high diversity metagenomes, much of a metagenome cannot be assembled, leaving the majority of the reads as singletons. for example, in a diverse community sample obtained from minnesota soil, less than 1% of the reads could be assembled  <cit> .

the second obstacle arises from the fact that the new sequencing technologies generate shorter reads. in currently popular sequencing technologies, a read corresponds to dna fragments with lengths between 100- <dig> bp creating greater dificulties in assembling contigs as well as shorter singletons. all in all, these technologies yield contigs ranging from a few hundreds of base pairs to a few tens of kbp at the end of the metagenome assembly process.

analyzing the composition of such a large amount of fragmented data remains a computational challenge. in order to identify which operational taxonomic units  exist in the mixture, phylotyping methods are often employed that involve searching for  <dig> s rrna marker genes  <cit>  or a set of marker genes  <cit>  in a metagenome to locate the otus in the existing phylogeny trees. amphora  <cit>  and mltreemap  <cit>  use marker gene analyses to infer the phylogenetic information of a given environmental sample. while those programs supply information about the biodiversity of a sample, they only associate those genome fragments that carry a marker gene with possible otus. that means the great majority of sequencing reads remain unassociated with any taxa. however, along with the composition of the metagenome, classifying each sequence fragment into taxonomic units is also a challenge that needs to be met in metagenomics. this is required to link genes discovered to the members of a taxon or to enable divide-and-conquer approaches as a solution to the metagenome assembly problem.

in this article, we refer to the process of classifying the metagenome fragments into otus as binning. we can categorize most binning methods as similarity-based methods and composition-based methods. in similarity-based methods, the dna fragments to be classified are compared with existing sequences by performing string similarity searches against a molecular sequence database . the megan system  <cit>  is an example of similarity-based binning. it attempts to predict the source of the sequences by assigning them to hypothetical common ancestors using multiple high scores gathered from a similarity search system, such as blast  <cit> . carma  <cit>  is an algorithm that assigns the sequences to taxonomical origins by trying to match them to known protein families contained in pfam domains. although these methods are frequently used for phylotyping, they can be employed for binning since they utilize comprehensive protein/nucleotide domains and attempt to classify any given genome fragment. while computationally expensive, these algorithms have been shown to be accurate even for short sequences in the current pyrosequencing read length range . however, the accuracy drops dramatically when phylogenetically close sequences are missing from the search databases. running carma on a comprehensive dataset gathered from a large spectrum of known genomes resulted in inaccurate classifications  <cit> . . moreover, in a recent study  <cit> , only 12% of the data obtained from microbial communities in coral atolls got significant blast hits. thus, even if similarity-based methods were much more accurate, they would still be unable to identify sequences from a large proportion of the microbial population.

composition-based binning methods approach the problem using conserved compositional features of genomes, such as short oligonucleotide usage patterns. it has been observed that relative frequencies of k-mers in dna sequences are taxon specific and carry phylogenetic signals. moreover, they are fairly conserved for relatively short fragments. thus to some extent, it is possible to predict the origin of a random dna fragment given the relative oligonucleotide frequencies of the possible sources. a number of unsupervised methods for clustering fragments originating from similar taxonomic units have been proposed. tetra  <cit>  uses relative proportions of tetranucleotides with respect to the database samples in dna contigs and calculates the correlations of pairs as a measure of similarity. self-organizing maps  are used for clustering profiles of tetranucleotide frequencies.

when the binning task includes assigning taxonomical labels using available genomic information, supervised methods are employed; and the available genomic sequences of known organisms are used for training source models. a naive-bayesian classifier-based method proposed by sandberg et al.  <cit>  and a markov chain method by dalevi et al.  <cit>  are early examples of this approach. the algorithm, phylopythia  <cit> , consists of various support vector machine  classifiers and uses relative frequency profiles of short oligonucleotides as feature vectors. satisfactory sensitivity and specificity results are reported for the sequence lengths >1- <dig> kbp. however, a sharp cutoff in the accuracy is observed for fragments less than  <dig> kbp in length. another recent taxonomic classification method, tacoa  <cit> , proposes a k-nearest-neighbor-classification-based algorithm. in this method, genomic sequences are represented by the abundance profiles of oligonucleotides. tacoa correctly classifies fragments larger than  <dig> bp with an average sensitivity between 76% at rank superkingdom and 39% at rank genus, and its performance is comparable to phylopythia in that range.

there are several ways of measuring the distance or similarity of sequence composition, in particular the distances between relative oligonucleotide frequencies or oligonucleotide abundance feature vectors. however, measures such as euclidean distances , inner products , and pearson correlations  have some inherent limitations in this context. since all 4k oligonucletotide components calculated over k-mer frequencies are involved in similarity measurements, good estimates of all components are necessary; and overfitting dramatically drops the detection accuracy. in order to prevent overfitting, more data points are needed to accurately estimate frequencies of occurrence ; and the number of parameters to be estimated should preferably be kept small . not surprisingly, all of these methods work best with relatively short oligomers  with sequences ≥1- <dig> kbp. however, longer-range correlations exist in dna sequences, which we would like to exploit for fragment identification even with short sequence reads. it has been observed that methods that employ probabilistic frameworks, such as the naive bayesian classifier, which estimates the probability of observing dna sequences based on relative oligonucleotide frequencies  <cit> , or markov models  <cit> , can achieve better accuracy for longer oligonucleotides, even for sequences shorter than  <dig> kbp.

to date, the only composition-based algorithm reported to be successful with short reads is phymm  <cit> . it was developed for the classification of short read lengths of metagenomics data. it is based on a bayesian decision machine that detects the taxonomic source of a read with its maximum a posteriori probability calculated over variable-order markov models. phymm provides significantly better accuracy than carma and phylopythia. phymmbl  <cit> , which combines the phymm-based approach with a blast-based similarity approach, provides superior performance to phymm, albeit at a significant computational cost.

metagenomic fragment classification remains an important computational challenge that requires the taxonomic assignment of genomic sequences of various lengths, which in turn requires reliable sensitivity and specificity values for a large spectrum of fragment lengths. we propose a composition-based semisupervised binning algorithm, raiphy. this method characterizes, or models, a genome/taxonomic unit with a set of parameters called the relative abundance index . according to this model, an index value is calculated for each k-mer, based on the over- and underabundance statistics gathered from the taxon. unlike the work of brendel et al.  <cit>  used in the work of qi et al.  <cit>  and wan et al  <cit> , the over- and underabundance statistics are obtained with reference to a sequence of markov models. a given random genome fragment is given a membership score with respect to a taxon by adding up the index values in the rai model for the taxon for each observed k-mer in the fragment. the fragment is assigned to the taxon that results in the highest score. an iterative process consisting of classifying the fragments from a mixture using the current rai models then updating the rai models based on the resulting clusters is used to improve the classification accuracy. as the initial rai seeds, raiphy uses models estimated from genomes currently available in the refseq database, and thus raiphy can be categorized as a semi-supervised method.

raiphy has been implemented as a simple, compact standalone desktop application, which is fast compared to similarity-search-based applications. while achieving competitive binning accuracies for the dna sequencing read length range , the method also performs accurately for longer environmental contigs.

methods
there are three components of the raiphy algorithm: the relative abundance index and the corresponding profile or model for genomic fragments and taxonomic units; the classification metric; and the iterative algorithm used to refine the models used for classification. we describe each in turn.

relative abundance index
the relative abundance index is a measure of the relative abundance of oligonucleotides in genomic fragments. based on the available genomic sequences for a taxonomic unit, a score is assigned to each possible k-mer. these scores are higher for overrepresented k-mers and lower for underrepresented k-mers. the vector of k-mer scores comprises the rai profile for a taxonomic unit.

the under and the overrepresentation of each k-mer is measured using the log-odd ratios between the observed and expected frequencies of each k-mer. therefore, for an overrepresented k-mer, the observed frequency is higher than the expected frequency; and the rai score is positive. it is negative for an underrepresented k-mer. using relative frequency counts as estimations of k-mer probabilities in a genome sequence, we use markov assumptions for the calculation of expected k-mer probabilities.

consider a k-mer, x <dig>  x <dig>  . . . , xk, with probability p. we can write this probability as:

  p=pp. 

we can rewrite the first factor on the right hand side of equation  under different independence assumptions as follows. assuming that the bases occur independently of each other, the conditional probability can be replaced by the marginal probability

  p=p. 

to test this assumption, we can compute a log odds ratio to form the relative abundance index of order  <dig> rai0:

  rai0=log2ppp. 

if we assume that the bases follow a first order markov model,

  p=p 

  =pp. 

the corresponding relative abundance index rai <dig> is then given by:

  rai1=log2pppp. 

continuing in this fashion, we obtain:

  raii=log2pppp. 

we combine the relative abundance indices of all orders by adding them to give the total superposed profile

  rai=∑i=0k−2raii. 

given a particular k-mer, x <dig>  . . . , xk, {rai} is a positive value if the probability of observing x <dig>  . . . , xk is higher than expected for a particular taxonomic unit, and a negative value if the probability of observing x <dig>  . . . , xk is lower than expected for a particular taxonomic unit.

the probabilities used for obtaining the rai values for k-mers are estimated using the relative frequency of occurrence of that k-mer in the taxonomic unit. thus, for each taxonomic unit for which we have genomic sequences, we compute a corresponding rai profile. this profile serves as a model for that taxonomic unit.

classification metric
to assign a genomic fragment, f, from an unknown source to a taxonomic unit, we first compute the relative frequencies of occurrence for each k-mer from the fragment. for each candidate taxonomic unit, we then obtain a membership score by computing the weighted sum of the components of the rai profile of the taxonomic unit where the weighting is the corresponding k-mer frequency of occurrence for the fragment f.

given a rai model belonging to the taxon, gi, and an unknown genome fragment, f, the membership score, ef , is given as:

  ef=∑xffraigj, 

where ff  is the frequency of a k-mer in the fragment, f, and raigj is calculated using the relative frequency counts of the k-mers observed in the taxon, j. consider what happens when the statistics of the k-mers of the fragment match the statistics of a taxonomic unit. for a k-mer that occurs often, the frequency of occurrence will be a high and the rai value of the k-mer for the taxonomic unit will be positive. the more often the k-mer occurs, the larger will be the values of both the rai and the frequency of occurrence. for k-mers that occur less often than expected, the frequency of occurrence will be low; and the rai value of the k-mer for the taxonomic unit will be negative. thus in the sum, the positive rai values will be weighted by the larger frequencies of occurrence; and the negative values will be weighted with the lower frequencies of occurrence. the opposite will happen when the statistics of the fragments are completely mismatched with the statistics of a taxonomic unit. therefore, the membership score for the matching taxonomic unit will be higher than the membership score for the mismatched taxonomic unit. we have empirically observed that genome fragments attain higher membership scores when they share the same taxa with an rai profile . this can also be shown mathematically assuming stationarity .

given the taxa, j = { <dig>   <dig> ...,n}, with rai profile. }raig <dig> raig <dig> …,raigj,…,raign}, an unknown genome fragment, f, is classified to the taxon, j⌢, by

  j⌢=argmaxjef. 

we have observed that rai performs better than the similarity measures defined by sandberg et al.  <cit>  and dalevi et al.  <cit>  with the same experiment setup used in those studies . therefore, we have adopted rai as the compositional detection approach to be used in our metagenomic phylogeny classification.

iterative refinement of genome models
metagenomics binning programs are designed for classifying genome fragments of previously unknown species using phylogenetically close genomes. since the conserved compositional features, or genome signatures, of the unknown species in the mixture are not available, the presumption is that the classification algorithm will assign the fragment to the same or a close clade-level for which a model  is available. while this can be done with some success, there remains significant room for improving the classification accuracy by adaptively updating the models used for detection. the heuristics presented here rely on the fact that we actually possess genomic fragments from the unknown genome in the mixture. therefore, we use a multistep process in which the first step uses classification, as described above, using the rai profiles of known species. once this first classification has been performed, the resulting clusters of fragments can be used to obtain the rai profiles of the unknown species. obtaining the genome signatures of these clustered fragments  results in models that better describe the composition of the unknown genome leading to more accurate classification. experiments supporting these claims are presented in the results section.

the refinement procedure consisted of the repetition of two phases. in the first phase, rai profiles were estimated from genomes of known organisms. each metagenome fragment was classified by assigning it to the genomes returning the maximum rai score. in the second phase, the oligonucleotide frequencies and, subsequently, the rai profiles for each class were recalculated using the collection of fragments assigned to the corresponding class. these two phases were iteratively repeated until a stopping criterion was met. with each refinement, the metagenome fragments were represented with improved rai profiles. thus, the average membership scores were expected to increase. when the change in the increase of average membership scores with a refinement became small, we stopped the refinement procedure. here, the stopping criterion was met if the improvement in the score was less than 1% of the membership score achieved in the previous iteration. the algorithm is quite robust to the stopping threshold; reducing the threshold by several orders of magnitude has no effect on the binning performance. this procedure can be thought of as an expectation maximization algorithm with hard decision of classes  <cit> . from this point of view, it is similar to a seeded k-means clustering algorithm, with training initial conditions using previously known data  <cit> . instead of minimizing the mean euclidean distance, our objective was to maximize the mean average membership score. the algorithm can be summarized as follows:

classification with iterative refinement:

n metagenome fragments: fjj ∈ { <dig>   <dig>  .., n}

m rai profiles: raigi i ∈ { <dig>   <dig>  .., m}

m taxonomic classes: gii ∈ { <dig>   <dig>  .., m}

 <dig>  classify allfj using allraigi

 <dig>  update allraigi usingfj ∈ gi

 <dig>  break if|average_membership_score_currentaverage_membership_score_previous−1| < <dig> 

 <dig>  goto 1

we tested the performance of this algorithm using the same data and experimental design as in  <cit>  . the test fragments in this dataset were short fragments in the range of 100- <dig> bp. observing the performance of iterative refinement on short fragments was important because the ratio of false positives is greater for short fragment lengths, as is the noise introduced by them. therefore, the task of improving the models in this band was harder. we observed improvement in classification accuracy for all fragment lengths we tested in a small number of iterations . the increase in accuracy for the fragment length of  <dig> bp is shown in figure  <dig> 

test data
in order to be able to conduct controlled experiments, we created synthetic metagenome data using the available genomes in the us national center for biotechnology information  refseq database  <cit>  as of march  <dig>  we built our database storing rai profiles for all  <dig>  available genomes. different chromosomes and plasmids belonging to the same organism were concatenated and treated as a single sequence. these served as the initial seeds in a run of raiphy. for phylogenetic binning and labeling, we collected the taxonomic information from the ncbi taxonomy database. the data collected was comprised of  <dig> species,  <dig> genera,  <dig> families,  <dig> orders,  <dig> classes, and  <dig> phyla. to test the performance of our program, leave-one-out, cross-validation tests were performed as follows: for every taxonomic unit comprised of at least two subtaxa , a test genome was selected; and  <dig> test fragments were drawn randomly from each one of those genomes. the rai profiles were trained over the remaining taxa. the test genome was not used for obtaining the rai profile. this was done for every genome that was not a single representative of a clade. we repeated each experiment  <dig> times to assess the first and second order accuracy statistics.

program parameters
since raiphy was designed as an iterative algorithm, which retrains its models depending on the change in the average membership score, the parameters were kept constant for the whole spectrum of fragment lengths. the oligonucleotide length was fixed at seven. although it has been shown that longer correlations exist in dna and that it is possible to exploit longer oligonucleotides for sufficient sequence lengths  <cit> , we observed that the classification accuracy saturates after an oligomer length of seven . the binning accuracy increases significantly with the increase in k-mer size to a size of seven . however, increasing the size of the k-mers beyond seven results in negligible accuracy improvement while significantly increasing the computational burden. an rai profile was updated only if the total length of the fragments assigned to the corresponding class exceeded  <dig> kbp.

RESULTS
absolute metrics vs. probability metrics
in order to show the improvement in accuracy obtained by replacing the distance/similarity metrics from absolute metrics, such as euclidean norms, or correlation coefficients to probabilistic measures, such as bayesian posterior probabilities, we ran the same experiments with different metrics using the dataset in  <cit> . the example shows the percent of true positive ratios for short fragments, and the metric defined in equation  <cit>  can be observed to be more accurate for 7-mer frequencies. this was the motivation for using a probabilistic method for oligonucleotide usage measurement. the results are shown in figure  <dig>  the improvement of bayesian detection over the use of euclidean distance and the pearson correlation coefficient is evident for all fragment lengths.

experiments in support of the refinement process
there are two observations that support the thesis that a refinement process will improve the overall detection performance. first, the genome signatures estimated using the detected portion of a genome should be a good approximation of the signature of the unknown genome. that is to say, we should be able to perform sufficient classification with the models trained from incomplete genomes and even with a collection covering a small percentage of the genome. although the genome signatures are known to be pervasive, we investigated whether the pervasiveness was sufficient to allow a reasonable estimate of the signature to be extracted from a small fraction of the genome. we repeated the fragment classification experiments in  <cit>  using models trained over various coverage percentages of genomes starting from the entire genome down to only 10% of the genome. employing the rai in the manner described above, as shown in figure  <dig>  we observed that there is only a decrease in accuracy of 2-4% in the worst case. this result supports the premise that even with a small collection of fragments in a taxonomic bin after the classification we could train a practically useful model for the unknown organism.

the first experiment demonstrated that it was possible to train a model with a small fraction of the genome that could be obtained through classification of the samples of the microbiome. however, these results assume that the genomic fragments available truly belong to the organism being detected. taxonomic classification algorithms return significant amounts of false positives. these false positives could conceivably make the algorithm diverge and actually reduce classification accuracy. we conducted a number of experiments to make sure that this would not happen with raiphy for the metagenomic classification experiments. an example of the results of such an experiment is shown in figure  <dig>  we had no experiments in which the algorithm diverged.

classification performance for short fragments
the first set of experiments included testing the accuracy of raiphy for short fragments in the range of 100- <dig>  bp. the experiments were divided into ranges or bands of fragment length, because existing programs operating in different bands have different accuracy scores and properties. for example, tacoa and phylopythia perform poorly for short fragments as mentioned above. on the other hand, similarity-based programs, such as carma, also perform poorly when the genome of origin is not available. currently, the only composition-based method that can accurately classify previously unobserved metagenome samples in this range is phymm. in figure  <dig>  the accuracy  performance with changing fragment lengths is illustrated. it can be seen that the raiphy classification performance compares favorably to phymm for all fragment lengths. in figure  <dig>  raiphy is compared with phymmbl, which combines phymm and blast. phymmbl outperforms raiphy for shorter fragment lengths at a cost of significantly increased computation time.

binning fragments in the absence of close relatives
even with our contemporary knowledge of microbiology, a great majority of the tree of life is unknown. therefore, it would not be unexpected to have genome fragments of an unknown clade in a metagenome sample. in this case, a metagenome binning method is desired to assign the fragments of undiscovered genomes to sister taxa in the same clade-level. to simulate this situation and observe how raiphy performs in such cases, we tested it with incomplete training data. we repeated the previous experiments with leave-one-out, cross-validation; however, this time, all representatives of the taxonomic group that the test samples belong to were removed from the training data and an assignment to a sister taxon  was accepted as a correct classification. we performed the tests for the unknown taxa of different clade-levels from family to class levels.

the correct classification rate decreased substantially with missing data. raiphy performed at under 50% accuracy for all clade-levels for fragment lengths in the range of  <dig> bp- <dig> kbp. in figure  <dig>  the binning performance for raiphy, phymm, and blast searches is illustrated for a read length of  <dig> bp and  <dig> kbp. while this performance is still superior to other composition-based methods, similarity searches performed using blast performed better for short read lengths of  <dig> bp and  <dig> bp .

classification performance for longer metagenome fragments
the classification performance for genomic fragments of  <dig> bp- <dig> kbp was also studied. this range is significant because it represents lengths of assembled contigs, while the shorter fragments correspond to single sequencing reads. in taxonomic classification, generation of a smaller number of highly reliable predictions is preferred over predicting the majority of fragments with less reliable labels  <cit> . when this is the case, genomic fragments with reliable scores can be classified and suspicious fragments left as "unknown." adopting the accuracy measurement definitions defined by baldi et al.  <cit> , this kind of regularization yields higher average specificity and lower average sensitivity. the sensitivity for the class i is defined as:

  sni=tpitpi+fni+ui, 

where tpi is the number of samples correctly classified to the class i , fni is the number of samples assigned to another class even though they belong to class i , and ui is the unclassified number of samples belonging to class i. the specificity for the class i is defined as:

  spi=tpitpi+fpi 

where fpi is the number of samples assigned to the class i while belonging to another class.

determining an operating point in the sensitivity-specificity trade-off was achieved by using different approaches for different methods. in tacoa, the kernel parameters governed the thresholds for classifying samples. in diaz et al.  <cit> , grid searches were employed to decide the optimal accuracy values and for setting the parameters. phylopythia uses a post-processing one-versus-all svm classifier to detect the reliable samples and leave the rest "unknown." raiphy classifies all metagenomic fragments to a taxonomic bin by default. however, raiphy also allows setting thresholds and operating at different points of the sensitivity-specificity curves. we assigned detection-quality scores to fragments to measure the likelihood of fitting. the quality scores were calculated as the difference between the best average rai score and the next best score:

  q=ef−ef 

where i is the class returning the best rai score , and k is the class returning the second highest rai score. if a fragment fits equally well to more than one model, the quality score turns out to be 0; and if a fragment reflects the characteristics of one class much better than any other class, it receives a high quality score.

setting percentage thresholds  to assign the top p% scored fragments of each class and drop the labels of the remaining  % to "unknown" increased the specificity while reducing the sensitivity. geometrically speaking, the fragments remaining in an iso-quality hyperboloid were assigned; and the others outside the hyperboloid were determined to be unclassified. therefore, this thresholding is a tightening of the decision boundary from a hyperplane to a hyperboloid in the feature space.

figures  <dig>   <dig>  and  <dig> show the specificity-sensitivity performance obtained from a cross-validation test on the dataset for  <dig> bp,  <dig> kbp, and  <dig> kbp fragments . four thousand random fragments were sampled from each test species. the optimized sensitivity and specificity values for tacoa and phylopythia were also shown for the same datasets. raiphy significantly outperformed both algorithms for the given range of fragments and clade-levels. an advantage of raiphy, as demonstrated by the sensitivity-specificity performance curves, is that even when samples with low confidence scores are included in the classification, we retain high specificity; and the number of unknown samples decreases and sensitivity values increase, whereas the specificity drop is only around 10-25% for  <dig> bp and  <dig> kbp fragments and around 10-15% for  <dig> kbp fragments.

performance on real-life metagenomic data
the raiphy system was also tested using a real-life dataset. recognizing the control on real metagenome data is very limited and that true labels of assembled contigs and reads are not entirely known or the labeling is low quality, the experiment was performed on a subset of an acid mine drainage  metagenome  <cit> . the amd sample consisted of a low-diversity community that was dominated by three microbic populations: ferroplasma acidarmanus and leptospirillum sp. groups ii and iii. since these organisms exist abundantly in the community, it has been possible to assemble draft genomes for these organisms. therefore, we can accurately determine which fragment reads belong to these organisms with sequence alignments since fragments originating from the draft genomes align with few mismatches. this allowed us to observe the classification accuracy of our method for a subset of real metagenome data that could be accurately labeled. the phylum-level taxonomy assignments for each of the three genomes are shown in figure  <dig>  ferroplasma acidarmanus belongs to euryarchaeota phylum of archaea;  <dig> % of the fragments were correctly classified, as shown in figure 10-a. this compares with  <dig> % for phymm,  <dig> % for megan, and 61% for phymmbl, as shown in table  <dig>  the similarity scores used as megan input were obtained from nucleotide blast with the refseq database used as the similarity search set.

phylum-level classification of the genome fragments belonging to ferroplasma acidarmanus according to the sequence alignments with the reads and draft of the genome for the taxonomic classification programs phymm, megan, phymmbl, and raiphy. correctly classified phylum is euryarchaeota.

leptospirillum sp. groups ii and iii are bacteria belonging to the nitrospirae phylum, which does not exist in the ncbi refseq database and, consequently, in our database. the genus leptospirillum was assigned as deltaprotobacteria  <cit> , which is a class of protobacteria. of the fragments putatively determined to be leptospirillum sp. group ii reads,  <dig> % were assigned to the protobacteria phylum. for phymm the true positive percentage was  <dig> %, for megan it was  <dig> %, while for phymmbl it was  <dig> %, as shown in table  <dig>  finally for leptospirillum sp. group iii fragments, the true positive rate for raiphy was  <dig> %. this compares to  <dig> % for phymm, 62% for megan, and  <dig> % for phymmbl, as shown in table  <dig>  this is a significant improvement in classification performance.

phylum-level classification of the genome fragments belonging to leptospirillum sp.group ii according to the sequence alignments with the reads and draft of the genome for the taxonomic classification programs phymm, megan, phymmbl, and raiphy.

phylum-level classification of the genome fragments belonging to leptospirillum sp.group iii according to the sequence alignments with the reads and draft of the genome for the taxonomic classification programs phymm, megan, phymmbl, and raiphy.

CONCLUSIONS
we proposed a metagenome binning method that exploits inherent features of genomic signatures with a novel measure called rai and a novel classification metric. our simulations used a large genomic fragment length range from  <dig> bp to  <dig> kbp. this range covers the length of average metagenome assembly contigs and the length of sequencing reads with the current sequencing technology. the simulations resulted in classification accuracy ranging between 38-97% at the deepest clade-level . using rai scores, the optimal performance was obtained using relatively longer oligonucleotides  than methods using euclidean distance and correlation-based scores utilizing shorter k-mer statistics. we attributed a part of the improvement in classification accuracy to being able to use longer oligonucleotide statistics, which include additional information on the dna k-mer distribution. moreover, with the availability of rai profile updates using the predicted dna sequences, we have defined an iterative classification method that improves the classification accuracy. we believe the improvement is due to the fact that genome signatures are pervasive, and genome models can be approximated without requiring the availability of complete genomes. therefore, a small set of genome fragments was sufficient to update the initial genome models. in our case, a set of fragments forming  <dig> kbp of nonoverlapping genomic sequence was sufficient to increase the classification accuracy in the next iteration.

in addition to the experiments performed on synthetic metagenomics data, we tested raiphy with well-studied, real-life metagenome amd sample reads. raiphy outperformed the composition-based phymm and nucleotide blast search-based megan on the binning task. phymmbl, which uses a composite method consisting of phymm and blast, did better than raiphy in one of the three tasks and worse in the other two. phymmbl took substantially longer to complete the tasks than phymm or raiphy. the running time of raiphy scales linearly with the average fragment length and the number of fragments in the metagenome sample. in our experiments, it took less than  <dig> hours to bin the amd metagenome with the most comprehensive search models that contained all  <dig>  genomic sequences of the  refseq database on a standard desktop computer with a  <dig>  ghz cpu. processing of the same dataset with similarity-search-based binning programs, such as carma and megan , and even with phylotyping pipelines amphora and mltreemap, requires > <dig> hours. phymmbl took around  <dig> hours to process the dataset. using genus level rai profiles, the current version of raiphy can bin  <dig>  gbp of genomic sequences with  <dig> bp average read length in  <dig> hours. this amount of data is achievable with next generation, high-throughput sequencing; and raiphy appears to satisfy a computational need for fast and accurate metagenome binning. raiphy uses a moderate amount of memory  in its runtime.

we have implemented raiphy as an open-source desktop application supported with a simple graphical user interface. while the default is for all the rai profiles of the refseq database in the species and genus level to be used as database files, there is also an option to create custom databases if a set of training sequences are provided. since the program performs with a satisfactory accuracy both for read-length and assembly-length dna fragments, it can be utilized either as a preprocessing stage in a metagenomics pipeline to improve the assembly procedure or as the binning procedure for the assembled contigs.

we have observed that the accuracy falls to below 50% when sister taxa of the unknown fragments are not close relatives. this appears to be a universal problem that is also observed with other binning methods. for the metagenome samples of undiscovered microbes, it might be a safe strategy to sacrifice prediction resolution and bin the sequences to higher taxonomic units, such as phylum or class, or sacrifice specificity by selecting best hits and leaving suspicious assignments "unknown." raiphy outputs assignments at all taxonomic levels as well as providing a thresholding option to select the best hits. another universal problem, which raiphy also suffers from, is the classification of horizontally transferred regions in procaryotes. since recently transferred regions differ in composition, predictions of those regions result in false binning.

availability
the binary files and source code for raiphy can be downloaded from http://bioinfo.unl.edu/raiphy.php.

authors' contributions
oun came up with the rai concept and developed and implemented the algorithms and wrote the initial draft of the manuscript. sw wrote the production version of the raiphy program. shh provided the biological insight and contributed to the final manuscript. ks conceived the study and collaborated in the development of the algorithm and in preparing the final manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
empirical distributions of rai scores. histograms of the relative abundance index scores are shown for different levels of phylogenetic closeness. a rai profile is built for a species, and rai scores calculated using this profile for a relatively close relative and a distant relative are considered. a close relative is expected to have higher rai scores, and a low score is expected for a distant relative. the empirical distributions calculated by rai score histograms support this claim.

click here for file

 additional file 2
analytical result showing rai scores measures compositional similarity. with the assumption that elements from the same taxonomic units follow the same k-mer probability distribution, it is shown that rai profiles of dna fragments from the same taxon attain higher membership scores than fragments from other taxa.

click here for file

 additional file 3
classification performance of rai similarity measure. figure  <dig> shows the comparison of relative abundance index measure with other similarity measures for  <dig> bp- <dig> bp fragment lengths. an oligomer length of  <dig> is used. figure  <dig> shows the detection accuracy for varying oligomer lengths  using an rai measure in the range of  <dig> bp- <dig> bp fragment length.

click here for file

 additional file 4
binning performance in the absence of close relatives. comparison of raiphy, blast, and phymm with incomplete training set for varying clade-levels is shown for  <dig> bp,  <dig> bp, and  <dig> bp genomic fragments.

click here for file

 additional file 5
performance of raiphy for longer genome fragments. using metagenome fragments ranging from  <dig> bp to  <dig> kbp, the specificity results were illustrated for each taxon. the results are supplied for clade-levels of genus, family, order, class, and phylum seperately.

click here for file

 acknowledgements
this work was supported in part by a grant from the national institutes of health under grant k25ai <dig>  we thank patricia wofirster for her careful reading and critique of the manuscript. we also owe a considerable debt to the anonymous reviewers who helped us significantly improve this paper.
