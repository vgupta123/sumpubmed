BACKGROUND
next generation sequencing   <cit>  is a term that refers to post-sanger sequencing methods. the primary advantage offered by ngs technologies over traditional sequencing methods is the production of large volumes of sequence data inexpensively and with a high degree of flexibility for the level of resolution required for given experiments. the production of large numbers of low-cost, high-quality sequences has enabled the scientific community to address an increasingly diverse range of biological and medical problems, including clinical diagnostics  <cit> , epidemiological investigation  <cit> , species classification and gene discovery in metagenomics studies  <cit> , virology  <cit>  and genomic analysis  <cit> .

although ngs technologies are increasingly used in many areas, the large amounts of data produced by ngs technologies present a significant challenge for data analysis and interpretation. advanced high-performance computing and intensive bioinformatics support is essential for the successful application of ngs technologies. currently, a variety of analysis tools and software have been developed for the early stage of ngs technologies. most of these tools are used for the general categories, such as sequence alignment, genome assembly and annotation, and genetic variation detection  <cit> . limited research has been reported on data mining strategies for large next generation sequencing data to address biology-driven questions.

topic modeling is an active research technique in machine learning that has wide analytical applicability for interpreting large data sets in text mining  and image retrieval procedures  <cit> . the basic idea in topic modeling is that a document is a mixture of latent topics, each of which is expressed by a distribution on words. latent dirichlet allocation   <cit>  is the most popular topic modeling algorithm. in an enhanced version of the earlier models  <cit> , lda uses two dirichlet-multinomial distributions to model both the relationships between documents and topics and between topics and words. two probability matrices are provided by the lda approach:  <dig>  per-document topic distributions and  <dig>  per-topic word distributions. approximate methods, such as variational inference  <cit>  and markov chain monte carlo   <cit> , are commonly used in lda analysis to calculate the posterior probabilities. the calculated probability matrices are used to make inference about the topics and documents for text mining. topic modeling has been applied for various purposes, such as protein structure representation  <cit> , fda drug labeling  <cit>  and metagenome data analysis  <cit> , however, we are not aware of any research that has been reported which applies the text mining algorithms to next generation sequence data analysis.

in this study, we propose a procedure that applies lda topic modeling to analyze ngs data, especially those on the large sequence datasets. the ngs data set containing the salmonella flic gene was used as a case study to show the workflow and the function of this procedure. the flic gene encodes a salmonella phase  <dig> antigen, and is considered one of the salmonella serotype determinant genes  <cit> . the developed procedure was applied to the flic gene-containing ngs sequences of  <dig> salmonella strains of nine salmonella serotypes. these sequences were retrieved from the database of the national center for biotechnology information  and/or other sequence databases, and were transformed into the files of documents on which the lda algorithm was run and two matrices were generated. the two matrices were then analyzed by hierarchical clustering and other data mining methods to elucidate the hidden information within the content of dna sequences.

based on our limited knowledge, the proposed method in this study is the first attempt of applying topic modeling to ngs data analysis at the level of phenotype-determinant genes. better performance and accuracy was observed when comparing this method with hamming distance method  <cit>  by clustering analysis and classification. the results showed that the topic modeling provides a promising novel approach to analysis of ngs data for the purpose of understanding and decoding hidden genetic information in a biological system.

methods
dataset construction
in this study, the whole genome sequences of  <dig> strains  of salmonella o antigen group b  <cit>  were retrieved from the ncbi database, including  <dig> strains of s. agona,  <dig> strains of s. heidelberg, one strain of s. paratyphi b, two strains of s. saintpaul, two strains of s. schwarzengrund, one strain of s. stanley,  <dig> strains of s. typhimurium, one strain of s. typhimurium var.5-, and one strain of s.  <dig>  12:i:-  <cit> . the dataset was constructed and preprocessed by our developed pipeline  <cit>  as briefly described in the following: the retrieved sequence reads or contigs were collected to a data pool. for each strain, the sequence fragment best matching the reference flic gene was selected by blasting with the serotype-specific reference flic, using the basic local alignment search tool   <cit> . in this study, the reference flic genes used for the strains of s. agona, s. heidelberg, s. paratyphi b, s. saintpaul, s. schwarzengrund and s. stanley were those of s. agona sl <dig>  s. heidelberg sl <dig>  s. paratyphi b spb <dig>  s. newport sl <dig>  s. schwarzengrund cvm <dig> and s. typhi ct <dig>  respectively. the strains of s. typhimurium, s. typhimurium var.5- and 1 s.  <dig>  12:i:-  <cit>  used the flic of s. typhimurium lt <dig> as the reference gene. all the reference genes were retrieved from ncbi by the same pipeline. the metadata of the flic gene-containing ngs data of  <dig> salmonella strains are listed in additional file 1: table s <dig> 

ngs data preprocessing
the procedures for data preprocessing are shown in fig.  <dig>  the sequences in the constructed dataset ) were aligned by an algorithm of multiple sequence alignment , such as muscle  <cit>  or clustal  <cit> , generating a dataset of aligned sequences  ). the nucleotide differences at each site, called single nucleotide polymorphisms , were collected and are shown in fig.  <dig>  each of the  <dig> strains had its corresponding file of words consisting of both snps and the locations of the snps in the sequences ).fig.  <dig> flowchart of the proposed procedure



topic modeling
after preprocessing, a text corpus was generated in which each of the documents corresponded to one of the  <dig> strains, and all the documents had the same number of words. the lda program implemented in mallet  <cit>  was utilized to model the corpus to get the latent topics and the topic mixture distribution for each strain.

lda is a generative probabilistic model whose graphical model representation is shown in fig.  <dig>  lda generates a given corpus according to the following process  <cit> :for each topic k, where k in {1… k}, pick a distribution over words φk ~ dir;

for each strain ds, where s in {1… s},pick a distribution over topics θs ~ dir;

for each word wn with n in {1… n},pick a topic z ~ multinomial ;

pick word wn ~ multinomial ;





fig.  <dig> graphical representation of the lda model. the shaded circle represents the observed variable and white circles represent latent variables



in the generative process, dir represented a dirichlet distribution and multinomial represented a multinomial distribution. the distributions of words for topics and distributions of topics for documents were viewed as random variables obeying dirichlet distributions with parameters β and α, respectively. words in documents were treated as random variables obeying the multinomial distribution of topics.

given a corpus of s strains d = {d <dig>  d <dig> …, ds}, the probability of the corpus:  <dig> pdαβ=∏s=1s∫pθsα∏n=1n∑z=1kpzsnθspwsnφzsnpφzβdθsdθz 

in this study, gibbs sampling  <cit> , a special case of markov chain monte carlo   <cit>  approach, was used to sample posterior distribution of θs 'zsn and φzsn.the lda algorithm was run on the corpus several times with different number of topics. for all the runs, we assigned α =  <dig>  and β =  <dig>  as initial values for the two hyper-parameters, and  <dig> iterations in gibbs sampling. the default values were applied for the other parameters in the lda model in mallet.

perplexity measurement
leave-one-out cross-validation was used to measure the perplexity of lda algorithm. the lda algorithm was first trained by  <dig> samples, and then the obtained lda model was applied to calculate the perplexity of the left-out sample. this process was repeated  <dig> times until each of the samples had been left out once. the average perplexity of the  <dig> samples was taken as the final perplexity for the corresponding number of topics.

data mining
strain characterization
the per-document topic distributions and the per-topic word distributions were obtained after lda processing. words with high probability for given topics were selected to characterize and differentiate bacterial strains.

two-way hierarchical clustering
two-way clustering is a data mining technique which allows simultaneous clustering of the rows and columns of a matrix. in the two-way hierarchical clustering analysis in this study, the topic mixture distributions of strains were viewed as the strain representatives. the dissimilarities between strains and topics were calculated by euclidean distance of topic mixture distributions of strains. the result describes simultaneously the subgroups of samples and the relationships among topics. hierarchical cluster analysis using the complete linkage was applied on the dissimilarities to perform a two-way hierarchical clustering. function “heatmap.2” in package “gplots” of r  <cit>  was utilized to implement the two-way clustering. the colors from blue to red indicate the values of the topic probabilities of the strains ranging from  <dig> to  <dig> 

distance matrix analysis
in the distance matrix analysis, euclidean distance measure was used to measure the dissimilarity between strains based on the strain-topic mixtures derived from the flic snps dataset. the program “dist” in package “stats” of r   <cit>  was utilized to calculate the euclidean distances between all the strains. the colors from blue to red represent the values of the euclidean distances as they range from  <dig> to  <dig> 

evaluation of topic modeling performance
to evaluate the performance of topic modeling, we applied clustering and classification algorithms on the sample-topic matrices ) generated by lda and similarity matrices generated by hamming distance  <cit> , and the results were compared based on the serotypes  of the samples which were viewed as the sample’s true labels.hamming distance measures

the documents  in fig.  <dig> were transformed into matrix of vector space model   <cit>  which is a commonly used model for representing text documents. in the vsm matrix, the number of row is the number of samples and the number of column represents the size of the vocabulary. using hamming distance measures, the traditional clustering and classification methods were conducted and the results were compared with those conducted on the sample-topic matrices from lda ).

 <dig>  cluster analysis and result comparison

 <dig>  classification analysis and comparison

topic model-derived clustering method  <cit>  was applied, in which lda was utilized as a feature reduction approach for cluster analysis. the lda-derived topics were considered as the new features of datasets. the sample-topic matrix ) was treated as a new representation of the original dataset. based on the sample-topic matrix , conventional clustering algorithms, such as k-means, was used for the clustering analysis. the number of clusters was set as  <dig> in the k-means method due to  <dig> different serotypes in the dataset. while in comparison, k-means algorithm was also applied on vsm matrix using hamming distance similarities. for further comparison, due to the dimension reduction of topic modeling approach, the traditional tool of pca was used to reduce features  of vsm matrix followed by the k-means cluster analysis. moreover, clustering by only lda referred as “highest probable topic assignment”  <cit>   was also used for comparison. in “highest probable topic assignment”, the lda-derived topics were made as the clusters of the dataset. then, each sample was assigned to the cluster  with the highest probability in the row of the sample-topic matrix. to interpret the clustering results obtained by the k-means algorithm, samples in each cluster were labeled as the dominant serotype of the samples in the cluster. the predicted labels of samples were compared with the true labels  to evaluate the clustering quality.

the clustering results were evaluated by normalized mutual information   <cit>  and adjusted rand index   <cit> . nmi and ari are two external validation metrics to evaluate the quality of clustering results with respect to the given true labels of datasets. the range of nmi and ari values is 0– <dig>  in general, the larger the value is, the better the clustering quality is.

two commonly used classification algorithms, support vector machine   <cit>  and random forest   <cit> , were applied on the sample-topic matrix obtained by lda with the topic number set to  <dig> and  <dig>  respectively. svm and rf were also applied to the vsm matrix for comparison. accuracy rate was used to evaluate and compare the classification results. since classification is a supervised learning task, training dataset is required to include all of the true labels in the testing dataset. therefore, the new data set for classification consists of  <dig> samples with two serotypes  paratyphi b and stanley samples removed from the original dataset due to the insufficient samples. leave-one-out cross-validation  was conducted on the  <dig> samples and the predicted accuracy rate was calculated. in this study, the function “svm”  in r package “e1071” and function “randomforest”  in r package “randomforest” were utilized to train the classifiers.



RESULTS
in this study, we propose a novel procedure for applying the concept of topic modeling to the analysis and mining of ngs data. assuming that the snps composition  in ngs sequences can be considered and treated as “words”, the original sequence data are transformed to a file of “a bag of words”. a topic modeling procedure is then run on the document file to create two digital matrices, on which various data mining algorithms are applied to reveal the hidden genetic information in the sequences. a ngs data set of  <dig> salmonella outbreak strains was used as a case study to show the workflow and its applications.

procedure
figure  <dig> shows a schematic representation of the proposed procedure to transform the original sequence data to two digital matrices by topic modeling. the data set, first constructed ) by our developed pipeline  <cit> , is described in detail in “methods”. the best flic gene-matching sequences from all of the  <dig> salmonella strains were collected in the dataset ). nucleotides a, t, g, and c are shown by different colors. in the procedures for data preprocessing ), the best flic gene-matching sequences were multi-aligned and the variant nucleotides were found at  <dig> sites in  <dig> strains. all the nucleotides at the  <dig> sites in the  <dig> sequences are designated as snps in this study ). the collection of all the snps in the dataset ) was then transformed into a text corpus, in which each of the  <dig> salmonella strains had its unique file of words ). the final vocabulary size is  <dig> and the obtained corpus had a total of  <dig>  words  from the  <dig> strains.

lda algorithms run on the corpus and generated two digital matrices: fig.  <dig> shows per-topic word distributions; and fig.  <dig> exhibits per-document topic distributions. the two matrices provided vast information pools available for data mining.

topic analysis
lda-derived topics classify a group of words which share the similar characteristics. table  <dig> lists the top  <dig> most probable words in each of the five topics when the number of topics was set to  <dig> . in each topic, the words were shown in the order of the probabilities, from high to low. each topic had its unique word composition, and the top  <dig> words among the five topics were different. each strain had a unique file consisting of various topics and corresponding probabilities . strains of the same serotype exhibited similar topic mixture coefficients . we have grouped the strains by serotypes and calculated the average probabilities of the topics for each serotype . the topic distributions varied with serotypes. three serotypes, typhimurium, typhimurium var. 5-, and  <dig>  <cit> ,12:i:-, harbored only one topic t <dig> ; while the absences of topics t <dig> and t <dig> differentiated the serotype agona from the other eight serotypes. serotype heidelberg was unique, lacking topics t <dig>  t <dig>  and t <dig>  serotype saintpaul distinguished itself from serotypes schwarzengrund and stanley by missing topic t <dig>  the various topic distributions could be used to differentiate serotypes.table  <dig> topic- <dig> most probable words obtained when topic number is set to five

fig.  <dig> the topic distribution among different serotypes when the topic number is set to five. the five topics and the average probabilities for each serotype were calculated and the colored bars represent topics t <dig> to t <dig>  respectively



two-way hierarchical clustering
the two mixtures derived from lda  and ) provided vast probabilities for data mining. hierarchical clustering analysis was first conducted on the strain-topic mixtures ) of all  <dig> strains in the data set to identify the relationships between the strains, serotypes, and the obtained five topics . the heat map shows that the strains with the same serotype were grouped together and all  <dig> strains were clustered into four groups :  <dig> strains of agona expressing f, g, and s factors of the flic gene were clustered in group i;  <dig> strains of serotypes typhimurium, typhimurium var.5- and  <dig>  <cit> ,12:i:- with i factor of the flic gene were clustered together in group iii;  <dig> strains of heidelberg with factor “r” of the flic gene were grouped into group iv; and the six strains from serotypes schwarzengrund, stanley, paratyphi b, and saintpaul were in group ii. the results are consistent with those shown in fig.  <dig>  serotypes agona and heidelberg, as well as the group of three serotypes typhimurium, typhimurium var.5- and  <dig>  <cit> ,12:i:-, have unique and distinguishable topic compositions; while the serotypes schwarzengrund, stanley, paratyphi b, and saintpaul share more or less similar topic compositions. the clustering patterns on the data matrix derived from the topic modeling reflected the genetic truth of the serotype determinant flic gene. according to the cdc’s annual report  <cit> , i  <dig>  <cit> ,12:i:- is the monophasic variant of typhimurium  and lacks the second phase h antigen  <dig> . in surveillance reports, typhimurium var. 5- has been considered an o:5-negative variant of typhimurium or reported as typhimurium  <cit> . strains of all three serotypes express factor i of the flic gene and were classified in one group. figure  <dig> clearly showed not only the topic distributions among serotypes , but also the relationships between the topics. the topic distributions and snps compositions in topics were confirmed to be important features that could be used to characterize bacterial strains and distinguish serotypes.fig.  <dig> two-way hierarchical clustering analysis of the lda-derived strain-topic matrix. the complete-link hierarchical clustering algorithm was applied on the euclidean distance measures of the topics in any two of the strains in the dataset. the heat map shows that the  <dig> strains are clustered into four groups . i: agona; ii: saintpaul, paratyphi b, schwarzengrund and stanley; iii: typhimurium, typhimurium var.5- and  <dig>  <cit> ,12:i:- ; iv: heidelberg. the color histogram from blue to red shows the value of the topic weights of the strains ranged from  <dig> to 1



distance matrix analysis
distance matrix analysis was performed on the lda-derived  strain-topic matrix of the  <dig> strains . colors ranging from blue to red indicate various degrees of similarity of topic mixtures between every pair of strains. the blue squares in the diagonal, which are distinguishable from the other squares, represent concordance among the strains within the same serotypes. all of the  <dig> strains were classified into four subgroups . strains of typhimurium and its variants were grouped into subgroup a, while strains of heidelberg were grouped into subgroup b. the distances of the strains between subgroups a and b are much smaller , compared to the distances to the strains in other subgroups . the results show that serotypes heidelberg, typhimurium and its variants share the same flic factor i and are genetically close to each other. strains of serotype agona were clustered into subgroup d, containing similar topics. the distances of agona strains to other serotype strains are much further. the results shown in fig.  <dig>   <dig> and  <dig> are concordant with each other.fig.  <dig> distance matrix of  <dig> strains with topic number set to  <dig>  the heat map shows the distance matrix performed on topic mixture representations of the  <dig> strains. the color histogram from blue to red indicates various degrees of similarity of topic mixtures between every pair of strains. four groups are visualized. group a: typhimurium, typhimurium var.5- and  <dig>  <cit> ,12:i:-; group b: heidelberg; group c: saintpaul, paratyphi b, schwarzengrund and stanley; group d: agona



we also ran the lda algorithms on the snps corpus with the topic numbers  set to  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig>  respectively, to clarify the effect of topic number variation on the resulted biological importance. data mining was then performed on the obtained strain-topic mixtures representing the snps in the flic gene of  <dig> salmonella strains. figure  <dig> shows the heat map of the distance matrices performed at the lda outputs with various topic numbers. a, b, c, and d represent the same serotype groups as shown in fig.  <dig>  when k is set to two, the groups a and b cannot be separated, and the distance between the groups a/b and c is relatively close ), indicating that the strain-topic matrices are not able to provide sufficient information to distinguish the serotypes included in groups of a, b and c. when k is increased, the blue squares in the diagonal increase and become more differentiated from each other ) until they are stable ). the groups a and b were separated from each other when the topic number was set to three ). when k was increased to  <dig>  the strains in subgroup c were classified into three groups ) representing three groups of serotypes. the strains in group a were classified into two small closely related subgroups when k was set to  <dig> ) or more, indicating the existing two patterns of serotype typhimurium var.5- and  <dig>  <cit> ,12:i:-. the pattern differentiation and subgroup classification remain the same when the topic number is set to  <dig> or more ). therefore, we consider that the strain-topic matrices derived from the lda algorithm best distinguished the serotype-determinant flic gene when the topic number was set to  <dig> for this ngs dataset.fig.  <dig> distance matrix of  <dig> strains with various topic numbers. nine heat maps show the distance matrices when the topic number k is set to  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig> , respectively. the analysis was performed on the topic mixture representations of the  <dig> strains by the same method as shown in fig.  <dig>  the color histogram from blue to red indicates various degrees of similarity of topic mixtures between every pair of strains. four groups are visualized. group a: typhimurium, typhimurium var.5- and  <dig>  <cit> ,12:i:-; group b: heidelberg; group c: saintpaul, paratyphi b, schwarzengrund and stanley; group d: agona



model evaluation
we compared the performance and accuracy of our proposed topic modeling method with hamming method, which is one of the existing methods on sequence similarity analysis, by clustering analysis and classification. table  <dig> shows the nmi and ari values of different methods which were applied to evaluate the clustering results. it is obvious that both nmi and ari measurements were the highest when k-means clustering analysis was applied on lda-derived sample-topic matrix with topic number set to  <dig>  indicating the better accuracy of topic modeling on similarity detection. however, when topic number was set to  <dig>  the clustering quality was not satisfactory due to the insufficient distinguishment among serotypes. the results are consistent with those in fig.  <dig> . the distinction between different serotypes becomes more significant when the topic number increases from  <dig> to  <dig>  five topics were not enough to distinguish the samples with serotypes paratyphi b, saintpaul, schwarzengrund and stanley. therefore, the clustering quality was worse than that when  <dig> topics were applied. in addition, it was noticed that when hamming distance was used to calculate the sequence similarities, pca feature extraction had no obvious effect on the qualities of k-means clustering, comparing the similar ari and nmi values of k-means, pca + k-means, and pca + k-means, inferring that topic modeling was more efficient than pca on this dataset even as a dimension reduction tool. comparing the results of various methods, the method of “highest probable topic assignment” performed the worst, indicating that the highest probable topic only is not sufficient to describe the distinctions among samples.table  <dig> comparison the results of clustering

methoda

 <dig> 
 <dig> 

a
k-means: traditional k-means applying on vsm format of dataset, using hamming distance

pca + k-means: traditional k-means applying on  <dig> feature matrix obtained by pca

pca + k-means: traditional k-means applying on  <dig> feature matrix obtained by pca

lda: “highest probable topic assignment” by lda with  <dig> topics

lda: “highest probable topic assignment” by lda with  <dig> topics

lda + k-means: traditional k-means applying on sample-topic matrix by lda with  <dig> topics

lda + k-means: traditional k-means applying on sample-topic matrix by lda with  <dig> topics

note that pca and pca exhibited better clustering qualities than pca and pca, and are shown in the table

bold numbers indicate the best results among various methods



table  <dig> shows the classification results using both svm and rf algorithms to compare the proposed topic modeling method and hamming method. overall, the lda derived sample-topic matrix with  <dig> topics had higher classification accuracies than the matrix from hamming method. especially, rf algorithm reached 100 % accurate prediction on the sample-topic matrix with  <dig> topics.table  <dig> comparison the results of classification

 <dig> 
1
bold numbers indicate the best results among various methods



biomarker identification and visualization
the lda-derived strain-topic and topic-word matrices could also be combined to analyze the snps in the flic gene. the lda algorithm was run on the text corpus of the flic snps from  <dig> strains with the topic number set to five, resulting in two matrices: strain-topic matrix , and topic-snp matrix . we multiplied the two matrices and generated a new matrix of strain-snps, from which the top  <dig> snps were then collected for each strain. a sketch was plotted to show the dissemination of these highly emerged snps in  <dig> strains . the colored dots represent snps of a, t, c, g, and deletions as well as their locations in the flic gene. the dissemination of the top ten snps for the  <dig> strains was shown to be serotype-dependent. especially, the top  <dig> snps are identical for the strains of the same serotypes of heidelberg, typhimurium group , schwarzengrund and saintpaul. the strains of serotype agona exhibit more diversity on snps dissemination, with a majority of the snps located between 1000–1500 bp. the accuracies of these snps in the  <dig> strains have been confirmed by the sequences from ncbi . the information about the commonalities and diversities in and between serotypes shown in fig.  <dig> provides vast possibilities for potential biomarker discrimination, strain evolution, source tracking, and genomic knowledge interpretation .fig.  <dig> snps differentiation and locations in  <dig> strains. the identified snps and their relative locations in the salmonella flic gene were marked. the red, green, purple, black and grey dots represent a, t, g, c and deletions, respectively



discussion
in this study, we proposed a novel procedure to analyze ngs data and discussed its computational implementation as an integrated tool to analyze a target gene’s diversity from the whole genome sequence reads. the key element of the procedure is the application of topic modeling and its integration with current sequence analysis tools and data mining methods. topic modeling has been widely used in large dataset analysis  <cit> . its algorithms analyse the words of documents to discover the themes that pervade a large collection of documents  <cit> . the rational for incorporating topic modeling on ngs data analysis was based on the fact that the four nucleotides as well as their orders in ngs sequences could be treated as “words”, therefore, the genetic information in sequences was translated and exhibited as “a bag of words”. two matrices generated by the algorithms of topic modeling provide huge potential applications by combining with various data mining methods for different purposes. the main motivation of this study was to develop the text mining and data mining methods of ngs data analysis for better understanding the genetic diversity of bacterial pathogen populations with high rates of nucleotide substitutions.

the salmonella flic gene was used as a case study to show one of the applications of the proposed procedure on genetic diversity and biomarker clarification for bacterial pathogen populations. epidemiological investigations of salmonella infections in humans and animals have depended on serotyping of the cultivated isolates for more than 70 years  <cit> . currently there are more than  <dig>  serotypes within s. enterica and s. bongori due to the various combinations of  <dig> o antigens and 85 h antigens  <cit> . the limitations of traditional serotyping have stimulated the request for developing new dna-based serotyping methods. multiple methods have been investigated for their abilities as a replacement for salmonella serotyping, such as pfge  , ribotyping  <cit> , repetitive extragenic palindromic sequence-based pcr   <cit> , microsphere-based liquid arrays, and multilocus sequence typing   <cit> . these methods are feasible for some serotypes, but lack widespread adoption and might misidentify a newly emergent serotype  <cit> . the nature of unbiased ngs approaches allows numerous applications in comprehensive pathogen detection, infectious disease diagnosis, outbreak investigation and surveillance at a global level  <cit> . however, the latest applications have mostly relied on phylogenetic clustering and comparisons based on whole genome reads  <cit> . it is challenging to globally estimate a targeted functional encoding gene’s diversity in bacterial pathogen populations from whole genome reads. before the cost-effective ngs sequencing technologies became available, this was approached by sequencing pcr-amplified fragments of cultivated isolates, which was indirect, usually biased and inaccurate due to genetic diversity, oligonucleotide primer design, and experimental errors.

the proposed procedure is designed to work on ngs reads or contigs from the ncbi bio-project ngs sequence database  or any other data source, and the specific target gene-related reads or contigs  were retrieved for the following alignment. the snps we identified in this study were different from the original designation, in which all the variations in the same location were included ). therefore, the “bag of snps” ) covered all possible variations in the flic-coding region. these variations, as well as their locations, could be used as characteristics to distinguish strain similarities or identify new mutants . moreover, the original data of atgc sequence reads were transferred into a file of texts on which the text mining/data mining tools can be applied for deep analyses. in the example used in this study, by using the strain-topic matrix derived from topic modeling, we investigated the relationships and similarities between  <dig> strains and nine serotypes by two-way hierarchical cluster analysis and distance matrix analysis . since the salmonella flic is the coding gene for salmonella phase  <dig> antigen, and is considered one of the salmonella serotype determinant genes  <cit> , the diversity of salmonella flic and the relationship with the corresponding serotypes  more accurately reflected gene-phenotype relationships than the whole genome sequence phylogenetic trees. the nucleotide-level salmonella flic gene diversity can be potentially used as the biomarker for serotype screening . the more ngs sequences are added from more strains and serotypes, the higher the accuracy of the biomarker will be.

in this study, gibbs sampling was used to maximize the probabilities of the obtained text corpus. an important property of the gibbs sampling approach is its convergent efficiency. if it takes too many iterations to converge, gibbs sampling approach will not be a feasible tool for real applications. to test if gibbs sampling converged fast in the lda model, we computed the likelihood of the model consisting of both a dirichlet-multinomial for the snps in each topic and a dirichlet-multinomial for the topics in each strain. the formula used for model likelihood is shown in eq.  <dig>  the larger the value of the model likelihood is, the better the model that is obtained. gibbs sampling in lda converges once the value is stable.  <dig> llmodel=∏s=1sΓ∑i=1kaiΓ∑i=1kai+nsi∏i=1kΓai+nsiΓai⋅∏k=1kΓ∑j=1vβjΓ∑j=1vβj+nkj∏j=1vΓβj+nkjΓβj 

here in eq. <dig>  v represents the size of the vocabulary . the first part in right-hand side of eq. <dig> is the dirichlet-multinomial for the topics in s documents and nsi represents the number of topics i picked in document s; the second part in right-hand side of eq. <dig> is the dirichlet-multinomial for the words in k topics and nkj represents the number of words j picked in topic k. the log of eq.  <dig> for every  <dig> iterations was calculated . fig.  <dig> shows the results of the convergence test of gibbs sampling in the lda algorithm with the number of topics set at different numbers. the log likelihood of the model increases fast in the first  <dig> iterations, then becomes stable after about  <dig> iterations . gibbs sampling reaches the convergence around  <dig>  indicating that the running of the lda algorithm is fast to reach the best result. therefore, the proposed procedure and the implemented tool will be a fast, efficient method and workflow for ngs data analysis and data mining.fig.  <dig> gibbs sampling convergence test. the likelihood of the model, consisting of both a dirichlet-multinomial for the snps in each topic and a dirichlet-multinomial for the topics in each strain, was computed when the topic number was set to various numbers. the log of eq.  <dig> of every  <dig> iterations was calculated 



our procedure could be applied on ngs datasets for genetic diversity identification and biomarker development on various functional genes and gene clusters in various biological and biomedical areas. the proposed procedure has implemented the topic modeling algorithms and data mining algorithms in the ngs data analysis, and the resulting sample-topics and topic-words matrices provide huge possibilities for data mining and interpretation. furthermore, the algorithms in the procedure are designed to accommodate billions of ngs reads if the users’ computer capacity allows. therefore, the tool we developed in this study is suitable for overcoming difficulties in big ngs data analysis in biological and medical fields. we expect this procedure to be an efficient tool to cope with high complexity and huge volumes of sequence data for elucidating genetic information, gene-phenotype relationships and biomarker identification. the tool has the potential to give a more complete view of the evolutionary dynamics of the bacterial population.

CONCLUSIONS
we have reported a novel procedure to analyze next-generation sequencing data by introducing topic modeling, which is an active research field in machine learning and has been mainly used as an analytical tool to structure large text corpora for data mining. four major steps are included in this procedure: ngs data retrieval, preprocessing, topic modeling, and data mining using latent dirichlet allocation  topic outputs. the performance was evaluated by a case study of the ngs data set of the salmonella enterica strains. the results illustrate that the implementation of topic modeling in ngs data analysis provides a new way to elucidate genetic information from ngs data, and identify the gene-phenotype relationships and biomarkers, especially in the era of biological and medical big data.

ethics approval and consent to participate
not applicable.

availability of data and materials
the original whole genome sequences of  <dig> strains of salmonella o antigen group b were retrieved from the ncbi database, including  <dig> strains of s. agona,  <dig> strains of s. heidelberg, one strain of s. paratyphi b, two strains of s. saintpaul, two strains of s. schwarzengrund, one strain of s. stanley,  <dig> strains of s. typhimurium, one strain of s. typhimurium var.5-, and one strain of s.  <dig>  12:i:-. the wgs accession numbers, sequence bioproject numbers, and strain names in ncbi database are listed in additional file 1: table s <dig> 

additional files
additional file 1: table s <dig>  metadata of  <dig> samples used in this study. 

additional file 2: table s <dig>  topic mixtures of  <dig> samples with  <dig> topics. 



abbreviations
ariadjusted rand index

blastbasic local alignment search tool

ldalatent dirichlet allocation

loocvleave one out cross validation

mcmcmarkov chain monte carlo

mlstmultilocus sequence typing

msamultiple sequence alignment

ncbinational center for biotechnology information

ngsnext generation sequencing

nminormalized mutual information

pfgepulsed-field gel electrophoresis

rfrandom forest

snpssingle nucleotide polymorphisms

svmsupport vector machine

vsmvector space model

wgswhole genome sequence

competing interests

the authors declare that they have no competing interests.

authors’ contributions

wz  performed all the calculations and data analysis, and wrote the first draft of the manuscript. wz developed the methods, had the original idea, and guided the data analysis and presentation of results. wz, wz , jc, rp, yw, zl, hh, and wt participated the dataset construction and result presentation. wz managed the research and guided the scientific discussing and editing. all authors contributed to data verification, approach evaluation, and assisted with writing the manuscript. all authors read and approved the final manuscript.

