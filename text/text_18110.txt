BACKGROUND
a kinetic model of a biochemical reaction network consists of a set of ordinary differential equations describing the dynamics of the concentrations of all metabolites in the reaction network. most biochemical reaction networks are complex and involve many enzyme-catalyzed processes with non-linear kinetics and intricate stoichiometric and regulatory interactions between the enzymes. consequently, the mathematical models of such networks contain high-dimensional sets of coupled rational differential equations, which sometimes require huge computational effort to analyze. the current state-of-the-art numerical tools for stability analysis, for bifurcation study and for other types of dynamical analysis are known to suffer from a so-called curse-of-dimensionality. for example, the largest biological model that has numerically been analyzed for bifurcation in
 <cit>  consists of  <dig> metabolites and  <dig> parameters and the one in
 <cit>  has  <dig> metabolites. moreover since complex models of biochemical reaction networks involve a huge number of parameters, the task of identifying these parameters  is enormous and requires large datasets. the complexity of this task is further compounded by the fact that often not all the metabolite concentrations can be measured. thus, there is a need for techniques that can reduce a given kinetic model of a biochemical reaction network to a simplified version that mimics the behaviour of the original model satisfactorily, but contains less differential equations and parameters.

for biochemical reaction networks, a number of model reduction techniques are known. see
 <cit>  for a detailed review of some of the well known methods of model reduction. here we list only a few of the known methods in the literature. the singular perturbation method, the time-scale separation technique
 <cit> , the rapid-equilibrium approximation, also known as the quasi-equilibrium approximation  and the quasi steady-state approximation   are the most commonly used techniques. the reduced state vector obtained by any of these techniques contains a subset of the metabolite concentrations  of the full model. härdin
 <cit>  extends the qssa approach by considering the higher-order approximation in the computation of the quasi steady-state. in
 <cit> , some approaches for reduction of complexity in biochemical reaction networks are considered for use in sycamore, which is a computational research environment in systems biology. one of the approaches considered in
 <cit>  is the intrinsic low-dimensional manifold  approach, which is an improved time-scale separation technique. more recently
 <cit> , a computational singular perturbation  algorithm was developed to analyze the time-scales of the nf- κb signaling network which could be used in order to reduce its model. the application of singular perturbation, time-scale separation, quasi equilibrium and quasi steady state approaches to general enzyme-kinetic rate laws, such as michaelis-menten and ping-pong bi-bi is difficult and leads to complicated rate law expressions in the reduced models. some of the time-scale separation techniques are either based on a priori experimental information or eigenvalues of the jacobian corresponding to the model and hence are only locally effective. another recent approach for model reduction uses tropical geometry , wherein the polynomial occuring in every rate equation is replaced by a monomial which is equal to the largest, in absolute value among the monomials that constitute the polynomial.

one of the ways of reducing the complexity of a biochemical model is to reduce the number of parameters in it. this can be done by carrying out a parameter sensitivity analysis  and eliminating those parameters whose variations have least effect on the dynamics of a given network. in
 <cit> , a time-scale analysis is first done using experimental data to identify the fast and the slow metabolites and this information is then used to carry out an a priori parameter sensitivity analysis to obtain a reduced kinetic model of a biochemical reaction network. in
 <cit> , an implicit multiparametric variability analysis  method is used to search the entire parameter space in order to determine the set of parameters that can be eliminated. in
 <cit> , the authors go one step further by identifying a region in the parameter space where some of the parameters are zero-valued, others have readjusted values and where nevertheless the outputs of the original model match those of the reduced model within a certain tolerance. they further show that parameter sensitivity analysis approach for model reduction may not be always successful. another way of reducing the complexity of a biochemical reaction network model is to reduce the number of reactions. in
 <cit> , optimization techniques are used to determine which reactions can be eliminated from the original model without a substantial alteration of the model behaviour.

the method proposed in
 <cit>  simplifies a given chemical reaction network by linearly combining reactions in such a way that the resulting network has lesser number of species. however, the kinetics for the reduced set of reactions are determined by the rate limiting steps in the original network and this requires prior biological knowledge of the network. danø et al. <cit>  propose reduction by identification and elimination of variables in such a way that the basic dynamic properties of the original model are preserved. in
 <cit> , model reduction is achieved by simplifying the rate equations of individual enzymes in the network. a limitation of this method is that it yields a reduced model that predicts measurement data only under specific experimental conditions.

in this paper, we describe a new model reduction method that reduces the number of reactions, metabolites and parameters, such that the dynamics of the metabolite concentrations of the reduced model are close to those of the original model. this method proceeds by a simple stepwise reduction in the number of ‘complexes’, which are defined as the left and right-hand sides of the reactions in the network. the effect of this stepwise reduction is monitored by an error integral, which quantifies how much the behaviour of the reduced model deviates from the original. the method is based on the reduction of the underlying weighted laplacian  describing the graph structure of the complexes and reactions in the chemical reaction network. a similar technique is also employed in the kron reduction method for reduction of resistive electrical network models
 <cit> .

our model reduction technique is easy to implement and can be used to reduce reaction networks governed by a vast majority of enzyme kinetic rate laws including hill kinetics and reversible michaelis-menten kinetics. it does not rely on prior knowledge about the dynamic behaviour or biological function of the network. consequently, it can be automated. furthermore, the reduced model largely retains the kinetics and structure of the original model. this enables a direct biochemical interpretation and yields insight into which parts of the network have the highest influence on its behaviour. it also accelerates computations and facilitates parameter fitting, especially when we deal with models of huge biochemical reaction networks.

we show the application of our model reduction technique to a yeast glycolysis model
 <cit>  and a model of beta-oxidation in rat liver
 <cit> . we have simulated the transient behaviour of the metabolites that are not eliminated during the model reduction procedure. in both the cases, a 30% reduction of the number of variables still retained about  <dig> – <dig> % agreement between the outputs of the full and the reduced networks.

methods
preliminaries
notation: the space of n dimensional real vectors is denoted by
rn, and the space of m×n real matrices by
rm×n. the space of n dimensional real vectors consisting of all strictly positive entries is denoted by
r+n. i
n
 denotes an identity matrix of dimension n. the transpose of a matrix a is denoted by a
t
. define the mapping
ln:r+m→rm,x↦ln, as the mapping for which the i-th component is given by )
i
:=ln. similarly, define the mapping
exp:rm→r+m,x↦exp, as the mapping for which the i-th component is given by )
i
:=exp.
1m denotes a vector of dimension m with all entries equal to  <dig> and dim denotes the dimension of a set v.

chemical reaction network structure
in this section, we introduce the concept of a complex graph which was first introduced in the work of horn & jackson and feinberg
 <cit> . this concept will be used first in deriving our general mathematical formulation of the dynamics of chemical reaction networks, and subsequently to explain our model reduction approach.

let m, c and r denote the number of species , complexes and reactions respectively of a given chemical reaction network. the set of complexes of a network is simply defined as the union of all the different left- and righthand sides  of the reactions in the network. thus, the complexes corresponding to the network in figure
 <dig> are 2x1+x <dig>  x <dig>  x1+2x <dig> and x <dig> 

the expression of the complexes in terms of the chemical species is formalized by an m×c matrix z, whose α-th column captures the expression of the α-th complex in the m chemical species. for example, for the network depicted in figure
 <dig>  

 z= <dig>  

 the matrix z is called the complex stoichiometric matrix of the network. note that by definition all elements of the matrix z are non-negative integers.

since complexes are the left- and righthand sides of reactions in the network, they can be naturally associated with the vertices of a directed graph with edges corresponding to the reactions. formally, the reaction α→β between the α-th  and the β-th  complexes defines a directed edge with tail vertex being the α-th complex and head vertex being the β-th complex. the resulting graph will be called the complex graph.

any graph is defined by its incidence matrixb <cit> . this is a c×r matrix, where c denotes the number of vertices, r denotes the number of edges and the -th element is equal to - <dig> if vertex α is the tail vertex of edge j and  <dig> if vertex α is the head vertex of edge j, while  <dig> otherwise.

the basic structure underlying the dynamics of the vector
x∈r+m of concentrations x
i
,i= <dig> ⋯,m, of the species of a chemical reaction network is given by the balance lawsx˙=zbv; the elements of the vector
v∈rr are commonly called the  rates or fluxes.

in many cases of interest, especially in biochemical reaction networks, chemical reaction networks are intrinsically open, in the sense that there is a continuous exchange with the environment . in this paper, we are particularly interested in inflows to and outflows from the complexes of the network. this will be modeled by a vector
vb∈rc consisting of cboundary  fluxes, leading to an extended model 

  x˙=zbv+zvb 

a linkage class of a chemical reaction network is a maximal set of complexes
{c <dig> …,ck} such that
ci is connected by reactions to
cj for every i,j∈{ <dig> …,k}, i≠j.

general kinetics
for a biochemical reaction network, the relation between the reaction rates and species concentrations depends on the mechanisms of the reactions involved in the network. in this section, we derive a framework for describing the dynamics of enzymatic reaction networks using the aforementioned notion of complex graphs in a reaction network. this framework will be useful in describing our model reduction method. we describe the forward and reverse rates of an enzyme with separate equations.

let
zsj denote the column of the complex stoichiometric matrix z corresponding to the substrate complex
sj of the j-th reaction of a chemical reaction network. then the unidirectional, forward reaction rate of the jth reaction of the chemical reaction network between the substrate complex
sj and the product complex
pj is given by 

  vj=djkjexpzsjtln, 

where for j= <dig> …,r,
dj:r+m→r+ is a rational function of its argument and k
j
 denotes a proportionality constant of the jth reaction of the network. note that if the governing law of the jth reaction is mass action kinetics, then d
j
= <dig> 

as an example, consider the reaction 

  x1+x2→x3+x <dig> 

for i= <dig> …, <dig>  let x
i
 denote the concentration of the species x
i
 and define x:=
t
. in this example, the substrate complex s is x1+x <dig> and the product complex p is x3+x <dig>  the matrices b and z for the reaction  are given by 

 b=-11z= <dig>  

hence
zs is given by
zs=1100t. let k <dig>  k <dig>  k <dig> and k <dig> denote the “michaelis” constants of the species x <dig>  x <dig>  x <dig> and x <dig> respectively. let v
f
 denote the maximum rate of the forward reaction . the expression for the rate of the reaction  depends on the type and mechanism of the reaction, for instance the type of inhibition and other regulatory mechanisms involved in the reaction. one possibility is 

  v=vfk1k2x1x21+x1k1+x3k31+x2k2+x4k <dig>  

by defining
k:=vfk1k <dig>  

 d:=11+x1k1+x3k31+x2k2+x4k <dig>  

 observe that
d:r+4→r+ and equation  can be written as 

 v=dkx1x2=dkexpzstln. 

in additional file
 <dig>  we have provided a list of enzyme-kinetic rate laws that can be written in the form  with d satisfying
d:r+m→r+. note that the form  is retained with a d satisfying
d:r+m→r+ even if there are competitive, non-competitive or uncompetitive modifiers in the reaction network. this is because the terms containing the concentration of the modifiers appear in the denominator of the rate expression in such a way that the denominator assumes positive values for positive values of concentrations of the substrates. for example, if we consider the reaction 

  x1→x <dig> 

governed by michaelis-menten kinetics, with michaelis constant of x <dig> denoted by k <dig> and the maximum reaction rate denoted by v, then 

  v=vx1k11+x1k <dig> 

is the expression for the rate of the reaction . it is easy to see that with
k:=vk <dig> and
d:=1+x1k1- <dig>   has the same form as  and
d:r+2→r+. now assume that the reaction involves a competitive modifier i whose concentration is denoted by i and whose inhibition coefficient is denoted by k
i
. then the rate of the reaction is given by 

  vc=vx1k11+x1k1+iki 

with k defined as earlier and
d:=1+x1k1+iki- <dig> observe that  has the same form as  and
d:r+2→r+. similarly if i is a non-competitive modifier, then 

 vnc=vx1k11+x1k11+iki 

 denotes the rate of the reaction which can again be written in the form  with a d satisfying
d:r+2→r+. if i denotes an uncompetitive modifier, then 

 vuc=vx1k11+x1k11+iki 

 denotes the rate of the reaction which can be written in the form  with a d satisfying
d:r+2→r+.

based on the formulation in  and , we can describe the complete reaction network dynamics as follows. for every σ,π∈{ <dig> …,c}, define 

 cπσ:=j∈{ <dig> …,r}∣= 

 and
aπσ:=∑j∈cπσkjdj. thus if there is no reaction σ→π, then a
π
σ
= <dig>  define the weighted adjacency matrixa of the complex graph as the matrix with -th element a
σ
π
, where σ,π∈{ <dig> ⋯,c}. furthermore, define l:=Δ-a, where Δ is the diagonal matrix whose -th element is equal to the sum of the elements of the ρ-th column of a. hereafter we refer to l as the weighted laplacian of the complex graph associated with the given network with species concentration vector x. it can be verified that the sum of the elements of each column of l is equal to zero and that the vector bv is equal to -lexp). from equation , it follows that the dynamics of enzymatic chemical reaction networks can be compactly written as 

  x˙=-zlexpztln+zvb 

a similar expression of the dynamics corresponding to mass action kinetics, in less explicit form, was obtained in
 <cit> . note that although in equation , exp) is not defined if some of the components of x are equal to zeros, the limit at such an x exists and is used in equation  whenever some of the components of x are equal to zero.

model reduction
for many purposes one may wish to reduce the number of dynamical equations of a chemical reaction network in such a way that the behaviour of a number of key metabolites is approximated in a satisfactory way. we propose a novel method for model reduction of chemical reaction networks governed by enzyme kinetics. our method is inspired by the kron reduction method for model reduction of resistive electrical networks described in
 <cit> ; see also
 <cit> .

description of the method
consider again a reaction network with boundary fluxes and with dynamics modelled by equation . our model reduction method is based on reduction of the complex graph associated with the network. let
 denote the set of vertices of the complex graph. reduction of the model is carried out by deleting certain complexes in the complex graph, resulting in a reduced complex graph. deletion of a complex is equivalent to imposing the complex balancing condition on it, i.e., the condition that the net inflow into the complex is equal to the net outflow from it. consider a subset
vo⊂v of dimension
c-ĉ that we wish to delete in order to reduce the model. consider a partition of l given by 

 l=l11l12l21l <dig> 

where
l11∈rĉ×ĉ,
l12∈rĉ×,
l21∈r×ĉ,
l22∈r× and
vo corresponds to the last part of the indices . consider corresponding partitions of z and v
b
 given by 

 z=z1z2;vb=vb1vb2t, 

in order to rewrite  as 

 x˙=zvb1vb2-zl11l12l21l22expz1tlnexpz2tln 

define
p:= and let
l^ denote the schur complement of l with respect to the indices corresponding to
vo. consider now the auxiliary dynamical system 

 y˙1y˙2=vb1vb2-l11l12l21l22w1w <dig>  

note that complex balancing condition on the complexes in
vo can be imposed by setting the constraint
y˙2= <dig>  this results in the equation 

 w2=-l22-1-l21w1), 

 leading to the reduced auxiliary dynamics 

 y˙1=pvb-l^w <dig>  

 substituting
w1=expz1tln in the above equation and making use of
x˙=z1y˙1+z2y˙2=z1y˙ <dig>  we then obtain the reduced model given by 

  x˙=z1pvb-l^expz1tln. 

note that the reduced model is independent of the order of deletion of complexes. from the following proposition, it follows that
l^ satisfies all the properties of a weighted laplacian matrix of a reaction network corresponding to a complex graph with vertex set
v-vo

proposition <dig> 
consider a chemical reaction network with weighted laplacian matrix
l∈rc×c corresponding to the concentration vector x. let
 denote the set of vertices of the complex graph associated with the network. then for any subset of vertices
vr⊂v, the schur complement
l^ of l with respect to the indices corresponding to
vr satisfies the following properties: 

 <dig>  all diagonal elements of
l^ are positive and off-diagonal elements are nonnegative for
x∈r+m.

 <dig> 
1ĉtl^= <dig>  where
ĉ:=c-dim.

proof
 follows from the proof of ; see also
 <cit>  for the case of symmetric l.  without loss of generality, assume that the last
c-ĉ rows and columns of l correspond to the vertex set
vr. consider a partition of l given by 

  l=l11l12l21l <dig> 

where
l11∈rĉ×ĉ,
l12∈rĉ×,
l21∈r×ĉ and
l22∈r×. it is easy to see that 

 l^=l11-l12l22-1l <dig> 

 since
1ctl= <dig>  we obtain 

 1ĉtl11+1c-ĉtl21=1ĉtl12+1c-ĉtl22= <dig> 

 using the above equations, we get 

 1ĉtl^=1ĉtl11-l12l22-1l21=-1c-ĉtl21+1c-ĉtl22l22-1l21= <dig> 

□

this proves that  describes the dynamics of a chemical reaction network governed by enzyme kinetics, with a reduced number of complexes and with, in general, a different set of boundary fluxes and reactions . an appropriate choice of
vo will ensure that some of the elements of x have derivative zero in  leading to a reduced number of state variables.

the principle behind our model reduction method is to couple the dynamics of certain complexes to the dynamics of the neighbouring complexes or the complexes with which they are connected by reactions. this is done by complex balancing or by equating the net rate of inflow into the complex to the net rate of outflow from it. note that for a reasonably good model reduction, it is important to make the right choice of complexes to be deleted. in the next section, we describe a procedure for making the choice of complexes to be deleted. below, we illustrate our complex balancing procedure for model reduction with the help of an example.

example 1
we consider an example of a simple reversible reaction network and apply the model reduction procedure described in the paper. this reaction network is shown below: 

  x1+x2⇌x3+x4⇌x5+x <dig> 

for i= <dig> …, <dig>  let x
i
 denote the concentration of x
i
. for i= <dig> …, <dig>  let
kmi,i denote the michaelis constant of x
i
 for the first reversible reaction. for i= <dig> …, <dig>  let
kmii,i denote the michaelis constant of x
i
 for the second reversible reaction. let
kfi and
kri denote the forward and reverse rate constants of the first reaction and let
kfii and
krii denote the respective rate constants of the second reaction. note that
kfi:=vfikmi,1kmi, <dig> where
vfi denotes the maximum rate of the first reversible reaction in the forward direction and the other rate constants are similarly defined. define x:=
t
, 

 p1:=1+x1kmi,1+x3kmi,31+x2kmi,2+x4kmi, <dig> p2:=1+x3kmii,3+x5kmii,51+x4kmii,4+x6kmii, <dig>  

as described for the example in the section “general kinetics”, possible rate equations for the network are given by
v1f=kfix1x2p <dig> 
v1r=krix3x4p <dig> 
v2f=kfiix3x4p <dig> and
v2r=kriix5x6p <dig>  where v1f
,v1r
 denote the reaction rates in the forward and the reverse directions respectively of the first reversible reaction and v2f
,v2r
 similarly denote those of the second reversible reaction. if
keqi and
keqii denote the equilibrium constants of the first and the second reversible reactions respectively, then 

 keqi=kfikrikeqii=kfiikrii 

 now consider the reduced network 

 x1+x2⇌x5+x <dig> 

 that is obtained by deleting the complex x3+x <dig> from the network . applying the procedure described in this section, we first assume that the rate of inflow to the complex x3+x <dig> is equal to the rate of outflow from it, i.e. v1f
-v1r
=v2f
-v2r
. this yields 

  x3x4=kfip2x1x2+kriip1x5x6kfiip1+krip <dig> 

by substitution, we obtain the following expression for the overall rate v in the forward direction of the reduced network: 

 v=v1f-v1r=v2f-v2r=kfikfiix1x2-krikriix5x6kfiip1+krip <dig>  

 in the expression for p <dig> and p <dig> in the right hand side of the above equation, we fix x <dig> and x <dig> at their initial values to obtain the following expression for v. 

  v=kfredx1x2-krredx5x61+x1kmred,1+x2kmred,2+x5kmred,5+x6kmred,6+x1x2kmred,12+x5x6kmred, <dig>  

where
kfred,krred,kmred, <dig> kmred, <dig> kmred, <dig> kmred, <dig> kmred, <dig> kmred, <dig> are positive constants that depend on the rate constants and michaelis constants of the original network and the initial values of x <dig> and x <dig>  we remark here that the resulting equation  has again the form of an enzyme kinetic rate equation and the rates in the forward and reverse directions can be written in the form of equation  with a d satisfying
d:r+4→r+. if
keqred denotes the equilibrium constant for the reduced network, then observe that 

 keqred=kfikfiikrikrii=keqikeqii 

 for this example, our procedure yields a reduced model with  <dig> parameters while the original model has  <dig> parameters. moreover while the original model has  <dig> reactions and  <dig> state variables, the reduced model has  <dig> reaction and  <dig> state variables.

error integral
we now describe an automated procedure for making the choice of complexes to be deleted in such a way that the dynamic behaviour of the reduced model is close to that of the original model. we quantify the difference between the dynamical behaviour of the original and the corresponding reduced model under the conditions of a specific dynamic event by an error integral, as defined in this section.

assume that the given biochemical network is asymptotically stable around a steady state. let
ℳi denote the set of species which we consider to be significant from the point of view of experimental design. this set is a subjective choice of the scientist and contains for instance species whose concentrations can be experimentally measured. moreover complexes made of species in
ℳi are not considered for deletion in order to reduce the model. let
n denote the number of elements in the set
ℳi. assume that  is the time interval over which we are interested to observe the difference between the behaviours of the full and the reduced model. we define the error integral  as 

  i:=∑i∈ℳi1tn∫0t1-xirxifdt, 

where x
i
r
 and x
i
f
 denote the concentrations of the ith metabolite of the reduced and the full model respectively at time t. observe that i is dimensionless. the value of i indicates the deviation of the reduced model from the full model averaged over time and species.

in order to reduce a given model of a biochemical reaction network, we first determine the steady state concentration of each of the metabolite of the network. then we rank the complexes to be deleted according to the error integrals corresponding to the reduced model with the respective complex deleted and with the initial values of concentrations of the species of the deleted complexes set at their steady state values. we then make the deletion that leads to the smallest value of i. with the reduced model, we then repeat this procedure. thus we follow an iterative procedure with each iteration consisting of two steps: ranking of complexes to be deleted and deletion of the complex which leads to the smallest error integral. we stop the iteration when the error integral of the reduced model obtained at the end of an iteration exceeds a certain cut-off value. the reduced model obtained at the end of the previous iteration is then considered as the final reduced model.

for the two biochemical models considered in this paper, namely the yeast glycolysis model and the rat-liver fatty acid beta-oxidation model, the cut-off value of the error integral for stopping the iterative model reduction procedure has been set at  <dig> . in general, this cut-off value can be set according to the desired closeness of the reduced model to the original.

difference with qssa
the basic premise of our model reduction approach is similar to the one of quasi steady state approximation . in our method, we assume that some of the complexes attain rapid steady states and hence we equate the rates of inflows to and outflows from such complexes. on the other hand, in the case of qssa, it is rather some of the individual metabolites that are assumed to attain rapid steady states and hence the rates of inflows to and outflows from such metabolites are equated. there are some other subtle differences between our approach and qssa even for the case when the complexes are given by the species, i.e., z is an identity matrix, as shown in the following example. consider the reaction network 

 x1⇌x2⇌x <dig> 

 with reactions governed by reversible michaelis-menten kinetics. as earlier, for i= <dig> , <dig>  let x
i
 denote the concentration of x
i
. for i= <dig> , let
kmi,i denote the michaelis constant of x
i
 for the first reversible reaction. for i= <dig> , let
kmii,i denote the michaelis constant of x
i
 for the second reversible reaction. let
kfi and
kri denote the forward and reverse rate constants of the first reaction and let
kfii and
krii denote the respective rate constants of the second reaction. note that
kfi:=vfikmi, <dig> where
vfi denotes the maximum rate of the first reversible reaction in the forward direction and the other rate constants are similarly defined. define 

 p1:=1+x1kmi,1+x2kmi,2p2:=1+x2kmii,2+x3kmii, <dig>  

now assume that x <dig> attains rapid steady state which, as in the previous example, implies that 

 x2=kfip2x1+kriip1x3kfiip1+krip <dig>  

 if we use qssa method, we first need to solve for x <dig> from the resulting quadratic equation given by 

 x22kfiikmi,2+krikmii,2+x2kfii+kri+kfiix1kmi,1-kfix1kmii,2+krix3kmii,3-kriix3kmi,2-kfix11+x3kmii,3-kriix31+x1kmi,1= <dig>  

let f be a function of two variables such that x2=f defines an admissible  solution of the above equation. then the resulting reaction rate in the forward direction  of the reduced network 

  x1⇌x <dig> 

is given by 

 v=kfikfiix1-krikriix3kfiip1)+krip <dig> x3). 

 the kinetics of the reduced network obtained by application of qssa in this case is no longer enzyme kinetics. in contrast, our model reduction method yields the simple expression 

 v=kfredx1-krredx31+x1kmred,1+x3kmred, <dig> 

 as the overall reaction rate in the forward direction of the reduced network .

if we now consider the following reaction network 

 x1+x2⇌2x3⇌x4+x <dig> 

 governed by the same kind of enzyme-kinetic rate laws as in example  <dig> and assume that x <dig> attains rapid equilibrium, application of qssa is more complicated as compared to the previous case as it involves solution of a quartic equation. on the other hand, our method leads to a simple expression for the overall reaction rate in the forward direction  of the reduced network 

 v=kfredx1x2-krredx4x51+x1kmred,1+x2kmred,2+x4kmred,4+x5kmred,5+x1x2kmred,12+x4x5kmred, <dig>  

when the complex to be deleted in a reaction network is made up of more than one species, qssa cannot be applied in some cases. example  <dig> is one such case. with reference to this example, using equation , one needs to solve for x <dig> and x <dig> in order to apply qssa. however, this is not possible as there is one equation and two unknowns x <dig> and x <dig> to be solved for. thus our model reduction method is more effective in dealing with deletion of complexes made up of more than one species.

effect of model reduction
in this section, we show the graph restructuring of our reduced model in terms of its corresponding full model for three particular types of linkage classes of biochemical reaction networks. note that the deletion of a set of complexes in one linkage class does not affect the mathematical models of the reactions of the other linkage classes of the network.

type  <dig> linkage class:

  full network:c1⇌c2⇌c3⇌⋯⋯⇌cn 

  reduced network:c1⇌c3⇌⋯⋯⇌cn 

consider a linkage class with reversible reactions occuring between consecutive elements of the set of distinct complexes
{c <dig> c <dig> …,cn} as in . the reduced network obtained by deleting the complex
c <dig> is given by , where the two reversible reactions,
c1⇌c <dig> and
c2⇌c <dig> of the full network are replaced by a reversible reaction
c1⇌c <dig> in the reduced network. if the kinetics of the reactions
c1⇌c <dig> and
c2⇌c <dig> are of the same type, the reaction
c1⇌c <dig> of the reduced network has the same kinetics. this has been shown for a particular type of reactions in example  <dig>  the rate equations of all the remaining reactions of the reduced network are the same as those of the full network.

a special case of linkage class  is the following: 

  c1⇌c <dig> 

deletion of the complex
c <dig> in this case is equivalent to deletion of the linkage class from the network. such a deletion provides a close approximation to the original network if the reaction  has very little effect on the dynamics of the network.

type  <dig> linkage class:

  full network 1:⋯c1⇌c2→c3⋯ 

  reduced network 1:⋯c1→c3⋯ 

  full network 2:⋯c1→c2⇌c3⋯ 

  reduced network 2:⋯c1→c3⋯ 

in this type of a linkage class, we have one complex
c <dig> involved in both a reversible reaction and an irreversible reaction as shown in  and . the reversible and the irreversible reactions in which
c <dig> is involved in the full network are replaced with a single irreversible reaction in the reduced network as in  and . the deletion of
c <dig> does not affect the mathematical description of the remaining reactions of the linkage class. as with the previous type of linkage class, if the kinetics of the reversible and irreversible reactions of the full network are of the same type, the reaction
c1→c <dig> of the reduced network has the same kinetics.

type  <dig> linkage class:    

in this type of linkage classes, we have a complex that is involved in more than two reactions as the one shown in . in this example, if we delete the complex
c <dig>  we arrive at the reduced network shown in . this deletion has no effect on the mathematical description of the remaining part of the network. similar to the previous type of linkage classes, the reduced model of this type of a linkage class inherits the kinetics of the full model.

notice that though the number of complexes in the reduced network is less than that of the original network, the number of reactions is the same in both. the reaction constants of reaction  <dig> of the reduced network depends on the reaction constants of reactions  <dig> and  <dig> of the full network; those of reaction  <dig> depend on those of reactions  <dig> and  <dig> and those of reaction  <dig> depend on those of reactions  <dig> and  <dig>  furthermore, deletion of the complex
c <dig> in this case does not lead to a reduction in the number of parameters.

in the next section, we show the application of our model reduction method on a yeast glycolysis model and a beta oxidation model in rat liver. in both these cases, we encounter linkage classes belonging to one of the three types mentioned above.

RESULTS
yeast glycolysis model
we have applied our model reduction procedure on a detailed kinetic model of yeast glycolysis
 <cit> . a schematic representation of the model is shown in the left-hand panel of figure
 <dig>  the corresponding detailed mathematical model can be found in
 <cit> . this network consists of type  <dig> and type  <dig> linkage classes.
 <cit> . the right-hand panel represents the reduced model after deleting  <dig> complexes . the blue arrows in the two panels indicate external fluxes.

for the modelling, we have considered the following as external fluxes as indicated in figure
2: 

 <dig>  uptake of extracellular glucose  into the cell;

 <dig>  conversion of trehalose into intracellular glucose ;

 <dig>  production of trehalose from glucose 6-phosphate ;

 <dig>  production of glycerol from trio ;

 <dig>  production of succinate from pyruvate ;

 <dig>  production of acetate from acetaldehyde ;

 <dig>  production of ethanol from acald.

the model reduction procedure is applied to a glucose upshift as described in
 <cit>  and the corresponding parameter set was chosen
 <cit> . under these conditions, the imposed concentrations of glco are  <dig>  mm and  <dig> mm for t< <dig> and t≥ <dig> respectively, and as observed experimentally the corresponding concentrations of atp are equal to  <dig> mm and  <dig>  mm. it is assumed that the network is at steady state for t< <dig>  it is found that the model is asymptotically stable. the reactions of the network are governed by enzyme kinetics and we can write the equations of the model in the same form as equation . the set of significant species
 for the model consists of glci, trio, bpg, pyr, acald and nadh. figure
 <dig> depicts the minimum error integrals as a function of the number of deleted complexes. since deletion of a sixth complex leads to the error integral exceeding  <dig>  in value, we stop the model reduction process after deletion of five complexes. the order of deletion is f6p, g6p, 2-phosphoglycerate , 3-phosphoglycerate  and phosphoenoylpyruvate . deletion of p3g and p2g produces the same effect as the deletion of complex
c <dig> from a type  <dig> linkage class as described in the section on model reduction. deletion of each of the remaining complexes produces the same effect as the deletion of complex
c <dig> from a type  <dig> linkage class. each deletion results in the shortening of the chain length of the linkage class to which the complex belongs .

it is observed that there is a good agreement between the transient behaviours of most of the metabolites when comparing the original model to the reduced model with five complexes deleted. the main reason for this is that the reactions of the original model that are missing in the reduced one  are the close-to-equilibrium reactions of the network. the concentration of f16bp has a strong effect on enzyme rates, both locally on the reactions in which it is involved, and distantly on the rate of pyruvate kinase . together, this provides a clear explanation why f16bp ends up last in the order of complexes to be deleted . the table of figure
 <dig> gives the convergence times of the six metabolites  that were considered for deletion. these are the times that it takes for the metabolite concentrations to achieve 95% of their concentration change going from one steady state to the other. observe that the order of deletion of the complexes is not the same as the increasing order of their convergence times.

while the original model has  <dig> variables,  <dig> parameters and  <dig> reactions, the reduced model has  <dig> variables,  <dig> parameters and  <dig> reactions. we have provided the matlab files corresponding to the original model, the reduced model and automation of the model reduction procedure for the yeast glycolysis model, as additional files . additional file
 <dig> gives as output the order of deletion of complexes and the error integral at each step of deletion. additional files
 <dig> 
 <dig> 
 <dig> and
 <dig> are matlab files that are required to run additional file
 <dig>  we have submitted to biomodels two sbml files corresponding to the original and the reduced yeast glycolysis models . the evolution of the concentrations of glci, pyr, trio, acald, bpg and nadh is compared between the different stages of model reduction in figure
 <dig> 

fatty acid beta-oxidation model
subsequently, we have applied our model reduction method to a very different type of biochemical network, i.e., a model of fatty-acid beta-oxidation in rat liver
 <cit> . this network mostly consists of type  <dig> and type  <dig> linkage classes. the model is shown schematically in figure
 <dig>  acyl carnitines of even chain lengths are broken down in the mitochondria to produce acetyl coa. the acyl carnitines are first converted to acyl coa’s of the same chain length within the mitochondria by the enzyme carnitine palmitoyl transferase ii. through a series of enzymatic reactions involving the enzymes acyl coa dehydrogenase, crotonase , hydroxyacyl coa dehydrogenase , β-ketothiolase  and mitochondrial trifunctional protein , the carbon chain length of each molecule of acyl coa is shortened by  <dig> at the same time producing one molecule of acetyl coa.
 <cit> .

the carbon chain-lengths of the compounds processed by each of these enzymes is indicated within the ellipses. the full model has  <dig> state variables,  <dig> parameters and  <dig> reactions. the mathematical model is first written in the form . it is found that the model is asymptotically stable. at steady state, each enzyme has a constant reaction flux .

by making use of the biochemical knowledge of the beta oxidation model, an initial reduction of the beta oxidation model has been performed as described below. this procedure holds only for this particular model and is not obtained by an automated deletion of complexes. it can be seen from figure
 <dig> that certain acyl coas having the same carbon chain lengths can be dehydrogenated by multiple enzymes, for example c <dig> acyl coa can be dehydrogenated by three enzymes mcad, lcad or vlcad. by checking the steady state fluxes of the same reaction through these different enzymes, we can reduce the model. for example, we found that the flux of dehydrogenation of c <dig> acyl coa by mcad is  <dig> times that by scad. thus the model can be reduced by assuming that c <dig> acyl coa is dehydrogenated by mcad alone and not by scad. similarly, we found that the model can be further reduced by assuming that c <dig> acyl coa is dehydrogenated by scad alone and c <dig> acyl coa is dehydrogenated by mcad alone as the dehydrogenation fluxes of these compounds via other enzymes is comparatively very low.

subsequently, we performed a further reduction of the beta oxidation model by deletion of certain complexes according to the procedure described earlier. it can be seen from figure
 <dig> that the shortening of chain length of acyl coas of chain lengths  <dig>   <dig>   <dig>   <dig> and  <dig> can happen via two routes, i.e. either via the enzyme mtp or via the sequence of enzymes crotonase, m/schad and mckat. deletion of the complexes hydroxyacyl and ketoacyl coas of even chain lengths between  <dig> and  <dig> is equivalent to having all acyl coas of chain lengths  <dig> till  <dig> reduced by only the first route. it is found that such a deletion produces a reduced model which has a very similar transient behaviour as the full model. the observation that the steady state fluxes through the first route is about a hundred times larger than the steady state fluxes through the second route explains the fact that removal of the second route does not have much effect on the dynamics of the rest of the system.

note that the shortening of chain length of acyl coas of chain lengths  <dig> and  <dig> happens only via the sequence of enzymes crotonase, m/schad and mckat. it is found that the combined effect of enzymes crotonase and m/schad can be produced by a single fictitious enzyme which we have termed as crms. this is done by deleting the complexes c <dig> hydroxyacyl coa and c <dig> hydroxyacyl coa. again such a deletion has a negligible effect on the dynamics of the rest of the system.

each of the  <dig> deletions of complexes mentioned above produces the same effect as the deletion of the complex
c <dig> from a type  <dig> linkage class as described in the section on effect of model reduction. deletion of hydroxyacyl and ketoacyl coas of even chain lengths between  <dig> and  <dig> is equivalent to removal of the linkage classes to which they belong. deletion of c <dig> and c <dig> hydroxyacyl coa is equivalent to reducing the number of reactions in the linkage class to which they belong, which in turn is equivalent to replacing the enzymes crotonase and m/schad with a single enzyme crms.

the set of significant species
 for the model consists of all the acyl carnitines in the cytoplasm and the mitochondria, since these have been measured for the original model validation
 <cit> . figure
 <dig> depicts the values of minimum error integrals vs the number of complexes deleted in order to obtain a reduced model of beta oxidation. it can be seen that when the fourteenth complex is deleted from the model, the minimum error integral is more than  <dig> . therefore as discussed earlier, we stop our model reduction procedure after deletion of  <dig> complexes. the first  <dig> complexes that are deleted are the ones that were mentioned in the previous paragraphs in addition to c <dig> acyl coa. deletion of c <dig> acyl coa produces the same effect as the deletion of the complex
c <dig> from a type  <dig> linkage class as described earlier. this deletion does not lead to a reduction in the number of reactions or parameters; only the number of complexes is reduced. in the following we show the local effect of deletion of c <dig> acyl coa schematically.   

the reduced model obtained by incorporating all the deletions mentioned above except the deletion of the complex c <dig> acyl coa is depicted in figure
 <dig>  it has  <dig> state variables,  <dig> parameters and  <dig> reactions while the full model has  <dig> state variables,  <dig> parameters and  <dig> reactions. it is found that the transient behaviour of all the state variables of the reduced model with  <dig> complexes deleted are in good agreement with those obtained using the full model. both the original and the reduced model have been provided as additional files . an sbml file corresponding to the reduced model has been submitted to biomodels . figure
 <dig> depicts the comparison of the transient behaviours of the concentrations of all the acyl carnitines in the cytoplasm.

discussion
our model reduction method involves rewriting of the complex graph corresponding to a given network. in the literature, there are other model reduction methods that involve graph rewriting like qssa and quasi-equilibrium procedures, the method of
 <cit>  and the graph rewriting of monomolecular reaction networks described in
 <cit> . the difference between these methods and ours is that these involve rewriting of the species-reactions graph unlike ours where the complex graph is rewritten.

in order to come up with a reasonably good reduced model, we follow an iterative procedure as described in the subsection titled “error integral”. this iterative procedure involves computation of error integrals of a number of reduced models which are obtained by deletion of different combinations of complexes. in the beta-oxidation example, where the original model consists of  <dig> species and the reduced one has  <dig> species, the required number of simulations is +++⋯+ where m is the number of species that must still be present in the reduced model . in our example, m= <dig>  and the total simulations using our procedure are  <dig>  more precisely, if there are n number of species, m number of important species and if l is the dimension of the reduced species, then the total number of simulations is
∑i=ln=l+n2-m. although our procedure is time consuming, it is simple and systematic, ensures that the reduced model closely mimics the transients of the original model and is scalable to a large model. we are currently investigating the computation of error bounds based on the algebraic property of the laplacian matrices and we foresee that this knowledge might allow us to directly obtain the optimal set of complexes to be deleted.

the cut-off value of the error integral at which we stop our iterative model reduction procedure can be set according to the desired closeness to the original model. for the two models discussed in this paper, this value has been set at  <dig>  and it has been found that if this value is set at  <dig> , then the resulting comparison plots of the transient behaviours of the original vs the reduced models reveal significant visual differences. another method of coming up with a cut-off value for the error integral is to look for a sudden, steep increase in the error integral histogram. however in the case where the error-integral histogram shows uniform increase with an increase in the number of complexes deleted, this method cannot be used.

note that in principle, complexes can be deleted to reduce any biochemical model, whether asymptotically stable or not. however, for the computation of error integral as described in the paper, it is necessary that the original network is asymptotically stable around a steady state, since the computation makes use of the steady state concentrations of some species of the network.

in some cases, deletion of certain complexes can drastically change the dynamics of the system. an example is the following. assume that x <dig> x <dig> …,x <dig> are distinct species of the network. consider the following reaction network consisting of three reversible reactions: 

 x1+x2⇌x3+x4x4+x5⇌x6+x7x7+x8⇌x9+x <dig> 

now consider deletion of the complex x4+x <dig> from the above reaction network. this deletion leads to the deletion of the second reaction of the network. since the first and the third reaction of the network do not have common species, deletion of the second reaction leads to the first and the third reactions occuring independently of each other. this will lead to the reduced model exhibiting a behaviour which is not close to the behaviour of the original model. although one can quantify the difference between the behaviours using error integrals, avoiding such deletions will reduce the computational effort in making the choice of complexes to be deleted. examples of such deletions are deletion of complexes trio or bpg in the yeast glycolysis model and deletion of complex c <dig> acyl carnitine in the beta oxidation model.

we remark here that one should update a reduced model when major changes are made to the original model. for example, if we consider the rat liver beta-oxidation model of a mcad-deficient animal, this model will not have the enzyme mcad. in this case, the dynamic behaviour of the reduced model of figure
 <dig> may be far from that of the original model of figure
 <dig> without the enzyme mcad.

CONCLUSIONS
in this paper, we have outlined a method for model reduction of biochemical reaction networks that are asymptotically stable around a steady state. the principle behind our model reduction method is to couple the dynamics of certain complexes to the dynamics of the neighbouring complexes in such a way that the net rate of inflow into the complex is equal to the net rate of outflow from it. we provide an algorithm for choosing the complexes to be deleted in such a way that the transient behaviour of the significant species of the reduced model is close to that of the original model. apart from a reduction in the number of state variables, our model reduction method also leads to a reduction in the number of reactions and parameters of the model. this in turn leads to an improved computational effort required in order to analyze the model. our model reduction procedure ensures that the reduced model mimics the full model well under the conditions of a specific dynamic event. a different reduced model with a different set of deleted complexes may be produced by our procedure under the conditions of a different dynamic event.

in additional file
 <dig>  we give a list of some well-known enzyme kinetic rate laws for which our model reduction method is applicable. some of the rate laws provided in this list are rate laws for irreversible reactions. however our method is also applicable for the reversible version of these rate laws. this is because a reversible reaction can be split into its forward and reverse reaction components and if our method is applicable to each of these components then it is applicable to the given reversible reaction. for example, since our method is applicable to reactions governed by irreversible mass action kinetics, it is also applicable for reactions governed by reversible mass action kinetics. the list provided in additional file
 <dig> is not an exhaustive list of all enzyme kinetic rate laws for which our method is applicable. we have checked that our method is applicable to all the rate laws that are included in the copasi software
 <cit> .

we have applied our method on a yeast glycolysis model and a beta-oxidation model in rat liver and have observed a good agreement between the transient behaviours of the original and the reduced models. in these cases, our model reduction method has also helped us significantly in improving our understanding of the dynamics of the networks, for example by identification of the close-to-equilibrium reactions of the yeast glycolysis model and of the reaction pathways with comparatively low fluxes in the rat liver beta-oxidation model. in the case of the yeast glycolysis model, we found that the order of deletion of complexes  is not the same as the order of their convergence times. this shows that in this case, our model reduction approach will perform differently from a time-scale separation technique where metabolites with faster convergence times are assumed to attain rapid steady state. as observed in the two examples of metabolic reaction networks, our model reduction method helps in removing redundancies in the given network .

recently, there has been an interest in kinetic modelling of large genome-scale networks. for example,
 <cit>  gives a method for building a parameterized genome-scale kinetic model of a network consisting of  <dig> reactions and  <dig> metabolites. we envisage that our model reduction method will be particularly useful to reduce the complexity of such large genome-scale kinetic models in the future. likewise, it can also be useful in reducing multiscale models of biochemical reaction networks which are computationally burdensome to analyze. in a large-scale kinetic model of a biochemical reaction network, our model reduction method can be used to reduce all pathways except the ones of interest into which we would like to zoom-in and analyze.

currently, we are using our reduced model of the rat liver beta-oxidation model that we explained in an earlier section in order to check for possible bifurcations. in this respect, the reduced model provides an advantage over the full model as it requires lesser computational effort while checking for bifurcation.

ethics
the authors declare that no experiments have been performed as part of the research for this manuscript.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
ajvds, sr and bj conceived the idea of model reduction. ajvds prepared a first draft of some of the subsections under the “methods” section. bmb conceived the idea of stepwise automated reduction procedure. kve provided the original models of yeast glycolysis and rat liver beta oxidation. sr and bj carried out reduction of these models. sr prepared the manuscript with the help of bmb and bj. all authors read and approved the final manuscript.

supplementary material
additional file 1
enzyme kinetic rate laws for which our model reduction method is applicable.

click here for file

 additional file 2
original yeast glycolysis model.

click here for file

 additional file 3
reduced yeast glycolysis model.

click here for file

 additional file 4
automation of our model reduction procedure for the yeast glycolysis model.

click here for file

 additional file 5
reduced yeast glycolysis model with a prespecified number of deleted complexes.

click here for file

 additional file 6
a matlab file required to run additional file  <dig> 

click here for file

 additional file 7
a matlab function for computing the final steady state with given initial conditions.

click here for file

 additional file 8
a program to compute the error integral between the original and a given reduced model of the yeast glycolysis.

click here for file

 additional file 9
original model of rat liver beta oxidation.

click here for file

 additional file 10
reduced model of rat liver beta oxidation.

click here for file

 acknowledgements
we thank dr. guy-bart stan and juan kuntz for their critical comments on an earlier draft of the manuscript. we also thank the reviewers of this manuscript for patiently going through it and providing suggestions to improve its readability. their comments have helped us in improving the quality of the manuscript. this work was funded by the netherlands organization for scientific research  to the systems biology centre for energy metabolism and ageing. ajvds received funding from the european union seventh framework programme  under grant agreement no. <dig> hycon <dig> network of excellence. kve has been funded by the netherlands genomics initiative via the netherlands centre for systems biology and by the top institute food and nutrition. bmb received a rosalind franklin fellowship from the university of groningen.
