BACKGROUND
recently, biomedical researchers have considered the impact of genomics variations on human diseases as it provides valuable insight into functional elements and disease-causing regulatory variants . specific focus is drawn on copy number variation , which is a form of structural variation of the dna sequence, including multiplication and deletions of a particular segment of dna   <cit> . the interest and importance of cnvs has risen in a wide collection of diseases including parkinson  <cit> , hirschsprung  <cit> , diabetes mellitus  <cit> , autism , alzheimer  <cit> , schizophrenia  <cit>  and cancer  <cit> . specifically, significant effort has found associations between cnvs and cancers . cancer is well known as a disease of genome and genomic aberrations of interest in cancer are mostly somatic aberrations, since tumors arise from normal cells with acquired aberrations in their genomic materials  <cit> . cnv is one of the most important somatic aberrations in cancer , since oncogene activation is often attributed to chromosomal copy number amplification, and tumor suppressor gene inactivation is often caused by either heterozygous deletion associated with mutation or by homozygous deletion. thus identification of somatic cnv can have an important role in cancer prognosis and treatment improvement  <cit> .

array-based technologies have been used widely since late 1990s for more than a decade as an affordable and relatively high-resolution assay for cnv detection  <cit> . however, array-based technologies have limitations associated with hybridization, which results in poor sensitivity and precision; and with resolution, related to the coverage and density of the array’s probes. with the arrival of next generation sequencing  technologies  <cit> , sequence-based cnv detection has rapidly emerged as a viable option to identify cnvs with higher resolution and accuracy  <cit> . as a result, recently whole-genome sequencing  and whole-exome sequencing  have become primary strategies for ngs technologies in cnv detection and for studying of human diseases. in most cases, cnvs are identified from wgs data. yet, wgs is considered too expensive for research involving large cohort and wes, which is targeted to protein coding regions , is becoming an alternative, cost-effective strategy  <cit> . even though wes has several technical issues  <cit> , it has been emerged as one of the most popular techniques for identifying clinically relevant aberrations in cancer  <cit> . wes, can offer lower cost, higher coverage, and less complex data analysis, which are appealing for clinical application when there are several samples. exome represents a highly function-enriched subset of the human genome, and cnvs in exome are more likely to be disease-causing aberrations than those in nongenic regions  <cit> .

many tools have been developed for cnv detection using wgs data. however, these methods are not suitable for wes data since their main assumptions on read distributions and continuity of data do not hold. in addition, wes data introduce biases due to hybridization, which do not exist in wgs data and are not considered in the cnv detection methods. on the other hand, germline and somatic cnvs are very different in their overall coverage of the genome and their frequency across population; and they need to be identified differently. the characteristics of somatic cnvs need special consideration in algorithms and strategies in which germline cnv detection programs are usually not suited for. in general, germline cnvs cover small portion of the genome   <cit> , they are more deletion, and they are common among different people. however somatic cnvs can cover a majority part of a genome, can be focal, and are unique for each tumor. as a result cnv detection methods that are developed for identifying population cnvs or germline cnvs cannot be used for identifying somatic aberrations. also, identifying somatic cnvs in cancer is very challenging because of the tumor heterogeneity and complexity: tumor samples are contaminated by normal tissue, the ploidy of tumors is unknown, and there are multiple clones in tumor samples. on top of the tumor samples’ complexity there are experimental, technical and sequencing noise and biases which makes somatic cnv detection very challenging.

even though many cnv detection tools and methods have been developed since introducing ngs data, there are few tools available for somatic cnv detection for wes data in cancer. because of the popularity of wes in cancer studies and challenges of detecting somatic cnv using wes data, in this study we focus on cnv detection methods and tools for wes data in cancer. the objectives of this study are addressing the limitations of the current tools and methods and providing guidelines for developing new ones. in this work first, we briefly explain the cnv detection methods and challenges for wes data and then introduce the recent cnv detection tools for wes data. then we present the performance analysis of the tools in terms of sensitivity and specificity of detecting true cnvs, using real data and simulated data.

methods
cnv detection methods
in general there are three main approaches to identify cnv from next generation sequencing data: 1) read count, 2) paired-end, 3) assembly  <cit> . in the read depth  approach mostly a non-overlapping sliding window is used to count the number of short reads that are mapped to a genomic region overlapped with the window. then these read count values are used to identify cnv regions. due to reducing the cost of sequencing and improving the sequencing technologies more and more high-coverage ngs data are available; as a result, rd-based methods have recently become a major approach to identify cnvs. paired-end  approach, which are applied to paired-end ngs data, identifies genomics aberration based on the distances between the paired reads. in paired-end sequencing data, reads from the two ends of the genomics segments are available. the distance between a pair of paired-end reads is used as an indicator of a genomics aberration including cnv. a genomic aberration is detected when the distance is significantly different from the predetermined average insert size. this approach is mostly used for identifying other type of structural variation  such as inversion and translocation. in the assembly approach short reads are used to assemble the genomics regions by connecting overlapping short reads . cnv regions are detected by comparing the assembled contigs to the reference genome. in this methods short reads are not aligned to the reference genome first. since in wes targeted regions are exonic regions, they are very short and discontinuous across the genome. as a result, the pe and assembly approaches for identifying cnvs are not suitable for wes data. also high coverage of wes data makes the rd approach more practical. therefore, all cnv detection tools for wes are based on the rd approach.

in general, the rd approach consist of two major steps: 1) preprocessing, and 2) segmentation. the input data are aligned short reads in bam, sam or pileup formats. in the preprocessing step, wes data’s biases and noise are eliminated or reduced. normalization and de-noising algorithms are the main components of this step. in the segmentation step a statistical approach is used to merge the regions with the similar read count to estimate a cnv segment. the most commonly used statistical methods for segmentation are circular binary segmentation  and hidden markov model . in cbs, the algorithm recursively localizes the breakpoints by changing genomic positions until the chromosomes are divided into segments with equal copy numbers that are significantly different from the copy numbers from their adjacent genomic regions. in hmm the read count windows are sequentially binned along the chromosome according to whether they are likely to measure an amplification, a deletion, or a region in which no copy number change occurred. even though other statistical methods have been introduced for detecting cnvs from wgs data, these two methods are the most common methods that are used in the current cnv detection tools for wes data.

challenges for detecting somatic cnvs in cancer
despite improvements to sequencing technologies and cnv detection methods, identifying cnv is still a challenging problem. complexity of tumors and technical problems of wes add more challenges to identifying somatic cnvs from wes data in cancer  <cit> . in this section we briefly explain the challenges that somatic cnv identification are faced with in cancer when using wes data. we divide these challenges into three classes: challenges due to 1) sequencing data, 2) wes technical problems, and 3) tumor complexity.

challenges due to sequencing data
the main assumption of the rd based cnv detection algorithms is that the read counts and cnv for a particular region are correlated. however, there are biases and noise that distort the relationship between the read count and copy number. these biases and noise include gc bias, mappability bias, experimental noise, and technical  noise. gc content varies significantly along the genome and has been found to influence read coverage on most sequencing platforms  <cit> . in the alignment step, a huge number of reads are mapped to multiple positions due to the short read length and the presence of repetitive regions in the reference genome  <cit> . these ambiguities in alignment can produce unavoidable biases and error in rd based cnv detection methods  <cit> . furthermore, sample preparation, library preparation and sequencing process introduce experimental and systematic noise that can hinder cnv detection  <cit> .

challenges due to wes technical problem
the exome capture procedure in the library preparation process for wes introduces biases and noise that distorts the relation between read count and cnv. in the wes library preparation, the hybridization process produces biases. in addition, the distribution of read in the exonic regions is not even, which is another source of bias  <cit> . it is very common that in some genomic regions the read count is very low. this low read counts affect the statistical analysis for calling cnvs and as a result produce noise in the cnv detection algorithms.

challenges due to tumor complexity
complexity of cancer tumor also distorts the relationship between read count and cnv and as a result produces noise. the tumor complexity includes tumor purity, tumor ploidy, and tumor subclonal heterogeneity. tumor samples are mostly contaminated by normal cells. therefore, mapped read on a particular region are not all belong to tumor cells. as a result, read count values do not completely reflect copy number of tumor cells and the tumor normal copy number ratio is less than the real value. this introduces difficulties in calling copy number segments. a threshold for calling cnv will depend on tumor purity, which is usually unknown. there are a few tools available to estimate tumor purity  <cit> . aneuploidy of the tumor genome is observed in almost all cancer tumors  <cit> , which creates difficulties in determining the copy number values. the normal tumor read count ratio is corresponding to the average ploidy, which is usually unknown in the tumor sample. it is observed that multiple clonal subpopulations of cells are present in tumors  <cit> . due to their low percentage in a sample, it is hard to determine the subclones. this intra-tumor heterogeneity or multiple clonality distorts the cnv and makes calling cnv segments complicated.

cnv detection tools
as of august  <dig>  we have identified fifteen sequence-based cnv detection tools  for wes data. several studies have already evaluated and compared the performance of cnv detection tools for wes data  <cit> . however, the focus of their work has not been on cancer. in this work, we restricted the analysis and comparison of cnv tools to those that have been used or have the ability to detect cancer specific aberrations . due to the fast advancing sequencing technologies, we also focused on the widely used and more recent tools. out of the available cnv detection tools for wes data, we chose the tools that fit the criteria of  ability to detect somatic aberration,  using read depth  method and  was published in the recent years or commonly used. six tools meet the above criteria:  adtex  <cit> ,  contra  <cit> ,  cn.mops  <cit> ,  exomecnv  <cit> ,  varscan <dig>  <cit> , and  convex  <cit> . adtex and convex were developed by the same group using a similar method, which adtex is the modified version of the convex. as a result, we only considered adtex. more recent tools, such as canoes  <cit> , exomdepth  <cit> , and cnvcapseq  <cit> , are not used specifically for cancer; therefore we did not consider them in this study. the list of the tools that we considered in this study and their general characteristics are provided in table  <dig> table  <dig> selected tools for the performance analysis of cnv detection tools using wes data

http://adtex.sourceforge.net
https://sourceforge.net/projects/contra-cnv/
http://www.bioinf.jku.at/software/cnmops/cnmops.html
https://secure.genome.ucla.edu/index.php/exomecnv_user_guide
http://varscan.sourceforge.net/

asegmentation is not imbedded in the tool. cbs is recommended for segmentation


bcorrelation matrix diagonal segmentation


cdiscrete wavelet transform


db allele frequencies




adtex  <cit>  is specifically designed to infer copy number and genotypes using wes from paired tumor/normal samples. adtex uses both read count ratios and b allele frequencies  to detect cnv along with their genotypes. it addresses the problem of tumor complexity by employing baf data, if these data are available. for normalization, adtex first calculates the average read count of exonic regions for both tumor and normal, and then computes the ratios of read counts for each exonic region. adtex also uses the discrete wavelet transform approach as a preprocessing step to reduce the noise of read count ratio data. it uses the hmm method for segmentation and cnv call. two hmms are used in the detection algorithm: one to detect cnvs in combination with baf signal to estimate the ploidy of the tumor and predict the absolute copy numbers, the other to predict the zygosity or genotype of each cnv segment. when the bafs of tumor samples are available, they fitted the hmm for different base ploidy values. to determine the base ploidy, adtex selects the snps which overlaps with each exonic region, segments bafs using cbs algorithm, estimates b allele count for different ploidy levels, and finally uses the distances between b allele counts to provide the best fit for base ploidy.

contra  <cit>  is a method used for cnv detection for targeted resequencing data, including wes data. it is designed to detect cnv for very small target regions ranging between  <dig> to 200 bp. the main difference between contra and the other method is that it calculates and normalizes the read count and log ratio for each base . this allows for better gc normalization and log ratio calculations for low coverage regions. after calculating base-level log ratios, it estimates region-level log ratios by averaging the base-level log ratios over the targeted regions . then, it normalizes the region-level log ratios for the library size of control and normal samples. the significant values of the normalized region-level log ratios are calculated by modeling region-level log ratios as normal distribution. for detecting large cnvs spanning multiple targeted regions , contra performs cbs on region-level log-ratios. to call a cnv segment, at least half of the segment has to have overlap with the significant region-level cnvs. this method addresses the problems of some very low coverage regions and sequencing biases , which are due to uneven distribution of reads in wes.

the main difference between cn.mops  <cit>  and other tools is that it can use several samples for each genomics region to have a better estimate of variations and true copy numbers. cn.mops uses non-overlapping sliding window to compute read counts for genomic regions. to model read count, it employs a mixture of poisson distribution across the samples. the model is used to estimate copy number for each genomic region. cn.mops does not calculate ratios of case and control. instead it uses a metric that measure the distance between the observed data and null hypothesis, which is all samples have copy number of  <dig>  if cnv differs from  <dig> across the sample, the metric is higher. this metric is used for segmentation by cbs per sample. at each genomic position, cn.mops uses the model of read counts across samples, so it is not affected by read count alteration along chromosomes. by using baysian approach, cn.mops can estimate noise and so it can reduce the false discovery rate .

exomecnv is designed specifically for wes data using pairs of case-control samples such as tumor-normal pairs. it counts the overlapping reads for exons; and by using these read counts for tumor and normal, it computes the ratio of read counts for each exonic regions. hinkley transformation  is used to infer the normal distribution for the read count ratios. after finding ratios of tumor and normal for exonic regions, cbs is used for segmentation. if the tumor purity is given in advance, exomecnv will use it to compute copy numbers. it also can detect loss of heterozygosity  if baf data is given. exomecnv divides the average read count by the overall exome average read count to normalize the average read count per exon.

varscan <dig>  <cit>  is also specifically designed for the detection of somatic cnvs in wes from tumor–normal pairs. to compute the read counts of bases, the algorithm considers only high quality bases  for tumor and normal samples individually. it does not use a sliding window or exons to generate read count data. instead, it calculates tumor to normal read count ratios of the high quality bases that full fill the minimum coverage requirement. then, in each chromosome, consecutive bases that their tumor to normal read count ratios do not change significantly, based on the fisher’s exact test, are binned together as a genomic region to generate read count data. for each genomic region, copy number alterations are detected and then are normalized based on the amount of input data for each sample. a segmentation algorithm in not embedded into the varscan <dig> tool and cbs algorithm is recommended for the segmentation of the genomic regions.

data sets
in this work, we used real and simulated wes data to evaluate cnv tools’ performances.

real data
we used ten breast cancer patient tumor-normal pair wes datasets from the cancer genome atlas  to evaluate the performance of the cnv detection tools. the list of samples is given in the additional file 1: table s <dig>  the wes data were generated by the illumina genome analyzer platform at washington university genome sequencing center . the aligned bam files of these  <dig> samples  were downloaded from the cancer genomics hub , https://cghub.ucsc.edu/index.html. we also used array-based cnv data from the same  <dig> tumor samples as a benchmark for the cnv detection tools evaluation. we downloaded snp-array level  <dig> data from the affymetrix genome-wide snp <dig> platform from the tcga data portal website  for the  <dig> tumors.

simulated data
to evaluate the performance of the tools, we have also used benchmark datasets generated by a cnv simulator, called varsimlab  <cit> . varsimlab is a simulation software tool that is highly optimized to make use of existing short read simulators. reference genome in fasta format and sequencing targets  in bed format are inputs of the simulator. a list of cnv regions that are affected by amplifications or deletions is randomly generated according to the simulation parameters. the cnv simulator manipulates the reference genome file and the target file before generating short reads that exhibit cnvs. the output consists of:  a list file that contains the synthesized amplifications and deletions in txt format,  short reads with no cnvs as control in fastq format, and  short reads with synthesized cnv as case in fastq format.

we used varsimlab to generate simulated short reads of length 100 bp for chromosome  <dig>  we generated synthesized datasets with 3 m, 2 m, 1 m,  <dig>  m,  <dig>  m,  <dig>  m,  <dig>  m reads to simulate different coverage values . for each coverage value, we generated  <dig> datasets . these simulated data with known cnv regions were used to evaluate the performance of the cnv detection tools in terms of sensitivity and specificity for identifying cnv regions.

comparison methods
to evaluate the performance of the tools in terms of sensitivity, false discovery rate  and specificity for detecting cnvs we compared their detected cnvs with the benchmark cnvs. for this comparison, we utilized two approaches: 1) gene-based comparison, and 2) segment-based comparison. gene-based comparison analysis indicates the performance of the tools on calling cnvs only on exonic regions, which are the targets of the wes. however, segment-based analysis indicates the performance of the tools on overall calling cnv segments across the genome.

gene-based comparison
for the gene-based comparison, we first annotated the detected cnv segments in the benchmark and samples for both real data and simulated data. we used “cghmcr” r package from bioconductor  <cit>  to identify cnv genes using refseq gene identifications. the average of the cnv values of the overlapping cnv segments for each gene is used as the gene cnv value. a threshold of ± thr for log
2
ratios was used for calling cnv genes, that is: amplification for log
2
ratios > thr, deletion for log
2
ratios < − thr, and no cnv for log
2
ratios between - thr and thr.


for each tool, we computed sensitivity, specificity and fdr separately for amplification and deletion. if we name the detected cnv value for a specific gene as cnvtest and the benchmark cnv value of the gene as cnvbench, then we can define true positive , false positive , true negative  and false negative  for amplified and deleted genes as given in table  <dig> table  <dig> computing tp, fp, tn and fn for gene-based comparison of the performance of the tools

cnvtest > thr
tp
fp
cnvtest < thr
fn
tn
tp
fp
fn
tn



the sensitivities or true positive rates , specificities  and fdrs are calculated using the following equations for both amplified and deleted genes.  <dig> tpr=tptp+fn, 
  <dig> fdr=fptp+fp, 


and  <dig> spc=tnfp+tn 


for each tool we calculated tprs, spcs, and fdrs of the tools for all datasets and used their average values.

segment-based comparison
for the segment-based comparison, we focused on comparing the cnv segments between detected cnvs and benchmark cnvs. similar with the gene-based cnv comparison, we used a threshold  to call amplified, deleted and no cnv segments. comparing cnv regions between detected cnvs and their corresponding benchmark cnvs is more complicated than comparing cnv genes. detected cnv segments, unlike cnv genes, have different sizes and different start and end positions compared to those of benchmark cnv segments. we used “genomicranges” r package from bioconductor  <cit>  to obtain overlapping regions between detected cnvs and benchmark cnvs. if an amplified/deleted segment of a sample, which has cnv > thr/ cnv < −thr, has an overlap of 80% or more with a benchmark amplified/deleted segment it was considered as tp. if we cannot find an overlap of 80% or more between a detected cnv region and any benchmark cnvs, the detected cnv segment was consider as fp. an amplified/deleted segment in the benchmark that does not have an overlap of 80% or more with any detected amplified/deleted regions was called fn. since the regions with no cnvs cover very large sections of a genome we did not calculate tn regions. therefor for segment-based comparison we calculated tprs and fdrs as eqs.  <dig> and  <dig>  if we name a cnv segment of samples as testseg and a cnv segment of benchmark as benchseg, we can calculate tps, fps and fns as shown in table  <dig> table  <dig> computing tp, fp and fn for segment-based comparison

testseg cnv > thr
testseg cnv < thr
…
testseg cnv < −thr
testseg cnv > −thr
...



RESULTS
real data
gene-based comparison
the average sensitivity, specificity and fdr of the  <dig> cnv detection tools on real breast cancer wes data are shown in table  <dig> . thresholds of ± <dig>  were used to call cnv genes. in summary tools show moderate sensitivities , fair specificities  and poor fdrs  on detecting cnv genes. of the five tools, exomecnv was found to outperform other tools with the highest sensitivity rate of  <dig> % for amplification and  <dig> % for deletion. varscan <dig>  and adtex  show the best fdr and specificity for detecting amplified and deleted genes . exomecnv employs a minimum power/specificity parameter, and it makes a call on a specific exon if the desired power/specificity is achieved by the coverage of that exon. that is likely the reason of its better performance.table  <dig> overall performance of the cnv detection tools using the gene-based comparison approach for real data

 <dig> %
 <dig> %
 <dig> %
 <dig> %
 <dig> %
 <dig> %
in the table, bold value in each line represents the best value of each performance measure




in general, tools show higher fdrs in detecting deleted genes compared to detecting amplified genes. adtex, contra, and cn.mops show similar rate of sensitivity for detecting the true amplified cnv genes . the high fdrs of the tools might be partially due to using array-based cnv results as benchmark cnvs. array-based technologies suffer from low resolution due to probe intensities, which results in detecting large cnv regions and missing the detection of small cnv regions.

to examine the consistency of the tools’ results, we compared the cnv calls of the genes for each sample across the tools. figure  <dig> shows the cnv calls of  <dig> breast cancer related genes  <cit>  for the breast cancer samples used in this study. it can be seen that there is no strong consistency among the tools in calling these breast cancer related genes for each sample. there are few genes that are called as amplified or deleted in each sample by all the tools. many genes are called as amplified by some tools, deleted by some other tools and no cnv by the rest. as can be seen from fig.  <dig>  sample  <dig> has a few amplified or deleted cnv regions compared to other samples; thus, we removed it for the rest of analysis. figure 2a and b show the venn diagram of the average of the number of truly detected deleted and amplified genes by the tools from all the samples. as can be seen, a small fraction of true amplified and true deleted genes are common across all the tools. only  <dig> genes out of  <dig> true amplified genes in union, and  <dig> genes out of  <dig> true deleted genes in union are common across the tools, which show low consistency among the tools.fig.  <dig> cnv call of  <dig> breast cancer related genes. blue: deletion, red: amplification, and light yellow no cnv call. order of tools from left to right: 1: adtex, 2: exomecnv, 3: contra, 4: cn.mops, and 5: varscan2


fig.  <dig> venn diagrams of the average of the number of truly detected cnv genes from the  <dig> tools,  amplified genes,  deleted genes




segment-based comparison
average sensitivities and fdrs of the cnv detection tools based on the segment-based comparison analysis are given in table s <dig> in additional file  <dig>  we considered an overlap of at least 80% between the detected cnvs and benchmark cnvs to call tps and fps. we also used thresholds of ± <dig>  to call cnv regions. sensitivities and fdrs of the segment-based analysis are almost similar to the sensitivities and fdrs of the gene-based analysis. however, we observed that tools that can detect larger cnv segments show better performance. this is most likely due to use large benchmark cnv regions from the array-based technologies. exomecnv and cn.mops show the highest sensitivities for detecting cnv segments; and cn.mops and varscan <dig> show the lowest fdr for detecting cnv segments . exomecnv and cnmops also detect a greater percentage of large cnv segments .fig.  <dig> characteristics of the detected cnv regions by the  <dig> tools. a size distributions of cnv segments. b number of detected cnv segments




the cnv size distributions and the number of the detected cnvs from the breast cancer samples by the five tools are shown in fig.  <dig>  there is no strong consistency among the tools on the size and number of detected cnvs as well. tools that detect larger cnv segments detect lower number of cnvs and tools that detect shorter cnv segments detect more cnvs . that indicates a high level of errors in cnv break point  detection. in fig. 3a, cn.mops and adtex show a tendency to detect larger cnv segments. contera detects shorter cnv segments. only about 1% of its detected cnvs regions are larger than 1000 k.

we also examined the computational complexity of these cnv detection tools by comparing their execution times. in order to compare the running time of the tools, we run the tools using one of the breast cancer sample for  <dig> times and averaged their execution times. the runs performed on a single node of the same computer cluster. figure  <dig> shows the average execution times of the tools on the real dataset. in fig.  <dig>  you can see that while adtex takes the longest time, cn.mops is the fastest tool among the five tools. the running times of the other three tools are almost comparable.fig.  <dig> average execution times of the tools from  <dig> runs on a real breast cancer dataset




in summary, adtex has a moderate sensitivity and better fdr. similar to cn.mops, it is capable of detecting larger cnv regions, but it detects cnvs with a wider range of sizes. adtex is the most recently developed tool for cnv detection. different from the other four tools, it employs two hmms for calling cnvs and a denoising method for preprocessing. its detection method is more computationally expensive compared to the other tools. contra has a moderate sensitivity and fdr, with a wide range of detected cnvs sizes. its performance outperforms the other tool using simulated data. because contra was developed based on empirical relationships between log-ratios and read count data, it relies on the case sample being largely copy number neutral. but this might not be true for cancer data, and results in poor performance for real cancer data. cn.mops also has a moderate sensitivity and fdr for the gene-based comparison approach. cn.mops can apply to multiple samples at once for a better normalization, which can improve its performance. it shows better performance in detecting cnv segments. cn.mops detects larger cnv regions, and is the fastest tool. exomecnv has higher sensitivity and moderate fdr. its better sensitivity can be due to its additional step to call cnv at individual exon before segmentation process. in general, exomecnv shows better overall performance in comparison to the other tools. its execution time is comparable with other tools as well. in this study we did not use baf data. using baf data can improve its performance too. varscan <dig> has higher sensitivity and better fdr for both amplification and deletion in the gene-based comparison analysis. even though varscan <dig> did not show the best performance, it shows stable overall performance and ease of use with a comparable execution time.

simulated data
the advantages of using simulated data are that: 1) we have a known list of benchmark cnvs that can be used as a gold standard for calculating accurate sensitivities and fdrs, and 2) we can investigate the effect of coverage on the detection power of the tools. since the price of sequencing directly depends on the coverage of the data , knowing the minimum coverage of data needed for accurate cnv detection is important. it is useful to notice that even though simulated data harbor sequencing noise and biases, tumor related distortions have not simulated in the synthesized data. as a result, cnv detection tools show superior performance on synthesized data compared to real tumor data. we generated  <dig> sets of  <dig> simulated paired-end wes data for chromosome one. each set has different numbers of 100 bp reads of 3 m, 2 m, 1 m,  <dig>  m,  <dig>  m,  <dig>  m,  <dig>  m. thresholds of ± <dig>  were used to call cnv genes and segments for simulated data.

gene-based approach



segment-based approach
segment-based analysis of the performance of the tools using the simulated data showed that varscan <dig> and cn.mops have the highest sensitivity for detecting amplified cnvs, and varscan <dig> and exomecnv have the lowest fdr in detecting deleted cnvs, as shown in the additional file 1: table s <dig>  the five tools show almost the same fdr for detecting amplified and deleted cnv segments. they have high sensitivities and low fdrs especially for high coverage values. as expected, we observed that the overall performances of the tools are better for higher coverage values .

in addition, we analyzed false negative, false positive and true positive cnv segments regarding their lengths. we observed that in general fn and fp segments have significantly shorter lengths compared to tp segments  for all of the tools. the boxplots of the lengths of fp, fn, and tp cnv segments for all the tools and for amplification and deletion are given in additional file 1: figures s <dig> and s2). it can be concluded that the power of all the tools in detecting short cnvs is low and they detect many false short cnvs and miss many true ones. the length of a cnv segments is indirectly related to the local coverage of the segment. therefore, mis-detection of short and low coverage segments is one of the major reasons for poor performance of the tools.

CONCLUSIONS
in this study, we surveyed cnv detection tools for wes data in cancer. we focused on cnv detection for wes data because wes is a more affordable and a more popular sequencing technique in translational research compared to wgs. despite the popularity and prevalence of wes data, detecting cnv using wes data is challenging. cnv detection using wes data requires different approaches compared to the cnv detection using wgs data due to different type of noise and biases and sparsity of exonic regions. also, in this study we concentrated our efforts on studying cnv detection tools that can apply to or designed for cancer. cancer tumors harbor somatic aberrations and tumors are complex due to tumor ploidy, normal cells contamination and subclonal heterogeneity. as a result, studying cnvs in cancer requires different approaches compared to studying germline cnvs or population cnvs.

we evaluated the performance of the five most recent and commonly used cnv detection tools  for cancer wes data in terms of sensitivity, fdr and specificity of detecting cnv genes and cnv segments. for the performance evaluation, we used real breast cancer data as well as simulated data. the comparative analysis of the performance of the tools on real data shows that the tools have moderate detection power  while show low precision . the poor fdrs show that the tools generate many false positives.

there are some important reasons for having low sensitivity and specificity of cnv detection tools. first reason is related to the inability of accurate detection of cnv breakpoints for wes date. percentage of exons in genome is about  <dig> % to  <dig> % and some of the real breakpoints are outside of the captured target regions  <cit> . second, all of these tools are based on the rd approach that uses the depth of coverage  information for detecting cnv. this method has low resolution and power in detecting small cnvs due to low values of read count data  <cit> . third reason is the lack of appropriate preprocessing methods such as bias removing, de-noising and normalization. it is assumed that there is a shared bias between tumor and normal read count data, which can be removed by calculating the ratio of tumor and normal coverage. but this assumption can lead to potential problems. the noise of a local region is not considered in this assumption. therefor in computing ratio values of depth of coverage between tumor and normal samples, noise is amplified. it has been shown that cnv detection tools do not perform well for low quality and noisy samples  <cit> , which indicates a need for using more advanced preprocessing and detection  methods.

also, the characteristics of the detected cnv segments  are different across the tools that show inconsistency in the segmentation of the cnv regions. in addition, the consensus cnvs across the tools is low which can be the result of the high fdrs as well. using synthesized data resulted in the better performance of the tools because tumor complexity  has not been simulated on the synthesized data. that shows the importance of considering tumor complexity in cnv detection in cancer.

even though tumor complexity play an important role on the accurate detection of cnvs, there are only two tools, adtex and exomecnv, that partially address tumor complexity by employing baf information – regarding tumor ploidy- in their cnv detection methods. however, tumor subclonal heterogeneity and tumor purity have not been addressed by any tools. incorporating extra information such as allelic frequency and a model of tumor purity can help to improve true detection of cnvs.

using the simulated data, we also investigated the effect of coverage on the detection power of the tools. coverage of sequencing, or the number of reads, is proportional to the cost of sequencing. high coverage is important to call somatic aberration, especially for somatic mutations, but it costs more as well. in this study, we observed that the tools’ performances do not improve significantly by increasing the coverage more than about 10x on exonic regions. although, the tools use different preprocessing methods, they used hmm and cbs for segmentation of cnv regions, which are adopted from cnv detection for microarray technologies. new segmentation approaches that can effectively use characteristics of wes data in cancer, such as tumor complexity and sparsity of exonic regions, need to be developed. in addition, even though it is well known that read count data suffer from noise there is only one tool, adtex, that uses a noise cancellation method- based on the discrete wavelet transform technique - to reduce noise before segmentation. also, somatic cnv detection methods typically utilize matched normal dna as a means for identifying true somatic variations from germline variations and reducing background sequencing biases. developing appropriate and effective noise cancelation and normalization methods is required to detect cnvs more accurately. utilizing techniques from other fields such as statistical image/signal processing can help to address these challenges.

one of the challenges we faced in this study was usability of the tools. one of the problems is the mismatch of the tools with the newer version of their dependencies. in addition, all of the cnv detection tools are command line based software tools without user-friendly user interfaces. the lack of user-friendly user interface makes the tools’ utilization difficult for researcher with limited expertise in computer systems. visualization is also very important to study cnvs. most of the tools offer commands for plotting cvns with very limited features. however, embedding advanced and user-friendly visualization features to the cnv detection software tool can be very useful.

finally, the lack of a cnv gold standard to accurately evaluate the performance of the tools is another challenge in developing cnv detection tools. an effort on developing a gold standard for cnv detection can significantly help cnv detection tool development.

in summary, the moderate sensitivities and poor fdrs of the current cnv detection tools for wes data in cancer indicate the need for developing more efficient and precise cnv detection methods. cnv detection tools with user-friendly user interfaces and visualization features can extremely enhance cnv studies. also, utilizing advanced novel segmentation, normalization and de-noising techniques that are designed specifically for cancer data is necessary.

additional files

additional file 1: supplementary materials . 

 
additional file 2: cnv results of adtex for the  <dig> real breast cancer samples. 

 
additional file 3: cnv results of contra for the  <dig> real breast cancer samples. 

 
additional file 4: cnv results of cn.mops for the  <dig> real breast cancer samples. 

 
additional file 5: cnv results of exomecnv for the  <dig> real breast cancer samples. 

 
additional file 6: cnv results of varscan <dig> for the  <dig> real breast cancer samples. 

 


abbreviations
cnvcopy number variation

tcgathe cancer genome atlas

weswhole exome sequencing

wgswhole genome sequencing

fdrfalse discovery rate

bafb allele frequencies

spcspecificity

hmmhidden markov model

cbscircular binary segmentation

tptrue positive

fnfalse negative

tntrue negative

fpfalse positive

tprtrue positive rate

fprfalse positive rate

electronic supplementary material

the online version of this article  contains supplementary material, which is available to authorized users.

not applicable.

funding
this study was supported by a grant from the national institutes of health .

availability of data and materials
all data generated or analyzed are included in this published article . the breast cancer cnv data that are used as benchmark are available at tcga’s data portal  the bam files of the breast cancer data are protected data and are available at the cancer genomics hub , https://cghub.ucsc.edu/index.html. the simulator for generating simulated wes data is available at https://github.com/nabavilab/varsimlab.

authors’ contributions
sn, md and fz designed the study. fz, md, ah and nm implemented the analysis; sn, fz, md, ah and nm interpreted the results. sn, fz and md wrote the manuscript. all authors read and approved the final version of the manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
no ethics approval was required for the study. input data are publicly available through the cancer genome atlas  and are simulated data.

publisher’s note
springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
