BACKGROUND
rna-seq has emerged as a powerful tool for studying transcriptomes. it aims to provide a comprehensive list of all transcripts and their expression levels from a given cell or cell population under a particular condition. a typical rna-seq experiment involves rna isolation followed by conversion to a library of short cdna fragments and sequencing using next-generation sequencing technology  <cit> . rna-seq data analysis typically involves aligning the short read sequences to a reference genome to reveal reads from exons, splicing junctions, or polya ends. this information is used to i) derive novel gene models or refine existing gene models, including exon structure and untranslated regions  and ii) to determine gene expression levels from read count statistics  <cit> . a few software packages have been developed to perform one or more of the above data analysis tasks, including tophat/cufflinks  <cit> , erange  <cit>  and scripture  <cit> . this type of reference-based approach can be very successful if the reference genomes are good quality. however, except for a few model organisms, genome assemblies are often incomplete or unavailable. similarly, sequencing rna from complex microbial communities, or metatranscriptome sequencing, also poses considerable challenges for data analysis because the genomes for most of the organisms are not known. thus, in many cases, reference-based analysis of rna-seq data is not possible.

de novo assembly of rna-seq reads into transcripts has the potential to overcome the above limitations. however, short read assembly itself is very challenging. in general, next-generation sequence data contains large numbers of reads with artifacts originating either from the library preparation step  or from the sequencing step . these poor quality reads can result in fragmented assemblies or assembly errors. also, the size of sequencing datasets produced is often very large, and therefore requires substantial memory and long computing times, even for the very efficient de bruijn graph-based assemblers  <cit> . there are additional challenges specific to assembly of rna-seq data. for example, the sequencing coverage among different transcripts can range over five orders of magnitude, depending on transcript abundance and sequencing depth. this causes most short read assemblers to be unsuitable for transcriptome assembly because they assume uniform coverage. furthermore, a set of standard criteria to evaluate the quality of transcriptome assemblies remains an open question.

to address these challenges, we developed an automated software pipeline, called rnnotator, for preprocessing of rna-seq data followed by reference genome independent de novo assembly into transcriptomes. we also developed standards to evaluate transcriptome assemblies that can be generalized to many other transcriptomes. for transcripts with deep sequencing coverage we demonstrate that rnnotator is capable of producing full-length transcript assemblies. furthermore, we demonstrate that a de novo assembly approach can discover transcripts derived from sequences which are not present in the reference genome.

RESULTS
the rnnotator assembly pipeline
rnnotator takes short read sequences as input and outputs assembled transcript contigs. it consists of three major components: preprocessing of reads, assembly, and post-processing of contigs .

the preprocessing step removes highly redundant reads and low quality sequences found in most rna-seq data sets. large numbers of identical reads may originate from pcr amplification or from abundant transcripts and do not contribute to the assembly. consolidation of identical reads into a single representative sequence prior to assembly reduces the computational resource requirements for the assembly. low quality reads containing sequencing errors are also filtered out using a k-mer based approach . we found that preprocessing the raw reads reduced the variation of gene coverage while improving the computational performance of the assembly significantly. the variance of gene coverage was reduced by  <dig> fold in candida albicans . these preprocessing steps also reduced the total read count from  <dig> to  <dig> million  in the candida albicans sc <dig> dataset, which reduced the memory required for one run of velvet from  <dig> gb to  <dig> gb .

for assembling the filtered reads rnnotator uses velvet  <cit>  as the default assembler. to obtain an optimal set of assembly parameters we tried several different parameter sets and evaluated their performance. since there is no single parameter set that can give the best results for all genes, we executed multiple velvet assemblies and then merged the resulting contigs using the minimus <dig> assembler from the amos package  <cit> . merging the velvet assembled contigs resulted in a much better assembly .

rnnotator takes special consideration of the direction of transcription. to determine the transcription direction as well as resolve overlapping transcripts that originate from opposing dna strands  rnnotator incorporates information from strand-specific rna-seq reads . it does this by aligning the strand-specific reads to each contig and then splitting contigs at the strandness transition point which signifies the boundary of adjacent transcripts. for genomic regions that have reads from both orientations, indicative of transcript overlap, both strands of the contig are retained after separation . finally, single base errors in the assembled contigs are corrected by aligning the reads back to each contig to generate a consensus nucleotide sequence.

1accuracy is defined by the percentage of contigs that share at least 95% identity with the reference genome;

2completeness is the percentage of known genes covered by the contigs to at least 80% of the gene length;

3contiguity is the percentage of complete genes covered by a single contig over at least 80% of the gene length.

4gene fusions are the percentage of contigs that contain more than 50% of two or more annotated genes.

evaluation of rnnotator's performance
the ultimate goal of transcriptome assembly from rna-seq data is to compile short reads into a set of contigs, each of which represents a full-length transcript, without miss-joining elements of different transcripts or losing the correct representation of the expressed genes. to this end we have developed four criteria: accuracy, completeness, contiguity, and gene fusions to evaluate the quality of the assemblies. accuracy is a measure of the correctness of the assembly and is estimated by aligning each contig to the reference genome. completeness measures the degree to which the transcriptome is covered by the assembled contigs and is estimated by calculating the percentage of genes in the annotated gene catalog that are covered at > 80% of the gene length. contiguity measures the likelihood that a full-length transcript is represented as a single contig and is estimated by calculating the percentage of complete genes covered by a single contig to > 80% of the gene length. finally, gene fusions measures the number of contigs which contain two genes assembled into a single contig. using these criteria, we evaluated the performance of rnnotator against transcriptome assemblies from two strains of a pathogenic yeast species, candida albicans sc <dig> and candida albicans wo <dig> .

to evaluate the accuracy of rnnotator, we aligned the assembled contigs to the reference genome. for all of the data sets, over  <dig> % of the assembled contigs align to the genome at over 95% of the contig length. there is not much difference between the accuracy of rnnotator and a single velvet assembly, suggesting that rnnotator produces highly accurate contigs . the accuracy of contigs is not clearly correlated with sequencing depth. our estimate of accuracy is likely an underestimate of the true accuracy since contigs that represent trans-splicing, which are not straightforward to estimate, are also counted as "misassembled". rnnotator also determines the orientation for each transcript. this further improves the accuracy, especially in the candida genome where overlapping transcription from opposite strands is very common. for example, from candida albicans sc <dig> stranded rna-seq data, rnnotator resolved  <dig> pairs of overlapping transcripts .

to evaluate the completeness of the assembly, we compared the rnnotator assembly with a set of previously annotated genes for each organism. in general, the rnnotator contigs cover 10-20% more known genes than those from a single velvet assembly ; the difference is more pronounced for genes with contigs covering the entire gene length . as expected, the completeness of the assembly is correlated with the sequencing depth  of each gene . for the ultra-deep sequenced candida albicans sc <dig> transcriptome, where the median sequencing coverage of annotated protein coding genes is 175x,  <dig> out of  <dig> genes  have contigs covering at least 80% of their length, demonstrating that rnnotator is able to produce transcript sequence for the majority of the known yeast genes .

we next evaluated the contiguity of the assembly, or how likely a known gene is to be assembled into a single contig covering the full length of the gene. compared to the results from a single velvet assembly, rnnotator assembled many more genes with a single contig covering the entire gene length. in the rnnotator candida sc <dig> assembly  <dig>  genes are covered at over > 80% of their length by a single full-length contig, compared to only  <dig>  genes from a single velvet assembly . like completeness, contiguity also improves with increasing sequencing coverage .

we also evaluated the number of contigs containing a gene fusion event. genes with overlapping utrs may be joined into a single contig during the assembly process. the rnnotator contigs exhibited far fewer gene fusion events than the velvet contigs . in the sc <dig> assembly,  <dig> % of the rnnotator contigs contained gene fusion events, while  <dig> % of the velvet contigs contain fused genes. rnnotator is able to drastically reduce the number of fused genes by splitting incorrectly assembled contigs using stranded reads.

in addition to comparing rnnotator to a single-run of velvet, we also compared rnnotator to two other transcriptome assembly strategies: oases  <cit>  and multiple-k  <cit> . for the two candida data sets tested here, rnnotator produced contigs with the highest contiguity among the three while its accuracy and completeness are comparable to the other two .

these results suggest that full-length transcripts can be accurately de novo assembled from ultra-deep rna-seq datasets using rnnotator, and that this tool will be of great value in functional annotation of genes from organisms without sequenced genomes.

novel transcribed regions discovered only by de novo assembly
a de novo transcriptome assembly has the potential to detect novel transcripts that are not present in the reference genome assembly, or even parasite transcripts that do not originate from the host genome. of the  <dig>  assembled transcripts from the candida sc <dig> strain,  <dig> contigs do not align to the reference genome. however,  <dig> of these contigs do align to the reference genome of the wo <dig> strain, suggesting that these contigs are not the result of transcript misassembly or contamination of a foreign species, but instead that the sc <dig> genome assembly is incomplete, and/or contains misassemblies. of the remaining  <dig> contigs,  <dig> have blast hits to the ncbi non-redundant database . it is possible that these transcripts are derived from the unassembled part of the genome, or they might represent recent genetic additions to the strain used for the experiments. further experiments are required to resolve these possibilities. the remaining  <dig> contigs have low complexity sequence and likely originate from sequencing artifacts.

discussion
apart from annotation of the transcriptome, another major goal of rna-seq studies is to quantify transcript levels  <cit> . when a reference transcriptome is available, standard rna-seq counting procedures align reads from each sample to the reference gene catalog and the number of reads that align to each gene is used to determine gene expression levels  <cit> . in the absence of a reference transcriptome, rnnotator is able to produce a set of transcripts directly from rna-seq reads which can serve as the reference, therefore potentially extending the application of gene expression profiling to organisms or metagenome communities that do not have existing transcriptome annotations.

with the sequencing depth used in this study rnnotator is unable to fully assemble poorly expressed genes that have insufficient sequencing coverage. in cases where there are reference genomes present, this limitation can be partially removed by combining the result from a reference-based transcriptome assembly . while the reference-based assembly will miss transcripts that are derived from unassembled portions of the genome, in the future one would combine these two complementary approaches for a comprehensive annotation of the transcribed regions. additionally, rnnotator cannot currently resolve transcripts from duplicated genomic regions, or transcripts produced from polymorphic alleles. a complete re-sequencing of the lab strain used in the manuscript will be required to determine how rnnotator deals with transcripts from duplicated genomic regions. we assume that near identical transcripts  will be assembled into one. how transcripts from polymorphic alleles are assembled is also an open question. we assume less abundant alleles will be "corrected" to their abundant counterparts based upon how rnnotator works. however, allele information should be inferred by mapping raw reads back to the transcripts from those assembled by rnnotator, a topic that is worth more in-depth exploration. in principle, both of these challenges will be overcome by the increased sequence depth and read length expected from ongoing improvements to dna sequencing technology.

finally, it is unknown how alternative splicing will affect transcript assembly. currently we have not explored transcriptome assembly from an organism in which alternative splicing is prevalent, neither have we had a good reference set that contains a comprehensive list of alternatively spliced transcript variants for evaluation of such effects.

CONCLUSIONS
here we described a systematic method to assess transcriptome assembly quality by assessing the accuracy, completeness, contiguity, and gene fusion events in transcriptome assemblies. using these criteria as guidelines, we developed a de novo transcriptome assembly pipeline to reconstruct high quality transcripts from short read sequences independent of an existing reference genome, which potentially enables rna-seq studies in any organism, simple or complex. we also demonstrated that transcriptome assembly is complementary to reference-based analysis when reference genomes are incomplete. in addition, assembly of rna-seq reads also provides an opportunity to discover new types of rna not encoded in reference genomes.

