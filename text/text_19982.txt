BACKGROUND
the development of massively parallel sequencing for use in gene expression profiling is known as rna-sequencing . rna-seq has had an enormous impact on gene expression studies. compared to hybridization-based technologies like dna microarrays, it provides consistent quantification and manifests its superiority in terms of the dynamic range, sampling depth, and has independence from pre-existing sequence information 
 <cit> . rna-seq can be used for traditional transcriptome profiling 
 <cit> , identification of novel transcripts 
 <cit> , identification of expressed snps <cit> , alternative splicing, and for the detection of gene fusion events 
.

to allow for mrna/gene detection, highly abundant ribosomal rnas  must be removed from total rna before sequencing. one standard solution is to enrich for the polyadenylated ) rna transcripts  with oligo  primers, similar to how dna microarrays are primed; however, this method eliminates all non-poly rnas in addition to rrnas. recent studies suggested that certain non-polya rnas, either non-coding or protein coding, are functionally important 
. moreover, mrna-seq poorly captures partially degraded mrnas, hence it is not an optimal method to use when the starting materials are from formalin-fixed and paraffin-embedded  samples, because the rnas from ffpe are degraded to a small average size 
 <cit> . to overcome these challenges, several rrna depletion protocols have been developed. the ribo-zero method removes rrna through hybridization capture of rrna followed by binding to magnetic beads for subtraction. another method involves duplex-specific nuclease  degradation by the c0t-kinetics-based normalization method to deplete abundant sequences that reanneal quickly, such as those derived from the highly abundant rrnas and trnas 
 <cit> . in this study, we examined rrna-depleted libraries from total rna of fresh-frozen  and ffpe samples sequenced by mrna-seq, ribo-zero-seq and dsn-seq and compared these results across methods and with conventional dna microarrays.

RESULTS
to rigorously evaluate the feasibility of reproducible gene expression profiling using rna from clinically relevant ffpe materials, we collected ffpe and fresh-frozen  tumor rnas for matched sets of tumors from two different sources . most tumors were subjected to gene expression profiling using six different methods that included: 1) agilent dna microarrays using ff rna, 2) mrna-seq using ff rna, 3) ribo-zero-seq using ff rna, 4) dsn-seq using ff rna, 5) ribo-zero-seq using ffpe rna, and 6) dsn-seq using ffpe rna; see figure 
 <dig> for a comparison of each rna-seq protocol and the number of samples tested for each protocol. analytical comparisons were focused on several features including rrna depletion efficiency, genome alignment profile, transcriptome coverage, transcript quantification accuracy and reproducibility, gene expression patterns and differential gene expression, as well as coverage of annotated genes at different sequencing depths.figure  <dig> 
schematic overview of the rrna removal protocols and list of samples tested.  mrna-seq, ribo-zero-seq and dsn-seq library preparation protocols are shown, with the key steps to remove the rrna from the library show in italics. the full protocol was applied to the fresh-frozen  samples, and a similar alternative protocol was applied to ffpe samples .  the list of samples tested by each rna-seq library protocol and their source.



rrna depletion efficiency
the efficiency of rrna removal is a key factor to maximize reads mapping to transcripts, because if left alone, rrnas make up >80-90% of the total rna of an un-enriched sample 
 <cit> . due the nature of rrna sequences, many rrna short reads will produce poor alignments; hence, the estimation of absolute abundance of rrna based on whole genome alignment tends to underestimate rrna amounts. thus we evaluated the relative level of rrna components across protocols by comparing the levels to those observed in mrna-seq. ribo-zero-seq reduced rrna levels to a similar order of magnitude as mrna-seq in both ff and ffpe rna, while the rrna fraction in dsn-seq libraries were significantly higher  and with greater variation, particularly within the ffpe samples . consistent with the analysis of the unc dataset, ribo-zero-seq provided the same rrna removal efficiency as mrna-seq in the tcga samples; the level of rrna reduction observed here for the ribo-zero-seq protocol was similar to that reported by the company that makes the ribo-zero kit .table  <dig> 
analysis of performance for multiple rna-seq methods



unc dataset

tcga dataset
five different analyses were performed in order to assess the capabilities of the different rna-seq protocols. these included: 1) % rrna relative to mrna-seq; 2) % aligned bases; 3) median cv coverage; 4) median 5′ to 3′ bias; 5) the pearson correlation coefficient between the rna-seq libraries methods and the same samples assayed by dna microarray in unc dataset.



genome alignment profile
the precision of rna-seq gene quantification is directly dependent on the number of reads that are mapped to transcripts, thus we first assessed the fraction of reads aligning to the reference human genome ucsc hg <dig> . in ff samples, mrna-seq and ribo-zero-seq provided comparable percentage of nucleotide bases mapping to the genome , while dsn-seq aligned a smaller number . in ffpe samples, ribo-zero-seq and dsn-seq both had good performance in alignment on average ; tcga samples had a similar result for both ff and ffpe . compared to ff, the ffpe samples tended to exhibit a greater variation in the% aligned, most likely related to more variable quality of ffpe rnas.

transcriptome coverage
the coverage of the transcriptome directly affects the accuracy of transcript abundance estimation and the sensitivity of transcript detection, which are two critical features of all gene expression studies. therefore, we evaluated two features of the transcriptome coverage:  relative coverage of exons, introns, and intergenic regions, and  uniformity of transcript coverage.

 relative coverage of exons, introns, and intergenic regions
in ff samples, bases mapping to transcripts  constituted  <dig> % total bases in mrna-seq, while a marked reduction was observed in the two rrna-depletion protocols . conversely, bases mapping to intronic and intergenic regions increased from  <dig> % in mrna-seq to  <dig> % in dsn-seq and ribo-zero-seq. in ffpe samples, dsn-seq and ribo-zero-seq provided similar coverage profiles, where ~20% of bases were mapped to transcriptome and >60% to intronic or intergenic regions. these results were concordant with that observed in the tcga sample set .figure  <dig> 
genome alignment profiles. the percentage of nucleotide bases mapping to three different regions of the genome: exonic/protein coding and utr , intronic , intergenic , and the percentage of unmapped bases . the data is shown separately for the unc  and tcga  datasets.



we further investigated the coverage across individual genes . in mrna-seq, most reads mapped almost exclusively to exons, and the coverage of intronic regions was low and comparable to the intergenic background. in contrast, in ribo-zero-seq and dsn-seq there was a more continuous coverage of both exons and introns, although the coverage of intergenic regions was more similar to what was seen with mrna-seq. this unique profile suggests that the rrna depletion protocol may capture pre-mrnas in addition to mature mrnas. to test this hypothesis, we examined the pile-up profile of a few individual genes and identified reads that spanned exon-intron boundaries in the ribo-zero-seq and dsn-seq protocols .

 uniformity of transcript coverage
we next determined the evenness of transcript coverage by comparing the median coefficient of variation  for the read coverage of the  <dig> most highly expressed transcripts . in ff libraries, mrna-seq and ribo-zero-seq had significantly lower cv than dsn-seq , indicating a more uniform coverage across the full length of transcripts. in the ffpe libraries, there was an increase in cv in both protocols. ribo-zero-seq-ffpe had slightly higher variation than the result reported in adiconis et al. 
 <cit> , while dsn-seq-ffpe had the highest cv among all protocols.

another measure of transcript coverage is the variation at 5′ and 3′ ends. we evaluated the ratio of coverage at the 5′ end relative to the 3′ end for the  <dig> most highly expressed transcripts . previous studies have shown that the poly-capture strategy shows substantially more reads from the 3′ ends of transcripts. our analysis revealed that on ff, ribo-zero-seq provided less biased 5′-to-3′ coverage ratio than mrna-seq , while dsn-seq made no significant improvement. in ffpe samples, both protocols performed similar as mrna-seq with respect to 5′-to-3′ bias.

transcript quantification and reproducibility
rna-seq poly enrichment strategies yield an accurate and reproducible measurement of transcript abundance with a wide dynamic range 
 <cit> . given the advantages of profiling multiple types of rna species , it is critical to evaluate the performance of mrna quantification in total rna-seq protocols. to determine the possible concordance of rna-seq with data generated by older genomic profiling platforms, we compared the gene expression levels of rna-seq data with that of agilent dna microarray data that were assayed using the same rnas. with specific and standard gene filtering criteria 
 <cit> , we detected  <dig>  expressed entrez genes by custom agilent  <dig>  feature microarrays, with  <dig>  genes detected by both microarray and rna-seq across our paired samples. in ff samples, gene abundance measurements by all protocols of rna-seq were highly correlated with the microarray data . in ffpe samples, rna-seq measurements were lower but also significantly correlated with ff microarray , which is at a level similar to that observed when comparing concordance between agilent and affymetrix microarrays 
 <cit> .we next examined the correlation of transcript abundance across the different rna-seq protocols. there was greater concordance and fewer outliers than when compared to the microarray data . among ff tissues, the correlation was > <dig>  for all pair-wise, sample-matched comparisons. dsn-seq and ribo-zero-seq on ffpe were less correlated with ff mrna-seq , but still higher than the correlation observed with microarrays. the two rrna depletion protocols were the most highly correlated in both ff and ffpe samples . the correlation plots for an individual sample  are shown in figure 
3c.figure  <dig> 
comparison of gene quantification concordance across rna-seq library protocols. pearson correlation coefficients of rna-seq libraries pairs in  unc and  tcga dataset.  scatter plots of libraries of each pair of protocols for breast tumor sample 020578b.  deming regression slope for pairs of rna-seq libraries in unc dataset. a slope of  <dig> indicates the equivalent sensitivity of the two libraries, whereas a smaller value is indicative of a higher sensitivity of the first term/method in the pair.



additional quality assessments were made on the tcga dataset, to account for the fact that a much smaller set of reads were mapped to transcriptome in rna depletion protocols. we generated eight technical replicates with the ribo-zero-seq-ffpe protocol to balance the total number of transcriptome reads for the comparison with ff mrna-seq. the assessment of technical reproducibility suggested that these ffpe replicates were indistinguishable . the correlation between ribo-zero-seq on ff and ffpe as well as between ribo-zero-seq-ffpe replicate pairs has also been confirmed in norton et al. 
 <cit> .lastly, we applied deming regression to estimate a statistically unbiased slope to determine the relative sensitivity of protocol pairs . a slope of  <dig> indicates the equivalent sensitivity of the two libraries, whereas a smaller value is indicative of a higher sensitivity of the first protocol in the pair. mrna-seq exhibited its superiority over all the other protocols in terms of sensitivity, with a slope less than  <dig> in all the pair-wise comparison. in addition, dsn-seq and ribo-zero-seq both have higher sensitivity in ff samples than in ffpe.

gene expression patterns and differential gene expression
hierarchical clustering analysis provides a global examination whether biologically relevant expression signatures are consistently measured by distinct protocols. in this example, we tested whether the same sample assayed by different protocols “paired” or “partnered” together; if so, then this is a very high level of assay validation as not only are the overall subtype expression profiles maintained, but also the profiles that are unique to that sample are maintained. we performed hierarchical clustering analysis of the rna-seq data using a previously published ‘intrinsic gene list’ 
 <cit>   and a set of  <dig> human breast tumor samples that consists of the  <dig> unc and tcga samples described here and  <dig> additional breast tumors and  <dig> normal breast tissues with mrna-seq from tcga. 41/ <dig> samples of the unc tumor dataset were tightly co-clustered with their partner sample originating from the same tumor, and these clustered with other tcga tumors based upon each tumor’s subtype profile. the 3/ <dig> non-clustered samples were all prepared by ribo-zero-seq on ffpe samples and their partner dsn-seq samples on ffpe were not available. in the tcga dataset, 40/ <dig> samples were tightly co-clustered with their partners ; the four samples that were not clustered were on a separate branch, but were moderately correlated with their partner samples .

to further evaluate the capability of rna-seq protocols to detect biologically relevant differential expression signals, we performed significance analysis of microarray  on three basal-like and three luminal samples of unc dataset that were sequenced by mrna-seq, ribo-zero-seq and dsn-seq respectively. comparison of the top  <dig> most variably expressed genes between basal-like and luminal tumors revealed that each pair of rna-seq protocols shared about  <dig> differential expressed genes, and more than  <dig> genes were consistently identified by all the protocols .

as another test of data quality, we determined the differentially expressed gene set in ff mrna-seq vs. ribo-zero-seq and ff ribo-zero-seq vs. dsn-seq using significance analysis of microarray . we identified  <dig> genes with a fdr of  <dig> that were differentially expressed between mrna-seq and ribo-zero-seq ; this list was enriched with snornas and histone rnas that were more highly expressed in the ribo-zero-seq samples. many of these rnas do not possess poly tails, and therefore, are not targeted by poly selection in mrna-seq. conversely,  <dig> genes at a fdr of  <dig> were identified to be differentially expressed between ribo-zero-seq and dsn-seq libraries ; among these,  <dig> genes were lowly quantified by dsn-seq and most of these genes were snornas and histone rnas, which tend to exist at high abundance in total rnas. since dsn-seq removes the most highly abundant components via cot kinetics, these rnas may also be subject to depletion in the dsn protocol relative to the ribo-zero, which uses beads to capture only the rrnas.

coverage of annotated genes at different sequencing depths
compared to hybridization-based methods, the cost per sample by rna-seq is still higher. the utilization of multiplexing techniques provides a strategy to further lower the costs. however, too much multiplexing will inhibit the ability to detect lowly expressed genes; therefore, we sought to determine the minimal number of reads required to provide the same transcriptome coverage as provided by an agilent dna microarray. the encode consortium guidelines and other studies have provided insights into the sufficient rna-seq coverage and depth for studies of various design goals 
 <cit> , but these efforts were primarily focused on experiments with ff samples prepared by poly-enrichment protocols. here we extended the investigation to rrna depletion approaches and ffpe samples.

we applied a simulation-based method on the pooled data of each protocol. the ucsc known gene reference database  includes  <dig>   genes. to reduce the noise, we only counted genes as present if there were  <dig> or greater read counts. using the average number of genes detected on our agilent microarrays as the baseline ,  <dig>  million reads from ff mrna-seq libraries would allow detection of the same number of genes , which is consistent with previous studies 
 <cit> . in the dsn-seq and ribo-zero-seq ff libraries, and ribo-zero-seq-ffpe libraries, 35-65 m reads were required to provide the same transcriptome coverage. only the dsn-seq-ffpe library required a much larger number of input reads .figure  <dig> 
determination of the number of reads needed for each rna-seq protocol to equal a dna microarray. the number of detected genes at different levels of sequencing depth is displayed relative to the number of genes detected via dna microarray .



discussion
the growing popularity of rna-seq makes it one of the more desired methods to explore the transcriptome. preparing rna-seq libraries with poly enrichment provides an accurate method to characterize mrnas, which is functionally equivalent to what dna microarrays have been accomplishing for more than a decade. however, certain biologically relevant rna species that do not possess poly tails are largely undetected using a poly selection protocol. in addition, ffpe samples, such as those collected as part of standard medical practice, also require library preparation methods that do not rely on the intact poly structure due to the highly degraded nature of the ffpe rna. in this study, we demonstrate that a ribo-zero-seq protocol using either fresh-frozen  or ffpe samples eliminates rrna with good efficiency. in evaluation of a possible coverage bias, 5′-to- 3′ bias was reduced in ff ribo-zero-seq libraries as it does not rely on poly selection step.

one major distinction across these various protocols is the coverage of the transcriptome. to more directly investigate the relationship between sequencing depth and transcriptome coverage, we performed a simulation approach where mrna-seq was the most cost effective strategy to equal a microarray in terms of total genes detected with a minimum of ~ <dig>  million reads needed. for the same transcriptome coverage, the reads required for ribo-zero-seq in ff and ffpe and dsn-seq in ff were 35-65 m reads. however, rrna depletion protocols also appear to measure immature transcripts  and therefore provide more information on splicing patterns and possible splice junctions. thus to achieve the same level of exonic reads as ff mrna-seq, one needs to sequence 2– <dig> times the number of reads in rrna-depletion on ffpe rna libraries.

despite fewer of the total reads mapping to exonic regions and a greater number of transcripts being detected, we did not observe a marked decrease in the correlation between microarray and rna-seq in rrna-depleted libraries, where rna-zero-seq and dsn-seq were found to be highly consistent in gene quantification. our evaluation of the quantitative consistency of rna-seq on ffpe with microarray may be limited in two aspects:  the quality of a few unc ffpe samples was less satisfactory, and  not all the tumors have rna-seq data on matched ffpe samples that passed our quality control available for this analysis. yet we still observed very good correlations with microarray data for those samples with complete ffpe data, which gave correlation values nearly identical to those seen when comparing an agilent microarray versus an affymetrix microarray 
 <cit> .

given the consistent quantification, mrna-seq and rrna depletion protocols exhibited their merits in different aspects. in the set of genes detected by all the protocols, mrna-seq provided the highest sensitivity in detecting differentially expressed genes, which was likely due to the greater fraction of reads mapping to the transcriptome. on the other hand, ribo-zero-seq detected about  <dig> more annotated genes than mrna-seq . with a much greater set of reads mapping to the intergenic and intronic regions in rrna depletion protocols, the number of additional transcripts detected with the new protocols may be expected to be greater than our conservative estimation here. as shown in another recent study 
 <cit> , we also expect more novel transcripts to be identified from the rrna depletion methods.

the very good quantification performance of the protocols on ffpe samples is of significant impact for researchers with clinical samples. our results demonstrate that ribo-zero-seq had high technical reproducibility on ffpe rnas and high concordance with ff rnas. though the quantification of ffpe was less correlated to ff mrna-seq, the two rrna depletion methods provided highly consistent gene profiles on ffpe. thus, it is the quality of ffpe rna samples, rather than the robustness of method, that likely contributes more to the variation of performance with respect to gene quantification. the hierarchical clustering analysis also validated that the biologically-based intrinsic gene profiles were present and highly correlated between ff and ffpe. hence, we suggest that it is possible to apply the rrna depletion protocols to ffpe samples and achieve quantitative accuracies comparable with standard genome profiling techniques that use ff tissues and rnas.

CONCLUSIONS
in this study, we demonstrated that compared to mrna-seq, ribo-zero-seq provides equivalent rrna removal efficiency, coverage uniformity, genome-based mapped reads, and reduces 5′- to- 3′ bias. in addition, both ribo-zero-seq and dsn-seq provide highly consistent quantification of transcripts when compared to microarrays or mrna-seq, and substantially more information on non-poly rna. moreover, the two rrna depletion methods have consistent transcript quantification using ffpe rnas and show high reproducibility.

