BACKGROUND
most proteins have arisen by natural selection to adopt a hierarchical three-dimensional fold, where regularly shaped structural motifs are packed together and form a hydrophobic core. the first description of two of these motifs introduced the concept of secondary structures  and demonstrated that some local structures have a repetitive nature  <cit> . later it was discovered that almost all regions of a protein backbone can be rebuilt by few substructures common to different proteins  <cit> . with increasing availability of high quality structures, it also became clear that some of the adopted conformations are realised much more frequently than others and more recently a detailed analysis of the ramachandran space  <cit>  for structures of different crystallographic resolution showed clustering of both secondary structure types and random coil conformations at distinct conformational attractors  <cit> . these attractors can be labelled as conformational 'states' and the protein structure can be considered as a sequence of conformational states. indeed, classical secondary structure attribution encodes a protein structure into a sequence of states.

however, the protein fold cannot be fully reconstructed from the secondary structure sequence alone, because this code describes the conformation of single residues and provides too few states to capture the entire variety of local conformations. to overcome these limitations, comprehensive libraries of frequently occurring fragments spanning several, typically 4- <dig>  residues were derived  <cit> . these libraries provide a richer choice of conformational states and they comprise intrinsically the structural correlation between consecutive residues. using fragments, protein fold reconstruction can be achieved by superimposing chains of fragments in a head-to-tail arrangement.

structural alphabets are fragment libraries composed of a relatively small number of fragments that complement each other to form a 'universal code' of local conformations. several structural alphabets have been derived  <cit>  using methods such as cluster analysis  <cit> , kohonen maps  <cit>  and hidden markov models  <cit> . generally machine learning strategies yielded better performing alphabets at the price of an indirect description of the conformational space. despite the relative novelty, the potential of structural alphabets has been exploited for decoy generation  <cit> , local structure prediction  <cit> , sequence-based structural comparison  <cit> , combined sequence-structure alignments  <cit> , 3d structure alignment  <cit> , structure mining  <cit> , structure reconstruction from cα  <cit> , fold classification  <cit> , fold prediction  <cit> , structure generation  <cit> , de novo prediction  <cit> , de novo backbone design  <cit> , but not yet for molecular motions and conformational transitions. therefore, a description of high quality structural alphabets is needed that allows for a projection of these properties into the conformational space of the alphabet, which would facilitate the development of applications that combine a static and dynamic description of proteins.

in this paper we devise a simple and explicit description of four-residue long fragments, the conformation of each being defined by three internal angles. all protein fragments were mapped as points in a three-dimensional space of these internal angles. structural alphabets were extracted directly from the conformational attractors on that fragment map and assessed in terms of their accuracy in reconstructing protein structures. a performance comparison was made with other structural alphabets of four-residue fragments. finally the suitability of our best performing alphabet for the description of protein dynamics was assessed by encoding the different structures in a test set of conformation ensembles and measuring the correlation between local flexibility and encoding variability.

methods
dataset
a reference set of high quality protein structures was selected from astral scop  <dig> , which includes domains with less than 10% sequence identity  <cit> . the degree of quality was measured by the summary pdb astral check index   <cit> . this index provides information on the reliability and precision of protein structures. it includes three contributions: the quality of the experimental data , the quality of the fitting procedure , and the quality of the deposited model structure . only x-ray structures with complete backbone chains and spaci quality scores >  <dig>  were included, yielding a total of  <dig> protein domains. the list of scop ids is available for download at http://mathbio.nimr.mrc.ac.uk/download/mk.dataset.txt.

the dataset of local structures was defined as the collection of all four-residue long fragments within the reference set. a fragment is represented by the cα atoms of four consecutive residues. to avoid sampling bias and to allow for reconstruction, the extracted fragments may overlap in the source structure and neighbouring fragments share three atoms. for each fragment, three pseudo-angles were defined between their constituting cα atoms: the angle between atoms 1-2- <dig> , atoms 2-3- <dig>  and the torsion angle formed by atoms 1-2-3- <dig>  . angle values were computed via the cartesian coordinates of the cα atoms. note that these angles are not directly related to the ramachandran angles , as our fragment definition embodies a coarse grained representation of the backbone without consideration of the peptide bond geometry.

a molecule composed of n atoms possesses 3n degrees of freedom. removal of trivial rigid body motions and bond constraints yields  <dig> *  <dig> -  <dig> -  <dig> =  <dig> degrees of freedom, which are entirely described by the three independent internal angles ϕ <dig>  ϕ <dig> and θ. advantages of this representation are the conceptual simplicity, the ease of visualisation and the fast comparison of fragment geometries by angle differences instead of atom super-positioning.

density-based cluster analysis
cluster analysis of the fragments extracted from the selected set of  <dig> protein domains  was performed in the conformational space of the three internal fragment angles . the values of these angles were neither normalised nor standardised to preserve the original ratio between the variance in the torsional angle θ compared to the planar angles ϕ. this information is central to correctly detect the geometries associated with secondary structures and the transitions between them. a cubic grid with 2° resolution was defined to obtain an initial fragment density estimate. to reduce the computational complexity, irrelevant data were removed by an initial filtering step: those fragments in cubes containing in total less than  <dig> fragments were removed. the final dataset included  <dig> fragments.

extraction of a structural alphabet from the data cloud in this conformational space requires the identification of representatives within the high-density regions of point clusters. however, the data did not lend themselves to standard clustering methods, because of the large variation of cluster densities and the partial overlap of clusters with different densities. to overcome this problem, the optics  method was implemented in c and applied to the dataset. a flow chart of the algorithm is given in additional file 1: supplementary figure s <dig>  optics is based on a nearest neighbour walk through the data space, thereby ordering and recording pairwise point distances  <cit> . the approach is particularly suitable for the extraction of a structural alphabet, because fragments can be clustered hierarchically by density and representatives may be selected amidst the highest point densities. the algorithm requires only two input parameters: a neighbourhood radius  and a minimum number of neighbour points . we set ε to 200°; since the largest angular rmsd in the dataset is 78°, each point is reachable and this parameter had no influence on the results.

briefly, the algorithm starts at a random data point, calculates the distance to all points within the neighbourhood radius  and, if at least a minimal number of points  is encountered, it records the nearest neighbour distance  and the smallest radius that encircles minpts objects . if less than minpts points fall within ε, the point is considered as noise. the algorithm repeats the same procedure for the nearest neighbour point and proceeds iteratively until all data points have been visited, thereby generating an ordered list. our specific choice of ε implies that none of the fragments is labelled 'noise' and each is included in one cluster at least. this choice allows to scan afterwards for clusters at any density. distances dij were calculated as the root mean square deviation in angular coordinates  between fragment pairs. angle differences of ϕ <dig> and ϕ <dig> naturally fell into the value range  <cit> , while for θ periodicity was removed to retain the value range  <cit> . the ordered list of reachability distances  can be drawn as a comprehensive nearest neighbour distance plot .

structural alphabet extraction
the cluster structure emerges directly from the reachability plot. a variant of the drop-down algorithm  <cit>  was implemented to extract the clusters and their representatives. the idea behind this algorithm is to hierarchically extract the clusters by progressively increasing a density threshold. given a density threshold value, a cluster is defined by a contiguous series of  points having a density above the threshold. the algorithm works as follows:

 <dig>  generate a list in which the fragments are sorted by decreasing reachability distance  with 'merge sort'.

 <dig>  parse the sorted list to find two fragments that are more than minpts apart in the reachability plot; these fragments enclose a candidate cluster.

 <dig>  if the size of the candidate cluster is at least minpts smaller than the parent cluster, label the candidate cluster as accepted cluster and remove all its points from the sorted list.

 <dig>  repeat  <dig> until reaching the end of the sorted list.

in the first iteration, the entire reachability plot is scanned for root clusters; in following iterations, new clusters are extracted by processing the clusters that were identified at the previous step. the fragment with the lowest core distance  is taken as the representative of a cluster.

redundancy removal
as previously reported  <cit> , the distribution of pairwise euclidean distances between short protein fragments of fixed length is multi-modal, with one peak corresponding to intra-cluster distances  and the others to inter-cluster distances . using the same principle, we derived a cutoff distance to remove redundant representatives from our set.

the distribution of pairwise distances was calculated for a random sample of  <dig> fragments from the dataset. the euclidean distance between the cα atoms after optimal superposition of all fragment pairs was computed. the resulting distance distribution of the intra-cluster peak is log-normal for values smaller than  <dig>  Å and it was fitted using the maximum-likelihood method of the r  <cit>  package mass  <cit> .

occurrences within one standard deviation  account for 84% of the data and  <dig>  Å was selected as the redundancy distance cutoff for cluster representatives.

assessment by fit quality
the quality of a structural alphabet is generally assessed by its accuracy in approximating real protein structures. for this purpose the performance measure previously used by other authors was adopted: local fit and global fit accuracy  <cit> . a local fit is obtained if each position of a given protein structure template is overlaid with the best-fitting alphabet fragment. the coordinate root mean square deviation  on the position of each cα atom from the template protein is then calculated. a global fit is obtained if the best-fitting sequence of fragments is given and the protein structure is reconstructed by progressively overlaying the ends of neighbouring fragments in the sequence. in this case the crmsd value is calculated after aligning the reconstructed structure with the template.

in both cases the median of the protein rmsd fit was calculated for a test set including  <dig> proteins from astral scop superfamily level with spaci scores > <dig>   <cit> . dataset and test set did not overlap. the list of scop ids of the test set is available for download at http://mathbio.nimr.mrc.ac.uk/download/mk.testset.txt.

for this analysis the global fit procedure described by  <cit>  was implemented in c. whenever possible, rmsd calculations were performed with theobald's fast quaternion method  <cit> . a heap size of  <dig> was used to ensure convergence of the encoding.

assessment by information content
the performance of a discrete state model  is a trade-off between the complexity invoked by its number of states and the ability to describe reality as reflected by its fit quality. a suitable metric for this trade-off is akaike's information criterion , an entropy based measure of the goodness of fit for a given model with a varying number of parameters  <cit> . being grounded in information theory, it provides a relative measure of the information loss by using the model instead of the real data. the general expression for a model with k parameters and a maximum likelihood l  reads:   

if the model errors are normally and independently distributed, the aic can be expressed in terms of the n residual errors of the fit  as   

the structural alphabets obtained for different values of minpts were ranked according to their aic. the residual errors were calculated in the form of a local fit rmsd of the  <dig> fragments in the dataset. the structural alphabet with the lowest aic was selected as the most informative alphabet, providing the highest fit performance for the lowest number of constituting fragments.

genetic algorithm optimisation of combined fragments
to overcome any potential bias by the hierarchical cluster extraction, all fragments of the alphabets obtained with minpts parameters in the range  <cit>   were submitted to a global optimisation within the framework of a genetic algorithm  <cit> . the purpose of this optimisation is an independent alphabet derivation to verify that any potential methodological biases of the described optics selection do not interfere with the performance of the selected alphabets.

the target size of the optimised structural alphabet was  <dig> fragments to match the size of our best performing alphabet . each fragment was represented by a gene in the form of a binary number, where  <cit>  indicates either inclusion or exclusion with respect to the final subset. the fitness of the genome was calculated as the average local fit on the  <dig> top quality proteins  in astral scop  <dig>  which cover a diverse set of folds. the ga was run three times with a population size of  <dig> genomes over  <dig> generations, cross-over breeding of the fittest 5% genomes and elitism . the algorithm converged to a unique solution in  <dig> generations. the optimised subset was assessed by local fit, global fit and aic.

analysis of native contacts and intrinsic flexibility
the local and global fit accuracy are robust and general measures of reconstruction quality. for applications other than reconstruction, specific quality measures should complement the assessment. the structural alphabets introduced here are intended to also capture the intrinsic flexibility of protein structures. this implies that the network of interactions in the native structure is correctly described in the reconstructed structures. therefore, reconstructed structures were assessed in terms of their dynamics and residue interactions. a useful approach to test this is provided by the gaussian network model   <cit> . with this simple but elegant model it is possible to calculate the protein contact map and to derive an estimate of the root mean square fluctuation  of the atom positions directly from a single structure.

in the gnm a protein of n residues is described by an elastic network where residues become nodes linked by harmonic springs. each node is subjected to gaussian fluctuations around its equilibrium position, defined by the coordinates of the cα atoms in the protein structure. the model is isotropic and has n degrees of freedom describing the amplitude of the fluctuation of each node. the force constant of the spring  is generic and identical for each residue type. the associated inter-residue interaction potential is:   

where Δr is an n-dimensional vector whose ith element is the fluctuation vector Δri of the individual residue ith, and Γ is the n × n kirchhoff contact matrix with elements   

where dij is the distance between residues i and j and the cutoff distance rc is  <dig> Å. the cross-correlation of fluctuations between residues i and j can be calculated from   

where kb is the boltzmann constant and t is the absolute temperature. accordingly, the mean-square fluctuations of the cα atoms can be extracted from the diagonal elements of Γ- <dig>   

estimated rmsfs and cross-correlation matrices were analysed for  <dig> pairs of native and reconstructed proteins from astral scop superfamily level with spaci scores > <dig>  . the agreement of the rmsf profiles was measured by the pearson correlation coefficient, while the similarity of the cross-correlation matrices was calculated by matrix overlap  <cit> :   

where a and b are the matrices to compare, tr is the trace operator and d is the matrix difference:   

the overlap ranges from  <dig>  to  <dig> .

analysis of conformational states in structural ensembles
the suitability of the proposed structural alphabet to analyse protein dynamics was further tested by investigating both the robustness of the fragments to small fluctuations and their ability to describe conformational transitions. to limit the computational effort, the analysis was performed on a set of  <dig> proteins. the conformational space of each protein was explored with the tconcoord method  <cit>  that provides a more accurate model than gnm, since an all-atom representation of the system is used and anharmonicities in atom motions are allowed, but it is still simpler and faster than molecular dynamics  simulations.

in tconcoord, ensembles of structures are generated by fulfilling a set of distance constraints between atom pairs. the permitted distance intervals are determined on the basis of the distance values found in the starting structure and of the type of the interaction , so that lower tolerances are used to describe stronger interactions. all the contacts in the original structure are preserved, except for 'under-wrapped' hydrogen bonds  <cit>  which are considered unstable since they are not sufficiently shielded from the environment by hydrophobic groups. it has been shown that the detection of unprotected hydrogen bonds, together with the calibration of the distance constraint definition, allows the prediction of conformational transitions  <cit> . moreover, even if the molecule description is less accurate than that provided by the force fields generally used in md simulations and there is no explicit representation of the solvent, the collective motions and the overall rmsf profiles extracted from tconcoord ensembles have been found in good agreement with both md and experimental results  <cit> .

the test set of  <dig> proteins was extracted from a larger dataset of proteins annotated in the pisite database  <cit>  and currently used by the authors to study the role of flexibility in protein-protein interactions. to avoid the introduction of biases due to the over-representation of some secondary structure types or of some folds, the first four classes of scop  were equally represented and a given fold was considered only once . moreover, within each group of six proteins belonging to the same scop class, it was ensured that the distributions of the total number of residues and of the ratio between structured  and unstructured  regions was covering a wide range . after full protonation and energy-minimisation with the gromacs  <dig> . <dig> package  <cit>  and the opls-aa force field  <cit> , tconcoord ensembles of  <dig> structures were generated for each protein.

h+e/l: ratio between regular  and irregular  secondary structure elements according to dssp  <cit>  ; size: number of residues.

a 'per-fragment' flexibility profile was obtained for each protein by calculating the rmsfs of cα over n- <dig> sliding windows of  <dig> residues. the roto-translational motion was eliminated by least-square superposition of the fragment in each frame to the reference starting structure. the value assigned to each window was calculated as the quadratic mean of the rmsf values of each cα in the fragment.

for comparison, for each protein the structures in the ensemble were encoded into structural strings by both local and global fit procedure as previously described . conversely to the encoding of a single structure, in the ensemble a given fragment position can be generally described by different letters. the letter variability per fragment was evaluated through the shannon entropy  <cit> :   

where pij is the fraction of structures where fragment i was encoded by letter j and k is the total number of letters in the alphabet.

RESULTS
structural alphabets from conformational attractors
a plot of the conformational space of  <dig> fragments derived from a set of  <dig> high-resolution structures sampled from sequence-unrelated protein domains  is shown in figure  <dig>  the overall clustering of the fragments at conformational attractors is clearly visible. the existence and location of the high density regions around these attractors is an intrinsic property of the conformational space and it is within the tested limits independent of the dataset size and the resolution of the contained structures . one can readily identify main clusters around fragment conformations typically found in protein structures: helix, turn, extended and loop, as illustrated by the ball-and-stick models of the representatives of these clusters on the right panel. although the main fragment clusters are already informative, their fine structure needs to be resolved computationally to extract fragment alphabets with a high information content .

using the density clustering method optics  <cit> , a comprehensive and sorted density plot  of all fragments was obtained . the point density is approximated by a nearest-neighbour distance , measured as a euclidean distance in the internal angle space  of the fragments' degrees of freedom . the reachability plot shows the fine structure of the optics data clustering.

this density plot was then processed with a variant of the drop-down algorithm  <cit> , in which a density threshold was progressively increased, to extract the cluster structure . a diagram of the hierarchical extraction is presented in the top panel of figure  <dig>  the resulting fragments and their location in the reachability plot are shown in the middle panel. in this scheme, frequently occurring fragments are selected first, rarer conformations later, which can also be interpreted as the importance of the attractor  in the conformational space. the collection of extracted fragments forms the structural alphabet. the rugged fine structure of the data density combined with the sensitive clustering method yielded some representatives with near-identical conformations. a plot of all pairwise fragment distances  in the dataset showed that the intra-cluster peak follows a log-normal distribution; fragments were deemed redundant and removed if their distance to an accepted representative within the intra-cluster peak was shorter than a cutoff value . an example of the distribution of fragments of a structural alphabet is shown in figure 2; each fragment is indicated by an annotated circle. it is noticeable that the fragments representing helical conformations  are spaced much closer than those of extended conformations . helical conformations can be well represented by a few similar states, while extended conformations are more versatile and require more representatives to capture the variability of strands in proteins.

the minpts parameter was used to fine-tune the extraction of structural alphabets to specific densities. we generated reachability plots for values of minpts in the range 10- <dig>  structural alphabets derived for minpts values >  <dig> contain too few  fragments and already those derived for values >  <dig> show an unsatisfactory performance in reconstructing protein structures . therefore, only results for minpts values in the range 10- <dig> are reported here. our alphabets are named according to their minpts parameter and size, for example 'm32k25' for minpts =  <dig> and k =  <dig>  a comparison between the location of the fragments of three structural alphabets relative to the conformational attractors is given in figure  <dig>  the m32k <dig> set is compared with two alphabets from the literature of size  <dig>  and  <dig> , both composed by fragments of four cα. the centering of the m32k <dig> representatives at data clusters is clearly visible.

structural alphabet performance assessment
structural alphabets capture the essence of conformational variability of the folded protein backbone in a small number of states. by extracting the states of highest density as representatives, we maximise the probability to match this state in any given structure. therefore, in terms of a structural alphabet, a protein structure can be thought of as a sequence of conformational states and the representation of a protein structure can be reduced to a string of alphabet characters . this translation can be thought of as an encoding, achieved by matching the best fitting alphabet fragment to each position of the protein structure. this can be done for each position independently  allowing for non-exact fragment overlaps, or by searching for the sequence of fragments that comprehensively best approximate the geometry of the template structure  with exact fragment overlaps. in both cases the crmsd between fitted and template structure is a measure for the error associated with the encoding. the two fit procedures exemplify also two extreme cases of the structure prediction problem: local and fold prediction. as the aim of this work is not to provide a new tool for structure prediction, these two fit assessments should not be interpreted as a measure of the predictive ability of the alphabets; further tests would be required to validate the alphabets in the context of fold prediction.

the global fit error is generally higher than the local fit error, because it incorporates the deviation between the alphabet fragments and the template structure  and additionally the deviation arising from the neighbour fragment super-positioning. the global fit error is therefore a more stringent measure for the assessment of an alphabet's performance. an example of a typical local/global fit reconstruction is shown in figure  <dig>  the quality of each structural alphabet was assessed by its ability to approximate real protein structures both by local fit and global fit reconstruction  <cit>  on a test set of  <dig> high quality protein structures. a summary of the assessment is reported in table  <dig> and the complete table for minpts 10- <dig> is included as additional file 1: supplementary table s1; for each set the alphabet size  is given as well as the median and inter quartile distance  of the crmsd distribution. these are robust statistical results unaffected by the presence of outliers. the structural alphabets cgt <dig> and msm <dig> from the literature are included for comparison. since the fit results are equivalent whether done in the form of crmsd or armsd , we decided to employ the former for compatibility with previous studies  <cit> .

: median crmsd, iqd: inter-quartile distance of crmsd; aic: akaike information criterion. alphabets are labelled with their minpts parameter value  and alphabet size . the literature alphabets cgt <dig> and msm <dig> are of size  <dig> and  <dig>  respectively. best performing alphabets are highlighted in bold font.

for all fragment sets the quality of the global fit is comparable to the experimental uncertainty in protein structure determination: the median crmsd is in the range  <dig> - <dig>  Å with an iqd in the range  <dig> - <dig>  Å. the local fit results show that a representative fragment can be found for any local conformation with an average fit error in the range  <dig> - <dig>  Å.

the size of a discrete state model is a trade-off between performance and complexity. a plot of the fit accuracy as a function of alphabet size is given in figure  <dig>  as predicted, the median crmsd is generally decreasing when more representatives are included in the alphabet, but the trend is reversed beyond size  <dig>  this is consistent with a density-based approach: as we increase the density cutoff, the fitness of the model increases by including still informative but rarer states until a global optimum is reached, after which any new states are not providing more information but add to the complexity.

other groups have devised optimal alphabets of size  <dig>  <cit>  and  <dig>  <cit> . while in those studies the identification of the optimal size was not done by fit performance, it is noteworthy that the range of optimal values is similar to the one identified by optics.

to correctly define the global optimum  we used akaike's information content  that allows comparison of fitness models having a different number of parameters. the results are reported in figure  <dig>  the trend is similar to the global fit plot in figure  <dig> and confirms that the alphabet m32k <dig> derived for m =  <dig>  and k =  <dig>  is performing best. in terms of the aic, this alphabet  is roughly equivalent to the alphabet cgt <dig>  <cit>  . m32k <dig> is shown as a black triangle in figure  <dig> and  <dig> 

the robustness of the aic test was confirmed by bootstrapping. the results of  <dig> bootstraps are reported as error bars in the plot in additional file 1: supplementary figure s <dig> 

structural alphabet m32k25
the location of each of the  <dig> fragments of the m32k <dig> alphabet in the conformational space is illustrated in figure  <dig>  where the fragments are labelled by capital letters according to their order in the reachability plot . angle values are reported in table  <dig>  the alphabet includes representative fragments for each of the populated conformations, sampling both dense and sparser regions. one can discern seven areas : , , , , , , . these areas correspond to valleys in the reachability plot  that are separated by peaks of inter-cluster distances.

while all three angles  are needed to fully describe the variety of conformations, the torsion angle θ provides most of the information. this is confirmed by the order of fragments in the reachability plot and illustrated by the selected fragments on the right panel of figure 2: the order extended , loop , helical  and turn  corresponds to a progressive decrease of the torsion angle θ.

this is also consistent with the secondary structure attribution of stride  <cit>  to the  <dig> proteins included in the test set: fragments  generally encode for strand-like regions,  for loops,  for helices and  for turns. a detailed bar plot of the fraction of secondary structures associated with each letter of the alphabet is shown in figure  <dig> 

as previously reported  <cit> , one should not expect a strict correspondence between the states in a structural alphabet and those obtained from secondary structure assignment for the same local structures. the possibility to fit some of the fragments to different structural environments is important to achieve high accuracy in protein reconstruction.

optimisation of combined alphabets
to investigate how the hierarchical cluster extraction scheme has biased the alphabet selection, we performed a separate extraction. a genetic algorithm optimisation was performed on the collection of all non-redundant fragments of all alphabets within the minpts range 10- <dig>  the optimisation was designed to select those  <dig> out of  <dig> fragments in the collection that yield the best local fit score on a set of  <dig> high quality structures.

the resulting alphabet  was assessed by local fit, global fit and aic performance . the improvement in local fit  and global fit  is smaller than the variance in the corresponding fit processes and the aic difference is also relatively small . the ga optimised set is indeed equivalent to the m32k <dig> alphabet, confirming the results of the hierarchical extraction procedure.

intrinsic flexibility of reconstructed proteins
the fit assessment is a simple and robust method to measure the accuracy of a structural alphabet in approximating real proteins, but it does not guarantee that all native features are correctly reproduced in the reconstructed structure  <cit> .

while the m32k <dig> alphabet has satisfied the necessary requirement of reconstructing static structures within the experimental error, it is important to validate its ability to capture the intrinsic flexibility of proteins. this can be done by comparing the flexibility of the native and reconstructed structure: the dynamical properties should be unaffected by the discretisation imposed by the structural alphabet. an elegant and fast method to perform such an analysis is provided by the gnm  <cit> , that has already been used in several structural studies  <cit>  and proven to be a reliable approximation for the dynamic properties of proteins.

for our purpose, the cross-correlation of atomic fluctuations was derived by applying the gnm and compared in the native and reconstructed structures . both the atomic rmsf profiles and the cross-correlation matrices demonstrated the suitability of the m32k <dig> encoding. the reconstructed structures preserved the required native features: both the rmsf correlation  and the matrix overlap  are close to  <dig> for a large set of high quality structures. the former correlation is also higher than the one reported with b-factors  <cit> , confirming that the encoding error is within the experimental uncertainty. additionally the two indices are independent of the global and local fit quality measures .

this is also an indirect test of the ability of a structural alphabet encoding to preserve native contacts. indeed in this harmonic model the conformational freedom of each atom is a function of the number of neighbour interactions  <cit> . the preservation of native contacts is a necessary precondition to obtain similar flexibility profiles.

for comparison purposes, this test was performed also on the structural alphabets cgt <dig> and msm <dig>  both alphabets performed as well as the m32k <dig> in preserving the native contacts and the intrinsic flexibility. the rmsf correlations were  <dig>  ±  <dig>   and  <dig>  ±  <dig>  , while the matrix overlap was  <dig>  ±  <dig>  for both.

while with a different aim and procedure, a previous study  <cit>  has also highlighted that pairwise contact specificity is greater in terms of structural letters than amino acids.

accuracy and robustness in encoding structural ensembles
to be able to capture the dynamical behaviour of a protein, a structural alphabet should be stable to small fluctuations on one side and it should reproduce transitions between different states on the other. thus a first requisite of an alphabet is that, when used to encode different structures in a conformational ensemble, the variability of the letters is correlated with the flexibility of the position that they describe. this means that a position encoded by many different letters should also show large fluctuations. on the other hand, if a fragment is relatively rigid, only few letters should be sufficient to accurately represent it. we analysed the relationship between flexibility profiles and encoding variability by generating ensembles of  <dig> structures for a set of  <dig> proteins with the tconcoord method. this relies on a more accurate description of the molecule than the gnm approach used in the previous section. moreover, it allows the breaking of native contacts, so that the generated ensembles contain also transitions between significantly different conformations. a generally good agreement has been found between tconcoord and molecular dynamics   <cit> . however the aim of the present test is to assess the performance of the alphabet in reproducing structural variability in ensembles, independently from the method used to generate them. finally, since the increased computational cost of tconcoord prevented its application to the entire dataset used for the other alphabet assessments, a limited number of proteins had to be selected.

correlations were calculated between the rmsfs of the fragments' geometries and the shannon entropies of their encodings . since the pure roto-translational motion of a given fragment does not contribute to a letter change in the encoding, it was eliminated in the rmsf calculation. encodings using both local and global fit reconstructions were performed with the m32k <dig>  cgt <dig> and msm <dig> alphabets. from figure  <dig> and  <dig>  it is evident that the three alphabets have different performances. moreover, the degree of the correlation does not mirror the accuracy of the reconstruction . when the structures are encoded by local fit , both the m32k <dig> and the msm <dig> alphabets show good correlation coefficients, which are below  <dig>  only in four cases for m32k <dig> and in three cases for msm <dig>  smaller values are generally found for cgt <dig>  whose performance is comparable to the other two only for the β class. conversely both m32k <dig> and msm <dig> better perform for proteins that contain α-helices . overall, m32k <dig> has the highest correlations in  <dig> cases, msm <dig> in  <dig> cases and cgt <dig> in  <dig> case. however, differences between the m32k <dig> and msm <dig> values are often very small. when the global fit encoding is employed , the correlation values decrease for all alphabets: the reduced accuracy in the representation of the local structure required by a "seamless" reconstruction is a further source of letter variation, not necessarily related with the real flexibility of the fragment. the reduction in correlation affects more the msm <dig> alphabet, so that now m32k <dig> has the best performance in  <dig> cases, msm <dig> in  <dig> cases and cgt <dig> in  <dig> cases.

r and r: pearson correlation coefficients between fragment rmsf and shannon entropy of local fit  and global fit  encoding.

: median crmsd, iqd: inter-quartile distance of crmsd. values from the m32k <dig>  cgt <dig> and msm <dig> alphabets are calculated by local fit  and global fit  encoding.

when correlations are calculated per protein rather than per residue, i.e. by comparing the average protein rmsf with the average entropy , good results are again obtained for m32k <dig> and msm <dig> with correlations greater than  <dig> . in this case the m32k <dig> alphabet best performs independently from the type of reconstruction. correlation values are much smaller for the cgt <dig> alphabet, in particular if the entropy from local fit encoding is considered.

discussion
we have derived the structural alphabet m32k <dig> from the conformational attractors of protein structures. the intention of our approach was to devise a simple and generic description of local conformations that is readily amenable to visualisation and computational analysis. a solution was found in the conformational space spanned by three internal angles corresponding to the fragment's degrees of freedom.

the optics algorithm provided two important functions for the analysis of the data space. firstly, cluster representatives were extracted in the order of decreasing density, which is equivalent with decreasing importance for encoding. secondly, the unique data ordering corresponds to a minimum distance path, providing a gradual inter-conversion among the states. therefore, despite the mutual independence between fragments, the resulting structural alphabet includes important connective fragments to allow for a smooth protein reconstruction. connectivity is partially implied by the overlap of neighboured fragments in the original structures: the ϕ <dig> angle of a fragment in a given structure is identical to the ϕ <dig> angle of the next c-terminal fragment. the addition of a structural alphabet fragment to a growing reconstruction model adds one unconstrained atom  and two unconstrained angles ϕ <dig> and θ .

the optics algorithm has been recently applied for sequence clustering  <cit> , but to the knowledge of the authors, this is the first use in structural bioinformatics and it suggests a general suitability of density-based approaches for protein structure analysis.

a further objective of this study was to minimise the number of free parameters in design and analysis. excluding the descriptive conformational parameters , only the minpts parameter influenced the set of representative fragments. we explored the range of suitable values for minpts and selected the most informative alphabet. the high entropy of the m32k <dig> alphabet allows for protein reconstruction with an error comparable to that of structure resolution techniques. theoretical studies on small libraries of local structures  <cit>  predict the global fit accuracy for an alphabet of this size to  <dig>  Å in agreement with our results .

a comparison can be drawn directly only to other alphabets composed by fragments of the same type, i.e. of length four cα atoms. previous structural alphabets used a fragment representation in the form of a set of cartesian coordinates  or of a four-vector descriptor composed of three not-consecutive cα-cα distances and the projection of the fourth atom onto the plane formed by the other three . our angular representation has the advantage of being an internal metric that is independent of the molecular orientation, as for cgt <dig>  but with only three parameters. the other alphabets include collections of  <dig> fragments  and  <dig> fragments, while our best alphabet m32k <dig> includes  <dig> states. the performance as measured by the global fit  is  <dig>  ±  <dig>  for m32k <dig>   <dig>  ±  <dig>  for cgt <dig> and  <dig>  ±  <dig>  for msm <dig>  indicating that the m32k <dig> alphabet achieves similar or better performance with only  <dig> states.

but the main difference between the m32k <dig> alphabet and other structural alphabets is its stringency in the representation of high density states as shown by the fragment locations in figure 4: other approaches were equally successful in describing only some of the attractors. the efficiency in our extraction was achieved by including a minimal number  of the most informative  degrees of freedom to describe each fragment and by analysing selected high quality structures.

associating physico-chemical properties to the m32k <dig> fragments automatically maps these properties onto the most important conformational states. the simplicity of this mapping together with the option to visualise the map should be useful for protein structure analysis and design.

the main advantage of a density-based selection is the ability to directly capture the most highly populated conformations; these have also a higher chance to be sampled during protein dynamics. borrowing anfinsen's 'thermodynamic hypothesis' one may speculate that the alphabet fragments correspond to low energy conformations, because proteins can be reconstructed using solely these fragments.

we investigated the suitability of the m32k <dig> alphabet and its associated mapping in the analysis of conformational ensembles of protein structures.

a precondition for this type of conformational analysis is that the alphabet encoding can correctly preserve the intrinsic flexibility of a protein structure. this was demonstrated for the m32k <dig> by an assessment based on gnm calculations: the native contacts and the flexibility calculated with this harmonic model were completely preserved in the reconstructed structures. an extension of the gnm calculations to structures reconstructed with the cgt <dig> and msm <dig> alphabets also suggests that this fidelity is a general property of structural alphabets, but not directly correlated to the accuracy in fit reconstruction. a previous study  <cit>  has also demonstrated that the cgt <dig> alphabet has more specificity than the amino acid code in capturing inter-residue contacts in protein complexes.

the ability to capture the dynamical behaviour of a protein was tested by encoding the different structures in conformational ensembles generated by tconcoord. we measured the accuracy and robustness of m32k <dig>  ctg <dig> and msm <dig> alphabets by the correlation between the shannon entropy of the encoded ensemble and its fragment flexibility in terms of rmsf.

correlations are generally higher for local than global fit encoding, because optimal global reconstruction is achieved at expense of local accuracy. this suggests the importance of designing strategies to estimate the weight of this inaccuracy in the encoding. all three alphabets have comparable results for β-class proteins, but the performances are significantly better for m32k <dig> and msm <dig> in the other scop classes. where the former has the best performance in global fit and the latter in local fit .

m32k <dig> is the more efficient in capturing the average flexibility per protein .

the performance difference between the structural alphabets can be explained in terms of robustness. a set of representatives that efficiently samples the conformational space with low redundancy will be less affected by small fluctuations, while a set that contains groups of relatively similar fragments describing the same state will tend to overestimate the conformational difference. this is a possible explanation for the performance of cgt <dig> for α-helix containing proteins: the alphabets includes a group of closely located fragments in the α region of the  space . on the contrary a set of well spaced fragments does not imply an accurate encoding. the good performance of msm <dig> does not correspond to a good accuracy in the reconstruction .

the fragment composition of a structural alphabet is dependent on the type of strategy employed to select conformational representatives. this can affect the overall encoding stability. both m32k <dig> and msm <dig> were derived by indirectly maximizing the geometrical diversity, while cgt <dig> was optimized for statistical representativity. the former strategy provides a clear advantage in terms of encoding stability at the expense of a minor  to significant  decrease in the encoding accuracy, while the reverse is true for the cgt <dig> set: the inclusion of statistically significant but geometrically similar helical conformations can decrease the stability but provides a very accurate description of linear, kinked and curved helices  <cit> . this limitation in encoding stability could be overcome by considering the states as not strictly independent and consequently by either weighting their contributions according to their geometrical dissimilarity or by constructing a suitable substitution matrix. a successful example of the latter approach has been already used in the context of 3d structural alignment  <cit> , where the performance of string-based structural comparison was increased allowing non-exact matches by means of a structural alphabet substitution matrix.

we do not aim to provide an alternative framework for structure prediction, but a novel tool for studies of protein structures and their dynamics. the addition of this newly designed assessment to the ones previously proposed in the literature is in line with the purpose of our alphabet. the density-based m32k <dig> alphabet has proven to be accurate for protein reconstruction and stable for ensemble encoding. the combination of these features suggests that m32k <dig> is specifically suitable for studies of protein dynamics.

CONCLUSIONS
the density-based structural alphabet provides a two-fold advantage: ensembles of protein structures can be encoded with high accuracy and sufficient robustness to correctly describe local flexibility.

future developments may involve the employment of this structural alphabet to analyse and annotate structure ensembles from molecular simulations to easily map molecular motions onto the fragment space. the attractors can act as a guide to classify dynamics features and to compare protein families or different energetic states of the same protein. this can help in understanding, for example, binding specificity to multiple partners or conserved biological mechanisms.

authors' contributions
ap and jk jointly conceived the study and implemented the code. ap and af designed and carried out the data analysis. ap, af and jk wrote the manuscript and approved the final version.

supplementary material
additional file 1
supplementary tables and figures. the file contains figure s1: flow-chart of the optics algorithm; figure s2: projection of astral scop  <dig> fragments into the conformational space of the internal angles ; figure s3: akaike's information content  against alphabet size  with bootstrapping; figure s4: comparison of the armsd and crmsd distribution of matched fragments for the local fit of the protein test set; table s1: performance assessment of structural alphabets in terms of the local and global fit quality; table s2: fragment statistics of alphabet m32k <dig> for local fit.

click here for file

 acknowledgements
we like to thank acc coolen, f fraternali, d frenkel and j macdonald for insightful discussions. we are grateful for funding by the european science foundation , the eu marie curie programme  and the leverhulme trust .
