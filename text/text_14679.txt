BACKGROUND
estimates of the taxonomy and the number of microbial taxa in metagenomic data often rely on 16s rrna molecules. taxonomic assignments can be evaluated by comparing the contigs assembled from the data to known ones, e.g. in the ribosomal database project  <cit> . however, in view of the taxonomic diversity observed in novel data, it is common to bin the observed 16s rrna into operational taxonomic units   <cit> , and use the latter for estimating the hierarchy and complexity of the data. the question of whether the 16s method should be the sole classifier of bacterial taxa identities has often been raised in the literature. in order to make sense of genetic and ecological variety, fraser et al.  <cit>  have argued that this should be only one of many considerations that have to be taken into account. in particular, other genomic information should be used. one of the problems associated with 16s is that there often are multiple copies of this gene in a single genome. their intragenomic variance leads to difficulties, hence case et al.  <cit>  suggested they should be replaced by the single-copy gene rpob, to provide an alternative phylogenetic tree. alternatively, a full proteomic analysis may be argued to provide an even better basis for phylogenetic studies  <cit> .

the alternative that we propose is based on aminoacyl trna synthetases . they are known to constitute an essential enzyme super-family, providing fidelity of the translation process of mrna to proteins in living cells. their importance to the understanding of evolution has been often emphasized in the literature  <cit> . here we make use of a particular subgroup of these enzymes, called s <dig> , that are single-genes, i.e. rarely exists more than once on bacterial genomes  <cit> . this subgroup contains the ec numbers  <dig> . <dig> x with × equal to  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  the single-protein property has been verified for all bacteria within swiss-prot to an accuracy of 98%.

having to deal with metagenomic data we employ a technology that identifies reads as belonging to aars enzymes by searching for the existence of specific peptides  on such reads  <cit> . we limit ourselves to sps of length nine amino-acids and more, ensuring that the probability of their appearance at random is negligible. this list , containing  <dig>  peptides, serves as a look-up table, whose elements are searched on all reads or contigs of the metagenome.

we will separately study the cases of short reads and longer genomic data . both share the same pre-processing stage, in which we turn all genomic nucleotide sequences into amino-acid strings using the six possible translation modes. we will refer to the latter as putative peptides . the sps that are observed to occur on the largest numbers of pps define groups of proteomic reads that form the basis of our calculation. the lower bound on the number of species and strains in the data is obtained by deducing how many different genes could have been responsible for the sets of sequences that have been observed.

there are two major differences between applying our methodology to short reads or to long contigs. in the case of short reads we identify all reads that share a single sp. a single sp of length l ≥  <dig> amino acids appears only once in a given gene. although there may be many sps belonging to the same ec we have to limit ourselves to only one of them in our counting procedure. this is because two short-sequences that contain two different sps can be part of a single gene. we then compare all the resulting reads and perform the counting by estimating the minimal number of different strings. since the reads are short, distinguishing between species belonging to the same genus is impossible. depending on the length of the short reads, chances are high however for distinguishing between different families, classes and phyla. for the case of long sequences or extensive contigs, we can search for sequences that share several sps of the same ec. here we run into the question whether sequences that differ by few amino-acids represent different strains of the same species or different species. we will confront all these issues. it should however be remembered that when we refer to our 'taxa counting' algorithm it may represent effective numbers of families, when applied to short reads, or effective numbers of species and their strains, when applied to long contigs.

in the following we address different aspects of the methodology offered here. in methods we present a brief review of sps and establish that sps of length of  <dig> amino-acids and more reduce the number of false positives to a bare minimum. we start the results section with a discussion of the taxa-counting algorithm. we establish the fact that taxonomic acuity depends on the length of the reads being analyzed. the shorter the reads length, the higher is the taxonomic level that can be analyzed. we then define the mathematical problem of taxa-counting, which is equivalent to finding the chromatic number of a graph, a well-known np-hard problem. we describe our algorithm on a simple example of short read metagenomic data.

we then turn to applying our methodology to long genomic contigs. we start with a study of an artificial metagenome composed of  <dig> annotated genomes, which we use to compare the 16s methodology with ours, pointing out the problem of distinguishing different strains from different species. we apply our analysis to the contigs published by a recent study of the human gut microbiome . qin et al. conclude that the cohort of bacteria in the study of  <dig> individuals contains  <dig> to  <dig> prevalent bacterial species, based on non-redundant protein contigs. applying our analysis to the same set of prevalent proteins we obtain lower bounds of the order of  <dig> species. using the set of all contigs, i.e. not just the prevalent set, we estimate numbers of different strains and species to be of the order of  <dig>  finally we process and analyze short read data of the same study  <cit> . we demonstrate how the method works on such data, increasing further the estimates of numbers of species. we show that errors in the data can be monitored and removed to arrive at a stable estimate of taxonomic counts.

the large bacterial diversity often leads to considerable debate on what "species" are and how they should be defined. our study derives its power from listings of species and strains in swiss-prot. thus the present conventional wisdom, as represented in this data-base, serves as our guidance. our primary goal is to estimate the number of taxa in a given metagenome prior to taxonomic identification. providing lower bounds should help to constraint and monitor other methods and techniques with which the method presented here should be integrated. community composition is our secondary goal. it is estimated both by comparing the experimental data to known databases and by using the taxa-specific peptides  methodology  <cit> .

RESULTS
taxa counting algorithm
taxonomic acuity and read length
as a preparatory phase of our analysis, we study pairs of bacterial enzymes of the s <dig> set from the swiss-prot data-base. each enzyme is assigned the taxonomic hierarchy phylum → class → order → family → genus → species. for each level of the hierarchy, we compare pairs of enzymes belonging to different lower levels of the hierarchy. for an identified single pair of proteins we select amino-acid sequences of size w  from the shorter protein, and count the total number of times that any of these sub-sequences appear in the longer protein without any modification. from this we deduce the probability that a given window had no identical match. summing over all windows and pairs of enzymes we define the probability of inequality, pine = ndif/Σ, where ndif is the number of windows for which no identical match was found, and Σ is the number of all windows over all pairs of enzymes compared.

for each of the w values displayed in figure  <dig> we present the probability of inequality, i.e. the probability that a pair of enzymes may be judged, on the basis of windows of length w, to be non-identical amino-acid sequences. these analyses were carried out for any two consecutive taxonomic levels in the hierarchy. we note from figure  <dig> that given short reads of  <dig> amino-acids we can tell apart different families at 80% probability and different genera at 50%, while for  <dig> amino-acids genera differentiation probability increases to 80% and family distinction is close to 100%. the higher end of the protein length scale is needed to distinguish species and strains, and will be further analyzed below.

taxa counting methodology
let us study a set of amino-acid sequences, all carrying the same sp. we define two sequences a and b to be consistent, a~b, if throughout the domain of their overlap they are identical with one another. otherwise, i.e. if within their domain of overlap there exists at least one amino-acid that differs between a and b, they will be designated as inconsistent, a × b. consistent strings may be combined  into a longer string  that could be part of a single protein. inconsistent strings belong to different proteins, which imply different taxa because they carry the same sp. the number of inconsistent combinations provides therefore a lower bound on the number of taxa. throughout this analysis we assume that all sequences are free of errors. we will return to the question of errors later on.

as an example consider the following sequence strings: a = a-s-b, b = a-s-b-c, c = d-s-b, d = s-b-e. a, b, c and d are the four studied sequences, and s represents the sp that is common to them. a, b, c, d, and e are different sub-strings. relationships among the sequences are: a~b, a×c, a~d, b×c, b×d, c~d. trying to fuse them into larger strings, we find that the smallest possible  fulfillment of these constrains is presented by two fused strings: ab = a-s-b-c, cd = d-s-b-e. hence a lower bound of two taxa is expected.

the taxa counting problem, as defined and exemplified above, can be cast into a graphical formulation. define the graph g =  where the vertices v are the sequences and the edges e are the inconsistency relations. thus the example described above can be represented by the graph a—c—b—d.

our problem is equivalent to finding the chromatic number of the graph, i.e. the minimal number of independent groups that cover the whole graph. this is also the minimal number of colors of v such that every two connected vs have different colors. in the simple example above the two colors specify ab and cd respectively. this is a well-known np-hard problem  <cit> . since, however, our problem deals with specific string structures, its solution can be readily estimated even for thousands of reads, as demonstrated below.

to explain our heuristic algorithm with a realistic example we study a set of rios mesquites metagenomic data  <cit> . using all short read genomic data, converting them to amino-acid strings in six possible ways, and searching for sp hits, we find the following example of  <dig> short reads exhibiting hits of the sp = fyalpqapq, associated with ec =  <dig> . <dig>  , displayed in table  <dig>  this is the largest number of short reads found to accommodate a single sp of s <dig> with length ≥  <dig> 

the first  <dig> rows display the short reads. the two last rows are fused strings of short reads used for solving the minimal chromatic number problem. entries in the last column indicate  <dig> independent sequences .

our method is to construct a set of fused strings of short reads, such that all are inconsistent with each other. their number constitutes a lower bound on the number of taxa. from table  <dig> we note that the following  <dig> short reads are inconsistent with all others and with each other:  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  hence they can be recognized as belonging to eight different taxa. eliminating them we are left with  <dig> short reads:  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  the relationships among them are displayed in table  <dig> 

our heuristic algorithm for solving the problem is based on proposing possible mergers of the short reads into a minimal number of fused strings, proceeding along the following steps:

1) organize consistency relationships in blocks.

2) sort short reads by their length in ascending order. 

3) for each row, combine short reads with one another and construct fused strings:

a) within a row, short reads that are substrings of the longest short reads are fused into it. here,  <dig>   <dig> are included in  <dig>  and eliminated from further consideration.

b) remaining short reads are candidates for possible prolongation of the longest one, creating a new fused string. here  <dig> can be prolonged by  <dig>   <dig>  and  <dig> can be prolonged by  <dig>   <dig> as well. the latter was the arbitrary choice made in table  <dig>  in general proceed according to size of blocks and size of short read, which in this case were the same.

4) check if in the resulting list of strings all are inconsistent with all. otherwise reiterate. here reiteration is unnecessary; hence we conclude that the smallest number of possible taxa is 8+ <dig> =  <dig> 

the fused string procedure bears similarity to known contig assembly procedures. nonetheless note that a major difference is that all strings contain the same sp, and no other strings are being used. moreover, since we will apply the method also to long strings that are contigs to begin with, we keep the term 'fused strings' in order not to confuse them with other assembly procedures.

a complete description and matlab code of the algorithm is available online at: http://horn.tau.ac.il/sc.html. it takes seconds to run on the problem of table  <dig>  more complicated problems, such as the many long contigs whose results are displayed figure  <dig>  are completed within a minute on a pc. existing heuristic algorithms for solving a general chromatic number problem are limited to less than  <dig> vertices. we have compared our results on tens of contigs in the gut microbiome project  with those of the chromatic number algorithm on maple  <dig>  and verified that they agree with each other.

taxa counting on contigs
comparison of the 16s rrna and s <dig> sp methods on an artificial metagenome
to elaborate on the differences and similarities between our method and the conventional method based on the analysis of 16s rrna genes, we have analyzed an artificial metagenome composed of  <dig> genomes of species and strains . taxa were selected such that they fairly represent the bacterial taxonomic diversity across the tree-of-life  <cit> . for some of the principal phyla, we have selected pairs of strains of the same species, such that the resolutions of the taxonomic delineation of the two methods can be tested and compared.

kegg code and taxa names are given in the first  <dig> columns. last three columns display the results of the two methods. blast 16s analysis : strains of the same species that were both fully matched  to the same 16s rrna query hence cannot be distinguished. additional taxa that cannot be distinguished at an identity threshold of 99% are also indicated. 'v' represents taxa distinguished from each other with an identity level > 99%. s <dig> peptide analysis : strains of the same species that were fully matched, i.e. no difference between the corresponding two sequences exist within the tested range . additional strains that cannot be distinguished if up to  <dig> amino-acid differences are allowed between the sequences . 'v' represents taxa distinguished from each other with an identity level > 99%. last column: sp identification of the sequence.

full dna sequences of all taxa were analyzed by the two methods. following the conventional method we have retrieved the full length 16s rrna sequences for all  <dig> selected taxa ). blast search was then used to map the 16s rrna genes to the artificial database which contained the complete dna cohort of these  <dig> taxa. we have analyzed the results after initial filtering by requiring identity match > 97% and 80% alignment overlap, considering the length of the query sequence. for each taxon we identified at least one 16s rrna copy that was fully matched to the right dna sequence . however, in several cases a 16s rrna sequence has a match with more than a single taxon. we found  <dig> species whose strains  match by 100% to the 16s rrna gene copies. for taxa-counting this means that  <dig> strains cannot be distinguished, hence a count based on 16s will lead to  <dig> species . these numbers change if one allows identity match of > 99%. then, there are additional  <dig> species whose strains cannot be distinguished, leading to taxa-count of  <dig>  already at this level of identity > 99% there are  <dig> different species of the same genus that cannot be distinguished from each other . the situation is worse for a cut-off of 97%, when more species cannot be distinguished from each other . this is a well-known problem of 16s analysis  <cit> .

we have performed an analysis by s <dig> sp search and alignment on the same metagenomic data. the most abundant sp  was found in  <dig> out of the  <dig> genomes . the other  <dig> genomes can be identified through occurrences of other sps belonging to the same ec. all sequences, including the minority of  <dig> that do not possess the leading sp, can be easily aligned with each other, exhibiting similarities and differences. using this procedure, there are several cases where strains cannot be distinguished. they are exhibited in table  <dig> , where we find  <dig> strain pairs and  <dig> strain triplet that fully match one another, i.e. the distances between the corresponding sequences are zero. analogously to the 99% identity threshold in the 16s analysis, we can set a similar threshold in the enzyme , finding  <dig> additional pairs of strains cannot be distinguished .

we will return to the issue of species vs strain counting below, after analyzing the metagenomic results of qin et al.,  <cit> . one important point of caution is that the results may depend on the type of protein that underlies our analysis. thus for the  <dig> . <dig>  case, studied here, differences of a few amino-acids in the protein sequence occur for different strains of the same species as well as for different species of the same genus. this is not the case for  <dig> . <dig>  for example, where distances <  <dig> amino-acids usually signify different strains of the same species, while larger distances are characteristic of different species. at the resolution level of strains we see that even for an artificial metagenome where 16s rrna genes are available, the s <dig> peptide approach can serve as a comparable tool for distinguishing strains from species. it can further serve as a complementary tool to distinguish between strains and species based on the analysis of certain ecs, such as the  <dig> . <dig>  . it may be of high importance for environmental samples of unknown taxa as it does not require a predefined query dataset.

finally we wish to point out that if full genes  are being used for analysis purposes, we do not have to confine ourselves to sps with lengths ≥  <dig>  instead we can use a larger list of sps with length ≥  <dig> and look for all cases where sufficient amino-acids  are hit by these sps on the protein. this way we may uncover a relevant protein, having the same ec, even if no sp with length  <dig> or more is observed on it. it should be realized that all examples quoted in table  <dig> have many hits of sps with length  <dig> or  <dig>  in addition to those mentioned in the last column. for example, the m penetrans enzyme  has  <dig>  such hits in addition to the leading sp of length  <dig>  thus, even if the latter would have been corrupted by some mutation, the protein would be identified as ec =  <dig> . <dig>  by the dme methodology  <cit>  that takes into account all these hits, as demonstrated by the webtool http://adios.tau.ac.il/dme <dig> html. our previous limitation to length ≥  <dig> was important in the short read application, where two hits of sps of length  <dig> on the same read are very rare, and a single sp hit with length  <dig> may be erroneous .

human gut microbial species counting on long genomic contigs - the prevalent set of qin et al.  <cit> 
the human gut microbial metagenome has recently been studied on samples taken from  <dig> human individuals  <cit>  and shown to be due to a cohort containing over  <dig> prevalent species. this conclusion was based on estimating the contents of a non-redundant set of  <dig>  m orfs derived from full genomic analysis . searching for s <dig> sps on the set of all prevalent genes we find that the largest number of sequences recognized by sps of lengths ≥  <dig> occurs for ec =  <dig> . <dig> . for comparison we will also quote results from ecs  <dig> . <dig>  and  <dig> . <dig> . the numbers of sequences with hits of the leading sps of these three ecs are  <dig>   <dig>  and  <dig> correspondingly . summing up all sequences on which non-leading sps corresponding to these ecs were found  we obtain total counts of  <dig>   <dig> and  <dig> correspondingly. it should be noted that, since this is a non-redundant set to begin with, we do not have to apply the taxa-counting algorithm. moreover, given the stringent definition of prevalent genes  we can eliminate the possibility of counting different strains of the same species. the results from ecs  <dig> . <dig>  and  <dig> . <dig>  seemingly agree with the species count estimated by the authors  <cit> . however, there is a flaw in this argument: many of the prevalent gene sequences are only partial sections of the relevant genes. thus, adding up numbers due to different sp markers, one runs the risk of over-counting, by regarding possible non-overlapping sections of a single gene as putative independent genes.

in figure  <dig>  we display the length histograms of sequences carrying the leading sp of  <dig> . <dig>   and of all non-leading sps with lengths ≥  <dig>  the peak at length of about  <dig> amino-acids signifies sequences that are full representations of the enzyme syv  carrying this ec . obviously this peak accounts for only a fraction of the total counts mentioned above. in order to generate a strict lower-bound estimate, we start with the count  of the leading sp. since the latter can only appear once on this enzyme we can regard all the sequences in which it was found as different. however, to add to this count the other sequences of the non-leading sps, we must consider only sufficiently long sequences, reducing the probability that they are complements of the gene sequences that were already counted. thus, we add the peak of the non-leading distribution . this way we are guaranteed that no over-counting occurs. this procedure leads to the lower-bound estimate of  <dig> prevalent species, characterized by one syv for each species.

thus whereas  <dig> different species could lead to the observed  <dig> different sequences, a rigorous lower bound on prevalent species should be set at  <dig> on the basis of the available syv data. the lower bound estimates for all three ecs, are  <dig>   <dig> and  <dig> for the syv , syt  and syq  genes correspondingly. note that while most syv sequences carry the leading sp, the syt count relies heavily on non-leading sps; nonetheless the total numbers are amazingly consistent with one another. syq leads to a lower count, reflecting presumably the absence of such genes on some bacteria. this discrepancy is present and even bigger in swiss-prot data, as shown in the additional file  <dig> .

human gut microbial taxa counting on all long genomic contigs of qin et al.  <cit> 
next we apply our s <dig> sp analysis to the full set of  contigs in qin et al.  <cit> . by regarding every possible difference among protein sequences as meaningful, we will reach lower bounds on taxa counts  that are much higher than in the previous section. expanding our algorithm to incorporate different levels of sequence inequality we will demonstrate their consistency with the results on the prevalent set.

we start by translating each contig into six pseudo-peptides , according to the six different choices of reading frames. sps are then searched on all pps of all human microbial populations. sp hits with length of l ≥  <dig> amino-acids occur only once on a pp. combining all relevant pps of the whole cohort, we search for sps that lead to the highest numbers of hits. concentrating on the same ecs that we have investigated in the prevalent set, we find the following hits of leading sps:

isrqlwwgh   <dig> hits.

trfppepngylh   <dig> hits.

geaafygpk   <dig> hits.

we extract from all pps the sections that correspond to the proper enzymatic gene, i.e. start with the first methionine following the closest stop signal to the left of the sp, and end at the first stop signal downstream to the sp. the length histogram of these pps is presented in figure  <dig> for the first  and second sp . most of the proper full enzymatic proteins establish the peaks around contig lengths of  <dig> and  <dig> amino-acids for syv and syq respectively. the contigs leading to shorter pps either begin too late or end too early, thus containing only fractions of an enzyme .

next we employ the taxa counting algorithm with which we analyzed the examples of tables  <dig>   <dig> to create the assemblies of pps . in fact, there are many cases where short pps are completely fused into longer ones. this process converges quickly, within one minute on a regular pc, leading to a lower bound of  <dig> and  <dig> taxa, respectively. analogous analysis based on the  <dig> hits of sp = geaafygpk  leads to a count of  <dig> 

now we proceed to look for hits of other sps  of the same ec numbers, on contigs on which the leading sp was not found, to select further candidates for the corresponding enzymes. we limit ourselves to pps which are long enough so that the most abundant sp was not missed just because the pp does not contain its appropriate location. thus, when applying the algorithm to the non-leading sps we exclude fractions of proteins that are shorter than the cutoff lengths that we have employed in figure  <dig> . this leads to a final total count of  <dig> for syv ,  <dig> for syq  and  <dig> for syt . in the next section we will make contact between these numbers and the prevalent gene counts discussed in the previous section.

taxa counting based on minimal distance d: differentiating between strains and species
we have demonstrated in table  <dig> the problematics of distinguishing between strains of the same species using the 16s rrna technology as well as ours. there we have employed sps belonging to  <dig> . <dig> . here we wish to point out that the situation changes if one employs  <dig> . <dig>  which, we have already seen, has quite a large number of species count in this data, although smaller than that of  <dig> . <dig> .

in figure  <dig> we present the results of a study of all bacterial protein sequences that contain the most abundant sps for syv  and syq  in uniprot kb data. here we display histograms of pairs of strains in same species, and pairs of species in the same genus, as function of hamming distance, i.e. differences in amino-acid identities in protein sequences. for completion we also add pairs of different genera in the same family. in order to compare different sequences we aligned them according to their common sp and measured their hamming distances on overlapping domains. for syv enzymes, displayed in figure  <dig>  we find very similar behavior for both strains and species: both have distributions ranging mostly over differences in amino-acids from  <dig> to  <dig>  this is in agreement with our conclusions in table  <dig>  where we saw that it is impossible to set a clear threshold on amino-acid distance below which one finds only different strains of same species. analyzing the syq data in figure  <dig> a clear threshold distinguishing different strains from different species is observed: more than 95% of all strains of the same species differ only by 0- <dig> amino-acids, whereas about the same majority of different species differ from each other by more than  <dig> amino-acids. the same consequences hold also for an analysis based on the needleman-wunsch edit distance  <cit> , displayed in additional file  <dig> fig. s <dig> 

in order to apply such a threshold criterion to our data we return to the ensembles of fused strings, discussed in the previous section, and reevaluate them according to the minimal difference in amino-acids  detected among pairs of fused strings. to this effect we construct a distance matrix m, whose upper triangle entries signify distances between shorter to longer strings, i.e. the indices of m are ordered  according to the length of the string that is being considered.

in order to estimate the minimal number of fused strings whose distance from one another is ≤ d we follow three steps:

a) identify indices of all sequences that belong to a pair having distance ≤ d. this leads to an nx <dig> matrix in which, for each row, the index value in the left column is always smaller than in the right column. n is the number of pairs of sequences with distance ≤ d.

b) identify the unique values in each column of the nx <dig> matrix . the smaller set  of unique values is regarded as the minimal set.

c) remove from the set of sequences all those corresponding to the minimal set of indices. all remaining sequences have distances >d.

the syq curve allows us to estimate the numbers of different strains of the same species, by using the cutoff of d ≤  <dig> derived from figure 4d. we learn from it that out of the overall number of  <dig> taxa derived from syq sequences, more than  <dig> may be associated with different strains of the same species . note that many more strains may be indistinguishable on the basis of syq sequences, as demonstrated in the swiss-prot statistics displayed by the peak at zero distance in figure 4d. a different way of making the statement regarding the number of strains is that the syq analysis implies that there exist more than  <dig> genuinely different species , whereas our prevalent species estimate for this ec was  <dig> only.

errors in contig constructions affect the counting procedure, since the latter interprets any mutation as a new taxon. qin et al.  <cit>  estimated their assembly errors to be approximately  <dig> per mb. from this we deduce that the maximum error we should expect is about  <dig> wrong amino-acids in an ensemble of pps containing million amino-acids. hence we estimate that our total counts are subject to a possible error which is of the same order of magnitude as the drop encountered in figure  <dig> between the peak at d ≥  <dig> and the next point at d ≥  <dig>  this implies that the estimate of the number of strains may be subjected to a large uncertainty, however the estimate of numbers of different taxa derived from d ≥  <dig> is quite a safe lower bound.

taxonomic identification - contigs
both distributions displayed in figure  <dig> show a sharp drop for low d, turning into linear descent for higher d values. no asymptotic plateau is observed at larger d, as would be expected if the data had large numbers of genera in it . hence we conclude that the number of different genera is relatively small, presumably less than a few tens.

so far our analysis has been carried out without any reference to the taxonomic identification of the species involved. an sp-based approach that can provide an answer to this question has been developed in  <cit> , where taxa specific peptides  were filtered out of all sp lists. the tsps are specific to a phylum or class, and may provide taxonomic classification even on short read data . this method can be easily applied to the contigs of  <dig> . <dig> . we find taxonomic tsp identification for  <dig> out of the  <dig> fused strings of d ≥  <dig>  they contain  <dig> bacterioidetes,  <dig> firmicutes,  <dig> classified generally as proteobacteria, additional  <dig> classified as gammaproteobacteria, and a small minority of  <dig> tenericutes. obviously one can also perform a blast analysis, e.g. with respect to uniprot data. it implies that most bacterial species are limited to just two classes, bacteroidetes and clostridia, which is consistent with the observation of  <cit>  and others  <cit> , as well as our tsp estimates, that bacteoidetes and firmicutes are the dominant phyla in gut microbiomes.

note that we based most of our analysis on analogies with uniprot kb data. its statistics is further discussed in the additional file  <dig>  the venn diagram of additional file  <dig>  figure s <dig>  shows that most of the recorded species  have both  <dig> . <dig>  and  <dig> . <dig>  annotated enzymes, but 2/ <dig> of them lack  <dig> . <dig> . the distribution observed in the microbiome analyzed here is different, presumably because it is composed of taxa belonging mostly to just bacteroidetes and clostridia.

taxa counting on short reads
in the previous sections we have studied taxa counting on long contigs. applying our algorithm to well separated contigs, like the 'prevalent genes' set of  <cit> , we are quite sure to obtain a lower limit on the number of species that are responsible for the observed data. on the other hand, if we study redundant contigs we can obtain some indication on the number of strains involved in these data, by relying on the  <dig> . <dig>  analysis. here we wish to extend our study to raw short reads. a large fraction of the latter are often discarded in metagenomic studies because they are classified as singletons, i.e. they cannot be combined with other short reads to form contigs. our taxa counting can however be applied to all of them. this provides an insight into the data that has been discarded by others. it can further elaborate on community composition.

analysis of human  <dig> short read data  <cit> 
qin et al  <cit>  have applied particular deep sequencing searches to two of the human samples,  <dig> and  <dig>  we have made use of the available illumina short read data of human  <dig> and human  <dig>  we performed sp searches after translating each one of the short reads into the  <dig> possible reading frames. we then looked for pps in which the leading sps of syv  and syq  were found. for human  <dig> we found sets of  <dig> syv sequences and  <dig> syq ones.

based on these sequences, we demonstrate what consequences may be drawn with regards to taxa counts and taxa composition. on the basis of these data we test, as well, the variation of these results with respect to depth of analysis, i.e. the number of sequences that are being taken into consideration by the taxa counting algorithm. for this purpose we choose random sets of varying sample sizes s < np, where np is the number of pps with the common leading sp. for each sample size, s,  <dig> random trials are performed in order to draw conclusions about mean counts and their errors. the results are displayed in figure  <dig> for human  <dig>  the left panel displays mean counts and their errors for different sample sizes as function of minimal pair distances d. the middle panel displays the same results as function of sample size. whereas for small d taxa counting grows linearly with sample size, it saturates clearly for d ≥  <dig> at large sample sizes. similar behavior was obtained for human  <dig> .

sequence error and count analysis
the raw data contain errors, and every misidentification of an amino acid will affect our taxa counts. error rates can be estimated directly from the quality scores of the raw short reads. their median indicates about  <dig>  base errors for a short read of  <dig> bases, i.e. the probability for having an error in a single nucleotide is less than  <dig> %. since some of the nucleotide errors may leave the resulting amino-acids intact, we may estimate 1% to be an upper bound on the probability of an error in an amino acid designation within any one of the pps.

to demonstrate the effect of such errors we study artificial sets of short reads by injecting arbitrary mutations into the original pp sets at the rate of 1%. the results are demonstrated in figure 6c for raw short reads that we have already classified as belonging to syv genes. we find that the d ≥  <dig> count of the set with artificial errors  lies close to the d ≥  <dig> curve of the original analysis . in other words, the d ≥  <dig> curve is a true estimate of a d ≥  <dig> count on a problem without artificial errors. this allows us to conclude that the original d ≥  <dig> count may be trusted to account for elimination of the majority of the true errors that exist in the original d ≥  <dig> estimate. clearly the errors infiltrate all other d counts, however they diminish considerably as d increases. we conclude that counts of  <dig> or more for sample sizes of order  <dig>  which are based on distances of d ≥  <dig> and d ≥  <dig>  should already be regarded as correct. the fact that they keep increasing with sample size indicates that increasing depth unravels increasing numbers of strains and species.

another interesting aspect of figure  <dig> is that for d ≥  <dig> the taxa counts saturate at about  <dig>  providing a stable bound on the number of species that are expected to have quite large hamming distances  between their relevant protein sequences. similar behavior was obtained for human  <dig> .

taxonomic identification - raw short reads
an interesting remaining question is whether we can identify the taxa from the raw short reads that we have analyzed. in figure  <dig> we search for the proximity of all human  <dig> raw short reads, containing the leading sp of  <dig> . <dig> , to three data sets: all swiss-prot entries, all uniprot entries, and our set of fused contigs corresponding to the same leading sp. we conclude from this figure, using the information at hamming distance  <dig>  that human  <dig> raw short reads contain about 10% novelties with respect to the set of contigs. moreover, there are about 45% novelties when compared to all uniprot enzymes. it should be kept in mind that all these short reads of length  <dig> amino acids have the same sp  in common.

in uniprot there are  <dig> bacteroidetes proteins  and  <dig> firmicutes  belonging to syv. for the short reads matched to uniprot, we have found  <dig> bacteroidetes and  <dig> firmicutes. estimating the abundance of these principal phyla, by comparing with an unbiased set of proteins from different phyla, we conclude that bacteroidetes is the major phylum. the next leading phyla are firmicutes, proteobacteria, spirochaetes and chloroflexi. to further support the significance of this result, we have repeated the same analysis comparing artificial short reads of length  <dig> amino-acids to the full uniprot proteins from which they were drawn . good matches  between different phyla are very small. thus, the large fractions observed in figure  <dig> are indicative of true matches of the short reads to the quoted phyla.

discussion
use of single-copy genes
the idea that single-copy proteins can be used for estimating the number of species in metagenomes is well-known. in the first sargasso-sea metagenomic study, venter et al.  <cit>  have used the proteins atpd, gyrb, hap <dig>  reca, rpob, and tufa to carry out such estimates. one of them, rpob, is the basis of the analysis proposed by  <cit> . gyrb, has been used in an sp study of the sargasso sea data  <cit> , leading to an estimate close to the one by venter et al.  <cit> . here we propose a method for taxa-counting in metagenomic data that is based on another type of single-copy genes - enzymes which belong to the aminoacyl trna synthetases super-family. some of the aars enzymes are included in the  <dig> protein-coding marker genes of mltreemap  <cit> , a method which sorts out the mapping of a species along the tree of life. notably they include syv, but exclude syq and syt that play important roles in our analysis of the gut microbiome.

the methodology, sps search on aars enzymes
there are three important building-blocks in our proposed methodology. the first is relying on aars enzymes that have the characteristics of single proteins . the second is employing a look-up table of specific peptides  which serve as markers that, when encountered on metagenomic sequences, provide evidence for the association of these sequences with single-gene enzymes. the third is using the largest sets of sequences that are associated with single sps as the basis for our taxa-counting algorithm. this is an np-hard problem. nonetheless, the fact that we deal with sets of sequences renders it solvable, even for thousands of such strings. in practice, we find that a large number of such sequences are inconsistent with one another  and can be counted and removed from further analysis in the first step. many of those that are left fit into sets within which sequences are mutually consistent with one another.

in the additional file  <dig> we provide a link to the list of sps that we have used in this study. a matlab code implementing our counting algorithm is provided online. this should make it easy for metagenomic research groups to employ the tool that we propose, and establish its usefulness in future analyses.

application to long contigs
when analyzing long contigs it seems only natural to compare our methodology to the conventional 16s rrna one. working with an artificial metagenome composed of  <dig> genomes we have demonstrated that we have comparable achievements. we have employed the contigs of qin et al.  <cit>  to demonstrate how our proposed technology can work on real metagenomic data. we have separately applied it to their set of prevalent genes, and to their total data derived from gut microbiota of  <dig> individuals. concentrating on estimates based on syv genes  we find overall numbers of all the relevant contigs to be  <dig> in the prevalent gene set. however, we have estimated that a strict lower limit on the number of species should be  <dig>  which was consistent with our estimate based on syt genes . this estimate is a conservative number, making sure that no double counting error is made due to the presence of small factions of genes. confronting these results with the statement of qin et al.  <cit>  about the existence of  <dig> to  <dig> prevalent species, we find that their result reflects the maximal number sustained by the data; however a cautious estimate of the lower limit reduces it by a factor of two.

using the concept of prevalent genes one circumvents the issue of sorting out different strains from different species. we have compared these results to the results obtained by applying our method directly to the data of all  <dig> individuals. there is a fundamental difficulty in defining a threshold that separates different strains of the same species from different species, which is also well-known in the 16s rrna analysis. it is also known to vary among different genera  <cit> . within our method it is seen to vary among different ecs. this is exemplified in our analysis by comparing figure  <dig> and 5: for syv genes within uniprot bacteria, strains of the same species exhibit sequence differences up to a distance of  <dig> amino-acids . different species demonstrate also such small differences in syv sequences , therefore strains and species counts cannot be separated by a distance criterion. note that prevalent syv genes have distances larger than  <dig> amino-acids . our syv-based count of the total strains + species on all contigs is  <dig> for the leading sp hits and  <dig> after adding all non-leading sp strings that are long enough to avoid double-counting. this estimate is subject to an overall error of about  <dig> due to errors in contig construction . the separation between species and strains can however be carried out for syq genes: the bulk of strains in uniprot data exhibit sequence differences below a distance of  <dig> amino-acids  within the same species. in the syq-based count one can reach a lower bound estimate of different strains if one takes seriously observed differences of one or two amino-acids in the fused sequences generated from the data . this particular family of enzymes, which carries rich information in the data of  <cit> , was inapplicable to the problem of the artificial metagenome considered before in table  <dig>  the reason is the low coverage of syq genes in swiss-prot data .

taxa-counting independently of taxonomic assignment
the large diversity of bacterial life poses quite a challenge to the definition of what a "species" is. it has been suggested that sequence similarity is not always indicative of true diversity  <cit> . nevertheless, advances in our understanding of single-gene properties may provide improved methods for estimating taxonomic diversity and composition  <cit> .

although our method is based on sequence similarity as well, it is different in various respects. our taxa-counting algorithm does not go through a taxonomic assignment stage in order to arrive at its estimate of the count. in fact it relies on sps that are common to all taxa, and counts the number of independent sequences, all of which contain the same sp. the fact that no comparisons to known data-bases  are being used has a conceptual advantage: new species may belong to novel families and orders that have not been annotated so far. comparing proteins from such species with known data bases may point out similarities to known species; but, unless the latter is based on extremely high amino acid identity, the results could be false . it should be emphasized that even if new aars enzymes have low homology to those of known species, we may detect them as long as they carry one of the  <dig> sps on our look-up table.

clearly, when long reads  are being used, or long contigs, one can rely on blast comparisons of the extracted putative proteins with well annotated databases, to carry out the taxonomical classification of the data, and attempt to resolve the taxa-counting problem. this is the basis of many proposed algorithms  <cit> , including the recently updated megan algorithm  <cit> . moreover, we can perform quite well using our own tsp approach  <cit>  that resolved half of all fused strings of  <dig> . <dig>  into bacterioidetes, firmicutes and proteobacteria.

phylogenetic tree
phylogenetic trees are well-accepted tools in metagenomic studies. they may be based either on distance patterns inferred from grouping of 16s rrna otus  <cit> , or on similarities of protein sequences  <cit> . using a single gene may be risky for inferring species phylogeny. in particular, it has been emphasized  <cit>  that different aars enzymes may lead to slightly different evolutionary patterns, indicating also the existence of horizontal gene transfer among bacteria. although we find that an analysis of all bacterial  <dig> . <dig>  data in swiss-prot leads to reasonable groupings of the relevant species, we know that such an analysis cannot be applied directly to the  <dig> fused strings of  <dig> . <dig> . the reason is that the set of all contigs has a large fraction of short strings together with full proteins.

application of taxa counting to short read data
in the realm of short reads our method is quite unique. having based it on sps whose length is  <dig> or more amino-acids, we trust that the short reads that were selected by sp hits are fractions of the relevant enzymes. this allows for a quick species count estimate directly from raw data. different strains cannot be distinguished from one another on the basis of such short reads. short read singletons that are often discarded from metagenomic analysis because they do not combine with other short reads to form longer contigs, can be included in our analysis. by allowing for different minimal hamming distances we can sort out such data, eliminate errors and provide interesting insights.

our analysis suggests that counts based on raw short read data increase linearly with the sample size because of increased sequencing depth. this type of inflation has been observed as well in the number of otus  <cit> . when we focus our attention on large hamming distances between the selected short reads, our counts saturate, indicating a lower bound of sufficiently distinct "species", presumably counts of different families.

taxonomic identification
direct analysis of short reads has been proposed by  <cit> , with their carma web-tool which is based on annotated environmental gene tags . the latter may be as short as  <dig> amino-acids and were estimated to have specificity of 93% and sensitivity of 61% at the level of order prediction. our proposed application is rooted in a different approach. whereas both methods deal directly with short reads, we have aimed to achieve estimates for strict lower bounds of taxa counts, and the taxonomic identification is an interesting by-product.

an alternative method for taxonomic assignment using sps has been proposed in  <cit>  in terms of taxa-specific sps . this method cannot be applied to the restricted set of short-reads containing just the leading  <dig> . <dig>  sp. the reason is that the chances of establishing an additional tsp on a short read of  <dig> amino-acids, which includes already the leading sp, are nil. it can however be applied to the set of all raw short reads. we have carried out such an analysis  leading to results that are consistent with previous studies of the gut and with results obtained by matching raw-short reads, or contigs, that carry leading s <dig> sps, to the uniprot database.

CONCLUSIONS
a major advantage of our methodology is its simplicity: its straightforward implementation does not require any further choice of parameters, or comparisons with additional data bases. the application to the microbiome data should serve as a validation of the power of our proposed methodology. the only bias in our methodology is the reliance on existing enzymes in swiss-prot, from which the sps are being extracted. it should be noted that sps belonging to the aars enzymes have the highest coverage among all sps  <cit> , because these enzymes permeate throughout all the tree of life. hence they are expected to show up also in novel species. nonetheless, it is theoretically possible that some genes of new species will be so far removed from the known ones that no sp match will occur and they may thus avoid detection. this danger should decrease with time. the reason is simply that as more and more data become available, the mex algorithm  <cit>  should be reapplied and it will pick up more motifs, thus increasing the set of s <dig> sps and leading to higher recall.

the ever-improving sequencing technologies lead to rapid increases in the amounts of metagenomic data that become available. we believe that the method and concepts presented here can contribute significantly to such analyses in conjunction with other existing methods and techniques.

