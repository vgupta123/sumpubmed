BACKGROUND
one of the key goals of evolutionary biology is to reconstitute the evolutionary history of species and to establish their filiation patterns. this goal has been pursued using first morphological and physiological data and later molecular data, which harbour a large amount of phylogenetic information. the first molecular phylogenetic reconstructions were based on, often partial, sequences of one orthologous locus in various species. a single locus was considered representative of the history of the whole genome and of the species. as more sequence data became available, this representativeness was jeopardized as examples of incongruent stories revealed by different genes for the same set of species or discrepancies between species tree and gene trees accumulated, e.g. fungi  <cit> , plants  <cit>  and mammals  <cit> . earlier examples have been reviewed by nichols and coworkers  <cit> . the reason for these discrepancies can be either biological or technical. regarding biology, there are three main evolutionary events responsible for them  <cit> . the first one is incomplete lineage sorting, also called deep coalescence, which corresponds to the persistence, after speciation, of ancestral polymorphism and subsequent loss of alleles or random sampling. for example incomplete lineage sorting has been pervasive during the bird adaptive radiation that followed the cretaceous/tertiary crisis  <cit> . the second one is gene exchange between species, which can occur either by hybridization, pervasive in plants  <cit> , or by horizontal gene transfer, frequent in prokaryotes  <cit> . the third one is gene duplication and subsequent loss and evolution that might render difficult the correct identification of orthologous genes  <cit> . regarding reconstruction techniques, discrepancies between gene tree and species tree inferences can also be artefacts due among others to sequencing errors, orthologous genes misidentification, alignment underperformance, wrong model choice or inefficient search for global likelihood optima during phylogenetic reconstruction.

in the genomic era, datasets span several genes , each available in a variable number of taxa. a higher volume of sequences means more phylogenetic information but also more incongruences between gene trees. this renders the reconstitution of species trees always more difficult and controversial. the two main questions about incongruences are:  how to detect and quantify them? and  what to do with them? regarding the first question, a large number of tests have been designed to compare two phylogenetic trees, assessing either the distance or similarity in terms of topology or branch length or a combination of both. an idea of the diversity of these methods as well as a test for their relative efficiency depending on the dataset can be found in kuhner and yamato  <cit> . additionally, methods have been developed to analyse sets of phylogenetic trees reconstructed from different sequences. they allow identifying outliers, that can be futher studied to determine the origin of the difference in their reconstructed evolutionary history. these methods use principal components analysis  <cit> , heat maps  <cit>  or clustering of likelihood ratio tests  <cit> , euclidean distances  <cit> , multiple co-inertia analysis  <cit> , linear correlation between genetic distance matrices of aligned individual gene sequences and aligned genome sequences  <cit> , information theory  <cit> , or non-parametric estimation of tree distribution  <cit> .

regarding the “what to do with them?” question, one approach has been to find a consensus tree capturing the essential features of the evolutionary history of the species. data for each gene can be analysed independently and then combined by a consensus tree approach  <cit> , supertree-based approaches , bayesian approach  <cit> , summary by maximum agreement subtrees  <cit> , coalescent approach , or bayesian reconstruction of gene trees taking the species tree as a prior  <cit> . an extension of this last model proposes the estimation of the species tree from multiple-allele data  <cit> . data for each gene can also be analysed simultaneously through concatenation into a supermatrix  <cit> . recent developments allow for differential weighing between partitions, e.g. as a function of parameters such as gene length or bootstrap support, in order to avoid arbitrarily giving the same importance to all genes and all partitions, as synthetized by de queiroz and coworkers  <cit> . conflict between gene trees can also be seen as a source of information about genome evolution rather than an obstacle to reconstructing the species tree. some methods acknowledge that a genome contains different evolutionary histories, either through gene networks representing alternative phylogenetic paths in a graphical way or the projection of conflicting signals in 2d, , or by explicit consensus network, in which horizontal gene transfers and hybridization are explicitely represented  <cit> . additionally, methods have been developed that extract several consensus trees from a set of gene trees, by clustering output trees  <cit> , by representing all splits above a predefined threshold in as few trees as possible  <cit>  or by introducing a general score that compares the goodness of fit of models with one or various trees  <cit> .

the available methods generally focus on a single characteristic extracted from each gene alignment, most often, the topology of the best-known tree. some methods can be applied to more than one characteristic, for example the nodal and the patristic distance, but none of them allows combining various evolutionary characteristics and extracting in a synthetic way groups of genes with similar evolutionary history. recent methods have been developed to perform analysis on very large data sets and often do not perform well on small genomes. for example, using simulated data sets, de vienne and coworkers  <cit>  established that phylo-mcoa retrieved correctly outliers only if data sets contained more than  <dig> genes and species. thus, such methods may not be suited for application to small viral genomes, in which each gene represents a significant proportion of the whole genome.

here we propose a method to identify groups of genes sharing similar evolutionary histories using an integrative strategy. in this strategy, we have considered different characteristics of the evolution of each of the genes, such as tree-topology, branch length, detection of the level of selection operating on the proteins and phylogenetic distances between taxa, and have combined them in order to detect groups of genes sharing evolutionary characteristics. we applied this method to viral data sets. the small size of viral genomes is not synonymous of simple and homogeneous evolutionary history. indeed, viral evolution is strongly affected by recombination and by differential selection pressure on different genes. in vivo estimates of recombination rate range from 4 × 10- <dig> in poliovirus  <cit>  to 10- <dig> in hepatitis c virus  <cit> . recombination has been documented to occur at the intraspecific level as in watermelon mosaic virus  <cit> , at the intragenus level as in potyvirus  <cit> , at the intrafamily level as between ipomovirus and potyvirus  <cit>  or between papillomavirus genera  <cit>  and at the interfamily level as between papillomaviridae and poliomaviridae  <cit> . besides, differential selection pressures acting on different genes result in diverse evolutionary rates, for example in hepatitis e virus  <cit> , in porcine parvoviruses  <cit>  or in murine cytomegalovirus  <cit> . typical genes with a high proportion of codons under positive selection are the ones in contact with the host immune system and implicated in immune escape and evolutionary arms race  <cit> .

methods
the general analysis strategy is depicted in fig.  <dig> and a detailed workflow description is depicted in additional file 1: supplementary material and methods. we have collected information about the gene-specific evolutionary patterns at three levels: direct phylogenetic inference, selection, and pairwise evolutionary distances.fig.  <dig> diagram representing the different evolutionary parameters  derived from the initial protein sequence data set of the different genes and their concatenated. these eleven parameters are those included in the final cluster/pca



phylogenetic inference
viral gene sequences were aligned at the amino acid level using muscle  <cit>  and the underlying nucleotide sequences were aligned accordingly. poorly aligned sequences and divergent regions were removed using the gblocks software  <cit>  at the codon level under non-stringent conditions and allowing for gap positions. phylogenetic relationships were inferred separately for each gene and for the concatenated sequence of all genes in a genome. phylogenetic reconstructions were performed by maximum likelihood  using raxml_v <dig> . <dig>  <cit>  at the nucleotide level, using the gtr + g <dig> model, with partitions per gene and per codon position within a gene, and  <dig> bootstrap cycles, and at amino acid level using the lg + g <dig> model. model choice was performed using the akaike information criterion among alternative models tested with raxml for nucleotide and for amino acids. to visualize and represent incongruences between gene trees, we generated a split network computed from gene trees as a supernetwork using  <dig> runs of the splitstree <dig> software with default parameters  <cit> . phylogenetic reconstructions provided the first four variables for the analysis: total tree length for the nucleotide tree , relative contribution of the second and third codon positions to the tree length , and total tree length for the amino acid tree .

tree comparison
evaluating similarities between phylogenetic trees is still a source of debate, and several methods for tree comparison have been proposed, possibly because there is no simple answer to the description of the extent of difference between trees, as reviewed recently  <cit> . to quantify the overall differences in the relative branch length and topology of two phylogenetic trees, we have chosen the k-score index, which searches to minimise the branch length distance between both trees  <cit> . the method is implemented in the ktreedist software. we calculated all pairwise k-score values between gene trees at the amino acid and at the nucleotide levels. importantly, the k-score calculation involves first a scaling step that is dependent on the tree used as reference, and the resulting matrices are therefore asymmetrical. to obtain values describing the general characteristic of one gene in terms of similitude of its tree to the trees of the other genes, these matrices were processed using principal coordinate analysis  with the vegan and ade <dig> r packages. the output of the pcoa provides a re-scaled distance matrix between the phylogenetic trees used as input, with the new, re-scaled dimensions accounting for a decreasing amount of the overall variability in the initial matrix. in our case, the first two dimensions of the pcoa, captured a large proportion of the variance: above 60 % for tumv and above 90 % for pvs. both dimensions were plotted in order to visualize close vs. distant genes in terms of similitude of their trees. the coordinates of each gene on the first two dimensions were retained for the final analyses .

selection regime
for each gene, signature of positive, negative selection or lack thereof was identified by calculating the ω = dn/ds ratio at the individual codon level. for each gene, the alignment and the best-known ml tree were used as input for the selecton online tool  <cit> . we assessed first the presence of positions under positive selection using the mec  <cit>  and the m <dig> evolutionary models, and tested likelihood against the alternative m8a model, which does not consider positive selection  <cit> . the huber robust central m-estimator of ω was used as a synthetic value of the selection direction for each gene and saved as an additional evolutionary parameter . in order to have high power under normality the constant used to calculate the huber m-estimator was  <dig> .

pairwise evolutionary distances
for each gene tree and for the corresponding concatenated tree, all pairwise patristic distances  between terminal taxa were calculated both at the amino acid and nucleotide levels. in order to compare distances between taxa for different genes in a same genome, we normalised them by dividing each pairwise distance obtained from a gene tree by the corresponding distance obtained from the concatenated tree for the same pair of taxa. for each gene, normalised distances were synthesized by calculating the huber robust central m-estimator and the associated median absolute deviation . the huber m-estimator of pairwise nucleotide distances and amino acid distances were added as evolutionary parameters characterizing the genes . additionally, the graphical representation shown in fig.  <dig> of the normalised amino acid distance versus the normalised nucleotide distance allows categorizing the genes for their evolutionary behaviour relatively to the genome containing them. indeed, the  point represents the evolutionary characteristics of the concatenated, and lines parallel to the axes and going through this point divide the plan in four sectors of faster/slower evolution for amino acid/nucleotide .fig.  <dig> normalised nucleotide distance vs normalised amino acid distance. the  point labels the evolutionary behaviour of the concatenated and the lines parallel to the axis and passing through this point define four sectors representing the four types of relative evolutionary speed



finally all the above-mentioned evolutionary parameters  were combined to identify genes displaying similar evolutionary metrics by applying techniques for dimensionality reduction implemented in the r packages pvclust and stats: i) ward hierarchical cluster identification using the euclidean distances. the approximately unbiased  support values, and the bootstrap probability  support values were also computed; ii) principal component analysis . data were standardized prior to their analysis.

data sets
turnip mosaic virus  data set
the first data set used contained  <dig> genomes of tumv isolates . tumv belongs to the genus potyvirus within the family potyviridae, the largest family of plant viruses and the source of important crop losses in cultivated plants. tumv is a worldwide distributed virus, sap-transmissible to a wide range of species and transmitted by many aphid species in a non-persistent manner  <cit> . tumv is a positive-sense single stranded rna virus, with a filamentous, non-enveloped helical capsid. as all potyviruses, the tumv genome is linear, monopartite and around 10 kb in length. it encodes a unique orf, translated into a polyprotein, autocatalytically cleaved into ten mature proteins: p <dig>  hc-pro, p <dig>  6 k <dig>  ci, 6 k <dig>  vpg, nia-pro, nib, and cp. an overlapping open reading frame coding a small additional protein, pipo, after + <dig> frameshifting within p <dig> has also been described  <cit> . the knowledge of the intra-plant biology of this virus is moderate, compared to viruses infecting humans, and the protein function are well described for some proteins, yet ignored for others. there are currently over one hundred whole tumv genome sequences available but a minimum recombination set of  <dig> tumv full-length genomes were retained for the analysis, according to tan and coworkers  <cit> . only coding sequences were used for this analysis, and the pipo overlapping gene was not considered.

papillomavirus data set
the second data set contained genomes of various papillomavirus species . papillomaviruses  are animal viruses belonging to the papillomaviridae family. the biology and natural history for some of these viruses and the function of each gene are known in many details, because of their role in inducing lesions, benign and malignant tumours in humans and animals  <cit> . pvs are small, non-enveloped viruses, with a genome encoded in a circular double-stranded dna molecule of around 8 kb. the pv genome is divided in two gene clusters. the first one called “early genes” is composed by e <dig> and e <dig> , e <dig> and e <dig> , e <dig> , and e <dig>   <cit> . the second cluster called “late genes” is composed by l <dig> and l <dig>  encoding for the capsid proteins. the e <dig> orf, nested within the e <dig> gene, was not included in our analyses. the e <dig> was also not considered in our analyses because it is absent in most pv genomes, and probably they do not share a common ancestor  <cit> . most of the complete pv genomes deposited in databases are human pvs belonging to the alpha-, beta- and gammapapillomaviruses. in contrast, animal pv diversity is poorly sampled. to avoid an over-representation of these three taxa, a subset of  <dig> representative pv types that covered the sequence diversity of all known pvs was chosen. representative sequences were chosen avoiding pvs suspected of having undergone recombination  <cit> .

RESULTS
analysis of the tumv data set
additional file 3: figure s1a displays the best-known ml tree obtained for the concatenated sequences and additional file 3: figure s1b the split network resulting from the individual best-known ml gene trees. individual gene best-known ml trees are given in additional file 3: figure s <dig> and support values for each group is shown in additional file 4: table s2a.

the nucleotide gene tree lengths  showed a decreasing trend along the tumv genome , as indicated by the negative regression of the nucleotide tree length on the gene order . grouping the tree lengths by a k-means cluster and choosing the cluster number by the aic, revealed that the data best cluster in three groups: the four genes located on 5’ in the genome , the following five genes  and cp . interestingly, the amino acid gene tree length , follows the same decreasing trend but with a lot more variations resulting in a non-significant regression of tree length on gene order and no clear clustering of the tree length values . as expected, the third codon position provides the highest contribution to the total tree length, followed by the first and then the second position, the latest being fixed for 6 k <dig> and nia-pro.fig.  <dig> 
a,b tree length  of tumv. a plot of the nucleotide tree length displaying the contribution of the first, second and third codon position in dark grey, white and light grey respectively. b plot of the amino acid tree length. c,d biplot of the principal coordinates analysis  using the four variables treecomp1_nt, treecomp2_nt, treecomp1_aa, treecomp2_aa  for tumv. the first principal component is represented in the x-axis, and the second principal component is represented in the y-axis. percentage values in the axes indicate the percentage of variation explained by either component. e percentage of sites under positive , neutral  and purifing selection  for tumv . the solid black line represents the huber m-estimator of ω  of all positions for each gene and for the concatenated 



four columns of additional file 5: table s3a show the projection values in the first two dimensions of the pcoa of the pairwise distances between the individual gene trees, considering a combination of topology and branch length    <cit> . in terms of selection regime, all tumv genes present a ω central estimator below  <dig>  except p <dig>  with a ω central estimator of  <dig>  . accordingly, p <dig> is also the gene with the highest proportion of codons under positive or neutral selection . the rest of the genes present a large majority  of their codons under purifying selection.

the organisation of the genes into the tumv genome is shown in fig. 4a. plotting the nucleotide pwdist against the amino acid pwdist yielded always a high correlation, for each individual gene as well as for the concatenated, but the slope of the regression varied largely depending on the gene . when normalising the distances by dividing each individual gene-based pwdist by the corresponding concatenated-based pwdist, different genes behaved differently and fell in three sectors of the normalised plot : p <dig>  p <dig> and 6 k <dig> displayed both higher amino acid and nucleotide pwdist than the concatenated; vpg displayed higher amino acid but similar pwdist than the concatenated; 6 k <dig> and hc-pro displayed lower amino acid but higher nucleotide pwdist than the concatenated; ci, nia-pro and nib displayed both lower amino acid and nucleotide pwdist than the concatenated; and cp displayed less variation in both amino acid and nucleotide than the average of the genome, but the ratio between both was similar to that of the concatenated.fig.  <dig> 
a tumv genome organisation. b nucleotide distance vs amino acid distance of the tumv. slopes values for each regression are indicated. all regression p <  <dig> . c nucleotide vs amino acid pairwise distances for tumv genes. for each gene, the huber estimator  of the distances normalised to their respective concatenated is displayed. d hierarchical cluster dendogram using the eleven chosen variables  for tumv. the clustering was performed using the euclidean distances and the ward method. probability values were calculated using bootstrap resampling techniques, the approximately unbiased  support p-value  and the bootstrap probability  value . e biplot of the principal component analysis  using the eleven chosen variables  for tumv. the first principal component is represented in the x-axis, and the second principal component is represented in the y-axis. percentage values in the axes indicate the percentage of variation explained by either components. original variables are given in blue, and those showing co-variation above  <dig>  are encircled by discontinuous lines



the results for the eleven variables extracted  were finally combined and a cluster analysis was applied to the ten genes in the tumv genome. the results are displayed in fig. 4d. the height of the branches represents the distances between clusters calculated by the ward method. the cluster analysis showed a clear separation of p <dig> from the rest of genes . two further clusters could be distinguished, a first one containing genes located in the first half of the polyprotein  and 6 k <dig>  and a second one containing genes of the second half of the polyprotein and ci. members of the second cluster were more similar between them than the one of the first one and there is no further grouping within each of these two clusters. regarding the pca, the first two axes explain more than 75 % of the global variance, with p <dig> differing largely from the rest of the genes based on the first derived axis . the value on the second axis seems to globally correspond to gene order in the genome: genes from the first half of the genome have negative values whereas genes from the second half have positive values. covariance values above  <dig> cluster the eleven considered variables into two groups and four isolated variables.

analysis of the pv data set
additional file 6: figure s2a displays the best-known ml tree obtained for the concatenated genes and additional file 6: figure s2b the split network from the individual best-known ml gene trees. individual gene trees are depicted in the same additional file 6: figure s <dig> and support values for the crown groups are provided in additional file 4: table s2b.

pvs displayed nucleotide and amino acid tree lengths globally homogeneous across the individual genes . there were no significant trends in tree length with gene order neither for nucleotide  nor for amino acid . grouping the tree lengths using a k-means cluster and choosing the number of clusters after the aic, the best clustering at the nucleotide level was with two clusters: e <dig> and e <dig> in one and the remaining genes in the other. at the amino acid level, the lowest and indistinguishable aic values were for  <dig>  and three clusters .fig.  <dig> 
a,b tree length  for pvs. a displays nucleotide tree length with the contribution of the first, second and third codon position in dark grey, white and light grey respectively. b represents the amino acid tree length. c,d biplot of the principal coordinates analysis  using the four variables treecomp1_nt, treecomp2_nt, treecomp1_aa, treecomp2_aa  for pv. the first principal component is represented in the x-axis, and the second principal component is represented in the y-axis. percentage values in the axes show the percentage of variation explained by either components. e percentage of sites under positive , neutral  and purifing selection  for pvs . the solid black line represents the huber m-estimation of ω  of all position for each gene and the concatenated 



the first four columns of additional file 5: table s3b show the projection values in the first two dimensions of the pcoa of the pairwise distances between the individual gene trees, considering a combination of topology and branch length    <cit> . in both pcoa, the first axis spreads e <dig> , e <dig>  and a group formed by all other genes .

regarding selection regime, pv genes presented a central estimator for ω ranging from  <dig>  to  <dig>  , with e <dig> gene showing the highest ω =  <dig>  ±  <dig> . also, 25 % of the e <dig> codons were under neutral or positive selection, while all codons in other genes are under purifying selection, except  <dig>  % of positions under neutral or positive selection in e <dig> 

the organisation of the genes into the pv genome is shown in fig. 6a. plotting nucleotide pwdist against amino acid pwdist yielded always a high correlation, for each individual gene as well as for the concatenated, but the slope of the regression varied largely depending on the gene . plotting norm_pwdist_nt vs norm_pwdist_aa showed that e <dig> was the most divergent gene with respect to the complete genome, displaying the highest distances at both the amino acid and the nucleotide levels . in contrast, e <dig> and l <dig> were more conserved than the complete genome at the amino acid level, and e <dig> and e <dig> were more conserved than the complete genome at the nucleotide level.fig.  <dig> 
a pv genome organisation. b nucleotide distance vs amino acid distance for pvs. slopes values for each regression are indicated. all regression p <  <dig> . c nucleotide vs amino acid pairwise distances for pv genes. for each gene, the huber estimator  of the distances normalised to their respective concatenated is represented. d hierarchical cluster dendogram using the eleven chosen variables  for pv. the clustering was performed using the euclidean distances and the ward method. probability values were calculated using bootstrap resampling techniques, the approximately unbiased  support p-value  and the bootstrap probability  value . e biplot of the principal component analysis  using the eleven chosen variables  for pv. the first principal component is represented in the x-axis, and the second principal component is represented in the y-axis. percentage values in the axes show the percentage of variation explained by each components. original variables are given in blue, and those showing co-variation above  <dig>  are encircled by discontinuous lines



the cluster analysis of the eleven variables extracted for the six analysed genes  is given in fig. 6d. the cluster analysis showed a clear separation of e <dig> from the rest of genes. then genes involved in building the virus capsid, l <dig> and l <dig>  clustered with an au support p =  <dig>  and early genes involved in genome replication, e <dig> and e <dig>  clustered together with an au support p =  <dig> . regarding the pca, the eleven observed variables could be rescaled into two principal components that explained  <dig>  % of the total observed variation . regarding the genes, the first component discriminated e <dig> from the other genes and the second component separated e <dig> from the other genes. covariance values above  <dig> clustered the eleven considered variables into three groups and four isolated variables.

discussion
we describe here an integrative approach to identify groups of genes sharing common patterns of evolution in genomes with reduced size, and exemplified the validity of the method by applying it to two viral genome datasets, differing largely in genome structure as well as in evolutionary distance among the taxa included. we chose two data sets with quite different characteristics to illustrate both the applicability of the method in distinct situations and how the outcome can be used and interpreted depending on these situations. the tumv data set is an example of rna viruses with low divergence between the terminal leaves and a moderate knowledge of the biology of the virus whereas the pvs data set is an example of dna viruses with high divergence between the terminal leaves and a good knowledge of the viruses biology.

the method here depicted combines a series of eleven variables recapitulating information about tree topology and branch length, about agreement between gene-based and genome-based phylogenetic reconstructions, about the strength of selection along the positions in a gene, and about comparison between gene-based and genome-based distances between taxa. these eleven variables are not fully independent from one another, but covariance patterns between variables are different for the two viral datasets, thus showing that none of them can a priori be considered as redundant. the result provides with visual, intuitive plots easy to interpret, which can guide further informed comparisons, when incorporating knowledge on gene function. thus, interpreting nucleotide vs amino acid pairwise distances with the key provided in the graphical representation of the normalised amino acid distance vs the normalised nucleotide distance shows distinct evolutionary patterns for both datasets, and allows pinpointing highly divergent genes, e.g. p <dig> in tumv genomes and e <dig> and e <dig> in pvs. further, we have applied information reduction techniques that allow projecting the 11-dimension space into more visual two-dimensional plots. again, obvious trends of similarity in evolutionary patterns are evidenced and can be tracked back to biological differences between genes, as in the split between the e <dig> and e <dig> genes and the rest of the pv genes, mirroring the proposed evolutionary history for the blocks composing the pv genomes  <cit> .

for tumv genes, we identified two major gene clusters grouping together genes that are physically close in the viral genome. certain genes are well conserved among isolates  while others are more divaricated . our results show that p <dig> presents a very distinct evolutionary pattern, in terms of increased positive selection, long amino acid tree length and large pairwise amino acid distances. p <dig> is known to be diverse in sequence and length both within and between species . it has also been established that intragene recombination and gene duplication contributed to the evolution of p <dig> and to successful host adaptation  <cit> . moreover, the non-proteolytic part, i.e. a very large portion of the protein, is dispensable for infectivity and replication in tobacco etch potyvirus   <cit> , suggesting a lower level of selective constraint on this protein. finally, p <dig> plays a role in determining the virus host range  <cit> . this role implies that the p <dig> protein carries the hallmark of either a process of adaptation to the host or of an evolutionary arms race with the host. these two phenomena are likely responsible for the observed pattern of positive selection and increased amino acid diversity, which cluster p <dig> apart from the rest of the tumv genes.

one striking pattern for tumv is that the final clustering closely follows the gene order in the genome. gene order is known to be very essential for potyvirus functioning as recently demonstrated experimentally in tev  <cit> : the nib gene, encoding for the polymerase, was relocated at all possible intercistronic positions and all relocations were lethal to the virus except when nib was placed before p <dig> or between p <dig> and hc-pro. this experimental result also adds to the idea that the 5’ side of the potyvirus genome is more permissive to changes. as for the origin of the relationship between gene order and evolutionary history outlined by our study, it could go both ways: gene order could drive evolutionary history or evolutionary history could drive gene order. in the first, case, we have here a higher degree of conservation for the 3’ proteins that could be due to an increase in the selection pressure along the genome. however, we cannot totally exclude a decrease in the error rate of the nib rna-dependent-rna polymerase along the genome, even though it has never been documented. regarding the potential increase in selection pressure along the genome, it is important to keep in mind that the genome itself serves as mrna and is translated into a polyprotein, which is then cleaved in ten functional proteins. hitherto, no mechanisms for differential regulation of individual protein expression have been described, meaning that all proteins are expected to be synthesised simultaneously and in similar amounts. however, such uniformity for protein products with different functions and requirements is unlikely. a recent study on the p <dig> protease of plum pox potyvirus, reveals a modulation of its activity. this p <dig> protease activity regulation could allow for a fine modulation on the viral amplification and reduce triggering of host immune responses  <cit> . this recent study is a first element arguing for differences in expression levels, potentially causing differences in selection intensity. an alternative mechanism for the regulation of the expression of individual proteins would be the presence of internal ribosome entry segment . this mechanism has been identified in picornaviruses  <cit>  and in the shrimp white spot syndrome virus  <cit> . the same phenomenon could apply to the single tumv orf with a higher expression of 3’ proteins than of 5’ proteins, leading to a more stringent selection on 3’ proteins.

in the context of the reverse causality – evolutionary history drives gene order - the observed clustering could reflect the organisation of the genome in groups of proteins that interact together for the realisation of the same function: host-virus interaction , accessory factors of genome replication  and core replicase . an evolutionary advantage of such genome organisation would be that interacting proteins are released simultaneously. however the “functional group” argument is not very appropriate for compact viral genomes with multifunctional proteins involved in multiple interactions. for example, ci and cp have been described as having a role in virus cell-to-cell movement  but do not cluster in terms of evolutionary patterns.

regarding pvs, the results are consistent with the gene expression patterns and with the natural history of the viral infection. both clustering and pairwise distances analyses reveal that pv genes are organised in two main blocks: the first one composed by genes involved in the replication of the viral genome, and the second one composed by genes involved in the encapsidation of the virus. these two blocks are accompanied by the oncogenes e <dig> and e <dig>  which are not grouped in any cluster. this result is consistent with the hypothesis suggesting that the proto-pv was composed by the e <dig>  e <dig>  l <dig> and l <dig> genes, the core region of the genome, while the e <dig> and e <dig> were incorporated later, providing with dispensable transforming capacities  <cit> . further, this clustering matches well differences in codon usage preferences between different pv genes, which are similar for genes expressed at similar stages of the natural history of the pv infection  <cit> .

the two blocks of the pv genome encompasses the only four genes that are present in all pvs and that may potentially suffice for completing the viral infection cycle  <cit> . they encode for the l <dig> and l <dig> proteins, which form the viral capsid  <cit> ; for the e <dig> protein, which binds dna, recruits cellular factors for dna replication and acts as a helicase ; and for the e <dig> protein, a transcription factor that modulates viral gene expression and also directs e <dig> activity  <cit> . the l <dig> gene is under a strong purifying selection, likely reflecting the essentially structural role of the l <dig> proteins, which are able to spontaneously self-assemble into virions  <cit> . the e <dig> and the l <dig> genes show similar global ratios of synonymous and non-synonymous mutations, as both lie on the reference diagonal for the concatenated genome, although the l <dig> gene accumulates more changes. finally, the e <dig> gene contains a small number of positions identified to be under positive selection. these positions may indeed be under selection or may instead reflect the particular architecture of this protein: the n- and c-termini are well-conserved and interact forming an internal dimer to bind dna  <cit> , while the central, hinge region is poorly conserved and consists of stretches rich in proline, serine and glycine . the filtering step for the sequence alignment previous to phylogenetic inference identifies most of the e <dig> hinge region to be poorly conserved and consequently removes it. the few positions under positive selection identified in the e <dig> gene map to the remnants of the hinge region that have been selected for tree construction. the hinge region of the e <dig> gene accommodates the e <dig> orf overlapping in a ± <dig> frame. in this hinge region, the pressure towards conservation of the e <dig> amino acid positions renders synonymous changes in the e <dig> frame as non-synonymous changes in the e <dig> frame  <cit> . this e <dig> gene has not been included in our analyses because it is properly annotated only in a few genera of the papillomaviridae family.

the isolated genes e <dig> and e <dig> are not present in all pvs, as some pvs encode e <dig> but no e <dig> proteins  whereas other pvs encode e <dig> but no e <dig> proteins  <cit> . for the best studied pvs, the role of these proteins during pv infection is the disruption of the growth host cell control by interacting with the tumour suppressor proteins p <dig> and prb in the upper layers of the epithelium . the expression of both genes drives duplication of keratinocytes in skin layers in which no replication normally occurs, and prevents checkpoint mechanisms from triggering cell arrest . both e <dig> and e <dig> proteins are small and highly disordered and have multiple interaction partners . these structural features, together with the fact of being dispensable in the pv genome, constitute the main differences between the e <dig> and e <dig> proteins and those present in the pv core genome, e1-e2-l2-l <dig>  the results in our analyses for pvs deepen those from previous reports  <cit>  and reflect also these fundamental differences, gathering the inconsistency in phylogenetic relationships inferred for the two oncogenes, the increase in accepted nucleotide substitutions, and the large fraction of positions under positive selection for e <dig>  and leading to the clear split of the pv genes into two clusters that globally reflect pv biology and evolution.

CONCLUSIONS
the idea that viral genes might have different evolutionary histories is not new, particularly for virus with segmented genomes . however, comparisons are often qualitative and use only part of the information that can be extracted from the sequences. the comprehensive analysis presented here allows identifying characteristics of the evolution of individual genes and to pinpoint groups of genes with similar evolutionary patterns in terms of phylogenetic relationships and evolutionary pressures. the two data sets we used illustrate that this strategy can be applied to different evolutionary scales: the tumv data set gathered sequences of variants of a virus species with a divergence of 10- <dig> substitutions/position/taxon, whereas the pv data set was constituted of sequences of species within the papillomaviridae family with 10- <dig> substitutions/position/taxon. this difference of evolutionary scale is actually reflected in the  <dig> times difference in tree length. the viral genomes in the example data sets were of the same length range , but the method could be applied to larger viruses or to bacterial genomes. for larger genomes the procedure described here could allow identifying gene clusters with similar evolutionary pattern within the core genome of bacteria, as it has allowed us in the case of the pvs to infer the evolutionary steps prior to the appearance of modern pv genomes.

with this first attempt to combine evolutionary and phylogenetic information on the orthologous genes of sets of isolates, we have shown, in an integrative way, that inconsistencies between gene trees can be exploited to identify groups of genes with similar evolutionary histories. by choosing two viral data sets with very distinct characteristics, we illustrated that this method  can be applied to very compact genomes,  is able to recover from an evolutionary point of view the functional data accumulated on well-characterized virus or  to unravel unknown characteristics of the evolutionary history, likely related to protein functions, of less studied viruses. this opens perspectives for the generation of evolutionary and functional hypotheses on the basis of sequence data in general and for a refinement of core-genome determination in particular.

additional files
additional file 1: 
supplementary material and methods. exhaustive workflow description indicating the input and output files for each step and where to find the software resources. this workflow combined with fig.  <dig> allows full reproduction of the method. 

 additional file 2: table s <dig>  accession numbers of tumv  and pv  genomes used to perform the analysis.

 additional file 3: figure s <dig>  best-known ml tree  and phylogenetic network  constructed from the tumv concatenated nucleotide data set. around them, the best-known ml tree constructed for each of the genes of tumv at nucleotide level. shaded areas correspond to the supported groups refered to in the text and in additional file 4: table s2a.

 additional file 4: table s <dig>  bootstrap support for the clusters identified  in the phylogenetic trees built from the concatenated sequence for the concatenated tree and the gene trees, for the tumv and the pv nucleotide data set.

 additional file 5: table s <dig>  values of the eleven variables extracted from different characteristics of the evolution of each of the genes, such as tree-topology, branch length, detection of the level of selection operating on the proteins and phylogenetic distances between taxa.

 additional file 6: figure s <dig>  best-known ml tree  and phylogenetic network  constructed from the pv concatenated nucleotide data set. around them, the best-known ml tree constructed for each of the genes of pv at nucleotide level. shaded areas correspond to the supported groups refered to in the text and in additional file 4: table s2b.

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

bmc performed analyses and drafted the manuscript; sb contributed to analyses and drafted the manuscript; gl performed analyses on tumv and helped to draft the manuscript; sfe supervised analyses on tumv and helped to draft the manuscript; igb conceived the study and drafted the manuscript. all authors have contributed to, read and approved the final manuscript.

