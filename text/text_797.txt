BACKGROUND
affymetrix manufactures high-density oligonucleotide microarrays for transcript measurement, a platform known as the genechip™. each gene is represented on a genechip™ by one or more sets of oligonucleotide probe pairs that have been designed to capture transcripts from a biological sample. a probeset consists of 11– <dig> probe pairs; each probe pair is made up of a perfect match  and mismatch  25-mer oligonucleotide. the sequence of the pm probe is designed to be an exact complement of a segment of a transcribed portion of the gene to which the probe maps and is intended to allow quantification of the transcription level of that gene. the corresponding mm probe differs from the pm probe by a single base substitution  at the 13th position. in the array design  supplied by affymetrix, the 13th position is called either the mismatch or interrogation position of the probe sequence. the original intent behind incorporating a mm probe for each pm probe was to provide a sensitive control for the identification and quantification of non-specific hybridization as a source of background signals  <cit> . however, several factors, such as the physical accessibility of probe-target interaction sites under experimental conditions and cross-hybridization from other alleles and other genes, may contribute to the mm readout being higher than the corresponding pm value. the relative importance of these contributing factors is currently unknown. one of our research goals is to better understand and characterize the factors that may lead to anomalous probe values. in this study, we focus on characterizing the presence of single nucleotide polymorphisms  as a source of probe readouts that do not reflect transcript concentration levels, and we investigate the effects on downstream results when one does not compensate for such occurrences.

hybridization of labeled target to any probe is due to both fully and partially complementary sequences. therefore, measurable signal results from both hybridization of the probe to the intended target and cross-hybridization to an unintended target. there is a substantial body of publications reporting on the probable sources of cross-hybridization from alternate sites in the genome, but not from alternate alleles of the same locus  <cit>  which is what snps represent. removal of cross-hybridizing probes is based on sequence similarity comparison data, but is not data driven in the sense of using measurements of pm and mm levels to search for the responsible binding partners. in many experiments, the data shows that for a significant number of probes the mm intensity exceeds the pm intensity. since this violates the assumptions of good probe behavior, the common analysis strategy in this case is to eliminate these probe pairs from the dataset  <cit> . while this is reasonable when the cause can be rigorously assigned to cross-hybridization, the reverse reasoning cannot be applied, that is, mm ≥ pm does not always result from cross-hybridization of sequences from different genes, and, as shown below, elimination of measurements based on this observation may incorrectly change the quantitation or call status outcome for particular genes.

in fact, the correct interpretation of mm data as a whole remains a topic of debate, and as yet there is no single consensus on how to handle background subtraction for affymetrix microarrays. for instance, zhou and rocke  <cit>  present a number of strategies addressing whether and when to use mm measurements as part of the background adjustment, but those strategies which do use the intensity of mm probes assume that non-specific hybridization is monitored. in the analyses described here, we chose to use certain procedures recommended by affymetrix, the manufacturer of the data production platform. in brief, the affymetrix probeset detection calling algorithm uses the mm intensity to estimate the stray signal. if the mm intensity is higher than the pm intensity, affymetrix microarray suite  <dig>   flags the outcome as uninformative and computes an idealized version of the mm signal, which is then subtracted from the corresponding pm probe signal. this idealized version of a mm signal  is always smaller than the corresponding pm signal  <cit> . to obtain the expression signal that is representative of a complete probeset, the mas  <dig>  algorithm compares signal intensities from the constituent pm and mm probes to classify the overall probeset measurement in a 'detection call' as being either 'present' , 'absent' , or 'marginal'   <cit> . the impact of mm signal handling on different analysis strategies will depend on their individual assumptions; for example, robust multi-chip average  ignores any mm contribution to the expression intensity signal  <cit>  and therefore will lose information when the alleles present bind most strongly to the mm probes.

since a mismatch probe is the result of a single base difference between two sequences, the concept that probes might be detecting snp alleles seemed a natural property to consider  <cit> . an individual might be heterozygous such that one allele binds to the pm and the other to the mm probe with high specificity and similar intensity , or homozygous for the allele matching a mm probe . therefore, if not accounted for, the presence of two different alleles or the presence of only the allele complementary to the pm, will cause the relationship between the pm and mm pair to be inverted in the analysis, with subsequent misinterpretation  <cit> . in some cases neither the pm nor mm probe is the perfect complement of the allele present, in which case there will still be preferential binding that can lead to low levels of binding to the pm probe and/or high levels of binding to the mm probe  <cit> . the deviations from ideal behavior of the matched probe pairs can be predicted in these cases. as mentioned above, under these circumstances, the mas  <dig>  algorithm arbitrarily adjusts the mm value to ensure that it is less than the pm value, but given a flag indicating the presence of a snp, mas  <dig>  could be modified to handle the pm and mm values appropriately; for example by swapping the two values if a snp is present that makes the allele complementary to the mm probe, or removing the values entirely if correct genotype information is not available.

we identified the snp-containing probes on the chip used for an experiment that had a large number of human samples  and then examined differences between the bulk properties of intensity values and ranges for snp-containing and non-snp-containing probes. to test the effect of taking into account the possibility of a snp in a probe on a specific gene in a particular sample, we also tested whether either the presence/absence call or the total intensity of a gene was affected by how we handled the probe. because the number of individual probes on a chip is very large , and the snp-identification databases are updated fairly frequently, the process of mapping a snp to a probe was automated to allow rapid, consistent and reliable whole-array screening.

a java-based computational tool, affymapsdetector, was developed to identify snp containing probes in affymetrix expression arrays. this allowed us to specifically screen for the intensity measurements due to probes that may contain snps, and investigate their properties with the goal of improving our data pre-processing methods and subsequent meta-analyses of the transcript-level data. while we have used snp identification for processing existing expression datasets, this information can also be used in the design of probes and microarray experiments.

implementation
affymapsdetector has been developed as a cross-platform desktop application using the java technology suite from sun microsystems  <cit> . its user interface is written in java swing and it requires jre  <dig>  or a higher version. the required jre can be downloaded from the web-site at  <cit> . before running affymapsdetector as a desktop application, jre  <dig>  or higher must be installed and the computer must be connected to the internet. figure  <dig> shows the core concepts and underlying architecture of the affymapsdetector using the unified modeling language .

affymapsdetector requires two ascii text files as input data sources: "netaffx annotation file" and "sequence file". both of these files are available for download from the affymetrix support page under "netaffx annotation file" and "sequence files" respectively  <cit> . please note that affymetrix requires registration before you can download the annotation files. here we refer to the "netaffx annotation file" as the gene information file  and the "sequence file" as the probeset information file . for the hg_u95av <dig> chip, the current gif and pif files are available from the affymetrix hg-u <dig> main support page cited above. the gif appears in the "netaffx annotation files" section as hg_u95av <dig> annotations, csv  and the pif appears in the "sequence files" section as hg_u95av <dig> probe sequences, tabular . the gif file contains information at the level of the genes , gene-name, chromosome, gene description etc.) that are interrogated by the chip. the pif file contains probe specific information including the probeset name, the probe's x and y coordinates on the chip, the interrogation  position, the probe's sequence, and target strandedness etc. affymapsdetector has a simple graphical interface that guides the investigator through the process of loading the gif and pif files and starts the process of snp detection with the simple click of a button. figure  <dig> shows the affymapsdetector process workflow as it retrieves the location of snps and maps them to the probes in a given probeset. gif and pif files are stylized for brevity in figure  <dig> 

for each chip, affymapsdetector builds a correspondence between the probeset and target sequence related information using the {"representative public id", "locus link"} tuple. for an ith probeset, affymapsdetector uses the corresponding tuple to extract the following information from ncbi snp and nucleotide databases  <cit> :

• refseq mrna sequence of the gene referenced by gene accession number.

• list of snp locations, if present, in the mrna sequence for the {"representative public id", "locus link"} tuple.

• for each snp, snp details including: alleles, heterozygosity, snp class, snp position at / strand etc.

affymapsdetector determines the sequence correspondence between the probe and target sequence segment, including comparison of the starting, middle, and end positions of each probe of the ith probeset with the corresponding mrna sequence. it compares the probe's interrogation-position  with the middle position in the matched mrna segment. if the middle and the interrogation positions are not the same, the middle position is used as the reference 13th position in the probe sequence. affymapsdetector then uses the snp-list for the ith probeset to check for the presence of snps at all possible positions in the probes in the ith probeset. table  <dig> shows a subset of the snp output file generated by affymapsdetector using dbsnp as the source. here, "range-min" and "range-max" correspond to the starting and the ending base-indices of the probe sequence with respect to the transcript sequence. row number  <dig>  corresponding to probeset 1341_at, shows an instance of the "interrogation" position  that does not agree with the current "middle position"  of the probe. since affymetrix probes are designed against "exemplar sequences" derived from transcript and est sequences, it is always possible that, as transcript and est databases evolve, a lack of correspondence between the 13th probe-position and the complementary mrna segment will occur, leading to the lack of congruence between the probe and its intended target that we occasionally pick up.

a subset of snp detection output file generated by affymapsdetector run on hg-u95av <dig>  some of the columns have been omitted for brevity. range min is the where the probe starts on the transcript and range max is where it ends. row  <dig> shows an instance where the interrogation position differs from the mismatch  position.

affymapsdetector generates five tab-delimited ascii text files and a log file. the type of information contained in each file is described below:

• probes_with_snps.xls file contains probes that are determined to contain documented snps at any position in the probe sequence.

• probes_without_snps.xls file contains the list of genes and probesets for which no snps are found.

• genes_without_locus_link.xls file contains the list of those genes for which either locuslink information is not provided in the gene-information file or for which affymapsdetector cannot parse the locuslink as a positive integer.

• genes_info_from_web.xls file contains the mrna sequences of genes that are collected by affymapsdetector from the ncbi nucleotide database and used for determining the probe-positions within mrna sequences.

• snps_info_from_web.xls file contains additional information about probes with snps at the 13th and/or any other position. this includes: "nucleotide accession number of gene", "snp position with respect to mrna sequence", "dbsnp reference cluster id – rs#", "protein accession number", "function", "snp class", "heterozygosity", and "allele".

• log.txt file contains the output log messages resulting from affymapsdetector execution. the log information is primarily useful for post-processing follow up, for example, in cases that are described by text such as "a given probe sequence was not found in the extracted mrna sequence"; "program failed to extract mrna sequence"; "snps not found for a given gene"; "program failed to find locuslink for a gene" etc. this helps the user interpret the cause of missing values.

RESULTS
affymapsdetector results for dbsnp-build-123
affymapsdetector can be used to characterize any affymetrix expression genechip™ with respect to snps if the underlying gif and pif files are set up appropriately. for the results reported here, the application was run against the netaffx-supplied gif and pif files for hg-u95av <dig> genechip™, the ncbi's snp database  and the nucleotide database . the genechip™ hg-u95av <dig> contained a total of  <dig>  probes belonging to  <dig>  probesets . processing this chip using affymapsdetector generated the five tab-delimited ascii text files and log file described above. output from affymapsdetector for this array design run against dbsnp-build- <dig> is described below:

• probes_with_snps.xls file:  <dig>  probes were determined to contain documented snps. these probes belonged to  <dig>  probesets . to inspect this list, see additional file 1: 'complete snp output file'. of the  <dig>  probes,  <dig> probes had at least one snp at the 13th position and  <dig>  probes had one or more snps at positions other than the 13th position. to inspect this list see additional file 2: 'probes having snps at mismatch location'.

• probes_without_snps.xls file: the probes from  <dig>  probesets  did not have any documented  snps in the dbsnp- build- <dig>  to inspect this list see additional file 3: 'probesets without snps'.

• genes_without_locus_link.xls file: the gif contained  <dig> probesets  that lacked locuslink information. however, of the  <dig>  probesets, affymapsdetector was able to extract locuslink information from the ncbi snp website for  <dig> probesets . of the remaining  <dig> probesets  on the chip,  <dig> genes were sourced from the institute of genome research , but without the corresponding ncbi gene id and locus link information it was not possible to query the ncbi server for related metadata. for the other  <dig> genes, locuslink information was not available at the ncbi website at the time affymapsdetector was run on hg-u95av <dig>  to inspect this list see additional file 4: 'expression genotype'.

• genes_info_from_web.xls file: this file contains mrna sequences of  <dig>  genes. to inspect this list see additional file 5: 'hg-u95av <dig> genes mrna sequence'.

• snps_info_from_web.xls file: this file contains useful meta-information at the gene level, including "nucleotide accession number", "genbank gi number", "locuslink id" and "gene description" corresponding to all  <dig>  genes. this information is very helpful for subsequent analyses, such as examining the position effects of labeling strategies, or determining the exon membership of probes. to inspect this list see additional file 6: 'additional snp information for having snps'.

• log.txt file: sequences of the  <dig>  probes belonging to  <dig>  probesets  that do not map to their corresponding genes' mrna sequence at collected in this file. to inspect the results please see additional file 7: 'affymapsdetector execution log'.

recently, affymapsdetector was run against the latest dbsnp version, build- <dig>  results obtained from dbsnp-build- <dig> and dbsnp-build- <dig> are summarized in table  <dig>  result files from test hg-u95av <dig> runs using dbsnp-build- <dig> and dbsnp-build- <dig>  and for additional gene chips including hg-u <dig>  mg-430a <dig>  and rae- <dig>  using dbsnp-build- <dig>  are available from the project home page.

comparison of the output results from affymapsdetector run on hg-u95av <dig> against dbsnp-build- <dig> and dbsnp-build- <dig> 

we note that output results will change as dbsnp evolves and grows, and also that updates in the build files must be treated with caution. for example, one such update of the ncbi snp database  caused a significant change in the results we obtained; in particular there was a marked decrease in the number of probes containing snps. further investigation, and follow up with the curators at ncbi, identified the cause as an internal dbsnp error in transferring the data in the new build, and a recommendation to revert to dbsnp-build- <dig>  therefore, we strongly suggest that the users carefully date output files and include versions of the source databases and files used as references.

experimental data set
in order to determine whether there is any significant effect due to the presence of snp alleles on the analysis of an experimental dataset, the snp identification results from affymapsdetector were used to characterize the behavior of snp-containing probes in a specific data set. here, we used a hg-u95av <dig> based lung adenocarcinoma dataset to examine the impact of discriminating snp-containing probes  <cit>  from non-snp containing probes. this dataset contained  <dig> cel files corresponding to  <dig> unique lung adenocarcinoma positive samples . dna-chip analyzer   <cit>  was used to retrieve pm and mm intensity values corresponding to all probes in the  <dig> cel files and these values were stored in a single large file, called the "lung adenocarcinoma probe data ", available on the authors' project web page.

snps and probe intensity distribution
since the samples were not genotyped, we did not know what snps were present in a particular sample. at the same time, the snps in dbsnp must be present in a minimal frequency in the test population, so it is reasonable to assume that some of them occurred in this relatively large experimental sample. in order to determine whether snp-containing probes as a group behaved similarly to the single-allele detecting probes, we compared the intensity distribution of expression values for the following two sets of  <dig> probes:

 <dig>  probes with snps: this group included  <dig> probes that had a snp at the 13th position.

 <dig>  probes without snps: probes in this group were randomly selected from the set of probes without any known snps. several such sets were created, with similar outcomes each time.

for each group, the intensity differences i.e. the  values were extracted from lapd into a two dimensional matrix of size 325x <dig>  the values were plotted using matlab v <dig>  and the distributions compared for mean and standard deviation from the mean. as seen in figures 3a and 3b, intensity frequency distributions of these two datasets indicate distinct differences in both the mean and variance of the distributions of these two groups.

snps and pm and mm probe binding efficiency
to explore the effect of snps on target binding efficiencies for pm and mm probes, we decided to compare adjacent probes on a transcript, where one probe was predicted to contain a snp and the second was not. we initially focused on probes with one snp at the 13th position since they provided the least ambiguous case for analysis. however, in order to assess global properties we later expanded the criterion to include all snp-containing probes. for a measurement to be valid the intensity must fall within a particular scanner range. therefore, we selected the probes for which the pm and mm signal intensities in the  <dig> cel files satisfied the requirement that the intensity fell in the linear measurement range, i.e. in the range . results show a number of genes for which there was a great similarity in pm and mm values across all probes in a probeset, except at a snp-containing probe. one such example is shown in figures 4a and 4b, using dchip graphical output to compare and contrast the possible effect of a snp on the expression levels of human ribosomal protein s <dig>  the results for two different samples are shown: sample- <dig>  and sample- <dig>  from the lung adenocarcinoma study. in this figure it can be seen that for  <dig> of the  <dig> probes in probeset 31568_at  the intensity of pm>mm, and the intensity difference  in each probe is consistent between the two samples. this consistency is violated for the ninth probe, where snp results from affymapsdetector indicate that the ninth probe  in probeset 31568_at has a snp at the 13th position. one consequence is that, since dchip output for the gene for sample- <dig> shows probe  <dig> with pm>mm intensity, it includes the p <dig> response in the computation of the 'presence' call as well as in further downstream gene expression data analysis . however, dchip output for this gene for sample- <dig> has mm>pm intensity for probe  <dig>  so it will not be used in the computation of the presence call, and the intensity contribution will be replaced by one using an idealized background calculation, which modifies the total concentration calculation for the second sample .

for more examples of genes in which probepairs showed this behavior in samples in this experiment, please see additional files  <dig> and 9: 'behavior of snp-containing probes with respect to pm and mm binding efficiencies.'

alteration of probeset detection call using pm/mm swap
despite the example above, it is possible that a small change in intensity in one probe pair, averaged over  <dig> probe pairs, would have a very minor impact on the outcome, reflected either in the total intensity of the gene or in the presence/absence call of the gene. for this analysis we focused on the subset of snp-containing probes that have a snp at the 13th position. for a randomly chosen sample , the corresponding cel file was modified by swapping pm and mm values for those samples where the probes containing snps had mm > pm, to study the effect on presence/absence calls of the genes. the program dchip was used to explore the effect of this exchange on the probeset detection call. to make the comparison, both the modified cel file and the original  cel file were loaded into dchip simultaneously, thus simulating a comparison of two different samples/experiments. we found that, for some probesets, allowing for the presence of snps at the 13th position by using the mm intensity in place of the pm intensity altered the probeset detection call . in particular, the detection call for probesets 1486_at and 34345_at changed from 'absent' to 'present' and for the probeset 37746_r_at the result was a change from 'marginal' to 'present'. to see the complete list of results see additional file 10: 'examples of probes affecting probeset detection calls.' in these cases the genes will now have to be included in gene lists for downstream analyses such as differential expression estimation and clustering.

expression signature pattern analysis
the most common use of snps is to genotype individuals. the types of measurements available from gene expression arrays make it difficult to extract genotype information because expression level differences of each allele are layered on the genotype differences. it was not clear whether or not a sample genotype expression signature would emerge from genechip data. since the ratio of pm to mm values was to be used and dividing by a small number inflates such a ratio, in the next experiment we required that intensity levels of both the pm and mm probes be at least  <dig> fluorescent units. we organized pm/mm ratio values as an  matrix in a tab delimited ascii text file, where each row corresponded to a probe/gene of interest  and each column corresponded to a sample/chip of interest. we tuned for measurement reproducibility based on duplicate samples present in the experiment, and then binned the results into three categories, pm/mm ≥  <dig>  pm/mm ≈  <dig>  pm/mm ≤  <dig>  a heat-map type viewer was used for visualization of the results as shown in figure 5; ratios of pm/mm >  <dig> are represented in red, pm/mm <  <dig> are represented in green, and pm/mm ≈  <dig> are represented in yellow, with increasing color saturation as the ratio values increase. after removing the probes/genes that do not vary across the sample population, three classes of interest were identified:

 <dig>  class a: samples in which "allele a is over-expressed compared to allele b."

 <dig>  class b: samples in which "allele b is over-expressed compared to allele a."

 <dig>  class a/b: samples in which "alleles a and b are equally expressed."

based on the patterns of the classes, it was possible to select a subset of snp-containing probes that uniquely identified each sample; reproducibility was confirmed by using duplicate samples as the test set. all duplicates were correctly identified and none of the unique samples had exactly the same pattern. see additional data file 11: 'snp-containing probes' pm/mm ratio data file for expression genotype' as an example of the dataset that was used for expression genotyping.

software testing
affymapsdetector was run on a windows xp  platform with  <dig>  ghz intel® pentium® m processor and 2gb ram, on a windows  <dig> platform with  <dig>  ghz intel pentium processor and  <dig> gb of ram, and on a second windows  <dig> platform with  <dig>  ghz pentium processor and  <dig> gb of ram. it was observed that in each case affymapsdetector took about six hours to finish processing  <dig>  probesets housed on hg-u95av <dig>  actual execution time will vary depending on factors such as the machine's processing power, size of the chip, internet bandwidth, and network traffic to the ncbi server. affymapsdetector compiled and source codes are available as: additional data file  <dig> 'affymapsdetector v <dig> distribution package ', and additional data file  <dig> 'affymapsdetector v <dig> source code'. these files are also available for download from the authors' project web page.

discussion
the analysis of affymetrix genechip™ expression arrays is quite complex because of the various factors contributing to the intensity measurements. among the most commonly explored problems are those of cross-hybridization caused by other sites in the genome  <cit>  and probe assignment inconsistencies that occur over time due to changing gene annotations  <cit> . here, we have identified probes that are a potential source of signal assignment errors, either due to changes in the underlying sequence that we have identified, or due to the presence of alternate alleles arising from snps. our software identifies:

 <dig>  probes that no longer provide measurements for the gene that they were designed to represent.

 <dig>  probes that measure targets known to have one or more snps, leading to the potential for confounding the pm and mm signal intensities and the relationship between the two in a sample.

affymapsdetector results show that  <dig>   of the hg-u95av <dig> probes do not actually map to the corresponding gene sequence. table  <dig> shows the summary statistics of such probes for human, mouse, and rat gene chips. while not the affymapsdetector's primary focus, the supporting data is collected during the normal course of processing, and can be used to compile the corresponding statistics by parsing the output log. these probes may be simply flagged and excluded from analyses or may be a source of interest in themselves. here we have chosen to examine the effect of excluding them, since the focus of our interest was to study the effect of snps on the interpretation of gene intensity values. of the remaining ~ <dig> % probes, ~ <dig> %  contain dbsnp-characterized snps. among these, one group of  <dig> probes has snps present at the 13th position while the other group of  <dig>  probes has one or more snps at some position other than the 13th position. the first group provides a simpler set for interpretation of the experimental results, since in this case the snp position coincides with the mismatch position between the pm and mm probes.

probe level statistics based on affymapsdetector log results for probes that do not actually represent the gene that they were designed to represent .

in figures 4a and 4b, where dchip graphical output was used to compare and contrast the possible effect of a snp on the expression levels of human ribosomal protein s <dig> in two different samples, dchip flags p <dig> probe as an outlier  and replaces the actual mm signal intensity value with a computed value in determining the 'presence' call. this may adversely affect the quality of subsequent downstream analysis since the intensity value assigned to the gene changes as well. although other researchers have produced lists of cross-hybridizing probes using different criteria for an acceptable match  <cit>  and this probe did not appear on those lists, we independently checked for cross hybridization with transcripts from genes other than s <dig>  we examined the blast hit results for the p <dig> sequence against the ncbi non-redundant nucleotide database "nr". the blast results indicate that the p <dig> sequence has no significant cross-hybridization with currently known expressed sequences. therefore, for sample- <dig>  the observation that p <dig> > p <dig> can be best explained by the presence of a snp at the 13th position in this sample. given that multiple alleles are represented in the population of samples, there are several associated consequences. first, the gene-quantitation results for the first sample will be altered by the intensity value contributed by this probe . second, a comparison of the gene expression between these two samples will be altered. third, a potentially useful piece of information about the presence of a genotypic variant will be lost.

if snp-containing probes are generally different in their behavior from non snp-containing probes, then genes with such probes might cluster differently than they otherwise would based solely on the intensity differences. we quantitatively analyzed the intensity distribution of probes using the  difference that is customary when mm values are taken into account. the intensity profiles differ in both mean and variance, indicating that different properties are being measured by the two types of probes and therefore significant information may be lost if the analyst ignores snp-containing probes in this dataset. the intensity values in the probes with snps were spread over a much wider range and the overall distribution was shifted towards negative values when compared to the intensities of the set of probes without snps, implying that the mm signal is greater than the pm signal for the 'average' probe pair in this group. in this dataset, the impact of snp-containing probes is to decrease gene intensity estimates for genes that have such probes as compared to the genes without such probes. unless samples are snp qualified, our recommendation for the downstream intensity computation algorithms such as mas <dig> and rma is to remove the snp-containing probes. in our analysis, we confirmed the repeatability of observed intensity distribution profile difference between the probes with/without snps by generating plots similar to figure  <dig> for three independent selections of non-snp containing probes. these results are contained in additional file 14: 'intensity distribution profiles confirmation.'

although the presence of snp-containing probes has the potential to degrade the quality of gene expression data, we considered whether these measurements might be useful in their own right. simultaneous  expression of both alleles of a gene has been observed by others  <cit> ; we were interested in determining whether it is possible to identify allelic expression signatures of the samples using snp-containing probe pairs. we performed an analysis to build allelic expression signatures using only those probes containing snps and showed that duplicate samples could be uniquely identified based on simple binning of expression ratios. we are in the process of developing a second program to perform more complete expression genotyping analyses, including a component for compensating for the different types and frequencies of snp alleles.

CONCLUSIONS
we present a tool that can be used to supplement the annotations provided for probes on the affymetrix genechip™ platform. the snp detection results from affymapsdetector can be effectively used in the data analysis phase of a microarray experiment. in our study, the snp results were found to be significant since the snp-containing probes show behavior consistently distinct from the non-snp containing probes when evaluated in terms of both the intensity distribution of each probe class and the contribution each class of probe has on the determination of individual transcript presence or intensity by several programs. the snp annotation information can be used by researchers to assign a physical reason for the measured behavior of some of the mm probes. this information permits researchers to choose explicitly whether and how to include intensity estimates from these probes in the overall gene expression value for a probeset. since snp-containing probes behave differently from those without snps, separating the two for a given analysis may improve gene association and disease classification studies. as investigators use microarray experiments to study the intricate relationships and complex interactions between the molecular species in a biological system, we believe that the corresponding data-analysis or data-mining strategies will require processing of the data using multiple approaches. we have demonstrated the importance of one such approach in the interpretation of results from our research and we hope that it will serve others in a similar fashion.

we are currently in the process of extending the affymapsdetector tool to produce explicit information about the cross-hybridization potential for every probe across the target genome including any characterized sequence variants, incorporating nearest neighbor estimates for the stability of all snp-based alleles. we are also extending the affymapsdetector utility set to allow assessment of genechip™ probe layouts in order to locate the probes with snps, probes without snps, any error prone probes that are not found to map to the corresponding gene's sequence, and potentially cross-hybridizing probes on the chip along with integrated context-sensitive annotations.

affymapsdetector code and documentation distribution is open source under the gpl license and is available on the project home page. it can be readily modified to run locally if appropriate databases are set up correctly. this approach will allow the user to include proprietary information about snps in the analysis. we recommend regenerating the affymapsdetector output files when source databases are updated. we have posted copies of the files generated for this report at the project home page. these can be downloaded by anyone interested in using the information to flag probes present in affymetrix genechip designs without running the program. although all reasonable efforts have been made to ensure the accuracy and reliability of the software and data, the changing nature of data sources and user specific configuration make it impossible for the authors to warrant the performance and/or results that may be obtained by using the software or data. the authors disclaim all warranties as to performance, merchantability or fitness of output of the software for any particular purpose. in any work or product derived from this material, proper attribution of the authors as the source of the software or data should be made.

availability and requirements
• project name: affymapsdetector

• home page: 

• operating system: platform independent

• programming language: java

• other requirements: sun java™  <dig> runtime environment , standard edition,  <dig> +;  <dig> mb or higher ram; about 300mb of free hard disk space.

• license: gnu gpl 

• availability: source code available from the project home page.

• any restrictions to use by non-academics: none

abbreviations
affymapsdetector: affymetrix microarray probe snp detector

ascii: american standard code for information interchange

cdf: chip definition file

dbsnp: ncbi snp database

gif: netaffx gene information file

gui: graphical user interface

im: algorithmically computed ideal mismatch intensity value

lapd: lung adenocarcinoma probe data 

mas  <dig> : affymetrix microarray suite version 5

mm: mismatch probe

pif: netaffx probe information file

pm: perfect match probe

rma: robust multi-chip average

snp: single nucleotide polymorphism

uml: unified modeling language

authors' contributions
jw formulated the main idea of systematically identifying snp-containing probes in genechip™ expression arrays. sk and lkv conceived the idea of automating the process of characterizing genechip™ probes with respect to snps, designed and implemented snp-detection/data-analysis algorithms, affymapsdetector tool. sk and lkv also performed the data analysis work with constant insights and critiques from jw. all authors read and approved the final manuscript.

supplementary material
additional file 1
complete snp output file. the listing of snp-containing probes generated by affymapsdetector for hg-u95av <dig> 

click here for file

 additional file 2
probes having snp at mismatch location. the listing of probes having a snp exactly the 13th position in the probe sequence. it also includes the probes that have snps at other position in addition to 13th position.

click here for file

 additional file 3
probesets without snps. the listing of all hg-u95av <dig> probesets, none of whose probes were found to contain any documented snps.

click here for file

 additional file 4
genes with undefined locuslink. the listing of all hg-u95av <dig> genes/probesets for which either locuslink was not defined  or affymapsdetector couldn't disambiguate the given locuslink information.

click here for file

 additional file 5
hg-u95av <dig> genes mrna sequence. the listing of hg-u95av <dig> genes mrna sequence extracted by affymapsdetector from ncbi nucleotide database. since size of this file is more than  <dig> mega bytes, only a truncated version of this file is provided here . however, complete file can be obtained from the project home page.

click here for file

 additional file 6
additional snp information for probes having snps. this file contains additional snp information, extracted by affymapsdetector from ncbi dbsnp, for probe having snps.

click here for file

 additional file 7
affymapsdetector execution log. this file contains useful information logged by affymapsdetector during hg-u95av <dig> run.

click here for file

 additional file 8
behavior of snp-containing probes with respect to pm and mm binding efficiencies. this file presents examples of snp-containing probes that affect pm and mm binding efficiencies in a tabular form with hyperlinks to dchip graphical images. due to the large volume of data and size of the image files, this file is one of two parts. each file,  <dig> and  <dig>  unzips into its respective folder." underneath each folder, you would see "effectofsnpsonexpression.html" file and "dchipgraphics" folder containing  <dig> image files in .emf format in each folder. for hyperlinks to work properly in "effectofsnpsonexpression.html" file, make sure that all image files reside together underneath one "dchipgraphics" folder .

click here for file

 additional file 9
behavior of snp-containing probes with respect to pm and mm binding efficiencies. this file presents examples of snp-containing probes that affect pm and mm binding efficiencies in a tabular form with hyperlinks to dchip graphical images.

click here for file

 additional file 10
example of probes affecting probeset detection calls. this file contains some examples of snp-containing probes that affect probeset detection call.

click here for file

 additional file 11
snp-containing probes' pm/mm ratio data file for expression genotype. an instance of a pm/mm ratio data file from adenocarcinoma positive sample-replicates that can be loaded into the data visualization utility for expression signature pattern analysis.

click here for file

 additional file 12
affymapsdetector v <dig> distribution package . affymapsdetector v <dig> distribution package .

click here for file

 additional file 13
affymapsdetector v <dig> source code. affymapsdetector source code.

click here for file

 additional file 14
intensity distribution profiles' confirmation. the set of files in this archive contain data analysis experiment results on lung adenocarcinoma dataset to confirm repeatability of intensity distribution patterns differences between probes with snps and probes without snps.

click here for file

 acknowledgements
the authors wish to thank hrishikesh deshmukh for testing the software; satyendra kumar, vivek kumar and cynthia gibas for reviewing the manuscript and the affymapsdetector website.
