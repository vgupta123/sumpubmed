BACKGROUND
metagenomics, or the direct sequencing of collective genomes is paving the road to a better understanding of our ecosystems and the impact of microbes on human health. researchers are now changing the genome-centric approach, which focussed on isolation, cultivation and sequencing of single species at a time by sequencing complete dna samples from an environment, thus bypassing the isolation and cultivation step. at present, most metagenomes are sequenced using the whole genome shotgun approach  <cit> . when used in combination with the sanger technique  <cit> , a collection of short sequence reads with average length of  <dig> bp is generated  <cit> . recovery of dna fragments of several thousand base pairs is also possible using bacterial artificial chromosomes   <cit> . longer dna fragments can be also obtained when short overlapping reads are assembled into larger dna stretches referred to as contigs.

an essential task addressed in the metagenomic data analysis workflow is to predict the source organism or taxonomic origin of each read or assembled contig. this process is called taxonomic classification or binning. predicting the taxonomic origin of reads or contigs can aid in linking gene functions to members of the community or to reconstruct the microbial composition of the studied sample. the knowledge of the taxonomic composition of a sample can be used to derive valuable ecological parameters at the community level   <cit>  or at the population level   <cit> .

two types of methods are used for the taxonomic classification of environmental fragments: composition-based and similarity-based-methods. similarity-based-methods depend on a sequence-comparison with a reference set of genomic sequences. similarity-based methods directly align metagenomic sequences to a reference set, e.g. using blast  <cit> . composition-based methods rely on characteristics that can be extracted directly from the nucleotide sequences . recently, methods employing sequence-composition-based features are gaining popularity  <cit> . in particular, oligonucleotide frequencies have frequently been used because they carry a phylogenetic signal  <cit> . karlin et al.  <cit>  showed that significant deviations in terms of di-nucleotide or tetra-nucleotide frequencies were less significant within a genome than between genomes of different species.

from a machine learning point of view composition- and similarity-based methods can be further divided into supervised and unsupervised apporaches. in the context of this work, supervised methods require a reference set of genomic sequences with known taxonomic origin. supervised composition-based methods use the reference set to learn sequence characteristics of each taxonomic class during a training phase. subsequently, the trained classifier is used to identify the taxonomic class of fragments of unknown origin. for example methods such as a bayesian classifier  <cit>  and phylopythia  <cit>  fall into the supervised composition-based category. although megan  <cit>  and carma  <cit>  do not have a training phase, these similarity based classifiers are supervised since they rely on the alignment of the genomic fragments to reference sequences with known taxonomic origin.

the recently published carma software  <cit>  has been developed to taxonomically classify short reads  derived by the pyrosequencing technique   <cit> . carma showed to be very accurate on taxonomically classifying reads that carry a complete or partial protein family contained in the pfam database  <cit> . carma has the advantage of giving very accurate predictions but it is computationally expensive. megan  <cit>  performs well in classifying genomic fragments if closely related reference genomes are available, which may not be always the case for organisms contained in an environmental sample. in general, sequence similarity based classifiers, such as carma and megan, have the disadvantage of being able to predict the taxonomic class for only those fragments carrying a partial gene or a protein domain. compared to megan and carma, our proposed strategy has the advantage of being easy to maintain and the complete strategy can be run on a desktop computer in a reasonable time frame without preprocessing steps. phylopythia, a supervised composition-based method, uses over-represented oligonucleotide patterns as features to train a hierarchical collection of support vector machines , which is subsequently used to predict the taxonomic origin of genomic fragments as short as  <dig> kbp  <cit> . support vector machines demonstrated to achieve a high classification accuracy for fragments of length ≥  <dig> kbp and moderate accuracy for  <dig> kbp long fragments. however, the complete classifier needs to be retrained  when newly sequenced genomes are added to the training set.

unsupervised learning approaches do not depend on reference sequences for classification, instead characteristics are directly learned from the same data set that is being analyzed. in the context of metagenomics, unsupervised learning methods are used to group genomic sequences such that all sequences originating from the same taxon are grouped into one cluster. notably, this grouping can be done on different taxonomic ranks, ranging from superkingdom to species. unsupervised methods are for example employed as a pre-processing step for assembly or to study the community composition of samples. additionally, marker sequences of known taxonomic origin can be used to infer the taxonomic origin of each generated cluster. however, in this case the marker sequences are not involved in the classification process per se  <cit> .

several unsupervised methods have been developed for the analysis of metagenomic data, the pioneering tetra  <cit>  used tetranucleotide-derived z-score correlations to taxonomically classify genomic fragments from metagenome libraries of low diversity. abe et al.  <cit> , in a following work, showed the feasibility to classify environmental genomic fragments with minimal length of  <dig> kbp using a self-organizing map . more recently, chan et al. developed a seeded growing self-organizing map   <cit>  to cluster metagenomic sequences.

currently, completely sequenced genomes, which could be used as a reference for the taxonomic classification of metagenomic sequences, become available at an exponential rate. therefore, the taxonomic classification of metagenomic data will greatly benefit from supervised methods that can be instantaneously updated when new genomes become available. herein, we present a taxonomic composition analysis method  able to predict the taxonomic origin of environmental genomic fragments of variable length in a supervised manner. tacoa can be easily installed and run on a desktop computer offering more independence in the analysis of metagenomic data sets. furthermore, the reference set used by the proposed classifier can easily be updated with newly sequenced genomes.

tacoa applies the intuitive idea of the k-nearest neighbor  approach  <cit>  and combines it with a smoother kernel function  <cit> . compared to other less intuitive and more complex approaches, k-nn based methods have proven to yield competitive results in a large number of classification problems  <cit> . in particluar, if the classification problem has a multi-class nature. the kernelized k-nn approach used in tacoa allows to realize an accurate multi-class classifier. in general, k-nn is intuitive, does not make any assumptions about the distribution of the input data and the reference set can be easily updated. for a wide range of practical applications it approximates the optimal classifier if the reference set is large enough. a further advantage is that the classification results can be easily interpreted. however, the traditional k-nn algorithm runs into problems when dealing with high dimensional input data   <cit> . in our extension of k-nn, the introduction of a gaussian kernel helps to alleviate this problem.  <cit> . by using a smoother kernel function the complete reference set is considered during the classification procedure instead of a strict neighborhood. we present our kernelized k-nn approach as an alternative to solve the problem of taxonomically classifying environmental genomic fragments.

RESULTS
the idea behind our approach is to exploit the benefits of the case-based-reasoning k-nn algorithm, which classifies vectors  on the basis of the class labels observed for vectors in its neighborhood while keeping the advantage to approximate to the optimal classifier if the training set is large enough. in particular, we used a smoother kernel function with gaussian density to profit from its implicit weighting scheme, thus allowing more flexibility on setting the neighborhood width and in handling high-dimensional input data. the weights given by a smoother kernel function decrease as the euclidean distance between the classified gfv and the reference vector increases. the rate at which the weights decreases is controlled by the neighborhood width λ  <cit> .

algorithm
in this study, a genomic fragment is defined as a dna sequence of a given length . the total number of oligonucleotides of length l, from the alphabet ∑ = {a, t, c, g} is given by 4l. each genomic fragment is represented as a vector  using the vector space model  <cit> . for each of the possible four oligonucleotides in a sequence, the vector stores the ratio between the observed frequency of that oligonucleotide to the expected frequency given the gc-content of that genomic fragment.

in order to predict the taxonomic origin of a query gfv, tacoa compares that query gfv to the reference gfvs. in our method, the reference gfvs are computed from all  <dig> completely sequenced reference genomes. in the following, the set of all computed reference gfvs is named as reference set . in this study a reference set consisting of  <dig> genomes was used, i.e. t =  <dig> in this case.

more formally, let refset = {xj } with  <dig> ≤ j ≤ t be the set of reference gfvs, where each xj represents a gfv computed from a completely sequenced reference genome. let x be a query gfv representing a genomic fragment to classify. the multi-class classification problem addressed herein, resides in deciding to which of all different taxonomic classes, at rank r, x belongs to.

for each taxonomic rank r out of superkingdom, phylum, class, order and genus and for each taxonomic class i at that rank, the algorithm computes a discriminant function δi, and then classifies x into that class with the highest value for its discriminant function.

more precisely, for a given taxonomic rank r, let i be that class with the highest discriminant function δi. then, x is classified into class i if δi is at least half as large as the value of the second highest discriminant function on rank r, otherwise x is classified as "unclassified". this optimal cut-off value for the discrimination function at each taxonomic rank r was identified in a grid search. the discriminant function for a taxonomic class i is computed by:

  δi=∑xj∈refikλ 

where refi = {xj|xj ∈ refset and xj stems from class i} is the set of all reference gfvs from class i. the smoother kernel kλ is based on the gaussian density function that exponentially decreases with euclidian distance from x:

  kλ=e22λ) 

where dw is a weighted distance function as defined later in equation  and λ controls the neighborhood width around x in the kernel function. small values of λ result in decision boundaries with higher variance that well-fit the reference set while large values achieve smooth and stable decision boundaries that avoid overfitting and are more robust  <cit> .

in order to estimate how much a query gfv x differs from a reference gfv the distance between the two vectors is determined. by normalizing each vector to unit length differences in genomic vector lengths are corrected. the distance d between a query gfv x and each reference gfv xj is computed using the dot-product between the normalized query gfv x^ and the normalized reference gfv x^j:

  d=1−<x^,x^j> 

the distance d was weighted in order to account for the imbalanced reference set used in this study, where majority classes and minority classes are present, e.g. the bacteria group is over-represented compared to the archaea in a proportion of 10: <dig> 

the weighted distance function is denoted as dw and the weights are assigned using the following weighting scheme. let xj originate from class i and let ni be the number of genomes in class i. furthermore, let t be the number of genomes constituting the reference set. the weighted distance function dw is given by:

  dw=tnid 

this weighting scheme assigns small weights to the gfvs belonging to the majority classes and a relative larger weight for gfvs contained in the minority classes.

testing
as a proof of concept the method was evaluated on a data set containing fragments from  <dig> completely sequenced genomes representing a vast majority of members from the archaeal and bacterial group. all completely sequenced genomes available up to march  <dig> were downloaded from the seed database  <cit> . the selected genomes represent  <dig> superkingdoms,  <dig> phyla,  <dig> classes,  <dig> orders and  <dig> genera. the taxonomic information for this data set was collected from the taxonomy database located at the us national center for biotechnology information   <cit> . some of the genomes downloaded from seed were unfinished and present as several contigs. in this case, all contigs of each genome were arbitrarily joined together.

evaluation strategy
the classification accuracy of the presented method was assessed using the leave-one-out cross-validation strategy. in the leave-one-out cross validation, one genome is used to generate fragments of a fixed length and thereafter the taxonomic origin of each fragment was predicted using the remaining  <dig> genomes and used as the reference set . this simulates the case when the taxonomic origin of dna fragments is predicted that stem from genomes that are not yet represented in the public genome databases. in a second experiment we also evaluated the classification accuracy of the method with the test set included in the reference set, i.e. in this case the fragments of each genome were taxonomically classified using all  <dig> genomes as a reference. this experiment simulated the case when fragments need to be classified but they stem from genomes that are already represented in the reference set.

parameter optimization
we extensively investigated the oligonucleotide length parameter choosing different values of l  and detected the length which resulted in the maximal classification accuracy. for short fragment lengths only small l values were considered to guarantee that all possible oligonucleotides have a sufficient occurrence, i.e. 4l < |s| in a genomic fragment s . the optimal oligonucleotide length l was identified for each genomic fragment length at each taxonomic rank.

oligonucleotides of length  <dig> were sufficient to achieve high classification rates for genomic fragments of length  <dig> bp,  <dig> kbp, and  <dig> kbp. for genomic fragments of length  <dig> kbp,  <dig> kbp, and  <dig> kbp, oligonucleotides of length  <dig> were best suited for classification. a general trend for all genomic fragment lengths was that both average specificity and average sensitivity dropped when oligonucleotides longer than  <dig> were analyzed. in additional file  <dig> the oligonucleotide length-dependent classification accuracy is exemplified using sequence of length  <dig> bp and  <dig> kbp. conversely, the false negative rate increased when longer oligonucleotide lengths were considered . a detailed table summarizing average accuracy values and standard deviations for the two different fragment lengths  and for each oligonucleotide length analyzed is given as additional file  <dig> 

the kernel parameter λ governs the width of the local neighborhood, thus influencing the local behavior of the decision boundary allowing to search for an optimal trade-off between a well-fitted and a more generalized classifier.

a grid search  was employed to detect values of λ resulting in maximal accuracy values . in general, λopt is smaller at lower taxonomic ranks . this observation may be explained by the drastic increase on the number of taxonomic classes at deeper ranks. if a large number of taxonomic classes occur at deeper ranks, the neighborhood to be considered in the classification task needs to be smaller  than for broader taxonomic ranks. on the other hand, if a large λ is considered and a large number of classes exists, the respective neighborhood of a query genomic vector may cover too many reference vectors from diverse taxonomic classes; resulting in a negative impact on the classification accuracy. however, if the reference vectors from a taxonomic class are sparsely distributed from the query genomic vector, it is necessary to consider a bigger neighborhood . this may explain those cases where a large λopt is obtained.

optimal lambda parameter  is shown for each genomic fragment length at each taxonomic rank: superkingdom , phylum , class , order , and genus .

during the optimization procedure, optimal parameters were chosen based on average accuracy values over all taxonomic classes at each taxonomic rank, therefore it may occur that the optimal parameters chosen are indeed suboptimal for some taxonomic classes at a given rank. in consequence, the accuracy for some taxonomic classes can drop dramatically, this situation can be seen as "gaps" in figure  <dig> 

from a practical perspective we regarded it to be more valuable to produce a low number of highly reliable predictions rather than a large number of predictions with low reliability. therefore, in this study we favored parameters that produce a high specificity rather than a high sensitivity.

classification accuracy for genomic fragments of variable length
the classification accuracy of tacoa was evaluated on genomic fragments of lengths ranging from  <dig> bp to  <dig> kbp. a total of  <dig> , <dig> genomic fragments from  <dig> different species were analyzed, comprising ≈ <dig> mb of sequence data. the classification accuracy for all different evaluated genomic fragment lengths, taxonomic ranks, and taxonomic classes is given in detail in figure  <dig> 

a high proportion of contigs  was correctly classified with an average sensitivity between 76% at rank superkingdom and 39% at rank genus . at the same time, less than 10% of contigs were misclassified  at all taxonomic ranks. for the remaining contigs the taxonomic origin could not be inferred and hence these were assigned to the "unclassified" class. overall, reliable predictions were obtained with an average specificity ranging from 89% at superkingdom to 71% at rank genus. for the longest analyzed contig length , tacoa achieved an average sensitivity of 82% at superkingdom and 46% at genus, and specificity of 93%  and 77%  . also for shorter contigs, a high classification accuracy was obtained. for example, 74% of the contigs of length  <dig> kbp were correctly classified at rank superkingdom and 31% at rank genus , the specificity for contigs of length  <dig> kbp reached values between 74%  and 31% .

in this evaluation, single reads were represented by genomic fragments of length  <dig> bp –  <dig> kbp. tacoa is capable of accurately predicting the taxonomic origin of single reads up to the rank of class, despite the limited information contained in these short sequences. a high proportion of reads was correctly classified. for reads of length  <dig> bp, the average sensitivity was between 67% at superkingdom to 16% at rank class and for reads of length  <dig> kbp, it ranged from 71% to 22%. furthermore, in average only between 9%  and 5%  of reads were misclassified. overall, reliable predictions were obtained, with an average specificity ranging from 73%  to 62%  for  <dig> bp reads and between 73% and 64% for reads of length  <dig> kbp. in light of the limited information contained in fragments of length  <dig> bp –  <dig> kbp and the complexity of the classification problem , tacoa also achieves a surprisingly good performance for single reads at rank order and genus .

however, in practice it is not recommended to interpret classification results of single reads on these ranks because only a small number of fragments may be represented in the currently available sequenced genomes. in real metagenomic data sets, already sequenced organisms may be contained in the studied sample. therefore, the classification accuracy of tacoa was also assessed for fragments stemming from organisms included in the reference set . as expected, having the source organisms of classified fragments included in the reference set has a markedly positive impact on the accuracy at all taxonomic ranks. the sensitivity increased of up to 30%. furthermore, the specificity substantially increased while the false negative rate was reduced .

as a general trend, the accuracy improves when longer genomic fragments were classified . for example, on rank superkingdom the sensitivity increased from 67% for  <dig> bp reads to 82% for  <dig> kbp contigs and at rank genus from 5% to 46%. conversely, the accuracy decreases as deeper taxonomic ranks were examined . in general, it is easy to predict classes that are well represented in the reference set, while detecting the underrepresented taxonomic groups is more challenging . tacoa is capable of detecting a remarkably high number of different taxonomic classes, if they are present in a studied sample. for example for contigs of length  <dig> kbp, tacoa achieved a sensitivity above 20% for all  <dig> phyla, for  <dig> of the  <dig> classes, for  <dig> of the  <dig> orders, and for  <dig> of the  <dig> genera represented in our test set .

assessing the classification accuracy of tacoa and phylopythia for genomic fragments of variable length
we compared the classification accuracy  of our proposed kernelized k-nn classification method with phylopythia, which employs a hierarchical collection of svms for the taxonomic classification of environmental fragments. the set of completely sequenced genomes used for comparison was selected as follows: at rank class, two different genomes were randomly chosen from each taxonomic class guaranteeing that the data set used in the comparison is unbiased. moreover, the genomes were randomly selected from the universe of all recently published genomes ensuring that the test set is not contained in the training set of phylopythia or reference set of tacoa. the selected test set resembles very well the situation when the classifiers need to predict the taxonomic origin of organisms that have not yet been sequenced.

in general, tacoa and phylopythia achieved quite comparable classification accuracies, but tacoa has a slightly improved performance for the classification of short dna fragments. for the classification of reads of length  <dig> bp and  <dig> kbp, tacoa has a higher sensitivity while both tools achieve a comparable false negative rate and specificity values . remarkably, on ranks order and genus tacoa is still able to correctly classify between 3% and 17% of short fragments , while phylopythia cannot infer the taxonomic origin of any of the fragments and thus has an average sensitivity of 0%. for longer contigs  phylopythia is more sensitive on higher taxonomic ranks . in contrast, tacoa produces less misclassifications  making its prediction more reliable. on lower taxonomic ranks , tacoa is able to correctly infer the taxonomic origin of about 10% to 17% of all contigs, while phylopythia has a sensitivity of 0% for all taxonomic groups at these ranks.

a closer analysis of the classification of short dna fragments, across ranks superkingdom to class, reveals that tacoa achieved sensitivity values of 71% to 3% for  <dig> bp fragments and 76% to 11% for  <dig> kbp fragments. on the other hand, at ranks superkingdom, phylum and class phylopythia obtained a slightly lower sensitivity of 66% to 6% for  <dig> bp fragments and 75% to 9% for  <dig> kbp fragments. at deeper ranks order and genus, tacoa is able to correctly classify between 3% and 7% of all short fragments , while only between 1% and  <dig> % of fragments are misclassified . in contrast, phylopythia was not able to predict any taxonomic class resulting in a sensitivity of 0% for all groups on these two ranks. overall, for short fragments tacoa is more sensitive at almost all taxonomic ranks, in particular at ranks order and genus. the only exception is at rank class, at which phylopythia is more sensitive for the classification of  <dig> bp fragments. at the same time, for the classification of short fragments tacoa has a slightly lower false negative rate for almost all taxonomic ranks. the only exceptions are rank phylum at which phylopythia has a lower false negative rate for  <dig> bp fragments. for the classification of contigs of length  <dig> kbp, tacoa achieved a sensitivity between 73% and 30% at ranks superkingdom to class, while phylopythia correctly classified between 82% and 47%. according to these results phylopythia was between 9% and 17% more sensitive than tacoa. but for the same contig length and ranks, tacoa is between 10% and 9% more specific than phylopythia. in addition, a high percentage of misclassifications was also observed for phylopythia  in contrast to that achieved by tacoa . at lower taxonomic ranks, tacoa achieved average sensitivity values between 17%  and 10%  for the classification of  <dig> kbp contigs, while phylopythia was not able to predict any taxonomic class for these long contigs, thus obtaining a sensitivity of 0% . although phylopythia was not able to make predictions for ranks order and genus, a marginal misclassification rate was observed  for a fragment length of  <dig> kbp. detailed sensitivity, specificity and false negative rate values for all taxonomic ranks and evaluated lengths are given in additional file  <dig>  additional file  <dig> and additional file  <dig> 

influence of horizontal gene transfer on the classification accuracy of an intrinsic-based classifier
the classification accuracy of methods using composition-based features might be influenced by a heterogeneous nucleotide composition present in the dna sequence of the analyzed genomic fragment. although differences in the nucleotide composition of dna sequences can be linked to a number of genomic attributes, including codon usage, dna base-stacking energy, dna structural conformation, strand asymmetry and even relic features of the primary genetic information, horizontal gene transfer events  is one of the most common cause  <cit> . the work of brown et al. also suggests that despite the rapid changes on the nucleotide composition of recent transferred dna chunks, the phylogenetic signal from the donor can still be detected if the hgt event is recent, rather than ancient  <cit> . since the importance of hgt events has been gaining increasing attention lately  <cit> , we investigated its influence in the accuracy of the intrinsic-based classifier tacoa.

one of the findings of this work is that tetranucleotides were best suited to analyzed genomic fragments ≤  <dig> kbp. but it has been reported that tetranucleotide frequencies are a good measure to detect horizontally transferred regions  <cit> . therefore, any classifier aiming to predict the taxonomic origin of genomic fragments based on a tetranucleotide feature is susceptible to "wrongly" classify to the donor taxonomic class a genomic fragment obtained via hgt. to explore the influence of hgt events in the classification accuracy of tacoa, we selected fragments of length  <dig> kbp from two genomes . several studies  <cit>  have reported acquisition of large stretches of dna via hgt events for thermoplasma acidophilum  and for thermotoga maritima .

in particular, the archaeal genome of thermoplasma acidophilum has been reported to acquire ≈12% of its genome via hgt. the main donors seem to belong to bacterial organisms, but also some archaeal species have been detected  <cit> . it has been suggested that t. acidophilum has received genes via hgt from sulfolobus solfataricus, a distantly related crenarchaeota living in the same ecological niche  <cit> . the sensitivity achieved by tacoa for t. acidophilum was 43% for reads  <dig> bp long and 51% for reads of length  <dig> kbp.

in order to evaluate the taxonomic distribution of misclassifications for t. acidophilum genomic fragments, we fragmented its genome in pieces of length  <dig> kbp and predicted their taxonomic origin. for the  <dig>  fragments analyzed, we found that 1%  were misclassified into the order sulfolobales, another 3%  into other members of the euryarchaeota group, 7%  to a variety of members from the bacterial group, and 38%  could not be classified . from the proportion of genomic fragments that were "erroneously" misclassified, the largest fraction  was placed into the sulfolobus group. the results of the taxonomic distribution of "misclassifications" made by tacoa for t. acidophilum are in close agreement to previous studies  <cit> . hence, the low number of correctly classified fragments obtained for t. acidophilum at rank genus may be partially explained by the lateral transfered dna from other species.

we also explored the bacterial genome of thermotoga maritima, which is another organism with a high number of candidate genes that have been presumably acquired from archaea via hgt  <cit> . a total of  <dig>  genomic fragments of length  <dig> kbp each were classified using tacoa and analyzed . a high number of misclassified genomic fragments were "wrongly" assigned to the archaeal group , a small fraction  was erroneously assigned to the sulfolobus group and 27%  could not be classified. conversely to t. acidophilum, the genome t. maritima seems to be recipient of dna originating mainly from archaeal species as suggested by other authors  <cit> . these two case studies strongly suggest that horizontally transfered stretches of dna can affect the classification accuracy of a classifier using compositional based features to infer the taxonomic origin of genomic fragments. a possible explanation for this observation is that the nucleotide composition of transferred dna chunks still carry phylogenetic signals from the donor genome after the hgt event has occurred as suggested by brown  <cit> .

discussion and 
CONCLUSIONS
our novel strategy named tacoa can accurately predict the taxonomic origin of genomic fragments from metagenomic data sets by combining the advantages of the k-nn approach with a smoothing kernel function. the reference set used by our proposed method can be easily updated by simply adding the genomic feature vectors  from the new genomes to the reference set without the need of retraining. our standalone tool tacoa can also be easily installed and run on a desktop computer, therefore allowing researchers to locally analyze their metagenomic sequence data or integrate it into their pipelines.

analogous to phylopythia, researchers can easily incorporate sample specific-models from particular organisms into the framework of tacoa. the use of sample-especific models can greatly support the identification of organisms of special interest. sample specific-models can be easily incorporated into the framework of tacoa by the researcher using the following approach: genomic fragments carrying phylogenetic marker genes  or fragments with high similarity to reference sequences of known origin  can be taxonomically annotated in a pre-processing step. subsequently, these annotated fragments can be added to the reference set of tacoa. this can be easily done with the "addreferencegenome" program provided by tacoa. the use of sample-specific models will improve the accuracy of the classifier for those species that have a reference sequence in public databases . in this work, we demonstrated that having the test set in the reference set can have a positive impact on the sensitivity and specificity of up to 30% and at the same time a decline on the false negative rate is observed .

as a whole, we evaluated the classification accuracy at five different taxonomic ranks: superkingdom, phylum, class, order, and genus. tacoa can correctly classify genomic fragments of length as short as  <dig> bp up to rank class. our proposed method can be used to predict the taxonomic origin of genomic fragments sequenced from any technology producing fragments ≥  <dig> bp. our strategy also produced reliable predictions for genomic fragments originating from taxonomic groups that are absent from the reference set . on average and over all taxonomic ranks, 77% of these fragments were correctly classified as "unknown".

tacoa compares well to the current most sophisticated taxonomic classifier for environmental fragments phylopyhtia. in terms of percentage of correctly classified fragments  tacoa slightly outperforms phylopythia for reads of length  <dig> bp and  <dig> kbp at all taxonomic ranks evaluated, except for reads  <dig> bp at rank class. but the very low false negative rate  and the high specificity  of tacoa makes the accuracy for reads of length  <dig> bp  comparable to that obtained by phylopythia. compared to tacoa, the overall reduced sensitivity obtained by phylopythia  is partially due to the absence of the phylum chloroflexi and thermatogae from its training set. this example illustrates the positive effect of an updated training or reference set in the prediction of known taxonomic classes.

for contigs of length  <dig> kbp, tacoa achieved lower sensitivity, lower false negative rate and higher specificity values than phylopyhtia. although phylopythia achieves higher sensitivity values for contigs of length  <dig> kbp the overall performance is comparable for both classifiers at ranks superkingdom, phylum and class.

at deeper taxonomic ranks , for all evaluated lengths tacoa was still able to provide correct classifications for several taxonomic classes  while phylopythia failed in making any taxonomic assignments . with an average sensitivity of 17%  and 10% , an average false negative rate of  <dig> %  and  <dig> % , tacoa can provide a more detailed view of the taxonomic composition of an environmental sample. notice that in practice it is not recommended to draw conclusions at such deep ranks for reads ≤  <dig> kbp because only a small number of fragments may be represented in the currently available sequenced genomes.

an interesting observation made during this work was that the classification of genomic fragments is possible using only gfvs computed from completely sequenced genomes rather than computing the vectors on fragments from genomes. similar observations have already been made by abe et al. in  <dig> and  <dig> and more recently by mchardy et al. in  <dig>  where the developed classifiers were trained with genomic fragments longer than the ones being tested. here we demonstrated that even complete genomes can be used as reference to classify environmental genomic dna fragments.

this study supports the findings that frequencies of short length oligonucleotides  are best suited to capture taxon-specific differences among prokaryotic genomes  <cit> . moreover, our parameter search analysis strongly suggests that tetra- or penta-oligonucleotide frequencies are optimal features for tacoa to classify environmental genomic fragments as short as  <dig> bp. this observation is in accordance to those reported by bohlin et al.  <cit>  who already proposed that little increase in information potential about phylogenetic relationships is gained in oligonucleotide sizes larger than hexa-nucleotides.

we showed that recent events of hgt can affect the accuracy of a composition-based classifier. the correct classification of horizontally transferred regions into its "current" taxon is difficult if these still carry a strong phylogenetic signal from the donor genome. this was illustrated by classifying fragments of length  <dig> kbp from the archaea t. acidophilum and the bacteria t. maritima. notably, hgt is not the only phenomena causing variations in the oligonucleotide frequencies within genomes and hence affecting the classification performance.

tacoa combines the ability of predicting the taxonomic origin of genomic fragments with high accuracy and the advantage of being a tool that can easily be installed and used on a desktop computer breaking any dependency and limitations that web server services may bring. altogether, it strongly suggests that tacoa offers a great potential to assist on the exploration of the taxonomic composition of metagenomic data sets.

