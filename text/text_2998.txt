BACKGROUND
in recent years, a number of techniques have emerged for large-scale gene expression analysis. most are designed to compare the expression of many genes between cell types or under a number of different conditions. however, there has also been interest in techniques capable of identifying the complete transcriptome of a given cell or tissue. 'closed' architecture systems, such as microarrays, are less suited to this application because they are limited by the extent to which global transcriptome coverage has been achieved. even in organisms such as homo sapiens where a complete genome sequence is now available, there remains uncertainty regarding the actual number of transcribed regions. this is true in the case of conventional genes and even more so if regions thought to yield polyadenylated non-coding rnas are included  <cit> . thus, at the present time, it would in principle be necessary to represent the whole genome on an array in order to test for all possible transcripts, which presents two major difficulties. first, there is the shear number of probes required to fully cover the human genome using tiling arrays:  <dig> , <dig> probes on  <dig> arrays were required even for non-overlapping coverage of non-repetitive regions in a study undertaken in  <dig>  <cit> . second, there are the technical difficulties associated with designing consistently good probes covering the whole genome . it may, therefore, be some time before all human genes can be confidently sampled in a conventional laboratory setting using such methodologies.

much use has therefore been made of 'open' gene-expression profiling methods requiring no a priori knowledge of the genes likely to be of interest  <cit> . many of these techniques are based on the sequencing of short tags created from pooled transcripts. until recently, tag-based expression profiling technologies had a key advantage over more traditional 'open' technologies such as expressed sequence tag  or cdna sequencing insofar as they efficiently and relatively inexpensively sample large numbers of transcripts. in sage, between  <dig> and  <dig> transcripts are sampled per sequencing reaction, compared to one est or a fraction of a cdna, whilst in mpss all tags in a library  are sequenced simultaneously. new sequencing techniques, such as lcm- <dig> technology  <cit> , may allow rapid sequencing of very large est libraries  <cit> , but these may lack the quantitative nature of tag-based techniques because production and capture of the ests are likely to be length and/or sequence dependent. these technologies could, however, be used to sequence extremely large sage libraries.

an additional advantage of 'open' technologies is that sensitivity can be improved to a great extent simply by increasing library size, allowing the identification of very weakly expressed transcripts. such transcripts may be expressed at levels much less than one copy per cell because they are only present at, e.g., very specific points in the cell cycle or in response to particular levels of cellular stress that only apply to subsets of the cell population. one caveat to this is that background noise in the data, e.g. due to contaminating species, degradation or mis-priming, may limit the maximum sensitivity that can be achieved . in contrast, for microarrays, sensitivity is limited by the inherent signal:noise ratio of the read-out technology itself, rather than only biological noise. best estimates of the sensitivity for cdna or long oligonucleotide arrays vary from  <dig> to  <dig> transcripts per million, whereas, using the same type of analysis, species present at an average count as low as  <dig> transcripts per million could be reliably identified as being differentially expressed in large-scale tag-sequencing experiments  <cit> . estimates of detection sensitivity for short oligonucleotide arrays have not been calculated in the same manner, but others have claimed the reliable detection of transcripts expressed as weakly as 6– <dig> per million using affymetrix genechips  <cit> . however, this sensitivity was somewhat dependent on comparisons to a 'mismatched control' oligonucleotide, the results of which were compromised by variable cross-reactivity with the mismatched oligonucleotide.

the disadvantage of sequencing very short tags is that it compromises identification of the transcripts corresponding to each tag. ideally, every tag would map uniquely to both the genome and the transcriptome, and every transcript would be represented by at least one tag. short sequence tag-based profiling was pioneered by velculescu et al. in the form of conventional sage  <cit> , which produces  <dig> bp tags from the 3'-most occurrence of an "anchoring" restriction site  in polyadenylated transcripts. this might be thought to be sufficient to map uniquely to the transcriptome  <cit> , but because transcript sequences are non-random, such tags are often too short to distinguish similar sequences. in addition, genomic mapping of the tags usually generates multiple hits, making the identification of novel genes extremely difficult.

other tag-based methodologies, especially those for gene identification and establishing transcriptional start points, have since been developed that generate longer tags from the 3' or 5' ends of transcripts, or both . until now, the most common techniques that have been used for tag-based global expression analysis are longsage  <cit>  and massively parallel signature sequencing   <cit> . little, if any, data has been generated or made available in the public databases with the newer sequencing technologies, such as lcm- <dig>  which would in principle allow rapid production of extremely large est and sage libraries  <cit>  or solexa's sbs technology  <cit> , which has been adapted to tag-based expression profiling  <cit> .

longsage is a modification of the standard sage protocol using a different type ii restriction enzyme  to generate a  <dig> bp tag at the anchor site . mpss generated  <dig> bp tags anchored at the 3'-most dpnii sites in transcripts, in a similar manner to sage. the unique feature of mpss was the proprietary, bead-based sequencing technology, which was more efficient than standard sanger sequencing and yielded far larger tag counts. as both methods significantly increase tag length compared to conventional sage, they were expected to improve the prospects for unique genome and transcriptome tag mapping, as suggested by the pilot-scale use of longsage for genome annotation  <cit> . as a proprietary technology that the parent company has ceased to offer, new mpss libraries can no longer be generated. nevertheless, large amounts of mpss data are still being made available .

although the ability of the mpss and longsage methods to identify abundant or differentially expressed genes has been compared, their capacity to provide complete transcriptome coverage has not. the number of transcripts expressed in a single cell can vary considerably depending on cell type, among other factors, but it has been estimated that a 'typical' human somatic cell contains ~ <dig>  mrna molecules  <cit> . given that a particular transcript species could be present at less than one copy per cell, i.e. less than two tags per million , full transcriptome coverage using tag-based methods can only be guaranteed if libraries containing several times this many tags are fully sequenced. due to the efficiency of mpss sequencing, it became feasible to sequence well in excess of  <dig> million tags per sample at a fraction of the cost of sequencing a similar number of longsage tags. it has seemed, therefore, that mpss was the technology most likely to offer the depth of sampling required for whole transcriptome coverage, but this has not been adequately tested.

we previously analysed a cd8+ t-cell clone using conventional sage  <cit>  and found that a library of only  <dig>  tags contained sequences corresponding to most, if not all, the transcripts encoding the surface molecules from that cell. however, some of these tags were found only once in the library and it is likely that transcripts from many other functional classes were not sampled at all. similar-sized libraries have been generated from other leukocyte populations  <cit> , and extensive microarray analysis has identified large numbers of transcripts differentially expressed among leukocyte subsets  <cit> . herein, we compare the ability of sage and mpss data to provide, as far as is currently feasible, access to the entire transcriptome of a t cell.

RESULTS
systematic limitations
before undertaking a direct comparison of the two transcriptome-profiling methods, we consider the systematic limitations of the methods, as previously done in a generalised way  <cit> . first, for a restriction site-based tagging method to detect a given transcript, the transcript must contain that site. using nlaiii  or dpnii , which each have four-base recognition sites, the recognition site ought to be present, on average, every  <dig> base pairs. however, some transcripts will not have these sites and both sage and mpss are expected to be similarly affected. there are  <dig> , <dig> and  <dig>  nlaiii sites in the human genome and in all the human sequences in release  <dig> of the refseq database  <cit> , respectively. the numbers for dpnii sites are  <dig> , <dig> and  <dig> , so this site is rarer, suggesting that the ability of mpss to tag more transcripts is in this way compromised. in refseq, excluding predicted transcripts from the genome, the proportion of cdnas lacking the longsage recognition site is less than  <dig> %  whereas the proportion lacking the mpss site is substantially higher, at ~ <dig> % . in terms of the total pool of transcripts, these numbers are relatively small, but cannot be overlooked if the entire transcriptome of a cell is to be identified. a better strategy would involve a combination of sites: only  <dig> of the  <dig>  human sequences in refseq release  <dig> lack both nlaiii and dpnii recognition sites.

a second limitation of tag-based methods is the difficulty of matching each tag to a unique transcript. the single most important benefit of open expression technologies is their ability to identify previously uncharacterised genes, which requires that novel tags can be linked to sequenced transcripts or, if they have not been previously identified, to the genome. analysis of nlaiii and dpnii sites in the human genome demonstrates the effect of tag length on transcript identification . the vast majority  of all potential longsage and mpss tags are unique in the genome and transcriptome, compared with only 9% of potential conventional  sage tags, indicating that these technologies significantly reduce the problem of unique transcript identification. these results reinforce and extend the results of unneberg et al.  <cit> , obtained before longsage was in use, which suggested that tags of at least  <dig> bp would be needed to find unique matches among human unigene clusters. nevertheless, the identification of novel genes using longsage and mpss tags is not straightforward, because apparently novel tags may arise via sequencing errors or genetic polymorphisms. the combination of longsage and mpss data should provide a powerful approach for identifying new transcriptional loci, since regions of the genome that are not known to code for any genes, but which contain matches to tags derived by both methods, would be highly likely to encode novel transcripts.

library production
longsage and mpss libraries were prepared from a single sample of rna extracted from a cd4+ t-cell clone  activated with beads coated in anti-cd <dig> and anti-cd <dig> antibodies. clone  <dig> was derived from the peripheral blood mononuclear cells of a subject given a modified vaccinia virus ankara  vaccine containing a polyprotein made from hiv- <dig> gag fused to a string of cytotoxic t-cell epitopes as part of a vaccine trial  <cit> . it was established in culture with il- <dig> and the overlapping hiv- <dig> gag peptides, krwiilglnkivrmy and geiykrwiilglnki, but was shown to respond specifically to the former peptide. the likely clonality of the population was confirmed by analysis of tcr vβ chain usage, which showed exclusive expression of vβ <dig> . a single library of  <dig>  longsage tags, and  <dig> libraries containing a total of  <dig> , <dig> mpss tags, were sequenced.

facs analysis indicated that, prior to library generation, the activated t-cell clone expressed cd <dig>  cd <dig>  cd <dig> and cd <dig>  but not cd <dig> or cd62l . the longsage data perfectly matched the facs results and revealed the expression of each of the classical t-cell markers, i.e. all tcr/cd <dig> components, cd <dig>  cd <dig>  cd <dig>  cd <dig>  cd11a , cd <dig>  cd <dig> and cd <dig>  the mpss library, however, lacked tags corresponding to both cd3γ and cd <dig>  the longsage cd <dig> transcript tag derived from the 3' untranslated region , upstream of the only dpnii site in the full length cdna. between the nlaiii site and the dpnii site there is a potential polyadenylation signal, suggesting that alternative polyadenylation could be responsible for the absence of a cd <dig> mpss tag. even though cd3γ is the most weakly expressed transcript of those tested here, the lack of any mpss tags derived from transcripts of cd3γ is very surprising, given the supposedly increased depth of the mpss libraries compared to sage. taken in isolation, this finding could have implied that there is an additional region of the cd3γ 3' utr containing a potential mpss tag that is not recorded in the main dna sequence databases. however, in a second mpss library made from the same mrna sample the cd3γ tag was represented at  <dig>  tags per million. thus, the tag is produced and, given its expression level, should be found in every library of this size provided that every transcript is equally likely to be sampled. this provided the first indication of mpss sampling problems, despite the size of mpss libraries.

analysis of known genes
ideally, the level of expression of every distinct transcript identified by the two methods would be compared. however, ambiguities in tag to gene mapping and differences in tag anchoring sites mean that different populations of potential tags will be sampled in each case, making such comparisons non-trivial. therefore, a set of test transcripts that contain both nlaiii and dpnii sites, and for which the potential tags at all such sites are unique in both the human genome and the ensembl transcriptome, was extracted from ensembl  <cit> . this set was called utbs  and consisted of  <dig>  transcripts. the spearman correlation coefficient for expression of utbs transcripts in the two libraries was  <dig> . as expected, this correlation is significantly higher than that obtained for comparisons of the mpss library with other, i.e. non-cd4+ t cell-derived longsage libraries; for example comparison with an activated cd8+ t cell-derived longsage library  yielded a correlation of  <dig> . importantly, however, the correlation between libraries produced from the one rna sample using the two methods was far lower than that for longsage libraries produced from distinct cell populations. the coefficient obtained for a comparison of our activated cd4+ t-cell longsage library with the activated cd8+ t-cell library referred to above, for example, is  <dig>  and when our library is compared to a second longsage library of similar size generated from the same cells in the "resting" state, i.e. prior to activation with anti-cd <dig> and anti-cd <dig> antibody coated beads , the correlation coefficient is  <dig> .

given that both methods are believed to be generally reproducible  <cit> , the larger-than-expected differences between the longsage and mpss libraries generated from the same rna sample is suggestive of a systematic bias intrinsic to one or other of the methods. to identify the source of this bias, and to establish which of the methods is the more reliable, the libraries were compared at the levels of sampling depth and breadth.

depth of sampling
the rate of addition of novel tag sequences to the library provides a measure of whether a given library is large enough to identify every potential tag sequence in the initial sample, since, when all existing tags have been sequenced, this rate should approach zero. as expected, given their relative sizes, this appears to be the case for the mpss but not the longsage library. however, the rate of novel tag addition is likely to be artificially increased in the longsage library due to sequencing error accumulation  <cit> ; mpss has been reported to have much lower error rates than longsage, i.e. ~ <dig> %  <cit>  versus ~ <dig> % per base  <cit> . a simple filter was used to remove tag sequences generated by errors: i.e. only tags that matched either the genome or the known transcriptome were kept. some genuine tags carrying polymorphisms unrepresented in the databases, or for which no cdna sequence is available and a splice junction or polyadenylation occurs within the tag, are likely to be removed. however, as these are comparatively rare events, this is not expected to have a large effect on library complexity  <cit> . removal of the error-derived tags dramatically reduces the rate of novel tag addition in the longsage library , although it is still not asymptotic. the abundances of tags corresponding to utbs transcripts were used to examine the effect of library size on the sampling of known genes . it is clear from this that the mpss library has sampled virtually all utbs transcripts present, and that the rate of transcript discovery by longsage falls to a very low level, suggesting that the longsage library is probably large enough to identify most known transcripts within the transcriptome of this cell.

the analysis using all tags matching the genome  versus that based on the utbs transcript set  provide different answers to the question of how many tags need to be sequenced in order to sample the entire transcriptome. both methods suggest that the mpss library is large enough to sample all the readable sequence species present on the microbeads . on the other hand, while the all-tag analysis suggests that a longsage library needs to be substantially larger than  <dig>  tags to sample all transcripts in the cdna pool, the analysis of known genes does not. this difference is not surprising because known genes are likely, on average, to be expressed at a higher level than novel transcripts, aiding their initial identification  <cit> . however, it is also possible that many longsage tags are derived from unconventional, i.e. non-protein encoding, transcriptional units absent from gene databases. in this case, larger sage libraries would be required to identify a full set of such unconventional transcripts.

breadth of sampling
great sampling depth is only of value if the open expression technology identifies transcripts irrespective of their sequence. there is a large discrepancy in the number of different sequences identified by the two methods. at the same sampling depth  there are many more distinct tag sequences in the longsage library than in the mpss library . allowing for differences in sequencing error rate by considering only tags that match the human genome, longsage identifies  <dig> -fold more unique tag sequences than mpss . even using the entire mpss library, which is  <dig> times the size of the sage library, mpss identifies  <dig> -fold fewer tags than sage. although up to half of this difference may be accounted for by the lower number of dpnii sites in the genome, a ~3-fold reduction in number of distinct species identified by a method intended to analyse samples to a greater depth is unexpected. this large difference suggests either that the longsage library contains many spurious tags randomly matching genomic sequences or that the mpss library lacks many genuine tags, despite the sequencing of tags from every captured transcript.

a simple explanation for the greater complexity of the longsage library is that sage samples more tags per transcript than mpss. it is not possible to directly convert the number of tag sequences found in a library to the number of genes being profiled, for two reasons. first, most genes will have multiple tags owing to polymorphisms, alternative polyadenylation, internal polyadenosine stretches, antisense expression and incomplete cleavage by the restriction enzymes. second, in some cases, especially within gene families, multiple genes will share the same tag sequence. it should be possible, however, to make a rough estimate of the number of transcriptional loci identified by examining the number of 'tag clusters' found in the genome. as we wanted to compare the two methods rather than identify specific genes or determine an exact gene number, a very simple set of criteria was used to define a tag cluster. briefly, all the tags matching the genome only once were sorted by chromosome position. each tag match was analysed in turn and was considered to be part of a new transcriptional locus if it was greater than x bases from the nearest previous tag match on the chromosome or more than y bases from the first tag match in the previous transcriptional locus. various values were used for x and y, but regardless of the exact value used, the longsage library identified  <dig> – <dig>  fold more clusters, and therefore presumably loci, than the mpss library . for example, if x is  <dig> kb, longsage identifies ~ <dig>  loci and mpss identifies ~ <dig>  loci regardless of the value of y, once the data have been corrected for tags that had to be excluded from the analysis because they matched multiple loci. thus, the difference in the number of tag species identified by the two methods probably does reflect a real difference in the number of expressed genes sampled, rather than a trivial difference in the number of potential tags sampled per transcript.

examination of a set of known transcripts should help determine whether these differences are due to erroneous longsage tags or to the absence of genuine tags from the mpss library. analysis of the tags matching the utbs transcript set yielded the same trend as the analysis of all tags, with the longsage library identifying almost twice as many utbs transcripts as the mpss library . this data can be extrapolated to estimate the number of genes sampled in each library: since  <dig> % of all the tag sequences in the mpss library represented  <dig>  known transcripts and  <dig> % of the longsage tag sequences represented  <dig>  transcripts, it can be estimated that ~ <dig>  transcripts are sampled in the complete mpss library and ~ <dig>  in the entire longsage library. these numbers are expected to be underestimates given that known transcripts are likely to be expressed at a higher level than uncharacterized transcripts. however, these numbers are much higher than those obtained when estimating the numbers of transcriptional loci even using a maximum distance between tags  of just  <dig> kb . the likely explanation for this is that sequencing errors are artificially increasing the number of apparently unique tags in the libraries. using matches to the genome to define genuine tags, extrapolation from the number of utbs transcripts found suggests that sage identified a total of ~ <dig>  transcripts and mpss ~ <dig>  transcripts, in good agreement with the estimates of loci number allowing  <dig> – <dig>  bases between tags defining each locus .

however, the data is analyzed, mpss seems to underestimate transcriptome complexity. in this context, it is revealing to examine the expression level of the different classes of transcripts in the utbs dataset. the average representation level for all longsage tags corresponding to each sense transcript in this set  is  <dig> tags per million , whereas for transcripts identified by both methods the average total sage tag count for a transcript is  <dig> tpm  and for those identified by longsage only, it is  <dig> tpm . this suggests that mpss fails to detect weakly expressed transcripts. since this is not what is expected of a method capable of sampling many more tags than sage, it implies that there are systematic biases in mpss sequencing, or in library production, or both.

a trivial explanation for these results is that there is dna contamination of the longsage library but not the mpss library. it is of course very difficult to prove that there has been no contamination of a library when deep transcriptome analysis of the given cell has not been undertaken previously. clearly, every care was taken to ensure that there was no contamination of the libraries at any stage. however, if the sage library was contaminated after the initial rna sample was divided, there are three possible sources of contaminating dna that could explain our results : human genomic dna, dna from other human transcripts or ditags from previously generated human sage libraries. the only longsage library previously produced in our laboratory was derived from anti-cd <dig> antibody-treated cd8+ t-cells . in this library, there are very high tag counts for tags derived from transcripts encoding cd <dig>  and several other molecules that are completely absent from the cd4+ t cell-derived sage library. similarly, tags that are extremely abundant in both the activated cd8+ t cell-derived library and our activated cd4+ t cell-derived library are completely absent in another large resting cd4+ t cell-derived library , e.g. ccl4l <dig> at  <dig> tpm,  <dig> tpm and  <dig> tpm, respectively. thus, library cross-contamination seems unlikely. in addition, the new libraries did not contain any tags derived from transcripts encoding markers of cells that are likely sources of cdna contamination in our laboratory, e.g. b cells , myeloid cells  or keratinocytes . finally, in the case of genomic dna contamination, the abundance of contaminating tags would be expected to correlate directly with the number of copies of that sequence found in the human genome. however, the abundance distributions for sage tags from utbs transcripts detected by sage only is equivalent to that of all the tags matching utbs transcripts detected by sage as well as those detected by sage and by mpss . thus, there do not appear to be any differences in the distribution of tags detected only by sage that can be attributed to genomic contamination.

analysis of mpss bias
in order to try to identify the nature of mpss bias, we analysed additional mpss libraries and examined the complexities of one library at different stages of sequencing. two more mpss 'bead libraries' were produced from the same cdna sample used in the production of the library considered up to this point. since analysis of the first bead library revealed substantial sequence redundancy, i.e. virtually no new sequences were added as the library size increased , we expected the tag composition of additional bead libraries to be essentially identical. instead, addition of tags from the new libraries causes dramatic increases in the number of different species . each library has similar numbers of distinct tag sequences , but the majority  of these are only found in one of the three libraries, even after excluding tags that do not match the genome . the tags found in any one library are present at much lower levels than those found in all three libraries . this suggests that random sampling during mpss library preparation has a large effect on the resulting 'bead library', profoundly reducing its complexity. since only  <dig>  transcripts are identified in the utbs dataset when the three mpss libraries are combined , versus the  <dig>  identified by longsage, more than three mpss libraries would be required for comprehensive transcriptome analysis using mpss.

the raw mpss data was provided in three forms, extracted at different stages of sequencing: i.e. after the sequencing of tags of  <dig> bp,  <dig> bp and  <dig> bp. a comparison of the alternate tag extractions from the first bead library  suggests that sequencing length has an effect on the complexity of the library: the longer the tag sequence, the smaller the number of unique tags that are sequenced . the  <dig> bp library was ~24% more complex than the  <dig> bp library, contrary to expectation: a  <dig> bp library generated in silico from the  <dig> bp data is ~16% less complex than the  <dig> bp tag library. it is possible that the additional  <dig> bp tag sequences that are absent from the libraries of longer tags are 'bad sequencing reads' that are filtered out in the last rounds of sequencing. if this were the case, the  <dig> bp library should constitute an improvement on the libraries of shorter tags, and a larger proportion of the long tags ought to match the genome sequence. instead, we found the opposite: as tag length increased, a smaller proportion of tags matched the genome . there are two explanations for the apparent drop in 'sequence quality' as tag length increases. first, as tag length increases, the chance that an error, polymorphism or splice junction may occur within the sequence also increases. second, shorter tags are more likely to match the genome due to chance even if they contain an error . the loss of library complexity during successive sequencing cycles can only exacerbate the much larger loss of complexity resulting from sampling error at the stage of bead library construction revealed by our comparison of multiple mpss libraries.

mpss tags can be extracted from the same initial dataset to produce tags of different lengths; in this case  <dig>   <dig> and  <dig> bp tags were extracted. after the extractions, tag lengths can be computationally shortened to see if there is a difference in complexity between the different tag extractions. decreasing the tag length sequenced was, unexpectedly, found to increase the complexity of the library. for example,  <dig>  different  <dig> base tags were produced, which contained  <dig>  different  <dig> base sequences if the last  <dig> bases were ignored. however, if the tags were initially extracted at  <dig> bases  then a library of  <dig>  different tag sequences was produced;  <dig>  distinct species are therefore lost in this last sequencing step. the last column shows how many of the distinct tag species have perfect matches in the human genome, and this is also expressed as the proportion of the species identified .

identification of potential novel transcriptional loci
the deep sampling by longsage and to a smaller degree by mpss means that tags can be matched to genomic regions where transcripts have not previously been identified or predicted by ensembl . however, many of these matches are unlikely to correspond to actual transcriptional loci, as tags may match more than one genomic site or may represent sequencing errors arising fortuitously from more abundant tags that match the genome elsewhere. on the other hand, it is likely that loci identified by both methods will represent genuine regions of transcription. to investigate the likely numbers of new transcriptional loci identifiable using this approach, strict criteria were used to identify regions where transcription was detected by both methods. tags were required to match the genome only once, at a position where no known ensembl genes are annotated within  <dig> bases in the sense or antisense direction. of all the tags, only  <dig>   <dig> unique longsage tags and  <dig> mpss tags satisfied these criteria . the genomic matches to the tags in both lists were then examined in order to ascertain whether they could be part of the same gene. if a longsage tag matched the genome within  <dig>  bases of, and on the same strand as, an mpss tag, this pair of tags was considered to define a potentially new transcriptional locus. this procedure identified only  <dig> tag pairs, none of which occur within  <dig>  bases of predicted genes in ensembl release  <dig> . these loci therefore represent possible transcriptional loci for which no clear evidence has previously been obtained. the pairs of tags are listed in additional file  <dig>  interestingly, the average abundance of mpss tags that match the genome once and have some form of gene annotation is  <dig>  tpm but for those in this novel gene list, it is  <dig>  tpm. this confirms that novel genes tend to be expressed at a lower level than those already discovered. it is also interesting to note that roughly half these tag pairs  are found in genomic regions masked in ensembl, which are more difficult to analyse by other methods owing to the presence of repetitive elements. identifying the transcripts corresponding to all these novel loci should be relatively simple using both tags as primers for direct pcr or nested 5' rapid amplification of cdna ends   <cit> . overall, however, our observations suggest that relatively few bona fide new transcriptional loci remain to be discovered.

discussion
we have described the production of large longsage and mpss libraries from a single rna sample and consider their usefulness for identifying the complete transcriptome of a clonal population of cells, including transcripts not expressed in all cells and hence present on average at less than one copy per cell. the two methods give very different estimates of the number of genes expressed by a single cell. both by counting the number of genomic loci represented or by extrapolation from the number of known genes found, the sage tags sequenced are estimated to represent  <dig> – <dig>  transcripts, whereas the mpss tags represent  <dig> – <dig>  transcripts. the total number of genes in the human genome is still being debated, but the current consensus places it under  <dig>  protein encoding genes  <cit>  . estimates of the number of different transcripts expressed in a single cell vary widely. early studies on mouse brain suggested that there are between ~ <dig>   <cit>  and ~ <dig>   <cit>  transcript species per cell. however, gene expression is a stochastic process  <cit> , so it might be expected that, if a pure population of cells could be sampled deeply enough, transcription from every gene would be detected.

the main conclusion of our work is that although mpss yields large amounts of expression data very rapidly, sampling problems severely limit transcriptome coverage and bias library complexity towards genes transcribed at higher levels. our analysis suggests that, despite the very significant problem of sequencing errors in large sage libraries, until large amounts of data from new techniques such as sbs  <cit>  become available, longsage will remain the best source of available data for the deep mining of cellular transcriptomes. in organisms for which the complete genome sequence is available, most sequencing errors can be removed by excluding tags that fail to match either the genome or any known transcript. this is likely to remove a few genuine tags because databases of expressed sequences are not complete and splicing, polyadenylation and sequence polymorphisms mean that expressed sequence is not always identical to genomic sequence. however, because most transcripts contain more than one sage tag, very few expressed genes will remain unidentified. other methods for removing sequencing errors from sage libraries are mostly based on identifying tags in the library related by simple mutations . in our hands, these methods removed several genuine transcripts of interest without removing as large a proportion of the tag sequences as the genome-based approach . for organisms for which complete genome sequences are unavailable, only these methods would allow meaningful lists of tags representing truly novel transcripts to be compiled.

we are uncertain about the source of the reduced complexity of the mpss data. it seems clear that a lack of sampling due to insufficient sequencing is not the major problem. for each bead library virtually all the distinct sequences are sampled after sequencing fewer tags than are obtained in an average library produced using the standard protocol. from our comparison of three mpss libraries prepared from the same rna sample, it would appear that the largest amount of complexity is lost at the stage of bead library preparation. each library samples a small fraction of the transcriptome and, even in combination, the three mpss libraries fail to identify as many known genes as an >8-fold smaller longsage library, let alone as many different transcript species overall. at present it is not obvious whether it is the production of tags from cdna or tag to bead ligation that is most responsible for reducing library complexity prior to bead loading and sequencing.

it should be noted, however, that some transcripts are lost in the course of sequencing, as demonstrated by the loss of library complexity in terms of the number of species identified as tag sequences are extended from  <dig> to  <dig> to  <dig> bp. we are not the first to identify such effects. mpss sequencing proceeds in four-base steps yielding four-base "words" and it has been noted by meyers et al. that mpss has problems with palindromic words   <cit> , leading to bias against detection of these sequences. however, meyers et al.  <cit>  estimated that only ~8% of sequences would be affected by this source of bias and in our libraries this effect will have been suppressed by sequencing in two staggered phases, since this increases the number of tags that do not contain  <dig> base palindromes in at least one of the phases. the extent of the palindrome effect is therefore not enough to explain the large decrease in library complexity we observe when comparing the  <dig>   <dig> and  <dig> bp extractions of the sequencing data. either the palindrome-dependent effect is larger than expected or there is some additional, currently unidentified, systematic bias in mpss sequencing.

a potential source of bias in classical mpss data is that the cdna species immobilised on the beads following dpnii cleavage vary significantly in length . the effect of tag-position within the cdna on the observed abundance of mpss tags has been analysed by chen and rattray  <cit>  who found that this was a significant source of bias for both "classical" and "signature" mpss, although it was more serious for classical mpss. signature mpss is a refinement of the method wherein cdnas are cleaved with mmei after cleavage with dpnii and ligation of a linker so that the same length of sequence, i.e., the tag, is immobilised on the beads in each case. this approach is analogous to the sage process, which ensures that all ditags amplify uniformly. tag-position bias is likely to affect the observed abundance of many tags in our libraries. however, if the library is sequenced to completion, as our data suggests , all different tag sequences on the beads should have been sampled even if the frequency of sampling does not correlate with abundance. it is possible that there is a maximum length of cdna species beyond which tags are never  observed, but this has not been demonstrated and is unlikely to account for the level of inter-library variation we observed.

analysis of the gc content of observed sage and mpss tags, compared to that expected by random sampling of tags from known genes  <cit> , also pointed to bias in mpss but not sage tag identification. longsagelite  <cit> , which has an additional amplification step, may introduce bias, however. several signature mpss libraries analysed by siddiqui et al.  <cit>  were found to be biased towards gc-rich tags. in contrast, the few classical mpss libraries that were analysed seemed to have a small bias towards at rich tags. using a similar approach to chen et al., we find that the gc content of both our sage and mpss libraries is higher than that seen in random sampling by ~ <dig> standard deviations and ~ <dig> standard deviations, respectively. these deviations are larger than those observed by siddiqui et al.  <cit> , which may reflect differences in the details of the sampling procedure or the refseq pool used. the difference we see between the two methods is consistent with their data for signature mpss libraries and longsage libraries, i.e. that the mpss method appears to be significantly biased in favour of gc rich tags. it remains unclear whether this accounts for the complete absence of large numbers of at rich tags from an mpss bead library, but it at least partly explains the loss of complexity at the sequencing stage.

CONCLUSIONS
our results suggest that mpss data ought to be used cautiously. although conventionally sequenced sage datasets therefore constitute the only reliable sources of quantitative digital gene expression data at present, this situation is almost certainly set to change. new dna sequencing technologies, based on polony sequencing  <cit> , are likely to provide additional, very large datasets. these methods will reduce both the cost and the time taken to generate large sage and est libraries, making these methods even more accessible. it is unlikely that the use of new sequencing technologies per se would introduce unforeseen biases into expression libraries, but our findings suggest that researchers will need to verify this. sbs has been adapted by solexa, who also own the now redundant mpss technology, as an alternative method for the parallel production and sequencing of signature sequences  <cit> . this technique is quite different from mpss, in that it does not use beads, does not have the 4-base sequencing cycles, and will be available as an instrument rather than a "black box" service. however, when sbs signature expression libraries become available it will be necessary to exclude the unexpected, and largely unexplained, lack of complexity we have encountered in mpss libraries.

