BACKGROUND
the application of rna-seq for in-depth transcriptomics analyses is hindered by the vast excess of certain rnas leading to insufficient coverage of transcripts of interest. such problematic sequences can be rrna , rnas from particular species  or canonical transcript sequences . a particular challenge for experiments involving targeted isolation of complex-associated rna, such as in ribosome profiling  <cit> , clip-seq  <cit> , or modified base cleavage studies is that the rna must be partially fragmented, which releases a plethora of rrna digestion products. this impedes interpretation of the results; for example in clip-seq, an input sample digested in parallel should be sequenced as a control to facilitate peak-calling from the sequence data  <cit> , however this is rarely done in practice due to the high content of degraded rrna in these controls.

popular methods to deplete unwanted sequences involve hybridizing the rna with biotinylated lna probes  or hybridizing the single-stranded cdna library to biotinylated dna probes  <cit> , and depleting the bound targets using immobilized streptavidin. however, these probes are usually purchased as ready-made sets targeted at rrna in a limited range of source species, precluding customization. the costs of obtaining custom modified probes to, for instance, target all rrna fragments in degraded  or digested samples  are prohibitive. targeting rrna with unmodified antisense dna oligonucleotides and digestion with rnase h can yield efficient depletion without introducing gross bias into the transcriptome  <cit> . this approach, however, requires saturation of rrna with contiguous oligonucleotides. further, due to the high thermal stability of rna:dna hybrids  <cit>  and the short duplex length  targeted by rnase h, there is no guarantee that the resulting fragment ends will all be faithful representations of the input fragment ends in nucleotide-resolution studies .

a strategy to deplete high-abundance sequences from dsdna libraries is c0t-hybridization  <cit> , which involves heat-denaturing followed by re-annealing. high-abundance sequences, which preferentially re-anneal, are removed using duplex-specific nuclease   <cit>  or hydroxyapatite chromatography  <cit> . this procedure has not been widely adopted due to the difficulty of fine-tuning the extended hybridization reaction. application of c0t-hybridization to deep sequencing libraries is further severely limited by the potential of the ubiquitous linker/adapter sequences to be inadvertently targeted. notably, dsn treatment in conjunction with targeted dna oligonucleotide probes has been used to deplete abundant mrna sequences in conventional, full-length cdna libraries  <cit> .

here we outline probe-directed degradation , a dsn/probe hybridization-based method for depletion of unwanted cdna sequences from rna-seq libraries. targeting saccharomyces cerevisiae rrna we achieved efficient depletion across multiple pdd-targeted loci without introducing bias among mrna-derived sequences. we present probe design guidelines and a bioinformatics tool that evaluates the efficacy of candidate probe sets. we also describe some streamlining modifications to the split adapter library preparation strategy. overall, we find pdd to be rapid and specific, while also being quickly and cheaply customizable to diverse species or applications.

methods
probe design
probes were initially designed manually to target rrna sequences that form the major contaminants in ribosome profiling libraries . to enable in silico analysis of these probes for possible hybridization with other transcripts, we constructed a perl script to identify matches of >10 nt in the transcribed portion of any annotated genome , estimating the tm of each target and off-target match by the method of allawi et al. <cit>  as implemented in the bioperl primer module. here we used the reference genome for s. cerevisiae s288c, assembly r64-1- <dig> . probe sequences  were refined in several iterations to maximize the tm differential between desired and undesired targets. they were then ordered in plate format from integrated dna technologies and individually resuspended at 200 μm.

library preparation
a “degraded” rna sample  was generated by incubating 1 au <dig> of s. cerevisiae cytoplasmic lysate with  <dig> u of rnase  <dig> for 30 minutes at room temperature. a “total” rna library  was generated by mg+2-mediated cleavage of intact rna for 8 minutes at 94°c using the nebnext mg+ <dig> rna fragmentation module . a “ribominus™ spike-in” library  with total rna in a 1: <dig> ratio and fragmenting for 6 minutes at 94°c. in both cases, libraries were generated by the split adapter method as described  <cit>  with modifications .

library preparation was performed as follows. after ethanol precipitation and resuspension in t10e <dig> ,  approximately 500 ng of fragmented rna was end-repaired by  <dig> u of t <dig> polynucleotide kinase  in 20 μl of 1× pnk buffer  for 2 hours at 37°c in the presence of 1 u/μl of rnaseout inhibitor . t <dig> pnk was then heat-inactivated at 65°c for 10 minutes and the resultant rna was 3′ polyadenylated using the ambion poly-tailing kit as follows. the pnk reaction was added to a master mix to give a final 50 μl reaction containing of  <dig>  mm ratp,  <dig>  mm mncl <dig>  1× reaction buffer,  <dig>  u of e. coli poly polymerase and supplemented with fresh rnaseout rnase inhibitor . the polyadenylation reaction was allowed to proceed for 1 hour at 37°c. pyrophosphate precipitate was pelleted by brief centrifugation and the rna in the supernatant was ethanol-precipitated in a new tube. rna pellets were resuspended in 15 μl of 1 mm sodium citrate buffer, ph  <dig> . after polyadenylation, a <dig> readings were no longer useful for quantifying rna.

half of the resuspended rna  was reverse transcribed using the superscript® iii first-strand synthesis kit  according to the manufacturer’s instructions with some variations as follows. 20 pmol of split adapter/oligo dt primer  were mixed with the template rna and dntps in 13 μl and heated to 70°c for 3 minutes in a thermocycler, cooled to 60°c then slow-ramped to 55°c over 2 minutes to anneal primer. a preheated 7 μl reverse transcription master mix aliquot  was added, the mixture was slow-ramped to 50°c and incubated for a further 30 minutes. the reverse transcription reaction was heated to 60°c for 5 minutes, then cooled to 37°c, and 1 μl of 20 u/μl exoi  was immediately added, followed by a further 20 minute incubation to allow depletion of the unextended single-stranded primer. meanwhile, ampure xp beads  from 20 μl of initial manufacturer’s suspension were washed and resuspended in  <dig> × reaction volumes  of 1× pn buffer . exoi was inactivated by adding 1 μl 250 mm edta, and both the reaction mixture  and the beads suspension  were preheated in a 60°c oven before rapidly mixing and returning to the oven for 5 minutes. beads were collected on a magnetic rack for 1 minute in the oven, the rack was transferred to room temperature and the supernatant was immediately removed and replaced with room-temperature  <dig> × pn buffer while keeping the reaction tubes on the magnet. after two ~30 second washes in 70% ethanol on the magnet at room temperature, beads were dried ~2 minutes and cdna was eluted in  <dig>  μl t10e <dig>  buffer. the purpose of the elevated temperature during bead binding was to prevent non-specific primer annealing and carryover, while still leaving cdna:rna duplexes intact to take advantage of the large length differential between the polyadenylated rna and the primer for size-based selection on ampure xp beads. we have not tested room-temperature separation conditions.

cdna circularization
purified cdna:rna duplexes from the previous step were denatured at 80°c for 15 minutes and the rna degraded by adding  <dig>  μg of rnase a and incubating at 37°c for 20 minutes. an aliquot  was circularised with 75 u of circligase™ ii  in a 20 μl self-ligation reaction containing 1× manufacturer’s reaction buffer supplemented with  <dig>  mm mncl <dig> and  <dig>  m betaine for 2– <dig> hours at 60°c. upon completion of the circularisation reaction, edta was added to  <dig>  mm and the ligase was heat-inactivated at 80°c for 15 minutes. the amount of cdna product in the reaction was that derived from approximately 112 ng of starting rna . circular cdna was then purified using ampure xp beads  and the resultant bound cdna library was eluted from the beads in 10 μl t10e <dig>  buffer.

dd treatment
half of the circularised library  was mixed with 2 μl of  <dig> × dsn buffer  with depletion probes  so that each probe was approximately equimolar with the library assuming 100% conversion of rna to cdna. the 7 μl mix was overlayed with mineral oil and denatured on a thermocycler at 95°c for 1 minute, brought to 75°c and then slowly cooled  to 48°c. after a 5 minute hybridization at 48°c, 3 μl of pre-warmed dsn master mix containing  <dig>  u dsn  in 1× dsn buffer was added and incubated for 20 minutes. the reaction was stopped by the addition of 6 μl of 25 mm edta and incubated for another 5 minutes, then phenol:chloroform extracted and the dna was purified using ampure xp beads  and the libraries eluted in 10 μl t10e <dig>  each. the remaining half of the circularised library was left untreated as a control.

library amplification and size-selection
the libraries were amplified by pcr using indexed primers, corresponding to those used in the illumina’s truseq small rna sample prep kit. one third of each of the pdd-treated and untreated library samples from the previous step were added as templates to pcr mixtures , dntps, primers, and extreme thermophilic single-stranded binding protein ) and amplified through  <dig> thermocycles. primers contained all the flanking sequences features necessary for sequencing on the intended platform, and different index sequences for each library. pcr products were run on a tbe dna gel  and a band of ~170-350 bp  was cut out, dna from it was purified and analysed by on-chip electrophoresis using an agilent bioanalyzer. libraries that were to be directly compared with each other  were quantified and pooled together proportionally prior to size-selection on the gel. the indexed, size-selected libraries were pooled with other indexed size-selected libraries for sequencing from the 5′ ends  on an illumina hiseq  <dig> instrument by the biomolecular resource facility, australian national university.

sequence data analysis
raw reads were trimmed for low-quality positions  using fastq_quality_trimmer and adapter sequences and poly tracts were then trimmed using fastx_clipper, both from the fastx tools suite. reads shorter than 11 nt after trimming were discarded. reads were initially mapped unidirectionally using bowtie <dig>  <cit>   against processed rrna sequences, and the unmapped reads were then mapped against other non-coding rnas including rrna precursors, snornas and trnas. finally, the remaining unmapped reads were mapped unidirectionally against mrnas . reference sequences were from the s288c reference genome . read densities and counts per transcript were collated using custom perl and r scripts. reads were first divided into size ranges, and the density of the 5′ ends of reads mapping to rrna was calculated as a moving average  from pdd-treated and untreated libraries. read 5′ density from pdd-treated libraries was plotted as a percentage of that from untreated libraries after normalizing for library loading using the total number of mrna-mapped reads within the relevant insert size-group. depletion efficiency was calculated from the minima of this value after averaging across all functional 18s and 25s probes.

gc content of libraries was calculated for all reads mapping to mrnas from each library. pcr duplication rates were determined by analysing the number of reads starting at exactly the same position. coverage was calculated as the number of reads divided by the number of available positions  on each orf. simulated reshuffling of read 5′ ends was performed repeatedly over the available positions in each orf and the number of exact 5′ read end overlaps was tallied and compared to the numbers from the real data . at least  <dig> simulations were performed for orfs with > <dig> reads, and at least  <dig> each for orfs with 2– <dig> reads.

qpcr
qpcr was performed using quantifast qpcr premix  as per manufacturer’s instructions with primers as listed in  at  <dig>  μm final concentration. serial dilutions of control cdna were used to test the pcr efficiency, which was >90% for all primers. 10 μl reactions were generated in 384-well plates  and qpcr performed on a quantstudio 12 k flex .

RESULTS
in developing pdd we aimed for a method that would avoid manipulations at the rna level and use unmodified dna oligonucleotide probes to allow for cost savings as well as facile customisation. these criteria were met by deploying probe-mediated dsn cleavage at the stage of single-stranded adapter-flanked cdna, common to several rna-seq library preparation methods, including the split adapter ligation approach used here   <cit> . a single cut introduced anywhere in a library molecule will prevent its amplification via the adapter sequences at subsequent stages. this strategy also avoids inadvertent cleavage of adapter sequences, as there is no complementary strand with which they could form dsdna. dsn operates efficiently at higher temperatures and requires at least ten perfectly complementary base pairs to cut, thus it has better mismatch discrimination than rnase h, especially given the higher tm of rna:dna compared to dna:dna hybrids. that pdd is performed downstream of adapter ligation furthermore eliminates any risk of new adapter-insert junctions being created through off-target cutting.figure  <dig> 
strategy to implement pdd with the split-adapter library preparation method. fragmented rna is 3′-polyadenylated and reverse transcribed using a primer with both 5′  and 3′  adapters. between them  is a block for dna polymerases . also present is a 5′-phosphate  for subsequent self-ligation. after reverse transcription, rna template is eliminated and cdna  circularized and subjected to pdd treatment, whereby it is hybridized to dna oligonucleotide probes  and any dsdna formed is cut with dsn, rendering the targets incapable of amplification.



proof of concept
to test the feasibility of the pdd strategy, we simulated the generation of a rna-seq library from degraded rna by using rnase i-treated s. cerevisiae cytoplasmic lysate as starting material for the split-adapter library preparation method  <cit> . this method, which has been extensively characterized elsewhere  <cit>  and is now also implemented as a commercial kit, was chosen due to its even coverage and low tendency for insert bias. it generates a single-stranded intermediate antisense cdna construct flanked by 5′ and 3′ adapters in a circular molecule . we mixed the library intermediate with four oligonucleotide probes corresponding to rrna sense sequences , denatured and cooled to 48°c, whereupon dsn was added to one half of the mixture and the other mock incubated. after library amplification, qpcr was performed for several rrna amplicons as well as mrna sequences for normalisation purposes. this showed that the abundance of the two directly targeted sequences  had decreased by approximately two orders of magnitude in the dsn-treated library, while another qpcr amplicon , ~100 nt away from two flanking probe-targeted sequences, still decreased by about 5-fold .figure  <dig> 
initial pdd trials and probe set analysis. a: top: two qpcr primer pairs , rrna-a and rrna-b, flanked the target sites for depletion probes , while the rrna-c primer pair was located about 100 nt away from the nearest target sites. bottom: qpcr Δct values  from the three rrna sequences and two mrna controls. error bars are the standard error of the mean. b: fifty depletion probes were analysed for tm of hybridization with intended rrna targets  and likely off-target sites  in the transcriptome using offtarget_tm. the probe that later failed to deplete its target is indicated .



probe design
following these encouraging findings, we designed more sense-strand dna oligonucleotide probes to target rrna fragments that tend to dominate ribosome profiling libraries to reach a total of  <dig> each, against 18s and 25s rrna, and one each, against  <dig> s and 5s rrna . the probes had variable spacing across the rrnas, allowing characterisation of individual probe efficacy and probe spacing requirements. we also generated a bioinformatics tool, offtarget_tm , to evaluate probe sets. offtarget_tm performs in silico annealing of probes to the target rnas and other transcriptome sequences in order to identify potential unintentional off-targets and determine the optimum hybridization temperature for pdd. results with our probe set indicated excellent discrimination between intended targets and off-targets at our chosen hybridization temperature of 48°c .

application to rna-seq libraries
to demonstrate the performance of pdd in full-scale rna-seq experiments, we generated two high-complexity rna-seq libraries by the split adapter method, this time using mg+2–mediated fragmentation of purified s. cerevisiae rna. one library was made from highly fragmented total rna . the other library was made from a moderately fragmented  mixture of total rna spiked with 20% of rna that had been enriched for mrna using the ribominus™ kit. the purpose of the first library was to assess pdd efficacy in a typical application. the goal with the second library was to have better mrna representation  to accurately assess any off-target effects of pdd. we also modified the published split adapter ligation protocol  to include selection of cdna:rna duplexes away from unextended reverse-transcription primer , while bypassing several gel-electrophoresis purification steps.

each cdna library intermediate was split into equal aliquots and either pdd treated or left untreated. the four samples were then pcr-amplified, size-selected for an insert size of ~ <dig> - 200 nt and the first 150 nt sequenced from the 5′ end in a multiplexed run on an illumina hiseq  <dig> instrument.

efficient depletion of rrna
we first focussed on the rrna-mapped reads in the highly fragmented total rna libraries. densities of the 5′ ends of rrna-mapped reads were calculated across all rrnas and normalised to mrna-mapped reads to correct for library loading. we then calculated 5′ read density in the pdd-treated sample as a percentage of that in the untreated control, to characterise zones of depletion at each probe-targeted region. conceptually, a steep drop in 5′ read density should be seen on the right flank of the zones, starting beyond ten nucleotides upstream from the location of probe 3′ ends, as a direct consequence of dsn’s minimum requirement of ten consecutive matching base pairs for degradation  <cit> . conversely, position and slope of the left flanks of the depletion zones should be determined by the distribution of insert sizes in the libraries . to ascertain these patterns in our experiment we performed several in silico size selections, simulating libraries of different insert size ranges, and plotted their relative 5′ read densities across rrnas. figure 3a shows 5′ read densities in pdd-treated libraries, as a percentage of untreated, along the entire 18s rrna. it is apparent that each probe created a zone of depletion that grew wider with increasing insert size. overall, we saw efficient and consistent depletion for  <dig> of the  <dig> probes. the reason for failure of one probe  is unclear, although it was shorter than most of the others , thus it may be prudent to design probes of >22 nt length. figure 3b displays all probe-targeted regions in 18s and 25s rrna , aligned according to the 3′ end of each probe, to assess depletion zone topology for different library insert size ranges. consistent across all probes we saw the expected steep drop in read density beyond ten nucleotides upstream of probe 3′ ends. coverage recovered further upstream as a function of insert length cutoffs, with longer library inserts yielding larger depletion zones. we next explored the relationship between library insert size, inter-probe distance and read depletion. pdd should achieve continuous rrna depletion for inter-probe distances that are at least 20 nt shorter than the minimum insert size of the library. this would allow every rrna insert to be targeted by at least one probe . the results obtained from tallying reads falling between probes  fully confirmed these expectations. for each insert size-range analysed, the relative depletion of inter-probe reads was greater for more closely spaced probes, approaching full efficiency as inter-probe distance dropped below the minimum insert size cutoff minus 20 nt. assessing all inter-probe regions below this distance requirement further allowed us to calculate an average depletion efficiency of ~94% for pdd in its current configuration.figure  <dig> 
pdd-mediated rrna depletion. a: 18s rrna profile of read 5′ end-density  from the total rna library. reads were divided into the insert length ranges indicated on the right and normalized to the number of reads mapped to mrna orfs within each size category. annealing positions of depletion probes are indicated . b: pile-up of 5′ read densities  flanking all probes targeting 18s and 25s rrna  in four different size-ranges of library inserts. black lines: average read ratio of smoothed  individual profiles. probe lengths are indicated by line colours. c: trade-off between library insert size and probe spacing from the total rna library. for each pair of adjacent probes along rrna, reads falling between probes  were counted, and used to calculate a normalized read ratio of each inter-probe segment of rrna . this was compared to the intervening distance between probes . four different library insert size ranges were analysed and the minimum insert size for each group is indicated on the x-axis .



absence of bias in retained transcriptome coverage
we assessed several quality parameters in all four sequencing library datasets  and found no notable change with dsn treatment. the gc content of mrna reads was not appreciably affected by pdd , unlike previously reported with c0t hybridization  <cit> . focussing on orf-mapped reads in the mrna-enriched libraries, <2% of reads were pcr duplicates and little fragment bias was detected when comparing the observed read distribution to that produced by random reshuffling of reads, with or without pdd treatment . these libraries again displayed the expected rrna depletion pattern in the pdd-treated sample , and were further processed to assess mrna representation . this revealed high concordance between libraries and, importantly, no systematic bias as a result of the dsn treatment, even for mrnas carrying potential off-target sites for the depletion probes  as predicted by offtarget_tm.figure  <dig> 
comparison of read counts for mrnas from both pdd treated and untreated libraries, derived from the 20% ribominus™ rna spiked sample. calculated tm of the best off-target match within an orf to any of the probes is indicated by the intensity of red colour.



discussion
in this study we characterised pdd as an efficient, accurate and flexible method for the depletion of problematic sequences from rna-seq libraries. in applying it to s. cerevisiae rrna we showed that pdd performance is reliable and predictable as a function of the well characterised enzymatic properties of dsn, probe design  and spacing, as well as library insert size distribution. when starting with intact total rna samples there is no need for contiguous probe coverage of the target, rather a probe spacing of 20 nt less than the minimum anticipated library insert size, or closer, will suffice to obtain even and continuous depletion. rrna depletion by pdd in its present configuration is slightly less efficient  than that reported for the rnase h method or commercial ribo-zero™/ribominus™ kits . offsetting this are other advantages of pdd such as its high stringency/lack of bias and avoidance of nuclease exposure prior to linker ligation. the relatively sparse probe spacing required further increases flexibility of probe design so that off-targets can be avoided.

given the low cost of unmodified dna oligonucleotides, pdd is an affordable solution for depletion of rrna in species for which off-the-shelf commercial kits are not available. similarly, pdd might be a cost-effective option when sequencing large sample sets derived from standard organisms. its faithful preservation of fragment ends makes it highly suitable for applications that rely heavily on accurate mapping of fragment ends, such as ribosome profiling, clip-seq and related approaches, mapping of transcript extremities, and nucleotide-resolution mapping of base modification in rna   <cit> . as pdd operates at the cdna level it could also be applied to remediate pre-existing libraries containing unacceptable levels of unwanted sequences  or to remove “adapter dimers” .

we implemented pdd in combination with the split adapter method, however, it should be applicable to most directional rna-seq library preparation methods, with some modifications, if it is performed after linker ligation and reverse transcription but before amplification . we have tested 1× dsn buffer for hybridization and dsn digestion. while buffers that are similar in terms of ionic strength and ph should also permit pdd, any free divalent cations other than mg+ <dig>  should be removed or chelated with equimolar edta  as they are known to alter dsn activity  <cit>  and interfere with fidelity of a related dsdna nuclease  <cit> . note that it is important to eliminate the template rna prior to pdd as dsn can also degrade the dna strand of rna:dna hybrids longer than 15 nt  <cit> . conversely, this property of dsn might even be harnessed productively, by using purified fragmented rrna instead of oligonucleotides to direct dsn cleavage.

additional potential applications and variations of the pdd procedure are numerous. identification of minor organisms present in mixed environmental samples  might also be aided by pdd, through selective depletion of conserved rrna loci, allowing deeper sequencing of more variable rrna regions for discriminating between species. the rapid flexibility of pdd also allows unwanted sequences other than rrna or adapter dimers to be readily targeted for a variety of applications. highly abundant mrnas in the target cell or tissue to be sequenced  could be depleted. capture-seq, a technique for focussed sequencing of rare transcripts  <cit> , could be combined with pdd to deplete abundant transcript isoforms or contaminants, for example to find rare expressed antibody variants in immune cell populations responding to antigen. the mismatch-discrimination of dsn could potentially allow the enrichment of rare point mutation-containing sequences in other types of pooled samples  <cit> , for example to analyse the deep mutational landscape of retrovirus in a patient’s bloodstream.

CONCLUSIONS
we envisage that pdd will prove useful for ridding rna-seq libraries of sequences that would otherwise dominate coverage. key features of pdd are its relatively low cost, flexibility and accuracy, allowing it to be customised to a variety of source species and applications. in this way pdd will facilitate the ever increasing and diverse uses of rna-seq in the modern life sciences.

data availability
sequencing data is available at the ncbi sra database  under project accession number: srp <dig> 

electronic supplementary material
additional file 1: table s1: is a list of oligonucleotides used in this study. table s <dig>  is a summary of diagnostic statistics for sequencing quality from the sequencing run. 

 additional file 2: figure s1a and s1b: are schematic diagrams describing expected 5′ read densities after pdd treatment, and figure s <dig>  shows an analysis of pcr-duplication in the sequencing data. 

 additional file 3: contains a perl script, offtarget_tm.pl that was used to estimate matches between probes and transcripts in an annotated genome. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

ska and tp conceived and designed the experiments. ska and nes performed the experiments. ska analyzed the data. ska and tp wrote the paper. all authors read and approved the manuscript.

