BACKGROUND
the dramatic increase in the production of farmed fish in the past few decades has resulted in aquaculture species becoming of huge economic importance, promising a sustainable resource of high quality protein and long-chain fatty acids. salmonids, in particular atlantic salmon, are amongst the most important aquaculture species. in  <dig>  approximately  <dig>  million tonnes of atlantic salmon were produced from farms worldwide, corresponding to a value of just over $ <dig>  billion  <cit> .

salmonidae originate from a common ancestor whose genome underwent a duplication event around  <dig> -  <dig> million years ago   <cit> , with recent estimates from sequence data  suggesting a date of ~ <dig> mya  <cit> . extant salmonid species have not yet fully recovered the diploid state, with areas of the genome still showing evidence of tetraploid segregation  <cit> . in female atlantic salmon, all loci appear to segregate in a diploid fashion  <cit> . although much of the male genome segregates disomically, secondary quadrivalent formation during meiosis between parts of chromosomes which are ancestrally homeologous has been described  <cit> . homeologous pairing is thought to occur only at the telomeres since it takes place after homologous chromosome pairing, and has been postulated to be responsible for the distinct lack of recombination observed in male salmon  <cit> . while in most species the heterogametic sex often shows reduced recombination rates compared to the homogametic sex  <cit> , the ratio in atlantic salmon is one of the highest observed in vertebrates   <cit> . existing linkage maps for atlantic salmon also highlight a marked difference between the sexes in the distribution of putative crossover events; equal dispersion is observed along chromosomes in females, in contrast to telomere-specific recombination in males with little or no recombination at centromeric regions  <cit> . as a result, marker order and positions are more reliably estimated in female-specific recombination maps.

the genomic resources for atlantic salmon are amongst the most extensive of all aquaculture species  <cit> , and include several genetic maps, a physical map, an extensive est database of approximately  <dig>  tags and several microarrays  <cit> . the atlantic salmon genome is also in the process of being sequenced and assembled  <cit> , and the first draft assembly is available . however, the recent genome duplication and frequent long repeat regions are hampering the genome assembly  <cit> . the linkage maps currently available for atlantic salmon include those based on amplified fragment length polymorphisms , microsatellites and more recently single nucleotide polymorphisms   <cit> . microsatellites are generally most informative for linkage mapping due to their variability and multi-allelic nature. however, bi-allelic snps are increasingly utilised due to their abundance and amenity to accurate and high-throughput scoring . the most recent salmon linkage map by lien at al.  <cit>  is comprised of  <dig>  snp markers in  <dig> linkage groups. in contrast to other studies , the difference in overall map length between males and females was minor . a possible reason for this discrepancy is that the increased marker density resulted in the genotyping of more markers in the telomeric regions. therefore, lien et al.  <cit>  suggested that overall average male and female recombination rates are similar, but the distribution of recombination events is markedly different, with male recombination events being more frequent at the telomeres, as supported by other atlantic salmon linkage maps  <cit> .

while dense snp genotyping platforms are still in development for salmonid species, next generation sequencing  technologies are making the snp discovery and genotyping process much more feasible, efficient, and cost-effective  <cit> . several methods of genotyping-by-sequencing can be used to simultaneously discover and score thousands of snp markers in pooled, barcoded samples of any species of interest  <cit> . for example, restriction-site associated dna sequencing , first described by baird et al.  <cit> , has been applied to many organisms without a reference genome  <cit> . it has rapidly become a popular method in aquatic species for quick snp discovery and genotyping for building linkage maps  <cit> , population genomics  <cit> , comparative genomics  <cit>  and qtl mapping  <cit> . in addition to the snp genotypes, paired-end rad-seq provides several hundred bases of flanking sequence from the assembly of paired-end reads of randomly sheared genomic fragments anchored at the same restriction site   <cit> . these sequence data assist in whole genome sequencing of an organism via the assembly and ordering of genome contigs and scaffolds . rad-seq has also been applied to fine map qtl in atlantic salmon  <cit> , but a linkage map based on the snp genotypes in the restriction enzyme site flanking sequences has not yet been constructed, and the location of the rad-seq-derived snps with respect to the atlantic salmon reference genome contigs and putative genes is largely unknown.

the main aim of this study was to construct a high density snp linkage map of the atlantic salmon genome using snp markers derived from a rad-seq analysis using the sbfi restriction enzyme. additional aims, building on this linkage map, were to  investigate the differences in recombination rate and distribution between male and female maps;  integrate the new rad-seq linkage map with existing linkage/physical maps and the draft atlantic salmon reference genome;  identify putative genes proximal to the snps in the linkage map using comparative genomics; and  investigate the salmonid genome duplication by comparisons to rainbow trout and stickleback linkage groups.

RESULTS
rad sequencing
the atlantic salmon samples used in this study were from the two salmap reference families, for which dense sex-specific microsatellite linkage maps exist . four unrelated individuals  sourced from the river tay in scotland, uk, were used as parents in the production of two full-sibling families . each full-sibling family consisted of 46 f <dig> offspring, resulting in  <dig> individuals in the study . to maximise the chances of detecting segregating snps in the parents, the parents were sequenced at a substantially higher depth than the offspring . the average sequence depth was  <dig> million reads per parent and  <dig> million reads per offspring, which was reduced to  <dig>  million and  <dig>  million following the removal of putative pcr duplicates . paired-end rad-seq results in sequence from both ends of the randomly-sheared genomic fragments which are anchored at the sbfi cleavage sites. the resulting dataset includes a stack of ‘read 1’ corresponding to the 95 bp  immediately adjacent to the sbfi cleavage site  and an associated paired-end contig resulting from the assembly of the ‘read 2’ .

following the merging of reads into rad loci across individuals,  <dig>  distinct rad loci were detected  which is indicative of  <dig>  sbfi cleavage sites in the atlantic salmon genome. this number is comparable to a previous study by our group  <cit>  in families of farmed atlantic salmon, and indeed > 97% of the rad loci observed in the current study were also observed in  <cit> . this demonstrates that sbfi rad-seq is sampling the same sites in the atlantic salmon genome across wild and farmed populations, with positive implications for its reproducibility as a genotyping technique.

snp discovery, filtering, genotyping and validation
a total of  <dig>  putative snps were discovered, of which  <dig>  were detected in the rad loci and  <dig>  were detected in the pe contigs. stringent filtering criteria  were applied to identify and remove individuals and snps with a high level of missing data and/or mendelian errors.  <dig>  snps with a genotype pattern suggestive of paralogous sequence variants  were removed . these are a useful resource for excluding psvs in future sbfi rad-seq of atlantic salmon and other salmonids. the proportion of missing genotypes of an individual was inversely related to the sequence coverage for that individual ; this was due to the removal of genotypes at individual snp loci where sequence depth was below the threshold chosen to ensure high confidence in the genotype call . as a result,  <dig> individuals were removed from further analysis . it is clear that a read depth of ca.  <dig> million reads per individual  is required to ensure high levels of high confidence genotype coverage. a further  <dig> individuals were removed from further analysis due to a high mendelian error rate . post-filtering, the number of snps retained for the construction of the linkage map was  <dig> , and the total number of individuals remaining was  <dig> .

stringent quality control filtering was applied to the initial set of  <dig>  putative snps generated from the raw rad-seq reads. filtering parameters for snps included removing excess missing data , excess mendelian errors  and excess heterozygosity . the final number of snps left for linkage map construction was  <dig> . individuals were removed if they showed excess missing genotypes  and/or excess mendelian errors .  <dig> individuals remained for linkage map construction post-filtering.

to validate a subset of the rad-seq-derived snps and to compare genotype calls with a more established genotyping technology, a subset of  <dig> snps were genotyped across the mapping panel using kasp technology  . on average, a 97% correspondence between kasp and rad-seq genotypes was found . given the complex, duplicated nature of the salmon genome, no genotyping assay is likely to have complete accuracy across all snps. therefore, 97% concordance between genotype calls using two disparate technologies suggests that the rad genotyping described herein is reliable.

linkage map construction
following the snp filtering process, the linkage arrangements between the remaining  <dig>  putative snps were assessed. anchor markers were used to assign snps to each of the  <dig> groups .  <dig>  snps were initially assigned to a linkage group using cri-map software ) , with an average of  <dig> snps per linkage group.  <dig>  of the snps were from the rad loci and a further  <dig> were from the pe contigs. the lower number of pe snps is likely to be due to the lower sequence coverage of pe contigs compared to the rad loci. in family br <dig>   <dig>  markers showed informative segregation patterns . the corresponding number in family br <dig> was  <dig>  .

snps were assigned to a linkage group using previously mapped anchor markers in cri-map. snps were then ordered on each linkage group in onemap for each individual mapping parent separately.

 <dig>  snp markers were assigned to a linkage group using the cri-map software. the table gives the total number of markers segregating for each parent from this subset of assigned markers.

individual linkage maps were then constructed using the onemap software  <cit>   for each parent using the sex-specific segregating markers only. the numbers of snps positioned and ordered on each linkage group are given in table  <dig> . figure  <dig> shows linkage maps drawn for all four parents for an example linkage group . all individual parent maps with ordered snps and positions are given in additional file  <dig>  no linkage map could be constructed for linkage group  <dig> for the female parent of family br <dig> due to very few female-segregating markers being assigned to this linkage group.

distribution of recombination events across the genome
one of the striking features of the salmon genome is the large difference in recombination rate and distribution observed between the sexes  <cit> . to investigate this phenomenon using the rad-seq linkage map, the map lengths for each linkage group were compared for each parent within a family to give an indication of the male:female recombination ratio . for family br <dig> the overall map lengths between the sexes were similar, with a female map length of  <dig>  centimorgans  and a male map length of  <dig>  cm, giving a recombination ratio of 1: <dig> . this similarity of map length was generally consistent across most linkage groups, although for linkage groups  <dig>   <dig> and  <dig> the female map was significantly longer . for family br <dig> the female map length was  <dig>  cm and the male map length was  <dig>  cm giving a male:female ratio of 1: <dig> . the larger ratio and smaller male map observed in family br <dig> is likely related to two features of the male parent map. firstly, the markers on linkage group  <dig> all clustered at 0 cm thus no ratio could be calculated. secondly, linkage group  <dig> in family br <dig> showed an extreme male:female map distance ratio of 1: <dig> 

in addition to the overall heterochiasmy in salmonids, previous studies have presented evidence for major differences in the distribution of putative recombination events between males and females, with male recombination events thought to cluster towards the telomeres  <cit> . to compare the distribution of putative recombination events in the current study, for each linkage group in each family the shortest parental map was identified and split into 5 cm intervals. the longer map  was then split into an equal number of evenly sized intervals. the five intervals containing the most snps were identified for each map, and an overall average of the percentage of markers in the top five most populated intervals was calculated and compared for the two sexes across both families br <dig> and br <dig> . it is evident that markers are much more clustered into one or two peaks of marker density in males, compared to females. this corresponds to a putative recombination desert, postulated to be at the centromeric regions of chromosomes in males. conversely, fewer markers were found in intervals closer to the extremes  of male linkage groups. for example for family br <dig>  the average percentage of markers located at the extremes of the linkage groups was 19% in females vs. 8% in males. this suggests more frequent recombination events in putative telomeric regions in males, in line with previous salmonid linkage mapping studies  <cit> .

integration of the rad-seq maps with the atlantic salmon reference genome
flanking sequences for the mapped rad-seq snps  were aligned to the atlantic salmon draft reference genome sequence contigs . this allowed the assignment of  <dig>  atlantic salmon reference genome contigs  to at least one linkage group . it is noteworthy that  <dig> genome sequence contigs showed significant sequence similarity to two different linkage groups, and two contigs to three linkage groups, which is indicative of homeology resulting from the recent genome duplication . for example,  <dig> contigs aligned to both atlantic salmon linkage groups  <dig> and  <dig>  homeology between these two linkage groups has also been inferred in other studies  <cit> .

2/27/
6/
23/
9/ 
10/
3/
2/
31
17/
5/
14/
18
15
27
7/
17
22
atlantic salmon reference genome contigs were assigned to linkage groups by blastn alignment against mapped rad contigs. column  <dig> shows the stickleback linkage groups orthologous to the atlantic salmon linkage groups identified by this study. column  <dig> shows the atlantic salmon - rainbow trout orthologous linkage groups as defined by phillips et al.  <cit>   and danzmann et al.  <cit>   individually, and those identified in both studies . 50% of the stickleback - rainbow trout relationships suggested in this table have been identified in another study comparing rainbow trout and stickleback only  <cit> .

*grand total includes genome contigs assigned to more than one linkage group only once, thus is less than the sum of genome contigs per linkage group.

**grand total given includes sequence data of genome contigs assigned to more than one linkage group only once, thus is less than the sum of sequence  assigned per linkage group.

 <dig> atlantic salmon reference genome contigs showed alignment to two or more linkage groups. the number of times two or more atlantic salmon linkage groups shared an atlantic salmon genome contig was counted, and is presented in column three. column four shows the proto-acinopterygian ancestral linkage group shared between atlantic salmon linkage groups in column one, as defined by danzmann et al.  <cit> .

§ also identified in  <cit> ; *also identified in  <cit> .

comparative genomics: identification of rad-marker-associated genes
a two-stage strategy was employed to identify genes associated with the mapped and ordered rad-seq snps. in stage one, the repeat-masked flanking sequence of the mapped rad-seq snps  was screened for sequence similarity to all known three-spined stickleback  gene sequences using tblastx. the stickleback was chosen because it is one of the most closely-related species to atlantic salmon for which there is a near-complete annotated reference genome sequence. significant sequence similarity  between mapped rad contigs and stickleback genes was observed for approximately 17% of the mapped rad contigs .

the number of rad-seq snps located within or close to genes based on direct alignment of mapped rad contigs  or atlantic salmon reference genome contigs  against the stickleback nucleotide gene sequences downloaded from ensembl biomart ). column two gives the total number of sex specific segregating snps which were ordered and positioned within a linkage group using the onemap software.

however, the mapped rad contigs are relatively short  and therefore genes close to, but not within, the mapped rad contigs may be undetected. therefore, in stage  <dig>  the  <dig>  atlantic salmon reference genome contigs assigned to a linkage group  were repeat-masked and aligned  with the stickleback gene sequences. significant sequence similarity to stickleback genes was observed for  <dig>  contigs , of which  <dig> aligned to two atlantic salmon linkage groups. in total, ~50% of the mapped snps were associated with a putative gene . on average, 70% of the genes identified in stage  <dig> for each linkage group were also identified in stage  <dig>  overall, across all individuals and all linkage groups, atlantic salmon orthologs for  <dig>  stickleback genes were identified and mapped. these data may increase the utility of the rad-seq snps for qtl mapping and subsequent identification of candidate genes.

comparative genomics: synteny analysis
to investigate regions of conserved synteny  between the atlantic salmon and stickleback genomes, the linkage group positions of the genes associated with the mapped rad contigs in the stickleback reference genome were recorded. for each of the salmon linkage groups, the stickleback linkage groups to which the mapped rad contigs most frequently aligned to was identified . regions of conserved synteny were identified for  <dig> of the  <dig> atlantic salmon linkage groups. however, no clear pattern of orthology with a stickleback linkage group was observed for atlantic salmon linkage groups  <dig>   <dig> and  <dig>  .

comparative genomics: genome duplication
as described above,  <dig> and  <dig> atlantic salmon genome contigs showed significant alignment to two and three atlantic salmon linkage groups respectively . in total,  <dig> homeologies were identified.  <dig> of these have been shown to originate from the same proto-acinopterygian ancestral karyotype as defined by danzmann et al.  <cit> . in order to confirm these homeologies, the atlantic salmon linkage groups which share a single stickleback linkage group were identified from table  <dig>  and this is summarised in additional file 1: table sa <dig>  based on this,  <dig> homeologies were identified,  <dig> of which had already been identified in table  <dig> using shared genome contig assignments. to test the theory of a salmonid specific duplication, orthologous relationships between atlantic salmon and rainbow trout relative to stickleback linkage groups were analysed using previously published data  <cit> . a 1: <dig> correspondence between single atlantic salmon linkage groups and rainbow trout linkage groups was not observed . for  <dig> of the  <dig> atlantic salmon homeologies identified due to sharing a single stickleback linkage group , two rainbow trout linkage groups were identified.

discussion
linkage map construction
we have constructed and characterised a high density rad-seq-derived snp linkage map in atlantic salmon. as rad-seq becomes increasingly utilised as a cost- and time-efficient method of snp discovery and genotyping in salmonid genomic studies, this map will provide a framework for orientation of the marker genotypes with the atlantic salmon reference genome and putative candidate genes.

the large number of markers that can be discovered and scored in a single experiment is an advantage of the rad-seq approach. however, stringent filtering must be applied to avoid false positive snps, particularly in the recently duplicated salmonid genomes. we initially discovered >  <dig>  putative snps in our dataset, but after removing putative psvs and snps with excess missing genotypes or mendelian errors, only ca.  <dig>  snps remained for linkage map construction. the large number of missing genotypes in the dataset is partially due to a degree of irregularity in the sequence coverage across individuals and mapped rad sites. snps removed at this stage were mainly from the pe contigs where sequence coverage is inevitably lower than at rad loci. post-filtering, the average genotyping rate in the dataset across  <dig> individuals and ~ <dig>  snps was 76%. this is a substantial increase in the average genotyping rate in the unfiltered data . however, given the relatively small sample size in this study, any missing data will reduce the resolution of the maps constructed and reported. there is a strong relationship between sequence coverage and proportion of successful snp genotype calls across individuals . this is despite ensuring near equal quantities of offspring genomic dna in each library. therefore, to avoid high proportions of missing genotypes in future experiments using rad-seq, it is important to  strive for identical quantity and quality of input genomic dna per individual and  to account for the uneven read distribution across individuals and scale up the projected read coverage per individual accordingly.

the number of snps initially assigned to each linkage group using the cri-map software and anchor marker information in this study was compared to the snp linkage map constructed by lien et al  <cit>  and a strong positive correlation was observed . this is despite the use of different sequencing and genotyping technologies for the construction of the maps. this suggests that sbfi rad-seq is yielding an unbiased sample of the salmon genome, and that the number of snps per linkage group in both studies is likely to be related to chromosome size. dense sex-specific microsatellite linkage maps  are available for each of the four parents in the two salmap families  <cit> . in the current study, previously mapped markers were used as anchors in order assign rad-seq snps to salmon linkage groups, thus allowing a partial integration of the existing linkage maps with a dense snp linkage map. to our knowledge, our study is the first to attempt this in atlantic salmon. due to constraints in the sample size and the different properties associated with the inheritance of the different marker types, we were unable to produce a reliable combined anchor marker-snp linkage map using the onemap software. therefore, final maps are comprised only of rad-seq derived snp markers. for tightly linked snps, the number of recombination events is likely to be small in families of this size . while we did not observe more than 25% of markers segregating as a single unit on linkage maps , an improved reliability of marker order may be obtained by analysing additional families with larger numbers of offspring to increase the number of informative meioses.

the length of genomic dna sequenced at each rad locus, including the rad locus itself and the pe contig, is approximately 500 bp. therefore, multiple snps are frequently observed at a single locus and recombination between these snps is unlikely. as such, these snps are expected to map to the same position on the linkage map. to test this, we analysed the positions of snps from rad loci and pe contigs which originate from the same restriction cut site within the genome. we identified  <dig> restriction cut sites with mapped snps from both the rad locus and pe contig. in ~60% of cases, snps from the rad locus and associated pe contig mapped to the same cm position on the map. where this did not occur, pe snps were found to be positioned at the terminal ends of linkage groups. given the lower read coverage for the pe contig due to the nature of the rad-seq protocol, snps derived from the pe contig may have a higher genotyping error rate than those from the rad locus. a common feature of linkage mapping software is the positioning of markers with higher error rates at the ends of linkage groups, which could explain the instances where rad loci and pe contig derived snps did not co-localise on linkage maps.

map lengths and recombination ratios
the large difference in recombination rate between atlantic salmon males and females, and the distribution of the recombination events along the chromosome, have been a subject of much discussion in the literature  <cit> . we observed only a relatively small difference in overall map length in the current study  which is comparable to that observed in the snp linkage map of lien et al.  <cit>  . also in common with previous studies, we identified an increased clustering of male-segregating markers compared to females . therefore, this study supports the hypothesis that the major difference between male and female atlantic salmon is in the position of recombination events on the chromosome and not the overall frequency of recombination events. however, it should be noted that since sex specific markers were used, there were no common snps between the male and female maps within a family. therefore, our interpretations of the map distance differences and recombination events are based on overall patterns of linkage group size and marker clustering, rather than direct comparisons between marker pairs.

comparative genomics
approximately 17% of the snps had flanking sequence data which gave a significant alignment with an annotated gene in the stickleback genome. including the additional step of aligning the mapped snp flanking sequences to the salmon reference genome contigs increased the proportion of mapped snps associated with a putative gene to ca. 50%. there is a gc bias in the sbfi recognition sequence  which may result in a higher-than-expected frequency of sbfi cut sites within gene-rich regions of the genome. this bias in sbfi cut sites in potentially gene-rich regions of the genome has been observed in other sbfi rad-seq studies  <cit> . in total, atlantic salmon orthologs for  <dig>  stickleback genes were identified. on average, over half the genes identified on a linkage group were unique to a single individual map, with approximately a third of genes being mapped in two mapping parents. a substantial overlap between individuals in genes identified may not be expected since maps were not built using common snp markers.

gene-associated mapped snps were then used to investigate the orthology between the atlantic salmon and the stickleback genome. due to the large evolutionary distance between stickleback and salmon, extensive chromosomal rearrangements are likely to have occurred in both species. the stickleback genome contains  <dig> chromosomes , which is fewer than atlantic salmon . most salmon linkage groups were assigned to at least one stickleback group , with three salmon linkage groups  remaining unassigned, possibly due to the lower number of gene-associated markers on these linkage groups. twelve stickleback linkage groups aligned to more than one atlantic salmon linkage group, with one  aligning to three atlantic salmon linkage groups . these orthologies are consistent with published literature  <cit> , and may represent homeologous chromosomes within the atlantic salmon genome.

using microsatellites from the same mapping families as the current study, danzmann et al.  <cit>  were able to identify homeologous regions within the atlantic salmon genome . as well as this, they characterised the ancestral proto-acinopterygian karyotype which is hypothesised to have had  <dig> linkage groups , and assigned each atlantic salmon linkage group as originating from one or more of these ancestral linkage groups. the atlantic salmon homeologies given in table  <dig> were based on shared atlantic salmon genome contigs which were assigned to linkage groups by blastn alignment to mapped rad contigs. the atlantic salmon genome assembly used is the first published draft, and may contain assembly errors. therefore it is possible that the presence of chimeric or repetitive contigs could create spurious homeologies between linkage groups. 70% of the homeologies given in table  <dig> also contained regions of common ancestral origin based on the ancestral karyotype  as characterised by danzmann et al.  <cit> . we further confirmed these atlantic salmon homeologies by looking for the atlantic salmon linkage groups which have a stickleback linkage group in common . of the  <dig> homeologies described in additional file 1: table sa <dig>   <dig> have been described in a study conducted by danzmann et al.  <cit> , and  <dig> have been described in phillips et al.  <cit> ; these have been highlighted in table  <dig> 

linkage group orthologies between atlantic salmon and rainbow trout were also analysed using published studies  <cit>  to confirm the ancestral genome duplication within the salmonids relative to other teleost fish genomes. overall, a 1: <dig> correspondence between atlantic salmon and rainbow trout linkage groups was not seen . this may be explained by the genomic rearrangements that have occurred in the two different genomes post-diploidisation. however, two atlantic salmon linkage groups sharing a single stickleback linkage group  were seen to map to two rainbow trout linkage groups . this 1:2: <dig> correspondence between stickleback, atlantic salmon and rainbow trout linkage groups respectively supports the salmonid specific ancestral genome duplication.

CONCLUSIONS
in this study we used paired-end rad-seq to generate a high density snp linkage map of the atlantic salmon genome in an outbred population. the pattern of recombination between male and female mapping parents revealed a difference in the distribution of putative recombination events across the linkage groups. comparative genomics allowed the identification of genes proximal to  the mapped rad-seq snps. homeologous regions within the atlantic salmon genome and the putative orthologues of the salmon linkage groups in the stickleback and rainbow trout genome were identified and confirmed, providing support for a salmonid specific genome duplication. rad-seq is an increasingly popular tool for qtl mapping and population genomics, and this new map will provide a useful framework for future genomics studies.

materials and methods
rad library preparation and sequencing
the two salmap families   <cit>  used in this study are from a salmonid genetics resource population, and studies using these samples have been previously published  <cit> . therefore, no new fish experiments or sampling was carried out for this study. dna samples for these fish were obtained, and for each family, both parents and  <dig> offspring were sequenced using rad-seq . genomic dna samples from each individual were quantified using spectrophotometry  and checked for genomic integrity by agarose gel electrophoresis. a total of eight rad libraries were prepared, with two parent libraries  and six offspring libraries . since each library was subsequently sequenced in an individual lane, this design ensured higher sequence coverage of the parents compared to the offspring . rad libraries were prepared according to the methodology described in etter et al.  <cit>  with modifications as described in houston et al.  <cit> . briefly, each sample  was digested with sbfi-hf  . within each library, a p <dig> adaptor containing an individual-specific nucleotide barcode was ligated to the gdna of each sample. details of the library composition and nucleotide barcodes are given in additional file 1: table sa <dig>  the samples within each library were then pooled and the pools were sheared to ~400 bp fragments using a covaris s <dig> sonicator , then size selected through agarose gel electrophoresis to an approximate range of  <dig> - 500 bp. the p <dig> adapter, a “y” adapter with divergent ends, was ligated to the fragments and the libraries underwent 18 cycles of pcr amplification followed by a final size selection for the  <dig> - 500 bp fraction of the fragments. size ranges of the completed libraries were verified using electrophoresis  and concentrations were determined using spectrophotometry . each library was sequenced on an individual lane of the illumina hiseq  <dig> at the edinburgh genomics facility, university of edinburgh . raw sequences are available from the ena , accession number prjeb <dig> 

rad-seq bioinformatic pipeline and snp calling
the process for generating snp genotype data for the individuals in the rad-seq experiment was as follows. firstly, raw reads were ‘demultiplexed’ and assigned to individual samples according to their nucleotide barcode using radpools v <dig> . <dig>  <cit> , resulting in an individual fastq file per animal. the raw reads from each of these individuals were then merged into populations and the consensus sequence at each side of the sbfi cleavage sites were generated using ustacks and cstacks v <dig>   <cit> , allowing a mismatch of  <dig> base only. the assembly of the paired-end sequences at each sbfi flanking site was performed with clc assembly cell v <dig> . the paired-end reads were aligned back to the assembly using stampy  <dig> . <dig>  <cit> . pcr duplicates were detected with picard markduplicates v <dig>   and excluded. overall,  <dig>  consensus rad contigs were generated, of which  <dig>  were from the rad loci and  <dig>  were from the pe contig. 2% of rad loci had more than one pe contig associated with it. snps were called using samtools v <dig> . <dig>  <cit>  and then filtered using vcfutils to ensure a minimum overall read count at the locus of  <dig>  a maximum of  <dig>   and a snp quality score of  <dig>  only genotypes with a quality score of  <dig> and a depth of  <dig> reads were used; the others were assigned no call. only snps with a call in both parents of a family were retained for further analyses.

snp genotype quality control and filtering
the rad-seq bioinformatics pipeline described above resulted in a set of  <dig>  putative snps in both single and paired-end consensus sequences. due to variation in sequence coverage between individuals there was a large number of missing genotypes in the dataset . paralogous sequence variants  within duplicate regions of the genome with a very high sequence similarity will be retained by the pipeline above. therefore, filtering to remove  individuals and snps with excess missing data ,  putative psvs   and  apparent mendelian errors  was carried out. given parental genotypes, a mendelian error was defined as a highly improbable offspring genotype at a given snp. removing snps with genotypes in fewer than half of the individuals left  <dig>  snps. removing individuals with poor genotyping coverage  resulted in the removal of  <dig> individuals . snps showing excess  heterozygosity across the two families used in this mapping study  were removed from the dataset as putative psvs, leaving  <dig>  snps. four individuals with >  <dig> genotypes defined as mendelian errors were removed from the analysis.  <dig> snps with two or more mendelian errors were discarded. snps with one mendelian error  were set to missing for the genotype in question. the final dataset remaining for linkage map construction consisted of  <dig> individuals  and  <dig>  snp markers, with an overall genotyping rate of  <dig> %. the snp filtering procedure is summarised in table  <dig> 

linkage map construction
linkage maps were constructed separately for the four parents in the two mapping families using a two-step process. in step  <dig>  the snp markers were clustered into putative linkage groups using  <dig> markers from a pre-existing study genotyped across the salmap families  <cit>  as anchors . markers were chosen so that at least one informative marker was present in each linkage group. the two-point linkage between all markers was then calculated using the ‘twopoint’ option of the cri-map software  as modified by xuelu liu   <cit> . snp markers were then assigned to linkage groups using the ‘autogroup’ option and mapped anchor markers , starting at a lod of  <dig> and applying a stepwise decrease in lod score threshold to a minimum of  <dig>  for each snp, the segregation type  of the snp in each family was determined and snps showing informative segregation patterns for linkage map construction  were identified. the best estimated order of snps on each linkage group was calculated using the ‘order.seq’ algorithm of the onemap software  <cit> , modified for parallelised computing by marcelo mollinari  with the following parameters: n.init =  <dig>  thres =  <dig>  draw.try = false. snp marker order was confirmed as the best order using the ‘ripple.seq’ function of onemap with a word size of  <dig> and applying a lod threshold of  <dig> 

the map position in centimorgans  was calculated according to the haldane mapping function. marker genotypes containing errors can appear as recombination events and result in erroneous positioning of snps some distance removed from other markers at the ends of linkage groups. therefore, maps for each parent and each linkage group were investigated manually, and snps with a gap of greater than 30 cm in male maps and 20 cm in female maps from the neighbouring snp at the ends of the linkage groups were removed. maps were drawn using the mapchart software  <cit>  .

recombination ratio calculation and comparing marker distributions
recombination ratios between males and females could not be directly estimated using marker intervals since male and female maps within families did not contain the same markers. instead, recombination ratios were estimated by comparing map lengths. in order to compare the distribution of markers between the sexes, linkage groups were split into intervals of equal size and the distribution of the markers across the intervals was compared for males and females across linkage groups. to define the intervals, the shorter of the parental maps was split into 5 cm intervals. if map length was not long enough to produce more than five distinct intervals then a smaller cm interval was chosen in order to split the map into  <dig> equally sized intervals. the longer parental map was then split into an equal number of intervals. for example for family br <dig> and linkage group  <dig>  the male map was shorter than the female map . therefore, the male map was split into  <dig> intervals of 5 cm. the female map was then split into  <dig> marker intervals of equal size  and the percentage of snps mapping to each interval for both sexes was calculated. for each linkage group and each sex across both families, the five intervals with the highest percentage of markers were identified, and the averages of these percentages are given in figure  <dig> 

alignment of rad loci with atlantic salmon reference genome
in order to assign atlantic salmon reference genome contigs to linkage groups, the mapped rad contigs were first repeat-masked using the repeatmasker software using the “salmon raw repeat db v <dig> ” database . masked sequences were then aligned with the atlantic salmon reference genome  using blastn with an e-value threshold of 1e- <dig> for rad loci and 1e- <dig> for pe contigs. rad loci or pe contigs aligning to multiple  reference genome contigs were excluded.

comparative genomics: identification of snp-associated putative genes
all known three-spined stickleback gene nucleotide sequences were downloaded from ensembl biomart ). the identification of snps within or close to putative genes was performed in two stages. in the first stage, the mapped rad contigs were screened for sequence similarity to stickleback  genes using tblastx . tblastx was chosen as it is more sensitive to protein homologies between distantly related species using sequence data , since it translates sequences in all three frames before alignment, thus overcoming problems of detecting open reading frames in the context of frame shifts between species. in the second stage, the linkage group assigned, repeat-masked salmo salar reference genome contigs were aligned against the stickleback gene sequences. this was done in order to detect mapped rad-seq snps which are in close proximity to a stickleback gene ortholog . only the two most significant alignments were retained in an attempt to avoid spurious alignment to multiple genes from different stickleback linkage groups .

comparative genomics: synteny analysis and assignment of atlantic salmon linkage groups to stickleback linkage groups
as described above, for each linkage group and each individual separately, rad loci and pe contigs associated with mapped snps were aligned against the stickleback gene sequences. rad loci and pe contigs were then grouped into a single rad locus in order to be counted only once  and the total number of rad loci showing significant alignment to a gene on a particular stickleback linkage group was counted. for each atlantic salmon linkage group, a single synteny relationship was assigned only if the number of significant alignments for a particular stickleback linkage group was twice  than the number of significant alignments for any other stickleback linkage group, and this relationship was seen in all mapping parents. the only exceptions to this was in cases where two stickleback linkage groups showed identical numbers of rad loci alignments, then both were assigned to that atlantic salmon linkage group.

kasp assay genotyping
to verify a subset of the rad-seq snps and to investigate the correspondence between individual genotypes obtained by rad-seq and those obtained by the more established ‘kasp’ technology , a subset of rad-seq snps with flanking sequence  were submitted to lgc genomics for kasp assay design and genotyping of the two salmap families   <cit> . a total of  <dig> kasp assays were designed, of which eight returned monomorphic data across the  <dig> samples. therefore, genotypes for  <dig> polymorphic snps  from  <dig> rad sites  were investigated for correspondence of scored genotypes between the two genotyping techniques in the same samples.

availability of supporting data
the raw rad sequence reads supporting this article are available in the european nucleotide archive  repository, .

competing interests
the authors declare that they have no competing interests.

authors’ contributions
conceived and designed the experiments: rdh, scb. prepared rad libraries: nl. managed sequencing of rad libraries: kg. analysed data: sg, tc. wrote the paper: sg, rdh. all authors read and approved the final manuscript.

supplementary material
additional file 1
this file contains supplementary tables a1-a <dig>  table a <dig> – library structure and read depth for the paired-end rad-sequencing libraries. table a <dig> – markers used as anchors in cri-map for assignment of rad-derived snps to linkage groups, and their corresponding atlantic salmon linkage groups/chromosomes. table a <dig> – map length  for each mapping parent and the comparison between the sexes. table a <dig> – homeologous atlantic salmon linkage groups with the stickleback and rainbow trout linkage groups and proto-acinopterygian linkage groups which they have in common.

click here for file

 additional file 2
putative psvs: variants removed from analysis due to excess heterozygosity. contains the following information for each psv identified: id of the snp identified as a psv ; rad consensus id  and rad consensus sequence  from which the snp originates; position of the snp identified as a psv in the rad consensus sequence  ; snp alleles .

click here for file

 additional file 3
snps used for rad-seq validation. contains id and sequence information for the  <dig> snps validated by kasp technology. for each snp, the percentage concordance between the genotypes obtained from rad-seq and those obtained from the kasp technology for the two salmap families is given in column  <dig> 

click here for file

 additional file 4
linkage maps. annotated with alignment information to stickleback genes and atlantic salmon genome contigs. map distances are given in centimorgans . each parent’s linkage map is given in separate sheets of the file.

click here for file

 additional file 5
 <dig>  atlantic salmon reference genome contigs and the atlantic salmon linkage groups to which they map.

click here for file

 additional file 6
 <dig> reference genome contigs which mapped to more than one linkage group and the atlantic salmon linkage groups to which they align.

click here for file

 acknowledgements
the authors wish to thank john taggart  and bjorn hoyheim  for providing the majority of the anchor marker genotypes used for linkage map construction and staff at the edinburgh genomics facility for assistance with rad-sequencing. the authors also wish to thank marcelo mollinari  for e-mail correspondence and modification to the onemap software code in order to permit parallel running of the software. we acknowledge funding from the biotechnology and biological sciences research council   and from the roslin institute’s bbsrc institute strategic funding grant.
