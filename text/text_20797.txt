BACKGROUND
biological oscillators with periods varying from seconds to years play important roles for most living organisms  <cit> . these oscillators have been divided into three groups by period length:  circadian oscillators, with periods close to 1 day;  ultradian oscillators, with periods less than 24 h; and  infradian oscillators, slower than circadian oscillators, with periods from a few days to a few seasons. examples of ultradian rhythms can be found in the oscillation of body temperature in golden hamsters and in electroencephalogram measurements from the human brain  <cit> . infradian oscillations can be seen in animals, such as birds, that have annual migration cycles  <cit> . behavioral oscillators form the group of oscillators that are responsible for adaptation to external environments, control of daily cycles of activity, annual reproductive rhythms, and migrations  <cit> . the most prominent and well-studied of the behavioral oscillators is the circadian clock .

the circadian clock is an endogenous biological oscillator with a period of approximately 24 h that controls daily activity and is found in most plants and animals. this clock helps to synchronize an organism’s internal processes and behavioral outputs with the daily light–dark cycle. the fruit fly drosophila melanogaster is one of the primary model organisms in the study of behavioral rhythms and previous studies in this invertebrate have revealed the core components of the circadian clock that have been subsequently found to be conserved in other organisms, including mammals  <cit> .

how these overt behavioral rhythms are generated has been an active topic of research for decades. one of the first theoretical models for the circadian system was proposed by pittendrigh, who suggested that the circadian clock consists of multiple oscillatory components that maintain identical frequency and appropriate phasing through external entrainment  <cit> . an alternative mechanism was proposed by pavlidis who relied on contemporary research showing that most known biochemical oscillators had periods which did not exceed a few minutes  <cit> . pavlidis showed mathematically that a system of strongly coupled oscillators with short periods can produce a robust circadian rhythm and simulate many aspects of circadian behavior. the pavlidis mechanism was supported subsequently by various mathematical models in which circadian rhythms result from a coupling of ultradian oscillators with periods of a few hours  <cit> . in yet another theoretical study circadian rhythms were generated by coupling oscillators with periods of only a few seconds  <cit> .

behavioral studies of various animals claim to reveal multiple ultradian rhythms in daily activity . these studies are commonly performed using spectral analysis of activity recordings. power spectra typically show multiple peaks at periods of less than 24 h, which some studies have attributed to ultradian oscillators. in these behavioral studies short ultradian rhythms associated with foraging activity were observed in siberian hamsters  <cit>  and common voles  <cit> . the animals were studied under conditions disruptive to circadian rhythms, leading the authors to suggest that these ultradian rhythms are independent of the circadian clock. other research has shown periods between  <dig> and 12 h in the activity of inbred strains of mice  <cit> ; these rhythms were observed both in 12 h light/12 h dark conditions and in constant darkness. a more recent report from blum et al. on dopamine-dependent oscillations in mouse activity with a ~4 h period has reinvigorated the discussion on ultradian rhythms in mammalian behavior  <cit> . in studies of fruit fly activity, ultradian rhythms were first claimed in per <dig> flies measured under constant conditions  <cit> . circadian rhythms are abolished in per <dig> animals due to a mutation in the period  gene  <cit> . subsequently, ultradian rhythms were also reported in wild type and other clock mutants of drosophila melanogaster  <cit> . based on these data, the authors proposed that in fruit flies per couples ultradian oscillators and ultimately produces a circadian rhythm. however, even though it was not explicitly mentioned, power spectra in these studies were interpreted under the assumption that only one spectral peak results from the circadian clock and therefore the activity data have a sinusoidal shape. in reality, rhythmic behavioral data often have a non-sinusoidal shape in time.

the core of the drosophila circadian clock consists of four proteins, period , timeless , clock  and cycle , that form a negative feedback loop  <cit> . although the molecular components differ, circadian clocks in mammals and plants also employ similar genetic architecture and, in each case, this conserved architecture produces clock gene oscillations that are sinusoidal in shape with period of approximately 24 h . these molecular oscillations converge on downstream behavioral circuits such as those for sleep, feeding and mating, and ultimately shape daily activity of organisms  <cit> . in drosophila, temporal patterns in solitary activity are generally studied using locomotion measurements by detecting a fly crossing an infra-red light beam in the middle of a tube. a typical recording shows a non-sinusoidal time series with two distinguishable peaks: the morning peak , which starts during the end of the night time and has its maximum when the light turns on; and the evening peak , which starts during the end of the day and reaches its maximum when the light turns off. the m and e activity peaks are thought to be produced by two groups of pacemaker neurons, the m and e oscillator cells, and modulated by neuropeptides secreted by the pacemakers . these two groups of neurons produce different neuropeptides. the neuropeptide produced in the morning oscillator cells is pigment dispersing factor  which has been shown to synchronize clock neurons and promote morning activity in fly behavior  <cit> . one of the neuropeptides produced by the evening oscillator cells is called the ion transport peptide  which is thought to influence fly activity around dusk  <cit> . a second possible source for the non-sinusoidal shape is the fly sleep homeostat, a feedback system that keeps track of sleep need in the animal. in mammals, the homeostat output has been modeled as repeating patterns of exponential rise and decay  <cit> . assuming the fly sleep homeostat produces similar patterns, interaction of its output signal with that of the clock could shape the final behavioral output as a non-sinusoidal waveform, as seen in locomotor recordings. indeed, that sleep–wake signals influence locomotor output is a standard assumption in fly studies which now routinely use locomotion as a read-out of sleep and wakefulness  <cit> . these possibilities suggest that understanding the temporal shape of the recordings could provide systems-level access to the biochemical pathways that influence fly locomotion patterns.

a mathematical description of the widely studied daily locomotion patterns in flies is currently missing and its absence has limited our interpretation of the data in both frequency and time domains. in frequency space, spectral data of locomotion are typically interpreted without considering the shape of the activity time series, although it is well-known from fourier’s theorem that the form of the time series is a critical determinant of its power spectrum. for example, non-sinusoidal signals with a single periodicity, such as square or triangular waves, produce power spectra with multiple peaks, which correspond to the harmonics of the primary period. in the time domain, beyond a qualitative description of how m and e peak heights vary with simple perturbations, no biophysical description exists for the peculiar shape of fly locomotor activity. for instance, we do not know what biological processes control the rates of increase and decrease of activity around m and e peaks.

we address these limitations by constructing a simple waveform with a single period that closely resembles the shape of fruit fly activity. our model consists of four exponential terms that generate a pattern resembling the m and e peaks. the power spectrum of the proposed waveform has peaks at harmonics of the primary period t <dig> and we demonstrate that the predicted spectral peaks can account for the multiple periodicities seen in the power spectrum of drosophila locomotion. the data show that lesions in circadian genes that shift the circadian peak also shift the ultradian peaks, in accordance with our model. genetic or environmental ablation of the circadian clock expectedly eliminates the circadian spectral peak but also reduces to noise levels the height of peaks in the ultradian range. thus we weaken the competing view that circadian rhythms may arise from the coupling of ultradian oscillators by showing that the secondary spectral peaks in drosophila locomotion, rather than being produced by independent oscillators, simply result from the non-sinusoidal shape of fruit fly activity. in the time domain, we determine the model exponential rate constants for wild-type and clock mutants of drosophila. these rates which vary widely in magnitude between  <dig>  and  <dig>  h− <dig>  with mean value of  <dig>  h− <dig>  are found to be independent of the pace of the circadian clock. guided by these results, we propose that the exponents might come from the accumulation and release rates of neuropeptides important in regulating activity and sleep in the fly brain. finally, we use the model to make quantitative predictions about candidate biological processes in general that could give rise to the rate constants and suggest future experiments to help identify the associated molecular substrates.

RESULTS
fruit fly activity was measured using the standard drosophila activity monitor . each fly is placed in an individual tube with food on one end and cotton on the other . an infrared beam crosses the tube in the middle in a perpendicular direction. when a fly interrupts the beam, the monitor receives a signal which is accumulated over time and sent to the computer every 20 s . power spectra for activity data were calculated using maximum entropy spectral analysis  and lomb–scargle periodogram  . spectra obtained by each method show the expected 24 h peak. additionally, there is a series of statistically significant peaks at smaller periods  with peak values from the two methods agreeing with each other to within 2 %. unlike mesa, the lomb–scargle periodogram has an easily computable significance metric, which allows one to distinguish between significant and insignificant periodicities in the power spectra. departing from the practice of filtering data prior to spectral analysis, we determine all power spectra directly from raw data. a number of past studies on ultradian rhythms adopted digital filtering as a standard procedure in their analyses . however, as we demonstrate in this work , application of digital filters can irrevocably modify statistical properties of a time series and can give rise to artifacts in its power spectrum.fig.  <dig> power spectrum of fly locomotor activity shows multiple peaks. a schematic representation of fly activity measurement. each time the enclosed fly crosses an ir beam, the computer receives a “1”. b activity of a single wild type fruit fly measured in constant darkness. subjective day/night time is shown in white/grey bars. c power spectrum of the fly activity. spectrum from  <dig> to 30 h is shown on top, dashed rectangle is enlarged in the lower panel. power spectra calculated with lomb–scargle  and maximum entropy spectral analysis  methods show the expected ~24 h circadian peak and additionally show a series of statistically significant peaks at lower t. dashed horizontal line represents statistical significance of  <dig>  for the lomb–scarge spectrum. peak positions detected by ls and mesa agree to within 2 %



figure 2a shows population averaged fly activity obtained from measurement of  <dig> flies in simulated light–dark conditions  for 5 days. drosophila daily activity has two distinguishable peaks. the morning peak  starts during the night and has a maximum when the light turns on and the evening peak  starts during the day and has a maximum when the light turns off. we constructed a model with a single fundamental period which reproduces these features of the activity. our model consists of four normalized exponential terms with rates bmd,bmr,bed,andber, with subscripts denoting morning decay , morning rise , evening decay  and evening rise :fig.  <dig> comparison of data  to the model . a average recording of  <dig> wild type flies measured in ld for 5 days; day/night shown with white/black bars. model consists of four exponential terms with rates bmd,bmr, ber, bed, and widths of morning and evening peaks given by tm and te. b autocorrelations of data and model with primary period 24 h. periods in signal are found from regularly appearing peaks with high correlation. peaks exceeding the dashed line
2/n, where n is number of data points in activity trace, represent strong correlations. strong  <dig> and 12 h periods are seen in both graphs. c lomb–scargle power spectra for the data and the model. model reproduces strong peaks as well as small side peaks , which are from the dirichlet kernel . parameters used for this simulation: bmd=- <dig> h- <dig> bmr= <dig> h- <dig> ber= <dig> h- <dig> bed= <dig> h- <dig> tm= <dig> h,te= <dig> h.


 f=ebmdtm-ebmdtebmdtm- <dig> <t<tmebmrt-tm-1ebmrt0-tm,tm<t<t01-e-bert-t02-te1-e-berte,t02-te<t<t02e-bedt-t <dig> t02<t<t <dig> 

in the proposed waveform, exponential terms with rates bmd and bmr form the m peak with width tm while terms with rates ber and bed form the e peak with width te . together, these four exponents create a wave with t0=24h. the fourier transform of f contains terms proportional to cos2πt0t and sin2πt0t, which produce peaks in the power spectra at harmonics of the primary period t <dig> . to estimate peak heights, we analytically calculated fourier transform only at harmonics tn=t0/n of the primary period. the analytic expression has multiple terms such as those containing cos2tmnπt <dig>  sin2tenπt <dig>  etmbmd, and eteber .

since a mathematical function that adequately reproduces fly locomotor data has been lacking, we tested different waveforms to simulate locomotion and interpret its power spectrum. in previous work, it was assumed that behavioral rhythms have the form of a square wave  <cit> . although a square wave with period t <dig> produces multiple spectral peaks , it is able to interpret only odd-numbered harmonics in spectral data and does not completely mimic fly activity. we also tested a sawtooth wave, which is able to interpret most spectral peaks, but does not describe with high fidelity the shape of drosophila locomotion data. fruit fly circadian behavior is controlled by the activity of clock neurons, which often have exponential patterns of activation and deactivation  <cit> . the underlying exponential kinetics and the observed shape of activity data motivated us to build a model that consists of exponential terms.

in order to find similarities between the model and data and to look for the main periodicities in data, we first calculated the autocorrelation function. autocorrelation with 1 min time lags was obtained by calculating the covariance of each time series with itself. the periods of the time series can be found from regularly appearing peaks of high correlation. even though both the model and the data have a primary period of 24 h, the autocorrelations show strong  <dig> and 12 h periodicities . the 12 h periodicity results from the 12 h time interval between m and e peaks. having obtained a basic level of similarity between data and model, we next analyzed them with the lomb–scargle periodogram to calculate a high-resolution power spectrum . similar to the actual fly recordings, the proposed waveform with the primary period of 24 h shows multiple peaks in the power spectrum at values between  <dig> and 24 h with the 12 h peak dominating. the 12 h periodicity is significantly increased by the externally imposed 12-h light/12-h dark cycle. the model power spectrum not only reproduces prominent peaks from the data, but also the smaller peaks that appear near the prominent peaks. these small peaks, whose number and position can be predicted from the dirichlet kernel, arise from the fact that we work with finite discrete data . for both the experiment and the simulation, the circadian peak is ~24 h.

we noticed that the majority of peaks that appear in the power spectra of wild-type flies measured in ld occur at multiples of the primary period t <dig>  to test if the secondary peaks result from the externally imposed light/dark cycle, we measured fly  locomotion in constant darkness  for 5–7 days. this analysis revealed that together with the 24 h peak reflecting the circadian clock, the power spectrum still has the same additional peaks that appear at multiples of t <dig> , suggesting that the additional periodicities in the power spectra of fly activity are simply harmonics of the endogenous circadian period t <dig> fig.  <dig> our model correctly predicts majority of peaks in power spectrum of fly locomotion. a power spectra of individual wild type and clock mutants of drosophila measured in constant darkness for 5–7 days. x-axis given as ratio t0/t, with the circadian period t <dig> indicated in each case. increasing values indicate shorter periods of oscillation. for each t <dig>  prominent secondary peaks are found at t0/t= <dig> ,… accompanied by lower power dirichlet kernel peaks. b comparison of peaks detected in the data to peaks predicted by the model was obtained by analyzing wt , per
s  and per
l  flies. only peaks higher than p= <dig>  were used in the analysis. y=x is shown as a solid line, 10 % deviation shown as dashed lines. for wild type and clock mutants more than 88 % of the data peaks for t = 2–35 h can be explained by the model with ± 10 % error. c power spectra of a wild type fly measured in ll and a per
 <dig> mutant measured in dd. neither spectrum shows peaks higher than p= <dig>  significance level . for both graphs t0= <dig>  h was used for scaling the abscissa



to further test our assumption that multiple spectral peaks of fly locomotion all result from the circadian clock, we used different circadian period mutants of drosophila melanogaster. we analyzed pers  and perl  flies, with average circadian periods of  <dig> and  <dig>  h , respectively, for the presence of secondary peaks in their power spectra. activity of both genotypes was measured in constant darkness for 7 days and analyzed with lomb–scargle periodogram. power spectra of the clock mutants show secondary peaks that, similar to wild-type, were found to be at multiples of the mutant t <dig> . almost all peaks in the power spectra of the different genotypes line up after rescaling the period axis with the circadian period. these results predict that elimination of the clock should abolish all rhythmicity in the power spectrum. we tested this prediction both by measuring circadian null mutants and by rendering wild-type flies arrhythmic by placing them in constant light . power spectra of per <dig>  and clkjrk  clock mutants that do not show circadian rhythmicity in constant darkness were determined from locomotor recordings of individual animals   <cit> . the majority of per <dig> flies  do not show statistically significant peaks at the p =  <dig>  level between  <dig> and 35 h in the power spectra. most clkjrk flies  also do not have circadian rhythms and almost all peaks seen in the power spectra of wild-type flies between  <dig> and 35 h are absent in the power spectra of these mutant flies . we also measured activity of yw  flies in ll and analyzed their power spectra . most flies  appear arrhythmic, showing no significant periodicities between  <dig> and 35 h. these results together provide strong support for the majority of spectral peaks resulting from the circadian clock producing a non-sinusoidal oscillation in fly behavior.

to test our model’s reliability, we compared peak positions in the power spectra for wild-type and shifted-period clock mutants of drosophila to peak positions in the power spectra of model with different primary periods . for each genotype we constructed a model with t <dig> matching the circadian period in the data, yielding harmonics at values t <dig> t <dig> …,t0n in the power spectra, which we then used to interpret peaks in the data. we used only peaks higher than the significance level of  <dig>  in order to exclude dirichlet kernel peaks from the analysis. for all three genotypes our simple model is able to identify more than 88 % of peaks in the data to within 10 % error .

we next determined the exponents bmd − bed for wild-type flies in dd and ld. in our model, these exponents define the shape of the m and e peaks. the model parameters were obtained from the power spectra of activity data . spectra were fitted with an analytical expression h obtained by calculating the square of the fourier transform of f. the square of the fourier transform yields peak heights h at harmonics tn of the primary period  . in dd data, t <dig> was determined from the peak at the circadian frequency. since the fitting procedure is sensitive to the initial choice of parameters, as an initial guess we used parameters from a preliminary fitting of activity data with the model. the exponents obtained from the fits shown in fig.  <dig> are bmd=- <dig> h- <dig>  bmr= <dig> h- <dig>  ber=- <dig> h- <dig>  and bed= <dig> h- <dig> for ld, and bmd= <dig> h- <dig>  bmr= <dig> h- <dig>  ber= <dig> h- <dig>  and bed= <dig> h- <dig> for dd. the analytical expression also produced good fits for the activity power spectra with the average peak height fit error of less than 10 %  . final values of the parameters determined from fitting the power spectrum were then used to construct a model for the activity recordings . for the measured wild-type flies, the constructed model shows good fit for locomotor activity with the average rate constant magnitude ~ <dig>  ± 2 h− <dig> . the parameters bmd and ber obtained from fitting data can be either positive or negative, which means that the exponential terms with bmd and ber in f can be either concave or convex. interestingly, we find that the parameters bmr and bed are always greater than  <dig> and therefore corresponding terms are always concave. it should be noted here that our model does not impose any restrictions on the numerical values of the parameters.fig.  <dig> model parameters are obtained by fitting the power spectrum. a examples of data power spectrum  and fit  for a wild type fly measured in ld  and dd . in the ld data, the 12 h peak is stronger than the 24 h peak and was therefore used as the reference peak in the fit. comparison of model and data power spectra for low t shown in the inset. for low values of the period, the model predicts peak height h∝t <dig> , a behavior not shown by the data. b errors in peak height estimation from  <dig> flies . on average, peak heights are estimated with error of 10 %  or better. c parameters obtained from a are used to construct model of fly activity. data  shown in 20 min bins; day/night shown with white/black bars for ld and subjective day/night shown with white/grey bars for dd



while the predictive power of the model is reliable for t>2h, for t<2h our model strongly deviates from data . the calculated model peak heights h predict that for period values less than 2π/b, where b is the largest exponent, typically bmd or ber, the peak heights are proportional to t <dig> . however, the data show weak sensitivity to t in this regime. there are a few factors that can affect the power spectrum of fruit fly activity at low period values. the first factor is that the locomotion measurement reports fly movement only when it crosses the middle of the tube. this lack of spatial resolution causes the system to miss small-scale movements which happen without the fly crossing the beam. a second factor is the nyquist frequency. in any measurement the nyquist frequency is equal to half of the sampling frequency and imposes a lower limit on the periods one can search for in a given time series. thus, limitations imposed by both the measurement method and by the nyquist frequency likely result in detectable discrepancies between the data and the model for low t. for these reasons, all our model-based predictions are restricted to t > 2 h.

in order to understand what factors affect the model parameters, we determined their values for different clock mutants and tested for their relation to the circadian period t <dig>  wild-type, pers, and perl animals introduced above together with timul flies  with average t0 ~ 27 h were used in these analyses . given our mathematical description of fly activity, we hypothesized two possibilities: one, in which the rate constants do not vary but tm and te adjust with t <dig> and another, in which both sets of parameters change with t <dig>  interestingly, the data show that the rate constants bmd, bmr, ber, bed do not depend strongly on t <dig> , whereas the parameters tm and te that determine width of the morning and evening peaks, increase with t <dig> . assuming the measured parameters represent characteristics of underlying biological processes, the robustness of the rate constants suggests that the pace of the clock likely does not alter the kinetics of these processes. on the contrary, tight association between tm and te and clock speed suggests that the clock may regulate when these processes are initiated and terminated. the rate constants typically range between ±5 h− <dig> for bmd and ber, and between  <dig> and  <dig>  h− <dig> for bmr and bed, with average bmd¯= <dig> ± <dig> h- <dig>  bmr¯= <dig> ± <dig> h- <dig>  ber¯= <dig> ± <dig> h- <dig>  bed¯= <dig> ± <dig> h- <dig> . the mean ± standard deviation of the magnitude of the four rate constants from all flies tested in constant darkness is  <dig> ± <dig> h- <dig>  lastly, linear fits of the tme versus t <dig> data reveal tm≈ <dig> t <dig> and te≈ <dig> t <dig>  .fig.  <dig> analysis reveals quantitative relations between model parameters and circadian period. a parameters extracted from fitting locomotor data of wild type , per
s , per
l  and tim
ul  flies measured in constant darkness for 5–7 days. plotted parameter is indicated in the adjacent box for each graph, with curvatures shown for bmd,bmr,ber,bed> <dig>  the data show that the exponential rate constants are independent of t <dig>  while parameters tm and te grow roughly linearly with t <dig>  dashed lines are visual guides  or linear fits . b sketch of two locomotor patterns where the red locomotion is driven by a faster clock . if increase in t <dig> results in lengthening of activity peak widths from tm,short to tm,long without altering the exponential rates, our model predicts that the activity amplitude must also increase from hshort to hlong. the first m peaks are shown to overlap to emphasize constancy of the exponential rates. the red sketched activity has been vertically shifted for visual clarity. c data from flies in a demonstrate a positive correlation between average activity amplitude h and the circadian period t <dig>  dashed line is a linear fit to the data giving h≈ <dig> t0




based on the observed independence of the b parameters and the linear dependence of the tm parameters on the circadian period, we argued using the model that the average amplitude of daily activity must also increase with t <dig> . to test this prediction, we measured for each fly an activity amplitude, h, by averaging m and e peak heights in each recording. a plot of h vs. t <dig> shows that amplitude of activity indeed increases with lengthening of the circadian period . the form of our model function f suggests that h and t <dig> can be related according to h=c, which in the linear approximation becomes h≈ct <dig>  with c, k and c as fit parameters. due to the large scatter in our data, the simpler linear expression is statistically favored over the exponential function, yielding h≈ <dig> t <dig> . the surprisingly good agreement between the data and the prediction of our simple model further validates the mathematical description of fly locomotion pattern proposed in this work.

discussion
while a large number of studies have exploited rhythmic patterns in fruit fly activity to query the status of the circadian clock, the broader question of what principal endogenous systems other than the clock shape these patterns, remain poorly understood. here we attempt to fill this gap by formulating a simple mathematical model that accommodates the diverse locomotion patterns exhibited by drosophila over the time-scale of multiple days. the model has two major components: an oscillatory component characterized by a single period and an exponential component defined by four rate constants. we show that these components are together sufficient to explain prominent features in both the power spectra and the time series of fly locomotor recordings. using the model, we show that the position and height of over 88 % of locomotor spectral peaks can be accounted for as harmonics of circadian rhythms. we use this finding as evidence to support the view that in flies daily locomotor rhythms receive negligible input from endogenous ultradian clocks. using the proposed model, we additionally extract values of the exponential rate constants in a variety of flies. we propose that these rate constants could represent kinetics of neurobiological processes that, such as the secretion of neuropeptides, have been implicated in modulating behavior. we suggest our data and model-based predictions open up fly behavioral recordings to more rigorous analysis.

ultradian and circadian clocks are known to co-exist in animals but the extent of interactions among the two classes of endogenous oscillators is still unresolved. previous work on this issue outlines three possible relationships between circadian and ultradian rhythms: i) a circadian rhythm is produced by the coupling of ultradian oscillators, and ultradian peaks seen in power spectra are components that break down from the circadian clock ; ii) ultradian and circadian oscillators exist independently in the organism  <cit> ; and iii) ultradian rhythms come from the desynchronization of a population of circadian oscillators  <cit> . using our model we can address the first two hypotheses. we have shown that multiple periodicities in power spectra result from a non-sinusoidal shape of drosophila locomotion and appear at harmonics of the circadian rhythm . since nearly all peaks in our fly power spectra come from circadian rhythms , we suggest the first hypothesis, which states that circadian rhythms result from the coupling of ultradian oscillators, is unlikely. the assumption of the second hypothesis, that circadian and ultradian oscillators coexist, is possible; however we have shown that more than 88 % of peaks that stably appear between  <dig> and 35 h in the power spectra of fly locomotion result from the circadian clock. our attempts to detect intermittent ultradian activity revealed such behavior in <5 % of the total recording time . these results therefore indicate that there are no robust ultradian oscillators with periods in this range detectable in fly activity. our data are at odds with claims made by several previous examinations of locomotion . the previous studies missed the harmonics likely due to a combination of disregarding the non-sinusoidal pattern of the raw time series, the inappropriate use of digital filters and the lack of proper statistical metrics. our data, together with bona fide ultradian periodicities discussed in other behavioral contexts such as male courtship song  <cit>  or calcium oscillations in neurons  <cit> , suggest that second hypothesis is most likely, and that there is minimal cross-talk between the two types of oscillators, at least at the level of behavioral output. in brief, our results contradict the previously espoused role of multiple ultradian oscillators shaping locomotion. instead, the data support a parsimonious model in which a single circadian oscillator regulates all rhythmic modulations of fly locomotion.

data on ultradian rhythms reported in locomotion of mammals can also be considered in relation to the circadian clock. studies that addressed this question in siberian hamsters and common voles concluded that the ultradian rhythms are generated independently of the circadian clock  <cit> . autonomy of mammalian ultradian rhythms was further affirmed by a recent work in mice that identified dopamine as a major regulator of and, possibly, the source of these ~4 h oscillations  <cit> . these previous data from mammals raises the question of why drosophila locomotion does not exhibit robust ultradian oscillations. our model, which incorporates only circadian rhythms, reliably predicts spectral peak heights and positions in rhythmic flies of different genotypes and genetic backgrounds and shows an absence of rhythms in circadian arrhythmic animals. compared to mammals, the fly data suggest that if there is an ultradian signal that feeds into locomotion, it is either much weaker or has a period ≪2 h where our model does not strictly apply.

beyond addressing the rhythmic component of locomotion, our model also captures the general temporal shape of fly locomotion. despite widespread use of these time series in fly circadian studies, to our knowledge, proposed f is the first description of the multi-day data in mathematical terms. in our mathematical model, the various shapes of these time series are quantified in terms of four exponential rate constants, bmd-bed, that control the slopes around the morning and evening activity peaks and the parameters tm-te, that control the widths of these peaks. although one may assume that all model parameters should scale with the circadian period, our measurements reveal that while tm and te increase with the circadian period, the exponents bmd,bmr,ber, and bed intriguingly do not . independence of the rates from the circadian period indicates that mutations in per and tim do not affect the rate constants bmd-bed, suggesting that the rate constants possibly represent clock-autonomous biological processes. this observation together with available biochemical data, leads us to hypothesize that the rate constants could represent processes like accumulation, release or degradation of neuropeptides, particularly those that are involved in the clock neuronal network. neuropeptides pigment dispersing factor , ion transport peptide  and neuropeptide f  modify m and e clock neurons and influence locomotor patterns  <cit> . the abundance of these neuropeptides, in turn, are modulated by the clock  <cit> . but their rates of accumulation in neurons, subsequent secretion, and degradation are presumably controlled by cell-biological machinery whose rate-limiting steps are set independently of the circadian program  <cit> . therefore, we propose the b rate constants could represent average measures of some of these kinetic steps. specifically, since pdf controls morning anticipation, which in our model is shaped by bmd and bmr, we suggest these parameters may reflect kinetic steps related to pdf  <cit> . similarly, because itp reduces nocturnal activity and enhances diurnal evening activity, its kinetics may contribute to exponents ber and bed which form the e peak in our model  <cit> . regarding temporal modulation of the levels of the neuropeptides, our model suggests that it likely results from the clock periodically initiating and terminating the key kinetic steps. in circadian rhythms, neuropeptide activity has so far been accessible largely through biochemical assays. our analysis using f may have established a potential link to the relevant neuropeptide kinetics through the behavioral rhythms that these neuropeptides are thought to modulate.

alternatively, the model exponents could represent signals that feed into locomotor circuits from other endogenous systems such as those controlling fly sleep–wake states. daily temporal patterns in sleep and activity in flies, like in mammals, are coordinated with major inputs from the circadian clock and the sleep homeostat  <cit> . studies on human sleep patterns, in particular, have led to a model in which the sleep homeostat output is described as an exponentially varying signal  <cit> . in this model, the varying signal is the sleep electroencephalogram  power density that exponentially increases during daytime wakefulness and diminishes during nighttime sleep, producing a singular peak in the signal in the early evening. the average rate constants associated with the increase and decrease of eeg power are ~ <dig>  and ~ <dig>  h− <dig>  respectively. interestingly, these are well within the range of values we find for the b parameters. although output of the fly sleep homeostat has yet to be defined, it is reasonable to assume that its architecture may resemble that of the human homeostat given the substantial mechanistic overlap already uncovered between fly and human sleep  <cit> . together, these similarities are consistent with a hypothesis in which the rate constants extracted from fly locomotion could be representative of the fly sleep homeostat.

our mathematical model also permits a number of general predictions to be made about candidate neurobiological processes that may underlie our model parameters . first, we propose that the candidate process can be described, for simplicity, in terms of linear or exponential growth-decay kinetics. second, the processes are presumably sporadic when averaged over many neurons. their random nature would imply they have noisy power spectra  and considering the processes are key modulators of behavior, their average stochastic nature should result in arrhythmic behavior in the absence of the circadian clock . third, we suggest that the underlying processes have kinetics on the time-scale of tens of minutes. this constraint is based on the magnitude of the model rate constants, which are ~ <dig>  h− <dig> on average, suggesting that the processes they represent persist for ~40 min. at the molecular level, this is a long time-scale and suggests that neurotransmitter activity or electrical pulses, which also have exponential kinetics but act on the time-scale of seconds or less, are unlikely to be direct contributors to the exponents in f. however, neuropeptide half-life in the brain and accumulation in synaptic boutons happen over span of ~30 min, making these substrates attractive candidates in our model  <cit> . lastly, we suggest that on the time-scale of hours the circadian clock is likely the sole pacemaker  to temporally gate the relevant neurobiological processes. the circadian gating imposes rhythm on otherwise stochastic processes and when integrated with additional downstream signals, ultimately produces rhythmic patterns in locomotion . related to the circadian gating are two additional features that the hypothetical processes might display . we suggest that changes in the period of the clock may cause not only parallel changes in the rhythm of the processes but, importantly, also changes in the amplitude of their oscillation. for instance, if bmd and bmr are indeed related to pdf activity, our model predicts that compared to perl animals, in pers animals both the period and the peak–peak amplitude of pdf oscillation is smaller. this prediction is based on our assumption that such changes in the amplitude of the underlying processes likely causes the correlation observed in our data between the average locomotor amplitude and the circadian period, which is predicted surprisingly well by our model . together, these characterizations should facilitate experimental identification of the key neurobiological processes that our model parameters represent.fig.  <dig> our results make quantitative predictions about biochemical signals that may shape fly locomotor patterns. a cartoon showing circadian genes and their products oscillate in a sinusoidal fashion  and produce a power spectrum with a single peak . we propose that efferent signal from the clock impinges on exponential processes that turn on/off stochastically in time. an example may be neuromodulator accumulation and release . without circadian regulation, the exponential process should result in noisy power spectra . integration of the sinusoidal with the exponential processes together with other signals  result in the observed shape of fly locomotion . the resulting time series has multiple peaks in power spectrum by virtue of its non-sinusoidal shape . b we suggest that the exponential processes that may underlie the observed shape in locomotion are temporally gated by the circadian clock. if so, then changing rhythm of the clock should cause corresponding changes both in the oscillatory period and the peak–peak amplitude of the gated signal. shortening period of the clock  predicts speeding up of the periodic exponential process and decrease of its amplitude of oscillation . in these cartoons, it is assumed that the rate at which the exponential process occurs, for instance, the rate of neuromodulator release, is not affected by the circadian clock speed. to underscore the constant rate, the first decay phase of the fast and slow exponential waves are overlaid



CONCLUSIONS
in summary, this work initiates a more mathematical dissection than is currently available of the temporal shape of fly locomotor recordings. we point out that such analysis can lead to experimentally verifiable predictions of what major biological processes regulate daily manifestations of behavior. as examples of such candidates, we propose accumulation and degradation of neuropeptides implicated in controlling sleep-activity in flies and suggest these kinetic steps are gated principally by the circadian clock. critically, our mathematical model now opens up the recordings to quantitative scrutiny towards clearer mechanistic understanding of daily rhythmic behaviors in drosophila and other organisms.

