BACKGROUND
microarray is an experimental method by which tens of thousands of genes can be printed on a small chip and their expression can be measured simultaneously  <cit> . since the microarray technology was introduced, it has been widely used in many biomedical studies  <cit> . microarrays can be used to measure expression for tens of thousands of genes at the mrna level for samples in normal and disease groups, and then statistical methods for two-sample comparison can be used to identify differentially expressed genes. differentially expressed genes are potential disease related genes for clinical diagnoses and medical treatments. this approach has been successfully used in cancer studies  <cit>  as well as diabetes studies  <cit> .

although microarray technology has been developed for more than a decade, the experiment cost is still considerably expensive. this limits the sample size of microarray studies. therefore, the detection power can be low, especially when the signal of differential expression is relatively weak  <cit> . many microarray data sets have been collected for the same or similar research purpose. detecting genes with concordant behavior among different data sets is of biological interest. it is also of statistical interest to improve the detection power if it is feasible to integrate different data sets in differential expression analysis. for this reason, several methods have been proposed for data integration  <cit> .

however, the genome-wide concordance of different data sets has not been well considered in these integrative analyses. a gene selected for the follow-up analysis should behave concordantly in different data sets. for example, if a gene is up-regulated in one experiment, then it should also be up-regulated in another experiment. slight inconsistency should be expected since there are considerable noises generated by microarray experiments. if two data sets are genome-wide concordant, then integrating them can generally improve the sample size and reduce the noise impact. therefore, it is desirable to combine observations of concordant genes since we expect to achieve a more powerful detection of differential expression. however, if two data sets are not genome-wide concordant, then there are genes with discordant behavior in different data sets. there are many possible factors for such observations, such as population heterogeneity, probe binding issues from different microarray platforms, as well as lab-specific system noises. therefore, integrating observations of discordant genes may result in misleading conclusions and should be discouraged.

when a seemingly discordant behavior is observed for a gene, it is difficult to tell whether the observation is generated by random noises or the observation reflects the underlying truth. therefore, it is not trivial to determine whether a gene has a concordant/discordant behavior in different experiments. the analysis will be more complicated for evaluating genome-wide concordance. cahan et al.  <cit>  have studied different gene lists identified from different data sets. ein-dor et al.  <cit>  have showed that we may need to collect thousands of samples to generate a robust gene list for disease prediction. miron et al.  <cit>  have proposed a correlation based approach for measuring concordance between two lists of test statistics from two data sets. however, this approach does not consider the fact that different genes in a data set belong to different components . we have recently proposed a mixture-model based method for testing genome-wide concordance and discordance  <cit> . this approach considers the mixture of different gene components as well as the independence between two data sets, and it can be extended for data integration. in this study, we propose a mixture-model based statistical framework to achieve a rigorous integrative analysis of differential expression.

in a recent study  <cit> , it has been shown that the widely used overlap count  is not an appropriate metric for measuring the reproducibility of differential expression analysis. it is necessary to develop new metrics for rigorously measuring the reproducibility of differential expression analysis. the disadvantage of overlap count metric is that the randomness of differential expression measures  has not been well considered. however, our mixture-model based tests of genome-wide concordance and discordance  <cit>  take this randomness into account and the reported p-values can be used as rigorous metrics for measuring the reproducibility of differential expression analysis.

for the rest of paper, we first introduce our statistical framework. then, we use simulated data to evaluate its performance. two experimental data based case studies are considered as the applications. finally, we discuss the advantages and disadvantages of our method.

methods
a statistical framework
 <dig>  in each data set, perform a statistical test of differential expression for each gene to obtain a lists of test scores;

 <dig>  for each list of test scores, perform a transformation procedure to obtain a list of z-scores;

 <dig>  for two lists of z-scores, test the complete discordance between them;

 if the complete discordance cannot be rejected, then the data integration will be discouraged;

 if the complete discordance can be rejected, then continue to the next step;

 <dig>  for two lists of z-scores, test the complete concordance between them;

 if the complete concordance cannot be rejected, then calculate a list of concordant integrative scores based on the complete concordance  model;

 if the complete concordance can be rejected, then calculate a list of concordant integrative scores based on the partial concordance/discordance  model;

 <dig>  use the list of concordant integrative scores to prioritize genes for the follow-up study.

test of differential expression
for simplicity, we consider the student's two-sample t-test for differential expression analysis. other test statistics, such as wilcoxon's rank sum test or a generalized t/f-statistic  <cit> , can certainly be considered. the statistical significance  of a test value can be evaluated based on either its theoretical null distribution or a permutation null distribution  <cit> . in this study, the theoretical p-value is used for the simulation study since we know the underlying distribution; the permutation p-value is used for the application since the underlying distribution is unknown .

transformation of test score
it has been suggested transforming a test value to its associated z-score so that more efficient results can be achieved in a normal mixture model based analysis  <cit> . when the one-sided  p-value of a test value is available, the associated z-score can be simply calculated by

 z = Φ- <dig>  

where Φ- <dig> is the inverse of standard normal distribution. notice that it is necessary to use one-sided p-values since we intend to distinguish up-regulated differential expression from down-regulated differential expression.

mixture models
we have proposed several mixture models  <cit>  to evaluate the genome-wide concordance/discordance between two lists of z-scores: { : k =  <dig>   <dig>  ..., m}, where m is the number of common genes in both data sets. a general mixture model can be used to represent the case of partial concordance/discordance :

 fpcd=∑i=02∑j=02πijϕμi,σi2ϕνj,τj <dig>  

this model can be reduced to a complete concordance  model:

 fcc=∑i=02πiiϕμi,σi2ϕνi,τi <dig>  

and a complete discordance  model:

 fcd=. 

more details for these models have been described in our recent publication  <cit> . in these models, index  <dig> is used to represent the null component with fixed parameters: μ <dig> = ν <dig> =  <dig> and σ02=τ02=1; indices  <dig> and  <dig> are used to represent the down-regulated and up-regulated components with constrains: μ <dig>  ν <dig> ≤  <dig> and μ <dig>  ν <dig> ≥ 0; πij is the proportion of genes belonging to the i-th component in the first data set and j-th component in the second data set . πi. is the marginal proportion of genes belonging to the i-th component in the first data set; and π.j is the marginal proportion of genes belonging to the j-th component in the second data set. the model parameters can be estimated through an e-m algorithm  <cit> . the detail has also been described in our recent publication  <cit> .

tests of concordance and discordance
based on the assumption of independence among the list of z-scores, we can calculate the mixture model based likelihoods:

 lpcd=∏k=1mfpcd; 

 lcc=∏k=1mfcc; 

 lcd=∏k=1mfcd. 

with these likelihoods, we can test pcd  against cc  or cd  by the following likelihood ratio tests in the logarithm scale:

 tcc=log⁡=log⁡−log⁡;tcd=log⁡=log⁡−log⁡. 

the statistical significance of a test value can be evaluated by the parametric bootstrap procedure  <cit> , which has also been described in our recent publication  <cit> .

data integration
if the complete discordance  cannot be rejected, then the data integration will be discouraged to avoid misleading results. if cd can be rejected, then either the complete concordance  or the partial concordance/discordance  will be established. although cc is a special case of pcd, it is still statistically necessary to test pcd against cc. if cc cannot be rejected, then we expect to achieve a more efficient data integration by reducing the number of parameters. under cc or pcd, it is feasible to consider the data integration. to prioritizing genes, we can consider a concordant integrative score, which is the conditional probability of concordantly differential expression under an appropriate mixture model: /p. under the cc model, it is calculated as:

 scc=∑i=12π^iiϕμ^i,σ^i2ϕν^i,τ^i2∑i=02π^iiϕμ^i,σ^i2ϕν^i,τ^i2; 

under the pcd model, it is calculated as:

 spcd=∑i=12π^iiϕμ^i,σ^i2ϕν^i,τ^i2∑i=02∑j=02π^ijϕμ^i,σ^i2ϕν^j,τ^j <dig>  

false positive control
the mixture model provides a rigorous convenience to estimate the number of false positives in a theoretical manner. notice that the above concordant integrative score is actually a probability of true positive. therefore, if we are interested in the top k genes {x, x, ..., x} ranked by the concordant integrative score, then the associated number of false positives can be estimated as:

 fp^=k−∑k=1ks,z <dig> ), 

where s is calculated based on an appropriate mixture model . with this estimate, one may realize that the false discovery rate  <cit>   based on the q-value concept  <cit>  can be simply estimated as fp^/k.

for an individual data set, we simply use the r-package qvalue  <cit>  to obtain the estimated fdr. then, the number of false positives for the top k genes can be simple estimated as k × fdr, which is theoretically consistent with the above fp^.

RESULTS
illustrative examples
a simulation study
there are many parameters to be considered when we simulate microarray gene expression data:

• gene size m;

• the proportion of non-differentially expressed genes π0;

• sample sizes of two groups n <dig>  n2;

• distributions of expression measurements of differentially and non-differentially expressed genes;

• covariance structure among genes.

in our simulation studies, we consider the widely used block structure: genes are partitioned into many blocks; genes within the same block are positively dependent; and different blocks are independent. to save the computing time, we reasonably set gene size m =  <dig>  π <dig> = 80% and n <dig> = n <dig> =  <dig> for each of two data sets. the block size  is set b =  <dig>  within each block, the expression measurements are simulated from a multivariate normal distribution. for blocks of non-differentially expressed genes, we simulate expression measurements from n, where μ^ <dig> is a b ×  <dig> vector of 0's and Σ <dig> is a b × b matrix with diagonal entries as  <dig> and non-diagonal entries as a fixed value . for blocks of differentially expressed genes, we simulate expression measurements from n and n for the first and the second sample groups, respectively. μ^ <dig> is simply a b ×  <dig> vector of 0's. to simulate μ^ <dig>  we first simulate b ×  <dig> vector of random numbers from a beta distribution beta, multiply this vector by a factor r =  <dig> , and then multiply randomly simulated signs  so that both up and down regulated differential expression can be generated. Σ <dig> and Σ <dig> are similarly generated as Σ <dig>  two data sets are first simulated based on the same configuration. to simulate genes with discordant behavior, we randomly reallocate ξ = 0%, 15%, 30%, 45%, 60% and 75% genes in the second data set so that these genes are no longer matched with those in the first data set. notice that the simulation configuration is not completely consistent with what have been assumed for our method. this is intentionally designed to understand the robustness of our method. the complete concordance or the complete discordant will be rejected at the level p-value <  <dig>  since there is a issue of multiple hypothesis testing. to save computing time, we only perform the parametric bootstrap for  <dig> times to evaluate the p-value of a test.

for each round of simulation, since we know the truth , we can use the curve of number of concordantly differentially expressed genes  against number of claimed ones  to evaluate the performance of our method. after many  rounds of simulations , we can take the average to obtain a smooth mean curve. since the existing data integration methods  <cit>  do not consider the issue of genome-wide concordance/discordance, they are not included for comparison in this study. however, we have compared our method with the simple pooling approach: observations of the same gene from two data sets are simply combined for each sample group, and the t-test is applied to each gene in the pooled data set. this approach is feasible since the measurements in two simulated data sets are comparable. 

applications
a case study of partial concordance/discordance
since nod mouse spontaneously develops type  <dig> diabetes, it has been widely used for studying the disease. based on a time course microarray study using samples collected from  <dig> weeks to  <dig> weeks, week  <dig> is a key checkpoint for the development of type  <dig> diabetes  <cit> . to distinguish the genes related to diabetes development from the genes related to aging, two other data sets have also been collected for two congenic strains: nod.idd3/idd <dig> and nod.b10sn-h <dig>  which do not spontaneously develop diabetes. samples have been collected at different time points from  <dig> weeks to  <dig> weeks  <cit> . although these two strains do not spontaneously develop type  <dig> diabetes, it is still interesting to understand their differential expression before  <dig> weeks vs. after  <dig> weeks. furthermore, understanding genes with concordant/discordant behavior for these two strains is important. therefore, the data set collected for each congenic strain is partitioned into two sample groups: for strain nod.idd3/idd <dig>  there are  <dig> and  <dig> subjects collected before  <dig> weeks and after  <dig> weeks, respectively; for strain nod.b10sn-h <dig>  there are  <dig> and  <dig> subjects collected before  <dig> weeks and after  <dig> weeks, respectively. measurements for  <dig>  genes have been collected based on a cdna microarray platform.

figures 4a and 4b show the scatter-plot for the paired p-values  and z-scores of  <dig>  genes based on these two data sets. it is difficult to evaluate the genome-wide concordance/discordance based on the scatter-plot of paired p-values . from the scatter-plot of paired z-scores , the genome-wide concordance seems quite satisfactory. however, based on  <dig> parametric bootstraps , the tests of complete concordance  and complete discordance  are both significant . therefore, both cc and cd models are rejected and the partial concordance model  should be used in the analysis. this is not surprising since certain genetic and biological differences are expected from these two similar strains. table  <dig> gives the pcd model estimates. there are still about 75% genes with concordant behavior. the level of darkness in figure 4b represents the level of being concordantly differentially expressed that is evaluated by the concordant integrative score based on the pcd model .

a case study of complete concordance
in practice, we may collect gene expression data for the same study from different laboratories based on different microarray platforms. these data usually cannot be directly combined for an analysis with a larger sample size. our method can also be used to solve this problem. although this situation has been discussed in our simulation study, it is still necessary to illustrate it with experimental data. here, we generate a case of complete concordance based on an experimental data set. the data set was collected for a prostate cancer study  <cit> . genome-wide expression profiles for  <dig> genes  have been measured for  <dig> normal and  <dig> cancerous subjects. we randomly split this data set into two subsets with equal sample sizes .

figures 5a and 5b show the scatter-plot for the paired p-values  and z-scores of  <dig>  genes based on these two subsets. they are highly genome-wide concordant. this is consistent with our expectation. based on  <dig> parametric bootstraps , the complete discordance is rejected  but the complete concordance cannot be rejected . table  <dig> gives the cc model estimates. the estimates of mean and variance parameters in two subsets are consistent. the level of darkness in figure 5b represents the level of being concordantly differentially expressed that is evaluated by the concordant integrative score based on the cc model .

CONCLUSIONS
in this study, we have proposed a statistical framework for integrating two microarray gene expression data sets in differential expression analysis. our simulation and application results confirm that it is necessary to evaluate the genome-wide concordance before the consideration of data integration. otherwise, misleading results can be generated from the integrative analysis. our current study focuses on the integration of two data sets with two-sample groups. in our future study, we will generalize our method for multiple data sets. however, it is less straightforward to generalize our method for multi-sample groups since it is difficult to define the concordance/discordance for multiple groups.

because of the randomness of data, we can always observe some intersection of genes selected from two data sets if the selection criterion is not stringent. this is the case even when two data sets are completed unrelated.  therefore, the genome-wide concordance/discordance is a critical issue in the integrative analysis microarray data. the traditional hyper-geometric analysis relies on the criterion of gene selection, which can be quite arbitrary in practice. for example, the results based on the threshold of 5%, 10% or 20% false discovery rates can be considerably different. it is not a rigorous approach to address the genome-wide concordance/discordance. in a recent study  <cit> , it has also been shown that the widely used overlap count  is not an appropriate metric for measuring the reproducibility of differential expression analysis. furthermore, it is not clear how to rank genes efficiently in the intersection of genes selected from two data sets.

to our knowledge, there is no other existing methods for evaluating genome-wide concordance/discordance before the consideration of data integration. our mixture model based approach is simple and intuitive. there are usually  <dig> major gene groups in a data set: up-regulated, down-regulated and null genes, which correspond to the three components in our model. the model inference is well-developed in the field of statistics. furthermore, our model allows us to provide rigorous ranks for genes analyzed in two data sets. in our simulation study, our method can still provide a comparable performance in the situation of complete genome-wide concordance when the ideal pooling approach is feasible. if two data sets are not completely concordant, then our method will provide a better performance.

our method has several advantages. it allows us to test genome-wide concordance/discordance, which is a critical issue before the data integration can be considered. it is a likelihood-based approach, which is efficient when the underlying model is not seriously mis-specified. we have also showed the robustness of our method through a simulation study when the underlying models are somewhat inconsistent. furthermore, the data integration is achieved through a rigorously defined probability with close formulas.

our method also has the following disadvantages. it is difficult to validate the assumed mixture model. however, without this assumption, we currently have no effect approach for evaluating genome-wide concordance/discordance. furthermore, the calculation of likelihood assumes that the test scores from different genes are independent. however, it is well-known that the covariance structure of a microarray gene expression data set can be complicated. in our future study, we will explore more efficient approaches to overcome these disadvantages.

competing interests
the authors declare that they have no competing interests.

authors' contributions
y lai conceived of the study, developed the methods, performed the statistical analysis, and drafted the manuscript; se eckenrode carried out the microarray experiments; j-x she designed the microarray experiments and helped to draft the manuscript. all authors read and approved the final manuscript.

