BACKGROUND
population structure analysis is important to genetic association studies  <cit>  and evolutionary investigations  <cit> . many statistical methods have been proposed to infer population structure and to assign individuals to ethnically similar clusters using multilocus genotype data, among which there are two major categories: parametric and non-parametric approaches.

parametric approaches usually need to estimate population parameters such as allele frequencies and genotype frequencies and calculate likelihood, assuming hardy-weinberg equilibrium  and linkage equilibrium  among loci for each population  <cit> . two representative programs for parametric approaches are: structure, a bayesian method which uses a markov chain monte carlo  algorithm based on the gibbs sampler algorithm  <cit> , and l-pop, a frequentist method which uses the expectation-maximization  algorithm  <cit> . in the extended version of structure , the program can account for loose linkage between loci, but not high background linkage disequilibrium   <cit> . high background ld increases the chance of spurious clusters  <cit> . there are many other parametric bayesian methods  <cit>  and frequentist methods  <cit> , which require similar or more complicated model assumptions. two major challenges for the parametric approaches are the accuracy of allele frequencies estimates with small sample sizes, and the model assumptions that may not hold for some data sets. moreover, assumptions of le or loosely linked loci put a restriction on the number of genome-wide snp loci that can be used.

in contrast to parametric approaches, non-parametric approaches do not rely on model assumptions about the properties of the sub-populations, nor do they require allele frequency estimates. in situations where parametric model assumptions can not be verified, or there is only a limited number of individuals from a single sub-population, non-parametric methods are more powerful for inference. however, when the model assumptions do hold and allele frequencies can be accurately estimated, then parametric methods provide more information. thus, the two approaches are complementary in that one method is stronger where the other is weaker.

as stated by liu and zhao  <cit> , non-parametric methods use a two-stage design. they start by calculating pair-wise distances  <cit> , or some other form of dimension reduction, e.g. singular value decomposition   <cit> , and then rely on statistical clustering methods, e.g. neighbor joining   <cit> , k-means method  <cit> , principal coordinates analysis   <cit>  or multidimensional scaling   <cit> , to separate individuals. recently, gao and starmer proposed a non-parametric method for population structure analysis and showed its advantages when genome-wide snps are available  <cit> . liu and zhao also proposed a non-parametric approach  <cit> , but it requires missing genotypes be imputed explicitly and the software is not widely available. in recent publications, researchers tend to use both parametric and non-parametric approaches in their reports  <cit> .

since its publication in  <dig>  the freely available program structure has become quite popular and dominated population structure analysis, while the non-parametric methods have not received much attention. however, with the vast amount of genotype data available, non-parametric approaches may be preferred because of their robustness to model assumptions and fast calculation. recently, it was shown in an empirical study that non-parametric methods can give accurate results in fine-scale population structure detection and even separated chinese and japanese individuals using genome-wide random snps  <cit> . the separation of chinese and japanese individuals was also observed by purcell et al. using mds  <cit> .

r is a convenient fast growing statistical computing environment with considerable popularity in the research community. it is freely available on a wide range of platforms, comes with implementations of many standard statistical methods, and can be easily extended through packages. we borrowed the strength of r and developed an add-on package that specifically focused on non-parametric population structure analysis. the motivation behind the package is to make recent developments in non-parametric population structure analysis available to researchers with an easy to use and intuitive graphical interface.

implementation
we have developed point-and-click software for non-parametric population structure exploration. the program was written in r and tk and can be installed as an r package. the package is named awclust . the major modules enclosed are: allele sharing distance  calculation, mds 2d plot, mds 3d plot, hierarchical plot by ward's minimum variance algorithm, gap statistic calculation for inferring the optimal number of clusters and saving the clustered results.

RESULTS
we automated the non-parametric population structure analysis procedures and packed all the routine steps in an intuitive graphical interface. the software can save researchers' time in data exploration. the outputs from awclust are ready for publication and further analysis. it is distributed as r installation packages available for all popular operating systems: ms windows, mac os x and linux/unix. the software comes with two example data sets, is fully documented, and includes a tutorial to help users become familiar with how to use it.

after installing and loading the awclust package, users are presented with a gui interface . to experiment with the program, users can load one of the two sample data sets: hapmap <dig> or perlegen <dig>  the hapmap <dig> dataset contains  <dig> genome-wide random snps from  <dig> unrelated individuals from the hapmap project, specifically  <dig> yoruba from ibadan, nigeria ,  <dig> ceph utah residents with ancestry from northern and western europe ,  <dig> han chinese from beijing, china , and  <dig> japanese from tokyo, japan . the perlegen <dig> dataset contains  <dig> genome-wide random snps from  <dig> unrelated individuals from the perlegen project, including  <dig> african americans ,  <dig> european americans  and  <dig> han chinese . in each dataset, the snp information is encoded as numeric values  to represent the number of variant snp alleles in genotypes, and - <dig> is used to represent missing values.

after loading a snp data set, the next step is to calculate the allele sharing distance  matrix. once this is done the user can perform non-parametric exploration with the snp data set. the user can generate multidimensional scaling  2d/3d plots to get a general idea of how the data clusters and to detect any outliers in the dataset. mds is a statistical technique for allowing differences and similarities to be visualized. the differences are represented by distances between points on a graph. elements in the asd matrix that are close together will tend to cluster together.

if the mds plot does not reveal any outliers in the dataset, then it makes sense to create a hierarchical plot of the data. for large datasets, the screen size and resolution may cause the ids for the individuals to become difficult to read, however, this problem can be solved by saving and viewing the pdf output separately. the hierarchical plot can help users identify clusters and general relationships among individuals. the cluster tree can be cut at any level of similarity according to researchers' need and be saved to a text file.

one of the important features of awclust is that it will calculate the gap statistic, a method for estimating the number of clusters in a data set  <cit> . it compares the pooled within-cluster sum of squares with its expectation from a null reference distribution. the precision of this method requires multiple simulations from the null reference distribution and thus, can be computationally intensive. for example, a dataset with  <dig> individuals, each with  <dig> snps and running  <dig> simulations  takes slightly longer than two minutes to run on an intel core <dig>   <dig>  ghz cpu with  <dig> gb of ram. the data points are then plotted for a range of cluster sizes and the optimal size maximizes the distance between the observed and expected pooled within-cluster sum of squares. information from mds and hierarchical plots may also help interpret of the gap statistic plots.

when using awclust on datasets other than the provided samples, it is important to note that the more closely related the subpopulations are, the larger the number of genome-wide random snp loci needed for good separation. fortunately, awclust can quickly process large datasets. for the number of snp loci required for major human populations, users can refer the empirical studies by gao and starmer  <cit> .

discussion
genome-wide snps can be easily obtained using affymetrix or illumina chips and thus, making full use of the vast amount of genetic markers available is an open issue for parametric approaches since the le assumption does not hold when snps are densely genotyped. without complicated ld modeling, there is a bottleneck for the amount of data that can be used by parametric approaches. moreover, the allele frequency estimation in parametric approaches suffers from high variation if the number of individuals for a sub-population is extremely small, e.g. less than ten, and this leads to questionable results.

besides structure, there are several other parametric software packages that are compared by wu et al.  <cit> , such as partition  <cit> , baps  <dig>  <cit> , geneland  <cit>  and psmix  <cit> . however, all parametric approaches suffer similar limitations because they all require verification of their model assumptions. when they are not justified, and for densely genotyped snps or when there is only a limited number of individuals from a single sub-population this is likely to be the case, non-parametric approaches provide better results.

recently researchers have began to use both parametric and non-parametric approaches to aid population structure analysis  <cit> . however, non-parametric approaches have been limited to the utilization of nj, k-means method, pcoa or mds, all of which can not give the optimal number of clusters objectively. furthermore, to our knowledge, we are not aware of an easy to use software package for non-parametric population structure analysis. therefore, it is imperative to promote a non-parametric software package that automates routine steps and can take advantage of the vast amount of snp markers available while inferring the optimal k objectively.

a limitation for the awclust software is that it does not estimate the proportion of genome that belongs to each sub-population, which would necessarily require allele frequency estimation and many other assumptions about hwe and ld, while awclust assigns each individual to one and only one cluster.  furthermore, awclust only handles snps, currently the most popular genetic marker. also, we did not aim to cover as many features in population genetics analysis as possible, like arlequin does  <cit>  since we did not want to replicate functions available in other software. there is also algorithm/software targeting on admixture mapping, i.e. admixmap  <cit>  and ancestrymap  <cit> , which requires more complicated model assumptions and is out of the scope of non-parametric methods. awclust performs classification rather than test statistic adjustment as genomic control  <cit>  and eigenstrat  <cit>  do. however, investigators can conduct further analysis conditional on the cluster information provided by awclust.

a general challenge in population structure analysis is to infer the optimal number of populations, k, and this is no different for the awclust software. before using the gap statistic to infer the optimal k, we suggest to plot the data using mds first in addition to the hierarchical plot. in our experience, hierarchical plots give general information about the clusters embedded in the data, while mds is suitable for outlier detection in exploration of individual relationships. to give an extreme situation, if there is just one individual for a particular sub-population, it is unlikely this individual can form a stand-alone cluster among all of the hierarchical clusters. therefore, it is better to take outlier individuals out before applying the hierarchical plot and the gap statistic. the optimal k can also be explained in combination with other prior information about populations in the data sets and experience of the field.

CONCLUSIONS
in summary, we have developed new software, awclust, for non-parametric population structure exploration. the software does not require hwe and le for sample individuals. nor does it need to estimate allele frequency. most importantly, it can identify the optimal number of populations objectively. awclust provides a user friendly gui interface and does not require any prior programming skill from users. this non-parametric software is complementary to the parametric population structure programs because it is useful when hwe and le can not be assumed to hold and when the accuracy of allele frequency estimation is questionable.

availability and requirements
project name: awclust

project home page: 

online users' manual: 

operating system: platform independent

programming language: r, tk

other requirements: r  <dig>  or higher 

license: gpl

any restrictions to use by non-academics: none

authors' contributions
xg designed and programmed the software. js participated in programming and wrote the manual. xg and js co-drafted the manuscript. both authors read and approved the final manuscript.

