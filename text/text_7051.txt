BACKGROUND
splicing is a complex process regulated by multiple trans-factors in conjunction with cis-regulatory signals. the latter determine the precise recognition of exon/intron boundaries and the structure of mature transcripts  <cit> . mutations in cis-regulatory motifs may lead to changes in splicing patterns and hence strongly influence gene function. disruptions of splicing patterns are commonly considered as loss-of-function variants and indeed they are frequently associated with genetic diseases  <cit> . surprisingly, multiple studies have reported widespread natural variation in splicing patterns among healthy individuals. two alleles of the same gene may lead to the expression of transcripts with different exon/intron structure  <cit> . in turn, the analysis of associations between variation in splicing patterns and whole genome sequences enables the discovery of putative regulatory variants, splicing quantitative trait loci   <cit> .

previously, we have analyzed a large set of splice-site disrupting polymorphisms observed in modern human populations  <cit> . although mutations at canonical splicing dinucleotides are supposed to cause dramatic changes in splicing patterns, our study showed that the majority of these mutations had minor functional effects. most polymorphisms affected rarely used and weakly conserved isoforms. the resulting changes in splicing patterns had little effect on the encoded protein structure  <cit> . however, these observations were solely based on predicted disruptions of known annotated isoforms. we did not have the capacity to annotate and analyze exact molecular outcomes of changes in gene models at that time.

a straightforward way to detect a new splicing pattern is to observe it in individual transcriptomic data. here we analyzed allele-specific splicing patterns in matching genomic and transcriptomic data for  <dig> d. melanogaster hybrid strains generated by crosses of inbred strains from natural populations to a single inbred reference strain. we identified dozens of putative regulatory variants associated with genotype-specific changes in splicing patterns. notably, a large fraction of the observed changes resulted in previously unannotated gene models. the predicted functional effects of the splicing changes were consistent with our previous conclusions  <cit>  supporting the thesis that natural variation in splicing patterns is likely to have only modest direct effect on the encoded protein sequences.

RESULTS
genotype-specific transcriptomes of d. melanogaster lines
we analyzed a panel of rna-seq datasets from  <dig> d. melanogaster heterozygotes with known genotypes . the flies were crossbred following a common reference design  <cit> , such that multiple inbred strains from natural populations  were crossed with a single common tester strain . the resulting transcriptomes of f1-hybrids were subsequently sequenced . the measurement of allelic imbalance in a splicing patterns allowed us to partition cis- and trans- genetic effects . in total, the dataset consisted of  <dig> million uniquely mapped paired-end rna-seq reads. the total coverage varied from  <dig>  to  <dig> million reads per genotype .figure  <dig> 
genotype-specific transcriptomes. a: common reference design.  <dig> inbred lines, which were derived from natural populations , were crossed with one common line . each heterozygous f1-hybrid had the same tester allele  and variable natural allele . transcriptomes of these f1-hybrids were sequenced and used to annotate and quantify genotype-specific splicing patterns. b: annotation and quantification of alternative splicing events. we focused on two most common types of alternative splicing events, namely, alternative donor/acceptor sites and cassette exons. the counts of inclusion  and exclusion  junction reads were used to quantify each alternative splicing event in each f1-hybrid. Ψ-value represented fraction of the longer isoform among two alternate transcripts.



genotype-specific changes in splicing patterns may be both quantitative  and qualitative . to be able to detect new genotype-specific isoforms, we annotated all alternative splicing events observed in the analyzed dataset. to this end we extended the base set of annotated introns with newly detected splice junctions and used them to annotate and quantify alternative splicing events . we concentrated on two most common subtypes, namely, alternative donor/acceptor sites  and cassette exons  . particularly, we did not account for retained introns since any observed intron retention event might stem from contamination of underspliced transcripts  <cit> . overall, the dataset consisted of  <dig> alternative splicing events, including  <dig> cases of alternative splice-site usage and  <dig> cases of cassette exons .

alternative splicing events were quantified in each genotype by a Ψ-value  which is a natural representation of the fraction of one of the isoforms among two major alternate transcripts .

genotype-specific splicing events associated with cis-sqtl
we ran association tests between the quantitative estimates of splicing patterns  with single-nucleotide polymorphisms  to detect putative regulatory variants. a relatively low sample size  restricted our power to perform genome-wide association tests, therefore we focused only on variants located in close proximity to the tested alternative splicing events . this is a minor concern, as it has previously been shown that splicing patterns tend to be determined mainly by cis-variants  <cit> .

natural inbred lines used in this study were collected from two north american populations of d. melanogaster , and a significant level of genome-wide differentiation was detected among the lines. in order to take this into account, we used emma  <cit> , a well-established method to test for associations while correcting for confounding effects including the population structure .

in total, we performed  <dig>  association tests between alternative splicing events and cis-snps. we used the benjamini-hochberg fdr 1% value as a statistical significance threshold. we also filtered significant hits by their effect sizes, which were calculated as the difference between median Ψ-values for two alternate alleles of the tested snp . we focused on cases with ΔΨ >  <dig> . we detected  <dig> alternative splicing events that were associated with  <dig> cis-splicing quantitative trait loci  with ΔΨ >  <dig>  . we refer to the alternative splicing events that exhibit changes in Ψ-values associated with sqtl as genotype-specific splicing events. in those cases where changes in splicing were associated with multiple cis-snps, the snps most likely formed ld-blocks.

the majority of detected genotype-specific splicing events had at least one cis-sqtl overlapping with splice sites  suggesting that these mutations were likely the causative regulatory variants. splice sites were defined as regions around intron/exon boundaries from − <dig> to + <dig> for donor sites and from − <dig> to + <dig> for acceptor sites. moreover, in seven of these cases mutations occurred in canonical splicing dinucleotides of splice sites  and thus undoubtedly can be considered as regulatory snps . in the remaining nine cases, all associated cis-qtl were located outside of splice site regions. they might represent either auxiliary regulatory sites or snps that are in ld with undetected causative snps.

a representative example of a detected genotype-specific splicing event is shown in figure  <dig>  we used cumulative exon/intron coverage plots to visualize differences in splicing patterns between two alternative alleles of cis-sqtl . it should be noticed that we were considering the state of snp only for the natural alleles. the tester alleles in all f1-hybrids carried the ancestral variant of cis-sqtl. in these coverage plots we show the rna-seq coverage of each genomic position for both exonic  and intronic  parts of a read. coverage from multiple f1-hybrids that carried the same variants of cis-sqtl was merged for illustration purposes. the coverage plots were generated for the alleles of the most significant snp. the distributions of Ψ-values for each f1-hybrid that carried alternate variants of the snp are shown in figure 2c.figure  <dig> 
genotype-specific alternative acceptor site associated with
cis
-sqtl . a cryptic acceptor site activation and removal of a 206 bp segment that is associated with four cis-sqtl. all plots are shown for the most significant cis-sqtl. a-b: exon/intron coverage plots of the genotype-specific splicing event are shown for the f1-hybrids that carried derived  and ancestral  variants of cis-sqtl on natural alleles. tester alleles of all f1-hybrids carried ancestral variant of cis-sqtl. the coverage for each genomic positions is shown separately for exonic  and intronic  parts of reads. the coverage from multiple genotypes that carry the same allele is merged. exon/intron boundaries are marked by vertical dashed lines. the position of cis-sqtl is shown by the red arrow. the alternative gene models are shown under the coverage plots: blue rectangles and yellow lines correspond to exons and introns, respectively. c: the distributions of Ψ-values for alleles of this cis-sqtl. d: the manhattan plot of association test log-p-values for all tested cis-snps. e: q-q plot for the observed  and expected  distributions of association p-values for the tested cis-snps  and  <dig> random snps from other chromosomes . f: rt-pcr validation of gene models. the predicted lengths of pcr-products corresponding to the long and short isoforms were 337 bp and 131 bp, respectively. a/a: inbred line carrying only ancestral alleles ; a/d: f1-hybrid carrying both ancestral and derived alleles; d/d: inbred line carrying only derived alleles .



this example represents activation of a cryptic acceptor site associated with four closely linked snps located approximately 20 bp upstream from the activated splice site. this leads to the removal of a 206 bp protein-coding region from the second exon of the gene cg <dig> .

to test for potential inflation of false-positive results we performed association tests between detected genotype-specific splicing pattern with  <dig>  random snps from other chromosomes and calculated genome-wide inflation factor . a diagnostic q-q plot for the observed and expected distributions of log-p-values for the presented example is shown in figure 2e. no genome-wide inflation was observed in any of the detected genotypes-specific splicing events .

the expression of the predicted isoforms was validated by rt-pcr . validation was performed for one of the f1-hybrids, which carried the derived allele of the most significant cis-sqtl, and for the respective inbred parental lines. we could show that the inbred tester line, which carried only ancestral alleles , expressed the long isoform . the inbred natural line, which carried only derived alleles , expressed only the short isoform corresponding to the activation of a cryptic splice site . f1-hybrids, which carried both alleles , expressed both isoforms. the absence of the long isoform in the homozygous d/d-inbred lines implies that in this case we observe a complete switch of isoforms between alternate alleles.

genotype-specific splicing events associated with snps in canonical splicing dinucleotides
canonical splicing dinucleotides are the most conserved positions in splice sites . mutations that occurred at these positions resulted in complete absence of splicing . we identified seven cis-sqtl in our association tests  that were located in canonical splicing dinucleotides. the set of analyzed strains could potentially harbor additional cases of genotype-specific splicing events associated with such polymorphisms, which went undetected in our association tests due to a limited statistical power resulting from the available sample size and our conservative approach to the multiple-testing correction. therefore we selected additional polymorphic canonical splicing dinucleotides that might have the potential to be associated with considerable changes in splicing patterns . the statistical significance of the association was calculated by fisher’s exact test  and then the benjamini-hochberg fdr <  <dig>  correction was applied. in total, we found  <dig> genotype-specific splicing events associated with  <dig> sqtl at canonical dinucleotides . in one case, allele-specific inclusion of a cassette exon was associated with snps in canonical dinucleotides of both splice sites .

polymorphisms at canonical dinucleotides might actually represent two different scenarios: disruption of pre-existing splice sites or creation of de novo splice sites. for each snp we determined the ancestral state using orthologous genomic sequences in closely related drosophila species . in  <dig> of  <dig> cases the polymorphic splice sites represented creation of de novo splice sites .

an example of a genotype-specific splicing event associated with cis-sqtl in canonical dinucleotides is shown on figure  <dig> . we observed a de novo donor site  in the first intron of the gene dbi. creation of this splice site resulted in inclusion of a 84 bp intron segment to the first exon. in genotypes that carried the ancestral allele, no junction reads corresponding to this splice site were observed. the altered exon was located in the 5′-untranslated region of the gene and most probably did not affect the structure of the encoded protein. the rt-pcr validation experiment confirmed that the transcripts that utilized the new splice site  were expressed only in flies that carried the derived allele of cis-sqtl . however, the homozygous d/d-inbred line was still expressing the short isoform , i.e. we did not observe a complete switch of isoforms.figure  <dig> 
genotype-specific alternative donor site associated with
cis
-sqtl in canonical splicing dinucleotide.
de novo donor site and inclusion of an 84 bp segment that was associated with cis-sqtl in canonical splicing dinucleotide. a-b: exon/intron coverage plots of the genotype-specific splicing event are shown for the f1-hybrids that carried derived  and ancestral  variants of cis-sqtl on natural alleles. tester alleles of all f1-hybrids carried ancestral variant of cis-sqtl. c: the distributions of Ψ-values for alleles of this cis-sqtl. d: rt-pcr validation of gene models. the predicted lengths of pcr-products corresponding to the long and short isoforms were 234 bp and 150 bp, respectively. for other details see the legend to figure  <dig> 



overall, we detected  <dig> genotype-specific splicing events that were associated with  <dig> cis-sqtl with ΔΨ >  <dig>  .

allelic imbalance of cis-regulated genotype-specific splicing patterns
the differences in splicing patterns between the transcripts, which are expressed from two parental alleles, suggests cis-regulatory divergence between parental genotypes  <cit> . here, we use the presence of allelic imbalance in observed genotype-specific splicing patterns as an additional evidence that the associated sqtl represent cis-regulatory variants.

reads were aligned to parental specific reference genomes. the fraction of reads overlapping with heterozygous positions were differentially aligned to parental genome references, thus we were able to determine the allele of origin for these reads . allele-specific reads were used to estimate the Ψ-values separately for each parental allele, i.e. natural allele-specific  and tester allele-specific , according to the allele origin. in other words, ns-Ψ- and ts-Ψ-values represented ratios of transcripts expressed from the natural and tester alleles respectively . consequently, ns-Ψ- and ts-Ψ-values were used to measure changes in splicing patterns separately for each parental allele .

the coverage plots and distributions of Ψ-values for allele-specific reads are shown for one of genotype-specific splicing events in figure  <dig>  in this example, a cis-sqtl was associated with the inclusion of a cassette exon in the 5′-untranslated region of the gene sod <dig>  plots were created separately for reads expressed from the natural  and tester alleles . considerable inclusion of the cassette exon was observed only in transcripts expressed from natural alleles carrying the derived variant of the cis-sqtl . at the same time, almost no inclusion of the cassette exon was detected in transcripts expressed from tester alleles carrying the ancestral variant of the cis-sqtl from the same f1-hybrids . as a result, a considerable change in the splicing pattern associated with cis-sqtl is observed only for reads expressed from natural alleles , and almost no change is observed for reads expressed from tester alleles . strong allelic imbalance in heterozygotes implies that the observed inclusion of the cassette exon is regulated in cis, and that the identified cis-sqtl most likely is the causative regulatory variant. an rt-pcr validation experiment confirmed that observable inclusion of the cassette exon occurred only in flies that carried the derived allele of cis-sqtl .figure  <dig> 
allelic imbalance of genotype-specific cassette exon inclusion associated with
cis
-sqtl . genotype-specific cassette exon that exhibits strong allelic imbalance is shown. the allele-specific exon/intron coverage of genotype-specific splicing event are shown for the f1-hybrids that carried derived  and ancestral  variants of cis-sqtl on natural alleles. tester alleles of all f1-hybrids carried ancestral variant of cis-sqtl. the plots were created separately for the reads expressed from natural  and tester alleles . only genotypes with estimated ns-Ψ and ts-Ψ-values were considered. cf: the distributions of ns-Ψ  and ts-Ψ-values  for alleles of cis-sqtl. g: rt-pcr validation of gene models. the predicted lengths of pcr-products corresponding to the long and short isoforms are 231 bp and 102 bp, respectively. for other details see the legend to figure  <dig> 



unfortunately, due to the limited coverage by allele-specific reads, we were able to estimate ns-Ψ and ts-Ψ only for a fraction of detected genotype-specific splicing events. both values for at least one f1-hybrid for each variant of the cis-sqtl was obtained for  <dig> cis-sqtl, which were associated with  <dig> genotype-specific splicing events. for these cis-sqtl, we calculated the allele-specific ΔΨ-values . the distributions of allele-specific ΔΨ-values are shown in figure  <dig>  on average, ns-ΔΨ-values were considerably higher than ΔΨ-values calculated for all reads, and the median of the ts-ΔΨ-values distribution is close to zero . in other words, almost all differences between splicing patterns associated with cis-sqtl are caused by changes in transcripts expressed from natural alleles. this suggests that the majority of identified genotype-specific splicing patterns indeed are regulated by cis-genetic effects. at the same time, in some cases allele-specific ΔΨ-values did not follow the optimal patterns that could be expected for cis-genetic regulation . this might be caused by a variety of factors, including non-causative alleles, low coverage, or the influence of unknown additional genetic effects .figure  <dig> 
distributions of allele-specific ΔΨ-values. ΔΨ-values as calculated for natural allele-specific reads , for tester allele-specific reads  and for all reads . values were calculated for cis-sqtl with sufficient coverage for calculation of both values for at least one f1-hybrid for each variant.



effects of genotype-specific splicing events on encoded proteins
changes in splicing patterns may have diverse functional outcomes. for instance, they may cause exclusion or inclusion of relatively long gene segments. moreover, such changes in protein-coding regions may result in frameshifts. thus, mutations disrupting splice sites were often considered as loss-of-function variants  <cit> .

the set of identified genotype-specific splicing events differed from the overall set of all alternative splicing event in many aspects . specifically, the genotype-specific changes were underrepresented among cassette exons . they more frequently affected terminal untranslated regions of genes  than other alternative splicing events .table  <dig> 
comparison of genotype-specific splicing events with the overall set of alternative splicing events


genotype-specific splicing events
all alternative splicing events
p-value 

alternative donor sites

alternative acceptor sites

cassette exons
the percents represent fractions within the “total number of alternative splicing events”. * – in case of alternative donor/acceptor sites, the lengths of alternative gene segments were calculated as distance between alternative splice sites. this is inapplicable for terminal alternative splicing events . thus, on the estimation of the fraction of frame-preserving splicing events and median length of alternative gene segments, we exclude splicing events with more than 500 bp between alternative splice sites. ** – p-value for wilcoxon rank-sum test.



only  <dig> of  <dig> genotype-specific splicing events overlapped with protein-coding regions. almost all of them were frame-preserving with lengths of alternatively spliced segments being a multiple of  <dig> . the affected gene segments were significantly shorter than that in the set of other alternative splicing events. in  <dig> of  <dig> cases genotype-specific changes involved only four or less amino acid residues , including eight cases affecting only one amino acid residue .

in two cases, the lengths of altered gene segments in the protein-coding region was not a multiple of  <dig> and most likely lead to frameshifts. these frame-shifts disrupted protein sequences of the gene cg <dig> that encodes peptidase-s  and the gene nimb <dig> which is involved in innate immunity  <cit> . these cases probably represents loss-of-function variants. interestingly, the most significant cis-sqtl associated with a frameshift in the gene cg <dig> is not a rare mutation:  <dig> of  <dig> studied inbred lines carry the derived allele .

in most cases one of the alternate isoforms of a genotype-specific splicing event was not annotated . this has been expected as the vast majority of them represented disruptions and creations of splice sites .

discussion
here we studied natural genetic variation of gene models in d. melanogaster. we analyzed transcriptomes of  <dig> hybrid strains generated by crosses of inbred strains from natural populations to a single tester strain. we used rna-seq to annotate and to quantify alternative splicing events. firstly, we ran association tests between isoform usage with adjacent snps, and identified several dozen cis-sqtl. most of them were associated with mutations of regulated splice sites. additionally, we searched for splice sites with polymorphic canonical splicing dinucleotides that were associated with considerable differences in splicing patterns. these dinucleotides are known to be crucial for the splicing mechanism and snps at these positions are usually considered to be regulatory variants causing the observed changes. overall, we identified  <dig> genotype-specific splicing events that were associated with  <dig> cis-sqtl. allele-specific estimates of splicing patterns confirm that the observed changes in splicing patterns are predominantly regulated in cis. the affected transcripts are expressed from the natural alleles rather than the tester alleles. several representative examples were validated by rt-pcr experiments .

cis-sqtl located outside of the splice site region are of particular interest as they may represent mutations in auxiliary elements of the splicing code  <cit> . two examples of such cases are shown in figures  <dig> and  <dig>  in the first example, four closely linked mutations are associated with the activation of a cryptic splice site located 20 bp downstream of the most significant cis-sqtl. in the second example, inclusion of a cassette exon is associated with a single cis-sqtl located in the middle of the regulated exon.

the relatively small number of genotypes and a rank-based transformation of splicing estimates resulted in a limited power of association tests. further, the observed differences in the splicing patterns among the analyzed genotypes were probably diluted by the effects of common tester alleles. moreover, we focused on two most basic types of alternative splicing events, thus excluding a considerable fraction of intron retentions and complex splicing events. hence, the identified set of genotype-specific splicing events likely represents only a fraction of splicing variation existing among analyzed genotypes.

currently, sqtl-studies are mainly focused on changes in ratios of known isoforms  <cit> . we used previously unknown high-confident splicing junctions to annotate new gene models. more than half of splice sites with snps at canonical splicing dinucleotides are de novo splice sites. furthermore, 75% of the identified genotype-specific splicing events were not annotated, i.e. at least one of the alternate isoforms was not present in the known annotations of gene models. all these demonstrates the importance of considering qualitative changes in genotype-specific splicing patterns.

cassette exons are underrepresented among the genotype-specific splicing events we have identified. at the same time, a comparison of alternative splicing among d. melanogaster lines and between closely related drosophila species has revealed that cassette exons are the most divergent type of alternative splicing events  <cit> . the study of mcmanus and colleagues was focused on detection of differences in splicing patterns not considering association with sqtl. they analyzed the allelic imbalance in the interspecies f1-hybrids and showed that the regulation of cassette exons  had a larger component of trans-genetic effects than other types of alternative splicing events  <cit> . on the other hand, the main focus of our study was the detection of changes in splicing patterns associated with cis-sqtl, and it may explain the discrepancy between our results.

the analysis of putative functional effects of identified cis-sqtl on gene function is consistent with results of previous studies  <cit> . in most cases, the changes in splicing patterns have no or little effect on the encoded protein sequences. on the other hand, it should be noted that the analyzed natural lines underwent many generations of inbreeding, and the majority of deleterious variants were probably washed out.

this study may be used as a prototype to design similar experiments in the future . the current bottleneck is the absence of powerful tools for such association studies, simultaneously accounting for non-normally distributed traits  and population structure.

CONCLUSIONS
the overall results of this study suggest that gene models in natural populations of drosophila melanogaster may be flexible. association tests between genotype-specific splicing patterns and snps identified dozens of putative splicing regulatory variants . a set of mutations disrupting canonical dinucleotides was analyzed to identify sqtl that were not detected in the association tests. in total, we identified  <dig> genotype-specific splicing events that were associated with  <dig> cis-sqtl. effects of the observed changes in gene models on the encoded proteins were predicted to be modest. the splicing polymorphisms with strong functional effects are likely selected against in natural populations, and only those with weak functional roles are segregating. the obtained results expand our understanding of how the exon/intron structure of genes evolves. the concepts applied in this manuscript may be used to design similar experiments in the future.

