BACKGROUND
in  <dig>  pauling and corey predicted the existence of two periodic motifs in protein structures: the α-helix  <cit>  and the β-sheet  <cit>  which turned out to be major features of protein architecture. secondary structures, because they allow a simple and intuitive description of 3d structures, are widely employed in a number of structural biology applications. for instance, they are used for structure comparison  <cit>  and structure classification  <cit> . they also provide a natural frame for structure visualization  <cit> .

in recent years, secondary structures have come to play a major role in a number of methods aiming at predicting protein 3d-structures. indeed, being able to predict accurately secondary structure elements along the sequence provides a good starting point toward elucidating the 3d-structure  <cit> . current algorithms for predicting the secondary structure provides accuracy rates of about 80% for a  <dig> state prediction: α-helix, β-strand and coils  <cit> , using neural networks and evolutionary information. the maximum achievable prediction has been estimated to lie in the range 85%  <cit>  to 88%  <cit> .

the divergence between observed and predicted secondary structure has been noticed early  <cit> . it took more time, though, for the structuralist community, to realize that obtaining an accurate and objective secondary structure assignment was not a trivial task, due to the variations observed in secondary structures when compared to ideal ones. as noted by robson and garnier  <cit> : "in looking at a model of a protein, it is often easy to recognize helix and to a lesser extent sheet strands, but it is not easy to say whether the residues at the ends of these features be included in them or not. in addition there are many distorsions within such structures, so that it is difficult to assess whether this represents merely a distortion, or a break in the structure. in fact the problem is essentially that helices and sheets in globular proteins lack the regularity and clear definition found in the pauling and corey models." for instance, as found by barlow and thornton  <cit>  and kumar and bansal  <cit> , a majority of α-helices in globular proteins are smoothly curved. therefore, a group of experts , asked to assign the secondary structure of a particular protein, is likely to come up with different assignments.

to cope with this problem, as well as the increase in the number of experimentally solved 3d structures, the need for automatic secondary structure assignment programs was felt in the mid seventies. such programs are intended to embody expert's knowledge and to provide consistent and reproducible secondary structure assignments. periodic secondary structures generate regularities that can be used as criteria to define them, e.g., cα distances, dihedral angles, like α angles or pairs of  angles, and specific patterns of hydrogen bonds. along the years, various methods using these criteria have been proposed. the first implementation of such methods, allowing automatic secondary structure assignment from 3d coordinates, was done by levitt and greer  <cit> . the algorithm was mainly based on inter-cα; torsion angles.

a few years later, kabsch and sander developed a method called dssp  <cit>  that still remains one of the most widely-used program for secondary structure assignment. the dssp algorithm is based on the detection of hydrogen-bonds defined by an electrostatic criterion. secondary structure elements are then assigned according to characteristic hydrogen-bond patterns. this methodology has been widely accepted as the gold standard for secondary structure assignment. a number of software packages make use of dssp when they need to assign secondary structures. for instance rasmol  <cit> , the most widely distributed visualization software, assigns the repetitive structures with a fast dssp-like algorithm. similarly gromacs analysis tools use the dssp software  <cit> .

stride  <cit>  is a software related to dssp. it makes a very similar use of hydrogen-bond patterns to what is done in dssp, although the definition of hydrogen-bonds is slightly different. in addition stride takes into account  angles to assign secondary structures. stride is used by the visualization tool vmd  <cit>  to assign secondary structures.

secstr  <cit>  belongs to the same family of methods. it has been developed specifically to improve the detection of π-helices. indeed, secstr's authors found dssp and stride unable to detect several π-helices they were able to characterize with their method.

other methods have been developed that use different criteria to assign secondary structures. define  <cit>  relies on cα coordinates only and compares cα distances with distances in idealized secondary structure segments. it also provides a description of super-secondary structures. p-curve approach  <cit>  is based on the definition of helicoidal parameters for peptide units and generates a global peptide axis. psea  <cit>  only considers cα atoms. it is based on distance and angle criteria. xtlsstr  <cit>  has been developed to assign secondary structures " in the same way a person assigns structure visually", from distances and angles calculated from the backbone geometry. it is concerned with amide-amide interactions. the most recent method, to the best of our knowledge, is votap  <cit>  which employs the concept of voronoi tessellation, yielding new contact matrices.

let us notice that structure files provided by the protein data bank   <cit>  contain secondary structure descriptions in the helix, sheet and turn fields . these secondary structure descriptions are either provided by the depositor  or generated by dssp. approximately 90% of the pdb files do have secondary structure fields. however, even though these fields are used, it may happen that only a few secondary structure elements, of interest for the depositor, are described, the others being ignored.

the variety of available methods illustrates the fact that there are several legitimate ways to define secondary structures. it is hardly surprising that these different methods provide different assignments, especially at the edges of secondary structure segments. for example, colloc'h and co-workers  <cit>  showed that the percentage of agreement is only 63% between dssp, p-curve and define and that define tends to assign too many repetitive secondary structure segments. xtlsstr authors noted that dssp assigns more β-strands than xtlsstr does  <cit> . secstr is logically more sensitive for π-helix detection than dssp or stride  <cit> .

in this paper we want to focus on how well some of the above methods handle the secondary structure irregularities mentioned by robson and gamier  <cit> . we are particularly interested in the way these different methods process the edges of secondary structure elements and deal with the various structure distorsions occurring in proteins. for structures solved by x-ray diffraction, it is well known that the resolution has a direct effect upon the quality of the resulting model. one expects the secondary structure assignment to be less accurate for low resolution structures  <cit> . it is thus interesting to assess the effect of the resolution upon the secondary structure assignment proposed by the different methods. it is also worth comparing secondary structure assignments for structures solved by x-ray crystallography and by nmr techniques. structures solved by nmr correspond to proteins in solution and provide a more "dynamic" representation of the protein conformation than x-ray structures do. nmr structures are therefore more prone to local distorsions and constitute difficult, and interesting, cases for secondary structure assignment methods.

in the following we present a new method for secondary structure assignment, called kaksi  based on cα distances and  angles. these characteristics are intuitively used when examining visually a 3d structure. our main purpose in developing this method was to deal, in a satisfactory way, with the structure irregularities. for instance we consider that regions of the polypeptide chain that show an abrupt change in their curvatures  should be considered as breaks in periodic secondary structures. the objective of an assignment method is to provide accurate and reliable assignment. demonstrating that our methodology is an improvement over existing methods would be difficult since there is no standard of truth to benchmark methods with. we then carry out comparisons of the assignments of this new method with a number of other methods that use different criteria to define secondary structures: dssp, stride, secstr, xtlsstr and psea, as well as with the descriptions found in pdb files. these comparisons are performed on  <dig> different datasets:  <dig> x-ray datasets with, respectively, high, medium and low resolution and an nmr dataset. this allows us to evaluate the effect of the resolution and experimental method upon the different secondary structure assignment methods.

we address the problem of inclusion of residues at the edges of helices and strands by examining the length of segments assigned by different methods. we also study the problem of correctly defining segments in case of distortions. more specifically, for helices, we appraise the geometry of helical segments using helanal  <cit> , a software dedicated to this task.

finally, we illustrate how kaksi deals with distorted secondary structures by comparing its assignments with stride assignments for a number of difficult cases.

RESULTS
kaksi parameters
in kaksi secondary structure detection depends on a number of parameters .

to test the robustness of the method to the choice of these parameters, we examined the effect of changing εh, εb and σb upon the secondary structure contents of the comparison sets. we let εh and εb vary in the range  <dig>  to  <dig> , and σb in the range  <dig> to  <dig>  each parameter is tested separately, while keeping other parameters to the selected values given in methods section.

the effects are similar on all sets of structures. the decrease of εh below  <dig>  results in a moderate diminution of the percentage of α-helix, whereas this percentage slightly increases when εh is greater than  <dig> . fewer β-sheets are assigned when εb, is lower than  <dig> . on the contrary, the percentage of β-sheets increases when εb, is greater than  <dig> . slightly more β-sheets are assigned when σb is lower than  <dig>  and there is a diminution of β-sheets assignment when σb is greater than  <dig> 

two different behaviors are observed: kaksi assignments are not very sensitive to variations of α-helix detection thresholds, but quite sensitive to variations of β-sheets detection thresholds. this is easily explained by the detection heuristic: the detection of α-helix is achieved by the distance or the angle criteria, moderate changes of εh are balanced by other criteria. on the contrary, the β-sheet detection is achieved by the satisfaction of both, distance and angle, criteria.

the two criteria implemented in kaksi for kink detection in α-helices, k <dig> based on  angles and k <dig> based on axes, are also tested. to evaluate the efficiency of each criterion, we analyze the geometry of kinked helices with the helanal software. we monitor the fraction of helices classified as kinked by helanal. this fraction is reduced when each criterion is used separately showing that both criteria are able to detect kinks . results obtained with k <dig> agree better with helanal results than those obtained with k <dig>  however the best agreement with helanal is obtained when criterion k <dig> and k <dig> are used sequentially. hereafter, kaksi assignments are obtained with the parameter values given in material and methods and both criteria k <dig> and k <dig> applied for kink detection.

secondary structure content
the secondary structure content is used to assess the sensitivity of different assignment methods to the structure resolution. table  <dig> shows the secondary structure content in all our comparison sets, according to five available assignment softwares, kaksi and the pdb description.

there is no absolute consensus, even for the hres set, about secondary structure content according to different methods. stride and dssp figures are very close, as expected due to the similarity of these methods  <cit> . psea systematically assigns less helices and more strands than other methods. pdb assignments are always richer in α-helix than any automatic procedure. kaksi assigns a fraction of periodic secondary structures comparable to stride and dssp on the hres set.

secondary structure contents in the hres and the mres sets are similar according to different methods. assignments on the lres and the nmr sets result in smaller contents in regular secondary structures. this is true for every assignment methods, but more or less marked, depending on the method. β-assignment is lower on the lres set for a majority of methods. only psea assignments show a proportion of β comparable for all datasets. it must be noted that this method consistently assigns more β-strands than all other methods, whatever the dataset considered. overall, though, the influence of the resolution upon the assignments of the methods is moderate. the type of technique use to solve the structure  appear to have a more pronounced effect.

the decrease in β-sheets assignment on the lres and nmr sets indicates that less stringent parameter values are required when dealing with structures belonging to these sets. for example, kaksi assignment on the lres set with σb =  <dig> result in a proportion of  <dig> % residues in β-sheet and  <dig> % with σb =  <dig>  . in the same way, the percentage of β-sheet residues in the nmr sets is about  <dig> % with σb =  <dig> or εb =  <dig> . consequently, we suggest to adapt the β-sheet detection parameters when dealing with low resolution and nmr structures.

measures of global agreement between methods
c <dig> scores
assignments given by xtlsstr are the most different from others: c <dig> scores with dssp, stride, secstr and pdb are all below 81%. kaksi and psea show an intermediate behavior of the other methods . the c <dig> scores are all in the same range, between  <dig> %  and  <dig> % , excluding xtlsstr .

sov criterion
the sov criterion is usually employed for secondary structure prediction evaluation, whereas here, comparisons are made between alternative structure assignments. sov values depend on which structure ischosen as reference. to allow comparison, kaksi is taken as reference. table  <dig> shows sov values computed from the hres set for helices and strands, between kaksi and other methods. sov values for other datasets are available, .

for helical segments, the highest sov with kaksi assignment is obtained with dssp . it lies in the same range for stride. it is slightly lower for other methods but remains above 87%. for the strands, a good agreement is seen with dssp, stride and pdb . lower sov  are found with psea and secstrc. moderate agreement is seen with xtlsstr . c <dig> score between xtlsstr and kaksi is only  <dig> %. sov values are high for helices and slightly lower for strands, showing that differences between both methods mainly concern β-sheets assignments. hereafter we will restrict our comparisons to kaksi, stride, and psea assignments on the hres set. stride is a widely-used method whose results are very similar to dssp and pdb, as shown by the c <dig> scores. stride is chosen because it exhibits the largest c <dig> score with kaksi. psea is chosen because its algorithm fairly differs from other methods, but sov values remain consistent when compared to kaksi's.

segment length distribution
the length distributions of helices and strands assigned by kaksi, psea and stride on the hres set are shown on figure  <dig> 

in helix distributions, three zones can be distinguished.  for helices shorter than  <dig> residues, the distributions are very different: stride assigns many  <dig> residue long helices, whereas psea and kaksi do not assign helices shorter than  <dig> residues. psea assignments results in slightly larger number of short helices than stride. kaksi distribution shows a very high peak at  <dig> residues.  in the range  <dig> to  <dig> residues, small differences are observed: kaksi distribution shows a peak about  <dig> residues, unlike psea and stride distributions.  for helices longer than  <dig> residues, distributions are similar.

similarly,  <dig> distinct zones appear in the strand distributions.  up to  <dig> residues, psea and kaksi curves show larger peaks than stride distribution, at  <dig> to  <dig> residues for kaksi, and  <dig> and  <dig> residues for psea. psea and kaksi do not assign strands shorter than three residues, whereas stride assignment result in a large number of 1-residue long strands. these segments are isolated β-bridges .  between  <dig> and  <dig> residues, psea and kaksi segments are more numerous than stride segments.  after  <dig> residues, the distributions are identical.

global measures, such as c <dig> and sov scores, show that kaksi assignments are globally consistent with those given by other existing methods. the length distributions of helices and strands indicates that segment distribution is also roughly similar across methods. this broad consensus was expected. in the following sections we now turn toward the study of details of the assignments, in particular, as mentioned in the introduction, we compare the way different methods deal with the edges of secondary structures and cope with local distorsions.

detailed comparison
pair length
the sov criterion is a measure of the global overlapping of secondary structure segments. it gives no information about the effect of length of segments or about the respective length of facing segments. figure  <dig> shows the plot of lengths for pair of corresponding repetitive structure segments between stride and kaksi, and psea and kaksi assignments. the pairs are those used for the sov computation: a pair is considered when there is at least one residue in the same state for the two assignments. unpaired segments are ignored.

taking kaksi assignment as our reference, three different cases occur:  one segment according to kaksi corresponds to a single segment in another method assignment: these are one-to-one events.  one segment assigned by kaksi corresponds to two or more segments in another method assignment. we call this a fusion event.  the symmetric case, several segments in kaksi assignment corresponding to a single segments in another method assignment, is called a division event. the three cases are available plotted on separate graphs .

helix length
the strong accumulation of points along the diagonal, on both plots  and for every segment lengths shows that kaksi often agrees with other methods about the length of helices. there are more points below the diagonal than above, indicating that kaksi tends to assign slightly longer segments than stride and psea . this occurs for all segment lengths, but it is more striking on the psea/kaksi comparison.

the points appearing far from the diagonal correspond to division and fusion events, as shown by the squared correlation coefficients r <dig>  correlations are calculated on the pairs  and are used as indicators for the dispersion about the diagonal. on the kaksi/stride comparison, r <dig> =  <dig>  for all the  <dig> pairs, but reaches  <dig>  when only the  <dig> one-to-one events are considered. the remaining pairs correspond to  <dig> cases of fusion and  <dig> cases of division events. division events are responsible for the numerous observations of pairs of short helices in kaksi assignment  with longer helices in psea and stride assignments .

similarly, for the kaksi/psea comparison there are  <dig> pairs , distributed in  <dig> one-to-one events ,  <dig> fusion and  <dig> division events. numerous cases of divisions appear on the plot as pairs of  <dig> to  <dig> residue helices for kaksi and  <dig> to  <dig> residue helices for psea.

for both comparisons , the number of division events is greater than the number of fusion events, showing that kaksi tends to split long segments into shorter ones. this is a direct consequence of the kink detection mechanism used in kaksi. it also explains why short helices are more abundant in kaksi assignments than in stride and psea. some examples of this phenomenon are illustrated in fig  <dig> 

strand length
the situation is less clear than for helices. the points are more dispersed and there is no clear accumulation of points accounting for division events. in the kaksi/stride comparison, the  <dig> pairs yield a r <dig> equal to  <dig> . this value increases to  <dig>  when only the  <dig> one-to-one events are considered. amongst the remaining pairs  <dig> correspond to fusion events, and  <dig> to division events. the splitting of long segments is thus less systematic than for helices. this makes senses since there is no mechanism similar to the kink detection in helices for β-strands. 52% of the one-to-one events fall above the diagonal  and  <dig> % fall below the diagonal . the remaining 26% are on the diagonal. it shows that kaksi tend to assign longer strands than stride.

in the kaksi/psea comparison, r <dig> equals  <dig>  on the  <dig> pairs and  <dig>  on the  <dig> one-to-one events. there are  <dig> fusion events and  <dig> division events. the numbers of division and fusion events are close, indicating that there only a slight splitting effect. 27% of the one-to-one events are on the diagonal, 50% are above  and 23% are below . in a majority of case, kaksi assigns shorter strand segments concerning one-to-one events.

for both kind of segments and both comparisons, we also checked for the existence of systematic shifts of the segments toward the n-ter or c-ter termini of the secondary structure elements. no such systematic bias was found .

helix geometry analysis with helanal
in kaksi we pay a special attention to the detection of kinks in α-helices by applying angle and axis criteria. this motivates the study of the geometry of helices with an external tool, according to alternative definitions of helix locations. we check the geometry of helices assigned by the different assignment methods with the helanal software. we are interested in the distribution of helices into the three classes: linear , curved  or kinked . unclassified helices represent less than 1% in our datasets.

when analyzed by helanal, helices assigned by all methods show a high proportions of kinks. on the hres set, for example, about 20%  up to 30%  helices appear classified as kinked. this ratio is 16% only for the pdb assignments, and less than 10% for psea. when the resolution gets worse, this proportion increases . on the nmr set, we observe as much as 40% kinked helices for psea assignment and more 50% kinked helices for stride, secstr and pdb.

this high ratio of irregular helices  is in agreement with previously published results  <cit> . however, the high ratio of kinked helices found here is larger than previously reported by kumar and bansal  <cit> . there is a difference between kumar and bansal's work and our study: they modified helix assignment given by dssp before submission to helanal. using distance and axis criteria, they corrected helix boundaries to avoid distortions at the termini. consequently, the high ratio of kinked helices is likely due to these terminal residues. rather than applying the correction used by kumar and bansal, we apply a systematic correction before submitting helices to helanal, i.e., one residue is removed at each helix terminus. the reason for applying a systematic correction rather than a correction based on geometrical criteria is that we want to make a statistical comparison of helices assigned by various softwares. the goal is not to correct potentially wrong helices boundaries. we want to evaluate the assignments as they are produced by the softwares and used in later applications.

as helanal can handle only helices longer than nine residues, we restrict our analysis to helices longer than eleven residues. when removing the first and last residues of helices, the ratio of kinked helices decreases, showing that part of the kinks are due to distortion at the termini. after correction, the geometry of helices assigned by kaksi  is the closest to the geometry of helices described in the pdb . the kaksi method also assigns the highest ratio of linear helices . psea has only  <dig> % kinked helices but it should be noted that the number of helices submitted to analysis is slightly lower.

it is interesting to investigate the geometry of helices when kaksi assigns several helices in a region where stride assign a single long helix, i.e., the division events. if we consider the division events involving pair of helices longer than nine residues, we find  <dig> pairs where a kinked helix assigned by stride corresponds to curved or linear helices assigned by kaksi. the symmetric case, kinked helices in kaksi assignment paired with a curved or linear helices in stride assignment concerns only  <dig> cases. this indicates that splitting long helices into several short ones helps to define helices devoid of kink.

all these observations suggest that the kink detection implemented in kaksi is efficient and leads to more reliable helix locations. the major feature of kaksi assignments is then the geometry of α-helices: while assigning slightly longer helices than stride, the global geometry of helices remains satisfactory, with more linear helices than other assignments and a limited ratio of kinked helices, very close to pdb assignments. this is accomplished by dividing long distorted helices when appropriate. some examples are shown in the following section.

some examples of assignment disagreements
the last example  <dig> is an example of disagreement on a β-strands assignment. β-strands assigned by stride are fairly curved, allowing a change of direction of the backbone. no specific routine is implemented in kaksi to split distorted strands, as it is done for helices. nonetheless, the criteria of β-sheet assignment being fairly strict, some cases of division in long β-strands can also occur. these examples illustrate the fact that a small disagreement on a per-residue basis can result in a radical change in the structure description. in the examples shown on fig.  <dig> we believe that kaksi assignments provide a more pertinent description of the protein structure.

CONCLUSIONS
we have developed a new automatic procedure to assign secondary structures from 3d coordinates. our method, kaksi, uses cα distances and  angles and pay a special attention to kink detection in helices. like other methods , it is sensitive to the resolution, and the type of experimental technique used to solve the structure. consequently, we propose to choose detection parameters according to the structure resolution or technique and the nature of the secondary structure, since β-sheets are more difficult to detect. the careful comparison of kaksi assignments with assignments produced by five available methods and the description provided by the pdb highlights the similarities and differences between the different methods. good general agreement are observed between methods, especially on α-helices. the length of α-helices and β-strands, in case of agreement on the number of segments, are very similar when compared to stride and psea. when different lengths are assigned, we observe slightly longer α-helices and β-strands than the stride definition. when two methods disagree on the number of segments, we observe more division events than fusions, i.e., several short helices assigned by kaksi in front of a unique long helix assigned by stride or psea. division events are also slightly predominant in the comparison of β-strand length with stride and psea. the study of α-helix geometry with an external tool reveals that kaksi helices are less kinked that helices assigned by other methods, except psea. kaksi is also the method that assigns helices with geometrical characteristics in best agreement with helices described in the pdb, and, maybe more important, the highest proportion of linear helices. as stated by andersen and co-workers  <cit> , each method reflects its own definition of secondary structures. our definition favors a certain regularity of secondary structure elements, as illustrated by the examples on fig.  <dig> 

