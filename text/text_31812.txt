BACKGROUND
for decades scientists have used a variety of analytical techniques to relate allelic inheritance patterns in the genome to variation in continuous physical traits of interest. the goal of such analyses is often to locate quantitative trait loci , or genomic locations that exert an influence on the manifested trait. understanding the genomic location of these genetic control points may provide insight into the genetic and molecular framework responsible for enabling the trait.

in the past decade, the advent of the dna microarray and other high-throughput molecular technologies has updated the paradigm of the qtl. a qtl where mrna expression is the complex trait of interest is generally referred to as an expression qtl or eqtl  <cit> . by using dna microarrays eqtl can be measured for basically all genes in the genome, rendering eqtl data information rich and potentially very powerful. eqtl have been studied in yeast, mouse, rat, human, and plants  <cit>  and eqtl have proven to be useful for elucidating the molecular mechanisms of human diseases  <cit> .

although complex traits are by definition controlled by the coordination of multiple genes, the prevailing techniques for mapping them have been deeply rooted in univariate thinking - testing for genetic association to a trait one locus at a time, ignoring combinatorial effects and interactions. in contrast, broman and speed  <cit>  defined the qtl problem as one of multivariate variable selection, where ideally all loci and their combinations are allowed to enter and exit the model as the data dictate. viewing eqtl mapping as a variable selection problem opens the door to using a host of machine learning algorithms which have rarely, if at all, been applied to qtl and eqtl studies  <cit> . such a fresh look at the qtl problem may help to uncover latent and meaningful information in otherwise underexploited data.

a systematic comparison of eqtl mapping approaches is necessary to inform the research community which methods work best and in which contexts. toward that goal, the purpose of this work is twofold. first, we establish a framework for comparing available eqtl mapping methods based on the tendency of each method to map eqtl that are systematically supported by external biological data. this is important because methods papers proposing new qtl mapping techniques often draw their conclusions either solely or largely on the basis of simulated data  <cit> . this is perhaps understandable in the case of earlier work with qtl, where only a limited number of phenotypes were available and external knowledge about their context and probable genetic regulators was not available in a systematic form, making biology-based benchmarking difficult. however, this is not the case in the era of eqtl. although some genes remain uncharacterized, there are rich sources of data for many genes that give insight about their role and context within the cell. such knowledge is often contained in databases like the kyoto encyclopedia of genes and genomes   <cit> , which makes using it as a basis for a benchmark easier. our battery of knowledge-driven benchmarks consists of 1) assessing the proportion of cis-eqtl recovered by each method, 2) testing each method's high-scoring eqtl for enrichment of loci related to the target by kegg pathway information, and 3) agreement of each method's high-scoring eqtl with systematic loss-of-function studies. in this framework we tested three variable importance measures from random forests   <cit>  as well as sparse partial least squares   <cit> , the lasso  <cit> , the elastic net  <cit> , haley-knott regression   <cit> , and composite interval mapping   <cit> . we also performed simulations to complement the findings of the knowledge-driven benchmarking framework. we show that multi-locus methods in general  are better at recovering biologically meaningful loci than traditional qtl mapping methods such as hk and cim. second, we demonstrate that based on both simulations and the knowledge-driven benchmarks, rf shows superior performance as an eqtl mapping method. rf has previously been applied to genome-wide association studies  and qtl studies  <cit> . the contribution of our work, however, lies in the discovery that the most naive measure of variable importance in rf, the variable selection frequency , actually performs much better than the more popular permutation importance  in this context. since rfsf has been ignored in all previous works using rf in the qtl or gwas context, its use here represents a novel eqtl mapping method with demonstrated superior performance.

RESULTS
in order to evaluate the performance of the eqtl mapping methods in a comprehensive way, we used both simulated data and a variety of published and previously unpublished experimental data from mouse and yeast. the mouse data sets include gene expression data from four tissues of recombinant inbred  bxd mouse strains: regulatory t-cell , lung , hematopoietic stem cells  <cit> , and hippocampus  <cit> . the yeast data were taken from  <cit> . further details are available in the methods section.

we note here that one of the goals of this comparison is to determine how susceptible each method is to the effects of linkage disequilibrium. in light of this goal we used all genotype data as-is, without prefiltering or fusing markers, or assigning surrogate eqtl post-hoc. this enables a straightforward comparison across all mapping methods.

simulations
we first set out to examine the performance of each method when the underlying model generating the data was known completely. we used the actual bxd genotypes and generated traits based on four models: single causal locus, two epistatic causal loci, three additive causal loci, and three epistatic loci. these configurations were sufficient to clearly distinguish the performance of the methods. further details of the construction of the simulated data are given in the methods section. the goal of this investigation was to determine how well each method performed at placing all causal loci in the 99th percentile of scores, over a range of increasing gaussian noise in the trait. the results are given in figure  <dig>  in the single locus scenario, the performance gap between the newer multi-locus methods  and the legacy methods  is quite apparent. in the single locus case, hk and cim are unable to correctly identify causal loci in traits with more than  <dig> % noise, and fail almost completely at pinpointing causal loci in the more complex two and three locus models. the elastic net and rf deliver comparable performance in the more complex models, with rf performing better in epistatic scenarios and the elastic net performing slightly better in the three-locus additive model. it should be noted that while spls, the lasso, and the elastic net do not explicitly search for interactions, they may still find loci participating in epistasis due to small but detectable marginal effects of the interaction.

cis-eqtl counts
a "back of the envelope" approach for gauging the practical performance of a mapping method is the proportion of cis-eqtl found among all target transcripts in experimental data. since promoter regions are often polymorphic, one would expect under optimal conditions to be able to recover an eqtl at the genomic location of many of the examined target transcripts. in this sense, the "external information" used in the benchmark is the knowledge of the genomic location of the gene -- which, when compared to qtl in general, is information unique to eqtl. the results of this assessment are shown in figure  <dig>  taken individually, no single method dominated the others. however, the legacy methods  again showed poor performance when compared to their more modern counterparts. a relationship between study size and proportion of recovered cis-eqtl is also uncovered, with the larger studies  generally yielding higher proportions of cis-eqtl than smaller studies .

kegg enrichment
we used the pathway information available in the kegg database to establish relationships between target genes and potential regulators. kegg was chosen because of its position as a standard in pathway information and because it is generally a better reflection of the molecular relationships between genes . however, in principle other sources of pathway information could be used. one would not expect to recover an entire pathway in every eqtl map, but on a large scale there should be some overlap between the eqtl and the relationships contained in kegg. we assert that methods that show higher agreement with the information in kegg are more desirable for eqtl mapping. we formalize this by assessing the enrichment of high-scoring eqtl for loci near genes known to participate in the same pathways as the gene whose expression trait is being mapped. a graphical depiction of this idea is given in figure  <dig> and further details on the enrichment test are given in the methods section.

we tested pathway enrichment in yeast and mouse eqtl separately. for yeast, we included an additional enrichment test, which connected target genes not to pathways in which they participate, but to pathways in which the target's known transcription factors participate. we used the distributional properties of the enrichment p values to compare the eqtl mapping methods, with results for the yeast data shown in figure  <dig>  it should be noted that hk did not deviate significantly from the uniform distribution in either the pathway member or the tf-centric enrichment tests . in contrast, rfsf showed superior performance on the yeast data .

the mouse data showed more modest enrichment across all tissues and with all methods, suggesting perhaps that larger studies are needed to better recover the complex regulatory systems present in higher eukaryotes . all methods yielded significant deviation from the uniform distribution in each tissue . again, rfsf yielded the greatest degree of enrichment in all tissues. spls, the lasso, and the elastic net produce sparse models, which means that not all loci are assigned a coefficient as a score. this had the effect that for a small minority of expression traits, the 99th percentile of scores contained a small number loci with scores of  <dig>  we examined whether this effect put these sparse methods at a disadvantage for the enrichment tests. we found no systematic relationship between enrichment p value and the number of  <dig> scores in the 99th percentile.

mutant expression change enrichment
finally, we combined data from two systematic loss of function studies  <cit>  to see which method produced eqtl that agreed most with the mutant data.

in this test, we collected the maximum absolute expression change observed for each target gene when genes co-localized with eqtl in the 99th percentile are mutated. these values were aggregated over all target genes, forming a distribution for each eqtl mapping method. we compared these distributions to a null distribution  via the kolmogorov-smirnov test. we assert that the method that yields eqtl that are enriched for large changes in expression in the mutant study is the most desirable method.

all methods produced score distributions that deviated significantly from the null distribution, suggesting that there is indeed consistency between the yeast eqtl data and independent mutant data. although all methods showed significant deviation from the null, the magnitude of enrichment varied widely . rfsf showed the most significant enrichment, followed closely by hk.

discussion
high-throughput data make functional benchmarking of eqtl mapping methods possible
augmenting eqtl with independent information has been done previously to strengthen hypotheses suggested by the eqtl data  <cit> . although these applications demonstrate a certain degree of correspondence between eqtl data and external data sources, and imply that such correspondence is desirable in an eqtl mapping method, no benchmarks based on the systematic recovery of biological information have been proposed and applied to a wide variety of mapping methods and data sets. validating the performance of mapping methods is important not only for those whose analysis ends with an eqtl map, but also for more sophisticated algorithms such as lirnet  <cit>  and geronemo  <cit>  which build on top of basic mapping concepts. our analysis, combined with previously cited works that integrate eqtl with other data, show that there is indeed agreement among eqtl and data from different sources. maximizing this agreement should be a core objective of future mapping techniques. we hope that this approach to benchmarking, in addition to traditional simulated benchmarks, will help practitioners find the appropriate method now, and lead to the development of better mapping methods in the future.

multi-locus eqtl mapping methods outperform legacy methods
with few exceptions, the legacy methods -- hk and cim -- stood out as the poor performers, particularly in the simulations, cis-eqtl proportions, and enrichment for kegg pathway relationships. in preliminary analyses, we found related univariate mapping methods such as em interval mapping  <cit>  and anova to have performance almost indistinguishable from hk . this observation is important because even at the time of this writing there are still eqtl papers being published that use legacy mapping methods for their analysis  <cit> , ostensibly because the more modern methods are not as accessible. in light of our results, we expect that these studies have not exploited the full potential of the collected data. this represents a challenge for the computational community of working to promote not just the development, but also the adoption of these more advanced methods.

there is a fundamental difference in how the legacy linear methods  and the multi-locus linear methods  score loci. the univariate mapping methods rely on a lod score  that expresses the significance of the estimated correlation between a single marker and the trait, resulting in thousands of individual modeling attempts per expression trait. the multi-locus methods, in contrast, assign coefficients to multiple loci in a single final model. these coefficients are then used as locus scores. the disparity in performance between the two classes of methods is likely a result of scoring by contribution to the model , rather than scoring by significance .

rf offers a third paradigm for scoring that is conceptually similar to the coefficient approach of the multi-locus linear methods, though distinct in implementation. each of the three importance measures derived from rf measures a locus' average contribution in an ensemble of models. this differs from the coefficient approach in that it is a summary of multiple models, each including multiple loci, rather than a summary of a single model including multiple loci. additionally, the multi-locus linear methods do not implicitly allow for the inclusion of epistatic interactions in the locus scoring process, while rf does.

it should be noted that the benchmarking process described in this work did not focus on the methods' abilities for statistical inference, that is, determining whether a locus significantly explains an expression trait. instead, our benchmarks focused on which methods prioritized the loci with the greatest degree of effectiveness over a large panel of data. if statistical inference is desired, appropriate permutation of the data can be performed to obtain a null distribution of scores for the chosen method, which can then be used to assess significance of the scores.

we evaluated all experimental data sets and compared the loci that each method scored in the 99th percentile. in general, the multi-locus approaches showed agreement amongst themselves, with an average 49% overlap. figure  <dig> highlights the lack of consistency between the legacy methods and the multi-locus methods, and amongst themselves.

random forests selection frequency maps the most biologically consistent eqtl
random forests   <cit>  is a classification and regression algorithm based on fitting an ensemble of trees. when mapping eqtl, rf fits decision trees by using markers as predictor variables, i.e., each node in a tree corresponds to a split of the population based on the genotype at the selected marker. by combining an ensemble of many diverse decision trees, rf guards against overfitting and also provides several measures of predictor variable importance. in this work, these measures of variable importance are used to map eqtl.

although multi-locus methods in general outperformed the legacy methods hk and cim, rfsf showed the most consistent performance overall. in the simulations and cis-eqtl proportion test it was among the best, and in the kegg and mutant enrichment tests it outperformed the competitors. this finding is somewhat surprising because rfsf is virtually ignored as a variable importance measure in most applications of rf, including qtl and gwas  <cit> . avoiding rfsf may have several explanations. for instance, it has been shown previously that rfsf can be biased. this bias manifests itself in the case of continuous or categorical predictors that vary widely in their scales or number of categories  <cit> . this is typically not an issue in the case of genotype data, where all predictors are categorical with the same number of categories. however, rfsf can also be biased when there is a significant degree of correlation between predictors, which is the case with genotype data. under these conditions, rfsf preferentially selects variables  with low correlation to other variables; markers in linkage disequilibrium are under-selected. in order to estimate and account for this bias, we add or subtract the deviation from the mean selection frequency observed under the null hypothesis . see methods and figure  <dig> for details.

we decided to investigate further the potential reasons why rfsf performed better than the more typically used rfpi or rfrss. we hypothesized that perhaps rfsf picked up on smaller effects near the leaves of the trees, i.e. it is able to detect loci with very subtle effects on the trait. to demonstrate this, we use the largest data set  and grew several rfs with different characteristic tree depths. we then tested these forests with the cis-eqtl proportion test and the kegg enrichment test . we found that increasing the depth of the trees had a modest effect on the performance of rfpi and rfrss, with an increase in percentage of cis-eqtl from  <dig> % to  <dig> % and  <dig> % to  <dig> %, respectively, and an increase in d statistic  from  <dig>  to  <dig>  and  <dig>  to  <dig> , respectively. conversely, rfsf benefited more from the deeper forests, with an increase in percentage of cis-eqtl from  <dig> % to  <dig> % and an increase in d statistic  from  <dig>  to  <dig>  . in addition, we found that agreement with the linear methods  was at its highest when the tree growth was stopped early; similarity decreased with increasing tree depth. this effect was more pronounced for rfsf than for the other rf importance measures, which further suggests that the effects found near the leaves of the trees are connected to rfsf's superior performance .

to further explore this idea, we performed simulations where the expression trait was a function of eight loci, two with strong effects, and six with small effects. as expected, the loci with the stronger effects were used in splits closer to the root node. the causal loci with weaker effects were used to split closer to the leaves. in these simulations, rfsf scored the weak causal loci in the 99th percentile  <dig> % of the time, while rfpi scored the same loci in the 99th percentile only 10% of the time. these simulations also showed that rfpi is tightly coupled to a variable's proximity to the root node, while rfsf can give high scores even if the variable is not used close to the root node.

from these investigations we conclude that rfpi and rfrss both essentially determine variable importance near the roots of the trees, and that biologically important splits further down the tree are not adequately reflected in the overall importance scores. rfsf on the other hand, recovers more biologically meaningful predictor variables  when trees are grown deep, suggesting that even splits far down the tree can be reflected in this importance measure. epistatic effects are an example of where this phenomenon is important -- often genetic interactions are weak and only present in a subset of the population. such conditional effects are likely to manifest themselves deeper in the trees. rfsf is an attractive measure in these situations.

because of its demonstrated performance advantages in finding biologically relevant loci, its ability to implicitly consider epistatic interactions, as well as its straightforward and readily available implementation, we recommend using random forests for eqtl mapping. we have prepared a short tutorial and example r code demonstrating mapping eqtl with the bias-corrected selection frequency at http://cellnet.biotec.tu-dresden.de/rfsf.

marker density and analysis strategy
in this work we examined studies with genotype data in the range of thousands of markers. with the advent of next-generation sequencing and other ultra high-throughput methods, we expect to see more and more studies with hundreds of thousands, millions, or even tens of millions of snps. we wish to put the presented work in context by drawing a distinction between filtering methods, mapping methods, and explicit models .

the state of computer hardware at the time of this writing makes the multi-locus methods presented here impractical for exhaustive evaluations of data sets with millions of snps and tens of thousands of expression traits. the current solution to this problem is to filter the snps to a more tractable number using univariate tests or expert knowledge  <cit> . considering the joint effects of markers at this point is generally a fruitless effort, given the astronomical number of potential combinations and the problem of dealing with false positives.

as the number of markers considered falls into the tens of thousands, the problem transitions from filtering to mapping. mapping is a combination of modeling and feature selection, and the methods we explored in this work address the mapping problem. here the interplay between loci becomes important for accurately identifying the causal regions that should be included in an explicit model of the trait.

once causal loci have been identified reliably and the relationships between them have been characterized , one can construct a linear model, usually consisting of a handful of terms, that accurately describes the trait as a function of the genetic state of the organism. such an explicit model, though desirable, is rarely attained.

implications for related mapping problems
most of the conclusions from our work have implications beyond eqtl mapping. ideally, the concept of a knowledge-driven benchmark could be used for any physiological trait, but our approach depends on a fairly detailed knowledge of the molecular mechanisms underlying the mapped trait. neither our notion of measuring the enrichment of regulator-target gene groups in common pathways, nor our counting of cis-eqtl is immediately extendible to physiological traits. still, taken together, the evidence from this study indicates that qtl mapping - whatever the trait - should be performed using a multi-locus method. using univariate methods such as hk will lead to severe underexploitation of the data.

some of the more specific conclusions from our work will need further validation in other organisms and populations. for example, the study populations used here all had roughly a 50/ <dig> distribution of two possible alleles at each marker. human populations are characterized by very uneven distributions of snps, where minor alleles can be extremely rare in a given population. such a change in the characteristics of the data could influence the ranking of the individual methods. however, such fluctuations in the individual rankings are still unlikely to affect the general conclusion that multi-locus methods produce more informative results than univariate methods, even in gwas and linkage studies in outbred populations  <cit> .

finally, in this work we observed the expected relationship between study size and power to detect biologically interesting loci. we explored this phenomenon explicitly by taking subsets of decreasing sample size from the hippocampus study, and then comparing two representative methods - here rfsf and hk - using the cis-eqtl and kegg enrichment benchmarks. the results are depicted in figure  <dig> and clearly show that while both methods show improvements with additional samples, it is rfsf, the multi-locus method, that shows consistently better performance, regardless of the sample size. this suggests that even in studies with small sample sizes, multi-locus approaches are preferable to single-locus methods.

CONCLUSIONS
we have compared modern machine learning and regression eqtl mapping methods with more classical mapping approaches from statistical genetics, and evaluated the methods based on their ability to lead users to loci that are more readily supported by external information. we found that the modern methods, which freely allow the consideration of all loci simultaneously, generally outperform their classical counterparts in this regard. in particular, we found that random forests consistently mapped the most promising eqtl. random forests bias-corrected selection frequency, a novel importance measure, performed better in these tasks than the established permutation importance and rss importance.

