BACKGROUND
the ancestors of crops were originally domesticated and bred because they exhibited specific extraordinary features that made them useful for human consumption, animal food, or ornamental display. understanding the genetics of these man-selected features involves the identification of underlying qualitative and quantitative trait loci  through genetic mapping.

mapping efficiency and ultimately the ability to isolate interesting loci can be improved by facilitating information transfer from genetic model species to crops and vice versa. synteny, the conservation of gene order along the chromosomes of related species, is a genomic property that can be exploited for this purpose . shared genetic loci can be used as landmarks for the alignment of linkage groups, thereby defining large chromosomal blocks . the alignment of sequences from related species often reveals the presence of short regions of sequence conservation . comparing genomic sequences of genetic models such as arabidopsis  <cit>  and rice  <cit> , with large collections of ests from related plants, enables the identification of shared loci instrumental in projecting the large and repetitive genomes of many crop species onto the genomes of the model species. however, comparisons between genetic maps of distantly related species are usually difficult and less productive. genomes often undergo chromosomal rearrangements, such as inversions, translocations, duplications, deletions and cycles of polyploidization followed by diploidization  <cit> . plants, given their sexual promiscuity and potential for vegetative reproduction, are particularly prone to genome rearrangements  <cit> . for example, whole genome duplications have occurred at several occasions during the evolution of modern plant species  <cit> . in the diploid phase, members of a duplicated gene pair are retained or deleted at random in the two duplicated regions, obscuring their common past. this process results in diminished congruency between two genomes that are separated by a polyploidization-diploidization cycle. hence, in order to avoid the pitfalls of comparative genome mapping, the species to be compared should be carefully chosen.

a central step in genome comparisons is the identification of sequences that can readily be identified in genomes of the species to be compared and serve as "anchors" of their respective genetic maps. commonly used markers, such as microsatellite or aflp markers, can give high resolution genetic maps, but are of little comparative value since they are not necessarily conserved across species boundaries. anchor sequences should be chosen to maximize the potential to serve as markers in several species, and allow the quick estimation of congruency between genetic maps of the organisms. first generation comparative maps of plants relied on southern hybridization of highly conserved homologous probes and their scoring as rflp markers  <cit> . markers requiring southern hybridization, although informative, are time consuming and labor intensive. furthermore, it can be difficult to generate specific hybridization markers, due to cross-hybridization to other genomic regions. pcr based markers are much more efficient as they are amenable to high throughput automation and, if well designed, of high specificity. towards this goal we employ a genome-wide strategy based on the identification of low-copy evolutionarily conserved sequences within transcribed sequences of representative species. these regions are used as primer annealing sites for pcr amplification of intercalated introns that are subsequently sequenced in order to ascertain polymorphisms between mapping parents. this approach ensures that non-repetitive, transcribed regions of the genome are the primary targets of mapping efforts.

here we present an automated pipeline for generation of comparative anchor tagged sequence markers  and apply it to design a set of legume anchor markers.

RESULTS
the aim of the bioinformatics pipeline was to develop plant family anchor markers useful in order to exploit colinearity between genomes of species with dense genetic maps and crops with important agronomic traits. sequence polymorphisms constitute the basis of molecular genetics and methods using polymorphisms in noncoding regions like introns are more effective due to differences in evolutionary rate of dna changes. functional coding regions and regulatory elements undergo purifying selection, whereas, intron sequences are less constrained and will display a higher degree of mutational variation between any two ecotypes/varieties. previously, we have developed software for automated multiple alignment-based primer-finding  that proposes primer pairs in regions of high conservation for pcr amplification of intervening sequences of low conservation, such as introns  <cit> . the algorithm employed by the cats proposing pipeline is best illustrated as a series of consecutive comparative selection filters followed by automated primer-design using prifi .

identification of legume cats
in the first step of the pipeline the experimenter selects gene sequences for processing. genome colinearity erodes with phylogenetic distance. it is therefore crucial to choose the resources that allow maximal information transfer between species. parameters that we considered include the amount of est information and their phylogenetic relationship. in order to develop legume cats, we chose resources originating from lotus japonicus, medicago truncatula, phaseolus vulgaris and glycine max. the phylogenetic relationship between these species is depicted in figure 2a. we have used the ready-clustered est collections downloadable from tigr as input, but any assembled collection of ests could serve equally well serve as entry points.

repetitive sequences are not useful for mapping purposes since polymorphisms might reflect paralogous origin rather than allelic variation. furthermore, allelic variation at a candidate marker locus can be partially or completely masked by the presence of paralogous sequences, reducing the information content of such a marker. for example, the arabidopsis genome has more than  <dig> genes containing the extremely well conserved protein kinase domain. clearly, such sequences are not well suited to identify unique anchors between genomes. also, only truly orthologous sequences are able to reveal the syntenic relationships. homologous single copy genes in any two genomes are very likely being true orthologs. since no legume genome sequence is complete yet we are relying on legume-derived est data in this study. the gene copy number in legumes can be indirectly estimated by counting the number of paralogous sequences in the full set of inferred protein-coding sequences  of a reference species with a complete genome sequence. for legumes, arabidopsis is the phylogenetically closest species with a complete genome sequence available. since arabidopsis has been subject to a recent whole genome duplication  <cit> , its proteome reference provides a conservative copy number estimate for legume proteomes. therefore, we allow legume cats candidates to have one or two homologs in arabidopsis .

the species name is followed by the release version , and the number of gene indices  are indicated for each species. numbers of ests with one and two arabdopsis homologs are listed. the numbers in parenthesis indicate the number of gene indices which show an intron when compared to the respective genomic sequence. l. japonicus gis were compared to l. japonicus genomic sequences, whereas m. truncatula gis were compared to m. truncatula genomic sequences.

in the next step, the selected est sequences are aligned with corresponding genomic sequences in order to score intron positions and lengths. this ensures maximal chances of detecting polymorphisms between mapping parents at later steps, since intron sequences are under relaxed evolutionary constraints. intron position and approximate length, however, are strongly conserved features, even over long evolutionary distances  <cit> . here, we make use of the l. japonicus and m. truncatula genome sequences  <cit> , but the general idea could easily be extended to the arabidopsis or poplar genome sequences  <cit> , given the conserved nature of intron positions. we also score the length of introns. this parameter is of interest for two reasons:  short introns are less likely to be polymorphic than longer ones, and  using standard polymerases the amplicon size is limited to a maximum of ~ <dig> kb. aligning l. japonicus est sequences to the l. japonicus genome identified  <dig> sequences with introns of appropriate length. alignment of m. truncatula ests to the m. truncatula genome identified  <dig>  sequences with introns of appropriate length.

next, homologous ests from as many as possible of the four legumes with the same best arabidopsis protein match are aligned. one of the included ests must originate from l. japonicus or m. truncatula and alignment to its gene must reveal the presence of at least one intron of appropriate length.

in a final step, the pipeline designs optimally spaced intron-spanning forward and reverse primers in conserved regions of multiple sequence alignments. to select the optimal primer set among all possible combinations of primers for any multiple alignment, a number of criteria must be met. these include the number of taxons in the alignment, the melting temperature and gc content of the proposed primers and the length of the intron separating the two primers. also the distance from primer site to the exon-intron junction is considered, since primers that are located too close to an intron will not allow positive sequence confirmation of the pcr product. a combined score for each primer pair allows their comparison and ranking within and between candidate regions. using stringent cutoff levels, primers for a total of  <dig> cats loci were produced applying these steps . of these, we were able to position  <dig> on the l. japonicus genetic map and  <dig> on the m. truncatula map . four markers have map-positions in both maps. although the sequencing of the two legume genomes is still incomplete, all chromosome arms from both m. truncatula and l. japonicus are represented.

synteny between to genomic regions can only be established if markers are true orthologs. orthology between genes from different species is indicated by the matching of gene trees and species tree. to test this, we constructed a neighbor-joining tree for each alignment. of a total of  <dig> gene trees,  <dig>  topologies were incompatible with the species tree, potentially due to sequences of paralogous origin in the alignment. these cats should be treated with care.

the sequence alignments, phylogenetic trees, known map positions, primer reports and gene annotations of all cats are web-accessible  <cit> .

potential for marker development in the grass family
the development of legume cats relied on the identification of introns through comparisons of est sequences to still incomplete m. truncatula and l. japonicus genomic sequences. sequencing of both  <dig> mbp model legume genomes is still in progress  <cit> , and our analysis is based on  <dig> mb of l. japonicus genomic sequence and  <dig> mb of m. truncatula genome sequence. completion of the gene rich sequences of these genomes will allow more cats candidates to be identified in the near future. to demonstrate the potential and versatility of the pipeline we applied it to the grass family  where both a complete rice genome and large est sequence collections are available. the input data files of step one were chosen to represent maximal phylogenetic diversity and sequence information in grasses. the coding sequences of the well annotated rice genome sequence served as one species, and est collections of wheat and sorghum as the two comparison sequences. introns were defined by the rice annotation, and the number of paralogous rice sequences was tallied from selfcomparison of the rice proteome. otherwise we followed the pipeline as outlined for legumes above. in total we were able to identify  <dig> grass cats primer pairs. the distribution of these cats on the rice chromosomes is shown in figure  <dig>  all chromosomes are covered. when developed as markers and mapped in several species, these could add considerable density to existing comparative mapping databases such as gramene  <cit> . the data for grass cats developed here is web-accessible  <cit> .

testing legume family anchor markers on the outlier peanut
peanut  represents a phylogenetic outgroup to the clade from which the legume sequences were sampled. hence, it provides a challenging opportunity to assess the potential of our pipeline to generate pan-legume family anchor markers. recently a microsatellite marker-based genetic map of the aa component of the allotetraploid genome of peanut, has been developed  <cit> . this map was developed using a mapping population derived from a cross between a. duranensis, the most probably aa genome donor of peanut, and the closely related a. stenosperma. anchoring this map to the genome sequence of l. japonicus and m. truncatula will be a central next step in the development of arachis genetics. towards this goal, we tested  <dig> legume family cats primer pairs which were designed based on the degenerate consensus sequence of the multiple alignment of two to four ests included in the legume cats pipeline. testing was performed on the in-clade representative common bean and the outlier arachis to evaluate the robustness and general applicability of the pipeline. we determined whether these primer sets amplified the correct sequences, and scored polymorphisms between mapping parents of central mapping populations for both species . of the  <dig> tested primer sets,  <dig> and  <dig>  amplified the expected product for arachis and bean, respectively. sequencing of the pcr products revealed that  <dig> % of the arachis cats were polymorphic between arachis duranensis k <dig> x a. stenosperma v <dig>  among the bean cats,  <dig> % were polymorphic between the mapping parents bat <dig> x jaloeep <dig> 

discussion
the automated bioinformatic pipeline described here allows the large-scale generation of marker candidates useful for map construction and comparisons in legumes and grasses and, by extension, to any phylogenetic clade with appropriate comparative sequence information. since only unique sequences are unambiguous as markers, the number of paralogous sequences in the target genome is of interest. an approximation to this number is obtained by counting homologous sequences in the proteome of a reference species. since no legume genome has been completely sequenced to date, the pipeline relies on est data and is not able to discern between orthologous and paralogous origin of homologous sequences. however, selecting sequences with only one or two homologs in the arabidopsis reference proteome enhances the probability of an orthologous relationship between homologous legume ests. for 88% of the cats candidate developed here, the gene tree follows the species tree, suggesting orthology. although these indirect criteria maximize congruency when comparing maps, they by no means guarantee it. a common ancestor of the legumes has undergone a whole-genome duplication  <cit> , potentially obstructing congruency through differential gene loss in duplicated chromosomal regions. whereas macrosynteny is not recognizable between m. truncatula and arabidopsis  <cit> , microsynteny is generally much better retained  <cit> . within a given clade, such as legumes or grasses, both micro- and macrosyntenic relations are readily identifiable  <cit> .

a main application of this algorithm is the transfer of genome information between model species and closely related large genome crops. dense genetic maps spanning all linkage groups are of invaluable help for breeding purposes. comparison to genomes of other species, especially model species, can help in the development of new markers in regions of interest and may allow educated guesses at candidate genes in the region under investigation. it is therefore advantageous to use markers that can serve as syntenic anchors, connecting genetic maps of as many species as possible.

 <dig> legume cats were recently published  <cit> . here we extend this collection significantly by automating the bioinformatics tasks involved. applying this pipeline to the currently available legume est and genome data, we were able to identify  <dig> cats. an interactive table of these cats primers along with est alignments, bac sequences and l. japonicus and m. truncatula map positions is web-available  <cit> .

currently, the number of cats to be identified in legumes is limited by the incomplete m. truncatula or l. japonicus genomic sequences. the sequencing of these genomes is still in progress and will hence allow the identification of many more cats candidates in the future. given the conserved nature of intron position and approximate length  <cit> , the arabidopsis genome sequence might be equally valuable for the identification of introns, a strategy which has been employed by choi et al.  <cit> . however, apart from increasing the number of cats, such a measure does not allow the linking of genetic map information to sequence information in legumes.

it might be useful to include est collections from other related species for example ests from mung bean  in the case of the legume family. for this purpose, we have developed a web-based service, gemprospector  <cit> , that allows the user to submit other est collections to the pipeline, both for legumes and grasses.

the genome sequence used for defining introns makes it possible to sample cats with even dispersal across all linkage groups or enriched in chromosomal regions of interest. as expected, the success-rate of pcr amplification using degenerate primers decreases with phylogenetic distance of the test species from the species chosen to provide the sequence information for the pipeline. the ability to predict successful primer pairs at the phylogenetic distance between the outlier arachis and the clade defined by m. truncatua, l. japonicus and soybean is remarkable and demonstrates the success of the pipeline.

CONCLUSIONS
we present a general framework for the automated design of cats marker candidates through mining of large-scale sequence collections of diverse origin. the accompanying databases allow legume and grass researchers to get instant and easy access to unprecedented numbers of cats. apart from their use as comparative anchor markers, cats will be useful in the estimation of population genetic parameters such as allele frequencies, effective population sizes and inbreeding coefficients in natural populations and outbreeding crops.

