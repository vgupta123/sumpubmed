BACKGROUND
the challenges being faced in sorting out short genomic fragments generated by metagenome sequencing projects  <cit>  pose a fundamental question: "does each genome have a unique signature imprinted on its short sequence fragments so that fragments from the same genomes in a metagenome can be identified accurately?" a positive answer to this question could have significant implications to many important genome and metagenome analysis problems such as identification of genetic material transferred from other organisms  <cit>  or through virus invasions  <cit> , separation of short sequence fragments generated by metagenome sequencing into individual genomes  <cit>  and phylogenetic analyses of genomes  <cit> .

understanding the intrinsic properties of genome sequences, either general to all or specific to some classes of genomes, has been the focus of many studies in the past two decades. earlier work includes the discovery of the periodicity property of dna sequences across both prokaryotic and eukaryotic genomes  <cit>  and the realization that coding sequences follow markov chain properties  <cit> . karlin and colleagues have studied various genome properties based on analyses of k-mer frequency distributions, and have observed that the di-nucleotide relative abundance, a normalized di-mer frequency with respect to the mono-mer frequencies, is generally stable across a genome measured on  <dig> k base-pair  fragments  <cit> . they even suggested that such normalized di-mer frequency distributions can possibly serve as signatures of genomes.

in this paper, we present a barcoding scheme for all sequenced genomes, and illustrate a number of interesting and useful properties of the barcodes, which we can take advantage to solve challenging genome analysis problems. we highlight the power of this barcoding scheme through addressing two application problems: metagenome binning problem and identification of horizontally transferred genes.

RESULTS
barcodes and their properties
we have calculated the barcode for each sequenced prokaryotic genome, using the following procedure. for each genome, we partition its sequence into a series of non-overlapping and equal-sized fragments of m bps; then for each k-mer , we calculate the combined frequency of the k-mer and its reverse complement within each partitioned fragment. the barcode for each genome is a matrix of n columns and genome_length/m rows, with each element representing the frequency of the corresponding k-mer within the corresponding sequence fragment, where n is the number of unique combined k-mers. note that n = 4k/ <dig> or / <dig>  depending on whether k is odd or even. for example, n =  <dig>  the portion of the barcode corresponding to a fragment in a genome is called the fragment's barcode. in this paper, barcodes are calculated using m =  <dig> and k =  <dig> unless stated otherwise. a discussion on our choices of the m and k values is given in additional file  <dig>  where we can also see that the above "equal-sized" requirement is not necessary.

for each barcode, we have created a grey-level image, a barcode image, by mapping the k-mer frequencies to grey levels using a procedure given in the methods section so that darker grey levels are for lower frequencies. figure  <dig> shows the barcode images for five prokaryotic genomes. a key advantage of having barcode images is that they provide an intuitive, informative and global view of genomes, from which various genomic features become immediately apparent. this view can be used to guide our rigorous statistical analyses of genomes. we have calculated the barcode images for all  <dig> sequenced prokaryotic genomes, which are all accessible at  <cit> , along with the barcode images for other classes of genomes.

from these barcodes , we observed that  all chromosomal genomes have remarkably stable 4-mer frequency distributions essentially for all 4-mers, giving rise to the vertical bands with consistent grey levels across each barcode;  the small fraction of the fragments with clearly different, abnormal, barcodes  than the rest of the genome typically represent 2– <dig> special classes of genes ;  multiple chromosomes of the same organisms generally have highly similar barcodes ) but they each have their unique patterns of abnormal fragments; and  the barcodes similarities tend to be generally proportional to the genomes' phylogenetic closeness ).

to understand why a genomic sequence has the barcode property, we have examined random nucleotide sequences generated using different models, including markov chain models of order from  <dig> to  <dig>  we observed that barcodes for random nucleotide sequences generated using a third-order markov chain model are the closest to the barcodes of genomic sequences in terms of their appearances , and higher order markov chain models do not seem to add much to this property. hence we believe that the barcode property of prokaryotic genomes is mainly due to the third-order markov chain property of the coding sequences in the genomes, which count for 80–90% of a typical prokaryotic genome. it is worth noting that barcodes for coding and non-coding sequences of the same genome are generally different though they share a weakly similar backbone structure while each of these two classes of  regions generally has highly similar barcodes .

extension to other genomes
in addition to prokaryotes, we have also calculated the barcodes for the other classes of sequenced genomes, namely eukaryotic, mitochondrial, plastid and plasmid genomes. for eukaryotes, we studied the barcodes for four key components in eukaryotic genomes, namely the  regions of repetitive sequences, promoter sequences , coding regions and introns, respectively –). we observed that  different regions in a high-level eukaryotic genome  have similar "backbone" structures in their barcodes, and  the barcodes for the four types of regions have increasingly higher complexity, going from repetitive sequences to coding regions to introns and promoter sequences. this is consistent with the belief that introns and promoter sequences are probably the most information rich among the four because of the possibly large numbers of regulatory elements they encode.

the barcodes of the mitochondrial genomes are generally unique compared to the barcodes of the other genomes as they have a distinct overall appearance –). their similar appearance may be the result of all mitochondria originating from proteobacteria. the barcodes of all plasmid genomes also tend to have similar characteristics among themselves, possibly due to being under similar selection pressure caused by their frequent transferring among cell cultures. the barcodes of all the plastid genomes are also generally unique compared to the barcodes of the others –). for example, a majority of them each consist of two dark horizontal bends toward one end in their barcodes along the genome axis, whose corresponding genomic regions consist of rna genes such as ribosomal rnas and trnas, plus ribosomal proteins. the fuzzier appearance of the plastid barcodes indicates that their k-mer frequencies along the genome axis are not as stable as in the other genomes. the overall similar appearances of the plastid barcodes may be due to all originating from the cyanobacteria.

one interesting question is "do different classes of genomes have their unique characteristics in their barcodes?" our answer is yes, based on their highly separable distributions in the feature space defined by two particular features, as shown in figure  <dig>  one of which measures the overall frequency variation for all 4-mers across the genome's barcode, and the other measures the overall similarity level among all the m-bp fragments of the genome, each considered as a vector of 4-mer frequencies. while figure  <dig> indicates that barcodes generally preserve sequence-level similarities, figure  <dig> suggests that barcodes also capture a higher-level similarity beyond individual genome sequence similarities through the textures of their images, which are the common and unique characteristics of different classes of genomes. this property indicates that barcodes are not just a simple visualization tool, instead they have captured some fairly basic information about genomes! from application point of view, we believe that this feature will prove to be useful to metagenome analyses as fragments from different classes of genomes such as eukaryotes, prokaryotes or different organelle genomes, have different characteristics in their barcode images.

identification of abnormal sequence fragments
our procedure for identifying sequence fragments with abnormal barcodes in a genome employs a clustering strategy to divide all the sequence fragments in a genome into two groups:  a large group of fragments with their barcodes all similar to each other and  the rest .

using this procedure, we have identified  <dig>  abnormal fragments, covering  <dig>  genes across all the complete prokaryotic genomes. specifically  <dig>  such fragments are identified in the  <dig> bacterial genomes, covering  <dig>  genes, and  <dig>  such fragments are identified in the  <dig> archaeal genomes, covering  <dig>  genes. we found that the percentage of fragments with abnormal barcodes ranges from  <dig> % to  <dig> % across all the bacterial genomes, with the average being  <dig> %. among the  <dig> sequenced archaeal genomes, the percentage of fragments with abnormal barcodes ranges from  <dig> % to  <dig> %, with the average being  <dig> %. further information can be found from additional file  <dig>  the detailed frequency information for abnormal fragments across different genomes is in additional file  <dig> <cit> .

while we found that it is generally more challenging to study the abnormal fragments in eukaryotes, we did apply the same procedure to different human chromosomes, and found that the percentage of abnormal fragments ranges from  <dig> % to  <dig> %, with the average being  <dig> %.

we have analyzed the abnormal fragments across the prokaryotic genomes, and found the following: ~30% of the abnormal fragments can be explained in terms of  horizontal gene transfers,  phage invasions and  highly expressed genes, based on phx-pa  <cit>  and prophinder  <cit> , respectively. among the genes that fall into this 30%,  <dig> % are horizontally transferred genes,  <dig> % bacteriophage genes and  <dig> % highly expressed genes, based on the above two prediction programs – note that these numbers do not add up to exactly 30% since there are overlaps among them. the genes falling into different categories are given in additional file  <dig> <cit> . we have carried out an enrichment analysis of such elements in regions with abnormal versus normal barcodes. we found that the highly expressed genes are enriched in the abnormal fragments, with the enrichment ratio >  <dig> across all the genomes and the average enrichment ratio being  <dig> . similar results hold for the horizontally transferred genes and bacteriophage genes. all the detailed data can be found in additional file 2

we noted that our estimate of the percentages of "foreign fragments" in bacterial genomes  is in general agreement with the previous estimates though different information and techniques are used to derive the estimates  <cit> .

we do not yet have an explanation for the remaining ~70% of abnormal fragments in prokaryotic genomes, although we suspect that they mostly fall into the same three categories – one reason that we could not explain them now is possibly due to the limited coverage of the current databases for horizontally transferred genes, bacteriophage genomes and highly expressed genes. we believe that by using more sophisticated computational procedures, one may be able to derive the level of abnormality of a fragment's barcode in a genome, and possibly link such information to when such fragments were horizontally transferred  <cit> .

binning metagenome sequence
the ability to sequence a microbial community has led to the sequencing of at least  <dig>  giga bps of metagenome sequences, already  <dig>  times the total complete genome sequences accumulated in the past two decades  <cit> . these metagenome sequences have opened many doors to new research possibilities, and have posed some challenging problems. one such problem is determining which fragments are from the same organisms in a large pool of metagenomic fragments  <cit> , typically ~ <dig> bps in lengths after the initial assembly using the sanger sequencing techniques.

we have applied a clustering algorithm  for binning sequence fragments together based on their barcode similarities, and tested the clustering strategy on three sets of simulated metagenome data created by cutting actual bacterial genomes into fragments and mixing them together. the three test sets consist of all sequence fragments from three sets of genomes, respectively, extracted from the genbank. the first set consists of  <dig> genomes randomly selected from the same genus but from  <dig> different species  while the last two sets each consist of  <dig> and  <dig> genomes randomly selected from  <dig> and  <dig> different bacterial genera, respectively. the genome names are given in additional file  <dig> <cit> .

to assess the binning ability of our algorithm as a function of the fragment size, we have considered fragment size m =  <dig>   <dig>   <dig> and  <dig>  to test the limit of our binning algorithm, we have also considered m =  <dig>  for each set of genomes, we partitioned each genome into fragments of size m, and then mixed the fragments of the same length into one pool. we then calculated the barcode for each fragment, and did a clustering analysis, assuming that the number of genomes in each pool is known . we have carried out binning predictions, one directly on the generated fragments and one on a reduced set of generated fragments, in which we remove 10% of the fragments from each genome whose barcodes are most different from the average barcode of the genome. the consideration is that each bacterial genome has ~13% of fragments with abnormal barcodes on average, which are not expected to be binned correctly with the rest of their host genome. this way we can more accurately assess the binning ability of our algorithm. table  <dig> gives the binning results on the three sets of synthetic metagenome data, both the original set and the reduced set.

the binning accuracy is defined as / <dig>  and fs is for fragment size, where both the specificity and sensitivity are measured in terms of putting the fragments into the correct bin corresponding to each genome, defined by the majority of the fragments in the bin. the column "original genomes" lists the binning accuracy of our algorithm on all the non-overlapping fragments in each group of genomes, and the column "filtered genomes" gives the accuracy after removing the 10% fragments with the most abnormal barcodes from each genome.

from the table, we can see that the binning accuracy  is high for fragment size m =  <dig> and above, at both the species and the genus level. from the table, we see that there is a drop in the binning accuracy when the number of the underlying genomes is increased from  <dig> to  <dig>  this indicates the increased complexity of the problem as a function of the number of underlying genomes.

we have compared our binning performance with the published results by the best available algorithm phylopythia  <cit> . our comparison indicates that our algorithm gives consistently more accurate and more specific binning results across different fragment sizes. for example, at the species level, our algorithm has better than 50% accuracy on our test set when the fragment size is at least  <dig> bps while no binning results at the species level is given in mchardy et al.  <cit> . at the genus level, the accuracy  and  <dig> in mchardy et al.  <cit> ) by phylopythia is  <dig> % for fragment size  <dig>  56% for  <dig>  74% for  <dig> and  <dig> % for  <dig> , all measured in terms of putting fragments into the correct genera while ours is to the correct genomes and with more accurate binning results. it should be noted that the test set used by phylopythia is different than ours, which may affect the performance statistics somewhat though we suspect that will be insignificant, considering the sizes of the test sets. another key difference between the two algorithms is that while phylopythia is a supervised learning algorithm, which requires a training set, our algorithm does not require a training set, and hence it is more general.

one thing worth noting is that a prokaryotic genome, on average, has ~13–14% of abnormal sequence fragments, when the fragment size is m =  <dig> , suggesting that the theoretical limit for binning accuracy should be no better than 86–87%. similarly we expect that the theoretical limits of binning accuracy for  <dig> ,  <dig>  and  <dig>  fragments-based binning should, in general, be no better than  <dig> %,  <dig> % and  <dig> %, respectively.

discussion and 
CONCLUSIONS
a natural question is "do all nucleotide sequences have the barcode property like genome sequences have?" the answer is no, based on the large number of randomly generated sequences that we have examined. figure  <dig> shows a typical barcode of a random sequence generated using a zeroth order markov chain model. we found that none of the so generated nucleotide sequences has the vertical band structures as in genomes barcodes. more generally, barcodes for genomes and the randomly generated nucleotide sequences have different characteristics as shown in figure  <dig> 

the barcode analyses in this paper are mainly based on data from prokaryotes. though we have applied the same barcode model to eukaryotes and made interesting observations, we suspect that the current barcoding scheme is rich enough to capture all the complexity of eukaryotes. further studies along this direction are clearly needed.

we believe that for many genome analysis problems, particularly for prokaryotic genomes, the barcodes provide a natural, intuitive, information-rich and unified framework for studying them. further applications of this capability to numerous genome analysis problems can be envisioned, such as phylogeny studies, particularly for genomes without obvious marker genes such as viruses, more thorough examination of different types of genomic regions in eukaryotes, their structures and organization, further studies of horizontal gene transfers, assisting in genome assembly of higher-order organisms  and possibly many more. we believe that we have only begun exploring the true power of this new capability for genome studies.

