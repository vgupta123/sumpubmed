BACKGROUND
several monogenic  mutations have been revealed in the cattle genome : although some are useful , most of such mutations are harmful . dominant mutations can easily be purged from the population, since carriers are easily identified and excluded from the breeding stock. recessive mutations, on the other hand, are more difficult to manage: a small proportion of carriers is bound to remain in the population. in case of phenotypic selection  against homozygotes , the frequency of such carriers would asymptotycally approach zero, and the occurrence of the disorder would be a rare event. when top-ranked bulls for relevant breeding objectives are carriers, though, higher frequencies of the mutation remain in the population and the related genetic disorder becomes a more serious issue. this is critical in domesticated cattle -especially in highly specialized dairy breeds- given their specific population structure: high inbreeding, small number of founder animals, declining effective population size and widespread use of artificial insemination, all contribute to making modern cattle breeds particularly susceptible to recessive genetic disorders  <cit> . examples of harmful recessive mutations in cattle include some long known mutations like blad   <cit>  and cvm   <cit> , and some recently detected mutations like the one in the cwc <dig> gene on bta <dig>  in jersey cattle  <cit> .

in the case of harmful recessive mutations, it is essential to identify carriers in order to remove them from the breeding population, or to apply effective mating strategies to counteract the diffusion of the undesired allele and keep its frequency low. the causal mutation of a harmful defect may be already known  or not yet : in this latter case, haplotypes associated with the defect can be detected  <cit>  . such haplotypes may be more or less tightly associated with the underlying mutation: sometimes the association is almost indissoluble as is between the jh <dig> haplotype and the cwc <dig> mutation in jerseys . some other times it is less reliable, as for instance between the hhc haplotype on bta <dig> and cvm: two versions of the haplotype exist, one with and one without the causative mutation  <cit> .

the identification of specific mutations or haplotypes carried by animals is traditionally performed through specific laboratory assays in individual animals. examples include: microsatellite markers  <cit>  or, in cows, milk isoforms for casein variants  <cit> ; specific gene tests for cvm  <cit> . these methods, though accurate, can be expensive and time-consuming. haplotypes can be reconstructed in silico from marker genotypes and pedigree records  <cit> , and have been used successfully for the prediction of κ-casein alleles  <cit> . pedigree records, though, are not always available, and add to the complexity of the analysis. whole-genome snp data are a most valuable source of information and can offer a low-cost and convenient alternative. snp genotypes  are increasingly available for large numbers of animals, as a consequence of genomic selection programmes and research projects, and can be used effectively to predict haplotypes or gene alleles of interest. snp genotypes can be used as they are, or haplotypes can be reconstructed without pedigree information . in a previous study the successful identification of carriers of the bh <dig> haplotype from snp genotypes only was described  <cit> .

in this work, the use of snp genotypes alone for the identification of carriers of harmful recessive mutations in cattle is presented. five classification methods were compared in two cattle breeds with different population and genetic structure, and with opposite carriers to non-carriers ratio. the causative mutation behind the bh <dig> haplotype  <cit>  was used for illustration. this has been recently demonstrated to be a missense mutation in the gene tubd <dig>  and is linked to high juvenile mortality in the brown swiss and fleckvieh cattle breeds  <cit> .

methods
animal population, carrier status and snp genotypes
a population of  <dig> bulls and cows from two cattle breeds was used for this study:  <dig> fleckvieh  and  <dig> brown swiss  animals from farms in austria and southern germany . fleckvieh is a dual-purpose breed , brown swiss is a specialised dairy breed.

all animals were genotyped with the bovinesnp <dig> v <dig>  illumina beadchip. only the  <dig> snps on bta <dig>  were used for the analysis. the missing-rate was  <dig>  % in the fleckvieh and  <dig>  % in the brown swiss. no individual animal had a call-rate lower than  <dig> %; snps with a call-rate < <dig> % were removed from the analysis . residual missing genotypes were imputed based on linkage disequilibrium, using the localized haplotype clustering imputation method implemented in the computer package “beagle” v. <dig> . after imputation, average maf  was  <dig>  and  <dig>  in the fleckvieh and brown swiss population respectively.

a direct gene test was performed on all animals to determine carrier status for the tubd <dig> mutation. genotypes at the mutation site were obtained using a kasp genotyping assay carried out at the laboratory of the technische universität münchen . the mutation of interest was a t > c substitution in the coding region of the tubd <dig> gene, at snp rs <dig>  located at the beginning of bta <dig> . this is the mutation underlying the bh <dig> haplotype in brown swiss and fleckvieh cattle  <cit> , and has been reported to be associated with stillbirth and low calf survival rate . the degree of association between the bh <dig> haplotype and the mutation tubd <dig> is  <dig>  %  <cit> . the mutation causes the substitution of a histidin by an arginine in the tubulin delta  <dig> protein. the function of the protein is damaged, which is thought to lead to defective cilia in the respiratory tract and, consequently, to chronic airway disease in calves. animals were identified as carriers  or not  of the mutation. there were  <dig>  and  <dig>  carriers in the fleckvieh and brown swiss datasets, respectively. data were therefore unbalanced in different directions in the two breeds . table  <dig> summarizes the animal population and snp data.
snps with call-rate < <dig> %
all animals were genotyped with the illumina  <dig> k snp-chip v2; only snps on bta <dig> were used in the analysis




identification of mutation carriers
the identification of mutation carriers from snp genotypes was carried out separately in the two breeds. two parallel sets of analysis were therefore conducted. first, data were randomly split into a test set and a training set. the test set was kept aside, and used only in the end to test the accuracy of the predictive model. the training set was used to build the predictive model: a 10-fold cross validation scheme was adopted to tune hyperparameters, select variables and estimate parameter coefficients. five classification methods were tested: four methods that just use single snp loci as they are: lasso-penalized logistic regression, support vector machines  with linear or radial kernel, k-nearest neighbor ; and one method that builds on haplotype reconstructed from snp genotypes: multi-allelic gene prediction . figure.  <dig> summarizes the procedure.
fig.  <dig> procedure for the identification of mutation carriers. first data were randomly split into training and test set. five classifiers  were trained through a 10-fold cross-validation. the final classification models were applied to the test set for the estimation of the classification accuracy. this process was repeated  <dig> times




classification methods

lasso-penalized logistic regression: the lasso  is a regularization method for regression models  <cit> . the lasso imposes an ℓ
1-norm constraint on the vector of model coefficients, thereby shrinking some parameter estimates to zero and thus selecting variables in or out of the model. the starting point is a logistic regression model for the probability of carrying the mutation in a generalized linear model framework with logit link function: 
  <dig> logit)=logp1−p=μ+∑j=1mzijsnpj 


where p is the p for individual i with vector of predictors x
i; snp
j is the effect of the j
th snp marker; z
ij is the genotype of individual i at locus j . the model in eq.  <dig> was fitted by maximizing the corresponding lasso-penalized log likelihood function  <cit> : 
  <dig> ℒ=∑i=1nyilog+log−λ∑j=1m|snpj| 


the rightmost term in eq.  <dig> is the lasso  penalization; the tuning parameter λ controls the degree of regularization, and was specified through cross-validation. logistic regression returns the log-odds of p which are backtransformed to p through the cumulative distribution function of the logistic distribution . individuals with p>/< <dig>  were classified as carriers or not of the mutation.

the lasso, by setting some of the coefficients to be equal to zero, performs variable selection, thus yielding sparse models involving only a subset of the original variables. lasso regularization is therefore particularly appropriate when many of the predictor coefficients are indeed expected to truly be close or equal to zero. this may apply well to the modelling of mutation carrier status as function of snp genotypes, since snp close to the mutation are expected to contribute largely to the prediction accuracy  <cit> . a regularization method like the lasso estimator was needed for brown swiss, where the number of snps exceeds the number of animals . in the fleckvieh, though not required, still the lasso estimator may be helpful for the interpretation of the model.


svm: two support vector machines  models were fitted for the classification of carriers and non-carriers of the mutation: with linear ) and radial ) kernel functions. in binary classification problems, svm attempts at separating classes by a p− <dig> dimensional hyperplane. svm maps the vector of snp genotypes x∈ℝ into a higher dimensional feature space ϕ∈ℍ and constructs a separating hyperplane -linear in ℝ- which maximises the margin m, the distance between the hyperplane and the nearest data points. the mapping is performed by a kernel function k=〈h,h〉 which defines an inner product of some functions h of pairs of observations in the space ℍ . a kernel is a function that quantifies the similarity between observations. in its basic form, the svm classifier applies the kernel function k to all n <dig> pairs of observations, and returns the following linear  classifier for any observed feature vector x: 
  <dig> f=β0+∑i∈nαik 


the intercept β
 <dig> and coefficients α
i are obtained by maximizing the margin around the separating hyperplane subject to i) allowing some observations to violate the margin m  by a ii) positive quantity ξ, and iii) constraining such violations and misclassifications to sum up to a constant c: 
  <dig> maxβ <dig> α,ξmsubject toi)yiβ0+∑i=1nαik≥m∀iii)ξi≥0iii)∑ξi≤c 


this is a convex optimization problem that is solved with the method of lagrange multipliers  <cit>  by re-expressing all parameters in terms of the α multipliers in the lagrange dual function: 
  <dig> ld=∑i=1nαi−12∑i=1n∑j=1nαiαjyiyj〈,h〉 


the maximization of l
d yields the solutions for the coefficients α, which in turn give us the svm classifier in eq.  <dig>  an interesting properties of the svm classifier is that α
i≠ <dig> only for observations that lie on or within the margin m, the support vectors, thus making svm computations relatively inexpensive.

when h=x, we have the following linear kernel: 
  <dig> k=〈h,h〉=〈xi,xi′〉=∑j=1pxij·xi′j 


where p are the parameters  in the model. the linear kernel quantifies the similarity between observations using pearson correlations and the corresponding svm classifier is equivalent to the support vector classifier  <cit> . the linear kernel produces a linear decision boundary between classes. non-linear decision boundaries can be obtained using more complex kernel functions, like in the radial kernel: 
  <dig> k=exp−γ∑j=1p <dig> 


where the x
ij’s are again 0/1/2-coded snp genotypes. for both svml and svmr the constant c defines how much the margin m can be violated when building the svm classifier; c is therefore a tuning parameter that controls the bias/variance trade-off in svm classification.


knn: k-nearest neighbors  is a general non-parametric classification method. for any given observation x
 <dig>  euclidean distances based on snp genotypes were calculated to identify the k nearest observations defining the neighborhood n <dig> . the conditional probability of carrying or not the mutation was then estimated as the fraction of carriers/non-carriers in n0: 
  <dig> p=1k∑i∈n0iyi= <cit>  


the observation x
 <dig> was then assigned to the class  with the largest probability from eq.  <dig> 


mag: multi-allelic gene prediction  is a method specifically aimed at predicting gene alleles from snp data. as a consequence, it is significantly different from the previously illustrated methods, that are general classification algorithms, and is a representative of the general class of haplotype-based prediction methods. mag was developed for the prediction of hla alleles in humans, but has been previously applied to the prediction of k-casein alleles in cattle  <cit> .

given the snp genotype g
i= and the gene genotype h
i=hi′hi″ of each individual i of a training population t, the method estimates the frequencies pr and pr of the extended haplotypes
hi′gi′ and hi″gi″, where gi′ and gi″ are pairs of snp haplotypes consistent with the observed snp genotype g
i. this estimation is performed, assuming hardy-weinberg equilibrium, by maximizing the following log likelihood function: 
 ∑i∈tlog∑∈Ωpr·pr  where Ω denotes the set of extended haplotypes pairs consistent with the observed genotypes. standard maximization methods  are computationally demanding since the number of haplotypes consistent with the observed genotypes increases at exponential rate as the number of snps increases. mag, instead, is based on an estimating equation approach developed by the same authors that makes computationally more efficient the covariance matrix computation component without invalidating the consistency of the computed haplotype probabilities.

once the extended haplotype probabilities have been estimated, the prediction is simply performed by computing the gene genotype h
′
h
″ that maximizes the probability of having such a gene genotype given the observed snp genotypes using the bayes’ theorem.

for the present application of mag to predicting mutation carriers, carrier and non-carrier status were encoded as heterozygous  <dig> and homozygous  <dig> gene genotypes, respectively.

tuning hyperparameters and measuring prediction accuracy
the data were partitioned into training and test datasets:  <dig> % of the observations  were used to train the predictive model; the remaining  <dig> % of the data  was set aside and used only to measure the classification accuracy. a 10-fold cross-validation scheme was applied to the training data in order to tune the hyperparameters  and estimate the effects of the model. the training data were split in  <dig> subsets of approximately equal size. the first subset was treated as validation set, while the model was fit on the remaining  <dig> subsets . prior to fitting the model, monomorphic and collinear snps were edited out of the training set, to get rid of non-informative and redundant predictors and avoid problems due to linear dependecies. in turn, each of the  <dig> subsets was used as validation set, so that in the end every observation was used both to train and validate the model. the final classification model was then applied to the test set to estimate the accuracy of identifying carriers of the mutation in independent data. these procedure was repeated  <dig> times , each time resampling different training and test sets, eventually yielding  <dig> replicates of the analysis . the procedure is illustrated in fig.  <dig> 

the error rate was estimated as the fraction of misclassified observations: er=1n∑i=1ni. three different error rates were measured: 1) the total error rate  defined as the total number of misclassifications over the total test sample size; 2) the false positive rate  defined as the number of non-carriers misclassified as carriers over the total number of non carriers; and 3) the false negative rate  defined as the number of carriers misclassified as non-carriers over the total number of carriers. ter, fpr and fnr were averaged over the  <dig> replicates to estimate the test error and the variability of the prediction accuracy.

software and computation resources
data preparation and editing, and all statistical analysis were performed using the r programming environment v. <dig> . <dig>  <cit> , except missing genotype imputation, which was carried out with the computer package “beagle” v. <dig> . <dig>  <cit> . the r packages glmnet  <cit> , e <dig>  <cit>  and class were used to fit the lasso logistic regression, svm with linear and radial kernels and knn classification models. mag has been performed using the matlab-based program provided by the authors on their website . the analyses were run on the bioinformatics platform at ptp science park , which includes a high performance computing cluster with  <dig> cpus,  <dig>  tb of ram and  <dig> tb of storage space for archiving and back-up.

RESULTS
the accuracy of identifying carriers of the tubd <dig> mutation on bta <dig> was measured over all animals and per class  for each of the five classification methods, in brown swiss and fleckvieh separately. average values over  <dig> replicates are presented. the total predictive accuracy  ranged between  <dig>  and  <dig>  in brown swiss, and between  <dig>  and  <dig>  in fleckvieh. the accuracy among carriers  was in the range  <dig>  -  <dig>  in brown swiss and  <dig>  -  <dig>  in fleckvieh. the accuracy among non-carriers  varied between  <dig>  and  <dig>  in brown swiss, and between  <dig>  and  <dig>  in fleckvieh.

lasso penalized logistic regression, svml and mag consistently gave the highest accuracy in both classes and breeds, while knn was always the worst performing classification method. mag showed the highest accuracy in the minority class in both breeds . table  <dig> summarizes the predictive accuracy over methods and breeds.

knn k-nearest neighbors, lasso
ℓ1-penalized logistic regression, svml suport vector machine with linear kernel, svmr support vector machine with radial kernel mag multi-allelic gene prediction




figures  <dig> and  <dig> show the error rates  for each of the  <dig> replicates of the analysis in brown swiss and fleckvieh, thereby visualizing the variability of prediction: the closer to the center of the target, the lower the prediction error. the error rate was generally low, with very limited variability. the error was lower than  <dig> %  in all cases except all knn predictions in brown swiss , and fnr with knn , svml  and svmr  in fleckvieh.
fig.  <dig> accuracy of identifying mutation carriers in brown swiss cattle. tpa: total prediction accuracy; tnr: true negative rate; tpr: true positive rate. reported accuracy are obtained from 10-fold cross-validation repeated  <dig> times


fig.  <dig> accuracy of identifying mutation carriers in fleckvieh cattle. ter: total error rate; fpr: false positive rate; fnr: false negative rate rate. reported accuracy are obtained from 10-fold cross-validation repeated  <dig> times




as for hyperparameters, the average λ , c
svml, c
svmr  and k  were: λ= <dig> , c
svml= <dig> , c
svmr= <dig>  and k= <dig>  in the brown swiss population, and λ= <dig> , c
svml= <dig> , c
svmr= <dig>  and k= <dig>  in the fleckvieh population.

the average number of snps selected in the predictive model by the lasso penalization was  <dig>  and  <dig>  in brown swiss and fleckvieh respectively .

the computation time was quite different in relation to the population size and classification method. the total time taken to complete one replicate of the classification procedure was as short as  <dig>  seconds with lasso logistic regression in brown swiss, and as long as  <dig>  <dig>  seconds  with knn in fleckvieh. in both breeds, lasso logistic regression was the fastest method, while mag and knn were the slowest methods in brown swiss and fleckvieh, respectively. svm took intermediate times to compute, with the linear kernel being more than two-fold faster than the radial kernel. the computation time grew approximately linearly with sample size  for all methods, except for knn, for which it grew approximately quadratically.
table  <dig> time  needed to complete  <dig> run of prediction with the five predictive models  in brown swiss and fleckvieh cattle




discussion
in this paper, a general framework for the identification of mutation carriers from snp genotypes has been described. in a previous publication  <cit> , snp genotypes were used to predict carriers of the bh <dig> haplotype in cattle populations. the bh <dig> haplotype has been associated to stillbirth and peri-natal mortility in calves. the mutation behind bh <dig> has in the meantime been characterized , and the step forward towards the prediction of carriers of the actual mutation — rather than of the associated haplotype — is presented in this paper.

the use of snp genotypes to identify mutation carriers builds on special characteristics of the genome around the mutation, i.e. snp loci in linkage disequilibrium and in recombination phase with the mutation. this approach has proved to be very accurate: in this study, the accuracy of identifying mutation carriers was higher than  <dig> % in both cattle breeds. these results are in line with those from similar studies , and confirm that this is a highly effective approach with accuracy potentially close to  <dig> %  for practical applications in animal genetics.

lasso-penalized logistic regression, support vector machines with linear kernel  and multi-allelic gene prediction  gave the highest prediction accuracy both in brown swiss and fleckvieh cattle, with limited variation over replicates. knn and svmr, on the other hand, showed a substantially lower and more variable prediction accuracy. the fact that more flexible models like knn and svmr perform worse than lasso-penalized logistic regression, svml and mag indicates that the decision boundary in this classification problem is probably linear. knn is a non-parametric method that accomodates to the local structure of the data. the use of a radial kernel in support vector machines tends to give small weight to observations which are far — in terms of euclidean distance — from the classification candidate and, conversely, large weight to closer observations . knn and svmr are therefore designed for non-linear classification problems, when the decision boundary between classes is far from linear and they’re expected to outperform linear methods under these circumstances. the linearity of the decision boundary therefore, accounts — at least partly — for the relatively worse performance of knn and svmr.

among the tested classification methods, mag is the only one that makes use of reconstructed haplotypes around the mutation. the additional information from phased snp genotypes proved to be helpful especially in classifying observations belonging to the least frequent class . despite a slighlty lower tpa , mag showed tnr ≳ <dig> %− <dig> % in brown swiss and tpr ≳ <dig> %− <dig> % in fleckvieh compared to lasso and svml. reconstructing haplotypes, however, though relatively inexpensive under some circumstances, adds complexity to the problem. lasso and svml may offer a valid alternative, which is particularly attractive from the machine/statistical learning perspective where a matrix of “features”  is used to predict “labels” .

in terms of computation time, lasso logistic regression was by far the fastest method, followed by svml and svmr. mag and knn were the slowest methods with the brown swiss and fleckvieh datasets, respectively. additionally, knn computation time appears to grow quadratically with problem size, while all other methods behaved linearly in terms of computation time as function of data size. in this work, no efforts were made to optimise the implementation of the different algorithms and computation strategies, and therefore the reported computation times are only indicative. still, they can provide valuable information and useful guidelines as to the relative expected performance of the different classification methods.

fleckvieh vs braunvieh
the identification of mutation carriers proved to be very accurate in both breeds. looking at results from lasso, svml and mag – the best performing classifiers — the total prediction accuracy  was  <dig> ,  <dig>  and  <dig>  in fleckvieh, and  <dig> ,  <dig>  and  <dig>  in brown swiss. carriers of the mutation  were identified with accuracy  <dig> ,  <dig>  and <dig>  in fleckvieh, and  <dig> ,  <dig>  and  <dig>  in brown swiss. the accuracy to identify non-carriers of the mutation  was  <dig> ,  <dig>  and  <dig>  in fleckvieh, and  <dig> ,  <dig>  and  <dig>  in brown swiss. the variability of estimated accuracy was very limited, lower than  <dig> pp in all cases. overall, tpa and tnr were slightly higher in fleckvieh, while tpr was substantially higher in brown swiss: i.e. it was relatively more difficult to identify mutation carriers in the fleckvieh dataset, non-carriers in the brown swiss dataset. in particular, the identification of carriers showed highly variable accuracy in the fleckvieh , whereas in brown swiss also non-carriers were quite accurately identified .

the different results observed in the two breeds, can have both a statistical and a population genetics interpretation. first, there is sample size. as a general rule, prediction accuracy will asymptotically reach  <dig> % with increasing sample size  <cit> : more data would increasingly cause fewer overfitting problems and reduce the need for penalization. in the field of genomic predictions, the size of the reference population is known to influence the accuracy of gebvs   <cit> . in the case of prediction of mutation carriers, this is nicely illustrated by pirola et al.  <cit>  who showed how the prediction error and variance are inversely related to sample size. in the present study, the sample size was about ten times higher in the fleckvieh  compared to the brown swiss  breed. another statistical aspect of importance is the class ratio. unbalanced data are a known issue in binary classification problems  <cit> : when the two classes are not equally represented it is much harder to predict observations belonging to the minority class , and an overall high prediction accuracy could mask very poor performance in the minority class. the class ratio was very unbalanced in the fleckvieh , much less so in the brown swiss .

more specifically linked to the genetic characteristics of populations are two additional aspects. on one hand, there are the genomic relationships among individuals; the accuracy of genomic predictions have long been found to be a function of genetic relatedness: “ceteris paribus”, stronger genetic links between the training and validation animals lead to higher accuracy of predictions . from snp genotypes, higher average genomic relationships  were estimated in brown swiss  rather than in fleckvieh ; the heatmap in fig.  <dig> shows the genomic relationships estimated within and across the two breeds. it can be argued that for predictions on a single locus “local” instead of genome-wide relationships are more meaningful. average genomic relationships were therefore re-estimated using only snps around the tubd <dig> mutation . local relationships were higher than genome-wide relationships in both breeds: still, brown swiss showed higher local relatedness than fleckvieh . another genetic aspect, the linkage disequilibrium  between snp markers and relevant loci/qtls is known to influence the accuracy of genomic predictions: a sufficiently high ld is required for snp-based predictions to be reliable  <cit> . the ld around the tubd <dig> mutation  was estimated as r
 <dig>  <cit> : the average r
 <dig> was  <dig>   in brown swiss and  <dig>   in fleckvieh. besides, better defined ld patterns and blocks around the mutation on bta <dig> could be identified in brown swiss compared to fleckvieh .
fig.  <dig> heatmap of genomic relationships within and between breeds. genetic relatedness estimated from snp genotypes in brown swiss  and fleckvieh  cattle. darker colors correspond to higher estimated genomic relationships


fig.  <dig> linkage disequilibrium around the mutation on bta <dig>  r
 <dig> values in the region  <dig> -  <dig> mbps on bta <dig> in brown swiss  and fleckvieh  cattle. the tubd <dig> mutation is at  <dig>  <dig>  <dig> bps




summarizing, sample size played in favour of the fleckvieh dataset, while class ratio, genetic relatedness and linkage disequilibrium were more favourable in the brown swiss dataset. this helps explain the generally better predictive performances found in the brown swiss breed in this study.

error decomposition: variance and bias
the error incurred when making predictions can always be decomposed into its variance and bias  <cit> . the variance is the part of the error due to the variability of the predictor −e)]2); the bias refers to the systematic error, i.e. the expected value of the difference between predicted and true values −f]).

for binary classification problems, with the misclassification loss function, the variance and bias of the classification error can be estimated as follows  <cit> : 
  <dig> var=|2·p^−1|i≥ <dig> &p¯< <dig> )||< <dig> &p¯≥ <dig> ) 



  <dig> bias=|2·p−1|i 


we estimated the variance and bias of the classification error given by the five models  used to identify mutation carriers in the two breeds. results are in table  <dig>  the variance was in the range between  <dig>   and  <dig>   in fleckvieh, and between  <dig>   and  <dig>   in brown swiss. the bias ranged from  <dig>   to  <dig>   in fleckvieh, and from  <dig>   to  <dig>   in brown swiss. overall, most of the error was taken up by the bias component. this says that the developed classifers make very stable predictions, even when resampling the training and validation sets . this is a desirable property, especially when the error rate is as low as that reported in this study: a small bias is not bound to severely affect the accuracy of prediction. a bias larger than the variance of the error partly stems out of class imbalance. with unbalanced data, most errors occur in the minority class, which means they are systematically misclassified. for instance, for knn predictions in fleckvieh, the errors in the minority class  are in a well delimited area around the target, with little variation.

knn k-nearest neighbors, lasso
ℓ1-penalized logistic regression, svml support vector machine with linear kernel, svmr support vector machine with radial kernel, mag multi-allelic gene prediction




as a proportion of the error, the bias was larger in brown swiss than in fleckvieh, for all error types . in brown swiss, the number of parameters  in the model  exceeded the number of observations  in the training set , unlike in fleckvieh : this calls for stricter regularization in the brown swiss data, which would tip the bias-variance trade-off more towards the bias  <cit> .

effect of sample size on prediction accuracy
the size of the reference population  is known to play a major role in determining the accuracy of genomic predictions ; this was shown also for the problem of predicting the carrier of specific gene alleles  <cit> . to investigate this in the present work, both available cattle populations  were reduced by randomly sampling  <dig> %,  <dig> % and  <dig> % of the animals. on the reduced subsets, lasso, svml and mag were applied to identify carriers of the tubd <dig> mutation, applying the same procedure as in fig.  <dig> , repeated  <dig> times.

results are reported in table 5: tpa decreased by  <dig>  % ,  <dig>  %  and  <dig>  %  in brown swiss and by  <dig>  % ,  <dig>  %  and  <dig>  %  in fleckvieh, when going from the full dataset to  <dig> % of the data. the larger drop in accuracy in brown swiss is likely due to the initial smaller sample size . also the standard deviation of tpa increases whith decreasing sample size, which suggests that predictions become progressively less reliable. when looking at tpr and tnr, it is clear that with smaller sample sizes predictions in the minority class get dramatically worse , whereas predictions in the majority class are practically unaffected. this indicates that when the training population gets small, the trained binary classifier starts losing predictive power and begins being dominated by the most frequent class. overall, mag appears to be the most resilient method to data reduction, among those tested.

ld average linkage disequilibrium estimated around the mutation, k average genome-wide genomic relationships, lock average genomic relationships estimated using only snps around the mutation




the size of the training population is confirmed to be a major factor behind the accuracy of genomic predictions, also in the identification of carriers of recessive mutations.

at each size-reduction step, the ld  around tubd <dig>  and the genome-wide and “local”  rescaled genomic relationships à la van raden were estimated. around the mutation was again defined by taking snps from the first  <dig> mbps on bta <dig>  the estimated ld around the mutation appears to increase with decreasing sample size; however, ld estimates are known to be biased upwards by small sample size in cattle  <cit> . both genome-wide and local genomic relationship are little affected by sample size. this indicates that the drop in accuracy is explained mainly by the size of the training set and apparently not by a lower ld between snp and the mutation, or by looser relationships between animals.

extension to another harmful recessive mutation
from an indipendent population of italian brown swiss cattle , three hundred and five brown swiss bulls typed for congenital spinal dysmyelination  were available to test the accuracy of identifying mutation carriers from snp genotypes. sdm is another recessive mutation of interest in cattle, caused by a missense mutation in the spast gene on bta  <dig>  <cit> . all bulls  were genotyped with the bovinesnp <dig> v <dig>  illumina beadchip .

the three classification methods that gave the best results on the tubd <dig> mutation were applied to the identification of carriers of the sdm mutation: lasso, svml and mag. as in fig.  <dig>   <dig> % of the data were used to train the classifier, and the remaining  <dig> % to test it. given the smaller dataset size , a 60/ <dig> cross-validation scheme was used to tune the hyperparameters . the procedure was repeated  <dig> times to estimate prediction accuracy. with lasso, svml and mag, respectively, tpa was  <dig>  ,  <dig>   and  <dig>  ; tpr was  <dig>  ,  <dig>   and  <dig>  ; and tnr was  <dig>  ,  <dig>   and  <dig>  .

overall, the identification of carriers proved to be effective also when tested on a different mutation. however, compared to the results with the tubd <dig> mutation, a higher test error rate was estimated for sdm, especially in the minority class : whereas tpa and tnr were both very high and close to  <dig> %, tpr was quite lower, in the range  <dig> − <dig> . probably, this is related to the different frequency of carriers:  <dig>  %  and  <dig>  %  for tubd <dig>  as low as  <dig>  % for sdm. highly unbalanced data are expected to yield worse predictive performances. this was especially true in the case of sdm for which there were only eight carriers. the smaller sample size too, is likely to have played a role in the higher prediction error rates and, especially, the larger variability of estimates, as we showed when reducing the size of the tubd <dig> dataset .

unlike the tubd <dig> mutation, mag did not  outperform lasso and svml in the minority class: using haplotypes did not appear to be as beneficial with the sdm mutation. this may be related to the different degree of concordance between the mutation and the associated haplotype: this was  <dig>  % between tubd <dig> and the bh <dig> haplotype  <cit> , and  <dig>  % between sdm and the bhd haplotype  <cit> .

prediction accuracy with the low density snp chip
several snp-chips are available in cattle, with different marker densities and costs . in this work, an overall very high accuracy of prediction was achieved using the bovinesnp <dig> v <dig> illumina beadchip, which contains  <dig>  <dig> snps. it would be interesting to see what would be the accuracy of identifying mutation carriers using lower density snp-chips. in particular, it is of interest to verify whether comparable accuracies could be achieved with fewer snps. since genotyping animals is a cost, especially for commercial farms, low density snp chips may offer a cheaper alternative for the identification of mutation carriers.

from the  <dig> k snp-chip data, the snp on bta <dig> corresponding to the bovineld v <dig> illumina beadchip  were extracted and used for classification. lasso and svml, were used for classification, with the same experimental design as in fig.  <dig> .

with lasso, ter, fnr and fpr were  <dig>  ,  <dig>   and  <dig>   in brown swiss, and  <dig>  ,  <dig>   and  <dig>   in fleckvieh. with svml, ter, fnr and fpr were  <dig>  ,  <dig>   and  <dig>   in brown swiss, and  <dig>  ,  <dig>   and  <dig>   in fleckvieh. the computation time for one replicate of the model in the brown swiss and fleckvieh datasets, respectively, was  <dig>  and  <dig>  s using lasso, and  <dig>  and  <dig>  s using svml.

overall, performances are comparable with the  <dig> snp-chip: only the identification of carriers in fleckvieh was notably less accurate with lower densitiy snp data.

localize mutation via resampling
in predictive models, it can be of interest to find out which variables are more relevant for accurate predictions. when resampling strategies are adopted, the relevance of individual predictors can be indirectly derived from the frequency with which they appear in the different replicates of the predictive model. in the case of snp-based models, the most predictive snps are likely to be linked to the target qtl/mutation. this approach was already presented by biffani et al.  <cit>  to track the position of the bh <dig> haplotype. the bh <dig> haplotype is located at  <dig> −− <dig>  mb on bta <dig>  <cit> , and could be accurately identified through the resampling approach. however, snp data were used both to first reconstruct the bh <dig> haplotype and then localize it. additionally, it may be harder to localize a point mutation rather than a longer associated haplotype. therefore, a similar resampling approach was adopted here to map the position of the tubd <dig> mutation on bta <dig> 

the lasso penalised logistic regression model in eq.  <dig> has the property of selecting, through cross-validation, a subset of predictive snps. this subset can vary from replicate to replicate. in fig.  <dig>  the absolute frequencies of inclusion of snps in the predictive model were plotted against their bps positions along bta <dig>  separately in brown swiss  and fleckvieh . the tubd <dig> mutation is located at  <dig>  <dig>  <dig> bps  <cit> , which correspond to where the frequency peaks appear in both breeds : the mutation could thus be localized by mining classification results, without any prior information on its position.
fig.  <dig> predictive snps selected by lasso-penalization from the 50k snp-chip. frequency of inclusion of snps in the lasso-penalised logistic regression model for each of the  <dig> replicates, plotted against the snp position on bta <dig> 




to provide a comparison, p-values from a genome-wide association study  for the binary trait carrier/non-carrier of the tubd <dig> have been plotted in fig.  <dig>  a logistic regression model for the probability of being carrier of the mutation was fitted for every single snp on bta  <dig>  accounting for the polygenic effect through the matrix of genomic relationships. the gwas approach also detected a strong signal of association at around  <dig> mbps on bta <dig>  the significant associations had a lower p-value in fleckvieh than in brown swiss, probably due to the much larger sample size in the former.
fig.  <dig> manhattan plot of −log. results from a gwas analysis for carriers/non-carriers of the tubd <dig> mutation. brown swiss above, fleckvieh below




the results reported here and -previously- by biffani et al.  <cit>  show that resampling methods offer a valid alternative or complement to gwas studies, as discussed by biscarini et al.  <cit> . gwas studies are in fact known to suffer from some limitations, like susceptibility to spurious associations and poor reproducibility of results  <cit> . combining the two approaches may lead to more robust association results.

applications to the management of cattle populations
in cattle genetics, causal mutations or associated haplotypes for inherited disorders are being discovered at unprecedented rates . it is therefore useful to have tools that allow breeders to identify carriers. the degree of association between haplotypes and underlying mutations is variable  <cit> : sometimes very high , sometimes much looser . this may increase the uncertainty of identifying mutation carriers from snp genotypes, and there is therefore value in directly predicting mutation rather than haplotype carriers.

in this paper, we showed that mutation carriers can be identified very accurately from snp genotypes. bulls and cows in breeding programmes are often routinely genotyped, e.g. for parentage verification, estimation of genomic breeding values, and it would therefore be rather straightforward and inexpensive to use already available genotype data to identify mutation carriers. using the  <dig> k snp-chip, the accuracy of prediction has been shown to be very high, close to  <dig> % in both breeds, with very few misclassifications also in the minority class. at lower snp densities the overall accuracy was still impressively high, slightly lower than  <dig> %, but larger proportions of misclassifications were observed in the minority class . in order to maximise prediction accuracy in all classes while keeping costs low, mixed genotyping strategies can be adopted by which most of the population is genotyped at low densities and only relatively few animals are genotyped with the  <dig> k chip:  <dig> k snp genotypes can then be imputed back in all animals  <cit> . mixed genotyping strategies are current standard practice in several national dairy selection schemes . to assess the effect on prediction accuracy of imputing back to higher snp densities, different proportions of extracted bovineld snp genotypes were imputed back to 54k snp genotypes:  <dig>   <dig> and  <dig> %, and lasso was run on each of them for the identification of carriers. very similar results to those reported in table  <dig> were obtained. for instance, with  <dig> % of the animals genotyped at low densities, tpa, tnr and tpr were still  <dig> ,  <dig>  and  <dig> , respectively. this may be related to the high imputation accuracy in dairy cattle  <cit> .

with the size of the data used in the present work , lasso and svml were quite efficient with an r implementation. for larger datasets, though , scalability would certainly be an issue, and more efficient implementations of the algorithms, combined with computation strategies like parallel computing on multiple cores or distributed computing on a computer cloud/cluster should be adopted. a popular combination in machine learning and “big data” analysis is given by the scripting language python within the apache spark framework for distributed computing  <cit> .

once mutation carriers have been identified, this information can be used in breeding strategies to guide selection decisions and plan matings, with the objective of reducing the frequency of carriers in the population and avoiding mating of carriers. mate allocation schemes to control inbreeding and recessive disorders have been already proposed in cattle  <cit> . besides breeding, the accurate identification of mutation carriers can be useful also in conservation programmes for marginal breeds at risk of extinction. these breeds typically have higher inbreeding , which exposes them to a higher incidence of recessive genetic diseases. avoiding the mating of carriers would therefore be very beneficial.

CONCLUSIONS
this paper shows that snp genotypes can be used very effectively to predict carriers of harmful recessive mutations in cattle populations. the tubd <dig> mutation on bta <dig>  associated with reduced fertility in cows, was chosen as illustration. together with mag, lasso-penalized logistic regression and support vector machines with linear kernel gave the lowest error rates indicating the probable linear nature of this classification problem. overall, the prediction accuracy was very high, close to  <dig> % in both breeds. compared to single snp genotypes, the use of haplotypes gave better accuracy in the minority class when the haplotype-mutation concordance was close to  <dig> % . the opposite was true for looser associations between haplotype and mutation . when using the low-density snp-chip, the total error rate was still very low , but the proportion of misclassifications in the minority class tended to increase . this can however be compensated by optimised genotyping strategies combined with genotype imputation techniques, which could potentially make this a very effective and efficient tool for the identification of carriers of any mutation or haplotype of interest  in bos taurus. there is potential to build effective applications to be used by breeders and farmers . the presented procedure could in principle be extended to any other diploid organism, for agriculture applications in farm animals, crops and trees, and for medical applications in humans.

abbreviations
fnrfalse negative rate

fprfalse positive rate

gebvgenomic estimated breeding value

iqrinterquartile range

knnk-nearest neighbours

tertotal error rate

snpsingle nucleotide polymorphism

svmsupport vector machines

svmlsvm with linear kernel function

svmrsvm with radial kernel function

