BACKGROUND
the amino acid sequences from a set of homologous proteins contain an imperfect record of the history of sequence divergence within that protein family. much of this history can be modeled by a process that formally reconstructs the sequences of ancestral proteins throughout an evolutionary tree, given a multiple sequence alignment relating individual sites in the descendent proteins  <cit> . these reconstructions are generally presented in probabilistic form, where the likelihood that each of the standard amino acids occupied a particular site at a point in the tree is represented by a vector whose coefficients sum to unity, and where each coefficient represents the probability, conditional on the reconstruction model, that each of the standard amino acids occupied that site at that point.

reconstructed ancestral sequences can be viewed as an expedient representation of extant sequence data, because they include all of the sequence information in a way that represents a best guess model for the historical reality. it is not surprising, therefore, that explicitly considering reconstructed ancestral sequences is a powerful tool for interpreting sequence data. for example, explicit consideration of ancestral states provided an understanding of the general features of correlated changes in proteins  <cit> , an understanding that eluded a perplexed literature that attempted to analyze correlated change by leaf-leaf comparisons  <cit> . likewise, many compelling tools for predicting the folded structure of proteins are based on analyses that consider reconstructed ancestral sequences  <cit> . ancestral sequence reconstructions have provided insight as well into the relation between protein sequence, behavior, and adaptive function in proteins as diverse as ribonucleotide reductase  <cit> , leptin  <cit> , aromatase  <cit> , sulfotransferase  <cit> , steroid receptor  <cit> , alcohol dehydrogenase  <cit> , elongation factor  <cit> , ribonuclease and its homologs  <cit> , rhodopsin  <cit> , lysozyme  <cit> , and biofluorescent proteins  <cit> . in the last seven cases, ancestral proteins from extinct organisms were actually resurrected in the laboratory .

as valuable as such studies are, however, only a very few scientists pursue them. two reasons explain, at least in part, why studies involving reconstructed ancestral proteins are challenging. first, evolutionary analyses are highly dependent on the availability of a large amount of data collected by others. an evolutionary analysis of a protein family can generate interesting biological interpretations only if it contains a sizeable number of members, and only if those sequences are contributed from interesting organisms. further, the analysis depends on the extent to which the sequences have diverged, and how the tree interconnecting the sequences is articulated.

non-sequence information to support an evolutionary analysis of sequence data is also usually available only opportunistically. thus, the availability of a crystal structure for a member of a protein family is generally not determined by a desire to support an evolutionary analysis. likewise, there is no guarantee that a fossil record will exist for organisms holding ancestral proteins of interest, or kinetic data will be collected on the interesting proteins as biomolecules, or even that an interesting physiological recruitment has been studied by cell or organismic biologists.

this contingency means that one rarely knows in advance when one sets out to perform an evolutionary analysis what will be discovered. generally the most interesting insights are true discoveries, coming opportunistically by those who can resourcefully take advantage of all information, especially that from researchers who delivered it to the literature for reasons quite different from the desire to support an evolutionary analysis.

this places a high value on database architectures that support browsing. the most useful database for an evolutionary bioinformaticist must allow the user to ask "what if?" and "why not?" questions about the evolutionary histories of multiple families, where the answers can be extracted from the database in minutes or hours, not days or weeks.

this generates the second reason why detailed evolutionary bioinformatic analyses are rarely done. the public databases are inadequate for those who wish to browse, especially if they hope to collect information about ancestral protein sequences. the decision to do an evolutionary analysis with the ncbi web page is a decision to spend weeks doing expert interpretation of blast outputs, multiple sequence alignments, and tree constructs. this means that evolutionary analyses are today done one family at a time, by experts in evolutionary analysis, and are not done by bench experimental scientists who have the most access to the non-sequence information that enriches a purely bioinformatics study.

a naturally organized commercial database incorporating information from ancestral sequences, known as the mastercatalog, was introduced in  <dig> to support browsing  <cit> . it has been remarkably successful doing so in the hands of those who have had access to it  <cit> . the product falls between market niches, however; too expensive to be available to academic scientists, yet generating too little revenue to attract major capital support. therefore, it has not permitted broad based discovery using genomic sequence data. some time ago, we set out to develop a publicly available database that would support browsing of evolutionary and structural data jointly. we have been able here to assemble such a database, magnum, that covers protein families where at least one member has a crystal structure.

we report here a characterization of the magnum database, which covers the multiple sequence alignments, phylogenetic trees, inferred ancestral sequences, amino acid residue replacements on branches, and crystal structures. we demonstrate the utility of magnum as a research tool for addressing general trends in protein evolution as well as more specific questions of relevance to individual protein families. in this case, we performed queries to select individual amino acid replacements occurring along short branches, located at internally folded protein sites, and requiring a nucleotide change at each of the three codon positions for interconversion. the results lead us to, among others, the family of proteins that bind retinol and other hydrophobic ligands, where we discovered along one branch a replacement that may explain physiological differences in ligand binding specificities, and along another branch a set of replacements related to the recruitment of this protein as an eye lens crystallin in diurnal geckos.

RESULTS
description of magnum
in its current form, magnum comprises  <dig>  "superfamilies"  <cit>  from the protein information resource  containing from  <dig> to  <dig> family members. together, these contain a total of  <dig>  protein sequences . the average family has  <dig> sequences aligned over  <dig> sites . if all of the alignments were concatenated, the total alignment length would be  <dig>  sites.

of the  <dig>  alignment sites, 68% were completely gap-free. where gaps do occur, they comprise less than 15% of all alignments characters for approximately two-thirds of the families  and are concentrated within ten or fewer distinct regions for the typical family .

the average family in magnum has a width of  <dig>  amino acid replacements per site . the average branch represents a distance of  <dig>  replacements per site . an unrooted phylogeny with n leaf sequences has n- <dig> internal nodes and 2n- <dig> branches. the trees collected in magnum contain  <dig>  internal nodes and  <dig>  branches. over 80% of internal nodes are less than  <dig>  amino acid substitutions per site distant from a leaf sequence . a substantial fraction of these connected an internal node to a leaf. the remaining 20% of the nodes, nearly all not directly connected to a leaf, were more than  <dig>  amino acid substitutions per site distant from a leaf. the distribution of substitution rates at individual sites is shown in figure 2d.

accuracy and error in reconstructed sequences
to obtain a general measure of the reconstruction accuracy at the typical site in the magnum database, conditional posterior probabilities were obtained from the marginal reconstruction method, which independently treats each site at each internal node in order to calculate the probability of deriving the leaf sequences starting from each of the  <dig> amino acids at that position in the tree . these probabilities are conditional on the parameters of the metatheory used during the reconstruction. as the accuracy of a reconstruction declines, so to does the posterior probability value generated by the scoring tool.

in magnum,  <dig> , <dig> ancestral sites were reconstructed. at  <dig> , <dig> sites, the reconstruction suggested gap characters, which are not assigned a probability value. although we do not consider replacements involving gaps in this study, we chose to model the gapping history because even a simple representation of the indel process was preferable to ignoring it. where the reconstructions did not contain gaps, the overwhelming majority of conditional posterior probabilities for the primary amino acids  were above 90% .

all reconstructed sites are cross-tabulated according to the posterior probability of the best marginal reconstruction amino acid and the marginal reconstruction rank, from highest to lowest posterior probability, of the sole joint reconstruction amino acid.

the primary amino acid residues reconstructed using marginal and joint methods were then compared. discrepancies between these reconstructions would indicate disagreement, which would imply uncertainty in reconstructions arising from an irresolvable concern over which of the two methods is more likely to capture the historical reality. fortunately, the primary residue inferred using the marginal reconstruction method differed from that inferred by the joint reconstruction method at only  <dig> % of the ungapped ancestral sites . these sites predominantly occurred among sites where the marginal posterior probabilities were low. this indicates that disagreement between the "marginal reconstruction" and "joint reconstruction" metatheories is found primarily at sites where the inferences of the ancestral amino acid are not confident in any case. at the majority of these sites, the residue inferred by the joint reconstruction method was the second or the third most likely residue inferred by the marginal reconstruction method.

from these results, we conclude that the majority of ancestral reconstructions in magnum are fairly accurate and robust to the reconstruction philosophy . more precisely, inferences drawn directly from the magnum database without further refinement of its ancestral characters are not likely to be dominated by database error. further, when performing detailed analyses with the data, numerous indicators of accuracy are available from magnum to the user for deciding where the reconstructions are likely to be less certain.

structural characteristics of the families
as a condition for inclusion within magnum, each pir superfamily had to be associated with at least one protein chain from a structure in the protein data bank . the median magnum family has members associated with two pdb chains . the families with the longest alignments have the fewest pdb chains and vice versa . we explain this by the observation that short sequences are more prevalent in the pdb.

multiple sequence alignment was used to relate pdb chain sites with family member sites. at  <dig>  of the final sites, gaps were placed within the pdb chain sequences . at an additional  <dig>  sites, residues in the pdb-listed sequence were aligned, but the pdb database did not report resolved crystallographic coordinates for their side chains, and therefore secondary structural information was unavailable . after correcting for gaps and unresolved residues,  <dig>  sites were aligned with at least one resolved residue from the pdb.

in the current version of magnum,  <dig>  families are associated with multiple pdb chains . for the majority of these families, a strong correlation exists between the average length of the pdb chains and the alignment length after correcting for sites without structural information . this demonstrates that in many families with multiple structures the same alignment sites are covered by each pdb chain.

the structural information was then used to assign surface accessibility and secondary structural characteristics for the  <dig>  sites where it was available . if more than one pdb chain was applicable to a site, the side chain accessibility values were averaged. at the  <dig> and  <dig>  sites where four and three, respectively, secondary structure types were assigned we report the most common type. in the event that none of the secondary structures are more common than the others, such as in the  <dig>  sites with exactly two assignments, the secondary structure is reported according to the following hierarchy: turn, helix, coil, and then strand.

* the average surface accessibility is reported when multiple pdb chains are aligned at a site.

** the most commonly called secondary structure type is reported when multiple pdb chains are aligned at a site.

residues at approximately half of the sites were less than 30% accessible. this is a threshold at which we distinguish 'buried' and 'exposed' sites for the studies below, although the user is able to select alternative cutoffs. the four secondary structure types were each well represented at all levels of surface accessibility. residues in strands were more likely to be buried, while residues in turns were more likely to be found on the surface  <cit> . residues in helices and coils did not show a preference for buried or exposed sites.

amino acid residue replacements along branches
as a further test of the uncertainty in the ancestral sequence reconstructions, we asked whether patterns in the replacement of amino acids as represented by replacements inferred from ancestral sequences were similar to/different from those patterns obtained by many workers  by comparing extant sequences. for short, medium and long branches,  <dig>  leaf-leaf and node-node pairs were randomly selected. replacements were counted within these six collections of aligned sequences, and dayhoff matrices were constructed from the replacement counts .

for the node-node comparisons, replacements were counted using three tools that differed in the weighting of replacements. the 'best count' tool assigned equal weight to all replacements, which were detected by searching for sites where the most probable parent residue differed from the most probable residue at the same site in the child nodal sequence. using the same strategy to search for replacements, the 'best fractional' tool weights each replacement by the product of the marginal posterior probability values of the parent and child residues. the 'all fractional' tool exhaustively considers, for every aligned site, all possible combinations of parent and child residues weighted by their combined probability. in addition to the  <dig> pairs of different residues , each tool also keeps a running total the  <dig> non-replacement pairs.

a clear linear relation was observed between corresponding node-node and leaf-leaf matrix elements at all three distances regardless of the replacement counting tool . from this, we conclude that replacement events reconstructed from node-node comparisons are similar in type to the amino acid replacements based on leaf-leaf comparisons.

intriguingly, the correlation coefficient was larger in the long branches examined than in the medium and short branches. this phenomenon is not understood. interestingly, the replacement pairs that deviate from the regression line in fig.  <dig> appear most frequently to involve alanine or valine. further, alanine and valine appear to be most conserved, regardless of the distance between the sequences. this is a discovery worth investigating in the future.

the branch lengths used in the magnum trees are obtained by fitting the matrix of pairwise leaf-leaf distances  upon the tree that gives the smallest total distance using the strategy in the program weighbor  <cit> . once the ancestral sequences are in hand, an alternative measure of the distance of a branch connecting two nodes  was obtained by examining two  ancestral sequences, and counting the number of changes, weighted by the fractional probabilities of those residues where appropriate. these are "branch-lengths-from-reconstruction".

the number of changes on any branch at any individual site cannot exceed unity, as multiple substitutions at a site are not captured by simply comparing two sequences. thus, the branch-lengths-from-reconstruction, a metric that averages these over all sites, cannot exceed unity. the branch-lengths-from-reconstruction with the all fractional tool closely resembled the actual branch lengths, especially at short distances . the other tools rarely overestimated the actual branch length . where branch-lengths-from-reconstruction are less than actual lengths, one explanation is that intermediate replacements occurred at some sites. by correcting for multiple substitutions, which occur more frequently on longer branches and for sites with higher substitution rates, it would be possible to improve the correspondence between branch-lengths-from-reconstruction and the actual tree branch lengths.

*replacements per site from all fractional , best fractional , and best count  tools.

a browsing example: f-to-e, f-to-q, and f-to-k replacements
we illustrate an example of how the magnum database can be used to ask a question about amino acid replacement in general, where possible answers to the question bear on evolutionary and structural biology.

we started by noting, trivially, that  <dig> distinct amino acid replacement patterns exist given  <dig> standard amino acids and ignoring directionality in time . in  <dig> of these, three nucleotide substitutions  are required to effect the replacement, regardless of the codons used in the parent or child genes. three of these pairs interconvert the hydrophobic amino acid phenylalanine  with one of the polar amino acids, lysine , glutamine , or glutamate . for example, the f-to-k replacement requires the conversion of a tty codon  to an aar , requiring a total of three transversions. the six shortest pathways for the f-to-e, f-to-q, and f-to-k replacements are shown in figure  <dig> 

the f-to-e/q/k replacements on branches of any length were found to be relatively infrequent, observed at only  <dig> % of all recorded replacements . the collection of f-to-e/q/k replacements appears to be distributed with no obvious preference in large and small families, long or short alignments, or branches connecting sites with higher or lower posterior probability. the f-to-e/q/k replacements are, however, found more frequently on longer branches and in sites holding side chains on the protein surface . each of these facts is readily retrieved given the structure of the magnum database.

*detected as sites where the most probable parent and child residues were different.

**the average product of probabilities for the parent and child residues.

in the hope of identifying f-to-e/q/k replacements involved in adaptive change, buried sites on short branches  were selected. again, the magnum database permitted this information to be extracted with little effort. a total of  <dig> replacements satisfied these criteria .

first, the alignments and phylogenies were inspected to determine which of these events might reflect database error; misalignments were of special concern. out of  <dig> events we found that  <dig> of the alignments were most likely incorrect. this is not surprising due to the unusual nature of the replacement events under inspection in this sample. we expect, therefore, that this is a worst case example.

cellular retinoid binding proteins
while each of the remaining f-to-e/q/k replacements proved to be interesting, we choose to discuss here just one to illustrate how opportunities arise as one exploits a browsable database. in the example chosen for this illustration, an f-to-q replacement was found at alignment site  <dig> in a family of beta barrel folded proteins that bind to assorted hydrophobic ligands, including sterols, fatty acids, and retinoids .

this particular f-to-q replacement was found in a lineage leading to a subfamily of proteins, known as cellular retinol-binding protein ii, after the mammals holding these proteins diverged from bony fishes . a crystal structure of a member of this subfamily  was used as a reference structure; the f-to-q replacement occurs at position  <dig> in this protein.

we considered two hypotheses. the first, actually intimated in the literature  <cit> , is that the residue at alignment site  <dig> influences the geometry of the glutamine at alignment site  <dig>  via hydrogen bonding. the glutamine at site  <dig> directly contacts the hydroxyl group of retinol, and the carbonyl group of retinal  <cit> . according to this model, f in site  <dig> forms a "pi anion" interaction with the amide hydrogen of site  <dig> glutamine, constraining it to offer its amide oxygen to either retinol or retinal, and therefore causing the protein to favor the first as a ligand over the second. a q at site  <dig> would be able to hydrogen bond with either the amide oxygen or the amide hydrogen from gln  <dig>  allowing it  to offer either the amide hydrogen or the amide oxygen to the retinal or retinol , allowing it to bind either . the intermediary amino acids along the shortest pathways between f and q do not each possess the chemical properties to perform this molecular physiological function. leu cannot form a hydrogen bond of any kind. his can form hydrogen bonds that are analogous, although not geometrically identical, to those that can be formed by phe or gln. tyr, in contrast, can form hydrogen bonds using the pi anion mechanism; indeed these are at least as strong as those formed by phe.

the second hypothesis is that at least some of the intermediates between phe and gln are acceptable to the protein. under this hypothesis additional sequence data that articulated the branch, sequences that were not available when version  <dig>  of iproclass was established, might show that the intermediate steps were found.

the second proved to be the case. motivated by the peculiarity of the f-to-q event in this protein family, we searched for and found additional sequences from gallus gallus  and xenopus tropicalis . further, both contained a tyr at site  <dig>  therefore, articulating the tree along branch  <dig>  we reconstructed a tyr as an intermediate between the parent phe and the derived gln. this is, perhaps not accidentally, exactly the residue that would be chosen based on the chemical logic in the preceding paragraphs.

it is still necessary, of course, to take two steps to get from tyr to gln. leu would presumably be unacceptable in this role; his might be tolerated. although efforts to further articulate the tree must involve the sequencing of marsupials , we would predict that if the tree were articulated and an intermediate amino acid were detected, it would be his, not leu.

curiously, although leu is not known in this lineage, it is known elsewhere among the cellular retinol binding protein paralogs. this fact is easily discoverable with magnum, given its support of browsing. it is found in site  <dig> in several of the cousin families, including the cellular retinol-binding protein iii, known in human and gecko , and cellular retinol-binding protein iv, known in mouse and human. interestingly, the affinity of these for retinal and retinol was both very low: kd values of  <dig> and  <dig> nm  <cit> , compared with  <dig>  nm for the homologs that retain the ancestral f, and  <dig> nm for those with the derived gln at site  <dig>  <cit> .

the opportunistic nature of database browsing, and the ability of the magnum database to support it, was then illustrated again. the amino acid replacements along the branch leading to the gecko crystallin  were delivered from the precomputed magnum database , as was their distribution in the crystal structure of the nearest homolog . remarkably, the sites undergoing replacement along this branch were not randomly distributed. rather, many of them were concentrated in strands i and j, and helices  <dig> and  <dig>  on the amino acids presented to the surface, creating a highly modified surface . we expect that these are contact sites required for the formation of lens crystals. a planetary biology explanation as to why this protein, which binds the light absorber  <dig> -didehydroretinol, evolved as geckos moved from a nocturnal lifestyle to a diurnal lifestyle is found in the literature  <cit> .

discussion
the magnum database is presented here as a tool to permit the rapid exploration of hypotheses relating to protein structure and function, using evolutionary analyses, and to support the pursuit of leads obtained by browsing. as required to obtain the full power of a combined evolutionary and structural analysis, magnum integrates crystallographic protein data with detailed evolutionary features, such as amino acid replacements inferred along branches within the evolutionary tree. the precomputed nature of the magnum resource is critical for meeting its intended uses but also imposes certain constraints.

application to example questions
the present study interrogated a subset of replacements involving three nucleotide substitutions, a buried site in the protein structure, and a short branch in the phylogenetic tree. it is a rare and interesting event when a site experiences multiple amino acid replacements on a short branch. we hypothesized that these replacements on relatively short branches may indicate a functionally important site. the rationale behind this hypothesis is that if none of the intermediates are observed, a "non-markovian" process might drive the introduction of the second and third transversion after the first occurs, because the amino acids that are intermediates in the f-to-e, f-to-q, or f-to-k replacements create selective disadvantage on the host organisms. as a counterhypothesis, some of these events correspond to sites that are unimportant for functional reasons that would constrain their evolution, where the intermediates are not seen in the reconstructed history simply because the branch is not articulated .

the f-to-q replacement at alignment site  <dig> along the branch leading to the mammalian retinol binding proteins was a case of poor articulation. orthologs from the recently completed chicken and frog genomes possessed tyr, an intermediate amino acid in the f-to-q pathway. nevertheless, the structural position of this site suggested that the amino acid residue it holds can modulate ligand binding affinity by influencing the orientation of the dual hydrogen bond donor/acceptor residue at a second site, which is in direct contact with the polar end of the bound ligand. these hypotheses are specific enough to be experimentally testable.

in the same protein family, we noticed an unusual protein sequence from the gecko . literature searches revealed that it had been found in the eye lens and prompted us to ask if the sites replaced along this branch might explain how this protein had been recruited to function as a crystallin. many of the sites were clustered in a region of the protein with their side chains protruding away from the surface – a pattern consistent with the emergence of a new binding site.

these three examples illustrate how the naturally organized magnum database supports querying across many protein families, as well as opportunistically following leads obtained by browsing, to quickly explore and generate hypotheses related to protein structure and function.

integrating protein evolution and structures
existing protein sequence and structure data sources are magnum's foundation, yet magnum is much more than the sum of its source data. the specific sources of raw data chosen for inclusion in magnum, and three major steps employed to generate the final product, distinguish magnum from other databases such as pfam  <cit> , pandit  <cit> , and pali  <cit> . the magnum source data is first organized under a common schema designed to allow storage, integration, and retrieval of the source data and its derived information. importantly, this step establishes the orthologous relationships between sequence and structure protein sites. genealogies are then built for each protein family and the derived molecular evolutionary information stored in the database. this process is not a trivial one. it requires extensive planning, computational processing, and integrating of results from different stages of the evolutionary analysis. finally, interactive browsing and analysis tools are deployed that make use of a custom application programming interface to the magnum database.

the chemical behaviors of polypeptides determine, to a large extent, biological phenotypes. investigating the molecular basis of phenotypes would be simple if the behavior of a protein and the consequence of replacing residues at particular protein sites were predictable from the linear sequence of amino acids. in the absence of these predictive powers, combining phylogenetic sequence analyses with additional sources of complementary data represents a powerful approach to the study of protein molecular function  <cit> . while many would agree that integrative biology is a worthwhile goal, the slow pace of progress in this direction indicates significant challenges exist. here we succeeded at developing an integration scheme for just two fields of protein study, evolution and structure, which obviously have a synergistic relationship. we applied the method in a high-throughput manner to full-length protein families where at lea one crystal structure could be identified.

we attribute the successful synthesis, at least in part, to the particularly detailed approach employed for reconstructing protein evolution. while many recognize that homologous sequences are more valuable when aligned and organized phylogenetically, few have considered the benefits of capturing branch-specific replacement patterns through the use of ancestral sequences. reconstructing amino acid replacements along phylogenetic lineages is a realistic and efficient means of modeling the actual events that have occurred during the divergent evolution of the homologous protein sequences. the alternative, when ancestral sequences are unavailable, is to make 'leaf-leaf' comparisons. in leaf-leaf comparisons lineages are visited multiple times as the paths for different leaf-leaf pairs cross many of the same branches  <cit> . leaf-leaf comparisons introduce bias in the counting of replacements, thus making the interpretations more difficult. in addition, leaf-leaf pairs are always separated by at least two branches and the number of replacements separating them will always be larger  than the number of replacements along individual branches. when searching for a few replacements of functional importance amidst a background of functionally neutral replacements the smaller groups of mutations organized by node-node comparisons are expected to be helpful. in addition, node-node comparisons should capture multiple substitutions at a site better than leaf-leaf treatments.

homologous proteins with detectable sequence identity possess nearly identical backbone structures  <cit> . therefore, a single structure reasonably depicts the fold of all members of a family of homologs. here the definition of what constitutes a protein family becomes important. homeomorphic protein families, such as those from the pir superfamily resource, contain similar domain contents and arrangements, and the aligned sites share common structural environments. from a folded protein model, sites with buried residues and sites with residues exposed to the solvent are easily identified. buried residues commonly interact to stabilize the protein fold, whereas exposed residues can bind crucial ligands, catalyze reactions, and mediate the formation of inter-molecular complexes. three-dimensional structures also divulge groups of sites that might be distant in a linear sequence but proximal in the folded structure, and regions of the molecule that tend to remain flexible. when different proteins are crystallized as a complex, a detailed map of where and how different proteins interact is also captured. all of these structural insights can be investigated from a fresh perspective when the different levels of protein structure  are connected with a detailed account of protein evolution.

strengths and weaknesses of the approach
as demonstrated here with examples from the cellular retinoid binding proteins, magnum allows any inquisitive user to ask questions about individual protein families and get quick answers, which may beg additional questions that are either answerable through magnum or by consulting the scientific literature. there is no need to be an expert or to spend days or weeks preparing the data before the question can be asked. this is the most obvious advantage of a precomputed resource such as magnum.

another distinguishing feature of magnum is its inclusion of detailed molecular evolutionary and structural information for a large number of diverse protein families. this permits the user to browse or query the data across a range of scales, such as specific replacement patterns , groups of coincident replacements along a branch, replacements in similar structural elements, or all of these in combination. for those who are willing to follow leads opportunistically, magnum offers a unique resource that enables discovery through browsing. we have found that this can be an effective method for research project selection.

ideally, magnum should consider all families of proteins, regardless of whether they are represented in the crystallographic database, and should be rebuilt continuously. limited resources required us to consider only those families represented in the pdb by a crystal structure, and to construct only a static database from a single release of iproclass . the first limitation is not excessively severe; as such families are most susceptible to the combination of structural biology and evolutionary biology that has proven to be so valuable in inferring function. the second is more severe, as is illustrated by our discussion of the cellular retinol binding proteins.

use of magnum to analyze cellular retinoid binding proteins, and proteins involved in inflammation , showed certain deficiencies related to statically built databases. most notable of these was the absence of sequences deposited in the public databases since the last build of magnum was completed.

another disadvantage is that specific metatheories must be chosen before the database is built. the metatheories and evolutionary parameters that we chose here generated outputs that appear, by various metrics, reasonably accurate, meaning that errors in the alignments, trees, and ancestral sequences will not dominate any conclusions drawn by automated analysis of the database. ideally, if resources were available, the evolutionary models for individual families would also be continuously upgraded as these metatheories improve. we can even imagine a human inspector evaluating each protein family.

expediency of ancestral sequences
the core of an evolutionary model is a multiple sequence alignment and an evolutionary tree. the first describes the historical relation between individual codons in the genes that encode the derived proteins; aligning two amino acids in two derived sequences is equivalent to a statement that the codons encoding these two amino acids are descendents of a single codon in the last common ancestral gene for the two.

few dispute the existence of the ancestral gene/protein, given the existing derived genes. the likelihood that the model for any particular ancestral sequence corresponds to a sequence that actually existed depends on many factors. most critical are the number of homologous sequences that contribute to the reconstruction, the extent to which the sequences have diverged, and how the tree connecting them is articulated. perhaps obviously, more sequences, less divergence, and greater articulation leads generally to a higher likelihood of correspondence than fewer sequences, more divergence, and less articulation. also obviously, correspondence requires that the multiple sequence alignment and the phylogenetic tree represent the true evolutionary relationships. the treatment of phylogenetic correctness has received little attention in this study for several reasons. the true evolutionary relationships for a protein family, including topology and branch lengths, are unknowable in many cases due to the large number of possible trees. assessing the reliability of an evolutionary tree through bootstrapping is also not without problems  <cit> . these issues would be partially surmountable if additional resources were available. for example, the hierarchal bayesian framework integrates over uncertainty in the tree and branch lengths when inferring ancestral sequences  <cit> .

given a substantial dataset and satisfactory congruence between the actual history of a protein family and features of the model for that history, other factors become important. these include the choice of a metatheory describing the likelihood of specific amino acid replacements and various tactics for apportioning variation between different sites. although much has been written comparing these various features of evolutionary metatheories , the selection of a metatheory generally has far less impact on the outcome than other factors. in particular, it does not appear to be important to consider higher order models for protein sequence evolution that include replacements at adjacent or distant sites when inferring the amino acids at individual sites in ancestral sequences. to a good approximation, the amino acids at the derived sites are sufficient  <cit> .

CONCLUSIONS
in these demonstrations we have relied upon universal protein/codon relationships, and additional criteria from structural and evolutionary biology, to investigate individual amino acid replacements requiring three nucleotide substitutions. we remind that this is but one of many analyses that can be performed using the protein information assembled in the current version of magnum. any analysis that considers how the amino acid replacements recorded at individual sites, or collections thereof, along a single branch  have affected a measurable property of the descendent protein would be addressable with magnum. of course, analyses that integrate structural information would make fullest use of the resources delivered.

the integrative framework outlined here can be viewed as the outset of an ambitious project to model biological systems from the bottom up. integrating biological data from other maturing areas would increase the number and type of questions that can be addressed. for example, additional molecular components of biological systems , connections between these components , and even a dating framework for inferring correlations between the molecular and natural history records could be integrated. when done properly, the integration of disparate, but interrelated, sources of biological information offers a powerful resource for asking biological questions, where the answers can be used to formulate new hypotheses and make predictions that warrant experimental testing.

