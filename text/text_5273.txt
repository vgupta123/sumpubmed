BACKGROUND
for functional biological sequences, and for proteins in particular, similarity in sequence is often predictive of similarity in structure and function. this has great utility, because while it is challenging to glean knowledge of structure and function, sequence information is comparatively easy to obtain. for this reason, and because comparing two sequences in an alignment is straightforward, pairwise alignments are often the first step toward annotating a sequence whose folded structure and biological function are unknown. when two sequences show extensive similarity and one of the two has been annotated, transferring that annotation provides an easy functional prediction; however, even in the complete absence of annotation, alignments can be used to ascribe functional importance to sites and regions in a sequence  <cit> . consider, for example, two distantly-related sequences, say a pair of orthologous genes in human and chicken. both the coding sequences of these genes and the amino acid sequences that they encode may be very different, yet particular stretches of residues may be well conserved  <cit> . while such surprisingly similarity can arise by random chance, it may also be the footprint of purifying selection, indicating a region of the sequence that is functionally important and resistant to evolutionary change.

in proteins, functionally and structurally important residues are often organized into domains. thus, in a comparison of related sequences, domains may be apparent as regions of surprising similarity. this style of de novo annotation is exploited routinely and underlies a number of web-accessible methods including but not limited to the evolutionary trace   <cit>  and evolution-structure-function analysis   <cit> . the success of these methods relies upon two general characteristics of protein sequences, namely  that there exists heterogeneity among the rates at which sites in a protein evolve and  that the rates are spatially autocorrelated . consequently, more sophisticated de novo annotation schemes gain resolution through a combination of improved evolutionary models, accounting for site autocorrelation, and respecting spatial proximities induced by tertiary structure, e.g.  <cit> .

just as surprising regional similarity in a pairwise comparison may be of biological interest, interesting biology may be responsible for regions that are surprisingly distinct. for example, in a comparison of closely-related species, say human and chimpanzee, one expects a great deal of sequence similarity. in such a background, sometimes regions of surprisingly dissimilarity may encode positively selected adaptations, including those that have helped to distinguish us from our primate cousins  <cit> . within a protein-coding gene, there is evidence that sites undergoing diversifying positive selection, that is those evolving more rapidly than the rate of neutral evolution would predict, cluster non-randomly along the primary sequence  <cit> . the web-accessible tool swakk, which is similar in spirit to et and esf, exploits this non-random distribution to identify positively-selected regions within a protein  <cit> .

synthesizing the above, there is evidence that both negative purifying selection and positive diversifying selection promote the clustering of amino acid differences in a pairwise comparison of protein sequences. by contrast, in the absence of selection at the protein level , clustering is not expected, unless for example the mutation process is biased or there is selection on the encoding dna. in a snapshot of evolutionary time, most proteins are under purifying selection, whereby non-synonymous mutations that change the encoded protein are more likely to fix if they affect regions of the sequence of functionally lesser importance. this raises the possibility that for proteins under stronger purifying selection the clustering of amino acid differences in a pairwise comparison is more intense. to explore this and other possibilities, we introduce a simple statistic that quantifies the degree to which non-synonymous changes are clustered in a pairwise alignment.

in this manuscript, we consider aligned pairs of putatively orthologous protein-coding sequences across a variety of species. within that focus, we hypothesize that:  there exists a genome-wide trend relating the intensity with which purifying selection acts on a protein sequence to the intensity with which non-synonymous changes are clustered in a pairwise alignment;  gene pairs which have undergone periods of relaxed or reversed constraint, such as might occur subsequent to gene duplication, appear as deviations from the genome-wide trend; and  the intensity with which non-synonymous changes are clustered in a pairwise alignment is a strong non-redundant predictor of evolutionary rate. using our new "dispersion ratio" statistic, we provide evidence in support of each hypothesis as well as show that the hypotheses are robust to the choice of genomes compared.

methods
genome-wide pairwise comparisons of selection and dispersion
we obtained from ensembl  <dig> pairwise codon alignments of all one-to-one orthologous protein coding sequences between human and eight other species: pan troglodytes, macaca mulatta, mus musculus, rattus norvegicus, canis familiaris, monodelphis domestica, gallus gallus, and danio rerio. as illustrated in figure  <dig>  we identified the sites in each alignment at which the encoded amino acids were distinct; these comprise the visible subset of all sites where a non-synonymous change has taken place. we labeled as "adjacent"  all sites adjacent to, but not necessarily including, any site identified as non-synonymous by amino acid comparison; the remaining sites were labeled "isolated" . the complete alignment was then partitioned into its adjacent and isolated components, yielding two disjoint subalignments. within each genome-wide comparison, individual proteins were excluded from consideration unless the two subalignments each contained both a transition and a transversion event.

we used the method of yang and nielsen  <cit> , as implemented in paml , to estimate ka and ks for each complete alignment  and its two subalignments. the subalignment ka and ks estimates were denoted kaa and ksa, for the adjacent alignment, and kai and ksi, for the isolated alignment. we obtained from paml the standard errors for each estimate as well. we computed ω = ka/ks for the complete alignment, ωa = kaa/ksa for the adjacent alignment, and ω <dig> = kai/ksi for the isolated alignment. the dispersion ratio was calculated as ρ = ωi/ωa. within each genome-wide comparison, individual proteins were again excluded when either log or log had a standard error greater than one. standard errors for ρ and ω were approximated using the delta method as

 seρ=sekaikai2+seksiksi2+sekaakaa2+seksaksa2andseω=sekaka2+seksks <dig>  

saccharomyces data and analysis
we obtained from kellis et al.  <cit>  the protein-coding genes and ortholog assignments  for four saccharomyces species: s. cerevisiae, s. paradoxus, s. mikitae, and s. bayanus. we considered only those proteins for which all four sequences were present, and these were aligned using clustalw and subjected to phylogenetic analysis assuming the fixed unrooted topology , ). the method of goldman and yang  <cit> , as implemented in paml , was used to jointly infer "ancestral" sequences at the coalescence of cerevisiae/paradoxus and of mikitae/bayanus. this facilitated five pairwise comparisons that collectively span the tree:  cerevisiae vs. cerevisiae/paradoxus,  paradoxus vs. cerevisiae/paradoxus ,  mikitae vs. mikitae/bayanus,  bayanus vs. mikitae/bayanus, and  cerevisiae/paradoxus vs. mikitae/bayanus. subsequently, kaa, ksa, kai and ksi were calculated for each. to compute a dispersion ratio for the tree, we first summed each of these measures across the five branches comprising , ). the dispersion ratio for each gene was thus given by / where each sum ranges over the five aforementioned pairwise comparisions.

comparing selection and dispersion for genes under recent positive selection
within the human/chimpanzee dataset gathered from ensembl, we identified those genes implicated as being under positive selection in the human lineage  <cit> . we then fit the model yi = α + βxi + γpi + εi, where the response variable yi is the log value for gene i, the continuous predictor variable xi is the log value for gene i, and

 pi= <dig> ifgeneiwasunderrecentpositiveselection <dig> otherwise 

comparing the dispersion ratio to established correlates of evolutionary rate
measures of protein-related attributes in saccharomyces cerevisae were collected from various sources . careful attention was paid to ensure that we chose exclusion criteria and data transformations consistent with published studies. after exclusion and transformation, each of the protein-related attributes described above was investigated for correlation to both log and log , x and rlog, x, respectively). partial correlations were computed between log and log after controlling for each of the protein-related attributes individually , log|x).

RESULTS
the dispersion ratio as a simple measure of clustering
in this section we introduce the dispersion ratio, a measure of the degree to which non-synonymous changes are clustered in a pairwise alignment. the dispersion ratio thus quantifies spatial heterogeneity, which is in general a common and well-studied phenomenon. to illustrate how we have adapted the concept, in figure  <dig> we present a hypothetical 27aa protein sequence that is composed of alternating rapidly- and slowly-evolving segments. to construct the dispersion ratio from a pair of aligned protein-coding sequences, we begin by identifying all positions j in the alignment at which the amino acids disagree. we then label the sites adjacent to mismatches  with an "a". we next partition the alignment into two subalignments: one composed exclusively of the sites labeled "a", and one composed of the remaining sites, which we label "i" for isolated. within each of these subalignments, we compute the ratio of the rate of non-synonymous substitutions to the rate of synonymous substitutions . the dispersion ratio ρ is the ratio of ratios ωi/ωa. the dispersion ratio measures the degree to which non-synonymous changes are clustered along a protein's primary sequence. it specifically quantifies the propensity for non-synonymous changes to neighbor one another in a comparison of homologous proteins. the philosophy of ρ can be conveyed through figure  <dig> by simply tallying where the non-synonymous changes fall; there  <dig> of  <dig> isolated sites  harbor a non-synonymous change, as compared to  <dig> of  <dig> adjacent ones , suggesting a dispersion ratio smaller than one. as the name implies, larger values of ρ indicate that non-synonymous changes are more dispersed, whereas smaller values indicate a greater degree of clustering. supplied with this definition of ρ, we can rephrase our first hypothesis as follows: if ω is the ratio of the rate of non-synonymous substitutions to the rate of synonymous substitutions for the entire protein, then we hypothesize a genome-wide trend that relates ω to ρ.

a significant log-linear relationship between selection and dispersion
to test hypothesis , we conducted a genome-wide comparison between each human protein-coding gene and its ortholog, when present and unambiguous, across eight vertebrate species . we restricted ourselves to unique orthologs as designated by ensembl  and used their previously computed alignments. for each alignment, we used the model of yang and nielsen  <cit>  as implemented in paml to compute ω, ωi and ωa as described above. each aligned pair of orthologs thus provides a  coordinate pair that can be entered into a species-specific scatterplot of genes. these eight scatterplots - one for each non-human species in the phylogeny of figure  <dig> - show a consistent, non-linear monotonic trend; as ω decreases, so too does ρ, indicating that the degree to which non-synonymous changes cluster increases with the strength of purifying selection . when the two axes are log-transformed, so that log is plotted against log, the relationship becomes linear and highly significant. in figure  <dig>  log is plotted against log in blue for  <dig>  aligned pairs of orthologous genes identified in human and mouse . the linear trend depicted in black is highly significant  and is not limited to the comparison of human and mouse. indeed, as figure  <dig> shows, each of the eight comparisons provides strong evidence of a significant log-linear trend relating our chosen measures of selection and dispersion. to isolate the effect of calibrating by synonymous substitution rates, figure  <dig> also includes results from alternative measures of selection and dispersion based on unscaled protein divergence. these results, which compare log to log without regard to synonymous substitution rates, show a similar but weaker trend.

to emphasize the significance of our findings, the scatterplot of figure  <dig> in red presents a control. our control, constructed in the spirit of the dispersion ratio, follows the construction illustrated in figure  <dig> for synonymous rather than for non-synonymous changes. thus, whereas ρ is created by first partitioning sites in the alignment according to the location of non-synonymous changes, the synonymous dispersion ratio ρs is created by first partitioning sites according to where synonymous changes are observed. figure  <dig> plots log against log in red for the human/mouse comparison. as the figure shows, the relationship is not significant , suggesting that in strong contrast to non-synonymous changes, the clustering of synonymous changes does not depend on the intensity of purifying selection on the protein sequence. as a final validation, we turned to a permutation-based approach whereby the order of sites in each alignment was shuffled. the effect of this, for any one aligned pair of orthologs, is to hold ω fixed while varying ρ in a random, non-biological way. permuting each aligned human/mouse pair creates an alternative version of the blue scatterplot in figure 4; the observed correlation can be thought of as a sample from a null distribution under which selection and dispersion are not biologically related. we used  <dig> genome-wide permutations to perform a non-parametric test of the null hypothesis that the observed correlation between ω and ρ is consistent with a spatially random placement of non-synonymous changes. owing to edge effects and the discrete nature of the data, the expected correlation of ω and ρ under the null hypothesis is biased away from zero; nevertheless, the correlation observed in our original data is uniformly and substantially larger than any of the permuted realizations , and this persists regardless of the comparison. this, once again, supports the existence of a genome-wide trend relating the intensity with which purifying selection acts on a protein and the intensity with which non-synonymous changes are clustered.

genes under recent positive selection deviate from the trend
in a pairwise comparison of protein-coding sequences, it is difficult to disentangle the mode and tempo of the evolutionary process. for example, genes under recent positive selection in the human lineage may not appear as such in a pairwise comparison if purifying selection is acting upon the gene in the sister lineage. put another way, the pairwise comparison reflects the aggregated effects of two evolutionary regimes, one in which the protein evolves at a rate faster than expected under neutrality, and one in which the protein evolves at a rate slower than expected under neutrality. as a consequence of this aggregation, the individual regimes that compose such a mixed regime may be obscured, unless of course additional information is incorporated in the analysis. we hypothesize that the dispersion ratio provides useful information toward disentangling mixed evolutionary regimes. evidence of this comes from the observation that both purifying selection and positive selection appear to promote the clustering of non-synonymous changes: if both regimes promote clustering, than the degree of clustering observed under a mixed regime may be surprisingly large given the apparent intensity of selection. the stable relationship between log and log presented previously suggests that log can be predicted from log; in a pairwise comparison that spans a mixed regime, log may be appear too large when compared to a prediction based on the value of log that was observed. in other words, we hypothesized that a mixed regime might lead to evolutionary rates that are "too fast" for the degree of clustering observed.

as a test of this hypothesis, we turned to a set of protein-coding genes implicated as being under positive selection in the human lineage after the human/chimpanzee split  <cit> . reversing the axes from figure  <dig>  in figure  <dig> we identified these genes in a human/chimpanzee scatterplot of log vs. log . qualitatively, the positively-selected genes  appear to have larger-than-average values of ω for any given ρ; quantitatively, we assessed this using a linear model that includes an indicator variable. letting xi and yi denote the log and log values for gene i, respectively, and defining the indicator to be pi be equal to one if gene i was deemed to be under recent positive selection and equal to zero otherwise, we tested whether γ =  <dig> in the linear model yi = α + βxi + γpi + εi. we were able to reject the null hypothesis γ =  <dig> when tested against the biological one-sided alternative γ <  <dig> , concluding that as compared to the overall clustering trend the rates of "mixed-regime" genes appear to be elevated.

the dispersion ratio is a non-redundant predictor of evolutionary rate
recall that, as depicted in figure 2a, one interpretation of the dispersion ratio is that it captures the latent segmentation of rate classes within a protein sequence. this segmentation, in turn, may be due to constraints on a protein's structure and function. viewed in this way, it is not unreasonable to consider the dispersion ratio as a crude but informative surrogate of the structural constraints acting upon a protein. we have provided evidence that this structural surrogate is predictive of the rate at which a protein evolves , and we have shown that the clustering measured by ρ is independent of ω when the sequences have been permuted . in this section, we investigate how ρ compares with other established correlates of evolutionary rate.

we have structured this comparison to bring it in accord with the literature. the manuscripts we sought to parallel collectively introduce a diverse set of potential correlates of a protein's evolutionary rate. the measures we consider span a wide range of protein-related attributes, including mrna expression level  <cit> , protein abundance  <cit> , translational efficiency   <cit> , dispensability   <cit> , sequence length  <cit> , the number of protein-protein interaction partners  <cit> , the protein's contact density  <cit> , the fraction of residues in the protein that are at least 25% buried, and the fraction of residues involved in various secondary structure elements   <cit> . in addition to correlating these attributes both to log and log, we considered each as a controlling variable to test the persistence of a significant log-linear relationship between ρ and ω in yeast.

the yeast dataset we employ comes from  <cit>  and includes annotated protein-coding genes from four saccharomyces species: s. cerevisiae, s. paradoxus, s. mikitae, and s. bayanus. we again focused on groups of unique orthologs, and because here for each protein-coding gene we have four sequences instead of two, we were forced to extend the dispersion ratio beyond pairwise comparisons. our approach was to treat the unrooted phylogeny from  <cit> , , ), as representing five separate pairwise comparisons to be aggregated . to accomplish this required us to infer the sequences at the internal nodes of the tree, and we did so under a probabilistic model from  <cit> , using the algorithm of  <cit> . for each pair of sequences spanning a branch on the tree, we partitioned their alignment as in figure  <dig> to obtain four values:  kaa, the adjacent rate of non-synonymous changes,  ksa, the adjacent rate of synonymous changes,  kai, the isolated rate of non-synonymous changes, and  ksi, the isolated rate of synonymous changes. note that whereas before we combined these to compute ρ, here we have kept them separate so that each can be summed across the tree. in this way, we computed the dispersion ratio for each yeast protein-coding gene as /.

as before, we find a highly significant log-linear relationship between the dispersion ratio and evolutionary rate. to test whether or not that relationship persists after controlling for the aforementioned protein-related attributes, we used the method of partial correlation. specifically, we computed the partial correlation between log and log after controlling for each of the protein-related attributes in table  <dig>  the results show that the log-linear relationship between selection and dispersion remains highly significant even after controlling for a variety of established evolutionary correlates. the strength of that relationship, in comparison to those observed for other attributes, is remarkable  and suggests that the dispersion ratio is capturing an important determinant of evolutionary rate.

discussion
as a protein-coding gene evolves, non-synonymous substitutions do not accumulate uniformly along its sequence. there is heterogeneity among the rates at which individual sites within a protein evolve, and part of that heterogeneity is induced by structural and functional constraints. though the structural and functional domains that comprise proteins are contingent upon tertiary folding, there is enrichment within domains for residues that are contiguous along the primary sequence. as such, within proteins there exists rate autocorrelation that can be, and has been, exploited to annotate regions of putative importance.

in a pairwise comparison of protein-coding genes, rate heterogeneity manifests in the non-random placement of non-synonymous changes. one expects a dearth of such changes in regions of structural and functional importance and a relative excess where the intensity of selection is less. the aggregation of changes outside of important regions may lead to the appearance that non-synonymous changes are clustering. we speculated that the appearance of clustering would increase with an increasing intensity of selection, and we developed the dispersion ratio to test that hypothesis. confirming our speculation, we found a highly-significant log-linear relationship between the dispersion ratio and evolutionary rate. this relationship was observed to be robust to both choice of species and degree of evolutionary divergence.

just as purifying selection acts to cluster substitutions along the sequence of a protein, there is evidence that diversifying selection leads to clustering as well. this led us to consider the case of genes whose modes of evolution differ on sister lineages. in cases when the evolutionary trajectory spanned by a pairwise comparison contains a mixture of purifying and diversifying selection, we hypothesized an effect on the relationship between the dispersion ratio and evolutionary rate. having already observed that the degree to which non-synonymous changes cluster is predictive of the rate at which a protein is evolving, we reasoned that for mixed regimes such predictions would be biased downward. at least for the data we examined, this turned out to be the case: for genes under positive selection in the human lineage, the evolutionary rate estimated from a human/chimpanzee comparison was greater than what the degree of clustering would predict.

to place in perspective the contribution of the dispersion ratio as a predictor of evolutionary rate, we compared its explanatory power to those of a diverse set of protein-related attributes. in doing so, we found log to be a highly-significant and non-redundant correlate of the logarithmic rate, log. the correlation between log and log, and its persistence after conditioning on other correlates of evolutionary rate, speaks to either a determinant of evolutionary rate that has not yet been characterized or a deficiency in the way evolutionary rate has been quantified in this particular set of studies. whatever the case, it appears that non-synonymous clustering is a reliable, non-redundant, sequence-based predictor of ω.

because the dispersion ratio behaves differently under neutrality and under purifying selection, and because permutations can be used to populate a sensible null distribution, one can envision using the dispersion ratio in a test of selection. nevertheless, we did not devise ρ as a statistic to test the behavior of individual genes, and such tests, though conceivable, would likely be underpowered and inferior to existing methods . these methods, unlike ours, were specifically designed to identify the presence of clustered substitutions and test their significance against an appropriate null hypothesis about a specific gene. by contrast, we were motivated by simplicity and proposed the dispersion ratio as an intuitive means of testing the existence of genome-wide evolutionary trends, without regard to any particular gene. other measures of clustering are likely to perform similarly, and indeed we observe similar results to those presented when ρ is replaced by a model-based measure of autocorrelation .

the intuition behind our statistic and its relationship to evolutionary rate is grounded in dependencies induced by protein tertiary structure. though ρ is a function of sequence and not structure, the dispersion ratio, like the methods from which it was inspired , leverages the fact that adjacent residues in the sequence are structurally proximal. it seems reasonable that a structurally-informed analog of the dispersion ratio would be superior to ρ in validating the hypotheses of this manuscript, but we did not find this to be the case . this may be due to, among other possibilities, the limited number of structures available or the manner in which we extended our statistic.

in interpreting the results presented here, it should be noted that all of our analyses were contingent upon sequence alignment. because alignment uncertainty tends to increase with sequence divergence, to the extent that alignment errors affect neighboring sites, one expects a spurious non-biological correlation between ω and ρ. while alignment error may indeed contribute to the signal we observe, we do not believe it to play a major role. several of our analyses feature very closely related species whose orthologous proteins are predominantly the same length. for these proteins, the alignment is unambiguous, unless there was both an insertion and deletion event.

CONCLUSIONS
in summary, we have proposed a simple statistic that quantifies the degree of non-synonymous clustering in a pairwise comparison, and we did so to test hypotheses about how clustering varies with evolutionary rate. we found ample evidence of a strong log-linear relationship, and we tested the robustness and validity of our observations in a number of ways. to investigate generality, we considered eight vertebrate pairwise comparisons spanning a wide range of evolutionary divergence, as well as a comparison of four saccharomyces yeast. to investigate potential artifacts, we used as controls both a permutation approach and a synonymous dispersion statistic. to investigate methodological dependence, we considered alternatives to the dispersion ratio, including the idea of simply "counting" synonymous and non-synonymous changes as suggested by nei and gojobori  <cit>  and by li  <cit>  . in every case, for every comparison, we find that non-synonymous clustering intensifies with increasing purifying selection. the ubiquity of this relationship supports the concept of a loose segmentation model for protein sequences as well as the use of de novo annotation methods that have implicitly capitalized upon it.

authors' contributions
lgm and eas conceived the study, performed the statistical analysis, participated in the design and drafted the manuscript. all authors read and approved the final manuscript.

acknowledgements and funding
lgm was supported by a training grant in bioinformatics from the national institute of environmental health sciences. this work was supported in part by a grant from the national institute of general medical sciences .
