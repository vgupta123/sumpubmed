BACKGROUND
chromosomal abnormalities, including deletions, amplifications, and uniparental disomy  events, are a significant cause of mendelian and complex disorders, as well as a source of benign variation within a population. technological advancements such as snp microarrays and next-generation sequencing have dramatically enhanced disease research and diagnosis by improving the ability to detect genomic variation. along with technological advances, new algorithms for data analysis improve our ability to identify biological aberrations within large datasets. many algorithms are designed to detect abnormalities that result in copy number variation , but frequently neglect regions of upd and somatic mosaicism. within a population of cells originating from a single zygote, any somatic change results in mosaicism, in which a subset of cells harbors a unique genetic variant. our understanding of the prevalence and consequences of mosaic abnormalities remains limited, due to the difficulty of detecting alterations in a small subpopulation of cells. mosaic abnormalities have been implicated in a multitude of disorders, including alzheimer’s disease, schizophrenia, autism, neurofibromatosis, mccune-albright syndrome, duchenne muscular dystrophy, proteus syndrome, heart, kidney, neuromuscular, and dysmorphic syndromes, as well as cancer  <cit> . lymphoblastoid cell lines, commonly used for disease research, frequently undergo both the introduction of large mosaic abnormalities and the loss of biological mosaicism due to a tendency toward clonality  <cit> .

there are many useful algorithms for abnormality detection in snp array data. implementations of segmentation-based approaches applied to b allele frequency  and log r ratio  values, including bafsegmentation  <cit>  and mad  <cit> , are proficient at detecting abnormalities, including mosaicism, when there are suitably large percentages of abnormal cells. snptrio makes use of genotypes from parent–child trios and reports uniparental inheritance, but is generally limited to detection of non-mosaic deletion and upd events  <cit> . penncnv joint is a hidden markov model -based cnv detection tool which is capable of improved detection using parent–child trios, but is not designed to detect upd or partial copy number states  <cit> . other hmm-based approaches, including pscn, genocn, mixhmm, and gphmm, can detect cnvs and upd events in tumor/normal mixtures and are thus capable of detecting mosaic changes at a certain level of resolution  <cit> . a bayesian-based algorithm, gbpcr, also reports successful detection of both cnvs and upd events in mixed tumor/normal samples, but has a very long run time   <cit> . a highly sensitive method for quantification of the level of mosaicism has been reported, which applies the distribution analysis by fitting integrated probabilities method to determine the central tendencies of the baf band distributions, but there is not currently a feasible implementation for detection of unknown mosaic regions  <cit> . while many algorithms can detect a subset of mosaic abnormalities, the resolution for low-level mosaicism can be greatly improved.

here we present an algorithm for highly sensitive and specific detection of mosaic and non-mosaic abnormalities in offspring by employing the parent of origin-based detection  method on snp array data from a parent–child trio. we also describe an implementation of this algorithm in tripod , which includes additional parental contribution-based approaches for abnormality detection. tripod outperforms current state of the art detection methods, shows greatly improved sensitivity for detection of low-level mosaicism, and uniquely provides the parental origin for each detected abnormality. tripod software is made available as a command line program and as a web application.

RESULTS
snp array technology provides a convenient source of data for the detection of chromosomal abnormalities. snp arrays consist of immobilized allele-specific probes for hybridization with fluorescently-labeled target dna. for the illumina platform, the normalized intensity ratio at each position is subjected to linear interpolation based on aa, ab, and bb reference genotype cluster positions  <cit> . the resulting value is an expression of the intensity ratio in terms of the b allele and is referred to as the b allele frequency . genotype determination incorporates the proximity of the baf and lrr values of a sample to those of the reference cluster. when a chromosomal abnormality is present, the baf values  deviate from the expected range and possibly affect the genotype call. a snp with a baf or lrr value not located within close proximity to an allelic cluster cannot be assigned a genotype and is thus labeled a no call . a mosaic abnormality can result in a mixture of genotypes . the resulting diploid genotype as called by the default illumina algorithm is dependent on the extent of mosaicism and would be either the genotype of the largest subpopulation  or a nc. mosaic abnormalities can be visualized as aberrations from the expected genotype bands in a baf plot .

the pod method
the pod method identifies snps which are informative for abnormal parental contribution. we define an informative snp as a polymorphic position where the comparison of parental and progeny genotypes  potentially reveals abnormal parental contribution for the surrounding region . abnormally contributed snps are enriched for by analyzing the outliers of the sample-specific normal heterozygous baf distribution. for example, if at a given snp position the parental alleles are aa  and bb , the genotype of the child is expected to be ab. thus the baf value is expected to be a member of the distribution of normal heterozygous baf values. in this case, if the child’s baf value is abnormally depressed, it may indicate an underlying biological abnormality resulting in an elevated proportion of paternal a alleles. conversely, if the child’s baf value is abnormally elevated, it may indicate an underlying biological abnormality resulting in an elevated proportion of maternal b alleles. the combination of parental genotypes and progeny baf outliers allows for a highly sensitive inference of mosaic parental contribution regardless of the progeny genotype call. the information content provided by the pod method can be effectively utilized for abnormal region detection by multiple algorithmic and statistical approaches and is the most useful when used concurrently with segmentation or model-based cnv detection. this method can also be used to detect abnormalities in any member of the parent–child trio using inheritance-based expectations of genotype and baf values .

combinations of genotypes and outlier baf values provide information content useful for the pod method. given specific parental genotype combinations, when the child’s baf value is an outlier of the normal baf distribution, it may be indicative of a departure from expected biallelic inheritance. the ↑ symbol indicates an unexpected elevation of the child’s baf value . the ↓ symbol indicates an unexpected depression of the baf value .

the pod method can also be employed to detect parental abnormalities. given specific genotype combinations between a parent and child, when the other parent’s baf value is an outlier of the normal baf distribution, it may be indicative of a departure from expected biallelic inheritance. the ↑ symbol indicates an unexpected elevation of the baf value . the ↓ symbol indicates an unexpected depression of the baf value .

tripod description
tripod is a fast, efficient, multi-threaded software program for chromosomal abnormality detection in offspring using snp array data from parent–child trios. it is implemented as a perl script and makes use of the r software environment for graphical output. it can be used for single trios or batches. it is designed to distribute analyses of individual chromosome arms to a user-supplied number of processors and perform parallelized single processor analyses of samples in batch mode. for the current implementation, average run times for analyses of a single trio with ~ <dig>  snps were recorded on a linux server with  <dig>  ghz xeon x <dig> processors and range from ~ <dig> seconds on a single cpu to ~ <dig> seconds employing  <dig> cpu cores . in batch mode, a number of samples equal to the number of cpu cores can be analyzed in parallel in the same amount of time required for a single sample on a single cpu core. the user can specify the use of the four detection algorithms described below. the output includes detailed annotation of detected abnormal regions in tabular format, optional graphical output of chromosomes harboring abnormalities, a file in bed format for use with genome browsers, an optional file reporting calculated parameters and thresholds, and a log file for error reporting.

tripod workflow
tripod includes an implementation of the pod method, in addition to streak-based approaches to homozygous deletion , single mendelian error -based , and cryptic  region detection . the sliding window approach employed combines high resolution and an adequate sampling of the surrounding region. the following is a summary of the tripod workflow:

 <dig>  sample-specific parameter specifications and probability estimations are calculated.

 <dig>  pod method. snps are analyzed for information content based on genotype combinations and progeny baf values.

 <dig>  pod region detection. informative snps are analyzed using overlapping windows. the ratios of parental abnormal snp contributions are evaluated using a two-tailed binomial test along each chromosome. overlapping abnormal windows are combined and expanded until evidence of a change in contribution is encountered. remaining normal segments are evaluated for low-level mosaicism.

 <dig>  streak-based region detection. the podhd, podmi <dig>  and podcr algorithms detect abnormalities by identifying statistically significant streaks of abnormal snps.

 <dig>  the boundaries of detected abnormal regions are refined using an optimized bidirectional cumulative sums  approach applied to the lrr values or mirrored baf  values .

 <dig>  steps  <dig> –  <dig> are then repeated, following a refinement of the baf and lrr parameters, which are generally derived from the normal regions of the local chromosome arm.

 <dig>  overlapping detected regions are combined or spliced and annotated for parent-of-origin, type of abnormality, and inheritance pattern.

 <dig>  the abnormal regions can be viewed as tabular and/or graphical output .

implementation of the pod method
genetic abnormalities can be detected using a parental contribution model derived from the principles of inheritance. normal biparental inheritance results in progeny who share approximately 50% of their genome with each parent. inheritance of a parental chromosome harboring a mutation  or the acquisition of a somatic mutation alters the expected 1: <dig> parental contribution ratio for that region. the tripod implementation of the pod method is based on a statistical model in which the parental contributions revealed by informative snps in regions of biparental inheritance can be viewed as a sequence of bernoulli trials where the outcomes occur with equal probability. so in a set of n informative snps, the number k that indicate paternal contribution can be viewed as the outcome of the binomial random variable xn ~ b. thus, a two-tailed binomial test can be applied to identify statistically significant deviations from the expected distribution over a region of the genome, indicating the presence of a chromosomal abnormality.

informative snps are detected using a combination of genotypes and progeny baf values exceeding a threshold. to specify the baf thresholds, the mean baf values of heterozygous and homozygous snps in normal autosomal chromosomes for each sample are calculated, and thresholds are defined as a specified number of standard deviations  of the mean. the default number of sds for heterozygous snps is  <dig> based on chebyshev's inequality, such that for any baf distribution, a minimum of 50% of snps with normal bafs will be identified and removed from the analysis as uninformative. chebyshev's inequality sets a distribution-independent minimum threshold for the percentage of values within k sds of the mean, defined as 1−1k <dig> for all k >  <dig>  an initial search for informative snps using autosomal baf thresholds allows for an observation of the distribution of windows containing different amounts of information content .

the informative snps are first evaluated using overlapping windows  in single snp increments along each chromosome arm. for each window the binomial test is applied and the p-value of the observed outcome of the random variable xn is calculated. the probability mass function for the binomial distribution is defined to be

 bk;n,p=nkpk1−pn−k, 

where nk=n!k!n−k!, n is the number of trials, k is the number of successes, and p is the probability of success. the formula for calculating the p-value for the two-tailed binomial test is

 pk;n,p=∑i=0kbi,n,p+∑i=n−knbi,n,p,k<n/ <dig> k=n/2∑i=0n−kbi,n,p+∑i=knbi,n,p,k>n/ <dig>  

where, in our case, p =  <dig>  and k is the number of snp positions with abnormal paternal contribution out of n informative snps in a window. the null hypothesis, that the window lies in a region of biparental inheritance, is rejected if the p-value falls below the significance threshold, indicating a chromosomal abnormality within or including the current window.

each overlapping window which contains a new set of informative snps and is not inside of an abnormal region constitutes a new binomial test. due to the unusual dependency structure created by tests applied to overlapping windows, the most appropriate method of controlling the familywise error rate  is derived from the field of scan statistics, which focuses on the clustering of events observed while scanning time or space. we first compute the expected number of windows e containing k informative snps given by

 ewk=n−k+1∑i=k−1nbi;n,wm, 

where m is the total number of snps, n is the total number of informative snps, and w is the window size  <cit>  . then at a given threshold β, the probability of making a type i error is given by

 pfwerβ=∑k∑i=1ewkbi;ewk,γk, 

where

 γk=maxpj;k, <dig> |pj;k, <dig> ≤βandj≤k. 

thus we can control the fwer by finding a β such that pfwer is below the α-value. since our set of possible p-values is discrete and relatively small, this can be done efficiently, and in our implementation we test the values βk = p for increasing k. the first βk satisfying pfwer < α becomes our significance threshold for the individual binomial tests.

when an abnormal window is identified, it becomes the seed of an abnormal region, which is expanded until there is evidence of a change-point in the distribution of parental contributions. the boundary is then retracted to the most recent significantly abnormal window and further retracted to the first and last informative snps with contribution from the appropriate parent. the region boundaries are then refined using the bidirectional cusum approach .

in an abnormal region, all informative snps should show abnormal contribution from the same parent unless a genotyping error has occurred. most detectable errors in an abnormal region will show up as informative for the opposite parent. therefore we can view each snp in the window as a bernoulli trial for which the probability of success  is the estimated error rate e . as before, we can apply a binomial test to assess deviations from the expected distribution which would indicate that the abnormal region has ended and initiate boundary retraction. in this case the applicable test is one-tailed, and the p-value is equal to ∑i=knbi,n,e.

chromosomal regions without detected abnormalities undergo further analysis using a larger overlapping window size . this analysis is specifically designed to enhance the detection of large low-level mosaic abnormalities and illustrates the utility of employing multiple window sizes within the pod method. a large window analysis has higher sensitivity and lower specificity than a small window analysis. by implementing an initial analysis with smaller windows, a large majority of abnormalities will be detected with highly specific boundaries before any remaining low-level mosaic abnormalities would be detected during the subsequent large window analysis. this allows for an elevation of overall sensitivity with a minimal reduction in overall specificity.

streak detection
when analyzing trios, there are many additional ways to evaluate parental contribution data. to complement the pod approach, tripod employs a streak-based algorithm for detection of hd- and mi1-based abnormalities, as well as abnormal regions lacking sufficient parental information content. a streak is comprised of adjacent informative snps. informative snps are defined differently depending on the algorithm used for streak detection and autosomal rates are calculated . the minimum number of adjacent informative snps which can be considered a statistically significant abnormality is calculated by computing the minimum m for which the p-value of the occurrence of m adjacent informative snps falls below the user defined α-value. a highly accurate approximation of the p-value of a streak of size m is given by

 psm;n,p=1−q2q3/q2n/m− <dig>  

where

 q2=1−pm1+mq, 

 q3=1−pm1+2mq+ <dig> p2m2mq+mm−1q <dig>  

n is the total number of snps, and p is an autosomal rate of informative snps  <cit>  .

for hd detection, since the source of parental dna is considered an appropriate proxy for the individual gametes comprising the zygote, hd regions in a parent indicate a total absence of genetic contribution and are thus detected and reported as abnormalities in the child. in the podhd algorithm, an hd snp is defined as having a lrr value sufficiently outlying the distribution ofsingle-copy deletion values centered near − <dig>  . for each trio member, the minimum size of a significant hd streak is computed as above with p defined as the autosomal rate of hd snps. all hd streaks larger than the minimum size are detected. the overlapping streaks are combined and expanded using the bidirectional cusum approach applied to the lrr values. non-hd regions in the child which correspond to a parental hd region are evaluated using the cusum approach and spliced into adjacent abnormal regions of different types, when necessary.

in the podmi <dig> algorithm, informative mi <dig> snps are defined as all genotype combinations from which a single inheritance error can be inferred, including all informative snp combinations with an abnormal baf value which exceeds 5sd of the normal heterozygous baf mean. the minimum podmi <dig> region size and region detection is performed as above with n defined as the total number of polymorphic snps and p as the autosomal rate of mi <dig> snps. podmi <dig> detection is very useful for identifying small non-mosaic or high-level mosaic abnormalities frequently below the detection limit of the pod method. it is also useful for resolving instances in which the pod method detects a small abnormality but is unable to completely refine the boundaries .

we define cryptic regions as having a statistically significant presence of outlier baf values. the autosomal rate of non-homozygous snps with baf values which exceed 2sd of the normal autosomal mean is calculated. the minimum size of a streak is computed as above with n defined as the total number of polymorphic snps and p as the autosomal rate of outlier baf values. windows with a significant rate of outlier baf values may be due to a local asymmetry in baf  <cit> , and are thus evaluated by the distribution of baf outliers above and below the distribution center. a two-tailed binomial test is applied, where n is the total number of outlier baf values and k is the minimum number of the upper or lower values. windows for which the null hypothesis is rejected, given the α-value corrected for number of detected cryptic regions, are evaluated and undergo boundary refinement with unknown parental origin. parent of origin is assigned, if possible, during the annotation stage.

boundary refinement
the detection of abnormal regions prior to boundary determination requires a unique application of change-point analysis for detection of single change-points bidirectionally from within an abnormality. the cumulative sums  approach is a standard method of change-point analysis developed to detect small changes hidden in a continuous process  <cit> . a basic one-sided cusum equation is

 sn=max <dig> sn−1+xn−k, 

in which the change-point is the maximum partial sum sn, x is a dataset with n members, and k is commonly the in-control sample mean or target value. we adapt this equation for boundary detection as follows: sn is a region boundary defined by a change-point between the normal and abnormal distributions, optimized k = / <dig>  and x is a sequence of lrr or non-homozygous mbaf values. our assignment of k maximizes the value of the change-point by creating approximately equal slopes on either side. this estimation of k is only optimal when variation between distributions is similar. since the hd variation is much larger than the other distributions, k ≤  <dig>  is considered to be more appropriate. from within an abnormal region the abnormal values will generally be >k, creating a positive slope which will peak at the change-point, after which the values in the normal region will generally be <k, creating a negative slope .

for an abnormal region to undergo lrr-based cusum boundary refinement, the lrr median must meet the lrr threshold requirements . if a region does not meet the lrr requirements, it will undergo baf-based cusum boundary refinement if the baf median meets the baf threshold requirements . for the application of a one-sided cusum approach, the lrr values for regions with a median <  <dig> are reflected about  <dig> and a maximum change-point is detected. the members of x evaluated by cusum are determined as follows:

 fori= <dig> s0=end,sn≤start−10e0=start,en≥end+ <dig> 

 3≤i≤3min,s0=crit|cen,sn≤start−5ie0=crit|cen,en≥end+5i 

 i>3min,s0=start+mininf,sn≤start−25e0=end−mininf,en≥end+ <dig>  

where i = number of snps in the abnormal region, s0 = x <dig> and sn = xn for the start boundary calculation, e0 = x <dig> and en = xn for the end boundary calculation, start = the initial start position of the abnormal region, end = the initial end position of the abnormal region, min = minimum pod region size, min inf = a min number of informative snps, crit = the position of the maximum lrr value in the region which is not equal to start or end, and cen = the position of the center informative snp for baf cusum. the variables s <dig> and e <dig> are snp positions located inside the abnormal region and sn and en, respectively, are upstream and downstream baseline snp positions located outside of the region. the sn and en values are determined by iterative moving median calculations of the data immediately adjacent to the abnormal region boundaries. median values are calculated for 5i ≤  <dig> snps in overlapping single snp increments. when the median value is <k, it is determined that the window extends into the adjacent baseline data and sn or en = the most distant snp evaluated. since a detected region likely includes false positive snps in addition to the true abnormality, when 3 ≤ i ≤ 3min, s <dig> = e <dig> = the position of the maximum lrr value in the abnormal region to ensure that cusum begins within the true abnormality. for baf-based cusum of similar regions, cusum begins from the center informative snp, since extreme values are less informative. in order to reduce the chance that cusum finds an incorrect local maximum when evaluating a large region, the analysis begins min inf snps from start and end when i > 3min.

a series of rules are designed to control for unusual situations. if a max peak is not detected, the boundary defaults to the initial value. if the median of the adjacent data is twice as large as or larger than the median of the abnormal region, it is deemed likely that there is an adjacent unique abnormality and the initial boundary remains, unless a cusum minimum was detected. random hd lrr outliers in a hemizygous deletion region are ignored. random baf outliers > the region median +  <dig>  are ignored.

overlap and annotation
for occasions when regions called by different tripod detection methods overlap, rules have been created to prioritize, combine, and splice such regions. podhd regions are predominantly small regions and are reported as detected without fragmenting larger overlapping regions. non-mosaic or high-level mosaic abnormalities can be detected by multiple methods. since the podmi <dig> algorithm is more adept at defining small regions than the pod algorithm, in certain cases we assume that both algorithms are detecting the same small abnormalities and give the podmi <dig> region priority. when a pod region overlaps no more than two podmi <dig> regions and the information content within non-overlapping pod segments is not larger than the minimum acceptable region size, the pod region is discarded in favor of the podmi <dig> region. otherwise, overlapping regions are combined or spliced based upon various factors, including size of region, number of informative snps, parental contribution, and type of abnormality.

detected regions are annotated by parent-of-origin, type of abnormality and inheritance. the type of abnormality is assigned using a threshold-based approach applied to the normalized median lrr value. this value is compared to a threshold normalized to the local baseline lrr median as follows: amplification  ≥  <dig> , deletion  > − <dig>  and ≤ − <dig> , and hd ≤ − <dig> . detected regions with normalized median lrr values > − <dig>  and <  <dig>  may be any of the following: a upd region, a region of low-level mosaicism of any type , or a region containing a small abnormality along with many normal snps. within this group, uniparental heterodisomy  is assigned to otherwise unannotated regions if the child’s genotypes exactly match the genotypes of the parent of origin, taking into account the estimated error rate. uniparental isodisomy  is assigned to unannotated regions if ≥ 90% of the child’s genotypes are homozygous or if the normalized median mbaf value is >  <dig>  and lrr values are > − <dig>  and <  <dig> . noisy lrr values may affect proper annotation of small regions. when the inheritance pattern indicates that an abnormality was likely inherited, an annotation of inherited  or inherited with a unique cn state  is provided. the inh state is defined as follows: an amp is inherited if the contributing parent also has an amp; a del is inherited if the contributing parent also has a del; an hd region is inherited if the contributing parent have any heritable combination of hd and del regions not indicative of a unique cn state. the inh-cn state is defined as follows: an inh-cn del exists when the contributing parent has an hd region and the opposite parent is normal; an inh-cn hd region exists when both parents have a single-copy del. we make no judgment as to the inheritance state of any region which does not fall within the above stated parameters.

tripod provides graphical  and annotated tabular output for detected abnormalities, including parent-of-origin, type of abnormality, inheritance pattern, detection method, region size, number of informative snps, and the median mbaf and lrr values for all trio members. the reported regional mbaf and lrr values are normalized as the distance from the median local baseline values. if > 75% of a chromosome arm is abnormal, the medians are normalized to the baseline values of the adjacent chromosome arm. in the case of aneuploidy, the medians are normalized to the autosomal baseline values. since a parent-of-origin determination is dependent upon the type of abnormality, when the type of abnormality is not called, the detected parental contributor will be designated in the output.

benchmarking with simulated data
for benchmarking purposes, we adapted a simulated tumor dilution dataset made available by staaf et al.  <cit> , which has been frequently used for testing the sensitivity and specificity of detection for new algorithms  <cit>  . this dataset contains  <dig> simulated abnormalities ranging from 0% to 100% normal cells in intervals of 5%, totaling  <dig> samples. for use with tripod, microarray data was obtained for hapmap  <cit>  samples na <dig> and na <dig>  the father and mother, respectively, of na <dig>  the sample upon which the simulation was constructed. similar to staaf et al., we assumed that the simulated abnormalities were the only aberrant regions in this dataset.

the dataset was analyzed using tripod’s pod method and five leading software programs for chromosomal abnormality detection: paired bafsegmentation , genocna , mad , penncnv joint , and pscn   <cit> . sensitivity and specificity were calculated at each level of mosaicism for each abnormality as in staff et al.  <cit>  . tripod outperformed all other methods based on sensitivity of detection, displaying a large improvement at low levels of mosaicism . for consistency with previous publications, the level of mosaicism was plotted as a percentage of normal cells, in which case a high percentage of normal cells corresponds to a low-level mosaic abnormality. tripod’s increase in sensitivity is apparent in all types of simulated abnormalities. the mean sensitivity at each level of mosaicism is presented in figure 4a. at low levels of mosaicism , tripod displayed a mean sensitivity of 99%, 98%, and 83%, respectively, compared to the next best performing method  with 33%, 20%, and 0%. mean detection thresholds were calculated as the mean of the percent normal cells  at which the sensitivity of detection first drops to zero. tripod’s mean detection threshold of 96% greatly exceeded all other programs, followed by pscn  and bafsegmentation  . the high level of consistency displayed by tripod is evidenced by the fact that 91% of the mosaic abnormalities were detected at a level > = 95% sensitivity, compared to pscn  and bafsegmentation  . the similarity between a program’s mean detected region size and the mean size of the simulated regions reveals its ability to detect a large abnormality as a single region. compared to the mean simulated region size of  <dig> snps, tripod’s mean region size was  <dig> snps, bafsegmentation had  <dig>  and the others were much smaller . the specificity of tripod, penncnv, bafsegmentation, mad, and genocna were comparable and very high , while the specificity for pscn was much lower  . the reduced specificity of the default pscn settings allows for an elevation of sensitivity in this comparison. positive predictive value measurements  highlight the precision of tripod’s detection, which is superior to the other programs at low levels of mosaicism, maintaining greater than  <dig>  across all levels of mosaicism .

detection statistics are compared between tripod and other benchmarked programs. the mean detection threshold is the mean of the percent normal cells  at which the sensitivity of detection first drops to zero. the proportion detected >= 95% refers to the proportion of the total number of simulated abnormalities detected with >= 95% sensitivity. the mean region size serves as an indication of a program’s ability to call an entire abnormality as a single abnormal region.

low-level mosaicism comparisons
in order to illustrate tripod’s ability to detect low-level mosaicism in real data, progeny samples harboring large low-level mosaic abnormalities were identified by tripod in illumina humanhap <dig> trios provided by the autism genetic resource exchange  consortium  <cit> . twelve representative trios were chosen, in which a chromosome in the progeny sample harbored an abnormality which met the following criteria: the change-point is visually identifiable, large , low-level mosaic , segmental , and of reasonable quality . these samples underwent analyses with default parameters using tripod, bafsegmentation, genocna, mad, penncnv joint, and pscn. for these regions, comparisons between tripod and the other programs are not strictly benchmarking, since the appropriate regions were first identified using tripod, by necessity. they serve mainly to illustrate the capabilities of each program for detection of similar regions and to lend real-world support to the results of the simulation analyses. for each region, a cusum-based approach applied to a subset of the baf range  was used to successfully validate the existence of appropriate change-points corresponding to regions wholly or partially detected by tripod and visually identifiable as a widening or splitting of the heterozygous baf band. the calculated change-points served as estimates of the region boundaries. a single cusum boundary was calculated for terminal abnormalities. sensitivity was calculated as the ratio of the number of detected abnormal snps out of the total abnormal snps for each region. a detection threshold was set at a minimum of 10% sensitivity. tripod dramatically outperformed the other software, based on the number of regions detected and the average sensitivity  . pscn was able to detect  <dig> of  <dig> regions, for which the average sensitivity was 69%. mad was able to detect two of the regions, bafsegmentation and genocna detected a single region, and penncnv joint was unable to detect any of the low-level mosaic abnormalities. these results are graphically illustrated in figures  <dig>   <dig>   <dig>  note that several of the programs  called a larger number of abnormal regions in many chromosomes, compared to tripod, penncnv joint, and mad, many of which we assume to be false positives.

the sensitivity of abnormal region detection for  <dig> samples in the agre autism dataset harboring a large low-level mosaic abnormality is presented. the samples were analyzed by tripod, bafsegmentation , genocna, mad, penncnv joint, and pscn. . the % mosaic column is the estimated percent mosaicism calculated, using baf values >= the baseline median and <  <dig> , as the ratio of the distance of the abnormal baf median from the baseline median and the expected distance of a 100% mosaic abnormality from the baseline median. for low-level mosaicism, the type of abnormality is difficult to distinguish based on lrr values, thus a range is provided to account for regions resulting from a deletion or upd event  or an amplification.

cross-chip performance: hapmap samples
hapmap ceu and yri datasets processed on four different illumina microarray chips and available in the ncbi geo database  <cit>  were analyzed by tripod . summary results are presented in tables  <dig> and  <dig>  trios which were present in all four datasets and met quality controls were analyzed. the average percentage of ncs ranged from  <dig> % to  <dig> %. detected abnormalities were evaluated for overlapping calls  within the other datasets. the trio including offspring na <dig> was excluded from the overlap analyses due to the emergence of multiple large mosaic abnormalities described below. for abnormal regions with ≥  <dig> informative snps, 6% of the regions were unique to a single dataset, while 86%, 6%, and 2% overlapped regions called in one, two, or three other datasets. for regions with ≥  <dig> informative snps, 2% of the regions were unique to a single dataset, while 20%, 30%, and 48% overlapped regions called in one, two, or three other datasets. these results are illustrated in figure  <dig>  the 660w and omni <dig> datasets contain many more detected abnormalities due to the increase in cnv-specific probes . regions with ≥  <dig> informative snps in the 660w and omni <dig> datasets had 94% concordance. we conclude that, as expected, small regions were much more likely to overlap regions on one similar chip, and that tripod results for these regions are highly concordant. also, as expected, large regions were most frequently present in all four datasets and that tripod showed good concordance given the known fluctuation of mosaic of anomalies in cell lines .

1m: human1m-duov3; 660w: human660w-quadv1; omni1: humanomni1-quadv1; cytosnp12: humancytosnp-12v2-1; accession: accession identifier in the ncbi geo database; markers: approximate number of autosomal markers following conversion; cnv-specific: the number of autosomal cnv-specific probes; date processed: the processing date reported in the illumina final report. amp amplification, del hemizygous deletion, hd homozygous deletion, uphd uniparental heterodisomy, upid uniparental isodisomy, unk detected abnormalities of undetermined type.

rows and columns are defined in table  <dig> 

the ability to detect newly emerging mosaic abnormalities is illustrated in figures  <dig>   <dig>   <dig>  in which tripod results are provided for chromosomes  <dig>   <dig>  and  <dig> of sample na <dig>  several large mosaic abnormalities, detected by tripod and visually identifiable, are present in the omni <dig> and cytosnp <dig> samples: a large mosaic amplification on chromosome 8qter; a large low-level mosaic abnormality on chromosome  <dig> qter; a large low-level mosaic abnormality on chromosome 13q. as presented in table  <dig>  the 1m and 660w samples were processed at earlier dates than the omni <dig> and cytosnp <dig> samples. we believe that these large abnormalities occurred during passaging and expansion of this cell line and were thus present and detectable only in the more recently processed samples. tripod also detected a large very low-level abnormality on chromosome 5q of ceu sample na <dig> , which was possibly not present in the 660w and 1m samples and below the resolution of the cytosnp <dig> sample. newly emerging large mosaic abnormalities were not detected in the yri trios, although a previously reported  <cit>  mosaic amplification of the entire chromosome  <dig> in na <dig> was detected in all four datasets.

geneva cleft lip/palate and agre samples
the cleft lip/palate dataset is a part of the gene environment association studies initiative  and described in  <cit> . it consists of parent–child trios run on the illumina human <dig> quadv1_b microarray platform. most of the dna samples were obtained from whole blood, with limited samples from buccal brush/swap, saliva, mouthwash, and dried blood. of the  <dig> trios,  <dig> trios passed quality control before analysis with tripod. the autosomes of  <dig> of those were successfully analyzed by tripod .

the agre trios were previously run on the illumina humanhap <dig> microarray, which does not contain cnv-specific probes. the dna for these samples was derived from cultured lymphoblastoid cell lines. the autosomal data of  <dig> trios was successfully analyzed by tripod .

the total numbers and ratios of detected abnormalities by type ) are presented in table  <dig>  the presence of cnv-specific probes on the human <dig> chip used for the cleft data vastly increases the number of detected regions and alters the ratios. the distributions of the sizes for each type of abnormality in the cleft and agre datasets are presented in figure  <dig>  while the medians are similar between datasets, it is evident that the whiskers extend lower for the cleft findings  and the outliers tend to be larger and more abundant within the agre abnormalities.

rows are defined in table  <dig>  values in parentheses are proportions of the total abnormalities for each dataset.

for both the cleft and agre datasets, the large, highly informative abnormalities were identified. these regions with ≥  <dig> informative snps were visually investigated and multiple reports for single abnormalities were combined . the resulting regions are presented in tables  <dig> and  <dig>  as mentioned above, these large abnormalities occur much more frequently in the agre dataset. the proportion of autosomes harboring at least one large informative abnormality in the cleft dataset was  <dig> of  <dig> autosomes , while the agre dataset contained  <dig> of  <dig> autosomes . thus the agre dataset is  <dig>  times more likely to harbor large abnormalities than the cleft dataset .

cidr_name sample identifier from the center for inherited disease research; loc the location of the abnormality on the chromosome ; po parental origin =paternal contribution, m=maternal contribution); snps=number of snps in the detected region; inf=number of snps in the detected region which were informative for the detection algorithm; det=detection algorithm; #reg=the number of separate regions reported within a single large abnormality.

abbreviations as described in table  <dig>  note – a large abnormality detected in sample au <dig> was manually annotated as adjacent regions of upd.

a large study on the presence of mosaic abnormalities  in geneva datasets was recently reported by laurie et al.  <cit> . since the cleft dataset consists of parent–child trios, we were able to compare regions detected in the offspring. they reported  <dig> mosaic abnormalities in  <dig> offspring samples within the cleft dataset, the identifiers of which were provided upon request by the authors. these findings are presented in table  <dig> along with the overlapping tripod findings. tripod detected all of the previously reported abnormalities with an average concordance of  <dig> %. tripod also detected a vast number of additional abnormalities, many of which are presumed to be mosaic based on normalized median mbaf values, although tripod does not attempt to distinguish mosaic from non-mosaic abnormalities.

aupd acquired upd; concordance: the proportion of base pairs in agreement between the regions reported by tripod and those reported by laurie et al. additional abbreviations as described in table  <dig>  columns 4- <dig> correspond to the tripod analysis.

discussion
the ability to accurately detect all types of chromosomal abnormalities is vital to advance the understanding of normal and disease processes. sensitive and specific detection is the first step in uncovering the effects of low-level mosaic alterations on human health. in addition to the role of mosaicism in disease, several groups have hypothesized that the prevalence of large mosaic abnormalities in the brain and liver suggests a role in normal physiological function, possibly associated with a favorable increase in genetic diversity and unique neuronal signaling processes  <cit> . recent reports have also highlighted a strong correlation between clonal mosaicism and aging, with interesting similarities to cancer  <cit> . we hope that increasingly sensitive techniques for the detection of low-level mosaicism will fuel a surge in mosaicism research. it is also important, for many types of disease research, to be able to detect the presence of large low-level mosaic cell line artifacts in cultured cells  <cit> .

the implementation of the pod method in tripod greatly increases the ability to detect mosaic abnormalities in snp array data. benchmarking with simulated and real mosaic abnormalities reveals the superior sensitivity of the tripod software. the analysis of large mosaic abnormalities within the agre autism dataset reveals that tripod allows for identification of previously undetected mosaic abnormalities. since the agre samples are derived from transformed cell lines, it is impossible to distinguish large regions of low-level mosaicism originating in the patient from cell line artifacts. however, the ability to detect such regions is crucial since low-level aneuploidy has been proposed as a genetic risk factor for idiopathic autism, as detected using extensive cytogenetic analyses in cultured peripheral blood cells  <cit> . since tripod demonstrates superior performance on simulated cancer data when compared with algorithms designed for cancer sample analysis, including the paired mode of bafsegmentation, we suggest that a pod trio-based approach modified for cancer research may provide more sensitive detection than paired tumor/normal approaches.

differences in abnormality detection are expected across microarray chips due to differences in the number/density of probes, the number of cnv-specific probes, dna preparation and quality, flux in the levels of mosaicism during expansion or passage of individual samples, and the frequent appearance of new mosaic abnormalities in transformed cell lines  <cit> . in spite of these underlying confounders, tripod was shown to be robust when applied to hapmap trios across four different illumina microarray chips. detected abnormalities were highly concordant between chips with similar numbers of cnv-specific probes. while small abnormalities were most likely to overlap one other dataset, large informative abnormalities were most likely to be detected across all chip types. tripod showed good concordance of large abnormalities with 48% matching across all four chips and 78% matching three or more chips, given the confounding effects of mosaic flux and new abnormalities . although tripod was developed for microarray data from the illumina platform, automated adjustments for sample-specific levels of quality and variation allow for application to other platforms from which snp-specific genotypes, allelic ratios, and copy number data can be derived. we also anticipate an adaptation of the pod method for analysis of mosaicism in next-generation sequence data.

a comparison of two large datasets reveals that the presence of cnv-specific probes results in a great increase in detected abnormalities. it was discovered that the agre dataset harbored significantly more large informative abnormalities than the cleft lip/palate dataset. while there may be multiple reasons for this difference, the source of dna offers a likely explanation. large abnormalities may occur with increased frequency or with neutral or advantageous results in cell culture, resulting in frequent mosaic events due to the process of clonal selection. additional datasets from cultured and in vivo sources will be helpful to identify global patterns resulting from the source of dna and those resulting from disease-associated processes. tripod’s findings were highly concordant with all of the previously reported  <cit>  large mosaic abnormalities in the cleft lip/palate dataset. although software was not released to facilitate benchmarking, it is apparent that tripod has greater sensitivity than the laurie et al. approach.

although validation of the newly discovered very low-level mosaic abnormalities by additional experimental approaches would be ideal, the correlation between alterations of the heterozygous baf band and underlying mosaic abnormalities has been rigorously validated by multiple groups  <cit> , as noted by laurie et al.  <cit> . the current validation approaches are largely infeasible for proving false positives for regions < 5% mosaic. we hope that increasingly sensitive detection algorithms will spur the development of new sequence-based validation techniques.

we have several recommendations for tripod usage. tripod may be used concurrently with a cnv-specific algorithm, in order to benefit from both types of specialized detection capabilities. care should be taken when interpreting large abnormalities in commonly variable regions due to a tendency to combine small adjacent abnormalities of the same type. interesting findings should be graphically investigated until the user has gained expertise with the strengths and weaknesses of the various detection and annotation methods employed by tripod. only in very rare instances of consanguineous relationships  in which a significant portion of the parental genomes are identical, would there be a large reduction in the number of informative snps for analysis. to identify such cases we recommend examining the relationship status of trios using a specialized software program such as kcoeff  <cit> .

we believe that many of our algorithmic approaches, including applications of scan statistics, abnormal chromosome detection using k-means clustering and the jump method, cusum applied to boundary refinement following region detection, and error rate estimation, may be novel applications for abnormality detection in snp array data. we expect that such methods can be generalized and of benefit for alternative analyses of genomic data or similar clustering of observed events over time.

CONCLUSIONS
application of the pod method to trio-based snp array data provides a highly sensitive and specific means for detecting chromosomal abnormalities, especially low-level mosaicism. our software implementation, tripod, outperformed comparable programs when benchmarked with simulated mosaic data. examples from the agre autism dataset in which a progeny chromosome harbored a large low-level mosaic abnormality highlighted the superior performance of tripod for sensitive detection of mosaic events. tripod analyses were shown to be robust across multiple types of microarray chips. significant differences in the abundance of large abnormalities between two large datasets were revealed, likely due to the dna source. tripod makes significant advances in reducing the mosaicism detection barrier and increasing the accessibility of mosaicism-directed research.

