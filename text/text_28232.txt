BACKGROUND
the cyprininae family includes zebrafish  and the several economically important cultivated carp, such as common carp , grass carp , silver carp  and bighead carp . teleosts are widely believed to have gone through an additional round of whole genome duplication referred to as the 3r hypothesis, as compared to mammals. this third round  of whole genome duplication is specific to ray-finned fish and possibly occurred about  <dig> million years ago , preceding the divergence of the teleosts  <cit> . the 3r duplication may have led to the major diversification of the teleosts  <cit> . the chromosome number of common carp  is twice that of most other cyprinidae. thus, it has been assumed that common carp have undergone a fourth round  of genome duplication. indeed, previous studies have found more copies of several genes and microsatellites in common carp than in most other cyprinidae and various estimates of the time of the additional round of genome duplication have been made. an analysis of the c-myc genes in common carp estimated that the tetraploidization event occurred  <dig> mya  <cit>  while another study, based on other duplicated genes in common carp, reported a tetraploidization time of less than  <dig> mya  <cit> . using  <dig> microsatellites, david et al.  <cit>  estimated that the 4r genome duplication had occurred about  <dig> mya. however, these conflicting estimates of the time of genome duplication were all based on small data set. thus, to obtain a more accurate estimate of the duplication time, it is necessary to use a larger data set.

for species for which the whole genome sequence is not yet available, transcriptome analysis is an alternative method that has been used to discover new genes and to investigate gene expression. a large set of common carp ests produced using sanger sequencing has been developed and used to study traits in common carp  <cit> . more recently, second generation sequencing platforms have been applied to transcriptome sequencing  <cit> , making the transcriptome more readily accessible. transcriptome analysis is a power tool that has been used to study various genome feature, including genome duplication  <cit> . when the synonymous substitution rate  in two paralogous sequences is assumed to increase approximately linearly with age  <cit> , paralogous pairs can be sorted along with their relative ages of duplication by estimating their ks. a genome duplication event would result in a sharp increase in the number of paralogous genes, yielding a secondary peak in the ks distribution of paralogous pairs. therefore, a secondary peak in the paralogous ks distribution indicates one genome duplication event. large-scale transcriptome data for the common carp will help the study of the additional genome duplication and improve estimates of the timing of this event in this species.

here, we have compared the contigs from common carp with zebrafish genes: 1) to assess the relative age of the separation between zebrafish and common carp; 2) to estimate the time of the additional genome duplication event in common carp; and 3) to determine biological processes and pathways enriched in common carp.

RESULTS
hybrid assembly of the common carp  <dig> contigs and public ests/mrnas
the  <dig> pyrosequencing generated  <dig>  reads, encompassing about  <dig>  mb of sequencing data. the average length of the  <dig> reads was  <dig> bp. after the initial adapter trimming and quality filtering, we assembled the remaining  <dig>  cleaned reads using celera assembler  <cit>  and obtained  <dig>  contigs and  <dig>  singletons. we downloaded  <dig>  common carp ests and  <dig> mrnas from ncbi sequence database. after filtering out possible vector sequences,  <dig>  cleaned ests and  <dig> cleaned mrnas were assembled with  <dig> contigs/singletons into  <dig>  contigs using cap <dig>  <cit> . further, to avoid redundant gene identification and annotation caused by alternative splicing, we performed an all-against-all blastn search on the cap <dig> contigs. if the alignments of two sequences had 100% identity over  <dig> bp, they were considered to be from the same genes as the result of alternative splicing. we selected the longest contigs to represent these genes and finally obtained  <dig>  unique contigs. the n <dig> length of this set of contigs was  <dig> bp.

assessment of hybrid assembly
to assess the quality of our assembly, the cap <dig> contigs were compared with  <dig> published paralogous mrnas . the  <dig> mrnas were aligned with the cap <dig> contigs using blat and the cap <dig> contig that aligned best with each of the mrnas was selected. although the highest identity between these paralogous genes was 97%, all the mrnas matched distinct cap <dig> contigs with the full length sequences covered. this result indicated that our assembly was of high quality.

without a genome sequence, it is difficult to determine splicing variants in a de novo transcriptome assembly  <cit> . spliced variants in the dataset can lead to redundant gene prediction and artificial paralogs. because splicing variants were from the same genes and share common exons, we filtered out possible alternative splicing variants using high sequence identity  over long matched region . we evaluated the reliability of this strategy using zebrafish transcripts from the ensembl database  <cit>  as a test dataset. in the ensembl database,  <dig>  zebrafish genes have  <dig>  spliced variants and form  <dig>  splicing pairs. we identified  <dig>  pairs of spliced variants using our strategy;  <dig>  of them were in the ensembl splicing pairs. this result suggested that our strategy had the sensitivity of nearly 80% with a low error rate of only 11% .

gene prediction from common carp contigs
we used homolog searches and an ab initio prediction method to annotate the common carp contigs. by searching against three different protein databases using blastx with a cutoff e-value of 1e- <dig>  we found  <dig>  contigs that had blastx hits to at least one of these databases. most contigs were homologous to sequences from the fish protein database . as shown in figure  <dig>  the common carp contigs had the greatest number of hits against zebrafish sequences. after running the unmatched contigs against utrdb  <cit> , a database of 5' and 3' untranslated regions  of eukaryotic mrnas, we found another  <dig>  contigs that were homologous to utrs, indicating that these contigs might represent the utrs of common carp protein-coding genes. an additional  <dig>  contigs could be aligned to the ncbi nonredundant nucleotide database using blastn. since these contigs had hits to known proteins or nucleotide sequences, they might be conserved genes.

* fish protein database consists of protein sequences from zebrafish, fugu, stickleback, tetraodon and medaka.

finally, among the remaining unidentified contigs, an ab initio method using the cpc predicted that  <dig> of the contigs were potentially coding sequences. because these contigs had no matches to known proteins, they might be common carp specific protein-coding genes. the remaining unknown  <dig>  contigs had neither protein-coding potential nor known homologs, indicating that they were probably transcribed from common carp intergenic regions of the common carp genome. the complete annotation statistics are shown in table  <dig> 

to validate the reliability of the de novo assembly and the assembled contigs, gene expression was examined in rnas from the pooled-tissues by pcr. twenty contigs, including conserved genes, common carp specific protein-coding genes and unknown contigs , were selected randomly. primers were designed specifically for the selected contigs to avoid amplifying paralogs. the results showed that all the selected contigs could be amplified , indicating that these contigs were correctly assembled and truly expressed.

genome speciation event deduced from orthologous pairs between common carp and zebrafish
we assumed that one round of genome duplication occurred in common carp after the speciation while zebrafish had no further genome duplication. a secondary peak in the orthologous ks value distribution indicates a speciation events  <cit> . therefore, we firstly estimated the genome speciation time based on the ks distribution of orthologous pairs between the two species. we identified  <dig>  orthologous pairs between common carp and zebrafish using the reciprocal best blast hit approach with a stringent e-value cutoff  as described previously  <cit> . the ks distribution of these  <dig>  orthologous pairs showed a distinct secondary ks peak at  <dig>  . considering a clock-like rate of synonymous substitution of  <dig>  × 10- <dig> substitutions/synonymous site per year  <cit> , the speciation between common carp and zebrafish was estimated to have occurred ~ <dig> mya. this estimated speciation time is earlier than the time predicted from previous reports based on individual genes  <cit> .

genome duplication event estimated from ks distribution of paralogous pairs
a secondary peak in the paralogous ks distribution plot can provide signatures of genome duplication within a species  <cit> . to evaluate the quality of the paralogs identification by our strategy, we performed an all-against-all blastn using the same  <dig> paralogous pairs. a total of  <dig> pairs  satisfied the criteria for paralogous identification , indicating that the customized parameter was suitable for paralogs identification. we identified  <dig>  and  <dig>  paralogous pairs within common carp and zebrafish, respectively. these paralogous pairs were then organized into  <dig>  and  <dig> gene families in carp and zebrafish respectively, by a single linkage clustering method. the numbers of sequences in the paralogous pairs and gene families are shown in table  <dig> and the ks distribution plots for the two species are shown in figure  <dig>  we observed an obvious secondary peak in the ks distribution of paralogous sequences within common carp , indicating a genome duplication event. with the rate of  <dig>  × 10- <dig> substitutions/synonymous site per year  <cit> , this duplication was estimated to have occurred  <dig>  to  <dig>  mya. this estimate is more recent than previous ones  <cit> . together with the estimated speciation time, these data suggested that this duplication event occurred long after the speciation. within zebrafish, no secondary peak in the ks distribution of paralogous sequences was observed, indicating that after speciation no genome duplication event had occurred. together, these data supported the hypothesis that common carp had undergone one extra round of genome duplication compared with zebrafish.

a number of the longest sequences.

b number of paralogous sequences found in the final dataset using blastn search.

c percentage of paralogous sequences found in the final dataset.

d number of gene families constructed with paralogous sequences using single linkage clustering.

e number of duplication events used in the distributions in figure  <dig> and of which median ks rates are <  <dig> 

comparison of biological process and pathway enriched in common carp and zebrafish
we determined that a whole genome duplication event occurred  <dig>  to  <dig>  mya in the common carp. since then, re-diploidization would have resulted in a pseudo-tetraploid state and differential evolution or loss of duplicated genes. a biological process and pathway comparison between common carp and zebrafish may provide hints of the possible consequences of whole genome duplication and following re-diploidization.

we assigned gene ontology  terms to  <dig> % of the common carp contigs  using homologous assignments and interproscan  <cit> . this percentage is similar to go assignments in other fish  <cit> . we then used wego to find significantly enriched go terms in common carp  using zebrafish genes as the background. in the biological process category, a total of  <dig> go terms  were significantly overrepresented  while  <dig> terms were either underrepresented or similar in the common carp relative to the zebrafish go annotations .

to study the biological pathways involved, we mapped common carp contigs to pathways in the kyoto encyclopedia of genes and genomes  using kobas software and a total of  <dig>  contigs were mapped to kegg pathway. zebrafish genes were also mapped to kegg pathway and used as background to compare pathway differences between common carp and zebrafish. the statistically enriched pathways  were consistent with the enriched go biological process terms. for example, immune-related process, localization and response to stimulus were all indicated in both enriched go processes and kegg pathways. these data, therefore, provide an insight into the process and pathway enriched in common carp.

* the enriched pathways correspond to biological process go terms of level  <dig> in go vocabulary. these biological processes were still enriched in common carp, indicating the consistence between go term comparison and kegg pathway analysis.

discussion
here, we performed transcriptome analysis to estimate the time of the fourth round  of genome duplication in common carp. earlier, several genes and microsatellites had been used to estimate this. in the present study, we generated an order-of-magnitude more contigs than previously, making the estimated time of the 4r duplication event more reliable.

timothy et al.  <cit>  reported that the pooled-tissue approach was highly effective in preparing libraries for efficient deep sequencing. rna that has been pooled from multiple tissues can maximize the number of independent genes for which sequence data can be obtained  <cit> . thus, we constructed a pooled-tissue cdna library and sequenced the library. although the number of sequencing reads that we obtained were lower than in other studies  <cit> , the hybrid assembly built by including public est/mrnas improved the sequence coverage and allowed more common carp genes to be identified. the size of common carp genome has been estimated to be  <dig> - <dig>  gb  <cit> . assuming that 1% of the genome encodes mrnas  <cit> , the  <dig>  contigs, accounting for  <dig> mb, that we obtained provide an estimated coverage of the common carp transcriptome of at least 85%. this estimate is an indication that, in our study, the common carp transcriptome has been sampled broadly with good coverage. previous studies have suggested that singletons may be biologically valuable  <cit> . therefore, we included the singletons in all further analyses. the high coverage of the transcriptome helped in genome duplication detection and function comparison.

although de novo transcriptome assembly can make the genes of non-model organisms with no available genome sequences more readily accessible, a number of challenges including gene duplication or paralogy and alternative splicing still exist. we used stringent parameters for the de novo assembly to help differentiate paralogous genes. we then assessed the correctness of the assembly by comparing it with published paralogous genes. these published genes all corresponded to distinct contigs, indicating that the parameters were robust enough to have avoided the creation of chimeric sequences from paralogous transcripts. spliced variants present in de novo assembly dataset are another challenge because their presence can result in redundant gene predictions and paralogs identification. although spliced variants are difficult to identify without the genome sequences, the strategy that we applied here would have filtered out a high proportion of the alternative variant with a low error rate .

to estimate the time of the 4r genome duplication event in the common carp, we estimated the ks values for all orthologous and paralogous pairs. the clear signature of a duplication event within common carp that we obtained showed that the duplication was fairly recent. this is possibly one of the most recent genome duplications in vertebrates. as expected, we did not observe a paralogous peak in zebrafish. these data provided evidence for an additional round of genome duplication in common carp. however, with age increasing, an exponential decrease of density in the distribution of paralogous pairs as a result of the deletion of duplicated sequences would have occurred  <cit> . because of this effect, common genome duplication events in common carp and zebrafish could not be found.

zebrafish is the most closely related species to common carp; both belong to the cyprinidae family. the common carp contigs that were generated in this study allowed us to conduct an initial comparative genome analysis between zebrafish and common carp. because, one more round of genome duplication followed by re-diploidization occurred in the common carp, the comparison of go biological process terms and kegg pathways between common carp and zebrafish provided hints of the possible consequences of whole genome duplication and re-diploidization. interestingly, compared to the zebrafish genes, the common carp contigs were enriched in immune-related terms and pathways, such as, complement and coagulation cascades, and antigen processing and presentation. we examined the functions of the published paralogous genes  and found that 45% of them  were involved in immune-related pathways. the enriched immune-related contigs might be genes that assist carp in resisting pathogens or might be of help in adapting to different aquaculture growing environment.

CONCLUSIONS
the hybrid assembly of the  <dig> contigs and published ests/mrnas in this study had significantly expanded the common carp est resource and provided a valuable dataset for future gene discovery. our comparative analysis between the common carp contigs and zebrafish genes estimated the time of the 4r of genome duplication event in common carp to be  <dig>  to  <dig>  mya and revealed the enriched biological processes and pathways in common carp.

