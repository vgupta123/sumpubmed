BACKGROUND
molecular profiling technologies have enabled the collection of large, exploratory data sets consisting of measurements for tens of thousands of molecular entities. these rich data sets hold promise for understanding the molecular bases of disease, drug action, and drug toxicity, but do not often lead to a reasonable short list of potential molecular mechanisms that can be investigated further by targeted experiments. for example, gene expression profiling experiments frequently result in a list of hundreds or thousands of gene expression differences that characterize a comparison of biological states like diseased versus normal tissue or treatment versus control. the development of methods to interpret these lists of differential measurements and extract testable hypotheses is necessary to realize the full potential of these large data sets.

the use of prior knowledge in the form of functional groupings of genes into gene sets is central to many methods for interpreting molecular profiling data. generally, a collection of gene sets is assessed to identify those for which differentially expressed genes from the data set are over-represented . genes can be grouped into sets based on a variety of criteria including:  functional annotation,  pathway maps,  regulatory or structural motifs, and  common response to an experimental perturbation.

analyses using gene sets based on pathway maps  or functional annotation  rely on the assumption that differential rna expression is equivalent to differential protein activity. this assumption can be problematic because rna abundances are not generally a good measure for the abundance or activity of the corresponding proteins. the correlation of rna expression to protein expression is variable, with changes in rna levels accounting for only a modest portion of changes in levels of the corresponding proteins  <cit> . as a group, signal transduction proteins are more poorly correlated with their corresponding rnas than are structural proteins, thus extrapolation of rna microarray data to infer changes in signal transduction requires caution  <cit> . protein abundance is regulated via translation and proteolysis in addition to regulation via transcription and stability of mrna. moreover, protein expression levels are frequently not the key determinant of protein activity; many pathways are regulated by post-translational events such as protein modification or binding, and only secondarily by protein abundance.

experimental result-based gene sets, for example the l2l, genesigdb, and msigdb chemical and genetic perturbations  gene sets  <cit> , do not evaluate differentially expressed rnas based on the function of the proteins they encode, but rather by a common mechanism controlling their expression . this type of gene set has the additional advantage that the function of the corresponding gene products need not be well defined to be considered. one limitation of experimental result-based gene sets is that the sets of genes up-regulated and down-regulated within an experiment are often either handled as distinct “up” and “down” sets or combined without regards to direction. additionally, gene sets from experiments with similar chemical or genetic perturbations are not generally integrated into a single cohesive gene set.

in this paper, we present a detailed description of reverse causal reasoning , a reverse engineering algorithm to identify biological mechanisms that are statistically significant explanations for differential measurements in a molecular profiling data set. this approach uses prior knowledge in the form of a large network of biological cause and effect relationships, from which smaller networks representative of discrete biological mechanisms are derived. these smaller networks are essentially structured gene sets, where the upstream node represents an experimental perturbation like a chemical, protein, or protein activity, the downstream nodes represent entities such as rnas that have been measured in the data set, and the edges specify an “increased”, “decreased”, or “ambiguous” relationship. these mechanism networks are evaluated for both overrepresentation and consistency with respect to differential measurements from a data set.

this general approach has been in use by selventa since  <dig> to identify and evaluate molecular mechanisms involved in diverse biological processes, but not formally described or tested using a publically available knowledge base  <cit> . a related approach has been recently reported  <cit> . in addition, an approach using the same network structure to represent mechanisms has been developed to quantify and allow comparison of the level of activity of a mechanism between related data sets  <cit> .

we provide an implementation of rcr, whistle , specifically designed for analysing gene expression profiling data, and apply whistle to three example gene expression profiling data sets. whistle uses prior knowledge in the form of biological expression language  statements compiled into a causal graph. bel is a language for representing causal and correlative biological relationships from the scientific literature in a computable form. the bel framework, which provides tools for compiling and managing bel statements, has recently been made available to the general public as open source along with a starter corpus of statements, used in this paper to analyse the example data sets .

methods
overview of rcr and whistle
rcr interprets molecular profiling data sets by inferring a set of molecular mechanisms with associated direction  that can serve as potential causes for the observed profiling differences between two sample groups . this algorithm requires a large knowledge base consisting of prior biological knowledge in the form of cause-and-effect relationships, where the entities measured by the molecular profiling experiment are included as targets of the cause-and-effect relationships.

whistle is an implementation of rcr that uses a bel knowledge assembly model  as the knowledge base to analyse a gene expression profiling data set comparing two sample groups. whistle uses the following general strategy :

 <dig>  a kam is assembled from biological findings

 <dig>  small networks representative of a mechanism  are derived from the kam; each kam node immediately upstream of a minimum number of measured rna abundance nodes represents a hyp.

 <dig>  differential mrna abundance measurements are mapped to mechanism networks and a direction  is assigned for each network.

 <dig>  evaluation statistics  are calculated for each mechanism network.

term definitions related to whistle input and output are provided in table  <dig> 

whistle evaluates prior knowledge as hyps
the prior knowledge structures used by whistle are termed ‘hyps’ . a hyp is a small, directed acyclic network containing an upstream node and downstream nodes that map to measured entities . a hyp can be compared to a qualitative bayesian network or qualitative probabilistic network  <cit> . each edge in a hyp represents a qualitative influence of increases , decreases , or ambiguous . unlike qualitative probabilistic networks, zero influences  are not included within hyps. like a naïve bayes classifier, all downstream nodes in a hyp are assumed independent from each other, given a fixed value of the upstream node; the downstream nodes are assumed to be uncorrelated with each other.

in the case of whistle, hyps are essentially gene sets structured as directed networks, such that both the enrichment of differentially expressed genes and consistency of the directions  can be evaluated. each whistle hyp is derived from a kam. an increases edge connecting two nodes within a hyp means that the nodes are connected by an increases or directlyincreases bel relationship in the kam. similarly, a decreases hyp edge is derived from a decreases or directlydecreases kam relationship. an ambiguous hyp edge means that the kam contains multiple, conflicting edges connecting an upstream and downstream node, e.g., both an increases and decreases edge. other classes of hyps, e.g., those using other edge types, paths consisting of multiple edges, and/or other types of measured downstream nodes, can be derived from kams and evaluated by rcr, but they are not described here or evaluated by whistle.

mapping probe sets to the kam
first, whistle maps the set of measured rnas for a data set to the kam. this mapping is used to generate hyps for evaluation, determine the downstream nodes for each hyp , and determine the set of downstream nodes for all hyps evaluated .

probe set names or other identifiers  are mapped to rna abundance nodes in the kam using the equivalence files provided by the bel framework . next, each kam node with at least four causally downstream measured rna abundance nodes is selected as the upstream node for a hyp, resulting in a set of hyps from the kam for evaluation against the data set.

mapping differential measurements to hyp networks
next, the data set of differential measurements is mapped to the hyp networks and basic metrics including direction, correct, and contra are calculated . differential gene expression data is processed such that each measurement is expressed as one of three discrete states: significant increase, significant decrease, or no significant change, based on user-defined significance criteria. these criteria generally include thresholds for fold change, adjusted p-value, and average abundance .

a direction of increased, decreased, or none is assigned to each hyp, representing the inferred state of the upstream node of the network based on the states of the downstream nodes mapped from the data set. the direction is the state consistent with the majority of the significantly increased and decreased downstream nodes of the hyp network. for each significantly increased or decreased hyp downstream node, the causal linkage to the upstream node determines if the observed state is consistent with an increased, decreased, or neither  state of the upstream node. for example, if upstream node a is connected to rna abundance node b by a causal decrease, a significant increase in b would be consistent with a decrease in a. if upstream node a is connected to b by an ambiguous edge, an increase in b would be considered an ambiguity.

evaluation statistics 
two evaluation statistics, concordance and richness, are calculated for each hyp. these statistics allow the hyps to be prioritized based on the strength and consistency of their support in the data set. lower concordance and richness p-values reduce the number of false positive, but increase the number of false negative hyp inferences. as is common for other prior knowledge-driven approaches  <cit> , both the concordance and richness statistics are biased in favour of hyp networks with a larger number of downstream nodes. for most statistic-based metrics, values associated with a larger number of measurements can achieve higher levels of significance than those associated with a small number of measurements . thus, we use these metrics primarily as a filter to identify potential explanations for the gene expression data, and not as a strict ranking for the most interesting explanations. a threshold of p <  <dig>  for both concordance and richness generally limits both false negatives and false positives to an acceptable level, and provides a manageable set of hyps for manual evaluation .

concordance
the concordance statistic is calculated as a p-value that characterizes the consistency of the observed states of the downstream nodes with the direction assigned to the hyp upstream node. concordance is calculated as a binomial distribution where the directions expected for the downstream rna abundance nodes, based on the assigned direction of the hyp upstream node and the causal relationships to the downstream nodes are tested. downstream nodes with the assigned state no significant change and nodes connected to the upstream node by an ambiguous relationship are excluded. for the set of significantly increased or decreased nodes comprising the correct and contra for a hyp, the concordance statistic is the probability of getting at least the number of state changes consistent with the direction .

the binomial distribution can be written as f where:

k is the number of successful predictions ,

n is the number of trials , and

p is the probability of achieving a result, 0 ≤ p ≤  <dig> 

the point probability of getting exactly k successful predictions is calculated as:

 prob=fk;n,p=nkpk1−pn−k 

for the purposes of evaluating a hyp, the probability of getting the direction of prediction correct, p, is  <dig> ; the network can either predict the observed direction for a state change correctly or incorrectly. for some hyp xi, the number of trials, ni, corresponds to the number of downstream nodes for the mechanism that are mapped to state changes . the number of successful predictions ki is the number of downstream nodes of xi, mapped to state changes that are consistent with the hyp direction . let li be the number of downstream nodes for which the predicted direction cannot be determined .

the point probability for some hyp, xi, for some ki is then calculated as:

 probik=ni−likipki1−pni−ki−li 

the concordance p-value is a cumulative probability based on the area under the curve of a probability distribution function. thus, concordance for some hyp, xi, is the sum of probij for all j = ki, ki +  <dig>  …, min. the concordance for xi is then given as:

 conci=∑j=kiminni− <dig> mni−lijpj1−pni−j−li 

richness
the richness statistic for a hyp indicates the enrichment of nodes that have an observed significantly increased or decreased state in the downstream nodes of the network  compared to the number of significantly increased or decreased rnas  in the total population of measured rnas mapped to hyps. richness is calculated as a p-value using a hypergeometric probability distribution, a method commonly used to characterize the degree to which a subset of a whole is particularly notable.

the hypergeometric distribution can be written as f where:

k is the number of notable items in the subset ,

n is the number of items in the full set ,

m is the number of notable items in the full set , and

n is the size of the subset .

the probability that the subset is not due to chance can be calculated as:

 prob=fk;n,m,n=mkn−mn−knn 

for the richness calculation, the size of the full set, n, corresponds to the number of observations in the experiment that can be identified and mapped to at least one downstream node in the set of all possible hyps ; m is the cardinality of the set of state changes. these values are constant for all mechanisms xi, i =  <dig> ,…,n. for any mechanism, xi, ni is the number of downstream nodes that are mapped to measurements in the experiment , and the number of notable items, ki, corresponds to the number of downstream nodes also found in the set of m state changes .

the point probability for some hyp, xi, for some ki is then calculated as:

 probik=mkin−mni−kinni 

the richness p-value is a cumulative probability based on the area under the curve of a probability distribution function. thus, richness for a hyp, xi, is the sum of probij for all j ≥ ki. additionally, j is bounded by the size of the subset ni and number of notable events m. the complete richness calculation is then given as:

 richi=∑j=kiminnimmjn−mni−jnni 

which determines the cumulative probability over the range j = ki, ki +  <dig>  …, min.

data analysis for examples
three gene expression data sets were used as examples to evaluate whistle output:  a mouse high fat diet insulin resistance model  <cit> ;  human microvascular endothelial cells treated with tnf  <cit> ; and  human breast epithelial cells treated with a pi <dig> kinase inhibitor  <cit> . microarray data sets used as input for the tnf  and pik3ca  examples were downloaded from gene expression omnibus  . the high fat diet  data set was downloaded from arrayexpress . gse <dig> used the affymetrix human genome u133a, gse <dig> uses affymetrix human genome u <dig> plus  <dig> , and e-mexp- <dig> used the affymetrix mouse genome  <dig>  <dig>  array. raw rna expression data for each data set was analysed using the “affy”  and “limma”  packages of the bioconductor suite of microarray analysis tools available for the r statistical environment  <cit> . robust microarray analysis  background correction and quantile normalization were used to generate microarray expression values. an overall linear model was fit to the data for all sample groups, and specific contrasts of interest were evaluated to generate raw p-values for each probe set on the expression array  <cit> .

unless otherwise specified, state changes for probe sets were generated using the following significance criteria:  adjusted p-values of less than or equal to  <dig> , corrected for multiple testing effects using benjamini-hochberg fdr,  absolute fold changes of at least  <dig> , and  an average normalized affymetrix abundance of at least  <dig>  other thresholds were used to determine differential probe sets as specified. genes represented by multiple probe sets were considered to have changed if at least one probe set met criteria for differential expression. gene expression changes that met these criteria are considered to be significantly differentially expressed and have the directional qualities of increased or decreased, i.e., they were upregulated or downregulated, respectively, in response to the experimental perturbation.

knowledge base
the “bel large corpus”, version  <dig> , , was used as the prior knowledge source for the examples. the large corpus contains approximately  <dig>  causal statements manually curated from the published biomedical literature, each statement representing an observation from experiments performed in human, mouse, or rat. each statement is associated with a citation and key experimental context information . the large corpus was compiled into a knowledge assembly model  using the bel framework, version  <dig> . <dig>  with the default compiler settings. for the examples, kam nodes representing orthologous nodes were collapsed to either mouse or human as appropriate, using the bel framework api.

because a bel kam is used as the prior knowledge source, each hyp is referred to by the bel term label of its upstream node. bel terms follow the general format f, where f is a function like ‘proteinabundance’  or ‘biologicalprocess’ ; ns is a reference to a namespace like ‘mgi’  or ‘egid’ ; and v is a value from the indicated namespace, like ‘akt1’. a list of bel functions and namespace abbreviations used in the examples is provided in additional file  <dig>  full bel language documentation can be found in the openbel portal .

RESULTS
example data sets
to highlight the utility of rcr for generating testable mechanistic hypotheses from gene expression profiling data, we provide examples of the application of whistle v <dig>  to three published gene expression data sets using a network compiled from the bel large corpus as the prior knowledge source. each data set was analysed to identify significantly differentially expressed probe sets  and the resulting data analysed using whistle and the large corpus kam . these examples demonstrate the use of whistle to identify potential molecular upstream controllers of observed differential gene expression from experimental data sets.

probe sets were considered significantly differential if average abundance > =  <dig>  fold change > =  <dig> , and adjusted p-value < =  <dig> . the population size is defined as the number of unique measured rna abundances mapped to hyps. the number of state changes is defined as the number of differential rnas in the population. mechanisms were evaluated as hyps if at least four measured rnas are downstream nodes. hyps were considered significant if both richness p < =  <dig>  and concordance p < =  <dig> .

example  <dig> – high fat diet diabetes model
we applied whistle to data set e-mexp- <dig>  the liver gene expression profile from mice fed a high fat diet, a model for impaired glucose tolerance and type  <dig> diabetes  <cit> . for this data set, c57bl/6 j male mice were fed either a high fat diet or standard chow for 15 weeks, and rna was extracted from the liver for profiling  <cit> .

mapping of measurements from the affymetrix mg- <dig>  <dig>  microarray supported the generation of  <dig> hyps for evaluation from the mouse large corpus kam , with a population of  <dig> unique downstream rna abundance nodes. the  <dig> probe sets meeting criteria for significant differential expression between high fat diet and normal diet mouse livers map to  <dig> unique rna abundance nodes in the population .

of the  <dig> hyps evaluated from the mouse large corpus kam,  <dig> met the standard richness and concordance p-value significance thresholds of  <dig>   . for example, the hyp bp is inferred to be significantly increased for the high fat data set . this mechanism, representing the biological process defined by the go term ‘response to endoplasmic reticulum stress’, is causally upstream from  <dig> measured rna abundances in the mouse-orthologized large corpus kam . of the  <dig> significantly increased or decreased rna abundance nodes resulting from high fat diet, seven map to the bp hyp, representing a significant enrichment in endoplasmic reticulum stress-regulated rna abundance nodes . of these seven, six are in a direction consistent with increased response to endoplasmic reticulum stress, and one is consistent with decreased response. thus, the direction increased is assigned to the bp hyp. the concordance p-value, which evaluates the directions of the observed states of the downstream nodes against the predictions made by the hyp, is  <dig> e- <dig>  supporting the inference of increased bp.

thirteen hyps meet both richness and concordance thresholds of p < =  <dig>  for data set e-mexp- <dig>  five mechanisms meet more stringent p <  <dig>  thresholds .

several of the significant mechanisms inferred by whistle are consistent with the dietary changes and insulin resistance associated with this mouse model. increased food intake ) and decreased response to starvation ) are consistent with the dietary differences characterizing the high-fat diet group and the control group. circulating insulin levels are reported to be increased in the high fat diet fed mouse model  <cit> , and several hyps representing increased insulin , a, and a) are inferred by whistle. increased response to endoplasmic reticulum stress  is consistent with reports of er stress induction in mouse obesity models  <cit> . the decreased transcriptional activity of foxa <dig> protein )) is consistent with the reported inactivation of foxa <dig> in insulin-resistant mouse models  <cit> .

several of the highly relevant hyps inferred by whistle for the e-mexp- <dig> data set represent the abundance or activity of proteins for which the corresponding rnas are not differentially expressed. these mechanisms would not be identified by standard overrepresentation analyses based on the functions of the proteins encoded by the differentially expressed genes. for example, insulin , a, and a) is inferred increased, but probe sets for the mouse insulin genes ins <dig> and ins <dig>  and the insulin receptor gene insr do not meet criteria for differential expression. insulin is produced by the pancreas, and is not expected to be regulated by gene expression in the liver. similarly, the hyp representing the transcriptional activity of foxa <dig>  tscript), is inferred decreased, but the foxa <dig> rna  is not differentially expressed. foxa <dig> is an insulin-regulated liver transcription factor whose activation leads to oxidation of fatty acids and secretion of triacyglycerols, and whose impairment has been implicated in diabetes  <cit> . foxa <dig> regulation by insulin occurs via phosphorylation  <cit> , consistent with the lack of observed regulation of foxa <dig> rna.

example  <dig> – tnf treatment of human microvascular endothelial cells
we applied whistle to a gene expression profile of the response of human microvascular endothelial cells to tnf. this data set  was generated by stimulating hmec- <dig> cells with 2 ng/ml tnf for 5 hours  <cit> ). in endothelial cells, tnf, a potent mediator of inflammatory signalling, acts through its cognate receptors to initiate downstream signalling, including activation of the transcription factor nf-κb, resulting in increased transcription of cell surface receptors involved in leukocyte adhesion  <cit> .

mapping of measurements from the affymetrix u133a microarray supported the generation of  <dig> hyps from the human large corpus kam , with a population of to  <dig> unique downstream rna abundance nodes. the  <dig> probe sets meeting criteria for significant differential expression between tnf stimulated and untreated cells map to  <dig> unique rna abundance nodes in the population.

of the  <dig> hyps evaluated from the human large corpus kam,  <dig> met the standard richness and concordance p-value significance thresholds of  <dig> . the top  <dig> significant mechanisms as ranked by the concordance statistic are shown in table  <dig>  these significant mechanisms include several molecules and processes canonically associated with tnf signalling. transcriptional activity of nf-κb complex )) is inferred increased, consistent with the complex’s role as a key mediator of tnf-induced transcription  <cit> . tnf reduces endothelial cell lifespan  <cit> , consistent with the inferred increase of replicative cell aging ). tnf activates p <dig> mapk in endothelial cells  <cit> , and increased kinase activity of p <dig> mapk )) is inferred by whistle. interestingly, while the inferred increases of lipopolysaccharide ) bacterial infection ) seem biologically implausible to occur during the 5 hour tnf treatment used to generate the data set, these mechanisms are aligned with reports that lps and tnf activate very similar transcriptional responses in endothelial cells  <cit> . a hyp representing tnf itself was not evaluated, as tnf is not connected to sufficient downstream rna abundance nodes in the large corpus kam.

fifty-eight hyps met richness and concordance thresholds of p < =  <dig>  for data set gse2638; the top twenty significant hyps, as ranked by concordance are shown.

example  <dig> – pi3k inhibitor treatment of human breast epithelial cells
we applied whistle to data set gse <dig>  the gene expression profile of human breast epithelial cells treated with a pi3k inhibitor. for this data set, a clone of cell line mcf10a with a knock-in of the activating pik3ca mutation h1047r was treated with either the pi3k inhibitor gdc- <dig> or the vehicle dmso for 4 hours  <cit> . the phosphatidylinositol 3-kinase  signalling pathway is a key mediator of cell survival and proliferation  <cit> .

mapping of measurements from the affymetrix u <dig> plus  <dig>  microarray supported the generation of  <dig> hyps from the human large corpus kam , with a population of  <dig> unique downstream rna abundance nodes. the  <dig> probe sets meeting criteria for significant differential expression between pi3k inhibitor-treated and dmso-treated cells map to  <dig> unique rna abundance nodes in the population.

of the  <dig> mechanisms evaluated from the human large corpus kam,  <dig> met the standard richness and concordance p-value significance thresholds of  <dig> , including decreased pi3k complex activity )) and several mechanisms canonically associated with inhibition of pi3k signalling, e.g., increased activity of foxo transcription factors foxo <dig>  foxo <dig>  and foxo <dig> ), tscript), tscript)); decreased akt kinase activity )), and decreased insulin signalling )  <cit> . the top  <dig> significant mechanisms as ranked by the concordance statistic are shown in table  <dig> 

forty-five hyps met both richness and concordance p < =  <dig>  thresholds for data set gse <dig>  the top twenty hyps, as ranked by concordance are shown.

randomized data sets
random data are not expected to produce a biological signal. to further investigate the significance of the mechanisms inferred by whistle, we generated a set of  <dig>  matched random data sets for each example data set and compared the whistle results to those for the matched real data. these random data sets were generated such that the population was the same as the matched example data set and that the total number of significantly increased and decreased rnas in the randomized data matched that of the real data set.

we used the random data whistle results to guide the selection of a generally applicable threshold for richness and concordance p-values to use to identify significant hyps, minimizing false positive and false negative significant hyps. whistle results for the randomized data sets supported the selection of  <dig>  as a standard threshold for richness and concordance p-values. applying thresholds of p < =  <dig>  for both richness and concordance to all three example data sets and their matched random data yields a median number of significant hyps inferred for the  <dig>  random data sets equal to 5-10% of the number of hyps inferred for the corresponding real data at the same threshold . thus, we expect this threshold to yield less than 10% false positive inferred hyps for most data sets. while selection of a more stringent p-value threshold such as  <dig>  reduced the number of hyps meeting significance criteria in the random data sets, it resulted in false negatives, i.e., the loss of several biologically relevant mechanisms. specifically, lowering the p-value threshold from  <dig>  to  <dig>  for the high fat diet data set resulted in the loss of eight of the thirteen hyps including increased bp, decreased bp, and decreased tscript). as the mechanisms represented by these hyps are highly biologically relevant for the high fat data set , we chose to apply the relatively permissive p < =  <dig>  richness and concordance evaluation statistic threshold.

for each example data set ,  <dig> matched random data sets were generated. the number of hyps meeting significance criteria at each p-value threshold is indicated, for random data the median number of significant mechanisms is shown.

bold indicates the  <dig>  p-value threshold applied to analysis of the three example data sets.

bias in evaluation statistics by hyp size
we further evaluated the richness and concordance statistics by examining bias of both metrics to the number of downstream rnas  in the hyp within the randomized data sets. because these data sets do not contain true biological signal, the correlation of either metric with the hyp size can be used to examine the expected bias.

richness
minimal correlation between richness and hyp size  was observed in the randomized data . this weak degree of correlation suggests that the hyp size has minimal influence on richness.

concordance
a higher level of correlation between concordance and hyp size was observed in the randomized data .

to correct this bias, we fit a loess curve to the log concordances from a subset of the randomized data matching the example data sets  and computed an adjusted concordance measure by subtracting the fit from the log raw concordance. this correction reduced the overall correlation of concordance to the hyp size  in each of the three example data sets . the spearman correlation of the top  <dig> hyps by concordance versus adjusted concordance was  <dig> ,  <dig> , and  <dig>  for the high fat diet , tnf , and pi3k inhibitor  data sets, respectively. the corrected concordance values had minimal effect on the ranking of the top hyps by concordance in the three example data sets.

moreover, limiting the hyps to those which are associated with a minimum number of differentially expressed rnas removes much of the concordance bias in the randomized data. concordance evaluates the consistency of the direction of the significant rna expression changes with the hyp sub-network and thus is most relevant when applied to hyps which have several significantly changing rnas. the richness statistic is used to evaluate if the number of differentially expressed rnas for a given mechanism is significant. in practice, concordance is critically evaluated only for those mechanisms for which at least four downstream rnas are differentially expressed , as this number is the minimum required for concordance to meet the  <dig>  threshold. in the randomized data sets, only about 20% of total scored hyps have at least four observed. limiting to these scores reduces the correlation coefficient between concordance and possible in the randomized data from − <dig>  to − <dig>  . while the concordance bias is significant, it has limited impact on the use of concordance to filter the hyps to a list of interesting mechanisms for a data set or to use concordance to rank the most interesting hyps. given the limited influence of the concordance bias within the range of interest, we have not implemented correction of concordance in whistle.

discussion
rcr is a reverse engineering algorithm that reasons from observed effects to potential causes, transforming lists of differentially expressed genes into mechanistic hypotheses. the use of a knowledge base structured as a directed, causal network provides rcr with some key advantages over other analysis techniques relying on prior knowledge:  rcr does not rely on the assumption that changes in rna expression are equivalent to changes in the activity of the corresponding protein,  the structuring of gene sets as networks  allows evaluation of genes up- and down-regulated by the same mechanism as a cohesive, causally consistent mechanism, and  flexibility to generate hyp networks for evaluation from the knowledge base network, potentially combining related upstream nodes to a single hyp or dividing hyps based on knowledge context.

the integration of qualitative causal relationships in reverse causal reasoning fundamentally distinguishes it from other techniques in which gene expression profiling data is interpreted via over-representation analysis of functionally related sets of genes. the hyp networks assessed by rcr group measurable quantities based on a shared upstream controller, and specify the direction of control for each measurable quantity. gene sets for over-representation analysis derived from pathway maps such as kegg  <cit>  or gene ontology  annotation  <cit> , differ sharply from the hyps used by rcr in that the genes within a gene set are not related by a specified common regulator. gene sets derived from experimental data  are more similar to mechanism networks because they are selected by a common cause  but they generally do not express the causal information in a single structure. the incorporation of this causal information allows rcr to assess genes both up- and down-regulated by a controller as a common mechanism, and evaluate the causal consistency of the network against the observed data using the concordance metric.

rcr provides a qualitative assessment of significance of a mechanism, ideal for exploratory analyses to provide qualitative hypotheses about molecular mechanisms connecting the perturbation  to the observed gene expression. in contrast, network perturbation amplitude  methods, which use the same network structure as rcr to evaluate mechanisms, provide quantitative comparison of the activity of interesting mechanisms between data sets  <cit> . the rcr scores and evaluation metrics do not indicate relative strength of activation or inhibition of a mechanism, only the direction and significance. hyps with lower richness and concordance p-values are more likely to be biologically relevant. we found that filtering to p-values below  <dig>  typically results in a reasonable set of mechanisms for further manual evaluation, with an acceptably low level of false positives. of note, hyps with a relatively small number of downstream rnas  are intrinsically biased towards less significant p-values than larger hyps due to the smaller sample size.

rcr shares a limitation with other analysis approaches that require prior knowledge that only those mechanisms or pathways that are represented in the body of prior knowledge can be inferred to be active. for example, the whistle analysis of the tnf data set  did not infer tnf itself to be significant. tnf is not connected to sufficient downstream rna abundance nodes in the large corpus kam, thus no hyp representing tnf was evaluated. the knowledge base used for the example data sets, the large corpus kam, is significantly smaller than the knowledge base that selventa routinely uses with this algorithm. the species-orthologized large corpus kam generates approximately  <dig> mechanism networks. in contrast, the full selventa knowledge base permits evaluation of more than  <dig> mechanisms, and contains more downstream elements for each mechanism. we selected the large corpus kam to use here because it is publically available and sufficiently large for demonstration purposes.

the derivation of hyp networks from a larger causal network provides two immediate logical extensions to rcr. first, individual hyp networks can be causally connected within the larger network . each hyp represents a node in the kam, thus hyps that meet significance criteria can be joined through causal relationships in the kam to generate more complex explanatory networks. for example, for the pi3k inhibitor treatment data set, decreased pi3k activity )), decreased akt kinase activity )), and increased activity of foxo transcription factors foxo <dig>  foxo <dig>  and foxo <dig> ), tscript), tscript)) can be causally joined. second, while whistle is designed to create and score very simple hyp networks from a larger network, hyps representing more complex networks can be derived from the kam and evaluated by rcr. for example, algorithms could be created to generate hyps representing transcriptional motifs like sets of genes co-regulated by multiple transcription factors, or signalling pathway motifs like a ligand and receptor and their combined set of downstream rna targets.

CONCLUSIONS
rcr, a reverse engineering algorithm, provides mechanistic explanations for molecular profiling data sets, reducing data complexity and providing hypotheses to guide follow-up experimentation. this approach of identifying upstream causes that can explain the data offers some advantages over methods that map differential entities to gene ontology categories or pathway maps, because it does not rely on the assumption that changes in rna expression leads to comparable changes in active protein.

to identify potential explanations for a set of differential measurements obtained by comparison of two sample groups, this algorithm evaluates small networks representing biological mechanisms. these small networks are comparable to gene sets, but differ in their network structure that incorporates the direction of causal influence  of the mechanism on the measured quantity. this network structure enables both evaluations incorporating the direction of influence and the possibility to link multiple significant networks into a larger explanatory network.

whistle, an implementation of rcr focused on the interpretation of gene expression data that uses prior knowledge in bel format, is available at .

competing interests
all authors are either current or former employees of selventa . selventa has applied for a patent related to the method described in this manuscript; ts and dp are listed as inventors on the application.

authors’ contributions
ts, wl, koe, and dp developed the rcr methodology and initial implementation. ajb and su developed whistle. nlc provided requirements for and testing of whistle and developed the whistle/rcr use examples. nlc and dp drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
bel term and namespace abbreviations.

click here for file

 additional file 2
evaluated hyps for the tnf , pi3k inhibitor , and high fat diet  data sets.

click here for file

 additional file 3: figure s5
evaluation of richness correlation with hyp size. scatter plot  and boxplot  of richness versus hyp size  for randomized data matched to the example data sets. pearson correlation coefficient = - <dig> . s <dig>  evaluation of concordance correlation with hyp size. scatter plot  and boxplot  of concordance versus hyp size  for randomized data matched to the example data sets. pearson correlation coefficient = - <dig> . boxplot  shows reduced correlation for scores limited to those hyps with at least four rna expression changes; correlation coefficient - <dig> . s <dig>  evaluation of loess fit-adjusted concordance for example data sets.boxplots for concordance versus hyp size  for the high fat diet, tnf, and pi3k inhibitor example data sets  and adjusted concordance .

click here for file

 acknowledgements
the authors would like to acknowledge the late navin chandra, who, as founding cto of genstruct, articulated a vision of cause-and-effect analysis to pragmatically address complex issues in molecular biology. his insights were a critical first step leading to the development of rcr. the authors would like also to thank justin sun and tat chu for important contributions to rcr, ty thomson for helpful discussions, and william hayes for help generating and running the randomized data sets.

the research described in this article was supported by selventa.
