BACKGROUND
developing a metabolic pathway resource involves many steps. these steps can be described as follows: given a genome assembly and a gene model set, translated protein sequences are fed into a computational pipeline. enzymes are then predicted and assigned a functional category, usually based on gene ontology   <cit>  terms or enzyme commission   <cit>  numbers. after the initial enzymatic function assignments are made, enzymes are then mapped to a reference metabolic pathway database to create an initial metabolic pathway resource. finalizing a pathway resource requires manual curation to improve the accuracy of the final metabolic representation.

a wide-range of computational methods can be applied at each step of developing a metabolic pathway resource. this variance makes a comparison of metabolic pathway resources challenging. the problems that complicate comparison between heterogeneous databases have long been recognized  <cit> , and several attempts have been made to homogenize data from different sources  <cit> . studies seeking to compare data content between resources  <cit>  describe many of the challenges of matching biological data in order to assess overlap. non-standard chemical naming conventions, difficulty matching stereo-chemistry and protonation, as well as defining pathway boundaries and managing gene variants all create challenges for comparing metabolic pathway resources.

for maize, two metabolic network resources are available, both of which are based on the b <dig> refgen_v <dig> genome assembly/gene model set  <cit>  and used the pathway tools software  <cit>  to map enzymes onto reactions and pathways. this provides a unique opportunity to explore the effect of the initial enzymatic function assignment pipeline on the final metabolic pathway resource.

corncyc  <dig>   was developed using the ensemble enzyme prediction pipeline   <cit>  created by plant metabolic network   <cit>  in collaboration with maizegdb   <cit> . maizecyc  <dig>   <cit>  was developed based on the ensembl xref pipeline  <cit>  in collaboration between two database projects, gramene  and maizegdb. the term “ensemble” in the corncyc pipeline refers to integration of methods, whereas “ensembl” in the maizecyc pipeline refers to the collaborative project between the european bioinformatics institute and the wellcome trust sanger institute.

in order to gain insight into the strengths of each resource based on initial enzymatic function assignments, we compared the data content and accuracy of corncyc and maizecyc by calculating the overlap of different data types between the resources and compared the accuracy of computational annotations against experimentally-assigned enzymatic functions.

methods
gold standard protein annotation data
a gold standard set of protein functional annotations was generated by extracting data from uniprot  <cit>  and brenda  <cit> . we extracted all protein sequence and annotation data from uniprot  for the organism zea mays, keeping the ec annotations only from the manually reviewed component of uniprot, while removing those annotations that had not undergone manual review. we also extracted experimentally verified protein annotations for zea mays from brenda . the uniprot and brenda annotations were then merged by matching proteins based on the database cross-links provided by brenda, resulting in the union of the reviewed annotations from uniprot and the experimentally verified annotations of brenda with duplicates removed. the merged protein annotations were then matched to the b <dig> refgen_v <dig> translated gene models using blastp based on a sequence identity cutoff of 96% and an e-value cutoff of 1e- <dig>  we selected the top scoring hit for each protein which resulted in matches to  <dig>  unique maize proteins. ec annotations for alternate isoforms were consolidated at the gene level, resulting in  <dig>  experimentally verified or manually reviewed protein functional annotations across  <dig>  maize genes.

resource preparation and access
we compared corncyc version  <dig>  with maizecyc version  <dig>  hosted within pathway tools  <dig>   <cit> . throughout the text, we refer to corncyc version  <dig>  as corncyc and maizecyc version  <dig>  as maizecyc unless otherwise specified. figure  <dig> compares the pipelines used to produce both databases. both resources are based on the b <dig> refgen_v <dig> reference genome assembly and the filtered gene set   <cit> . although the v <dig> assembly of the maize genome sequence is not as recent as the v <dig> assembly, maizecyc was only available for v <dig>  which drove our decision to use the v <dig> assembly and less recent corncyc  <dig>  . also, while maizecyc was developed using pathway tools  <dig> , corncyc was developed using pathway tools  <dig> . in order to make a consistent comparison, both corncyc and maizecyc were upgraded to pathway tools  <dig>  and metacyc  <dig>  as follows: first we upgraded the schema of both corncyc and maizecyc to pathway tools  <dig>  using the built-in pathologic upgrade tool. then we removed all manually curated go terms from maizecyc. finally, we used the “propagate metacyc updates” and “rescore pathways” procedures in order to ensure that all reactions, compounds, and pathways were up-to-date with metacyc version  <dig> . the process of updating and rescoring pathways also served to remove existing manual curation at the pathway level, such as the application of savi to corncyc. the savi procedure was not reapplied to either corncyc or maizecyc. removing the manually curated go terms before the propagate and rescoring steps prevented bias that would otherwise occur. all data extraction queries to the corncyc and maizecyc resources were made using the javacyco libraries  <cit>  and the pathway tools application program interface . details of the methods used to extract and compare the data from corncyc and maizecyc are available in additional file  <dig> 
fig.  <dig> overview of the pipelines used to create corncyc  <dig>  and maizecyc  <dig> . green represents common components, and orange and blue corncyc- and maizecyc-specific components respectively. corncyc and maizecyc were both based on the b <dig> refgen_v <dig> gene model. they mainly differed in different functional annotation prediction methods incorporated into their respective pipelines. both databases used pathway tools and metacyc for their reaction and pathway inference. since both databases were created at different times, they used different versions of metacyc. finally, manual curation has been applied to both databases. in order to account for differences at the pathway and reaction inference steps as well as at the manual curation step, we propagated updates from the same version of metacyc to both databases and allowed the propagation utility to remove manually curated data




corncyc annotation pipeline
corncyc was developed based on the ensemble enzyme prediction pipeline   <cit> . e2p <dig> uses an average weighted integration algorithm based on results from individual classifiers such as blast  <cit> , catfam  <cit> , and priam  <cit> . the ensemble algorithm relies on an average weighted integration scheme where the weight of each predicted model was determined by a 5-by- <dig> nested cross-validation routine. for corncyc  <dig> , e2p <dig> version  <dig>   was used with blast’s e-value cutoff set to be ≤ 1e- <dig>  the training of e2p <dig> and the reference databases used in the annotation process are based on the reference protein sequence dataset  version  <dig>  included in the e2p <dig> v <dig>  package. rpsd contains protein sequences with experimental support of existence compiled from swiss-prot  <cit> , metacyc  <cit> , and brenda  <cit> .

after the initial database generation, corncyc was further modified by plant metabolic network using the savi pipeline  <cit> , which categorizes the initially predicted pathways to be retained, deleted, or manually reviewed based on a set of rules developed as a part of the curation process. savi also detects missing pathways. the savi program uses six curated pathway library files to enable semi-automated changes to a predicted pathway database . all pathway library files used in validating and refining corncyc  <dig>  are available online at: ftp://ftp.plantcyc.org/pathways/savi_validation_lists/savi_validation_lists_archive/savi_lists_pmn8_july_2013/.

maizecyc annotation pipeline
the development pipeline for maizecyc was described in detail previously  <cit> . maizecyc is based on the b <dig> refgen_v <dig> filtered gene set. the pipeline uses transcripts with the longest open reading frame  for functional annotation based on scores derived from the ensembl xref pipeline  <cit>  following protein sequence alignment to uniprot  <cit> . additional sources of enzymatic function annotations include classical maize genes  <cit> , coordinates and cross-references from maizesequence.org , maizegdb   <cit> , uniprotkb/swiss-prot  <cit>  , gene ontology  <cit>  , and proteomics-supported gene annotations . reactions and pathways were computationally inferred using the pathologic component of pathway tools  <cit> .

RESULTS
validation of enzymatic function assignments against experiments
to determine the accuracy of the computationally predicted protein function annotations in the publicly available versions of corncyc  <dig>  and maizecyc  <dig> , we compared the predicted annotations at the gene level against the gold standard set of annotations described in the “methods” section. we used the following definitions for our performance classifications: 1) true positive  is when a predicted function of an enzyme matches an experimentally determined function category for that enzyme. 2) false positive  is when a predicted function does not match any experimentally determined function category for that enzyme. finally 3) false negative  is when a function category is an experimentally determined but is not predicted by the annotation algorithm. when counting the false negatives, we included cases when a gene is not present in corncyc or maizecyc, which accounted for  <dig> additional false negatives in corncyc and  <dig> additional false negatives in maizecyc. the fourth category, true negative , is a quantity that is difficult to capture, as it means that for a given enzyme no prediction is made for a functional category that is also ruled out experimentally. precision, recall, and f-measure only uses tp, fp, and fn classifications. a summary of the results is shown in table  <dig> 



we used the following expressions for analysis: p
r
e
c
i
s
i
o
n=t
p/ and r
e
c
a
l
l=t
p/. precision is a ratio of correctly predicted classes among all the predictions, and recall is a ratio of correctly predicted classes among all the possible correct classes. f-measure is a combination of these two measures and provides a single measure for comparing the performance of two sets of predictions. f- measure is defined as 2∗/.

corncyc performs better than maizecyc, as demonstrated by higher precision , recall , and f-measure  . corncyc’s performance originates from the much higher number of true positives. for biologists, a higher f-measure means is that when they find an annotation in corncyc, it is more likely to be correct than it is in maizecyc.
fig.  <dig> performance comparison between corncyc  <dig> , maizecyc  <dig> , and the union of both datasets based on  <dig>  experimentally verified annotations across  <dig>  genes




in order to understand how combining annotations determines the final prediction performance, we merged all the enzymatic assignments from two resources into a single resource. figure  <dig> shows the performance measures for the merged resource. the merged annotations from corncyc and maizecyc performed worse than corncyc overall and better than maizecyc, while having greater coverage than either dataset individually.

comparison of data overlap
despite the fact that both were developed on the same gene model set, maizecyc and corncyc have a quite different distribution of go-annotated and mapped genes/proteins . part of the reason for this is that the scope of maizecyc includes all genes in the maize b <dig> refgen_v <dig> filtered gene set, while the scope of corncyc is limited to only enzyme-coding genes in the filtered gene set. in order to draw a useful comparison between the gene content in corncyc and maizecyc, we only considered genes associated with a form of annotation. specifically, we define a gene to have annotation if it is either assigned at least one go term or is associated with a protein that catalyzes at least one reaction. in corncyc, only  <dig> of the  <dig>  genes have go term annotations, but  <dig> % are mapped to at least one reaction. in maizecyc,  <dig> % of the  <dig>  genes have go term annotations while  <dig> % are mapped to at least one reaction .
fig.  <dig> comparison of a) go annotated gene, b) reaction mapped gene, c) reaction mapped protein, d) compound, e) reaction, and f) pathway statistics between corncyc  <dig>  and maizecyc  <dig> 




maizecyc contains more genes/proteins than corncyc, many of which only have go annotations and are not associated with a reaction. corncyc contains  <dig>  times as many unique genes as maizecyc , and nearly four times as many unique reaction-mapped proteins . the difference in the number of proteins can be explained by the fact that this version of corncyc contains, on average,  <dig>  alternative splice variants per gene. in contrast, maizecyc includes very few splice variants.

while  <dig>  reactions were found in both corncyc and maizecyc, corncyc contains  <dig>  reactions not present in maizecyc, and maizecyc contains  <dig> reactions not present in corncyc . in order to determine if the differences in reaction content reflect differences in coverage of reaction space, we compared the distribution of enzyme commission  categories for the reactions in each resource. reactions were assigned to ec categories using their top-level ec class. we compared the total reaction content of corncyc and maizecyc to the portion of reactions unique to corncyc and maizecyc, as well as the total reaction content of brenda  <cit>  and metacyc  <cit>  . metacyc is the source reactions from which corncyc and maizecyc imported their reaction information, while brenda contains a comprehensive source of enzyme information derived from literature. metacyc, corncyc, and maizecyc frequencies are distributed similarly, whereas frequency distribution for brenda is lower in ec  <dig> and ec  <dig> and much higher in ec  <dig> 
fig.  <dig> comparison of reactions sorted by ec category between corncyc  <dig> , maizecyc  <dig> , brenda , and metacyc  <dig> . for corncyc and maizecyc, reactions with no ec category are not included in the calculations. corncyc unique reactions refer to all reactions that were unique to the corncyc when compared to maizecyc, and vice versa. for metacyc and brenda, all reactions, including those not found in plants, were included



table  <dig> comparison of reaction and ec number statistics for all reactions in corncyc  <dig>  and maizecyc  <dig> 




we compared the compounds in both databases for small, non-elemental molecules . since compounds are imported into the corncyc and maizecyc from metacyc, we do not expect them to be intrinsically unique in one resource except when the two resources contain reactions catalyzing compounds unique to those reactions. as expected, as corncyc has more unique reactions, it also contains significantly more small-molecule compounds than maizecyc, providing a greater coverage of the compound space . the number of unique reactions has a direct effect on pathway coverage as well: corncyc and maizecyc have  <dig> pathways in common with  <dig> and  <dig> pathways unique to corncyc and maizecyc, respectively .

the level and quality of manual curation differentiates metabolic databases
manual curation is a powerful approach for ensuring consistency and accuracy of a database. unfortunately, the time-consuming and expensive nature of curation means that only limited parts of a data resource will receive manual review. in the case of corncyc and maizecyc, their content was first populated with computationally predicted annotations using their respective annotation pipelines. this content is then reviewed in an ongoing curation effort to integrate literature-supported experimental annotation into the metabolic resources.

the current version of corncyc  has  <dig> proteins and  <dig> pathways with experimental support. one area of maizecyc that has received considerable manual curation effort is gene ontology  annotations. because go annotations are important for researchers interested in gene function, we previously developed a tool to migrate go annotations between pathway tools-based metabolic databases  <cit> . previous work reported  <dig> experimentally verified go assignments to proteins in maizecyc, of which  <dig> were matched and transferred to corncyc by using this tool  <cit> .

corncyc and maizecyc show distinct differences on the pathway level: c <dig> photosynthesis pathway
to demonstrate how initial enzymatic functional annotations can lead to differences in a given pathway, we used the c <dig> photosynthesis pathway  as an example, as the pathway is present in both resources. in fig.  <dig>  the top panel shows the pathway diagram that displays the reaction set. at the bottom, a matrix displays which genes are linked to which reactions in this pathway. a yellow ‘c’ designates a gene which was linked to the given reaction in corncyc, while a green ‘m’ designates a gene which was linked to the given reaction in maizecyc. an orange ‘cm’ means that corncyc and maizecyc agree on a gene-reaction pairing. this example visually illustrates how different gene-reaction pairs in the c <dig> photosynthesis pathway for both resources. in this example, corncyc predicts enzymes for the reactions rxn- <dig>  and rxn- <dig>  while maizecyc does not predict any enzymes for these reactions.
fig.  <dig> the gene-reaction relationships for reactions in the c <dig> photosynthesis pathway pwy- <dig>  while the pathway and reaction-pathway membership  remain the same for both resources, the gene-reaction relationships differ. each gene-reaction pair  indicates if the pairing is found in corncyc , maizecyc , or both resources 




CONCLUSIONS
the availability of genome-wide metabolic pathway resources provides a systems-level view of the chemical interactions in a cell, which creates phenotypes of interest. when a metabolic pathway resource is developed and made publicly available, scientists can then construct a network of interactions around their enzymes of interest, and build further hypotheses based on the annotations assigned to the genes and proteins. for example, when an enzyme of interest is discovered to be differentially expressed and hypothesized to play a critical role in cellular processes, the next step is often to gather its functional annotations from several database resources for further analyses. therefore, it is highly desirable for a metabolic pathway resource to have annotations for larger numbers of enzymes. a higher coverage of the genome-wide enzyme space, however, does not automatically translate into a higher accuracy of prediction for those annotations. most of these annotations are generated through computational pipelines that involve multiple processing steps, and each step can contribute the final quality of a metabolic pathway resource. a larger number of functional assignments can indeed provide a higher number of correct assignments , but it can also introduce a higher number of wrong assignments .

corncyc  <dig>  and maizecyc  <dig>  are based on the same maize genome assembly version , and reaction and pathway mapping were done using the pathway tools software suite that heavily uses an “encyclopedia” of pathways “from all domains of life” called metacyc  <cit> . corncyc and maizecyc, however, were created by two different research groups based on their pipeline for enzymatic function assignments. in this work, we harnessed the availability of these two distinct metabolic pathway resources for maize in order to compare how initial enzymatic function assignments influence the final products that the biologists commonly use in their research.

our results demonstrate that even though both corncyc and maizecyc were constructed using the same gene model set and the same pathway assignment software, they have significantly different content. when we compared both databases in detail, we observed that maizecyc contains a larger number of go annotated genes whereas corncyc covers a larger metabolic space having more compounds, reactions, and pathways.

we also extracted experimentally determined enzymatic function assignments from uniprot and analyzed how well these assignments were discovered by the computational pipelines used during the development of the resources. we defined performance measures such as precision and recall, and consolidated these results into a single f-measure. f-measure comparison demonstrates that though corncyc coverage is more limited than that of maizecyc in terms of go-annotated genes, its functional annotations are more stringent, and therefore more reliable for creating further hypotheses. alternatively, a dataset composed of the merged annotations from both corncyc and maizecyc demonstrates that there is potential benefit to a merged resource which, while less accurate overall than corncyc, would provide greater coverage than corncyc or maizecyc at a higher accuracy than maizecyc alone.

to conclude, computational pipelines used in the initial enzymatic function assignments can have a large impact on the scope and quality of the metabolic pathway resources. the features of these pipelines determine the final accuracy and quality of these resources. given the large divergence between corncyc and maizecyc after starting from the same gene set, users of other metabolic resources should give additional scrutiny to the methods used in the generation of the resource.

additional file

additional file  <dig> method for extracting and comparing data from corncyc and maizecyc. this document describes how corncyc and maizecyc data were selected, extracted, and filtered and/or modified before comparison. the five major data types, genes, proteins, compounds, pathways, and reactions were each handled in unique ways. 




abbreviations
apiapplication programming interface

e2p2ensemble enzyme prediction pipeline

ecenzyme commission

fgsfiltered gene set

fnfalse negative

fpfalse positive

gogene ontology

pmnplant metabolic network

rpsdreference protein sequence dataset

savisemi-automated validation and integration

tntrue negative

tptrue positive

we thank the maizegdb team for sharing their insights and expertise. we thank jacqueline d. richter for her early contributions to the data extraction efforts.

funding
the material presented here is based upon work supported by the national science foundation grants eec- <dig> and abi- <dig> to jrw and jad, ios- <dig> to s.y.r., department of energy grant de-sc <dig> to s.y.r., and national institutes for health grant u <dig> gm <dig> to s.y.r. this work was also supported by long-term funding from the u.s department of agriculture - agricultural research service to tzs and mls. any opinions, findings, and conclusions or recommendations expressed in the material are those of the authors and do not necessarily reflect the views of the national science foundation.

availability of data and software
the datasets and code generated during the current study are available in the github repository, https://github.com/jrwalsh/corncompare. the software is available as an executable java program. pathway tools must be installed and running on a unix-like server system  and have corncyc and maizecyc uploaded. javacyco must be running in server mode on the same server as pathway tools. this software was written in java and is thus cross-platform compatible when java is installed on the client machine.

authors’ contributions
tzs, jrw, and jad conceived, designed, and coordinated the project. jrw developed and documented the software, and drafted the manuscript with tzs. jad provided guidance on the software development and mls on database curation of corncyc and maizecyc. syr and pz created and curated corncyc and provided their expertise in corncyc and metabolic databases. all authors contributed to the manuscript writing process, and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
