BACKGROUND
one of the strategies our immune system adopts to fight off intruders is to produce appropriate antibodies to recognize and neutralize foreign molecules specifically. this flexibility and robustness of adaptive immune system is mainly achieved by almost unlimited antibody diversity. as a homodimer of heavy and light peptide chains, each antibody contains a unique variable region encoded by variable , diversity  and joining  gene fragments   <cit> . these variable regions play a predominant role in determining the antibody specificity. in contrast to the potentially countless different antigens from the environment, the total sets of gene segments responsible for encoding are highly limited at the genome level. for instance, it has been found that the numbers of gene segments encoding heavy chain in human genome are only about  <dig> for v,  <dig> for d and  <dig> for j segments . the mechanism by which the diversified antibodies are produced based on limited gene segments has always been a topic of interest in molecular immunology. it is generally believed that the antibody diversity is mainly contributed by rearrangement among gene segments, junctional flexibility, somatic hypermutation and the pair matching between heavy and light chains  <cit> . in fact, it is only through the vj rearrangement process , j gene segments) the immune system may theoretically yield  <dig> diverse antibody genes for heavy chain . in addition, the modifications such as flexible junction  <cit> , n-region addition  <cit>  during recombination process and somatic hypermutation during an immune response  <cit> , will further lead to considerable increase in diversity and specificity. this process makes every antibody unique, only triggering a high-affinity response to one or one type of antigens.

this complicated process has aroused much interest because abnormal antibodies are often found to relate to serious diseases, such as systemic lupus erythematosus  <cit> , multiple sclerosis  <cit>  and rheumatoid arthritis  <cit> . thus, analyzing the features and origins of different antibodies would be useful not only to academic researches but also to clinical applications, where partitioning the functional antibody gene to the closest v, d, j gene segments in the germline has become increasingly required. various tools have been developed to assign rearranged sequences to their germline v,  and j counterparts. some are based on local sequence alignment to find the best match between mature antibody genes and v, , and j gene segments, such as dnaplot  <cit> , imgt/v-quest  <cit> , joinsolver  <cit>  and soda  <cit> . imgt/v-quest is the first automatic tool to analyze immunoglobulin junctional regions and is thus widely applied  <cit> . joinsolver incorporates two relatively conserved motifs, "tat tac tgt" and "c tgg gg", to find the margin of complementarity determining region three   <cit> . good performance is also achieved by a three-dimensional dynamic programming algorithm for vdj segments in soda  <cit> . another group of methods have applied statistical models, such as the hidden markov model , to obtain the optimized parameters fitting to the rearranged antibody, such as vdjsolver and ihmmune-align  <cit> . although these type of methods provide alternative ways to locate the best matched gene segments in the germline, model robustness relies heavily on the quality and diversity of training data sets in order to obtain consistently good performance for different varieties of antibodies  <cit> .

for many years, researchers have relied on dnaplot and imgt/vquest for immunoglobulin sequence alignment. as different programs have their respective advantages and disadvantages, several approaches have been reported in recent years to suit different needs  <cit> . for instance, joinsolver was developed specifically for analyzing cdr <dig> regions, which gives best results to sequences without mutations in the two conserved motifs  <cit> . while soda is often used to analyze a small number of sequences with low mutation level  <cit> . despite that, none of them give quantitative measures about confidence level, which could be a useful guide to the users especially when identification accuracy is not high enough for ighd.

in this paper, we describe a fast and efficient tool for general analysis which partitions functional antibody sequences to corresponding gene segments, with substantive refinement of algorithm parameters and more extensive validation based on a preliminary work  <cit> . in particular, for users' reference, a confidence indicator is provided in terms of the scoring threshold corresponding to certain specificity and sensitivity for ighd identification.

in our method, the empirical knowledge from clonally unrelated rearranged sequences was incorporated and natural antibody sequences were used to confirm the feasibility of ab-origin rather than purely simulated sequences. blast algorithm  <cit>  with customized parameters and window-sliding algorithm were adopted to realize the process. the performance of ab-origin was evaluated through independent set of simulated antibody sequences, as well as being compared to other five popular tools. ab-origin was developed using java language.

RESULTS
general information on human igh germlines
the numbers of non-redundant alleles from imgt are  <dig>   <dig>  and  <dig> for ighv, ighd and ighj respectively. the statistics showed that the full-length ighv germline sequences are  <dig>  ±  <dig>  nt long on average, ranging from  <dig> to  <dig> nt, while the data for ighj segments is  <dig>  ±  <dig>  nt, ranging from  <dig> to  <dig> nt. comparing to ighv and ighj, the average length of ighd sequences is only  <dig>  ±  <dig>  nt, with much larger variations in length from  <dig> to  <dig> nt.

choosing optimized scoring scheme for ighd identification
based on the analysis of results from monte carlo simulation, an optimized scoring scheme is developed to minimize the possible effect resulted from large variation in length of v-to-j region. the results from the simulation have been plotted into figure  <dig>  it can be seen that the scoring scheme of +5/- <dig> shows the minimal coefficient of variations under different length of v-to-j region from  <dig> to  <dig> 

initial evaluation through ighv3- <dig> sequence set
a set of  <dig> rearranged antibody sequences obtained by amplifying the ighv3-23-ighd-ighj joints by pcr were collected  <cit> , and  <dig> were randomly selected as input data to evaluate the ighv identification performance of ab-origin, together with five other tools . as shown in table  <dig>  the six tools all gave good performance in ighv3- <dig> identification. it is evident that, although ihmmune-align was designed to analyze rearrangement with no insertion or deletion within ighv gene  <cit> , it did not pick up any false positives.

the numbers of correct and incorrect pickups are shown here, together with the number of input sequences which can't be deciphered  by the six tools. a correct pickup is defined as a successful identification of ighv3- <dig> gene within the  <dig> samples, allowing for mismatched alleles.

* demonstrate that the accuracy of ab-origin is significantly higher than that of this tool.

a number of the input sequences cannot be deciphered by the tool due to various reasons.

b number of the incorrect pickups among the sequences already been deciphered.

c accuracy = correct pickups/500

this set of experimental data could also be applied to derive parameter setting of junctional flexibility. after mapping the rearranged sequences to their original ighv3- <dig> gene segments, the number of nucleotides that have been removed from the 3' end of ighv3- <dig> during the recombination process can be obtained. figure  <dig> shows the frequency distribution of nucleotide number being removed from the 3' end of the  <dig> sequences. more than 95% of the junctional flexibility length are equal or smaller than five nucleotide in our study, a result indirectly supported by another study  <cit> , thus the allowed length of junctional flexibility is set to 0– <dig> nt in our following simulation model.

further validation using simulated data set of full-length variable regions for heavy chain
because of the scarcity of experimentally derived antibody sequences with known germline gene segments, artificial sequences were often generated to validate predicting algorithms  <cit> .  <dig> pieces of antibody sequences of variable regions for heavy chain were initially obtained by simulation described in the methods section. the length distribution of v-to-j region of these sequences was compared with that of  <dig> real antibody sequences from imgt database . with  <dig>  ±  <dig>  nt  compared to  <dig>  ±  <dig>  nt , the result indicates that no significant difference in length is observed between simulated and real sequences . therefore, the simulated sequences are expected to be applicable for further validation. it is noted that different tools often use different germline repertoires which could make a difference when comparing their performance. to ensure fairness, only simulated sequences which include those common germline repertoires among the six tools were retained. during the validation,  <dig> pieces of such sequences randomly selected were treated as testing data, the same version of the imgt germline gene repertoire is recruited as much as possible between all programs. the performances of different programs are summarized into table  <dig> 

the numbers represent the results from six programs. a wrong pickup means that the identified gene segment was not the one we used exactly in simulation.

a number of the rearranged sequences cannot be deciphered by the tool due to various reasons. some tools give the explanation for rejection, i.e. joinsolver could not well define the cdr <dig> region  <cit> ; ihmmune-align is not intended for gaps in ighv and short length of ighv  <cit> .

b number of the wrong pickups among the sequences already been deciphered.

c accuracy = 1-/1000

d number of the sequences already been deciphered by the tool but didn't find the ighd alignment because of respective restrictions.

* demonstrate that the accuracy of ab-origin is significantly higher than that of the tool.

it can be seen from table  <dig> that all the programs give higher accuracy in identifying ighv and ighj gene segments than in identifying ighd. this is because ighd genes are much shorter and difficult to locate, as reported in previous studies  <cit> . most of the wrong ighv and ighj assignments are due to the existence of alleles. if factors such as mismatched alleles and the sequences rejected by the tool are excluded, ighv and ighj can be identified respectively with accuracy close to 100% for the six tools.

in total, the performance of ab-origin is the best among the  <dig> tools, with a statistically significant higher accuracy in classifying all the three types of gene segments .

using the score from ab-origin to estimate reliability of ighd gene identification
in spite of the high accuracy when identifying ighv and ighj, it is noticeable that identifying ighd correctly is much more difficult for all the available tools. without experimental results for reference, there is no criterion to ascertain which alignments are correct. empirically, when the original d germline is not known, the consensus between all the tools is more likely to be the true result  <cit> . unfortunately, further analysis of four non-redundant experimental datasets showed that the results from the five existing tools have only about 42%  agreement with each other in identifying ighd gene segments . this implies that the results from any one computational tool may contain a large number of false positives. therefore for a specific tool, providing a scoring threshold to infer the confidence level would be desirable to users when the prediction results are obtained for ighd. one possible way to derive scoring threshold is from a receiver operating characteristic  curve of large amount of simulated sequences.

an roc curve is frequently adopted to evaluate the performance of a classifier  <cit> , hence it is used in our study to examine whether our scores can successfully distinguish between right and wrong identifications. the roc curve derived from ighd identification results for  <dig> simulated sequences of variable regions is plotted into figure  <dig> 

as a non-parametric measure of classification accuracy, roc curve displays a trade-off between the sensitivity and specificity for all possible thresholds  <cit> . as in a case of random prediction, the true positive proportion would be equal to the false positive proportion for every threshold, and the roc curve would be inclined to the diagonal. in other words, a good classifier would have a high true positive proportion as well as a low false positive proportion. very much away from the diagonal, the solid line of the roc curve in figure  <dig> indicates that, the scoring from ab-origin acts as a qualified classifier for the whole sequences set in general, although variances exist between sequences generated from different ighd germline genes.

the relationship between selected thresholds and the sensitivity/specificity of the classification is summarized in table  <dig>  users are strongly recommended to refer to this table for guidance when choosing the prediction results for further analysis.

to examine whether our threshold is applicable to real data analysis, a threshold of  <dig>  was applied as an example to the four sets of experimental antibody sequences which were analysed by the other five tools before . as shown additional file 3: table s <dig>  the identified ighd genes above this threshold have improved to 69%  agreement among the other five tools, in contrast to the 42%  agreement without any cut-off. hence, such a threshold is expected to be a helpful guide to the credibility of the results. since the respective accuracy for ighv and ighj is high enough, their confidence were omitted.

discussion
the random assortment of the v, , j gene segments provides the basic structural frames for antibody variable region to recognize specific antigen. however, the details of this process are still largely unknown. although the functional antibody sequences are plentiful, their origination v-d-j gene segments at germline level are seldom known. till now only few experiments have studied the large-scale rearranged antibodies with known v gene source  <cit> . in this paper, experimental data of ighv3- <dig> genes were first applied to examine the capability of different programs in picking up ighv genes correctly, then to further derive the parameters of junctional flexibility for later simulation. because of the scarcity of real data, validation of the performance of different algorithms has to heavily rely on simulated sequences in most cases. hence artificial sequences were generated in our study for  <dig> pieces of full-length variable regions of heavy chain. though the simulation model is far from complete, it could be a practical way for evaluation purposes  <cit> .

in recent years, several computational tools have emerged to identify the sourcing gene segments at germline level. after several rounds of validation, these tools showed different ability in finding v, d and j gene segments correctly for heavy chain. generally speaking, programs based on sequence alignment gives better results in predicting longer segments, such as ighv and ighj. however statistical models also show outstanding ability in tracing back d segment to its germline, such as ihmmune-align in table  <dig>  which indicates their future potential in computing short and volatile elements among the antibody sequence.

in spite of the various algorithms conceived, the accuracy for ighd identification is lower than that of ighj and ighv. there are several reasons which could contribute to the partitioning ability of algorithms: first is the length of the gene segments, it should be long enough in order to avoid random matches to its original germlines. second is the number of gene segments in each of the v, d, j pools, the fewer the number of members in a group, the easier it is for the program to identify them. third is the junctional flexibility and mutation rate. the prediction accuracy will be seriously affected if the gene segment varies too much during the rearrangement and further development process. the limited modification, fewer family segments, and sequences of sufficient length make ighv and ighj segments to be identified with higher accuracy , as demonstrated in previous studies  <cit> . with regard to ighd identification, the germline sequences are much shorter than that of the ighv and ighj, with average length of  <dig>  ±  <dig>  nt, and length ranges from  <dig> to  <dig> nt. in contrast, ighv germline sequences vary from  <dig> to  <dig> nt and ighj from  <dig> to  <dig> nt. furthermore, ighd germline is the most volatile part which undergoes possible removal and n-addition from both ends, in addition to following somatic hypermutaion. considering this, the remaining length of d segment in the rearranged sequences could be as short as few nucleotides from our statistical results . hence there is a higher probability of false positive matches in identifying d germlines, and in some cases, no hit can be found. that is partially explains why vdjsolver could not find the d segments if less than eight nucleotides long  <cit> .

ab-origin was developed based on blast, which has been widely accepted as a powerful and efficient algorithm for sequence alignment that allows customized parameter settings according to specific conditions  <cit> . in particular, for ighd identification, ab-origin applies a window-sliding strategy to exhaustively align the query sequences to the ighd pool to find the best hit. besides, the scoring scheme for ighd search has been carefully evaluated and designed to minimize the influence of match length. it should be noted that ab-origin is not suitable to compute cases of allelic exclusion, isotopic exclusion as a blast-based tool, however, with the accumulation of more functional antibody sequences, the abnormal features could be more evident and thus possible aberrant recombinations could be identified.

CONCLUSIONS
an enhanced tool, ab-origin, was developed to provide batch query services with joint advantages of accuracy and prediction confidence. allowing detailed investigation of the original germline segment for antibodies and potential rearrangement profiles, ab-origin is expected to serve as a useful tool for the informatics study in the immune-community, so as to promote the understanding of antibody maturation process. from current investigations, the most difficult part lies in the analysis of the junctional region, thus further efforts could be directed towards incorporating statistical models, such as hmm, and accumulating more experimental data to enable insightful research into the antibody rearrangement process.

