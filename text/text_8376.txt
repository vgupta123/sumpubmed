BACKGROUND
recombinant dna techniques, such as dna shuffling, generate more diverse libraries than random mutagenesis with a relatively high fraction of functional proteins  <cit> . like mutagenesis but unlike de novo protein design, recombination deals with native sequences whose effectiveness for some particular function is established. as protein design tools, recombinatorial techniques dramatically reduce the combinatorial space of possible sequences to an area which can be explored in vitro more easily.

site-directed  recombination systematically reduces the amino acid sequence space for consideration by identifying specific sites in parental sequences at which their parts can be interchanged  <cit> . this paper develops and evaluates a method that uses machine learning to suggest recombination sites solely from the amino acid sequences of the parents. alternative tools may be more precise but require either parents to be structurally resolved  <cit>  or phylogenetically well-characterised  <cit> .

schema predicts structural disruption by gleaning contact maps of parents  <cit> . the principle of schema applies to recombination site identification  or to evaluate the folding potential of specific hybrids . raspp  was introduced to generate and evaluate candidate hybrids using the e-value  <cit> .

schema's s-profile essentially identifies sequence segments that are likely to fold independently from the rest of the protein  <cit> . the profile is the series of sums of possible disruptions  within a window centered on each residue of the protein . the assumption behind schema is that protein function is preserved by not interfering with these structural "building blocks". different segments are sampled from a family of parent proteins to be recombined with the main structural features left intact  <cit> . indeed, sites identified by schema match successful recombination sites used in in vitro experiments  <cit> . additionally, the application of schema on the β-lactamase and cytochrome p <dig> families has been helpful in evaluating  the ratio of folded and functional enzyme hybrids  <cit> . note, schema's "building blocks" must not be confused with domains or other structural or functional subdivisions . by placing recombination sites only at the boundaries of such structural subdivisions, exploration is severely hampered  <cit> . additionally, to enhance a function, intra-domain segments may need to be perturbed.

unfortunately, schema requires the full tertiary description of the protein structure . this requirement severely limits the number of candidate proteins to the small group that are already resolved. due to the expensive, time-consuming and complicated nature of structure determination, the number of proteins with known structure is likely to remain comparably small to the number of known sequences.

famclash is another method for evaluating the potency of hybrids  <cit> . famclash checks for every amino acid pair   if charge, volume and hydrophobicity is in agreement with the conserved properties at  in the protein family both parents belong to. to determine the conserved properties of the family a preprocessing step is necessary. each residue pair in the mth member of the family forms a unique 3d coordinate [ci,jm
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgdbwqdaqhaawcbagaemyaakmaeiilawiaemoaaogabagaemyba0gaaaaa@32e3@, vi,jm
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbgvdaqhaawcbagaemyaakmaeiilawiaemoaaogabagaemyba0gaaaaa@3309@, hi,jm
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgibasdaqhaawcbagaemyaakmaeiilawiaemoaaogabagaemyba0gaaaaa@32ed@] with ci,jm
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgdbwqdaqhaawcbagaemyaakmaeiilawiaemoaaogabagaemyba0gaaaaa@32e3@ = c + c, where k is the residue at position i in m and l at j and c is the value of a lookup table containing the charge of the residue . the space is partitioned into cubes. residue pairs whose coordinates are within one cube are defined to be similar. a position  is conserved if 20% of the family members have a residue pair for  that is within the cube. each residue pair in the hybrid can now be assessed with the triplet of the mean values of the conserved residue pairs in the protein family. any deviation between hybrid and conserved property in the family is denoted as a "clash". positions with no conservation are simply ignored. a limitation of famclash is its reliance on members of the parents' protein family. a sufficiently large protein family needs to be established and analysed to properly identify conservation.

saraf et al. developed optcomb  <cit> , which like raspp identifies the optimal recombination sites and, additionally, is able to limit the parental sequence fragments for the library to the most promising ones. famclash  <cit>  is used as an objective function. thus, optcomb identifies recombination sites which produce hybrids with the minimal number of clashes. like raspp, optcomb is able to use any function that evaluates a protein including schema  <cit>  or the current method.

using machine learning methods, we developed star , to extend a schema-like analysis to proteins for which no structure has been solved. star predicts the maximum number of connections that can be broken by recombination for each position in the parent – schema's single-parent s-score . a minimum in this star-profile corresponds to a region where the protein structure has lower contact density and thus less prone to be corrupted by recombination.

notably, schema's s-score has largely been superseded by the e-value . since the intention here is partly to explore the applicability of machine learning tools to assist in the determination of recombination sites, we choose to focus on the simpler strategy based on the s-score as calculated from a single sequence.

for comparison, i-mutant <dig>   <cit> , mupro  <cit>  and conseq  <cit>  predict stability changes caused by single-point mutation from amino acid sequence data. these methods are not specifically designed to assist in the determination of recombination sites.

however, by exhaustively testing all possible amino acid substitution for each position, we can identify crucial amino acids within the sequence, and compare these scores with star's. i-mutant <dig>  and mupro are both machine learning-based and predict a stability change  of the whole protein for a given single-point mutation. if a residue is crucial for retaining the current structure, substitutions would result in large negative predictions. conseq uses phylogenetic trees to calculate a conservation score for each residue which should correlate with the importance of it.

implementation
the goal is to develop a model using machine learning methods to predict schema's single-parent s-profile from an amino acid sequence. from a machine learning point of view, the goal presents a significant challenge since schema relies crucially on structural features, not amino acid composition. as per equation  <dig> the s-score counts the number of connections that break if position i serves as the point at which sequence parts are exchanged.

si=∑j=i−w+1i∑k=jj+w−2∑l=k+1j+w−1ckl     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwudawgaawcbagaemyaakgabeaakiabg2da9maaqahabawaaabcaeaadaaewbqaaiabdogajnaabaaaleaacqwgrbwacqwgsbabaeqaaaqaaiabdygasjabg2da9iabdugarjabgucariabigdaxaqaaiabdqgaqjabgucariabdeha3jabgkhitiabigdaxaqdcqghris5aawcbagaem4aasmaeyypa0jaemoaaogabagaemoaaomaey4kasiaem4dacnaeyoei0iaegomaidaniabgghildaaleaacqwgqbgacqgh9aqpcqwgpbqacqghsislcqwg3bwdcqghrawkcqaixaqmaeaacqwgpbqaa0gaeyyeiuoakiaaxmaacawljawaaewaaeaacqaixaqmaiaawicacaglpaaaaaa@5d00@

si describes, for each sequence position i, the number of contacts within the window  that could be broken if the recombination site is positioned at i. ckl =  <dig> if residues k and l are in within  <dig>  Å of one another, and ckl =  <dig> otherwise. in the multi-parent s-score, ckl is derived from a multiply-aligned contact map  <cit> . ckl only counts when the two residues k and i come from different parents and represent different amino acids. the single-parent s-score neglects the overlap between parents and is thus an upper bound of the multi-parent s-score . to follow the configuration used by  <cit> , w is set to  <dig> residues.

to build a data set for training and evaluating machine learning models, the binary contact map was derived for each of the proteins in a 945-protein data set  by employing a euclidian cut-off distance of  <dig>  Å. equation  <dig> is then determined for each residue in the set. for practical purposes, the single-parent s-score is normalised to fall in the 0– <dig> interval: sin
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwudaqhaawcbagaemyaakgabagaemota4eaaaaa@3088@ = tanh where we have preset max =  <dig> from gleaning the data set. we call this score the calculated star-score. the sequence set represents a diverse range of proteins and has no pairs with more than 25% sequence similarity  <cit> . the data set is made available from the predictor home page.

model development
psi-blast profiles are used successfully for most protein structure prediction problems, including secondary structure, residue contacts, and surface accessibility  <cit> . in a standard fashion, each protein chain in the data set is represented using the psi-blast profile . the profile implicitly incorporates information about sequence variability and the location of indels within a family of proteins  <cit> .

we evaluate two major types of machine learning algorithms, namely support vector regression and neural networks. both types have repeatedly been found superior for relevant prediction problems . the input window size of all models is set to  <dig> residues: the residue for which the schema score is predicted and then 7+ <dig> residues immediately upstream and downstream, respectively. we use 2-fold crossvalidation to develop and test models, meaning that one simulation run involves training and testing two models. each model is trained on half the data and tested on the remaining half but controlled so that each data point appears as a test point in exactly one model. preliminary simulations with the used models showed that the differences between 10-fold and 2-fold crossvalidation are negligible . to minimize the computational time required, we consistently use 2-fold crossvalidation to develop and test the models. however, we repeated the runs to guarantee consistency in the results. the average accuracy is reported below.

the star-score is not predicted with a reasonable accuracy if the machine learning algorithm is presented with only the sequence data encoded using psi-blast profiles . instead we first present the sequence to an already existing secondary structure predictor and then use its output as the input to our star-score predictor. to predict the secondary structure, we use the continuum secondary structure predictor  <cit>  which produces a probability for each secondary structure state. noteworthy, the continuum secondary structure has a state-of-the-art classification accuracy of q <dig> =  <dig>  and from preliminary trials we note there is no significant difference in star-score prediction accuracy if the true secondary structure is used as input instead.

the star-score prediction accuracy  when sequence data was presented directly to the machine learning algorithm.

the simple feed forward neural network  and the bidirectional recurrent neural network   <cit>  are trained and evaluated on the 945-protein data set. training uses gradient descent to minimise the error as measured on the single output node. the learning rate is η =  <dig> . a variety of hidden node numbers h  are trialled. for all neural networks, training data is presented in batches of  <dig> windows before the weights are changed. a total of  <dig>  sequences were presented in random order before we stopped training. in preliminary studies this number was seen as sufficient for convergence.

recent findings suggest that support vector regression  exceeds the accuracy reached by many neural networks  <cit> . essentially, support vector regression operates by finding so-called support vectors that collectively represent the function in a feature space. a kernel function maps the input sequence encoding into the feature space. support vector regression can be understood as minimising a tube wrapped around the hypothesis function. during training, the "tube" is defined by an ε-insensitive loss function . sample targets outside this margin are penalised. for ε, we use the standard value of  <dig> . we examine optimisation using ε-svr and ν-svr with the same protein data set. ν-svr replaces the ε hyper-parameter with ν, to control the number of support vectors . the standard stopping criterion is used and c was set to  <dig>  . we trial both the linear and gaussian kernel functions . note, the exploration of the parameter space is far from being exhaustive.

we use the correlation coefficient r between the calculated star-score ti and the predicted score pi where the index i represents the position in the sequence, r is defined for a single chain.

r=〈⋅〉〈〉⋅〈〉     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgybgccqgh9aqpdawcaaqaaiabgmyihlabcicaoiabdsha0naabaaaleaacqwgpbqaaeqaaogaeyoei0iaeyykjeuaemidaq3aasbaasqaaiabdmgapbqabagccqghqms8cqggpaqkcqghfly1cqggoaakcqwgwbacdawgaawcbagaemyaakgabeaakiabgkhitiabgmyihlabdchawnaabaaaleaacqwgpbqaaeqaaogaeyokjevaeiykakiaeyokjepabawaaoaaaeaacqghpms4cqggoaakcqwg0baddawgaawcbagaemyaakgabeaakiabgkhitiabgmyihlabdsha0naabaaaleaacqwgpbqaaeqaaogaeyokjevaeiykakiaeyokjepaleqaaogaeyyxic9aaoaaaeaacqghpms4cqggoaakcqwgwbacdawgaawcbagaemyaakgabeaakiabgkhitiabgmyihlabdchawnaabaaaleaacqwgpbqaaeqaaogaeyokjevaeiykakiaeyokjepaleqaaaaakiaaxmaacawljawaaewaaeaacqaiyagmaiaawicacaglpaaaaaa@72cd@

where ⟨·⟩ is the mean. ideal performance means that ti and pi are perfectly and positively correlated r =  <dig> all reported result values are averages over all chains .

RESULTS
the results when using the predicted secondary structure as input are shown in table  <dig>  brnn seems to perform slightly better than the other algorithms but the small number of trials prohibits us from ranking them confidently.

the star-score prediction accuracy  when sequence data was presented as the predicted 3-class continuum secondary structure.

the average correlation coefficient between the predicted and calculated star-score for brnn on test data  is  <dig>   and the mean squared error is  <dig> . approximately 18% of the sequences from the star data set have a sequence similarity exceeding 25% with sequences in the training dataset of the secondary structure predictor  <cit> . to ensure that the overlap does not influence the estimated accuracy, we assessed the star prediction accuracy specifically for the sequences which had less than 25% similarity with the set used for training the secondary structure predictor. the average correlation coefficient on these  <dig> was  <dig>  .

the most essential piece of information in the s-profile is the positions of minima  <cit> . in addition to the correlation, the distance between the positions of the minima in the predicted function and in the target function, illustrates the suitability of the method for protein design. the average distance between the position of the predicted and the target minima is a mere  <dig>  residues for the brnn-model.

the high correlation between the scores and the low average distance between their minimas, illustrate the feasibility of replacing the s-score with star – allowing the user to explore structural building blocks in silica of yet unresolved or even hypothetical protein with little loss of precision.

the web interface of star requires the user to input a single amino acid sequence , and then predicts the single-parent schema profile. the profile can be presented as a graph – allowing the user to quickly assess regions of low connectivity lending themselves to recombination. the individual scores are also presented numerically with added details . a suitable recombination site is thus one with a low score, i.e. a position which – should it be the point of exchange – disrupts few, predicted connections in the parent sequence.

a family of cephalosporinase genes from four microbial species subjected to random dna shuffling yielded an eight-fold increase of moxalactamase activity in a single cycle of shuffling  <cit> . we presented the sequence of pdb entry 1bls  to star. we calculated the single-parent s-score  from the contact map of 1bls and the multi-parent s-score using a sequence alignment between 1bls and 1g <dig> . both schema-profiles were superimposed on top of the predicted star-score . we also present the successful recombination sites as determined from the original random shuffling experiment. the same data was used for evaluating the original schema algorithm . for practical reasons we were unable to test famclash 

as can be seen in figure  <dig>  the successful recombination sites match the minima of all profiles with the exception of the site close to the c-terminus. the last site is deemed unsuitable by both the original schema algorithm and star. the full structure shown in figure  <dig> illustrates that regions which have divergent schema- and star-scores are at the surface of the molecule and should typically have lower connectivity .

to put the example prediction in context, we adapted alternative methods not explicitly designed for this purpose but potentially useful for identifying recombination sites. the predicted stability change of i-mutant <dig>  and mupro is summed up over all  <dig> possible amino acid substitution for each position of the amino acid sequence. the lower the score for an amino acid, the more sensitive the current structure is to perturbations. the score profile is smoothed with a kernel averaging over  <dig> neighboring residues, normalised and inverted to compare neatly with star's profile. this post-processed prediction thus has minima at positions with high substitution tolerance. conseq predicts a conservation-score which is similarly smoothed. this modified conseq-profile has minima at positions with low evolutionary diversity. low evolutionary diversity is taken to indicate essential residues for structure or function of the protein.

i-mutant <dig> , mupro and conseq predictions along with the biological verified recombination sites of 1bls are shown in figure  <dig>  i-mutant <dig>  and mupro predict minima at the verified recombination sites-supporting the assumption to cut at less sensitive regions . conseq on the other hand does not seem directly applicable for the identification of recombination sites. it should be noted however that the experimental recombination data for 1bls is far from exhaustive. our comparison merely serves to illustrate that currently there appears to exist no silver bullet for recombination site prediction.

star uses continuum secondary structure as input. however, star does more than avoid breaking helices. rat reductase  has a bundle of short helices, interrupted by coiled segments . as the user of the online service can verify, star recognises the bundle and predicts a constant high connectivity score.

purn and gart glycinaminid ribonucleotide transformylase  were recombined and functional hybrid proteins were selected  <cit> . recombination was restricted to occur between amino acid position  <dig> and  <dig>  in figure  <dig>  the multi-parent s-profile determined from the pdb entry 1cdd and gart  <cit>  is shown. the predicted star-profile was generated from the sequence of 1cdd. for comparison the graph also shows the calculated single-sequence s-profile for 1cdd. in spite of the high sequence similarity between 1cdd and gart, the single- and multi-parent profiles are very similar. the 1cdd structure is incomplete for residues 110– <dig> and hence the calculated s-profiles are undefined for this segment. the predictor was presented with the full sequence  and correctly characterises this segment as unsuitable for recombination. finally, we removed all residues in the unknown sequence segment to illustrate the predictors ability to cope with incomplete sequence data.

mupro and i-mutant <dig>  performed poorly on 1cdd . conseq failed completely to generate an output since 1cdd has too few family members to generate the required alignment.

CONCLUSIONS
schema-based guidance can increase the fraction of properly folded proteins resulting from a single round of recombination from a mere 9% to 75%  <cit> . however, access to tertiary and quaternary structures is limited, imposing a severe restriction on the use of algorithms like schema. if exploration beyond the few sequences that have been rigorously characterised is required , we cannot use methods that assume access to tertiary or quaternary structure.

as at april  <dig>  there are about  <dig>  structurally resolved proteins in the protein data bank but several hundreds of thousands of known proteins in sequence databases. since star requires only the protein sequence as input, it enables the protein engineer to choose candidate proteins on the basis of functional properties , and not be limited to those for which full structural or extensive protein family information is available.

star has been trained on data generated by the normalised version of the single-parent s-profile on the basis of resolved protein structures, representative for the whole protein universe . star is able to generalise so that each position in any hypothetical or yet unresolved protein can be accurately evaluated in relation to its potential to disrupt the structure . in this context, we review recent algorithms intended for predicting structural stability changes caused by single-point mutagenesis, and adapt them to similarly serve to identify sites prone to disrupt structure.

availability
• project name : star

• project home page : 

• operating system: platform independent

• programming language: java servlet

• licence: a licence is required for non-academic use

authors' contributions
dcb researched and developed the schema score prediction model under the supervision of mb and rt. dcb and mb drafted the paper and rt and

emg provided substantive feedback on the draft and helped finishing the manuscript. the prediction service was developed by mb and dcb.

