BACKGROUND
due to the recent rise of big-data in biology, predictive models based on small panels of biomarkers are becoming increasingly important in clinical, translational and basic biomedical research. in clinical applications such predictive models are increasingly being used for diagnosis  <cit> , patient stratification  <cit> , prognosis  <cit> , and treatment response, among others.

many types of biological data can be used to identify informative biomarker panels. common ones include microarray based gene expression, microrna, genomic copy number, and snp data, but the rise of new technologies including high-throughput transcriptome sequencing  and mass spectrometry will continue to increase the diversity of biomarker types readily available for biomarker mining.

useful predictive models are typically restricted to use a small number of biomarkers that can be cost-effectively assayed in the lab  <cit> . the use of few biomarkers also reduces the effects of over-fitting, particularly for limited amounts of training data  <cit> . once training data has been collected and appropriate procedures for normalization of primary data have been defined, assembling a robust biomarker panel requires the solution of two main computational problems: feature selection, to identify a short list of informative biomarkers, and classification, used to make predictions for new samples based on patterns extracted from the training data. both of these steps have been explored extensively in the statistics and machine learning literature, and many alternative algorithms are available for each. due to the sheer number of available choices and the lack of predictable interactions between feature selection method, classification algorithm, and data type, assembling the most robust biomarker assay for a given biomedical application is rarely undertaken systematically. rather, it is more often driven by the intuition and a priori preferences of the statistician.

available feature selection methods can be grouped into three broad categories: filter, wrapper and embedded. filtering approaches use an easy to calculate metric which allows quick ranking of the features, with top ranking features being selected. wrapper methods use a classification algorithm to interrogate the effect of various biomarker subsets. embedded approaches are classification algorithms which eliminate features as part of the training process. recent studies  <cit>  investigated the influence of feature selection algorithms on the performance of predictive models and provided a framework for thorough comparison of approaches. however the effect of the number of biomarkers selected and high-dimensional data type was not explored.

there are hundreds of publications describing classification algorithms and their applications to genetic research and medicine. many publications advocating a new method employ a limited comparison between similar approaches. however non-uniform validation strategies make it difficult to assess performance of a wide variety of approaches. a previous study compared both classification and feature selection approaches in a unified framework  <cit> , however the effect of biological data type was not explored, but it was observed that the biological question does have an effect on the best model. additionally most comparisons typically overlook the effect of model parameterization even though the choice of parameters can have profound effects on performance.

this work presents a large scale empirical comparison of the effects of the interaction between the main components of the predictive model , the number of features utilized, and the underlying data type on the performance of the overall model. this study also implements exhaustive parametrization of all models to ensure a fair comparison between models.

in order to test the performance of the large number of models tested in this study, and in order to be able to run direct comparisons of the models on different biological data types, we took advantage of the publicly available nci- <dig> cancer cell line data set  <cit> . the nci- <dig> cell line collection represents a carefully curated collection of  <dig> independent cancer cell lines derived from nine types of cancer occurring in  <dig> individual patients. each line has been uniformly cultured and dna fingerprinted to ensure independence  <cit> . in addition, the nci- <dig> cell lines have been subjected to extensive molecular characterization including mrna microarray  <cit> , microrna  <cit> , protein lysate arrays  <cit> , snp arrays  <cit> , and acgh analysis  <cit> . for these reasons, the nci- <dig> data set represents a tremendous research tool for exploring and benchmarking omics-type approaches to cancer classification and therapeutics.

cancers are widely believed to derive from a single event in which one cell escapes the many surveillance mechanisms in place to prevent uncontrolled proliferation. once this has occurred, the cancer often evolves quickly, rapidly acquiring large numbers of mutations, ranging from small point mutations to very large chromosomal aberrations and regional amplifications . the original identity of the cancer cell  appears to exert a very strong influence on the course of evolution of the cancer. for this reason, characteristic mutations will often be found in cancers derived from the same tissue, even in different patients. in addition, because identical cell types from different patients will share very similar gene expression signatures, cancers derived from these tissues will often do the same. in the present study we take advantage of these two features of cancer to test the ability of various statistical models to correctly infer the cell type  of each cancer cell line. the ability to make this inference correctly not only represents an excellent test of these models on real biological data, it is a good example of the type of classification ability required for targeted cancer therapeutics.

methods
nci- <dig> cancer cell-line dataset
in order to test the predictive models in this study we use publicly available data from the nci- <dig> cancer cell lines as provided by cellminer  <cit> . for the purpose of this study, we analyzed cancers with at least  <dig> representative cell lines derived from the same tissue-of-origin . these lines represent cancers emerging from eight tissues: breast, central nervous system, colon, leukemia, melanoma, non-small cell lung, ovarian, and renal cancers. the data types used in this study are gene expression  and protein lysate  arrays  <cit> , microrna  <cit> , snp arrays  <cit> , and array comparative genome hybridization   <cit> . all data has been normalized according to best practices for each assay platform prior to downloading for this study  <cit> . the specific cell lines and data files used in this study can be found in supplemental tables s <dig> and s <dig> 

feature selection methods
the area of feature selection in machine learning has recently been quite robust. there are numerous specialized feature selection algorithms which identify the most informative biomarkers from high-dimensional data. this study utilized at least one approach from each of the three broad categories identified above . every approach utilized allowed for a specific number of features to be chosen. no requirement was established that induced a relationship between feature sets from the same algorithm. so the  <dig> features chosen by one approach are not required to be a subset of the  <dig> features chosen by the same. for all algorithms we used the implementations in the scikit-learn  <cit>  python package, please refer to its associated documentation for specific implementation details.

the fastest and most simplistic selection method is univariate filtering. these approaches rank features according to some score, and the user selects the best k features accordingly. here the f-statistic , a generalization of the t-test, is used as a filter, as suggested in  <cit>  and  <cit> . there are no parameters for this feature selection method.

wrapper approaches typically use some type of greedy strategy to select influential features using a black box classifier. they are more computationally intensive, however svm recursive feature elimination  is extensively used in medical applications  <cit> . the parameters considered were the penalty parameter and loss function.

the final class of feature selection algorithms is embedded approaches where the features are chosen while building the classifier. to represent this class two tree-based methods were adapted; random forest   <cit>  and extra-trees   <cit> . the parameter considered was the number of trees used in each approach.

a summary of parameters of all considered feature selection methods along with the range of values searched for each parameter are given in supplemental table s <dig> 

classification methods
an exhaustive comparison of all classification algorithms would be quite challenging. therefore only a small number of approaches was explored, chosen to represent most common machine learning approaches used in bioinformatics. identifying the cancer type from the nci- <dig> dataset is inherently a multi-category classification problem. therefore each considered approach must accommodate this setting or be adaptable by one-vs-one  <cit>  or equivalent approaches. the types of algorithms tested fall into three main categories: linear, tree, and distance based methods. again we used the scikit-learn  <cit>  python implementations for all compared classification algorithms.

linear classifiers use a linear function to score classes by taking the dot product of feature values and feature weights computed during training. one of the most powerful, flexible and ubiquitous linear classifier is the support vector machine  with linear kernel  <cit> . svm has been utilized in numerous works describing predictive models with biological and medical significance. both the penalty and loss function parameters were explored. another powerful linear classifier is logistic regression   <cit> . the specific implementation uses one-vs-all to accommodate the multi-classification setting instead of the one-vs-one approach. the penalty function, and regularization parameters were explored.

classification trees are a machine learning tool which has found extensive use in the biological and medical communities. this is partially due to both their resilience to over-fitting and ease of interpretation. this work looks at three related approaches; vanilla decision trees   <cit> , random forest   <cit>  and gradient boosting   <cit> . decision trees represent class labels as leaves in the tree and branches are combinations of features that lead towards a leaf. vanilla decision trees can often over-complicate the explanation necessary to arrive at the appropriate class label, however their interpretation is very simple. random forest approach and gradient boosting are ensemble learning techniques where multiple trees are created and the final decision is some aggregate. these approaches are less-susceptible to over-fitting however they are often computationally intensive. the common parameter explored is the number of trees used and for gradient boosting the number of boosting stages.

distance based methods surveyed are k-nearest neighbors , cosine  and correlation . cosine and correlation are simple classifiers which calculate the distance to all training samples from the test sample and assigns the label based on the closest match. knn is a slightly more advanced version of the same concept in which class membership is assigned by majority voting among the k  closest matches.

a summary of parameters of all considered classification algorithms along with the range of values searched for each parameter are given in supplemental table s <dig> 

validation strategy
a common validation strategy used in evaluating machine-learning methods is k-fold cross-validation  <cit> . here the data is partitioned into k equal size subsets with each set used in turn for testing while the other k −  <dig> subsets are used as training data. care must be taken taken to avoid substantial biases  <cit>  by ensuring that feature selection is performed only on the data reserved for training. since the approach presented here is also parameterizing for each distinct model, nested k-fold cross-validation is used to tune parameter values. this requires an additional cross-validation experiment on each training dataset, where a grid-search over the considered parameter range is performed. the inner phase identifies the best parameter values which are then used exclusively in the outer cross-validation. in order to build stronger evidence for the models' performance, the outer cross-validation phase was repeated  <dig> times, however the parameterization was only performed in the first iteration. biases towards selecting more complex models with more parameters or overly fine grid-steps are still a possibility, however nested cross-validation should largely mitigate them. more advanced techniques presented in  <cit>  could be utilized in future iterations. an outline of the validation strategy can be seen in figure  <dig> 

the nested k-fold cross-validation strategy is computationally very intensive. with  <dig> ×  <dig> =  <dig> models  to evaluate, dozens of parameter values and different number of selected markers there can be upwards of  <dig> , <dig> individual classifier runs per data type. the majority of the jobs occur in the inner cross-validation loop, and fortunately can all be run in parallel on a cluster or multi-core server. also, a pre-filtering heuristic was applied to speed up the feature selection process. for all datasets with more than  <dig>  features we retained only the top  <dig>  features as ranked by the f-statistic prior to any additional feature selection.

to further validate the results on external datasets, eight primary tumor cohorts from the cancer genome atlas  were identified to match five nci- <dig> tissue-of-origin cell lines; central nervous system, colon, non-small cell lung, ovarian, and renal. the mapping of the tcga cohorts to the nci- <dig> cell lines can be found in supplemental table  <dig>  the tcga derived gene expression microarray data was obtained from the broad institute's gdac firehose utility  <cit> . the presented pipeline was used to select biomarkers, identify and train the most informative model using nci- <dig> data  <cit> . then its performance was tested using the tcga derived data.

metrics
there are numerous metrics used in evaluating the accuracy of a predictive model. one common metric is auc, or area under the receiver operating characteristic  curve. the roc curve is a plot of the true positive rate against the false positive rate. the auc is then the area under this curve and is used as a single measurement of classifier performance. this definition is typically for binary classification tasks, however there are several extensions to multiclass classification problems  <cit> . since the classes are equally represented in the nci- <dig> dataset this work utilizes the multiclass metric, auctotal= ∑ci∈caucci⋅pci, where auc is the typical binary classification auc for class ci and p is the prevalence in the data of class ci.

RESULTS
this study is evaluating the effect of three parameters simultaneously: the model, the data type and the number of markers. therefore conclusions about the best predictive model are presented from the perspective of each parameter individually. in figure  <dig> an overview of the auc for each model, data type and each number of markers is presented as a heatmap. the hotter entries represent higher auc.

model effects
the accuracy of the predictive models varies greatly, with the various combinations of feature selection and classification algorithms. if the feature selection and classification algorithms are grouped by class, a high-level ranking becomes much clearer. in figure  <dig> the relative ranking of each model is indicated by color for each data type at each number of features. the rfe-linear combination which uses svm-rfe for feature selection and logistic regression or svm for classification is the best performing model in almost all instances. close behind is ensembl-linear, where in table  <dig> it is clear that it performs only slightly worse than rfe-linear.

table of auc for top performing models for each data type and grouped by marker set size.

if the data type and number of features are fixed the effects of the models can be explored further. as seen in figure  <dig> the mrna and protein data types consistently afford the best classification accuracy at both high and low number of markers. although classifiers have relatively poor performance on snp data for  <dig> markers, as the number of selected biomarkers increases best performing classifiers based on snp data match or slightly outperform those based on gene and protein expression. the accuracy of all models is generally highest at a high number of markers. therefore mrna and snp at  <dig>  and  <dig>  markers were chosen to demonstrate model effects. surprisingly, the effect of classifier choice is small as seen in figure  <dig>  the models are grouped by feature selection algorithm. for rfe there is very little difference between all the classifiers except decision trees and gradient boosting which are consistently poor performers. the major differences appear between feature selection groups, where svm-rfe is the best, random forest and extra trees have equivalent performance, and anova is the worst.

this conclusion is contrary to that of  <cit> , where it was found that the t-test univariate filter  often performed the best for feature selection. this could be due to the differences in the underlying complexity of the question; namely in  <cit>  the goal was to predict metastatic relapse, which is a binary question, using gene expression microarrays. in addition, no parameter tuning using nested cv or similar approach was performed in  <cit> . although this study cannot prove that a particular feature selection or classification algorithm is best in a certain scenario, it does indicate that a thorough model selection step is advised.

the relatively small effect of classifier choice is interesting and unexpected. this indicates that much more care should be given to choosing the right features, as this has the biggest effect on model performance.

data type effects
the rich selection of data types available for these cell lines provides the opportunity to compare the ability of many types of biological data to classify the tissue of origin of a tumor cell line. some of these data types fundamentally reflect gene expression levels: mrna, protein and microrna. the other two: cnv and snp, are generally assumed to reflect genomic changes at large  and small  scales. comparisons of data type effects at all marker sizes are best seen in figure  <dig> 

the transition from normal tissue to cancerous tissue is generally associated with changes at the level of both gene expression and the genome. frequent mutations, genomic rearrangements and large scale changes in gene expression are all characteristic of oncogenic transformation. however, cancer cells also retain many, if not most, of the essential hallmarks of the tissue of origin of the cancer. in this study, we use the tissue of origin as the ground truth and measure the ability of each data type to correctly infer the tissue of origin of a sample based upon each data type.

a priori, we expect some of these data types to be better at this task than others. for instance, mrna profiles are highly distinct between different tissue types. for this reason, even after oncogenic transformation, an mrna transcriptional profile characteristic of the tissue of origin is expected to resemble that of the normal tissue, more than it would the transcriptional profile of tumors derived from other tissues. for this reason, we expect  that mrna transcriptional profiles reliably and accurately infer the tissue of origin of tumor cell lines. similarly, protein expression profiles are also very reliable indicators of the tissue of origin of a tumor. microrna profiles are less powerful than either mrna or protein expression profiles, but still fairly powerful indicators of tissue of origin. the relative weakness of microrna profiles compared to mrna and protein expression profiles may in part result from lower tissue specificity of microrna expression relative to mrna and protein.

the ability of genomic data to infer the tissue of origin of the tumor is subject to a very different set of biological constraints than expression data. while expression data is expected to be approximately identical across tissues regardless of patient identity, and thus similar between tumors derived from the same tissue but from different individuals; genomic data is identical across normal tissues in an individual, and differs between individuals. thus, at first glance, genomic data would be expected to track with the individual, and be a very poor predictor of the tissue of origin of a cancer. however, dramatic genomic alterations are a hallmark of cancer progression, and distinct genomic alterations are often found in distinct cancer types. accordingly, we find that copy number variation is about as powerful as microrna profiles at inferring the tissue of origin of a cancer cell. this is likely due to the preferential occurrence of specific dna rearrangements in cancers derived from specific cell types  <cit> . the snp arrays however, which measure the presence of specific alleles in a sample, show unexpectedly strong ability to infer the tissue of origin of these cancer cell lines. indeed, their performance is similar to that of the mrna and protein expression profiles . this was unexpected as snp's should be roughly identical across all tissues in an individual, and by and large, reflect an individual's ancestry. however, this phenomenon has been previously observed in the nci- <dig> data, and was found to result from the fact that intensity of signal on the snp array was actually reflecting snp copy number at duplicated loci, and thus indirectly measuring likely gene expression levels, rather than homogenization of genotypic diversity  <cit> . this effect was strongest for linked snps, and appears to be the result of local gene copy number amplification, which in turn enables increased gene expression. thus, the ability of snp arrays to accurately infer tissue of origin of cancer cell lines appears to result from increased gene expression driven by local duplication and increase in copy number. as the cgh arrays used to profile the nci- <dig> lines provide much lower genomic resolution than the snp arrays, they are less powerful at detecting and exploiting this effect. this unexpected behavior of the snp arrays used to characterize the nci- <dig> lines could be addressed by utilizing newer snp arrays that control for copy number such as the affymetrix snp <dig> platform.

number of marker effects
as one uses more biomarkers to classify samples, one expects increased performance, the possibility of overfitting, and the appearance of a plateau beyond which additional markers do not increase the power of classification. however, the rate at which these changes occur as more markers are used to classify a sample can be very different for various types of data.

our analysis shows that mrna, protein, and snp data all plateau at about the same auc .

however, each of these data types reaches the plateau at a different number of markers: mrna plateaus between  <dig> and  <dig> markers, while protein plateaus at around  <dig> markers, and snp does not reach the same auc until  <dig> markers are used. this may result from the fact that each of these markers appear to measuring aspects of gene expression, with decreasing directness  or coverage , and thus power of discrimination. the mrna arrays used to characterize the nci- <dig> cell lines provide direct assessment of the activity of thousands of protein-coding genes, while the protein arrays measure only somewhat more than  <dig> proteins. with thousands of potential markers to choose from, the mrna-based models can select informative markers from a larger marker pool, and thus maximize the performance of a gene expression-based model more quickly than the protein arrays, which are restricted to a small subset of the protein coding genes represented on the mrna arrays. the more direct nature of the protein measurement  does not appear to outweigh the disadvantage of the lower coverage in the starting set of protein markers. as discussed in the preceding section, the snp array appears to be measuring, in part, gene expression levels resulting from the amplification of specific regions of the genome in specific cancer types. however, there is likely to be a complex and possibly heterogeneous and non-linear relationship between signal intensity on the snp array, and gene expression levels. thus, despite the very large number of markers to choose from on the snp array, highly informative markers are not as abundant in this data as they appear to be in the mrna data. as a result, many more snp markers are required to achieve the same level of performance as mrna-based markers. it is hard to predict how the power of snps to infer cancer type might change when newer arrays, that control for copy number changes, are used to characterize these cell lines.

similarly, cnv and microrna markers approach the same level of performance as one another, but do so at different rates. while microrna markers plateau quickly  cnv markers require 64- <dig> markers to reach the same level of performance. the quick plateau of microrna-based markers is likely due to the highly tissue-specific expression of a minority of microrna's, and the more global expression of the remaining majority. once the few highly informative microrna's have been selected and used, adding more provides little additional classification power. in the case of cnv's, like snp's these markers reflect changes in the cancer cells genome that can lead to changes in gene expression that are distinctive features of cancer subtypes. however, not only do the cnv markers suffer from the indirect relationship between the marker and gene expression expected for snp's, they are also a much lower resolution marker than snp's , and far fewer cnv's were measured on the arrays, thus limiting the likelihood that the most informative cnv's were available for selection. thus, the power of the cnv biomarker panel climbs slowly.

taken together, these observations suggest that the absolute performance of a given biomarker data type to classify a cancer can be understood in the context of: the number of available markers for the model to choose from, the power of the most informative markers in the set, and the directness with which the data type reflects an informative aspect of the sample biology. data types with a large number of markers to choose from, that are closely related to the biology of the sample, are most likely to yield highly effective small biomarker panels. on another hand, data types with lower saturation , and/or a less direct relationship to the biological differences between samples, will require more markers to reach maximal performance.

combined model, data type, and number of marker effects
ultimately all parameters should be considered simultaneously when attempting to build the best targeted predictive model. in order to do this it is necessary to build a validation framework to explore all parameters fairly and efficiently. although it is a difficult task it is not impractical and interesting nuances can be extracted.

in this study it was observed that at the lowest number of markers  mrna and protein were the best data types for cancer identification. for mrna, snp and protein the svm-rfe was the best feature selection choice and et was the best classifier. for cnv and microrna the best classifier was lr and et respectively. interestingly for all data types at  <dig> markers except cnv a tree based classifier performed the best as seen in table  <dig>  it is possible that if only a few biomarkers are considered the tree based approaches explicit enumeration of decisions may be better suited, however it should be noted that the linear classifiers are typically only marginally worse.

at the highest number of markers tests  both rfe and et perform strongly on all data types, however lr is the best classifier for all types except snp where knn is the best. both of these classification tools are technically simple, yet they perform best which lends credence to the occam's razor principle which when applied to machine learning places preference on simpler explanations.

external validation
the amount of over-fitting when building a predictive model is always a concern. this effect was measured in an external validation experiment utilizing analogous gene expression microarray data obtained from several studies which are part of the tcga project  <cit> . the results of this comparison indicated that biomarker and model selection using auc as the ranking criteria is robust and performs well across studies. in table  <dig> it can be seen that colon , cns and renal  cancer types were distinguishable with a high degree of accuracy using between  <dig> and  <dig> markers. the cns type was more challenging to differentiate after  <dig> markers, while ovarian  and lung cancers  were extremely difficult to differentiate at any number of markers.

accuracy of the top performing model for each cancer type and grouped by marker set size.

the nci- <dig> data is derived from decades old cell lines, while the tcga data was derived from recently sampled primary solid tumors. additionally the matched cancer types did not have comparable histological classification. finally, there were three aditional cancer types  which were present in nci- <dig> but not included in the external validation set. these classes were included in the training. despite these differences the presented method was able to perform biomarker selection and build accurate predictive models for this challenging external validation experiment. a complete breakdown of the per-class prediction rate by cancer marker set size is provided in supplemental table  <dig> 

CONCLUSIONS
the initial hypothesis motivating this research was that certain predictive models will perform better on different data types at different dimensionalities. while this hypothesis holds, the difference in accuracy between models is often small and allows for several generalizations. namely that rfe is clearly the best feature selection algorithm and both svm and lr are the best classifiers as seen in figures  <dig> and  <dig>  both mrna and protein expression are the overall best performing data types for the cancer classification question. however to maximize predictive accuracy all models at all parameters should be parameterized and vetted fairly before conclusions are made.

list of abbreviations
nci- <dig>  national cancer institutes tumor cell line project; tcga. the cancer genome atlas; svm. support vector machine; dt. decision tree; rf. random forest; et. extra tree; gb. gradient boosting; knn. k-nearest neighbor; rfe. recursive feature elimination; lr. logistic regression; cos. cosine; cor. correlation; br. breast; cns. central nervous system; co. colon; lc. lung cancer; re. renal; ov. ovarian; me. melanoma; snp. single nucleotide polymorphism

competing interests
iim, cen, eh and jl are co-founders and own shares of smpl bio llc a for-profit business created to commercialize the application of the work presented here. smpl bio llc has not contributed financially to this publication. the university of connecticut has filed a patent application on work related to this publication.

authors' contributions
iim and cen conceived the study. eh, jl, and cl conducted the experiments. all the authors contributed valuable ideas to the study, drafted the manuscript, and were involved in manuscript revision. all authors have read and approved the final manuscript.

supplementary material
additional file 1
supplementary figures, methods, and tables are supplied in pdf format.

click here for file

 acknowledgements
this work was supported in part by awards 1r21hd071606-01a <dig> from nih, iis- <dig> from nsf, and agriculture and food research initiative competitive grant no. 2011-67016- <dig> from the usda national institute of food and agriculture.

declarations
publication costs for this work were funded by the corresponding authors' institution.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2014: selected articles from the 9th international symposium on bioinformatics research and applications : bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/15/s <dig> 
