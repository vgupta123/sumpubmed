BACKGROUND
ongoing advancements and cost reductions in biochemical technology are enabling acquisition of ever richer datasets. in many settings, in both basic biology and medical studies, it may be important to model the relationship between assayed molecular entities, such as genes, proteins or metabolites, and a biological response of interest.

molecular players may act in concert to influence biological response: this has motivated a need for multivariate methods capable of modelling such joint activity. when sample sizes are small-to-moderate, as is often the case in molecular studies, robust modelling of joint influences becomes especially challenging. however, often it is likely that only a small number of players are critical in influencing the response of interest. then, the challenge is to identify appropriate variable subsets.

statistical variable selection methods have been widely used in the bioinformatics domain to discover subsets of influential molecular predictors. both penalised likelihood and bayesian approaches have been used in a diverse range of applications
 <cit> .

bayesian approaches can facilitate the integration of ancillary information regarding variables under study through prior probability distributions. ongoing development of online tools and databases have meant that such information is widely available, and depending on context, may include networks and pathway maps, public gene expression datasets, molecular interaction databases, ontologies and so on. however, while the idea of incorporating such information into variable selection has a clear appeal, it is not always obvious what information should be included nor how it should be weighted. indeed, many existing bayesian variable selection approaches do not attempt integrative analyses exploiting such information and instead employ standard priors that do not specify preferences for particular variables, but may, for example, encode a preference for sparse models
 <cit> . several bayesian variable selection studies have put forward simple approaches for incorporating prior knowledge by independently assigning each variable a prior probability of being included in the model
 <cit> . however, subjectively setting such hyperparameters for each variable may be difficult. furthermore, prior independence may be a questionable assumption, since molecular variables are unlikely to influence a response independently of one another.

we develop a variable selection procedure in which an empirical bayes approach is used to objectively select between a choice of informative priors incorporating ancillary information  and also to objectively weight the contribution of the prior to the overall analysis. the work presented here is motivated by questions concerning the relationship between signalling proteins and drug response in human cancers. in the protein signalling setting  there is now much information available, both in the literature and in diverse online resources, concerning relevant pathways and networks. we therefore develop pathway- and network-based informative priors for this setting, applying the methods proposed to automatically select and weight the prior and thence carry out variable selection.

the relationship between response and predictors is modelled using a continuous, linear model with interaction terms. in this way we avoid data discretization  yet retain the ability to capture combinatorial interplay. we take advantage of biochemically-motivated sparsity constraints to permit exact inference, thereby avoiding the need for approximate approaches such as markov chain monte carlo . this enables the calculation of exact probability scores over which variables are likely to be influential. the overall procedure is computationally fast: empirical bayes analysis and subsequent calculation of posterior  probabilities for  <dig> predictors via full model averaging required only  <dig> minutes . moreover, the overall procedure we put forward is simple from the user perspective, requiring very few user-set parameters or mcmc convergence diagnostics.

the remainder of the paper is organised as follows. we begin below by defining notation and reviewing bayesian variable selection. we then describe methods, including empirical bayes analysis to objectively select and weight biologically informative prior information, pathway-based informative priors and exact inference. we illustrate our method on published single cell proteomic data
 <cit>  and on proteomic data and drug response from ongoing work in breast cancer. we also compare the proposed approach to alternative methods. we conclude with a discussion of our results, the merits and shortcomings of our work, and highlight directions for further work.

notation
let
y=y <dig> …,ynt∈rn be a vector of response values and
xi∈rp for
i∈ <dig> …,n be corresponding p-dimensional candidate predictors. xi  forms row i of the n × p predictor matrix x.

let
γ=γ <dig> …,γpt∈ <dig> p be a binary vector and
γ=∑jγj be the number of non-zeros in γ. then xγ is the
n×γ matrix obtained by removing from x those columns j for which γj =  <dig>  similarly, for a vector
a=a <dig> …,ap, aγ is obtained from a by removing components aj for which γj =  <dig> 

bayesian variable selection
bayesian linear model
consider the classical linear model y = xβ + ε, where
β=β <dig> …,βpt are regression coefficients and
ε∼n <dig> σ2i, where
n denotes a normal distrbution. in some settings it makes sense to assume that some of the regression coefficients can be set to zero, thereby removing the corresponding predictors from the model. variable selection addresses the question of which subset of predictors best models the response. an inclusion indicator vector
γ∈ <dig> p specifies which regression coefficients vanish. that is, predictor j is included in the model if and only if γj =  <dig>  we use γ  to denote both the inclusion indicator vector and the model it specifies. given model γ we have the reduced linear model 

  y=xγβγ+ε. 

we are interested in the posterior distribution over models p. from bayes’ rule we have 

  p∝pp 

where p is the marginal likelihood. p is a prior over models , and is the main focus of the present paper. the marginal likelihood is obtained by integrating out the regression parameters βγ and variance parameter σ <dig> and thereby automatically penalises complex models with many parameters. this penalisation occurs because a more complex model has a larger parameter space. this means that for more complex models, the integral that defines the marginal likelihood is over a greater number of dimensions, with prior mass spread over a larger space. this in turn results in a lower marginal likelihood score.

model selection and model averaging
the posterior distribution over models p can be used to find a single, maximum a posteriori  model,
γ^=argmaxγpγ|y,x. however, considering a single ‘best’ model may be misleading, especially in the small-sample setting where the posterior distribution is likely to be diffuse with several similarly high-scoring models. model averaging
 <cit>  can ameliorate such effects by averaging over the entire space of models to calculate posterior inclusion probabilities for each individual predictor, 

  p=∑γ:γj=1p. 

these inclusion probabilities are a measure of the importance of each individual predictor in determining the response.

evaluating the summation in equation  <dig> requires enumerating the entire posterior over models p. the model space Γ can be vast  even for moderate values of p . thus, markov chain monte carlo
 <cit>  is often used to sample from the posterior over models thereby providing asymptotically valid estimates of the inclusion probabilities
 <cit> . as outlined in methods below, we instead calculate exact inclusion probabilities; an approach rendered computationally viable through restricting the size of model space Γ. justifications for such a restriction and advantages and disadvantages of an exact approach are provided in the discussion below.

model prior
calculating the posterior distribution over models  requires specifying a prior over Γ, p. a common choice of prior assumes that the a priori inclusion probabilities are independent and have bernoulli distributed marginal distributions p with success parameter Π. this hyperparameter may be a user-defined constant or may itself have a beta prior
 <cit> . in the former case, small values are often chosen to promote parsimonious models
 <cit> .

these priors provide no information regarding specific predictors and do not utilise domain knowledge. employing predictor dependent hyperparameters Πj enables incorporation of prior knowledge that some predictors are more important than others. however, utilising such a prior may be difficult in practice due to the many hyperparameters that must be subjectively specified. we note also in this formulation, prior inclusion probabilities are still independent.

methods
we now describe the bayesian variable selection method used in the present work. we describe in turn, an extended linear model including interactions between predictors, exact computation of posterior inclusion probabilities, biologically informative model priors and empirical bayes learning of associated hyperparameters.

bayesian linear model with interaction terms
we extend the classical linear model in equation  <dig> above to enable combinatorial relationships between predictors and response to be captured. given model γ, response yi depends in a non-linear fashion on the included predictors xiγ whilst remaining linear in the regression parameters. in particular, the mean for yi is a linear combination of included predictors and all possible products of included predictors. for example, if
γ= <dig> with γ <dig> = γ <dig> =  <dig>  we have yi = xiγβγ + αxi3xi <dig> + εi. we extend the
n×γ predictor matrix xγ and regression coefficient vector βγ to include the interaction terms and coefficients respectively, and we denote the extended versions by
x¯γ and
β¯γ. all columns in
x¯γ are standardised to have zero mean and unit variance.

the likelihood now takes the form 

  p∼nx¯γβ¯γ,σ2i. 

we choose hierarchical parameter priors following smith and kohn
 <cit>  and nott and green
 <cit> , taking the prior for
β¯γ given γ and σ <dig> to be normal 

  p∼n <dig> nσ2x¯γtx¯γ− <dig> 

and the prior for σ <dig> to be
p∝σ− <dig>  integrating out the parameters results in the following closed form marginal likelihood, 

  p∝1+n−2γ−12×yty−nn+1ytx¯γx¯γtx¯γ−1x¯γty−n <dig>  

we note that, in contrast to the widely-used normal inverse-gamma prior
 <cit> , this formulation has no free hyperparameters and enjoys attractive invariance properties under rescaling
 <cit> .

exact posterior inclusion probabilities
we enforce a restriction on the number of predictors that are allowed to be included in the model. that is, we only allow γ with
γ≤dmax for some
dmax∈n. thus, instead of being exponential in p, the model space Γ has polynomial size of order
pdmax, thereby allowing explicit calculation of posterior inclusion probabilities via equation  <dig>  we take dmax =  <dig>  giving
Γ= <dig>  for the p =  <dig> predictors in the cancer drug response application below; the original size of Γ was of order  <dig> 

biologically informative model priors
we now turn our attention to the model prior p. in many molecular biology settings, there is much valuable information available which may be used to construct biologically informative model priors. this could be network and pathway structures, providing information on relationships between predictors, or information from publicly available datasets. however, it may not be obvious precisely how such information should be used and it is usually possible to encode several different, apparently plausible priors. we are therefore interested in investigating the question of how to choose between such priors.

suppose we have m priors to choose from, with each prior, indexed by
m∈ <dig> …,m, encoded by a function
fm: <dig> p→r which scores a proposed model γ  according to the prior information. following mukherjee et al. <cit> , we take the overall prior to be of the following form, 

  p∝expλfm 

where m is a hyperparameter  that selects amongst priors and λ is a hyperparameter controlling the overall strength of the prior.

we consider two simple pathway-based priors, capturing information regarding number of pathways and intra-pathway distances via functions f <dig> and f <dig> respectively. below we proceed to give details for each, making use of the following notation. we let
Εk⊆ <dig> …,p denote the set of proteins contained in pathway k,
k∈ <dig> …,k, and we let
Εkγ=γ∩Εk be the set of proteins that are both in model γ  and in pathway k. we note that a protein is both allowed to be a member of more than one pathway or to not be a member of any pathways. if there is no prior information available, the pathway-based priors reduce to a flat prior over model space. figure
 <dig> illustrates properties of the two prior components.

number of pathways 
the first pathway-based feature encodes the notion that predictors that are influential in determining response may belong to a small number of pathways or, in contrast, may be spread across many pathways. we encode such beliefs by a function f <dig> which counts the number of pathways represented in a model γ. specifically,
f1=max where kγ is the pathway count given by
minss for
s⊆ <dig> …,k satisfying 

  ⋃k=1kΕkγ=⋃k∈sΕkγ. 

this definition prevents the empty model being a priori most probable and avoids double counting , and this single pathway is selected to minimise the pathway count; see figure
1). if the strength parameter λ is negative, the prior increasingly penalises models as number of pathways increases, whereas a positive value results in a prior that prefers models representing many pathways.

intra-pathway distance 
the second feature we consider is that variables which jointly influence the response may either be close to each other in a network sense, or may in fact be far apart in the network. this is done by a function f <dig> which gives the average distance between pairs of proteins that are both in γ  and in the same pathway. specifically, the distance between two proteins j <dig> and j <dig>  denoted d, is the number of edges in the shortest  path between them. then, we define
f2=max where dγ is the average of all d with
j <dig> j2∈Εkγ for some k. in order for the distance to be defined for any two proteins in a pathway, we assume that the network topology for a pathway consists of a single connected component . we term a protein included in γ as a singleton if there are no other included proteins in the same pathway . for models that only contain singletons or the empty model we set dγ =  <dig>  the function f <dig> defined in this way satisfies a number of natural desiderata. it is agnostic to |γ| and to the pathway count kγ. also, it avoids double counting  once only) and is indifferent between models including only singletons and models with the smallest possible average distance of dγ =  <dig>  a negative strength parameter λ  results in a prior that penalises larger intra-pathway distances, whilst a positive value encourages larger distances.

empirical bayes
we set the prior source parameter m and strength parameter λ in an objective manner using empirical bayes
 <cit> . specifically, we maximise the following marginal likelihood, 

  p=epp=∑γpp. 

for a given choice of hyperparameters, the marginal likelihood can be calculated exactly by exploiting the model space restriction described above. the score is calculated for varying hyperparameters and those resulting in the largest score are used for variable selection.

prediction
given already observed data x,y, we can predict the expected value of new response y′  from new predictor data x′  by model averaging: 

  ey′|x′,x,y=∑γey′|x′,x,y,γp 

with 

  ey′|x′,x,y,γ=nn+1x¯γ′x¯γtx¯γ−1x¯γty 

and the model posterior p calculated via equations  <dig>   <dig> and  <dig> 

RESULTS
we first show an application of our proposed approach to synthetic response data generated from a published study of cell signalling, and then further illustrate the approach with an analysis of proteomic data and drug response from breast cancers.

synthetic response data
in ongoing studies, such as that presented below, truly objective performance comparisons may be challenging, since we usually do not know which molecules are truly influential in driving biological response. at the same time, in fully synthetic data it can be difficult to mimic realistic correlations between variables within a pathway or across a network. for this reason, we empirically assessed the methods proposed using published single-cell, phospho-proteomic data
 <cit>  with responses generated from that data. this preserved pathway-related correlation structure between predictors but permitted objective assessment. the dataset consists of  <dig> proteins and ntot =  <dig> samples. .

figure
 <dig> shows a network and pathway structure for the  <dig> proteins for use with the biologically informative priors of the type described above. the network structure was taken from sachs et al. <cit>  and reflects current knowledge of signalling interactions. the proteins were assigned into four pathways.
 <cit>  consisting of  <dig> proteins and  <dig> samples . network structure shown here is based on that given in sachs et al. <cit>  and reflects current knowledge of signalling interactions. proteins were divided into four pathways, denoted by node colours red, blue, green and yellow. the grey nodes are each members of all four pathways.
 <cit> ; ‘lasso’: lasso linear regression ; ‘li&li’: penalised-likelihood approach proposed by li and li
 <cit>  that also incorporates network information ; ‘corr’: absolute pearson correlations between each protein and response. area under the  roc curve  appears in parentheses.

we first considered two simulation models,
γ1* and
γ2*, each of which is a predictor subset consisting of three proteins; pip <dig>  erk1/ <dig>  p <dig> for simulation  <dig>  and raf, mek1/ <dig>  pka for simulation  <dig>  in each case, the three proteins were chosen to be favoured by a particular prior.
γ1* is favoured by the intra-pathway distance prior  with positive λ; the proteins included in
γ1* had a large average intra-pathway distance
= <dig> ) and incorporated a medium number of pathways
=1).
γ2* is favoured by either the number of pathways prior  with negative λ or the intra-pathway distance prior  with negative λ; the proteins included in
γ2* had both a small intra-pathway distance
=0) and incorporated a small number of pathways
=0). since, by construction, each model is favoured by a particular prior, we can test the ability of the empirical bayes approach to select appropriate hyperparameter values. response data y  were generated using a linear model with interaction terms ; y=a + bc + ε, where a,b,c are the three influential variables.

we are especially interested in the small-sample regime that is often of interest in molecular studies. we therefore subsampled  n= <dig> training data from the complete dataset , and assessed predictive ability on the remaining, held-out data .

subsampling was repeated to give  <dig>  training/test pairs, over which results are reported below. at each iteration, only small-sample training data was used for inference. the empirical bayes method was employed to set prior source and strength parameters , with
λ∈− <dig>  . posterior inclusion probabilities were then calculated as described above.

we assessed performance by comparing the true underlying model γ* to the model γτ obtained by thresholding posterior inclusion probabilities at level τ. for results from each small-sample dataset, a receiver operating characteristic  curve was constructed by plotting number of true positives
 against number of false positives
 for varying thresholds τ. figure
3a,b shows average roc curves over the  <dig>  iterations for simulation  <dig> and simulation  <dig>  together with the area under the roc curve . auc is a summary of the curve and provides a measure of variable selection accuracy, with higher scores indicating better performance. the score is normalised to take a value between  <dig> and  <dig>  our bayesian variable selection  method with empirical bayes and linear model with interaction terms  is compared with eight other approaches: 

 bvs with flat prior and linear model with interaction terms ;

 bvs with a prior that is incorrect with respect to the true, underlying model: intra-pathway distance prior  favouring small distances  for simulation  <dig> and large distances  for simulation  <dig> ;

 bvs with flat prior and linear model with no interaction terms ;

 bvs with a markov random field prior
 <cit>  and linear model with interaction terms ;

 penalised-likelihood lasso regression
 <cit>  using a linear model with no interaction terms ;

 penalised-likelihood lasso regression
 <cit>  using a linear model with pair-wise interaction terms ;

 a penalised-likelihood approach, proposed by li and li
 <cit> , based on the lasso and also incorporates network structure information ; and

 absolute correlation coefficients between each predictor and response .

markov random field priors have previously been used in bayesian variable selection to take network structure of predictors into account
 <cit> . a markov random field is an undirected graphical model g =  in which vertices v  represent variables  and edges e represent probabilistic relationships between them. let a =  be a binary symmetric matrix with ai,j =  <dig> if and only if edge ∈e. then, the markov random field prior is given by 

  p∝expλγtaγ. 

the strength parameter λ  is usually constrained to be non-negative, resulting in a prior that encourages selection of predictors whose neighbours in g are also included in the model. here, we do not enforce this constraint and also allow negative values for λ. negative values result in a prior that penalises models containing predictors that are neighbours in g. as with the proposed bayesian variable selection method, we use a linear model with interaction terms and set λ with empirical bayes. the graph structure g is obtained from the structure shown in figure
 <dig> by converting all directed edges to undirected edges.

lasso regression performs variable selection by placing an ℓ <dig> penalty on the regression coefficients. this has the effect of shrinking a subset of regression coefficients to exactly zero; the predictors with non-zero coefficients are taken as the inferred model. sparsity of the inferred model is controlled by a tuning parameter, which we set by 5-fold cross-validation. this method results in a single inferred model . however, a full roc curve can still be obtained by thresholding absolute regression coefficients.

the penalised-likelihood method proposed by li and li
 <cit>  combines a lasso penalty with an additional penalty term that incorporates predictor network structure. together, these penalties encourage sparse estimates for regression coefficients that are also ‘smooth’ over the network structure; that is, coefficients for neighbours in the network are encouraged to be similar. in terms of variable selection, the approach promotes models containing predictors that are neighbours in the graph. the two penalty terms each have their own tuning parameter, controlling sparsity and smoothness over the network respectively; we set these parameters by 5-fold cross-validation. 

we observe that, in both simulations, the automated empirical bayes analysis, with pathway-based priors, improves performance over the flat prior and provides substantial gains over an incorrect prior. the empirical bayes approach selected the correct prior in 85% of iterations for simulation  <dig> and 96% of iterations for simulation  <dig> . since the lasso regression method  does not incorporate prior information, it is unsurprising that it is also outperformed by the empirical bayes approach. hence, it is fairer to compare it to bayesian variable selection with a flat prior . in simulation  <dig> these regimes both show a similar performance with the lasso approach displaying some gains at small numbers of false positives. however, in simulation  <dig> the bayesian approach offers a clear improvement in performance over lasso regression . due to its inability to model combinatorial interplay, the linear model without interaction terms is outperformed by the linear model with interaction terms for both bayesian and lasso approaches.

in simulation  <dig>  the strength parameter for the markov random field prior was set to λ = − <dig> by empirical bayes in 86% of iterations, thereby correctly promoting models that do not contain predictors that are neighbours in the network. however, although the markov random field prior offers improvements over a flat prior, it is outperformed by the proposed pathway-based priors at small numbers of false negatives. this is due to the fact that our intra-pathway distance prior is able to promote models with large distances between predictors, whilst the markov random field prior can only penalise models that contain neighbours. the markov random field prior is in general less flexible because it considers neighbours rather than distances. intriguingly, in simulation  <dig>  λ >  <dig>  was only selected by empirical bayes in 41% of iterations. as a result, performance of the markov random field prior is inferior to a flat prior. we discuss this further in discussion below.

the penalised-likelihood approach proposed in
 <cit> , incorporating network information, performs poorly in both simulations, with similar performance compared to simply looking at correlations between predictors. whilst in simulation  <dig>  a clear improvement is observed over standard lasso regression , this is not the case in simulation  <dig>  this is because the approach promotes models containing predictors that are neighbours in the network, which reflects the true underlying model for simulation  <dig> only. the general poor performance of this approach is likely due to its inability to capture combinatorial interplay since it necessarily employs a linear model without interaction terms.

since the network-based penalised-likelihood approach
 <cit>  does not incorporate interaction terms we performed a third simulation to investigate its performance under a data-generating model without interaction terms. in particular, we used the same true underlying predictor subset as in simulation  <dig> , which contains predictors that are neighbours in the network, but generated data using a linear model without interaction terms; y = a + 2b + 3c + ε, where abc are the three influential variables. we note that each predictor in the data-generating model has a different magnitude of influence on the response . average roc curves are shown in figure
3c. comparisons are made to other approaches as described above, but all methods now use linear models without interaction terms. as in simulations  <dig> and  <dig> the bayesian variable selection approach with empirical bayes and pathway-based priors outperforms a flat prior and an incorrect prior, with empirical bayes selecting the correct prior in 99% of iterations . the bayesian approach with markov random field prior showed a similar performance to the proposed pathway-based priors . however, the approach of li and li
 <cit> , whilst now more competitive compared with simulation  <dig>  is still outperformed by the empirical bayes approach with pathway-based priors. moreover, it does not display a clear improvement over lasso regression.

predictions using small-sample training data  and held-out test data  for simulations  <dig>   <dig> and  <dig>  results shown are mean absolute predictive errors ± sem for the following methods: bayesian variable selection  with biologically informative pathway-based prior with source and strength parameters set by empirical bayes, bvs with flat prior, bvs with ‘incorrect’ prior , bvs with a markov random field  prior, lasso regression, penalised-likelihood approach proposed by li and li
 <cit> , and a baseline linear regression without interaction terms including all  <dig> predictors. for bvs, predictions made using the posterior predictive distribution with exact model averaging  and using the maximum a posteriori model .

‡  linear model with interaction terms for simulations  <dig> and  <dig>  and without interaction terms for simulation  <dig> 

the failure of the incorrect prior illustrates the importance of prior elicitation. moreover, our results demonstrate that the proposed empirical bayes approach can select a suitable prior automatically, even under very small sample conditions . if the data is not in agreement with a proposed prior, then it is desirable that λ =  <dig> is selected by empirical bayes, resulting in a flat prior. to test this, we used the model in simulation  <dig> with a prior that favoured models with predictors from many pathways . this prior does not reflect the true, underlying model, which contains a small number of pathways. empirical bayes analysis successfully selected λ =  <dig> in 95% of iterations.

for each dataset, we used the posterior predictive distribution  to predict responses for held-out test data. mean absolute predictive errors, obtained by averaging over all  <dig>  train/test iterations, are shown in table
 <dig> . the empirical bayes approach with pathway-based priors shows improvements in predictive accuracy over a flat prior, and substantial improvements over both the ‘incorrect’ prior and a baseline linear model without interaction terms including all  <dig> predictors . it also outperforms the markov random field prior in simulations  <dig> and  <dig>  and outperforms lasso regression in simulation  <dig>  in simulations  <dig> and  <dig>  lasso regression offers the best predictive performance . in simulation  <dig>  the best predictive accuracy is provided by the markov random field prior. the penalised regression approach proposed in
 <cit>  has very poor predictive performance across all simulations, inferior to the baseline linear model. we also found that model averaging provided gains relative to prediction using the map model , with a 5%, 7% and 3% decrease in error on average for simulations 1- <dig> respectively .
 <dig>  for the empirical bayes approach, were obtained by exact model averaging with the number of predictors included in a model restricted to not exceed dmax =  <dig>  posterior inclusion probabilities for  <dig> simulated datasets from simulation  <dig> were compared with results obtained by exact model averaging with an increased maximum number of included predictors of dmax =  <dig>  and using markov chain monte carlo-based model averaging with no sparsity restriction . sensitivity to the range of prior strength parameter values considered by empirical bayes was also assessed by comparing the posterior inclusion probabilities obtained with
λ∈− <dig>  to those obtained with an increased range of
λ∈− <dig> .
cellsignal.com. square nodes represent fully connected subnetworks consisting of iso-forms and phospho-forms of the named protein . node colouring represents pathway structure. red, blue, yellow, green and purple nodes denote  <dig> pathways. orange nodes are in both the red and yellow pathways. light grey nodes are in all  <dig> pathways. dark grey node is in all pathways except the purple pathway. white nodes are not assigned to a pathway.

the only user-set parameters in the proposed method are dmax , and the range of values for the prior strength parameter λ to optimise over in empirical bayes. we sought to check the sensitivity of our results to these parameters. as described in ‘methods’ above, we set dmax =  <dig> and considered
λ∈− <dig> . we compared the posterior inclusion probabilities inferred from  <dig> iterations of simulation  <dig> to those obtained using  an increased maximum number of included predictors of dmax = 5;  markov chain monte carlo-based  inference with no restriction on number of included predictors, and  an increased range for the prior strength
λ∈− <dig>  . we found very close agreement in all cases, indicating that results reported do not depend on the sparsity restriction or the chosen range for λ.

in simulation  <dig> and simulation  <dig>  the smallest value of λ = − <dig> was selected by empirical bayes in a majority of iterations. the true, underlying model has the minimum possible number of pathways and intra-pathway distance. hence, the strong  prior strength is appropriate because it causes the prior to heavily penalise any model not satisfying these minima. under the increased range for λ, the smallest value  was still selected in these iterations, but results were almost identical . this indicates that the prior was already having close to maximal influence at the lower value of λ = − <dig> 

cancer drug response data
aberrant signalling is heavily implicated in almost every aspect of cancer biology
 <cit>  and, as a result, signalling proteins are targets for many emerging cancer therapies. here, we apply the methods proposed to probing phospho-proteomic influences on response to an anti-cancer agent triciribine.

phospho-protein abundance was assayed in a high-throughput manner using the kinetworkstm system , for p =  <dig> proteins related to epidermal growth factor receptor  signalling, in each of n =  <dig> breast cancer cell lines . the egfr signalling network plays a central role in breast cancer biology
 <cit>  and the cell lines used have previously been shown to retain much of the biological heterogeneity of primary tumours
 <cit> . gi <dig>  was used to quantify response to triciribine for each of the  <dig> cell lines
 <cit> . gi <dig> is the concentration that causes 50% growth inhibition compared to a baseline. a network  was constructed using
http://cellsignal.com .

figure
 <dig> shows marginal likelihood scores arising from empirical bayes. this selects the intra-pathway distance prior  with hyperparameter λ =  <dig> . due to the small sample size, we tested robustness of this choice by running empirical bayes with each data sample removed. the same prior was selected in 86% of the iterations.
6),  flat prior and  "incorrect" biologically informative prior that is not optimal according to empirical bayes analysis , λ = −5). posterior inclusion probabilities provide a measure of how influential each protein is in determining drug response. proteins contained in the single map model are shaded red.

predictions using leave-one-out-cross-validation . results shown are mean absolute predictive errors ± sem for the following methods: bayesian variable selection  with biologically informative pathway-based prior with source and strength parameters set by empirical bayes, bvs with flat prior, bvs with ‘incorrect’ prior , bvs with a markov random field  prior, lasso regression, penalised-likelihood approach proposed by li and li
 <cit> , and a baseline linear regression without interaction terms including all  <dig> predictors. ‘+int’ denotes linear model with interaction terms. for bvs, predictions made using the posterior predictive distribution with exact model averaging  and using the maximum a posteriori model .

figure
 <dig> shows posterior inclusion probabilities obtained under three prior regimes: empirical bayes , flat prior and an "incorrect" prior that is not optimal according to the empirical bayes analysis . phospho-ir and phospho-rb stand out in the empirical bayes analysis. triciribine targets akt, which inhibits apoptotic processes and is heavily implicated in cancer signalling
 <cit> . ir  is a tyrosine kinase receptor, known to stimulate the akt pathway
 <cit> , and it has been suggested that the rb/e2f pathway, which is also known to play a role in cancer
 <cit> , has an effect on akt activity via transcriptional regulation
 <cit> . hence, the salience of ir and rb accords with known biology and drug mechanism. the map model for each prior regime is highlighted in red in figure
 <dig>  we note that these models do not always contain the proteins with highest inclusion probabilities.

we performed leave-one-out-cross-validation , making predictions for the held-out test sample using both posterior model averaging  and the map model . the full variable selection approach, including selection of hyperparameters with empirical bayes, was carried out at each cross-validation iteration. table
 <dig> shows mean absolute predictive errors, with comparisons made as in the synthetic response data study above. for the ‘incorrect’ prior, the prior source parameter not selected by empirical bayes was used, along with the optimal strength parameter λ  for that prior. mirroring the synthetic data results , we observe that prior elicitation with empirical bayes provides an increase in mean predictive accuracy over a flat prior, an ‘incorrect’ prior, the markov random field prior and the approach proposed by li and li
 <cit> , whilst lasso regression has lowest mean predictive error. we note, however, that due to the very small sample size, differences in mean predictive error between these regimes are not conclusive. yet, they all show an improvement over the baseline linear approach, and model averaging results in an average 26% decrease in predictive error over using map models. the prior strength parameter for the markov random field prior was set to λ = − <dig> by empirical bayes in every cross-validation iteration .

we again checked sensitivity of results to the restriction on the number of predictors included in a model, dmax =  <dig>  the results in figure
 <dig> were compared with those obtained using an increased maximum number of included predictors of dmax =  <dig> and using mcmc-based inference with no such restriction . the strong agreement between dmax =  <dig> and dmax =  <dig> suggests that the minor differences observed between dmax =  <dig> and mcmc are a result of inherent monte carlo error. we also see a close agreement between results in figure
7a  and those obtained by optimising over the increased range of
λ∈− <dig>  . this shows that results reported do not depend on the sparsity restriction or the range of values considered for the prior strength parameter.
 <dig> were obtained by exact model averaging with the number of predictors included in a model restricted to not exceed dmax =  <dig>  these results were compared with results obtained by exact model averaging with an increased maximum number of included predictors of dmax =  <dig>  and using markov chain monte carlo-based model averaging with no sparsity restriction .

computation times  for proposed bayesian variable selection procedure, using empirical bayes to select between two priors  and to set the prior strength parameter λ  . results shown for varying values of dmax  and p , for both a linear model without interaction terms and a linear model with interaction terms.  regime where the procedure failed due to insufficient memory).

discussion
model priors incorporating biological information can play an important role in variable selection, especially at the small sample sizes characteristic of molecular studies. in applications where there are multiple sources of prior information, or multiple possible prior specifications, the empirical bayes approach we put forward permits objective selection and weighting. this aids prior elicitation and guards against the use of mis-specified priors. we demonstrated that a biologically informative prior, with hyperparameters set by empirical bayes, can have benefits over both a flat prior and a subjectively formed prior which is incorrect with respect to the underlying system. we also observed that, whilst lasso regression can offer some improvement in predictive performance over the bayesian approaches, its accuracy in selecting the correct underlying model  can be inferior to the proposed empirical bayes approach, thereby affecting interpretability of results. empirical bayes approaches have previously been used in variable selection, but with standard bernoulli-distributed priors
 <cit> .

we developed informative priors in the context of protein signalling based on two high-level features derived from network information: the number of pathways a subset of predictors incorporates and the intra-pathway distance between proteins in a proposed model. this formulation used the entire network structure in an intuitive way, removing the the need to specify individual prior probabilities for each variable and avoiding assumptions of prior independence between variables.

our pathway-based priors form part of a growing literature on exploiting existing domain knowledge to aid inference, especially in the small sample setting. for example, recent variable selection studies also make use of graph structure within a bayesian markov random field prior
 <cit>  and within a non-bayesian framework
 <cit> , essentially preferring models containing predictors that are neighbours in the graph. this is similar in spirit to the special case of our prior where the network consists of a single pathway and short intra-pathway distances are strongly preferred.

we compared our pathway-based priors to the markov random field prior, but found in simulation  <dig> that empirical bayes frequently set the prior strength parameter to an incorrect value, resulting in a prior that penalises models containing predictors that are neighbours in the network, instead of promoting them. this is likely due to the parameterisation of the markov random field prior, which is not agnostic to the number of included predictors in the model |γ|; addition of a predictor to a model could lead to a substantial increase in the prior score. indeed, it has previously been noted that markov random field priors can be unstable with the occurance of phase transitions in |γ|
 <cit> . hence, the prior prefers less sparse models, but these models do not agree well with the data, as more complex models are penalised by the marginal likelihood. in contrast, our distance prior is based on an average distance measure and so is somewhat indifferent to |γ|. in simulation  <dig>  we do not observe this behaviour of the markov random field prior; since the linear model does not include interaction terms, the model complexity does not increase as sharply with |γ| and so there is less disagreement between the prior and the marginal likelihood. we note that biologically informative priors have also been used for classification
 <cit>  and network inference
 <cit> .

we also compared our approach to the network-based penalised-likelihood method proposed by li and li
 <cit> . it performed poorly in simulations  <dig> and  <dig>  primarily due to its inability to capture nonlinear interplay. however, even in simulation  <dig>  with no interaction terms in the data-generating model, it failed to match the performance of our proposed empirical bayes approach with pathway-based priors. this could be due to lack of similarity between the regression coefficients in the data-generating model, which goes against an assumption of the penalised-likelihood approach; that coefficients are similar for predictors that are neighbours in the network. this could also explain its poor predictive performance.

we used a continuous regression framework with interaction terms. whilst discrete models are naturally capable of capturing non-linear interplay between components, the discretisation process results in a loss of information. continuous models avoid this loss, but the response is usually assumed to depend linearly on predictors. the product terms in our model provide the possibility of capturing influences on the response of interest by interplay between predictors, including higher-order interactions. chipman
 <cit>  and jensen et al. <cit>  have employed a related approach allowing pairwise interactions only. we note that, under our formulation, model complexity grows rapidly with number of included predictors. however, complex models are naturally penalised by the marginal likelihood formulation giving overall sparse, parsimonious models, yet allowing for complex interplay via product terms.

we carried out variable selection using exact model averaging. this was made possible by means of a sparsity restriction. sparsity constraints have been employed in previous work in bayesian variable selection
 <cit>  and also in the related setting of inference of gene regulatory networks
 <cit> . the sparsity-constrained approach proposed is attractive as it yields exact posterior probabilities and facilitates exact empirical bayes analysis. sparsity is a reasonable assumption in settings where it is likely that only a few predictors play a key role in influencing a response. in such settings, and where data is of small-to-moderate dimensionality, our exact approach is fast and deterministic with no requirement of mcmc convergence diagnostics. this, together with empirical bayes and the choice of parameter priors, results in the overall approach having very few user-set parameters.

in applications of higher dimensionality, where the exact calculation is no longer feasible, empirical bayes can still be performed using an approximate conditional marginal ‘likelihood’ approach as seen in george and foster
 <cit>  and yuan and lin
 <cit> . this involves optimisation over the model space instead of averaging. mcmc, with the selected hyperparameter values, can then be used to estimate inclusion probabilities. alternatively, a fully bayes mcmc approach could be taken, which places a prior on the hyperparameters and integrates them out .

illustrative computational times for our approach are shown in table
 <dig>  for four values of p  and four values of dmax. we also considered linear models with and without interaction terms. empirical bayes was used to select between two priors  and to set the prior strength parameter . the computation time scales as
dmaxpdmax for the model without interaction terms and
pdmax for the model with interaction terms. we see that the approach is fast on datasets of moderate dimensionality  with dmax =  <dig>  we note that shortage of memory was the limiting factor on our machine. computational time could also be improved by using multiple cores to calculate empirical bayes marginal likelihood scores for multiple values of λsimultaneously.

we showed examples of automated selection between multiple sources of ancillary information, but, rather than selecting a single source, the methods proposed could be generalised to allow combinations of complementary information sources as seen in jensen et al. <cit> . whilst our priors were based on pathway and network structure, the methods can also permit integration and weighting of publicly available data, which while plentiful, can be of uncertain relevance to a given study.

CONCLUSIONS
in this paper we have proposed an empirical bayes method for objective selection and weighting of biologically informative prior information for integration within bayesian variable selection. the method is computationally efficient, exact and has very few user-set parameters. we developed informative pathway-based priors in the context of protein signalling and illustrated our method on synthetic repsonse data. we demonstrated that in situations where there are several plausible formulations for the prior, it is capable of selecting the most appropriate. in particular, the approach has potential to significantly improve results by guarding against mis-specification of priors. comparisons were made to alternative methods, demonstrating that the proposed approach offers a competitive variable selection performance. we have also shown an application on cancer drug response data and obtained biologically plausible results. our method is general and can be applied in any setting with multiple sources of prior knowledge.

competing interests
the authors declare that they have no competing interests.

authors contributions
smh designed the priors, carried out all computational analyses and wrote the paper. sm conceived the study, provided feedback on all aspects and revised the manuscript. rmn and nb carried out the cell line assays. wlk and sz carried out the drug response assays. pts and jwg led the biological aspects of the work and provided feedback. all authors read and approved the final manuscript.

supplementary material
addtional file 1
cancer drug response application. tables of proteins and cell lines included in the analysis, further details of the experimental procedure and figure s <dig> 

click here for file

 acknowledgements
this work was supported by the director, office of science, office of basic energy sciences, of the u.s. department of energy under contract no. de-ac02-05ch <dig>  by the national institutes of health, national cancer institute grants u <dig> ca  <dig> and p <dig> ca  <dig> to jwg, and the cancer systems biology center grant from the netherlands organisation for scientific research. smh and sm were supported under epsrc ep/e501311/ <dig> 
