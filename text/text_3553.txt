BACKGROUND
dna microarrays are a powerful means of monitoring the expression of thousands of genes simultaneously. a variety of computational and statistical methods have been proposed to extract information from the large quantity of data generated from microarray experiments. many methods assume, as we do here, the use of cdna labeled with one of two fluorescent dyes to differentiate two treatments on a single microarray, implying data from two images to be analyzed. these methods include a number of data normalization techniques to reduce the effects of systematic errors and various kinds of statistical tests to identify differentially expressed genes in comparisons among different experimental conditions. there is as yet no single method that can be recommended under all circumstances for either normalization or identification of differential gene expression.

in recent years, anova methods have gained popularity for identification of differential gene expression. the power of anova methods derives from their flexibility in fitting and comparing different models to a given set of data  <cit> . one such method is the two-stage, log-linear anova mixed models technique of wolfinger, et al.,  <cit> . its first stage uses a normalization model designed to remove global effects across all microarrays. its second stage uses a gene-specific model to estimate gene-treatment interactions as ratios of gene expression under control and treated conditions, along with a statistical significance. kerr  <cit>  notes that the global normalization model employed in this technique is conducive to combining data across genes for realistic and robust models of error, especially when random effects are included. pan  <cit>  compares different microarray statistical analysis methods and demonstrates that the log-linear anova mixed model approach performs better than the t-test and regression approaches. the regression approach, although flexible and robust, assumes that the data is drawn from a normal distribution, while the t-test is limited due to very few degrees of freedom. chu, et al.,  <cit>  compare two log-linear anova mixed models for probe-level, oligonucleotide array data and found that both types of models capture key measurable sources of variability of oligonucleotide arrays for real and simulated data. cui and churchill  <cit>  review the use of a mixed anova model for analyzing a cdna microarray experiment and conclude that such models provide a powerful way to obtain information from experiments with multiple factors or sources of variation. rosa, et al.,  <cit>  review issues of analyzing cdna microarrays with mixed linear models and puts such analysis in the larger context of bayesian analysis procedures and adjustments for multiple testing.

data normalization is the first step in analyzing microarray data; numerous data normalization methods have been proposed and investigated. while refinements of existing methods continue to appear , naive methods, such as total intensity normalization, are still in use . xie, et al.,  <cit>  did a comparative study of normalization methods and test statistics to analyze the results of a dna-protein binding microarray experiment. using performance and bias correction criteria, bolstad, et al.,  <cit>  evaluate the cyclic lowess method, the contrast method, the quantile method, and baseline array scaling methods, both linear and non-linear; they demonstrate that normalization methods incorporating data from all microarrays perform better than methods employing a baseline array.

several software tools that combine data normalization and statistical analysis are currently available. dudoit, et al.,  <cit>  review these software tools with an emphasis on the tm <dig> microarray software suite, bioconductor in r, and the bioarray software environment  system. saeed, et al.,  <cit>  describe the features and capabilities of tm <dig>  while quackenbush  <cit>  describes the normalization and transformation methods implemented in it. williams, et al.,  <cit> , zhu, et al.,  <cit> , and khaitovich, et al.,  <cit>  have used tm <dig> in microarray data analysis. another system is expresso, an experiment management system that serves as a unifying framework to study data driven applications such as microarray experiments  <cit> . expresso has adapted the two-stage anova mixed models technique of wolfinger, et al.,  <cit>  to the particular needs of individual microarray data sets. our experience with numerous such data sets has demonstrated that modeling the underlying experiment carefully and completely is essential to obtaining meaningful and defensible results. use of tools that require experiments to conform to their analysis methods are less than satisfactory.

in this paper, we compare the expresso analysis methodology to the approach provided in the tm <dig> microarray analysis software suite  <cit> . each is invoked to identify differentially expressed genes in two experimental data sets, each of which uses an arabidopsis thaliana oligonucleotide array. along the way, we demonstrate differences between the use of integrated intensity values  and median intensity values  as inputs. we report interactions between normalization and gene identification methods. we use quantitative reverse-transcriptase pcr  results to assess the consistency of genes reported by tm <dig> and expresso as having significant differential expression.

RESULTS
here, we report a portion of the results obtained in our comparison of expresso analysis and the tm <dig> pipeline . figure  <dig> illustrates the overall flow of the statistical analyses of microarray data that were done in this study. we began with microarray data in gpr format from experiment  <dig> and experiment  <dig>  median intensity values  from the gpr files can be analyzed by the expresso gp and got models directly. expressconverter provides integrated intensity values  for further expresso and tm <dig> analysis. the midas normalization and filtering pipeline executes these steps in order: total intensity normalization , lowess normalization , standard deviation regularization , and low intensity filter . midas allows tapping the output of any step in the pipeline; for example, iivtl signifies an mev file after total intensity normalization followed by lowess normalization. the identification of genes with significant differential expression was performed on all gpr and mev files, using the expresso gp and got models and the t-test in mev.

normalization and low intensity filtering in tm4
quackenbush  <cit>  describes the use of ratio-intensity plots  to detect and normalize for any systematic intensity-dependent dye bias using lowess normalization . we evaluated the effect of lowess normalization within the context of the flow in figure  <dig> by creating ri-plots after each step for the second replicate microarray in experiment  <dig>  wt plant. supplementary figure  <dig> - see additional file:  <dig> contains these ri-plots. the iivtl is indeed effective, for this data set, in correcting systematic dye bias, suggesting that preprocessing by these two normalization steps in midas may be a good practice in many situations.

the normalization and filtering pipeline affects the number of genes identified as differentially expressed in both the gp and got models. see table  <dig>  for example, in experiment  <dig>  the gp model using iiv input data identifies  <dig> up-expressed genes in the wt microarrays, while it identifies only  <dig> wt genes as up-expressed if iivtlsf  input data is used.

small changes in the number of genes identified as up- or down-expressed after successive midas steps may mask larger changes in the composition of sets of up- and down-expressed genes. to obtain a more precise view of the effects of midas changes, we computed retention counts  and retention percentages  between the gene successive sets whose numbers are in table  <dig>  rc is the number of genes in the set before the midas step that remain in the set after the step. rp is the percentage of remaining genes with respect to the number of genes in the set after the midas step. table  <dig> contains the rc and rp values corresponding to the counts in table  <dig>  for experiment  <dig>  there is a tremendous drop in retention during the lowess normalization that follows the total intensity normalization. there is not a drop of corresponding magnitude for experiment  <dig>  for both experiments, normalization has a significant effect on the sets of genes identified as differentially expressed.

in experiment  <dig> results, the number of genes commonly assessed by expresso as significantly expressed when using iiv and iivt is high. for example, there is  <dig> % retention of wt genes  assessed as up-expressed when using iivt data in expresso compared to that when using iiv data. retention percentage of these genes assessed as expressed however went down after doing lowess normalization. there is only  <dig> % retention of wt genes  assessed as up-expressed in the results when using iivts data in expresso compared to when using iivt. while we observe increase in the retention percentage in iivtls  and iivtlsf , there's low retention percentage in the results using iivtlsf from iiv data. this can be traced in the low retention percentage of iivtl from iivt. hence, the normalization method that affects the results in experiment  <dig> the most is lowess normalization.

the results of expresso on experiment  <dig> show that low retention percentages happen after appli-cation of total intensity normalization  and after application of low intensity filtering . the low retention percentages shown in the iiv âˆ© iivtlsf column implies that the normalization pipeline also significantly affects the results in expresso analysis of experiment  <dig> 

choice of intensity signal data
the input to statistical analysis of microarray experiments is a set of real numbers that represent the measured intensity signal for each spot in a microarray. much statistical analysis of microarray data has traditionally used median intensity values . the alternative used in tm <dig> is the integrated intensity value .  since iiv is intended to integrate the measured intensity across the biological sample printed at a spot, one might expect iiv to be a more accurate assessment of the biological measurement than miv data. for example, a spot having  <dig> pixels and a median intensity of  <dig>  has the same iiv as a spot having  <dig> pixels and a median intensity of  <dig> .

this study provides the opportunity to observe the difference that choosing miv or iiv makes on the sets of genes ultimately identified as differentially expressed. we used the gp model to analyze unnormalized miv and iiv data from experiment  <dig>  and we used the got model to analyze unnormalized miv and iiv data from experiment  <dig>  table  <dig> reports a summary of the results. in experiment  <dig>   <dig> wt genes are assessed as up-expressed and  <dig> wt genes are down-expressed when miv data are used in expresso. these numbers decreased to  <dig> up-expressed genes and  <dig> down-expressed genes when iiv data are used instead. a similar trend is observed in experiment  <dig> results when using miv and iiv data. these results suggest that employing iiv input data with expresso analysis leads to more conservative results than employing miv input data.

comparison of statistical methods
we compared the performance of the gp model, the got model, and the t-test of mev in identifying differentially expressed genes in experiment  <dig>  we used the iivtlsf data of experiment  <dig> as input to these methods. we also contrast these results with miv data analyzed in gp. table  <dig> reports counts for these analyses.

the plot in figure 2a demonstrates that the estimates of iog <dig> are the same in gp and got. as figure 2b shows, the p values by got are smaller compared to the p values calculated by gp. use of the mev t-test resulted in fewer genes assessed as significantly expressed when compared to the numbers for the gp model. the results obtained when miv data was used as input to gp, is closest to the results when using iivtlsf.

to compare the effectiveness of expresso and tm <dig> in identifying gene differential expression, we compared the identified direction of differential expression of a select set of genes per genotype in experiment  <dig> with results obtained by qrt-pcr. see table  <dig>  the lowest overall percentage  of agreement is between the qrt-pcr results and the mev t-test results using iivtlsf. the log estimates of the gp model has  <dig> % percentage agreement with the qrt-pcr results, which is slightly higher than the percentage for the mev t-test. the results of the gp model using miv data demonstrated the greatest agreement,  <dig> %, with the qrt-pcr results.

figures  <dig>   <dig>  and  <dig> present the actual assessed iog <dig> values for  <dig> selected col- <dig> genes in experiment  <dig>  along with their qrt-pcr values. these are the  <dig> col- <dig> genes, among the  <dig> with qrt-pcr values, for which we have expression values for all methods. for each gene, a histogram of the iog <dig> estimates of qrt-pcr, the gp model using miv, the gp model using iivtlsf, and the mev t-test is given. the  <dig> histograms are spread over three figures to enhance readability and are in increasing order by qrt-pcr estimated change. in general, the log <dig> estimates of the gp model and of the mev t-test, all iivtlsf input data, are approximately the same, while being slightly different from estimates of the gp model using miv input data. as might be expected, disagreement between qrt-pcr and microarray results are more prevalent for small estimated log <dig> values. the histograms for genes at4g <dig> , at1g <dig> , and at3g <dig>  show that the direction of log estimate of qrt-pcr matches the direction of the gp model using miv input data, while differing from the direction of the estimates of the gp model and the mev t-test using iivtlsf input data.

CONCLUSIONS
our integration and comparison of expresso analysis and the capabilities of tm <dig> has highlighted successes in microarray analysis, some similarities, and some differences. the success of microarray analysis is demonstrated by considerable agreement between qrt-pcr results and the results of all the examined microarray analysis methods. the greatest agreement was found when median intensity value  inputs were analyzed with the expresso gp analysis model. we also found that the use of integrated intensity value  inputs for expresso analysis consistently resulted in fewer genes identified as differentially expressed when compared to results from miv inputs. this suggests that the use of iiv inputs is more conservative than the use of miv inputs, while miv inputs may give greater agreement to qrt-pcr results than iiv inputs.

our results demonstrate that the midas normalization and filtering pipeline corrects systematic intensity-dependent dye bias on a per microarray basis. the normalization stage in expresso analysis removes global effects across all microarrays and complements the per microarray normalization methods of midas. the generally better agreement of expresso analysis with qrt-pcr results when compared to the mev t-test suggests that it would be desirable for mev to have an anova test that has the greater flexibility of the expresso gene model.

