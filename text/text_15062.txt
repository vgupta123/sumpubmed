BACKGROUND
many proteins carry over their function by interacting with small molecule ligands. these include enzyme cofactors, metabolites and chemical messengers such as hormones. moreover the vast majority of drugs are in fact small molecules that bind to a target protein thus modulating its function. therefore the identification of a ligand binding site can give indication about the molecular function of a protein, even though the relationship between the molecular and biological function, i.e. the role of a protein in the context of a cellular process, is not straightforward.

the task of predicting a binding site for a specific ligand can be divided in two steps: i) the identification of an appropriate cavity in the structure, ii) the prediction of which molecule can fit in said cavity. the latter task, which can be broadly identified with molecular docking, is extremely demanding from a computational point of view. therefore the first step is almost always necessary in order to limit the search space of a molecular docking experiment.

accordingly a variety of algorithms have been developed to identify ligand binding pockets in protein structures  <cit> . the available methods use geometric criteria, energy functions or a combination of both.

geometric approaches, such as surfnet  <cit> , ligsitecsc  <cit> , concavity  <cit> , apropos  <cit>  and depth  <cit>  mainly work by identifying cavities on the structure and then predicting one of the largest clefts as the ligand binding site. indeed it has been shown with surfnet that considering the two largest cavities calculated by this method identifies the correct location of the ligand in single-chain enzymes with a success rate of about 90%  <cit> .

ligsitecsc combines geometric analysis with evolutionary conservation by ranking clefts according to the conservation of their constituent residues. the method was tested on  <dig> apo/holo protein pairs and on a second test set composed of  <dig> holo protein structures and correctly predicts the ligand binding site in 71% and 75% cases, respectively.

concavity also integrates sequence conservation with pocket detection and makes specific predictions of positions in space that overlap ligand atoms. moreover, instead of identifying entire clefts, the method specifically predicts which residues are likely to be in contact with a ligand. concavity was tested on  <dig> apo/holo protein pairs from the non redundant ligasite  <dig>  dataset  <cit>  and achieved an area under the precision-recall curve of  <dig>  and  <dig>  on apo and holo structure respectively.

apropos uses an alpha-shape algorithm to identify pockets by comparing surfaces of the protein generated with different levels of detail. this algorithm correctly locates more than 95% of the ligand binding sites in a set of about  <dig> protein structures. depth is based on the observation that some of the residues in a binding site could be deep but at the same time exposed to the solvent. depth has been compared with ligsite, pocket-finder, surfnet and concavity on a set of  <dig> protein structures binding small ligands, achieving results comparable with all these methods.

methods based on energetic criteria, such as the one developed by morita et al.  <cit> , q-sitefinder  <cit>  and sitehound  <cit> , usually calculate the energy of interaction between a probe and the surface of the protein. clusters of points with favorable interaction energies define the predicted ligand binding sites.

sitehound uses an energy-based approach to identify possible regions of binding, implementing different types of probes  to characterize a protein structure. it has been tested on  <dig> protein structures and it correctly ranks the ligand binding site in one of the top three clusters in 95% of the cases.

both q-sitefinder and the method by morita et al. use methane probes and have been tested on the same dataset of  <dig> apo/holo protein pairs. q-sitefinder achieves a success rate of 51% for apo and 80% for holo structures, when considering the top scoring prediction as the correct one. the method by morita et al. has a similar performance on holo structures, but performs better on apo proteins achieving a success rate of 77%.

in addition to these approaches, a variety of methods exist that predict the location of binding sites based on several characteristics that distinguish them from other regions of the protein surface. for instance residues in binding pockets and enzyme active sites have been observed to interact directly, or via few intermediates, with a great number of residues in the structure  <cit> . moreover enzyme active sites have been reported to have perturbed pka values  <cit>  and, when mutated, lead to a decrease in activity accompanied by an increase in the stability of the protein  <cit> . the preference of certain residues to be located in binding sites has also been exploited for prediction. mehio et al.  <cit>  recently developed a binding site prediction method based on the over-representation of specific atom triplets in binding sites with respect to the rest of the structure.

a separate discussion is necessary when the structure of a homologue of the protein of interest is available. for these cases different approaches have been proposed in the last few years, such as 3dligandsite  <cit> , findsite  <cit>  and firestar  <cit> .

3dligandsite searches a structural library for proteins homologous to the query. these proteins are superimposed with the structure of interest and the position of their ligands is used to predict the location of the binding site. similarly findsite superimposes and clusters ligands from homologous structures onto a query protein and uses the center of mass of the ligands to identify putative binding sites. the predicted sites are then ranked according to the number of templates sharing the binding pocket. firestar integrates firedb, a database of annotated functional residues, with a sequence alignment tool in order to enable the comparison of binding residues across homologous proteins. when possible the information of which residues are functionally important is transferred to the protein of interest.

as previously stated the performance of binding site prediction methods differs according to whether the analysis is performed on apo or holo structures because proteins undergo conformational changes when binding their cognate ligands. in general most of these methods correctly identify the location of the binding site in 70-90% of the cases if the protein analyzed is in the bound conformation . in contrast, the same analysis performed on the apo structures achieves a success rate ranging from 50% to 70%.

a wealth of data concerning the mechanisms underlying the interaction of proteins with small molecules can be extracted from complexes of known structure deposited in the pdb. while knowledge-based approaches have been developed that use these data to dock ligands onto proteins  <cit> , no method exists that uses available protein-ligand complexes to predict binding sites on a query structure, irrespective of the ligand.

in this work we detail the development of pdbinder, a novel method for the prediction of ligand binding sites in protein structures. pdbinder is a knowledge-based method based on the observation that unrelated binding sites share small structural motifs that bind the same chemical fragments irrespective of the nature of the ligand molecule as a whole  <cit> . moreover these motifs behave as small building blocks  that can be assembled to create different binding pockets  <cit> . this modularity parallels the modularity of the ligand molecules, which are themselves composed of recurring chemical fragments.

we therefore reasoned that, because of the presence of these motifs and irrespective of the identity of the bound ligand, a binding site should resemble other known binding sites, more than other parts of the structure. thus the number of similarities that are identified between a protein patch and the set of all known binding sites can be used to assess the likelihood of that surface area being able to bind a ligand.

pdbinder uses the superpose3d  <cit>  local structural comparison algorithm to scan a query protein against a library of binding and non-binding protein surface regions derived from the pdb. the number of similarities identified in the two sets is then used to derive a propensity value for each residue in the protein of interest. surface areas with high propensity values denote the position of the predicted binding site. the method was trained on a non-redundant set of  <dig> high-quality structures of protein-ligand complexes and tested on two different datasets of  <dig> and  <dig> apo/holo structure pairs. we also report a comparison between the performance of pdbinder and other methods.

availability
a downloadable version of the program is available at http://cbm.bio.uniroma <dig> it/pdbinder/.

RESULTS
training of the method
in order to train pdbinder and determine the optimal threshold of the propensity value we used the non-redundant dataset of  <dig> high-quality ligand binding structures from which we derived the libraries of binding and non-binding residues. we used a leave-one-out procedure as described in the methods. as a first test we pooled the residues from all the structures together, each one associated with the pdbinder propensity value and a binary flag indicating whether the residue is part of a binding pocket or not. to assess the predictive power of the propensity value we drew a roc curve and obtained an area under the curve  of  <dig>  . this result shows that the propensity value assigned by pdbinder is indeed correlated with the likelihood that a residue is part of a binding pocket.

in order to calculate the optimal propensity threshold we choose the value that maximizes the average of the prediction performance on all the proteins, i.e. instead of pooling all the residues together we calculate the performance for each chain and seek to maximize the average. this situation is clearly more indicative of the typical usage of the method. figure  <dig> shows how the sensitivity, specificity, positive predictive value  and matthew's correlation coefficient  vary as a function of the threshold of propensity value. this figure also highlights the effects of using a threshold that maximizes the positive predictive value, i.e. a threshold value of  <dig> . the ppv rises to  <dig>  but the sensitivity decreases to  <dig>  which means that only 2% of the binding pockets residues are correctly recognized.

we choose the threshold value that maximizes the average of the matthew's correlation coefficient .

the optimal threshold was thus determined to be  <dig> . because of the way the pdbinder propensity is defined this means that at least ~15% of the matches of a residue must be with residues in binding pockets for the amino acid to be predicted as positive. using this threshold resulted in an average mcc on the training set of  <dig> , with an average sensitivity of  <dig> , a specificity of  <dig>  and a positive predictive value of  <dig> .

clustering of the predictions
the results on the training set show that using the propensity value alone we obtain ~40% of correct predictions. since binding sites are contiguous regions of the surface, we investigated whether discarding spatially isolated predictions yielded an improvement in the performance of pdbinder. we therefore decided to discard all the predictions that do not have at least another prediction in a defined radius. we tested different thresholds from  <dig>  Å to  <dig>  Å in increments of  <dig> Å. the results of this spatial filtering show that the best clustering radius is  <dig>  Å. this value is close to the mean radius of the binding sites in the training set . the use of this threshold raises the positive predictive value by  <dig> % and the mcc by  <dig>  with a loss of  <dig> % in sensitivity .

results obtained by pdbinder on the training set and apo/holo test sets. these results were derived by using a single propensity threshold for all the amino acids and applying the spatial clustering with a  <dig> angstrom threshold.

amino acid-specific analysis
the amino acid composition of binding pockets is known to be different from that of the remainder of the structure. indeed some amino acids such as arginine and histidine are commonly found in ligand binding sites  <cit> . therefore structural motifs including these residues will tend to match more frequently with binding sites by virtue of their composition alone. we tried to separate this effect from the contribution given by geometry by calculating a different propensity value threshold for each amino acid.

this method implicitly normalizes for the preference of certain amino acids to appear in binding sites. for instance, in order for the propensity of a histidine to rise above the threshold, the structural motifs of which it is part have to appear in known binding sites more frequently than other motifs involving histidine. if we use the same threshold for all the amino acids, the same histidine has to "compete" with all the motifs, which is easier because histidine is itself preferred in binding sites while the other motifs include residues which are strongly disfavored.

we therefore calculated  <dig> different thresholds using all the residues in the training set, with the same method that was used to derive the general cutoff . figure  <dig> displays the residue-specific cutoffs along with the general cutoff of  <dig>  used in the previous analysis . the optimal cutoffs are specific for each aminoacid type and range from the  <dig>  of leucine to the  <dig>  of histidine. interestingly these cutoffs correlate well  with the residue preferences calculated from the composition of the binding sites alone, with residues having a threshold higher than the general cutoff being favored.

we again calculated the average mcc for all the proteins in the training set, this time using the amino acid-specific cutoffs and obtained an mcc of  <dig>  with an average sensitivity of  <dig>  a specificity of  <dig>  and a positive predictive value of  <dig> . therefore the use of residue-specific thresholds yielded fewer, more accurate predictions but the average performance was slightly worst and was not recovered by introducing the spatial clustering .

we decided to determine how much the geometry of the binding residues is important for our knowledge-based potential with respect to the simpler aminoacid composition of the binding triplets. to this end we calculated an average propensity value for all the binding triplets of residues having the same aminoacid composition, i.e. avv, vav and vva, regardless of their geometric configuration. to derive the average propensity value, we calculated the ratio between the number of times each triplet with the same aminoacid composition appears in a binding pocket and the total number of occurrences of the triplets having the same aminoacid composition.

the complete list of triplets along with their potentials is reported in the additional file 1: table  <dig> 

we then applied these propensity values in a leave-one-out experiment on the training set. for each protein structure, the propensity value associated to a residue is calculated as the average propensity value of the triplets in which each residue is found using superpose3d.

when using this simpler aminoacid composition potential, the best mcc obtained on our training set drops to  <dig>  , thus showing the importance of the geometry of a triplet in determining whether a residue is binding or not.

these results show that geometry alone gives a strong contribution to the predictive power of pdbinder. however the signal from the binding site composition, i.e. the differential occurrence of specific residues, is too strong to be ignored without some loss of performance. the single cutoff method was therefore used for all the remaining analyses.

evaluation of the results with the test set
a benchmark dataset for binding site prediction methods should ideally consist of proteins with one unbound structure to apply the method, and at least one bound structure to assess the correctness of the predictions. this is necessary to account for the fact that proteins can undergo conformational changes upon binding. consequently applying a binding site prediction method to a bound structure from which the ligand has been deleted does not appropriately reproduce situations where the binding site location is truly unknown.

for these reasons we tested pdbinder on the ligasite dataset, which includes, for each protein-ligand complex , a structure determined in absence of the ligand . the training and test sets are completely independent. moreover, in order to avoid any unfair advantage deriving from the possible homology of a structure in the test set with the chains used to build the libraries of binding and non binding residues, we did not consider structural matches with residues coming from proteins having a sequence identity with the query structure higher than 30%.

we used the optimal propensity threshold of  <dig>  which was derived from the analysis of the training set as described above. the average mcc value on the holo test set was  <dig>  with an average sensitivity of  <dig> , an average specificity of  <dig>  and a ppv of  <dig>  . the small decrease in performance shows that the optimal threshold derived from the training set is general enough to be applied to an independent dataset.

using the apo test set of unbound structures the average mcc values calculated from the distribution was  <dig>  with a sensitivity of  <dig> , a specificity of  <dig>  and a ppv of  <dig>  . these results show that the performance of pdbinder suffers only a modest decrease when moving from holo to apo structures. this observation could be explained by the fact that our method considers the conformation of groups of three residues only. therefore, even if the overall structure of the binding pocket is altered when the ligand is bound, the local conformation of small subsets of residues is mostly preserved .

comparison of pdbinder with q-sitefinder
q-sitefinder is a method that scans the surface of a protein with a methyl probe and predicts clusters of favorable interaction spots as ligand binding sites. we developed an automated procedure to analyze the test set proteins using the q-sitefinder webserver  <cit> . in order to compare the results with those obtained with pdbinder, we had to map the cluster of probes predicted by q-sitefinder on specific residues of the structure. to this end we defined as binding residues those lying closer than  <dig>  angstrom to any cluster of probes identified by q-sitefinder.

we determined that q-sitefinder obtains the best performance in terms of mcc and ppv when the top two clusters are considered as positive predictions  and applied this criterion in all the following analyses. the results obtained by both methods are displayed in table  <dig>  the performance of pdbinder on the holo set is better both in terms of ppv  and mcc . the sensitivity and specificity values show that pdbinder misses more true positives  but makes more correct predictions on average . interestingly, while the performance of both methods as expected worsens when analysing the apo proteins, the relative decrease in performance of q-sitefinder is significantly greater. indeed q-sitefinder suffers a 35% reduction in mcc vs 13% of pdbinder and a 28% reduction in ppv vs 10% of pdbinder.

integration of pdbinder with q-sitefinder. these results refer to the apo/holo test set. the first two rows detail the performance values achieved by pdbinder  and q-sitefinder  alone. the third row reports the results obtained if a residue is considered positive when it is predicted by both methods. the fourth row details the opposite situation in which a residue is considered positive when it is predicted by either method. the last row reports the results obtained with the two threshold systems. we performed a ten-fold cross validation to derive two different propensity thresholds, one for the residues predicted as positive by q-sitefinder and the other one for the negatives. the results are the average of the ten cross validation runs ± the standard error.

identification of the gdp binding pocket of the gdpran-ntf <dig> complex
in order to illustrate the potential of pdbinder, we analyzed the gdpran-ntf <dig> complex  using both pdbinder and q-sitefinder. this complex has five chains, a and b forming the ntf <dig> protein and c d and e forming the gdpase ran protein which binds a gdp molecule per chain. figure  <dig> shows the predicted binding residues as sticks. the predictions of pdbinder are in green while those derived from the top  <dig> clusters of q-sitefinder are in yellow. pdbinder correctly identified all the binding site residues with only one false positive per chain, namely residue s <dig> 

to understand why pdbinder achieved more accurate predictions on this structure with respect to an energy-based method, we analyzed in more detail the residues predicted as positives and negatives. all the residues identified by pdbinder as positives have a high number of matches with triplets found in binding pockets in the training set, and only one residue has a propensity value which is borderline but high enough to exceed the threshold of  <dig>  .

binding site residues predicted by q-sitefinder and pdbinder on gdpran-ntf <dig> complex . the only false positive residue identified by pdbinder is s <dig> 

the prediction of s <dig> as binding, the only false positive, may be explained by its structural neighbors raising the number of matches with the dataset of binding residues.

the analysis of the residues correctly predicted as negatives by pdbinder, and incorrectly marked as binding by q-sitefinder, shows the importance of considering geometry besides the simple relative abundance of a residue in binding pockets. indeed for instance residue  <dig> of chain a is a histidine, which is  <dig> -times more frequent in binding sites . however, in this case, this residue is in a different structural context and only has  <dig> matches against the entire set of binding residues. this histidine therefore has a low propensity value and is correctly predicted as negative.

integration with q-sitefinder
the approaches used by pdbinder and q-sitefinder are completely independent. the former is based on the analysis of the geometry of known binding residues, while the latter is based on predicting the energy of interaction with a chemical probe. we therefore decided to investigate whether a combination of the two approaches yielded improved results. to this end two different strategies were applied:

i) predicting a residue as binding when at least one of the methods identifies it as such.

ii) predicting a residue as binding only when both methods agree.

comparison of pdbinder with other ligand binding site prediction methods
large cavities in protein surfaces often harbor ligand binding sites or enzyme active sites, and several methods  are available to identify such pockets. mehio et al. recently developed a method called stp  that assigns to each residue of a structure a propensity value derived from counting the occurrences of triplets of atoms in known binding sites. the authors use these residue propensities to rank the surface cavities identified by surfnet and then compare their results with those obtained with q-sitefinder and the method by morita et al. the  <dig> apo proteins of the original q-sitefinder test set are used for the comparison.

we therefore decided to perform a similar experiment and used pdbinder to rank the cavities identified by surfnet on the same dataset of  <dig> proteins. the ranking is based on the number of binding residues predicted by pdbinder in each cavity. figure  <dig> displays the results of considering the top first, second or third-ranking cavities for the identification of the ligand binding site. the results show that pdbinder performs better than surfnet, q-sitefinder, stp and the method by morita et al. when only the first cavity is considered. conversely when size alone is used for ranking surfnet outperforms all the methods if one considers the top two or three cavities.

similarly to what we did with q-sitefinder, we tried to integrate pdbinder and stp to investigate whether this led to a performance improvement. stp assigns a patchscore to each atom and the authors consider  <dig> as the threshold for the identification of high scoring atoms which are then used to rank the cavities. for the purpose of integrating stp and pdbinder we consider any residue with at least one atom having a patchscore greater than  <dig> as a binding residue. the number of residues predicted by either method is then used to rank the cavities.

as shown in figure  <dig> the integration of pdbinder and stp clearly outperforms all the other methods, when only the top cavity is considered. when the top two cavities are considered pdbinder + stp outperforms surfnet, while no single method does. considering the top three cavities results in surfnet and pdbinder + stp having identical performance and once again outperforming all the other methods.

CONCLUSIONS
in this work we detailed the development of pdbinder, a novel method for predicting the location of ligand binding sites in protein structures. our approach is based on the observation that unrelated binding sites contain similar structural motifs that are associated with specific chemical fragments in the ligands, irrespective of the identity of the ligand molecule as a whole. pdbinder therefore assumes that ligand binding sites will resemble each other more than other parts of the structure, because of the presence of these small motifs.

we built two libraries of binding and non-binding residues from a set of  <dig> high-quality protein structures and used the superpose3d local structural comparison algorithm to search for structural similarities between a query structure and the two libraries of residues. the number of matches with the sets of binding and non-binding residues is then used to assign a propensity value to each amino acid in the query structure. we optimized the score threshold on the training set of  <dig> proteins using a leave-one-out procedure, and then tested pdbinder on the ligasite dataset, which comprises  <dig> apo/holo structure pairs.

we obtained an mcc of  <dig>  on the holo set, with a ppv of  <dig> . interestingly the performance on apo structures is quite similar to the one obtained with the proteins in their ligand-bound conformation. this could be explained by the fact that, even though the ligand induces some rearrangements in the overall structure of the binding site, the local conformation of small sets of residues, which is the level of detail relevant for pdbinder, does not vary much. this result is extremely important for real-world applications where the location of the binding site is unknown because the protein has been crystallized without a ligand.

we then compared pdbinder with a number of existing methods. the comparison with q-sitefinder on the ligasite test set showed that pdbinder has a superior performance and this can be further improved by combining the two methods. we then used pdbinder to rank surface cavities identified by surfnet and compared the performance with that of stp, q-sitefinder and the method by morita et al. the results show that pdbinder is better than all other methods when considering only the first cavity as the correct one. moreover combining pdbinder and stp outperforms all the other methods when the top ranking two or three cavities are also considered.

in conclusion this work shows that pdbinder is an efficient method for the prediction of ligand binding sites, that uses an approach which is very different from those found in the literature. the propensity value is a statistical potential unique among the other developed binding site prediction algorithms that not only has a good performance by itself, but also has an original approach which allows it to be integrated effectively with existing programs.

