BACKGROUND
comparative analyses of whole genome sequences have been shown to be vital for understanding the correlation between infecting pathogen and disease manifestation . a pre-requisite for comparative genomics is the identification of strains of differing pathogenicity and also the ability to assemble the whole of the genome, including accessory regions in genomes of pathogenic bacteria. bacterial genomes can be divided into conserved core and less conserved accessory  regions  <cit> . importantly, accessory regions often undergo horizontal gene transfer, probably promoted by mobile genome elements   <cit> . this may change pathogenicity as well as host, or vector specificity .

next generation sequencing  technologies have allowed a big step to be taken towards the goal of whole genome analysis. different sequencing methods are currently on the market with illumina being notable for short sequencing read technology , but assembly of accessory regions of the genome may be particularly challenging from short read ngs data  <cit> . on the other hand pacific bioscience systems’ single molecule real-time  dna sequencing and oxford nanopore technologies’ nanopore sequencing methods generate long sequence reads  with enormous advantages for genome assembly and in particular for plasmids . although long read methods such as nanopore or smrt sequencing may have less precision with respect to single nucleotide polymorphism accuracy  <cit> , high sequence coverage with the latter method  has been reported to provide more accuracy at the single nucleotide  <cit> . costs of the sequencing methods vary considerably and thus, precision and economics are important factors for deciding which sequencing technology is best suited to investigate the pathogen in question.

in the present work we compared different ngs methodologies for their utility in analyzing the very complex genome of borrelia burgdorferi sensu stricto . b. burgdorferi s.s. belongs to a bacterial species complex that consists of more than  <dig> genospecies with differing propensity to cause lyme borreliosis in humans. the bacteria are maintained in natural transmission cycles between vertebrate reservoir hosts and tick vectors. the borrelia genome is highly fragmented consisting of a linear main chromosome and numerous linear and circular plasmids  <cit> . figure  <dig> shows a schematic drawing of the published genome of strain b <dig>  the first strain of b. burgdorferi s.s. ever sequenced. the size of the whole genome amounts to  <dig>  mb with plasmids constituting appr. 40% of it. the gc content is about 28%. it is known that plasmids encode the majority of outer surface proteins  <cit>  that are located at the vector-host-pathogen interface  playing a critical role in the ecology of b. burgdorferi sensu lato  and in their ability to cause disease. therefore, information on plasmid content and structure is an absolute requirement for understanding host or vector adaptation of vector-borne disease agents such as borrelia. the number and structure of plasmids harbored by borrelia strains can vary considerably  <cit>  and for many european borrelia species only limited information on plasmid content and structure is available . furthermore, difficulties in assembling plasmid sequences currently hamper efforts to understand the interaction of this organism with human and animal reservoir hosts as well as its arthropod  vector  <cit> .fig.  <dig> schematic drawing of the genome organization of b. burgdorferi s.s. strain b31-gb. strain b31-gb has been described to possess > <dig> linear and circular plasmids . similar color indicates plasmids with high sequence similarity. note that lp <dig> has an insertion of a cp <dig> plasmid




molecular level changes in the genomes of bacteria with significant consequences for virulence and pathogenicity, together with host and vector associations can be accelerated through horizontal gene transfer and recombination instigated by mobile genetic elements . to explore molecular level changes in the genome of vector-borne bacterial pathogens and to understand how best to identify them, we investigated the genomes of closely related strains of the tick-transmitted bacterium b. burgdorferi s. s. using a variety of library construction methods, enrichment of plasmids and different sequencing technologies . previous work has shown that linear and circular plasmids can have a mosaic structure and differ even between strains of a given species  <cit> , thus we especially focused on the plasmid fraction, which is known to be important in influencing host specificity and virulence in borrelia  <cit> . it is well recognized in other bacteria that gain or loss of genetic elements  can lead to adaptation to a new environment including host specialization and may change pathogenicity of bacterial pathogens with consequences for human or animal health .

we sequenced a low passage strain b <dig> of b. burgdorferi s. s., available at the german national reference centre for borrelia , and two additional closely related strains pali and pabe  <cit> , comparing these with the previously sequenced reference strain b <dig>  available in genbank  . these strains were chosen because their close relatedness to the b <dig> reference strain allowed addressing questions of performance of library construction methods, of assembly software and sequencing technology. one of the main aims was to address the question of what are appropriate requirements for future reference genome assembly in other borrelia species.

our data show that short read methods are sufficient to assemble the main chromosome and many of the plasmids. however, both long and short read methods are required to obtain reliable data on cp <dig> plasmids. the b. burgdorferi s.s. strains investigated here showed in general a high degree of similarity to the reference strain b31-gb but, intriguingly, both long read technologies revealed remarkable differences between strains in some cp <dig> plasmids. these data together with previous work indicate that b. burgdorferi s.s. strains that show high similarity at the core genome may show structural differences in some of their plasmids suggesting a dynamic system for rapid evolution.

methods
strains
we used a b <dig> low passage strain of b. burgdorferi s.s. , provided as a kind gift of w. burgdorfer to the german national reference centre . the strain was originally isolated in  <dig> from an ixodes scapularis tick on shelter island  <cit> . throughout the paper, this b <dig> strain is termed b31-nrz and will be compared to b31-gb, the strain that had been sequenced by fraser and co-authors  <cit>  and deposited to genbank under accession number ae <dig> . the strains sequenced by fraser and co-authors originated from the same tick isolate as b31-nrz but was cloned and passed through a mouse before sequencing using a whole-genome random approach utilizing small insert plasmid libraries  <cit> .

pali and pabe are strains isolated from patients in germany in the 1990s . based on multilocus sequence typing  and chromosomal single nucleotide polymorphisms , they have been shown to belong to the same mlst sequence type  as b <dig>  and both these strains differ in approximately  <dig> snps from b31-gb on the main chromosome, thus they are very closely related to b <dig>  <cit> .

pcr analyses
to probe which plasmids are present in the strains b31-nrz, pabe and pali, primers were designed to sequence regions that were unique for individual plasmids in b31-gb .

pcr primer and conditions used to verify the presence/absence of gaps in illumina alignments are given in additional file 1: tables s <dig> 

dna purification, plasmid enrichment and library construction
to generate genomic dna for illumina sequencing, borrelia strains were cultured in mkp medium using conditions as described previously  <cit> . genomic dna was extracted via a maxwell®  <dig> using a maxwell lev blood dna kit  and libraries of whole genomic dna  were prepared according to the manufacturer’s recommendation.

following dna quantification, libraries were prepared according to illumina dna sample preparation guide . three different library preparations were used for total dna for illumina miseq sequencing: nextera  , truseq  v <dig>  and nextera mate pair library prep kit  . library prep kits, library index kits and miseq reagent kits were purchased from illumina . to generate libraries, nextera required 50 ng of dna, ts and mate pair libraries required 1–2 μg of dna. for ts libraries genomic dna was fragmented using ultrasound in a covaris m <dig> . settings were as follows: dna_ <dig> bp protocol, peak power  <dig> , duty factor  <dig> , cycles/burst  <dig>  duration 45 s. to shear the circularized fragments during mate-pair library construction, the following covaris settings were used: dna_ <dig> bp, peak power  <dig> , duty factor  <dig> , cycles/burst  <dig>  duration 36 s. mp library construction yielded the following sizes after circularization: b <dig> 8400 bp; pabe 3600 bp; pali 7500 bp. purified biotinylated fragments of 500 bp, 644 bp and 687 bp were obtained for b <dig>  pabe and pali, respectively, after shearing of circularized dna.

to investigate whether sequence assembly would improve for plasmids if the main linear chromosome was removed prior to library construction, we used plasmid purification kits. for an initial assessment of suitability of plasmid purification kits for separation of the borrelia main chromosome from plasmids, three different plasmid purification kits were run in duplicate, two from qiagen and one from promega ; qiaprep® spin miniprep kit ; wizard® plus sv minipreps dna purification system ). based on the results of this assessment, a larger scale plasmid purification of b31-nrz, pali und pabe dna was performed using the qiagen® plasmid midi kit  according to a protocol provided by the manufacturer.

libraries on enriched plasmids were prepared using the nextera® xt library prep kit , the nextera® xt index kit  and libraries run with a miseq® reagent nano kit v <dig> . extracted dna was diluted to a concentration of  <dig>  ng/μl and four μl were used as starting material for library construction according to the manufacturer’s recommendations.

all libraries were validated using genomic dna analysis screen tapes  and genomics dna reagents  .

a quality check on illumina sequencing reads was performed either in galaxy  <cit>  or in the clc genomics workbench and reads that did not pass the filter were not included in the analyses. sequence reads were mapped on the b <dig> reference genome  in the clc genomics workbench using default settings: mismatch cost = 2; cost of insertions and deletions = linear gap cost; length fraction =  <dig> ; similarity fraction =  <dig> ; auto-detect paired distances = yes; non-specific match handling = map randomly. variant calls were generated using the fixed ploidy variant detection option with ploidy = 1; required variant probability  = 90; minimum coverage = 10; minimum count = 2; minimum frequency  = 80; base quality filter = yes; neighborhood radium = 5; minimum central quality = 20; minimum neighborhood quality =  <dig>  read tracks and reports were generated and saved as well as un-mapped reads.


de novo assembly was also done in the clc genomics workbench using the following parameters: mapping mode = map reads back to contigs; mismatch cost = 2; insertion cost = 3; delection cost = 3; colorspace error cost = 3; length fraction =  <dig> ; similarity fraction =  <dig> ; colorspace alignment; alignment mode = local; match mode = random.

for de novo assembly of reads in galaxy  <cit> , sga  <cit>  and velvet  <cit>  were used with the following settings in sga: minimum overlap for the final assembly = 85; correction k-mer = 31; min read length = 40; coverage filter = 2; overlap parameter used for fm-merge = 55; number of pairs required to link two contigs = 5; minimum length of contigs to include into scaffold =  <dig>  settings for velvetoptimiser were: start hash length =  <dig>  end hash length =  <dig>  kmer optimisation metric = n <dig> size; coverage optimisation metric = length of single longest contig.

for b31-nrz de novo assembly was also conducted using spades  <cit>  on a virtual biolinux v. <dig> . machine  <cit>  using the following command line: −k  <dig>   <dig>   <dig>   <dig>   <dig> --careful --pe1- <dig> b31_r <dig> fastq --pe1- <dig> b31_r <dig> fastq -o b31_spades_output.

for smrt sequencing 10 μg of dna were purified via maxwell®  <dig> using a maxwell lev blood dna kit . the quality and quantity of dna was validated using a qubit  <dig>  fluorimeter  and a genomic dna screen tape . dna was sent to the norwegian sequencing centre, university of oslo, norway for library construction, sequencing and assembly. libraries were constructed using pacific biosciences 20 kb library preparation protocol. size selection of the final library was performed using bluepippin with a 7 kb cut-off. libraries were sequenced on pacific biosciences rs ii instrument using p6-c <dig> chemistry with 360 min movie time.

assembled sequences and consensus sequences of the read mapping conducted in clc were aligned using mega <dig>  <cit> . genetic distance analyses between sequences and multiple alignments of sequences were created in mega <dig> 

for nanopore sequencing  <dig> μg of dna was end-repaired and da-tailed without previous fragmentation  and ligated to 1d sequencing adapters . prepared library was loaded to a minion flowcell  and sequenced for 6 h with offline basecalling. for nanopore reads error correction, trimming and assembly was performed with the canu assembler  <cit>  using the command options genomesize =  <dig>  m, coroutcoverage =  <dig>  cormincoverage =  <dig>  errorrate =  <dig> , minreadlength =  <dig> 

sequencing and sequence analysis
short read sequencing was performed on an illumina miseq platform . reads were demultiplexed and tags removed as part of the miseq run. smrt sequences were assembled and polished using the hierarchical genome assembly process . overlapping regions due to circularization of plasmids were removed. nanopore sequences were processed employing the long read assembler canu  <cit>  available through a galaxy platform  <cit> .

the software package mauve  <cit>  was used to order pre-assembled contigs and to align them to a reference genome.

blast ring image generator  was used to display similarities between genomes  <cit> . blast  <cit>  was performed with default settings to search for similarities between contigs and sequences available in genbank.

RESULTS
impact of library construction and assembler on illumina miseq sequence reads
a summary of the sequencing statistics, i.e. total bp, average read length, gc content, revealed that for all strains sequencing results were of comparative, sufficiently high quantity and quality to obtain a representative view of the genome . comparison of the different methods using de novo assembly revealed little differences in assembly success when either nx or ts were used on their own. mp libraries have been developed to provide scaffolding for short reads especially for regions carrying repetitive sequences  <cit> . in our study, when combining nx and ts reads with mp reads the number of contigs  was only slightly reduced from  <dig> to  <dig> with nx or nx_mp, respectively, and  <dig> to  <dig> for ts and ts_mp for strain pabe . similarly, n <dig> values changed only slightly when libraries were constructed using ts only or including mp libraries in the assembly . for b31-nrz de novo assembly of lp28- <dig> was improved using a combination of ts and mp library reads compared to ts reads alone .table  <dig> sequencing statistics for all samples and sequencers


fig.  <dig> visualization of de novo assembly of lp28- <dig> in b31-nrz. poor assembly was observed using ts libraries only . a combination of ts and mp libraries considerably improved the assembly of lp28- <dig> . also the use of enriched plasmid dna for nx library construction improved the assembly . pacific bioscience smrt sequences also provided a good assembly . it is noteworthy that in all cases  the plasmid of b31-nrz was shorter than that of b31-gb. different shades of coloration in one panel indicate different identities between aligned sequences. regions with lighter shades correspond to less sequence similarity 




in some cases, when de novo assemblies of plasmids of b31-nrz, pali and pabe were aligned to the b31-gb reference, gaps in the alignment were observed e.g. lp <dig>  , lp28- <dig> , lp <dig>  and lp <dig> . to examine whether these gaps represented true differences between strains or whether these gaps may have appeared as a result of problems in library construction or assembly, pcr was employed. pcr with primers  designed to bridge the border between neighboring contigs and the gapped regions resulted in pcr products, suggesting that these gaps are artefacts likely to be results of library construction methods or assembly of short reads . sequences of pcr products were identical to b31-gb sequences further confirming the artefactual nature of these gaps . the artefactual nature of these gaps was further confirmed by long read assemblies .fig.  <dig> visualization of assemblies of lp <dig> in pabe aligned to the reference b31-gb using brig. total genomic dna was used for ts library preparation . a spurious gap in the region from  <dig> to  <dig>  kb is visible. using enriched plasmid dna for nx library construction improved the assembly and a smaller gap at 16–17 kb is visible ). not surprinsingly, read mapping of illumina reads on b31-gb using enriched plasmid dna for library construction showed complete coverage suggesting that reads for the complete plasmid existed but were not assembled de novo . de novo assemblies of pacific bioscience smrt sequences showed complete coverage of lp <dig> confirming that the complete plasmid was present in pabe and that the gaps presenting in de novo assemblies of short reads were artefacts either of library construction or short read assembly 




comparison of different assemblers revealed that using spades for assembly gave the longest contigs. a single contig covered the whole of the main chromosome , while several others covered whole plasmids such as lp <dig>  lp <dig>  lp <dig> or cp <dig> . however, as shown by blast  <cit>  searches, cp <dig> plasmids were difficult to assemble de novo using any assembler including spades and only short contigs that matched several b31-gb cp <dig> sequences were generated .table  <dig> summary statistics of b31-nrz ts paired-end illumina reads using different de novo assemblers




as expected, read mapping to the b31-gb reference genome  provided evidence that the different library preparation methods gave equally good results with numbers of snps being very similar regardless of the library construction method .

pcr with plasmid specific primers  on strain b31-nrz confirmed the presence of eight plasmids, six linear plasmids, lp <dig>  lp28- <dig>  lp <dig>  lp <dig>  lp <dig>  lp <dig>  and two circular plasmids cp <dig> and cp32- <dig>  primers for plasmid lp28- <dig> turned out to cross-react with lp <dig> . for cp32’s  it was not possible to design specific primers due to sequence similarities between various cp <dig> plasmids. smrt sequences  revealed more subtle differences in plasmid content between b31-nrz and b31-gb.

plasmids of nrz strains b31-nrz, pali and pabe
using commercially available plasmid mini kits, it was possible to enrich borrelia linear and circular plasmids of all sizes, and even the large linear plasmids lp <dig> and lp <dig> were found by pcr in the preparation. the yield of dna from the main linear chromosome was drastically reduced by this procedure  permitting a high read coverage of plasmids and a slightly better de novo assembly of some plasmids of b. burgdorferi strains b <dig>  pali und pabe. graphical representation generated using brig  <cit>  and comparison of the different methods underlined the suitability of plasmid enrichment for plasmid assembly in borrelia . these images show that gaps that were present with de novo assemblies of total genomic dna were reduced when enriched plasmid dna was used for miseq sequencing . pacific bioscience sequences performed even better resulting in fewer gaps in plasmids assemblies .fig.  <dig> visualization of assemblies of cp32- <dig> of b31-nrz aligned to the reference b31-gb. de novo assembly of total genomic dna sequenced from a ts library preparation . the alignment shows several gaps covering only three quarter of the plasmid. using enriched plasmid dna for nx library construction followed by de novo assembly in the clc genomics workbench ), the size of gaps was reduced. read mapping of illumina reads on b31-gb using enriched plasmid dna for nx library construction ) produced a gapless alignment of reads to the reference. de novo assemblies of pacific bioscience smrt sequences  showed complete coverage of the cp32- <dig> plasmid. the image shows the larger size of the smrt assembly with a gap appearing around 17 kb which likely reflect the differences observed between b31-nrz and b31-gb. different shades of coloration in one panel indicate different identities between aligned sequences. regions with lighter shades correspond to less sequence similarity 




pacific biosciences smrt sequences

de novo assemblies obtained from pacific biosciences smrt sequences resulted in contigs which indicated the presence of one main chromosome and <dig> plasmids in b31-nrz,  <dig> plasmids in pali and ten plasmids in pabe. smrt sequence assemblies correctly displayed the duplicated 5s-23s locus on the main chromosome and repetitive sequences, for example on plasmid lp <dig> . in all three strains, differences in plasmid content compared to b31-gb were found; especially some of the cp <dig> plasmids appeared to have merged .

the  <dig> plasmids found in strain b31-nrz were six linear plasmids lp <dig>  lp28- <dig>  lp <dig>  lp <dig>  lp <dig>  lp <dig>  and six circular plasmids, cp <dig>  cp32-5 +  <dig>  cp32- <dig>  cp32- <dig>  cp32- <dig> and cp32- <dig> . differences in b31-nrz compared to b31-gb included  that contig <dig> matching plasmid cp32- <dig> in this strain seemed to be fusion of cp32- <dig> and cp32- <dig> as its pfam <dig> sequences were 100% identical to that of cp32- <dig> and cp32- <dig>  furthermore, it differed to b31-gb’s cp32- <dig> in sequence stretches of one or several kb that showed higher similarity to cp32- <dig> and cp32- <dig> of strains 64b and 156a, respectively ;  that plasmid lp28- <dig> was shorter  than in b31-gb  and  that plasmid cp32- <dig> was present and had > <dig> snps compared to cp32- <dig>  the pfam <dig> sequence of b31-nrz contig <dig> showed 100% identity to pfam <dig> of plasmid cp32- <dig> and 99% similarity to pfam <dig> of plasmids cp32- <dig> of several b. burgdorferi s. s. strains. plasmid cp32- <dig> was described originally in b <dig>  <cit>  and in some b <dig> cultures it appears to have been replaced by cp32- <dig>  <cit> .table  <dig> plasmids present in b31-nrz, pali and pabe




abbss = b. burgdorferi s.s.; the full complement of b31-gb plasmids can be found in table s3


bin b31-nrz contig4  of the smrt sequences was likely a hybrid plasmid as the first app.  <dig>  bp showed  <dig> snps to cp32- <dig> while the sequence starting from  <dig>  had  <dig> snps to cp32- <dig>  the regions showing variation to cp32- <dig> of b <dig> showed similarity to cp32- <dig> of strain 64b  and to cp32- <dig> of strain 156a  . contig <dig> had  <dig> snps compared to cp32-1 +  <dig> of jd <dig>  its pfam <dig> sequences showed 100% similarity to cp32- <dig> and cp32-1


cin pali, three contigs were found that matched cp32- <dig> in blast searches. contig <dig> showed  <dig> snps to cp32- <dig> but was short  and did not have a pfam <dig> locus. contig <dig> matched cp32- <dig> from  <dig> to  <dig>  bp,  <dig> –23 kb the similarity was higher to cp32-5 of b. burgdorferi s.s. strain 64b , while the remaining sequence to  <dig>  matched cp32- <dig> again. its pfam <dig> sequences showed 100% similarity to cp32- <dig> of several b. burgdorferi s. s. strains. contig <dig> between  <dig>  and 18 kb showed a closer match to cp32-6 of strain 156a while the remaining sequence matched cp32- <dig>  pfam <dig> sequence of contig <dig> was identical to cp32- <dig> of b31-gb


din pabe one contig was present  that partially matched cp32- <dig> but part of the sequence also matched cp32- <dig>  and cp32- <dig> . in contig <dig>  the pfam <dig> of cp32- <dig> showed 100% identity


ea plasmid was found in b31-nrz that was not present in the b31-gb reference. its pfam <dig> sequence was identical to cp32- <dig> and showed high similarity  to cp32- <dig> of several b. burgdorferi s.s. strains. an almost identical plasmid was found in pabe with a pfam <dig> matching that of cp32-2


fin blast searches contig <dig> of pabe showed similarity to cp32- <dig> . however, the first part of the sequence was highly similar to cp32- <dig> while the second part was more similar to cp32- <dig> of b <dig> suggesting that this plasmid represents a hybrid plasmid. the pfam <dig> sequences were identical to pfam <dig> of cp32- <dig> and cp32-4


gin b <dig> plasmid lp28- <dig> is short . in pabe the presence of lp28- <dig> is questionable as there were only two contigs of approximately 4800 bp that showed high similarity to lp28-1




pali contained seven circular plasmids and five out of the six linear plasmids as identified in b31-nrz, lp28- <dig> was missing completely. three contigs showed similarities to plasmid cp32- <dig>  and to varying degrees similarities to other cp <dig> plasmids .

in strain pabe contigs matching seven complete plasmids were identified including lp <dig>  lp <dig>  cp <dig>  cp32-5/cp32- <dig>  cp32- <dig>  cp32-4/cp32- <dig>  cp32- <dig>  of which two appeared to be fusion plasmids, i.e. contig <dig> fusion cp32- <dig> and cp32- <dig> and contig <dig> fusion of plasmids cp32- <dig> and cp32- <dig>  plasmid lp <dig> was missing from pabe.

contig <dig> of b31-nrz seemed to be a mosaic plasmid of cp32- <dig> and other plasmids. it contained in the region from 21 kb – 26 kb sequences with high similarity to bbu64b_v <dig>  and bbu64b_v <dig> to _v <dig> that correspond to region  <dig> - <dig>  and  <dig> - <dig>  of cp32- <dig> of b. burgdorferi s.s. strain 64b. bbu64b_v <dig> to bbu64b_v <dig> encode hypothetical proteins, putative plasmid partition genes or kid repeat protein. the region between  <dig> and 49 kb in contig <dig> of b31-nrz showed the highest similarity to bbu156a_m <dig> and _m <dig> . m <dig> of strain 156a codes for a repeat motif-containing protein whose nucleotide sequences was 91% similar to the borrelia direct repeat  gene of cp32- <dig> in b <dig> 

in pali, there were three different contigs that had similarity to cp32- <dig> of b31-gb. contig <dig> had highest similarity to cp32- <dig> but was truncated  compared to cp32- <dig> of b31-gb  and no pfam <dig> sequence was found. contig <dig> and  <dig> were partially highly similar to cp32- <dig> but had sequence stretches of higher similarity to cp32- <dig> or cp32- <dig>  respectively , similar to what was found in contig <dig> of b31-nrz. similarity searches with pfam <dig> sequences revealed that contig <dig> was likely a member of cp32- <dig>  its pfam <dig> was identical to pfam <dig> of cp32- <dig> plasmids of other b. burgdorferi s. s. strains. the pfam <dig> sequence of contig <dig> had 100% similarity to cp32- <dig> of b31-gb, in spite of this plasmid containing a sequence stretch that was identical to cp32- <dig> of b. burgdorferi s.s. strain 156a. the cp32- <dig> sequences mapped to the same region as those in b31-nrz , indicating that amongst the strains investigated here, the plasmids and plasmid parts showed a high degree of similarity to each other .

in pabe, plasmid cp32- <dig> was found being 99% identical to cp32- <dig> of b31-nrz. the size of contig <dig> in pabe was 62 kb. it showed sequence similarities to cp32- <dig> and cp32- <dig> suggesting that this plasmid represents a hybrid plasmid in this strain. to this point, its two pfam <dig> sequences showed 100% identity to cp32- <dig> and cp32- <dig> 

in pabe, several contigs were obtained that partially matched three plasmids . lp <dig> was represented by  <dig> short contigs  that aligned in a gapped fashion to lp <dig> of b31-gb which may suggest that the plasmid was in the process of degradation. for lp <dig> two overlapping contigs were obtained. it is conceivable that different cells of the population contained the different fragments of the plasmid which was perhaps also in the process of degradation. discrepancies concerning plasmid lp28- <dig> existed between different assemblies. de novo assemblies of illumina reads using total genomic dna suggested the presence of an lp28- <dig> in pabe. a protein blast search in the illumina de novo assembly of pabe with the lp28- <dig> partitioning protein of b31-gb revealed a 100% identical hit supporting the presence of lp28- <dig>  however, read mapping of plasmid enriched illumina reads showed a surprisingly low coverage of lp28- <dig> of only 14× compared to >100× coverage for other plasmids. in smrt assemblies two short contigs  were recovered one of which showed high similarity  to the vlse-locus that is located on lp28- <dig> in b31-gb. taken together, the data suggest the presence of lp28- <dig> in pabe albeit perhaps in low abundance and perhaps in the process of decay.

analysis of coverage of smrt contigs suggested it was likely that not all the plasmids were present in each individual cell of the population, but that individual plasmids were present in only a subset of cells. for example in pabe, coverage of the main chromosome was nearly  <dig> fold while plasmids cp32- <dig> and lp <dig> showed a coverage of 500fold and 250fold, respectively suggesting a presence of the respective plasmids in either one half or one quarter of the cells.

a drawback of pacific biosciences smrt and nanopore sequences was the presence of  insertions and deletions   that were neither present in the b31-gb reference sequence nor in consensus sequences of read mapping of the respective illumina sequences .

nanopore sequencing
sequences obtained using the minion device of oxford nanopore technology were trimmed and assembled using the single read assembler canu  <cit> . both, assembled and unassembled trimmed reads had an average coverage of 40fold. blast  <cit>  searches of nanopore contigs and trimmed reads against sequences available in genbank returned matches to the main chromosome and plasmids as detailed in table  <dig>  the main chromosome as well as five plasmids  returned from canu assemblies while plasmids lp <dig>  lp28- <dig>  lp <dig>  cp32- <dig>  cp32- <dig>  cp32- <dig> and cp32- <dig> were recovered from trimmed read sequences indicating that the  complete length of these plasmids was sequenced as a single length of dna. contig  <dig> was longer in size than the b31-gb cp <dig>  however, the first  <dig>  bases matched to position  <dig> - <dig>  of cp <dig> and bases  <dig> - <dig>  matched to the first 7358 bp of cp <dig> suggesting an overlap of sequences. while most plasmids were comparable in size to the genbank reference, some showed only partial matches, e.g. plasmid lp28- <dig>  and cp32- <dig>  were shorter than plasmids found in the genbank reference of b <dig>  interestingly, shorter sequences for plasmid lp28- <dig> were also found in illumina and smrt sequences . intriguingly, nanopore sequences contained a single plasmid of approximately 60 kb in size that matched  to contig <dig> of smrt sequences . in addition, unassembled trimmed reads of  <dig>  bp showed highest similarity to contig <dig> of b31-nrz, a plasmid resembling cp32- <dig> that was originally described in b <dig>  <cit> . the para gene present in contig <dig> and the nanopore reads showed highest similarity in blast searches to the para gene of cp32- <dig> table  <dig> comparison of nanopore contigs and trimmed reads with genbank and determination of single nucleotide differences  in mega


aunassembled trimmed reads


baligned to pacific bioscience smrt sequence unitig <dig>  and unitig <dig> , respectively




determination of single nucleotide differences  in mega between nanopore sequences and b31-gb sequences resulted in a number of snps some of which were due to alignment errors resulting from the fact that gap extension is less costly in alignments than opening of new gaps . in comparison, fewer snps were observed in smrt sequences  which can be attributed to higher accuracy of smrt sequences and fewer sequencing gaps in homopolymer regions.

discussion
we chose b. burgdorferi s.s. strain b <dig> that was available at the german nrz for borrelia and two closely related strains  that were isolated from patients with different clinical manifestations, i.e. erythema migrans and lyme neuroborreliosis, respectively, to compare various next generation sequencing methods. these strains were chosen to obtain proof-of-principle data on the suitability of methods and to understand how similar or different the plasmid content and structure of very closely related strains in b. burgdorferi s.s. are. previous studies of genomic differences between borrelia strains investigated markedly divergent strains of b. burgdorferi s.s., i.e. representing different mlst sts. these studies revealed a substantial rearrangement of plasmid located sequences likely due to homologous and non-homologous recombination  <cit> .

short read methods provide a good representation of the core genome but not of all plasmids
ts libraries have been described to give a more even coverage of genomes due to the mechanical fragmentation of dna by ultrasound  <cit> . the nx library construction method, based on enzymatic fragmentation and tagmentation of dna in a single step, represents a fast and very convenient way of constructing sequencing libraries and requires very little dna input . mp libraries give approximate distance and orientation of reads and can serve as a scaffold for reads of other library preparation methods  <cit> . a combination of nx or ts with mp libraries may improve de novo assembly of genomes, especially in regions with sequence repeats  <cit> .

nx libraries have been reported to be especially suited for genomes with a balanced gc content. however, this method performed very well for the at-rich   <cit>  borrelia genome in our study. we did not observe major differences in de novo assemblies whether ts or nx libraries were used, many plasmids being well represented in alignments. for b31-nrz the assembly of plasmid lp28- <dig> was considerably improved using a combination of ts and mp library reads compared to ts reads alone , while in pabe no difference was observed in lp28- <dig> assembly. enrichment of plasmids using commercially available plasmid purification kits also resulted in improvement of de novo assemblies of some plasmids  suggesting that higher depth of coverage may have improved assembly of these regions.

of the different de novo assemblers used in this study, spades produced the longest contigs, at least for the main chromosome and several of the plasmids but not for cp <dig> plasmids. plasmid assembly of cp <dig> plasmids proved very difficult with short sequence reads, regardless of library construction, plasmid enrichment or assembly software used. borrelia cp <dig> plasmids are of particular interest, as they harbor erp loci which encode gene products that confer protection of the bacteria against the mammalian innate immunity  <cit> . unfortunately, however, many borrelia strains contain multiple versions of highly similar cp32s, thereby impeding sequence assembly. obtaining accurate sequences for such genetic elements is of crucial importance and might provide new insights in to ecology and pathogenicity of these spirochetes in the future. to assemble cp <dig> plasmids properly, long read sequencing was required and revealed subtle differences that were not detected using combinations of library preparations and illumina sequencing only.

plasmids in b. burgdorferi appear dynamic
the strains included in our study showed differences in plasmid numbers compared to b31-gb which may have reflected the loss of b. burgdorferi s.s. plasmids during cultivation or freeze/thaw cycles of strains  <cit> . the plasmids reported to be lost most frequently in cultures of b <dig> include cp <dig>  lp <dig>  lp <dig>  lp <dig>  lp28- <dig>  lp28- <dig> and lp <dig>  <cit> . of these cp <dig>  lp <dig>  lp <dig>  lp <dig>  and lp28- <dig> were not found in any of our strains, either with plasmid specific pcr, or in illumina sequences of whole genomic dna, enriched plasmid preparations or in either of the long read sequence assemblies. in addition, plasmids cp32- <dig>  − <dig>  − <dig>  lp28- <dig>  lp28- <dig>  lp28- <dig>  lp28- <dig> and lp28- <dig> were also absent. for the remaining plasmids, our data show that not all cells in a given population may harbor every plasmid that was present in the population. there were obvious differences in the frequency of plasmids and some plasmids  may have been present in the population in such low frequencies that they were not captured by all methods. for example, whilst illumina miseq sequences suggested the presence of lp28- <dig> in pabe, neither plasmid-enriched preparations nor pacific bioscience sequencing captured the full lp28- <dig> plasmid. these differences in sequencing success point to methodological weaknesses or drawbacks. for example, pacific bioscience sequencing requires large amounts of dna and plasmids that are present in a subset of the population may not be represented well in sequence assemblies. one has to consider that the strains investigated here were very closely related and we assumed that their plasmid content was identical or highly similar. the advantages and disadvantages of sequencing methods described here combined with economics and sample handling  need to be considered when sequencing unknown strains or species for which no reference sequence is available.

apart from quantitative information, we aimed to explore methods to qualitatively investigate the plasmid structure of closely related borrelia strains to obtain information on requirements for future reference genomes. it had been shown in borrelia that plasmids may be inserted into the main linear chromosome or other plasmids, and merging of plasmids has also been observed  <cit> . linear plasmids have been shown to contain a large number of pseudogenes that may have emerged through gene duplications, accumulation of deleterious mutations and decay  <cit> . as the insertion of a gene into a different genomic environment may change its expression pattern, and such changes may influence host- or vector-interaction of bacterial pathogens, it is important to investigate the structural changes that may occur in the plasmids of closely related bacterial strains.

the close relationship of the strains investigated here is already shown by identical mlst types  <cit>  and is further demonstrated by the very low number of snps that are found in the main chromosome  <cit>  and linear extrachromosomal elements. of the circular plasmids, cp <dig> and three cp32s, i.e. cp32- <dig>  cp32- <dig> and cp32- <dig>  showed also very few snps or rearrangements among the strains studied here , further emphasizing the close relationship of the strains. the remaining cp32s showed similarity amongst the three nrz strains, but revealed differences to b31-gb. variant segments in the cp32- <dig> or cp32- <dig> plasmids had higher blast similarity to regions in plasmids cp32- <dig> of b. burgdorferi s.s. strain156a or cp32- <dig> of b. burgdorferi s.s. strain 64b. interestingly, the variable region in contig <dig>  of b31-nrz, in contigs <dig>  and  <dig>  of pali and contig <dig> of pabe corresponded to regions  <dig> and  <dig> described by casjens and co-workers in  <dig>  although homologous recombination may contribute to re-shuffling of sequences in cp <dig> plasmids within strains  <cit>  and although cp <dig> plasmids have been shown to contain prophage sequences  <cit>  and may therefore be particularly prone to horizontal gene transfer, the mechanisms behind the rearrangements observed here are difficult to understand because the inserted variable sequences had high similarity to b. burgdorferi s.s. strains 156a and 64b, but not b <dig>  it can only be speculated that:  the original strain b <dig> may not have been a clonal isolate and actually consisted of several different borrelia clones; each clone maintaining different genetic elements during sub-passage of cultures;  the plasmid content of a single borrelia strain differs between different individual cells;  some plasmids may have been present in our strain population in such a low frequency that no data were obtained. support for the latter hypothesis comes from our pacific bioscience data which showed that some plasmids occur in the population with low frequency, i.e. the data suggest that only every tenth cell may contain these plasmids as the average coverage of plasmids tended to be variable ranging from >300fold for the chromosome and some plasmids to 30fold for other plasmids .

contig <dig> in b31-nrz and pabe corresponded most likely to the elusive cp32- <dig> plasmid in b31-gb  <cit> . casjens et al.  <cit>  suggested the use of pfam <dig> sequences for plasmid classification as they are homologous to plasmid partitioning proteins  in other systems and were shown to allow categorization of plasmids in borrelia. we used this system to classify plasmids in the closely related strains investigated here. similarity searches with the pfam <dig> gene of cp32- <dig> that had been initially described by  <cit>  revealed that it was identical to sequences in both contig <dig> and in reads obtained by nanopore sequencing. cp32- <dig> also possessed a gene region containing an erpcd locus  <cit>  and sequences in the contigs <dig> of b31-nrz and pabe had 99% similarity with it.

despite the fact that pacific biosciences smrt assemblies showed generally >100fold and nanopore sequences a 40fold coverage, a drawback of these assemblies was the occurrence of indels that may provoke frameshifts in coding sequences. this tendency was more pronounced in nanopore than in smrt sequences. this problem has been noticed for pacific bioscience sequence assemblies before and different strategies have been proposed to address the issue including hybrid approaches  <cit>  or long read correction tools  <cit> . it demonstrates that although long read sequencing has hugely improved the assembly of bacterial genomes and in particular plasmids, there are still hurdles to overcome. in view of the fact that in b. burgdorferi s.s. linear plasmids may contain a large number of non-functional pseudogenes  <cit> , in the case of borrelia the use of a hybrid strategy employing short and long reads may be prudent to generate accurate genome sequences.

the demonstrated merging of cp <dig> plasmids in the b. burgdorferi s. s. strains investigated here shows that some elements in the genome are dynamic even between strains that are almost identical on the main chromosome  <cit> . it suggests that even for such closely related strains, the use of reference genomes for read mapping may give only a distorted view of reality. b. burgdorferi s. s. belongs to a bacterial species complex  which currently comprises > <dig> named and proposed species. individual genospecies within the complex differ in their ecological niches in terms of reservoir host and vector associations  and in their ability to cause human disease  <cit> . the dynamic nature of the b. burgdorferi s.s. genome  may be important in terms of understanding the ecology and pathogenicity of b. burgdorferi s.l. in general and for individual strains in particular. pali and pabe were isolated from patients with different clinical manifestations and further investigations including a larger number of strains may reveal whether or not a common pattern in plasmid content or structure can be found in strains isolated from patients with different clinical manifestations.

CONCLUSIONS
the data accumulated in the present study are in agreement with previous studies that showed that the plasmid content and structure may vary between even closely related borrelia strains. importantly, it was noted that different next generation sequencing methods provide different details on the genome structure of the bacterial pathogens, even those belonging to the same mlst sequence type. a combination of different sequencing methods will therefore be the method of choice for investigating genetic elements that confer host- and vector-adaptations as well as differing levels of pathogenicity to tick-borne pathogens such as borrelia.

the genomic complexity shown in this and previous studies  <cit>  may reflect the ecological  <cit>  and/or humanpathogenic complexity of borrelia  <cit> . it raises the question of whether this is also the case in other human pathogenic or vector-borne bacteria, and may perhaps indicate that borrelia is an interesting paradigm for comparative genomics studies.

an important conclusion from our work is that some of borrelia’s plasmids, as opposed to its chromosome, appear dynamic. while it remains important to investigate the great variety of human pathogenic and non-pathogenic b. burgdorferi s.l. genospecies, it is already evident that the many plasmids of this spirochete are subject to a much greater degree of within-strain genetic variation than is the chromosomal component of its genome, even in strains that appear to be closely related in terms of chromosomal genes. since proteins conferring both virulence against mammalian hosts and competence to be transmitted by tick vectors are known to be encoded on plasmids  <cit> , methods for typing borrelia strains on the basis of their plasmids will be increasingly important in determining the risk of, and developing strategies to manage, lyme borreliosis.

additional files

additional file 1:  
tables s1–s <dig> and figures s1–s <dig>  

 
additional file 2: multiple plasmid alignments_b31_pabe_pali. 

 


electronic supplementary material

the online version of this article  contains supplementary material, which is available to authorized users.

