BACKGROUND
polymerase chain reaction -based typing methods are molecular diagnostic techniques widely used in biological and biomedical studies. the level of discriminatory power of pcr-based typing depends upon the molecular marker targeted. therefore, identifying appropriate dna target regions for primer annealing is a crucial step because these regions must be conserved within the target taxa but must vary among related taxa  <cit> .

recent advances in next-generation sequencing technology are enabling genome sequencing projects at a significantly lower cost, even for non-model organisms. the resulting increase in the amount of genomic data available, combined with bioinformatics tools, have led to the identification of highly informative markers, such as microsatellites and orthologous or taxa-specific genes  <cit> .

microsatellites or single sequence repeats  are tandem repeated stretches of short nucleotide motifs, usually ranging from  <dig> to 6 bp, ubiquitously distributed in the genomes of eukaryotic organisms. these regions are more prone to genetic variation and the differences in the length of individual ssr loci can be easily screened by pcr. in fact, this technique has been useful for several studies including strain typing and population genetics  <cit> . the conventional method of ssr discovery is time consuming and costly. therefore, in silico mining analysis has been used to improve marker identification  <cit> .

orthologs are homologous proteins in different species that evolved from a single ancestral sequence and are related by speciation events. these sequences tend to show more functional similarity than other homologs. the identification of orthologous genes is useful in a wide range of contexts, such as inference of gene function, comparative genomics, evolutionary conservation and sequence variability  <cit> . due to their importance, many tools have been developed to predict ortholog groups, including the widely used software orthomcl  <cit> .

the demand is increasing for bioinformatic tools that automate analysis of genomic data generated by next-generation sequencing technology  <cit> . an example is the development of automated procedures to facilitate species-specific primer design for diagnostic methods  <cit> . several web-based tools for facilitating primer design are available  <cit> , but many of them are written mainly to assist in the primer design process and are not meant to search for targets and analyze primer specificity. the use of fully automated methods to search for molecular markers and the availability of genomic data for a growing number of taxa would increase the efficiency of pcr-based genotyping applications. moreover, this strategy might save time and resources because the in silico evaluation of the candidate primers against the target genomic sequence are performed prior to testing them in the laboratory  <cit> . thus, there is a need for a tool to search for appropriate genomic target regions and then design specific primers towards the selected markers.

in this context, we have developed tipmt to meet the growing demand for easy-to-use software that facilitates the design of primers that target molecular markers to distinguish the genomic sequences of different taxa. this program only requires genomic sequences of a target species and offers, as an output, specific primers for a given taxa.

implementation
method summary
the aim of the software pipeline is to provide a set of primer pairs flanking polymorphic sequences to identify taxa among related species using pcr, given their genomic sequences. by taking advantage of sequence data from related species, the pipeline identifies orthologous and singleton  genes or ssr regions as target sequences that are likely to identify unique taxon or taxa. because primer specificity is a key step in a pcr reaction, the pipeline identifies all potential annealing sites for the primers selected based on alignment and thermodynamics. then, the tipmt evaluates compatibility among specific primers for designing multiplex pcr reactions. finally, the program generates a virtual gel with the result of a simulated standard or multiplex pcr assay, where taxa can be identified by the size variation of the predicted pcr products.

the program workflow is shown in fig.  <dig> and consists of the following steps: 1) the database with data required for the next steps is generated. in this step, the user provides the genomic sequences and defines the type of target sequences, orthologous genes or microsatellites, which are then extracted from each taxon; in this step, the user also defines the primer design constraints; 2) regions of target sequences with similarity to the other genomic sequences provided by the user  are masked; cross reaction genomes correspond to templates that should not cross-react in pcr assays; 3) candidate primers for each target sequence are designed; 4) the amplification profile of each taxon is obtained based on electronic pcr and the thermodynamic properties of the primers; 5) candidate primers are classified according to the number of taxa with amplicons; 6) the compatibility of specific primers in multiplex pcr reactions are checked; and 7) predicted pcr products for selected primers are visualized as virtual electrophoresis gels and analyzed.fig.  <dig> flowchart for tipmt analysis




user input data
tipmt is flexible because it accepts three different input data as target sequences: genomes, predicted genes and user defined target sequences. the user may provide sequences by uploading files in fasta format or entering nucleotide accession numbers, and then, corresponding sequences will be downloaded from the ncbi refseq database. there are two types of genomic sequences: target taxa and cross-reaction taxa. the former sequences will be used in the pipeline as templates for primer design and to check the specificity of the primers. the latter are sequences of species that should not cross-react during the pcr assays. regions in the target taxa that have similarities to sequences in the cross-reaction taxa are not targeted during the primer-designing step. the number of taxa analyzed in tipmt is not limited, but the processing time is substantially increased for each taxon added. for example, in the test using leishmania braziliensis and leishmania infantum genomes as templates on “ortholog target” mode run on a intel xeon x <dig>  <dig> ghz,  <dig> cpus and 8 gb ram machine, the software spent 12 h, while the execution with leishmania amazonensis, l. braziliensis and l. infantum genomes in the same mode run and machine spent 22 h.

the next step is the definition of the target sequences by the user, and each approach offers advantages. ssrs are highly polymorphic and tend to be conserved between closely related species  <cit> . these features enhance the success rate in the search for taxon specific primers. moreover, ssr targets only require genomic sequences. orthologs sequences are less error-prone than repetitive regions during genome assembly, thus the amplification failure tends to be lower compared to ssrs. additionally, conserved primers among closely related taxa are easily found using this approach and singleton sequences enable the search for taxon-specific primers. in the case orthologs target sequences, the user should provide the sequences of the predicted genes in the genome. also, users can have their custom sequences of interest be targets to design specific primers.

if the user chooses an ssr as a target, the pipeline will search ssr regions in the target genomes, and these regions will be the template sequences in the primer design step. on the other hand, if the user selects ‘ortholog target’, orthologous and singleton genes will be identified in the predicted coding regions provided by the user. finally, the user may choose to provide target sequences instead of using the tipmt target search mechanism.

lastly, the following primer design constraint parameters are defined: 1) mismatch and gap tolerance ; 2) pcr product sizes; 3) the number of primers per target ; and 4) minimal difference .

pipeline mechanism
tipmt is a web-based application that was written in perl language. the client side was built primarily in html markup language with dynamic parts written in javascript programming language, and java applets are used to input data and process files between the user and the application. the server side runs on php, and mysql database is used to store the input parameters and results.

the pipeline uses primer <dig> core  <cit>  as the primer design engine and is built around other public domain programs, such as bedtools  <cit> , bioperl  <cit> , blast  <cit> , emboss  <cit> , e-pcr  <cit> , mfeprimer  <cit> , multiplx  <cit> , orthomcl  <cit>  and progerf  <cit> . these programs are used in the processing flow from raw sequences to the list of primers in the following list of procedures:target search. one way to improve sensitivity in pcr is to find the most appropriate template region for primer design. ortholog and singleton sequences are identified in the predicted coding sequences provided by the user using orthomcl with default parameters values. progerf searches for ssr regions, without degeneration or gaps in the sequence .

mask similar regions. conservation of the flanking regions of the target sequences is essential for a high quality pcr assay because a high number of primer annealing sites can cause failure of the pcr assay  <cit> . similar regions between target sequences and cross-reaction genomes are identified using a megablast search with default parameters. megablast was chosen due to its speed and its ability to handle slight differences in genomic sequences. next, regions with more than 95% of identity are masked with lowercase nucleotides .

primer design. candidate primers are generated for each of the dna template sequences using primer <dig>  <dig> . <dig> with default parameters values and an option that rejects the primer candidates with lowercase letters in the first 3’ end position. because the high number of annealing sites influences primer specificity, this procedure decreases the rate of low-success specific primers, avoiding primer design in regions with similarity between species  <cit> .

specificity check. all candidate pairs of primers generated are evaluated for specificity using the alignment based e-pcr algorithm and by thermodynamic properties using mfeprimer software, with mismatch and gap tolerance chosen by the user. if both tools predict pcr products using the same pair of primers with same length, the pair of primers is selected for the next step.

primer classification. the program recovers all potentially useful pairs of primers for the differentiation of taxa. if a pair of primers has only one amplification product in only one target genome, it is defined as ‘specific’. if a pair of primers has one amplification product in at least one other genome, it is defined as ‘multiple’. if it amplifies the same size products in all genomes, it is named as ‘conserved’, but if the pcr products have different sizes in all genomes, then it is a ‘single’ primer. ‘single’ pairs of primers are capable of distinguishing all taxa in a simple pcr reaction because each has different sizes of amplification products in each genome.

compatibility check. specific primers are clustered into compatible groups for multiplexing pcr using multiplx, which tests all primer pairs for interactions, including dimer formation and differences in their melting temperatures.

gel visualization. after a set of primers is chosen, the relative electrophoretic migration distances are calculated based on the expected length of the amplification products. then, a virtual electrophoresis gel is generated showing the expected amplification profile as a result of a standard pcr assay using a mixture of target genomes as the template. another virtual gel is generated for the amplification profile of the multiplex pcr reaction, to check for interactions among primers that generate undesired alternative products.




pipeline validation
this pipeline was validated using genomic sequences and genomic dna samples from different species of the parasite leishmania. promastigote forms of l. braziliensis , l. infantum , l. amazonensis  and l. major  were cultured in schneider’s insect medium  supplemented with 10% inactivated fetal bovine serum  and 1%  penicillin/streptomycin and maintained at 24 °c. genomic dna was extracted from  <dig> promastigotes in logarithmic growth phase using a wizard genomic dna purification kit , resuspended in dnase-free water and quantified using a nanodrop spectrophotometer nd- <dig>  the genomic dna samples obtained from the different species of leishmania were used as a template in pcr amplification reactions with selected taxon-specific primers designed by tipmt . each pcr used 50 ng of dna template, 1x green gotaq reaction buffer , 200 μm dntps mix,  <dig> pmol of each forward and reverse primers, and  <dig>  u of taq dna polymerase . the samples were incubated at 94 °c for 5 min and submitted to 30 cycles of 94 °c , 63 °c  and 72 °c , followed by a final extension of 72 °c for 7 min. the pcr products were fractionated by electrophoresis in  <dig> % agarose gels in tae 1x buffer  with  <dig>  μg/ml ethidium bromide or in silver-stained 8% polyacrylamide gel in tae 1x.table  <dig> list of specific  and single  pairs of primers for in vitro validation

l. amazonensis

l. braziliensis

l. infantum
l. infantum, l. braziliensis and l. major
all primers were generated by tipmt on “ortholog target” mode using l. amazonensis, l. braziliensis and l. infantum genomes , or l. braziliensis, l. major and l. infantum genomes 




RESULTS
tipmt output
primers set
selected pairs of primers are classified in one of the four categories: specific, multiple, single and conserved. after the user chooses the categories, information regarding the primer characteristics is reported, such as primer sequence, melting temperature range  and pcr product length . additionally, users can choose a set of primers or save the primer information in a text file or visualize a virtual gel electrophoresis. the text file shows the following amplicon properties: 1) name; 2) forward primer sequence; 3) reverse primer sequence; and 4) primer melting temperature and amplicon size in each target genome. a list of the compatible pairs of primers that are optimal for multiplex pcr is also available to download.

virtual gel
after selecting a set of pair of primers, the user may choose to generate a virtual electrophoresis gel, a visual output with a simulated result of a conventional pcr e-gel or multiplex pcr e-mpx . in both cases, tipmt takes the set of pcr products and calculates their respective migration distances based on the length of the amplicons.fig.  <dig> real and virtual  gel electrophoresis for specific g <dig> pairs of primers  and single s <dig> pair of primers . each lane corresponds to the combination of genomic dna of leishmania species and pair of primers identified at the top of the gel . la: l. amazonensis; lb: l. braziliensis; li: l. infantum; lm: l. major; gdna: genomic dna; bp: base pair




in the e-gel function, the visual output is a simulated conventional pcr assay, where each lane is a reaction with one selected primer and a mixture of target genomes as a template. the e-mpx function generates another virtual gel with the amplification profile of the multiplex pcr assay, where each lane is a mixture of all selected primers and one target genome or all target genomes as the template.

multiplex pcr is a variant of pcr, which simultaneously amplifies many loci of interest in one single reaction by using more than one pair of primers. setting up a multiplex pcr with consistent quality is not trivial; therefore, tipmt generates a file with groups of specific primers that are compatible in a multiplex assay, based on primer–primer interactions and differences in the melting temperatures.

experimental validation

leishmania is a genus of flagellate protozoan that cause a broad spectrum of diseases, ranging from self-limiting localized cutaneous lesions to visceral leishmaniasis. more than  <dig> species of leishmania cause infection in humans  <cit> . despite the wide taxonomic complexity of this genus, the gold standard for diagnosing leishmania infections, parasitological assays, only discriminates genus, not species. the reference method for species identification is multilocus enzyme electrophoresis . however, this method has several limitations, including the relatively small number of characterized loci and the requirement of a parasite culture that potentially biases the results  <cit> . therefore, the development of new molecular diagnostic methods could allow for a rapid and accurate diagnosis of leishmania species in infection. this is particularly important in the context of leishmaniasis, since the distinction between leishmania species is important to provide the appropriate treatment and design the most effective control measures. this specific identification is especially relevant in areas where different species occur simultaneously causing human disease. finally, robust molecular markers might contribute to the characterization of parasite-specific features, such as virulence or drug resistance  <cit> .

we thus applied tipmt pipeline to the genomes of different species of leishmania to generated sets of primers for genotyping using multiplex pcr. first, we tested the pipeline using l. amazonensis, l. braziliensis and l. infantum genomes as templates on “ortholog target” mode and among all pair of primers generated, we chose the g <dig> set for in vitro validation . because in this search no pair of primer was classified as single, we re-ran the pipeline using l. braziliensis, l. major and l. infantum on “ortholog target” mode and we obtained the pair of primers s <dig> which was also used in in vitro experiments . we also generated pairs of primers using l. braziliensis and l. infantum genomes on ssr  or ortholog  target modes and selected  <dig> pairs of primer for in vitro validation .

the pcr gel electrophoresis profile revealed that the result of the real experiment was the same as that predicted by the virtual electrophoresis gel analysis .

comparison to other primer design applications
our tool was developed to receive two or more genomic data and output specific pairs of primers for each taxon analyzed. so, we compared tipmt to other similar web-based primer design tools that have similar characteristics: freely available, web-based and able to find specific pairs of primers from multiple sequences. tipmt was compared to batchprimer <dig>  <cit> , jpcr  <cit> , mpprimer  <cit> . a comparison of the main features of these tools is shown in table  <dig> table  <dig> main features of similar web-based primer design tools

tipmt offers a combination of features that are not present in any other web application: multiple sequences as input, identifies target regions automatically in a single run, tests the specificity with two approaches and generates a virtual electrophoresis gel as output




mpprimer is a web-based tool that designs specific multiplex pcr primers, uses thermodynamic theories to estimate the stability of the primers, and has functions for predicting a group of compatible multiplex primers and generating a virtual electrophoretic gel for each group. the main limitations of mpprimer are a limited and pre-defined list of genome databases  provided by the tool that are used for checking primer specificity and the lack of a mechanism to search for target sequences, which should then be pre-defined by the user. batchprimer <dig> allows users to design several types of primer, including generic primers, hybridization oligos, primers for ssr regions, snp genotyping primers and dna sequencing primers. the main drawbacks of the tool are: limited number of sequences  that can be used for primer design; no step for checking primer specificity; and the tool does not design primers for multiplex pcr. jpcr  provides primers for most pcr applications and tests the specificity using a quick local alignment screen between the reference database  and input sequence. however, the application is platform dependent , requires computational resources of the user and more computing power for large databases. also, jpcr only searches for ssr as target sequences.

tipmt offers a combination of features that are not present in any other available web applications. tipmt receives multiple sequences as input and identifies target regions automatically. moreover, primer specificity is tested by both alignment- and thermodynamic-based properties. furthermore, tipmt provides functions to generate a virtual electrophoresisgel for conventional or multiplex pcr assays. this output gives users a visual result before performing a real pcr reaction. finally, the identification of taxa specific pairs of primers from multiple genomic sequences is a straightforward analysis only in tipmt, since it is the only available tool that can find pairs of primers for multiple taxa in a single run using genomic data without prior definition of the target region.

CONCLUSIONS
the emergence of large-scale dna sequencing projects in recent years has produced large amounts of data, opening many opportunities for genomic analyses. here, we focus our attention on identifying molecular markers and designing efficient primers for taxa differentiation. the ideal pair of primers should be capable of distinguishing the target taxon and should not cross-react with other closely related species. toward this aim, tipmt receives genomic sequences as input and integrates the process of primer design, from the search for target sequences to the evaluation of primer specificity. as an output, the web-application generates a plain text file with general information on the pairs of primers, based on taxa-specificity. the output also includes an image showing the result of a simulated pcr assay with selected pairs of primers. finally, experimental validation shows the effectiveness of the proposed tool in finding a taxon-specific pair of primers.

the pairs of primers generated by tipmt are suitable for use in conventional or multiplex pcr assays, as determined by the parameter settings during the primer design step. furthermore, primer design principles for conventional pcr and real-time quantitative pcr are quite similar. thus, our tool could be used for designing primers for both methodologies by adjusting some parameters, such as pcr product size.

future versions of tipmt will consider multi-copy genes as targets to improve pcr sensitivity and will also receive raw sequencing reads as input. additional improvements may also be performed, for example, automatic ranking of ideal primers for multiplex pcr.

the application is platform independent, freely available and has a simple and user-friendly interface that allows for designing primers in a high-throughput manner, even for novice users. furthermore, tipmt web page has a “manual” section with a tutorial and running examples. tipmt can be applied to a broad spectrum of research topics including both molecular diagnostic and evolutionary studies.

availability and requirements
project name: tipmt, tool for identification of primers for multiple taxa

project home page: http:// <dig> . <dig> /tipmt/


operating system: platform independent

programming language: php, javascript, perl

other requirements: web browser 

any restrictions to use by non-academics: no license needed

additional files

additional file 1: table s <dig>  list of specific pair of primers for in vitro validation. all primers were generated by tipmt using l. braziliensis and l. infantum genomes on “ssr target” mode  or “ortholog target” mode . 


additional file 2: figure s <dig>  real and virtual  gel electrophoresis for ssr  and orthologs  primers. each lane corresponds to the combination of genomic dna of leishmania species identified at the top and a mixture of the orthologs  or ssr  primers in a multiplex pcr assay. lb: l. braziliensis; li: l. infantum; gdna: genomic dna; bp: base pair. 




abbreviations
blastbasic local alignment search tool

htmlhypertext markup language

phpphp hypertext preprocessor

refseqreference sequence

