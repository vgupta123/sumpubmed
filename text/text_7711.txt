BACKGROUND
nitrogen serves a critical role in the metabolism of all organisms. as a key component in nucleic acids and proteins, it is required for healthy growth and it is often one of the most limiting nutrients for optimal yield. human intervention via the haber-bosch process for the production of ammonia has greatly shifted the global nitrogen cycle, however many ecosystems still rely heavily on biological nitrogen fixation. one such ecosystem is in the open ocean, which is a nutrient-limited environment and organisms that thrive here have evolved to thrive in deplete conditions. trichodesmium is a genus of filamentous diazotrophic  cyanobacteria that not only flourishes in this environment but provides bio-available nitrogen for surrounding species. trichodesmium is responsible for fixing roughly  <dig> tgny- <dig> of nitrogen annually   <cit>  and has been reported to ‘leak’ 30-50% of the nitrogen it fixes  <cit> . the genus is ubiquitous in marine environments; it is found in environments as diverse as the mediterranean sea  <cit> , the pacific ocean , and the great barrier reef where it has implications not only as a source of nitrogen, but also as a center for eutrophication  <cit> . it dwells primarily near the surface  <cit>  and can swell to occupy acres of the ocean or sea. despite its prominence in the global nitrogen cycle, most research efforts have focused on in situ sampling and therefore little has been done to model and or predict the effect of different environmental factors on the growth and nitrogen fixation rates in trichodesmium.



trichodesmium is a colonial cyanobacteria which grows in multicellular filaments called trichomes, each containing about  <dig> cells  <cit> . trichodesmium is a non-heterocystous cyanobacterium which means it does not employ specialized cells  for nitrogen fixation. instead, nitrogen fixation and photosynthesis can occur within the same cell. most non-hetrocystous cyanobacteria separate oxygen producing photosynthesis from nitrogenase by using temporal separation; they fix nitrogen at night when the cellular metabolism is in respiration mode . trichodesmium is unique in its mechanism to fix nitrogen, it fixes nitrogen during the day while simultaneously fixing carbon via photosynthesis. respiration rates in trichodesmium are reported to be higher than other cyanobacteria, which ensures a micro- or anaerobic environment and thus minimizes the potential poisoning of nitrogenase by oxygen  <cit> . nitrogenase is only expressed in a subset  of cells consecutively arranged in the middle of the trichome. these diazotrophic cells only express photosystem i because photosystem ii produces oxygen . current characterization of trichodesmium is limited predominantly to population level observations due to its genetic intractability and difficulty to culture. while several laboratory studies investigating the complex genome , transcriptome  <cit> , and proteome  <cit>  have been published, most relate to populations level or sparse in situ studies in diverse, non-ideal growth conditions. a handful of other recent studies report on the morphology/structure of the cells  <cit>  and how cells respond to iron, nickel, and other nutrient stresses . despite the availability of these studies, they are limited in scope and do not provide a complete picture of trichodesmium on a cellular scale. the long doubling time , low growth density  , and lack of genetic tools have limited laboratory based research on trichodesmium, especially compared to other diazotrophic cyanobacteria such as anabaena and cyanothece.

this work presents the first genome-scale reconstruction of a colony forming diazotrophic cyanobacterium, t. erythraeum, a leader in marine nitrogen fixation. it models biological optimization of metabolic exchange and biomass creation through flux balance analysis  and flux variability analysis   <cit>  to predict the different metabolic behaviors of the two cell types formed by t. erythraeum, nitrogen fixing cells and photoautotrophic cells, constrained by laboratory or published data/observations. the models described in this work illustrate how t. erythraeum divides labor between two cells stoichiometrically and applies the first step towards a multi-objective framework of these bilaterally operating cells. these results are extended to understand overall population compositions and metabolite production rates to visualize what role metabolite passage plays in formation of these complex colonies via dynamic flux balance analysis   <cit>  and a population co-optimization algorithm. this model lays the foundation for future colonial cyanobacteria characterization and integration with in situ and transcriptomic data for t. erythraeum.

RESULTS
biomass composition and growth rates
cells were grown in ybc-ii medium in ambient air  or supplemented with either  <dig> μ mol kno <dig> as a nitrogen source. growth was monitored by measuring total chlorophyll content . these data were then used to calculate the growth rate and doubling time assuming exponential growth .fig.  <dig> growth curves and biomass compositions of t. erythraeum. cells were grown with either ambient air  or potassium nitrate  as the nitrogen source in ybcii medium and growth was monitored by measuring total chlorophyll a content. a) growth curves of cells in different nitrogen sources and computational growth. error bars represent standard deviation from  <dig> biological replicates. b) biomass composition of t. erythraeum. the major elements of biomass were measured directly from cultures grown on diatomic nitrogen  or potassium nitrate. error bars represent standard error from  <dig> biological replicates



kno3
reported error is standard error σn where n =  <dig> biological replicates




the biomass composition of t. erythraeum was measured in order to formulate an accurate biomass formation equation. the composition of cells grown on both ambient air and nitrate were measured . we attempted to grow cells on ammonium because we hypothesized that this would remove the necessity of diazotroph formation and enable all the cells in the trichome to be carbon-fixing. this would allow biomass measurement of photoautotrophs directly; however, growth on ammonium in the laboratory was not possible as seems to be consistent with some other cyanobacteria. therefore we used the composition of cells grown on n <dig> as the average biomass composition for all subsequent modeling efforts.table  <dig> biomass composition of t. erythraeum


n2
phycoerythrina
cyanophycina
phycocyaninb
chlorophyllb
the biomass equation is the molar concentration of the metabolite predicted by the computational molar mass and uses the values from the ambient air  grown cultures. the “soluble pool” is a collection of soluble metabolites that are more or less conserved between organisms for survival  asubset of protein measurement. bsubset of lipid measurement




network reconstruction and manual curation
reconstructing a complete genome-scale metabolic network from a genomic sequence required several iterations. the first draft of the network was created using an automated genome-scale model algorithm, the seed rast  <cit>  and contained  <dig> reactions. automated metabolic network reconstructions rely on homology to well characterized and annotated model organisms such as e. coli or s. cerevisiae. therefore, the unique metabolic pathways for photosynthesis and nitrogen fixation were not accounted for in the initial draft. the initial automated draft had several gaps and missing reactions, therefore several iterations of manual curation were necessary to fill in missing reactions and infer the presence of reactions that were not predicted based on homology to model organisms. first, we focused on closing the balance on reactions associated with biomass and cellular energy pathways ; this was done by referencing metabolic pathway databases such as biocyc  <cit>  and kegg  <cit> . we then compared our draft network to genome scale reconstructions of other related organisms, including cyanothece atcc  <dig>  <cit> , synechocystis sp. pcc  <dig>  <cit> , synechococcus sp. pcc  <dig>  <cit> , arabidopsis thaliana  <cit> , phaeodactylum tricornutum  <cit> , and chlamydomonas reinhardtii  <cit> . through comparison, we added more photosynthesis-specific metabolic reactions which were predicted to be present in the genome based on blast results. finally, transport reactions included in the model were selected based on proteomic data or diffusion   <cit> . manual curation efforts built the model out to a maximum of  <dig> reactions; closer inspection of the reactions revealed that several were predicted by the seed algorithm but had no significant homology to the t. erythraeum genome and were non-essential, therefore they were removed. the current draft of the genome-scale metabolic model  for t. erythraeum contains  <dig> reactions:  <dig> biomass formation equation ,  <dig> macromolecule synthesis and condensation reactions,  <dig> exchange reactions,  <dig> transport reactions , and  <dig> metabolic reactions. these reactions involve  <dig> unique genes and  <dig> metabolites. despite our manual curation efforts, the model still has  <dig> dead end reactions:  <dig> are involved in lipid, amino acid, or pyrimidine/purine metabolism and are bypassed by summary reactions . manual curation of the model led us to identify  <dig> genes which are present in the genome based on homology but not annotated,  <dig> genes encoding enzymes with related functions we assume to be promiscuous and  <dig> gene which is required for the production of biomass but was not present in the genome based on homology .table  <dig> unannotated metabolic reactions in the t. erythraeum genome but included in the model based on homology to related organisms and/or to close gaps for biomass formation

nitrosococcus oceani
amborella trichopoda
dehalococcoides mccartyi vs
candidatus nitrososphaera gargensis
t. erythraeum
dihydroneopterin ppp



flux balance analysis
a t. erythraeum trichome is made up of cells with two distinct metabolic modes: photoautotrophic and diazotrophic. each cell type was modeled separately and thus required a different set of constraints to define the cell type. the specific constraints applied to each cell type based on literature and experimental data are provided in the methods section . growth associated atp demand is assumed to be identical to cyanothece sp. atcc  <dig>  <cit> :  <dig> mmol atp - <dig>  maintenance energy, represented by the reaction en_atp: atp + h2o → adp + h+ + pi was adjusted until the predicted growth rate matched published experimental growth rates   <cit> . maintenance energy demands were found to be:  <dig>  mmol atp - <dig> for photoautotrophs and  <dig>  mmol atp - <dig> for diazotrophs. we hypothesize that this number is significantly higher than heterotrophic bacteria for two reasons:  maintaining a micro-aerobic or anaerobic environment in the cells for nitrogenase is energetically demanding and  we do not constrain the photon absorption beyond the amount provided to the cells in the laboratory despite knowledge that cells aren’t 100% efficient at light harvesting. the cobra toolbox  <cit>  was used to evaluate the biomass yields for each cell type separately subject to published growth rates, carbon dioxide uptake, and nitrogenase activity . an .m file to run the model in matlab with appropriate constraints has been included in the supplemental files .table  <dig> predicted yields and selected fluxes for t. erythraeum

biomass and exchange differences between the two cell types are a result of different sources of energy. the carbon mass percent  is identical for both cell types because the same biomass formation equation was used 




flux maps were generated in order to visualize carbon trafficking within the cell for both cell types  subject to the constraints specified in table  <dig>  as expected, the model for a photoautotrophic cell exhibited high flux through the non-oxidative pentose phosphate pathway and gluconeogenesis. moreover, the highest recorded flux is through ribulose- <dig> -bisphosphate carboxylase/oxygenase , the enzyme responsible for carbon fixation. the tca and glyoxylate cycles are partially inactive; the majority of energy is produced through lower glycolysis or photosynthesis and the tca cycle’s main utility is in precursor biosynthesis. the diazotroph, on the other hand, has higher flux in the pathways associated with respiration: the oxidative pentose phosphate pathway and tca cycle in particular displayed substantial activity. the glyoxylate shunt also has high flux, indicating crucial differences in how metabolism is regulated in the different cell types.fig.  <dig> predicted central metabolic fluxes for  diazotrophic and  photoautotrophic cells of t. erythraeum. flux balance analysis was used to predict fluxes for both metabolic modes in a trichome of t. erythraeum. the thickness of the arrows depicts the amount of flux through the reaction normalized to the uptake of the carbon source. dotted gray lines are available unused pathways. diazotrophic cells have high flux through respiratory pathways, this protects nitrogenase from oxygen. as expected, photoautotrophic cells have high fluxes in the calvin benson basham cycle, which is the carbon fixing pathway. abbreviations for metabolites are provided in abbreviations section. full catalog of fluxes are provided in additional file 5: table s5




another utility of a fba model is the ability to predict essential genes. we performed an in silico gene knockout analysis and identified  <dig> genes as essential in phototrophic cells and  <dig> in diazotrophic cells . essential genes are frequently linked to biomass relevant compound synthesis , carbon and/or nitrogen fixation, or glycolysis. genes and reactions which decrease growth rate but were not lethal were frequently linked to central carbon processing. these gene knockout results are corroborated by reaction analysis, where reactions are removed from the model instead of genes; this analysis found  <dig> reactions essential in a photoautotroph and  <dig> in a diazotroph . most reactions overlapped, but  <dig> carbon fixation reactions and  <dig> gluconeogenesis reactions were unique to essentiality in photoautotrophs while ammonium output and  <dig> nitrogen fixation reactions were unique to diazotrophs. unfortunately, t. erythraeum has not been reported to be genetically tractable and therefore it is not possible to experimentally validate these results.

flux variability analysis 
flux balance analysis uses optimization techniques to predict fluxes in the cell, but most  genome-scale models are underdetermined so there exists the possibility of multiple flux distributions that lead to the same solution . to evaluate the flexibility in our model, we performed flux variability analysis  to estimate how much variability a particular reaction can tolerate and still give the same solution. enzymes, selected from important pathways and by comparing different metabolic distributions in the diazotrophic and photoautotrophic fba, are shown in fig.  <dig> and a table of bounds provided as additional file 7: table s <dig>  overall, photoautotrophic cells display tighter metabolic regulation and have required flux through every major pathway except for nitrogen fixation. in comparison, the diazotrophic model displays high variability through these central pathways with the exception of nitrogenase function. for the photoautotrophic model, two genes exhibit fully nonzero flux: phosphoglycerate kinase  and ribulose- <dig> -bisphosphate carboxylase/oxygenase . otherwise, two genes, d-fructose- <dig> -bisphosphate d-glyceraldehyde 3-phosphate lyase  in upper glycolysis, and sedoheptulose-7-phosphate: d-glyceraldehyde-3-phosphate  in the pentose phosphate pathway exhibit wide ranges with tagsfe possibly functioning in both directions while the same optimum is achieved. the complete tricarboxylic acid  cycle is invariably nonfunctional for energy metabolism in optimization of the photoautotrophs  and only functions for precursor biosynthesis. diazotrophs ultimately demonstrate more variability due to their energy source as more redundancy exists in carbon oxidation than in photosynthesis: all reactions can accommodate zero flux except nitrogen fixation. fpal and tagsfe both show reversibility . although there are similar patterns in the different cell types, energy metabolism is significantly different.fig.  <dig> allowable variation in flux for central metabolic reactions. bars visualize the flux variability through important pathways. . blue/lined bars are diazotrophic fluxes and green/solid bars are photoautotrophic fluxes. high variability implies adaptable responses while low variability implies a narrow essentiality for biomass and energy generation. greater variability was displayed between cell types in similar pathways including glycolysis , the calvin cycle  and nitrogen processing  while smaller variability was through the tca cycle  and the glyoxylate shunt . non-zero fluxes were found for the photoautotroph in pgk and rubisco while reversibility was found in both cell types for fpal and tagsfe. greater variabilities through carbon processing were due to redundancies in cellular processing, while less variability or non-zero variability was found in non-redundant pathways like carbon and nitrogen fixation. abbreviations are found under “enzymes” in the abbreviations section




dynamic flux balance analysis
dynamic flux balance analysis  was conducted to predict how well the model performed when compared to laboratory experiments using the same data to constraint the model as reported earlier . no additional constraints on diatomic nitrogen or carbon dioxide uptake were applied except for the demand from the other cell type we used the dfba model to test a number of different growth conditions and hypotheses. first, to predict the equilibrium trichome composition, the model was run with an inoculum of equal parts photoautotrophic and diazotrophic cells. once equilibrium was determined, initial concentrations of each cell type were calculated from experimental data and the simulation was re-run to validate that the most efficient growth and metabolite production occurred at this equilibrium. the resulting colony fractions to which the cells invariably converged were found to be  <dig> : <dig>  diazotrophs:photoautotrophs, similar to experimental evidence  <cit> . to understand how the initial inoculum effects the lag phase of the cells, we ran simulations for a number of different inoculums. given that the algorithm requires a sequential progression of metabolism , a “grace period” of  <dig> time steps was built in where the cells could borrow substrates from an arbitrary cache in their environment so that they could grow initially. however, if a population is unable to produce metabolites or biomass after those three consecutive time steps, the cells were assumed to be unviable and were terminated. how the growth rate evolves over time to reach the experimental value  is shown in fig.  <dig>  the expected growth rate is obtained rapidly for near-equilibrium starting populations  and more slowly for populations far from equilibrium . populations of 0: <dig> and 100: <dig> were nonviable. more detailed figures of how the model predicts composition changes when far from equilibrium is shown in fig.  <dig> with initial equality of cell types. cells appear to have three distinct growth phases, the first where they are adjusting their ratios to move closer toward equilibrium  while not able to leak metabolites. when the cells are near equilibrium , they are able to grow exponentially, but are unable to leak ammonium consistent with their exponential growth . when they finally reach equilibrium, growth and ammonium leakage is exponential, indicating most efficient growth. in the dfba model, photoautotrophic cells are unable to grow without diazotrophic cells and vice versa; however, if the models are optimized assuming nutrient unlimited environments , the photoautotroph can grow at a rate of  <dig>  h- <dig> and the diazotroph can grow at a maximum rate of  <dig>  h- <dig>  from these results, the equilibrium found in nature and this study represents the best-case growth scenario for t. erythraeum; this growth appears to be stoichiometrically and metabolically motivated instead of regulated through other means.fig.  <dig> growth rate evolution at different initial compositions. the growth rate between time points, taken by measuring biomass generated by dfba at ti = t and tf = t +  <dig>  was plotted versus time. each line represents a different initial composition as listed on the graph . all other conditions were held equal, and carbon uptake and nitrogen fixation were adapted from physiological data over  <dig> h intervals. the gray line represents the initial composition being set to the equilibrium composition. growth was unachievable at initial compositions of 0: <dig> and 100:0


fig.  <dig> computational population rates for t. erythraeum. dotted blue lines indicate diazotroph or fixed nitrogen, green lines indicate photoautotroph or glycogen. a fraction of population for each cell type. three phases of growth are present: linear redistribution of cells to create enough photoautotrophs, steady preferential allocation to photoautotrophs to drive biomass generation, and achievement of equilibrium. equilibrium is  <dig>  diazotroph and  <dig>  photoautotroph. b growth rates of each cell type. biomass is modeled using a batch reactor model with growth rate determined by fba using the genome-scale reconstruction and time steps of  <dig> h. c medium concentration for metabolites. these indicate the metabolite accumulation in the medium as determined by the amount of metabolite produced by each cell type less the metabolite consumed plus the amount of metabolite already existing in solution. d total growth rate of population. this is the total growth rate and is plotted with experimental growth rates in fig.  <dig>  it is calculated by adding the two biomasses in b together




this experiment generated several important parameters to compare against literature. intercellular metabolite production, cell fraction, and percent released of total fixed nitrogen were all predicted using dfba. the model was run for  <dig> iterations with different inoculum compositions to investigate the effect of initial compositions of population development. the generated values for an ideal population  are summarized in table  <dig>  the model over predicts nitrogenase flux - <dig> for the model versus  <dig>  mol n <dig> - <dig> for published measurements but is similar to literature values for carbon dioxide exchange - <dig> for the model versus  <dig>  mol co <dig> - <dig> for laboratory results)  <cit> . the model resulted in a total biomass of  <dig>  mg/l when simulated at equilibrium starting composition, compared to the 10– <dig> mg/l found in our laboratory experiments. variability in growth occurred as illustrated in fig. 6: growth rates peaked at  <dig>  h- <dig> for growth rate as expected due to constraints  at initial cell fractions of  <dig>  diazotrophs:  <dig>  photoautotrophs). initial diazotroph concentrations at zero resulted in no growth while photoautotroph dominated inoculums had the minimum nonzero values of  <dig> ⨯10- <dig> h- <dig>  fixed nitrogen release rate distributions and growth rate distributions through all iterations are illustrated in fig. 7a and b respectively.table  <dig> productivities of t. erythraeum according to literature, laboratory experiments, and the dfba model

ne corresponds to exported nitrogen in the form of ammonium


fig.  <dig> growth rate at different initial compositions. the average growth rate dependent on different relative values of diazotroph to photoautotrophic cells.  <dig> iterations were generated with random values of initial biomass for each cell type. the initial fraction was calculated using the ratio of these two randomly generated numbers and dfba was run for  <dig> h to simulate population development over that time period. where growth rate was zero over three or more time steps  or the cells were unable to manufacture their own nutrients, cell death was assumed and occurred at zero for initial fraction of diazotroph. optimal growth was found at  <dig>  and suboptimal non-zero growth was found with diazotroph dominated initial populations. the bracket and asterisk refers to the literature predicted equilibrium concentration of cells


fig.  <dig> nitrogen and biomass production based on variable initial cell concentrations.  <dig> iterations were run with randomly generated initial biomasses of each cell type and run for  <dig> h to simulate laboratory measured behavior. a fraction of fixed nitrogen released calculated by the average amount of fixed nitrogen accumulated in the medium of a batch reactor model divided by the average fixation rate over the time period. values are clustered between 25% and 45% except for non-growth cases where no nitrogen was released because death was assumed. b growth rate over all iterations. non-growth cases resulted in zero, but otherwise a bimodal distribution existed. this can be coupled with  <dig> : <dig>  diazotroph: photoautotroph ratio determined by simulation.photoautotroph ratio determined by simulation. the dotted black line refers to laboratory measured growth at  <dig>  h-1





finally, dfba was conducted to investigate the effect of different nitrogen sources on the growth rate of t. erythraeum. all other constraints on the mode were held constant and the resulting growth curves are given in fig.  <dig>  as expected, growth rates increase with increasing levels of nitrogen reduction and carbon in the nitrogen source. unfortunately, growth on nitrogen sources other than n <dig> or no <dig> have proven to be problematic and there is no evidence of t. erythraeum’s ability to utilize other nitrogen sources.fig.  <dig> predicted in silico growth rates on different nitrogen and nitrogen/carbon sources. each line represents an excess of a compound. the slowest rate is given by ambient nitrogen which is the same set of values used for the computational curve. the accompanying table relays growth rates and nitrogens or carbons in the source




discussion
in this work, we present a genome-scale metabolic network reconstruction of t. erythraeum which has been experimentally validated and used to predict growth under a variety of conditions.

experimental data
an important aspect of any metabolic model is to collect experimental data to aid in the development of the model  and for validation . major biomass constituents were measured experimentally with direction from literature to define the scope of the biomass constituents . it should be noted that t. erythraeum differs from other nitrogen fixing organisms and cyanobacteria. species like cyanothece and anabaena either temporally regulate nitrogen fixation using circadian rhythms or through spatial segregation by forming special cells called heterocysts. t. erythraeum, while it does exhibit some circadian regulation  <cit> , can fix nitrogen at all times, day or night. it does form two cell types, but the only evidence of different structures is indicated by accumulation of starches  <cit> . cyanophycin granules exist, but are distributed throughout the cells, indicating that they are nitrogen storage compounds rather than structural devices. after assessing the literature based behavior of t. erythraeum and its differences from other bacteria, biomass was evaluated when grown on nitrogen or nitrate. the existence of two separate cell types  within a trichome implies a locally nitrogen limited and nitrogen replete environment. we sought to mimic these effects. as expected, the nitrogen provided to the cell culture has a significant impact on biomass composition, and cells partition their carbon in different ways depending on availability of reduced nitrogen. since the reduction of diatomic nitrogen to ammonia requires a large amount of energy , it is likely that the cells activate their nitrogen sparing mechanisms in order to limit the amount of nitrogen needed for growth. this is evident in the ratio between carbohydrates and lipids , which is significantly lower – only 54% – in cells grown on diatomic nitrogen compared to those grown on nitrate. this is similar to reports of algae which accumulate lipids in response to nitrogen starvation . here, we assume that growth on diatomic nitrogen causes the cells to act like nitrogen is limiting. cells grown on nitrate have an increased protein content, again highlighting that the cell is no longer acting as if nitrogen is limiting. this increase in protein is also commensurate with an increase in the major photosynthetic pigment-protein complex phycoerythrin. cultures grown on diatomic nitrogen convert their fixed nitrogen to higher quantities of cyanophycin, a molecule used for nitrogen storage. meanwhile, this study also sought to characterize the laboratory growth rate of t. erythraeum grown on different sources of nitrogen. unfortunately, t. erythraeum showed a reticence to grow on ammonium in the laboratory and has no evidence of a putative transporters for amino acids, commensurate with heuristic knowledge of other cyanobacteria, which limited this experimentation. even so, growth rates are similar to previous laboratory measurements  but are dissimilar to in situ studies with values measured as low as  <dig>  × 10- <dig> h- <dig> in the north atlantic  <cit> . this is not surprising, it is well known that the open ocean is extremely nutrient deplete and thus a challenging growth environment. also, our measurements of growth on different nitrogen sources do not indicate a statistically significant disparity in growth rate based on nitrogen source despite significant changes in cellular composition. as such, the data implies that nitrogen availability is not the major limiting factor in cellular growth. this is supported by literature which demonstrates that t. erythraeum is much more efficient in higher co <dig> concentrations  <cit> . this means that the major effect of nitrogen source is on cellular composition and implies that carbon fixation is the growth limiting function of t. erythraeum.

metabolic network reconstruction
equipped with a high-level biological understanding of the organism, a genome scale reconstruction was built using the annotated genome, enzyme databases, models of related organisms, and the laboratory biomass measurements. the first draft of the genome-scale metabolic network for t. erythraeum was created using the seed rast algorithm  <cit>  followed by manual curation. manual curation was conducted by adding all possible reactions predicted by databases, similar organisms, and gaps based on data in primary literature and publicly available databases  <cit> . this was pruned to the current model  by vetting each reaction through blast and essentiality. these numbers are comparable to metabolic network reconstructions of similar organisms . reactions relating to central metabolism, including carbon fixation, glycolysis, the tca cycle, photosynthesis and the pentose phosphate pathway, are conserved between t. erythraeum and the other cyanobacteria listed in additional file 8: table s <dig>  biomass equations were based on the cyanothece atcc  <dig> model  <cit>  for lipid and protein formation. the reactions were mass balanced to predict molar masses, and the biomass measurements were interpreted using these computational predictions. finally, closure was obtained through proteomic assessment of transport reactions in conjunction with the metabolic network and biomass equations. overall, the manually curated model of t. erythraeum is a strong summary of the majority of metabolic processes and relates well to previous models.

one of the more challenging aspects of building a metabolic network of a non-model organism is the lack of  genome annotation. however, in performing a genome-scale reconstruction, shortcomings in annotation can be identified. in order to achieve closure,  <dig> reactions were added that are not linked directly to a gene in the t. erythraeum genome by assuming enzyme promiscuity, hypothetical protein function, or a lack of evidence for its existence. to validate or refute the presence of these genes in the genome, we did extensive blast analysis with related organisms with more complete annotations . we identified  <dig> genes encoding enzymes which had evidence of the desired function but were annotated differently ; we assumed these enzymes to be promiscuous and perform the necessary functions to fill gaps in the network. these assumptions were possible because the genes are often found to have redundant or generic function . we identified an additional  <dig> genes which were previously unannotated but are predicted to be present in the t. erythraeum based on homology to related organisms . most of these genes encode enzymes associated with the glyoxylate cycle, aminotransferases, and amino acid metabolism. again, some of these enzymes have traditionally exhibited generic behavior , but other enzymes were unannotated due to their single-function synthetic purposes . interestingly, enzymes associated with the glyoxylate cycle show the most similarity with ammonium oxidizing bacteria. the aminotransferases and amino acid metabolism enzymes, which generate some of the carbon molecules that participate in the glyoxylate cycle, show most similarity to other colony forming cyanobacteria like leptolyngbya and nostoc. this indicates that nitrogen metabolism may have impacts on peripheral carbon metabolism that merits future investigation. finally, one enzyme which was necessary for the model to produce biomass, -pantoate: nadp+ 2-oxidoreductase , was not found to be present in the genome. this implies that t. erythraeum may have evolved an alternative pathway which has not yet been identified, or that the synthetic route for -pantoate has significant structural differences. main pathways included in the model along with the several of the newly annotated enzymes are presented in fig.  <dig>  confidence levels in the model reflect the strength of prediction of the enzymes, with ones referring to the enzymes discussed above.fig.  <dig> genome scale reconstruction and filled pathways. the green cell is the photoautotroph, the blue cell is the diazotroph. red arrows indicate missing pathways; appended genes indicate blast derived genes. zoomed out sections are pathways that were completed. omissions are summarized in table  <dig> and describe amino acid metabolism and secondary carbon metabolism as the majority of gap-filled reactions. only  <dig> . <dig>   had no significant correlation to another t. erythraeum or related organism enzyme




predicting central metabolic fluxes
with a vetted series of metabolic interactions, the model was used to study whole-cell behavior for both diazotrophs and photoautotrophs separately using flux balance analysis . the two cell types share the same genome but have distinct metabolisms based on differences in regulation due to cellular differentiation: diazotrophic cells provide biologically available nitrogen for the community and photoautotrophic cells provide a reduced carbon source, in the form of glycogen, to the diazotrophs. to model metabolic fluxes for each type of cell, we developed two sets of strict constraints  to reflect the laboratory constraints measured by literature  <cit> . we fit the predicted growth rate from the model by changing maintenance energy and used metabolite production  as the objective equation to ensure satisfaction of both objectives. as expected, flux distributions were specific to cell type. carbon fixation is central to photoautotrophic function and is evident by high flux through the calving benson bassham cycle. for diazotrophs, the absence of photosystem ii requires a functional tca cycle for production of cellular energy. interestingly, the oxidative pentose phosphate pathway was preferred over glycolysis, likely due to minimizing carbon oxidation and/or redox balancing. this same phenomenon explains the activation of the glyoxylate shunt which has evolved to conserve carbon . the flux maps envision crucial, but expected, differences in metabolism between cell types that are similar to previous findings.table  <dig> constraints for each cell type in model simulations for fba and fva


hν
psi
psii

hν
psii
psi
+



gene and reaction essentiality were also performed using the same constraints and agree well with flux balance analysis  and gene essentiality in related organisms. essential genes include carbon fixation, biomass synthesis, and central metabolism  for photoautotrophs and nitrogen fixation, biomass synthesis, and carbon oxidative cycles for diazotrophic cells. most notably, ammonium export is required for biomass production in diazotrophs, predicting that ammonium leakage is necessary for redox/energy balancing in these cells. these findings correlated with previous studies which find that photosynthetic pigments and certain amino acid pathways are essential  <cit>  while some carbon metabolism like the later parts of the tca cycle are dispensable in cyanobacteria  <cit> . the model is effective, then, in in silico predictions of essential and conserved metabolic motifs.

the flux maps we present here represent only a single possible solution due to the underdetermined system used for optimization. to assess the bounds and possible adaptations of the model, fva was conducted and visualized for important pathways . the photoautotrophic cells showed much tighter bounds for central metabolic processes than their diazotrophic counterparts, likely because their metabolites  require roughly  <dig> atp/mol as opposed to ammonium which requires  <dig> atp/mol  plus additional maintenance energy. consistent with gene essentiality and intuition, ribulose- <dig> -bisphosphate carboxylase/oxygenase  requires a non-zero flux to maintain optimal behavior. phosphoglycerate kinase  – which is in lower glycolysis/gluconeogenesis – is a less intuitive non-zero reaction, but the reaction represents an important step in both optimal carbon oxidation and reduction. for both cell types, d-fructose- <dig> -bisphosphate d-glyceraldehyde 3-phosphate lyase  and sedoheptulose-7-phosphate: d-glyceraldehyde-3-phosphate , which correspond to reactions in upper glycolysis and the non-oxidative pentose phosphate pathway, show high variability; tagsfe can even function reversibly while maintaining optimality. otherwise, the photoautotrophic cells have zero or near-zero flux for all tca_cycle enzymes  because of a lack of electron donors available for carbon oxidation. glutamine synthase  displays a small flux for ammonium metabolism and incorporation while pep carboxylase  can accommodate flux using its role as an alternative to rubisco for single-carbon incorporation. in the diazotrophic cells, pyruvate kinase  and glutamine synthase  exhibit high flux capacities due to their substrates being precursors for many essential metabolites in the cell and the energetic latitude given by the reduced carbon supply, but are irreversible. tca cycle has intermediate flux capacity because the reactions in it represent best-case processing for carbon oxidation, while the glyoxylate shunt  is used for carbon conservation . diazotrophic metabolism only has one significant deviation: the flux through the nitrogenase enzyme is invariable. these data are similar to findings for other photoautotrophic and diazotrophic organisms  <cit>  and illustrate similar conserved energetic and metabolic behaviors.

modeling equilibrium colony composition
simulations to this point showed the metabolic differences between the cell types, but had not accommodated their function as a community. for this reason, dynamic fba  was used to expand the study to simulate how gene-predicted metabolism causes higher order community behaviors. previous studies have used dfba for similar applications, including diauxic growth in e. coli and the competition between rhodoferax and geobacter  <cit> , but this study presents the idea of dynamic allocation of cells based on metabolite production to simulate need-based differentiation. since all cells are defined by the same genome, differentiate based on the needs of the community and are invested in the viability of surrounding cells, there is a third level of interaction within these communities. to model this, diazotrophs and photoautotrophs were treated like separate, symbiotic, interdependent populations that could achieve perfect diffusion of substrate. then, based on the deficiency of one metabolite, cells would be allocated from the deficiency generating cell  in proportion to the shortage to correct it. if there was only metabolite surplus, all excess cells from the diazotroph would be allocated towards photoautotrophic production which was implied to drive biomass growth. this was run with both this and the opposite assumption  with identical results, meaning that this assumption was an artifact of the algorithm rather than a pivotal administration. importantly, this algorithm requires the photoautotrophs to act by generating biomass and enough glycogen for the prior generation plus a predictive amount based on growth rate before the diazotroph reacts and creates ammonium. therefore, the model can inappropriately fail since metabolites are not being simultaneously synthesized. the model was “seeded” with initial ammonium and glycogen substrates that served to prevent this from affecting the model with a “grace period” of three time steps to allow the model to correct the initial “loan” from the environment. once the algorithm was developed, it was used to interrogate population efficiency by determining equilibrium compositions of cells, predicting metabolite excretion fluxes, and to predict the effect of changing environments on the cell . the laboratory imposed constraints used for fba were converted to relaxed, optimal constraints to reflect the lower growth rates measured in our lab. when optimized independently, assuming replete nutrients for each cell type, both cells grow much faster than in limited, co-dependent conditions . this is logical: when nutrients are limited overall growth is limited. another observation is that photoautotrophic growth is slower even ideal conditions, reinforcing the hypothesis that biomass generation is limited more by carbon than nitrogen.

to determine equilibrium behavior by the community and how well the model could predict the behaviors we observed, we conducted dfba using this algorithm over  <dig> h with several different starting conditions. first, a 50: <dig> starter culture was used to model both how a colony might achieve equilibrium through cellular differentiation and the resulting equilibrium. in order to achieve efficiency, three phases govern cell response to metabolite deficiencies as illustrated by fig.  <dig>  first, photoautotrophs are generated to correct for carbon deficiency over the first  <dig> h  and without excretion of metabolites . meanwhile, the diazotrophs are tasked with producing enough fixed nitrogen to support the community, but all biomass generation is diverted towards photoautotrophs because the “seed” carbon or nitrogen is rapidly depleted. in the second phase from hours  <dig> to  <dig>  where the cells are near but not at equilibrium, the cells redistribute more slowly as the community is able to support itself without reaching a deficiency while producing some metabolites . finally, after about  <dig> h, equilibrium is reached where more photoautotrophs will deplete the environment of fixed nitrogen and fewer will reduce biomass generation. this is also the stage where metabolite production is most rapid, and ammonium and glycogen are exchanged between cells and the environment exponentially fig.  <dig>  these results are encouraging because they justify our observation that the model converges to an equilibrium regardless of initial composition, and the equilibrium falls within experimental and in situ levels.

convergence toward equilibrium was investigated further by incrementally changing initial biomass ratios and plotting growth rate versus time. rapid convergence by an inoculum of 15: <dig> diazotroph:photoautotroph is expected and promotes this as ideal behavior by cellular populations . the convergence by other inoculums reinforces the idea of an equilibrium composition and shows the inefficiency of other starting populations. finally, since the model assumes no diffusional limitation and similarly structured cells, this convergence to an equilibrium demonstrates that metabolic interactions play a large role in community regulation of t. erythraeum. we repeated this analysis  <dig> times to see how the composition of the inoculum affected equilibrium composition of the cells . in agreement with the single simulation results from above, starting with compositions that were not close to equilibrium resulted in suboptimal growth  or no growth . “death” , was strictly contained within the initial phase of growth when the inoculum was 0: <dig> or 100: <dig>  this is because either nitrogen generation or glycogen generation is too low to support the population before efficient biomass production is achieved and the cells do not have enough exogenous resources to correct this. the equilibrium composition and nitrogen release fraction are both close to observed data: a starter culture closer to the cell composition measured in the ocean  grows nearest the constrained growth rate, while compositions further from that equilibrium result in depressed rates. the full distribution of possible growth rates can be seen in fig. 7b and illustrates a bimodal distribution. the separation between the two peaks can be explained by the extent of domination by either cell type. when diazotrophs dominate, suboptimal growth occurs; when photoautotrophs dominate, the cells operate optimally or die due to deficient nitrogen production. figure 7a depicts the range of nitrogen release rates dependent on initial inoculum and display a fairly narrow range. in non-death situations, it is consistent within 25% and 45% of total fixed nitrogen, well within the literature recorded values of  <dig> %  <cit>  –52%  <cit> . across all growth rates, nitrogen leakage is  <dig> % of total fixed nitrogen, but for optimal growth rates , nitrogen leakage is  <dig> %. again, nitrogen leakage appears essential to efficiency in biomass generation as evidenced both by observation and simulation. the repetition of the simulation show that an equilibrium composition similar to observation was invariable and is mediated by metabolism while nitrogen is a required side-effect of this optimal growth.

the model was also used to simulate growth conditions that have not been possible to perform in the laboratory. to date, t. erythraeum has not been reported to grow on more reduced nitrogen sources; however, we are able to predict how growth on these other n sources using our model . with increasingly more reduced nitrogen sources and higher carbon content , the growth rate increases from  <dig>  h- <dig> to  <dig>  h- <dig> with the exception of urea, which has the second lowest growth rate  due to its requirement of atp consuming active transport and a byproduct of moderately useful co <dig>  in the boyle laboratory, t. erythraeum only grows on n <dig> or nitrate and this general trend is also seen in other laboratory data. t. erythraeum, therefore, lives in a very narrow optimum between two important objectives: carbon and nitrogen fixation. the availability of carbon  particularly limits growth. in reality, light also has an important role in growth rate because a few centimeters below the surface of the ocean light becomes severely limited. diffusion, predation, colony shape, and other influential factors can also limit the cell’s ability to grow optimally. even so, biomass generation predictions correlate well between with laboratory data and predicted equilibrium compositions of cells are close to observed values. in order to more effectively leverage this model for colony modeling more sophisticated methods should be used, however, the model has already enabled genome discovery and investigation into the metabolic regulation of this unique and significant cyanobacterium.

CONCLUSIONS
a genome-scale metabolic network reconstruction was performed for the filamentous diazotrophic cyanobacterium, t. erythraeum. this organism has a prominent role in the global nitrogen cycle; it is responsible for 42% of the annual biological nitrogen fixation and secretes between  <dig> %  <cit>  and 52%  <cit>  of the nitrogen it fixes into the ocean, providing an important source of bio-available nitrogen to other organisms. this model was then subjected to constraints based modeling, such as fba, fva and dfba to investigate the effect of changing environmental conditions and initial cell composition on equilibrium cell compositions and to predict inter- and intra-cellular fluxes. our simulations indicate that cells exhibit traditional metabolic diversions to conserve carbon in nitrogen-fixing cells  and to conserve energy in carbon fixing cells . from simulations with unconstrained carbon/nitrogen uptake, it appears that photoautotrophs have a lower optimal growth rate than diazotrophs; however in nature, these conditions would never exist. diazotrophs rely on photoautotrophs for their required carbon and cannot grow in their absence. the model predicts an optimal growth rate for a trichome made up of  <dig> % diaztroph, this agrees well with published reports of 10–20% . thus, the model is capable of accurately predicting the required cellular compositions for optimal growth, implying that the composition of cells within a trichome is largely determined by stoichiometry. the success of this and other correlations between our model and laboratory and in situ measurements infers that the hypothesis that metabolites are the main influence for cell differentiation for t. erythraeum is correct.

the genome-scale metabolic network reconstruction and subsequent model simulations lay the foundation for further interrogation of the metabolism of t. erythraeum. this globally significant diazotroph plays an integral role in the ocean, providing a much needed nitrogen source in a very deplete environment. the modeling techniques we have employed above perform well in terms of predicting the growth of a trichome in an ideal environment; but to fully capture the role of t. erythraeum in the ocean, more advanced modeling techniques must be developed. in its native environment, t. erythraeum interacts with many other species and therefore multiscale models which can capture not only the interaction of the cells with their environment but interactions between cells  must be developed. these types of multi-scale models may also prove useful in modeling and predicting the effect of rising temperatures and carbon dioxide levels in the atmosphere.

