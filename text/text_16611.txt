BACKGROUND
protein evolution and evolution of protein function, in particular, is a long-standing topic of keen interest in both experimental and theoretical aspects  <cit> . recent advances in genomics and proteomics provided a wealth of sequences and structures, making it possible to unravel intricate evolutionary connections in the realm of protein function. specifically, it became feasible to follow in detail convergence and divergence of protein function in case of speciation and adaptation  <cit> , switching between natural and latent enzymatic activities  <cit> , evolution of promiscuous functions  <cit> , and recombination of functional domains into proteins with new functions  <cit> . there is still, however, an enigmatic question about the very emergence of the first enzymatic domains from primordial functional peptides. the ultimate goal would be to draw a picture of the emergence of functional domains/folds, their fate upon formation of proteomes and involvement into adaptation and speciation. first, it should be understood how protein structure started from combining the primitive peptides/proteins with elementary functions into folds with complex enzymatic activities. then, the fusion and recombination of these folds into multidomain structures and protein complexes should be explored  <cit> . further, the reutilization of already existing structures and the invention of new domains/folds with unique functions should be analyzed.

in order to dig as deep as to the emergence of the first enzymatic domains/folds, one has to hypothesize short peptides that preceded enzymes in the protein-rna world. existence of conserved functional motifs  <cit>  in a big number of protein superfamilies suggests that they originated from ancestral peptides. though severely changed, structural and functional “signatures” of these ancestors could survive in contemporary functional motifs. the first task, therefore, would be to define the unit of protein function and to use this definition for decomposing contemporary enzymatic functions into sets of elementary ones. structurally, it has been shown that closed loops  with a characteristic size  <dig> –  <dig> residues can be a common basic structural element of all globular proteins  <cit> . this element is apparently a consequence of the polymer nature of the polypeptide chains. closed loops in modern proteins are also presumed to be units of protein domains  <cit> , playing an important role in co-translational protein folding  <cit> . functionally, the notion of elementary functional loops , closed loops possessing the residues important for binding, activation, and catalysis has been introduced  <cit> . the efls are presumably descendants of primordial ring-like functional peptides of the protein-rna world, which can be reconstructed in the form of sequence profiles with specific functional signature and structure of the closed loop   <cit> . the same elementary function can serve as a unit of different enzymes, forming their biochemical functions in combinations with other efls. as a result, descendants of a particular prototype can be found in unrelated folds and functions. therefore, evolutionary connections unraveled by prototypes and efls go beyond homology on the functional superfamily level, illuminating the very process of building functional domains from the elementary units  <cit> .

we use here the archaeal superkingdom as a model system for exploring the emergence and molecular evolution of the protein function. archaea is an ancient superkingdom and has a compact structure with a clear division into four phyla: crenarchaeota, euryarchaeota, korarchaeota, nanoarchaeota. archaeal species thrive in different extreme environments, such as high temperature and salinity, and most of them are anaerobes. all the above allows to explore the emergence of new functions in the process of speciation as well as in response to demands of the environment. one can trace, for example, evolutionary relations between the most common and ancient functions and those that emerged later. earlier introduced notions of the archaeal “core” and the “shell” and the last archaeal common ancestor   <cit>  provide an excellent background for this analysis. the database of the archaeal clusters of orthologous groups of proteins  gives the basic functional annotation for each cluster as well as its distribution across the archaeal lineages  <cit> .

some archaeal species possess unique enzymatic functions and even unique metabolic pathways. for example, methanogenesis  <cit>  is a unique pathway found only in the archaeal divisions methanobacterialesmethanococcalesmethanomicrobiales and methanosarcina belonging to euryarchaeota kingdom. methanogens reduce carbon-containing compounds, such as co <dig>  formate, and acetate to methane in anaerobic conditions  <cit> . overall, the carbon is subsequently transferred between three carbon-carriers: methanofuran , tetrahydromethanopterin , and coenzyme m  via seven major enzymatic steps of the methanogenesis pathway. these steps are very similar between all kinds of methanogens  <cit> , and the main methanogenic enzymes are oxidoreductases and transferases  <cit> . one-carbon metabolism is considered to be one of the most ancient ones, and presumably of a prebiotic origin  <cit> . at the same time, genomic and geological evidences suggest that methanogenesis pathway evolved at rather late stages of archaeal evolution . there are in total more than  <dig> genes required for methane formation  <cit> . the majority of the proteins coded by these genes are involved into various coenzyme and cofactor biosynthesis, synthesis of prosthetic groups and ion transport. despite the diversity of enzymes involved in the methanogenesis, they all evolved from the one ancestral set of enzymes  <cit> . we analyze two enzymes of the methanogenic pathways, identify structural folds and elementary functional loops, and discuss the plausible scenario of their emergence.

RESULTS
fold usage in the archaeal proteomes
our goal here is to delineate evolutionary relationships between protein functions of the archaeal superkingdom via elementary functions comprising different enzymes. we analyze archaeal clusters of orthologous groups  representing the whole proteins, protein complexes and their subunits, and identify the functions of their individual domains. the arcogs are classified, according to their distribution across species, into the core , shell , and orphans  <cit> . arcogs correspond to chains or subunits of complete proteins, which either can be fully functional by themselves or should be assembled into oligomeric protein complexes. each arcog, in turn, can be composed of several functional domains incorporated in a protein chain. it makes the functional domain an indispensable unit, which directly links enzymatic functions of modern proteins to primordial functional peptides. the reconstruction of evolutionary relations between protein functions should start, therefore, from establishing links between the functional domains comprising multidomain proteins and protein complexes. first, we detect scop folds  <cit>  in the arcog protein sequences. the  <dig> folds found in archaea are distributed unevenly between the core, shell, and orphan arcogs . the core-only, shell-only, and orphan-only folds are exemplified with ten folds . we also counted the number of folds  predicted to be in the last archaeal common ancestor   <cit> . the diagram indicates the evolutionary dynamics in archaeal function and corresponding fold usage. overall, there are two major options in the evolutionary fate of the functional domains/folds. some of the specific folds are found only in the archaeal core , e.g. ribosomal protein folds, dna and rna binding folds . they were exclusively used for one or a few very common functions in the core and were not reused in other enzymes in the shell. these folds are present in all the archaeal lineages, which indicates their ancient and basic nature. on the other hand, there are many ancient core folds , such as rossmann fold, fad/nad-binding fold, and tim β/α-barrel fold, which were reused in new  functions . every core fold is present in laca , while the orphan-only folds  are not present in laca at all. the difference between the core and orphan folds apparently indicates that most of the orphan and some of the shell folds represent the functional domains designed de novo. among these new domains  there are, for example, unique folds of the methanogenic enzymes: methenyltetrahydrofolate cyclohydrolase-like fold , f420-dependent methylene-h4mpt dehydrogenase fold , methenyl-h4mpt cyclohydrolase , methyl-coenzyme m reductase alpha and beta chain c-term fold .

metanogenesis pathway
we analyze proteins involved into methanogenesis pathway by using the set of profiles of elementary functional loops  obtained for the whole archaeal superkingdom . elementary functional loops are represented by the sequence profiles in the form of 30-residue long position-specific scoring matrices . additional file 3: figure s <dig> shows the methanogenesis-related arcogs and their connections to the non-methanogenic ones via profiles of efls. since arcogs are in many cases multidomain proteins or protein complexes , we split them into individual domains and consider functions and evolutionary connections of each domain separately . there are novel folds, such as the folds of methenyl-h4mpt cyclohydrolase  and n-n-methenyl-h4mpt dehydrogenase  enzymes, which emerged in response to demand for new/specific function. highly designable folds, such as β/α-barrel, rossmann fold, and ferredoxin are abundant in the methanogenic enzymes. for example, β/α-barrel fold is present in fmd/fwd subunit a  and mer ; ferredoxin fold – in ftr  and in the other  cluster-containing enzymes, such as mcra and fmd; rossmann fold – in the hmd enzyme . there are also several rare coenzymes and cofactors working almost exclusively in methanogenesis, such as molybdopterin/tungsteen-pterin , coenzyme b , coenzyme f <dig>  and corrinoid cofactor f <dig>  despite their unique chemistry, some of these cofactors belong to wide groups of structurally similar chemical compounds. they may invoke therefore the similar chemistry of the recognition and binding, resulting in common elementary functional loops. in this case, the corresponding efls can be reused as building blocks of the new folds and biochemical functions. there are also cases where several folds fuse and make up multidomain enzymes, e.g. the unique two-domain structure of mch. some folds can assemble into protein complexes, such as the homoxehamer of the above-mentioned enzyme.

we consider here protein function starting from the level of elementary functional loops to functional domains and their combinations in mutidomain proteins and complexes. below we analyze enzymes catalyzing the first  and the last  steps of the methanogenic pathway, and heterosulfide reductase  enzyme linking these steps by reducing cofactors involved into them. for the details on these enzymes, see description in additional file  <dig>  the goal of this part is to show different ways of the function emergence and evolution such as reutilization of the abundant folds in forming specific methanogenic enzymes, the role of elementary functional loops as building blocks of the new enzymes, and formation of the protein complexes.

different efls working in domains of formyl-methanofuran dehydrogenase 
reutilization of folds and efls in cofactor f <dig> binding
reutilization of the same elementary function in different domains of heterosulfide reductase 
hdr enzyme is a protein complex composed, in the most general case, of three subunits: hdra, hdrb, and hdrc. in methanothermobacter hdrabc forms a complex with another enzyme -hydrogenase mvh  <cit>  and acts as an electron acceptor. hdrabc uses the electrons obtained from mvh to reduce ferredoxin and heterosulfide. the structure of heterosulfide reductase  has not been resolved yet, however it is possible to explore the functions of its subunits using sequence profiles of the elementary functional loops. the subunit a of the hdr contains several ferredoxin reductase-type fad-binding motifs. in the -x- motif the r/h form hydrogen bonds to the phosphate oxygen atom  <cit> . additionally, hdra contains four motifs for binding  clusters with the common signature -cxxcxxcxxxc- represented by profile  <dig>  the c subunit of hdr contains two  cluster-binding efls with the same signature, as in subunit a. hdrb is the catalytic domain, which uses another  cluster  and also contains several redox-active cysteine residues.

evolutionary relations between superfamilies of archaeal functions
the task of this part of the paper is to find evolutionary connections going beyond homology in enzyme superfamilies. three main reasons for the evolutionary connections between the arcogs and their functions can be named:  domain fusion and recombination, as some arcogs are multidomain proteins and/or protein complexes;  proteins in connected arcogs are distant homologs diverged from the same ancestral domain/fold;  common elementary functions are present in different non-homologous arcogs. the latter describes, for instance, common steps in the biochemical transformations or the binding of chemically similar substrates or cofactors. the connections between proteins sharing elementary functions can originate from the primordial evolution, hence they are not restricted within a  family or fold. we consider here functional domains and links between them provided by the elementary functional loops and their prototypes. functions of individual domains rather than those of the whole proteins are analyzed, since the first enzymatic domains were presumably formed from the simple primordial peptides with elementary functions  <cit> . we start from the arcogs in the archaeal core , as they represent the most common protein functions . then we identify the elementary functional loops, which served as building blocks of these domains and provided key steps of their biochemical functions. below we show how efls unravel intricate connections between protein superfamilies with different biochemical functions.

elementary functional loops are represented by the sequence profiles in the form of 30-residue long position-specific scoring matrices . in some cases, a profile represents enzymes belonging to different families and even superfamilies. the complete set of profiles with related elementary functions represents the prototype with the signature of the most basic and common elementary function. this prototype describes the primordial ancestor of the related efls. using the procedure described in materials and methods, we derived  <dig> sequence profiles from the archaeal proteomes  and matched them to the sequences of the arcogs. we found that some profiles match to several arcogs. figures  <dig> and  <dig> show connections between the core arcogs  via profiles of the elementary functional loops . ancient elementary functions of the core are also frequently found in the arcogs present in the “almost-core” arcogs  shown by the large blue nodes in figures  <dig> and  <dig>  the size of the node represents the number of archaeal species possessing the arcog. in order to exemplify evolutionary connections revealed by the elementary functions, we identified arcogs clustered around particular sequence profiles with elementary functions typical for the cluster . we name these clusters according to the prevailing enzymatic function of the arcogs and consider connections between them.

aminoacyl trna synthetases
two clusters of arcogs representing aminoacyl trna synthetases  are determined based on the sets of the corresponding profiles. the catalytic domains of aars are highly conserved, and there are several distinct signatures connecting synthetases of the same class. for example, class i aars  is characterized by the profile  <dig> with the signature -gxkmsksxg-. the elementary functional loop containing this characteristic signature is a part of the active site in aars class i, where the second lysine stabilizes the aminoacyl-adenylate. figure  <dig> shows the structure of the corresponding efl. the elementary function of this efl is the adenine moiety recognition and binding via a hydrogen bond  <cit> . additionally, aars of the class i are also connected by the elementary functions of heavy metal and ion transport possessed by the profile  <dig> with the signature -gdgxxd-. this functional signature describes interactions with ca2+ and mg2+ ions . class ii aars is also interconnected by several typical profiles . for example, the profile  <dig> has a characteristic glycine-rich signature -pxgxgxgxxrl-, similar to the nucleotide binding signatures. figure  <dig> contains the example of the efl corresponding to the profile  <dig>  where an elementary functional loop from a lysil-trna synthetase is shown together with substrates lysine and atp.

structural repeats
it is known that structural repeats are typical for many proteins, including β-propellers, pkd domains, wd <dig> domains, and cell surface proteins  <cit> . although the corresponding arcogs are not related functionally, profiles  <dig> y-) and  <dig> ivwxd-) represent repeating motifs which serve as conserved structural building blocks . figure  <dig> illustrates the example of a typical structural repeat comprising immunoglobuline-like fold of pkd domain with the signature of the profile  <dig> 

transcriptional regulators
transcriptional regulators belonging to different families  share several functional signatures . one of them is exemplified by the profile  <dig> with the signature -iaxvxlxxxgxv-. the “hth regulator fused to ferredoxin domain”  is the example of the connection as a result of domain fusion. in this case the arcogs is a multidomain protein. figure  <dig> shows the catabolite gene activator protein , which is a complex of the transcription factor with dna. the efl corresponding to the profile  <dig>  provides the interface between the protein and dna. presumably, this elementary function of dna-binding is also used by the other arcogs where matches of the profile  <dig> were found.

helicases
helicases, atpases involved in replication, replicative shii helicases, and recombinases have common elementary functional loops responsible for the interactions with nucleic acids . for instance, the profile  <dig> has a typical signature of helicases − lxpxgktlxaexa-  <cit> . this profile connects several protein superfamilies: reca-superfamily atpase implicated in signal transduction, protein implicated in ribosomal biogenesis, superfamily ii helicase, and replicative sfii helicase superfamily. figure  <dig> shows an example of the elementary functional loop representing the profile  <dig> in reca-superfamily, where its function is the adp binding.

methylases and methyltransferases
methylases/methyltransferases are involved in the addition/transfer of methyl chemical group via nucleophilic and radical mechanisms  <cit> . the group of methylases  has several characteristic signatures, for instance profiles  <dig> a-) and  <dig> a-). figure  <dig> shows an example of the efl representing the profile  <dig> in chemotaxis receptor methyltransferase with a bound s-adenosylmethionine  analog. it indicates that the same elementary function is shared between the sam-dependent methyltransferases, different rna methylases, including trna and rrna methylases, and biosynthesis enzymes with the methyltransferase activity.

abc transporters
the atp binding cassette is a common component of the abc transporters cluster . the cluster includes atpase component, transport systems for metal ions, amino acids, drugs, and small peptides. the atp binding cassette consists of several highly conserved  <cit>  consecutive functional signatures. we found profiles corresponding to the major functional loops in the abc transporters. the profile  <dig> gxxgxgkt-) corresponds to the walker a motif , which interacts with the phosphate groups of the nucleotide in the atp. the profile  <dig> depxxxld-) contains several signatures. first, it includes the walker b motif, which coordinates the mg2+ ion and provides a water molecule polarization. the profile  <dig> also contains a typical signature of all nucleotide hydrolases , acting as a γ -phosphate sensor. additionally, this profile includes a d-loop signature with conserved  residues. the profile  <dig> n-) represents the so-called q-loop with a highly conserved glutamine, providing a nucleophilic attack of the γ-phosphate in the atp  <cit> . figure  <dig> shows the structure of malk – an atpase subunit of the sugar abc transporter in the archaeaon thermococcus litoralis and is a representative example of the “abc transporters” cluster  <cit> . it contains three major elementary functional loops, representing profiles characteristic for the abc transporters:  <dig>   <dig>  and  <dig>  finally, elementary functions working in abc transporters are also present in other biochemical functions where atp binding is part of the reaction. for example, elementary functional loops of the profiles  <dig> and  <dig> work in the cysteine desulfurase activator atpase.

metal binding
heavy metals, such as mo, w, co, mg, and cu are widely used in enzymes in various biochemical and cellular processes as cofactors in the catalysis, activators, and electron donors/acceptors in redox reactions  <cit> . cluster  <dig> in the figure  <dig> shows several profiles with the elementary function of a metal binding. for instance, the profile  <dig> with the signature − gmxcxcxvxgv- characterizes elementary function of the copper binding . highly conserved cysteines and a methionine residue constitute the functional signature of this profile. in the graph in figure  <dig> the profile  <dig> connects the copper-ion-binding protein superfamily with the cation-transport atpase superfamily. both superfamilies share the elementary function of the copper binding. recently we showed that the profile  <dig> is a derivative of the ancient prototype with the generic signature -cxxc- and the general elementary function of the metal and metal-containing cofactor binding  <cit> . another example, the profile  <dig> with the signature − vxgdgxndaxalxaxgxa- binds various ions and inorganic compounds . in the arcog graph  the profile  <dig> connects several protein superfamilies: had superfamily hydrolase, cation transport atpase, and heavy metal associated domain  superfamily.

above examples of elementary functions include binding, activation, and elementary reactions, which presumably existed in the prebiotic rna-protein world and served as basic units in the formation of the first enzymatic domains. the binding of metals with generalized -cxxc- and aspartic-rich signatures  and the phosphate group binding characterized by glycine-rich signatures  are the examples of abundant and presumably ancient elementary functions.

CONCLUSIONS
contemporary proteins are sophisticated molecular machines built of hundreds or thousands amino acid residues. structurally, they consist of the independent and compact domain formed by the continuous polypeptide chain or several protein chains interacting and forming a protein complex. this work attempts to draw a picture of protein evolution starting from the prebiotic evolution of protein-like molecules with elementary functions and spanning into the contemporary evolution of protein structure and function.

we relied here on the concept of elementary functional loop  as a presumed basic unit of the protein function. we derived sequence profiles of efls using the set of complete proteomes from the archaeal superkingdom. our analysis shows that in the earliest stages of protein evolution or even earlier in the prebiotic world, combinations of primitive peptides/proteins with elementary functions, such as nucleotide/phosphate  or metal cofactor  binding apparently formed the first enzymatic domains. the most designable folds  apparently served as scaffolds for biochemical functions of the first enzymatic domains. the enzymes with different folds can contain elementary functional loops that diverged from the ancestral peptides with particular functions. therefore, functional relations between enzymatic domains could have been established already in the predomain evolution when the first functional folds have been formed. figure  <dig> contains examples of common biochemical functions  clustered around the key elementary functional loops. in many cases there is one or a few efls, which determine the clustering of enzymes.

we used methanogenesis pathway as a case study in order to show how enzymes with new functions can be formed from elementary functions and via reutilization of already existing functional domains. methanogenesis is only observed in archaea, moreover only in few lineages, and is characterized by several unique folds and unusual cofactors  <cit> . we considered enzymes catalyzing the first  and the last  steps of the methanogenesis in detail. the subunits fwdb and fwdd exemplify how binding of two molecules of molybdopterin dinucleotide cofactor  is achieved by the mutual work of two rossmann-like nucleotide binding folds fused together. these two folds  form the catalytic domain together with a  cluster-binding  and a beta-barrel  folds with elementary functions supporting the mgd binding. the mcr enzyme catalyzing the last step in methanogenic pathway has several different subunits evolved from the two folds: a ferredoxin-like fold and an all-α fold, which are used in several copies for building of the enzyme. mcr is also an example of utilizing metal- and nucleotide-binding signatures involved in interactions with a unique f <dig> cofactor. using another enzyme hdr, we show how very similar elementary functions of  cluster binding can be used in different combinations in order to build a complex enzyme with oxidoreductase activity.

to conclude, clear phylogenetic structure with four well-characterized phyla, a long evolutionary history bordering to the origin of life in the prebiotic world, and a diversity of colonized environments made archaea an attractive subject for the studies of the evolution of protein function. we were able to analyze major ways of the emergence and evolution of the protein function and to show how to reconstruct evolutionary relations between different enzymes. the future task we foresee is two-fold:  to obtain a set of elementary functions, which would exhaustively describe chemical transformations existed in a prebiotic world;  to determine the original set of enzymatic domains that formed from the above elementary functions and served as a seed in the evolution of the protein function.

