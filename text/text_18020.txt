BACKGROUND
chaos can be defined as an aperiodic long-term behaviour in a deterministic dynamical system  that shows sensitive dependence on the initial conditions  <cit> . though biological systems are affected by intrinsic and external stochastic noise, experimentally recorded irregular dynamics in the action potential  of cardiomyocytes have still been shown to be of the chaotic nature  <cit> . more precisely, it has been observed in  <cit>  that by increasing the frequency of the stimulating current ), the 1: <dig> entrainment of the action potential is lost and a sequence of different m:n rhythms with alterations in the action potential duration  called ap alternans is obtained before the dynamics finally become irregular. using an iterated map 
  <dig> apdn+1=f 


derived from the experimentally obtained restitution curve ), it has been shown that, as the pcl of the stimulus is decreased, the slope of f at the fixed point apd∗ of eq.  becomes progressively steeper until ∂
f/∂apd=− <dig> at some critical value pclcrit. at this flip bifurcation point pclcrit the stability of the fixed point is lost and a period- <dig> cycle of eq.  is born. the latter marks the beginning of a cascade of period-doubling bifurcations, also compare with  <cit> , that is produced as pcl is further decreased and that finally leads to chaotic sequences of apd generated by eq. . this is in accordance with the pd route to chaos in the general theory of iterated maps  <cit> . for later reference we emphasize that  <cit>  studied chaotic apd variations in periodically forced cardiac pacemakers cells , while  <cit>  studied chaotic apd variations in periodically forced non-spontaneously active purkinje fibre and ventricular muscle cells.

chaotic early afterdepolarizations  are a different type of irregular cardiac action potential dynamics  that have been experimentally observed both in periodically stimulated ventricular cardiomyocytes  <cit>  and more recently in spontaneously beating human induced pluripotent stem cell derived cardiomyocytes  . eads are abnormal voltage oscillations during the repolarization phase of the action potential, characterized by one or more periods of positive voltage slope before the normal repolarization is completed. while the irregular appearance of eads has also been associated with stochastic activities of the ion channels  in  <cit> , the first mathematical evidence for the chaotic nature of eads in dependence of pcl has been given in  <cit> . using simulations of a deterministic differential equation model of ventricular action potential dynamics with a voltage equation 
  <dig> cdvdt=−∑ioniion+isti, 


a restitution curve apd=r, similar to the one shown in fig. 2pp, was constructed. this curve was then used to derive eq.  with f=r due to 
  <dig> di=pcl−apd. 
fig.  <dig> simulation of chaotic eads. numerical simulations of eads using the deterministic ap models pp, pv and up as outlined in the methods section. model simulations were carried out for a time span of  <dig> seconds, plots show short sections long after possible transients are gone. positive largest lyapunov exponents λ of the time series confirm the chaotic nature of the eads. pp) chaotic eads, λ= <dig> s
− <dig>  for the periodically forced pacemaker cell model pp with g
k= <dig>  ms/ cm <dig> as previously shown in  <cit> . for i
sti we chose periodic step pulses with pcl =  <dig> s, step duration d =  <dig> s and step amplitude a =  <dig> μ
a/cm <dig>  pv) chaotic eads, λ= <dig> s
− <dig>  for the periodically paced ventricular cell model pv with g
k= <dig>  ms/ cm <dig> as previously reported in  <cit> . for i
sti we chose periodic step pulses with pcl =  <dig> s, step duration d =  <dig> s and step amplitude a =  <dig> μ
a/cm <dig>  as opposed to a), stimulation of the cell also takes place before full repolarization. up) chaotic eads, λ= <dig> s
− <dig>  for the unforced pacemaker cell model up with g
k= <dig>  ms/ cm <dig>  note that simulated chaotic eads have previously only been published in context of periodic forcing


fig.  <dig> restitution curves obtained from chaotic voltage traces. plots of the action potential duration apd
n+ <dig> vs. the diastolic interval di
n as obtained directly from the simulated voltage traces. pp) apd restitution curve corresponding to fig. 1pp as previously shown in  <cit>  and similar to the apd restitution curve presented in  <cit> . there, the steepness of the slope of the curve has been identified as the reason for obtaining chaotic apd variations, see our discussion of the map eq. . as the cell is only stimulated after full repolarization, the same restitution curve is obtained when using eq.  for the determination of di. pv) apd restitution corresponding to fig. 1pv, not previously published. as opposed to pp, the location of the data points no longer justifies to consider the relation  as a single-valued function. consequently, a map eq.  for the analysis of the chaotic ead dynamics cannot be constructed. using eq.  one would obtain negative values of di due to stimulations before full repolarization. up) apd restitution corresponding to fig. 1up, which even further deviates from pp than pv. again, the scattered location of  data points prevents to analyze the chaotic ead dynamics via eq. . as pcl is not involved, eq.  is not applicable




finally, it has been argued in  <cit>  that the steep positive slope of the restitution curve r before the peak  proves the chaotic nature of the ead dynamics.

in this paper, we demonstrate that a steep slope of the restitution curve r cannot serve as a general explanation of chaotic ead dynamics displayed by cardiac ap models. indeed, we will show that chaotic ead dynamics in eq.  are possible even if extracted adp and di data points do not form a function r . however, the key contribution of our paper will be novel insight into chaotic ead dynamics gained from mathematical bifurcation studies of differential equation models of the form eq. . using a separation into fast and slow time scale variables, bifurcation analysis has been previously applied in  <cit>  for the illumination of eads in  the periodically driven lr91-model  <cit>  for ventricular cardiomyocytes. in particular, it was shown in  <cit>  that the fast subsystem of eq.  features a supercritical hopf bifurcation from which stable limit cycles emerge until they terminate at a homoclinic bifurcation of a saddle equilibrium. then, ead behaviour is obtained if the model parameters are set such that the state trajectory of the full system eq.  temporarily coils around the limit cycle surface spanned between the supercritical hopf and the homoclinic bifurcations of the fast subsystem. furthermore, the homoclinic bifurcation in the fast subsystem has been introduced in  <cit>  as the reason for the chaotic ead dynamics that could be obtained whenever the pcl was chosen appropriately in an ead featuring parameter setting. further affirmations of the statement that chaotic ead dynamics in periodically triggered action potentials are due to a homoclinic bifurcation in the fast subsystem of eq.  are given in .

recently, we have shown in  <cit>  that eads may occur in action potential models eq.  that do not feature a supercritical hopf bifurcation in their fast subsystem. in this paper, we now demonstrate that a homoclinic bifurcation in the fast subsystem of eq.  is neither a necessary nor a sufficient condition for obtaining chaotic ead dynamics.

we rather argue that a pd cascade of limit cycles in the full action potential system eq.  paves the way to chaotic ead dynamics in a model-independent manner and present examples with models of a) periodically paced and spontaneously active cardiomyocytes, b) periodically paced and non-active cardiomyocytes as well as c) unpaced and spontaneously active cardiomyocytes. furthermore, we reveal that chaotic ead dynamics may coexist in a stable manner with regular action potential dynamics, where only the initial conditions decide about the dynamics displayed. the results of our article on chaotic ead dynamics in single cardiomyocytes may shed new light on the synchronization of chaotic eads  <cit>  and ead-mediated fibrillation  <cit>  in cardiac tissue, may open new paths for the control of cardiac chaos  <cit>  and may be of relevance within the cipa-initiative  <cit>  for a new approach to preclinical drug cardiotoxicity testing with hipsc-cms, which considers eads as a potential mechanism-based metric for the assessment of proarrhythmic risk.

methods
cardiac action potential models
modelling of cardiac action potentials with systems of nonlinear ordinary differential equations   is coupled to differential equations that describe the dynamics of the ion channel currents i
ion) dates back to the work of denis noble  <cit>  on both purkinje fibre and pace-maker cells. modern cardiac ap models for animal  <cit> , human adult  <cit>  and human induced pluripotent stem cell derived  <cit>  cardiomyocytes comprise dozens of state variables and hundreds of model parameters. typically, the only explicit time-dependence of cardiac ap models is due to the stimulating current i
sti such that without stimulation, i.e., i
sti≡ <dig>  the ap model forms an autonomous ode system. depending on the actual equations and the particular choice of the model parameters, the autonomous ode system may show limit cycle behaviour  or steady state behaviour . using inverse bifurcation analysis with sparsity promoting penalization  <cit> , models for spontaneously beating cells can be transferred into models for non-active cells and vice versa. anyhow, the application of a periodic stimulus i
sti with pacing cycle length pcl leads to ap models of either periodically paced and spontaneously active or periodically paced and spontaneously non-active cells. in our study we used the following representatives for each of the three available classes of ap models. if the values of the model parameters are not explicitly mentioned in the text, they were chosen to be identical to those used in the original publications.


ap model pp –periodically paced pacemaker cell


as an example of an ap model of periodically paced and spontaneaously active cells we chose 
  <dig> cdvdt=−gcad∞f−gkx+isti,dfdt=f∞−fτf,dxdt=x∞−xτx, 


as introduced in  <cit>  and subsequently also used in  <cit> . in particular, this ode model of state dimension n= <dig> includes the inward calcium current 
 ica=gcad∞f  with the calcium channel conductance g
ca and the dynamic inactivation variable f, as well as the outward potassium current 
 ik=gkx  with the potassium channel conductance g
k and the dynamic activation variable x. in our discussion we used this model with the original setting τ
f= <dig> and τ
x= <dig> for the relaxation variables  <cit>  and the initial conditions y
0==.


ap model pv – periodically paced ventricular cell


as an example of an ap model of periodically paced and spontaneously non-active cells we chose 
  <dig> cdvdt=−ica−ik−ina−i0+isti,dddt=d∞−dατd,dfdt=f∞−fβτf,dxdt=x∞−xγτx,dhdt=h∞−hτh,dmdt=m∞−mτm,djdt=j∞−jτj. 


this model was previously used in  <cit>  for the study of chaotic eads and is a slightly modified version of the lr91-model  <cit>  for ventricular cardiomyocytes in which the intracellular calcium now is set constant. here, the currents depending on the dynamic gating variables d, f, x, h, m and j are 
 ica=gcadfik=gkxx¯ina=gnam3hj, 


while i
 <dig> summarizes those currents that are not directly driven by the dynamic gating variables. in our study we chose the relaxation parameters α= <dig>  β= <dig> and γ= <dig>   and the initial conditions y
0= 
  <dig> y0= 


as also considered in  <cit> .


ap model up – unpaced pacemaker cell


as an example of an ap model of unforced and spontaneously active cells we chose eq.  with the setting τ
f= <dig>  τ
x= <dig>  and i
sti≡ <dig>  and the initial conditions y
0==.

numerical simulation of action potential models
for the numerical simulation of the ap models pp , pv  and up  we used the matlab  <cit>  solver ode15s for stiff ode systems with the relative tolerance option set to 10− <dig>  all models were simulated for a time span of  <dig> s. then, the first  <dig> s were discarded in order to eliminate possible transient effects, such that only the remaining  <dig> s of the simulations were used for the analysis.

numerical bifurcation analysis of ap models
due to the nonlinearities involved, cardiac ap models eq.  may show a variety of complex dynamical behaviour. bifurcation analysis  <cit>  is the study of the dynamical repertoire and its dependence on the model parameters. bifurcations are qualitative changes in the dynamics as model parameters are varied, and the parameter values at which they occur are referred to as bifurcation points. in the bifurcation analysis of the ap models pp, pv and up we used the potassium channel conductance g
k as the primary bifurcation parameter and, for models pp and pv, the pacing cycle length pcl as the secondary one. the bifurcation diagrams of the ap models pp, pv and up were obtained by means of the numerical continuation packages matcont  <cit>  and auto-07p  <cit> . continuation is the technique of following a particular solution  of an autonomous system as the continuation parameter changes. one advantage of continuation is that both stable and unstable solution branches can be calculated while bifurcations of fixed points and limit cycles can be simultaneously detected. for the application of this technique to the non-autonomous models pp and pv, the latter were transformed into autonomous models of increased state dimension. to this end we introduced the two-dimensional dynamical system 
  <dig> du1dt=u11−u12−u22−2πpclu <dig> du2dt=u21−u12−u22+2πpclu <dig>  


that admits an asymptotically stable periodic orbit  <cit> , and appended it to eq.  with the setting 
  <dig> isti=a1+exp5·106cosdπpcl−u2sindπpcl. 


here, a and d denote the amplitude and the duration of the step pulse, see the additional file  <dig> for further details.

the stable branches of the bifurcation diagrams were cross-checked and partially complemented  by a parametric sweep, i.e., by numerical simulations of eq.  that were repeated for a variety of different parameter values.

multiple time scale analysis of ap models
often, cardiac ap models eq.  have state variables with time derivatives of much smaller magnitude than those of other variables. then, multiple time scale analysis  <cit>  can be used to study the flow of the full system eq.  by splitting the variables into slow and fast ones and by analyzing the corresponding slow and fast subsystems of eq. . one underlying rationale is that the trajectory of the full system under certain conditions evolves along the bifurcation scaffold built by the fast subsystem in which the slow variables serve as bifurcation parameters. in particular, the multiple time scales approach was followed in  <cit>  to discuss the genesis of eads. more precisely, the authors first eliminated the sodium current i
na from eq.   in order to arrive at an ap model with state dimension n= <dig>  then, considering the potassium gating variable x as much slower , the fast subsystem 
  <dig> cdvdt=−gcadf−gkxx¯−i <dig> dddt=d∞−dατd,dfdt=f∞−fβτf 


was derived in which x acts as a model parameter. finally, a bifurcation analysis of eq.  for the setting α= <dig>  and β= <dig>  and with x as the continuation parameter revealed that eq.  features a supercritical hopf bifurcation followed by a homoclinic bifurcation to a saddle fixed point. while the hopf bifurcation was considered in  <cit>  to be necessary for the genesis of eads in the full system eq. , the homoclinic bifurcation was introduced as the reason for the occurence of chaotic ead dynamics in eq.  under an appropriate periodic stimulation.

while, with respect to chaotic eads, our paper suggests to rather explore the full ap dynamics of eq.  than fast subsystems, we also studied for the sake of comparison the fast subsystem 
  <dig> cdvdt=−gcad∞f−gkx,dfdt=f∞−fτf 


of the cardiac ap models pp and up, then again with the slow variable x as the bifurcation parameter. the submodel eq.  was previously used in  <cit>  in order to demonstrate that a supercritical hopf bifurcation in a fast subsystem is actually not necessary for ead genesis.

calculation of lyapunov exponents
cardiac ap models eq.  may feature both regular and chaotic ead dynamics. in order to test whether a given trajectory is actually chaotic, we calculated the largest lyapunov exponent λ from the simulated voltage time series data using the tisean package  <cit> . the central idea is to consider a trajectory on the presumably chaotic attractor and to pick a point sn <dig> in the state space. then, a second point sn <dig> in close distance δ0=∥sn1−sn2∥ is chosen, and the separation of the two trajectories over time is measured in terms of 
 ∥sn1+Δn−sn2+Δn∥≈δ0eλΔn. 


a positive value of λ corresponds with an exponentially fast growth of the initial perturbation δ
 <dig> and means that the respective trajectory is chaotic.

calculation of restitution curves
as considered in  <cit>  and  <cit>  as an alternative to the s1-s2-protocol, we derived the restitution curves directly from the simulated voltage traces. to this end, all time points at which the voltage crosses the threshold value v
th were recorded during the simulations using the matlab event option of the ode solver. action potential durations apds were then calculated as the time spans during which the voltage lies above v
th, while diastolic intervals dis were constructed as the time spans with voltage values below v
th. finally, pairs of di and subsequent apd were built and plotted as apd
n+ <dig> vs. di
n. our motivation for the use of this direct method was its straightforward applicability to both paced and spontaneaously active models without the need of introducing perturbations to the latter. for the sake of completeness, we also applied the s1-s2-protocol, see the additional file  <dig> 

RESULTS
simulations of chaotic eads via the numerical integration of eq.  have so far only been reported  <cit>  for the case of a periodic stimulation by an external current i
sti, see figs. 1pp and 1pv for examples. however, studying drug induced eads in spontaneously beating human induced pluripotent stem cell derived cardiomyocytes, we found that chaotic eads may also form in simulations of ap models without periodic stimulation, see fig. 1up. note that a comparable high number of small oscillations during ead-like activity has been experimentally observed in  <cit> . as the occurence of chaotic eads of the type shown in fig. 1pp  has been attributed in  <cit>  to the steep slope of the apd restitution curve, see fig. 2pp, we first wondered if this argument may also apply to chaotic eads of the types shown in figs. 1pv  and 1up . having derived the corresponding apd restitution curves, see figs. 2pv and 2up, we realized that they strongly deviate from their previously published counterparts as exemplified in fig. 2pp. in particular, due to the lack of continuity and differentiability properties the “apd restitution curves” of figs. 2pv and 2up do not allow to define maps eq.  for the iteration of apd and hence do not contribute to the understanding of the chaotic ead types shown in figs. 1pv and 1up.

in our attempt to find a common explanation for the chaotic ead dynamics observed in figs. 1pp, 1pv and 1up, we next focused on the hypothesis featured in  according to which chaotic eads have their source in a saddle-homoclinic bifurcation in the fast ap subdynamics. while in  <cit>  the homoclinic bifurcation occurs after a supercritical hopf bifurcation, our analysis of the fast subystems of models pp and pv shows that in these examples the homoclinic bifurcation is rather accompanied by a subcritical hopf bifurcation of which only unstable limit cycles emerge, see figs. 3pp and 3pv. however, the bifurcation analysis of the fast subsystem eq.  of the ap model up reveals that in this case a homoclinic bifurcation is not involved at all, see fig. 3up. it has been previously shown in  <cit> , that the reason for the occurence of eads in model up is a saddle-focus fixed point whose unstable manifold causes small scale oscillations of growing amplitudes. since the ap model up still features chaotic eads, see fig. 1up, it is demonstrated that a homoclinic bifurcation in the fast ap subdynamics is in fact not a necessary condition for the occurence of chaotic eads.
fig.  <dig> bifurcation diagrams of fast ap subsystems. pp) bifurcation diagram of the fast subsystem eq.  of model pp with the potassium gating variable x as continuation parameter. the solid and dashed black lines denote stable and unstable fixed points of eq. . at the subcritical hopf bifurcation h, unstable limit cycles emerge that subsequently terminate at a saddle-homoclinic bifurcation hc. the red dashed lines show the maximum and minimum voltage values of the unstable limit cycles. pv) bifurcation diagram of the fast subsystem eq.  ) of model pv, α= <dig> and β= <dig>  with the potassium gating variable x as continuation parameter. the solid and dashed black lines denote stable and unstable fixed points. at the subcritical hopf bifurcation h, unstable limit cycles are born that turn into stable ones at a saddle node of cycles bifurcation before they terminate at a saddle-homoclinic bifurcation hc. the red dashed lines show the maximum and minimum voltage values of unstable limit cycles, the red solid lines show the extreme voltage values of stable limit cycles. up) bifurcation diagram of the fast subsystem eq.  of model up with the potassium gating variable x as continuation parameter. the solid and dashed black lines denote stable and unstable fixed points of eq.  that annihilate each other at saddle-node bifurcations. as opposed to pp) and pv), neither a hopf nor a homoclinic bifurcation does exist, and neither stable nor unstable limit cycles are detected. still, model up features chaotic ead dynamics, see fig. 1up




neither the ead-theory based on the steepness of ap restitution curves nor the ead-theory based on homoclinic bifurcations in fast ap subsystems can attribute the chaotic ead dynamics of figs. 1pp, 1pv and 1up to a common cause. in particular, none of these theories can shed light on the chaotic ead dynamics of model up, as it neither admits a steep ap restitution curve nor a homoclinic bifurcation in the fast subsystem. for gaining insight, we hence decided to perform a bifurcation analysis of the full ap system of the model up with the potassium channel conductance g
k as the continuation parameter. while in principle also other model parameters could be chosen for the continuation, the choice of g
k is motivated by the strong focus of the established drug safety guidelines on potencies to block potassium currents. the corresponding bifurcation diagram of fig. 4up shows that, starting from an area of low g
k values that do not admit spontaneous oscillatory activity but only attraction towards fixed points, stable limit cycles of comparatively small amplitudes emerge from a supercritical hopf point as the value of g
k is increased. at the period doubling point pd <dig>  the single-period oscillation loses its stability and splits into stable double-period oscillations. as g
k is further increased, further period doublings pd <dig>  pd <dig>  pd <dig> and pd <dig> are numerically detected. figure  <dig> illustrates corresponding periodic trajectories with single, double, fourfold and eightfold period before the motion becomes chaotic. furthermore, the chaotic nature is also present after the transition from the small amplitude motion with a failed repolarization to the large amplitude motion of ap type, with one representative given by the chaotic ead dynamics displayed in fig. 1up, before the ap type motion turns into periodic ead dynamics . for projections of the trajectories onto the v-x-plane of the state space, see the additional file  <dig> 
fig.  <dig> bifurcation diagrams of full ap systems. the red dashed lines show the maximum and minimum voltage values of the unstable limit cycles of the full ap systems that were detected, the red solid lines correspond to stable limit cycles. in pp), pv), up), the blue markers depict the beginning of a cascade of period doubling bifurcations of stable limit cycles, in ppz), pvz), upz) the blue markers show the pd bifurcations of a particular cascade in close vicinity to the g
k value resulting in the chaotic ead dynamics of fig.  <dig>  pp) bifurcation diagram of model pp with the potassium conductance g
k as continuation parameter . pv) bifurcation diagram of model pv with the potassium conductance g
k as continuation parameter . up) bifurcation diagram of model up with the potassium conductance g
k as continuation parameter. the solid and dashed black lines denote stable and unstable fixed points of model pp. at the supercritical hopf bifurcation, stable limit cycles of small amplitudes emerge that go through a cascade of pd bifurcations, depicted by the blue markers, before they turn into limit cycles of large amplitudes that correspond to periodic ead dynamics. in between lies an area that features both periodic and chaotic dynamics, including chaotic ead dynamics as shown in fig. 1up. ppz) zoom into the pd area of pp), pvz) zoom into the pd area of pv), and upz) zoom into the pd area of up), all in neighborhood of the g
k values corresponding to the chaotic ead traces shown in figures 1pp-1up. this suggests that the pd points numerically detected are part of an infinite pd cascade leading to chaotic eads


fig.  <dig> period doubling route to chaotic eads of model up. evolution of voltage trajectories of model up as the channel conductance g
k is increased along the period doubling cascade pd <dig>  pd <dig>  pd <dig> ... a) single period with g
k= <dig>  ms/ cm <dig> and gk<gk <dig>  b) double period with g
k= <dig>  ms/ cm <dig> and gk1<gk<gk <dig>  c) fourfold period with g
k= <dig>  and gk2<gk<gk <dig>  d) eightfold period with g
k= <dig>  ms/ cm <dig> and gk3<gk<gk <dig>  e) chaotic motion of failed repolarization with g
k= <dig>  ms/ cm <dig>  f) chaotic eads behaviour with g
k= <dig>  ms/ cm2





having associated the chaotic ead dynamics of the model up with the period-doubling route to chaos in ode systems  <cit> , we wondered if this phenomenon, numerically and experimentally observed in many other biological and physical systems including neuronal activity  <cit> , may also underlie the chaotic ead dynamics in the non-autonomous models pp and pv. transforming the latter into autonomous systems using eqs.  and , we hence performed a numerical bifurcation analysis again with g
k as the continuation parameter. the resulting bifurcation diagrams, displayed in figs. 4pp and 4pv, reveal that also in the case of model pp and pv, the value of g
k corresponding to the chaotic ead dynamics shown in fig.  <dig> in fact lies in close vicinity to a cascade of period doubling bifurcations. for illustrations of the corresponding periodic trajectories we refer to the additional file  <dig> 

discussion
chaotic ead dynamics in ap models eq.  have been previously observed in the case of periodic pacing  <cit>  but have been attributed to either the steepness of apd restitution curves or the existence of homoclinic bifurcations in fast ap subdynamics. while none of these results is able to explain the chaotic ead dynamics observed in the unforced ap model up, our study suggests the existence of a cascade of period doubling bifurcations of limit cycles as a model-independent explanation for chaotic ead dynamics both in forced and unforced cardiac ap systems of the ode type. we emphasize that period doubling bifurcations, though then observed in iterated apd maps eq.  rather than in mechanistic cardiac ap models eq. , have so far only been linked with chaotic apd alternans  .

the results of this study were obtained by means of bifurcation analysis applied to ap models eq.  based on numerical continuation using the software packages matcont  <cit>  and auto-07p  <cit> . in the context of eads-research, numerical continuation was previously only applied to fast subsystems of eq. , see  <cit> . though the analysis of fast subsystems can illuminate ead generating mechanisms during a single ap  <cit> , its capability to study the occurence of eads over a time span covering several aps may be limited as the conditions for a separation into fast and slow state variables  <cit>  may not be met in the long term. in that regard, the proper consideration of the stimulating current in eq.  or eq. , which certainly constitutes a very fast component of the system, might be one hurdle to be taken. in contrast, the advantage of studying the dynamical behaviour by a bifurcation analysis of the full ap model eq.  is that its long term behaviour defined by stable and chaotic attractors can be captured and tracked as model parameters are continuously varied. besides of the detection of bifurcations such as hopf, saddle node of cycles, homoclinic or period doubling bifurcations, another benefit of bifurcation analysis with numerical continuation is that unstable  dynamical structures of eq.  can be revealed. while the interpretation of the unstable limit cycles illustrated in fig.  <dig> goes beyond the scope of this study, the relevance of unstable structures in the context of ap modelling is highlighted in  <cit> , in which the existence of an unstable chaotic invariant set suggests that the excitability of a membrane to fire an ap may be more complex than a smooth hypersurface that divides subthreshold and suprathreshold membrane potentials.

the transition between two chaotic states  observed in the model up, see figs.  <dig> and  <dig>  is reminiscent of the transition between chaotic spiking and chaotic bursting  <cit>  in an unforced hindmarsh–rose model of neuronal activity. still, a difference is the sharp change in amplitude of the neighboring stable limit cycles in fig. 4up as opposed to the comparatively same levels of amplitudes in neuronal spiking and bursting reported in  <cit> . such sharp transitions in stable limit cycle amplitudes as observed in the unforced model up are also evident in the bifurcation diagrams of the periodically forced cardiac ap models pp and pv, see figs. 4pp and 4pv. however, the chaotic ead traces displayed in figs. 1pp and 1pv are obtained with parameter values of g
k that lie far away from these transitions but rather close to different cascades of period doubling bifurcations. a common feature of the unforced and the periodically forced models of this study is that the corresponding pd cascades are all of the supercritical type and seem to obey feigenbaum’s law  <cit>  
  <dig> limn→∞gkn+1−gkngkn−gkn−1= <dig> ..., 


where gkn is the parameter value of g
k corresponding to the n-period doubling pd
n.

a further exploration of the bifurcation diagram of the model pv reveals that the pd cascade is accompanied by a stable branch of limit cycles, indicated by the solid line in fig. 6
a at v≈− <dig>  mv. this branch corresponds to limit cycles of periodically driven regular action potentials as displayed in fig. 6
b and demonstrates the coexistence of regular ap dynamics with the ead affected limit cycles of the pd cascade for a certain range of potassium channel conductances g
k. consequently, regular ap dynamics may also coexist with chaotic ead dynamics if g
k is chosen beyond the cascade-limit of periodic behaviour, see figs 1pv and 6b which are obtained with the same value of g
k and identical periodic forcing but with the two different initial conditions eq.  and 
  <dig> y0=. 
fig.  <dig> coexistence of chaotic eads and normal periodic ap dynamics. a zoom into the pd cascade area of fig. 4b, but now also depicting a solid red line at v≈− <dig>  mv that represents the minimum voltage values of stable limit cycles corresponding to normal periodic ap behaviour. b display of the normal periodic ap orbit obtained with the same parameter setting as for the chaotic ead dynamics of fig. 1pv but with the different initial condition eq. 




this is similar to the coexistence of periodic spiking and chaotic bursting reported for a non-forced spontaneously active neuron model in  <cit> , then attributed to a bifurcation of a saddle-node periodic orbit. hence, even though the fast subsystem of model pv features a homoclinic bifurcation, the latter is not sufficient for the occurence of chaotic ead dynamics as in addition to the model parameters also the initial conditions need to be properly set. this coexistence is of relevance both for numerical and experimental studies of cardiac action potentials which typically are based on the assumption that after a sufficiently long transient the  “steady state” periodic behaviour is observed independently of the pacing history.

other than channel conductances such as g
k, the dependency of cardiac ap dynamics on the pacing cycle length pcl of the stimulating current i
sti is of high relevance for studies of cardioelectrophysiology. typically, the action potential duration apd is derived from voltage traces that are simulated or experimentally recorded for a discrete sequence of different values of pcl, see  <cit> . our transformation of the periodically forced and hence non-autonomous ap model eq.  into an autonomous ap model of extended state based on eqs. ,  offers a complementary method for studying the impact of pcl on the dynamic repertoire of the cardiac ap model. in particular, the numerical bifurcation analysis based on a limit cycle continuation allows for a continuous pcl screening and ensures that critical pcl points or intervals are not missed as they possibly would be in case of only a discrete pcl sampling. as an example, fig.  <dig> shows corresponding bifurcation diagrams for the model pv with pcl as the continuation parameter. as with the continuation of g
k, both the period doubling route to chaos and the coexistence of two stable periodic orbits for one and the same parameter value can be detected. furthermore, the spread of additional pd bifurcations over a wide range of pcl suggests that the pd-route to ead chaos is a non-local phenomenon in periodically driven ap models, which is in accordance with the observation of apd chaos over a wide range of pcl in the parametric sweep studies of apd  <cit> .
fig.  <dig> bifurcation diagram of full ap system with pcl as continuation parameter. a bifurcation diagram of model pv with the pacing cycling length pcl as the continuation parameter. here, the channel conductance g
k, the current step amplitude a and the step duration d were chosen as for fig. 1pv. the red dashed and solid lines show the maximum and minimum voltage values of unstable and stable limit cycles. blue markers depict several pd bifurcations of limit cycles spread across a wide range of pcl values. b zoom into the pd area of a) in neighborhood of the pcl value corresponding to the chaotic ead trace shown in fig. 1pv. again, the detection of serveral pd bifurcations that seem to obey eq.  suggests that the period doubling route to chaotic eads is on hand. the upper solid branch depicts the minimum voltage value of stable limit cycles that correspond to regular periodic ap orbits, once again demonstrating the coexistence of chaotic ead dynamics and periodic ap dynamics in model pv




we end this section with some limitations of our study. our study focuses on the generation of chaotic eads in ode models eq.  that represent the behaviour of single cardiomyocytes. clearly, our work needs to be extended to pde models of cardio-electrophysiology in order to take into account the coupling between cells and spatial ap wave propagation. furthermore, we have not incorporated stochastic effects which also may have an impact on the bifurcation repertoire of dynamical systems. finally, the discontinuities in the bifurcation diagrams due to a failure of the numerical continuation and the unraveled unstable limit cycle branches require further analysis to extract the full information about the dynamical repertoire of eq. . note, however, that our bifurcation approach led to the discovery of chaotic eads in unforced cardiac ap models and furthermore offers an explanation via the pd route to chaos then also uniformly applicable to chaotic eads in forced cardiac ap models.

CONCLUSIONS
eads are pathological voltage oscillations during the repolarization phase of the ap of cardiomyocytes and are considered as potential triggers of cardiac arrhythmias in context of both ion channel diseases and drug cardiotoxicity testing. in this study, we have contributed to the theory of ead dynamics by attributing their chaotic appearance to cascades of period doubling bifurcations of limit cycles in deterministic ap models. as demonstrated in this article, the detection of pd cascades via the numerical continuation of limit cycles is possible both for paced and unforced cardiac ap models and serves as a strong indicator of chaotic ead dynamics that then take place in immediate vicinity in the parameter space. hence, the automatically executable detection of pd cascades in the full ap dynamics defines a parameter-to-output map f:p→pd which might allow to formulate and solve associated inverse bifurcation problems  <cit>  that address the avoidance or the control  <cit>  of chaotic ead dynamics in cardiomyocytes. furthermore, pd cascades might serve as classifiers of proarrhythmicity that provide improved risk prediction in comparison with purely simulation based and unspecific markers such as apd <dig> or ap upstroke velocity. also, the incorporation of drug-ion channel interaction models  <cit>  into eq.  such as, e.g., simple pore block 
 g=11+dic <dig>  would allow to conduct the bifurcation analysis directly with respect to drug concentration d or ic <dig> of the ion channels of interest. in that regard, the findings of this study might be of relevance for the currently unfolding cipa initiative to redefine the drug safety paradigm  <cit> . though the latter considers mathematical modelling and simulation of cardiac aps as one of its three pillars , it seems to so far ignore the potential of bifurcation analysis for the illumination of arrhythmic and chaotic behaviour in dynamical systems.

additional files

additional file  <dig> transformation of periodically driven ap models into autonomous form. 

 



additional file  <dig> restitution curves computed via s1-s2-stimulation. 

 



additional file  <dig> period doubling route to chaos of model up. 

 



additional file  <dig> illustration of period doubling route to chaotic eads in models pp and pv. 

 


abbreviations
apaction potential

apdaction potential duration

cipacomprehensive in-vitro proarrhythmic assay

didiastolic interval

eadeearly afterdepolarization

hipsc-cmhuman induced pluripotent stem cell derived cardiomyocyte

odeordinary differential equation

pdperiod doubling

pclpacing cycle length

pppaced pacemaker

pvpaced ventricular

upunpaced pacemaker

