BACKGROUND
single nucleotide polymorphisms  are the most abundant genetic variation in vertebrate genomes. they have been important tools in many biological fields, including mutation mechanisms, genome evolution, disease studies, pharmacogenomics, and fine mapping  <cit> . strong demands of snp data and rapid technology advancements helped us to have observed an exponential rate in the discovery of snps during the past decade. as of october  <dig>  the largest public snp database, dbsnp, deposited more than  <dig> million submitted snps from  <dig> organisms; among them, more than  <dig> million snps have their references to the genomes  <cit> . many more snps are to be identified in the near future.

mutation at the nucleotide level does not occur randomly. recent studies of mutational mechanisms revealed that the influence of neighboring nucleotides on snps was strong in the human and mouse genomes  <cit> . specifically, strong biases relative to the genome average were observed at the two adjacent sites of the snps and small biases could extend farther, i.e., as far as  <dig> nucleotides at each flanking side. further, the bias patterns varied among the snp types, e.g., the extent of the biases for transition snps  was much stronger than those for transversion snps . importantly, the bias patterns observed in the whole genome could be sufficiently represented by only a small subset of snps randomly sampled from the genome-wide data  <cit> . the effective snp size, defined as the minimum number of the snps that can essentially represent the bias patterns of the whole snps, was roughly estimated to be  <dig>  in the human and mouse genomes  <cit> . because the snps identified in the today's genomes reflect the combinatory evolutionary processes such as methylated cpg mutation hotspots, high transition rate, selection on functional elements, and error-prone dna replication and repair, a small effective snp size suggests the strong influence of one or several genetic factors, especially the cpg effects in vertebrate genomes  <cit> .

so far, how to efficiently estimate the effective snp size remains unsolved. the snpnb, an user-friendly application implemented by java and perl, can assist the user to evaluate and obtain a number which is close to the effective snp size  <cit> . however, there are three major limitations. first, because snpnb is based on an empirical re-sampling approach, it becomes impractical to find the effective snp size when the number of snps is very large, which is always true for a genome-wide or chromosome-wide analysis. second, it is a challenging task on how to define that the bias pattern observed from one data set is  the same as that from another set. this is because we need to combine four nucleotides at all sites on the 5' side and 3' side of the snps. third, there is a statistical problem. the null hypothesis is that there is no neighboring nucleotide bias of snps in the genome, or the frequencies of nucleotides at snp neighboring sites are the same as the average nucleotide frequencies in the genome sequences. therefore, the observed neighboring nucleotide biases  should be compared to the expected value, which is  <dig> for each nucleotide at each site. however, a hypothesis test with a very large number of snps may not lead to a meaningful conclusion. for example, for the  <dig> , <dig> human snps tested in snpnb  <cit> , when the frequency difference is as low as  <dig>   for nucleotide c, the z test would be significant at the 5% significance level . as a result, the null hypothesis is rejected. obviously, such a small difference is not biologically meaningful or significant. here, we propose an integrated statistical method to estimate the effective snp size. this method  considers both the biological significance and the statistical significance so that it avoids the problem of leading to an unreasonably large effective snp size when only the statistical significance is considered  <cit> . we also developed an efficient pipeline to iteratively evaluate the intermediate values for the effective size. snpks consists of two steps:  evaluation of an initial effective size; and  iterative tests of the initial effective size by interval evaluation.

RESULTS
ks test and interval evaluation
to estimate the effective snp size, we designed and integrated a two-step procedure in our system . in the first step, we apply the kolmogorov-smirnov test   <cit>  to obtain an initial effective snp size. usually, the ks test is used to evaluate whether a sample is from a population based on a specific distribution by comparing the corresponding cumulative frequencies. here we estimate an initial effective snp size by comparing the cumulative frequencies from the whole snp data with those from a sample snp data.

for the whole snp data with size n, we randomly generate a sub-sample of snps with size n <dig> . first, we calculate the frequency of each nucleotide at each neighboring site in the whole snp data and sample snp data, respectively. according to our previous analyses  <cit> , we examine  <dig> neighboring sites immediately adjacent to each snp:  <dig> sites at the 5' side and  <dig> sites at the 3' side, because these  <dig> sites have the largest neighboring-nucleotide biases. figure  <dig> illustrates the polymorphic site of a snp and its 5' and 3' flanking sequences. then, we compare the cumulative relative frequency of each nucleotide in the neighboring sequences. let fi,j and gi,j be the frequency of sample snp data and whole snp data, respectively, and fi,j and gi,j be cumulative frequency of sample snps and whole snps, respectively. here i denotes one of the four nucleotides  and j denotes a neighboring site in the snp flanking sequences . the fi,j and fi,j of the sample snps are defined by:

fi,j=1n0∑1n0{1if jthnucleotide=i,0otherwise     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdawgaawcbagaemyaakmaeiilawiaemoaaogabeaakiabg2da9maalaaabagaegymaedabagaemoba42aasbaasqaaiabicdawaqabaaaaowaaabcaeaadagabeqaauaabaqaciaaaeaacqaixaqmaeaacqwgpbqacqwgmbgzcqqggaaicqwgqbgadaahaawcbeqaaiabdsha0jabdigaobaakiabd6gaujabdwha1jabdogajjabdygasjabdwgaljabd+gavjabdsha0jabdmgapjabdsgakjabdwgaljabg2da9iabdmgapjabcycasaqaaiabicdawaqaaiabd+gavjabdsha0jabdigaojabdwgaljabdkhayjabdeha3jabdmgapjabdohazjabdwgalbaaaiaawuhaaawcbagaegymaedabagaemoba42aasbaawqaaiabbcdawaqabaaaniabgghildgccawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaaa@6825@

fi,j={fi,−10if j=−10fi,j−1+fi,jif−9≤j≤10 and j≠ <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdawgaawcbagaemyaakmaeiilawiaemoaaogabeaakiabg2da9maaceqabaqbaeaabigaaaqaaiabdagamnaabaaaleaacqwgpbqacqggsaalcqghsislcqaixaqmcqaiwaamaeqaaagcbagaemyaakmaemozaymaeeiiaaiaemoaaomaeyypa0jaeyoei0iaegymaejaegimaadabagaemoray0aasbaasqaaiabdmgapjabcycasiabdqgaqjabgkhitiabigdaxaqabagccqghrawkcqwgmbgzdawgaawcbagaemyaakmaeiilawiaemoaaogabeaaaoqaaiabdmgapjabdagamjabgkhitiabimda5iabgsmijkabdqgaqjabgsmijkabigdaxiabicdawiabbccagiabdggahjabd6gaujabdsgakjabbccagiabdqgaqjabgcmi5kabicdawaaacqgguaglaiaawuhaaiaaxmaacawljawaaewaaeaacqaiyagmaiaawicacaglpaaaaaa@6940@

the gi,j and gi,j are defined similarly except for that n, the size of the whole snp data, instead of n <dig> is used. the maximum difference of cumulative frequency for each nucleotide is defined by:

di=max⁡j|fi,j−gi,j|     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgebardawgaawcbagaemyaakgabeaakiabg2da9maaxababagagiyba0maeiyyaemaeiieaghaleaacqwgqbgaaeqaaowaaqwaaeaacqwggbgrdawgaawcbagaemyaakmaeiilawiaemoaaogabeaakiabgkhitiabdeeahnaabaaaleaacqwgpbqacqggsaalcqwgqbgaaeqaaagccaglhwuaayjcsdgaaczcaiaaxmaadaqadaqaaiabiodazagaayjkaiaawmcaaaaa@47b2@

next, we compare the maximum difference of cumulative relative frequency of each nucleotide with the threshold value of biological significance instead of test statistic given by the ks test, because the tolerable difference in the ks test is too generous to find a reasonable sample size  <cit> . here we specify  <dig> % as a biological significance threshold value because when the frequency difference is <  <dig> %, it appears that the biases are likely due to the stochastic variance and they are not biologically meaningful based on our previous studies  <cit> . when the di fails to be less than  <dig> %, the size of the sample set is increased by  <dig> . the procedure above will run it again until the criterion of di <  <dig> % is satisfied . this step gives out an initial effective size  for the next procedure.

after getting an initial effective snp size n, the second step is to test whether the bias patterns obtained from the sample with this size can effectively represent the bias patterns observed from the whole snp data. this is performed by an interval evaluation using  <dig> different snp subsets with size n randomly sampled from the whole snp dataset. we choose  <dig> different subsets because when the sample size approaches  <dig>  we can safely assume the distribution of the bias patterns to be normal for inference purpose by central limit theorem. for each nucleotide at each neighboring site, we calculate the bias relative to the genome sequence average  in each of the  <dig> sample sets, and then get its average bias . when the difference between the average bias in the  <dig> sample sets  and the corresponding bias in the whole snp data  is less than its standard deviation for all nucleotides at all neighboring sites, an intermediate effective snp size  is found. that is, the proposed method iteratively evaluates the following difference:

|bi,j - bi,j¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdkeacnaabaaaleaacqwgpbqacqggsaalcqwgqbgaaeqaaaaaaaa@318e@| <si,j, ∀ i, j     

where si,j is the standard deviation from the  <dig> bias patterns. otherwise, we increase the sample size by  <dig>  and run this step again. the procedure runs iteratively until the criterion is satisfied.

the two steps above run repetitively  <dig> times. this leads to  <dig> ne <dig> estimates. the effective snp size is thus the mean of these  <dig> estimates.

implementation
to implement the snpks method, we developed computer programs in c and perl. in the snpks algorithm, we need to regularly generate random numbers and then extract random snps from the whole snp dataset based on the generated random numbers. this routine is computationally intensive; therefore, we wrote a computer program in c. the ks test and interval estimation were implemented in a perl script, which calls the c program automatically. the application has been tested on both microsoft windows and linux operating systems. the programs, instructions, and test data are available at the website  <cit> .

applications
we applied snpks to estimate the effective snp size in four vertebrate genomes: human, chimpanzee, dog, and mouse. the genome-wide snp data were retrieved from the dbsnp database of the national center for biotechnology information  . the number of the test snps are shown in table  <dig>  here we describe the procedures using dog snps because there is no previous investigation of the point mutation patterns using snps in the dog genome and also our analysis indicated that the neighboring-nucleotide biases were strongest among these four genomes. we started a random sample size  <dig>   and run the snpks programs iteratively. we got an initial effective size   <dig> . then, we took  <dig> random subsets with size  <dig>  and performed an interval evaluation. as shown in figure  <dig>  for all four nucleotides at all  <dig> neighboring sites, the intervals obtained from the  <dig> samples covered the frequencies observed from the whole dog snps. table s <dig>  shows the biases relative to the average nucleotide frequencies in dog genome for each neighboring site from whole dog snps and from  <dig> random sample subsets with size  <dig> . it also includes the information of standard deviation.

the effective snp size was estimated to be  <dig>  ±  <dig> ,  <dig>  ±  <dig> ,  <dig>  ±  <dig> , and  <dig>  ±  <dig>  for the human, chimpanzee, dog, and mouse genomes, respectively. the 95% confidence intervals were in a narrow range in these four genomes . overall, the effective snp size  is similar in these four genomes, and  represents only a small proportion of the genome-wide snp data . the comparative results suggest strong genetic influences such as cpg effects across vertebrate genomes  <cit> .

we next estimated the effective snp size for the specific genomic regions in the human genome. we used snps in intergenic regions, genes, introns, and cpg islands and the average nucleotide frequencies in the corresponding genomic regions. we did not test in exons or untranslated regions  because the number of snps mapped in exons or utrs was not sufficient. although the numbers of snps and sequence compositions in the genomic regions varied greatly, their effective snp sizes were estimated to be similar:  <dig>  ±  <dig>  ,  <dig>  ±  <dig>  ,  <dig>  ±  <dig>  , and  <dig>  ±  <dig>  . the effective snp size in the cpg islands is the largest. this reflects the lack of methylation and suppression of 5mc deamination in cpg islands  <cit> .

performance comparison
we compared the performance of our method versus the empirical iterative procedures in snpnb  <cit> . we tested on a dell workstation  using human and mouse snp data. the results indicated that snpks greatly outperformed snpnb. for human snp data, snpnb elapsed ~ <dig> hours by a single round of evaluation and ~ <dig> hours by  <dig> rounds. this compares to only ~ <dig>  hours in snpks, which doesn't require the recursive rounds to estimate the effective snp size . assuming that snpnb requires  <dig> rounds of evaluation to find a number close to the effective snp size, it required 20-fold more computation time for human snp data and 35-fold more time for mouse snp data than snpks .

discussion
the effective snp size in this study is defined as the minimum number of snps that are sufficient to represent the bias patterns observed from the whole snp data. it measures the sequence context patterns observed in the snps. to our knowledge, this term has not been used in any other report except for our previous study  <cit> . this term is similar to the effective population size or effective sample size, which has been widely used in the population genetics or disease study. for example, the effective population size  is used to measure the size of an idealized population having the same effect of random sampling on gene frequency as that in the actual population. it can be estimated by ne = θ/ <dig> μ, where θ is the population parameter and μis the mutation rate per sequence per generation  <cit> . one example of the effective sample size in snp analysis  is to estimate the number of sequences in an alignment given the observed number of snps in the sequences  <cit> .

it is important to know how many snps are sufficient to represent the bias patterns observed from the whole snp data. first, this evaluates whether the observed patterns are representative or random in the genome  <cit> . the early studies of mutation pattern often revealed inconsistent results because of their limited size of the data, such as the influence of the neighboring nucleotides on snps  <cit> , mutation direction   <cit> , and methylation-dependent transition rates  <cit> . to draw a firm conclusion, such an evaluation is required. second, a small effective size means high confidence of the observed biases and indicates some genetic factors  that contribute significantly to the biases. further investigations of these factors will help us understand how mutation occurs in the specific sequence environment and has been maintained or survived during the evolutionary paths. third, comparative analysis of the bias patterns and effective snp size should reveal the mutability of the sequences in the different genomic regions among genomes, which is important for the study of genome evolution. currently, more than  <dig> genome sequences have been completed and available in ncbi. the comparative genomics is emerging as an important research field. the comparative analysis of snp data should provide us many insights on the mutability of sequence, genome sequence evolution, genetic drift, and natural selection among different genomes.

in this study, our analysis revealed the similar bias patterns observed in the chimpanzee, dog, human, and mouse genomes. however, the extent of the neighboring-nucleotide biases was different among these four genomes: the strongest in the dog genome and the weakest in the mouse genome . for example, the bias for nucleotide g at the 3' immediate adjacent site was + <dig> % , + <dig> % , + <dig> % , and + <dig> %  relative to the corresponding genome average, respectively. surprisingly, the effective sizes of the snps in these four genomes were similar  and not statistically significantly different . while this may suggest the strong influence of genetic factors in these genomes, further investigations on these factors and snp ascertainment biases are warranted. note that, because the size was increased by  <dig>  each time in the iterative procedure in snpks, it is unlikely the method led to the similar effective sizes. further, the effective sizes of the snps among the human genomic regions were overall slightly higher than the genome-wide whole snps . the effective snp size was the largest in the cpg islands and smallest in the intergenic and intronic regions. this is consistent with the previous findings of the strong cpg effect in the genome except for the cpg islands  <cit>  and the possible selection in the cpg islands  <cit> . further simulation analysis may figure out how each genetic factor impacts on the effective snp size. overall, the sizes obtained in this study were in a small range,  <dig>  –  <dig> , suggesting that the effective snp size in vertebrate genomes and their genomic regions is remarkably similar and close to  <dig> . this effective size may have three applications. first, it provides a new metric to assess genetic variability in other studies or other genomes. second, millions of snps are to be discovered in many vertebrate genomes in the near future. the effective snp size may be found larger or smaller than  <dig> . then, comparative genomics studies may uncover one or some genetic factors  contribute to the difference. third, it may be used to compare the mutation pattern in a variety of specific datasets, such as disease causing mutations, snps with rare allele frequencies or common allele frequencies, different snp types , snps at the biased codons or at the fourfold degenerate sites, mutation direction asymmetry at two dna strands .

to examine whether the above estimates of the effective snp size were reliable, we performed some additional analysis using different datasets. first, snp discovery and sampling is often subject to ascertainment bias  <cit> . some snps in the dbsnp database were identified from a very limited number of sequences, even from only two sequences. to examine whether such an ascertainment bias has an effect on the estimation of the effective snp size, we used hapmap phase i snps, which had strong ascertainment bias, and phase ii snps, which had less sampling ascertainment bias  <cit> . the effective snp size was estimated to be similar:  <dig>  ±  <dig>  for the  <dig>  phase i snps and  <dig>  ±  <dig>  for the  <dig> , <dig> phase ii snps . second, we examined whether a random subset of the total snps can have the similar effective size as the total snps. we generated  <dig> random subsets from the human snps, with their sizes ranging from  <dig>  to  <dig>  million. the effective snp sizes of these  <dig> subsets were within a range of  <dig>  to  <dig>   and similar to that  of the total human snps. third, we compared the effective sizes of two sets of snps in the mouse genome:  <dig>  snps  and  <dig> , <dig> . again, the effective sizes were similar . these results suggest that the estimation of effective snp size is less impacted by the ascertainment biases and sample size, thus, is robust.

it is difficult to evaluate whether one bias pattern is statistically the same as another because it needs to compare each of the four nucleotides at each flanking site of snps. if we consider  <dig> neighboring sites at each flanking side of snps, we will run and compare  <dig> multiple statistical tests. it is hard to control type i error . if we apply the bonferroni corrections for  <dig> multiple comparison tests, we have the significance level α/ <dig> for each test  <cit> . that means the value of test statistic is too large to lead an unreasonable effective size. previously, a re-sampling algorithm was implemented to evaluate the effective snp size  <cit> . that algorithm is based on an empirical approach and is computationally intensive even with a few rounds of re-sampling when the number of snps is large. moreover, its algorithm can only evaluate a number which is close to the effective snp size. the snpks method proposed in this study first applies the ks test to obtain an initial effective snp size. instead of a usual statistical approach, the biological tolerable difference  is used  <cit> . this improvement seems robust because the patterns from the sample with size ne are essentially the same as those from the whole snp data by our visual examination . however, snpks is still heuristic. while it should yield adequate approximation of the effective snp size for practical use, there is no guarantee on finding the absolute minimum effective snp size.

CONCLUSIONS
we proposed an integrated statistical method  to estimate the effective snp size. snpks consists of two major steps: evaluation of an initial effective size and iterative tests of the size by interval evaluation. snpks considers both the biological significance and the statistical significance. snpks is the first method to estimate the effective size based on statistical tests and greatly outperforms snpnb. the application of snpks to real snp data in the human, chimpanzee, dog, and mouse genomes revealed the similar small effective snp size  in these four genomes and in human genomic regions, suggesting strong influence of genetic factors across vertebrate genomes.

