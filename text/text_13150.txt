BACKGROUND
dna-binding proteins such as transcription factors , insulators or dna modifying enzymes regulate various biological processes. chromatin immunoprecipitation coupled with genome tiling microarrays   <cit>  and sequencing   <cit>  have become important tools to systematically identify protein-dna interactions. particularly chip-seq, which combines chip with massively parallel sequencing, offers a new genome-wide approach to extensively determine chromosome binding sites of dna-associated proteins. however the massive amounts of data generated from the high-throughput sequencing pose great challenges for the identification of protein binding sites.

several statistical approaches have been developed for analyzing chip-seq data generated by single-end sequencing to find genomic regions that are enriched in a pool of specifically precipitated dna fragments. these data can be used to determine the binding sites of tfs, using algorithms such as macs, quest, sissrs, chip-seq processing pipeline, f-seq, findpeaks, chipdiff, cisgenome and peakseq  <cit> . these algorithms work in a similar way, in which the enriched regions are deduced through the calculation of the tag density in a window/bin of a certain size in the genome. an estimation of the fragment size is used, typically by extending the read lengths of their 3'ends to identify binding motifs in these algorithms  <cit> . however, uncertain prediction of the precise dna-protein binding sites still occurs, thus chip-seq analysis is recognized as a relatively immature technology which requires development  <cit> .

the paired-end illumina sequencing platform is a recently emerging technology, which has been developed based on the single-end sequencing system. the paired-end sequencing system generates double-end sequencing reads using the paired-end module, which directs regeneration and amplification operations to prepare the templates for a second round of sequencing  <cit> . the double-end reads can be used for more precise identification of each corresponding dna fragment; therefore the paired-end sequencing data has the potential to increase the accuracy of identification of chromosome binding sites of dna-associated proteins because the fragment length as well as the effective genome length can be computed accurately.

here we describe a novel algorithm, sipes , which can be used to effectively mine the paired-end sequencing reads for genome-wide identification of binding sites by calculating fragment pileup values  at each nucleotide position. then a dynamic baseline, a background model and other user-set thresholds are used to find the binding sites. we demonstrate the utility of this algorithm with a chip-seq data set generated using the solexa platform for genome-wide binding analysis of a transcription factor aborted microspores . ams belongs to a basic helix-loop-helix  transcription factor, which is required for tapetal cell development and the post-meiotic microspore formation in arabidopsis thaliana  <cit> . using an in vitro selection and amplification binding assay, the recombinant ams fusion protein was shown to bind to the 6-bp consensus bhlh binding dna motif sequence canntg, typically referred to as the e-box  <cit> . the performance of sipes was compared to two algorithms, cisgenome and macs, used for reporting specific binding motifs and revealed that sipes has better resolution for binding sites discovery.

methods
chromatin immunoprecipitation 
the procedure for chip of ams-dna complexes in the wild-type arabidopsis anther was modified from that of saleh et al  <cit> . chromatin was isolated from  <dig>  g of formaldehyde cross-linked tissue from  <dig> - <dig>  mm buds of plants showing ams expression  <cit> . for immunoprecipitation, we used a specific polyclonal ams antibody, which in western blot analysis, interacts exclusively with the ams protein and shows no interaction with the ams mutant  <cit> .

dataset
since there is no public released paired-end chip-seq data, we generated a chip-seq library from an ams ip sample using a specific ams polyclonal antibody  <cit>  on chromatin isolated from arabidopsis thaliana buds. the aligned sequence reads for ams are available in the gene expression omnibus with accession number gsm <dig>  library preparation, linker annealing, amplification, and gel purification for around  <dig> ng chip dna were performed as instructed by the illumina protocol with small modifications  <cit> . gel purification and size selection for dna fragments between  <dig> and  <dig> bp were done after the amplification step.

software availability
sipes is implemented in c and will be freely available for non-profit use of most genomes . the source code and its executable file are available at http://gmdd.shgmo.org/computational-biology/chip-seq/download/sipes. users can compile sipes with the command line 'gcc -lm -o <dig> -s -g -o sipes sipes.c'. sipes runs from the command line and takes the following parameter: -bs for dynamic baseline start to construct the signal map, signal map means the picture of fragment pileup value at each nucleotide position; -be for dynamic baseline end to construct the signal map; -p for p-value cutoff to call peaks; -f for fold-enrichment to find signal maps based on the poisson model.

two types of files can be produced by sipes. one type generates signal coordinates and the pileup value of fragments from each chromosome. the other file includes signal start, signal end, signal width, reads in signal, max fragment pileup value, summit start, summit end, summit middle, summit width, p-value, and fold-enrichment of each signal map. here, summit means the location with a single global maximum fragment pileup value in the signal map.

modeling the dna fragments of paired-end reads
paired-end sequencing technology generates large numbers of reads derived from both the 5' and 3' ends of fragmented dna  in a chip-seq library. using the illumina solexa platform  <dig>  million 40-bp sequence reads were obtained from the ams ip sample. from these data,  <dig> , <dig> end- <dig> reads and  <dig> , <dig> end- <dig> reads were uniquely mapped onto the arabidopsis genome   <cit>  by ssaha <dig>   <cit> , allowing a maximum of one mismatch and no gaps in either end- <dig> or end- <dig> when the corresponding sequences mates aligned over a range of  <dig> to  <dig> bp. this process can also be used by other mapping software which supports the paired-end reads such as maq  <cit>  and bowtie  <cit> .

each pair of the sequenced reads is allocated a unique 'token' , that allows the precise identification of each corresponding dna fragment. using the mapped paired-end reads coordinate chromosome information, the start and end position of each fragment can be easily extracted via the preprocessing program of sipes . the precise location of each fragment in the reference genome is determined and these fragments are used as the sipes input.

RESULTS
calculation of the effective genome size
the paired-end sequencing technology generates double-end reads with unique tokens that can be used to determine the dna fragment's location and their corresponding length using sipes. using the preprocessing program of sipes, the effective genome size, which is the genome coverage calculated based on uniquely mapped reads, within the arabidopsis genome is  <dig> , <dig> bp, which accounts for about 93% of the whole genome length in our ams experiment .

sipes algorithm
sipes uses the fragment's start position and end position to identify binding sites  and its algorithm is overviewed in figure  <dig>  briefly, the fragments are extracted by using the start and end positions defined in 'chromosome i'. then fragment pileup value is calculated based on the sorted fragments in 'chromosome i' . subsequently, a dynamic baseline is used to cut off the bottom of peaks to identify potential binding sites. here baseline means the fragment pileup value  when start to construct the signal map. sipes is able to construct signal maps ranging from baseline  <dig> to t; t refers to the maximum baseline which can be set by users. after all the signal maps are constructed, sipes evaluates whether each signal map satisfies a set of user-determined thresholds for finding the true binding events.

the probability of detecting a binding site within a signal width w supported by at least c reads by chance based on its baseline is given by a sum of poisson distribution  <cit>  as:  

where tpn means the total number of paired-end reads , gs means the mappable genome size which is  <dig> , <dig> bp in our ams experiment, and the ratio between c and w reported as the fold-enrichment .

sipes also allows users to use their input dna as background. then false discovery rate can be calculated using n1/n <dig>  here n <dig> means the peak number that called by sipes when using chip over input dna, and n <dig> means the peak number that called by sipes when using input dna over chip with the same cutoff as n <dig>  then , where i means input dna reads count in a signal width w and c means ip reads count in w, also r is the normalization ratio of total ip reads count and total input dna reads count sequenced by the illumina solexa platform.

candidate signal maps with p below a user-defined threshold p-value and fold above a threshold fold-enrichment are called if baseline = t, or the signal maps with a single global maximum when baseline <t. since the signal maps are constructed ranging from baseline  <dig> to t, some candidate signal maps may have the same global maximum positions; sipes finally records a peak with the highest signal map value fold from the same 'global maximum position' as one binding site. and then all the called regions are ranked based on the fold.

method comparisons
sipes processes the data of paired-end sequencing by piling up the fragments in the genome. although the updated macs system supports the paired-end mode  <cit> , current publically available chip-seq algorithms are mainly targeting to single-end sequencing data. these existing chip-seq peak finding methods generally predict peaks by estimating the fragment length to predict the peak shift and use tag density within a window when dealing with the sequencing data. here we compared sipes analysis with two publicly available chip-seq peak finding methods, cisgenome  <cit>  and macs   <cit> . the mapped  <dig> , <dig> end- <dig> and  <dig> , <dig> end- <dig> reads with the same effective genome size were used for analysis using cisgenome and macs software. the depth of ams chip-seq is comparable with those used by other algorithms such as  <dig>  million chip tags for nrsf,  <dig>  million for ctcf of human in macs  <cit> . moreover, human genome size is about  <dig> times larger than arabidopsis.

the data generated by macs were compared with those of sipes using the single-end and paired-end modes of macs. a total of  <dig>  putative ams binding sites were identified using sipes , whilst only  <dig> binding sites were determined using the macs paired-end mode , and  <dig> binding sites using the macs single-end mode . we calculated the percentage of peaks harboring the ams binding motif  within  <dig> bp  of the peak center, and observed that sipes generated a higher percentage of peaks containing the ams binding motif than those of cisgenome, macs single-end mode and macs paired-end mode . the spatial resolution is expressed by the average distance from the peak center to the nearest ams motif. we observed that the average distance from the peak center to the nearest ams motif by sipes  was shorter than those of cisgenome, macs single-end mode and macs paired-end mode, suggesting that sipes system has a better spatial resolution . collectively, these results suggested that sipes is able to find peaks with better resolution for binding motif discovery.

discussion
effective genomic size is an important parameter for the calculation of p-value, and the fact that the sipes analysis can calculate fragment length and effective genomic size accurately using the reads from paired-end sequencing means that it can provide enhanced identification of dna-protein binding sites from chip-seq data. currently, most of the available algorithms can not accurately calculate the fragment size because they are mainly designed for single-end chip-seq data analysis, which usually uses the direction of reads to estimate the fragment length to identify binding sites  <cit> . the paired-end sequencing technology generates double-end reads with unique tokens that can be used to calculate fragment length using sipes. moreover, sipes can calculate the accurate effective genomic size using the advantage of the accurate fragment length. other algorithms, such as macs recommend that the effective genome size of hg <dig> is about 90% of the whole genome length  <cit>  while sissrs recommends about 80%  <cit>  and findpeaks suggests about 70%  <cit> . however this estimation is likely to affect the accuracy of the analysis for researchers who use the chip-seq technology. in this study, an effective genomic size of  <dig> , <dig> bp of ams enriched dna was observed using the sipes preprocessing program, which accounts for approximately 93% of the arabidopsis whole genome length. in addition, sipes calculates the dna-protein binding sites on basis of the analysis of fragment pileup which is more intuitive and creditable, while most of the existing algorithms are based on the tag counts to test the enrichment.

currently, most peak finding methods often employ a window scan for the whole genome with a step to calculate the read count and see if that can satisfy the statistical tests. varying window size and step length may therefore cause differences in the results. sipes can determine peak end and start positions based on a dynamic baseline while other algorithms sometimes incorrectly split a true peak into two or more peaks. in addition, sipes uses a dynamic baseline to discriminate closely adjacent binding sites to easily separate adjacent overlapping peaks. for example, if a baseline of  <dig> is used, two closely adjacent signal map a and map b are misrepresented as a single peak . but if a higher baseline is adopted, map a and map b are identified . sipes can also analyze broad peaks with high signal levels  while a peak of the same shape but of lower signal value with low signal values would have every local maxima . for example, one peak with the summit  <dig> will be called when the baseline is below  <dig> and satisfies the p-value cutoff set by the user. when the baseline is increased to  <dig>  then two peaks, one merging peak  and peak  <dig> will be called. when the baseline is increased to  <dig>  three peaks  will be called . if the low signal value is not high enough to satisfy the p-value cutoff, then only broad peaks with higher signal will be called.

therefore by utilizing a dynamic baseline, sipes can theoretically find all the signal maps with a single global maximum , this is of particular importance for high-density genomes which may have a number of binding sites in close proximity. we found that motif occurrence percentage is higher when t is increased from  <dig> to  <dig> which mean peak results will be better with a high t value; suggesting t is a good indicator of finding binding sites . also, peak number tends to be stable when t is increased using sipes, therefore users can find more genuine dna-protein binding sites by increasing the t value . from analysis of our ams chip-seq data, we recommend the users to choose as high a value for t as possible since this will allow the peaks to be identified more accurately, even though it may take more time to achieve this goal. at the same time, sipes is able to report the percentage of peaks with a single global maximum based on t set by users which can judge whether t is set reasonable.

similar to the limitation of existing algorithms, sipes is not suitable for peak finding in a wide peak region such as those histone marks, since the statistical tests are not capable of satisfying the user's threshold . additionally, sipes algorithm is targeting to paired-end sequencing reads, and not applicable for single-end sequencing data.

CONCLUSIONS
in this paper we present an algorithm sipes that can be used for calculation of the effective genome size and precise identification of binding sites from short reads generated from paired-end solexa chip-seq technology. in comparison with two existing algorithms cisgenome and macs, we conclude that sipes has better resolution for binding sites identification. moreover, the dynamic baseline used in sipes can effectively discriminate between closely adjacent dna-protein binding sites, which is of particular value when working with high-density genomes.

authors' contributions
cmw and jx contributed equally to this work. cmw and dbz conceived the strategies. dbz supervised the project. cmw built the software. jx, dsz and zaw performed ams chip and data analysis. dbz, cmw, jx and zaw wrote the paper.

supplementary material
additional file 1
sipes algorithm for calculating fragment pileup value after sort fragments by start position on chromosome i.

click here for file

 additional file 2
signal map with fragment pileup value determination using a dynamic baseline in sipes.  when the baseline is below  <dig>  one peak c would be observed by sipes, when the baseline is  <dig>  peak a and peak b are observed. this scheme shows that sipes has the ability to accurately locate the dna-protein binding sites using the dynamic baseline. one peak with the summit  <dig> will be called when the baseline is below  <dig> and satisfies the p-value cutoff set by the user. when the baseline is increased to  <dig>  then two peaks, one merging peak  and peak  <dig> will be called. when the baseline is increased to  <dig>  three peaks,  will be called.

click here for file

 acknowledgements
the authors gratefully acknowledge b meyers for critically reading the manuscript, b han for paired-end sequencing. this work was supported by the funds from the national key basic research developments program of the ministry of science and technology, pr china , national '863' high-tech project , national natural science foundation of china , and shanghai leading academic discipline project .
