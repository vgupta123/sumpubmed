BACKGROUND
microarray-based gene expression profiling experiments, which are routine today, allow researchers to identify, for instance, genes differentially expressed  between diseased and normal patient samples or genes that change in expression over time during a treatment. unfortunately, the steady increase in the amount of data generated in the past decade from such experiments was not paralleled by the evolution of analytical methods used to extract knowledge from such datasets and, therefore, there is a gap between our ability to measure gene expression data and to extract workable knowledge from it.

since the beginning of the microarray-based expression profiling experiments, researchers were interested in finding common “themes” among the genes identified as differentially expressed between two conditions. for instance the identification of gene ontology  terms enriched in differentially expressed genes was used as early as  <dig>  <cit> , but became widespread only after the first on-line go analysis tools were made available  <cit> . as biological annotations started to include descriptions of gene interactions in the form of pathways , the identification of the pathways involved in various conditions has emerged as a ubiquitous bioinformatics task.

in general, biological pathways can be divided into gene signaling pathways, and metabolic pathways. gene signaling pathways are graphs that use nodes to represent genes, or gene products, and edges to represent signals that go from one gene to another. metabolic pathways are graphs that use nodes to represent biochemical compounds, and edges to describe biochemical reactions that involve such compounds. since biochemical reactions are usually carried out by enzymes which are coded for by genes, in a metabolic pathway genes are associated with edges rather than nodes. ideally, a comprehensive pathway analysis method would be able to take into consideration all aspects of the phenomena described by a pathway. these aspects would include the position and role of each gene in a pathway, the types of signals between genes, the efficiency with which a signal travels from one gene to another, or the efficiency with which a certain reaction is carried out, rate limiting conditions, etc. such methods have been proposed for both signaling pathways  <cit> , and metabolic pathways  <cit> , but no method is currently available to analyze both types of pathways taking into consideration all the information available. hence, even though they do not use all information available, methods that treat the pathways as simple gene sets are still popular because they can be applied equally well to signaling pathways, metabolic pathways, go terms, as well as arbitrary sets of genes.

two of the most popular such methods are the gene set enrichment analysis   <cit>  and the gene set analysis   <cit> . these methods belong to the functional class scoring category of gene set analysis methods  <cit> . for a simple two group experiment , both gsea and gsa start with computing a t-statistic for each gene measured on the array. then, a score is computed for each gene set using the t-scores of all genes in the gene set. the significance of the gene set scores is determined by using permutations of the samples. both approaches treat the genes in the gene set equally.

in this work, we propose the pathway analysis with down-weighting of overlapping genes  which is a general gene set analysis method. the method gives more weight to genes that are gene set-specific, than to genes which can be found in multiple gene sets. this is similar to the approach commonly used in information retrieval  that decreases the importance of words that appear in many documents  in favor of words that are highly specific to given documents, the latter type being considered to carry more information about the informational content of the document. similarly, in our approach, if the differential expression affects genes that are highly specific to a given pathway , it is more likely that the respective pathway is truly relevant in that condition.

the process of down-weighting popular genes does not affect one’s ability to find a gene set to be significant whenever the gene set is composed mostly of ubiquitous genes, but rather increase the contrast between gene sets that overlap by reducing the contribution of the overlapping genes into the gene set scores. as a simple example, with padog, a gene set a having  <dig> out of  <dig> genes differentially expressed, that appear only in gene set a, will be found more significant than another gene set b of same size that has also  <dig> differentially expressed genes but which appear in other gene sets as well. both gsea and gsa would find the two gene sets equally significant.

analysis methods that do not treat all genes equally were previously proposed for pathway analysis in an over-representation context  <cit> , or in a functional class scoring context  <cit> , yet none specifically exploit the frequency of occurrence of genes across the pathways. moreover, unlike gsa, padog does not rely on ordinary t-scores to derive gene set scores but uses moderated t-statistics  <cit>  instead. a similar idea to use non-ordinary t-scores in the gene set scores computation was illustrated first in  <cit>  by using sam statistics  <cit>  in conjunction with gsea. moreover, unlike gsa, padog summarizes the gene scores into a gene set score using the mean of absolute values instead of the maxmean statistic.

the sensitivity of gene set analysis methods , as well their ability to rank the relevant gene sets near the top, is typically assessed using a few data sets, by asking domain experts to make informed guesses about which gene sets are relevant to each condition/dataset. relevance is determined using the expert’s knowledge and/or literature citations supporting the link between certain gene sets and the condition under the study  <cit> . the problem is that almost any gene set analysis result will be supported by some references which makes an unbiased and objective comparison of various analysis methods practically impossible. in this study, we used a different approach in which we make fewer assumptions, and use an order of magnitude more data sets . the type of gene sets considered in our validation were kegg biological pathways. each of the  <dig> microarray data sets that we used  involved a particular disease for which there is an associated pathway in the kegg database  <cit> , e.g. alzheimer’s diseasecolorectal cancerasthma, etc. we refer to these as the target pathways, and we, very conservatively, consider them to be the only ones certain to be relevant for their respective conditions. since the target pathways for all  <dig> datasets belong to the non-metabolic pathways category, we can restrict the analysis only to kegg non-metabolic pathways. analyzing all metabolic and non-metabolic pathways brings an additional challenge to the analysis methods because the assumed relevant pathway for a given condition  is now to be found among a larger pool of pathways. the gene set analysis methods were compared in terms of their ability to produce significant p-values for these target pathways and rank them near the top.

each data set comes from tissues affected by a specific disease. the kegg pathway describing that disease is henceforth considered to be the target pathway. the analysis methods were compared in terms of their ability to rank the target pathway as high as possible in the analysis of each data set.

methods
existing methods
the two methods we chose to compare padog against are the gene set enrichment analysis   <cit>  and the gene set analysis   <cit> . briefly, gsea works as follows. let gsi denote the ith gene set, where i= <dig> .ngs. for each gene j on the array, gsea computes a t-statistic zj for the differential expression of the gene between the disease group and the control group. a gene set score s is computed similar to a signed version of the kolmogorov-smirnov statistic between the values zjj∈gsiand their complement . the class labels of the arrays are permuted and the significance of the gene set score is assessed by determining the null distribution of the gene set score.

the gene set analysis   <cit>  differs from gsea in two ways. firstly, the gene set summary statistic used is the maxmean statistic, defined as: 

  smax=max∑zj/n,∑zj/n 

 where the  and  signs identify the positive and negative t-scores respectively, and n represents the number of genes in the gene set. secondly, gsa differs from gsea by re-standardizing the gene set scores by taking into account scores from sets formed by random selection of genes. permutations of class labels are then used to infer the significance of the standardized gene set scores. the need for re-standardization is justified by the fact that, given that the genes are correlated , the gene set score computed with the true class labels will be systematically larger than with permuted class labels and, hence, the significance of all gene sets will be overstated.

pathway analysis with down-weighting of overlapping genes 
let gsi with i= <dig> .ngsbe the collection of gene sets to be analyzed, each containing n genes, and g be the set of all genes measured on the array that can be mapped to at least one gene set to be analyzed. then let 풯g be the value of a moderated t-score  <cit>  of the gene g between the two conditions of interest with g∈g. the moderated t-scores are similar to ordinary t-scores, except that their standard errors have been moderated across genes, i.e., shrunk towards a common value using a bayesian model  <cit> . the moderated t-scores are expected to be more reliable than ordinary t-scores because the shrinkage of the gene standard deviations will prevent large t-scores to occur only due to small gene standard deviations.

moreover, let f  be the frequency of gene g across all gene sets to be analyzed. here f  can take values from  <dig> to ngs since a gene can be either specific to a gene set by appearing only in that gene set, or it is present in all gene sets, respectively. we want to weight the t-scores of the genes with a function of their frequency in such a way that the most frequently appearing gene gets a weight of w= <dig> , while gene set specific genes get double weight . we chose a monotonically decreasing function to relate the gene weight w to the gene frequency f  so that it is bounded between  <dig>  and  <dig>  and drops faster with increasing frequency values: 

  w=1+max−fmax−min 

for illustration purposes, the distribution of gene frequencies across all  <dig> kegg non-metabolic pathways , as well as the dependency of gene weights on gene frequency, is shown in figure  <dig>  for each gene set we compute a score as: 

  s0=1n∑g∈gsi|풯|·w 

the formula above describes the gene set scores as the mean across all genes in the gene set of the weighted absolute moderated t-scores. the gene set scores obtained with the formula above are first standardized using a row randomization approach described in  <cit>  to yield s’ <dig>  the row randomization consists of subtracting the mean and dividing by the standard deviation of gene set scores that could be obtained by randomly selecting sets of genes with the same size as the current gene set. given that our gene set summarization function eq.  <dig> is essentially a mean  both the row standardization mean and standard deviation can be inferred from the mean and standard deviation of |풯|·w values of all genes on the array, as the central limit theorem would suggest, and hence no actual permutations are needed. more specifically, the row randomization mean for gene set gsi will given by the mean  of all genes on the array, and the row randomization standard deviation can be calculated as the standard deviation of |풯|·w values of all genes on the array divided by n. a second standardization is applied by subtracting the mean and dividing to the standard deviation of s’ <dig> scores across all ngs gene sets to obtain the observed standardized scores, s0∗. the probability ppadog to observe such a large or larger standardized score is determined by permuting nite= <dig> times the array/samples labels: 

  ppadog=∑itei≥s0∗)nite 

where i is a function that returns  <dig> when the argument is true and  <dig> otherwise, and site∗ represents the standardized score obtained with the ite-th permutation of the samples for gene set gsi.

assessing the sensitivity and gene set ranking capability using real data
to assess the sensitivity and ranking capability of the gene set analysis methods discussed in this paper, we identified in the gene expression omnibus   <cit> ,  <dig> microarray data sets each involving a particular disease. for each such disease, we considered the kegg pathway that describes the biological phenomena taking place in that disease as the target pathway. for instance, the alzheimer’s disease pathway is the target pathway for all alzheimer data sets, etc. table  <dig> shows the details about these  <dig> datasets. for most diseases considered, there are several associated data sets in this collection. the gene set analysis methods were compared in terms of their ability to produce low p-values, and rank at the top these target pathways . a schematic representation of the benchmark system used to assess the performance of each gene set analysis method is shown in figure  <dig>  there were three categories of statistics computed to compare the performance of the gene set analysis methods considered in this study: 

 <dig>  statistics that describe the distribution of the  <dig> target pathway’s p-values, including the geometric mean and median , and the percentage of target pathways with nominal p< <dig>  . this later statistic is an estimate of the sensitivity of a given analysis method. the percentage of target pathways with false discovery rate  <cit>  corrected p-values  less than  <dig>  is also given.

 <dig>  statistics that describe the distribution of the  <dig> target pathways ranks, including mean and median . the rank of a target pathway, having the ithsmallest p-value amongst all ngs pathways analyzed for a given dataset, will be equal to i/ngs· <dig> 

 <dig>  statistics that allow to determine if a given pathway analysis method produces better rankings than a reference method, chosen to be gsa since it was the best among the two published methods that we tested. a simple method to test that the ranks produced by a given method for the  <dig> target pathways are smaller  than the reference method would be to use a one-tailed paired wilcoxon test, the pairing being at data set level. however, the wilcoxon test assumes that the different ranks are independent between the  <dig> datasets, yet this is may not be the case because some ranks are obtained for the same pathway in up to  <dig> datasets . another approach that we used to analyze the ranks while accounting for the eventual lack of independence among them was to fit a linear mixed-effects model. the dependent variable in this model were the rank values, while the explanatory variables were the analysis method  and the dataset id , while the random effects were the pathway ids. both the coefficient, and one-tailed p-value that a given analysis method produces better  ranks than the reference method were reported.

note that the gene set analysis methods could have been compared also in analyzing gene ontology terms instead of pathways, however, choosing one go term most relevant for each dataset would have been more subjective.

assessing the sensitivity of gene set analysis using simulated data
a sensitivity comparison between gsea, gsa and padog using simulated data was performed as in  <cit> , but further expanded to also allow for overlap between gene sets. expression data for  <dig> genes and  <dig> samples  is generated from a random normal distribution n. a number of  <dig> gene sets of size  <dig> were created, with the expression levels of some of the genes in gene set  <dig>  being artificially altered to make only this gene set relevant to the phenotype. expression levels of genes in gs <dig> were changed according to the following  <dig> scenarios by varying the amount of change, the number of genes that change in the gene set, as well as the proportion of up- to down-regulated genes: 

 <dig>  level of the first  <dig> genes of gs <dig> was increased by  <dig>  units in group  <dig> 

 <dig>  level of the first  <dig> genes of gs <dig> was increased by  <dig>  units and the level of the next  <dig> genes was decreased by  <dig>  units in group  <dig> 

 <dig>  level of the first  <dig> genes of gs <dig> was increased by  <dig>  units and the level of the next  <dig> genes was decreased by  <dig>  units in group  <dig> 

 <dig>  level of the first  <dig> genes of gs <dig> was increased by  <dig>  units and the level of the next  <dig> genes was decreased by  <dig>  units in group  <dig> 

 <dig>  level of the first  <dig> genes of gs <dig> was increased by  <dig>  units and the level of the next  <dig> genes was decreased by  <dig>  units in group  <dig> 

a number of  <dig> data sets were generated for each of the six scenarios above. orthogonal on the different scenarios we considered three analysis setups that could influence the results of padog but not gsa and gsea, according to whether or not the genes in gs <dig> are allowed to be present in other gene set as well ). in the first setup i), gs <dig> did not overlap with other gene sets as in  <cit> , ii) all genes designed to be de in gs <dig> were included also in gs <dig>  and iii) all non-de genes of gs <dig> were included in gs <dig>  with setup i) we are basically interested in assessing if the gene set summarization function of padog  combined with the moderated t-scores compares favorably to gsa and gsea, because in the absence of overlap, the genes of gs <dig> will have the same weight . when the de genes in gs <dig> appear also in other gene sets but the non-de do not , padog is expected to give higher p-values to gs <dig> compared to the situation when there is no overlap. this is because the weight of the de genes in this case will be lower than the weight on non-de genes. in contrary, if the genes that are non-de in gs <dig> overlap but the de genes are specific to gs <dig>  then padog is expected to produce smaller p-values for gs <dig> because the de genes will have more weight and also larger t-scores.

assessing the specificity of gene set analysis
to test the ability of the gene set analysis methods to not reject the null hypothesis when it is true, i.e. their specificity, we conducted two simulation studies.

simulation of the null hypothesis by sample labels permutation
in the first simulation study all the  <dig> data sets were considered, but their array/samples class labels were permuted at random before analysis so that the correlation structure between genes is preserved. in  <dig> different trials, we computed several of the statistics described above, including the median of target pathways p-values, median ranks, and the percentage of pathways with p< <dig> . the average of these statistics over the  <dig> trials are reported.

the purpose of this simulation was two-fold. first, it allows us to determine if the target pathways-based benchmark works, i.e. if the ranking results are worse for all methods when the labels are permuted compared to when the true class labels are used. second, it allows us to estimate the false positive rate  of each gene set analysis method and compare it with the level expected under the null hypothesis. all analysis methods were run on the same  <dig> permutations of the original class labels of each of the  <dig> data sets to eliminate any differences introduced by random chance. the number of internal iterations used by each analysis method was nite= <dig> 

simulation of the null hypothesis by generating random data
at the suggestion of one of the reviewers, a second type of simulation was performed to determine the false positives rate of gene set analysis methods by generating random data from a normal distribution with mean  <dig> and standard deviation of  <dig>  n. for each of the  <dig> real datasets,  <dig> fake replicas were created by maintaining the actual sample size and number of genes but generating data at random, for a total of  <dig> simulated datasets. the structure of the gene sets was preserved as defined by the  <dig> kegg metabolic and non-metabolic pathways, therefore maintaining a meaningful overlap between the different genes in the gene sets. the fraction of all significant pathways  at different αthresholds was determined.

data analysis
for all  <dig> datasets shown in table  <dig> which were available from the gene expression omnibus , the analysis was performed consistently by: a) removing outlier arrays , b) log transforming the data and normalizing it, c) performing a moderated t-test between groups and computing probes/probesets p-values, d) resolving duplicate probes/probesets to entrez id mappings by keeping the probe/probeset with smallest p-value for each unique gene and, e) filtering out all genes that could not be mapped on any of the pathways. the normalization of datasets obtained on affymetrix arrays was performed using the rma algorithm  <cit>  implemented in the affy <cit>  package of bioconductor <cit> , while normalization of of datasets run on illumina arrays were normalized using the quantile normalization algorithm  <cit>  implemented in the preprocesscore of bioconductor. the package limma <cit>  was used to compute a moderated two-sample paired or unpaired t-score depending on the particular design of each experiment.

the gsea analysis was performed using the r implementation available freely at http://www.broadinstitute.org/gsea/index.jsp, while the gsa analysis was performed using the gsa r package  <cit> . padog was implemented in r as well, together with the validation benchmark system comparing the methods. all methods were run using  <dig>  iterations to estimate the pathway p-values shown in tables  <dig> and  <dig>  while  <dig> iterations were used in the specificity analysis results shown in table  <dig> and  <dig> 

the table shows statistics computed from nominal and adjusted p-values, and ranks of the  <dig> target pathways only, including geometric mean, median and percentages of pathways significant at  <dig>  level based on nominal and adjusted p-values . the results of comparing the ranks of each method against gsa method , using a paired wilcoxon test and a linear mixed-effects model, are included. the best value for each criterion is shown in bold.

the table shows statistics computed from nominal and adjusted p-values, and ranks of the  <dig> target pathways only, including geometric mean, median and percentages of pathways significant at  <dig>  level based on nominal and adjusted p-values . the results of comparing the ranks of each method against gsa method , using a paired wilcoxon test and a linear mixed-effects model, are included. the best value for each criterion is shown in bold.

the table shows the mean p-values for gs <dig>  over  <dig> different trials in each of the  <dig> different scenarios. gsa and gsea p-values do not change if genes in gs <dig> are found in other gene sets as well. results for padog are given in the absence of overlap , presence of overlap between the genes designed to be de in gs <dig> and other gene sets , and presence of overlap between the non-de genes of gs <dig> and other gene sets . all methods used  <dig> permutations to compute the two sided p-values for gs <dig>  best values are shown in bold and second best are italicized.

the table shows statistics computed from nominal and adjusted p-values, and ranks of the  <dig> target pathways only, including geometric mean, median and percentages of pathways significant at  <dig>  level based on nominal and adjusted p-values . the results of comparing the ranks of each method against nomnow method, using a paired wilcoxon test and a linear mixed-effects model, are included. the best value for each criterion is shown in bold. padog is compared against simpler approaches that i) use gene weights but regular rather than moderated t-scores , ii) use moderated t-scores but no gene weights  and iii) use neither moderated t-scores nor gene weights .

the medians of target pathways p-values and ranks, as well as the fraction of target pathways with p< <dig>  were computed in  <dig> simulation trials. at each trial the class labels of the samples in each of  <dig> real datasets were permuted before analysis. the averages statistics over the  <dig> trials are shown.

the fraction of all pathways significant at α= <dig>  and α= <dig>  were computed after applying the three analysis methods on  <dig> datasets having expression data generated from a random normal n distribution. the collection of gene sets used in the analysis was defined by the  <dig> kegg non-metabolic and metabolic pathways.

the set of  <dig> metabolic and non-metabolic pathways and their genes were obtained from the kegg.db annotation package  <cit>  of bioconductor  <cit> . the split between metabolic and non-metabolic pathways was done based on kegg’s classification.

all analyses were run under the r statistical language and environment  <cit>  version  <dig>  and using other infrastructure packages available in bioconductor version  <dig> .

RESULTS
sensitivity and rank analysis using real data
we compared the padog method proposed here with two existing methods . the analysis was performed on i)  <dig> non-metabolic pathways  and ii)  <dig> metabolic and non-metabolic kegg pathways. the criteria used in the comparison between these methods were the sensitivity, the ranking, as well as the specificity of the gene set analysis methods considered. table  <dig> shows the summary of gene set analysis results for the three different methods based on the panel of  <dig> datasets described in table  <dig> when analyzing only kegg non-metabolic pathways.

padog compared favorably to both gsa and gsea in terms of median and geometric mean p-values of the target pathways . eight  of the  <dig> target pathways were found to be significant  with padog, but only three did so with gsa , and none with gsea. padog was the only method to identify one  of the  <dig> target pathways as significant after adjusting for multiple testing. in terms of the rank that each target pathway received in its data set , padog produced significantly better  rank values compared to gsa, as evaluated by both a paired wilcoxon test , and a linear mixed-effects model . this later test accounts for the fact that the same disease pathway is the target pathway in up to  <dig> data sets . padog improves  the rank of target pathways by  <dig>  rank units compared to gsa, which in turn is better than gsea by  <dig>  units. in other words, on average across the  <dig> data sets, the target pathways are ranked by padog approximately  <dig> rank units better than gsa, and approximately  <dig> rank units better than gsea. the paired difference in ranks for the target pathways between pathway analysis methods and the gsa method, chosen as reference, are also shown using box plots in figure  <dig> 

to determine the robustness of padog with respect to changes in the collection of gene sets to be analyzed changes, we have run the same comparison shown in table  <dig>  on the entire set of  <dig> kegg human pathways . an increase in the number of gene sets to be analyzed for a fixed gene expression dataset, is expected to impact the various methods in different ways. with padog, when there are more gene sets and, hence, more genes to be analyzed, the moderated t-scores of genes in all gene sets are expected to change because the shrinkage of standard deviations in the t-scores is based on a larger pool of genes  <cit> . secondly, the exact weights assigned to genes in padog depend on the number of gene sets in which they appear so these gene weights also change when the collection of gene sets to be analyzed changes. table  <dig> and figure  <dig> show that padog performed favorably compared to the other methods, and that the gains in terms or ranking and sensitivity are robust to changes in the collection of gene sets to be analyzed. moreover, unlike any other method tested, padog identified one  of the  <dig> target pathways as significant after adjusting for multiple testing.

sensitivity analysis using simulated data
the result of the sensitivity analysis based on  <dig> simulated data sets in each of the  <dig> different scenarios are given in table  <dig>  these results show that when all genes designed to be differentially expressed  in gs <dig> are changing in the same direction , gsa and gsea have an advantage over padog while the opposite is true in all remaining  <dig> scenarios. these results can be understood by considering the fact that gsa and gsea statistics are designed to find such cases when all the genes in the gene set change in the same direction while padog’s summary statistic is more flexible to accommodate cases when the changes occur in both directions. when the overlap favors the de genes in gs <dig> , that is, when its de genes are specific to this gene set while its non de-genes are not specific to the gene set, the performance of padog increase in all scenarios  <dig> through  <dig>  as compared to the absence of overlap. however, even when the overlap is not favorable to gs <dig> , that is, when all its non-de genes are specific to this gene set, padog still performes better than gsa and gsea under scenarios  <dig> through  <dig> 

sources of improvement in padog
the use of gene weights is the main source of improvement with padog in terms of ranking and power. this is shown in figure  <dig> and table  <dig> in which padog is compared with simpler alternative methods that i) use gene weights but regular rather than moderated t-scores , ii) use moderated t-scores but no gene weights  and iii) use neither moderated t-scores nor gene weights . as it can be seen in figure  <dig> left panel both methods that do not use weights  give higher  p-values for the target pathways than the two other methods that use weights . also as, shown in table  <dig>  the use of moderated t-scores alone  does not improve the raking compared to the reference  . although the use of weights  improves the ranking significantly compared to the reference method , the improvement is higher in the presence of the moderated t-scores.

specificity analysis of gene set analysis methods
two simulation studies were performed to determine whether the improved sensitivity of the padog method, i.e. producing lower p-values for the target pathways, comes at the expense of reduced specificity . table  <dig> shows three of the same statistics introduced in table  <dig>  except that their average was taken over  <dig> trials in which the class labels of the arrays in all  <dig> datasets were randomly permuted before the analysis. the percentage of target pathways with p< <dig>  is now the false positive rate  because using random class labels models the null hypothesis in which expression levels are dissociated from the studied phenotypes, yet the gene-gene correlations are preserved. under these circumstances, any pathways that are reported as significant by any method are, in fact, false positives.

an additional simulation in which  <dig> datasets were generated by drawing random values from a normal distribution has yielded similar results as the previous simulation. in this case the false positives rate was estimated as the fraction of all pathways across all  <dig> datasets with a p-value less than a given threshold α. the estimated false positive rates of all three methods were very close to the expected α levels as shown in table  <dig>  this again confirms that padog is not expected to find significant gene sets more often than expected by chance regardless if gene are correlated  or not .

specificity analysis of the set of target pathways
in response to the suggestion of one of the reviewers, we aimed at determining how specific the target pathways were to their respective conditions. given that the phenotype in  <dig> out of the  <dig> datasets used in our sensitivity assessment benchmark study is a form of cancer, we determined if the target pathway for each of these cancer types, in average, is found to be more significant than other general pathways typically associated with cancer such as apoptosis, cell cycle, pathways in cancer, and rna polymerase. table  <dig> shows that in average on the  <dig> cancer datasets padog shows the strongest evidence  for association between the pehnotype of the dataset and kegg’s disease specific pathway for the phenotype . the target pathway was preferred by all three methods to any other generic cancer related pathway that we have included in this comparison, based on median p-values and, by padog and gsa based on median ranks as well. the pathways in cancer gene set came in a close second for both padog and gsa. while for apoptosis and cell cycle the median p-values and ranks were around 25% for all methods, for the rna polymerase pathways these values were above  <dig> . this analysis provides evidence that the target pathways we chose were indeed specific for their respective phenotypes.

the table shows a comparison between the pathways specifically designed by kegg for each type of cancer  and other pathways that are commonly involved in many cancers. the table shows statistics computed from nominal p-values, and ranks of each type of pathway for the  <dig> cancer datasets shown in table  <dig>  padog gives the most significant p-values and best ranks to the target pathways. for each analysis method, the values for type of pathway with the smallest median p-values and ranks  are shown in bold, while the second smallest values are italicized.

CONCLUSIONS
the original contribution of this paper is two-fold. firstly, this paper introduces the idea of gene weighting in gene set analysis on the basis of gene frequency across the gene sets to analyzed. the reasoning behind this type of gene weighting is that whenever a gene belongs to multiple gene sets, that particular gene is less useful in prioritizing among those gene sets. conversely, the differential expression of a gene that is present only on a single gene set/pathway represents a stronger evidence that the given gene set/pathway is impacted in the given condition. a second original contribution is the validation procedure deployed here. the classical approach involves analyzing a handful of selected data sets and discussing the results in the light of the existing literature. this is subjective and makes the comparison of various methods practically impossible. the validation proposed here involves the analysis of a large number of data sets  that can be objectively associated with a target gene set/pathway. this objective association is based on the fact that the samples analyzed are collected from tissues affected by the target disease . this approach allows a comparison of analysis methods in terms of sensitivity and ranking. such a comparison is: a) objective, b) reproducible, and c) independent of the accuracy and thoroughness of a literature search. using this approach, we have shown that padog is able to identify the target pathways as significant more frequently and rank them consistently higher than two of the best existing methods for the analysis of gene sets based on high-throughput gene expression data.

competing interests
the authors of the manuscript do not hold or intend to apply for a patent. however, one or more authors may file an employee invention disclosure form to notify their employer that the work leading to the manuscript may be patentable.

author’s contributions
alt designed and implemented the research and drafted the manuscript. alt, sd, and rr evaluated the research and improved the manuscript. gb collected the datasets and performed data pre-processing. all authors read and approved the final manuscript.

