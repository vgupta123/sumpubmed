BACKGROUND
for thousands of years, plants have played a dominant role in the development of sophisticated traditional herbal medicine  systems  <cit> . and nowadays, hm has also attracted much interest of both patients and scientists  <cit> . however, herbal medicines are extracted with boiling water during the decoction process, which makes it very difficult to realize quality control  <cit> . in  <dig>  <cit> , the world health organization  accepted chromatography fingerprint, which reflects the complex chemical composition of the analyzed sample based on spectroscopic, chromatographic or electrophoretic techniques  <cit> , as a methodology for the assessment of natural products. but, two disadvantages exist for chromatography fingerprint: it relies on retention time which is not stable; it is chosen from only one specific wavelength which misses much information from other wavelength. so, 3d chromatogram generated by high performance liquid chromatography-diode array detector  was researched widely  <cit> . the construction of hplc-dad dataset is illustrated in figure  <dig>  in which there are three compounds contained in the solution for example.

a drop of sample is injected at the top of a column with absorbent. a cup of solvent, same as that in the sample, carries the sample through the column. different compounds will receive different resistance when they go through the column. given an ultraviolet detector at the bottom of the column, a chromatogram peak represented by si is formed to reflect the concentration for corresponding compound. if using a dad for detection, which has more than one thousand channels to detect multi-wavelength simultaneously, besides chromatogram peaks of the outflowing compounds, spectra represented by ai will also be recorded. the matrices of di and x represent ith compound and the mixture of all the compounds respectively. their relationship is given as

  x= ∑i=1ndi= ∑i=1nai×sit=a <dig> a <dig> ⋯,an×s1ts2t⋮snt=as 

where, the variable of n is the number of compounds contained in the solution, which equals to  <dig> for the example in figure  <dig> 

there are many methods to separate x  in , such as evolving factor analysis  <cit> , heuristic evolving latent projections  <cit> , window factor analysis  <cit> , orthogonal projection resolution  <cit> , evolving window orthogonal projections  <cit> , iterative target transformation factor analysis  <cit> , alternating regression  <cit> , parallel factor analysis  <cit> , multivariate curve resolution-alternating least squares  <cit>  and interactive self-modelling mixture analysis  <cit> , alternating trilinear decomposition  <cit>  and immune algorithm  <cit> . however, all these method need the number of the compounds to be known in advance. and the method to obtain the compounds' number is based on eigenvalue, which will miss small peaks especially when noise is severe. recently, independent component analysis  <cit>  was introduced in this field, which considered compounds and noises as independent components. but two disadvantages existed: 1) noises was considered as independent components, which gave unexpected and useless information in the results; 2) identifying compounds from noises after separating all the independent components was still needed.

in order to extract compounds directly from the data set, this paper proposed a parallel model of independent component analysis constrained by reference curves  and its solution by multi-areas genetic algorithm . in section  <dig>  the principle of picarc and mga were proposed. in section  <dig>  simulations and experiments were provided to show the performance of our method. finally, conclusions and future works were summarized in section  <dig> 

methods
the principle of our method is illustrated in figure  <dig>  the left thick box is the mathematical part, and the right thick box are corresponding data sets in the reality. firstly, we construct a kind of reference curve  r with different parameter of θ  based on the priori knowledge. then inputting r and x into the picarc model, calculated curves  y will be obtained. the distances, ε, between r and y are calculated by the measurement operator  ∥•∥mo. combining all the elements contained in the dash polygon together, it is called generalized picarc model, which has converted the separation problem to a multi-parameter optimization issue. next, what is needed is to find the parameters of θ*, which minimizes the value of ε.

in this paper, the algorithm of mga, which is proposed with reference to the features of r, is used to search θ*. after all the θ* have been found, y* will be obtained, whose row vectors are the chromatogram peaks for individual compounds. by using an estimator, the spectra of the compounds will be obtained. the priori knowledge has been introduced within our method. what the user needed to do is just to input your data setx .

following, the priori knowledge about chromatogram peaks, the picarc model, mo, mga and the estimator will be introduced one by one.

the priori knowledge
according to the physical principle of chromatography, each peak of chromatogram looks like certain curves such as gaussian curve, log-normal curve, gamma curve and weibull curve, etc.  <cit> , among which, the gaussian function was used prevalently for simulating chromatogram peaks in many relevant researches.  <cit>  so, we will use gaussian curve, which is illustrated in equation  and figure  <dig>  in our research. there are two parameters: μ  and σ .

  y=exp 

where, the factor of 1/2πσ is removed to set the maximum value to  <dig>  the amplitude information will be found in the spectra.

the range of the parameter μ  is decided by the data set, whose minimum value is μ1= <dig> and maximum value is μ2=column. according to the quantile of  <dig> %, we have the following inequality

  σ<μ2-μ1+ <dig> 

picarc model
the model of ica is represented as 

  x==a×s=a×=a×s1ts2t ⋮snt 

where x  are the observation vectors; a is the mixed matrix; s  are the source vectors; the subscript of t is the number of the samples in a and s . the purpose of this model is to obtain a and s  only based on x  under four assumptions <cit> . according to the separability theorem of ica <cit> , we could trust ica to separate hplc-dad data set as long as the number of the wavelength is greater than the number of the compounds. in  <dig>  the algorithm of fastica was proposed to solve  <cit> , of which the parallel form is shown as

  max eg=egsubject to e2=bi2= <dig>   

where, bi is a m-dimensional vector such thatebtx˜2= <dig>  x˜ is a matrix preprocessed fromx , g=1/4∙ is a nonlinear function. applying kkt condition  <cit>  and newton method  <cit> , the iterative equation of b  is shown as

  b+=ex˜g-eg′bb+=-1/2b 

where, g is the first derivative of g.

as mentioned in the introduction, two major problems were found when applying the ica model to hplc-dad data set. therefore, suitable modification about ica based on the priori knowledge of chromatogram peaks is needed to constrain the shape of the source signals. what should be noted is that the variable used for calculation in ica model is the x˜, which generates a signal of y′i shown in equation . however, the curve that should be constrained is yi, which is a calculated signal to approximate sit. the dw is the whitening matrix. there is a difference between y′i and yi, which is caused by pre-processing.

  y′i==bitx˜=bityi=yi <dig> yi <dig> ⋯,yit=bitdwx=bitdw 

in order to avoid introducing a new variable, which should represent the difference between y′i and yi, the model is constructed as

  maxr=tb¯t==t,d1×n]x′˜=tx″˜=te{2}=e{2}=b2= <dig> 

where d  represents the differences existing in the equation . the equation  is called picarc.

measurement operator
the purpose of mo is to measure the distance between yi and ri. here, the vector of ε= contains all these distances. we gave the definition of εias

  εi=yi-ri22= ∑j <dig> 

where, j represents every element in the vectors of yi and ri

multi-area genetic algorithm
gas are a family of computational models inspired by evolution. these algorithms encode a potential solution to a specific problem on a simple chromosome-like data structure, and apply recombination operators to these structures in such a way as to preserve critical information. usually, gas are used to find one global optimal point in the searching plane. but in our problem, several points in the μ-σ plane should be found as solutions simultaneously. in order to search multi optimal points, we propose an algorithm named multi-areas genetic algorithm .

areas are circles which are composed of chromosomes that are closed to one another, where the candidate solution will be found. if the fitness of one solution is much better than the others, the area around it will have better fitness as well. this will lead many elites assemble into this area. in order to balance the number of elites among all the areas, emigrant and immigrant policy are adopted. except limited chromosomes left in every area, the others will be selected as emigrants, which will keep balance among population in all areas. immigrant policy under certain criterion introduces new chromosomes into all areas.

the flow chart of mga is illustrated in figure  <dig>  firstly, parameters, which will be depicted in step 1), are initialized. secondly, initial population is generated. then, multi-areas have been formed among the population. each of these areas has a center and a radius. only in the areas, whose radius are big enough, the elite chromosomes have the right to match with each other and generate children. children with high fitness values will replace the inferior individuals. only a certain number of those top ranking chromosomes in an area will be kept for the next generation, the others will be selected as emigrants to avoid too many chromosomes converging in one dominant area. later, the emigrants will be allocated into different areas under certain law, which will be descripted in step 6).

after the migration process, new generation has been formed. new multi-areas will be separated among the new generation again. the iteration continues until there is no area with the size big enough to generate children. finally, only several areas left, which contain the candidates for solution. solutions are found according to the decision as described in step 7).

1) parameters initialization: the major parameters include the number of the population, the number of elites, length of the chromosome and the fitness function. the first three are decided according to the size of the search plane. the fitness of every chromosome is given by equation . here, smaller the fitness is, more superior the chromosome is.

2) population initialization: the population is equal to the row number of r. in order to get initial population with better fitness, two steps were adopted. firstly, the search space is separated into several sub spaces equally, and maximum number of chromosomes is randomly generated in every sub spaces. then, top ones according to their fitness value are selected as initial population.

3) multi-areas separation: multi-areas are formed among the population according to following steps:  select the chromosome with best fitness as the center of an area;  give an user-defined radius and draw a circle;  calculate the distance between center and the other chromosomes contained in this area, update the radius of this area with the largest distance;  for chromosomes not belonging to a specific area, repeat step  to  until no more chromosome left.

some of these circles  may overlap with each other. for those circles with severe overlapping, they should be merged as a big area for immigration; this will be further described in step 6).

4) mating and reproduction: every elite finds a mate which has the highest hamming distance, i.e. the number of different bits between them, by the sequence ordered of fitness. new chromosomes, the children, are generated by crossing every different bit between the mated pairs. if a child has better fitness value than any one of its parent, it will be classified as excellent child, which will be reserved; otherwise, it will be dropped.

5) select migrants: only limited chromosomes, whose number is user-defined depending on application, according to their fitness will stay in one area, the others are selected as emigrants. in this step, only the number of the migrants is decided. the generation of immigrants will be descripted in step 6).

6) migrant quota among areas allocation: for every circle , more elites in the previous generation, less immigrants will be allowed, to avoid too many elites in one area. if two areas are severely overlapped, they will be merged as one big area to receive immigrants. otherwise, the quota will be unfair because of the overlap. take the experiments in this paper as an example. there is a severe overlap between area  <dig> and area  <dig>  and there are  <dig> elites in area  <dig> and  <dig> elite in area  <dig>  if the area  <dig> and area  <dig> are not combined as one, there will be a small number of migrants for area  <dig> but many for area  <dig>  the immigrant in area  <dig> can also be considered as immigrant for area  <dig> because of the overlap. there is also an overlap between area  <dig> and area  <dig>  but the center of area  <dig> is at the boundary of the μ-σ plane, which is ignored for further evolution.

the chromosomes with the same number as the initial population will be generated randomly for every circle , but only top ones decided by the quota are selected as immigrants.

7) find solution: as the algorithm proceeds, the radii of the areas will become smaller. when all the radii become small enough, the program ends. the center of each area is the candidate solution. if the center is a local minimum, it will be selected as a solution.

estimator
after obtaining all the chromatogram peaks, y*≈s, by solving equation , the spectra can be estimated with y* and x with considering the noise contained in x . for simplicity, we ignore the noise in this paper to calculate spectra by

  a=x*pinv 

where the pinv is the pseudo inverse function. equation  is derived from equation  directly.

RESULTS
in this section, a group of simulations were given to explain the principle of our method. then several experiments on a real hplc-dad data set were given to demonstrate the practicability of our method. two criteria were used to evaluate our method: 1) to see whether the compounds' number found by our method was right; 2) to see the errors between the true spectra and calculated spectra.

simulations and discussion
as illustrated in figure  <dig>  five compounds' chromatogram peaks, which are represented by different parameters of  respectively, are constructed in the simulation dataset. the parameters for the compounds' chromatogram peaks from 1st to 5th are: , , ,  and  respectively. these initial parameters' distribution on the μ-σ plane is shown in figure  <dig>  there are many areas for the initial parameters, but few areas for the final parameters. the program is available from the corresponding author.

from the simulation, we can see:

 the method proposed in this paper could separate 3d chromatogram into chromatogram peaks and spectra effectively without know the compounds' number in advance even severe overlap exist. the picarc model transformed the separation problem to a multi-parameter optimization issue, which could be solved by swarm intelligent algorithm. the algorithm of mga could find all the solutions simultaneously.

 sometimes, the result given by this method was incorrect. this is because that the chromosome is initialized randomly, which will cause undetermined situation. this problem can be solved by running program multiple times and compare the candidate results to obtain the final results. ten times of simulation have been done in this simulation and seven times have the correct result, which is list in table  <dig> 

column of nume is the elites' number contained in this area. column of nump is the population's number contained in this area. column of errorc is the ε between the reference curves with the center as parameters and the chromatogram peaks. column of errors is the error between the calculated spectra and the true spectra.

 the implementation of the mga is fast. among ten times of simulation, the slowest one took  <dig> steps and  <dig>  seconds.

experiments and discussion
the program of experiment is available for free from the corresponding author. the data set of "adataset.mat", which is used in the experiment, can be downloaded from http://www.mcrals.info for free  <cit> . the data set is illustrated in figure  <dig>  the data set is a three-compound system with two pesticides identified and one unknown interferent. the three-way data set is formed by one matrix with the three compounds and two matrices of standards with one known compound.

ten experiments were run totally. as the population initialization was randomly, we just list the initial population and initial multi-areas for the first experiment in table  <dig>  among the ten experiments, eight gave the same results: ,  and . the initial population distribution and the final population distribution of one experiment are illustrated in figure  <dig>  the calculated results are illustrated in figure  <dig> 

column of error is the ε between the reference curves with the center as parameters and the chromatogram peaks. column of nume is the elites' number contained in this area. column of nump is the population's number contained in this area.

from the results, we can see:

 the method proposed in this paper can separate true hplc-dad data set into chromatogram peaks and spectra without know the compounds' number in advance. in the ten experiments, eight gave correct results. and the maximum step and time cost are  <dig> and  <dig>  seconds.

 in  of figure  <dig>  the profile is the projection of the data set along the axis of wavelength. and the chromatogram peaks are products of the calculated curves by the maximum value of the corresponding calculated spectra. the reason that the second peak is higher than the profile is that there is some values in the spectra are negative. the reason for the negative will be discussed in next item.

 in  and  of figure  <dig>  there are still errors between the calculated spectra and true spectra. this could be caused by following two reasons: noise existed in the data set; difference between the reference curve and true chromatogram peaks. for the first reason, the estimator, shown in equation  should be improved. for the second reason, more detailed reference curve should be proposed to replace equation .

CONCLUSIONS
in this paper, the picarc model and its solution by mga were proposed. a priori knowledge of chromatogram peaks is introduced into ica model. and the shape of the chromatogram peaks, which are the source signals in the ica model, is constrained with certain kind of function with parameters. because the gaussian curve is used widely in relevant field, we use gaussian curve to constrain the shape of the chromatogram peaks. in order to solve this model, which contained several objective points in the μ-σ plane, we modified the algorithm of ga to propose the algorithm of mga. this algorithm separated all the population into multi-areas according to their fitness and distances from each other. immigrant policy was adopted to keep the variety of the population. in order to avoid gathering too many elites into one dominant area, the immigrants were allocated according to the former elite number of the destination area. finally, simulations and experiments were done to prove the performance of our model and its solution algorithm. in this section, conclusions were summarized firstly, and then future works were prospected.

