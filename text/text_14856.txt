BACKGROUND
understanding the cell as a system of interacting components is a fundamental goal of current biology. various types of biological networks are being constructed in cellular systems including ppi networks, gene regulatory networks and metabolic networks, etc. exploring how molecules interact to form cellular machinery is a key task in systems biology. the well-understood graph-theoretical concepts has become a powerful tool to explore the topology, organization, function and evolution of biological networks. in this field, recent studies have made great progresses which considerably expanded our insights in the organizational principles and cellular mechanisms of cellular systems  <cit> .

modularity has been considered to be one of the main organization principles of biological networks in the past decade years. biological modules as a critical level of biological hierarchy and relatively independent units play special roles in biological systems  <cit> . how to uncover modular structures in various biological networks is a basic step for understanding cellular functions and organizational mechanisms of biosystems. for example, by using the network partition, zhao et al.  investigated the functional and evolutionary modularity of human metabolic networks from a topological perspective  <cit> .

in the past few years, a huge number of computational methods have been developed for detecting network modules and analyzing the network structure of biological networks. hierarchical clustering has been proven to be useful tools for analyzing biological networks. ravasz et al.  studied the hierarchical modular organization of metabolic networks based on a topological linkage matrix. researchers of three groups  <cit>  employed hierarchical clustering based on three different clustering methods respectively to analyze the modular structure of yeast protein interaction networks. the diffusion kernel of graph was also suggested as a universal similarity metric to construct the clustering tree of networks  <cit> . however, this type of approaches may generate many identical distances  and leads to the ‘tie in proximity' problem during hierarchical clustering. this type of method imposes a stringent tree structure on the network which is highly sensitive to the metric used to assess similarity, and typically requires subjective evaluation to define modules. and the evaluation of these similarity measures for hierarchical clustering is not an easy problem.

several studies of protein interaction networks have focused on detecting highly connected protein modules  <cit>  which generally correspond to meaningful biological units such as protein complexes and functional modules. in general, these approaches only employ local connectivity among proteins and neglect many peripheral proteins that connect to the core protein clusters with few links. however, biological networks including ppi networks are generally very sparse. most methods only identify strongly connected subgraphs as modules, so only a few modules were detected  <cit> . and biologically meaningful sparse protein modules are ignored by these approaches and those lost peripheral proteins may represent experimentally true interactions. furthermore, because these approaches heavily rely on the local topological connectivity, they ignore the impact of global organization of networks. but biological networks are globally coordinated system, so the local connectivity based methods can not be employed to explore the relationship among modules. another important factor is the noise of interaction data, other sources such as the function annotation data and gene expression data have been integrated into protein interaction networks to improve the effectiveness of module detection  <cit> .

one popular class of methods for dissecting modular structure in the field of general complex networks is based on optimizing a global quality function called modularity  <cit>  to partition the network into modules. and it has been comprehensively adopted to analyze biological networks  <cit> . however, it has recently been shown that the resolution of the modularity based methods is intrinsically limited. it fails to find small communities in large networks—instead, groups of small communities turn out merged as larger ones  <cit> . li et al.  proposed a novel quality function called modularity density  which aims to conquer the resolution limit problem in modularity  <cit> . they have tested it on many kinds of small networks for illustration but not on large real networks.

in this study, we aim to introduce the new quantitative measure modularity density into the modular analysis of biomolecular networks and develop new algorithms for detecting functional modules in protein-protein interaction  networks. we first adopt the simulated annealing  technique to maximize the modularity density and evaluate its advantages on a suit of simulated networks where the modules are known. in order to conquer the computational burden of sa procedure, we adopt a spectral fc-means method for optimizing the measure and apply it to a yeast ppi network. our biological analysis of detected modules suggests that most of these modules carry distinguished biological significance. we also make a comparison of our method with other two methods including the popular mcl and modularity based methods to verify its effectiveness.

materials and methods
definition of modularity and modularity density
the popular modularity q is defined by newman and girvan . briefly, when the nodes of a network are divided into modules, one can compute it as follows:  

where m is the number of modules, l is the total number of edges in the network, li is the number of edges between nodes in module i, and di is the total number of degrees of the nodes in module i. the highest q value of all possible module separations is called the network modularity. in the past studies, empirical and simulation studies showed that the network partition method of maximizing modularity q  has good performance. however, fortunato and barthelemy  recently pointed out the serious resolution limits of this method, and claimed that the size of a detected module depends on the size of the whole network. the main reason is that the modularity q does not capture the information of the number of nodes in a module, and the choice of partition is highly sensitive to the total number of links in the network.

in the following, we introduce the so-called modularity density d which was proposed as an alternative measure for describing the modular organization  <cit> . the characteristic of this measure is that it is related to the density of subgraphs. we first define the average modularity degree of subgraph gi

where aid  is the average inner degree of the subgraph gi, which equals to twice the number of edges in subgraph gi divided by the number ni of nodes in this subgraph. aod  is the average outer degree of the subgraph gi, which equals to the number of edges with one node in the subgraph and the other node outside it divided by the number ni of nodes in the subgraph. the intuitive idea is that ad  should be as large as possible for a valid ‘module'. then the modularity density d of a partition g <dig>  …, gm is defined as the sum of all average modularity degree of gi for i =  <dig>  …, m. in contrast to q, d can be calculated as follows:  

this measure provides a way to determine if a certain mesoscopic description of the graph is accurate in terms of modules. the larger the value of d, the more accurate a partition is. so the community detection problem can be viewed as a problem of finding a partition of a network such that its modularity density d is maximized. the search for optimal modularity density d is a challenging problem due to the fact that the space of possible partitions grows faster than any power of system size.

moreover, the phenomenon of multiple resolutions or/and hierarchy of modular structures have been observed in biological networks  <cit> . the modularity density d can be extended for this more general case using a tuning parameter λ as follows  <cit> :  

where λ is a value ranging from  <dig> to  <dig>  and when λ =  <dig> , the d <dig>  corresponds to modularity density d. by varying λ, we can detect detailed and hierarchical organization of biological systems. in other words, we can divide the network into large modules and small modules using a small λ and a large λ respectively.

simulated annealing for maximizing d 
in principle, the goal of a module detection is to find the ‘optimal’ partition with largest modularity q or modularity density d. several methods have been proposed for optimizing q. most of them rely on heuristic procedures or approximate strategies. here, we employ the simulated annealing  technique to maximize q and d to obtain the ‘best’ determination of the modules of a network for evaluating. simulated annealing is a kind of stochastic search technique for optimization problems. it enables one to find ‘low cost' configurations without getting trapped in ‘high cost' local minima and has many applications in combinatorial optimization problems. in the searching process, a global parameter t representing temperature is introduced. when t is high, the system can explore configurations of high cost while at low t the system only explores low cost regions. along with the decrease of t, ‘low cost' configurations can be reached step by step by overcoming small cost barriers. when identifying modules, the objective is to maximize the quantitative indexes , thus, the cost is c = −q or −d. at each temperature, we perform a number of random updates and accept them with probability:

  

where ci

specific implementation detail can be seen in  <cit> . note that we add a decision clause to ensure that each potential ‘module' is connected. the one that performs best consists in isolating the module from the rest of the network, and performing a nested' sa, entirely independent of the ‘global’ one. in using q and d as fitness functions', the method is more direct than those relying on heuristic procedures. moreover, sa enables us to carry out an exhaustive search and to minimize the problem of finding sub-optimal partitions. we should note that the sa method can't scale to very large networks, but it is an efficient evaluation method for its exhaustive characteristic. several efficient methods for optimizing q have been proposed, but designing efficient algorithms for optimizing the new measure  is still an essential and challenging problem.

spectral method for maximizing d 
given a network g = , and denote its vertex set as v, edge set as e and adjacency matrix as a. given a m-partition pm, define a corresponding n × m assignment matrix x =  with hic =  <dig> if vi ∊ vc, and hic =  <dig> otherwise, for  <dig> ≤ c ≤ m. observe that since each vertex can only be in one cluster, x 1m = 1n. we can reformulate d in terms of the assignment matrix x as follows:  

where b is the degree matrix. let  note that  or  then, we can obtain  

so the problem of maximizing d can then be expressed as:

  

from the standard result in linear algebra, the optimal  of the above trace maximization has close relationship with the leading k eigenvectors of 2a − b by relaxing  as an arbitrary orthonormal matrix  <cit> . we can adopt the corresponding spectral algorithms and use the leading k eigenvectors of 2a − b to optimize the modularity density d. to obtain the final network partition, we apply the k-means clustering method to cluster eigenvectors. importantly, the same principle can be derived for dλ.

the procedure of the algorithm
given an upper bound k of the number of modules and the adjacency matrix a = n×n of a network. the procedure of the algorithm is stated straightforward as follows:


 <dig>  compute the diagonal matrix b = , where .

 <dig>  form the eigenvector matrix uk = , corresponding to the k largest eigenvalues of 2a − b.


 <dig>  form the matrix uk =  from the matrix uk .

 <dig>  normalize the rows of uk to unit length using euclidean distance norm: .

 <dig>  treat the rows of uk as points in rk and cluster them into k clusters using k-means or even other clustering methods.


we should note that this type of spectral clustering technique has been successfully applied to general clustering problems as well as graph clustering problems  <cit> . here, we explore the characteristic of modularity density d, and derive a new spectral clustering based method for maximize d  . and the spemd procedure described here can be seen as a particular manner of employing the standard k-means algorithm on the elements of the leading k eigenvectors to extract k clusters simultaneously. convergence and computational complexity of the spemd procedure are key problems when this method is applied to large complex networks. fortunately, several strategies can be employed to improve these problems. first, we can initialize the k-means such that the starting centroids are chosen to be as orthogonal as possible  <cit> . this strategy does not change the time complexity, but can improve the quality of convergence, thus at the same time reduce the need for restarting the random initialization process. second, several fast techniques for solving eigen system have been developed and several methods of k-means acceleration can also be found in the literature. based on this type of techniques, for large sparse networks with m ~ n, and k ≪ n, the spemd procedure will scale roughly linearly as a function of the number of nodes n  <cit> . here we didn't consider these ameliorative techniques and only focus on the validity of the spemd method.

performance measures
the biological significance of the numerically computed modules can be validated by comparing the experimentally determined complexes in the mips database  <cit>  with the computed modules. we use a best-matching criteria which was first introduced in  <cit>  to match these two type of protein sets. by minimizing the probability pol of a random overlap between a computational protein module and an experimental complex using hypergeometric distribution, we determine the best-matching experimental complex for a protein module. the pol is defined as follows:  

where n is the size of the ppi network, k is the number of their common proteins, and |c|, |m| are the sizes of an experimental complex and a computed protein module respectively.

furthermore, the geometric accuracy and separation described in the study of brohee and van helden  <cit>  are employed to evaluate the performance of the module-detection methods. we first build a contingency table t, where row i corresponds to the i th experimental complex and column j to the j th module and the value of a cell tĳ indicates the number of proteins found in common between complex i and module j. the contingency table has n rows  and m columns . using this table, each module partitioning result is compared with the experimental complexes.

accuracy: the complex-wise sensitivity is defined as the maximal fraction of proteins in complex i that could be found in one module by the formula:  

where ni is the number of proteins belonging to complex i. to characterize the general sensitivity of a partitioning result, a clustering-wise sensitivity is defined as the weighted average of over all complexes by the formula:  

moreover, the cluster-wise positive predictive value 
 is calculated as the maximal fraction of proteins in module j found in the best-matching complex by the formula:  

to determine the general ppv  of a partitioning result as a whole, the clustering-wise ppv is computed as the weighted average of  over all modules by:  

finally, the geometric accuracy  indicating the tradeoff between sensitivity and predictive value can be obtained by computing the geometric mean of the sn and the ppv as follows:  

separation: from the contingency table, the relative frequencies with respect to the marginal sums can be defined for each row and each column as:  

then the separation is computed as the product of column-wise and row-wise frequencies by:  

the complex-wise separation   is calculated as the sum of separation values for a given complex i  by:  

the complex-wise sepco and clustering-wise sepcl

the the geometric separation  is defined as the geometric mean of sepco and sepcl by:  

RESULTS
in this section, we apply the present method to a suit of simulated networks and a yeast ppi network to test its efficiency. we first present detailed numerical results to show the difference of network partition determined by maximizing the modularity density d and modularity q with simulated annealing  technique. in general, maximizing d  can give more detailed and valid results, while maximizing q  encounters serious resolution limit in simulated networks.

then we apply the new spectral method for maximizing the generalized dλ  to a yeast ppi network to identify functional modules which show significant biological relevance. comparison with mq and mcl, we show that the spemd can obtain competitive performance with the well-known mcl method and resolve much finer modular structure than mq method. to extract appropriate modules, the spemd and mcl both rely on one parameter. here, we perform the spemd and mcl with adjusted parameters to obtain the ‘best’ geometric accuracy and separation. for spemd, we tune λ from  <dig>  to  <dig>  in step of  <dig> , and for mcl, we sample inflation parameter values from  <dig>  to  <dig> in steps of  <dig> .

simulated networks
first we do the comprehensive tests on a group of simulated networks which take on significant modular characteristics. in the work of  <cit> , d-based method has been showed to be able to obtain competitive performance with q-based method. however, the size of artificial networks generated by using newman's popular procedure as well as its variant are too small to show the serious resolution limit problem of q. therefore, we devise a new type of artificial networks. the network is composed of 2m cliques , and external edges are placed randomly with a fixed expectation values so as to keep the average edge connections kout of each node to nodes of other cliques. so each network has m nodes and about m/ <dig> + n2/2) + mkout

the computational results for this experiment are summarized in figure  <dig> and figure  <dig>  where nc is the number of cliques, i.e., nc = 2m. figure  <dig> shows the fraction of nodes that are correctly classified into the communities  with respect to kout by md and mq respectively. we can see that md method based on d-value performs much better than mq method under all the different nc. for instance, for  <dig> random networks with nc =  <dig> and kout =  <dig>  on an average  <dig> % nodes are classified correctly by md, while only about  <dig> % nodes by the mq. when kout =  <dig> which indicates the corresponding networks are difficult to be partitioned, md still has very high accuracy .

the most interesting observation is that performance of md is almost the same, while that of mq is greatly decreasing with the increase of nc . for example, for  <dig> random networks with kout =  <dig>  always on an average > <dig> % nodes are classified correctly by md on four different sizes of networks with nc =  <dig>   <dig>   <dig>   <dig>  while about  <dig> %,  <dig> %,  <dig> %,  <dig> % nodes by the mq respectively. this fact shows the serious resolution limit problem of modularity q, while that can not be observed on the small networks such as the simulated networks using newman's method.

to test the performance of md and mq in selecting the number of communities, we calculate the number of modules. figure  <dig> shows the averaged number of modules on four different sizes of networks  with respect to kout by md and mq respectively. we can see that md performs much better than mq. the md can almost always identify the right number of modules in four different sizes of networks with kout ≤  <dig>  while mq can not do that. for example, for  <dig> random networks with nc =  <dig> and kout =  <dig>  on an average  <dig>  modules are identified by md, while only about  <dig>  modules by the mq. for the harder case , md can still do much better than mq. actually, even for the easiest case kout =  <dig>  mq can not identify the right modules with  <dig>  modules for nc= <dig>  this uncovers the underlying resolution limit just as pointed in  <cit> . in summary, the md can recover the underlying community structure more often than the mq by a sizable margin in the simulated modular networks. the modularity density d more relies on local connectivity of a network and can uncover finer modular structure. while modularity q more relies on size and total links of a network and can lead to serious resolution limit. moreover, the limit is more serious as size of networks increasing.

results on a ppi network
the budding yeast s. cerevisiae ppi network was obtained from the dip database , which contains human-curated high-throughput and small-scale binary interactions directly observed in experiments, as well as binary interactions inferred from high-confidence protein complex data. we only considered non-self physical interactions and built the ppi network. the giant component of the ppi network is composed of  <dig> proteins linked by  <dig> nonredundant interactions. in order to test the ability of spemd to extract complexes from the interaction network and compare it with other two methods, we compared the detected modules to known complexes in yeast as annotated by the munich information center for protein sequences   <cit>  using the pol formula. we apply the spemd method to the yeast ppi network to detect functional modules. totally, we obtain  <dig> protein modules of sizes from  <dig> to  <dig> with λ =  <dig>  . in table  <dig>  we show detailed information of  <dig> detected modules and their matching with experimentally determined protein complexes that were catalogued in mips database. figure  <dig> presents two such modules. for example, the second one is a nine-member module which matches with golgi transport complex for stimulating intra-golgi transport with pol = 10− <dig> .

illustration of  <dig> detected modules and their matching with experimentally determined protein complexes that were catalogued in mips database.

comparison with mcl and mq
there has been many methods for detecting network modules. the comparison of all the methods is not an easy task. here, we attempt to compare the md  with two types of classical methods: mq and mcl. just as we have mentioned, the modularity  maximization based module-detection method has been comprehensively applied in many fields including analysis of biological networks. another method is the markov cluster algorithm  which was developed by van dongen  <cit> . the method simulates a flow on the network by calculating successive powers of the network adjacency matrix. in each iteration, an inflation step is applied to enhance the contrast between regions of strong or weak flow in the network. the process converges towards a partition of the network, with a set of high-flow regions separated by boundaries with no flow. the value of the inflation parameter strongly influences the the size and number of the detected modules. in a recent evaluation study  <cit> , the algorithm was found to be superior to several representative graph clustering algorithms including mcode  <cit> , rnsc  <cit>  and spc  <cit>  for the prediction of protein complexes.

the module size distribution of detected modules for each method on the ppi network have been shown in figure  <dig>  the spemd and mcl identify  <dig> and  <dig> modules respectively without extremely large clusters . the major trend generated by md and mcl are both similar to that of the complexes in mips database, which suggest the definition of modularity density is reasonable . unfortunately, the module size distribution of mq is very different from the previous ones. the mq only detect  <dig> modules with relative large size ranging from  <dig> to  <dig>  as tested on the simulated networks, the mq method is highly limited by the resolution problem .

as to biological significance, the accuracy and separation are used for evaluating the correspondence between complexes and modules from each method  <cit> . from figure  <dig>  we can easily see that the spemd and mcl have consistently better performance than mq. this means the modularity density based partition method can produce more biologically significant modules than the modularity based method. and the new quality function may become an evaluation index of modularity organization of networks. while mcl has no such evaluation function.

discussion and 
CONCLUSIONS
ppi networks are typical examples of complex biological systems that are difficult to understand from raw experimental data alone. algorithmic and modeling progresses in the area of biomolecular networks analysis could contribute to the understanding of biological processes and organization. many methods have been developed to organize, display and extract significant patterns in these systems  <cit> . 

a number of network clustering algorithms have been proposed to find modular structures in ppi networks and other biological networks. our work is a further development along this line for dissecting biological systems. here we introduce the quantitative measure  for exploring modular organization of networks to the field of biomolecular networks. we suggest the sa technique to maximize it for rigorous evaluation and we propose an efficient spectral -means method in the decomposition procedure. our comparative experiments with mcl and mq on a yeast ppi network show that the md  method can effectively detect protein interaction modules from a complex interaction network. in the current research, we use known complexes to choose the optimal λ as well as the inflation parameter for mcl algorithm. actually, we can also adopt an intrinsic measure which compares the resulting modules against the original network to choose the most appropriate parameter in an unsupervised manner. for example, van dongen  <cit>  suggested the so-called efficiency measure to test the performance of network clustering efficiency. therefore, the present method can be easily adapted to a fully self-contained method that doesn't rely on any known data or given parameters. the current algorithm, as most clustering methods, uncovers only disjoint modules . however, in real biological systems, proteins can be contained in more than one functional module or complex. zhang et al.  has suggested to apply fuzzy c-means clustering method to a spectral space for uncovering fuzzy modules  <cit> . it can also be addressed using an intrinsic measure based on the original network in the same way as suggested in  <cit>  by post-processing the modules obtained from the present algorithm.

modularity q have been extensively employed for dissecting and evaluating the modular organization of biomolecular networks  <cit>  as well as clustering the graphic representation of gene expression profile data  <cit> . however, the heavy resolution limit of modularity q reminds researchers to use it cautiously. and the modularity density d may become an alterative measure to achieve these goals.

in summary, our method is very effective for uncovering modular organization in biomolecular networks. it provides an objective approach to explore the organization and interactions of biological processes. with the increasing amount of biological ‘interaction' data available, md  can facilitate the construction of a more complete view of the composition and interconnection of functional modules and the understanding of the organization of the whole cell at system level. we plan to automate this algorithm to compute functional modules for a large number of biological networks. we hope that related studies will benefit from the present method coupled with the modularity density d .

competing interests
the authors declare that they have no competing interests.

authors' contributions
sz designed the study. sz and xmn implemented the method, performed the experiments and analyzed the data. cd and xsz contributed to discussions on the method. sz, xmn, cd and xsz wrote the manuscript.

