BACKGROUND
transcriptional gene regulation is a complex process that uses a network of interactions to  <cit> . a central problem remains the accurate identification of transcriptional modules or gene sub-networks involved in the regulation of critical biological processes  <cit> . for cancer research, these sub-networks can help provide a signature of the disease that is potentially useful for diagnosis, or suggests novel targets for drug intervention. the biomedical research literature and several specific databases contain sequence information, gene expression profiling data, and small scale biological experiments that allow investigators to reconstruct gene regulatory networks and explore the direct effects of transcription factors on gene expression.

recently, the bioinformatics community has explored various computational approaches for transcriptional module identification  <cit> . these approaches can be classified into two major categories. the first category uses clustering methods to explore the similarity in gene expression patterns to form gene modules. the second approach uses projection methods to infer latent  components with which to group genes into modules. a growing literature documents attempts to reconstruct gene networks by applying clustering methods  <cit>  and their more sophisticated variants such as statistical regression  <cit>  and bayesian networks  <cit> . while this line of work is important to help formulate hypotheses, there are many limitations on using clustering methods for regulatory module inference. one common challenge is detecting the interactions between transcription factors and their target genes based on gene expression data alone. for regulatory module identification, it is critical to distinguish 'co-regulation' from 'co-expression', and to understand the relationship between co-regulation and co-expression. generally, genes with highly homologous regulatory sequences  should have a similar expression pattern . however, the reverse is likely not true; co-expressed genes must not necessarily exhibit common regulatory sequences  <cit> . traditional clustering analysis often returns clusters lacking shared regulatory sequences, thus making the biological relevance of these clusters relatively low for the identification of regulatory mechanisms.

a group of projection methods from the second category, including principle component analysis , independent component analysis , and non-negative matrix factorization   <cit> , have also been extensively applied for transcriptional module identification. these methods decompose gene expression data into components that are constrained to be mutually uncorrelated or independent, and then cluster genes based on their loading in the components. since these methods do not cluster genes based on their expression similarity, they are better equipped to find co-regulated gene modules. one major difficulty using such projection approaches is that the components usually represent the joint effects of many underlying transcription factors. thus, the components do not correspond to individual known transcription factors , making the biological interpretation of the components very difficult.

to overcome the above-mentioned shortcomings, several integrative methods have been proposed that integrate tf-gene interaction data with gene expression data. for instance, network component analysis  has been recently developed to successfully estimate the tf activities of regulatory networks using both chip-on-chip and gene expression data  <cit> . note that nca heavily relies on chip-on-chip data for network connectivity information with which to define regulatory modules. thus, the nca scheme is not readily applicable to many biological studies where adequate network connectivity information is not available . to deal with this difficulty, sabatti and james  <cit>  were among the first to use motif information as the initial network topology, subsequently adopting a bayesian algorithm to reconstruct regulatory modules. while theoretically elegant, this approach needs to estimate the posterior probability, a joint distribution of network topology and transcription factor activity. even using the gibbs sampling technique, it is a formidable task to estimate the joint distribution when the number of samples is limited.

we now propose a novel approach, namely motif-guided sparse decomposition , to identify co-regulated transcriptional modules by integrating motif information and gene expression data. the msd method is a bayesian-principled method without the need to estimate the joint distribution. instead, a two-step approach is used to first estimate transcription factor activity and then regulation strength on the target genes. a motif-guided clustering method is developed to help estimate transcription factor activity by taking into account both co-expression and co-regulation. a sparse decomposition step is then applied to estimate the regulation strength of predicted regulatory networks. to evaluate the performance of the proposed approach, we applied the msd method to simulated and real yeast cell cycle data, showing an improved performance in identifying three kinds of coherent modules associated with known cell cycle transcription factors. we then applied our approach to a molecular profiling study of estrogen dependence in breast cancer cells, with the goal of recovering condition-specific transcriptional modules related to estrogen action. the results demonstrated that our approach effectively finds important condition-specific regulatory modules that are functionally relevant to estrogen signaling pathways.

methods
the overall scheme of the proposed msd approach is illustrated in figure  <dig>  we start by extracting motif information from upstream dna sequences of genes, followed by a two-stage approach to integrate motif information and gene expression data for regulatory module identification. in the first stage, we use a motif-guided clustering method for transcription factor activity estimation by maximizing the motif support for co-expressed gene modules. in the second stage, we use a sparse decomposition method for regulation strength estimation to enforce that the genes in a module are likely regulated by a few transcription factors. finally, regulatory modules are reconstructed from the detected active regulators and their target genes that exhibit large regulation strengths. in this section, we will give a detailed description of each major component in the msd approach. note that the msd software package is implemented and made available at http://www.cbil.ece.vt.edu/software.htm.

latent variable model
we adopt a latent variable model that has been used in liao et al.  <cit>  and kao et al.  <cit>  to establish a link between gene expression data and motif information. the central theme of the model is that gene expression measurements can be largely determined by the unknown activities of transcription factors acting on known binding motifs . using log-ratios of gene expression measurements, a simplified, yet biologically justified, linear model can be formulated as follows  <cit> :   

where xpg is defined as the logarithm of the expression ratio of gene g between data sample p and control sample, apt the activity level of tf t in sample p and stg the regulation strength of tf t onto gene g. the log-ratios of gene expression x ∈ rm×n , are expressed as a linear combination of log-ratios of tf activity  weighted by their regulation strength . note that m is the number of samples, n is the number of genes, and n is the number of tfs.

in general, the number of tfs is much smaller than the number of transcribed genes  and most genes are regulated only by a small number of tfs. hence, the matrix s that describes the regulation strength between the tfs and their regulated genes is sparse. further, the number of tfs  is usually greater than the number of samples , i.e., n >m , such that equation  represents an underdetermined linear system . to obtain a sparse solution to this uls, we develop a two-stage approach to estimate transcription factor activity  and regulation strength  sequentially.

transcription factor activity estimation
a generic approach for transcription factor activity estimation is to use a clustering method to find representative genes whose expression profiles  can be utilized to estimate a  <cit> . for a theoretical justification of the identifiability of a, please refer to section  <dig>  in the supplementary material. many clustering techniques have been proposed to cluster gene expression data, such as k-means clustering  <cit>  and self-organizing maps  <cit> , which are designed to find gene expression patterns by grouping genes with similar expression profiles. very recently, an affinity propagation  algorithm has been proposed for data clustering that shows an improved performance  <cit> . based on an ad hoc pair-wise similarity function between data points, ap seeks to identify each cluster by one of its elements, the so-called exemplar. ap takes as input a collection of real-valued similarities between data points, where the similarity s indicates how well data point k is suited to be the exemplar for data point i. the goal is to maximize the similarity s or equivalently, to minimize the euclidean distance  <cit> , d = ||xi - xk|| <dig>  where xi and xk are two column vectors of gene i and gene k, respectively, in x.

however, direct application of the ap clustering technique to gene expression data will only give rise to co-expressed gene clusters. to identify gene regulatory modules, we need a clustering technique to integrate motif information and gene expression data, aiming to find co-regulated gene clusters with co-expressed patterns. we here propose a motif-guided clustering method to find a group of genes that not only is of similar expression pattern but also shares a common set of binding motifs as much as possible.

motif-guided gene clustering with a joint similarity measure
to incorporate motif information, we propose a new similarity measure, taking into account both expression similarity and motif binding similarity, for the ap clustering method. the motif information can be represented by a tf-gene binding strength matrix, w = , considering a set of n tfs binding onto a set of n genes. each element of w, i.e., w, denotes the binding strength of tf t onto gene g. as a common practice, the binding strength is usually approximated by a position weight matrix  that contains log-odds weights for computing a match score between a binding site and an input dna sequence  <cit> . for a detailed description of how to generate the binding strength matrix, please refer to section s <dig>  in the supplementary material of this paper. given the binding strength of tf t onto gene i ) and that of tf t onto gene k ), the joint binding strength of tf t onto both gene i and gene k is proportional to w×w, assuming that these two binding events are independent. thus, for all possible tfs  binding onto gene i and gene k, it is reasonable to use the sum of their joint binding strengths to measure the likelihood of gene i and gene k being co-regulated by the possible set of tfs :   

for motif-guided clustering, we propose the following pair-wise similarity measure to simultaneously consider the binding motif likelihood and gene expression similarity:   

where λ is a trade-off parameter that controls the contribution from two different information sources: motif information and gene expression data. when incorporated into an ap clustering method, the first term in eq.  is used to find a group of genes with similar expression pattern, while the second term estimates those genes that should share a common set of tfs.

ideally, the clustering result will generate a better representation of the transcription factor activity that underlies a co-regulated group of genes. however, both motif information and gene expression data are noisy because the binding motif is a very short dna sequence  <cit>  and there is often a low signal-to-noise ratio in gene expression measurements  <cit> . the impact of the noises can be clearly observed in two extreme cases:  the gene cluster resulting from  motif information alone will show a noisy expression pattern;  the cluster resulting from gene expression data alone will often gain little support in terms of being regulated by a shared set of motifs. therefore, it is important to understand the contribution of each data source and assign its proper weight. the trade-off parameter λ in eq.  is used to alleviate the effects of noise. in the following section, we will design an entropy-based measure, in conjunction with a non-uniformity measure, to help find the optimal value for the trade-off parameter λ.

determination of the trade-off parameter
to measure the relative contribution of motif information to gene clustering, we propose an entropy-based measure to capture the property that a regulatory module should be regulated by a unique set of active transcription factors. for each gene cluster, an enrichment analysis is first performed to identify the significant motifs associated with the genes in the cluster. specifically, a hyper-geometric test is designed to calculate the significance value  of a motif  enriched in the cluster. the testing procedure can be described as follows. the null distribution is generated by randomly sampling the entire gene population  as many times as possible  to form random gene clusters. let us assume that the gene cluster j under examination consists of nj genes in which nb genes have the support of motif t, while in the entire gene population the total number of genes that contain the motif t in their promoters is nb. for the randomly generated clusters , we count the number of genes containing motif t in each cluster, denoted as ir, to finally form the null distribution. the p-value for motif t enriched in cluster j can then be calculated as follows:   

with the p-value for each motif's enrichment, we calculate the motif emission frequency  <cit>  for all the motifs in each cluster. for a particular cluster index j, j =  <dig> ..., j, a set of motif frequencies can be defined as θj = , where θjt = -log <dig> pjt, t =  <dig> ..., n and pjt is the p-value obtained from eq. . we then normalize θj by  to ensure that each element in θj falls in the range of  <cit> . treating motif occupancy as a random variable associated with an appropriate probability space, we can quantitatively measure the 'uncertainty' of motif occupancy in cluster j, from an information-theoretic perspective, by the following entropy definition  <cit> :   

the entropy is then normalized to be in the range of  <cit>  as divided by the maximum entropy ), i.e., ; the maximum entropy is acheived when the motif occupancy is uniformly distributed. summing over all the clusters, we can obtain the mean entropy to measure the overall 'uncertainty' of motif occupancy in the clusters as follows:   

conceptually, when motifs are randomly distributed  among the clusters, the mean entropy reaches its maximum; conversely, when motifs are uniquely distributed for each cluster , the mean entropy reaches its minimum.

to measure the relative contribution of gene expression data to gene clustering, we adopt a non-uniformity measure  <cit>  to characterize the co-expression nature of the genes in a cluster. the non-uniformity of expression pattern is measured as inversely proportional to the variance of gene expression weighted by an appropriate weighting factor as shown in the following equation:   

where  is the variance of gene expression pattern for cluster j,  the maximum variance for all clusters, and wj is the weight of cluster j defined as the proportion of genes to the entire gene population.

by varying the trade-off parameter λ in eq. , the ap clustering method will generate different clustering results. this outcome is predictable because both the motif information and gene expression data are noisy and will affect the clustering results. particularly, when λ is small, the contribution from gene expression data dominates, which will give rise to gene clusters with small non-uniformity of expression pattern but large entropy of motif occupancy . in contrast, when λ is large, the contribution from motif information dominates, leading to gene clusters with large non-uniformity but small entropy of motif occupancy . therefore, it is important to find the optimal λ value to alleviate the noise impact on finding regulatory modules. we propose to use the following cost function to combine the measure of motif occupancy ) and that of expression pattern ) as follows:   

theoretically, the cost function c is a u-shaped function; when λ reaches its optimal value, the cost function c reaches its minimum. in other words, by minimizing c we can find the optimal value of λ to take advantage of both the motif information and gene expression data, while alleviating the noise impact on gene clustering.

we can extend this cost function to a weighted form by using a trade-off parameter μ: c = μh+nonu, where  <dig> ≤ μ ≤  <dig>  by controlling μ we can obtain different sets of gene clusters with different degrees of motif occupancy and similarity in expression pattern. to determine an appropriate parameter λ, we use a simplified version of the cost function c: c = h+nonu , to help find an appropriate balance between motif occupancy and expression pattern for regualtory module identification. a simplified assumption here is that it is equally important to consider both co-regulation  and co-expression  for regulatory module identification. nevertheless, we use c to examine the robustness of parameter λ for the microarray data analyzed in this paper, ensuring that the selected parameter λ is not sensitive to a particular choice of parameter μ.

regulation strength estimation
we use the sparse component analysis  approach  <cit>  to exploit a well-known biological constraint that most genes are likely regulated by a few transcription factors, and then to estimate the regulation strength matrix s. specifically, we have devised a projected "active subspace" algorithm for regulation strength estimation that can be described as follows:

 initialize source s with a matrix w, which comes from either chip-on-chip data or tf-gene binding strength matrix searched from transfac  <cit> .

loop
 iterate for every column of s 

a. if sparseness constraints on the current column of s  apply, project sg to be desired sparse by making its l <dig> norm larger than a predefined sparseness threshold, while having the l <dig> norm unchanged. 

b. in the projected space, detect approximately which tfs are "active"; the term "active" is used to refer to the tfs with "considerably nonzero" strengths.

c. we assume that the first q tfs, {stg}, t =  <dig> ... q, have been found to be inactive. find the new estimation of sg by minimizing the cost function  subject to xg = asg.

until convergence
notice that a major step in the above algorithm ) requires a projection operator that enforces sparseness by explicitly setting both l <dig> and l <dig> norms. this operator, fortunately, has been found by hoyer  <cit>  to incorporate sparseness constraint in the context of non-negative matrix factorization . we use this projection operator in the sca approach to find the closest  sparse vector sg with a desired l <dig> and l <dig> norm. the cost function in step  is designed to minimize the regulation strength of "inactive" tfs, while letting the regulation strength of "active" tfs to change freely in order to fulfil the imposed constraint xg = asg . this can also be viewed as a form of projection into an active subspace  <cit> , resulting in an elegant mathematical approach to obtain the solution to a karush-kuhn-tucker  system .

RESULTS
synthetic and real yeast data
to validate the proposed integrative approach, we applied msd to synthetic and real yeast cell cycle data for regulatory module identification, and then compared its performance with those of other approaches including fastnca  <cit>  and sparse decomposition  <cit> . for the synthetic data set, we used a network generator, syntren  <cit> , to produce a benchmark gene expression data set based on a synthetic s. cerevisiae transcriptional regulatory network. syntren generated  <dig> samples of expression data with a set of  <dig> genes in different conditions. the genome-wide location data   <cit>  were then used to provide the binding information and these data were integrated with the gene expression data to extract transcription factor activity and estimate regulation strength.

to evaluate the performance of the msd approach, we compared its performance with those of other similar methods, including fastnca  <cit>  and sparse decomposition   <cit> . performances were measured by receiver operating characteristic  analysis and the area under the roc curve . the roc curve measures the sensitivity and specificity of a method by calculating true-positive  rate against false-positive  rate. to generate a roc curve, we first ranked the target genes for each tf according to their connection strengths in s, and then we calculated the true and false positive rates by running down the ranked gene list one at a time. to investigate the impact of noise on the respective performances of msd and fastnca, the binding information was obtained from the chip-on-chip data with different cut-off p-values ; a large cut-off p-value results in a high false positive rate in binding information .

in this experiment, we selected the following  <dig> well known regulatory tfs: arg <dig>  dal <dig>  gcn <dig>  gcr <dig>  hap <dig>  mig <dig>  rgt <dig>  rtg <dig>  rtg <dig>  ste <dig> and xbp <dig>  to calculate the averaged tp rates and fp rates for roc analysis. additional file  <dig>  figure s <dig> shows the roc curves of three different approaches and table  <dig> summarizes the aucs of the roc curves. for more analysis results, please refer to additional file  <dig>  figure s <dig>  additional file  <dig>  figure s <dig> and additional file  <dig>  table s <dig> in the supplementary material, which show detailed performance information on gene module identification for several transcription factors. as can be seen from the figures and tables, the msd approach outperforms the other two methods in identifying co-regulated genes in all three cut-off p-values. surprisingly, the performance of fastnca is worse than that of sd even though no binding information is used in the sd approach. however, fastnca largely depends on correct network topology, assuming noiseless binding information. when the noise level in binding information is relatively large, the performance of fastnca degrades to an unacceptable degree. in contrast, the msd approach finds a subset of target genes to reinforce the consistency between binding information and gene expression data, limiting the noise impact from both binding information and gene expression data.

to further evaluate our algorithm, we applied the msd approach to a cell cycle data set obtained under the condition of arrest of a cdc <dig> temperature-sensitive mutant  <cit> . as a pre-processing step, we employed knnimpute  <cit>  to fill in missing values and then identified  <dig> cell cycle-related genes as the gene subpopulation to test the msd approach. for the msd approach, we set the trade-off parameter λ in eq.  as  <dig>  for this experiment, since the cost function, c ), reached its minimum at λ =  <dig>   curve). the modified cost function c can also be found in additional file  <dig>  figure s <dig> in the supplementary material, which supports the robustness of the selected parameter λ with respect to parameter μ. since there is no ground truth of target genes available for this experiment, we used the functional enrichment of regulatory modules to compare the performance of msd with that of another method, cogrim  <cit> . cogrim is derived from a bayesian hierarchical model and implemented using the gibbs sampling technique. cogrim can help infer the activation or inhibition of tfs acting on their target genes, with an integration of microarray gene expression data, chip-on-chip data, and motif information. the top go enrichment p-values were transformed to negative logarithm values and averaged over all identified modules. the averaged enrichment score for the msd method is  <dig> , which is slightly better than the score for cogrim , demonstrating that the msd method can help identify functionally coherent gene clusters associated with specific tfs.

breast cancer cell line data
we then applied the msd approach to breast cancer cell line data to help understand estrogen signaling and action in breast cancer cells. greater than 70% of invasive breast cancers diagnosed each year in the u.s. express detectable levels of estrogen receptor alpha   <cit> . the most potent natural ligand for er is 17β-estradiol, which can regulate the proliferation of breast cancer cells and alter their cytoarchitectural and phenotypic properties  <cit> . antiestrogens, such as tamoxifen and fulvestrant, are widely used in the treatment of these breast cancers and they produce a significant survival benefit for some patients. however, half of these cancers will recur, and recurrent metastatic breast cancer remains an incurable disease. it is, therefore, clinically and biologically important to understand what transcriptional programs regulate these recurrence events  <cit> .

to gain insights into the transcriptional programs that drive tumor recurrence, we have collected and acquired breast cancer cell line data in estrogen-induced and estrogen-deprived conditions, respectively. the estrogen induced data set is a time course microarray data set obtained from the er+, estrogen-dependent breast cancer cell line mcf- <dig>  treated with 17β-estradiol   <cit> . the estrogen-deprived data set consists of a series of breast cancer variants that closely reflect clinical phenotypes of endocrine sensitive tumors  <cit> . the breast cancer variants are also derived from the mcf- <dig> cell line, including miii cells and lcc <dig> cells. miii cells were derived directly from mcf- <dig> and became estrogen independent and proliferate aggressively after six months of selection in vivo in ovariectomized athymic mice. lcc <dig> cells were derived from miii following further selection in vivo. both cell lines remain er+ and exhibit an estrogen-independent but antiestrogen sensitive phenotype  <cit> .

we focused on twenty six breast cancer and estrogen receptor  related transcription factors, which are listed in table  <dig>  this set of key transcription factors were previously identified and known to be involved in the estrogen receptor signaling ; authentic cis binding sites in breast cancer cell lines ; or overexpressed in estrogen receptor -positive breast tumors . meanwhile, we also included some motifs involved in cell cycle or apoptosis . for each identified tf, a position weight matrix  was chosen from the vertebrate non-redundant profiles within the transfac database  <cit> . further motif information was obtained from published chip-on-chip experiments  <cit> , and we generated a final list of twenty six transcription factors .

the motif information was obtained from the transfac database  <cit>  and chip-on-chip experiments  <cit> . all human promoter dna sequences were obtained from the ucsc genome database  <cit> ; we searched  <dig>  bp upstream from the transcription start site . with all vertebrate position weight matrices  provided by the transfac  <dig>  professional database  <cit> , the match™  <cit>  algorithm was used to generate a gene-motif binding strength matrix with cut offs that minimize the false-positive rate.

for the msd approach, we optimized the trade-off parameter λ in eq.  by examining the cost function c )  curves). as shown in additional file  <dig>  figure s <dig> in the supplementary material, the selected parameter λ is robust against the parameter μ in the modified cost function c. with the msd approach to integrate motif information and gene expression data, we identified several key regulatory networks associated with estrogen signaling. figure  <dig> shows the activities of five transcription factors  in estrogen-induced and estrogen-deprived conditions, respectively, that exhibit distinctive patterns of regulation. transcription factor activities clearly show different actions in response to estrogen induction ). v$ap1_q4_ <dig> was activated within  <dig> hour after estrogen treatment; v$etf_q <dig> and v$er_q <dig> were also activated early, but showed a subsequent decrease in activity followed by a second activation event by  <dig> hours; v$stat_q <dig> exhibited a response to estrogen induction within  <dig> hours. this stat activity estimation correlates well with previous findings that stats are activated via the tyrosine phosphorylation cascade after ligand binding and stimulation of the cytokine receptor-kinase complex  <cit> . one of the mechanisms by which er signaling occurs involves protein-protein interactions; activated estrogen receptors interact directly with transcription factors such as nuclear factor κb , activator protein- <dig> , and specificity protein- <dig> , to activate gene transcription  <cit> . as shown in figure  <dig>  an extended period of nfκb activation can be observed from  <dig> hours to  <dig> hours, which could be explained, at least in part, by such a mechanism.

notably, egfr is among the overlapped genes, and the expression of egfr is upregulated in lcc <dig> cells. we then searched the string database to find direct neighbors of egfr in the protein-protein interaction  network  <cit> . figure  <dig> shows some of the putative etf target genes and their ppi networks from the string database, which notably includes egfr and several direct neighbors of egfr: cbl, rasa <dig>  ptpn <dig>  shc <dig>  hbegf, src, erbb <dig>  greb <dig>  plcc <dig>  other etf target genes and their ppi networks can be found in the supplementary material .

overexpression and/or activation of the erbb receptors  may also promote proliferation, motility, adhesion, and differentiation  <cit> . recent evidence has shown that increased growth factor  signaling augments the ligand -independent activity of er  <cit> , which may partially explain the activity of er  in lcc <dig> cells as seen in figure  <dig>  in addition, the plc-gamma  and the jak-stat pathways are known to enhance the transcription of genes that regulate cell proliferation. this could contribute to the induced activity of stat  ), since one of the important signaling events activated by egfr involves tyrosine phosphorylation of stat. stimulation of egfr may induce tyrosine phosphorylation of stat <dig>  stat <dig> and stat <dig>  initiating complex formation of these stats with jak <dig> and jak <dig>  jaks are essential mediators of the interaction between egfr and the stats, which then translocate to the nucleus to stimulate gene transcription  <cit> . importantly, we have recently shown that egfr signaling through p130cas and the tyrosine kinase c-src leads to phosphorylation of stat5b, and that this signal transduction pathway induces tamoxifen resistance in mcf- <dig> breast cancer cells  <cit> .

it is also important to validate the identified target genes by biological experiments such as other breast cancer cell line data and chip-on-chip experiments. while many estrogen target genes have been identified through expression microarray studies  <cit> , the results from chip-on-chip experiments are not currently complete. nonetheless, our list of er target genes includes the following known direct targets: tff <dig>  greb <dig>  <cit> ; vamp <dig>  <cit> ; prkcsh, plec <dig>  nt5c <dig>  c19orf <dig>  tmod <dig>  and flj <dig>  <cit> . furthermore, cicatiello et al. have recently performed a comprehensive genome-wide analysis to investigate erα target genes by chromatin immunoprecipitation coupled to massively parallel sequencing and expression data  <cit> . comparing our gene list with their chip-seq and expression data showed that we find family members or isoforms of clic <dig>  elf <dig>  rab <dig>  fkbp <dig>  igfbp <dig>  and slc25a <dig> within their chip-seq data. several genes  appear in both our target gene list and their list of genes responsive to 17β-estradiol. currently, we are investigating several other transcription factors with biological experiments including chip-on-chip experiments.

to provide further statistical evidence in support of the identified er target genes, we conducted several additional analyses including statistical significance analysis, false discovery rate  calculation, gene set enrichment analysis, and motif enrichment analysis. for these statistical analyses, we selected two recently published genomic analyses of transcription factor binding of estrogen-regulated promoters as a benchmark  <cit> ; we acknowledge the incompleteness of chip-on-chip data for er target genes across multiple cellualr contexts. firstly, a statistically significant enrichment of er target genes can be observed in our er target gene list, as supported by the statistical significance  calulated based on the assumption of a hyper-geometric distribution in a comparison with the chip-on-chip benchmark target genes. a low false positive rate is evident  for the er target gene list identified by msd.

to calculate the fdr, we first ranked all the genes according to their computed binding strength in matrix s to $er_q <dig> binding site; we then selected a 'negative' set of genes with no binding connection with $er_q <dig> in position weight matrix  to form a null distribution of the binding strength. as in the msd approach, we assumed that the binding strength of target genes regulated by a transcription factor roughly follows a gamma distribution, since most transcription factors likely regulate relatively few target genes. thus, we calculated the p-value for each gene by selecting the strongest binding strength when compared with those obtained from the null distribution. to properly determine a cut-off threshold of the binding strength, we also controlled the fdr for multiple tests based on the total number of genes in the experiments  <cit> . we used the benjamini-hochberg procedure  <cit>  to compute the false discovery rate as follows. letting pk represent the corrected p-value computed for gene k, rk the rank of gene k sorted by the p-values, and g the total number of genes in the experiment, we calculated the false discovery rate for gene k as fdrk =gpk/rk. for our identified er taget gene list, we obtaned a low fdr  corresponding to a binding strength cutoff of  <dig> .

we also used a kolmogorov-smirnov  test to evaluate the enrichment of er target genes  <cit> . we first ordered all the genes in our experiments according to their computed binding strength in matrix s. we then formed the distribution of the target gene set within this ordered list by the ks nonparametric rank statistic as described below  <cit> . first, we denote n the total number of genes in the ordered er target list, x the number of overlapped genes between our inferred target genes and the chip-on-chip benchmark data, and y the number of non-ovarlepped genes. second, we let v = y, if gene i is included in the overlapped genes; v = -x, if not; note that we have  from this configuration. finally, we define the ks rank statistic as follows:  to conduct this statistical test based on a permutation test  <cit> . for our er target gene list, the ks score  is significantly higher than the scores in the null distribution based on  <dig>  randomly selected gene sets of the same size as the inferred er target genes .

we evaluated the enrichment of er binding sites in the promoters of target genes identified by the msd approach using transfac  <cit> . a motif enrichment analysis procedure was used based on a permutation test  <cit> , which can be summarized as follows. given a gene set s extracted by any computational method such as the msd approach, a statistic to measure the enrichment of a specific motif f is defined as , where m is the motif binding score as defined by both matrix similarity score and core similarity score  <cit> . to calculate the statistical significance , we need to form a null distribution. the null hypothesis is that the gene set is randomly generated from the gene population and there is no significant enrichment of the motif f. we randomly select gene sets with same size of s from the baseline gene population, and repeat b times to generate the corresponding null statistic enrichment score , for b =  <dig> ..., b. the null hypothesis distribution is assumed to be symmetric in this study. the p-value can be obtained for each gene set by calculating the probability that a null gene set has a larger statistic than the observed statistic. mathematically, the p-value can be calculated by

. by comparing our identified er target gene list to a randomly selected gene list , we clearly demonstrated a statistically significant enrichment of er binding site in the identified er target genes . the distribution of $er_q <dig> binding site among the identified er target genes is shown in figure  <dig>  along with the gene expression pattern of these er target genes in mcf- <dig> cell line data.

CONCLUSIONS
traditional clustering methods have been widely used for gene module identification by searching for similar patterns in gene expression data. clustering methods on gene expression data alone can only provide co-expressed gene modules. the expression pattern of genes in the same cluster may be correlated for reasons other than co-regulation. to identify gene regulatory modules, it is important to incorporate transcription factor binding information based either on chip-on-chip data or on motif information. the proposed method, namely, motif-guided sparse decomposition , is an integrated approach to combine gene expression data and binding information for regulatory module identification.

the main challenge is that the level of noise is high in both of the data types to be integrated. if a simple integration strategy is used, the method will result in many false positive target genes due to noise. two strategies were developed in our msd approach to mitigate the effects of noise impact on target gene identification. firstly, an affinity propagation  clustering method  <cit>  is used to estimate transcription factor activity by clustering gene expression data in conjunction with binding information. secondly, a sparse component analysis  method  <cit>  is applied to estimate regulation strength by exploiting the constraint that most genes are regulated by only a few transcription factors. since a gene cluster formed using an ap method reflects a similar pattern  and a shared regulator , the transcription factor activity  estimated from the cluster is a better starting point for regulatory module identification. using a sca method and the improved tfa estimates further refines the gene cluster by estimating the regulation strength of a particular transcription factor.

the msd approach has been developed and implemented as follows. binding motif information is initially used to define potential target genes, providing prior knowledge of the regulatory network topology. a sparse latent variable model is then used to integrate gene expression data and identify which of the potential target genes are actually activated by transcription factors. the msd approach was implemented as a two-step algorithm to perform  transcription factor activity estimation, and  regulation strength estimation. in the first step, we start to integrate binding motif information and gene expression data to identify co-regulated gene clusters. a motif-guided gene cluster method was developed and used to find the gene clusters, based on a joint similarity measure from both gene expression data and motif information. to limit the impact of noise on gene clustering performance, the contribution of each data type to clustering is quantified. the optimal trade-off between data sources can then be determined by minimizing a cost function taking into account the frequency of motif occupancy and non-uniformity of expression pattern. subsequently, we use a sparse decomposition method for regulation strength estimation.

unlike the nca method  <cit>  that assumes the network topology derived from chip-on-chip data or motif information is known without error, we consider both network configuration and connection strength estimation as integrative components of the decomposition method. the use of prior knowledge of binding motif-information provides a solid starting point. as in sabatti's work  <cit> , we also incorporate a sparse constraint to achieve a biologically meaningful representation of regulatory networks. the experimental results on synthetic and real yeast data have demonstrated that our method can effectively identify the target genes of transcription factors. the application of msd to breast cancer cell line data further revealed condition-specific regulatory modules associated with estrogen signaling and action in breast cancer, which are consistent with known gene functions in this cellular context.

the current work represents an important step toward integrating available biological information for reconstructing complex biological networks. this goal will be better accomplished by incorporating an analysis of the synergistic effect of regulators into the proposed method. combinatorial analysis may help discover the complex interplay between different regulators in order to assemble a complete map of regulatory networks for complex biological systems.

authors' contributions
tg and jx formulated the problem and developed the theoretical framework of the algorithm. tg carried out the development and implementation of the algorithm. lc, rbr, hl, yw, eph and rc provided technical and biological support to the project. all authors participated in the writing of the manuscript, and have read and approved the manuscript.

supplementary material
additional file 1
supplementary material. supplementary material includes supplementary method, tables and figures.

click here for file

 additional file 2
target genes of four transcript ion factors , respectively. the target gene lists can be found in 'target_genes_tfs.xls'.

click here for file

 acknowledgements
this study is supported by the national institutes of health under grants  and the department of defense under grant . we thank alan zwart for his work in the acquisition of breast cancer cell line microarray data. we also thank the reviewers for their invaluable suggestions that lead to many improvements in the manuscript.
