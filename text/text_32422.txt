BACKGROUND
reconstructing the phylogeny of organisms, the tree of life, is one of the major goals in biology and is essential for research in other biological disciplines ranging from evolutionary biology and systematics to biological control and conservation. in phylogenetics, molecular characters have become an indispensable tool, since they can be collected in a standardized and automated way. this is indicated by the exponential growth of published data, with a current doubling time of approximately  <dig> months  <cit>  and expected massively accelerated data generation over the next several years. the sequencing of expressed sequence tags , complete genomes and countless single-gene fragments has resulted in enormous, yet highly incomplete and unbalanced, data sets accessible via public databases such as the national center for biotechnology information  genbank, the european molecular biology laboratory  and the dna database of japan .

the accumulation of new data is, of course, important, but the potential of the currently available data for phylogenetic analysis has not yet been sufficiently explored. mcmahon and sanderson  <cit> , sanderson et al.  <cit>  and thomson and shaffer  <cit>  have published their attempts to use molecular data from public databases and to process them for phylogenetic analysis. however, these approaches, while valuable and trend-setting, did not offer thorough solutions and call for extension, improvements and updates in terms of generalization, detail, analysis and degree of automation. any new approach must offer solutions to deal with data scarcity, poor data overlap, nonstationary substitution processes, base compositional heterogeneity and data quality deficits. in this study, we address these problems with a newly developed bioinformatics pipeline. we use a large exemplar taxon for which far more than  <dig>  sequences have been published and show that comprehensive analyses can potentially deliver new results which were not available from each included data set separately.

as an exemplary taxon, we chose the insect order hymenoptera, which comprises prominent groups such as bees, ants and wasps, the latter including the overwhelming armada of parasitoid species  <cit> . the hymenoptera seem well-suited to demonstrate the power of our approach, since the taxon is megadiverse and offers a number of phylogenetic challenges, including many unresolved relationships and well-known problems that are associated with so-called long-branch taxa and rapid radiations . over a long period, comparatively few authors tried to resolve the phylogenetic relationships of the major lineages of hymenoptera . in recent years, however, interest and effort in solving higher-level relationships within the hymenoptera have notably increased and led to the publication of an extensive analysis based exclusively on morphological characters  <cit> , a study using complete mitochondrial genomes  <cit> , a supertree approach using previously published trees  <cit> , a phylogenetic estimate based on est data  <cit>  and a taxon-rich four-gene study  <cit> . in the past five years, complete nuclear genomes of several hymenoptera species have been sequenced. most noteworthy in this context are the genomes of the honey bee apis mellifera  <cit>  and the jewel wasp nasonia vitripennis, with its sibling species n. giraulti and n. longicornis  <cit> . these genomes contributed significantly to the amount of sequence data available for hymenoptera. however, their number is still too small to profitably augment phylogenetic analyses.

overall, there are only few phylogenetic hypotheses on major lineages within hymenoptera that are generally accepted. these are as follows:  "symphyta"  are paraphyletic, with the absence of the constriction between the first and second abdominal segments  as a symplesiomorphic character;  apocrita  are monophyletic ;  xyelidae are sister group to all other hymenoptera ;  orussidae are sister group to apocrita  and  aculeata  are monophyletic . in addition, most of the  <dig> currently recognized superfamilies are presumed to be monophyletic . numerous relationships within hymenoptera are still unresolved. among them, the most intriguing ones are the phylogeny of the major lineages within apocrita, and in particular what the sister group of aculeata is, and the monophyly and phylogeny of proctotrupomorpha sensu rasnitsyn  <dig>  <cit>  .

in this study, we present a standardized, fast and transparent bioinformatics pipeline to collect, filter and analyze public sequence data deposited in genbank. the pipeline is designed to be generally applicable in terms of taxa, genes and the variety of potential users. we apply this pipeline to sequences of hymenoptera and discuss our results against the background of current hypotheses on two selected questions: the phylogeny of the major lineages within apocrita and the monophyly and phylogeny of proctotrupomorpha. additionally, we use the results to diagnose persistent problems in the hymenopteran tree. finally, we illustrate the merit of being able to easily generate trees from available sequence data at a time when data sets are accumulating at an ever-increasing speed.

methods
we developed a bioinformatics pipeline that includes automated data retrieval, processing, filtering and analysis of sequence data using available programs in combination with newly developed scripts. the individual steps of the pipeline are illustrated in figure  <dig>  those steps that are executed by new scripts are highlighted in blue. these scripts can be downloaded from http://software.zfmk.de/ or accessed as part of additional file  <dig>  they have been written in the ruby or perl programming language and will run on any linux operating system. each of our scripts comes with a manual that provides more detailed information on what it does and how to use it . table  <dig> summarizes all new scripts and their respective tasks. to maneuver through the pipeline, each script has to be manually started with the output from the preceding step. this allows the user to manually interfere at each step or to modify the pipeline to adapt it to new demands. in the following paragraphs, we explain the individual steps of the pipeline using the example of the analysis of hymenoptera sequences deposited in genbank.

aavailable at http://software.zfmk.de/ and in additional file  <dig>  all scripts were written in ruby, except for checking_seq, which was written in perl. numerals  correspond to those in figure  <dig> 

sequence data retrieval and data processing
we downloaded all sequences of hymenoptera deposited in genbank  <dig>   with the aid of the script proseqco  . the script searched for the query taxon  in the nucleotide and in the est database of genbank  and stored the sequences of each species in a separate fasta file. mitochondrial sequences plus nuclear noncoding sequences   and all other nuclear sequences  were retrieved in two separate downloads. for outgroup comparison, we additionally retrieved sequence data of the transcriptome, the nuclear noncoding genes and the complete mitochondrial genome of bombyx mori , aedes aegypti  and tribolium castaneum . the gi numbers of all downloaded sequences are listed in additional file  <dig> 

left path a
the nuclear sequences were assembled into contigs for each species using the sequence assembly program cap <dig>  <cit>  . orthologous sequences were identified using hamstr  <dig>   <cit>  . we used the insecta core set  to build hidden markov models . the genome of a. mellifera was chosen for the reciprocal blast search  <cit> .  we chose hamstr as the currently most practicable tool to automatically assign orthology among nucleotide and est sequence data. during the hamstr orthology prediction, all nucleotide sequences are translated into the corresponding amino acid sequences.

right path b
the mitochondrial sequences and the nuclear noncoding sequences deposited in genbank often include regions that span more than just one gene. in these instances, the script multiple_sequence_splitter uses information from the corresponding genbank file to split sequences into fragments that correspond to single genes; that is, it creates multiple sequence files of single genes . this step was serially applied to each file that we obtained from the previous step by means of a shell script.  in each of the obtained files, we used the script checking_seq to check for consistent strand polarity and overall similarity between sequences . this was done to revert sequences with deviating strand polarity, to exclude wrongly annotated sequences and to ensure that all sequences in a single-gene file were orthologous. the script checking_seq compares a template of a gene with all the sequences of the single-gene files that were created in step  in blast2seq  <cit> . the identity  between template and target sequence had to be more than  <dig> nucleotides. otherwise, the reverse complement of the target sequence was checked, and hits were reverted. if identities were still below the match threshold, the target sequences were compared with a second, third or fourth template. primary templates were taken from a. mellifera.  we randomly selected sequences from previously successfully checked sequences as subsequent templates. a maximum of four templates were used before we finally discarded a sequence. then, to prepare the remaining sequences for the subsequent alignment, all coding mitochondrial sequences were translated from nucleotide to corresponding amino acid sequences with the aid of the script dna2aa, which uses the respective genbank information for this task . steps b.iv and b.v of our pipeline are automatically consecutively executed when using the script batch1_bivtobv.sh. 

both paths
sequence headers of all sequences were standardized to ">species,family,gi no." with the aid of the script header_standardizer, which uses the data included in the genbank entries . if multiple sequences were available for a given species and gene after respective steps  and , we chose the longest sequence from the unaligned multiple sequence files . this was done by using the script choose_longest_seq.

converged paths
we obtained numerous groups of orthologous sequences from path a and path b. groups of orthologs that comprised three or fewer species were deleted by the script small_groups_deleter . to increase data density, we discarded all species with only a single sequence in the data set by using the script taxon_deleter and again deleted groups of orthologs with three or fewer species by using small_groups_deleter .

multiple sequence alignment and alignment masking
orthologous sequences were aligned with mafft v <dig> b using the auto option . depending on the size of an alignment, mafft automatically chooses a suitable alignment option, such as l-ins-i for <  <dig> sequences and fft-ns- <dig> for >  <dig>  sequences  <cit> . all alignments were subsequently refined with the refinement option in muscle version  <dig>   <cit>  . these are powerful alignment tools that allow processing very large data sets in reasonable time. steps ii through vi of our pipeline are automatically consecutively executed when using the script batch2_iitovi.sh.  aligned and refined mitochondrial amino acid sequences were then translated back into nucleotide sequences with the aid of the script aa2dna, which uses the corresponding reading frame information from the genbank file . from this point on, we proceeded with nucleotide sequences for all mitochondrial sequences and nuclear noncoding sequences, as well as with amino acid sequences for the nuclear coding sequences .

ambiguously aligned or highly diverged regions of the alignment were masked with three different algorithms . we applied aliscore  <cit>  and alicut  <cit>  for noncoding nucleotide sequences and for nuclear amino acid sequences . since the multiple sequence alignment of 28s rrna was too big to be processed with aliscore, we used gblocks  <dig> b  <cit>  for 28s instead  number of included seq/ <dig> =  <dig>    <dig>    <dig>    <dig>  and  all). finally, we used the script gapkiller to identify and delete sites with more than 70% gaps in coding mitochondrial sequences. then we masked all third codon positions of mitochondrial coding sequences  and concatenated all trna alignments to one single alignment.

species and sequence subset selection
in each group of orthologous sequences, we selected the largest group of species in which the sequences of all species overlap in at least  <dig> nucleotide or amino acid positions . this was done with the aid of the script minimum_sequence_overlap. the script applies a maximum clique algorithm. generally, a maximum clique search is a way to find the largest group of items that fulfill a certain pairwise criterion.  this approach is the formal solution to guarantee that our overlap criterion is fulfilled. species that were not included in this first maximum clique were considered again in a search for a second maximum clique using the same criteria and the same script as before . so, for each gene, we retained two separate files with groups of orthologous sequences: the first and the second maximum clique, respectively. sequences that were not included in either of the maximum cliques were discarded.

to identify sequences that showed compositional heterogeneity in each group of orthologous nucleotide sequences, we used the script nucleotide_chi. the script applies a χ <dig> test  and proceeds with excluding sequences with a base composition that significantly deviates until all sequences show compositional homogeneity . since excluded sequences could comprise another set of homogeneous sequences, they were again tested with the same procedure as before to obtain a second group of sequences with compositional homogeneity . sequences that did not end up in either of the two groups with compositional homogeneity were discarded. after discarding numerous sequences in steps ix through xii, we again excluded species with only one sequence in the data set by using the script taxon_deleter and groups of orthologs with three or fewer species by using the script small_groups_deleter . next, we pruned species-rich genera to the  <dig> species that were best represented in the data set by using the script prune_genera. the representation criteria were, in this order,  the number of sequences in the data set and  the overall length of the sequence in the data set .

in a final subset selection step, we ensured that all species to be included in this subset overlap in at least one gene fragment of at least  <dig> nucleotide or amino acid positions . with the aid of the script reduce2leading_gene, we pruned the data set to those species that were present in the most sequence-rich group of orthologs. this was the largest group of species that fulfilled the overlap criterion. in case of hymenoptera, this group was a group of cox <dig> sequences. all corresponding sequences were concatenated with the script concatenator to one supermatrix. this supermatrix is referred to as "subset 1" . steps ix through xvi of our pipeline are automatically consecutively executed when using the script batch3_ixtoxvi.sh.  in addition to subset  <dig>  we selected a second subset. to accomplish this, we made concessions to systematic considerations and added to subset  <dig> representatives of hymenoptera families that were excluded by any of the previous filtering steps. if more than two species of the respective families were available, we selected the two best-represented species using criteria identical to those in step . with those sequences reincluded in the respective groups of orthologs, the tests for compositional heterogeneity  were repeated and all sequences were finally concatenated to a supermatrix. this supermatrix is referred to as "subset  <dig> "

tree reconstruction
phylogenetic inference of subset  <dig> and of subset  <dig> was done under the maximum likelihood  optimality criterion in partitioned analyses with raxml  <dig> . <dig>  <cit>  under the gtrcat model. analyses were computed on hpc linux clusters,  <dig> nodes with  <dig> cores each, at the regionales rechenzentrum köln  using cologne high efficient operating platform for science ; input was done in phylip format; and conversion of fasta to phylip was done using readseq  <cit>  . nuclear coding genes were treated as one partition . all other groups of orthologs were treated as separate partitions .  we applied the rapid bootstrap algorithm  <cit>  with a subsequent tree search. the numbers of bootstrap replicates were estimated on the fly by the "bootstopping" criteria implemented in raxml  <dig> . <dig>   <cit> . the analyses yielded two trees. these trees are referred to as "tree 1"  and "tree 2" . trees were edited in dendroscope  <cit>  .

hymenoptera systematics
we follow the terminology of  <cit>  for supraspecific taxa of hymenoptera.

RESULTS
we downloaded  <dig>  hymenoptera sequences from genbank  <dig>  , including those of the nuclear genome of n. vitripennis . the annotation of the nuclear genome of a. mellifera was used as a reference when searching for orthologs , and corresponding sequences of this species were added during this step. after the first processing steps , including a search for orthologs, a sequence check with checking_seq, filtering for longest sequence per species and gene, and excluding groups of orthologs with fewer than four species, the data set included a total of  <dig>  sequences from  <dig>  species and  <dig> genes. step , the exclusion of species with only one sequence in the data set, led to the exclusion of  <dig>  species and subsequently of  <dig> groups of orthologs. accordingly, sequences of  <dig>  species in  <dig> groups of orthologs were aligned in step . the selection of the first and second maximum cliques of species with an overlap of at least  <dig> nucleotides or amino acids  and the subsequent tests for compositional heterogeneity  led to the exclusion of  <dig> species and reduced the data set to  <dig>  species. the pruning of species-rich genera to  <dig> species led to the exclusion of another  <dig> species . pruned genera were camponotus, cardiocondyla, dorylus, lasius, myrmecocystus, pheidole, pogonomyrmex, polyrhachis, pseudomyrmex , bombus, diadasia, euglossa, xylocopa , colletes, hylaeus , aleiodes, cotesia , ceratosolen , andricus , neodiprion , pontania , megastigmus  and polistes .

after selecting the largest group of species that overlap in at least one group of orthologs , the final concatenated data set  included  <dig>  species ,  <dig> groups of orthologs,  <dig>  sequences and  <dig>  aligned sites. data coverage in subset  <dig>  was  <dig> %. tree reconstruction and  <dig> rapid bootstrap replicates took  <dig>  days. tree  <dig> obtained from subset  <dig> is shown in figures  <dig> and  <dig> and additional file  <dig> 

subset  <dig> included an additional  <dig> sequences of  <dig> species from  <dig> families. overall, the concatenated subset  <dig> consisted of  <dig>  species ,  <dig> groups of orthologs,  <dig>  sequences and  <dig>  aligned sites. the number of species is >  <dig>  plus  <dig> due to repeated tests for compositional heterogeneity with slightly different results. . data coverage  in subset  <dig> was  <dig> %. tree reconstruction and  <dig> rapid bootstrap replicates took  <dig>  days. tree  <dig> obtained from subset  <dig> is shown in figure  <dig> and additional file  <dig>  all species and all groups of orthologs included in subsets  <dig> and  <dig> are listed in additional files  <dig>   <dig>   <dig> and  <dig> 

discussion
the aim of the present investigation was to develop a bioinformatics pipeline for retrieving, processing, filtering, editing and analyzing large amounts of sequence data from genbank in a phylogenetic context. instead of using supertree approaches to explore existing data , we relied on a direct reanalysis of the sequence data. smith et al.  <cit>  presented an alternative approach that they called a "mega-phylogeny approach", which also directly uses sequence data. it includes an a priori selection of gene regions of interest and an a priori separation of sequences into alleged monophyla with the aims of reducing the size of the supermatrix and improving alignment quality. a number of taxon-specific studies have also made use of genbank sequence data, but those studies focused on specific genes . we intended to avoid a priori decisions. in our pipeline, we suggest solutions for almost any obstacle that may appear along the way from sequence retrieval to tree reconstruction under the ml optimality criterion. in various regards, our approach is an extension and improvement of earlier efforts  <cit> . it offers an extended degree of automation in steps such as downloading from genbank, sorting of sequences and translating and backtranslating sequences  . also, our approach includes improved quality management, such as by automatically checking the genbank sequences for strand polarity and annotation, by masking problematic alignment regions and by handling compositional heterogeneity  . our data selection steps   guarantee standardized levels of the density of the data set and of sequence overlap between included species. by choosing a minimum sequence overlap of  <dig> positions, we attempted to find a reasonable compromise between sequence overlap and number of species in the analysis. a larger overlap would have led to a significant decrease of the number of species in our phylogenetic tree. furthermore, the present study is an update in terms of tree reconstruction facilities. we have, for the first time, applied a ml algorithm to such a large amount of genbank data  . our approach is more general and independent of the taxonomic group. finally, our bioinformatics solution is transparent and user-friendly. we provide all new scripts with respective comments and detailed manuals as part of this publication so that the pipeline is ready for use by anybody interested. in the following paragraphs, we discuss the results of our exemplary pipeline run with hymenoptera data.

data set and analysis
one of the main characteristics of data sets when combining sequence data from independently conducted investigations is data scarcity; that is, the lack of data overlap. data distribution in supermatrices is unbalanced, and, as a consequence, there is a huge amount of missing data. however, data sets do not necessarily have to be complete to provide phylogenetic information. in fact, there is evidence that even with very low coverage, reliable phylogenetic estimates can be obtained . the sheer proportion of missing data is not decisive as long as the number of characters scored is sufficient to correctly place the taxa in the tree  <cit> . accordingly, we tried to cope with the problem of data scarcity by ensuring a minimum sequence overlap between taxa and a standardized data set density  . still, our hymenoptera data matrix is very large and exhibits very low coverage . this is a direct consequence of the characteristics of the original sequence information present in genbank. a large number of species for which only few sequences are available contrasts with a small number of species for which the transcriptome, the mitochondrial genome or even the entire nuclear genome have been sequenced. by combining all of these data in a single analysis, this data set will inevitably become large and unbalanced and will suffer from low overlap between taxa. irrespective of the fact that sequencing is getting cheaper and faster and that phylogenomic data will rapidly increase the size of data sets, the data characteristics described herein are still expected to prevail in the near future. the challenge is to find optimal subsets for phylogenetic analysis in order to explore available information and to subsequently identify and fill the most severe gaps via target-specific sequencing. accordingly, one of the goals of our approach has been to identify unstable nodes and to suggest future foci of molecular phylogenetic studies, in hymenoptera, for an effective, economical and time-saving process.

for tree reconstruction, we performed supermatrix ml analyses. to the best of our knowledge, this is the largest set of eukaryotic real data studied using ml analysis. past studies that utilized very large data sets applied supertrees or parsimony analyses. for example, mcmahon and sanderson  <cit>  and thomson and shaffer  <cit>  applied maximum parsimony analyses with supermatrices in their pipelines, but stated that they based this decision mainly on speed and computational capacity. however, with the latest program version of raxml implementing partitioned analysis, rapid bootstrap functions, and the ability of parallel analyses, even very large data sets, can be analyzed in a reasonable amount of time. in the next few years, systematic biologists' access to multicore computers will get easier and broader, and high-performance computing  will become routine. at the moment, subsets should be constrained in size to allow ml analysis. during our work, we set an approximate maximum of  <dig>  taxa and  <dig>  sites. phylogenetic analyses of subsets of this size take a maximum of two weeks on a fully parallelized hpc unit such as the one that we used. unless one wants to analyze data sets that are significantly larger than ours, there is no computational or speed argument left to perform supertree or parsimony methods in favor of ml analyses. accordingly, our approach was designed to prepare data for ml analysis. however, if a user wants to apply other algorithms for tree reconstruction  or to adjust parameters , the supermatrix produced by our pipeline can be used just as well  .

the phylogeny of hymenoptera
we have restricted our results and discussion to  new contributions to the phylogeny of major lineages within apocrita and to the monophyly and phylogeny of proctotrupomorpha,  the recovery of some noncontroversial relationships and  the diagnosis of persistent problems and possible solutions. phylogenetic relations within hymenoptera are far too numerous and complex to be exhaustively discussed. the complete trees in additional files  <dig> and  <dig> can be consulted for lower systematic level relationships.

in the following subsections, we repeatedly refer to single species as "misplaced". this means that their position as inferred in our trees clearly contradicts previous results from taxonomic as well as morphological and molecular phylogenetic studies. accordingly, the phylogenetic positions of these taxa were considered artefacts and were excluded from discussion of topologies.

major lineages within apocrita
within apocrita, our analysis suggests a topology of stephanoidea + ))  . stephanoidea was inferred to be sister group to all other apocrita in the morphological analyses of vilhelmsen et al.  <cit> . our analysis gives additional support for this relationship. the ichneumonoidea are monophyletic in our trees.  ichneumonoidea has been suggested as sister group to aculeata by rasnitsyn  <cit> , a relationship that found only moderate support from vilhelmsen et al.  <cit>  and was not retrieved by most recent analyses . our trees corroborate the results of most analyses cited above and suggest a rejection of the clade aculeata + ichneumonoidea. instead, we found evanioidea to be sister group to aculeata in our trees. a sister group relationship of evanioidea and aculeata has been suggested only by the combined morphological and molecular analysis by sharkey et al.  <cit> , and there are currently no convincing morphological synapomorphies that would support this clade. however, despite low branch support, we consider it quite possible that the evanioidea are the long-sought sister group to the aculeata and suggest further investigation of this particular clade. rasnitsyn  <cit>  introduced the supertaxon evaniomorpha, which includes evanioidea, ceraphronoidea, megalyroidea, trigonaloidea and stephanoidea. we argue against the monophyly of evaniomorpha, as our data support stephanoidea as sister taxon of the remaining apocrita . we cannot provide substantial information on the position of the superfamilies ceraphronoidea, megalyroidea and trigonaloidea, because their representatives are either included solely in the extended, possibly less reliable tree  <dig>  or obviously misplaced .

proctotrupomorpha
in our analyses, proctotrupomorpha s.l.  was retrieved when again ignoring a few misplaced taxa. in tree  <dig>  proctotrupomorpha comprises chalcidoidea, platygastroidea and cynipoidea ). in tree  <dig>  more representatives of proctotrupomorpha s.l. are present, and the inferred topology suggests the following relationships: cynipoidea + )). this contradicts the often proposed sister group relationship between mymarommatoidea and chalcidoidea . a sister group relationship between diaprioidea and chalcidoidea was retrieved in the molecular analyses of castro and dowton  <cit> , but their taxon sampling lacked mymarommatoidea, and was retrieved by heraty et al.  <cit> . our study is one of the first to include mymarommatoidea in a molecular phylogenetic analysis, but the position of mymarommatoidea in our analysis is not well supported and the group is represented only in the less reliable tree  <dig>  a position of chalcidoidea outside proctotrupomorpha was recently proposed by sharanowski et al.  <cit>  based on the analysis of  <dig> putative orthologous genes  from a small number of taxa. we regard this position as unlikely based on our own results and those of previous molecular studies that provided respective parts of our data set  <cit> . the most recent morphological or combined morphological and molecular analyses also contradict an origin of chalcidoidea outside proctotrupomorpha  <cit> .

recovery of noncontroversial relationships
we evaluated the reliability of the inferred phylogenetic trees by the recovery of phylogenetic relationships that are largely considered noncontroversial. we found positive indications in tree  <dig>  specifically, our results are consistent with the generally accepted paraphyly of "symphyta"  and with the generally accepted monophyly of apocrita and aculeata  . also, we retrieved the noncontroversially monophyletic superfamilies apoidea, chalcidoidea, cynipoidea, evanioidea, ichneumonoidea and siricoidea. however, some crucial taxa were not represented in tree 1: xyelidae and orussidae. if we add them to the data set to infer tree  <dig>  they are misplaced. the xyelidae are found as a sister group to pamphilioidea . this position is not very likely, as the sister group relationship of xyelidae and the remaining hymenoptera is well supported  <cit> . the orussidae, which have a key position within hymenoptera evolution as sister group of apocrita, are placed at the base of apocrita along with some proctotrupoidea taxa . however, the clade orussidae + apocrita is well established and supported by morphological and molecular data . this demonstrates the necessity of sequence overlap definitions and shows that the positions of reincluded taxa  have to be discussed with caution. the backbone of the tree, with its major splits, however, remains largely unaffected by adding taxa that do not fulfill our overlap criteria.

diagnosis of persistent problems and possible solutions
with the aid of our trees, we identified several persistent problems in the hymenoptera tree. while the available sequence data already cover all major lineages of hymenoptera, they are unequally distributed and there is poor overlap among taxa. this contradiction between taxonomic breadth and genomic depth in the data of hymenoptera is in accordance with the conclusions of sanderson  <cit>  in his evaluation of the phylogenetic signal in eukaryota. the large amount of missing data and the low taxonomic overlap between mitochondrial and nuclear data in our sets call for a solution. to get more independent markers and to close the taxonomic gap between mitochondrial and nuclear data, we suggest est studies  for taxa with completely sequenced mitochondrial genomes and sequencing of mitochondrial genomes of those taxa for which we already have a large number of nuclear sequence data available.

an obvious problem for solving higher-level relationships within hymenoptera is the underrepresentation of the small superfamilies megalyroidea, trigonaloidea, ceraphronoidea and mymarommatoidea. another highly problematic issue is those families of proctotrupoidea that we currently cannot map on the phylogenetic tree. any additional data regarding these taxa in terms of species and genes will be of great value.

as extensive est studies are still expensive, we also recommend target-specific amplification of nuclear coding genes. with the prospect of new primer design tools , amplification and sequencing of a data set of, for example,  <dig> taxa  and  <dig> nuclear coding genes can be accomplished in a reasonable amount of time and at reasonable cost. taxon sampling should again be based on taxa with completely sequenced mitochondrial genomes.

CONCLUSIONS
exemplarily for hymenoptera, we have demonstrated that the tree reconstructed from our pipeline output can make a substantial contribution to the phylogeny of the taxon and that comprehensive results can complement the discrete inferences from the single studies that have produced the data that were reanalyzed. inspired by mcmahon and sanderson  <cit>  and sanderson et al.  <cit> , we found an adequate approach to analyze all currently available molecular data in a single phylogenetic study in a standardized and efficient way. the impossible child of the scientific community, a sequence data monster, can be tamed. every systematic biologist, even without advanced programming and bioinformatics skills, is given the capability to produce a tree of his taxon of interest. our approach offers the possibility of relatively simple and reliable monitoring of new data and tree robustness, that is, the possibility to keep track of the phylogenetic signal in a taxonomic group. this also enables researchers to monitor how phylogenetic trees change over time with an increase of data size and density. this might promote a better understanding of more theoretical issues related to the analyses of molecular data, such as the information content of genes or the suitability and selection of genes to answer phylogenetic questions. our approach therefore has great potential to meet the challenges of the phylogenomic era, to improve our ideas on phylogenetic affinities and to contribute to a better understanding of the evolution of organisms.

authors' contributions
bmi and rsp conceived of the study. bme, bmi and rsp designed the study. rsp coordinated the study. bme, jb, km and rsp carried out the analyses. bme wrote the major part of the bioinformatics tools, and jb and bmi wrote minor parts of the bioinformatics tools. bme, jb and rsp wrote the manuals with comments and revisions from km. bme, bmi, on and rsp wrote the manuscript. jb, km, ks and lk provided comments on and made revisions to the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
software tools and manuals. all newly developed software tools and corresponding manuals.

click here for file

 additional file 2
gi numbers of sequences from genbank used in our pipeline. list of the genbank gi numbers of all hymenoptera sequences that were initially inputted in our pipeline run.

click here for file

 additional file 3
on maximum cliques. a short introduction to maximum cliques and how we used them in our analysis.

click here for file

 additional file 4
character partitions of subset  <dig> and  <dig>  the character partitions of the two subsets that were used in the phylogenetic analyses .

click here for file

 additional file 5
tree  <dig>  complete. phylogenetic tree of hymenoptera inferred from genbank sequences . numbers on branches indicate bootstrap support values . the applied color code corresponds to that of figures  <dig> and  <dig>  single species whose position in the inferred phylogenetic tree we consider erroneous are shown in gray.

click here for file

 additional file 6
tree  <dig>  complete. phylogenetic tree of hymenoptera inferred from genbank sequences . in this tree, species that were excluded by our pipeline in the course of generating subset  <dig> are reincluded. these taxa are marked with asterisks. the meaning of numbers and the applied color code correspond to those in additional file  <dig> 

click here for file

 additional file 7
species included in subset  <dig>  all species included in subset  <dig>  sorted by family.

click here for file

 additional file 8
groups of orthologs included in subset  <dig>  all groups of orthologs included in subset  <dig>  plus coverage of each group.

click here for file

 additional file 9
species included in subset  <dig>  all species included in subset  <dig>  sorted by family.

click here for file

 additional file 10
groups of orthologs included in subset  <dig>  all groups of orthologs included in subset  <dig>  plus coverage of each group.

click here for file

 acknowledgements
we thank alexandros stamatakis  for help with the phylogenetic analyses, ingo ebersberger  for help with hamstr, nikola szucsich  for valuable discussions and three anonymous referees for their helpful reviews. we acknowledge viktor achter, volker winkelmann and sebastian breuers for help with likelihood analyses on the cologne high efficiency operating platform for sciences .
