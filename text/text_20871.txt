BACKGROUND
given a set of possible event types, an event sequence is a sequence of pairs , where r is an event type and t is the occurrence location, or time, of the event. our focus is on measuring whether the co-localization of occurrences of events of two types is significant in a given sequence.

as an example, consider transcription factor binding sites  in a dna sequence, see  <cit> . tfbss occurring close to each other may belong to the same regulatory module. such modules usually span an interval of  <dig> –  <dig> base pairs  <cit> . these closely located tfbss could interact in forming larger protein complexes that regulate gene expression. thus it is of interest to discover which transcription factors  tend to co-occur, and potentially interact, in genomic sequences. regulatory modules can sometimes be observed from dna sequences by studying the co-localization of potential tfbs in short sequence windows. this can be done either on a genome-wide scale or in the context of regulatory regions, see for example  <cit> . tfbs co-occurrences have also been used in predicting regulatory regions, see  <cit> . given a pair of event types , there are several possible ways of quantifying their degree of co-occurrence. one can, for example, compute the mean distance from each occurrence of an event of type r to the next event of type r', or look at the distribution of such distances. in this paper we measure the co-occurrence of event types r and r' either by  dividing the sequence into non-overlapping windows of a fixed length w and counting the number of windows that contain at least one event of type r and at least one event of type r', or by  counting the number of events of type r that are followed by at least one event of type r' within distance w, or by  counting the number of events of type r that are followed or preceded by at least one event of type r' within distance w. these co-occurrence scores are used because of their simplicity and intuitiveness; other co-occurrence scores could be used as well. the point we make here is that the numerical value of such a score in itself is not very informative.

in order to determine the significance of a co-occurrence score, we need a null model to estimate the distribution of the score values and then decide the significance of an individual value. we define three such null models. these models apply to any co-occurrence score, not just the ones used here. null co-occurrence score distributions for tfbss have been estimated by levy, hannenhalli & workman  <cit> , hannenhalli & levy  <cit> , and klein & vingron  <cit>  by performing randomization experiments. we introduce an additional null model and compare it to those that have been suggested before. our experimental results on synthetic event sequences demonstrate that our novel null model provides more accurate results than previously suggested models in certain scenarios.

good null models take into account the global event sequence structure, including the tendency of events to occur in bursts . for example, in gene-rich dna regions potential binding sites may occur very densely, while in gene-poor areas the event density can be considerably smaller. an example of a bursty dna event sequence is shown in figure  <dig>  the figure shows potential binding sites in a  <dig> kbp region in chromosome  <dig>  featuring a burst of length  <dig> bp where potential tf binding sites occur more densely than elsewhere in the sequence. the dna sequence and the method for obtaining the binding sites are described in more detail in results and discussion. we show that a simple model that is equivalent to the standard χ <dig> significance test is poorly suited for such bursty data, yielding many false positives. more sophisticated models, on the other hand, make it possible to find exactly the planted co-occurrences in synthetic data as significant, and not many more.

the main contribution of this work is in the formal definition of null models for event sequences and demonstrating the need for different null models. we discuss and compare the performance of the null models on synthetic event sequences and on data consisting of potential tfbs occurrences in a human dna sequence. we study the effects of the distance w and the p-value threshold on the number of tf pairs that are found significant.

methods
sequences of events
consider a data sequence  containing n possible locations { <dig> ..., n} where events can occur. assume that there is a set r of event types, and that m events occur in the sequence. an event sequence s = {s <dig> ..., sm} consists of pairs si = , where ri ∈ r and ti ∈ { <dig> ..., n}. we use t = {t <dig> ..., tm} to denote the set of locations where events occur in s. for example, the data sequence can be a dna sequence of length n in which m potential transcription factor binding sites occur. the types would then correspond to specific transcription factors, and the locations to positions at which the binding sites appear in the sequence.

co-occurrence scores
given the sequence s = {, ,...,}, let c be the number of times event type r occurs in the sequence s, and denote f = c/m. divide the underlying n possible locations into non-overlapping windows of width w. the window count w for event types r and r' is the number of windows in which at least one event of type r and at least one event of type r' occur. thus the values of w are in . the co-occurrence count c is the number of events of type r that are followed or preceded by at least one event of type r' within distance w. the values of c are in . the directed co-occurrence count d is the number of events of type r that are followed by at least one event of type r' within distance w. the values of d are also in . see  <cit>  for similar scores. when the pair of event types  and the sequence s are implied by the context, we use the notation w, c, and d. see figure  <dig> for an illustration of the windows and corresponding co-occurrence scores.

note that the total number of event type pairs is o, and recall that m is the number of events in the sequence. the w score is the computationally most efficient to calculate; it takes time o to obtain the 0/ <dig> occurrence count of each event type in each window, and to multiply these counts for each event type pair in each window. computing the c score takes at most time o, where k is the maximum number of events within distance w from any event. this is because for each event we need to check the 0/ <dig> occurrence of each type in its neighborhood; the worst case time complexity is therefore o. the d score has the same worst case time complexity as the c score. however, now k denotes the maximum number of events following any event within distance w, which is expected to be less than the k for the c score.

null models
here we describe the null models that we use when computing the significance of the w, c, and d scores obtained on the input sequence. there are three models: the uniform locations  model, the fixed locations  model and the fixed locations fixed event type ) model. below we explain how to generate randomized versions of a given event sequence s according to these models:

uniform locations ul
generate a sequence rul by creating c events , i ∈  <dig> ..., c, where each ti is selected uniformly at random from { <dig> ..., n}. note that several events might have the same location. the randomized version of s, rul, is a union of the rul. a similar model is applied in, e.g.,  <cit> .

fixed locations fl
the randomized sequence rfl is the sequence {,...,}, where the event types qi are selected independently at random with probabilities f. that is, the event locations are kept fixed, and the event types are assigned at random according to their frequencies in the original sequence. a similar model is applied in, e.g.,  <cit> .

fixed locations fixed event type fl
given a sequence s and an event type r, the randomized sequence rfl is defined as rfl, with the exception that the occurrences of events of type r are kept unchanged. that is, type r is assigned for those locations ti for which ri = r, and the types for all other event locations are assigned from r\r according to their frequencies f. we are unaware of any previous studies on this type of a null model.

an example of the randomized sequences rul, rfl and rfl is given in figure  <dig> 

empirical p-values
for a given sequence s and a null model m ∈ {ul, fl, fl} we compute the empirical p-value of the w  score for event types r and r' as

 pw  = prob. 

in other words, we compute the fraction of randomizations in which the w  score for the randomized sequence rm exceeds the w  score for the original sequence s. when simultaneously testing multiple hypotheses, methods for controlling the false discovery rate can be applied  <cit> .

RESULTS
here we describe our experiments on synthetic and real event sequences. we also discuss the implications of our results on potential transcription factor binding site occurrences.

synthetic data
our experimental study aims to evaluate the different null models with respect to two diagnostics:  whether they find the planted co-occurrence patterns and  whether they are able to discard non-existing co-occurrence patterns . to study the null models w.r.t. these two diagnostics, we generated uncorrelated, correlated, and directed sequences as described below. we varied the burstiness in the generated sequences, and in some of them we planted a pattern of frequent co-occurrence between two event types.

the generative model for our data is as follows. we randomly divide the sequence into some number of sparse and dense segments. in each position in the sparse segments, an event of any type occurs with probability p <dig>  for the dense segments, the corresponding probability is p <dig> > p1; more events are expected to occur in the dense segments. the lengths of the dense segments are chosen uniformly at random from  <cit> , and  <dig> such segments are randomly positioned in the sequence .

we generated five types of sequences using this model. the sequences of the first type, uncorrelated, do not contain any correlations between event types; after deciding the positions for the events, we choose the type of each event uniformly at random. the sequences of the second type, correlated, contain an undirected frequent pattern of co-occurrence between two types of events, a and b, denoted . that is, the type of each event is again chosen uniformly at random, except that every time an event of type a occurs, it is with high probability followed by an event of type b, and the same holds for b followed by a. the third type of data, directed, contains a directed frequent co-occurrence pattern denoted a → b. in this case the pattern a followed by b is planted in the sequence .

for the distinct correlated and distinct directed sequences we generated sparse and dense segments as before, but in some number of the dense segments  a co-occurrence pattern between a and b was planted. in the distinct directed sequences this means that in some number of the dense segments whenever a occurs, it is with high probability followed by b. in the corresponding dense segments in the distinct correlated sequences, b is also followed by a with high probability. thus the co-occurrence patterns were only planted in some distinct dense segments. in the remaining dense segments and in the sparse segments all types occur with equal probability.

in table  <dig> we show the results for the experimental diagnostics  and . for the experiments we used a fixed set of parameter values:  <dig> event types, sequence length  <dig>  p <dig> =  <dig>  and p <dig> =  <dig> . we report the number of pairs of types whose co-occurrence score is significant  when w =  <dig>  the p-values for all null models were obtained by performing the corresponding randomizations and computing empirical p-values based on the results. in the case of the diagnostic  the co-occurrence of a and b is significant in sequence s according to score l = {w, c, d} if either l or l is found significant. that is, e.g., the co-occurrence score for a and b is significant either in randomizations where the locations of events of type a are fixed, or in randomizations when the locations of events of type b are fixed.

 median number of pairs of event types, over  <dig> randomly generated sequences, whose co-occurrence score is significant. results are shown for five types of synthetic datasets.  the number of randomizations in which the planted pair  is found significant. ul, fl, and fl correspond to the null models, and w, c, and d to the window, undirected, and directed co-occurrence scores. for the d score, the two values s1: s <dig> denote the number of randomizations in which  and  are found significant. the empirical p-values are based on  <dig> randomizations. results are shown for p-value threshold  <dig> , with  <dig> event types, w =  <dig>  burst lengths in  <cit> , sequence length  <dig>  and parameter values p <dig> =  <dig> , p <dig> =  <dig> , with  <dig> bursts per sequence. for the datasets  <dig> and  <dig>  the number of bursts containing correlations was randomly chosen from  <cit> .

from table  <dig> we can see that the fl and fl null models yield very good results on the first three datasets: in nearly all randomizations the planted co-occurrence and not many more co-occurrences are found significant. fl finds the planted co-occurrence slightly more often than fl for dataset directed with the c score, and it finds slightly fewer false positives with the d score.

note that as there are  <dig> event types, there are / <dig> +  <dig> =  <dig> pairs of types ), and one of them is truly significant. thus with p-value threshold  <dig>  we expect to see about  <dig>  false positives. using the ul null model we find the true co-occurrence pattern. however, this model also finds a very large number of false positives, close to the total number of pairs.

for the last two datasets in table  <dig>  the fl model yields the best results: it finds the planted co-occurrence pattern more successfully than fl, while yielding a smaller number of false positives when compared to ul or fl. we conclude that the fl null model yields results close to fl on uncorrelated, correlated and directed sequences, and it is the best model to use when the co-occurrence pattern between a pair of event types occurs in a distinct subset of the bursty regions in the sequence.

the probabilities p <dig> and p <dig>  as well as the lengths of the bursts have an effect on the burstiness of the data. in addition to these parameters, the length w, the number of event types, and the p-value threshold also affect the results for each null model. in more extensive tests, we varied the lengths of the bursts; we generated  <dig> sequences whose burst lengths were bl <dig>  randomly chosen from  <cit> , and  <dig> sequences with burst lengths bl <dig>  randomly chosen from  <cit> . we computed the empirical p-values using w = { <dig>   <dig>   <dig>  500} with  <dig> randomizations for these  <dig> sequences. the number of event types was again  <dig> while the sequence length was  <dig> kbp. we made the following observations about the datasets of types uncorrelated, correlated, and directed for p-value thresholds  <dig>  and  <dig>  : the ul model gives the largest number of false positives in each parameter setting, and the fl and fl models find the planted frequent co-occurrence pattern for at least 90% of the generated sequences for almost all parameter settings. in the cases where the fl and fl found the planted pattern for less than 90% of the sequences , the ul model found it significant an even fewer number of times. we thus conclude that the fl and fl models are successful in finding frequent co-occurrence patterns for a variety of burst lengths and values of w.

tfbs motif occurrences
potential binding sites of transcription factors are an example of biological event sequences where co-occurrence patterns and burstiness occur. we applied our techniques on  <dig> mbp regions from human chromosomes 1– <dig>  <cit>  , where we identified potential binding sites as matches to known transcription factor binding motifs. the regions  <dig> –  <dig> mbp were used for chromosomes 1– <dig>  and  <dig> –  <dig> mbp for chromosome  <dig>  to avoid the centromere region. this dataset contains genome regions with different characteristics , while being compact enough to be efficiently studied with several null models and window sizes. the motifs we consider are from the jaspar collection  <cit>  , all  <dig> motifs in the  <dig> build. in these sequences we identified all matches for each jaspar transcription factor  matrix by the possumsearch program  <cit> . the threshold for a match was set with p ≤ 10- <dig>  yielding approximately  <dig> matches for each  <dig> mbp sequence. with this p-value threshold, some jaspar motifs are not specific enough to yield any matches, resulting in  <dig> possible motifs, or, event types in the event sequence.

thus the event sequence consists of pairs of the format , where position marks the start of the match, and type the index of the tf. the starting position of a match is defined as its smallest distance from the start of the sequence, i.e., a match spanning sequence positions  <dig> to  <dig> has starting position  <dig>  the match for a given tf on either strand is counted as an event of the same type; thus strand-specificity is not considered. the number of matches per tf per sequence in the sequences ranges from  <dig>  to  <dig> . we noticed that the number of matches in each  <dig> kbp region tends to be larger in g+c and gene rich regions, the number of matches per  <dig> kbp ranging from  <dig> to  <dig> . therefore the assumption of regions with varying event density holds for this data. in the following we study the sequence for distances w ranging from  <dig> bp to  <dig> bp.

since some of the jaspar motifs are structurally similar, overlapping matches for two factors can occur in the event sequence. to prune out this source of false co-occurrence patterns, we processed the event sequence for each factor separately. when studying the significance of a factor pair , we disregarded all events closer than distance d to the location of a given occurrence of type a. experimentally we found that d = { <dig>   <dig>  50} produced almost identical results, while d =  <dig> gave many false co-occurrence patterns due to overlapping matches. the longest motif in our collection was of length  <dig>  which we chose to use as the value of d in the experiments. we also pruned out exactly overlapping matches for the same tf . the w score was not used in these experiments, as the implementation that disregards closely occurring matches would not be any more efficient than those for the c and d scores.

the number of pairs in each sequence with significant co-occurrence scores are shown in table  <dig> the table shows results for the distance w =  <dig> bp and p-value thresholds p ∈ { <dig> ,  <dig> }. all empirical p-values are over  <dig> randomizations. the co-occurrence of a pair  is significant in sequence s if either c or c is found significant. the numbers for different chromosomes are quite similar, indicating that the chosen regions are similar in their sequence composition and tendency to contain matches to pairs of jaspar motifs. the results show that the ul model yields more significant pairs than the other models, in one case over four times as many . lowering the p-value threshold reduces the number of pairs somewhat, as is expected, but the choice of a p-value between  <dig>  and  <dig>  does not radically alter the magnitude of the tf pairs that are found significant. the effect of the window size w is shown, as an example, for chromosome  <dig> in table  <dig>  increasing the window size from  <dig> bp to  <dig> bp only slightly increases the number of significant pairs, and the number is even reduced in some cases  model, p ≤  <dig> ). this indicates that many choices of w yield a consistent number of pairs whose co-occurrence is significant on that distance scale.

number of significant pairs for  <dig> mbp regions in human chromosomes 1– <dig>  results are shown for window sizes w =  <dig> and two p-value thresholds, for null models ul, fl, and fl, for co-occurrence scores c and d. minimum distance parameter d =  <dig> bp. number of event types is  <dig>  and thus the total number of undirected pairs is / <dig> +  <dig> =  <dig> and number of directed pairs is  <dig> =  <dig> 

number of significant pairs for  <dig> mbp regions in human chromosome  <dig>  results are shown for window sizes w ∈ { <dig>   <dig>  500} and two p-value thresholds, for null models ul, fl, and fl, for co-occurrence scores c and d. minimum distance parameter was d =  <dig> bp. number of event types is  <dig>  and thus the total number of undirected pairs is  <dig> and number of directed pairs is  <dig> 

the number of significant pairs  in chromosome data according to c score and null models fl and fl. parameters used are w =  <dig> bp, minimum distance d =  <dig> bp. the number of fl- and fl-specific pairs is shown, and the number of pairs that both models find significant.

an example of the pairs that are found significant is shown in table  <dig>  the significant tf pairs with the  <dig> highest c scores among all the studied chromosome sequences are listed in the table for w =  <dig>  according to the fl randomization. the full names of the tfs are given in additional file  <dig>  as table  <dig> shows, the c score for a pair is not directly related to the number of times each tf occurs in the sequence, e.g., pair  has a higher score than  whose tfbss occur more frequently. in total there are  <dig> unique significant pairs  with these parameters among all the chromosome sequences. typically the pairs are also found significant by the fl model. some pairs are found significant in only one chromosome sequence, e.g.,  in chromosome  <dig>  and some pairs in all sequences, e.g., . this would indicate that there are tf pairs whose potential binding sites have a significant tendency for co-occurrence across the genome, while some pairs may only show that tendency in specific genome regions.

the significant pairs  in chromosome data with the highest c scores. the parameters used are w =  <dig> bp, minimum distance d =  <dig> bp, and significance is determined according to the fl null model for the c score. there are in total  <dig> unique significant pairs in chromosomes 1– <dig> with these parameters. the chromosome where the c score is highest, and the total number of times that each tf occurs in the corresponding chromosome are given, as well as the c score. the following two columns state the number of chromosomes  in which the pair is significant, and if the pair is significant according to the fl null model. the last column gives a reference when one exists. additional file  <dig> contains the full names of the factors.

as an example, the co-localization of the pair with the highest c score, , is visualized in figure  <dig>  for a subsequence from chromosome  <dig>  we compared the locations of the matches in this sequence region to ensembl gene annotations , but did not observe tendencies for the pairs to occur in, e.g., upstream regions. indeed, a recent study by blanchette et al.  <cit>  found that their predicted regulatory modules also show enrichment near the 3' end of genes and in regions far from genes. further studies would be required to make conclusions about the genomic regions where the significant pairs are located.

we used the chilibot  <cit>  website to search for pubmed abstracts where the pairs of tfs in table  <dig> occur. the search results are given as references in the last column of the table. we also searched the transcompel  <cit>  database for interactions between the pairs for which no pubmed results were found, but found no further evidence of interaction. this can in part be due to different naming conventions in the jaspar and transfac databases. the chilibot search tool, on the other hand, is incorporated with a database of synonymous terms. the references shown in table  <dig> show interactions or connections that have been observed between the respective transcription factors. for  <dig> out of the  <dig> pairs with highest c scores, such references were found. the remaining pairs may also interact in a variety of ways, but we found no reported connections between them by searching related literature.

the potential binding sites for certain pairs of tfs, e.g., those pairs listed in table  <dig>  show a statistically significant tendency to occur in the same short regions in the studied chromosome segment that covers many genes and intergenic regions. this could be due to similarities in the dna sequence composition near their preferred binding sequences. however, we have eliminated the possibilities that the preference would be due to overlapping motif matches , or the tendency for many matches to occur globally in the same regions, i.e., the burstiness effect  null models).

CONCLUSIONS
in this paper we formally defined a number of null models, against which the significance of co-occurrence between a pair of event types can be determined in a sequence of events. the models formalize and extend the work of levy et al.  <cit>  and hannenhalli & levy  <cit> . furthermore, we showed how to empirically estimate the p-values of co-occurrence significance with respect to these null models and natural measures of undirected and directed co-occurrence. the null models and co-occurrence scores were shown relevant and practical on real data consisting of potential transcription factor binding sites.

we observed that for bursty data, such as tfbs occurrences, those null models that do not take the burstiness into account falsely determined co-occurrences between many pairs as significant. on the other hand, models that take the event locations into account performed well on both simulated and real data, finding significant tendencies for co-occurrence between some tfbss. our method for discovering significant co-occurrences between directed pairs of event types also performed well in practice.

an interesting and important direction for applying these type of significance tests would be the promoter regions of co-regulated genes. the null models and corresponding p-value computations can also be applied in other areas where co-occurrences of certain location- or time-dependent features is of interest.

authors' contributions
all authors participated in the design of the study and provided significant contributions to the content. all authors were involved in writing and revising the manuscript.

supplementary material
additional file 1
significant pairs. significant pairs according to the fl and fl null models and c score in  <dig> mbp regions from chromosome 1– <dig>  with window length w =  <dig>  minimum distance d =  <dig>  and empirical p-value p ≤  <dig> . each row contains the following  <dig> columns: chromosome, tf  <dig> , tf  <dig>  c score,  <dig> if the pair  is significant according to fl, or  <dig> if it is significant according to fl. the matrix names are available from the jaspar database download page: 

click here for file

 additional file 2
full names of tfs in table  <dig>  the full names of transcription factors appearing in table  <dig> 

click here for file

 acknowledgements
we thank the anonymous reviewers for their excellent comments that helped to improve the original manuscript. this work was supported in part by academy of finland grant  <dig> .
