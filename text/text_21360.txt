BACKGROUND
in prokaryotes, several adjacent genes on the same strand of dna are often co-transcribed as a polycistronic mrna, forming a multi-gene transcription unit called an operon. furthermore, in addition to protein- and rna-coding genes, some parts of a non-coding sequence and the opposite strand of a coding sequence can also be transcribed under certain conditions, generating non-coding rnas   <cit>  and anti-sense rnas   <cit> , respectively. accumulating body of evidence suggest that ncrnas  <cit>  and asrnas  <cit>  may play important roles in the physiology of prokaryotes. therefore, a full understanding of the transcriptomes of prokaryotic cells is necessary to annotate the functional elements in their genomes and to reconstruct the gene transcriptional networks in their cells. however, experimental determination of operon structures, ncrnas and asrnas by traditional molecular biology methods is time-consuming and labour-intensive. as a result, no single prokaryote has so far had all of its operon structures, ncrna and asrnas characterized using such methods. for instance, even for the most well-studied model bacteria e. coli k <dig> and b. subtilis, only  <dig>   <cit>  and  <dig>  <cit>  operons have been determined in their genomes using these methods, respectively, after decades of research while not each of their genes has been assigned to an operon. on the other hand, although a great progress has been made in computational prediction of operons  <cit>  and small rna genes  <cit> , the accuracy of these predictors is still low  <cit> , and they can only predict the static longest possible operons without considering possible alternative operons  <cit> .

in the past few years, increasing applications in prokaryotes of whole genome directional  tiling array and directional rna-seq techniques have completely changed our way to study and our view of the architecture and complexity of prokaryotic transcriptomes . for example, using a combination of whole genome directional tiling array and rna-seq techniques, guell et al. <cit>  found that operon utilizations in the reduced parasitic m. pneumoniae genome were highly variable and dynamic, almost half of the  <dig> identified multi-gene operons showed varying levels of  expression in a staircase-like manner. under different conditions, large operons could be transcribed as smaller sub-operons, resulting in many alternative transcripts, suggesting that the operon structures in m. pneumonia were highly complex and dynamic, a phenomenon that was comparable to the alternative splicing in eukaryotes  <cit> . they also identified a large number of ncrnas and asrnas expressed under various culture conditions, hence a much larger portion of the genome was transcribed than originally anticipated  <cit> . similar results were observed in many other taxonomically distinct species, such as epsilon proteobacteria h. pylori <cit> ; firmicutes b. sutiblis <cit>  and b. anthracis <cit> ; cyanobacteria synechocystis sp. pcc <dig>  <cit> ; euryarchaeota halobacterium salinarum nrc- <dig>  <cit> ; and bacteroidia porphyromonas gingivalis <cit> , to only name a few. however, not all these surprising observations were noted in some other studies. for instance, prevalent alternative operon utilizations were not reported in many studies in a variety of prokaryotes, such as b. subtilis <cit> , salmonella entericaserovar typhi  <cit> , burkholderia cenocepacia <cit> , caulobacter crescentus <cit> , staphylococcus aureus <cit> , vibrio cholera <cit> , chlamydia trachomatis <cit> , chlamydia pneumonia <cit> , clostridium beijerinckii ncimb  <dig>  <cit> , listeria monocytogenes <cit> , anabaena sp. strain pcc  <dig>  <cit> , synechococcuselongatus pcc  <dig>  <cit> , and sulfolobus solfataricus p <dig>  <cit> . contradictory results have also been reported. for instance, although rasmussen et al. <cit>  did not note alternative operon utilizations in b. subtilis, more recently, nicolas et al. <cit>  observed highly prevalent condition-dependent operon utilizations using a similar tiling array technique. moreover, although most of these studies found extensive asrna and ncrna transcriptions, the levels of their prevalence could vary quite differently from different studies even in the same strains. for instance, although selinger et al. <cit>  reported that up to  <dig>  e. coli k <dig> genes had asrna transcriptions using directional tilling arrays, dornenburg et al. <cit>  only identified about  <dig>  asrnas in the same strain under similar growth conditions using directional rna-seq. these discrepancies can be due to different experimental conditions and methods used in these studies. nevertheless, they inevitably raise the question: are the prevalent alternative operon utilizations, asrna and ncrna transcriptions ubiquitous phenomena in all prokaryotes or only prevalent in some specific species?

e. coli k <dig> is probably the best known free living model organism  <cit> , where novel biological hypotheses and computational algorithms can be tested. indeed, it is mainly through the studies in e. coli k <dig> that we have understood many fundamental biological processes, including the mechanisms of gene transcriptional regulation  <cit> . as a result, the e. coli k <dig> genome is in fact the best understood among all the model organisms in almost all aspects  <cit> . since the finishing of its genome sequence in  <dig>  <cit> , almost all newly developed high throughput technologies have been applied to this bacterium. as a result,  <dig>  genes have been experimentally or computationally identified in the ms <dig> strain, and  <dig>   of them have been assigned a biochemical function  <cit> . of these  <dig>  genes with an assigned function,  <dig>   had their functions characterized experimentally   <cit> . the products of the  <dig> genes with experimentally characterized function catalyze  <dig>  metabolic reactions, which constitute the best understood metabolic network  <cit> . as for its transcriptomes and transcriptional regulatory networks, regulondb database  <cit>  that is dedicated to compiling all experimentally verified relevant information in e. coli k <dig> has documented  <dig>  operons ,  <dig>  promoters,  <dig>  transcription factor binding sites of  <dig> transcription factors  in the regulatory region of  <dig> operons, and  <dig>  tf-target gene regulations  <cit> . furthermore, more than a hundred of ncrnas and asrnas have been experimentally identified in the e. coli <cit> . more recently, cho et al. <cit>  applied a combination of tiling array, 5’-end rna deep sequencing, rnap chip-chip and proteomics analyses to reveal the transcription unit architecture in the e. coli k <dig> genome. they identified  <dig>  transcription units, many alternative transcription start sites , alternative operons and ncrnas under a few cultural conditions. in another study, mendoza-vargas et al. <cit>  identified ~ <dig>  new tsss using a modified 5’-race method and a 5’-end rna sequencing method in the genome. consequently, after more than 40 years intensive molecular genetics research in this bacterium, including the recent high throughput studies  <cit> , our experimentally validated knowledge of the transcriptome and gene regulatory systems in e. coli k <dig> is the most complete currently available for any organism  <cit> . however, ironically, our understanding about the complexity of the transcriptomes in this model bacterium is rather limited compared to its counterpart model gram-positive bacterium b. subtilis <cit> . in particular, large scale dynamic and alternative operon utilizations under various conditions have not been reported in e. coli k <dig>  so do they exist in this bacterium? furthermore, how many asrnas and ncrnas are transcribed in e. coli k <dig> given the aforementioned inconsistent results  <cit> ?

technically, compared to directional tiling array techniques, directional rna-seq methods are more suitable and powerful tools for understanding the complexity of the prokaryotic transcriptomes due to their single-nucleotide resolution, higher dynamic range, and lower noise levels, thus they have gained increasing popularity  <cit> . one important step in rna-seq data analysis is to accurately assemble all meaningful transcripts in their full-length, so that correct conclusions can be drawn from tens of thousands of rna-seq short reads generated by next generation sequencing  technologies. however, it has been recently released  <cit>  and we will indicate later in this paper, that the coverage of reads generated by the current rna-seq techniques on transcribed regions is highly non-uniform. more seriously, there are even numerous uncovered parts in transcribed regions, leading to gaps in otherwise a continuous mapping in the region  <cit> . these highly non-uniform coverage and uncovered gaps make the transcripts assembly and quantitative analyses highly challenging tasks  <cit> . several technical problems in the current rna-seq library construction protocols and sequencing technologies have been identified responsible for the non-uniform coverage and gaps. first, the chemical rna fragmentation methods used in many protocols may have a bias to break or degrade some sequences  <cit> . second, the random primer based reverse transcription may preferentially transcribe some sequences  <cit> . third, ligases may preferentially link the adaptors to some sequences  <cit> . fourth, pcr amplification is well-known for introducing gc content-dependent bias in libraries  <cit> . fifth, it was recently found that sequencing errors could be biased to some specific sequences, making such sequences missing from the reads  <cit> . moreover, prokaryotic rnas are more labile than their counterparts in eukaryotes, thus segments of some rnas can be more easily lost during the library preparation. although some of these problems can be avoided by new technical development, such as using fret-seq for amplification-free sequencing to avoid gc content-dependent pcr bias  <cit> , or using single rna molecular sequencing for longer reads to ease the assembly problem  <cit> , no effective routine technique has yet been developed to avoid all these problems.

on the other hand, although several transcriptome assemblers using rna-seq short reads have been developed in the past few years, they are mainly for reconstructing alternative isoforms in eukaryotes  <cit> . these assemblers can be classified into two basic categories  <cit> : the reference-based assemblers when a reference genome sequence is used, and the de novo assemblers when a reference genome is not used. the reference-based assemblers usually involve two steps: rna-seq reads are first mapped to the reference genome using an aligner, such as blat  <cit> , tophat  <cit>  or bowtie  <cit> , and then a graph representing all possible isoforms from overlapping reads is constructed, and the isoforms are resolved by traversing the graph. examples of this strategy include cufflinks  <cit>  and scripture  <cit> . the de novo assemblers such as trinity  <cit> , oases  <cit> , transabyss  <cit> , rnnotator  <cit> , and multiple-k  <cit> , generally assemble isoforms based on a de bruijn graph constructed using overlapping reads. the advantage of de novo strategy is that it can assemble transcripts when a reference genome is not available and can recover transcripts that are missing in the genome assembly. however, de novo transcriptome assembly is very sensitive to sequencing errors, in particular, missing and chimerical reads in the dataset, thus their accuracy is generally lower than the reference-based approaches  <cit> .

de novo transcriptome assembly in prokaryotes can also be more challenging in prokaryotes owing to the prevalence of uncovered gaps caused by the aforementioned technical reasons and the unique prosperities of their rnas. fortunately, with thousands of sequenced prokaryotic genomes available now, transcriptome assembly in prokaryotes can often be done using the reference-based approaches. however, the only reference-based transcriptome assembler for prokaryotes that we are aware of is a hidden markov model -based method for reconstructing operons in bacillus anthracis <cit> , yet no tool was delivered from this research. furthermore, there are at least two limitations in this method. first, the prevalently uncovered gaps were not explicitly treated in this method  <cit> , thus the interrupted partial transcripts could not be effectively bridged. second, although this method attempted to model transcripts of different transcription levels using different expression states, it did not allow transitions among the states  <cit> . thus, without an effective method to correct the high non-uniformity of the read coverage along a transcript  <cit> , this method can break a transcript into smaller fragments. because of the lack of a good prokaryotic assembler, currently prokaryotic transcripts were assembled by either simply stitching the two covered segments if the gap between them is shorter than a cutoff  <cit> , or determining 5’ and 3’ ends of transcripts via a probability-based approach  <cit> , or relying on an additional source of information for the assembly, such as tiling array data that tend to have a more even and consecutive coverage along transcribed regions albeit at lower resolution  <cit> . as rna-seq becomes a routine technique for probing transcriptomes in prokaryotes, an efficient and accurate full-length transcripts assembly algorithm and tool tailored to prokaryotes are urgently needed in the research community.

to gain a better understanding of the complexity of the transcriptomes in e. coli k <dig>  we have profiled the transcriptomes of the bacterium under different culture conditions and growth phases using a highly specific directional rna-seq technique that can capture various types of transcripts in the cells, including mrnas, asrnas, and ncrnas. to assemble all types of full length transcripts using the directional rna-seq short reads, we have developed a new hidden markov model based algorithm, truhmm , attempting to addresses the highly non-uniform read coverage and uncovered gap problems of current rna-seq techniques. truhmm differs from the earlier hmm-based algorithm  <cit>  in several ways . in particular, truhmm overcomes the aforementioned limitations of the earlier method by allowing a transcript to have highly non-uniform coverage at different positions, and explicitly addressing the uncovered gap problem using a sliding window-based centroid read counting strategy in a pre-processing step. furthermore, truhmm can also predict alternative operons and tsss of the assembled transcripts. when evaluated on sets of known operons, asrnas and ncrnas in e. coli k <dig>  truhmm was able to assemble various types of transcripts with rather high accuracy. the parameters trained in e. coli k <dig> can be applied to an earlier directional rna-seq dataset in h. pylori <cit>  with similarly high accuracy, and vice versa, thus truhmm is also very robust. based on the transcripts assembled in truhmm, we found that  <dig>  ~  <dig> % of expressed operons were utilized in their putative alternative forms,  <dig>  ~  <dig> % open reading frames had putative asrna transcriptions and  <dig>  ~  <dig> % intergenic regions had putative ncrna transcriptions under different culture conditions and growth phases. thus, it seems that there are more prevalent alternative operon utilizations as well as asrna and ncrna transcriptions in e. coli k <dig> than originally anticipated, and they may play important roles in the physiology of the bacterium.

RESULTS
our directional rna-seq libraries are highly strand-specific and can capture various types of rnas
we prepared the directional rna-seq libraries from seven e. coli k <dig> samples collected at the log phase growth in lb, and different time points under heat shock  or phosphorus starvation  treatments, denoted as lb, hs15 min, hs30 min, hs60 min, m-p0 h, m-p2 h, and m-p4 h to reflect the treatment and sampling time point. the experimental procedure of our work is listed in additional file 1: figure s <dig>  the libraries were sequenced on either the illumina gaii or the hiseq  <dig> platform. specifically, the sample lb was sequenced using the gaii platform, samples hs30 min, hs60 min, m-p0 h, and m-p2 h were sequenced using the hiseq  <dig> platform, whereas samples hs15 min and m-p4 h were sequenced using both the platforms. each sample sequenced using the hiseq  <dig> platform was repeated twice . the reads obtained from different platforms for the same sample are highly correlated , thus the data for the same sample were combined for the analysis. a total of  <dig> , <dig> reads were generated from the seven samples. the mapping statistics of the samples are summarized in additional file 1: table s <dig> showing that  <dig>  ~  <dig> % of reads could be uniquely mapped to the genome, resulting in  <dig> ,369 ~  <dig> , <dig> uniquely mapped reads in each sample, corresponding to a sequencing depth of 93 ~  <dig> times of the genome. of the  <dig>  ~  <dig> % multiple mapped reads in each sample, over  <dig> % were from duplicated trna/rrna genes . thus discarding these multiple mapped reads does not affect our analysis of mrna, asrna and ncrna transcriptions. furthermore, as shown in figure  <dig>  in all the samples over 90% and less than 10% of the total mapped nucleotides were mapped to the sense strand and intergenic regions, respectively, with only  <dig>  ~  <dig> % of the total mapped nucleotides mapped to the antisense strand. moreover, as shown in additional file 1: figure s <dig>  our uniquely mapped reads consisted of well-balanced different sizes of rna insertions, indicating that, in additional to mrna, our library preparation protocol could potentially capture small rna species such as asrnas and ncrnas, which were otherwise left out by a typical size selection step in other library preparation protocols. all these results indicate that our sequence reads are highly strand-specific and of high quality, which is consistent with an earlier result using a similar library construction protocol  <cit> . the seven sequence datasets have been submitted to the gene expression omnibus  database with accession number gse <dig> 

uncovered-gaps in transcribed regions are prevalent and read coverage is highly non-uniform
however, as shown in figure  <dig>  even with such deeply sequencing coverage, less than 60% genes in the genome had their length completely covered by at least one read, while only less than 90% genes in the genome had at least 10% of their length covered by at least one read, suggesting that some transcribed regions were not covered by the reads, leaving uncovered gaps in transcribed regions. the same problem has been widely noted in both eukaryotes  <cit>  and prokaryotes  <cit>  due to the aforementioned technical artefacts of the current rna-seq techniques  <cit> . in fact, we found that this uncovered gap problem was even more serious in many published prokaryotic datasets we have reanalyzed, a typical example from  <cit>  is shown in additional file 1: figure s <dig>  these prevalent uncovered gaps may be also partially caused by the loss of some rna fragments during the library preparation due to the highly labile nature of prokaryotic rnas as mentioned earlier. our data seems to support this hypothesis, as the percentage of gene body coverage in our samples collected under heat shock treatment were generally lower than that in other treatments, in particular, after  <dig> and 60 min heat shock . it is well known that rnas have a shorter living time at a higher temperature. it is because of this uncovered gap problem that we define a gene with ≥50% of the length covered by at least one read to be sufficiently expressed. also, this 50% cutoff was chosen, as all the samples except hs60min had over 80% of genes with at least 50% length being covered . additionally, as shown in figure  <dig>  our libraries were also biased to the 5’-end of transcription units, which is consistent with the earlier results  <cit> .

furthermore, we also found that the read coverage along genes were highly non-uniform . interestingly, the pattern of non-uniform coverage did not depend on the culture conditions and growth phase; rather, it strongly depended on the positions in the transcribed region . such highly non-uniform read coverage along a transcribed region has been widely noted in recent studies  <cit> , and were shown to be caused by several technical artifices in current rna-seq techniques  <cit> . clearly, both the uncovered gaps and highly non-uniform read coverage along transcribed regions make the full-length transcript assembling and alternative operon identification challenging tasks.

truhmm assembles operons with high accuracy
we used the  <dig> experimentally verified operons in regulondb  to train the parameters of the hmm and applied the leave-one-out strategy to test our truhmm algorithm. to compensate for the negative effect of uncovered gaps in the expressed regions on assembling, we used a centroid coverage value in a sliding window to represent the reads coverage for each nucleotide of dna . meanwhile, we do not want to increase false positives by mistakenly bridging irrelevant reads using such a strategy. to find an appropriate widow size for this purpose, we plotted the distributions of interoperonic and gap lengths shown in figure  <dig>  which suggest that the optimal window size might be shorter than  <dig> nt. therefore, we evaluated the performance of our algorithm when the window size varied from  <dig> to  <dig> nt with an increment of  <dig> nt on all the seven samples using the leave-one-out validation strategy . as shown in figure  <dig>  when evaluated using the adjacent operon pairs , our algorithm was very robust for the choice of the window size in the range of 11 ~  <dig> nt . particularly, when the window size l =  <dig> nt, the algorithm achieved probably the best-balanced performance , especially in terms of the three most important measures: sensitivity, specificity and accuracy. when evaluated using the entire operon structure, our algorithm still achieved very good performance with all the five metrics being over  <dig> % for window size of 11 ~  <dig> nt , and the best performance  was also obtained when l =  <dig> nt. therefore, we chose l =  <dig> nt for our further analysis. we also evaluated the effect of sequencing depth on the performance of our algorithm. as shown in additional file 1: table s <dig> using m-p4 h as an example, when the sequencing depth is over  <dig> times of genome size, our algorithm was very robust to the sequencing depth.

the performance of truhmm is robust
to evaluate the performance of truhmm and the robustness of its parameters on different organisms and datasets, we first applied truhmm with the parameters trained on the e. coli k <dig> dataset to the earlier directional rna-seq datasets of h. pylori generated under five different culture conditions  <cit> . we then trained the algorithm using an h. pylori training set  based on the results in  <cit> , and applied the algorithm with the trained parameters to both the h. pylori and e. coli k <dig> rna-seq datasets. remarkably, the operons reconstructed in both h. pylori and e. coli k <dig> using the e. coli- or h. pylori-trained parameters are exactly the same , and have high accuracy measured by all the five metrics . this might be explained by the fact that the parameters of the algorithm trained on the h. pylori training sets and on the e. colik <dig> training sets are almost the same , although our e. coli and the earlier h. pylori rna-seq datasets were generated by quiet different methods. these results unambiguously demonstrate that the performance of our algorithm is highly robust, thus parameters trained in one organism can be well extended to other organisms, at least in our tested datasets. the assembled operons in h. pylori for each sample are listed in additional file  <dig> 

the boundaries of operons can largely be captured by our libraries and assembled by truhmm
we next evaluated the ability of truhmm to define operon boundaries, i.e., the tsss and transcription termination sites  of assembled transcripts. however, an accurate evaluation of predicted operon boundaries is complicated by the recently discovered fact that alternative tsss and ttss are far more prevalent than previously thought  <cit>  and the lack of a gold standard tss and tts datasets because although some different tsss and ttss are documented for some operons in regulondb, they were generally characterized in different studies under various conditions that are not necessarily the same as we used in this study. thus, we evaluated our reconstructed tsss by the following alternative ways. first, we wanted to know how many experimentally verified tss in regulondb could be recovered by the boundaries of our assembled operons in any of the seven samples. if two known tsss in regulondb are within 10nt from each other, we considered them as the same one in our evaluation. thus, there are  <dig>  known tsss  associated with the genes transcribed in at least one of our seven samples. we considered a known tss was recovered by our predicted tss if they were at most 50nt from each other. using this criterion,  <dig> out of  <dig>   known tss were recovered by a total of our  <dig>  predicted tsss . second, as for the remaining  <dig>  predicted tsss with no match to a known tss,  <dig>  of which appeared in at least two samples, thus they are likely to be novel true tsss. for example, although genes b2628-b <dig> on the reverse strand is documented as an operon in regulondb, there is no tss documented for gene b <dig>  we predicted a potential tss in the upstream intergenic region of b <dig>  in five samples . the remaining  <dig>  predicted tsss appeared only in one sample. the  <dig>  predicted tsss are listed in additional file  <dig>  the low coverage of known tsss in regulondb does not necessarily indicate the inaccuracy of our prediction, considering the prevalence of alternative tsss utilizations under different conditions and the fact that tsss in regulondb were mostly characterized by different researchers, and under different conditions. therefore, the limited number of tsss in regulondb might be the major reason.

third, we checked whether there is a potential σ <dig> binding site  near the predicted tsss. to this end, we used the motif profile of the pribnow boxes  found by meme  <cit>  in  <dig>  out of  <dig> upstream promoter sequences to scan for the potential pribnow box in the  interval around the predicted tsss. according to the distribution of the scanning scores in the random promoter sequences , when a score is greater than  <dig> , the corresponding empirical p-value would be smaller than  <dig> . in all,  <dig>   out of the  <dig>  predicted putative tsss appearing in multiple samples harbour a putative σ <dig> binding site around predicted tsss with a p-value ≤  <dig>  , and  <dig>  out of the  <dig>   predicted putative tsss appearing in only one sample bear a putative σ <dig> binding site with p-value ≤  <dig>  around the predicted tsss . however, the predicted tsss appearing in multiple samples are more likely to be genuine ones since around 80% of which have a potential σ <dig> binding site located around the  interval of the predicted tsss, compared to the rather evenly distributed pribnow box positions of predicted tsss appearing in a single sample .

lastly, sharma et. al <cit>  have determined  <dig> primary tsss  in h. pylori, using drna-seq technique that enriches the reads coverage on the 5’ end of a transcript. therefore, the tsss determined in this study could be a good dataset to test the accuracy of our algorithm. specifically, we compared our predicted tsss in h. pylori using their directional rna-seq datasets with their tsss determined by drna-seq. on average,  <dig> % of our predicted tsss in each sample are located within the  interval around a tss determined by drna-seq . thus our algorithm has achieved a rather high specificity. our predicted tsss in each of the five samples, located within the  interval around a verified tss are listed in additional file  <dig>  furthermore, we used the primary tss to check the recall rate  of our program. our program detected  <dig>  out of the  <dig> total primary tsss. the majority of the verified tsss recalled by our algorithm had a dominant coverage on the 5’ end of the transcript, one of such cases is shown in additional file 1: figure s <dig>  by contrast, the majority of primary tsss missed by our algorithm did not have a dominant read coverage on the 5’-end, two such cases are shown in additional file 1: figure s <dig>  the primary tsss both covered and missed by truhmm are listed in additional file  <dig>  the much higher recovery rate of known tsss by our algorithm in h. pylori than in e. coli k <dig> might be due to the fact that the gold standard dataset in h. pylori were derived from the same conditions as the rna-seq datasets that we used for assembling the transcripts, while the datasets in regulondb were derived under various conditions.

as for the tts predictions, our algorithm recovered  <dig> out of  <dig>  known ttss associated with expressed genes in e. coli k <dig> , which is higher than the recovery rate of known tsss, even though the mapped reads are strongly biased to the 5’-ends . the lower recovery rates of known 5’ ends  compared to 3’ ends  might indicate that operons utilize more alternative tsss than ttss under different conditions. in other words, the predicted tsss without a match with a known tss in regulondb are likely to be novel alternative tsss used in different conditions. taken together, all these results strongly suggest that most of the predicted tsss and ttss are likely to be true transcription boundaries. the assembled operons and their alternative tsss in each sample are listed in additional file  <dig>  however, as also demonstrated in earlier studies  <cit> , to more accurately detect tsss and ttss of transcripts/operons, in particular tsss, in addition to directional rna-seq datasets, special datasets targeted to the 5’-endof transcripts are clearly needed, such as drna-seq data  <cit>  and datasets for the more recently discovered transcription start site rnas   <cit> .

condition-dependent alternative operon utilizations appear to be prevalent in e. coli k12
as summarized in additional file 1: table s <dig>  our algorithm detected more than  <dig>  operons involving more than  <dig>  genes in each sample. there were  <dig>  consistent operons that were transcribed in at least two of the seven samples, and  <dig> of which were multiple-gene operons . of these  <dig> consistent multiple-gene operons,  <dig> were expressed in all the seven samples except the operon istr-1-istr-2/b <dig>  which was not expressed in the samples hs60min and m-p2 h . figure  <dig> shows an example of a consistent operon hemcdxy encoding enzymes for tetrapyrrole synthesis. although all the four genes were consistently expressed and continuously covered by the reads under different cultures and growth phases, they had similar position-dependent non-uniform read coverage along the operon, again indicating the non-uniform coverage of the libraries.

furthermore, we consider a non-consistent operon as an alternative operon if it shares a portion of genes with another operon in other samples. as shown in additional file 1: table s <dig>  from  <dig>  to  <dig>   alternative operons were detected in each sample. thus around half of the reconstructed operons in each sample have at least one putative alternative form, a number comparable to that found in m. pneumonia <cit>  and other prokaryotes  <cit> , indicating that like many other prokaryotes  <cit> , e. coli k <dig> seems to express enormous alternative operons under different culture conditions and growth phases, a phenomenon that is more prevalent than previously expected. an interesting example is the 14-gene operon phncdefghijklmnop coding for proteins responsible for the assimilation of c-p bond-containing phosphonates under phosphorus starvation conditions  <cit> . in the lb, and heat shock samples , this operon was transcribed in several short suboperons  with low expression levels, whereas under phosphorus starvation , the phn genes were transcribed as a large operon phncdefghijklmnop with high expression levels , which is consistent with previous observations  <cit> . in fact, this 14-gene operon and its suboperons have been studied previously by several groups  <cit> . the phncde suboperon encoding a phosphonate transport system, was transcribed in the sample m-p0 h, and phnf is a repressor for this suboperon  <cit> . moreover, the products of the genes phnghijklm are essential for the c-p bond cleaving activity  <cit> . more recently, jochimsen et. al <cit>  have shown that phnghijk encodes a protein complex essential for organophosphonate utilization; this suboperon was detected in the sample hs15 min. furthermore, genes phnnp function as downstream processing enzymes  <cit> , whereas the phno gene is unnecessary for transport or catalysis, and may therefore have a regulatory role  <cit> . finally, as shown in figure  <dig>  the phncdefghijklmnop operon displayed varying/decreasing expression levels along the operon, another form of the complexity of prokaryotic transcriptomes in addition to alternative operon utilization  <cit> . however, further investigation of this phenomenon is out of the scope of this work.

another interesting example is the alternative utilization of the 13-gene operon flifghijklmnopqr encoding proteins in the flagella of e. coli k <dig> . although the fli operon was expressed as a 13-gene polycistron in the sample lb, it was split into short suboperons under the treatments of heat shock or phosphorus starvation in a time dependent manner . for example, at the beginning of heat shock , the fli operon was divided into four suboperons, then it was further split into six to seven suboperons . interestingly, it has been shown that heat shock reduces bacterial mobility possibly through the regulatory interactions between the heat shock system and the flagellum/chemotaxis system  <cit> . moreover, it has been shown that inorganic phosphorus is necessary for the motility of bacteria  <cit> . however, the underlying mechanisms of these observations are largely unknown. therefore, our results might provide a possible molecular explanation of these earlier observations: the extreme conditions  alter the expression of flagella proteins by changing the patterns of alternative usages of the fli operon, thus influence the motility of the bacterial cells.

condition-dependent asrna and ncrna transcriptions appear to be prevalent in e. coli k12
intriguingly, about  <dig>  ~  <dig> % and  <dig>  ~  <dig> % of our uniquely mapped read were mapped to the antisense strand of annotated open reading frames  and intergenic regions, respectively . we consider the assembled transcripts from these reads as putative asrnas and ncrnas, respectively. as shown in figure  <dig>  majority of these putative asrnas and ncrnas have a length of 20 ~  <dig> nt, while some can be >  <dig>  nt long. interestingly, majority  of orfs were predicted to have asrna transcriptions , which is consistent with an earlier studies showing that  <dig>  ~  <dig>  orfs had asrna transcriptions using tiling array  <cit> . however, a recent study  <cit>  identified only about  <dig>  asrna in the same genome under similar growth conditions using directional rna-seq. this discrepancy might be due to different techniques and analysis methods used. furthermore,  <dig>  ~  <dig>   out of the  <dig>  intergenic regions had putative ncrna transcriptions in a condition- and/or growth phase-dependent manner . to evaluate the accuracy of our assembled asrnas and ncrnas, we compared them with the  <dig> known asrna and ncrnas compiled by storz’s group  <cit>  and regulondb  <cit> , and found that our results recovered  <dig>  of these  <dig> known asrna and ncrnas . thus, truhmm has also achieved rather high sensitivity in assembling asrnas and ncrnas. however, the authenticity and functions of the remaining putative novel asrnas and ncrnas need to be further investigated. the assembled putative asrnas and ncrnas in the seven samples are listed in additional file  <dig> and additional file  <dig>  respectively.

some hypothetical genes are transcribed
although e. coli k <dig> is probably the best studied and understood model organism, researchers have not completely defined even its coding genes. for instance, there are still  <dig> sequences labelled as hypothetical protein genes as of this writing in the regulondb  <cit> . interestingly, we found that all these  <dig> hypothetical genes were transcribed in at least one of our seven samples , and  <dig>  of them were expressed in all the seven samples, suggesting that they are highly likely to be true protein coding genes. furthermore,  <dig> of them formed multi-gene operons with other known genes . the functions of these known genes might provide hints to possible functions of the associated hypothetical genes for “guilt by association”.

discussion
although a few high throughput studies have attempted to delineate the architecture of e. coli k <dig> transcriptomes  <cit> , they mainly focused on identifying tsss  <cit> , promoters  <cit>  and other features  <cit> . thus we still lack a good understanding of the level of the complexity of the transcriptomes in e. coli k <dig>  from which we gained most of our knowledge about transcription in bacteria, but the more recent revolutionary view of the high complexity and dynamics of prokaryotic transcriptomes. therefore, there is an urgent need for a better understanding of the complexity of the transcriptomes in this most widely-used model gram-negative bacterium, in particular, when the same highly complex and dynamic transcriptomes have recently been revealed in its counterpart model gram-positive bacterium b. subtilis <cit> . to fill the gap, we have profiled the transcriptomes in e. coli k <dig> during the course of heat shock and phosphorus starvation conditions using a highly strand-specific rna-seq method that can capture various forms rna transcripts, in conjunction with a highly accurate full-length transcript assembler, truhmm. indeed, as has been widely reported in many other prokaryotes  <cit> , we have also identified numerous putative novel and/or alternative operons and tsss, as well as novel putative asrnas and ncrnas in e. coli k <dig>  more importantly, the transcription patterns of these putative alternative operons, asrnas and ncrnas were highly dependent on the growth phases and culture conditions of the bacterium, suggesting that they might play important roles in the physiology of the bacterium. in the future, it would be very interesting to study how the alternative operons, asrnas and ncrnas are related to transcriptional and translational regulations and cellular functions, in particular in responses to environmental cues. furthermore, the molecular mechanisms that lead to the highly complex and dynamic transcriptomes in e. coli k <dig> and other organisms also warrant further investigations.

based on the ever increasing body of evidence  <cit> , and the data presented in current study, it is highly likely that prokaryotes generally have highly dynamic and complex transcriptomes to cope with environmental changes. the failure to observe such highly complex and dynamic transcriptomes in some earlier studies  <cit> , and the inconsistent results in e. coli k <dig> and b. subtilis <cit> , might well be due to the limitations of experimental and computational methods used in these studies. for instance, although an earlier study  <cit>  did not detect alternative operon utilizations in b. subtilis using tiling arrays under two culture conditions, a more recent study  <cit>  observed highly prevalent condition-dependent operon utilizations as well as numerous asrna and ncrna transcriptions using higher resolution tiling arrays and more sophisticated computational analysis in ~ <dig> culture conditions. furthermore, although selinger et al. <cit>  found that up to  <dig>  ~  <dig>  e. coli k <dig> genes had asrna transcriptions using directional tilling arrays, dornenburg et al. <cit>  only identified about  <dig>  asrnas in the same genome under similar growth conditions using a directional rna-seq technique. our results is in excellent agreement with the former results  <cit> , as we detected that  <dig>  ~  <dig> % annotated genes have putative asrna transcriptions . thus again asrna transcription appears to be more prevalent than originally anticipated in e. coli k <dig>  with the continuous drop in costs of the ngs technologies, directional rna-seq becomes a routine technique to profile transcriptomes in thousands of sequenced prokaryotic genomes. we expect that highly complex and dynamic transcriptomes will be identified in more and more prokaryotes using improved directional rna-seq techniques and analysis tools. the experimental methods and the transcripts assembler that we developed in this study can add in these efforts.

specifically, our directional rna-seq libraries preparation method based on the illumina small rna-seq prep method is highly strand-specific, avoiding potential genomic dna contaminations. our method is also capable to capture various types rna transcripts, including mrna and small rnas such as asrnas and ncrnas, eliminating the need to prepare two libraries targeted to mrnas and small rnas separately  <cit> . additionally, before the advent of a routine full-length rna sequencing technology, reference-based assembly of full-length transcripts is probably the best choice and a necessary step to analyze the transcriptomes using rna-seq short reads. due to the highly labile nature and various technical biases introduced during the sequencing library preparation  <cit>  and the sequencing process per se  <cit> , transcribed regions are highly non-uniformly covered, and more seriously, a considerable portion of a transcribed region may not be covered by the reads, resulting in uncovered gaps in transcribed regions  <cit> . our assembler truhmm has effectively addressed these issues. truhmm differs from an earlier hmm based method for analyzing transcriptomes in b. anthracis <cit>  in the several important aspects, and overcomes its shortcomings. first, by arbitrarily dividing read coverage values of genes into several bins, the earlier hmm  <cit>  contains multiple expression states that are not directly connected, thus in principle it cannot assemble transcripts with highly non-uniform coverage. by contrast, truhmm uses only a single state to model a wide range of read coverage along a transcript, thus it is able to assemble transcripts with highly non-uniform coverage. second, the earlier method assumes a first order dependence of the mapped reads  <cit> , which cannot effectively bridge the larger and prevalent uncovered gaps along a transcribed region as we see in our and other rna-seq datasets. in contrast, we treat the gap problem explicitly by using a sliding-window based centroid coverage values, which as we have demonstrated in this paper, can largely relieve the gap problem. third, the earlier method empirically assigns emission probabilities to several expression states  <cit> . by contrast, we derived the emission probabilities by fitting our centroid read coverage values to a poisson distribution, which nicely models the highly non-uniform read coverage phenomenon . lastly, by using a post processing strategy, our algorithm can accurately predicted tsss, whereas the early method lacks such capability. for these reasons, our algorithm has largely solved the highly non-uniform coverage problem as well as the prevalent gap problem in assembling prokaryotic transcripts using rna-seq short reads. indeed, when evaluated on the seven rna-seq datasets that we generated in e. coli k <dig> as well as datasets produced in h. pylori, truhmm has achieved rather high performance in assembling operons  and locating tsss  in both our e. coli k <dig> datasets and the earlier h. pylori datasets. truhmm also was able to accurately assemble asrnas and ncrnas as it recovered  <dig>  of the  <dig> known such rnas in e. coli k <dig>  <cit>  . equally importantly, the performance of truhmm also is very robust as we have demonstrated that the e. coli-trained parameters can be used to assemble the transcripts in h. pylori and vice versa, while achieving in both the cases exactly the same results as being done using the parameters trained on their own verified operons. therefore, one can use our trained parameters to assemble transcripts in a different organism when enough known operons in the organism of interest are not available for training the parameters.

another interesting and rather prevalent phenomenon called dynamic operon transcription is recently revealed by transcriptome profiling studies in m. pneumonia <cit>  and b. subtilis <cit>  using high density tiling arrays that give more uniform signal coverage along genes albeit at lower resolution  <cit> . dynamic operon transcription is characterized by varying levels of transcription along an operon, resulting in staircase like transcription levels between adjacent genes in the operon  <cit> . this phenomenon also is clearly seen in our datasets . however, truhmm in its current form is unable to detect such dynamic operon transcription events due to the highly non-uniform read coverage along genes in an operon. furthermore, if multiple alternative operons start at the same tss, but terminate at different tts in the same sample, truhmm will fail to detect such coexisting alternative operons in the same sample. clearly, to solve these problems, one needs to transform the highly non-uniform read coverage along the genes into a more uniform one by effectively correcting the aforementioned technical biases in the current rna-seq methods, or relies on a better sequencing technology with minimal read bias, or capable of sequencing transcripts in their full-length. in addition, truhmm might not be able to separate overlapping transcripts if the downstream transcript has no outstanding primary tss. finally, additional sequencing library targeted to the intact 5’-end of rnas might be needed in order to identify all possible tsss in a sample.

CONCLUSIONS
using a highly efficient and strand-specific rna-seq method combined with a highly accurate and robust algorithm and tool, truhmm for assembling full-length transcriptomes, we showed that alternative operon utilizations in e. coli k <dig> appear to be more prevalent than originally anticipated, and that a large portion of orfs and intergenic regions of the genome appear to have asrna and ncrna transcriptions, respectively. furthermore, the patterns of alternative operon, asrna and ncrna transcriptions are dependent on the culture conditions and growth phases of the bacterium, thus they might play important roles in the physiology of the bacterium. furthermore, with the recognition of the highly complex nature of prokaryote transcriptomes and the wide application of rna-seq techniques in the prokaryotes research community, truhmm can also be very useful for biologists to reveal the complexity of transcriptomes and the underlying molecular mechanisms in all sequenced prokaryotic genomes.

