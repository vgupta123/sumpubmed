BACKGROUND
algae have been long been used to assess environmental conditions in aquatic habitats throughout the world  <cit> . algae respond to wide range of pollutants. they provide an early caution signal of worsening ecological condition. they are highly sensitive to changes in their environment and therefore a good indicator  <cit> . shifts in abundance of algal species can be used to detect environmental changes, and also to indicate the trophic status and nutrient problems in lake  <cit> . nutrient stimulation of algal growth made algae part of the problem in the eutrophication of lakes, and trophic status of lakes can be monitored by algal taxa found in them.

algae from the division of bacillariophyta and chlorophyta especially the desmids  are highly sensitive to changes in the environmental parameters that could be considered as a bio-indicator for monitoring water quality  <cit> . however, several species of algae are capable to produce potentially harmful toxins as unpleasant taste and odour. chlorophytes are often abundant in eutrophic lakes. blooms of staurastrum have created grassy odour problems. navicula is a member of the group of algae called bacillariophyta. the hard cell walls of navicula do not decompose even when the cells die. the remaining skeletons of the cells create problems when they clog the filters at water treatment plants. cyanobacteria are known to produce nuisance blooms in eutrophic waters. furthermore, some species of cyanobacteria contributes to toxin, taste, and odour problem in water. some types of cyanobacteria such as microcystis, and anabaena are toxin and odour producing. cyanobacteria has become a critical problem over worldwide because of it is toxicity, and it is widely spread in eutrophic lakes. surveys studies carried out in different countries demonstrated that about 75% of lake water samples contain toxic cyanobacteria  <cit> . moreover, cyanobacteria as a control parameter for water quality was included and recommended to be as a factor of risk assessment plans and safety level such as world health organization  and several national authorities worldwide  <cit> .

however, identification of algae presents a problem in their taxonomy and the application of the organisms in environmental studies. several studies reported the conventional identification of algae by using microscopy images is time consuming with the general decline in competent algae taxonomists. this has led many researchers to develop several systems to automate the analysing and classifying algae images  <cit> . an automated computer-based recognition and classification system for rapid identification of microorganisms such as many algae will certainly reduce the burden of routine identifications borne by taxonomist whose service are needed in biodiversity studies  <cit> . ann based automated algae recognition is advantageous due to its learning capability from a given dataset, and it does not require a rule base to determine outcome. ann is also capable to perform mapping arbitrarily between input and outputs. it can also be used in a wide variety of domains for classification, prediction, approximation, and clustering. it is also resistant to noise in the input data. ann has been successfully applied for classification of two co-occurring species of ceratium by applying the back propagation learning method with three hidden layers  <cit> . ann has also been used widely to identify different type of algae species of lake water samples, and microorganism. several researches were extracted a set of suitable features of algae images such as fourier descriptors, geometrical features, and features characterizing of grey level distribution in a region to use it for training process of ann  <cit> . different types of ann have been employed to classify algae images such as feed-forward multilayer, back propagation error, radial basis, and support vector machine. for example, support vector machine  as a type of ann had been used together with radial basis function kernel to distinguish between  <dig> species of marine phytoplankton with 89% accuracy  <cit> . research reported that recognition accuracy rate is mainly depends on image segmentation process, selected features to be extracted, and the classifier type or the type of ann. research used many segmentation methods for detecting algae objects in microscope images, a large variety of features had been extracted to enhance the recognition process including geometrical feature, colour features, and textures features. geometrical feature is given measurement parameters about the object shape such as size, length, width, and texture features includes some features about image such as moments varying, image histogram, image texture, and image spectrum  <cit> .

however, most efforts for automated analysis and identification of algae images were limited to some specific type of algae division only. this is because of the difficulties in implementation of an application that can detect all types of algae division due to the variation found in algae shapes, properties, and colours. so far, only a few or limited studies exist on automated identification of tropical freshwater algae  <cit> .

therefore, this study is an early attempt to devise an automated recognition and classification system for several common algae. a combination of image processing with ann approaches used to automatic detection and recognition of some selected freshwater algae genera. these algae were from the divisions of bacillariophyta, chlorophyta  and cyanobacteria  found in tropical putrajaya lake. although this lake is a mesotrophic lake, there is a need to monitor changes in its water quality as socio-economic developments take place in surrounding areas. automated recognition and classification system for algae will be one of the several tools to be developed for monitoring algae diversity of and hence, water quality changes, the lake. this study is also an extension of previous studies by other workers who focused on certain algal taxa only.

methods
study site and data
putrajaya lake is a man-made freshwater lake. the lake, which covers an area of  <dig> ha, is located at the new capital city of malaysia known as putrajaya. the lake was constructed to provide a landscape feature and varied recreational activities for the city population as well as creating wildlife habitats  <cit> . putrajaya lake is warm polymictic, oligotrophic to mesotrophic, and is located at the south of the densely inhabited klang valley, malaysia. major inflows from upstream outside surrounding areas contain certain level of pollutants. nutrient loading at the lake are mainly come from non-point sources. these include the use of agrochemicals, fertilizer, land clearing, and soil leveling at the surrounding areas. freshwater algae images used in this work have been captured from water samples collected from different locations at putrajaya lake, malaysia. water samples were analyzed and examined by using electronic microscope manufactured by thermo fisher scientific company model, and freshwater algae images were transferred to digital storage devices by using a dino-eye eyepiece camera manufactured by dutech scientific company model  which attached to the microscope lens, and connected with personal computer via usb port for image acquisition.

image acquisition was performed using attached camera assisted with computer software , and captured image resolution was  <dig> ×  <dig> pixels. manual identification of algae species were carried out based on their taxonomic characteristic by aishah  <cit> . the data set included three genera of cyanobacteria, one genera of chlorophyta, and one genus of bacillariophyta as shown in figure  <dig>   <dig> image samples collected to be used for each selected algae genus. the algae image samples are then classified into two groups, training group which contains  <dig> images for each algae genus, and testing group which contains  <dig> images for each algae genus. the operating system platform used in this work was intel core i <dig> cpu,  <dig> gb ram, windows  <dig> professional . image processing and other related approaches were performed using computer software matlab  <dig> .

system development
matlab  <dig>  was used to develop the automated freshwater algae detection and classification prototype. matlab  <dig>  has the ability to integrate technical computing environment which is suitable for algorithm design and development. it is considered as a high-level programming language which includes a lot of functions that support image processing and classification methods. the development process of the automated prototype involves image preprocessing, segmentation, feature extraction and classification. the system architecture is shown in figure  <dig> 

image pre-processing
images captured from the microscope mostly suffer from noise and low contrast quality, it may contain some hole, small objects or unwanted area, and it contains mostly unavoidable scum exist beside the target cells. image pre -processing was carried out to enhance the captured image features. it removes noise to improve intelligibility and appearances of the images. basic steps of image preprocessing were used and listed as follows:

 <dig>  captured images are uploaded to the system using graphical user interface .

 <dig>  contrast enhancement was performed to enhance uploaded images, to remove dark area, to increase image brightness, and to make images clearer. histogram equalization is applied to enhance the contrast of the color image intensity, before the image is transferred to gray scale image  <cit> . the frequency occurrence of the pixel intensities was given by the histogram and mapped to a uniform distribution. this step was performed to improve the appearance of the images in terms of the image contrast.

 <dig>  image converted from gray scale to binary image, and image complements obtained to produce image background in black color and image objects in white color.

 <dig>  median filter  was used to reduce image noise, and to preserve edges. some unwanted area and small objects were removed when the median filter was applied.

image segmentation
image segmentation process was used to isolate the individual objects in captured images. an algae sample usually contains foreign objects including other microorganisms. image segmentation was used to identify the number of detected object in binary image. image segmentation uses the binary images which had been pre- processed previously. in this study, we used canny edge detector algorithm to perform image segmentation which is a powerful edge detector for image segmentation  <cit> . it was used to identify discontinuities in an image intensity value or the edge of the image. the steps are as described as follows:

a) gaussian filter was applied to smooth the image. it was used with a specified standard deviation, σ, to reduce noise.

b) the local gradient , and edge direction , were computed at each point. the gx and gy were calculated by first derivative of the intensity pixels. an edge point is identified to be a point of locally maximum in the direction of the gradient.

  gx,y=gx2+gy21/ <dig> 

  αx,y=tan-1gx/gy 

c) then the non-maximal suppression in the gradient magnitude image was used to give a thin line, which was the ridge of the edge points determined in . the ridge pixels were then threshold.

d) finally, the algorithm performed edge linking by incorporating the weak pixels that were connected to the strong pixels.

then, essential morphological operations performed on binary images such as image border removal, filling of boundary area, and exclusion of any small region that are <  <dig> pixels. morphology operation is a set of image processing operations that process images based on shapes. in our system, we used dilation and erosion which considered the most basic morphological operations. to overcome with the problem of objects overlapping, each object was counted as a single item by the image analysis process, therefore it was necessary to separate individual objects. regions with a maximum length of the rectangle fully enclosing the region >  <dig> pixels in length and perpendicular of at least  <dig> pixels were copied to a new binary image. these regions typically represented overlapping objects and the process resulted in their separation from isolated objects and from other regions.

image segmentation is used to separate the input images into multiple images based on the number of detected objects, where each image contains one object only and each sub images would be processed individually. the region of binary image was detected using canny edge approach, and each region is represented on individual sub image. each sub image was used as a mask to obtain the same region of original image ; both regions of colour and binary images was associated with corresponding index number to extract features of colour and binary image for the same image and store it in database file. image pre-processing, image segmentation, and morphological operation methods are associated with some image samples as shown in figure  <dig>  and additional file  <dig> 

feature extraction
feature extraction used to transform binary and colour image from the pre-processed stage into a set of parameters that described the algae features. feature extracted from the pre-processed algae image using both binary and colour image include: shape, area, minor and major axis, perimeter and fourier spectrum with principal component analysis . the details of each extracted feature are described as follows:

shape feature: one of our novel methods was proposed to develop a simple shape classifier and applied it before shape extraction method is performed, a simple classification function that differentiates between the algae shape was created to categorize common algae shapes into three categories. the simple classification function was used to detect the three categories of input algae images. the function identified the algae shape to equal to '0' if circular, '1' for spiral, and '-1' if irregular. this function was used to improve the accuracy rate, and to optimize the time of image recognition process  <cit> . results obtained from shape extraction will be included as one of the input parameters to algae classification neural network. a simple function was developed to obtain the angle of inclination for image objects automatically, and then the angle is used to rotate the algae image to be aligned horizontally as shown in figure  <dig>  this routine is calculated the angle of inclination automatically by obtaining the longest path that existed between each two point on algae boundary. three identified points p <dig> , p <dig>  and point of origin p were used to find the angle of inclination by using the following equation:

  θ=tan-1m1-m2/1+m1*m <dig> 

where m <dig> and m <dig> is the slope of lines that form the angle which were obtained by using the following equation:

  m1=y2-y1/x2-x <dig> 

  m2=y1-y0/x1-x <dig> 

this routine is designed to align the rotated shape into horizontal lines which ease the feature extraction process, and also improve the accuracy and performance of recognition process.

major and minor axis feature: major and minor axis of an image are extracted where two points were identified automatically by calculating the maximum distance between given points in objects vector as mention previously. the major axis represents the line segment connecting between the base points in x axis, and minor axis represents the maximum width which is perpendicular to the major axis as shown in figure  <dig>  actually, the major and minor axis is represented the length and width of algae objects.

object width factor: to differentiate between similar algae in shape the object width factor was calculated by slicing across the major axis and parallel to minor axis, then feature points were normalized into a number of vertical strips, and for each strip the ratio of strip length to the object width was calculated as the following equation.

  rc=wc/l 

where rc is the ratio at column c, wc is the width of object at column c, and l is representing the object length as shown in figure  <dig>  object width factor results then normalized to obtain five features only.

area: the area is represented by the actual number of white pixels in the selected object region. the object area was calculated by counting the number of white or '1' pixels inside the object boundary as shown in figure  <dig>  the area was included in this study as one of the feature parameters used for classifying process.

perimeter: the perimeter of object was the summation of the distance between each adjoining pair of pixels around the object border; it is shown in red pixel in figure  <dig>  it included in our features because it gives an indication about the image object size.

fourier spectrum with pca feature extraction: fourier spectrum was applied to extract some texture feature for increasing the accuracy of the image detection. fourier spectrum is ideally suitable for describing the directionality of periodic or almost periodic two-dimensional patterns. the spectrum features are expressed in polar coordinates to yield a function s . radius function ) and angle function  obtained by annularity sampling of the function s  are one-dimension functions. radius function, ), reveals energy distribution information with different frequency.

feature sets extracted from an algae object may contain some redundant feature. pca approach is used widely in most image processing application to reduce the number of features by normalization process. it has de-correlation ability that serves to de-correlate redundant features, and its energy packing property serves to compact useful information into a few dominant features  <cit> . the pca algorithm is also used to reduce and summarize the extracted features of the fourier spectrum method by removing redundancies. eight eigen value extracted and included in our feature extraction process.

mlp ann for classification
multilayer perceptron network  trained with back propagation error algorithm ann was used to perform classification on extracted feature vectors  <cit> . these types of ann are widely used for pattern recognition and classification. in this study one hidden layer feed forward neural network was chosen mainly because it has been proven that such a topology can approximate any continuous function  <cit> . devilliers and barnard  <cit>  found that the use of two hidden layers was only justified for the most esoteric applications. the hyperbolic tangent transfer function was used as recommended by most of researchers. the ann architecture consists of three layers, the input layer which has  <dig> input nodes - hidden layer include  <dig> nodes and output layer include  <dig> nodes. the standard root mean squared error function  was used to assess network performance, and a momentum value of  <dig>  was set based on trial and error. with the above parameters fixed, optimal step sizes taken in weight space were a function of the learning rate of  <dig>  with an epoch size of  <dig> 

the input to ann is a vector feature dimension that includes  <dig> features which extracted from input image. r represents the number of features in the input vector, q is the total number of training  pairs as shown in additional file  <dig>  the element of vector features is shown in table  <dig> 

during the training phase the input data and desired responses were fed into the network. the network uses momentum learning algorithm to determine the weights in the network and after each presentation the weights were adjusted to minimize the error between desired and actual output. as training progressed the error between the desired response and the network output dropped towards zero. as an mlp with hidden layers could be approximate virtually any input-output map, it was possible that a network could have been over-trained, i.e. a network that classified the training data perfectly but unable to generalize and classify new 'unseen' data. to improve generalization, 10% of the input data was set aside for cross validation. the training was stopped when the error in the cross validation dataset began to increase. testing dataset was then used to avoid biasness in result. this was a set of images that are not used for training the ann.

RESULTS
the automated algae recognition system graphical user interface  is shown in additional file  <dig> & <dig>  and in figure  <dig>  the system interface allows user to perform image preprocessing and classification automatically in simple and easy steps.

in order to test the accuracy of the system testing was carried out for a total of  <dig> testing images that has not been used for the training of mlp. sixty images of each genus of selected fresh water algae were used in this study. two test methods are used to evaluate system accuracy and performance which are the testing system functionality method and the comparison method for inter and intra results of both manual and automatic recognition. table  <dig> shows the comparison result between the manual and computer-based classification of selected algae from the available image dataset samples. the number of extracted region from image samples for each alga was examined in both method manual and automatic approach to distingue between alga and other objects as shown in graph chart on figure  <dig>  the process for separating the objects found in the image resulted in some short irregularly shaped image regions containing the algae. the mlp was more like to misclassify these small segments, and the other small object was excluded during the segmentation process. the foreign objects found in the algae images were classified by the mlp as unidentified. based on the comparison results of inter image test the algae identified by the automated system were within 90% of the manual classification of the region as shown in figure  <dig>  the results of comparison showed that the automated system was able to identify the algae in given images within the approximate accuracy of manual procedure.

the proposed system evaluated to measure the accuracy of classifying process between image data set which considered intra testing comparison. the actual classification accuracy resulted by the use of confusion matrix as shown in table  <dig>  and illustrated in additional file  <dig>  in this matrix classification result is given by the comparison between the automated analysis with the desired classification . the results demonstrated that the system identified most of input algae images successfully with 93% overall accuracy. the average recognition accuracy of the system 93% and is shown in figure  <dig> 

discussion
in this study, we selected specific fresh water algae which impacted strongly the water quality. for example, in different studies performed in malaysia to asses eutrophication status for  <dig> lakes, they reported that  <dig> lakes or 62% were eutrophic or in bad situation which requires immediate rehabilitation and restoration, also they found that the other  <dig> lakes which represent 38% of the study is classified as mesotrophic  <cit> .

the main objective for this study was to develop a computer system to identify, and classify some types of algae. the system is designed and implemented in matlab environments with friendly interfaces that make it easier for users. system accuracy and performance were calculated by comparing the automated and manual comparison for testing datasets, and by calculating the time of training and recognition process. the automated procedure for training process takes approximately  <dig> minutes; and the time required for identifying and classifying of input images is varying between  <dig> to about  <dig>  minute. the comparison between the manual and automatic classification of each object found on a particular image which has been identified and extracted resulted in discarding of the of the overlapping images. the highest accuracy rate was achieved for identification of scenedesmus as this alga has the most distinct feature compared to the other algae genus used in this study. meanwhile chroococcus has the lowest classification rate because of the process for separation resulted in the production of some short, irregularly shaped image region representing the algae. microcystis which is circular in shape is difficult to distinguish because these algae exist in colonies and the images captured are prone to overlapping which cause the mlp to misclassify the algae to unidentified. the accuracy rate for navicula and oscillatoria can be misclassified with each other by automated system as their spiral shape seems similar for the classifier and extracted feature for both of them matching in some parameters. mlp was used in this study instead of svm or rbf because the data utilized in this study are limited to small number of algae and also limited numbers of extracted features were used. the limited number of feature has been utilized in this study because of the selected features are sufficient to detect and classify selected algae used in this study with considerably high accuracy rate. furthermore, mpl performs faster as compared to the other types of ann when data volume is not an issue as the number of algae increases with the number of extracted features svm and rbf are more suitable option. the overall system accuracy of developed system depends essentially on the ability of system to detect object within input image and the ability of the classification system to identify the detected object based on the extracted feature. accuracy rate achieved in this study is acceptable and consider higher rate if compared with other similar studies. the system is developed essentially to support the process of monitoring water quality by detection some selected freshwater algae in putrajaya lake. results showed that system able to achieve such tasks by providing the necessary data about the density and gens of selected algae.

CONCLUSIONS
in this paper, we presented an image processing techniques with ann approach to identify and classify selected genus of freshwater algae from three different divisions of fresh water algae which varies in sizes and shapes. this study illustrated that computational recognition approach is important for freshwater algae, and prove that the classifying process is feasible for automatic identification of the selected freshwater algae. the better accuracy resulted was obtained due to the well preprocessing used techniques, and also due to the specific features selected during extract feature process. in addition, system reliability was dependent more on the combination of approaches used for image pre-processing, segmentation approach used, well selected features, and the training of data set. testing results also showed that developed system was reliable to be used for monitoring water quality of putrajaya lake. the main limitation of our system its inability to work well with images that include a huge number of objects. we would like to solve these limitations in our future work and make the system even more robust in future studies.

competing interests
the authors declare that they have no competing interests.

authors' contributions
sm headed the study and structured the whole research. maam and hm assisted in model development and manuscript writing. pm and as assisted in manuscript writing. all authors contributed in this study.

supplementary material
additional file 1
example for morphological operation steps.

click here for file

 additional file 2
mpl ann architecture.

click here for file

 additional file 3
system gui example for pre-processing in .

click here for file

 additional file 4
system gui example for edge detection in .

click here for file

 additional file 5
confusion matrix chart for data test images.

click here for file

 acknowledgements
this study was funded by umrg grant of university of malaya rg241-12afr

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2012: eleventh international conference on bioinformatics : bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/13/s <dig> 
