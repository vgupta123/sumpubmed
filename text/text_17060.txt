BACKGROUND
many protein chains are made of repeating units of similar structure, which are often arranged in a beautifully symmetric manner. some well-known examples are the 8-fold symmetric "tim" barrel folds, the β-blade propellers, the α/α superhelices, the leucine-rich repeat horseshoe-shape structures, etc. 

occurrence of symmetric structures poses a number of questions: what sequence and energetic features make repeating units fold into a similar structure and cause them to arrange in a symmetric pattern? what is the biological function of such symmetric chains? how are they different from the symmetric structures of multimeric complexes, which are formed by symmetrically assembling non-symmetric monomers? how many symmetric chains and what types of symmetry exist in the protein universe? what is their evolutionary history?

symmetric structures also tend to cause problems for automatic domain partition programs, which may recognize a single repeating unit or several such units as a domain for some chains and the whole repeat set with the full symmetry for others of the similar structure. for structures with super-helical symmetry, automatic structure comparison can be a problem also because of the flexibility of the structure between the repeating units. one or a few units in two such structures can be recognized as similar, but the whole structures can often be sufficiently different for routine detection of the similarity.

in order to answer some of the questions posed above, we need to collect as many symmetric protein samples as possible. it is also useful to identify symmetric structures and separate them from the non-symmetric structures before an automatic structure comparison or domain partition operation. for these and other reasons, a number of procedures have been developed for identifying symmetric structures over the years. these procedures can be broadly classified into two groups.

one class of methods finds repeats by using a structure alignment program that can report not just one optimal alignment but many other independent, sub-optimal alignments between a pair of proteins. repeats are found by running such a program on a protein and its own copy to find non-trivial self-alignments. an early work using this principle is by kinoshita et al.  <cit>  but more recent works by others  <cit>  use essentially the same principle. these methods depend on the ability of the structure comparison programs to find sub-optimal, yet still significant, structural alignments. each individual repeat is found independent of others and the fact that the same motif is repeated in a regular pattern is not explicitly used.

another class of methods explicitly exploits the periodic occurrence of repeats along the primary sequence. the method by taylor et al.  <cit> , its sequel davros  <cit>  and the method by murray et al.  <cit>  all start from the n-by-n sap  <cit>  matrix, where n is the number of residues in the protein. each element of this matrix gives a measure of the similarity of the structural environments of a pair of residues. two segments of similar structures, without a gap in the sequence, will appear as two symmetrical diagonal lines of high scores in this matrix. the methods detect periodic occurrence of such lines using different mathematical devices . the method by chen et al.  <cit>  is partly similar in that it also makes use of the periodic features of an n-by-n matrix, although their matrix is different. each matrix element in this case represents a sub-sequence of given length and position in the primary sequence. the value of the matrix element is one if the structure of the corresponding sub-sequence is found to be similar to that of at least one other sub-sequence of the same length, thus requiring an un-gapped structural similarity, and zero otherwise. since the prominent features appear differently in this matrix than in the sap matrix above, a couple of different methods are used to recognize the repeats. at least one of these  again depends on the periodic occurrence of prominent features along the primary sequence. generally, this class of methods may depend too much on the regularity of the repeats; insertions or deletions, either within or between the repeats, reduce the signal and will make the detection difficult.

here we describe a different method, symd for symmetry detection, which makes use of the symmetry of the structure. in this method a protein structure is aligned to itself after circularly permuting the second copy by all possible number of residues. for each circular shift, we keep only one optimal, non-self structural alignment, fully allowing gaps and unaligned loops. we call this process the alignment scan. this has the effect of amplifying the signal for the symmetric transformation of the structure. suppose the structure is two-fold symmetric. call the two similar parts a and b. all known procedures, with a possible exception of the methods that use opaas  <cit> , will report the similarity of a to b and b to a separately, with a score corresponding to matching n/ <dig> residues. however, if the second copy is circularly permuted by n/ <dig> residues, it has the structure b-a, and since the structure is symmetric, it will match the original structure a-b in its entirety. therefore, the alignment scan will report a score corresponding to n matched residues at the position n/ <dig> against a background of no significant alignment at all other shift values. from the superposition matrix at the position of the maximum score, we also get the rotation angle , the position and orientation of the symmetry axis, and the translation along the symmetry axis when the symmetry is that of a helix. the boundaries of repeating units, and in fact all the residues that make up each repeating unit, can be obtained from the structure-based sequence alignment between the original and the circularly permuted sequences. we report some individual sample cases and also some statistics on the occurrence of symmetric structures found in the scop <dig>  astral 40% set  <cit>  using this procedure.

RESULTS
z-scores from alignment scans
for a protein with n residues, the symd procedure performs n- <dig> structure alignments , each of which starts from the initial alignment which forces the original sequence to align with the same sequence but circularly permuted by n residues where n ranges from  <dig> to n- <dig>  this initial alignment is refined by structure superposition and sequence alignment cycles. 

fig.  <dig> shows the z-scores based on the t-score  of all refined alignments from an alignment scan for six sample structures. the structures are shown in fig.  <dig> 

d1s99a_ is the product of the b. subtilis ykof gene, which is involved in the hydroxymethyl pyrimidine  salvage pathway. the structure  is made of 2-fold symmetric, tandem repeats of a ferredoxin-like fold  <cit> . panel  of fig.  <dig> is a scatter plot of the z-score vs. the rotation angle for all the alignments from the alignment scan. it clearly shows one angle, 180°, at which the z-scores are much larger than at any other angles.

d1wd3a <dig> is the arabinose-binding domain of alpha-l-arabinofuranosidase b from aspergillus kawachii. it has the structure  of the 3-fold symmetric beta-trefoil fold  <cit> . the z-score versus rotation angle scatter plot  shows two peaks, at 120° and 240°, respectively.

d1jofc_ is a muconate lactonizing enzyme from neurospora crassa. it has the 7-fold symmetric 7-bladed beta-propeller structure , in which the c-terminal end of the molecule comes near the n-terminus to complete the first repeating unit  <cit> . therefore, when the sequence of the duplicated structure is circularly permuted by one repeating unit, all units align nearly as well as when the second sequence is not shifted at all. the resulting z-score plot  shows  <dig> peaks of nearly the same height at angles that are nearly multiples of 360°/ <dig> = 52°.

d1vzwa <dig> is a bispecific phosphoribosyl isomerase  from streptomyces coelicolor. it has a  <dig> tim barrel structure  with a 2-fold symmetry  <cit>  and the less perfect 8-fold symmetry of the  <dig> barrels. the z-score plot  reflects these symmetries: it shows one major peak at 180° and a lower, but clearly recognizable, set of peaks at 45° intervals.

d1bk5a_ is the major portion of yeast karyopherin alpha, which is a selective nuclear import factor. it has an arm-type alpha-alpha superhelical repeat structure , in which  <dig> repeating units of  <dig> alpha-helices each  are arranged in a superhelical manner  <cit> . the z-score plot shows  <dig> successively decreasing peaks at about  <dig> residue intervals . a superhelical structure is an open structure in which the n- and c-terminals are at opposite ends of the molecule. for such a structure, shifting the sequence of one molecule by a repeating unit reduces the number of matching units by one even when the sequence is circularly permuted. this explains the decrease in peak height at successively larger shifts. ideally, there would be  <dig> peaks since the structure contains  <dig> repeats. however, the last peak is weak and does not rise above the background level.

notice that the z-scores are plotted against the average alignment shift rather than the rotation angle for this structure. the average alignment shift  <cit>  is the average of the residue serial number differences between aligned residue pairs after the alignment has been fully refined by rse. for this structure, the z-score plot shows a more regular pattern when plotted against the average alignment shift than when plotted against the rotation angle . this implies that the number of residues is more conserved than the relative orientation between the repeats in this structure.

d2j8ka <dig> is a protein made by the fusion of two pentapeptide repeat proteins, np <dig> and np <dig>  from nostoc punctiforme  <cit> . it has the structure of a parallel beta-helix with a square cross-section . let us label the successive corners of the square cross-section as c <dig>  c <dig>  etc. the basic symmetry of the structure, call it h <dig>  is a helical operation that matches cn to cn+ <dig>  the rotation angle of this symmetry is about 90° and the translation is small . the structure also has the symmetry h <dig> = h <dig>  which matches cn to cn+ <dig>  h <dig> = h <dig>  which matches cn to cn+ <dig>  etc. among these compounded symmetries, the 4-repeat symmetry, h <dig> = h <dig>  is special since this operation matches one layer to the next layer. this is nearly a pure translation , which essentially corresponds to the separation between the two parallel beta-strands. it has a small rotation component of -2° , which represents the slight left-handed twist between successive layers .

the z-score plot that symd program gives for this structure is shown in fig.  <dig>  panel f. concentrating on only those points for which the z-score is > <dig>  the plot shows  <dig> sets of points, each set at approximately 90°, 180°, 270° or 360°. these sets correspond to the square cross-section of the structure. the point with the highest z-score in the first set has the rotation angle of  <dig> ° and the translation of  <dig>  Å. this is the h <dig> symmetry. the other points in the same set represent h1*h <dig>  h1*h <dig>  etc. similarly, the set of points in the second set, at around 180°, represents symmetries h <dig>  h2*h <dig>  h2*h <dig>  etc. and the third set at around 270° represents symmetries h <dig>  h3*h <dig>  h3*h <dig>  etc. the point with the highest z-score in the last set of points has the rotation angle of - <dig> ° and the translation of  <dig>  Å. this represents the h <dig> symmetry, which essentially translates the whole molecule along the helix axis by one layer, with a small left-handed twist. the other points in the same set at successively larger negative angles represent h <dig>  h <dig>  etc.

number of symmetric structures in the universe of protein structural domains
the symmetries detected here are all pseudo or approximate symmetries. the imperfections in the symmetry arise both because the repeating units are not all exactly the same and because they are not arranged in a perfectly symmetrical manner. therefore, the notion of symmetric structure requires using a cutoff value of some variable. we used the z-score  for this purpose.

symd was run on all  <dig> domains in the scop <dig>  astral 40% set downloaded from the astral website http://astral.berkeley.edu/. the results of these runs  for all domains are given in the additional file 1: all_domains.xls. fig.  <dig> shows the number of proteins that have a z-score above the value indicated along the x-axis. at a sufficiently low z-score cutoff value, nearly all proteins have a z-score higher than the cutoff value. as the z-score cutoff value is raised, the number of proteins with a z-score higher than the cutoff value initially decreases rapidly and then more gradually at higher cutoff values. the number changes smoothly, indicating that there are proteins with all degrees of perfection of symmetry.

a better feel for the relation between symmetry and the z-score can be obtained by considering the z-score distribution of the alignments that are not likely to represent the symmetry of the protein. we selected two alignments among the n- <dig> refined alignments from the alignment scan for each protein: the 'best' alignment and the best among the 'noise' alignments. the 'best' alignment is the one with the highest z-score. the 'noise' alignments are those whose rotation axis makes more than about 20° angle  to that of the 'best' alignment. fig.  <dig> shows the z-score distribution among the  <dig> proteins for the 'best'  and for the best 'noise'  alignments. the black curve shows that there are few 'noise' alignments with the z-score above  <dig> and that the number increases sharply when z-score falls below  <dig> 

on this basis, we consider a protein to be symmetric when the z-score of its 'best' alignment is above  <dig> or  <dig>  the number of symmetric domains in the astral <dig> dataset is then  <dig>  or  <dig>  depending on whether the z-score cutoff value used is  <dig> or  <dig>  respectively.

symmetric scop folds
there are  <dig> folds in the astral 40% dataset we used. the number of symmetric domains in each of these folds, using the z-score cutoff values of  <dig> and  <dig>  are given in the additional file 2: all_folds.xls. many scop folds contain both the domains that are judged to be symmetric and those that are not. the number of scop folds that contain at least one, 50%, or 100% of domains that are symmetric, using the z-score cutoff criteria of  <dig> or  <dig>  are given in table  <dig>  for example, 8% or 13% of all scop folds contain half or more domains that are judged to be symmetric. but many of these are singletons and other small folds . if one considers only the  <dig> folds that contain at least  <dig> domains, the number of folds of which half or more of the domains are judged to be symmetric is  <dig>  or  <dig>  depending on the z-score cutoff value used.

a number of folds that contain at least one domain with the indicated z-scores.

b number of folds of which 50% or more domains have the indicated z-scores.

c number of folds of which all domains have the indicated z-scores.

there are  <dig> or  <dig> folds that contain  <dig> or more symmetric domains, using the z-score cutoff value of  <dig> or  <dig>  respectively. fig.  <dig> shows the total number of domains and the number of symmetric domains in the  <dig> folds. the names of these folds are listed in table  <dig> 

aserial number of folds in fig.  <dig> 

bnumber of domains with z-score >=  <dig> 

cnumber of domains with z-score >=  <dig> 

dtotal number of domains in the fold.

the fold with the most symmetric domains is the  <dig> tim barrel fold. symd finds  <dig>  to  <dig>  of the  <dig> domains of this fold symmetric depending on the z-score cutoff value used. many of the structures with low z-score are non-symmetric because of the presence of one or more large extensions outside of the barrel. others have distorted barrels. two examples of such structures are shown in fig.  <dig>  to be compared with a symmetric tim barrel shown in fig. 2d.

the alpha-alpha superhelix fold  has the second most number of symmetric domains. many of the domains in this fold that have low z-scores are either short or contain collections of helical hairpins that do not maintain a superhelical symmetry.

all  <dig> beta-trefoil domains  are found to be symmetric at the z-score cutoff level of  <dig> and all but  <dig> at the level of  <dig>  all the beta-propeller domains  are found to be symmetric at the z-score cutoff level of  <dig>  the 4- to 7-blade propellers are included in fig. 5; the six 8-bladed beta-propellers are not shown. all but two of the  <dig> transmembrane beta-barrels are recognized as symmetric at the z-score cutoff level of  <dig> and all but one at the level of  <dig>  it should be noted that the beta-hairpins in these structures are often not all of the same lengths and some strands in some structures make excursions into the inside of the barrel.

symd finds only a relatively small fraction of domains with the ferredoxin fold symmetric. the basic unit of the ferredoxin fold is an alpha-helix followed by a beta-hairpin. a typical ferredoxin fold contains two of these units, which ideally are related by a two-fold symmetry. however, many structures are circularly permuted and have an extension at the n- and/or c-terminus of the molecule. also, the two helices are often positioned and oriented in an asymmetric manner. the most symmetric ones in this fold actually have four basic units, of which the symmetry relates one pair to the other pair. 

the fold with the largest number of domains in the astral domain dataset is the immunoglobulin-like beta-sandwich fold . symd finds most of the domains in this fold as non-symmetric. only two out of  <dig> domains have the z-score greater than  <dig>  these are shown in fig.  <dig> along with another protein with a median z-score for comparison.

discussion
characteristics of the symd procedure
the simple method of doing the alignment scan using permuted structure has at least a couple of advantages compared to other reported methods. one is that at each stage, it finds the best alignment allowing gaps and unaligned regions. this is a significant advantage because repeating units in a symmetric structure often contain loops of varying lengths. other algorithms that use information on the regularity of repeats  <cit>  assume absence of long gaps. obviously, the length of the insertion matters: if the insertion is sufficiently large, the whole structure becomes non-symmetric because the non-symmetric inserted part can no longer be ignored. in such cases, symd will also declare the structure non-symmetric, not because it does not find the symmetric repeating units but because the symmetric part is too small a part of the whole structure.

another advantage is that this algorithm enhances positive signal by making use of the symmetry. for example, suppose a structure has six repeating units arranged in a 6-fold symmetric manner, but one unit is rather different from the rest. most programs will fail to recognize the 6-fold symmetry because this one unit does not align well with the others. in contrast, symd will find that  <dig> of the  <dig> units match at every 6-fold position and could very well report the protein as symmetric. 

these two features probably contribute to the remarkable fact that symd finds, for example, all  <dig> beta-propeller structures in the astral 40% dataset as symmetrical without exception .

on the other hand, symd algorithm is designed to detect global symmetry of a protein structure. if the protein contains a symmetric part, but is not symmetric as a whole because of the presence of other parts or other domains, symd will tend to declare the protein non-symmetric and not recognize the symmetric sub-structure. the algorithm can probably be modified to recognize local symmetry, but this will be the subject of a future study.

number of symmetric proteins in the astral <dig> domain dataset
the number of symmetric proteins in a database depends both on the property one uses to measure the degree of symmetry and on the cutoff value of this property. we used in this study the z-score of the t-score, which is a weighted number of aligned residues. in order to convert the t-score to the z-score, we used a background distribution that was obtained from alignments of similar sized proteins whose rotation axis is significantly different from that of the best alignment . a better method would probably use information other than just the size of the protein. for example, one could use protein class or secondary structure content information or perhaps each protein-specific background. we have not explored other quantities or other ways of obtaining the z-score in this study.

using the z-scores, we found that 10% or 15% of the proteins in the astral <dig> dataset are symmetric depending on whether the z-score cutoff value of  <dig> or  <dig> is used, respectively. this is comparable to the 14% found for proteins that contain duplicated sequence segments in all known protein sequences  <cit> .

the number of symmetric folds is even more difficult to decide because many folds contain both symmetric and non-symmetric domains. but the fraction of symmetric folds is roughly in the similar range using a couple of different measures. for example, the fraction of folds that contain more than 50% of symmetric domains is 11% or 16%, using the two z-score cutoff values, among the  <dig> folds that contain  <dig> or more domains .

comparison with other programs
the number of symmetric proteins found by symd is compared with that of several other programs in table  <dig>  the comparison is not completely satisfactory because the datasets used are different and only small number of numerical results are available in most cases. however, the table shows that symd finds a similar or more number of domains as symmetric, except when compared to gangsta+ by guerler et al.  <cit> , which finds more ferredoxin-like and immunoglogulin-like domains as symmetric than symd does.

¶ repeat length > <dig> 

since guerler et al. used the same dataset as we did and the full results are available on their web site, we made a more detailed comparison for the  <dig> folds listed in their table  <dig>  the results of this comparison are given in the additional file 3: symdgangstadata.xls, which gives the numerical values of the symmetry measures  by both programs for each domain of each fold, additional file 4: symdgangsta.ppt, which gives the scatter plots of the symmetry measures, and additional file 5: symdgangstatable.xls, which gives a summary table of the numbers of domains that are considered symmetric or non-symmetric by the two programs. the scatter plots show generally good correlation between the two symmetry measures except for the four-helix up and down bundle fold.  the number of symmetric proteins depends on the cutoff value used for both methods. for the ferredoxin-like and the immunoglobulin-like folds, only a small adjustments in the cutoff values will be sufficient to make the number of symmetric proteins the same.  however, the correlation is not perfect and the list of symmetric proteins would not be the same even after the cutoff values were adjusted to make the number of symmetric proteins the same. for the beta-trefoil, 7-bladed beta-propeller, and the tim barrel folds, small adjustments of the cutoff values will not bring the number of symmetric proteins the same.

types of symmetry
we observed many different types of symmetry by visual inspection of the structures. the pattern of the z-scores given by alignment scan procedure contains the symmetry information as described in the results section. we are currently working on developing a robust, automatic procedure for determining symmetry types from such data.

symmetric structures can be open or closed. in a closed structure, the n- and c-termini of the molecule are physically close to each other and the symmetry is purely, or nearly purely, rotational. the amount of rotation is an integer fraction of 360°. structures with 3- to 8-fold symmetries have been observed. these can be all alpha-helical , all beta  or a mixture .

the 2-fold symmetric structures can be of two types. a two-fold symmetry occurs when the n-terminal and the c-terminal halves of the molecule attain a similar structure. in many such structures, the two halves fold more or less independently and form two sub-domains. the structure shown in fig. 2a is an example of such a structure. in other cases, however, the two interact intimately over most of their length, resulting in an intertwined structure, like the double psi beta-barrel shown in fig. 8b.

a special type is the transmembrane beta-barrels, which are made of up-and-down beta-hairpins that twist around the surface of a cylindrical barrel . these can have more than 8-fold symmetry, or more than  <dig> beta-strands, but all are closed structures in which the n- and c-termini come close to each other. those with long barrels also have screw symmetries with many different rotation angles.

an open structure has a helical symmetry and the n- and c-termini of the molecule are at opposite ends of the molecule. such a structure can be all alpha-helical , all beta-strands , or a mixture . typically there are a large number of repeating units and the rotation angle is not an integer fraction of 360°.

we have seen only mono-axial symmetries in this work. but this is probably because we used the symd algorithm to find one symmetry axis and ignored other signals that might arise from a second symmetry axis. a possible indication of the existence of a second axis for some structures is the curious high z-scores for many 'noise' alignments seen in fig.  <dig>   this will be the subject of a future study.

CONCLUSIONS
we have described the principle of and the initial results obtained from the newly developed program symd. symd is a true symmetry detection program in contrast to many other procedures used for the same purpose but which actually simply detect structural repeats. the procedure is sensitive because  it allows detection of symmetry even when the structure contains symmetry-breaking insertions or deletions either within or between the repeating units and  it amplifies symmetric signal. the procedure yields both the sequence and structural alignments after each symmetry operation. the sequence alignment gives information on the residues that make up the repeating units. the structural alignment, or the structure transformation matrix, gives the information on the direction and position of the symmetry axis, the rotation angle, and the pitch if the symmetry is that of a helix. the procedure can detect more than one symmetry for a given molecule as described in the case of a 2-fold symmetric tim barrel and a beta-helix structures.

a symd run on the nearly  <dig>  domains in the astral 40% domain database yielded a preliminary overall view of symmetric structures in the known domain structure world. it can be estimated that between 10% and 15% of the domains are symmetric. many scop folds contain both symmetric and not-so-symmetric domains. the symmetries observed are broadly of two types, closed and open. in symmetric closed structures, the n- and c-termini of the molecule come close together and the structure has a purely rotational symmetry. most of these have 3- to 8-fold rotational symmetries, but the transmembrane beta-barrels can have higher symmetries. in the symmetric open structures, the structure has a helical symmetry and the n- and c-termini are at the opposite ends of the molecule. structures with a 2-fold rotational symmetry do not fit either category well; they can have either a closed  or an open structure.

