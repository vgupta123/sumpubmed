BACKGROUND
matrix assisted laser desorption ionization - mass spectrometry  is a well-established analytical technique in biological research. in particular, it is being widely used in proteomics, metabolomics and lipidomics studies  <cit> . maldi-ms can be used to measure amounts of bio-molecules in complex biological matrices thereby discovering differentially expressed bio-molecules. over the past decade maldi imaging mass spectrometry  approaches, which measure the spatial distribution of bio-molecules in thin sections of tissue, have been rapidly developed  <cit> . maldi-ims relies upon collecting many maldi-ms spectra in a two dimensional array. a typical dataset generated by these techniques may contain hundreds or thousands of spectra, each with hundreds to thousands of intensity measurements of peaks corresponding to various bio-molecules.

detection of peaks in mass spectra is the initial step in maldi-ms data analysis. enormous care should be taken to perform this step as accurately as possible because the errors that occur in this step highly affect the performance of subsequent steps and can possibly lead to wrong conclusions. in general, the peak detection procedure consists of three main steps namely: 1) spectra smoothing, 2) baseline correction and 3) peak picking  <cit> .

even though the peaks corresponding to bio-molecules appear as local maxima in a spectrum, detecting these peaks is a challenge due to the high background noise. the background noise that is measured at the detector will cause a non-uniform background in the acquired spectra and the generation of confounding signals. these signals can suppress the important low-amplitude peaks corresponding to low-abundance bio-molecules in mass spectra. moreover, they can cause a decreasing curve in the mass spectrum, which is known as baseline, making the peak detection process a challenge. therefore, it is crucial to perform spectra de-noising and baseline correction prior to peak picking.

in the literature, various methods such as gaussian filtering, average filtering and several wavelet transformation based methods have been utilized in spectra de-noising  <cit> . usually, in mass spectra, noise decreases along the spectrum and the peaks turn out to be shorter and wider at higher masses. therefore, simple fixed window based methods like average and gaussian filters often fail to produce adequate results  <cit> . as an alternative, wavelet transformation based methods have also been used for spectra de-noising  <cit> . basically there are two types of wavelet transformation based methods namely discrete wavelet transformation  and continuous wavelet transformation . these methods transform mass spectra into the wavelet domain and represent them in terms of wavelet coefficients in multiple scales. cwt computes wavelet transforms on every scale while capturing more information regarding the peaks in the mass spectrum. however, it is redundant and less efficient. on the other hand, dwt is non-redundant as it operates only on the required number of scales. however, it is shift-variant, meaning that a small shift in the starting position of the spectrum can cause a major drop in performance. in order to overcome this limitation, coombes et al. proposed undecimated discrete wavelet transformation , which is an improved shift-invariant version of dwt, for spectra de-noising  <cit> .

after de-noising, baseline should be removed from each spectrum. various methods based on monotone minimum, linear interpolation and moving average of minima have been utilized in baseline estimation  <cit> . however, if cwt is used for spectra smoothing, a separate step for baseline removal is not required as it has the ability to automatically remove the baseline  <cit> .

after de-noising and baseline removal, peak picking becomes less challenging. numerous peak finding methods have been proposed in the literature. some studies define peaks as local maxima in a spectrum  <cit> . signal to noise ratio of peaks has also been widely used for defining peaks  <cit> . du et al. proposed a method based on ridge lines for peak picking after using cwt  <cit> .

precise estimation of peak parameters such as peak summit location and peak area is of high importance. inaccurately estimated peak locations can cause problems when identifying underlying bio-molecules and can possibly lead to wrong predictions. also, peak area is a better estimation for molecular abundance than the peak intensity  <cit> . however, the above mentioned peak picking methods provide less accurate estimations for peak parameters. therefore, in order to estimate peak parameters more accurately, model-based peak picking methods have also been used. these methods use various model functions such as gaussian and lorentz to fit peaks  <cit> . these models produce inaccurate results when the peaks are asymmetric. in order to overcome this limitation, the bi-gaussian model has been proposed  <cit> . however, it tends to perform poorly when dealing with peaks that follow different shapes other than bi-gaussian. recently, bayesian non-parametric models have also been proposed for peak detection in maldi time of flight  mass spectra  <cit> . as these models have been developed incorporating the properties restricted to the tof analyser, unlike the other algorithms, they cannot be used for peak detection in other types of maldi mass spectra. also, the high computational cost of these methods hinders their practical application.

this paper proposes a new peak detection algorithm based on  dual-tree complex wavelet transformation and stein's unbiased risk estimator for spectra smoothing;  monotone local minimum curve fitting for baseline correction and  the modified asymmetric pseudo-voigt model together with hierarchical particle swarm optimization for peak modelling and parameter estimation.

methods
spectra smoothing
for spectra smoothing, we used an improved version of the conventional dwt method namely dual-tree complex wavelet transformation . the main advantage of dt-cwt over dwt is its ability to achieve near shift-invariance. also, it is more efficient than undecimated discrete wavelet transformation , which is another shift-invariant version of dwt, as the former has a relatively small redundancy factor. hence it has shown promising results in different areas outperforming dwt and its other variants  <cit> .

for dt-cwt, a q-shift hilbert pair of wavelets was used. mostly in the wavelet domain, true peaks are represented by relatively large wavelet coefficients and noise is represented by relatively small wavelet coefficients. therefore, after transforming mass spectra to the wavelet domain, the coefficients below a certain threshold were set to zero in order to eliminate noise and then the resultant coefficients were transformed back into the intensity domain. this threshold value should be selected carefully because a lower threshold value leads to under-smoothing and a higher threshold value results in over-smoothing. in this study, stein's unbiased risk estimator  was used to calculate the threshold value for each level in the wavelet domain. sure is an unbiased estimator that can be used to get an estimate of the risk or the mean-squared error for a threshold value  <cit> . therefore, an optimal threshold value can be selected by minimizing the estimated risk. for detailed information about sure, see appendix  <dig> 

we observed in most mass spectrometry data, that the noise decreases along the spectrum. therefore, at the beginning, the raw spectrum was split into  <dig> equal sections and each section was smoothed separately using the dt-cwt method.

baseline correction
in general, the baseline in maldi-ms data decreases at the beginning and then stays constant. therefore, we estimated the baseline by fitting a monotone local minimum curve, which follows the spectrum when it is decreasing and remains unchanged when the spectrum is increasing, to the smoothed spectrum. for detailed information about this method, see yang et al.  <cit> . the baseline estimated in this manner should be removed from the smoothed spectrum.

peak picking
after de-noising and baseline correction, the algorithm used for peak picking and peak parameter estimation in mass spectra can be summarized as follows:

 <dig>  locate valleys  in the smoothed and baseline-corrected spectrum and split the spectrum into groups of data points at the valleys. suppose the spectrum is split into k groups of data points.

 <dig>  for each group  of data points in the spectrum,

    <dig>  fit a peak to the data points in component j, using the modified asymmetric pseudo-voigt  model.

        let θ= be the parameter vector that needs to be optimized .

        use the hierarchical particle swarm optimization  method to obtain the optimized peak parameters  based on equation :

  θ^=argmin fθ. 

        f is the objective function given by:

  f=∑m <dig>  

        where s is the actual intensity value at mass m and v represents the fitted value.

        

    <dig>  calculate the area of the fitted peak and if it is smaller than a threshold value, then eliminate component j from further analysis.

    <dig>  check the peak width. if it is greater than a threshold value, there is a possibility that it contains multiple overlapping peaks. therefore, locate the valleys between the starting and ending points and split component j into subgroups at the valleys. for each subgroup of data points, repeat steps  <dig> ,  <dig>  and  <dig> .

    <dig>  check the level of peak asymmetry. if σ <dig> and σ <dig> denote the standard deviations of the two halves of the peak, then peak asymmetry  can be determined as follows:

  μ=maxmin. 

        if the peak is highly asymmetric , there is a possibility that it contains multiple overlapping peaks. such overlapping peaks need to be decomposed accurately. therefore, if the peak is highly asymmetric and if it is possible to locate valley points between the starting and ending points, then split j into subgroups at the valleys. for each subgroup of data points, repeat steps  <dig> ,  <dig>  and  <dig> .

    <dig>  record optimized peak parameters.

the modified asymmetric pseudo-voigt  peak model
we propose the mapv model, which is a linear combination of gaussian and lorentz functions, to fit maldi-ms peaks . it has  <dig> parameters namely height of the peak , location of the peak summit , the standard deviation of the first half of the peak , that of the second half of the peak , the fraction of lorentz function used in the first half of the peak  and that of the lorentz function used in the second half of the peak . when this model is used, the intensity values of a peak in a mass spectrum can be modelled as a function of mass values  according to equation :

  vm=h×β111+m-ασ12+1-β1e-lnm-ασ12;m<αh×β211+m-ασ22+1-β2e-lnm-ασ22;m≥α. 

both β <dig> and β <dig> lie in the range between  <dig> and  <dig>  hence,  and  represent the fractions of gaussian function used in the first and second halves of the peak respectively.

the proposed mapv model is a customization of the asymmetric pseudo-voigt  function used in the literature  <cit> . since the standard apv function has only one β parameter, it cannot adequately model mass spectral peaks having dissimilar proportions of lorentz and gaussian functions in the two halves of the peak . in contrast, the two β parameters allow the mapv model to take dissimilar values for the proportions of lorentz and gaussian functions in the two halves of the peak.

hierarchical particle swarm optimization 
peak fitting using the mapv model is basically an optimization problem. it is required to minimize the difference between the fitted values and the actual values. hence, the objective function is defined as in equation .

we used the hpso method proposed by ratnaweera et al., which is an improved version of the conventional particle swarm optimization  algorithm, to obtain the optimized peak parameters  <cit> . it is a population-based optimization technique which starts by randomly initializing the population of particles in the search space. then, it finds the global best solution by adjusting the path of each particle, towards its own best location and the best particle of the entire swarm. at each time step, this best particle of the entire swarm is found according to a user defined objective function  <cit> .

let n be the number of particles in the swarm and d be the dimensionality of the search space. in this application, d equals to  <dig> since there are  <dig> peak parameters that need to be optimized. in the d dimensional search space, each particle i  has the following features: its position vectorxi=, its velocity vector vi= and its personal best positionpi=. let pg= be the best particle found so far. then, this method updates the velocities and positions of the particles according to the following pseudocode:

 forvid=c1×rand.×pid-xid+c2×rand.×pgd-xidxid=xid+vidend 

where rand and rand are two random numbers in the range  <cit>  that are separately generated using the uniform distribution. c <dig> and c <dig> are calculated according to equations  and  respectively:

  c1=c1f-c1iitermaxitr+c1i, 

  c2=c2f-c2iitermaxitr+c2i, 

where iter denotes the present iteration number, maxitr denotes the maximum number of acceptable iterations and c1f, c1i, c2f and c2i are constants. in this study, we used the best values suggested by ratnaweera et al. for these constants  <cit> . the complete pseudocode of the hpso algorithm is available in appendix  <dig> 

dataset 1: simulation data to evaluate the mapv model
a comprehensive simulation study was conducted in order to assess the performance of the proposed mapv peak model. it was compared with three other widely used peak models namely gaussian, lorentz and bi-gaussian . in order to generate data for this comparison study, an approach similar to yu and peng, where the data were simulated using a 3-component bi-gaussian mixture model was used  <cit> . in this study, the data were generated using a 2-component mapv model. the  <dig> parameters used in this simulation study along with their values are listed in additional file  <dig>  by varying  <dig> out of those  <dig> parameters,  <dig> parameter combinations were created in order to assess the peak fitting accuracy at different levels of peak asymmetry and peak overlap. in each parameter setting, the intensity values of each component  were obtained from the mapv function in equation . then, the intensity values of both components were added together and noise was introduced in order to make the peak fitting process more challenging. in this study, each parameter setting was tested  <dig> times.

dataset 2: simulation data generated from the maldi-tof computer model
it is difficult to evaluate the performance of the proposed overall algorithm using real ms data as the true peak parameters are usually not known. therefore, in order to validate the competency of the proposed peak detection algorithm, we used a publicly available simulation dataset  <cit> . it consists of  <dig> groups of data each containing  <dig> spectra. this simulation dataset was created using a computer model that incorporates the physical properties of maldi time-of-flight  ms  <cit> . given a list of peaks with mass-to-charge  values and abundances, this computer model produces a virtual spectrum. therefore, the true peak list corresponding to each generated spectrum is known. coombes et al. showed that the spectra simulated from this model reflect the important characteristics of real maldi-tof-ms spectra  <cit> .

RESULTS
performance assessment of the mapv model against the other peak models
using the first simulation dataset, we compared the mean percentage error in estimating the peak summit location between the gaussian, lorentz, bi-gaussian and the mapv models . hpso was used with all these models for peak fitting in order to make this comparison unbiased. the proposed mapv model showed an advantage over the other peak models when the peaks were asymmetric, delivering lower mean percentage errors which were  <dig> % to  <dig> % less than that of the other models. especially when the peaks were highly asymmetric , the benefit of the mapv model was quite evident as it estimated the peak summit locations with a mean percentage error of  <dig> %, in comparison with  <dig> %,  <dig> % and  <dig> % of gaussian, lorentz and bi-gaussian models respectively. however, when the peaks were symmetric, gaussian and lorentz functions delivered less mean percentage errors than the mapv model. the mean percentage error values delivered by the mapv model were  <dig> % to  <dig> % less than that of the bi-gaussian model. in ms peak detection, this difference in peak summit location estimation is practically important as it could lead to the misidentification of an isotope or a completely different bio-molecule. in many cases, mass accuracy of more than two decimal places is essential for identifying the underlying bio-molecule accurately. for example, the exact mass of purine  is  <dig>  mass units  and that of acetophenone  is  <dig> u. hence, their exact mass difference is  <dig> u  <cit> . moreover, two amino acids namely lysine  and glutamine  differ in exact mass by only  <dig> u  <cit> . in both these cases, at least a mass accuracy of up to  <dig> decimal places is required, in order to allow unambiguous assignment of molecular formula which aids in identification.

peak asymmetry
values are expressed as mean ± standard error .

secondly, we compared the mean percentage error in peak area quantification between the four peak models . compared to the other peak models, the mapv model yielded much smaller mean percentage errors of  <dig> %,  <dig> % and  <dig> % for symmetric , moderately asymmetric  and highly asymmetric  peaks respectively. these mean percentage error values were about  <dig> % less than that of its closest competitor - the bi-gaussian model. therefore, when the peak area estimation was considered, the proposed peak model outperformed all the other models in all scenarios. since the mapv model can represent gaussian, lorentz and bi-gaussian models individually as well as various combinations of them, it is obvious that it outperforms or at least equally performing as one of the three methods.

peak asymmetry
values are expressed as mean ± se.

the precise estimation of peak summit location and peak area are of high importance in order to identify the corresponding bio-molecules and to determine their abundances accurately. therefore, the above results validate the use of the mapv model for ms peak modelling.

comparison of the performance of the proposed algorithm against other peak detection algorithms
using the simulation datasets generated from the maldi-tof computer model, we performed a comparison between the proposed algorithm and two other widely used peak detection algorithms. the first benchmark algorithm uses cwt along with ridge lines for peak detection  <cit> . after a comprehensive study of various peak detection algorithms, yang et al. demonstrated the advantages of using this method  <cit> . the second benchmark algorithm, which is known as cromwell, is mainly based on udwt and signal to noise ratio of peaks  <cit> . it also has been widely used in ms peak detection. therefore, we selected these two algorithms as benchmarks in order to evaluate the performance of the proposed algorithm.

well established performance measures such as sensitivity, fdr and f1-score were used to evaluate and compare the performance of this new pipeline. we applied all three algorithms to  <dig> simulated spectra and calculated the above measures for each algorithm on each spectrum. the sensitivity is defined as the percentage of correctly identified peaks out of the total number of real peaks, whereas fdr is the percentage of incorrectly identified peaks out of the total number of identified peaks. the f1-score, which combines both sensitivity and fdr, is defined as follows  <cit> :

  f1-score=2×1-fdr×sensitivity1-fdr+sensitivity. 

in this comparison study, peaks that were located within ±1% error range of a known m/z value corresponding to a real peak were considered as true peaks. moreover, both algorithms need some parameters to be set. in this study, the parameter values recommended by yang et al. were used  <cit> .

for these simulated spectra, table  <dig> demonstrates that the performance of the proposed algorithm is better than the other benchmark methods in terms of sensitivity. it achieved a sensitivity of 85%, in comparison with 77% and 71% of cwt and cromwell methods respectively. the utilization of an additional step to decompose broad and highly asymmetric peaks improved the sensitivity of the proposed algorithm. in particular, it facilitates the identification of most of the peaks corresponding to the observed isotopologue distribution for any particular bio-molecule. isotopologues of an individual molecule vary only in terms of isotopic compositions. the peaks corresponding to isotopologues may have overlapping distributions to other molecules with very close mass causing the algorithm to detect a single highly asymmetric peak. such peaks need to be decomposed accurately to identify all of the isotopologues and to provide accurate measurements of peak areas. if not, the peak detection algorithms with symmetric peak models would fail to identify any of the peaks in the overlapping distribution. algorithms, which use asymmetric peak models, would detect only the highest abundant isotopologue, however, an inaccurate value would be given as its abundance.

values are expressed as mean ± se.

the problem of having overlapped peaks is quite common in data obtained through ms instruments with low resolving power. the modern instruments with high resolving power have the ability to distinguish all peaks in mass spectra from each other without generating overlapped peaks, thereby avoiding the need for peak decomposition  <cit> . however, the inability of most of the tof ms instruments to attain this level of resolving power, calls for efficient peak detection algorithms that address this issue.

when compared to the cwt method, a slight increase in fdr was observed in the proposed algorithm. therefore, we used the f1-score, which combines both sensitivity and fdr, to compare the performances of the three algorithms. the proposed new algorithm delivered the highest f1-score of 74% compared to 71% and 58% of the cwt and cromwell algorithms respectively. the  <dig> % difference in f1-score between the proposed algorithm and its closest competitor - the cwt method, was found to be statistically significant through a t-test . the scatter plots of sensitivity and fdr illustrate the complete behaviour of the three algorithms . the proposed algorithm appears to maintain a higher sensitivity in peak detection across all spectra. these results validate the use of the proposed peak detection algorithm in maldi-ms data analysis.

moreover, we observed that more than 42% of the false peaks detected by the proposed algorithm lie in the m/z range below  <dig>  which is the range affected by the baseline in this dataset. therefore, we suggest improving the proposed algorithm by incorporating advanced baseline removal techniques in order to reduce the fdr. the proposed algorithm took about  <dig> minutes to detect peaks in a mass spectrum containing around  <dig> peaks on average, on a windows  <dig>  operating system running on a core™i7- <dig> cpu at  <dig> ghz with  <dig> gb random access memory.

in order to reduce the computational overhead, some studies have proposed to incorporate the average spectrum of each dataset for peak detection  <cit> . therefore, we further evaluated the performance of the peak detection algorithms using the average spectra corresponding to the  <dig> simulated datasets. for this comparison, we used the previously selected two benchmark algorithms as well as another two recently proposed bayesian nonparametric models namely lark-hp  and lark-ma  proposed by house et al. for peak detection in maldi-tof-ms data  <cit> . these models need many parameters to be set. in this study, the parameter values recommended by house et al. were used and both algorithms were run for one hundred thousand iterations on each average spectrum  <cit> .

values are expressed as mean ± se.

dual-tree complex wavelet transformation  for spectra smoothing
as the threshold value at each level in the wavelet domain is determined using sure, the proposed spectra smoothing method does not require any parameter to be set by the user, thereby avoiding the additional overhead of customizing the method for different datasets. moreover, the noise in a mass spectrum decreases along the spectrum. hence the use of a global threshold value calculated using the entire spectrum can result in either over-smoothing or under-smoothing. figure  <dig> shows smoothing results obtained using two different threshold values. the smaller threshold value works well for the peaks at lower masses. however, it tends to under-smooth the peaks at higher masses. conversely, the larger threshold value yields better smoothing results for the peaks at higher masses while over-smoothing the peaks at lower masses. this problem could be reduced by dividing each spectrum into  <dig> equal segments and calculating the threshold values for each segment separately. figure  <dig> shows a spectrum smoothed using this method along with the corresponding baseline-corrected spectrum.

the modified asymmetric pseudo-voigt  function for modelling ms peaks
symmetric gaussian and lorentz functions have been used in the context of ms peak modelling. the voigt function combines both gaussian and lorentz functions using convolution operation. hence, it can be used to get the best from both these models. pseudo-voigt function, which is a close approximation to the conventional voigt function, uses a linear combination of gaussian and lorentz functions instead of convolution in order to reduce the computational overhead.

moreover, most of the existing studies use symmetric peak models assuming all the peaks in mass spectra to be symmetric. however, asymmetric peaks can also be observed in mass spectra  <cit> . figure  <dig> shows an example of a real maldi-tof mass spectrum containing asymmetric and overlapping peaks. this spectrum, which represents the serum protein profile of a colorectal cancer patient, was extracted from a dataset provided in alexandrov et al.  <cit> . the symmetric peak models produce inaccurate estimations for peak parameters of these asymmetric peaks.

the mapv model proposed in this paper has a characteristic shape  and it is not a black box model where there is no physical meaning to the parameters. there is an important application specific reason behind the introduction of each parameter to this model. for example, σ <dig> and σ <dig> were used instead of one σ parameter in order to account for asymmetric peaks and β <dig> and β <dig> parameters were introduced to the model to provide a better fit for peaks with different shapes. the proposed mapv model is different to the apv function used in the literature because unlike the latter the former can have different proportions of the lorentz and gaussian functions for the two halves of the peak. sometimes in mass spectra, peaks can be found in which one half of the peak can be modelled accurately using the gaussian function and the other half of the peak can be accurately modelled using the lorentz function. for such peaks, the mapv function provides a better fit as it can represent both gaussian and lorentz functions individually as well as various combinations of them. figure  <dig> shows an asymmetric peak in which the first half follows the gaussian shape and the second half follows the lorentzian shape. it can be clearly seen that the apv function has failed to provide an adequate fit for this peak, as it assumes the proportions of the gaussian and lorentz functions to be same for both halves of the peak. in contrast, the additional parameter has allowed the mapv model to provide a better fit for this asymmetric peak.

CONCLUSIONS
this paper presents a new peak detection and parameter estimation algorithm for maldi-ms data. it incorporates dt-cwt along with sure for spectra smoothing thus avoiding the overhead of customizing the method for different datasets by setting parameters. it also proposes the mapv model to fit ms peaks more accurately.

we have successfully applied the proposed unsupervised algorithm on ms data, generated from a maldi-tof computer model, to detect peaks and to estimate the peak parameters. in particular, it has been demonstrated that the proposed mapv model with an optimization algorithm is a promising method to model peaks in ms data, which aids in identifying underlying bio-molecules and determining their abundances accurately. the proposed algorithm has a potential advantage over the existing methods for low resolution ms data having overlapped peak distributions and asymmetric peaks, which is quite common in metabolomics and proteomics studies.

we believe that these results can be further improved by incorporating the available important details regarding the dataset under study. although we propose this algorithm for peak detection in maldi-ms data, we believe that it can also be used for data generated by other types of ms instruments such as lc-ms and seldi-ms. we also suggest improving the proposed algorithm to be used for peak detection in maldi-ims data, incorporating the additional information about the spatial distribution of bio-molecules generated by this technology.

appendix
appendix 1: stein's unbiased risk estimator 
let μ=μ <dig> μ <dig> …,μd be a parameter vector and x=x <dig> x <dig> …,xd be a measurement vector wherexi~nμi,σ <dig>  if h is an estimator of μ such thathx=x+g, g=gii=1d and g is weakly differentiable, sure is defined as follows  <cit> :

 sure=dσ2+||g2||+2σ2∑i=1d∂∂xigi, 

where ||·|| is the euclidean norm.

appendix 2: pseudocode of the hierarchical particle swarm optimization  algorithm
let n be the number of particles in the swarm and d be the dimensionality of the search space. moreover, suppose xi =  is the position of the ith particle, vi =  is its velocity vector, pi =  is its personal best position and pg =  is the best particle found so far. the pseudocode of the hpso algorithm is as follows  <cit> :

begin

   initialize the population

   while  do

      for 

         evaluate fitness

         update pid

         update pgd

         for 

            calculate vid

            update xid

         end for

      end for

   end while

end.

appendix 3: gaussian, lorentz and bi-gaussian functions
gaussian function
gaussian function has  <dig> parameters namely height of the peak , location of the peak summit  and standard deviation of the peak . when this function is used to model peaks in mass spectra, the intensity values of a peak can be modelled as a function of mass values  as follows:

 gm=h×e-lnm-ασ <dig>  

lorentz function
lorentz function has  <dig> parameters namely height of the peak , location of the peak summit  and standard deviation of the peak . when this function is used to model peaks in mass spectra, the intensity values of a peak can be modelled as a function of mass values  as follows:

 lm=h×11+m-ασ <dig>  

bi-gaussian function
bi-gaussian function has  <dig> parameters namely height of the peak , location of the peak summit , standard deviation of the first half of the peak  and that of the second half of the peak . when this function is used to model peaks in mass spectra, the intensity values of a peak can be modelled as a function of mass values  as follows:

 bm=h×e-lnm-ασ12;m<αh×e-ln2m-ασ22;m≥α. 

competing interests
the authors declare that they have no competing interests.

authors' contributions
cdw developed the methods, assessed the performance and drafted the manuscript. bab and ur offered the knowledge in mass spectrometry based biological research and contributed to design the study. is and skh provided assistance to improve the developed methods. all authors edited and approved the final manuscript.

supplementary material
additional file 1
supplementary information. this file contains detailed information about the simulation dataset used to evaluate the proposed mapv peak model.

click here for file

 acknowledgements
we gratefully acknowledge an anonymous reviewer for providing constructive comments to improve the manuscript. this work is partially funded by australian research council grant dp <dig>  cdw is fully funded by iprs and apa scholarships of the university of melbourne.

declarations
publication charges for this article have been jointly funded by the university of melbourne and metabolomics australia.

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2015: joint 26th genome informatics workshop and 14th international conference on bioinformatics: genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/16/s <dig> 
