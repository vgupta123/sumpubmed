BACKGROUND
proteomics is the large scale analysis of proteins in a biological system. it is a continuously and rapidly growing scientific area evolving together with the emergence of new methodologies and technologies. protein identification is commonly being performed by the so called "bottom-up" approach: proteins are converted to peptides, the sequences of which are then determined by tandem mass spectrometry , combined with the use of search engines and protein databases that are available in the internet  <cit> . this analysis is widely performed by the use of liquid chromatography-mass spectrometry . in a common implementation, a reversed-phase microcapillary lc system is coupled online with an electrospray ionization  tandem mass spectrometer. peptides eluting from the lc column are immediately ionized by esi and subjected to mass measurement . the instrument, under computer control, automatically selects specific precursor ions for fragmentation in a collision cell, thus generating collision-induced dissociation  and producing tandem mass spectra   <cit> . it should be noted that many diverse chromatographic separations can be serially applied  and connected to the mass spectrometer, providing the ability to identify and quantify hundreds to thousands of proteins in a single experiment  <cit> .

in the vast majority of computational biology aspects, the main challenges of lc-ms are handling, evaluating and visualizing the large data sets that are generated by the application of this technology. during a typical ms-based proteomics experiment, involving the analysis of protein fractions from cells, tissues or body fluids  <cit> , thousands of mass spectra are generated. the use of mean mass spectra that correspond to the chromatogram compounds reduces dramatically that number; nevertheless the problem of quick viewing and evaluating the whole of these spectra is not trivial.

this paper is organized as follows: the implementation section presents the software in more detail, by describing the main ideas and functionality that are incorporated in it. this is followed by the results section, which summarizes the capabilities of the software by means of an application example. a brief comparison of other similar software tools is also included here. general remarks and future work are mentioned in the discussion section. the final section of the paper contains a summary of the conclusions.

implementation
in this work, we present an application, which provides a fast and easy way to overview a complete chromatograph analysis. 'brukin2d' is a matlab based program, which was developed in order to visualize, evaluate, process and compare lc-ms data. it uses as input the compound data that are exported from the bruker 'dataanalysis' program, and depicts the mean mass spectra of all the chromatogram compounds from one lc-ms run, in one 2d contour plot. each spot in the plot represents one peptide mass. the spot's y-intercept determines the time of its compound in the chromatogram, while the x-intercept is the mass to charge ratio  of the corresponding peak. the darkness of the spots is proportional to the intensity of the mass peaks. two contour plots from different chromatograph runs can be overlapped in the same window and compared. the results of the comparison can be viewed  through detailed mass quantification tables and chromatogram compound statistics that are calculated during the procedure. in this communication, two protein mixtures are visualized and compared as an example of the main functionality features of this software tool.

'dataanalysis' is an application created by bruker daltonics, which captures, visualizes and can further process the data that are produced from a lc-esi-ms bruker instrument. some basic functionality features of 'dataanalysis' include viewing the chromatogram, normalizing it and finding its compounds. furthermore, it is capable of visualizing the ms or ms/ms spectra, removing the noise, deconvoluting the spectra and finding the mass peaks. data can be extracted from the application in different formats .

the 'brukin2d' code and graphical user interface were written and tested in matlab  <dig>  for windows xp 32bit and 64bit. the application , its manual and the supplementary files that will be used in the application example below, can be freely downloaded from our website  <cit> .

software description
the main window of the application is used in order to load the xml input files and plot the mass contours. the chromatogram and compound mass spectrum plots, along with the quantification data of the analysis are also provided here. the contour plots can be exported as image files. finally the dual view window can be opened in order to compare two mixes.

the main window consists of different panels . a short description of the functionality of these panels follows:

parsexml panel
this panel is used to import and select the compound mass spectra files that have been exported from the bruker 'dataanalysis' program in xml format. upon typing the file name and clicking on the parse xml button, the file is parsed and the contour plot is produced according to the inserted contour parameters .

contour parameters panel
each contour/density plot includes spots that correspond to mass peaks. each spot consists of ellipsoid patches, which are drawn one above the other. these patches correspond to specific intensity contour levels and their color gets darker as the intensity gets bigger. this panel contains all the parameters that need to be set prior to contour plotting. for example, it is possible to adjust the number of the contour levels and each one's intensity value, the correspondence of color with intensity, the smoothing or stretching of spots, which is useful in order to acquire a clear and easy to evaluate plot. a detailed description of these parameters is included in the software manual.

export panel
from this panel it is possible to export plots, complete or in parts, in jpeg or tiff format.

in addition, the main window incorporates three plot windows, which show the contour plot , the chromatogram of the selected analysis and the compound mass spectrum of the selected compound. the quantification table includes detailed information for each mass peak in the plot and the dual view window allows the comparison of two mixes. both can be accessed through the appropriate buttons in the main window.

we will discuss in more detail the functionality of the dual view window , since it provides a semi-automated way to compare two contour plots, and find the differences between the two chromatograph runs. after clicking the dual view button in the main window, a dialog panel opens in order to select two mixes from the parsed ones. when the selection is made, the dual view window opens. it contains the two contour plots, which are superimposed, as well as the chromatograms of the mixes. a problem in lc-ms is that between different chromatograph runs of even the same peptide mix, there may be slight differences in the compounds' elution times . in order to eliminate these time differences, it is possible to insert shift vectors manually, through the dual view window. the application can then automatically compare the two plots and find the similarities and differences between the mass peaks, as well as the chromatogram compounds. there are parameters that can be set in order to control the leniency of that matching process. the results can be viewed through assimilated quantification tables and bar figures.

RESULTS
application example
this example demonstrates the main functionalities of the 'brukin2d' program. two peptide samples were used, which consist of the same basic peptide mix, with the addition of another standard mix in the second sample. the two samples were analyzed using lc-ms. afterwards, the chromatogram compounds, their m/z spectra and the deconvolution data were calculated using the bruker 'dataanalysis' program. finally, the compound data were exported in xml format, and also the chromatogram data in mzxml format.

the first processing step is to parse/analyze the xml files. while parsing, the application produces the chromatogram plot and the 2d contour visualization, according to the parameters that were selected from the contour parameters panel. the same parameter values are used for both mixes. in detail, four contour levels are selected in the intensity values  <dig>   <dig>   <dig>   <dig>  since the previous intensity values are relatively low, the smoothing value is set to  <dig> , in order to acquire more rounded and consequently distinguishable peaks. furthermore, the appropriate checkbox is marked, for the visualization to include only the deconvoluted m/z peaks. this means that all isotopes and multiple charged peaks are added together, so that only single-charged isotopes are shown in the plot. when the procedure is finished, some basic information can be seen in the main window. the first mix has  <dig> mass peaks in all the compounds, while the second has  <dig>  in addition to the chromatogram and the contour plot, the mean mass spectrum of each compound can be seen by clicking in the appropriate compound in the chromatogram. this can also be done by clicking in the contour window, within the time borders of that compound.

the mass matching and comparison of these two mixes is done by opening the dual view window. it must be mentioned that in the dual view window, only the lowest intensity level of the two contour plots is shown, due to time and memory issues. so, it is suggested for every comparison analysis to have at least the same lowest contour level for both mixes. the first step in comparing two mass contours is to eliminate any time differences produced by the lc-ms procedure. this is done by using vertical shift vectors, which are applied manually in the dual view window. by zooming and inspecting the overlapping contours and their chromatograms below, compounds or masses that are actually the same in the two mixes but appear in slightly different times in the analysis can be found. after inserting the appropriate vectors, the two contours are shifted in order to see the resulted images. the shift vectors have a red to yellow direction, so the second  mix is the one that is actually shifted to match the first  one .

the next step, after shifting the contours, is to execute the peak matching procedure, during which, the application finds the matched peaks and creates combinatory quantification tables that give analytical information on each peak and its matched ones. the two parameters that have to be set here are the time and m/z leniency, which in the particular example were set to  <dig>  and  <dig>  respectively. these values actually define the maximum distances in the y  and x  axes that two matched peaks can have.

as is apparent in figure  <dig>  which shows the results of the matching process between the two mixes, many mass peaks from both mixes are not matched. this is surprising especially for the first mix, in which ideally most of the peaks should be matched to the corresponding peaks of the second mix, since they both contain the basic peptide mix.

the compound stats windows  can provide more information about the peaks that are matched per compound in each mix, along with the compound correspondence between the two mixes . the first two  windows show the actual number of peaks per compound that were matched in each mix. more useful are the other two plots, which show the percentage of peaks in every compound that were matched. in the first mix, the majority of the compounds have peaks that are matched to the second mix, as should be expected, but the matching percentage is pretty low and vary between 30–60%. the compounds that appear to be unmatched in the first mix are some low intensity compounds that exist in the beginning and the end of the chromatogram, and also in the time space that the added compounds appear in the second mix, which have much higher intensity. by examining the plot for the second mix, it can be noticed that almost two thirds of the compounds have matched peaks and their matching percentage is between 20–80%. the two white regions correspond to compounds 4– <dig> and 15– <dig>  these compounds have mass peaks that appear only in the second mix, so their origin is from the added peptide mix. the compound number correspondence between the two mixes is seen in the two lists. clicking in a line of those lists highlights the selected compounds in the two chromatogram windows of the dual view.

finally, the combinatory quantification tables can be seen by clicking on the results table button. the time values that appear in the quantification tables are the initial  values.

in this example, the peak matching procedure was repeated two more times by setting two different mass intensity minimums in the contour plots, in order to take into consideration only mass peaks with high intensity. this was done by returning to the main program window and refreshing the contour plots, in order to exclude mass peaks that had intensity lower than  <dig> and  <dig> each time. in the first case, the peaks that were left in the two mixes were  <dig> and  <dig>  and in the second case, only  <dig> and  <dig> peaks had intensity above  <dig>  after creating the new contours, the same shift vectors were used and the peak matching process was repeated. the results can be seen in figure  <dig> and figure  <dig> respectively. the black columns in the compound percentage plots represent compounds that had no mass peaks with intensity greater than the minimum. it can be noticed that by keeping only high intensity peaks, the matching results are better, meaning that the percentage of the matched peaks is raised. some slight differences in the compound correspondence between the first comparison and the other two are due to mass intensity differences that exist between same peaks of the two mixes .

comparison with equivalent tools
similar software applications to 'brukin2d' have been developed by other research groups. two of these applications are briefly discussed below. the first is 'pep3d'  <cit> , developed by the institute for systems biology, which displays lc-esi-ms data in a two-dimensional  density plot, similar to the 'brukin2d'. 'pep3d' provides further functionality by allowing users to display precursor ions selected for cid and peptides successfully identified in the ms analysis. the cid boxes and peptide boxes have embedded common gateway interface  links allowing display of the corresponding cid spectrum and its peptide identification  <cit> . 'ped3d' is available as part of the trans-proteomic pipeline , which is a collection of integrated tools for ms/ms proteomics. the main feature of 'ped3d' is the ability to include ms/ms data, acquired from sequest or peptideprophet, as annotations in the plot, and it lacks all functionality relevant to analyzing and comparing the mass peaks on the 2d plots. as such, 'brukin2d' and 'pep3d' can be considered and used as complementary applications. the second application is 'msight'  <cit> , developed by the proteome informatics group. 'msight' is a tool developed for the representation of mass spectra along with data from a separation step . the 'msight' interface and functionalities are based on the imagemaster 2d gel image analysis system. 'msight' handles data generated from many different mass spectrometers as well as generic data formats. ms/ms identifications can also be imported from the 'phenyx' tool  <cit> . this software provides plenty capabilities, like annotation of peaks in the plots, three-dimensional view of a region, alignment and superposition of different ms runs as well as warping of plots, based on manually inserted landmarks  <cit> . the functionality of 'brukin2d' is very similar to that of 'msight'. both applications visualize data in the same manner and provide the ability to superimpose ms runs and align them accordingly in order to eliminate known retention time errors from the chromatograph. two main advantages of 'msight' is the support for data acquired by many different instruments, including bruker daltonics, applied biosystems, waters and thermofinnigan, and the ability to incorporate ms/ms annotations into the plot, in a similar way to that of 'pep3d'. on the other side, mass peak identification and comparison is not yet supported by this application. these features will be introduced on the next version of the software, as mentioned on the 'msight' website. other relevant tools that must be mentioned are 'msinspect'  <cit>  and 'mzmine'  <cit> . a more detailed description of all the above applications can be found in veltri's work  <cit> .

while 'brukin2d' lacks the basic annotation functions of the aforementioned tools and it has been tested to work only with data exported from bruker 'dataanalysis', it provides a number of unique features to the user:  the chromatogram of an analysis can be imported and used in order to navigate among the different compounds.  zooming is fast and unrestricted with no loss of data.  besides warping and superimposing two plots, 'brukin2d' includes a procedure for automatic matching of two contour plots, and the ability to view statistics calculated from the matching process results. table  <dig> includes a summary of features that are supported by 'brukin2d', 'msight' and 'ped3d'.

*: according to the msight website, these features will be available in the second version of the application.

discussion
the major concern in lc-ms is coping with the amount, redundancy and diversity of the exported data. a long way is still ahead of us in order to find quick, automated and definite procedures to evaluate these data. better pre-processing and post-processing of data can lead to more reliable and meaningful results.

based on our experience, tools like 'brukin2d' appear to be valuable assets, when it comes to finding an easy way to evaluate lc-ms high-throughput data. experience of the user in lc-ms is a major issue and should be considered necessary at least for the time being. the utilization and feedback on these tools from experienced scientists will result in the improvement of the software, which strives to facilitate data interpretation in a biologically meaningful way.

future work
ongoing work and future plans include the extension of this application in order to be compatible with other lc-ms instrumentation software, primarily by making use of exported xml data, while considering the incorporation of support for native data files. furthermore, effort is being done to provide better annotation capabilities and implement an automated chromatogram aligning algorithm, so as to replace the manually inserted shift vectors and avoid errors that can infiltrate the procedure through incorrect observations. finally, rewriting the application in a more common programming language is considered in order to make the application more machine/software independent and less liable to memory issues, which for now pose a problem to the increasing number of plots that can be loaded into the application and compared.

CONCLUSIONS
in this project, we developed a toolkit for easy visualization of the results from a ls-ms analysis, by using a 2d contour plot. the appropriate application and gui for importing the ls-ms compound data from the bruker 'dataanalysis' program and plotting the contour with the desired parameters, were developed. in addition, the application incorporates the necessary tools in order to compare two contour plots, and consequently the corresponding peptide mixes from different chromatograph runs and find the differences in the compound mass spectra and the chromatograms. thus, 'brukin2d' can be used both as a visualization tool for lc-ms data and as a comparison tool, in order to find and evaluate in an easy and quick way the different mass peaks from multiple ms runs. contour plots can be customized through a variety of parameters, in order to include the desired data and achieve the desired level of detail. all contour plots and corresponding data can be exported in standard formats for further usage, along with results from the comparison process. the tool and its source code are freely available, as well as the sample data files and the application manual. ongoing work involves making the application instrument and os  independent.

availability and requirements
project name: brukin2d

project home page: 

operating system: cross-platform 

programming language: matlab  <dig> 

other requirements: none

license: license-free

any restrictions to use by non-academics: none

competing interests
the authors declare that they have no competing interests.

authors' contributions
mb and sk conceived and supervised the project. dt designed and implemented the software. sk, pz, gl, av and dt participated in the preparation of the manuscript. all authors have read and approved the final version of the manuscript.

