BACKGROUND
homology modeling that constructs a structural model of a “query” protein based on its similarity to a homologous protein with known 3-dimensional structure  remains the most reliable method of structure prediction. in most homology modeling methods, an essential step requires the input or construction of a pairwise sequence alignment between the query and the template, from which structurally equivalent residue pairs are deduced. pairwise alignment is also the foundation for most multiple sequence alignment  methods. for example, the progressive method for msa construction assembles a multiple sequence alignment by a series of pairwise alignments of sequences or pre-aligned groups  <cit> .

early methods of pairwise protein alignments apply dynamic programming algorithms that rely on general substitution matrices of amino acid residues and pre-defined gap penalties  <cit> . heuristic pairwise alignment tools such as blast  <cit>  excel in speed and are suitable for sequence database searches. numerical sequence profiles have been designed to incorporate information of homologous proteins to help aligning divergent sequences. psi-blast  <cit>  and hmmer  <cit>  are examples of sequence-profile comparison methods that are generally more accurate than methods of sequence-sequence comparison. the subsequent development of profile-profile comparison methods  further enhanced alignment quality and the ability to detect homologous relationships. in addition to amino acid sequence profiles, predicted structural information, e.g., secondary structure and solvent accessibility, was also included in various alignment methods . three-dimensional structure information has been used in alignment construction methods in various ways, such as those based on structure-dependent profiles  <cit>  and a monte carlo-based alignment method that samples a set of moves of gapless alignment stretches and scores based on a template contact map  <cit> .

despite continuous method development in the alignment field, obtaining high-quality alignments for distantly related proteins remains a challenge. alignment errors are still the main cause for the low quality of models built by homology. one common type of alignment error is the local misalignment, often by only a few residues, of secondary structure elements . such errors often reflect the periodic nature of regular secondary structures. for example, many α-helices can be shifted by three or four residues while still maintaining a similar pattern of hydrophobic residues and polar residues. therefore, one possible direction for refining an alignment lies in the generation of alignment variants by locally shifting secondary structure elements and evaluating the sequence and structure fitness of these alignment variants to determine which one is more likely to be correct.

here we describe the sfesa web server, which refines pairwise protein alignments by evaluating alignment variants resulting from locally shifting secondary structure elements. the sfesa web server enables researchers to compute, refine, and evaluate pairwise alignments with a combined sequence and structure scoring of alignment blocks. the previous version of sfesa required the upload of a predefined template structure. in contrast, the new web server allows for a template to be specified by its pdb and chain identifiers. furthermore, if no structure is provided, the sfesa server will search the database of sequences with experimentally determined 3d structures for the closest template, and this will then be used in the alignment refinement. the server facilitates further analysis of alignments at the level of secondary structure, providing detailed results of sequence and structure scores for local shifts of secondary structure elements. to our knowledge, the sfesa web server is the only online tool that refines alignments by evaluating local shifts of secondary structure elements.

implementation
overview of the sfesa alignment refinement method and procedure
recently we developed sfesa  <cit> , a method that refines pairwise protein sequence alignment by evaluating alignment variants generated from local shifts of secondary structure elements. sfesa first delineates alignment blocks from a starting pairwise protein alignment. each alignment block corresponds to a regular secondary structural element  in the template and the corresponding aligned region in the query. for each alignment block, sfesa generates a set of alignment variants by locally shifting query residues relative to template residues. then, both a profile-based sequence score and a contact-based structure score of the aligned residue pairs in the original alignment block and the alignment variants are calculated. we have shown that the best-scoring alignment variant has the highest probability of being correct, e.g., showing the best agreement with the structure-based alignment.

sfesa uses two local shifting strategies to generate alignment variants with different treatments of gaps in the original alignment block. in the first strategy, up to  <dig> alignment variants are generated by shifting query residues up to four positions left or right relative to the template while maintaining the gap pattern in the original alignment block. however, we observed that gaps rarely occur in the middle of secondary structure elements in structure-based alignments. therefore, in the second strategy, sfesa preprocesses the gap pattern in the original alignment block by eliminating gaps in the middle of the secondary structure elements. to achieve this, residues of an alignment block in both the query and template are shifted all the way to the left or right while all gaps are placed on the opposite side. two preprocessed alignment blocks are generated: one by shifting residues to the left and filling the right side with gaps and the other by shifting residues to the right and filling the left side with gaps. each of these two alignment variants is then used as a starting point to generate  <dig> additional alignment variants by ± <dig> shifts while keeping the modified gap patterns. this procedure gives rise to up to  <dig>  unique alignment variants .

for the sequence score, we use the profile-profile compass score  <cit> . sequence profiles are generated from psi-blast multiple sequence alignments  <cit> . for the structure score, we define residue contacts based on the structure of the template. a residue contact is defined as a residue pair within a distance cutoff. in the template of an alignment, the residue contacts can be identified using the known structure of the template. we then evaluate the contact energy of corresponding contact residue pairs in the query that are inferred from query-template alignment. for example, if residue i in the template makes contact with residues j, k, and m in the template structure , , and ), and the corresponding aligned residues for i, j, k, and m in the query are i’ , j’ , k’ , and m’ , respectively, then the inferred contact pairs in the query are , , and . the structure score for the aligned residue pair i and i’ is ce + ce + ce, reflecting the structural fitness of the inferred query contact residue pairs. here, ce is a matrix of the contact energy for residue pairs. we used two contact energy matrices: one is derived by miyazawa and jernigan  <cit>  with contacts defined as residue pairs with side chain centers less than  <dig>  Å, and the other is developed by us to best discriminate correct alignment variants from incorrect alignment variants . regarding our derived contact matrix, the cutoff for contact definition is  <dig>  Å between any side chain atoms of two residues.

in practice, the sfesa method uses a two-filter strategy to compare the scores of the original alignment block and the alignment variants and determines whether the original alignment block should be kept or changed to one of the alignment variants. the first filter checks if there are any alignment variants with a higher combined score i  than the original alignment block. if none of the alignment variants has a scomb_i higher than the original alignment block, sfesa rejects all the alignment variants and keeps the original alignment block. otherwise, the alignment variant with the highest scomb_i is selected and passed to the second filter. in the second filter, sfesa uses combined score ii  or an svm score  to compare the selected alignment variant and the original alignment block. if the selected alignment variant still has a higher scomb_ii or ssvm, sfesa will accept this alignment variant. otherwise, sfesa keeps the original alignment block. the weights of the sequence score and structure score in scomb_i and scomb_ii are optimized separately. ssvm is a score reported by a support vector machine  that was trained to differentiate correct alignment variants from incorrect alignment variants by using a number of features including a compass-based sequence score  <cit> , a contact-based structure score, a solvent accessibility score and a secondary structure score . the solvent accessibility score is based on a three-by-three relative solvent accessibility substitution matrix derived from fast  <cit>  structural alignments of scop  <cit>  domains. similarly, the secondary structure score is based on a three-by-three secondary structure substitution matrix derived from fast  <cit>  structural alignments of scop  <cit>  domains . the secondary structure is predicted by psipred  <cit>  for the query; the secondary structure information in dssp  <cit>  is used for the template. for each alignment block, starting from the n-terminus and proceeding to the c-terminus, sfesa decides whether to keep the original alignment block or to accept one of the alignment variants.

the sfesa web server
the sfesa web server is a tool for constructing, refining, and evaluating pairwise protein alignments . the workflow of the server is shown in fig.  <dig>  compared to the previously reported version of sfesa  <cit> , in which a user must provide a structure for the template sequence, the updated server will search against our inhouse protein structure database to find the closest  homolog with available 3d structure to improve the alignment.fig.  <dig> flowchart of the sfesa web server. the sequence that is found to be the closest to the provided structure or the structure database is assigned as the template . the other sequence is assigned as the query 



users can input or upload sequences for the query and template either as a pairwise alignment or as two unaligned sequences in fasta format. if two unaligned sequences are provided, the server uses promals  <cit>  to automatically construct a pairwise alignment. input of a 3-dimensional structure  with high sequence similarity to the template is optional but recommended. a user can input a pdb identifier and a chain identifier, instead of a coordinate set, to directly use the structure from the rcsb pdb database  <cit> . if no structure is provided for the template, the server uses blast  <cit>  to automatically search for homologs for either the query or template in a database of representative spatial structures and selects the best hit as the homologous structure, used as a template for structure score calculation.

four sfesa alignment refinement modes are available in the web server: sfesa  uses up to  <dig> variants generated by ± <dig> shifts that keep the gap patterns of the original alignment block and the miyazawa-jernigan   <cit>  contact matrix for structure score calculation; sfesa  uses up to  <dig> variants by considering gap shifts and the mj contact matrix; and sfesa   uses a newly derived contact matrix in addition to gap processing; sfesa  differs from sfesa  in that an svm-derived score is used in the second filtering step instead of scomb_ii.

several parameters are provided. one parameter is the sequence identity threshold between the template sequence and its homolog with a known 3d structure. sfesa refinement is applied only when the sequence identity between the template and its structure homolog is higher than the threshold . another parameter is the maximal number of residue positions to shift . increasing this parameter generates more alignment variants, but also increases the probability that a wrong variant is accepted. the third parameter is the threshold for the fraction of non-gapped residue pairs above which an alignment block is used in the refinement process . we also provide parameters for running and processing psi-blast  <cit>  results to generate the sequence profile used for the sequence score calculation, such as the number of iterations, the e-value inclusion cutoff, and a sequence identity cutoff to remove divergent hits.

the output page of the sfesa web server includes the starting alignment , the refined alignment, and the refinement details for each evaluated alignment block. figure 2a, b, and c shows one example of the output page. the first part of the output page  contains the starting alignment and the refined alignment with colored alignment blocks. psipred  <cit>  predicts secondary structure elements of the query and secondary structure elements of the template are based on palsse  <cit>  and dssp  <cit> . these predicted elements are shown above the query sequence and below the template sequence, respectively. evaluated alignment blocks are depicted in red and orange for α-helices and blue and dark green for β-strands to distinguish them. in the sfesa-refined alignment, the modified alignment blocks are marked with underscores.fig.  <dig> an example showing the output of the sfesa server and its ability to improve the alignment.  output of the starting alignment and sfesa-refined alignment with secondary structure and colored alignment block. predicted secondary structures for the query and the real secondary structures for the template are shown . “number” shows the position number of the residue above the query and below the template, respectively. “cm1” and “cm2” represent the positional differences between the refined alignment and starting alignment. “cm1” shows the sign of the query residue shifting  while “cm2” shows the query residue shift number. if the query residue is aligned to a gap in both the starting and refined alignments, “cm1” is left blank and “cm2” shows the gap character “-”. if the query residue is aligned to one residue in the starting alignment but aligned to a gap in the refined alignment, “cm1” is left blank and “cm2” shows “*”. if a template residue is aligned to a gap in the starting alignment, both “cm1” and “cm2” are left blank. α-helix alignment blocks are shown alternately in red and orange. β-strand alignment blocks are shown alternately in blue and dark green. the refined alignment blocks are marked with underscores.  a table summarizing refinement results for the evaluated alignment blocks. the alignment block number is ordered from n-terminus to c-terminus. the sixth column indicates the refinement results of this alignment block. if refined, a format of “gap mode ” is shown. rows of the refined alignment blocks are colored red.  one example of the scoring details of shifts for alignment block number  <dig>  this table contains the original alignment block and all alignment variants. the first column in the table is gap mode. there are three gap modes if there are gaps in this alignment block: original , left  and right . the second column is the shift number. the third column indicates if such a variant is a unique one or the same as a variant shown previously. the fourth column shows the alignment variants with extended residues in both ends. the residues in the original alignment block are colored blue  and pink . the last four columns show the sequence score, structure score, combined score i and combined score ii of each alignment variant. the row colored red corresponds to the alignment variant that is the final choice in the refined alignment. . structure superpositions of query structure models  and query real structure . structure models were generated by modeller based on the starting alignment  and the sfesa-refined alignment . the strand  in alignment block number  <dig> is highlighted. this strand is shown in red and green in the structure model and the real structure, respectively. blue spheres and yellow spheres mark the n-terminal boundary  and the c-terminal boundary , respectively



the second part of the output page  is a table summarizing the refinement results of the evaluated alignment blocks, numbered from the n-terminus to the c-terminus. each row in the table provides the element start and end position numbers in the template, the element secondary structure type, the original alignment block, the shift result, and the refined alignment block. the shift result column shows gap mode and shift number. gap mode can be “left” , “right” , or “original” . shift number  is the number of positions the residues in the query are shifted by, relative to the template. the “+” and “−” signs in shift number denote that the query residues in the alignment block are shifted towards the c-terminus or the n-terminus, respectively. if no alignment variant was accepted for an alignment block , “no shift” is shown in the shift result column and “-” is shown in the column of refined alignment block. the third part of the output page contains tables with scoring details for the alignment variants. a table is provided for each alignment block evaluated by sfesa and presents each alignment variant and its sequence score, structure score, and combined scores i and ii. figure 2c provides an example for alignment block number  <dig>  the residues in the original alignment block are colored blue and pink for the query and the template, respectively. the scoring details for alignment variants may help users manually evaluate and select alternative alignments.

RESULTS
test on the sabmark benchmark
we tested sfesa on the sabmark benchmark database of alignments  <cit> . the sabmark database has two alignment sets with different levels of sequence similarity and thus different levels of difficulty for alignment. the twilight zone set was created by selecting structurally similar domains at the scop  <cit>  fold level and contains sequences with very low to low similarity. the superfamilies set was created by selecting structurally similar domains at the scop superfamily level and contains sequences with low to intermediate similarity. we tested the ability of sfesa to refine alignments generated by several alignment methods, such as promals  <cit> , hhpred  <cit> , and cnfpred  <cit> . here hhpred was used in the global alignment mode because its local alignment mode often results in short alignments and shows lower alignment accuracy than global alignments.

we used the reference-dependent q-score as the assessment. the q-score is the fraction of correctly aligned residue pairs in a test alignment among all aligned residue pairs in a reference alignment. in this paper, the range of q-score values is from  <dig> to  <dig> .

sfesa can improve the promals q-score from  <dig> to  <dig> for the twilight zone set and from  <dig> to  <dig> for the superfamilies set . promals-based sfesa outperforms other advanced alignment methods, such as hhpred and cnfpred. in practice, sfesa  and sfesa  produced similar results that are on average better than sfesa  and sfesa . furthermore, sfesa also improves alignments generated by other methods , including hhpred and cnfpred.table  <dig> evaluation of alignment methods on the sabmark benchmark

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
average q-scores of two sabmark  <cit>  data sets  are shown. the q-score is the number of correctly aligned residue pairs in the test alignment divided by the total number of aligned residue pairs in the reference alignment. one pair of domains is selected randomly from each group in the sabmark sets. for each set, the number in the parentheses is the number of alignments tested. bold numbers indicate the best performance in the subsection



an example of an alignment improved by the sfesa server
in the example shown in fig.  <dig>  the input consisted of two scop domains, d1ja1a <dig>  and d2piaa <dig> , and the 3d structure of the template. sfesa used promals to obtain the starting alignment, which was refined to generate the refined alignment with the default option sfesa . out of the seven alignment blocks evaluated by sfesa, five alignment blocks were kept without shifts and two alignment blocks were modified according to sfesa refinement scores . both of these modified alignment blocks are in better agreement with the dali structural alignment  <cit>  of the query and the template compared to the original alignment blocks. we generated structure models for the query based on the starting alignment  and the refined alignment . both models  were superimposed upon the real structure of the query . the gdt-ts scores  <cit>  for models generated from the starting alignment and the refined alignment are  <dig>  and  <dig> , respectively. the query secondary structure element in the fourth evaluated alignment block is highlighted in both structure superpositions . this element, misaligned by two residues in the starting alignment , has been corrected in the refined alignment . as a result, the rmsd for this secondary structure element between the model and the real structure improved from  <dig>  Å for the model generated by the starting alignment to  <dig>  Å for the model generated by the refined alignment.

discussion
despite many significant research efforts, it is still challenging to correctly align weakly similar but homologous protein sequences. alignment errors remain the main reason for the poor quality of homology-based models. refining the alignments generated by automatic methods is a promising approach for increasing alignment quality. we found that secondary structure elements are often misaligned by only a few residues and that more accurate solutions can be identified within a limited set of local shifts of secondary structure elements. therefore, we developed the sfesa method in order to refine alignments by evaluating the alignment variants generated by local shifts of template-defined secondary structures.

in the sfesa scoring system, both a profile-based sequence score and a novel contact-based structure score of the aligned residue pairs in the original alignment block and the alignment variants are calculated. thus, an insufficient number of contacts can limit the quality of the alignment refinement. we found that structure scoring works well when there are sufficient contacts in the template as well as sufficient corresponding aligned residues in the query  <cit> . however, if a secondary structure element is involved in too few contacts , these contacts are insufficient to define a complete structural environment. sfesa is less effective in these cases. this observation suggests that dedicated efforts on misaligned blocks with insufficient contacts are required to improve alignments further.

CONCLUSIONS
sfesa is a web-based tool to compute, refine, and evaluate pairwise alignments with a combined sequence and structure scoring of alignment blocks. taking a pairwise alignment as input, the sfesa web server searches against an in-house database of protein spatial structures to find the closest homolog of either sequence. it then refines the pairwise alignment by combining the sequence profile similarity and residue-residue contact information that were obtained from the homolog with the structure. finally, it facilitates further analysis of the alignment results at the level of secondary structure, providing details about scoring for all shifts of secondary structure elements.

availability and requirements
project name: sfesa, a pairwise alignment refinement tool.

project home page:http://prodata.swmed.edu/sfesa.

operating system: platform independent.

programming language: perl.

other requirements: internet connection, a browser.

any restrictions to use by non-academics: none.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

jt, jp, and nvg designed and developed the algorithms and workflow. jt and jp designed the web server. jt performed the analysis and drafted the manuscript. nvg conceptualized and oversaw the development of the tool. all authors contributed in discussions and approved the final draft of the manuscript.

