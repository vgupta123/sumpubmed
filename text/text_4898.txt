BACKGROUND
a major challenge in evolutionary biology is to understand how natural selection acts on molecular genetic variation  <cit> . one approach to studying the consequences of selection at the genomic level is the application of genome scans that screen a collection of polymorphic genetic marker loci for their extent of differentiation between multiple  populations occupying ecologically distinct environments. loci or genomic regions displaying particularly high population differentiation  relative to some differentiation baseline  are interpreted as either being directly under divergent selection, or exhibiting genetic hitchhiking along with a quantitative trait locus  under divergent selection  <cit> . genome scans therefore have the potential to illuminate the link between ecological selection and molecular variation, and hence to contribute to our understanding of adaptive diversification. this is particularly true if information from genome scans is integrated with complementary lines of evidence such as qtl mapping  <cit> .

genome scans can be performed in different ways, depending on the genomic resources available for a focal research system. on the one hand, reference-free  scans are carried out without information on the physical genomic position of a marker locus. here the fst value for each locus is treated as an independent data point and is evaluated against a baseline distribution derived from the entire data set e.g.,  <cit> . loci exhibiting extreme fst values relative to the baseline  are then interpreted as being directly or indirectly influenced by divergent selection.  on the other hand, reference-based genome scans map loci physically to an available genome e.g.,  <cit> . this offers a great advantage: loci occurring in the same genomic neighbourhood, and consequently exhibiting some physical linkage, will tend to display correlated fst values that can be integrated by taking a sliding window approach. this allows not only the identification of genomic regions displaying exceptionally high population differentiation, but also exploring the number and physical extent of such regions  <cit> . moreover, depending on the marker resolution, outlier regions may be screened for candidate genes potentially targeted by divergent selection.

inferences drawn from both reference-free and reference-based genome scans obviously depend on the availability of reliable polymorphism data. the objective of our study is to highlight a potential problem with polymorphism data sets that can introduce bias to genome scans and lead to incorrect interpretations of genomic differentiation, or the lack thereof. the problem lies in fst being sensitive not only to the extent of genetic differentiation among populations, but also to the allele frequency distribution. specifically, very low fst values  at a polymorphic marker locus can arise for two different reasons: first, when the locus’ polymorphism involves alleles segregating at relatively even frequencies in both populations, but the frequency distribution of the alleles does not differ between the populations . for such a locus, inferring the absence of population differentiation would generally be reasonable.

other fst estimators produce qualitatively similar results), given informative and uninformative single nucleotide polymorphism at a marker locus .

second, a very low  fst value will also arise if the alleles at a marker locus exhibit an extremely skewed frequency distribution. that is, if a locus is nearly monomorphic in both populations but contains an alternative allele segregating at very low frequency such that this allele occurs only once or a few times in the entire data set . such a locus is constrained to display a very low fst value between the populations  <cit> . however, inferring the absence of population differentiation from this fst value is problematic. the reason is that such rare alleles primarily represent relatively recent mutations, most of which will experience rapid stochastic loss  <cit> . markers with a very low minor allele frequency therefore lack the adequate sensitivity to capture the historical signatures of drift and hitchhiking, the key processes in genome scans.

to illustrate this point, imagine that a novel qtl allele arises in the neighborhood of a nearly monomorphic marker. this qtl allele is unlikely to be linked to the rare allele at the marker. if the qtl allele is favored by selection and increases in frequency within the population where it arose, hitchhiking along with the qtl will produce only a very minor  allele frequency shift at the marker locus . population differentiation at the qtl will therefore not be visible at the linked marker. a clear signature of hitchhiking, however, will be seen if the marker displays a more balanced allele frequency distribution . a similar inconsistency in differentiation between selected qtl and associated markers with highly skewed allele frequency distribution also occurs in the situation where selection acts on standing variation .

of course, in addition to the situation where a natural allele segregates at very low frequency within populations, a highly skewed allele frequency distribution at a locus can also arise artificially during marker data acquisition. for instance due to pcr replication or sequencing error. the locus then produces a minimal fst value although correctly no fst value would be calculated because the locus is not polymorphic. however, many strategies exist to avoid such technical errors . our paper is therefore primarily concerned with biological polymorphisms.

to summarize, there are two fundamentally different causes for minimal fst values in genome scan data sets: polymorphisms with relatively even allele frequency distribution, but without population differentiation, versus polymorphisms with extremely skewed allele frequency distribution unable to pick up population differentiation. hereafter, we refer to these forms of polymorphisms as ‘informative’ versus ‘uninformative’. we emphasize, however, that we restrict this crude classification to genome scans searching for signatures of selection in the form of elevated differentiation. markers with highly skewed allele frequency distributions might well be informative in other analytical contexts, such as the estimation of mutational or demographic parameters based on allele frequency spectra  <cit> .

if uninformative polymorphisms are abundant in a marker data set used for a genome scan , we can predict a number of undesirable consequences: in both reference-free and reference-based approaches, the estimated overall baseline differentiation, which is considered to reflect the effect of drift, will be biased downward. as a consequence of this bias in the baseline, the number of loci considered outliers driven by divergent selection in reference-free genome scans may be inflated. by contrast, in sliding window type of scans, the magnitude of among-population differentiation in genomic regions influenced by selection will be weakened, or in the worst case erased. both effects can lead to incorrect conclusions about the genomic consequences of divergent selection. we emphasize that these problems will arise irrespective of the specific estimator used to quantify population differentiation, or the method chosen for outlier detection. that is, uninformative marker loci will also influence sophisticated methods that estimate fst for a locus by taking into account genome-wide differentiation and locus-specific sample size  <cit> , or approaches based on p-values from locus-specific significance tests .

it would thus seem straightforward to eliminate uninformative marker loci from polymorphism data sets prior to performing a genome scan, as reflected in beaumont and nichols’  <cit>  recommendation to preferably use loci with high heterozygosity for such analyses. however, a screen of  <dig> recent genome scan papers based on single nucleotide polymorphisms , including most such studies currently available, suggests that the above issue is not generally recognized.  only three studies report marker filtering according to some minor allele frequency threshold . it is therefore possible that patterns reported and conclusions drawn in many genome scan studies are unreliable to some extent. given that genome scans are becoming increasingly easy to perform owing to the advent of high-throughput sequencing technology  <cit> , new techniques for extensive snp discovery  sequencing  <cit> ), and automated data analysis pipelines, the problem of bias arising from uninformative marker loci deserves wide recognition. a first goal of our study is therefore to use extensive snp data from lake and stream population of stickleback fish to demonstrate that uninformative marker loci indeed have the potential to bias results from genome scans. our second goal is to show that such bias can be avoided through careful inspection of the data set and subsequent exclusion of uninformative marker loci based on empirical criteria.

methods
our study uses snp data from threespine stickleback  populations occurring in lake and stream habitats within two independently colonized drainages. the first is the lake constance drainage in switzerland , hereafter called the ‘constance system’. the divergence between the lake and stream population in this system appears to be recent . the second is the boot lake drainage on vancouver island, canada , hereafter called the ‘boot system’. lake-stream divergence in this system is more ancient . lake and stream stickleback are known to experience divergent selection  <cit> , and the specific population pairs were chosen because they differ in the magnitude of habitat-related phenotypic and neutral genetic  divergence . for further details on the locations and populations see  <cit> . all samples were taken with permission from the british columbia ministry of environment , and the fisheries authority of the canton thurgau.

for snp detection, we illumina-sequenced rad  <cit>  derived from  <dig> stickleback specimens from each of the four sites . library preparation essentially followed the method described in  <cit> . in short, dna was digested by using the sbf <dig> restriction enzyme and barcode-ligated for each individual separately. amplified barcoded dna was then single-end sequenced on an illumina genome analyzer iix with  <dig> cycles in libraries of  <dig> pooled individuals each. the illumina short reads  were parsed by individual barcode, and for each individual separately aligned to the stickleback genome  using novoalign v <dig> . <dig> . alignment to a unique genome position was enforced, effectively eliminating sequences derived from repeated elements. the average sequence coverage per individual and rad site was  <dig> and  <dig> for the lake and stream sample in the constance system, and  <dig> and  <dig> for the boot system. alignments were converted to bam format using samtools v <dig> . <dig>  <cit> . for each individual and rad site, we then determined the consensus diploid genotype if ten or more replicate reads were available, or a haploid consensus genotype if replication was below ten. this threshold was chosen because for polymorphic nucleotide positions, we identified heterozygote diploids based on a binomial test with insufficient power at low replication. this test involved calculating the binomial likelihood of the observed frequency distribution of the snp alleles under the null hypothesis of heterozygosity . positions were considered heterozygous if the likelihood was greater than  <dig> . consensus genotyping was quality-aware in that bases with a greater than  <dig>  calling error probability were excluded from the binomial test.

to find snp markers and calculate genome-wide lake-stream population differentiation within each of the two systems, we pooled individual consensus genotypes from the lake and stream sample for each rad site. if at least  <dig> genotypes were available from each of the two habitats, we proceeded with fst calculation. in other words, a rad site was considered only if each individual contributed at least one haploid consensus genotype on average to the site’s genotype pool. for fst calculation, the genotype pool for each rad site was screened base by base for polymorphisms. if a variable position occurred, we calculated fst based on haplotype diversity . for rad sites exhibiting multiple snps, we retained only the highest fst value observed across all variable base positions.  negative fst values were rounded to zero, as commonly done.

the above fst calculation considered any type of snps. to explore the effect of informative versus uninformative markers, we repeated the above fst calculation protocol by imposing the restriction that the minor  allele had to occur at least n times in the lake-stream genotype pool, where n spanned the range from two to ten in increments of one.  for each calculation series, we then computed the number of resulting snps, and the mean fst value across all snps. we also visualized genomic differentiation by a sliding window approach using local polynomial fitting  implemented in r . all post-sequencing analysis except for alignment and file conversion was coded in the r language, making use of the bioconductor packages shortread  <cit> , biostrings, and rsamtools.

RESULTS
in both the constance and boot stickleback population pair, raising the threshold for the minimal required count of the minor snp allele  had a dramatic influence on the number of polymorphic marker loci available for fst calculation. most strikingly, the number of snps dropped by  <dig> %  and 34%  in the constance and boot system when singleton loci were excluded by setting n to two . increasing n from two to ten, however, had a relatively minor effect on the number of polymorphic loci. our stickleback data sets thus exhibit a very high proportion of singleton loci, as generally found in empirical studies . the genomic location of these singleton loci did not show any systematic association with chromosome position .

including these uninformative marker loci in the genome scan led to the consequences predicted above. first, baseline differentiation was substantially lower than the differentiation obtained when setting n to two or greater . for instance, genome-wide fst increased by 17% and 20% in the constance and boot system when raising n from one to two. in absolute terms, this shift was more dramatic in the boot system displaying the higher overall differentiation between the populations. second, fst profiles obtained from sliding window analyses including all markers  were strikingly flatter than those from analyses excluding uninformative polymorphisms. these two consequences are visualized for a segment of chromosome seven , which is representative of what we found throughout the genome. for that specific genomic region, analyses with and without uninformative marker loci might lead to qualitatively different conclusions about the magnitude and physical extent of population differentiation. for example, in the constance system, a large segment ranging approximately from 12– <dig> mb displays elevated differentiation, as revealed when using informative markers only. this differentiation is certainly substantial, given the low baseline differentiation in that young system , and might indicate ongoing divergent selection in that genomic region. nevertheless, elevated differentiation within that region would probably not be recognized when tolerating uninformative markers in the sliding window analysis.

note that in figure  <dig>  we define informative marker loci as those with the minor allele occurring at least four times , resulting in an average inter-locus distance of 53 kb and 63 kb for the constance and boot system. this minor allele threshold eliminated bias associated with uninformative marker loci relatively effectively; choosing higher thresholds had a relatively minor influence on the sliding window profiles.

discussion
our empirical analysis demonstrates that abundant uninformative polymorphisms in a genome scan data set can bias the estimated baseline differentiation, and hence affect conclusions about the genomic signatures of selection.

in our stickleback data set, uninformative polymorphisms  were very abundant. illumina sequencing type one errors  in rad sequences poorly replicated at the individual level might contribute to this pattern  <cit> . to examine this possibility, we inspected  <dig> randomly chosen snps exhibiting zero fst from the full data set accepting any type of polymorphisms  for each lake-stream system. as expected, a high proportion of these markers were singleton loci . for the boot system with lower replication per locus in the stream sample ,  <dig> of the  <dig> singleton loci represented unreplicated rad sequences. for these loci, the minor allele is likely a sequencing error.

however, all but one of the singleton alleles in the constance system represented consensus genotypes integrating multiple  replicate rad sequences. hence, the bulk of the uninformative marker loci in our data clearly cannot be attributed to sequencing error, because the probability of multiple identical errors at a specific nucleotide position at a given rad site is practically zero. the abundance of rare snp alleles therefore represents a real biological feature of the studied stickleback populations . this is not unexpected: theory consistently predicts a skew toward polymorphisms with low minor allele frequency, and hence a high proportion of singleton polymorphisms, under a broad range of demographic and selective conditions  <cit> . bias associated with uninformative polymorphisms is therefore of general importance to genome scan studies, and not specific to our empirical system. our analysis also raises a caveat regarding marker densities; the effective number of markers providing relevant information in genome scans might often be dramatically lower than the number reported.

in the present study, excluding singleton polymorphisms had the greatest influence on the results. reliable quantification of differentiation patterns, however, might require substantially more stringent minor allele frequency thresholds.  bradbury et al. <cit> , for instance, excluded snps exhibiting an overall minor allele frequency of  <dig>  or less, and a similar threshold was adopted in a recent lake-stream stickleback study carried out in our lab  <cit> . to obtain a guideline for marker filtering, the latter rad-based study evaluated the strength of the correlation in fst values between ‘sister’ rad sites  in relation to increasingly stringent minor allele frequency thresholds . the rationale was that if an fst value provided by a given marker reliably quantifies the consequences of drift and selection in a genomic region, then another extremely tightly linked marker should yield a similar fst value. this approach, however, requires tightly physically linked markers data and substantial population differentiation .

CONCLUSIONS
given the rapidly increasing feasibility and popularity of genome scans for signatures of selection, researchers should be aware that uninformative polymorphisms need to be excluded from data sets. this is not achieved by just avoiding technical errors, as a high prevalence of nearly monomorphic loci is a general biological feature of samples from natural populations. we suggest that a reasonable strategy to define and eliminate uninformative polymorphisms should be chosen by inspecting the allele frequency distribution of the polymorphisms, and by assessing the influence of different marker filtering thresholds on the genomic patterns of interest, or appropriate statistics . also, the approach taken to eliminate uninformative polymorphisms should be reported explicitly. together, this should increase the quality and comparability of genome scans, and hence promote our understanding of the processes shaping genomic differentiation.

competing interest
the authors declare no competing interest.

authors’ contributions
db and mr conceived the study; ws provided materials and infrastructure; mr and db generated the sequence data; db and mr analyzed the data; db wrote the paper, with input from mr and ws. all authors read and approved the final manuscript.

acknowledgment
field work was aided by anne-catherine grandchamp and, for the boot system, supported financially by andrew hendry. roman kistler  permitted sampling of the constance specimens. paul etter and bill cresko kindly shared their experience and protocol for rad library preparation. brigitte aeschbach and nicolas boileau facilitated wet lab work, ina nissen performed illumina sequencing at the quantitative genomics facility, d-bsse, eth zürich, and lukas zimmermann provided it support. the bioinformatics pipeline benefited from modifications to novoalign by colin hercus, and from coding suggestions by martin morgan and hervé pagès. matthieu foll, markus pfenninger, and three anonymous reviewers provided valuable suggestions that improved the paper. ws was supported financially by the european research council , the swiss national science foundation, and the university of basel. db was supported by the swiss national science foundation  and the research found of the university of basel. we kindly thank all these people and institutions.
