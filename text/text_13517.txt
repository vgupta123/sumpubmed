BACKGROUND
the overwhelming amount of molecular data generated by the sequencing of whole genomes and est libraries has triggered the development of numerous sequence comparison algorithms, aimed at detecting related sequences and at quantifying this relatedness. blast  <cit> , fasta  <cit>  and other related algorithm are arguably the most popular programs for sequence comparison. these algorithms rely on the local alignment of the sequences under scrutiny and assume conservation of contiguity between homologous segments. this assumption, however, is often violated. discontinuity can occur, for example, when spliced transcripts are matched to genomic sequences, when ests or cdnas from different splice variants are compared or when genomic sequences are aligned that have undergone genome shuffling. other alignment-based algorithms that do not assume conservation of contiguity, such as blat  <cit>  or sim <dig>  <cit> , can compute scores, percentage similarity, but do not assess statistical significance.

several types of alignment-free sequence comparison algorithms, reviewed in  <cit> , can circumvent this problem. among these alignment-free methods, techniques based on the number of k-words shared between two sequences, also known as the d <dig> statistic, are particularly noteworthy due to the speed of their implementation, their sensitivity and selectivity  <cit> . they have been extensively used to structure large collections of ests into clusters of similar sequences  <cit> .

the rigorous study of the statistical distribution of d <dig> began with the computation of bounds of d <dig> variance and the characterization of asymptotic distributional regimes  <cit> . these results have been refined in a recent study  <cit> . other studies  <cit>  have focussed on a generalization of d <dig>  the number of approximate k-word matches between two sequences, , where t is the number of mismatches per word. bounds on thevariance and asymptotic distribution of  have been determined  <cit> .

the current paper summarizes the theoretical knowledge on the distribution of d <dig> and . the optimal word sizes of these statistics in a variety of conditions were computed, and the distributional regimes at optimal word size were deduced. finally, the accuracy of  as a measure of sequence similarity was compared with other measures using random sequences and sequences evolved from human genomic dna.

RESULTS
word matches measures
exact matches
the theory developed for the number of exact word matches between two sequences is widely applicable to any kind of sequence with the only constraint that these are made of independent and identically distributed  letters. given an alphabet  of d letters, let a = a1a <dig> ⋯ an be a sequence of n i.i.d. letters of . let fa be the probability of a letter taking the value a, and pk = .

d <dig> is defined as the number of k-words matches between two sequences a and b, and can be expressed



where y is the k-word match indicator variable starting at position i in a and j in b, and the index set is

i = { :  <dig> ≤ i ≤ ,  <dig> ≤ j }

where, for convenience,  and  are written  and  respectively.

d <dig> can also be thought of as an inner product of the word count vectors. let  = {w <dig>  w <dig>  ⋯, wn} be the set of all k-words on . for w ∈ , let  be the number of times the letter w appears in sequence a. the count vector for that sequence is . d <dig> can thus also be expressed as



the mean of d <dig> can be easily computed 



when the letters of the alphabet are uniformly distributed, that is, fa = , for all a ∈ a.



lower and upper bounds for the variance of d <dig> were computed in  <cit> , and an exact formula for the variance in the case of uniform letter distribution was given in  <cit> . limiting distributions of d <dig> when n and k get large were derived in  <cit> , namely  when k/n >  <dig>  and e is not too small, d <dig> has a compound poisson  <cit>  asymptotic behaviour, and  when k/n < 1/ <dig>  and the letter distribution is non-uniform, d <dig> has a normal asymptotic behaviour. numerical simulations in  <cit>  showed that these theoretical bounds are not tight. the uniform letter distribution case was studied in  <cit> , where it was proved that, for large enough k, the d <dig> statistic is approximately normal as n gets large.

approximate matches
the theory for the number of approximate matches between two sequences has been developed in the more restricted framework of strand symmetric bernoulli text  <cit> . in this framework, the letters are i.i.d. with frequencies





where η is the perturbation parameter, with - <dig> ≥ η ≥  <dig>  the distance between two words x and y of length k is defined as the number of character mismatches between x and y and is written δ. when δ ≥ t, x is said to be a t-neighbour of y. if a is a strand symmetric bernoulli text and w is a known word of the same length, n, as a, then the probability distribution of the distance δ is:

pr = t) =gt

where gt is a perturbed binomial distribution  <cit> , c is the gc count in w and η is the perturbation parameter of a. the cumulative distribution function of the distance is then



the  statistic is defined to be the number of t-neighbours of k-words between sequences a and b, and can be expressed as



where  is the indicator variable of t-neighbourhood for the k-words starting at position i in a and j in b. the expectation of  can be expressed in terms of the perturbed binomial distribution  <cit> 



upper and lower bounds for the variance of  were computed in  <cit> , and the following limit deduced: for large n,  is asymptotically normal when k = α + c where  <dig> ≥ α < and c is a constant. when t =  <dig>  this result is an improvement on the α = 1/ <dig> result for perfect matches  <cit>  reported above. numerical simulations in  <cit>  suggest that this asymptotic behaviour occurs for α as high as  <dig> 

the results of the numerical simulations comparing the distribution of  to a normal distribution, for various word sizes, sequences sizes and number of mismatches, in the case of non-uniform letters distribution, are shown in figure  <dig>  similar tables comparing d <dig> to the normal and compound poisson distribution, in the case of exact word matches, for uniform and non-uniform letters distribution, can be found in  <cit> .

optimal word sizes
our first goal is to characterize the distribution regime of  when the word size is optimal. we write  the optimal word size for sequences of size n and t mismatches. numerical simulations were carried out to determine  for various sequence lengths n = 2x ×  <dig> with x =  <dig>   <dig>   <dig>   <dig>   <dig>  and for different numbers of mismatches t =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  a summary of these simulations is given in table  <dig> and the detailed simulation results can be found in additional files  <dig> to  <dig>  sequences with a non-uniform letter distribution were used, with nucleotide frequencies fa = ft = , fg = fc = . similar compositional biases are observed in several sequenced genomes, such as the honey bee apis mellifera, the roundworm caenorhabditis elegans or the zebra fish danio rerio. the optimal word size was also computed in the uniform case for t =  <dig>   <dig>  with very similar outcomes. we will therefore focus our discussion on the non-uniform case.

regardless of the number of mismatches, the optimal word size is quite stable when the lengths of the sequences vary across the range of sizes under consideration. we only noticed a slight decrease in  for sequences smaller than  <dig> letters . the behaviour of , however, can traverse different distribution regimes when the sequence length varies and the word size is fixed.

when our data for perfect word matches are compared to tables  <dig> and  <dig> in  <cit> , it appears that the distribution of d <dig> at optimal word size is approximately a compound poisson distribution when sequences are  <dig> letters long or smaller, and is approximately normal when sequences lengths are larger than  <dig> letters.

in the case of approximate word matches, it can be extrapolated from figure  <dig> that the distribution of  becomes normal for sequences larger than  <dig> letters. the approximate behaviour of , when t >  <dig> and k/n >  <dig>  however, is unknown. the distribution regime of  at optimal word size for smaller sequences could therefore not be characterized.

accuracy of  measures
a previous study  <cit>  compared the accuracy of various dissimilarity measures based on the number of words shared between  <dig> sequences. these authors give the values of the spearman's rank statistic, a , obtained with these measures and compare them with that obtained using either blast or the hamming distance. similarly, we compared the efficiency of  for different numbers of mismatches, t =  <dig> ,  <dig>   <dig>   <dig>   <dig> . we used the same sequence size  as inthe above-cited study so as to allow comparison of the performance of  with the measures assessed in that study. a for blast was computed based on the bit scores obtained with the default settings.

overall, the  measures provide an accuracy similar to the dissimilarity measures computed in  <cit> , with log  ranging from  <dig>  to  <dig> . this is better than blast whose log  is close to  <dig> . it is noteworthy that, at optimal word size, the  statistic gives better results when the number of mismatches allowed per word increases.

application to non-iid sequences
in real biological sequences, letters are not independent and identically distributed. to test the applicability of our results to biological sequences, we conducted similar simulations, but instead of randomly generated sequences of known composition, we used sequences sampled from the human genome and made them evolve according to the k <dig>  <cit>  model of nucleotide substitutions. the results are summarized in additional file  <dig>  these results are quite encouraging in many respects. first, the optimal word sizes for these sequences are the same as or very close to the ones predicted with random sequences in the previous sections. the values of log  for near-optimum word sizes are lower than those computed previously, suggesting that similarity measures based on word counts may be more accurate on real sequences than on randomly generated sequences. finally, the accuracy of the  measures near optimal word size are consistently better than blast bit scores obtained with the default settings.

CONCLUSIONS
the  statistic has different distribution regimes depending on the word size k, the sequences lengths n, the number of mismatches t and the sequence composition fatgc. we computed the optimal word size for various combinations of these parameters that influence the distribution of . for sequences smaller than  <dig> letters and when no mismatches are allowed, the distribution of  is close to a compound poisson. in the case of sequence larger than  <dig> letters, the distribution of  is approximately normal. when estimating the significance of sequence similarity using  at its optimal word size, the null distribution would thus have to be adjusted according to the size of the sequences. it is worth noting that the size of typical ests or whole genome shotgun sequencing traces  is in the transition region between these two limiting distributions.

we have also shown that the accuracy of the  statistic is similar to that of other similarity measures based on the number of words shared between two sequences. in particular, allowing for mismatches between words increases the accuracy of the . this improvement, however, comes at a high computation cost. the algorithmic complexity of  is o, when t =  <dig>  however, when t >  <dig>  the worst case complexity is o. in our simulations,  was more accurate than blast . we expect this difference to be accentuated on real sequences where shuffling and transposition occurs, breaking the contiguity generally assumed by alignment-based sequence comparison algorithms.

the assumption of i.i.d. distributed letters made to ease the characterization of the  distribution may not hold in real sequences. this may have an impact on the assessment of the statistical significance of the number of words shared between two sequences. the optimal word sizes computed in this study, however, seem to be valid for real sequences evolved under a relatively realistic model of nucleotides substitution.

taken together, the statistical theory, the algorithmic complexity and the simulation results suggest that the best application of the  statistics would be the identification of similarities between large genomic sequences using exact word matches. comparison of such sequences using alignment-based methods is computationally expensive, since these algorithms typically have a o complexity, hence the development of heuristics speeding up these comparisons, such as blat  <cit>  or megablast  <cit> . the linear ) nature of the  algorithm and the normal asymptotic behavior of , when sequences are large compared to word size, would allow sequence similarity to be assessed in a rigorous statistical framework, with significant improvement in run time.

finally, the known asymptotic behavior of the  statistic could be used to improve the assessment of significant matches during the initial  stage of existing alignment algorithms such as blast or blat.

the use of  in the context of biological sequences is not limited to the sequence comparison discussed in this paper. it has been proposed that it could be used to choose discriminative microarray probes  <cit> . other possible applications may include the detection of transcription factor binding sites, micrornas and dsrna targets.

