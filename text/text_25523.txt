BACKGROUND
reverse genetics tries to unravel gene function by the examination of phenotypic effects after a gene perturbation. the rationale behind this approach is that the perturbation of genes involved in the same cellular function are likely to produce similar phenotypes. rna interference techniques made reverse genetics an effective and cost-efficient approach. the traditional phenotypic characterization by macroscopic traits  is complemented by traits obtained at the molecular level . phenotyping of cell morphologies has been introduced as an intermediate description level which attempts to combine the advantages of both macroscopic and microscopic description levels, namely interpretability respectively high information content.

for the analysis of microscopic images, single cell images are converted into a vector of 10– <dig> morphological descriptors  <cit> . these morphological descriptors are sufficiently rich to distinguish various physiological states of a cell, such as mitotic and apoptotic phases  <cit> . the purpose of these methods is the clustering of cells into meaningful, phenotypically distinct classes  <cit> . time-lapse imaging enhances the discrimination of phenotype classes by generating a dynamic view on the morphological changes, yet introduces another layer of data complexity. the amount of data generated by high-throughput microscopy requires automated analysis methods for reasons of objectivity, reliability and efficiency. several supervised methods have been proposed in this context. cell nuclei were classified to mitotic phases using a support vector machine  <cit>  and afterwards a finite state machine  <cit>  or an hmm is used to correct for improbable transitions between the respective phases  <cit> .

supervised methods depend on training data that has been labelled by an expert. they are incapable of discovering new, previously unseen phenotypes. manual training is time consuming, depends largely on the biological knowledge and experience of the expert, and has to be repeated with each change of experimental conditions. this hampers the application of supervised methods to high throughput rnai screens in which a large, unknown phenotypic variability is expected. it has been shown recently that unsupervised methods can accurately cluster cells in time-lapse movies to mitotic phases using an appropriate initialization to cell cycle phases and an hmm with multivariate gaussian emission probabilities  <cit> .

we followed this line of investigation and provide a method that automatically extracts interesting phenotypes from rnai movies. our method is sensitive and efficient enough to screen hundreds of movies. apart from being able to identify known cell cycle states, we discover a representative selection of phenotypic states characterising abnormal cell morphologies. the abnormal cells of a given knockdown define a typical profile, which we use as a fingerprint for comparing different knockdowns. we find that replicate movies have similar fingerprints and that knockdowns having similar fingerprints are known to function in common pathways.

RESULTS
hmm phenotyping annotates time-lapse perturbation movies
we used time-lapse movies from the public mitocheck database  <cit>  for high throughput phenotyping. these movies were created using sirna microarrays. the cells on the microarray spots were transfected by sirna and are expressing green fluorescent protein - tagged histone 2b proteins, which mark the chromatin in the nucleus. they were incubated with the sirna for  <dig> hours and afterwards tracked for  <dig> hours by fluorescence imaging. every plate had  <dig> spots with negative controls. every gene in the mitocheck database was targeted by at least  <dig> different sirnas on  <dig> spots. mitocheck contains an enormous number of movies , with an average of initially  <dig>  cells per spot  <cit> . a comprehensive analysis of all movies is extremely time-consuming, even for efficient methods. for the scope of this paper, we therefore pre-selected  <dig> movies of  <dig> distinct gene knockdowns with an increased chance of exhibiting cell-cycle related phenotypic aberrations. among these  <dig> genes,  <dig> were known to show morphological aberrations  <cit> ,  <dig> were cell cycle associated genes, and  <dig> were tumour suppressor genes, furthermore we added  <dig> genes that were selected at random from all genes in the mitocheck database.

the open source software cellprofiler  <dig>  was used for quantitative image processing  <cit> . cellprofiler provides methods for the detection, segmentation and tracking of cells, and it calculates about  <dig> morphological features for each single cell . we realized that the cellprofiler watershed algorithm for cell segmentation had a tendency to erroneously split nuclei. we therefore implemented a cell profiler plugin for segmentation correction according to  <cit> , which can be downloaded from the accompanying website http://www.treschgroup.de/movieanalysis.html. principal component analysis was applied to reduce noise and to decorrelate the features . as the cells did not move substantially from one frame to another, the standard cellprofiler nearest neighbour tracker yielded good results .

the desired grouping of cells into phenotype classes can be achieved by clustering the corresponding feature vectors. since our feature vectors are high dimensional with correlated numeric entries, a clustering based on a multivariate gaussian mixture model would be an option. however, one would neglect the longitudinal structure of the data obtained from cell trajectories. we decided to use hidden markov models with multivariate gaussian emission distributions for phenotyping . hmms are a natural generalization of mixture models, which account for the time dependence of the observations.

an appropriate initialisation of the gaussian distributions is important to ensure a good fit of the model to the data. many changes in the cell phenotype are cell cycle related. additionally, abnormal phenotypes tend to arise at certain stages of the cell cycle. therefore, we chose a cell cycle dependent initialization. we assigned a relative cell cycle time to every cell nucleus in the trajectory . the cell cycle was then equipartitioned into  <dig> intervals, and the parameters of a gaussian distribution were learned from the feature vectors in every interval by maximum likelihood estimation. although cell cycle phases differ in their lengths, we chose equidistant intervals in order to ensure an unbiased initialisation. the learning of the hmm was done by the baum-welch algorithm . each cell was then assigned a phenotype class using the viterbi algorithm . a principal component analysis  of the means of the phenotype classes helps to assess their similarity and to tune the number of classes in the model , which we set to  <dig> 

by definition abnormal phenotypes only occur in knockdowns, but not in the wild type. knockdown movies were therefore always compared to negative controls . knockdowns and negative controls were selected from identical plates to account for plate-to-plate variance. cells from the knockdown and at least  <dig> adjacent negative controls were pooled for the training of the hmm . this ensures that the variety of morphologies in the regular cell cycle is properly reflected by the states of the hmm. knockdown-specific  states  were identified by counting their occurrence in the trajectories of knockdown cells and in the trajectories of wild-type cells. afterwards a fixed threshold  was applied to decide whether a state was almost exclusively found in the knockdown and hence called abnormal .

hmm phenotyping extracts static and dynamic characteristics of a knockdown
the hmm can be seen as a data compression method, which summarizes the morphologies through discrete phenotype classes  and the dynamics of the cell trajectories through a transition matrix. on top of the class annotation provided by a gaussian mixture model , the hmm performs a smoothing of the class annotations along a cell trajectory. we compared the learning performance of an hmm with that of a gmm. by visual inspection, the viterbi path annotation of the hmm are more consistent . quantitatively, we compared the hmm and gmm likelihood of ten previously unseen cell trajectories after training by sequences of the same movie. the hmm consistently outperformed the gmm in all ten cases, indicating that accounting for time dependence is advantageous .

based on the hmm parameters and the class annotation of each cell, we derive informative descriptors that characterize cell behaviour. a plot of the viterbi path for every cell trajectory provides a visualisation of the phenotypic changes of a cell over time. it is, e.g., evident that the viterbi paths of the plk <dig> knockdown  differ a lot from the viterbi paths of the negative control . by quantifying the relative abundances of phenotype classes in the plk <dig> knockdown and in the negative control, the green, blue and red classes appear to be knockdown related, as they are virtually absent in the control .

besides static phenotypes, the dynamic behaviour of the phenotype classes can be analysed. the distribution of phenotype classes along the cell cycle identifies cell cycle related phenotypes. for the wild type movie two classes are clearly associated with the cell cycle: the red class peaks at the beginning of the cell cycle and the turquoise class peaks at the end of the cell cycle . from the overlay of the cell image trajectories with their phenotype class annotation, it is obvious that the turquoise and red classes represent the mitotic phase and growth phase, respectively . the remaining classes also show certain cell cycle time specificity, which however is less pronounced .

the hmm transition matrix contains the transition probabilities between phenotype classes. as such, it provides information about phenotype dynamics. e.g., the transition probability from the mitotic state to the growth state is particularly large, which is in accordance with our expectations . notably, the first upper diagonal in the transition matrix contains, apart from the main diagonal, the largest entries. this supports the hypothesis that cells pass through a specific sequence of phenotypes during the cell cycle. the median holding time, i.e. the median time a cell stays in a certain phenotype class before changing to another specific phenotype class shows that the cells only spend a short time in the mitosis class, but remain a long time in the growth- and synthesis phase .

the green and blue knockdown-specific states in the plk <dig> knockdown are also cell cycle related. both their state frequencies increase with cell cycle time . this corresponds to the fact that plk <dig> has a role in mitotic spindle assembly during cell division and is therefore expected to show a mitotic effect  <cit> . the biological interpretation of a phenotype class is facilitated by the inspection of a representative cell sample of that class. in figure 2b. <dig>  cells annotated with the green and blue phenotype show a mitotic arrest, whereas cells of the red phenotype class show an apoptotic phenotype .

another way of comparing the dynamic behaviour of knockdown and control is to fix the emission probabilities of the learned hmm, and to learn two new, experiment-specific transition matrices on the knockdown and control separately. there is an obvious difference in the transition matrix of the plk <dig> knockdown and its wild type counterpart .

hmm phenotyping finds and categorizes knockdown-specific phenotypes
so far, we have described a computational method to identify knockdown-specific phenotypes in a single experiment. we applied this method to movies of  <dig> gene knockdowns with about  <dig> replicates for each knockdown . expectedly, not all knockdowns are phenotypically different from the wild type. in order to avoid false positives we only kept those knockdowns for which at least  <dig> replicates using at least  <dig> different sirnas had a knockdown-specific phenotype. this criterion selected  <dig> genes that were included in the subsequent analysis . this number is reasonable with regard to the results of the initial mitocheck analysis, where  <dig>  of about  <dig>  genes showed a mitotic hit in the primary screen. recall that we do not screen for pre-defined morphologies.

from each movie we only kept those cells with a knockdown-specific phenotype, which we call abnormal cells. this reduced the space of cell morphologies to phenotypes that are consequences of gene perturbations. the feature vectors of the abnormal cells were clustered using gaussian mixture clustering . the clusters of the gaussian mixture defined our universal  phenotype classes. the phenotypic fingerprint of a gene knockdown is given by the vector of relative cluster abundances of its abnormal cells. we assume that similarity of gene function implies fingerprint similarity. vice versa, dissimilarity of fingerprints implies distinct gene functions. a grouping of genes according to fingerprint similarity therefore cannot guarantee similar function of its group members; however, it will lead to an enrichment of functionally similar members. note that this is an obstacle common to all feature-based approaches identifying functional similarity. we grouped fingerprints by average linkage hierarchical clustering using euclidean distance . replicate movies of the same gene knockdown tend to cluster , supporting the fact that morphological fingerprints are characteristic of a gene. in general, we found that fingerprints of replicates using identical sirnas had smaller distances than fingerprints of different sirnas targeting the same gene . it is thus beneficial to average fingerprints of replicates targeting the same gene.

the mitocheck database categorizes cells into  <dig> morphological classes  <cit> .  <dig> of the  <dig> genes for which we found a knockdown-specific phenotype also showed at least one aberrant phenotype in the mitocheck database . it is encouraging that some of the universal phenotype classes found by our unsupervised analysis closely resemble the morphological classes of mitocheck. e.g. the morphologies of cells that were classified as binucleated in mitocheck match the morphologies of cells that we assigned to cluster  <dig>  the same holds for the mitocheck class of large cells and our cluster  <dig>  or for the mitocheck class of elongated cells and cluster  <dig> . we tested the enrichment in go terms for our  <dig> genes with knockdown-specific phenotypes against the background set of the remaining 315-67= <dig> input genes. we found go term enrichments for the regulation of apoptosis, protein phosphorylation, cell motility, response to stress, as well as signal transduction .

most fingerprints are dominated by one or two universal phenotype classes . this suggests that certain groups of genes induce a specific phenotype. conversely, some phenotype classes are specific for a small group of genes. these are the most interesting groups as they most likely indicate a functional relationship between their members. the genes plk <dig> and kif <dig> for example are clustered together and occupy a phenotype class that has large morphological differences to all other phenotype classes . plk <dig> has a role in centrosome maturation and bipolar spindle formation  <cit> . similarly kif <dig> has a role in the formation of the bipolar spindle  <cit> . genetic fingerprints thus clearly identified functionally similar genes by the extraction of knockdown-specific phenotypes and clustering.

furthermore, the cluster composed of armc <dig> and ing <dig> contains large, granulated nuclei . both genes are associated with metal ion transport and binding .

another cluster of two joint genes  and one more distant gene  shows dark and very small nuclei . creb <dig> and rxra are both transcription factors  <cit> . they jointly take part in the circadian clock pathway  <cit> . stk <dig> that is clustered more distant from creb <dig> and rxra is a serine threonine kinase  <cit> . stk <dig> regulates many signalling pathways in cell growth, cell polarity and cell metabolism  <cit>  and also acts as tumour suppressor. interestingly, stk <dig> negatively regulates the creb-regulated transcriptional co-activator   <cit> . members of the crtc family interact with creb <dig> and enhance its expression  <cit> . the relationship between stk <dig> and rxra is more subtle, however they both have a role in the adipocytokine pathway  <cit> .

an example of a knockdown-specific phenotype with two distinct morphologies is the group including the genes cdkn2b and atm. the phenotypic fingerprints of these genes have large proportions for a round phenotype with light speckles, as well as for an elongated phenotype . both genes are cell cycle checkpoint kinases that act at the transition from g <dig> to s-phase and induce g0/g <dig> arrest of melanoma cells  <cit> .

CONCLUSIONS
the automated extraction of morphological phenotypes in high throughput applications is a major task for future high content screens. we have developed an unsupervised method that is able to detect morphological changes in knockdown movies compared to their negative controls. this required the discrimination of phenotypes related to physiological cell behaviour from abnormal phenotypes that are consequences of perturbations like knockdowns or drug treatment. we consider our method as a dimension reduction approach for the vast space of cell images. we achieved this in two steps, first by assigning a discrete morphological state to every cell by the viterbi algorithm, and second by grouping cells with abnormal states into universal phenotypes. unlike supervised approaches, our method is best suited for the discovery of previously unseen phenotypes, for which prior knowledge does not exist. nevertheless, it automatically recovers the regular phenotypes arising during the regular cell cycle.

our method has been applied to high throughput rnai experiments. it provides a number of informative visualizations and summary statistics, which is indispensible when dealing with big data. most importantly, it generates a comprehensive summary of the distinct morphological states that constitute the phenotype space . by assigning a hidden state to each cell image, our method can even reveal the dynamic interplay between these morphological states .

the throughput achieved by our method allows us to perform a comparative analysis of hundreds of genes in a few days of compute time. we extract previously known as well as novel abnormal morphologies, and cluster genes according to their knockdown-specific phenotypes. rnai induced morphological similarity of genes is a proxy of functional similarity and is thus an important step towards identifying modules of functionally related genes and the discovery of metabolic and signal transduction pathways. however, we are aware that morphological similarity alone is not a sufficient proof of pathway membership; subsequent biochemical validation is indispensable.

we mention that our method can easily be extended to multi-colour movies in which various organelles of the cell are fluorescently tagged by different dyes. in this case we expect a large increase in the diversity of pathological phenotypes. the relatively fast and cheap process of data acquisition designates this method for the large scale screening of gene-drug or gene-environment interactions.

