BACKGROUND
genome-wide transcriptional profiling, the parallel measurement of the expression of tens of thousands of genes, is a powerful tool which, for example, aids in the development of clinical biomarkers for disease diagnosis, reveals the heterogeneity of histologically identical cancers, and sheds light on diverse biological mechanisms. after estimating the relative or absolute expression level of all transcripts, the next step is to test statistical hypotheses  <cit> . typically, these hypotheses are concerned with the difference between two biological conditions, for example, normal verses diseased tissue, or perturbed verses unperturbed cells. one of the most important aims of such tests is to identify the genes which are mostly responsible for the difference between the biological states under investigation, the so called differentially expressed genes .

genes do not function in isolation but are part of a complex regulatory and functional network, and this can be reflected in the significant observed correlations between their expression levels. however, the most widely used methods for identifying deg are univariate; typically tests are performed gene-by-gene without regarding gene-gene statistical dependencies. the fold-change, an early approach that is not recommended by statisticians but still popular among experimental biologists due to its simplicity, does not take into account the variance which arises from biological and experimental sources, and as such the fold-change measure does not offer any estimate of confidence  <cit> . because of this, the fold-change is regarded as an insufficient statistic for identifying deg  <cit> . other univariate methods include, welsh’s t test, significance analysis of microarrays   <cit> , and linear models for microarray data   <cit> , and, in the case of high-throughput sequencing data, differential gene expression analysis based on the negative binomial distribution   <cit> . however, since there are significant statistical dependencies between the expression levels of most genes, multivariate approaches may be more appropriate for genome-wide profiling analyses that identify deg; for example, multivariate analysis is able to find significant differential expression in cases where there is no marginal differential expression for individual genes .

there have been a number of attempts to apply multivariate analyses to identify deg  <cit> . for example, lu et al.  <cit>  proposed an application of hotellings t <dig> test, which is a multivariate generalization of welsh’s t-test. however, these approaches remain little-used because they are sensitive to the fact that typically microarray or rna-seq gene expression profiles have fewer samples than genes. a small sample size compared to the dimensionality of the measured variables brings difficulties to the analysis  <cit> . a significant step towards the resolution of such problems was the realization that variance shrinkage improves statistical power  <cit> . also, methods that directly attempt to identify differentially expressed gene-sets as opposed to individual genes have been developed  <cit> . in addition, to increase statistical power, these approaches also attempt to facilitate biological interpretation, which can be challenging when faced with a long list of deg  <cit> .

there are currently two main principle technologies to perform whole-genome transcriptional profiling: microarrays and rna-seq. the later has a number of advantages such as greater dynamic range, and an ability to measure previously unknown transcripts. the rna-seq technology also presents some challenges such as potential non-uniform read coverage and transcript length biases, and recently there has been a flurry of publications approaching these important issues  <cit> . one of the differences between microarray and rna-seq data is that microarrays result in continuous measures of expression, often log-normally distributed, whereas rna-seq data results in positive integer read counts with discrete probability distributions. for this reason, established methods of differential expression analysis for microarray data are not immediately transferable to rna-seq data but this challenge can be overcome as demonstrated by soneson et al.  <cit>  who showed how to transform rna-seq counts to continuous values. the approach we shall take here relies on minimal assumptions about the distributions of the data and should apply to rna-seq, microarray or any other similar situation where the dimensionality of the data far exceeds the sample size.

we propose a new multivariate approach called the characteristic direction which is better able to identify deg than univariate approaches including the methods: fold change, sam, the welch’s t test, limma and deseq. our approach naturally incorporates a regularization scheme to deal with the problem of dimensionality, and also provides an intuitive geometrical picture of differential expression in terms of a single direction. we show how this geometrical picture reliably characterizes the differential expression and also leads to some natural extensions of the approach such as improved gene-set enrichment analysis. in addition, we take advantage of a neat mathematical trick to make the characteristic direction method fast to compute.

previous attempts to validate expression analyses have tended to rely on simulated data due to the general lack of ground truth with which to compare the results when applying the methods to real data. however, simulated data can only contain a simplified reproduction of the rich structure of expression data and so can only provide an incomplete picture of the effectiveness of the method under investigation. we benchmarked our method using simulated data, but we also developed original methods to benchmark deg calling using real data . firstly, we extracted a large number  of gene expression microarray profiles from the gene expression omnibus  before and after the perturbation of individual tf. we then used chip-seq data, which provides information on the dna binding sites of the tfs to provide prior information by which we were able to evaluate the characteristic direction method and make comparisons to other approaches. we are aware that target genes for a tf, as determined by chip-seq, does not necessarily mean that the binding is functional. however, identifying more deg from a list of putative target genes determined by chip-seq can be used as a silver standard to compare deg calling methods. in a similar way, we were also able to do this for drug perturbations  in combination with knowledge about the drug targets and their known protein-protein interactions. for validation and evaluation of the characteristic direction method ability to identify deg from rna-seq data, there are currently fewer available studies from including set up similar test-beds, mostly because the technology is newer and cost prevents many studies from including more than two repeats. however, we did find an ideal study that measured binding sites for the tf stat <dig> and relevant rna-seq expression data in the same cells.

apart from being able to assess the analysis methods, these results are interesting in themselves as they show that we are able to infer information about tf and drug perturbations from expression data. for example, we find that proteins that are known to interact with the tfs and the drug targets tend to be also within the deg. finally, we show how a natural extension of the characteristic direction method can be used to perform potentially improved gene-set enrichment analysis. we compared enriched terms for deg identified in human cancer stem cells and show that the characteristic direction enrichment method recovers more relevant gene ontology  terms as compared with go terms recovered by the hypergeometric test, or gsea.

methods
computing the characteristic direction and identifying differentially expressed genes
classification approaches, for example those that predict clinical outcome from gene expression data, are inherently multivariate as they use the structure of the gene expression profiles as a whole in order to distinguish between biological conditions or classes. our approach is to repurpose linear classification methods in order to characterize differential expression and identify deg. we use a linear classification scheme, which defines a separating hyper-plane; the orientation of which we show can be interpreted to identify deg. we also find that the direction normal to the separating hyper-plane provides a simple geometrical conceptualization of the differential expression, which naturally leads to extensions of the approach, such as a new formulation of gene set enrichment analysis.

suppose we have gene expression data from a number of samples n, in which the expression of p genes is measured, and then let each expression profile sample form a row of the matrix x . for generality at this point we shall consider the case where each of the expression samples comes from one of k classes belonging to the set g. in linear discriminant analysis  the log-ratio of class posteriors p , is written as follows ,

  logprg=k|x=xprg=l|x=x=logπkπl-12μk-μltΣ-1μk-μl+xtΣ-1μk-μl 

where, πk, is the class mean, and it is assumed that both classes have the same covariance matrix, Σ. then the orientation of the separating hyper-plane  is defined by the normal p-vector, in the third term on the right hand side, that we label b,

  b=Σ-1μk-μl. 

the estimation, from the data, of the terms in this equation is explained in the additional file  <dig>  below we will interpret the direction of the p-vector, b, as the direction in expression space that best characterizes the differential expression, and show how the components of this vector can be used to identify differentially expressed genes. however, first we note a few potential issues: the calculation involves the inverse of a very large p × p matrix which is not only expensive to compute but also the elements must be estimated from a relatively small sample-size , which means that the matrix is singular and this leads to large variance in the results even when using the generalized inverse.

the issue of singularity and large variance can be tackled with a regularization procedure, for example, the covariance matrix can be shrunk to the scalar variance as follows,

  Σ^γ=γΣ^+1-γσ2ip,withγϵ <dig>  

where Σ^ is the estimated covariance matrix, and σ <dig> is the scalar covariance . the inclusion of a constant on the diagonal resolves the singularity problem, and the modulation of the off-diagonal terms helps to reduce noise arising from the estimation of covariance from few samples.

the problem of computational expense is efficiently overcome with the singular-value decomposition trick  <cit>  which also admits a solution in the limit of zero shrinkage by working in the subspace spanned by the data, rather than the full expression space . the normalized vector b^ contains only information about the direction of the normal to the separating hyper-plane. the components of b^ are the direction cosines, and their magnitude quantifies the degree of alignment of the direction to axes corresponding to each gene. the sign of each component can be interpreted as the sign of the contribution of each gene to the differential expression. another way to picture this interpretation of gene significance is to consider the identity,

  ∑i=1pb^i2≡ <dig> 

then the contribution of each b^ <dig> to this sum can be interpreted as quantifying the relative contribution of each component to the total differential expression giving the significance of the corresponding gene. the above interpretation provides a quantitative measure of the relative, but not absolute, significance of each gene to the differential expression, and as such can be used to rank the genes in order of significance. however, we also want to identify a shortlist of significant degs. this could be done completely within the framework we have outlined by using a l <dig> regularization scheme in place of that used in the shrinkage equation above; such a penalty results in automatic feature selection because many components fall to zero; the genes corresponding to the features retained would then comprise the degs. an alternative method to deriving a significance threshold is described below.

generating synthetic data
we generate synthetic normalized expression data which incorporates multivariate structure. the multivariate structure of real biological expression data is not fully known, we therefore use a simple approach which incorporates some of the best established properties of such data: 1) large number of features  with a relatively small number of samples; 2) significant dependencies between the expression levels of the genes, leading to dimensionality which is much smaller than the number of features. in addition to these properties we require control over the number and identity of genes which are differentially expressed between two datasets. there are a number of ways that datasets with these properties may be generated, but we chose the simplest, with the fewest free parameters. in a nutshell, we use a multi-variate normal distribution distributed throughout a random subspace of the full expression space, the dimension of which reflects the dimension of the dataset. by ensuring that this subspace spans a predefined vector of differentially expressed genes we can perturb the mean of the normal distribution, preserving the covariance matrix, to generate data with pre-defined differentially expressed genes. an explicit description of the algorithm follows:

the parameters input into the synthetic data generation algorithm are: the total number of genes on the array, p, the total number of differentially expressed genes, nd, the dimension of the data sets, d, the number of samples in each class, n, and a scale parameter which controls the magnitude of the difference between the “control” and “perturbed” data sets, Δ. first we determine which genes are to be differentially expressed and in which direction – this is done by generating a random unit p-vector with nd non-zero components, corresponding to the differentially expressed genes. we refer to this vector as m^. this vector, when normalized, provides the seed for the generation of a set of d isotropic random orthonormal vectors which provide a basis for a random subspace of expression space. this is generated by iteratively generating a random isotopic vector bi at step i, then calculating that part of bi which is parallel to the subspace spanned by the previously generated vectors {bj |j <i},

  bi,∥=∑j=1i-1bi.bjbj 

this is then subtracted from bi, resulting in a new vector which is perpendicular to the previous members of the set; this is normalized before being included in the set and moving on to the next iteration. the result is a set of orthonormal basis vectors for an isotropic subspace of dimension d which also includes the pre-defined vector of differentially expressed genes. for each class: “control” and “perturbed” we next generate random data within this subspace by drawing from a multi-dimensional normal distribution. to do this we must first define the mean and covariance matrices for each class. if, for simplicity, we assume linearity, then we may think of our random subspace as being the principal component space, and the data should be uncorrelated in this space, so we set the off diagonal elements of the covariance matrix to be zero and it only remains to determine the variances. we do this in such a way as to reflect a general property of biological expression data where the first principal component captures the most variance, and subsequent principal component capture successively smaller variances. we model this property very simply by setting the variance in the ith, principal component direction to be equal to e-, such that the variance in the first principal direction is  <dig>  and in the second e- <dig> etc. we assign the same covariance matrix to both the “control” and “perturbed” samples. we choose the mean of the “control” samples to be zero, and the mean of the “perturbed” samples to reflect the pre-defined differentially expressed genes by setting it equal to m^ scaled by Δ to control the magnitude of the difference between the “control” and “perturbed” expression data. an illustration of the synthetic data generated in a low-dimensional space with the parameters p =  <dig>  nd =  <dig>  d =  <dig>  n =  <dig>  and Δ =  <dig>  with gene  <dig> and  <dig> chosen to be differentially expressed, is shown in figure  <dig>  these parameters were chosen to give an impression of the structure of the data in higher dimensions, and to result in a clear difference between the two classes of samples.

estimating significant deg applied to the synthetic data
the characteristic direction method is represented by a vector in expression space, each component of which corresponds to a gene. we interpret this vector by taking the square of each component to be a measure of the importance of the corresponding gene in the differential expression; the larger the squared component the more significant the gene. in order to determine the appropriate threshold above which to accept genes as differentially expressed we derive a null distribution for the ranks of the squared components as follows:

given a null hypothesis that there are no differentially expressed genes we would like to compare the distribution of squared component values to those that would be expected under the null hypothesis. one way to generate the null distribution would be to use permutations of the data, which would require sample sizes to be large enough to permit a sizable number of permutations. an alternative which does not require such large sample size is to use the same multivariate normal model of the data distribution used in the classification calculation to generate the null distribution. under the null hypothesis we assume that there is no difference between the two classes of samples and that they both derive from a multivariate normal distribution with covariance matrix: Σ, the same as used in the classification calculation, and mean m <dig>  we use the following algorithm to generate the null distribution of ranked squared coefficients:

 <dig>  generate two random sample means by drawing from the multivariate student t distribution with n -  <dig> degrees of freedom and find their difference.

 <dig>  calculate the null characteristic direction bnull = Σ- <dig> Δm

 <dig>  calculate bnull <dig> and rank the components into descending order of magnitude

 <dig>  repeat steps 1– <dig>  <dig> times, and take the mean, to give 

 bnull <dig> 

to compare the real distribution the null we take the ratio: b2/bnull <dig>  the simplest and most conservative approach would be to accept into the set of differentially expressed genes all those genes for which the ratio: b2bnull2> <dig>  a less conservative method to derive the threshold from the data is to consider the inflection in the curves which can be isolated with the cumulative distributions.

performing characteristic direction enrichment analysis
the geometrical picture of differential expression as a single direction obtained by the characteristic direction naturally leads to some extensions. the natural distance measure for two directions is the cosine distance, or equivalently, the angle between the two directions. in this way we can picture the similarity between two biological perturbations as the alignment between two directions . furthermore, a gene-set defines a subspace within expression space; we can use the angle subtended between this subspace and the direction characterizing the differential expression, the first principal angle , as a quantitation of the significance of a pre-defined gene set for the differential expression. in the additional file  <dig> we derive the appropriate null-distribution with which to compare this subtended angle, and with such a statistical test we can identify significantly differentially expressed gene-sets. in the results section we compare this new method of enrichment analysis to existing methods such as gene set enrichment analysis   <cit>  and find a suggestion that this new enrichment analysis leads to the inference of more relevant biological processes.

RESULTS
benchmarking the characteristic direction method with transcription factor perturbations followed by microarray genome-wide expression profiling
we collected  <dig> experiments from geo  which contain expression data for control verses tf perturbation with at least three biological replicates in each of these classes. the tf perturbations consisted of knockdowns , knockouts , over-expressions , and other types of perturbation  such as partial mutations for example. a complete list with the details about these experiments can be found in the additional file  <dig>  we extracted processed expression values from the soft files downloaded from the geo database. for each experiment, we compared control and perturbed classes with four different methods: the fold change, welsh’s t test, sam, and the geometrical approach described above which we shall refer to as the “characteristic direction” approach. each experiment and method pair resulted in a ranked list of all genes on the particular array chip in order of their estimated significance in the differential expression.

to evaluate the ability of each method to prioritize deg we used chip-seq data reporting dna binding sites for the each tf from one of two databases: chea  <cit>  and encode  <cit> . there is little overlap between these databases and so they constitute independent validations . using this data we derived lists of genes which are associated with each tf by the identification that the tf bind to these genes’ promoters. then, by assuming that genes from these lists are more likely to be regulated by the perturbed tf than the complementary genes, we reasoned that the degree to which an analysis method prioritizes the chip-seq derived genes is a measure of its effectiveness. in addition, in a similar way we used lists of genes/proteins which are known to physically interact with each tf. we reasoned that genes for which their protein product physically interacts with the tf are more likely to be differentially expressed after the tf perturbation. as a final comparison, we examined the priority given to the perturbed tf itself, since it is known that many tf tend to auto-regulate their expression.

we took two approaches to examining and displaying the distributions of the rankings of these gene lists by the various methods: the cumulative distribution function over all experiments; and the distribution of the area under the curve  scores from each experiment. before proceeding, we describe these two methods in more detail. expression data from each experiment ej, with a total number of genes pj, is analyzed for differential expression, according to one of the methods described above, resulting in rankings for each gene which are scaled by pj to give rji, the scaled rank of gene i in experiment j, such that a value of rji =  <dig> is taken by the most significant gene in experiment ej and rji =  <dig> is taken by the least significant gene. for each experiment we have a corresponding subset of genes sj which may, for example, consist of genes which are putative target genes of the tf that was knocked down in the specific experiment, as determined by an independent chip-seq experiment. we examine the rankings of the genes sj. the set of rank values of the genes sj corresponding to experiment ej are identified for all j,

  a=∪j,k∈sjrjk 

then the cumulative distribution function of a, which we label d, is examined. if the gene sets sj contain genes which are neither preferentially significant or insignificant then we expect a uniform distribution and

  dr=r 

any significant deviation from this indicates that the gene sets are significant in the differential expression analysis, therefore we examine d - r for significant deviations from zero in order to evaluate the various methods. a significant positive value corresponds to the genes in sj being concentrated at the smaller scaled ranks and therefore having greater significance than a uniform random distribution. the entire process is visualized in figure  <dig> 

random fluctuations from zero are to be expected and we can estimate the scale for these fluctuations, φ, by a premise similar to that behind the kolmogorov-smirnov test . when plotting d - r we also include a right-hand scale to the plots which have the values scaled by φ to give an impression of how the deviation compares to what might be expected from random fluctuations under the null hypothesis of a uniform distribution of rankings. values >>  <dig> on this scale indicate significant non-uniformity in the distribution of ranks.

hence, this method allows us to visually and quantitatively compare the perturbation of cumulative distribution functions from uniform, d - r, for each ranking method and each gene list type . apart from figure 5a, which shows that all the methods are equally able to identify the tf directly perturbed in each experiment, the relative performance of the methods are quite consistent across the gene lists. the characteristic direction method prioritizes genes in the differential expression which are also associated with the perturbed tf in chip-seq data, and also genes which interact with the tf, and it does so to a significantly higher degree than the other methods . limma is the next best performing method by this measure, followed by sam and welsh’s t test. the fold change method does not seem to successfully prioritize the gene list. we also found that the degree of shrinkage has little effect on the rankings generated by the characteristic direction approach and thus choose a representative value .

benchmarking the characteristic direction method with drug perturbations followed by microarray genome-wide expression profiling
next we collected  <dig> experiments from geo  consisting of control verses fda approved drug perturbed samples, with at least three biological replicates in each sample. the genes were ranked in the same way as in the previous subsection, using the same methods. due to the different mechanisms of action between tfs and drugs, instead of using chip-seq for validation we assessed the rankings of known drug targets, and separately, genes which are known to have their protein products directly physically interact with those drug targets using known protein-protein interactions available from the ncbi gene database and drug targets from drugbank  <cit> . we assess the prioritization of the genes with the deg calling methods in the same way as for the tfs otherwise. it should be noted that chip-seq data informs the validation with relatively unbiased and objective data whereas the knowledge of drug targets is rather more biased and incomplete. in addition, it is not known whether targeting a drug target with a drug will alter the mrna expression of the target. so we do not expect to see the same strength of signal in this form of validation as compared with the validation for tf perturbation followed by expression with chip-seq prior data. the performance of each method seems to be in the same relation as for the tfs, with the characteristic direction giving higher priority to the genes encoding drug targets of the relevant drugs and genes which their products interact with those targets  .

comparing the characteristic direction method to deseq
in a recent study hardee et al.  <cit>  studied the relationship between differential stat <dig> binding and differential gene expression in two subtypes: germinal center b-cell-like  and activated b-cell-like  of diffuse large b-cell lymphoma . the illumina genome analyzer iix high-throughput sequencing platform was used to perform chip-seq experiments identifying the dna binding of the tf stat <dig> and also rna-seq experiments were performed on eight patient-derived cell lines: four from each subtype of dlbcl. the binding of stat <dig> was studied because deregulation of this tf is known to be an important discriminant between the two subtypes of cancer. the chip-seq data was condensed into  <dig> binding regions  for each cell line and the authors identify differential binding of stat <dig> between the two subtypes using deseq analysis. in addition, the authors identify differentially expressed genes, again using deseq. one of the central findings of their work is that there is a strong relationship between the differential binding of stat <dig> and the differential gene expression between the two subtypes of blbcl. stated another way, genes associated with binding regions which are differentially bound by stat <dig> also tend to be identified as differentially expressed. this study provides an opportunity to compare the performance of the characteristic direction approach in the setting of deep sequencing technologies to one of the most popular differential expression methods in the field . to do this, we repeated the differential analysis of both the chip-seq data and the rna-seq data, but where the authors used deseq, we use the characteristic direction; we then re-examined the association between differential stat <dig> binding and differential gene expression. taking the top  <dig> genes associated with differential stat <dig> binding as determined by the characteristic direction and deseq respectively, we examined the distribution of the deg in the same way as we did for the tfs . we see that the characteristic direction results in a higher ranking of the genes associated with differential binding of stat <dig>  more genes associated with differential binding of stat <dig> are recovered from the differential expression analysis when the characteristic direction method was used. the result further demonstrates the greater apparent degree of consistency between dna binding data and differential expression analysis uncovered when using the characteristic direction.

benchmarking the characteristic direction method with synthetic data
we used the following parameters to generate synthetic data as described in the methods: p =  <dig>  nd =  <dig> ×  <dig>  as these are of the same order of magnitude of whole genome profiles and we used Δ =  <dig>  as this resulted in data for which it was not too difficult and not too easy to identify the differentially expressed genes. we repeated each simulation  <dig> times. we investigated two different values of the sample size  as these are two common sample sizes found in geo datasets, and we also examined two different values for the dimensionality . the resulting roc curves show that the characteristic direction outperforms the other methods in recovering the differentially expressed genes from the synthetic data .
p 
= 10
4
, 
n


d

=  <dig> × 10
3
, and ∆= <dig> ; the remaining parameters are as indicated in the figure panels.

estimating significant deg applied to the synthetic data
in many cases prioritization of differentially expressed genes is not the only aim – a discrete list of genes which are to be regarded as differentially expressed is required. we next use the synthetic data described above in order to demonstrate an approach for setting a threshold that would determine significant differential expression. unless stated otherwise, all results in this section are averaged over three datasets. we first create a synthetic dataset where the number of differentially expressed genes is either  <dig>   <dig>   <dig> or  <dig>  the set of genes we aim to identify as differentially expressed genes are those with particularly large squared components. however, by plotting the ranked squared components for each gene it is not clear where it would be appropriate to apply a threshold . by applying the method that creates a null distribution for these ranked components, based on the null hypothesis that there are no differentially expressed genes, as described in the methods , we notice that when there are no differentially expressed genes the scaled components are uniformly distributed, with no components standing out . however, when there are differentially expressed genes we observed a peak with a width which reflects the number of differentially expressed genes in the synthetic data . by examining these curves we should be able to see whether there are any differentially expressed genes at all and if so how many; we therefore take the approach of allowing the data to decide the threshold as described in the methods using two types of thresholds: one stringent and the other less stringent.

the points on the curve which are closest to the top left corner capture more of the total differential expression with fewer genes. we label a new coordinate: s. which is perpendicular to the diagonal, and plot its value for each of the synthetic datasets . the peaks of these curves correspond to the inflections in the curves in figure 8c. their height indicates the degree of differential expression – values which are a significant fraction of unity indicate a significant differential expression . note that this criterion is satisfied by all the synthetic datasets shown with the exception of the dataset with no differentially expressed genes. the position of the peak may also be taken as the threshold for acceptance into the set of differentially expressed genes. finally, we indicate the position of the thresholds on roc curves to demonstrate that we have indeed found good thresholds for identifying deg . the sets of differentially expressed genes thus identified have sensible values of the false and true positive rates while also having the advantage that they are derived from the data itself rather than from the application of an arbitrary threshold.

characteristic direction enrichment analysis
in the case study presented in this section we attempt to compare the various biological contexts that emerge when examining differentially expressed genes identified from mrna profiling of cd44+ cd24-/low breast cancer cells as compared with normal breast epithelium tissue. the data used in this case study for evaluation and validation comes primarily from a study that profiled and compared normal breast epithelium tissue obtained from reduction mammoplasties and highly tumorigenic breast cancer cells isolated from tumors   <cit> . the various approaches to identify degs from this dataset may provide different pictures of the biological mechanisms which are relevant to the disease. when comparing cd44+ cd24-/low breast cancer stem cells with normal breast epithelium tissue we expect to detect biological processes such as cell motility, cell proliferation, wound healing  <cit> , and extra cellular matrix  remodeling which are known to be up-regulated in cancer stem cells and are activated in aggressive tumors.

one commonly used approach to obtain a picture of the biology from the analysis of differential expression is the evaluation of the deg for enrichment given previously annotated gene sets. gene set enrichment analysis  mentioned in the introduction, is one of the most popular approaches to accomplish this task. a more basic and widely used approach is to use welsh’s t test, or sam, to identify differentially expressed genes and then apply the hypergeomtric test to examine enrichment of gene sets deriving from various gene-set libraries or the gene ontology  <cit> . we can use these methods, as well as the characteristic direction approach to evaluate and compare significant biologically meaningful gene sets. we first manually construct six subsets of go biological processes corresponding to the six hallmark characteristics of cancer as defined by hanahan and weinberg  <cit> : 1) regulation of cell proliferation; 2) evasion of growth suppression; 3) resisting cell death; 4) enabling replicative senescence; 5) induction of angiogenesis; and 6) enabling invasion and metastasis  <cit> . we then performed enrichment analyses for genes involved in these go biological processes, using the deg obtained with each of the methods and compared the resulting picture of the biology that develops in each case . in the case of the characteristic direction, enrichment was calculated using the geometrical concept of the principal angle described above . in the case of welsh’s t test and sam a representative fdr threshold was set, resulting in a set of deg and the significance of the overlap of the deg with go biological process gene sets was evaluated with the hypergeometric test with an fdr threshold of 10%. we also include the results of using gsea  <cit> , though we found it necessary to increase the fdr threshold to the rather larger size of 60% in this case in order to observe a comparable number of significant processes. we observe complete agreement between all the methods in the go categories of mononuclear cell proliferation  and response to estrogen stimulus ; cell proliferative processes are known to be fundamental to carcinogenesis and estrogen signaling is known to play a significant role in breast cancer. the characteristic direction approach with principal angle enrichment finds more processes to be significant in the differential expression in all the hallmark categories. it is possible that this is because this approach leads to a clearer picture of the differential expression, however, it would require further exploration before a more categorical statement can be made on this matter.

discussion and 
CONCLUSIONS
we have described a new multivariate approach to differential expression which is better able to identify deg while also addressing the issues associated with the high dimensionality of expression data. the characteristic direction approach uses the orientation of the separating hyperplane from a linear classification scheme, linear discriminant analysis, to define a direction which characterizes the differential expression. this results in a simple, highly-regularized characterization which is appropriate for genome-wide expression analysis. we compared the performance of this approach to established univariate approaches, with real and synthetic data. the validation scheme in the context of tf and drug perturbations is in itself valuable for benchmarking both computational and experimental methods. extracting a large number of control verses perturbation expression datasets from geo and prioritizing the genes with the various methods, we were able to show that the characteristic direction approach prioritizes genes which are associated with the binding sites of the perturbed tf and targets of drugs respectively; and it does so to significantly greater degree than a selection of popular methods. we took advantage of the opportunity to use independent prior knowledge datasets to validate our method. it is established that binding and unbinding of transcription factors to the promoters of genes is, in general, used for gene expression regulation. however, it is also clear that binding to the promoter does not necessarily result in differential expression. this is especially true when considering different cellular contexts. in most cases of our validation scheme the chip and array do not come from the same cell lines. however, there is some correlation/overlap between deg after tf knockdowns and tf putative binding based on chip for the same tf in most cases. we do not know the true positives but we know that more overlap is likely due to a more accurate method to identify the deg. we name this a silver standard for validation as it is not as good as a gold standard but it is good enough to compare deg calling methods. the fact that we were able to recover genes associated with the binding sites of the perturbed tf is interesting on its own as it reveals a relation between dna interactions identified by chip-seq experiments and mrna levels from expression profiling. similarly, the ability of the method to identify a clear relationship between drug targets and the differential expression of their interactors in a systematic way is also noteworthy because for many drugs we do not know the targeted pathways while differential expression signatures are readily available. for the rna-seq validation we used a single study which compares differential binding of a tf, to differential expression, in the context of high-throughput sequencing. we found a stronger apparent relationship between differential binding and differential expression when using the characteristic direction approach as compared to the deseq method. like all statistical methods, the characteristic direction method works best when there are many repeats of the same condition. in principle, the method requires at least two repeats, but at least three repeats are needed for practical applications. the microarray and rna-seq data used for validation of the method always had at least three repeats for each condition. it is true that in most rna-seq studies so far investigators do not have that many repeats , but this is likely to change as the cost of such experiments rapidly drops. to make the characteristic direction method accessible, we implemented it in python, r, matlab and mathematica. readers that are interested in applying the method to their own data should refer to the open source scripts and examples available at: http://www.maayanlab.net/cd.

availability and requirements
implementations of the method are provided in python, r, matlab, and mathematica freely available at: http://www.maayanlab.net/cd.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
am and nrb designed the study and wrote the paper. nrb performed all analyses, wrote all the equations and implemented the method in mathematica. kh developed the tf perturbation gene-set library from geo, asf developed the drug perturbation gene-set library from geo, yk processed the data from encode, eyc implemented the method in python, qd implemented the method in matlab and r. all authors read and approved the final manuscript.

supplementary material
additional file 1
the characteristic direction: a geometrical approach to identify differentially expressed genes.

click here for file

 acknowledgements
this work was supported in part by grants from the nih: r01gm098316-01a <dig>  p50gm <dig>  r01dk088541-01a <dig>  u54hg006097-02s <dig> and rc4dk090860- <dig> 
