BACKGROUND
chip-sequencing, also known as chip-seq, is a recently established technique to detect protein-dna interactions in vivo on a genome-wide scale  <cit> . chip-seq combines chromatin immunoprecipitation  with massively parallel dna sequencing to identify all dna binding sites of a transcription factor  or genomic regions with certain histone modification marks. the chip process captures cross linked and sheared dna-protein complexes using an antibody against a protein of interest. after decrosslinking of the protein-dna complexes, the final dna pool is enriched in dna fragments bound by the protein of interest, but there are always random genomic dna fragments piggybacking on the specific dna fragments. the degree of enrichment depends on the chip efficiency. a more efficient experiment will induce a higher proportion of protein-bound fragments in the mixture pool, and generate more sequence reads in bound regions and less sequence reads in non-bound regions, than an experiment with lower chip efficiency. as a result, the more efficient experiment will have more power to discriminate between bound and non-bound genomic regions and generally show a larger number of bound regions.

the antibody used is the most critical factor affecting chip efficiency  <cit> . however, different chip efficiencies are also observed between different batches when using the same antibody, since chip protocols are notoriously difficult to standardize and control. in general, we may encounter three relevant scenarios where differences in chip efficiencies play a role:  the comparison of bound regions between two experimental conditions subjected to chips with the same antibody but with variable efficiencies;  the comparison of bound regions of the same tf or marked with the same histone modification but profiled with different antibodies;  the comparison of bound regions from two different tfs or marked with different histone modifications, profiled with different antibodies. when making comparisons without considering the chip efficiencies, the number of overlapping regions may be underestimated while the number of differentially bound regions may be overestimated. a number of methods have been proposed recently for comparative analyses of chip-seq data e.g.  <cit> . in general, there is recognition in the literature of different specificities associated to different antibodies used in chip-seq experiments, e.g.  <cit> , and attempts are made to account for these in the analysis. these are often in the form of a pre-selection of regions for the analysis: in  <cit>  only regions with high signal to background ratios are used for further analyses and normalization procedures, in  <cit>  the normalization is performed only on commonly enriched regions. a control experiment is often used to aid the detection of truly enriched regions . however, overall, there is a shortage of formal definition of chip efficiency and a limited focus on how this affects the interpretation of the results and how this should be fully accounted for in the statistical analysis of the data and consequently in the detection of enriched and differentially bound regions. in this paper, we address these issues using chip-seq data from a number of experiments conducted by different laboratories on two highly similar but different proteins.

p <dig> and the creb binding protein  are two histone acetyltransferases  which are transcription co-activators for a broad range of genes involved in various multiple cellular processes. p <dig> and cbp have highly similar roles in transcriptional activation, but also differ in some aspects that are still not fully understood  <cit> . this is reflected by the large but incomplete overlap in p <dig> and cbp binding sites in the genome  <cit> . in the chip-seq study of  <cit>  it is known that the antibody specificity for the p <dig> experiments is higher than for the cbp experiments. using a fisher exact test,  <cit>  find that the number of regions preferentially bound by p <dig> is largely greater than the number of regions preferentially bound by cbp. in  <cit> , two experiments are conducted on the same two proteins, but using a different cell line. in this case, the antibody specificity for the cbp experiment is known to be higher than the one for p <dig>  consequently, the number of regions preferentially bound by p <dig> found by this study is much smaller than the number of regions associated only with cbp. despite the different experimental set-ups of the two studies, these results suggest that the differences in chip efficiencies associated with the antibodies used can have a major impact on the findings of regions that are differentially bound by cbp or p <dig>  and may mask the real heterogeneity between the two hats and the two cell types studied. hence, there is a need to explicitly account for these in the statistical analysis and interpretation of the results.

a large number of statistical methods have been developed in the last few years for modelling chip-seq data. the majority of these concentrate on the detection of peak-type profiles such as the ones generated by dna-binding tfs. some others are proposed for detecting genomic regions with broader signals such as those bound by rna polymerase ii binding  <cit>  or marked with specific histone modifications  <cit> . if no control experiment is available , a general strategy is to model the background read distribution and then assign a statistical significance cut-off for the detection of candidate peaks or enriched regions using either analytical or simulation approaches. one popular model for the background is given by the poisson or negative binomial  distributions, which are used by a number of available software packages . an alternative to the global poisson or nb models is to use local poisson models , mixture of poisson/nb models  or more advanced hidden markov mixture or random field models .

in this paper, we use a latent mixture model, as described in the methods section, and show how this model accounts for the chip efficiency of an experiment, by modelling an appropriate signal to background ratio. the general idea is that the different components of the mixture model give flexibility to model both well separated signal and background components  and more overlapping components . a formal definition of chip efficiency is given, which can be easily extended to mixture models of more than two components. therefore, other methods based on mixture modelling, such as the ones mentioned above, could be used within the same framework described in this paper. the fact that different experiments, even technical replicates from the same lab, can have different ip efficiencies has probably been the main reason why, to date, statistical modelling of chip-seq data sets, and corresponding implementations, have been developed for individual experiments. in the presence of technical or biological replicates, the results from the different analyses are subsequently combined to increase the robustness in the detection of regions and circumvent the problem of different signal to background ratios  <cit> . one major contribution of this paper is to show how a mixture model framework that explicitly account for chip efficiencies can be used to perform a joint analysis of chip data from multiple experiments on different proteins, aiding to a more robust detection of enriched and differentially bound regions.

RESULTS
joint modelling of chip-seq data with multiple replicates and different ip efficiencies
the analyzed material from the immunoprecipitation step of a chip-seq experiment is always a mix of fragments bound by the transcription factor  and random background fragments . furthermore, the majority of regions in the genome is not enriched and should therefore contain only background signal. we would generally expect that the bin counts reflect this mixture pattern. that is, some bins are enriched regions with a lot of tags  and most other bins are not enriched, containing only few tags. this motivated us to assume a mixture model framework for the counts. the model that we present in this paper does not make any use of peak information and is therefore more suitable for the detection of broad regions, such as those marked with histone modifications.

let m be the total number of mappable bins and ymcji the counts in the mth bin, m =  <dig> ,⋯,m, under condition c, antibody j and replicate i. in our context, the condition c stands for a particular protein  at a particular time point, and i =  <dig> …,nj is the number of technical or biological replicates for antibody j used in this condition, with j =  <dig> …,j. the counts ymcji are either from a background population  or a from a signal population . let xmc be the unobserved random variable specifying if the mth bin is enriched  or non-enriched  under condition c. clearly, this latent state does not depend on chip efficiencies. similarly to the model used in mosaics for single experiments  <cit> , we define a joint mixture model for ymcji as follows:

 ymcji∼pcf+f, 

where pc = p is the mixture portion of the signal component and f and f are the signal and background densities for condition c, antibody j and replicate i, respectively.

using a mixture model allows to split the signal and background component in the data: this is particularly important when different chip efficiencies are observed, as these will induce a different signal to background ratio. the different parameters of the mixture components will allow to capture the different ip efficiencies of individual experiments, whereas the parameter pc, which does not depend on the chip efficiencies, allows to properly combine technical and biological replicates with the same or different antibodies. this is not normally done in the literature, rather different analyses are performed for different experiments and the detected regions are further combined at a second stage, e.g.  <cit> . the constant kcji is a non-negative value that represents the minimum observable tag count in an enriched region and is used to provide greater flexibility to the two-component mixture model, particularly in the presence of a large proportion of zeros.  <cit>  set this offset equal to some pre-specified value and use the same value for all experiments. however this assumption does not seem to be supported by the data, where the value of the offset k may also depend on the library size and on the different signal and background ratios of the experiments. we therefore opted to keeping this parameter free in our maximum likelihood procedure and estimating it from the data.

we fit this model to the p <dig> and cbp datasets described in the methods section, using the em-procedure outlined in the same section for parameter estimation. the input to the model is count data from all chip-seq datasets considered, together with information on which experiments are replicates. the output of the model is the estimates of all the parameters, that is pc, θcjis and θcjib for all c, j and i. the eight experiments considered in this paper are performed by two different labs. in  <cit> , two technical replicates are conducted at time  <dig> for each of the two proteins. in  <cit> , single experiments are conducted for non-activated t-cells. given the different cell lines used in the two studies, the experiments from the two different labs cannot be considered as biological replicates. however, the framework described in this paper would be flexible enough to allow for the situation when different replicates are conducted in different labs .

table  <dig> gives the parameter estimates of the mixture of two nb distributions, using the joint modelling approach just described. the use of nb distributions returned a better fit than a poisson mixture model in terms of the bayesian information criterion  values . the second column reports the value of the parameter pc, that is the probability of enrichment. this is the same for technical replicates, as constrained by the model since these are assumed to share the same binding profile. columns  <dig> to  <dig> report the parameters of the mixture distributions. these vary significantly between different experiments, to reflect the different ip efficiencies. column  <dig> shows different estimates of the parameter k for the eight experiments, suggesting that setting this value fixed a priori, as in  <cit> , is generally not advisable.

quantifying ip efficiencies of chip-seq experiments
the mixture model that best fits the data can be further used to derive an estimate of ip efficiency of a chip-seq experiment. in the literature, this is often done using informal ad-hoc measurements, e.g.  <cit>  estimate chip efficiency by the ratio of hybridization values at the top 1% of bound sites to the bottom 10%, which are taken to represent background levels of binding, whereas  <cit>  measure it using the relative level of protein binding with respect to control regions. in general, chip efficiency is often thought in terms of a ratio between the total number of counts in the enriched regions versus the total number of counts in the background regions. in the context of our paper, such a quantity can be estimated by taking the ratio of the expected counts in the signal regions, μs, versus the expected counts in the background regions, μb. however, such a measure would not account for overdispersion, or, in general, for more complex distributions of the background and signal components. for this reason, we present a more general measure of ip efficiency in terms of separation of the signal and background components of the mixture model. an efficient experiment will generate well separated signal and background components, whereas a less efficient experiment will generate two more overlapping components. in the methods section, we provide a formal derivation of this ip efficiency estimate.

table  <dig> reports the corresponding ip efficiencies for the eight experiments on p <dig> and cbp. these estimates reflect existing knowledge on the specificities of the antibodies used for the different proteins, e.g. the efficiencies of the experiments for p <dig> by  <cit>  are larger than the ones for the cbp experiments, whereas the opposite is observed for the experiments by  <cit> . furthermore, it is interesting to note quite a large difference in chip efficiency for technical replicates in the study of  <cit> , which is reflected also in the parameter estimates . these different chip efficiencies, if not accounted for, can potentially lead to erroneous biological conclusions.

accounting for chip efficiencies in the detection of enriched regions
chip efficiencies need to be properly accounted for in the detection of the regions bound by a protein from the available chip-seq data. after fitting a mixture model to count data, the estimates for all the parameters in the model, that is pc, θcjis and θcjib, are used to select the regions enriched by p <dig> and cbp, respectively. a common procedure for mixture models is to set a cut-off on the posterior probabilities of non-enrichment, p for regions m and condition c. we choose this threshold using a controlled false discovery rate  of  <dig> %, as detailed in the methods section. the last column of table  <dig> gives the number of enriched regions for each condition, in terms of the  <dig> bp windows used in the analysis. as technical replicates are modelled jointly, a single list of enriched regions is detected for these experiments.

the important step in the detection of enriched regions is that, in order to properly account for the different chip efficiencies, the enriched regions are selected after controlling for the same fdr amongst the different experiments. as shown in table  <dig> more regions are detected for the more efficient experiments, as one would expect. for example, the chip efficiency of wang cbp is larger than wang p <dig> and this results in more than twice the number of enriched regions detected in the cbp experiment than in the p <dig> experiment. this should not be confused with the actual number of true binding sites, which is unknown and is better reflected in the estimates of pc. for example, wangcbp is a more efficient experiment than cbpt <dig>  so more regions are detected as enriched in wangcbp than cbpt <dig> at the same fdr, but the estimated probability of a region being enriched is larger in cbpt <dig>  than in wangcbp . to emphasize the importance of using the same fdr in the presence of different chip efficiencies, table  <dig> gives the estimated fdr when we select the same number of enriched regions in the eight experiments. in particular, we consider the case where for each experiment we select the top  <dig> regions, which is the average of the number of enriched regions amongst the eight experiments on cbp and p <dig>  and the case where we select  <dig> regions, where the most efficient experiment shows acceptably low fdrs. as expected, the more efficient experiments show lower fdrs. this means that not accounting for chip efficiency, which we mimic here by assuming a fixed number of enriched regions in all experiments, will result in a greater number of false negatives for the more efficient experiment and a greater number of false positives for the less efficient experiment.

one strength of the approach proposed in this paper is in the fact that replicates are joined in the model by a common assumption of shared binding profiles. this is an assumption on the latent states, prior to the collection of data. the different ip efficiencies of the replicates are further captured by the individual parameters of the signal and background distributions. this joint modelling approach makes an appropriate use of replicates and is expected to return a more robust set of the regions bound by a protein. in the first instance, we compare our results with those from an existing method on single experiments. in particular, we perform a comparison with mosaics  <cit> , which is in spirit very similar to our mixture modelling approach. figure  <dig> shows venn diagrams of the detected regions at the same fdr, for two representative experiments. we compare our approach, denoted as enrich, with two versions of mosaics: mosaics_1s corresponds to a mixture model with one background and one signal component, whereas mosaics_2s fits a mixture of two densities for the signal component. figure  <dig> shows how mosaics_2s identifies more bins than mosaics_1s, as expected from a more flexible approach, and how enrich has a very high overlap with mosaics_2s. despite our method using only one signal component, the maximum likelihood procedure that we use for parameter estimation returns better estimates than the moment estimators used by mosaics. the mosaics_1s model fits an extremely large variance for the signal component to capture the long tail of the distribution of counts. this problem is attenuated by the use of the second signal component.

having established a very high overlap between our method and an existing approach for single experiments, we now assess the advantages of the joint modelling approach when replicates are available. table  <dig> compares the number of regions detected by our approach with the number of regions that are detected at the same fdr by fitting separate mixture models for each of the two replicates and then finding the regions that are detected as enriched by both experiments, which is the common procedure adopted in the current literature, e.g.  <cit> .

when conducting separate analyses, different latent profiles xmc, and consequently different pc, are implicitly assumed for each replicate. this goes against reasonable assumptions, as replicates are made under the same condition c, and it has the result of reducing the power in the detection of commonly enriched regions. in our comparison, we find that all regions detected by the separate approaches are detected also by the joint modelling approach. on the other hand, it is clear from table  <dig> how many more regions are detected when technical replicates are modeled jointly, as in the approach proposed in this paper, rather than individually. furthermore, when taking the intersection of lists of regions detected by single experiments using a controlled fdr, it is not clear what the level of fdr of the resulting list of regions is. in general, this is expected to be much smaller than the fdr cutoff chosen for each individual experiment, although this is rarely discussed in the literature  <cit>  and shows a further disadvantage of performing individual analyses of replicates. in an attempt to perform a fair comparison with our joint modelling approach, we estimate the fdr of the commonly enriched regions detected by separate experiments using

 p=ppp 

for two replicates y <dig> and y <dig>  sharing the latent binding profiles x, where we estimate the posterior probability p from the two separate analyses and we take p as an average of the two estimates from the two separate analyses. when setting an  <dig> % fdr cutoff on each individual analysis, this method returns an estimated fdr of  <dig> e − <dig> and  <dig> e − <dig> for cbp and p <dig>  respectively, for the commonly detected regions. we use these fdr values for the joint modelling results of table  <dig> . note that these values are smaller than the  <dig> % cutoff chosen for table  <dig>  thus returning a smaller number of enriched regions for the joint modelling approach. similar results are obtained by taking the union of separate analyses, rather than the intersection, that is by considering regions that are detected by at least one of the two separate analyses . the fdr of the union of regions is similar to that of individual experiments, but the joint modelling approach consistently finds many more regions than the separate analyses.

cbp and p <dig> both have roles in transcriptional activation. to analyze whether the additionally identified cbp and p <dig> bound regions are not merely false positives but likely functional in transcription activation, the regions are also evaluated for the presence of tsss of annotated genes . with the exception of the last comparison, where an unusually low percentage is observed, these results show that the additionally identified regions have a similar percentage of tsss to the ones in the independent modelling approach, providing some evidence that these regions are not just noise but genuine binding sites. we use chromhmm  <cit>  to validate this further and to explore whether other chromatin features are enriched in the regions identified by the different methods. figure  <dig> shows the results of chromhmm using a 4-state hidden markov model on the enrichment profile given by the intersection and union of separate analyses, each at an  <dig> % fdr , and by the joint model , at the same fdr as the intersection. the data from both proteins is jointly modelled by chromhmm. the left plots give the emission probabilities for the different analyses, that is the probability of the observed enrichment given each of the four possible states. these plots show how, for all analyses, two of the four states explain most of the enrichment pattern in the identified lists. the right plots give the relative fold enrichment for several annotations. these plots show how these two states are mostly enriched with tsss, active and weak promoters, and weak enhancers. furthermore, the plots show how the second state, which is enriched only in p <dig>  reflects mainly the different degrees of enrichment of cbp and p <dig> for the same chromatin features. this is most likely the result of the different chip efficiencies of the p <dig> and cbp experiments, respectively, which result in a larger number of enriched regions for p <dig> than for cbp and which are not accounted for in chromhmm. the findings from chromhmm seem to be consistent across the different analyses. together with the results in table  <dig>  one can conclude that by combining replicates jointly at the modelling stage, rather than at a later stage, many more regions are found at the same fdr, and that these regions are generally of the same quality as those found by the individual modelling approach.

detection of differentially bound regions
when we have data on two or more proteins, or on one protein and a control, an interesting question is to find the regions that are differentially bound by the two proteins of interest. these are the regions with a large difference in the probabilities of enrichment, p for the two proteins. antibody efficiencies also play a role in this as, generally, one would expect to find many regions preferentially bound by a protein for which a more efficient experiment is conducted, than for a protein from the less efficient experiment, simply down to the two different antibodies used. indeed, this is the case for the two studies by  <cit>  mentioned in the introduction. in the literature, techniques which can detect peaks or enriched regions for a single experiment against a control, e.g. macs  <cit> , chipdiff  <cit>  or mosaics  <cit> , can also be used to detect differentially bound regions for two proteins. here, the general procedure is to use the experiment from the other protein as a control. however this method lacks formal probability definitions on the difference between the two experiments. furthermore, it is not implementable for those peak-finder methods that do not use control information. more recent methods, such as chipnorm  <cit> , allow to compare two experiments on two proteins at the same time, but somewhat sidestep the issue of different ip efficiencies by focussing on regions with high signal to background ratio and normalizing the counts on these regions only. finally, one of the latest methods, dbchip  <cit> , allows the inclusion of biological replicates in the model, but does not account for their different ip efficiencies in the detection of enriched and differentially bound regions.

in this paper, we formally develop a test for the detection of differentially binding regions from a number of chip-seq experiments on two proteins, based on the statistical model proposed in this paper. the novelty of this test is in the fact that the information from multiple experiments is shared at the modelling stage, by properly accounting for the different ip efficiencies, and is then fed into the test. we consider the following probability of differential binding

  p=pp+pp 

where p is the probability that the mth bin is enriched for protein c, estimated by the model described above and from all the data on protein c. in this way, all replicates under the same condition are considered in the estimation of the posterior probabilities, returning a more robust set of differentially bound regions.

table  <dig> reports the results of this analysis, for the detection of the regions that are bound only by cbp or p <dig> at 5% fdr, using the parameters estimated by the joint mixture model  to compute the posterior probabilities in equation . it is clear how more regions are detected as bound by the protein where more efficient experiments are conducted than for the other protein . this is to be expected as there is more power in the detection of these regions, but it should not be misleading: the controlled fdr guarantees that only a controlled number of errors is computed in the detection of regions for either of the two proteins. only by increasing the fdr even further, would one be able to recover more regions in the less efficient experiments, albeit with a higher probability of false detections. finally, it is interesting to note how the number of differentially bound regions is more balanced for the case when technical replicates are available . this suggests that properly accounting for replicates at the modelling stage is expected to give more power also in the detection of differentially bound regions. in support of this, we have performed separate mixture modelling analyses for p300t <dig> versus cbpt <dig> and p300t <dig> versus cbpt <dig> and have taken the union of the differentially bound regions from these two separate analyses. these results are reported in table  <dig> and show a remarkable difference with the results from the joint analysis, especially for the less efficient experiment, where many more regions are detected as differentially bound using the joint modelling approach. figures 3a and 3b give genome browser views of two representative regions that are found differentially bound by cbp and p <dig>  respectively, using the joint modelling approach, but that are not found using the individual modelling approach. these plots show how the power in the detection of differentially bound regions increases when the counts of individual experiments on technical replicates are modelled jointly. future work will look at validating these regions biologically.

in the presence of two different proteins, a priori biological knowledge about the two proteins can be further included in the test. in particular, in the context of the model described in this paper, one can impose the assumption that the two proteins have the same number of binding sites, that is p1=p <dig>  where pc is the probability of a region being enriched by protein c. if realistic, this assumption is expected to lead to a more robust detection of the enriched regions, by providing a better estimate of the expected number of enriched regions in the different experiments. indirectly, this allows to better account for the different ip efficiencies of the different experiments. the constraint of p1 = p <dig> can be imposed in the maximum likelihood procedure, in a similar way to parameter estimation in the presence of replicates. however, in this case, we do not make an assumption of equal binding profiles , which is instead appropriate for technical replicates. the main difficulty in implementing this method is in assessing whether the assumption of a same pc is appropriate in a particular biological context. when no definite knowledge is available, we suggest to compare the fit of a model which makes an assumption of p1 = p <dig> with a model which does not make this assumption. as the two models have a different number of parameters, we suggest to compare them in terms of their bic value. this is defined in the usual way by −2lnl+rln, with Θ^ the estimated parameters in the model, l the maximum likelihood and r the number of parameters. the estimated parameters are different depending on whether the constraint of equal pc is imposed or not, and the best model is chosen as the one with the lowest bic. figure  <dig> shows the output of a simulation study where we have assessed whether this bic measure leads to an informative choice in our context. we have simulated count data on  <dig> regions for two different experiments , using the mixture distributions p1nb+nb and p2nb+nb, respectively. we have chosen these distributions so as to have different ip efficiencies . the plot gives the average bic value, over  <dig> iterations, for the model which does not make the assumption of equal probabilities  versus the model which does make this assumption . the x-axis shows the true p2−p <dig> value for the different simulations, where we fix p1 =  <dig>  and vary p <dig> between  <dig>  and  <dig> . despite the different ip efficiencies, it is clear how the bic measure manages to distinguish between the case when p1 = p <dig> and the case when this assumption is not satisfied. the simulation shows further how there is a small margin of error for values of p <dig> very close to, but not exactly equal to, p <dig> 

we have checked whether the assumption of an equal number of binding sites is appropriate for cbp and p <dig> from the experiments considered in this paper. of the three comparisons reported in table  <dig>  the bic measure suggests that p <dig> and cbp can be assumed to have an equal number of binding sites at time  <dig> , but this assumption is not appropriate at time  <dig>  table  <dig> compares the results of the analyses at time  <dig>  the p1 ≠ p <dig> column shows the results from table  <dig>  where different probabilities of enrichment are assumed for the different proteins at the different time points. the p1 = p <dig> column gives the results from the new analysis, where p <dig> and p <dig> are constrained to be equal in the estimation procedure. the results show how the two approaches lead to different results. in particular, fewer regions are detected for the more efficient experiments at the same false discovery rate. our interpretation of this is that, in the absence of replicates, when one compares two experiments on two different proteins with two different antibodies being used , it is difficult to estimate accurately the parameter pc as well as accounting for ip efficiency. indeed, the estimated pc values from the more flexible approach, with p1≠p <dig>  tend to be quite different in these cases, against expectation . particularly in these situations, including in the model the assumption of a similar number of binding profiles returns a better estimation of the probability of a region being enriched and consequently it is expected to return a more robust detection of the truly differential binding regions.

CONCLUSIONS
different antibodies are used for chip-seq experiments for different proteins, and these have different levels of specificity. on top of this, different chip efficiencies are observed even for replicated experiments on the same protein. this results in different signal to background ratios for chip-seq generated data, and consequently, in a different percentage of expected enriched and non-enriched regions. we have used simple arguments to show how this is the case, how the chip efficiency of an experiment can be quantified from the data and how different chip efficiencies for different experiments can lead to misleading biological conclusions if not accounted for in the statistical analysis. this is shown both for the detection of enriched regions and of differentially binding regions, for which a new test is proposed. in the exposition, we focus on the detection of broad regions, such as those marked with histone modifications, and we do not use any information about peak-shape or reads from opposite strands.

we have used a mixture of negative binomial distributions to present the results in this paper. one important point of the paper is that a mixture model approach, such as the one presented here, allows to account for the chip-efficiency of an experiment: less efficient experiments are modelled by more overlapping signal/background mixtures than more efficient experiments. in our results, we fitted this model to count data on  <dig> bp-size windows. the relatively large window size is motivated by the fact that the mixture model considered here does not account for markov properties in the data. more sophisticated statistical models of chip-seq data, such as hmms  <cit>  or random fields models  <cit> , or more sophisticated distributions, such as zero-inflated poisson or negative binomials distributions, e.g.  <cit> , can be used within the same framework described in this paper, and are currently under investigation. similarly more robust estimates of background distributions can be used, e.g.  <cit> . current research is looking at an extension of the joint model approach presented in this paper to one where read-mappability and gc-content are directly included in the model specification. furthermore, most of the available normalization methods, e.g.  <cit> , work with a pre-defined set of enriched regions and often make use of control experimental data to further improve the identification of enriched regions. the regions detected by the method proposed in this paper could be further used as part of existing normalization procedures.

a second important point of the paper is that estimation of the parameters of the mixture model is performed jointly, from all the available data. in particular, the knowledge of experiments being technical or biological replicates puts some constraints in the parameter space: the parameter pc that is discussed in the paper is the same for all technical and biological replicates, as these share naturally the same binding profile. this parameter, as well as all the other parameters in the model, are estimated from data by an expected maximum likelihood approach. given the parameter estimates, the final point of the paper is to show how these can be appropriately used to make a decision about which regions in the genome are enriched, and which are differentially bound in the case of two proteins.

we use real chip-seq data on two histone modifiers, p <dig> and cbp, to show how a joint modelling approach for chip-seq data, which properly accounts for the different chip efficiencies, is able to identify a larger number of enriched regions than a standard approach, where individual models are fitted to individual experiments and the results of individual analyses are subsequently combined. the regions identified by the joint modelling approach have been validated by tss overlap and chromhmm and have generally shown similar enrichment of chromatin features to the regions detected by individual analyses. additional a priori biological knowledge, such as the expectation of a same number of binding for two different proteins, can also be included in the model and is found to return more realistic numbers of differentially bound regions, with a smaller number of regions bound by the protein where a more efficient experiment is conducted and therefore an expectation of a smaller number of false positives. further work will be conducted to validate these regions biologically.

the methods described in this paper are implemented in the r package enrich, which is available in cran. the input to the main function in this package is count data for a number of bins and a number of experiments, together with information about which experiments are replicates, which experiments are thought to have the same number of binding profiles, which two proteins  should be compared for differential enrichment, and an fdr cut-off for the selection of regions. the output of the function is a list of enriched regions for each protein and each condition and the list of differentially bound regions at the specified fdr cut-off.

