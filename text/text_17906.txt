BACKGROUND
currently, large-scale bacterial 16s rrna gene analyses are based on sequencing of individual variable regions of the bacterial 16s rrna gene. single variable regions and combinations of variable regions including v <dig>  v <dig>  v <dig>  v1- <dig>  v1- <dig>  v2- <dig>  v2- <dig>  v3- <dig>  v4- <dig>  v3- <dig>  and v7- <dig>  have been all sequenced with second generation sequencing technology offered previously by roche and more recently by illumina technologies . however, depending on the region sequenced, biases can be introduced .

illumina miseq sequencing is currently the most widely applied platform for bacterial 16s rrna gene amplicon sequencing. its latest chemistry allows the sequencing of 300 bp pcr fragments in both directions with full overlap and makes it appropriate for the sequencing of single variable regions and the bacterial 16s rrna v1- <dig> gene region where full sequence overlap is desired  <cit> . however, the short read approach by second generation sequencing introduces biases depending on which variable regions are used and can not provide effective resolution below the bacterial genus level, limiting microbial ecology studies  <cit> . further, a large proportion of the bacterial 16s rrna gene records in the genbank database labeled as environmental samples are unclassified, which is in part due to low read accuracy, potential chimeric sequences produced during pcr amplification and the low resolution of short amplicons. high throughput full-length bacterial 16s rrna gene sequencing methodologies with reduced biases are needed.

historically, we were able to sequence full-length bacterial 16s rrna gene by conventional cloning and sanger sequencing. however, this is laborious, costly, and is low throughput. a new alternative for full-length bacterial 16s rrna gene sequencing is offered by the third generation pacific biosciences single molecule, real-time  sequencing technology. the latest pacbio p6/c <dig> chemistry offers very long reads, where half of the reads > <dig>  base pairs long and each smrt cell yields an average of  <dig>  reads from a 4 hour run . phylogenetic profiling based on full-length bacterial 16s  rrna gene requires high read accuracy, and this should be achieved through the use of pacbio circular consensus sequencing . in ccs, the dna polymerase reads a ligated circular dna template multiple times, depending on amplicon size, read length and sequencing movie length  <cit> , effectively generating a consensus sequence from multiple reads of a single molecule.

few studies have investigated the efficacy of pacbio 3rd generation sequencing for full-length bacterial 16s rrna genes using ccs. mosher and colleagues reported the first sequencing of full-length bacterial 16s rrna gene amplicons from environmental samples  using the pacbio rs smrt sequencing platform with xl/c <dig> chemistry in comparison with the roche  <dig> gs flx chemistry  <cit> . the roche  <dig> bacterial 16s rrna v1v <dig> gene sequences could be grouped into  <dig> clusters ) at 97% sequence identity, whereas the pacbio bacterial 16s rrna v1v <dig> gene sequences were grouped into  <dig> clusters  at 97% sequence identity. the pacbio full-length bacterial 16s  rrna gene sequences were grouped into  <dig> clusters  at 97% sequence identity. the >10-fold increase in the number of otu clusters obtained from the pacbio platform reflected the large sequencing error rate in the pacbio data at that time. one year later the same group reanalyzed two of their libraries with the updated p4/c <dig> chemistry and a run time of 180 minutes  <cit> . the pacbio rs ii platform combined with p4/c <dig> chemistry improved sequence accuracy and number of high quality reads, compared to their initial assessment, from 80% to > 99% for the full length bacterial 16s rrna gene sequence. in addition the number of reads obtained from the sediment sample doubled from 4563- <dig> sequences to 8260- <dig> sequences when using the newer chemistry.

singer and colleagues reported the comparison of pacbio full-length bacterial 16s rrna gene sequencing with illumina hiseq  <dig> metagenomic shotgun sequencing and miseq bacterial 16s rrna v <dig> gene region sequencing using a mock community as well as an environmental sample from sakinaw lake, british columbia  <cit> . when they compared the pacbio full-length bacterial 16s rrna gene taxonomic resolution with in silico generated pacbio bacterial 16s rrna v <dig> gene region at various taxonomic levels, they were able to classify a higher proportion of phylum, class, family, genus and species level from the full-length bacterial 16s rrna gene dataset compared to the in silico generated pacbio bacterial 16s rrna v <dig> gene region.

the group reported minor differences between datasets from illumina miseq bacterial 16s rrna v <dig> gene region and pacbio full-length bacterial 16s rrna gene in the classifiable otus. pacbio full-length bacterial 16s rrna gene sequencing resolved all  <dig> otus in the mock community, whereas illumina bacterial 16s rrna v <dig> gene sequencing could not resolve closely related species.

the most comprehensive analysis of pacbio full-length bacterial 16s rrna gene sequencing was recently published by schloss et al.  <cit> . they sequenced different bacterial 16s rrna gene regions  from a defined mock community and natural samples from human feces, mouse feces and soil environment. their sequence error rates reported ranged between  <dig> % and  <dig> % for the above bacterial 16s rrna gene regions.

the use of full-length sequencing for bacterial 16s rrna gene analysis would have significant advantages over current approaches. however, only a few studies have investigated the use of pacbio technology for the sequencing of the full-length 16s gene . thus, more information is urgently needed to identify the advantages and disadvantages of pacbio ccs for bacterial full-length 16s rrna gene sequencing.

previous studies including the lasted study from schloss et al.  <cit>  compared pacbio sequencing with illumina sequencing, both are know to be error prone. in our study we also included a pool of capillary sequenced stool colonies. thus, the aim of our study was to validate the latest pacbio p6/c <dig> sequencing chemistry using three approaches: 1) sequencing the full-length bacterial 16s gene from a single bacterial species staphylococcus aureus to analyze error modes and to optimize the bioinformatics pipeline for further analyses 2) sequencing the full-length bacterial 16s rrna genes from a pool of  <dig> different bacterial colonies from stool to compare with full-length bacterial 16s rrna genes capillary sequenced and 3) sequencing the full-length bacterial 16s rrna genes from  <dig> vaginal microbiome samples and comparing the pacbio full-length bacterial 16s rrna genes and in silico selected bacterial 16s rrna v1v <dig> gene region with bacterial 16s rrna v1v <dig> gene regions sequenced using the illumina miseq from the same samples.

methods
pacbio sequencing of staphylococcus aureus 16s dna
all polymerase chain reactions  were performed in triplicates using the new england biolab  q <dig> high-fidelity polymerase kit. twenty ng of staphylococcus aureus deoxyribonucleic acid  was pcr amplified in a total reaction volume of 50 μl together with 200 μm dntps,  <dig>  μm forward primers ,  <dig>  μm reverse primer , and  <dig>  μl q <dig> taq enzyme. each pcr was done in triplicate with 20 cycles. cycling conditions were as follows: denaturation at 98 °c for 2 minutes, followed by 30 cycles of amplification  and a final extension at 72 °c for 5 minutes. pcr product was purified with 50 μl ampure xp beads  according to illumina’s 16s metagenomic sequencing library preparation protocol pages 8- <dig>   <cit> . the amplified dna was sequenced using the pacbio smrt sequencing technology according to the standard manufacturers conditions. smrt bell library prep and sequencing used the currently available reagent kits template preparation  <dig> , polymerase binding p <dig>  and sequencing chemistry c <dig>  data was captured using 3-hour movies.

pacbio sequencing of bacterial 16s rrna gene from intestinal microbiome species and human vaginal microbiome
faecal samples from six healthy human donors were plated by the host-microbiota interactions group at the wellcome trust sanger institute and from these single colonies were picked and identified using full-length bacterial 16s rrna gene capillary sequencing  <cit> . whole genome dna was extracted from each unique species and  <dig> of these were pooled in equal volumes for subsequent analysis.

for the human vaginal microbiome study, dna from  <dig> cervico-vaginal lavage cell pellets from a microbicide feasibility study in tanzania  <cit>  were extracted using fastdna® spin kit for soil  at the london school of hygiene and tropical medicine and were to the wellcome trust sanger institute. all pcr reactions were performed using the neb q <dig> high-fidelity polymerase kit, as above. each pcr was done in triplicate with 20 cycles and using the same pcr condition as above. the bacterial full-length 16s rrna pcr primers included the pacbio barcodes are described here . pcr primers were purchased from integrated dna technology . pcr products were purified with ampure xp beads, as above, and the amplified dna was sequenced as above. for the human vaginal microbiome study, the dna concentration was determined by qubit quantification using qubit  <dig>  flurometer and the high sensitivity dna reagents . samples were pooled in equimolar concentration and gel purified using the wizard® sv gel and pcr clean-up system . the library size was confirmed on a tape station  before pacbio smrt sequencing as above.

illumina miseq sequencing of human vaginal microbiome dna
all pcr reactions were performed using the new england biolab  q <dig> high-fidelity polymerase kit, as above. the dna was amplified with illumina adapter and indexed pcr primers using a dual-index sequencing strategy to target the bacterial v1v <dig> 16s rrna gene  <cit> . each pcr was done in triplicate with 20 cycles with the same cycling conditions as above. the pcr reaction mix contained 200 μm dntps,  <dig>  μm v <dig> forward primers ,  <dig>  μm v <dig> reverse primer , and  <dig>  μl q <dig> taq enzyme. all primers except the read  <dig> sequencing primer were purchased from idt . the read  <dig> sequencing primer was lna modified at position  <dig>   <dig>  and  <dig>  and was purchased from exiqon . pcr product was purified with ampure xp beads  the same as above. the equimolar library mix was prepared the same way as above. the library size was confirmed on a tape stations  before submitting for miseq sequencing using the 600 cycle miseq reagent kit v <dig>  the library was sequenced at the wellcome trust sanger institute .

bioinformatics for pacbio sequence analysis
raw sequences were initially processed through the pacbio smrt portal. sequences were filtered for a minimum of 1-, 2-, 4-, and  <dig> passes, and a minimum predicted accuracy of 90%. downstream bioinformatics analysis was performed using the software package mothur   <cit> , uchime  <cit> , and arb – a software environment for sequence data   <cit> .

the following steps were done in mothur: the pacbio obtained “fastq.txt” file was first processed with the “fastq.info” command, which generated a fasta and quality file. both files were then used for amplicon size trimming to remove sequences outside the expected amplicon size  using the “trim.seqs” command. a second “trim.seqs” step was performed to remove any ambiguous sequences, sequences with homopolymers longer than 6 bp, and sequences with a quality window average below  <dig> over a rolling quality window size of 50 bp. unique sequences were generated and aligned with sequences of the silva reference database release  <dig>  which is available from the mothur homepage  <cit>  using the default kmer searching method with the flip parameter set to true. the aligned sequences were screened using the “screen.seqs” command to remove alignment outside the expected alignment coordinates . in order to decrease the sequencing error rate, we also implemented an additional screening step using the align report from the “align.seqs” step and screened the aligned sequences, setting the minscore to  <dig> or  <dig>  and the minsim to  <dig> or  <dig> . then the “filter.seqs” command was used to remove empty columns. the filtered sequences were pre clustered allowing 1% mismatch. the pre clustering implements a pseudo-single linkage algorithm with the goal of removing sequences that are likely due to sequencing errors. as a general rule we allow 1% difference  for the bacterial 16s gene. sequences were checked for chimeras using chimera uchime and the template option set to self. high quality filtered sequences were used for matrix generation  and the phylip generated distance matrix was clustered into operational taxonomic units  using a cutoff of  <dig> . sequencing error was determined with mothur using staphylococcus aureus m <dig> as a reference sequence. high quality sequences and otus were classified using silva.nr_v <dig> tax database, which is available from the mothur homepage. all figures were generated in graph pad prism  <dig> for mac version  <dig> e .

bioinformatics for miseq sequence analysis
a total dataset of over  <dig> human vaginal microbiome samples were processed. the forward and reverse fastq files were processed according to the miseq sop  <cit>  with additional adjustments: for the “make.contigs” command we set “trimoverlap = t”. no ambiguous sequences were allowed and the maximum number of homopolymers was set to six. using the silva bacterial database “silva.nr_v <dig> align” with the flip parameter set to true aligned the sequences. the “screen.seqs” command was used to remove sequences outside the expected alignment co-ordinates . the subsequent filtered sequences were de-noised by allowing three mismatches in the “pre.clustering” step. chimeras were removed using uchime with the dereplicate option set to “true”. sequences were further classified using the silva reference database “silva.nr_v <dig> align” and the silva taxonomy database “silva.nr_v <dig> tax” and a cut off value of 80% and the un-classified sequences were removed. the original datasets were screened for any contaminations identified either in the dna extraction controls or in negative pcr controls. those contaminants were removed using the “remove.lineage” from the final high quality fasta file, name file and group file. the same  <dig> samples which were used for the pacbio sequencing were then extracted from the total sample cohort using the “get.group” command and used for the generation of a square distance matrix. the matrix was clustered with the automatic set “cluster.classic” command with following parameters: precision =  <dig>  method = average, hard = t, sim = f. a shared file  was generated to identify the number of otus at each distance for further analysis.

we also generated a subsampled datasets comparable with pacbio sequencing using the “sub.sample” command. for this we subsampled the final high quality fasta, group and name file to  <dig> sequences . the subsampled datasets was again used for matrix generation and clustering as outlined above. otus with only one sequence  were considered to originate from pcr errors and sequencing errors and therefore were removed from all pacbio and the miseq datasets using the “remove.rare” command in mothur. the remove.rare command only takes a list and a group file, thus we used the “list.seqs” command to generate an “accnos” file from the singletons free group file. the accnos file was then used to get the singletons free fasta sequences from the fasta and name file using the “get.seqs” command. both, the total number of otus and singletons free otus are outlined in table  <dig>  the singletons free otus were used for bacterial taxonomic profile analysis using the arb software.table  <dig> vaginal human microbiome analysis


hqr high quality reads, v1v <dig> full-length bacterial 16s gene, v1v <dig> bacterial 16s v1v <dig> gene region, minscore = minimum alignment score during post alignment screening, minsim = minimum similarity score during post alignment screening, otu operational taxonomic units, value in round brackets number of singleton-free otus 




bioinformatics for alpha diversity analysis of the human vaginal microbiome samples
a shared file  was generated for the unique and 97%  otu distance level from the singletons otu free list file and group file using the “make.shared” command. for miseq analysis we used the subsampled datasets. the “summary.single” command was used to calculate the number of observed otus; “sobs”, the estimated richness index; “chao”, the sample “coverage” index; and three different diversity indexes, namely “inverse simpson, shannon and q statistic ”.

we used these three different diversity indexes because they all differ in the mathematical method for the emphasis of taxon  richness and abundance.

the simpsons index squares the relative abundance and the weight of rare species will thus be reduced relatively more than that of more abundant species. thus, the simpson index gives more weight to common or dominant species and the total species richness is down weighted relative to evenness. the shannon index includes a log of the relative abundance of species and the weight of abundant species will thus be reduced slightly relative to more rare species in comparison to the simpsons index. the q statistic is a bridge between the abundance models and diversity indices and is not weighted towards very abundant or rare species  <cit> . the q statistic analysis is based on measuring the “inter-quartile slope” on the cumulative species abundance curve.

RESULTS
in this study we: 1) evaluate the accuracy for the latest pacbio chemistry p <dig> using dna from a single bacterial species ; 2) compared pacbio sequencing with capillary sequencing using a pool of  <dig> species isolated from human stool samples; and 3) compared pacbio sequencing and illumina miseq sequencing using human vaginal microbiome samples. we also evaluated the resolution power of full-length bacterial 16s rrna gene analysis in identifying candidate species in stool colonies and vaginal microbiome samples. table  <dig> shows the number of pacbio filtered ccs reads using 90% minimum predictive accuracy across the different sample sets tested. as expected we observed a steady decrease in the number of reads obtained as filtering progressed from the ≥ <dig> pass filtering to the ≥ <dig> pass, ≥ <dig> pass, and finally ≥ <dig> pass filtering . the largest numbers of sequences were lost between the ≥ <dig> pass and ≥ <dig> pass filtering. using the ≥ <dig> pass filtered datasets would reduce the number of raw reads by  <dig> % , by  <dig> % , and by  <dig> %  compared to the  <dig> pass dataset .table  <dig> pacbio raw sequence reads across different sample sets


staphylococcus aureus
percent in brackets represent the proportion of sequence decrease compare to the  <dig> pass dataset




staphylococcus aureus analysis
the pacbio consensus circular reads  were filtered for a minimum of  <dig> pass,  <dig> passes,  <dig> passes, and  <dig> passes using the pacbio smrt portal. the number of raw reads, trimmed sequences ), otu clusters at unique,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  distance level, and overall sequence error rates were calculated for the standard quality filtered datasets and for datasets with extra post alignment screening using a minimum alignment score of 80% or 90% and a minimum similarity score of 80% or 90% . the high number of otus obtained from the standard quality filtering across the different passes prompted us to implement post alignment screening in order to decrease the number of spurious otus and hence improve the sequence error rates. theoretically, a single bacterial mock community should only generate one otu at 97% sequence similarity. a 97% identity to partial-length bacterial 16s rrna sequence is commonly accepted for species definition.fig.  <dig> change in sequence error rate a and the proportion of high quality reads that were retained when using different sequencing curation methods b. a the overall sequence error rates are plotted on the y-axis. the x-axis show the different allowed mismatches in the pre-clustering steps  across the different screened datasets: no post alignment screening, post alignment screening using minimum sequence similarity  and minimum alignment score of  of 80%, post alignment screening using minsim and minscore of 90%. the round, square, top facing triangle and bottom facing triangle symbols denotes the  <dig> pass,  <dig> pass,  <dig> pass, and  <dig> pass datasets, respectively. b top panel – bold symbols, number of filtered raw reads across the different  <dig> pass,  <dig> pass,  <dig> pass, and  <dig> pass datasets. top panel – open symbols, number of high quality reads  across the different post aligned screened datasets, i.e. no post alignment screening, post alignment screening using minimum sequence similarity and minimum alignment score of 80% , post alignment screening using minimum sequence similarity and minimum alignment score of 90% . b bottom panel, + symbol = number of hqrs in the pre-clustered dataset with  <dig> allowed mismatches, x symbol = number of hqrs in the pre-clustered dataset with  <dig> allowed mismatches, circle with dot = number of hqrs in the pre-clustered datasets with  <dig> allowed mismatches




as expected, implementing the post alignment screening effectively reduces the sequence error rate . the low stringency post alignment screening  did not much improve the sequence error rate compared to the non-post alignment screening for either of the passes  or different allowed pre-clustering mismatches . a dramatic improvement in sequence error rate was observed by increasing the allowed mismatches in the pre-clustering step. this was true for all three different post alignment screened datasets . the lowest sequence error rate was  <dig> % which was obtained from the high stringency post aligned screened dataset with  <dig> allowed mismatches in the pre-clustering step, followed by  <dig> % for the same datasets but allowing for  <dig> mismatches in the pre-clustering step .

the improvement in sequence error rate was strongly associated with a reduction of high quality pre-clustered sequences. this was particularly pronounced in the high stringency  screened datasets .

as expected, an increase in passes  did decrease the number of raw reads obtained from the pacbio platform, from  <dig> , to  <dig> , to  <dig>  and  <dig>  reads, respectively . however, the number of high quality sequences did not decrease accordingly. they were very similar across the  <dig> pass,  <dig> pass, and  <dig> pass datasets . the  <dig> pass dataset had the lowest number of high quality sequences which was between  <dig>  and  <dig>  compared to the  <dig> pass dataset which was between  <dig>  and  <dig> .

we plotted the different sequence error types from the 4-pass dataset with  <dig> allowed mismatches in the pre-clustering step, obtained from the “seq.error” step in mothur in graph pad. figure  <dig> shows that the largest proportion of sequence errors were deletions. the high stringency post alignment screening, using a minimum of 90% search score and a minimum of 90% similarity score to template sequences reduced the sequence error rate from  <dig> % to  <dig> % compared to the no post aligned screened dataset, which also resulted in a substantial reduction of all sequence error types, mostly deletion and insertion errors .fig.  <dig> comparing sequence error types across different alignment filtering. the different types of sequencing errors, obtained from the mothur error report file, were plotted in graph pad prism  <dig>  the x-axis shows the base pair position in the full-length bacterial 16s rrna gene and the y-axis shows the sequence error rate on a log  <dig> scale. the abundance of substitution errors, insertion errors, and deletion errors using standard quality filtering a, with low stringency post alignment filtering b, and high stringency post alignment filtering c are shown. the standard quality filtering parameters were: maximum ambiguous sequences =  <dig>  maximum number of homo-polymers  <dig>  sequence quality average of  <dig> over a sequence quality window of 50 bp. the extra post alignment screening parameters were: post alignment screening using minimum sequence similarity and minimum alignment score of 80% b and post alignment screening using minimum sequence similarity and minimum alignment score of 90% c





the low stringency post alignment screening using a minimum of 80% search score and a minimum of 80% similarity score had little effect in the overall reduction of the sequence error  compared to the standard quality filtered datasets with no post alignment screening . the slightly observed increase of the sequence error rate in the  <dig> pass dataset is a result of the lower total number sequences in this datasets. we also identified that substitution errors were not evenly distributed across the full-length bacterial 16s  rrna gene but were detected at hotspots across the full-length bacterial 16 s rrna gene . all  <dig>  high quality sequences of the no-post aligned screened  <dig> pass datasets with  <dig> allowed mismatches had a total of  <dig>  sequence errors. of these,  <dig>   were insertions,  <dig>   were deletions, and  <dig>   were substitutions. the proportions of error types were very similar for the high stringency post aligned screened  <dig> pass datasets. the  <dig>  high quality sequences had  <dig>  sequence errors of which  <dig>  were insertions,  <dig>   were deletions, and  <dig>  were substitutions.

the result of this “test of principle” using dna from a single bacterial species was used to validate and optimize the bioinformatics pipeline for pacbio sequences.

our quality filtering steps including  trimming by length ,  removing homo polymers longer than 6 bp,  removing all sequences with ambiguous base pairs,  using a quality average score of  <dig> over a rolling quality window of 50 bp, all of which produces a very consistent number of high quality reads across the ≥ <dig> pass, ≥ <dig> pass, and ≥ <dig> pass datasets. the ≥ <dig> pass filtering did not decrease the sequence error rate any further, but further reduced the number of high quality reads. therefore, we used the ≥ <dig> pass filtering for the stool sample analysis and human vaginal microbiome sample analysis.

pooled stool microbiome analysis
the pacbio consensus circular reads were filtered for a minimum of  <dig> passes using the pacbio smrt portal. a total of  <dig>  high quality reads  were obtained using standard quality filtering. using the low stringency post alignment screening  and high stringency post alignment screening  decreased the number of high quality reads by another  <dig>  and  <dig> reads, respectively. as expected we observed a higher number of otus in the low stringency post alignment screened datasets across the 97% , 98%  and unique otu clusters  . the higher number of otus seen in the low stringency screened datasets compared to the high stringency screened datasets is most likely a result of the high number of deletion errors present in these datasets, as seen in fig. 2b and c.table  <dig> stool sample analysis


abbreviations: 90/ <dig> minimum alignment and similarity score of 90% during post alignment screening, 80/ <dig> minimum alignment and similarity score of 80% during post alignment screening, no number, otu operational taxonomic units




next, we profiled the predicted species using full-length bacterial 16s rrna capillary sequence data from the pooled  <dig> stool colonies using the software package arb and a customized version of the silva ssuref database  that was generated by removing environmental and uncultured taxa. this was compared with the species profile of the pacbio post alignment screened datasets from the 97%, 98% and unique otus cluster . note that the number of species identified is lower than the number of otus as arb will often assign the same species identifier to more than one otu.

forty species were identified from the pool of  <dig> capillary sequenced stool colonies. these were four actinobacteria species, five bacteroidetes species, three bacterium , and  <dig> firmicutes species .  <dig> species  were shared between capillary sequences and all six different pacbio filtered datasets, i.e. low and high stringency post alignment screening at 97%, 98% and unique otu distance level . four additional species were shared with the capillary sequences and the pacbio low stringency post aligned screened dataset for all three otu distance levels. one firmicutes species  was only shared between capillary sequences and the unique distance level from the low stringency post aligned screened datasets. this brings to a total of 80% shared species between the low post alignment screened datasets  and capillary sequences.

however, if we accept the higher number of shared species from the low stringency dataset, we would also have to accept a higher rate of false positive identified species. between eight to  <dig> additional false positive species were identified from the low stringency post aligned screened dataset compared to three to four for the high stringency post aligned screened dataset. the higher number of otus from the standard quality filtering without post alignment screening,  <dig> otus for the unique otu distance level,  <dig> otus for 98% otu distance level, and  <dig> otus for the 97% otu distance level, did not identify additional false positive species . eight species  were only classified by capillary sequencing. this highlights that 20% of species  from the pooled stool colonies could not be classified by pacbio sequencing.

human vaginal microbiome analysis
eleven human vaginal microbiome samples were sequenced with pacbio p <dig> chemistry and with illumina miseq sequencing using the 600-cycle kit, which enabled the full-overlap paired-end sequencing of the bacterial 16s rrna v1v <dig> gene region. the pacbio samples were barcoded with standard pacbio barcodes as outlined in additional file 1: table s <dig>  for further analysis we used the  <dig> pass filtered datasets. the pacbio smrt portal barcode filtering was able to assign  <dig>  sequences to the eleven barcodes. we were able to increase the number of barcoded sequences by using mothur software and the “fastq.info” function, which allows a user-defined barcode list and adjustable mismatches in the barcode sequence. allowing four mismatches in the barcode sequence generated the same number of barcoded sequences as the pacbio smrt portal . the number of barcoded sequences could be increased to  <dig>   <dig>  and  <dig> reads by allowing one, two, and three mismatches in the barcode, respectively . for further analysis we used the filtered datasets with  <dig> allowed mismatches in the barcode. the miseq samples were part of a larger bacterial vaginosis study and were indexed with standard miseq indexing as outlined in the materials and methods section. the overall sequence error rate in the miseq data set was  <dig> %.

the total number of high quality reads and otus at the unique, 99%, 98% and 97% distance levels are shown in table  <dig>  the numbers of high quality reads in individual samples are shown in additional file 3: table s <dig>  for pacbio we analyzed the full-length bacterial 16s rrna gene and the in silico selected bacterial 16s rrna v1v <dig> gene region, using the low stringency and high stringency post aligned screened datasets. this was compared with the miseq full-overlap paired-end sequenced bacterial 16s rrna v1v <dig> gene region of the same sample cohort . for pacbio, we observed a very large number of otus in the low stringency post aligned screened datasets. this was most obvious for the full-length bacterial 16s rrna gene at unique , 99% , and 98%  distance level, compared to  <dig> otus,  <dig> otus, and  <dig> otus for the same distance level, respectively, using the high stringency post aligned screened datasets. the largest proportions of the additional otus in the low stringency datasets were singleton otus. the differences between the pacbio in silico selected bacterial 16s rrna v1v <dig> gene region in regards to the observed number of otus between the two different post alignment screened datasets was much smaller. the difference was even smaller after removing the singleton otus . we analyzed the miseq dataset with all sequences  and with a subsampled datasets of  <dig>  sequences which was equivalent to the number of pacbio in silico selected bacterial 16s rrna v1v <dig> gene region dataset from the low stringency post alignment screening. as expected the number of otus was higher by analyzing the non-subsampled miseq bacterial 16s rrna v1v <dig> gene sequences. the number of singletons free otus in the subsampled miseq datasets was similar to the number of singletons free otus in the pacbio in silico selected bacterial 16s rrna v1v <dig> gene datasets .

alpha diversity analysis of the human vaginal microbiome samples
alpha diversity analysis was performed using one-way anova. the alpha diversity analysis of the unique otu distance level is shown in fig.  <dig> and the 97% otu distance level is shown in fig.  <dig>  dashed lines in figs.  <dig> and  <dig> represent significant differences between the different datasets at 95% confidence interval .fig.  <dig> alpha diversity analysis using unique otu distance. several different alpha diversity indexes: number of observed otus a; chao community richness b; shannon diversity index c; q statistic – qstat diversity index d; inverse simpson diversity index e; and sample coverage index f calculated in mothur are shown for five different datasets analyzed. lines connect the same samples in each dataset. statistical analysis was performed in graph pad using the one-way anova for between group comparisons. abbreviations: otu = operational taxonomy unit, miseq = illumina miseq sequencing platform, v1v2 = bacterial 16s rrna gene region v <dig> to v <dig>  v1v9 = bacterial full-length 16s rrna gene, lo = pacbio datasets with low stringency post alignment screening using a minimum alignment score of 80% and minimum alignment similarity score of 80%. hi = pacbio datasets with high stringency post alignment screening using a minimum alignment score of 90% and a minimum alignment similarity score of 90%. dashed line = significant difference at 95% confidence interval 


fig.  <dig> alpha diversity analysis using 97%  otu distance. several different alpha diversity indexes: number of observed otus a; chao community richness b; shannon diversity index c; q statistic – qstat diversity index d; inverse simpson diversity index e; and sample coverage index f calculated in mothur are shown for five different datasets analyzed. lines connect the same samples in each detection method. statistical analysis was performed in graph pad using the one-way anova for between group comparisons. abbreviations: otu = operational taxonomy unit, miseq = illumina miseq sequencing platform, v1v2 = bacterial 16s rrna gene region v <dig> to v <dig>  v1v9 = bacterial full-length 16s rrna gene, lo = pacbio datasets with low stringency post alignment screening using a minimum alignment score of 80% and minimum alignment similarity score of 80%. hi = pacbio datasets with high stringency post alignment screening using a minimum alignment score of 90% and a minimum alignment similarity score of 90%. dashed line = significant difference at 95% confidence interval . § = these datasets did not pass the normality test




to test whether the datasets used for alpha diversity analysis followed a gaussian distribution, we tested each dataset using the d’agostino-person omnibus normality test and the shapiro-wilk normality test. all datasets except the dataset used for the inverse simpson diversity index at 97%  otu distance level passed the normality test .

the number of observed 97% otus was significantly higher in the miseq bacterial 16s rrna v1v <dig> gene region dataset compared to pacbio full-length bacterial 16s rrna gene dataset and pacbio in-silico bacterial 16s rrna v1v <dig> gene region, high stringency post aligned screened dataset . for both distance levels , we observed a significantly larger number of otus in the low stringency aligned screened pacbio datasets compare to the high stringency post aligned screened pacbio datasets . the chao community richness estimation resulted in a similar number of otus compared to the observed otus . we also observed similar significant differences for the chao richness estimators and observed otu between the different datasets. the shannon diversity index was significantly different between all group comparisons except for the comparison of the low and high stringency screened pacbio full-length bacteria 16s  rrna gene datasets at 97% otu level . this was in contrast to the qstat diversity index which revealed significant differences between the miseq bacterial 16s rrna v1v <dig> gene region dataset and pacbio full-length bacterial 16s rrna gene dataset for the unique otus  and no significant differences between groups using the 97% otus . the inverse simpson diversity index was significantly higher in the miseq bacterial 16s rrna v1v <dig> gene region data set compared to any of the pacbio datasets at the unique and 97% otu distance level . three out of five datasets used for the inverse simpson diversity analysis at 97% distanced level  did not pass the normality test. the same dataset was tested by the non-parametric kruskal-wallis test, which was not significant. the sampling coverage index was above  <dig> % for all unique otu datasets  and slightly less  for all 97% otu datasets .

bacterial species profiling
we also compared the bacterial taxonomic profile between the pacbio full-length bacterial 16s rrna gene, pacbio in silico selected bacterial 16s rrna v1v <dig> gene region and the miseq bacterial 16s rrna v1v <dig> 1gene region. for this we profiled the representative sequences of the singleton-free unique otus from the vaginal sequence dataset using the software package arb and the customized version of the silva ssuref database . seventy species from  <dig> otus were identified using the miseq bacterial 16s rrna v1v <dig> gene region protocol . when compared with low stringency post aligned screened pacbio in silico selected bacterial 16s rrna v1v <dig> gene region dataset and pacbio full-length bacterial 16s rrna gene dataset, we detected  <dig> shared species  and  <dig> shared species , respectively. the number of shared species decreased to  <dig>  using the pacbio high stringency post aligned screened dataset.table  <dig> vaginal microbiome species profiling

 <dig> otus =  <dig> species
 <dig> otus =  <dig> species
 <dig> otus =  <dig> species
 <dig> otus =  <dig> species
 <dig> otus =  <dig> species

abbreviations: minscore minimum alignment score during post alignment screening, minsim minimum similarity score during post alignment screening, otu operational taxonomic units, miseq illumina miseq sequencing, v1v <dig> bacterial 16s rrna v1v <dig> gene region, v1v <dig> full-length bacterial 16s rrna gene




discussion
this study aimed to validate the value of full-length bacterial 16s rrna gene sequencing using pacbio rs ii platform and to compare with capillary sequencing and short-read illumina miseq sequencing for bacterial species classification.

we used the pacbio full-length bacterial 16s rrna gene sequence data of a staphylococcus aureus lab strain for bioinformatics pipeline validation and for pipeline optimization. for our pacbio sequence quality filtering we introduced two different post alignments screening with an 80% minimum alignment and similarity score  or 90% minimum alignment and similarity score . the implementation of a post alignment screening did effectively decrease the number of pre-clustered sequences. this was particular dominant for high stringency screening for all three different pre-clustering parameters  .

this resulted in a dramatic decrease in the number of otus, particularly at 98%  and 97%  distance level .

this large decrease in otus, was most likely a consequence of removing large numbers of singleton otus originating from pacbio sequencing errors. our implemented quality filtering steps removed low quality reads very consistently from the four different pacbio filtered ≥ <dig> pass, ≥ <dig> pass, ≥ <dig> pass and ≥ <dig> pass datasets. interestingly, the sequence quality filtering resulted in very similar numbers of high quality reads from all four different filtered datasets despite large variations in the number of raw reads between the ≥ <dig> pass  and ≥ <dig> pass  datasets . this emphasizes that a good quality filtering step is of great importance and that an increase in the minimum number of passes for pacbio ccs reads did not generate a larger number of high quality reads after using our applied quality filtering parameters. we further analyzed the effect of different post alignment screening and different allowed mismatches during the pre-clustering step on overall sequence error rates and sequence error types. as expected the sequence error rate decreased depending on the allowed mismatches during the pre-cluster step. in the no post aligned screened dataset, the overall sequence error rate decreased from  <dig> %, to  <dig> %, and to  <dig> % allowing  <dig>   <dig>  or  <dig> bases mismatches during the pre-clustering . schloss et al reported an overall sequence error rate of  <dig> % allowing  <dig> bases mismatches during the pre-clustering  <cit> . the use of a different mock community and different laboratory/sequencing facility might have contributed to the different outcomes. low stringency post alignment screening did not much improve the sequence error rate, but the high stringency post alignment screening has a dramatic improvement in the overall sequence error rate. we achieved a sequence error rate of  <dig> % and  <dig> % by allowing  <dig> and  <dig> mismatches, respectively, in the pre-clustering step. this was achieved for the  <dig> pass,  <dig> pass, and  <dig> pass dataset. the  <dig> % sequence error rate was smaller compared to the  <dig> % miseq error in this study. within a given dataset and the same allowed pre-clustered mismatches, the number of passes did not improve the sequence error rate: i.e. the sequence error rate was very similar for the ≥ <dig> pass, ≥ <dig> pass, ≥ <dig> pass, and ≥ <dig> pass datasets . this was in contrast to the schloss study, which reported a reduced error rate by  <dig>  to  <dig> % with at least 10-fold coverage  compared to those with less coverage.

we have identified different proportions of sequence error types compared to the schloss study. our highest error types were deletions, which accounted for over 80% of all errors. the most abundant error types in the schloss study were substitutions, which accounted for  <dig> % of all errors, followed by  <dig> % for insertions and  <dig> % for deletions. other groups have reported insertions and deletions as the most abundance error types in pacbio sequence data  <cit> . singer et al  <cit>  also reported that substitutions errors are more difficult to correct than insertion and deletion errors. we could confirm the difficulty of removal of substitution errors, which were still present at the different hotspots after applying the high stringency post alignment screening which otherwise reduced the overall sequence error rate to an excellent range of  <dig> %.

we used the pooled stool clone sequence dataset to investigate the effect of low and high stringency post alignment screening on species classification by comparing 97% , 98% , and unique otu distance level from the  <dig> pass pacbio dataset. if we still consider the sanger capillary sequencing of the full-length bacterial 16s as the gold standard for species identification, then the discrepancy in species detection between pacbio sequence data and capillary sequencing indicates that the sequencing error rates in pacbio consensus circular reads can lead to additional classification of false positive species. the larger number of shared species between capillary sequence data and the low stringent screened sequence data comes at the expense of identifying a larger proportion of false positive species. the larger number of false positive species in the low stringency post alignment screened dataset is a reflection of the higher number of otus obtained using the low stringency screening parameters . we could not identify a bias regarding different phyla and genera classification between capillary and pacbio full-length bacterial 16s rrna gene in the pooled stool community. different species of the same genus were identified by capillary sequencing only, which were not detected by pacbio sequencing and vice versa . this highlights that species identification using bacterial 16s rrna gene is a difficult process and should be conducted and concluded with great care.

in our human vaginal microbiome analysis we pooled  <dig> barcoded samples in one pacbio run and the coverage index showed good sampling coverage across all  <dig> samples. the similarity between species detected by miseq sequence data and pacbio sequence data was less consistent, despite a similar number of singletons free otus detected by the two platforms  . interestingly, the largest numbers of species were identified from the miseq bacterial 16s rrna v1v <dig> gene region datasets, despite containing the lowest number of otus compared to any of the pacbio datasets . from the pacbio low stringency screened in silico bacterial 16s rrna v1v <dig> gene region dataset, 39/ <dig> species  were shared with the  <dig> miseq species, whereas from the high stringent screened in silico bacterial 16s rrna v1v <dig> gene region dataset 26/ <dig> species  were shared with the  <dig> miseq species. the smaller number of otus and consequently smaller proportion of miseq shared species from the pacbio high stringency post aligned screened datasets  suggests that high stringency screening removed additional true positive otus and hence species from the dataset. on the other hand, low stringency post alignment screening resulted in an additional detection of  <dig> species compared to  <dig> species from the high stringency post alignment screening, which were not detected in the miseq dataset. the same pattern of additional false positive species using low stringency screening was observed in the stool colony study.

the increased species diversity from the pacbio in silico selected bacterial 16s rrna v1v <dig> gene region and miseq bacterial 16s rrna v1v <dig> gene region datasets reflects that analysis of partial bacterial 16s rrna gene regions may overestimate bacterial diversity compare to the full-length bacterial 16s rrna gene. a previous study reported a similar discrepancy in the number of otus between partial bacterial 16s rrna gene regions and full length bacterial 16s rrna gene  <cit> .

our observed discrepancy between pacbio full-length bacterial 16s rrna gene dataset and shorter in silico pacbio bacterial 16s rrna v1v <dig> gene region dataset is in similar accordance with a study conducted by singer et al.  <cit> . in their sakinaw lake community dataset they could classify  <dig> % species from the full-length bacterial 16s rrna gene dataset and  <dig> % of species from the in silico bacterial 16s rrna v <dig> gene region dataset.

the fact that the forward pcr primer for the full-length bacterial 16s rrna gene differed by two nucleotides from the pcr primer for the bacterial 16s rrna v1v <dig> gene region  and the obvious different reverse pcr primers may also contributed to different taxonomic profiling. it has been recently reported that pcr primer choice influences bacterial 16s rrna gene-based profiling, and that this was particularly dominant in the detection of bifidobacterium in the human infant gut microbiome with slightly different 27f forward primer composition  <cit> .

koren et al.  <cit>  demonstrated that the clustering of enterotypes across different body habitats is difficult to establish and to interpret. the same group also compared the efficiency of enterotype clustering using different bacterial 16s rrna gene regions on fecal samples from the human microbiome project. depending on the clustering method used they detected different outcomes for bacterial 16s rrna v1v <dig> gene region and v3v <dig> gene region. no studies are available yet, which have investigated the enterotype clustering across different body habitats using full-length bacterial 16s rrna gene data. however, using full-length bacterial 16s rrna gene data might provide a good method for consistent enterotype clustering for multimodal distributions of sample abundances in the case of vaginal sequence data.

CONCLUSIONS
in this study we compared  capillary full-length bacterial 16s rrna gene sequencing with pacbio full-length bacterial 16s rrna gene sequencing using a pool of stool colonies, and  pacbio full-length bacterial 16s rrna gene sequencing and pacbio in silico generate bacterial 16s rrna v1v <dig> gene region with miseq bacterial 16s rrna v1v <dig> gene region using human vaginal samples.

our implemented post alignment screening dramatically improved the sequence error rate. however, high stringency post alignment screening can remove true positive species, whereas low stringency quality filtering can result in a higher number of false positive species. thus, a fine balance in sequence quality filtering is necessary to achieve the best outcome in using pacbio technology for full-length bacterial 16s rrna gene sequencing. the taxonomic profiling effectiveness between different bacterial 16s rrna gene regions and full-length bacterial 16s rrna gene needs further validation, to determine whether the full-length bacterial 16s rrna gene will provide better bacterial classification across different sample types. a true advantage of sequencing the full-length bacterial 16s rrna gene would be the possible global comparison of microbiome studies, which currently can only be done with great difficulty due to different bacterial 16s rrna gene regions used in different studies.

current bacterial 16s rrna gene studies can include several hundreds to thousands of samples, which can be readily analyzed by high throughput miseq indexing using up to several hundreds of samples per library. depending on bimodal  or multimodal  distribution of sample abundances, we would not recommend to pool more than  <dig> samples for good data differentiation on the current pacbio platform. however, the latest model of the pacbio machine “the sequel system” should be able to deliver about seven times more reads then the current available pacbio instrument . this would make the use of pacbio for full-length bacterial 16s rrna sequencing more attractive for larger datasets.

additional files

additional file 1: table s <dig>  outlines the barcoded pacbio pcr-primers for the full-length bacterial 16s rrna gene. 


additional file 2: table s <dig>  outlines raw reads, high quality trimmed sequences, high quality trimmed unique sequences, number of otus and overall sequence error rates for detailed staphylococcus aureus analysis, across different parameters for post alignment screening , and high ) and different allowed mismatches during the pre-clustering step . 


additional file 3: table s <dig>  shows the numbers of high quality reads in individual vaginal samples across different sequencing platform analysis methods. 


additional file 4: shows the capillary sequence data from  <dig> stool colonies, which were pooled for pacbio sequencing. 




abbreviations
ccscircular consensus sequencing

dnadeoxyribonucleic acid

dntpsdeoxyribose nucleoside triphosphate

otusoperational taxonomic units

pacbiopacific biosciences

pcrpolymerase chain reaction

smrtsingle molecule, real-time sequencing

