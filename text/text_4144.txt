BACKGROUND
a proper understanding of protein pka values is essential to a proper understanding of ph-dependent characteristics of protein function. if the pka of a particular group is known then one can determine its protonation state at a given ph, helping to determine several important properties including protein solubility, protein folding and catalytic activity. knowledge of the pka values of the residues of an active site can help to identify the reaction mechanism of an enzyme or aid in the interpretation of experimental results  <cit> . the pka value is -log <dig> where ka, is the ionization constant, a measure of a titratable group's ability to donate a proton:

ka=     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbwsdawgaawcbagaemyyaegabeaakiabg2da9maalaaabagaei4waslaemisag0aawbaasqabeaacqghrawkaagccqggdbqxcqggbbwwcqwgbbqqdaahaawcbeqaaiabgkhitaaakiabc2fadbqaaiabcufabjabdieaijabdgeabjabc2fadbaacawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaaa@4224@

the pka value is therefore equal to the ph when there is an equal concentration of the protonated and deprotonated groups in solution. each residue with a titratable group has a model or 'intrinsic' pka value, defined as the pka value when all the other groups are fixed in their neutral state. ionizable groups may be divided into acidic, which are neutral in their protonated state, and basic, which are positively charged in their protonated state. the protonated and the non-protonated forms of a residue can be very different chemically. in the case of his, the protonated form is hydrophilic and positively charged while the non-protonated form has a hydrophobic and aromatic character. consequently the nature of the interaction made by an ionizable group may differ significantly at a ph above or below the pka.

pka = pkmodel + Δpka       

the pka shift caused by the environment is not easily quantified. this is especially true of ionizable residues within protein active sites as they often have markedly higher or lower values than the intrinsic pka  <cit> . the three main factors that contribute towards environmental perturbation of the pka value are inter-molecular hydrogen bonding, the desolvation effect and coulombic interactions. previous studies have identified hydrogen bonding as the most important determinant of pka values  <cit> . the hydrogen bonding strength is both distance and angle dependent and therefore the extent of the perturbation is heavily dependent on the position of the interacting residues relative to each other. this is less of a factor with side chain hydrogen bonds than with main chain as the former is more flexible and therefore more likely to adopt an optimal orientation for hydrogen bond interactions. the desolvation effect is also important; this describes the energy that is required to move a group from a state of full solvation to a position within the folded protein. desolvation effects within the protein interior preferentially increases the energies of the negatively-charged, base forms, which will increase the pka value, while in the case of his, lys and arg, the desolvation preferentially increases the energy of the positively-charged, acid forms, which will decrease the pka values. the extent of the shift is dependent on the degree to which the group is buried within the protein. the third of the major factors, which may cause a pka shift, are coulombic interactions between ionizable groups. the pair-wise interactions are dependent on the charges of the respective groups, but also on their location as only residues that are buried produce significant charge-charge interactions.

it is possible to predict the pka value of a given protein residue from three-dimensional structural data. the pka shift may be calculated from the difference in energy between the group's charged and neutral forms and added to the pkmodel value to estimate its true value. several different algorithms have been developed to generate predicted pka values based on structural data.

the majority of papers which have assessed the reliability of pka predictive algorithms have only examined a limited number of proteins, making an evaluation of their accuracy very difficult  <cit> . the largest of these  <cit>  looked at  <dig> experimental pka values taken from  <dig> proteins. here we use a large pka dataset of  <dig> proteins, which is more than double that of the most extensive previous paper  <cit> , to analyse the predictive capabilities of the mcce  <cit> , mead  <cit> , propka  <cit>  and uhbd  <cit>  programs. the programs differ in their methodology and we assessed the merits of each. an enhanced approach to the problem of pka prediction is proposed.

RESULTS
technical difficulties with the uhbd program, due to errors in the protonation of histidine residues, prevented the successful processing of all  <dig> proteins; in total only  <dig> could be completed. this lead to the creation of two separate datasets, the large dataset  and the small dataset . several of the programs produced outliers, in some cases outside of the physically possible ph 0– <dig> range. outliers were removed from the dataset using a variety of different parameters to see the effect upon the overall accuracy of prediction datasets were generated where all predicted values were lesser or greater than the intrinsic values by  <dig>   <dig>   <dig> and  <dig> ph units were removed as well a dataset where only physically possible values were included. this data is presented in table  <dig> and table  <dig>  it may been seen from the data that in general the best results were obtained by using values within a range of  <dig> ph units. using those parameters,  <dig> residues were removed from the large dataset leaving  <dig> and  <dig> residues were removed from the small dataset leaving  <dig> residues. it is unlikely that the pka of a titratable residues can deviate more than  <dig> ph units from the residue's intrinsic value .

outliers 

complete  <dig> removed

true  <dig> removed

within  <dig>  <dig> removed

within  <dig>  <dig> removed

within  <dig>  <dig> removed

within  <dig>  <dig> removed

outliers 

complete  <dig> removed

true  <dig> removed

within  <dig>  <dig> removed

within  <dig>  <dig> removed

within  <dig>  <dig> removed

within  <dig>  <dig> removed

the majority of the outliers in both datasets were generated by the mead program, particularly when the parce force field was used. considerably more residues are present within the +/-  <dig> unit bands for mcce, uhbd and propka. thus there is a clear division between the performance of mead and that of the other programs. the same trend may be seen in the root mean squared deviation  values . propka is more accurate for asp, glu, lys and tyr with rmsd values of  <dig> ,  <dig> ,  <dig>  and  <dig>  respectively. his is more accurately predicted by mcce with an rmsd of  <dig> . with respect to the small dataset in table  <dig>  propka is the best predictor for all residues except glu and his, where uhbd performs best: rmsd of  <dig>  and  <dig>  respectively. the overall accuracy of each program to a level of < <dig>  pka units is 27% amber, 34% parse, 42% mcce, 40% uhbd  and 48% propka. when the error range is increased to < <dig> unit, the difference between the programs is more distinct: 56% amber, 56% parse, 71% mcce, 67% uhbd  and 81% propka . scatter plots for each program are shown in figure  <dig> 

from a previous study  <cit> ,  <dig> carboxyl residues found within protein active sites were selected. these are shown in table  <dig> <cit> . the  <dig> asp and  <dig> glu residues have experimental values that differ from the model pka value by at least  <dig> unit. values for asp and glu range from  <dig>  –  <dig>  and  <dig>  –  <dig>  respectively. propka and uhbd are distinct within the < <dig>  and < <dig> unit error bands , with propka performing best with an accuracy of  <dig> % within the < <dig> unit band. however a large discrepancy exists between the < <dig> and < <dig>  bands for all of the programs, with an approximate 50% drop in accuracy. for the asp residues, propka predicts far better than the other programs, with values of  <dig> %, compared to  <dig> % for mcce and 0% for uhbd at the < <dig>  level. however, for glu residues program performance is closer, with values of  <dig> % for parse, mcce and uhbd and 33% for amber and propka at the < <dig>  level. when the error level is extended to < <dig>  propka is far better, with a value of  <dig> % compared to its nearest rivals uhbd, amber and parse with values of 50%. propka shows an accuracy of 85% to within  <dig> pka unit for surface residues, whereas the same accuracy is limited to 53% with the mcce program for buried residues, a considerable reduction. the accuracy values obtained for mcce were also comparable with those that recently appeared on the program's website, which show an rmsd of  <dig>  and an accuracy range of 98% within the < <dig> ph unit range and 84% accuracy within the < <dig> ph unit range  <cit> .

given the capacity of the predictive programs to under or over predict the true pka value , the possibility of using a consensus approach to integrate the various programs was investigated. using the small dataset, combinations of the prediction values were calculated and the accuracy tested as before. from this dataset,  <dig> combinations  were tried. one, uhbd + propka, leads to improvements in all residues except histidine. the his rmsd value of  <dig> , from this combination, is far better than all of the programs except uhbd, which has a value of  <dig> . the overall accuracy of this combination was not a surprise due to the individual performance of each program. a further attempt to integrate the programs was made by using partial least squared  regression. the pls model generated had a correlation coefficient  of  <dig>  and a cross-validated correlation coefficient  of  <dig> . the resulting equations were applied to the small dataset and the accuracy results are shown in table  <dig>  the accuracy improved greatly in the < <dig>  range to almost 58%, significantly greater than either the other programs run individually or the combination method . again, a disparity between the predictive capabilities of mead and the other programs may be seen. amber and parse have coefficients of - <dig>  and - <dig>  respectively, which are comparatively small compared to the other coefficients . the results above would indicate a more significant relationship between the propka and uhbd predictions and the experimental pka values. this data fits with the trends seen in the other analysis. however, multiple linear regression is not an ideal way to increase predictive accuracy as combining programs will cause the propagation of experimental errors within a given dataset.

the disparity between the predictive capabilities of the program relates to the algorithm that used for the calculation. mead, uhbd and mcce are all based upon an electrostatic continuum model that solves the linearised poisson-boltzmann equation numerically  <cit> . the electrostatic potential φcan be calculated by the poisson-boltzmann equation:

∇ ε ∇ φ  - κ <dig> ε φ  = -4πρ        

whereε is the dielectric constant, r is the position vector, Φ is the electrostatic potential, ρ is the charge distribution and κ is a parameter that represents the effect of mobile ions in solution. all three programs work on the assumption that the major determinant of the pka shift from the model values are the electrostatic effects of burying titratable groups in low dielectric medium. a model of the macromolecule-solvent system is used with dielectric constants of  <dig> for the solvent and  <dig> for the protein. the details of the atomic structure are incorporated into the placement of charges and dielectric boundaries. the calculation accounts for the desolvation energy, the titratable group's interaction with partial charges and the group's interaction with other titratable groups in the protein. mead consistently performs more poorly than the other two poisson-boltzmann-based programs. this may be because, in addition to the basic calculation, uhbd and mcce also incorporate a monte carlo function to sample the multiple conformations of each titratable site. the monte carlo method achieves convergence by random sampling of side chain conformers. this allows the mcce and uhbd programs to make a more realistic calculation of the charge-charge interactions than mead. the rmsd values of the two mead data sets – parse and amber – are comparable, both producing similar rmsd values and numbers of outliers. however, table  <dig> shows that the parse force field generates outliers that deviate much further from the experimentally-determined values than those of amber. although the parameters of the two force fields are similar; the atomic radii of the hydrogens for parse are slightly larger which may have created inaccurate charge-charge interactions that have increased the calculated pka value . this is especially noticeable for lys where the respective rmsd values of amber and parse are  <dig>  and  <dig> .

although the propka and mcce programs are of comparable accuracy, the data suggests that the former tends to under-predict pka values whilst the latter over-predicts them . this observation may reflect the different approaches towards the calculation of the pka value in the two programs. propka  <cit>  takes a different approach to the other three programs, calculating the pka shift by using empirical rules that incorporate effects from hydrogen bonds, desolvation and coulombic interactions. the extent of the pka shift caused by hydrogen bonding is proportional to the number of hydrogen bonds formed by the titratable group  <cit> . the desolvation effect is calculated from the solvent accessible surface and the 'depth of burial' . lastly, the strength of the coulombic charge-charge interactions is dependent on the distance between the charges and on the state of the surrounding ionizable residues. this process, however, is only applied to buried pairs of ionizable residues. therefore propka's tendency to under-predict pka values may be caused by the program's emphasis on the dominance of hydrogen bonding in determining the extent of the shift. hydrogen bonds have the effect of lowering pka values  <cit>  and the predicted values may reflect that. conversely, mcce's tendency to over-predict may be the result of charge-charge interaction forcing an increase in the pka value. the majority of the over-predicted values are surface residues and, unlike propka, the mcce program does not take into account the lessened effects of charge-charge interactions when the respective residues are not buried within the protein interior. consequently, propka and mcce tend to be more accurate for surface and buried residues respectively.

side chains located at active sites are of particular interest as they often have unusually high or low pka values. in some instances, the electrostatic charge of the active site can be radically different from that the rest of the protein as a means to 'steer' a ligand towards the binding cleft  <cit> . for a program to work as an effective pka prediction tool it must be able to predict unusual pka values accurately. generally speaking, the accuracy of prediction decreased the further the measured pka value was from the side chain's intrinsic pka. again, propka proved to be the most consistent of the programs. this is not surprising as the design of the model and assignment of parameters were based upon a large dataset of carboxyl pka values. overall, the active site data was encouraging at the < <dig> unit level. however, once reduced to < <dig> , the accuracy of all of the programs decreased. this highlights a key area for the development of new models and programs.

an interesting correlation is seen with respect to the regression coefficients and the general performance of the programs. coefficients are generally an indicator of the relative importance of the contributing terms in a regression equation. the comparative performance of propka, the combination methods and the regression model is seen in figure  <dig>  propka is equally effective as these additional methods, although the regression data performs better than the best combination. a molecular dynamics simulation of one of the proteins from the dataset ) showed a standard deviation of ±  <dig>  for the pka value over a one-nanosecond period. this indicates that a dynamic structure has a large capacity for extreme pka shifts. this suggests that any accurate prediction pka method would need to incorporate conformational variability into the algorithm.

CONCLUSIONS
propka is the most accurate method for all residues except glu and his, where it is narrowly surpassed by uhbd and mcce, respectively. furthermore, the program also produces by far the best values for surface residues, most likely by taking sufficient account of hydrogen bonding. however, mcce predicts buried residues far better than propka, possibly by a more accurate evaluation of the charge-charge interaction with the conformers optimised by the monte carlo procedure. it must be noted that in all cases, the prediction of the buried residues is less accurate than for surface residues, indicating it is easier to calculate the interaction of a solvated or partially solvated residue than one densely packed within the protein interior. overall, the best standalone program is propka, which also produced the fewest outliers and is computationally much faster than the other programs. what the program lacks is a capacity to fully explore the conformational space available to the protein, which may ultimately limit its capacity to predict pka value. the reliability of the predictive programs tends to vary with both the residue type and its spatial location. for glutamic acid residues, uhbd produced the best results while for histidine and for all buried residues, mcce performed well. the comparatively poor prediction of the 'unusual' pka values by all of the programs was disappointing. their ability to only predict a third of the residues to a high degree of accuracy highlights an area requiring further development. the variation in pka values observed in our molecular dynamics simulation strongly suggests a complete sampling of conformations accessible to protein structures may be useful in creating accurate predictive software.

