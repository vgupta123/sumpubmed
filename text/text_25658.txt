BACKGROUND
rapid progress in dna sequencing is generating large numbers of deduced protein sequences. the prediction of their function is an important problem in bioinformatics. this is tackled by comparing new sequences to known sequences as high sequence similarity usually indicates related function. it is possible to use similarity search algorithms such as blast  <cit> . a more sensitive approach is to use hidden markov models  to define protein families as implemented in hmmer suite of programs  <cit> . such hmm profiles are used to define protein families in the pfam database  <cit> . in many cases, these families consist of functional domains in larger proteins.

in many cases protein families can be split into sub-types based on functional differences e.g. substrate specificity such as for the malonyl-coa- and methylmalonyl-coa-incorporating acyl transferase domains of modular polyketide synthetases  <cit> . these differences usually correlate with specific differences in amino acid sequence, which help to understand the molecular basis of protein function and serve as a basis for building prediction programs  <cit> . in order to identify such diagnostic amino acids, it is first necessary to produce a multiple alignment of the protein sequences to identify corresponding residues in different members of the family. this can be done in various ways e.g. using an hmm-profile  <cit>  or a multiple alignment program such as clustalw  <cit> . in some cases, it is possible to identify diagnostic residues merely by inspection of sequences , but this is difficult or impossible in many cases.

an interesting approach that analysed the entropy associated with different residue positions was described by hannenhalli and russell  <cit> . the biological idea behind this approach is that amino acid residues that are important in the determination of functional subtypes will have different constraints depending on the subtype. in general they will not be absolutely conserved, but evolution will only allow limited variation and the pattern of variation will be different for different subtypes. the functional subtypes corresponding to each protein are input to the program and the program uses an entropy measure to identify residues that split the dataset between the functional subtypes. the detection of specificity-determining residues has been developed further  <cit> . the residues identified by these methods can be used to assign new sequences to the correct subtype. however, it must be emphasized that all these methods rely on experimental data about the subtypes of a sufficiently large collection of proteins to identify the residues.

in many cases of interest there may not be enough experimental data about subtypes, but there is usually a much larger set of protein sequences  which have not been experimentally characterised. in this paper we describe a method which divides a set of protein sequences into subtypes based solely on sequence data without any prior assignment of subtypes. the method clustered six well-characterised protein families into functional subtypes without any prior knowledge of protein properties and identified specificity-determining amino acid residues.

RESULTS
identification of subtypes
the starting point for the analysis was a multiple sequence alignment of the protein family being analysed. we used clustalw and clustalx  <cit>  to align sequences . any other method of generating multiple alignments could be used e.g. with an hmm-profile of the family as implemented in the hmmer suite of programs  <cit> . the program only considers columns in the multiple alignment which contain amino acids for every member of the protein family . the program analyses the amino acids present at a given position and performs a statistical test to determine whether the distribution of the amino acids is more compatible with a model that they cluster around a single amino acid or with a model that they cluster around two or more different amino acids; the number of clusters is given to the program as a parameter. the two amino acid model has proved most useful for the six cases considered in this paper i.e. a binary split of the family into two subtypes is attempted. the statistical test needs a model for the substitution of amino acid residues and the blosum- <dig> matrix  <cit>  was used, which represents the observed substitutions in a large sample of proteins. although this model will not be strictly true for each amino acid position, the success of the program shows that it is adequate. an evolutionary split statistic was defined  that measures how well the position fits the multiple amino acid model i.e. a large value of the statistic indicates that the position should be important in the discrimination between subtypes.

on the basis of the evolutionary split statistic, the user selects a series of positions  to be used for splitting the protein family into subtypes. these are typically positions with the best scores, but other criteria  can be used. the clustering algorithm used gives log likelihood values for each sequence that show how well the "motif" assigns the sequence to a particular class. when a division into two subtypes is being carried out, it is useful to use the "specificity score", which is the difference between the log likelihoods for assignment to the two classes. the specificity score is a measure of how good the assignment to the class with higher likelihood is. the user can experiment with different numbers of motif positions to find a selection that gives good discrimination. as we will show later, in most cases this choice is not critical for the success of the method.

performance of the program
the program was tested on six different protein families . nucleotidyl cyclases have two functional subtypes corresponding to use of the substrates atp or gtp respectively. we extracted  <dig> sequences  from the uniprot database  <cit> . when the five positions with the best evolutionary split statistic were used to divide the family into two subtypes, the resulting groups were exactly the adenylate and guanylate cyclases . five of the ten best positions corresponded to amino acids that were discussed by hannenhalli and russell  <cit>  as important in determining the functional subtype .

and russell,
the ten residues with the best evolutionary split scores in the multiple sequence alignment of the nucleotidyl cyclases. when the residue had been detected in previous work  <cit>  the corresponding residue number is given. the dominant amino acid for the two subtypes is shown.

the protein kinase family can be divided into serine/threonine and tyrosine kinases.  <dig> kinase sequences  were extracted from the protein kinase resource database  <cit> . when the  <dig> best positions were used, the program divided the kinases into subtypes with 100% accuracy. seven of the best ten positions were identified previously as important for the subtype determination  <cit> .

lactate  and malate  are subtypes of a large dehydrogenase family. they show considerable sequence variability  <cit>  making them a more difficult case than the first two families.  <dig> dehydrogenase sequences  were extracted from the uniprot database  <cit> . when the top  <dig> positions were used as a motif the dehydrogenases were split into an ldh and an mdh group with  <dig> wrong assignments . the wrong assignments all had low specificity scores .

the two residues with the highest evolutionary split scores were discussed by hannenhalli and russell  <cit>  as important in determining the functional subtype. experimentally it has been shown that a major determinant of the substrate specificity is the choice between glutamine or arginine at residue  <dig> . this position was the 14th best evolutionary split score in our analysis . the reason why it does not rank higher is that arginine/glutamine exchanges are fairly common in proteins .

the acyl transferase  domains of type i modular polyketide synthases  determine the substrate selection  <cit> . most incorporate either a c <dig> unit  or a c <dig> unit . the choice of substrate can be deduced from the chemical structure of the polyketide product. we chose  <dig> at domains . we used the top  <dig> positions to define a motif and the program divided the domains into c <dig> and c <dig> subtypes with only  <dig> wrong assignments . the wrong assignments all had low specificity scores . the top  <dig> amino acid positions chosen were positions previously recognized by yadav and collaborators  <cit>  by inspection of the sequences. the top  <dig> amino acid residues were identified in the sequence of escherichia coli fatty acid synthase at for which a 3-d protein structure has been determined . the top  <dig> residues are in the region of the binding pocket where a direct effect on substrate binding might be expected. the other residues are scattered on the surface of the protein, too far from the substrate binding pocket to have a direct effect.

ketoreductase domains  of type i modular pkss use nadph to stereospecifically reduce the initially formed keto group to a hydroxyl group  <cit> . the stereospecificity can only be deduced from the structure of the product for cases in which further reduction steps have not occurred. we used  <dig> kr domains for which the stereospecificity was known . in this case, most of the residues with the best values for the evolutionary split parameter were clustered in a region of the sequence, so we chose the residues from positions  <dig> to  <dig> of the alignment to split the family into subtypes. this gave a 90% accurate assignment of domains . the motif residues included the residues that had been recognized by caffrey  <cit>  as playing a role in stereospecificity.

the final family that we examined was the small heat shock proteins , where it is not clear whether there is a functional difference between different subtypes. we analysed  <dig> sequences and on the basis of the best four positions obtained a split between metazoan shsps and the others   which corresponds to previously reported phylogenetic results  <cit> . the four residues  were localized on the 3-d structures of shsps from triticum aestivum  <cit>  and methanococcus janaschii  <cit> . the four residues are in a region of the protein that is involved in dimerisation. it is known that oligomerisation is important for the function of the protein and this result suggests that the two subtypes identified might differ in oligomerisation properties.

the clustering algorithm allows a free choice of amino acids alignment positions to include in the motif. this raises the question as to how sensitive the clustering algorithm is to the exact choice of motif. we clustered the six protein families using amino acid positions with the highest evolutionary split scores and varying the length of the motifs from  <dig> to  <dig> positions. table  <dig> shows that the accuracy of the clustering does not depend strongly on the number of positions chosen. this means that the algorithm could be used for the automatic clustering of protein families using a standard length of motif chosen from the best evolutionary split scores. in the case of the kr-domains, choosing a segment of the protein on the basis of specific knowledge, as done above, gave better results than using the best evolutionary split scores. the assignment of kr domains to subfamilies is complicated as they also determine the stereochemistry of methyl groups  <cit>  and examination of 3-d structures of kr domains resulted in their division into six subtypes  <cit> .

the amino acids positions with the highest evolutionary split scores were used to construct the motifs.

the evolutionary split statistic allows the identification of residues that are important for the determination of subtypes. however, as it is calculated independently of the clustering, it is not as good as methods that are based on a known clustering. the subfamilies predicted by our clustering algorithm can be used for such analyses  <cit> , which will give a more accurate identification of residues important for division into subtypes. the omission of sequences with low specificity scores should improve the analyses by removing misclassified sequences.

the algorithm showed an efficient division into subtypes for the six protein families tested. an alternative approach to recognizing subtypes in the absence of functional information is to use phylogenetic analysis. in order to have a closer comparison with our clustering algorithm we constructed phylogenetic trees from the multiple alignments of our six protein families using distances calculated from a blosum matrix  <cit>  instead of the more common jtt method  <cit> . for the nucleotidyl cyclases and protein kinases, whose subtypes were recognised with complete accuracy by our method , the functional subtypes do form separated clusters in the phylogenetic trees . division of the sequences into two subfamilies implies choosing a rooting point in the tree so that the subfamilies become clades in the rooted tree. in neither case, is the choice of such a rooting point unambiguous. for the cyclases  there are several plausible rooting points, only one of which will give the correct subfamilies. the kinases  fall into three clusters and the phylogenetic tree does not suggest the correct split into the two functional subtypes. the dehydrogenases  also appear to split into three clusters and the phylogenetic tree does not suggest a division corresponding to the two functional subtypes, whereas our clustering program recognises the functional subtypes efficiently . the at-domains  can be recognised as two groups using the phylogenetic tree with a similar degree of error to the clustering algorithm. the subtypes of the kr-domains  cannot be recognised using the phylogenetic tree, whereas the two subtypes of the shsps are clear in the phylogenetic tree . thus, in three of the six families, the phylogenetic trees did not give a clear identification of the functional subtypes. a further major advantage of the clustering algorithm is that the specificity score identifies sequences that are not well clustered by the algorithm so that they can be removed or treated with caution in subsequent analyses. the tests with known families showed that most wrong assignments involved such sequences.

in principle, the programs can also be used to cluster sequences into three or more subtypes. we tested for a clustering into three subtypes using two protein families:  <dig> serine proteases  and  <dig> at-domains . clustering was undertaken using best  <dig>   <dig> and  <dig> positions for the evolutionary split statistic . the clustering did not show a strong dependence on the number of positions. for the serine proteases, the trypsin subfamily was split into two groups and the chymotrypsin and pancreatic elastase subfamilies clustered together giving wrong clustering of  <dig> of the  <dig> sequences. similarly,  <dig> of the  <dig> at-domains were wrongly clustered. thus, although the method works for carefully constructed sets of test data, it does not seem to be effective for real biological protein families. it is not surprising that the method becomes less effective with increasing number of subtypes. the potential of a column to contribute towards a k-way split is estimated with the evolutionary split statistic  and increasing the number of subtypes drastically increases dimensionality of the parameter space; i.e. it is increasingly difficult to distinguish between evolutionary noise and functionally significant mutations. thus, only exceedingly large sample sizes will provide sufficient power for the method to work well. clustering is most efficient when the different subtypes are present in comparable numbers and the examples analysed in this paper show that the known sequences in natural protein families can often fall into one or two major subtypes with other subtypes being rare. such situations can be analysed better by using binary clustering and subsequently looking for rarer subtypes in the sequences that have low specificity scores.

the method suffers from the drawback that it can only be used in practice for dividing protein families into two subtypes. this will cause problems for protein families with several common subtypes and the method may not work well for rare subtypes. now that the feasibility of such a clustering algorithm has been demonstrated it is likely that improved algorithms can be devised to overcome these problems.

an important practical advantage of our algorithm is that it is computationally efficient allowing implementation on a public server. using a standard pc with a  <dig> ghz processor, it needs about  <dig>  second per column to compute the evolutionary split parameter  and about  <dig> minute to compute the clustering into subtypes. it is therefore feasible to experiment with different motifs and different selections of the sequences to obtain optimal results. the method offers a useful tool to detect previously unsuspected clustering into subtypes. if experimental data for a limited number of proteins are available, they provide an independent test for the predicted clustering and the subtype of previously uncharacterised proteins is predicted.

CONCLUSIONS
the programs cluster protein families into subtypes effectively without any prior functional knowledge. the specificity score identifies protein sequences that do not cluster well into the defined subtypes: these may include further rare subtypes. the programs are especially suitable for detecting novel unsuspected subtypes where extensive sequence data, but little experimental data are available.

