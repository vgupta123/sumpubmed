BACKGROUND
the ability to adapt to external inputs is a crucial property of cellular systems  <cit> . bacteria, for example, can outlast antibiotic stress by forming biofilm colonies  <cit> , or they may produce bacteriocins when sensing nutrient competition  <cit> . this form of acute adaptation is often encoded in the bacterial signal transduction network, which enables multiple stable states and may thus give rise to phenotypic heterogeneity .

in escherichia coli, the regulatory system of amyloid curli fibers is a central component of the stress-induced biofilm formation under the control of the master regulator σs . while heterogeneous all-or-nothing expression of the curli protein csgb in isogenic wild type cells under identical environmental conditions was shown in  <cit> , subsequent work  <cit>  allowed to infer interactions of the molecular components of the underlying signalling network. however, the ability of the suggested network to produce bistable behaviour  and the influence of individual molecular components on single-cell dynamics still remains to be elucidated.

rigorous mathematical modelling may further our mechanistic understanding of this system. two different methodological views for analysing bistability in signalling networks have been established in previous studies. logical modelling approaches assign discrete states to different activity levels of network components and represent reactions by logical functions. the advantage of this methodology is that it allows to test a large amount of alternative model topologies using a limited amount of data, or semi-quantitative data such as promoter activities in genetic knockout strains or immunoblotting data  <cit> .

particularly regarding asymptotic behaviour, logical analysis has been shown to be a useful tool for uncovering fundamental characteristics and functionalities of biological systems, . consequently, it is a well-suited approach for investigating bistable systems, where there is evidence that qualitative properties, in particular the network topology, are crucial determinants  <cit> . however, the low detail resolution of such models only allows for a preliminary understanding, and the biological interpretation of the results is not always straightforward.

time-continuous models  entail more biological detail and model parameters are readily interpretable. in this approach, besides topology, the signalling network is defined by well-established reaction rate kinetics. among others, the approaches for analysing bistability in continuous models are based on a feasibility analysis of unstable states  <cit>  and the chemical reaction network theory  <cit> , as e.g. applied to study bistable regulation of split histidine kinases in two-component signalling networks  <cit> . in analytically less tractable models, heuristic parameter search may be used, such as monte carlo  <cit>  or the genetic algorithm  <cit> . however, an exhaustive analysis of a large space of alternative model topologies and parameterisations is often infeasible, requiring a confinement to certain regions of the model and parameter space. thus, a drawback of the continuous modelling approach lies in the containment to a network topology and the requirement of sufficient information about the underlying biochemical reactions.

in addition to the deterministic modelling approach, time-continuous stochastic modelling  may deliver further insights into the system behaviour such as the probability of the cells to be in either of the two stable states and the noise-induced switching dynamics between the stable states  <cit> . the high computational effort for analysing stochastic models precludes, with only few exceptions, e.g.  <cit> , from addressing inverse problems  at all.

combining the advantages of the logical and continuous modelling approaches may allow to overcome their individual limitations and thus significantly increase the computational feasibility of the analysis, while keeping a high level of detail. the different views may generate complementary insights, contributing to a more holistic understanding of the topology and the kinetics of signalling networks  <cit> . to exploit these aspects, in this paper we introduce a hybrid modelling pipeline combining available genetic knockout data with logical, ode-based and stochastic modelling approaches as outlined in fig. 1a-d. starting with a logical, constraint-based description of the available data, we generate and analyse a pool of feasible logical models. this first step yields, on the one hand, results on essential system properties on its own. on the other hand, it is used to extract a well-supported network topology for the regulatory system of amyloid curli fibers in e. coli , as well as parameter constraints for building a more detail-resolving ode model. it has been shown in the context of biological modelling that properties related to asymptotic decision processes are rather robust concerning parameter perturbations up to being sustained between continuous and logical models . notably, steady states are rather well preserved between models as demonstrated in a number of studies  <cit> . based on the network topology validated in the logical modelling step, we incorporate additional kinetic information of involved reactions in order to set up a continuous reaction-rate model of the signalling system . deriving an ode-based model from the reaction rates enables us to estimate parameters that induce bistability compliant with experimental constraints. finally, we generate sample trajectories from the corresponding chemical master equation in order to analyse the dynamics of stochastic switching between the stable states of the system. the latter approach allows to identify alternative scenarios of the cell population splitting into curli-on  and curli-off states, while allowing stochastic back- and forth switching or leading to ultimate differentiation, in line with biological observations  <cit> .
fig.  <dig> logical-continuous modelling pipeline for bistability analysis of curli regulation in e. coli. a expression of the curli gene csgb in mutants with single or multiple knockout mutations in yege/yhjh and ydam/ycir c-di-gmp control modules . derivatives of e. coli k- <dig> w <dig> carrying a single copy csgb::lacz reporter fusion were grown in lb at  <dig> °c for  <dig> hours and β-galactosidase activities were determined. figure reproduced from  <cit>  with permission. b signalling network regulating the expression of curli fibers, as suggested in  <cit> . c logical formulation of the network topology. the two different functional states of ycir are modelled by two types of interactions. only the inhibitory effects exerted by ycir are represented by edges in the figure. full details on the regulatory activity of ycir and the dependence of the two functional states on the activity of c-di-gmp is formalised in the additional file 1: figure s1c. d continuous model combining kinetic reaction rates with the validated network topology



methods
regulatory network of curli expression
the second messenger molecule bis--cyclic dimeric guanosine monophosphate  is the central component within the regulatory signalling network of curli fimbriae during the stationary phase of the bacterial population growth cycle and upon induction of various stress conditions. c-di-gmp positively contributes to the expression of csgd, the key biofilm regulator, activating the expression of the curli regulon , with csgb and csga proteins constituting the curli fiber  <cit> . as shown in fig. 1b, the synthesis and degradation of c-di-gmp within this network is maintained by two diguanylate cyclase /phosphodiesterase  pairs: yege/yhjh  and ydam/ycir .

while dgc-type enzymes synthesise c-di-gmp from two gtp substrates, pde-type enzymes are responsible for the degradation of c-di-gmp. as shown in fig. 1b, besides the degradation function of c-di-gmp, ycir exhibits a second activity: the inhibition of ydam and mlra. importantly, ydam is the key activator of the transcription factor mlra, which directly activates transcription at the csgd promoter region. a sufficiently high amount of c-di-gmp prevents ycir from inhibiting ydam, since ycir binds c-di-gmp and starts to degrade it, acting as a trigger enzyme  <cit> . in turn, unbound  ydam activates mlra and induces the signalling cascade leading to the expression of the curli operon csgbac.

previously, the activity of the csgb promoter was measured in all possible single, double, triple and quadruple knockout strains of the set of genes yege, yhjh, ydam and ycir  <cit> . as depicted in fig. 1a, despite  <dig> different genetic backgrounds, only four main expression levels of the csgb gene were observed. e. coli strains containing a ydam-knockout exhibit a completely absent expression of the curli gene csgb  or a very low  level expression, as compared to wild type . furthermore, strains containing a ycir-knockout reveal an increased  expression of csgb if ydam is present. this knockout background is “blind” with respect to knockouts of module i genes . genetic and biochemical analyses allowed lindenberg et al.  <cit>  to derive a model of the regulatory network, which is depicted in fig. 1b. in this model different functional states are assigned to ycir  and ydam .

in order to find evidence for the bistability of the curli signalling system we assigned each of the four different expression levels observed in the genetic knockout experiments at population level  a certain single-cell phenotype. to this end, we used the complementary single-cell measurements of the wild type expression of the csgb protein in serra et al.  <cit> . these single-cell data suggest that the intermediate expression level of the csgb gene at population level corresponds to a heterogeneous mix of curli-on and curli-off cells in the bacterial population. this indicates that the basal and the hyperrepressed level of csgb reflects a mixture of cellular phenotypes where the fraction of curli-on cells is significantly lower as compared to the wild type, or it becomes undetectable. in contrast, the hyperactivated phenotype may be due to two different types of single-cell expression levels. either all cells in the population are in the curli-on mode, or there is a subset of cells in the curli-off mode but their frequency is significantly lower than the frequency of curli-off cells in the wild type population.

derivation of the logical model
in order to set up the logical model of the curli regulation system, we described the involved components in terms of logical variables whose values were interpreted as functional states of the components, e.g. active vs. inactive states. for deriving the model we applied a time-scale separation. thus we assumed that the total levels of involved proteins do not significantly change in contrast to their activity states. we based our assumption on results indicating that protein transcription and translation are significantly slower than post-translational interaction dynamics  <cit> .

having described the components by means of logical states, logical rules were added to characterise the principles of mutual regulation by the components. in particular, all activating or inhibitory effects indicated by experimental data were incorporated, resulting in the logical model depicted in fig. 1c. most of the components were assigned two states  corresponding to the situation where the component has either an effect on the system or not. an exception was made for the protein ycir, which was assigned a knockout state  and two different observable activities that are mutually exclusive   <cit> . note that ydam has also two different activity levels. however, since one of them does not have any observable effect, we identified it with the off-state.

in addition to the logical variables, we described the semantics of the model via the intertwined regulatory effects. thus, a regulation is effective if the respective regulator is on. in the case of ycir we distinguished between alternative regulations depending on their corresponding effect. a regulation is effective only when ycir occurs in the respective state, including the positive and negative effects . most of the included regulations correspond to the experimentally derived network topology in fig. 1b, with a few exceptions. the first difference is given by the negative feedback induced by the allosteric product inhibition of c-di-gmp on the catalytic activity of yege. when molecular numbers are considered, product inhibition  gives rise to an upper limit on the synthesis rate and thus contributes to setting up a homeostatic steady-state level of c-di-gmp  <cit> . however the semantics of this negative feedback loop do not transfer to the discrete logical model i.e. it is not possible for c-di-gmp to completely inhibit yege. since in the logical model, only one discrete value is used as an abstraction for the concentrations of c-di-gmp that are considered as the on-state, this negative feedback inhibition has no observable logical effect. therefore we eliminated the corresponding edge from the logical interaction graph .

furthermore, the dgc/pde-pair yhjh and yege constitute the inputs of the network, which means that they maintain the values that they were initially set to. finally, we used the system property that the expression of csgb is induced if its transcription factor csgd is expressed. this is the case if mlra is on, since it is in turn the functional activator of csgd transcription . therefore, in order to reduce the model, we removed csgd and used the boolean component mlra as the output component of the network. thus, the on-state of mlra represents the induction of curli expression in the logicalmodel.

at this point we incorporated a sufficient amount of information into the model for deriving all regulatory functions except the functions of c-di-gmp and mlra. these two components are influenced by multiple regulators, giving rise to a set of alternative logical functions describing their effect on c-di-gmp or mlra . after resolving the constraints derived from the interaction effects, we identified  <dig> possible regulatory functions for c-di-gmp and  <dig> for mlra. finally, by generating all possible combinations of the functions of the two components, we obtained  <dig> alternative models for the whole network.

formalisation of the experimental data
after specifying all  <dig> possible alternative logical models , we assessed for each model whether it fulfils all constraints given by the observations of the  <dig> genetic knockout experiments . we evaluated the dynamics of the logical models by employing the so-called asynchronous update that allows for non-deterministic behaviour. it has been previously shown to generate biologically realistic trajectories and has a clear relation to continuous modelling approaches  <cit> . we modelled a genetic knockout by forcing the respective component to remain in the off-state for the whole course of the simulation. our main focus was on stabilising behaviour, thus we assessed the reachability of stable states with a particular model configuration. a system state is considered as stable if it is not possible to leave it during simulation. as shown in fig. 1a, there are four distinctive phenotypes, each of which we addressed individually: 
the intermediate  phenotype was related to the ability to reach a stable state with mlra on and a stable state with mlra off in the logical modelling framework.

in the hyperrepressed phenotype no curli is being expressed, therefore we required that the stable state with mlra off is reachable, while the on-state is not.

the hyperactivated phenotype exhibits strong expression of curli and therefore we stated that the stable state with mlra on must be reachable. however, unlike the hyperrepressed phenotype, we did not prohibit the inactive stable state, since we could not rule out that this phenotype is generated by a mix of curli-on and curli-off cells.

lastly, the basal phenotype exhibits only little, but still measurable expression of curli. however, very weak expression of curli was also observed in the hyperrepressed phenotype . it would therefore be possible to identify the basal with the hyperrepressed phenotype, but this constraint could be spurious. we have therefore decided to not include the basal phenotype in the main analysis.



however, we also tested the validity of the resulting constraint in a second, less conservative analysis step. here, we assumed that the basal phenotype is equivalent to the hyperrepressed phenotype, see additional file  <dig> for details. since the measurements were conducted in the early stationary phase of the growth cycle , we expected the input components yege and yhjh to be on unless knocked out. using the stability constraints resulting from experimental data , we formulated  <dig> properties  that a valid model should fulfil  and  <dig> properties using the less conservative analysis step . we used these properties to test the entire set of alternative logical models. subsequently, we identified a valid reduced model topology, as well as parameter constraints that were passed on to the continuous modelling step, as exemplified in additional file  <dig> and shown in the “results” section.

derivation of the continuous reaction-rate model
based on the results from the logical modelling step , we included three system components as dynamical variables into the continuous model: the amount of c-di-gmp , the amount of ycir molecules in its role as a ydam inhibitor   and the amount of active ydam molecules . due to the time-scale separation assumption, transcription and translation were assumed to be negligible and thus the total amount of ycir and ydam was assumed to be constant . two further system components, yege and yhjh, were included as parts of the maximum catalytic velocity parameters . we did not include mlra into the model since its activity reflects the activity of ydam. this was supported by the results of the logical modelling step indicating that mlra does not influence the interactions between module i and module ii proteins . details of the derivation of reaction rates of the time-continuous model are given in the additional file  <dig> 

according to the network wiring validated in the logical model checking step , the final continuous model was composed of interactions given either by the production or degradation reactions of c-di-gmp. based on the elementary catalytic reactions, we derived michaelis-menten rates by applying the quasi-steady-state assumption .

c-di-gmp synthesis by yege and ydam respectively occurs with rates v <dig> and v <dig>  while c-di-gmp degradation by yhjh and ycir are modelled by rates v <dig> and v <dig>  respectively. the remaining four rates  relate to the reversible transitions between different functional states of ycir and ydam, as outlined in additional file  <dig> and summarised in table  <dig> max <dig> , v
max <dig> , ydamtot  and ycirtot 


v1=vmax11+x1/kiyege

v2=vmax2x1x1+kmyhjh

v3=kyciractx1x1+kmycir

v4=kydamactx3nkdpolymerydamn+x3n

v5=kycirdex2x1x1+kdycir

v
6=c

v7=kydamdex3x2x2+kdydam

v
8=c


based on the reaction rates, we derived an ode model describing the interaction dynamics of module i and module ii proteins and the signal transduction via the regulation of c-di-gmp levels in the cell . this results in the following system of ordinary differential equations : 
  ddtx1=v1+v4−v2+v <dig> ddtx2=−v5+v <dig> ddtx3=−v7+v <dig>  

where the system variables x <dig>  x <dig>  and x <dig> denote the molecular concentrations of c-di-gmp, ycir in the ydam-inhibition state and active ydam, respectively. the reaction rate functions are stated in table  <dig> 

setting the second equation of the ode system  to zero, we obtained the steady state equation for the amount of ycir molecules in both activity states : 
  x2ss=c6ycirtotc6+kycirdex1x1+kdycir=kdyciractycirtotkdyciract+x1x1+kdycir, 

where we introduced the equilibrium binding constant given by 
 kdyciract=c6kycirde. 

furthermore, by setting the third equation of the ode system  to zero and substituting x <dig> with x2ss, we obtained the equation for the amount of active  and inactive  ydam molecules at steady state: 
  x3ss=c8ydamtotc8+kydamdex2ssx2ss+kdydam=kdydamactydamtotkdydamact+x2ssx2ss+kdydam, 

where 
 kdydamact=c8kydamde. 

substituting x <dig> and x <dig> with x2ss and x3ss in the first equation of the ode system  yields a one-dimensional ode. its roots indicate the levels of c-di-gmp x1ss, which, in conjunction with the steady state eqs.  <dig> and , give rise to the fixed points xss=x1ss,x2ss,x3ss of the entire ode system. a fixed point xss is a stable steady state if all eigenvalues of the jacobian matrix of the ode system  at xss are real and negative.

parameter identification
we estimated the parameters of the ode model  by using a rejection sampling scheme. in the first step we sampled random parameter values using a uniform proposal distribution with bounds previously described in the literature or using physiologically meaningful ranges, as shown in table  <dig> and indicated by grey background shading in additional file 4: figure s <dig>  note that for the ode system  the identified parameters with units molecules were scaled by the system volume Ω that was set to Ω=1μm <dig>  <cit> .

kmyhjh

kmycir

kdycir

kiyege

v
max <dig>  v
max <dig>  k
ydamact, k
yciract

kdydam

ycirtot, ydamtot, kdpolymerydam

k
ycirde, k
ydamde


in order to reduce the parameter search space, we applied a set of constraints. firstly, we required that the proposal values of the parameters ycirtot and ydamtot are equal, as suggested by protein assays performed by lindenberg et al.  <cit> . furthermore, we included a constraint resulting from the logical modelling step requiring that the catalytic activity of ycir is weaker than the catalytic activity of ydam, i.e. kyciract≤kydamact .

a parameter proposal was accepted if the following set of qualitative requirements was fulfilled: 
the wild type model and the double knockout yege/yhjh exhibit two stable states,

the single-gene knockout mutant lacking yhjh either exhibits one or two stable states,

the single-gene knockout mutant lacking yege exhibits one stable state.



note, that the remaining knockout data in fig. 1a were not included for kinetic parameter sampling since they contain genetic knockouts of ydam or ycir. setting the amount of each of these two components to zero disrupts the structure of the ode  since these two components are described by system variables . the parameters were estimated using a fixed hill constant n= <dig>  this is supported by the tendency of ydam to build tetramers in-vitro  <cit> , in line with previous work suggesting multimerisation as a possible source for ultrasensitivity  <cit> .

in the second step we conducted a rejection sampling with a multivariate gaussian proposal distribution by accepting the sampled parameter sets if all stability constraints from the first step were fulfilled. the mean μ of the proposal distribution was given by the parameter sets identified in the first  sampling step and the standard deviation σ was chosen sufficiently large to cover a large sampling space but minimise the probability of negative sampling proposals . in the case of the parameter kmycir all sampled parameter sets, where the range of  <dig> molecules was exceeded, were post-hoc rejected due to experimental results suggesting this upper bound  <cit> . additionally, we post-hoc selected only those parameter sets which fulfilled the validity criterion for the michaelis-menten approximation in deterministic and stochastic models ).

chemical master equation of the curli regulation system
the stochastic model of curli regulation and the validity of the translation of continuous rates into stochastic propensities are discussed in additional file  <dig>  in order to solve the corresponding chemical master equation and to compute switching probabilities between the stable states, we generated a sufficiently large amount of sample trajectories using the stochastic simulation algorithm  <cit> . for computing the probability of stable states  we used sufficiently large simulation times ensuring the equilibration of the system. for instance, a simulation time of 100s for the parameter set used for generating fig.  <dig> was sufficient, as shown in additional file 5: figure s <dig> 

we then computed switching probabilities and switching times. a switch was detected if an ssa trajectory that was started in a stable state reached the neighbourhood of the opposite stable state within a maximal simulation time t=100s. for instance, if a system trajectory x was started in the stable state xss <dig>  then a switch to the stable state xss <dig> was detected if 
  ∑i=1nxi−xiss2≤∑i=1nεxiss1−xiss <dig> 

where ε is a neighbourhood parameter that we set to  <dig>  and n denotes the number of system components . the stable states xss <dig> and xss <dig> were computed as the steady states of the deterministic reaction-rate model  and confirmed by identifying the modes of the solution of the cme after a sufficiently long stochastic simulation time.

RESULTS
we applied logical model checking in order to assess the potential of the experimentally derived wild type interaction network  to exhibit bistable dynamics and at the same time to fulfil the stability constraints from the various genetic knockout strains .

following the logical model checking step, we then incorporated currently available information on biochemical reactions in order to derive a more detailed reaction-rate model of curli regulation.

logical analysis: topology and parameters
as a first analysis step, we tested the consistency of the candidate models, constructed in the “methods” section, with the  <dig> constraints  derived from the experimental observations . as a result, we found that  <dig> out of  <dig> possible models were in agreement with all constraints . using a comparative analysis of this set of  <dig> feasible models we obtained a number of results yielding meaningful insights into signalling mechanisms of curli regulation and supporting subsequent continuous modelling. in the following, we first describe the essential features of the system resulting from common properties of the feasible models and afterwards we present the consequences for the continuous modelling step.

in fig.  <dig> we illustrate the dynamical behaviour that is shared by all  <dig> models. as ensured by the constraints, all models support bistability given that both inputs  are active. this means that the model behaviour is non-deterministic and can asymptotically end in either one of the two stable states distinguished by the presence of mlra. interestingly, for all models these stable states do not only coincide in that they represent expression or no expression of curli, but also in the activity of all other model components. that is, we can completely characterise the two possible equilibrium states when the input components are on. furthermore, an inspection of the regulatory functions of the  <dig> remaining models indicates that there are five possible regulation mechanisms for c-di-gmp, which exhibit noteworthy commonalities. the most prominent pattern is that c-di-gmp is in most cases adopting the value of ydam, whereas the value of ycir is almost uncorrelated with the update of c-di-gmp. this observation allowed us to identify ydam as the most influential regulator of c-di-gmp. for a more detailed discussion and an explicit listing of the regulatory functions see additional file  <dig> 
fig.  <dig> simulation trace of the system where both inputs yege and yhjh are set to active states. values of the remaining four nodes create 24= <dig> different combinations,  <dig> of which form the strongly connected component  and the bottom two are the stable states, indicated by the self-loops. the depicted simulation trace is shared among all final models



apart from yielding insights into the modelled system, the logical approach could also be used to validate crucial assumptions underlying the continuous reaction-rate model: firstly and most importantly, we validated the network structure underlying the continuous reaction-rate model. to this end, as described above, we identified a non-empty set of logical models fulfilling the experimental constraints and exhibiting bistability. furthermore, by inspecting the set of  <dig> feasible models, we observed that despite of two different choices for the regulation of mlra, the realisation of the core circuit ydam—ycir—c-di-gmp is independent of the choice of the regulatory function of mlra. furthermore, mlra is an output component and thus does not influence any other components in the network, allowing for model reduction by completely removing mlra in the continuous modelling step. this gave rise to a core model that generates bistability, containing only c-di-gmp, ydam and ycir as dynamic variables.

in a second step, we asked if, besides the already incorporated  constraints, the network topology also fulfils the constraints related to the less conservative interpretation of the basal expression phenotype, as e.g. observed in the mutant strain with a yege-knockout . to this end, we made the assumption that the basal phenotype is equivalent with the hyperrepressed phenotype. this assumption is partly supported by the knockout data, which suggest that these two phenotypes are indeed equivalent w.r.t. to the core network  and only differ by the basal ydam-independent activity of mlra inhibited by the activity of ycir . overall we generated two constraints from each knockout experiment in fig. 1a, giving rise to  <dig> constraints . as a result, we identified one valid model fulfilling all constraints .

finally, we were able to translate our findings on the regulation of c-di-gmp into a parameter constraint for the ode model. our result stating that the activating effect of ydam overcomes the inhibitory influence of ycir under certain conditions yields the kinetic parameter inequality kyciract<kydamact in the continuous setting .

in summary, we were able to transfer four results into the continuous modelling step. firstly, the network structure postulated in fig. 1c, is a valid basis for a continuous reaction-rate model of curli regulation and supports the experimentally derived network topology. secondly, the core model giving rise to bistable behaviour is based on the interaction between ydam, ycir and c-di-gmp . thirdly, we have shown that the network topology also fulfils the constraints resulting from the equivalence assumption of the basal and hyperrepressed phenotypes. thus, this assumption can be used as a constraint in the continuous modelling step. finally, we obtained a parameter constraint for the catalytic activity of ycir in comparison with the activity of dgc enzyme ydam.

reaction-rate model of interaction between the dgc/pde modules
in the subsequent step, we analysed the dynamics of the system after translating the logical network into a continuous reaction rate model. we then determined the stable states of the system . since in the logical modelling step the activity of mlra was shown to almost completely reflect the activity of ydam, we only focused on interactions of the module i and module ii proteins, upstream of mlra, as the regulatory core of the network . note, that this model reduction is valid under the assumption that mlra and ydam can simultaneously bind ycir i.e. there is no competition . we used the bistability of the wild type strain and the stability properties of the single-gene knockout strains lacking either yege or yhjh  as acceptance criteria for parameter inference .

using 2· <dig> parameter proposals, our sampling procedure yielded  <dig> feasible parameter sets depicted in fig.  <dig>  along with experimentally determined parameters in related systems. the individual parameter values are listed in the additional file  <dig>  note also additional file 4: figure s <dig> showing the parameter distribution on a linear scale along with the proposal distribution.
fig.  <dig> distribution of sampled parameters along with reference parameter values from the literature. parameter distributions were obtained using rejection sampling where, if possible, the bounds of the proposal distribution were obtained from the literature  and are outlined by blue boxes. in addition, the empirical means of each parameter are shown . the first eight parameters on the x-axis have units molecules, the following six parameters have units molecules /s. the individual values of each parameter set are provided in the additional file  <dig>  for a comparison, experimentally measured values of similar parameters are depicted, if available . following parameter pairs are indicated for comparison :  <dig>  ydamtot/amount of dgca in e. coli ≈ <dig> molecules, obtained from  <cit>  and normalised by the dry weight of the cell obtained from the bionumbers database, bnid  <dig>  <cit> .  <dig>  kiyege/ k
i of dgca ≈ <dig> molecules, obtained from  <cit>  and normalised by the volume of e. coli cells.  <dig>  kmyhjh/ k
m of the pde-enzyme cc <dig> from caulobacter crescentus ≈ <dig> molecules, obtained from  <cit>   <dig>  kmycir/estimated maximal k
m of ycir ≈ <dig> molecules, obtained from  <cit> , page.  <dig> and normalised by the volume of e. coli cells.  <dig>  v
max <dig> of yege/ v
max of dgca ≈ <dig> s
− <dig> obtained from  <cit>  and normalised by the amount of dgca proteins and by the dry weight of the cell.  <dig>  v
max <dig> of yhjh/ v
max of the pde-enzyme cc <dig> from caulobacter crescentus ≈ <dig> s
− <dig> obtained from  <cit>  and normalised by the dry weight of the cell. note that the hill parameter was fixed at n= <dig>  and the parameters c
 <dig> and c
 <dig> were fixed at the value  <dig> s
− <dig> due to structural non-identifiability w.r.t parameters k
ycirde and k
ydamde, respectively



bifurcation analysis and comparison to genetic knockout experiments
previously, it was shown that protein-protein interactions between the module ii proteins ycir and ydam induce a switching point in this system requiring a sufficient amount of c-di-gmp in order to relieve the inhibition of ydam by ycir and enable downstream signal transduction  <cit> . in the following, we analysed the potential role of the regulatory parameters of c-di-gmp in generating bistability. since experimental results suggest that ydam is the main component transmitting the signal further downstream to mlra, we used the amount of active ydam molecules as the read-out parameter of our analysis. note that the stable states with a high amount of ydam molecules are characterised by a high level of c-di-gmp and a low level of ycir ii and vice versa, in line with the stable states of the logical model . by construction of the rejection sampling, all identified parameter sets shared equivalent stability properties of the wild type and genetic knockout strains. therefore, in order to analyse the dependence of the stable states on model parameters we selected a representative parameter set from the sampled distribution .

the parameters vmax <dig> and vmax <dig> are composed of the product of catalytic activity and the amount of the dgc-type enzyme yege and the pde-type enzyme yhjh, respectively. we varied these two parameters in order to analyse the impact of the amount and activity of this dgc/pde pair on signal transduction. for each of the two parameters we identified three different types of qualitative dynamics. at values of vmax <dig> slightly below  <dig> molecules /s the system exhibits monostable dynamics . a further decrease of this parameter reduces the amount of active ydam proteins at steady state eventually hitting the minimal level of active ydam proteins when yege activity is absent . this is supported by experimental measurements of csgb expression in yege knockout mutants exhibiting basal ydam-independent level of csgb expression   <cit> . with an increasing vmax <dig>  the amount of active ydam molecules increases as well, until the system becomes bistable with two possible stable levels of active ydam molecules in a region between  <dig> and  <dig> molecules /s. this type of qualitative dynamics agrees with the phenotypic heterogeneity of csgb expression observed in the wild type strain  <cit> . the stochastic simulations of the model indicate that within this parameter region the cells divide into two subpopulations with different levels of active ydam molecules . finally, a further increase of vmax <dig> makes the system monostable again with a high level of active ydam molecules . a similar analysis of the yhjh-activity parameter vmax <dig> in the second experiment exhibited the contrary bifurcation behaviour, where the system becomes monostable with a high level of active ydam molecules as vmax <dig> decreases . this corresponds to the hyperactivated expression of csgb, experimentally measured in yhjh-knockout mutants .
fig.  <dig> bifurcation analysis of key system parameters v
max <dig>  v
max <dig> and the complex parameter c
6/k
ycirde. the stable states are shown by continuous lines while unstable fixed points are indicated by dashed lines. note that each stable level of active ydam is characterised by a distinct stable amount of c-di-gmp and ycir ii . the parameter regions inducing bistability are marked by grey areas. inlay plots show stochastic simulations of the system within the bistable region, indicating the probability  to contain a high or low amount of active ydam molecules. the initial condition for the stochastic simulations was set to x
1= <dig> x
2= <dig> x
3= <dig> and  <dig> simulations were conducted for each parameter combination of the bifurcation analysis. a sufficiently large simulation time of  <dig> seconds was chosen in order to ensure equilibration. in each experiment a-c all the other parameters were kept fixed corresponding to the parameter set  <dig> in additional file  <dig> 



in the third experiment we varied the complex parameter c6/kycirde. this parameter is inversely proportional to the binding affinity of c-di-gmp to ycir and it has an opposite bifurcation behaviour as compared to vmax <dig>  values of c6/kycirde below  <dig> ·10− <dig>  i.e. a high affinity of c-di-gmp to ycir, give rise to a single steady state with a high level of active ydam molecules. between  <dig> ·10− <dig> and  <dig> ·10− <dig> the system becomes bistable with two different levels of active ydam molecules, which corresponds to the wild type dynamics. the corresponding stochastic simulations indicate that within this parameter region the probability of the system is divided between the two stable states, which is in agreement with the bistable dynamics of csgb expression. finally, at values higher than  <dig> ·10− <dig>  i.e. a further decrease of the binding affinity of c-di-gmp to ycir, the system becomes monostable again, exhibiting low level of active ydam molecules . this is supported by experimental data indicating a basal expression of csgb in mutant strains where the eal domain was mutated to an aal domain, thus diminishing the binding affinity of c-di-gmp to ycir  <cit> . the model suggests that the observed basal expression of curli might be a result of a single steady state with a low level of active ydam proteins. note that despite individual differences in the exact parameter values vmax <dig>  vmax <dig> and c6/kycirde between distinct feasible parameter sets at bifurcation points, the qualitative dynamics described above can be generalised to all identified parameter sets shown in fig.  <dig> 

dynamics of stochastic switching between different activity levels of ydam
although the identified parameter sets are qualitatively equivalent with respect to their stability properties , the equilibrium probabilities of each stable state and the dynamics of switching between the stable states might differ significantly. potential spontaneous switching between the stable states is an important property of stochastic multistable systems. by generating sample trajectories of the stochastic model one can show that on very short time scales the probability of each stable state is fully determined by the initial level of the key components in the system, while after sufficiently long simulation times the switching dynamics between the stable states marginalises the effect of initial molecular levels by inducing equilibration .

in the following, we analysed the switching behaviour between the two stable states  using all identified parameter sets. for each parameter set, we computed the probability of switching within a simulation time of  <dig> seconds. the result for each of the  <dig> identified parameter sets with regard to switching between the low and high ydam activity is shown in fig. 5a . a separation of the parameter space into four regions according to the switching probabilities between the two stable states indicates a certain asymmetry of the switching dynamics between the two states. for most of the identified parameter sets  we observed a high probability of switching  from the low ydam activity state to the high activity state while exhibiting a low inverse switching probability . these parameters induce an alert-type behaviour, where the system is very likely to switch to the curli expression state and most probably will remain in this state for some time. the number of these parameter sets exceeded the number of parameter sets exhibiting the opposite behaviour by an order of magnitude i.e. only  <dig> % of parameters indicated a small probability of switching from low ydam activity level  to a high ydam activity level , but a high probability of switching in the opposite direction. finally, a significant amount of feasible parameters sets exhibited very low switching probability in either direction , representing a possible robust differentiation of the bacterial population into two phenotypes, while  indicated high switching probabilities in both directions.
fig.  <dig> classification of identified parameter sets according to their mean switching times and switching probabilities between the two stable states. a. each of the feasible parameter sets is plotted according to the switching probability between the two stable states, given a maximal simulation time of  <dig> seconds. the parameter sets are classified into  <dig> regions which are divided by lines indicating a probability p= <dig>  of a switch in either direction. the colours represent the probabilities of switching in both directions, ranging from blue to yellow . the red boxes in the lower left and upper right corners indicate parameter regions inducing a low probability  and high probability  of switching in either direction, respectively. b. cumulative distribution of the switching times over all feasible parameter sets. for each of the  <dig> identified parameter sets  <dig> ssa simulations were performed by starting the system in the stable state either corresponding to the curli-off or curli-on state i.e. low/high amount of c-di-gmp, high/low amount of ycir in the ydam/mlra-inhibition state and low/high amount of active ydam molecules, respectively. each simulation was stopped if a switch to the opposite stable state was observed or if the maximal simulation time of  <dig> seconds was reached  for the definition of a switch). the mean switching time was computed over those trajectories that exhibited a switch for a given parameter set



in addition, we computed the time to switch between the two stable states. a summary plot for all simulations  is shown in fig. 5b, indicating that the time required to switch from the low to the high level of active ydam  was significantly shorter than for the reverse direction. when starting from the curli-off  state, a switch was observed in  <dig> % of all model parameterisations within  <dig> seconds. however, only slightly over  <dig> % exhibited a switch from the high ydam activity state to the low ydam activity state after this period . this difference in the times for switching in different directions is in line with the overrepresentation of parameter sets with a high probability of switching from the low to the high ydam activity state and low probability of switching in the reverse direction, as discussed above .

in order to identify the factors that give rise to the differences in switching behaviours, we compared the corresponding parameter sets. we identified significant differences between the distributions of several parameters inducing frequent switching in both directions  and those inducing very rare switching in both directions  i.e. the parameter sets marked by the two red boxes in fig. 5a. as shown in fig.  <dig>  there are significant differences  between the two parameter sets in terms of the total levels and/or activities of the pde-type enzyme ycir  and the dgc-type enzyme ydam ycirtot,kdydamandkdpolymerydam.
fig.  <dig> comparison of distributions of parameter sets inducing frequent switching to parameter sets with rare switching. stochastic simulations were performed as described in fig.  <dig>  the distributions of two parameter sets were compared: those with a high probability of switching p≥ <dig>  in both directions  and those with a low probability of switching p≤ <dig>  , as indicated by red boxes in fig. 5
a. a wilcoxon ranksum test was applied for detecting significant differences at a significance level p≤ <dig> . the parameters exhibiting no significant differences between the two sets are not shown



this suggests that changes of expression and activity levels of the dgc and pde enzymes due to e.g. transcriptional regulation might modulate the responsiveness of the system.

we compared the steady state levels of c-di-gmp, ycir ii and active ydam between parameter sets inducing frequent vs. rare switching dynamics between the curli-on and curli-off states in both directions . this graphic highlights the barrier that the system is required to overcome in order to switch to the opposite steady state. as shown in fig. 7b the steady state levels in the curli-on and curli-off states are significantly more distant for parameters inducing rare switching than those inducing frequent switching , possibly constituting a mechanism for controlling switching dynamics. furthermore, we compared parameter sets inducing a high switching probability in only one direction but a low probability in the reverse direction . significant differences between these data sets with respect to parameter values or steady state levels could not be found.
fig.  <dig> comparison of steady state levels of key system components within curli-off and curli-on phenotypes depending on switching behaviour. panel a : steady state levels of system components are shown as indicated above each subfigure for parameter sets inducing bistability with frequent switching  and rare switching  between curli-off and curli-on states. within each of these two groups the steady state levels of curli-on and curli-off states are shown . the steady state levels were computed using the ode system  and, for consistency, compared with the modes of the solution of the chemical master equation obtained by ssa sampling . panel b : the absolute difference between the molecular levels of system components between the curli-on and curli-off states is shown. the difference of molecular levels is computed for parameter sets inducing high and low probability of switching  between the curli-on and curli-off states. the p-values indicate the significance of the separation between the two distributions 



overall, besides the potential of the curli regulation system to induce bistable dynamics, our stochastic modelling results indicate alternative feasible scenarios of switching between the stable states. at the one extreme, the cells may be able to rapidly switch their phenotype and at the other extreme they may differentiate into two stable phenotypes. a difference between these two scenarios may be given by distinct expression levels of the involved proteins which regulate the energetic barrier separating the two stable states. it should be noted that certain reactions of the continuous model do not allow to distinguish between the impact of individual parameters as, for instance, the catalytic velocity of c-di-gmp degradation is determined by the product of two parameters: ycirtot and kyciract. therefore, additional kinetic data may help in future to further dissect the impact of reaction rate parameters on bistability and switching dynamics of curli expression.

discussion
multistability is a recurring mechanism in biological systems, enabling cellular heterogeneity and differentiation at the phenotypic level  <cit> . in order to understand the principles of its regulation, a thorough combination of wet-lab experimentation and mathematical modelling is required. many computational studies of bistable systems focused either on the network topology  <cit>  or on reaction kinetics  <cit> . here, we combined these two approaches. this enabled us to deal with heterogeneous data sources, such as expression levels in various knockout strains and kinetic rate parameters from in-vitro studies.

while multistability in signalling networks may be attributed to transcriptional and translational regulation as well as post-translational dynamics, in this study, we focused on molecular interactions at the post-translational level.

in our modelling pipeline we utilised three modelling frameworks in sequence to fully exploit the available data and investigate different aspects of the system on appropriate levels of abstraction. insights from each modelling- and analysis step were passed on in the pipeline and constituted, together with additional biological information accessible within the next higher detail-resolving formalism, the foundation for more elaborate models.

in a first step we used a constraint-based logical modelling approach enabling us to extract essential model characteristics needed to reproduce all available experimental observations. more precisely, we identified a set of logical models consistent with the suggested network topology that generates bistability in the wild type strain and fulfils all constraints given by the genetic data. furthermore, the logical modelling step revealed that the bistable distribution of the molecular pool of active ydam molecules  is the key determinant of phenotypic heterogeneity of curli expression observed in single-cell experiments. this insight allowed for a model reduction . the implicit assumption made here was that mlra and ydam do not compete for binding to ycir, making mlra a downstream component of the core regulatory network. structurally, this is justified by the possibility of independent and simultaneous binding of ydam and mlra to ycir due to its large interaction domain   <cit>  and different binding modes of ydam and mlra on that domain. in addition, genetic data from lindenberg et al.  <cit>  yielded functional arguments against competition between ydam and mlra. within our pipeline, the main result from the logical analysis passed on to the higher resolution modelling is the validation of the underlying network structure. we verified that the reduced topology shown in fig 1d can carry a dynamical model in agreement with all available data.

beyond purely topological insights, a closer look at the regulatory mechanisms encoded by the logical functions can also be exploited to derive parameter constraints for the continuous reaction-rate model. analysing the impact of different regulators on a target in different system states may yield information on relations between production and decay rates. theoretical results in this direction have been shown for specific classes of odes, see e.g.  <cit> , but they are not yet widely applicable. we suggested how to exploit this idea in a well-supported case for the curli regulation network and identified its potential for the sampling of kinetic parameters. still, for a systematic application of this strategy the theoretical groundwork needs to be further extended.

an even closer intertwining of the formalisms would also have been possible. automatic conversion procedures could have been used to lift a more abstract model into a more resolved formalism, e.g., to derive a generic ode system from a given logical model as suggested in  <cit> . however, this approach yields models that cannot incorporate additional mechanistic knowledge  in contrast to our approach, where we aimed at constructing a biologically realistic model by utilising all available kinetic information. as a consequence, the continuous model in our approach does not necessarily mimic the dynamics of the coarser models in all system states. it rather provides a complementary view based on the much higher detail resolution that allows to re-evaluate and broaden the results of the logical analysis. thus, a crucial advantage of our approach is the ability to incorporate experimental data from heterogeneous sources, carrying qualitative, semi-quantitative or fully quantitative information. a further possibility would have been to take smaller steps on the modelling scale and add hybrid formalisms to the pipeline, e.g. discrete-continuous systems modelled as hybrid automata or petri nets based on the boolean models that we derived in the first pipeline step  <cit> . however, we found that in our context this does not provide any clear advantages, since the computational cost of parameter- and dynamic analysis that go beyond qualitative aspects is already close to that of an ode model while still incorporating many abstractions of the underlying mechanisms  <cit> .

the ode model, derived in the second step of the pipeline, allowed us to identify regions in the multidimensional kinetic parameter space inducing bistable behaviour. using a monte carlo sampling procedure, we identified a sufficiently large amount of parameter sets inducing bistability in the wild type strain and monostable behaviour in particular knockout strains and strains with point mutations . note that sampling procedures are frequently used for identifying parameter regions inducing bistability  <cit> . we post-hoc compared the identified parameter distributions with experimentally measured parameters in related systems. thus, we could show that the network topology validated in the logical modelling step is capable of generating bistable dynamics within a biologically meaningful range of kinetic parameters, as shown in fig.  <dig> 

by conducting a bifurcation of key model parameters we exemplarily analysed the ranges where these parameters induce bistable regimes. this is of particular relevance since it was previously shown that during entry into the stationary phase of the growth cycle the σs-controlled dgc enzyme yege is induced, while the expression of the pde enzyme yhjh  is turned down. the remaining levels of the yhjh protein are diluted and degraded within the following cell divisions  <cit> . our results suggest that by fine-tuning the levels of yege and yhjh the cells maintain parametric configurations, which generate bistable behaviour. stochastic simulations indicate that a further increase of the protein levels of yege during the stationary phase might reduce the probability of the curli-off state and increase the probability of the curli-on state . this is in line with experimental measurements of the distribution of curli cells in bacterial colonies. serra et al.  <cit>  showed a spatial variation of this distribution, where the relative amount of curli-on cells increases with an increasing vertical distance to the nutritional source at the bottom of the colony. in addition, grantcharova et al.  <cit>  observed a variation of this distribution within different stages of the stationary phase of the bacterial growth cycle. furthermore, the bifurcation results suggested a narrow parameter region where the system is bistable. changing these parameters in a way that eliminates the catalytic activity of the c-di-gmp-regulating enzymes yege and yhjh, or decreases the binding affinity of c-di-gmp to ycir yielded monostable systems which could explain experimental results of corresponding single-gene knockout strains lacking yege and yhjh or carrying a yciraal point mutation .

finally, we addressed a possible mechanism inducing spontaneous switching between different stable states. stochastic simulations of the system indicated that depending on kinetic parameters, qualitatively different types of noise-induced switching dynamics may be observed, where most of the identified parameter sets indicated a higher probability of switching from the curli-off state to the curli-on state than vice versa . in line with these results, small chains of curli cells were observed within macrocolonies of e. coli, suggesting that once the cells switch to curli expression, they maintain this state and inherit it to successive cell generations  <cit> . we identified a significant subset of parameters  exhibiting a low switching probability in either direction . this suggests that certain parameter configurations might enable a long-term differentiation of the cells into curli producers and non-producers, retaining the status-quo until system parameters change again e.g. due to a variation of environmental conditions. a possible regulatory mechanism for controlling the switching behaviour might be given by the level of separation of steady states within distinct phenotypes. in support of this, we observed that the deviation of stable c-di-gmp levels between curli-off and curli-on phenotypes was much more pronounced in parameter sets that favour a differentiation  than those parameter sets that allow frequent switching between the two phenotypes. a greater separation of these levels may induce a larger  barrier and robustness against stochastic fluctuations, which could be a potential mechanism controlling the phenotypic plasticity of e. coli. a comparison of the steady state levels in fig.  <dig> with experimentally measured numbers of system components, in particular c-di-gmp, in curli-on and curli-off cells may shed further light on this topic.

note that in this study we only focused on the noise resulting from post-translational interactions. the implicit time-scale separation assumption can be justified by the longer time scales of fluctuations in protein copy numbers as compared to the longest simulations in this study . in our simulations, we observed that switching from curli-off to curli-on states was generally fast  and may thus not be affected by slower noise processes, that are related to protein copy number variations. however, switching in the opposite direction  may occur at a slower time-scale  in some parameter sets and may thus be influenced by the noise resulting from transcriptional and translational events. further kinetic data may enable a refinement of this model by explicitly including gene expression noise.

CONCLUSIONS
in this study we have presented a framework for the analysis of multistable signalling networks with an application to the stationary phase-induced curli regulation system of e. coli. using a hybrid sequential logical-continuous approach we first verified the potential of the curli regulation system for inducing bistability by incorporating genetic knockout experiments as discrete model constraints. based on the validated network topology, we derived a reaction-rate model of the system and identified several parameter sets that are capable of inducing bistable dynamics. notably, most identified parameter sets are located in a biologically meaningful region. in addition, we analysed the dependence of the probability of the stable curli-on and curli-off states on system parameters. we showed that certain parameter variations, e.g. the amount and activities of the dgcs and pdes, give rise to different switching dynamics between curli-on and curli-off states .

the present study introduces the first mathematical model of bistable regulation of curli fibers in e. coli based on post-translational interactions of multiple dgc and pde proteins with the signalling molecule c-di-gmp as the central player. our results deliver new potential targets for further experimental investigations, which may help to test the modelling hypotheses and to successively deepen the understanding of biofilm control in bacteria.

additional files
additional file  <dig> 
supplementary information on logical modelling formalism including figures s <dig> and tables s <dig> and s <dig> 




additional file  <dig> 
stepwise derivation of the reaction rates of the time-continuous model and description of the assumptions and of the validity criterion used for the derivation of the stochastic propensity functions.




additional file  <dig> 
this.csv file contains the identified parameter sets used for the stochastic modelling of curli regulation in
e. coli
.




additional file  <dig> 
figure s <dig>  violin plots showing the linearly scaled distribution of parameters in fig.  <dig> of main manuscript along with the proposal distribution of the rejection sampling procedure . the bounds of the proposal distribution, empirical means of each sampled parameter and the experimentally measured values of similar parameter values from the literature are equivalent to those in fig.  <dig> 



additional file  <dig> 
figure s <dig>  solutions of the chemical master equation ) based on monte carlo sampling  <cit> . three different initial levels of c-di-gmp were used: x
1= <dig>  and  <dig> molecules . the initial levels of the other two system variables were equally set to x
2= <dig>  and x
3= <dig> . three different simulation times t were used in order to identify the equilibration time of the system: t= <dig>  and  <dig> seconds .  <dig> stochastic sample trajectories were generated for computing each solution. the final empirical sampling distributions in the figures were subject to a kernel smoothing.



competing interests

the authors declare that they have no competing interests.

authors’ contributions

conceived the study and participated in its design and coordination: kpy, mvk, rh and cs. analysed the data: kpy, mvk and as. performed simulations: kpy and as. interpretation of results: kpy, as, hs and mvk. wrote the manuscript: kpy, as, hs and mvk. extensive reviewing and editing of the manuscript: kpy, as, hs, mvk and rh. all authors read and approved the final manuscript.

