BACKGROUND
rnas are known to carry important functionalities among diverse species, while those with similar functions are usually less conserved at sequence level in structured regions. hence, it is critical to consider the structural information in rna comparison, aiming to elucidate their functional and evolutional relationship. rna three dimensional structure mainly determine the current methods for rna secondary structure comparison can be generally classified into two categories, i.e., alignment-based and alignment-free.

the alignment-based methods are mostly conducted in a dynamic programming framework, relying on a string or tree representation of rna secondary structure . the rna secondary structure alignments generally fall into two broad categories: sankoff-based and non-sankoff rna alignment. the sankoff algorithm simultaneously folds and aligns two or more rna sequences using free energy minimization  <cit> . its time complexity and space complexity are o  and o , respectively, given m rna sequences with lengths of n. although this algorithm has a very good performance in prediction, its heavy computational complexity greatly limits its application.

therefore, in order to be more practical, there are many simplifications of sankoff algorithm  <cit>  including but not limited to consan  <cit> , dynalign  <cit> , pmcomp  <cit> , stemloc  <cit> , foldalign  <cit> , locarna  <cit> , sparse  <cit> , marna  <cit> , foldalignm  <cit> , murlet  <cit> , carna  <cit>  and raf  <cit> . pmcomp performs pairwise and progressive multiple alignments based on base pairing probability matrices computed from mccaskill’s algorithm  <cit> , which simplifies sankoff’s model by predicting only a single consensus structure. locarna improves pmcomp using local alignment. carna is an improved algorithm to consider rna pseudoknot structures based on the pmcomp model. sparse specifies prediction and alignment of rnas based on their structure ensembles in quadratic time. dynalign calculates a common structure by combining free energy minimization and comparative sequence analysis to find a low free energy structure common to two sequences without any sequence identity. non-sankoff algorithms separate these two processes: folding and alignments. the main methods include cmfinder  <cit> , lara  <cit> , rnadistance  <cit> , rnastrat  <cit> , rnaforester  <cit> , scarna  <cit> , gardenia  <cit> , era  <cit>  web-beagle  <cit>  and rnapdist  <cit> . rnadistance, rnaforester, rnapdist and rnastrat are all tree-based approaches. rnadistance compares rna secondary structures based on tree edit distance, and rnaforester calculates the pairwise- or multiple-alignment of structures based on tree alignment. rnapdist is another program based on the base pairing probabilities, which has been included in the vienna rna package  <cit> . rnastrat uses a conservative edit distance and mapping between two rna stem-loops based on a tree representation. lara is a graph-based representation for structural alignments using an integer linear program. cmfinder is based on a covariance model . gardenia is based on the definition of the common arc-annotated supersequence. era is an efficient and accurate rna secondary structure alignment tool using the sparse dynamic programming technique. in  <cit> , a new context-aware encoding representation for rna secondary structure named as bear is designed and an rna structural alignment based on bear encoding is proposed by integrating a constructed substitution matrix of rna structural elements with needleman-wunsch algorithm. the web server web-beagle  <cit>  of rna structural alignment based on bear encoding is developed. among the above alignment-based tools, rnadistance and rnapdist are the two most widely-used tools, which have been included in the vienna rna package  <cit> . it is noteworthy that the above alignment-based methods have an intensive requirement in time complexity.

an alignment-free algorithm is usually based on a numerical representation of sequences, which requires a novel idea and alternative way to visualize, analyze and compare dnas, rnas and proteins. hence, compared to the alignment-based methods for rna structure comparison, the studies on alignment-free algorithms are limited. in  <cit> , various graphical representations of protein, dna and the secondary structure of rna were reviewed. a three-dimensional curve that constitutes a unique representation of dna sequence was proposed by chun-ting zhang  <cit> , so-called z-curve. it is one of the representative studies in this field and has been successfully applied to many different bioinformatics areas, including identification of replication origin, proteins-coding genes, genomic island, gc content variations, and phylogenetic analysis . as far as we known, noncoding rnas are more conserved at structure levels  <cit> . it is very important to consider the structure features for alignment-free rna comparison algorithm. the sequence and structure features of rnas have been changed into different representations, including  <dig> dimensions,  <dig> dimensions,  <dig> dimensions and image . for instance, the features of the sequence and base pairing were transformed into a linear sequence, then the lempel-ziv algorithm was applied to compute the similarity  <cit> . graphclust is another alignment-free algorithm based on a fast graph kernel technique for clustering of local rna secondary structures  <cit> . recently, signal and image processing methods have been found useful in elucidating the similarity, and more details could be found in  <cit> . alignment-free methods for rna comparison usually have lower time complexity and less accuracy compared with alignment-based methods.

in addition, with steadily increasing numbers of known 3d rna structures, some 3d structure alignment algorithms and their web serves including setter  <cit> , multisetter  <cit> , r3dalign  <cit> , rclick  <cit> , r3d-blast  <cit>  and r3d-2-msa  <cit>  have been developed.

we developed a web server, rna-tvcurve, for inferring rnas’ relationship based on comparing their secondary-structures. the underlying alignment-free algorithm is summarized in the next section and more details can be found in  <cit> . this method has two unique features: 1) a novel numerical representation of rna sequence and its secondary structure; and 2) a novel multi-scale similarity metric of above numerical representation based on wavelet decomposition. rna-tvcurve has three functions: 1) visualization of rna secondary structure; 2) detection of single-point mutation based on rna secondary structure; and 3) construction of phylogenetic trees for multiple rnas. evaluations of our in-house algorithm and web server has been carried out on single point mutation identification for rna virus and phylogenetic trees construction for non-coding rna families. these performance comparison analyses were only conducted between rna-tvcurve and two alignment-based programs, rnadistance and rnapdist, as no other web servers based on alignment-free methods for rna structure comparison are available in the public domain. the results showcased that rna-tvcurve is more reliable than rnadistance and rnapdist. the main results are shown using intuitive figures. all the related results and execution files can be freely downloaded at http://ml.jlu.edu.cn/tvcurve/.

implementation
methodology for pairwise rna secondary structure comparison based on rna-tvcurve
the details of the underlying algorithm of rna-tvcurve can be found in  <cit> . here we firstly summarize the core methodology for pairwise rna secondary structure comparison in the following four steps .fig.  <dig> core methodology of rna-tvcurve including four sub-block diagram:  rna secondary structure prediction,  characteristic representation for combining rna sequence and secondary structure,  construction of tv-curve ,  wavelet decomposition of tv-curves and multi-scale similarity measure based on tv-curves





step 1: the minimum free energy method in terms of vienna’s rnafold  <cit>  is used to predict the secondary structure for any given rna sequence if users do not provide secondary structure.


step 2: the characteristic representation of rna secondary structure is designed based on eight symbols, in which a, c, g and u were used for the unpaired nucleotide bases, and a′, c′, g′, and u′ were used for the same bases if paired by hydrogen bonds.


step 3: a new numerical representation of rna is constructed, named as triple vector curves , by integrating rna sequence and secondary structure features. the triple vectors are designed to represent the eight a, t, c, g, a′, u′, g′ and c′ symbols respectively as follows: ,,⇒a,,,⇒a',,⇒u,,,⇒u',,⇒g,,,⇒g',,⇒c,,,⇒c' 


the schematic diagram of triple vectors representing eight letters is shown in subfigure of step  <dig> in fig.  <dig>  there is a one-to-one mapping between the tv-curves and the rna information of sequences and secondary structures. the tv-curve is a visualization method to represent the information of the primary and secondary structure of an rna molecular, which can provide users another angle to display and infer the difference between rnas, especially for the long rnas.


step 4: firstly, the wavelet decomposition  <cit>  with l-level of rna tv-curves are computed. after the l-level transformation, the detailed coefficients and approximation coefficients at the different resolution are obtained. l is usually taken as four by default. next, a novel similarity metric, named multi-scale similarity, was designed to capture both the global and local properties of the constructed tv-curve based on wavelet decomposition. the pearson correlation coefficients at different decomposition levels are calculated and the weighted sum is taken in the multi-scale similarity calculation.

detection of maximal structure difference among all rna single point mutants
for an rna sequence of length n, there are three possible types of mutations for each position. for the original rna sequence, if the original structure is not provided, the secondary structure of the original rna sequence will be predicted with the minimum free energy algorithm. all the 3*n single point mutated rna sequences are constructed. for each single point mutated rna sequence, the minimum free energy algorithm is used to predict the secondary structure. in order to identify the maximal structural mutation, the similarity between each mutated rna sequence and original rna sequence based rna-tvcurve is computed. the similarity score is changed into a distance score by one minus it. the mutation with the maximal structural distance is identified. furthermore, the histogram of the structure distance scores of all the single point mutation is provided to help users to comprehensively understand the landscape of all the single point mutation. in addition, to describe the structural stability of each position, the deleterious profile is defined as the maximum distance in structures between the wild-type and the possible single point mutants at each position. the structurally important sites can be easily identified by the peaks with a larger structural distance on the profile. the distributions of the distances between the wild-type and all the possible single mutants are shown as histograms. the histograms of the distances between the wild-type and all the possible single mutants provide the visual understanding on rna mutational robustness.

construction of rna phylogenetic trees
the main steps of construction the rna phylogenetic tree are listed as follows:


step 1: compute tv-curve for each sequence in a given rna set.


step 2: calculate similarity matrix of n / <dig> similarity between all pairs of n sequences by pairwise rna secondary structure comparison based on rna-tvcurve as mentioned above.


step 3: converting raw similarity scores to distances scores by 1-minus-similarity.


step 4: construct a phylogenetic tree from the distance matrix by upgma . firstly, cluster a pair of rnas  with the smallest distance. then re-calculate an average distance between the new cluster and other taxa, obtaining a new distance matrix. finally, repeat previous step until clusters converge.

usage of web server
rna-tvcurve offers four different functional modules :  tvcurve: visualization and generation of tv-curve for a provided rna sequence;  rna mutation: rna single point mutation detection for a given rna sequence;  rna multiple:construction of rna phylogenetic tree for multiple rnas.  rna pairwise: perform pairwise comparison based on rna-tvcurve. all these usages are freely available and no login information is required.

the server is accessible at: http://ml.jlu.edu.cn/tvcurve/ with standard web browsers . each functional module of the web serve of rna-tvcurve has been tested through four examples. the test samples for each module and the examples shown in this paper are listed in the server and also included in additional file  <dig>  aiming to help users to understand and use each of the functional modules. the input of the web server can be either entered in a text box or uploaded as an individual file from a local computer. users can either directly run example datasets on the web server or upload their files to test different functional modules. the minimal length of the input rna sequence for rna-tvcurve is  <dig> 

all functional modules require the input in fasta format or a modified fasta including the secondary structure in dot-bracket. upon a job is submitted to the server, a job id will be generated. a user can just save the job id and use it to extract the results. for a submitted job, its results are saved up to  <dig> month so that the user can query and retrieve. the probable long-running jobs include the rna structural mutation detection for a longer rna sequence with a length larger than 1000 nt, and the rna phylogenetic tree construction for more than  <dig> rna sequences. some important results including the tv-curve, the mutated structure with the maximal structural difference and the phylogenetic tree are shown in a more intuitive graphical manner. the output page also offers the download of the results as a single packed file in “.zip” format for offline analysis. the readme file in the packed file provides information on of the downloaded results. the detailed steps and functionality of each module are introduced in the following.

functional module 1:tvcurve
this module provides a visualization for the tv curve constructed from provided rna sequences and secondary structures. the input should be rna sequences in the fasta format that are provided with or without secondary structure information. if the structures of some rnas are not provided, the secondary structures are predicted with the minimum free energy algorithm. the output provides the tv-curve representation and the multi-scale decomposition of the tv-curve, and the secondary structure for each rna. all the results including tv-curve representation, the multi-scale decomposition of the tv-curve, and the secondary structure can be freely downloaded. detailed executive process and results of the example for this module are presented in additional file 3: figure s <dig>  the example dataset uses nine virus rna sequences.

functional module 2:rna mutation
this module is to accomplish the rna single point structural mutation detection. the required input for this module is a single rna sequence and structure or a sequence alone. if multiple rna sequences are submitted, only the first sequence is calculated. for this functional module, there is an option “compare with rna distance and rnapdist” to benchmark the results with both tools. this option is not selected by default. the maximum distance in structures between the wild-type and those with mutations at each position is extracted into a structural deleteriousness profile. this module provides the deleteriousness profiles and their histograms for rna-tvcurve. the structure with the maximum structure difference calculated by rna-tvcurve is given the corresponding mutation types and mutation sites are also provided. in addition, in order to help users to visualize the structural difference between the wild-type and all the mutants, the secondary structures of the wild-type rna and the mutated rna with the maximum structural distance are also displayed on the web page. all the structural distance scores of the single point mutations detected by rna-tvcurve are ranked, which are included in the downloaded file. if users select the option “compare with rna distance and rnapdist”, this module provides the deleteriousness profiles and their histograms for rna-tvcurve, rnadistance and rnapdist, respectively. the structure with the maximum structure difference calculated by rna-tvcurve, rnadistance and rnapdist are given and the corresponding mutation types and mutation sites are also provided. we will rank all the structural differences of the single point mutations detected by the three methods respectively. the detailed executive process and results of the example for this module are presented in additional file 4: figure s <dig>  the input example dataset is the leptomonas collosoma sequence.

functional module 3: rna multiple
for module  <dig>  the input is a set of rna sequences and their structures or rna sequences and part of structures or primary sequences alone . the phylogenetic tree computed by rna-tvcurve is displayed on the web page. all the related results include the phylogenetic tree, tv curves and distance matrix using rna-tvcurve can be freely downloaded. similar to the module of “rna mutation”, users have an option “compare with rna distance and rnapdist”. if this option is selected, the three phylogenetic trees computed by rna-tvcurve, rnapdist and rnadistance are all shown in an intuitive graphical manner on the web page, which can help users make comparison and further analysis. in this case, the downloaded file includes three phylogenetic trees and distance matrix computed by rna-tvcurve, rnapdist and rnadistance. when the number of the sequences is larger, the alignment-based rnapdist needs more time to compute. in addition, the labels of the leaves on the tree are hard to read when the number of multiple rnas is large. we construct the tree at horizontal direction in order to more clearly display the labels of the leaves on the tree when the number of multiple rnas is larger than  <dig> 

the example of construction the phylogenetic trees for multiple rnas is  <dig> sequences of four non-coding rna families including mirna, rnasep_arch, 5s_rrna and trna. in order to make the performance for each method clearly, four types of colors are marked for each family. the phylogenetic tree by rna-tvcurve has four noticeable branches and only four rnas are assigned at the wrong branch, where each branch represents one rna non-coding family. the detailed executive process and results of the example for this module are presented in additional file 5: figure s <dig> 

functional module 4: rna pairwise
this module is to accomplish rna pairwise comparison based on rna-tvcurve. the input of this module includes two sets of rna sequences. one set is named as query set and the other one as target sets. both of the two sequence sets include rna sequences and their structures or rna sequences and part of structures or primary sequences alone. they should be in the fasta format and contains the same number of rnas. in this module, the rnas in the query set and the corresponding rnas in the target set are compared by rna-tvcurve. the distance score for each pair of rnas are shown on the web server. in addition, the rna tv curve and secondary structure of each sequence are also displayed on the web server to help users further understand the structure difference between a pair of rnas. all the related results are packed in a zip file for download.

the detailed executive process and results of the example for this module is presented in additional file 6: figure s <dig>  the pairwise comparison is conducted between query set and target set with  <dig> virus sequences respectively.

RESULTS
we assessed the performance of rna-tvcurve compared with the two popular alignment-based programs, rnadistance and rnapdist. in order to systematically evaluate the performance of rna-tvcurve, two types of experiments are designed, one of which is to test the capability to infer the evolution for different species and the other is to validate the performance to distinguish the different types of rna families.

type i study: 5s rrnas, rnase p and rnase mrp
the sets of different types of rnas from different species in  <cit>  are designed to evaluate the performance of the constructed rna phylogenetic tree in terms of its accuracy. in order to clearly identify the evolutional relationship among the above sets, additional file 7: table s <dig> and table s <dig> provided the detailed information of family and species for the following two sets: set i from 5s ribosomal rna database  <cit> ; and set ii including rnase p and rnase mrp obtained from the rnase p database  <cit>  and ncbi. set ii is used to test distantly related sequences, which have limited homology information. the phylogenetic tree for set i of 5s rrnas constructed by rna-tvcurve, rnadistance and rnapdist is shown in fig.  <dig>  the phylogenetic trees constructed by rna-tvcurve has clearly two branches for the groups of archaea and eukaryotes, only dicyema misakiense is wrongly placed on the archaea branch, however the other two phylogenetic trees constructed by rnadistance and rnapdist do not show such good property. in addition, on the phylogenetic trees constructed by rna-tvcurve and rnapdist, the three groups of fungi, metazoa and crenarchaeot are all placed closely. the phylogenetic trees for set ii of rnase p and rnase mrp constructed by the three programs are listed in fig.  <dig>  rna-tvcurve also shows the best result compared with rnapdist and rnadistance, in which the phylogenetic tree constructed by rna-tvcurve has clearly two branches for the groups of rnase mrp and rnase p, only one rnase p m.jannaschii is wrongly placed on the branch of rnase mrp. the groups of alpha subdivision and cyanobacterial are all grouped closely. the other two phylogenetic trees constructed by rnadistance and rnapdist have limited power in distinguishing the rnase mrp and rnase p.fig.  <dig> the phylogenetic tree for the set i of 5s rrnas. a the phylogenetic tree constructed by rna-tvcurve, b the phylogenetic tree constructed by rnadistance, c the phylogenetic tree constructed by rnapdist. in this figure rnas in same the box mean they are consistent to the same known subgroup. the line is to mark the branch of the constructed tree


fig.  <dig> the phylogenetic tree for the set ii of rnase p and rnase mrp. a the phylogenetic tree constructed by rna-tvcurve, b the phylogenetic tree constructed by rnadistance, c the phylogenetic tree constructed by rnapdist. in this figure rnas in same the box mean they are consistent to the same known subgroup. the line is to mark the branch of the constructed tree




type ii study: different rna families from rfam database
next, different rna families from rfam database are used to evaluate the ability of these three programs in distinguishing the different types of rna families. the sequences of rrna, trna, mirna and rnase_p families are downloaded from the rfam database. in order to directly compare the performance for distinguishing the different types of rnas, pearson correlation is used to measure the consistency between the similarity measure and the background co-membership matrix. it is actually the correlation between the similarity matrix computed and the background co-membership matrix  <cit> . intuitively, a larger value of pearson correlation means a higher consistency with the background matrix. due to the large amount of sequences including  <dig>  rna sequences, it is not realistic to compute the similarities among them all. in this paper, we made  <dig>  random samplings from the downloaded sequences, in which  <dig> sequences from each rna family are randomly selected. then the similarity matrices for all the families were computed by rna-tvcurve, rnadistance and rnapdist. the corresponding pearson correlation coefficients were calculated for each sampling. the time complexity of rnapdist and rnadistance are both o . rna-tvcurve dramatically reduce the computational time complexity to o   <cit> , where n is the length of an rna sequence. the comparison of pearson correlation coefficients of rna-tvcurve, rnadistance and rnapdist for the  <dig>  experiments is shown in fig.  <dig>  rna-tvcurve is showcased significantly superior to rnapdist and rnadistance.fig.  <dig> the comparison of pearson correlation coefficients for rna-tvcurve, rnapdist and rnadistance to validate the ability to distinguish the different rna families from rfam database




CONCLUSIONS
the rna-tvcurve server provides an access to our alignment-free rna secondary structure comparison algorithms. it is the first integrated web server for rna analysis based on alignment-free method, which provides a novel visualization of rna secondary structure, mutation analysis, pairwise and multiple rnas secondary structure comparison. this method can provide a novel view to visualize and analyze rnas. our evaluations suggest that the web server is a good visualization tool, and more importantly, it can be used to solve a wide range of rna related analysis and mining problems. particularly, it is very useful for making deleterious mutation prediction, rna structural feature extraction and multiple rna structural comparison. we believe the server will be a useful tool for rna comparison and fill a void in this field.

a future improvement could be rna-tvcurve capacity extension to handle multiple point mutations. in addition, the native secondary structure of an rna is often a suboptimal structure not the predicted structure with minimum free energy due to limitations of thermodynamic models. integrating multiple predicted suboptimal structures in the rna structural similarity measurement is still very challenging and there is still a big room for improvement in its performance. in further study, we will focus on developing an rna comparison tool based on integration of multiple suboptimal structural features. since real structures of rnas are very close to the structures with the minimum free energy, it is very import to consider a reasonable filter process. in addition, we will develop a new tool and a web server to search the public rna datasets such as human 3′ utr, mouse 3′ utr, human lncrnas, mouse lncrnas, and structured rfam based on rna-tvcurve. these computational techniques will be very useful and crucial for in-depth inference of rna functions.

additional files

additional file 1: figure s <dig>  the web server of rna-tvcurve including four functional modules. a) main home page, b) tvcurve, c) rna mutations, d) rna multiple, and e) rna pairwise. 


additional file 2: supplementary_example_set: the fasta files of the used rna sequences. 


additional file 3: figure s <dig>  schematic diagram of functional module tvcurve: a) select the example sequence and the operation button, b) waiting interface: job id, c) results of the module of tvcurve: results and download interface. 


additional file 4: figure s <dig>  schematic diagram of functional module rna mutation: a) select the example sequence and the operation button, b) waiting interface: job id, c) results of the module of rna mutation: results and download interface. 


additional file 5: figure s <dig>  schematic diagram of functional module rna multiple: a) select the example sequence and the operation button, b) waiting interface: job id, c) results of the module of rna multiple: results and download interface. 


additional file 6: figure s <dig>  schematic diagram of functional module rna pairwise: a) select the example sequence and the operation button, b) results of the module of rna pairwise: results and download interface. 


additional file 7: table s <dig>  the information of families and species of set  <dig> of 5s rrna. table s <dig>  the information of families and species of set  <dig> of rnase p and rnase mrp. 




abbreviation
rna-tvcurverna triple vector curve representation

