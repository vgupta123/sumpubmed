BACKGROUND
animal health surveillance provides scientific and factual evidence that is critically essential to inform decision making, and to motivate timely and appropriate animal health action  <cit> . an obvious specificity of animal health surveillance data is that they come from different species and different environments . for the purpose of this paper, we will focus on the latter, i.e. through surveillance, we are interested in detecting health changes at all levels of the complex web that is a food production system, made up of sub-populations which are constantly moving around between farms to markets and slaughter.

few stories illustrate the importance of early event detection for efficient disease control better than the  <dig> foot-and-mouth epidemic in the uk. the  <dig> weeks delay in clinical detection of the virus by surveillance systems allowed the virus to spread across the country unnoticed. ultimately, over  <dig>  million livestock were slaughtered for disease control purposes, putting the estimated total cost of the epidemic at £ <dig> billion  <cit> . healthy animals contribute to public health by providing safe food and preventing contact between people and infectious animals carrying zoonotic pathogens. healthy animals also contribute to strong rural agricultural economies. being free from many animal diseases reduces the losses from disease , the cost for controlling diseases, and increases the quality of animal derived products, thereby making agriculture more competitive. being free from animal diseases that prevent international free trade also opens market opportunities to farmers.

national veterinary services navigate “waters of budgetary restraint, strewn with the flotsam of competing issues”, in efforts to understand, control and eliminate complex disease situations  <cit> . active surveillance methods, i.e., collecting data according to a defined plan relating to a particular condition, form the backbone of animal health surveillance systems and require significant investments in terms of resources and persons. surveys to substantiate freedom from disease, routine serological surveillance for foreign animal diseases in sentinel farms or sampling of wildlife are all very costly and time-consuming. at the same time veterinary services are more and more confronted with limited resources. the development of cost-effective tools for animal disease and food safety surveillance is therefore of priority to decision-makers in the field of animal health  <cit> . rapid advances in bioinformatics and data mining in the last decade have resulted in an increasing amount of data directly or indirectly related to animal health being collected and stored in very diverse databases. some of these databases are curated by governmental organisations at national and regional levels; while others  are maintained by, and for the benefit of the livestock industry and affiliated businesses . most of these data are used for administrative or economic purpose. however, they could be used in the passive surveillance of animal health as part of an integrated syndromic surveillance  system. the goal of sys is to monitor non-specific health indicators  in a continuous real-time fashion in order to detect disease outbreaks earlier; and more rapidly characterise them than traditional notifiable disease methods  <cit> . temporal aberrations in the occurrence of pre-defined syndromes are detected using algorithms that produce alerts when such syndromes occur more often than expected by chance. by definition, sys does not target specific diseases as it is based on health data collected before a diagnostic has been made for individual cases. this is why alerts should be followed with epidemiological investigations that will identify the hazard present. beyond outbreak detection, sys, more generally, contribute to timely and accurate population health situation awareness.

multivariate sys systems  have greater sensitivity and are more reliable than univariate systems  <cit> . not only does no single data source capture information from all the individuals involved in an outbreak; the information recorded is only partial and unspecific. for example, some diseases will cause a wide variety of clinical symptoms in different people or animals  and/or will affect different strata of the population . since there is often different information contained in observations from different data sources, sys systems should be multivariate by nature, i.e. simultaneously evaluating various combinations of multiple datasets. a sys continuously screening multiple data streams may appeal to decision makers as consistent evidence may be used to suggest inferential accuracy.

despite this demonstrated advantage  <cit> , most operational sys systems usually run multiple univariate aberration detection methods, each focused on detecting an unexpected increase in the times series of a particular syndrome . univariate aberration detection algorithms have the advantage of ease of application and interpretation: they employ hypothesis testing to provide systematic alert protocols. however, univariate methods are less sensitive to changes in disease incidence and suffer from a higher rate of false alerts, causing users to ignore alerts when they occur all the time. furthermore, most univariate aberration detection algorithms, such as statistical process control methods, cannot adequately deal with the specificities of surveillance time series such as the presence of strong seasonality or trends. these predictable effects must first be modelled and removed from the data, a step called pre-processing  <cit> . a historical baseline free of outbreaks is also necessary in order to be able to create models of expected behavior. this often constitutes a real challenge as most outbreaks may not be labelled, nor will their shape and magnitude be known  <cit> . on the other hand, a stochastic modelling-based approach to outbreak detection offers more flexibility, allowing for the retention of historical outbreaks, for overdispersion , non-stationarity  and the possibility to base the alarm system on the predictive distribution   <cit> . while such methods are not new, they have only recently received attention in the field of public health surveillance  <cit>  and are yet to be applied to animal health surveillance data.

the aim of this paper is to apply an example of such stochastic model, namely held and colleagues’ two-component model  <cit> , to two multivariate animal health datasets from switzerland in order to 1) evaluate its performance under different properties- namely time alignment versus time mis-alignment of the events under surveillance; 2) and assess its calibrations under outbreak prediction surveillance scenarios. we start our methods section by providing a succinct review of aberration detection methods , developed within the context of prospective sys surveillance. we then explain the two-component model in more details before showing, in the results section, its outbreak prediction performance compared to univariate models when applied to swiss diagnostic laboratory data and cattle abortion data. in the discussion, we share our experience of the methodological challenges encountered when attempting to apply multivariate methods to animal sys data.

methods
prospective univariate surveillance
outbreak detection
a comprehensive review of univariate statistical methods for prospective outbreak detection was compiled by  <cit> . in summary, the outbreak detection statistical process can be viewed as a two-step hierarchical model: 
in step  <dig>  the data  are modelled in order to obtain a prediction for each time point t, yt∼distr, where μ
t and σt <dig> are the mean and variance. this step requires the training data to be free of historical disease outbreaks in order to determine ‘typical’ background behaviour against which the presence of abnormalities can be investigated  <cit> .

in step  <dig>  the observed value at t is assessed against a prediction threshold, derived from the model in step  <dig>  to define whether an alarm should be triggered.




parametric regressions are commonly used in step  <dig>  for example, serfling’s method, a cyclic regression model, is capable of dealing with time trends and seasonal variations  <cit> , and is the standard center for disease control algorithm for flu detection. the method developed by  <cit> , based on a quasi-poisson regression, is routinely used by health protection agency in uk. semiparametric methods, such as the combined use of gaussian kernel smoothers with generalised additive models as in  <cit> , are also available. the threshold  above which an alarm is triggered in step  <dig>  can be defined in different ways: it can be defined as the upper prediction limit ut=μ^t+kσ^t , or based on 23-power transformation in the methods of  <cit> .

statistical process control  charts also have a long history of application in public health surveillance. cumulative sums , exponentially weighted moving averages , and shewhart control charts are routinely used for early disease detection on data from diagnostic laboratories in sweden and parts of canada  <cit> .

assuming that y
t follows a normal distribution, yt∼n, the one-sided  gaussian cusum at t is defined iteratively by 
  <dig> ct=max <dig> ct−1+yt−μtσt−k, 


where c
0= <dig>  k> <dig> and the threshold h are the two constants that depend on the size of the aberration of interest. the parameter k is often chosen to be 1/ <dig>  <cit>  while h will depend on the desired false alarm rate. a cusum approach for count data  is implemented in r: surveillance  <cit>  and r:vetsyn  <cit>  packages.

outbreak prediction
outbreak prediction algorithms differ from their outbreak detection counterparts in two major ways. first, models are fitted using the whole historical data available, i.e. without removing data linked to past disease outbreaks. they have the feature to model epidemics. second, the alarm system is based on the predictive distribution itself instead of comparing the observed value to a threshold. one example is the two-component model proposed by  <cit>  for univariate analysis, later extended to multivariate modelling by  <cit> . the two-component model can be based on poisson- or negative binomial distributed observations. its first component is parameter-driven and links latent endemic seasonal patterns to disease incidence. its second component is observation-driven and is based on the number of disease cases at previous time points.

outbreak prediction has many advantages over outbreak detection. since in step  <dig>  the model does not require the removal of disease outbreaks from the data, it is based on all available historic information, unlike many other algorithms that ignore a large percentage of the data in order to avoid having to deal with seasonal effects. furthermore, selection of a suitable model can be performed through the akaike information criterion  or the bayesian information criterion . the quality of the predictions can be assessed based on several diagnostic tools. proper scoring rules have been applied in  <cit>  to evaluate the predictions, which measure the predictive quality by assigning a numerical score, based on a stated predictive distribution and the later observed true value. the scoring rules are preferred by  <cit>  to check the predictions from mixed models which include random effects for multivariate modelling. there are three commonly used proper scoring rules: the logarithmic score   <cit> , the dawid-sebastiani score   <cit>  and the ranked probability score   <cit> . ls is the negative log-likelihood evaluated at the actual observation; dss is the standardised difference between the actual observation and predictive mean value plus a penalty of the predictive variance; rps is the sum of the brier scores  <cit>  for binary predictions at all possible thresholds. calibration tests are developed in  <cit>  to check the statistical consistency between observed values and their predictions. such tests can be constructed based on the proper scoring rules and interpreted so that small p-values signify poorly calibrated predictions.

in step  <dig>  outbreak prediction methods will raise a statistical alarm earlier than outbreak detection methods. an alarm is triggered based on the prediction instead of comparing the observed number with a predefined threshold. an alarm can be triggered at time t if the predictive probability that more than u
t cases will be reported is bigger than θ: 
  <dig> pr>θ. 


here, the two threshold u
t and θ can be chosen to control the false alarm rate or be based on expert opinion. alternatively, an alarm can be triggered based on a sequential monte carlo change point algorithm as in  <cit> . this method can be applied to the epidemic component which is allowed to change over time  <cit>  from one-step-ahead forecast distributions. sequential particle filter algorithms have been applied in this setting in  <cit> .

multivariate surveillance
disease mapping and clustering
point-pattern methods on spatio-temporal data can be used to assess whether disease cases are clustered, to identify areas of elevated disease risk and to generate hypotheses regarding disease etiology  <cit> . numerous methods of spatial cluster detection have been published , including spatial point process summary methods  <cit> , nearest neighbour methods  <cit> , and local rate scanning methods  <cit> . most of these methods can be implemented within freely available software: the k function and kernel intensity function within r  <cit> , cuzick and edwards’ method  <cit>  within clusterseer®; , and kulldorff’s scan statistic  <cit>  within satscan  <cit> .

a multivariate scan statistic was developed in software satscan to allow the detection of clusters in either a single or multiple datasets . such multivariate approach can be useful to detect different sources related to the same pathogen or whether a common environmental hazard exists. space-time scan statistics have further been extended using bayesian methods as in the multivariate bayesian scan statistics  <cit> ; the bayesian-network-based spatial scan statistic  <cit> ; and the anomalous group detection methods  <cit> .

multivariate disease models may be considered to describe the space-time behaviour of diseases when the different datasets are correlated . the multivariate conditional autoregressive  model  <cit>  and the shared component model  <cit>  are the two main approaches to model disease risk correlations across both spatial units and diseases. however, spatial surveillance is only a special case of multivariate surveillance. comparatively speaking, non-spatial data aggregation methods have received little attention.

parallel monitoring of multivariate series
parallel monitoring is often used on time series of a similar syndrome originating from multiple data sources, assuming that all the time series are independent and ignoring the correlation and interaction structure among them. aberration detection algorithms are applied separately to each time series and an alert may be raised depending on how many statistics exceeds a limit and how the separate results are combined. the statistical challenge is to retain sensitivity while limiting the number of false alerts arising from multiple testing. multiplicity adjustments are necessary to control the overall type i error, by applying a bonferroni-type procedure  <cit>  for example. a variant of parallel monitoring consists in combining the p-values to produce a single p-value by applying edgington’s consensus method  <cit>  for multiple experiments, or fisher’s method of p-value aggregation  <cit> . other authors propose rules to combine alarms  <cit> ; the use of detection limits to generate an overall score representing the “severity” of any alarm  <cit> ; or an approach using bayes belief networks for combining univariate algorithm output  <cit> . yet a different approach,  <cit>  validated the use of multiple sources of routinely collected data in order to develop a weighting score system, the continuous cattle health monitor, which can be used to systematically  detect herds with poor cattle health, and direct surveillance efforts.

the main drawbacks of parallel monitoring are as follows: 
the different time series must be independent from one another, an assumption which is often violated with surveillance data. in our example, it would be fair to assume that the numbers of test requests received by the different diagnostic laboratories are not independent from one another.

no extra knowledge about the health situation in the population is be gained when considering multiple sources of evidence in parallel .

the rate of false positives increases with the number of time series monitored.




the problem of multiple testing over units has been addressed by  <cit> , as well as time by estimating the false discovery rate  for multiple units over a fixed surveillance period. as an alternative, a signalling procedure has been proposed by  <cit>  to control the fdr. spc critical thresholds depend on the data and thus change over time, “which can make the technique difficult to justify to a general audience”  <cit> .

even when spatial monitoring is not explicitly applied, the monitoring of multiple, parallel time-series can be used to deal with the availability of data over large spatial scales, with counts being grouped for specific regions. for example,  <cit>  used hierarchical time series statistics, which account for the hierarchical spatial structure when grouping observations into different geographical scales.  <cit> , on the other hand, monitored mortality rate in each of  <dig> hexagons, into which france had been divided, and identified, weekly, which hexagons presented excessive mortality compared to the expectation of a poisson regression model calibrated with historical data. they then applied special scan statistics to detect clusters of hexagons with high mortality.

dimension reduction
an alternative to monitoring a large number of univariate time series is to try and reduce the number of random variables considered. several approaches have been suggested to achieve a reduction of dimensionality. the sum or another linear combination of the variables, or principal components may be used instead of the original data variables  <cit> . spc methods are then applied to this single statistic  <cit> . the work presented in  <cit>  would be a recent example of dimension reduction method used in animal sys. in this example, assuming that the three sources of evidence were conditionally independent, the time series of nervous syndromes in horses, the time series of mortality in adult horses and the time series of the number of necropsied wild birds were added to provide evidence for or against the hypothesis of a west nile outbreak.

dimension reduction methods applied to surveillance suffer from several drawbacks: 1) by combining the information contained across all variables; we may lose some valuable health-related information contained in only one time series. for example, samples from an aborted cattle foetus sent to diagnostic laboratories may be tested for bovine viral diarrhea, infectious bovine rhinotracheitis, q-fever or brucellosis as all four diseases can cause abortions. it is possible to reduce the dimension of our surveillance by combining the counts from all four time series and applying spc methods. this aggregated time series would still allow us to detect early signs of an abnormal increase in the number of abortions which may signify a disease outbreak. however, the aggregated time series will not provide us with the information of which test request increase, the knowledge of which would impact the ensuing epidemiological investigation and potential containment measures. 2) the variables monitored may be recorded using different units and it may not be possible to find a common scale. 3) even when the variables are recorded on the same scale, they may exhibit different relationships to the underlying unobserved disease process. for example, daily counts of cattle births and cattle deaths should not be aggregated as most diseases would lead to a decrease of the former and an increase of the latter. 4) finally, the covariance matrix of the input data streams will highly depend on a recent estimate  <cit> . more sophisticated methods of dimension reduction, termed “sufficient reduction”, will not reduce the information but still allow a joint solution to the full surveillance problem. however, the sufficient reduction solution cannot be applied to all multiple data streams, some further discussion can be found in  <cit> .

vector accumulation
the accumulated information from each time series is used by a transformation of the vector of component-wise alarm statistics into a scalar alarm statistic  <cit> . multivariate spc methods  <cit> , such as mewma  <cit>   and mcusum  <cit>  fall into this category. they are based on the assumption that the data or their residuals follow the normal distribution although a rank-based method or non-parametric scheme are discussed in  <cit> . applications in the field of veterinary public health and surveillance can be found in  <cit> .

joint modelling methods
joint modelling of the original data without dimension deduction or stepwise procedures is preferable when possible. optimal methods can be constructed based on the full likelihood function of multiple series when known; although it can be complicated or require many assumptions. to counter this, a multivariate model has been developed by incorporating a branching process for count data in  <cit> . this model is capable of handling seasonal effects, time trends as well as spatio-temporal interactions . this model was further extended to analyse surveillance data of several pathogens  <cit> , and an application to animal health surveillance can be found in  <cit> . for a recent review and details on software see  <cit> .

RESULTS
number of postcodes sending test requests to two laboratories
laboratory test requests can be suitable for animal sys  <cit>  if laboratories collect and store the data in an automated and electronic way such as is done in switzerland. using data from the swiss federal food safety and veterinary office, we produced time series of the daily number of unique postcodes from which animal samples were sent to the largest two animal diagnostic laboratories  between  <dig> and  <dig>  only the data from weekdays were modelled . the historic sample identification notation system used did not allow us to establish a direct link between samples and individual cattle. a veterinarian may send  <dig> samples to a laboratory all originating from the same animal but being tested for  <dig> different pathogens. grouping the samples by postcode of origin allowed us to make such a link indirectly, although it is not possible to currently differentiate between samples coming from different individuals within the same herd or same municipality. the data were split into two parts: a training set  used for model learning and a validation set  for outbreak detection or prediction.

the improved farrington’s method  <cit>  was applied to these two time series , using the surveillance::farringtonflexible function  <cit>  in the r:surveillance package, to illustrate the application of parallel monitoring methods to the outbreak detection problem. the algorithm takes range values of the surveillance time series and for each time point uses a quasi-poisson regression with overdispersion to compute a reference distribution for the current number of cases under an outbreak-free scenario - see  <cit>  for details. a quantile, say the 99% quantile, of this reference distribution then served as threshold to determine if the actual observation is unusually high: if the observation is above the bound, then an alarm is raised. in order to control the overall type i error, we applied a bonferroni adjustment and defined the upper bound based on the  <dig> % percentile corresponding to a  <dig>  significance level for each time series, half of the significance level  <dig>  used in  <cit> . data from the same weekday  in the previous five weeks was included as historical data. an alarm was flagged  on days for which the observed count was higher than the upper prediction threshold . under these settings, two alarms were flagged for laboratory a and one alarm in laboratory b. noting that one of the two alarms for laboratory a was close in time to the alarm raised for laboratory b, we decided to investigate possible interdependencies between the two time series using a joint modelling approach.
fig.  <dig> outbreak detection. statistical alarms  raised by the improved farrington algorithm applied to the time series of test requests  for laboratories a and b in  <dig>  alarms are raised when the number of test requests on a given day exceeds the  <dig>  percentile 




to that effect, we applied the two-component model to the laboratory data to predict outbreaks as discussed in section “outbreak prediction”. the full likelihood was assumed to follow a negative binomial distribution conditional on previous data, and the two time series were assumed to be conditionally independent. we denoted by x
a,t and x
b,t the number of cases in laboratory a and b, respectively, in weekday t, conditional on the number of cases x
a,t− <dig> and x
b,t− <dig> one weekday earlier . the joint model was defined as 
  <dig> xa,t|xa,t− <dig> xb,t−1∼nbinxb,t|xa,t− <dig> xb,t−1∼nbin, 


where ψ
a or ψ
b were the overdispersion parameters. the means were modelled as 
  <dig> μa,t=νa,t+λaxa,t−1+ϕxb,t− <dig> 



  <dig> μb,t=νb,t+λbxb,t−1+ϕxa,t− <dig>  


where ν
a,t and ν
b,t were the endemic components, λ
a
x
a,t− <dig> and λ
b
x
b,t− <dig> were the epidemic components considered as autoregressive effects, and ϕ
x
a,t− <dig> and ϕ
x
b,t− <dig> referred to the neighbourhood component representing the interactive effects from the other laboratory. the endemic component ν
j,t was modelled by including the time trend, yearly fluctuation and a weekday effect  <cit> : 
  <dig> logνj,t=αj,tt+∑s=1s+γscos)+αj,monday+αj,tuesday+αj,wednesday+αj,thursday+αj,friday, 


where j=a or b and ω
s=2π
s/ <dig>  because there are  <dig> weekdays in one year. the data from the two laboratories shared the same seasonality, as modelled by a sine/cosine function. the neighbourhood effect parameter ϕ was assumed to be equal because we assumed the interactive effect was similar in both directions between laboratory a and b. in contrast to outbreak detection, model selection based on akaike information criterion  was possible, because it was based on the all historical data from  <dig> to  <dig>  the model with s= <dig> was selected with the smallest aic .

the effect of the different components in such a model can be quantified to further understand disease dynamics. parameter estimates from the model with s= <dig> are shown in table  <dig>  parameters in the upper part of the table were fixed at the same value for both laboratory a and b, while the laboratory specific parameters are shown in the lower part. the decomposition of the fitted values into the endemic , the epidemic/autoregressive  and the neighbourhood/interactive  components  are shown in fig. 2
a & b, while the observed numbers are plotted as dots. both time series exhibited a time trend: the number of unique locations requesting tests increased over time for laboratory a  but decreased over time for laboratory b . no evidence for an interaction was found . the parameters ψ for laboratory a and b were large compared to the predictive means from the models, indicating that there is no strong overdispersion in the data.
fig.  <dig> components of joint model. observed daily number of test requests  and fitted values from the joint two-components model applied to data from laboratories a  and b . the fitted values can be decomposed into three components: an endemic component , an epidemic/auto-regressive component  and a neighbourhood/interactive component . in this example, the interactive component is weak  and as such not clearly visible



ϕ

δ
1

γ
1

δ
2

γ
2

λ

α
t

α
monday

α
tuesday

α
wenesday

α
thursday

α
friday

ψ
parameters for laboratory b in the upper part are empty because they are the same as those for laboratory a: ϕ is the interactive parameter from the other laboratory; δ
 <dig> to γ
 <dig> are the parameters of sine and cosine function to adjust for the seasonal pattern. in the lower part of the table, parameters are different between laboratory a and b: λ is the auto-regressive parameter; α
t is the time trend; α
monday to α
friday refer to weekday effect and ψ is the overdispersion parameter




a model-based approach to outbreak prediction would now be based on the one-step-ahead probabilistic forecasts. good quality of the predictions is essential for the appropriateness on this approach. proper scoring rules are commonly used to evaluate the quality of probabilistic forecasts  <cit> . a scoring rule imposes a penalty on the difference between the observation and the point prediction, the smaller the value is, the better the forecast is. here the one-step-ahead predictions for the year  <dig> have been evaluated using three commonly used proper scoring rules: ls, dss and rps. generally it is very difficult to interpret the score value and the difference of the two scores. hence we apply calibration tests based on these scoring rules to investigate if there is evidence for miscalibration  <cit> . the p-values from the three calibration tests based on rps, ls and dss were large . the p-values did not show any evidence of the predictions from this model being poorly calibrated, thereby validating our choice of a model-based outbreak prediction approach.
t= <dig> and θ= <dig>  in . in fig.  <dig>  the predictive numbers were plotted as grey bars and the observed number as black dots, the probability that pr was plotted as a blue line. if pr> <dig> , an alarm is flagged. no alarms were raised in either time series. in practice, the threshold of probability applied in practice could be chosen based on expert opinion. increasing it will further decrease the false alarm rate, while decreasing it will increase the model’s sensitivity.
fig.  <dig> outbreak prediction. one-step ahead predictions  and the probability that more than three locations send test requests to a laboratory on a given day  are shown. a statistical alarm would be raised should that probability be over  <dig>  




joint modelling of time series with misalignment
an outbreak of disease in the population would produce signals in the time series at different times. in reality, the data time lag will often be different in different data sources. this is true for public health data but perhaps even more common in animal health surveillance data. a disease outbreak  is best conceived as a chain of events through time: we may first observe an increase in the number of animals presenting fever, followed a few weeks later by an increase in the number of abortions reported, and even later an increase in the number of carcasses condemned at slaughter. the optimal surveillance method may depend on both the dependency between the monitored processes and the correlation between the time points when the changes occur  <cit> . for example, parallel surveillance works well when the changes occur far apart but a dimension reduction approach  <cit>  is optimal when the changes occur very close in time to one another. for intermediate, but known, time-lags, an approach combining reduction by time and reduction by variable should be explored  <cit> . this “time alignment issue”, discussed in  <cit> , poses a real problem as such delays are hard to quantify and will vary depending on the disease and/or the population. the first step would be to explore the lagged correlations among the time series. lagged correlation between time series can be estimated in the absence of outbreaks by making some assumptions  <cit> . but it may not be representative of true correlation in the presence of disease.

let’s illustrate with an example from animal health surveillance. because of processing and transporting delays, it is reasonable to expect that the number of samples  sent to official diagnostic laboratories will increase later than the number of abortions recorded on farms. the research question of interest is to quantify how large such time lag is. we extracted the daily number of cattle abortions from the swiss system for the identification and registration of cattle  <cit>  and the daily number of test requests for bovine viral diarrhea  sent to all official diagnostic laboratories between  <dig> and  <dig>  the joint model was applied in order to determine the time misalignment between the two series denoted as x
abor,t for the number of abortions and x
test,t for the number of test requests. similar to the method in section“number of postcodes sending test requests to two laboratories”, x
abor,t and x
test,t followed negative binomial distributions nbin and nbin respectively conditional on the previous data with 
  <dig> μabor,t=λaborxabor,t−1+ϕaborxtest,t−r+νabor,t,μtest,t=λtestxtest,t−1+ϕtestxabor,t−r+νtest,t. 


neighbourhood effects allowed the interactive effects to be different with different lags r in both directions : ϕ
abor from the number of tests to the number of abortions and ϕ
test from the number of abortions to the number of tests. in this method we can include the interactive effect with lags r= <dig> ,…, <dig> and the lags included are set as the same for the two series for the sake of simplicity. the data from  <dig> and  <dig> were retained as a learning dataset while the data from  <dig> were used as a validation dataset.

as in section “number of postcodes sending test requests to two laboratories”, the weekday effect and seasonality were included in the endemic component, for each time series j=test or abor, 
  <dig> logνj,t=∑s=1s+γj,scos)+αmonday,j+αtuesday,j+αwednesday,j+αthursday,j+αfriday,j, 


and where ω
s=2π
s/ <dig> . the best model retained the weekday effect and a seasonal effect with s= <dig> but no time trend . table  <dig> shows the estimated neighbourhood effects ϕ and their standard error. as expected, we did not find any evidence of an effect of the number of test requests on the number of abortions, since all estimates of ϕ
abor were close to zero. however, there was some evidence for an effect of the number of abortions two days earlier  on the number of test requests with estimate ϕ
test= <dig>  and 95% confidence interval . in addition, the model with r= <dig> fitted the data best according to aic. we further compared this result with the univariate modelling of the number of test requests which included the same model as in  but without the neighbourhood effect. the fitting results from the two models are shown in fig. 4
a & b. the proper scoring rules for the one-step-ahead predictions from the two models are shown in table  <dig>  the rps and ls scores of the joint model were slightly smaller than those from the model without the number of abortions, indicating that the joint model is better. however, the differences in score values were not big and the mean dss scores, rounded to two decimal places, were in fact the same. that is because the univariate model  accommodates larger forecast variances, making the average scores similar to the ones from the joint model . the overdispersion parameter in the joint model was larger, indicating that the predictions from the joint model are more precise than the ones from the univariate model. however, the p-values from calibration tests based on ls and dss were fairly small for both models and suggested that the predictions are not well calibrated.
fig.  <dig> joint modelling of time series with misalignment. fitted values, and their decomposition into endemic , epidemic  and interactive  components, from the joint model applied to the time series of the daily number of test requests for bvd with  and without  the lagged daily number of cattle abortions are shown


ϕ
ϕ









discussion
defining the population under surveillance in animal sys systems is often more complex than for public health surveillance. such systems have to accommodate diverse species, production types within species , different entities of interest  and different professionals interacting with the population. in animal health, most early-warning systems are based on continuous collection and analysis of clinical and treatment data from various sources such as farmers themselves, veterinary practitioners, animal health services, specialised clinics, university hospitals, pharmaceutical companies and breeding organisations. for example, sikava is the finnish electronic pig register used for national pig health monitoring. finnish pig farmers submit the numbers of animals and mortality rates, as well as drug use information, to sikava’s medical records. breeding farms have additional requirements for disease testings  <cit> . in switzerland, no such centralised clinical and treatment recording system exist, i.e. such a system would need to be developed, at great costs before it could be used in sys. as budget restrictions continuously force national veterinary services to seek reductions in the unit cost of assessing animals and animal clusters  <cit> , alternative data sources are being explored for use in sys. in switzerland, these include the national systems for the identification and registration of cattle  <cit>  and meat inspection data from slaughterhouses  <cit> . animal sys in switzerland faces similar statistical issues to health care surveillance systems. a common theme is the variety of types of data: there may be standardised  ratios, proportions, counts of adverse events, categorical data and even qualitative ‘intelligence’ that may need to be aggregated up a hierarchy. yet, as in healthcare surveillance, we experience “a demand for methods that are straightforward to implement, can be explained to multiple stakeholders and are robust to potentially mediocre quality data”  <cit> . many research questions still present themselves. here we consider four commonly encountered multivariate data scenarios that we believe are of importance but to which the multivariate outbreak detection or prediction methods presented above may not always be applicable.

different temporal granularity scenario
the time series have the same data type  but different temporal resolution . as animal sys is based on a variety of indirect health indicators collected by a variety of stakeholders for purposes, often, other than surveillance, the different indicators to integrate in a multivariate sys system may exhibit different temporal and spatial resolution. for example, in switzerland, data on cattle births are recorded on a daily basis, while post-mortem meat inspection data are only available on a monthly basis. aggregating all data sources to the largest resolution present  would make possible the use of the various multivariate methods described above but would reduce the timeliness of the system. time series clustering methods may be applicable on series which exhibit a small difference in temporal resolution. they take into account time series trends during periods of interest and then performs a clustering analysis in order to highlight relationship among the different data and their trends. a novel approach has been developed by  <cit>  for multivariate time series clustering using dynamic time series segmentation and self organizing maps techniques, and applied to geophysical data  recorded from monitoring networks at mt. etna.

different spatial granularity scenario
the time series have the same data type  but different spatial resolution . there is a large spectrum of scale and units at which animal sys data are recorded. an individual animal  may be the unit of surveillance. the animal unit is a window unto the collective health status of its herd or flock. in some data sources, only a subset of animals may have been sampled  or the data from several animals may be pooled together . surveillance data may also originate from an enterprise  or only be available at the regional or national level. one option is to aggregate all spatial data to a common denominator  and to look for space-time clusters using a multivariate spatial scan statistic method as in  <cit> .

different data types scenario
the time series have the same time resolution  but different data types . in the easiest surveillance scenarios, it may be possible to transform the count data streams into proportions or rates and apply the various multivariate methods described in section “methods”. data standardization and aggregation based on z-scores is also discussed in  <cit> . another alternative would consist in performing univariate modelling of all the data streams and setting rules of thumbs regarding the interpretation of the statistical alarms . however, complex modelling approaches based on bayesian methodologies, such as the ones developed by  <cit> , which are much more apt to discover the interplay among multiple and disparate syndromic data sources, will play a big part in the future of ahsys in which ever more integrative information systems are put in place for disease surveillance across domains .

reporting delay and nowcasting
health system users and decision makers depend on timeliness to take appropriate action based on the urgency and the type of responses required by the situation. however, such system is inherently “contaminated” by the reporting delay between the occurrence of the event, for example, time of symptom onset or visit by the veterinarian, and the time the report becomes available in the surveillance database. ideally, surveillance systems should be able to deal with the occurred-but-not-reported-events problem  <cit> . delay-adjusting tracking procedures, also called nowcasts, are developing in the public health setting  <cit> . nowcasting methods are not limited to univariate surveillance scenarios. the bayesian hierarchical models commonly used for forecasting  <cit>  offer a very suitable framework for multivariate surveillance.

CONCLUSIONS
the answer to the question “which multivariate surveillance method is the best?” is the same as the answer to the question “which univariate surveillance method is the best?”: different methods are suitable for different problems. the choice of which univariate method to apply will be based on the characteristics of the time series, the length of historic data available and the type of outbreak the sys system must detect . the choice of which multivariate method to apply will be based, additionally, on whether all data are of the same type and granularity as well as on our knowledge of the dependency between the monitored processes and the correlation between the time points when the changes occur . some diseases may lead to near-simultaneous increases in two or more syndrome monitored, in which case a reduction of dimensionality to a univariate surveillance problem is appropriate. on the other hand, if the syndromes monitored are expected to “respond” independently to the introduction of a pathogen in a population, parallel monitoring and joint modelling may yield more satisfactory results. we favour the latter. the model assumes that syndrome counts can be viewed as the sum of an endemic and an epidemic component. the proportion of the epidemic component λ
t is allowed to vary over time according to a bayesian multiple change point model, allowing the user to model time with occasional outbreaks or other non-stationary features   <cit> . the stochastic modelling approach also offers more interesting possibilities of being extended to address realistic surveillance scenarios. for example, the inclusion of times series specific parameters, such as overdispersion ψ or seasonality when applied to multivariate time series  <cit> . it becomes also possible to relate the endemic incidence μ or the epidemic parameter λ to “ecological” covariates  <cit>  known to have an impact on syndrome counts . a spatial extension of the model would relate the endemic incidence ν
t or the epidemic parameter λ to area-level covariates , or would be well suited to capture space-time dependence caused by the spatial spread of a disease over time  <cit> . setting up operational multivariate sys systems whether based on traditional outbreak detection algorithms or on more complex models, requires decision making about:  which combinations of data sources to test,  how to achieve sensitivity over many data streams while retaining manageable false alert rate frequency , and  how much corroboration among data streams is required to achieve a threshold for escalating the information into an alert that should require investigation  <cit> . the first point is related to the more general issue of the epidemiological evaluation of data sources used for health surveillance . one important consideration is how well the data collected match the required surveillance coverage in terms of populations, production types and geographic regions. another consideration is timeliness. this is particularly important for sys systems whose objectives is the early-detection of unexpected health events. not only should data be collected in near-real time on the unit of interest , they should also be reported to a central database in real-time for data aggregation and analysis or they will have little value for early disease detection. evaluation for animal health surveillance systems and data exist  <cit>  and should be used to quantify the usefulness of health and production recodring systems at the national level . it is important to recognise that timeliness should not be treated as the be all and end all of sys. a fully electronic system built around a centralised database is still of limited value if the system is not reliable  or accurate   <cit>  . finally, point  <dig> is not trivial given that the understanding of the relationships between different data streams can be poor when data are sparse and the events under consideration  occur infrequently.

the key difficulty in dealing with a multivariate system in which time misalignment occurs  resides in measuring the relationship between data sources when an outbreak occurs. for this, we need datasets with clearly identified and delimited  health events. while such data may be more easily available or derived for large well-defined seasonal outbreaks, the use of a small number of variables to define the occurrence of an outbreak may constitute a limited indicator and result in smaller outbreaks being missed  <cit> . alternatively, expert judgement may be used retrospectively to determine the occurrence of events of public health importance, often using resource-intensive epidemiological investigation techniques.

going back to the applications of the joint model to data on laboratory test requests in section “number of postcodes sending test requests to two laboratories”, we note that the farrington method has flagged three alarms in the two time series considered. in general, several definitions of what constitutes a statistical alarm are possible for multivariate outbreak detection. we could combine model/algorithm output from each series  in a manner akin to  <cit> . the combination process could follow a majority rule , or a m+n rule . alternatively, an overall alarm may be triggered if the joint probability of an outbreak across all series is higher than a fixed threshold. being able to identify why an alarm was raised by a multivariate surveillance system is essential to guide the subsequent epidemiological investigation. the first step in investigating an alarm is confirmation of the signal through the examination of individual cases that triggered the alarm to obtain geographic  data  <cit> . this step may be complicated for multivariate systems in which data streams were aggregated either spatially or temporally because of differences in their resolution. then if the signal is determined to not be a consequence of duplication of individual case data or data entry error, the specificity of the signal needs to be increased by requesting additional testing to rule specific diseases in or out or by querying specialists about specific conditions relating to the excess cases for example. this second step highlights the importance of, and difficulty in, extracting the right sort of knowledge from multivariate health data to focus the health services resources after a statistical alarm is raised. one advantage of multivariate parallel surveillance is that the interpretation of alarms is clear. other methods, like hotelling t
 <dig> control chart, are not capable of distinguishing a change in the mean vector from a change in the covariance structure for example  <cit> .

we conclude that many methodological challenges to multivariate animal health sys still remain. some of these challenges may require a change in the legislation to be surmounted. for example, the ubiquitous lack of commonly adopted data standards, make difficult data integration across heterogeneous datasets and/or geographical regions and may only be overcome through an official act defining such standards. other challenges may only be overcome after the sys system has been operational for some time and lessons are learned by trial and error. for example, deciding on the amount of corroboration among data streams that is required to escalate a statistical alert into an epidemiological alert is a difficult decision to take a priori given the sparse data on the events under consideration . while some of the desired improvements in multivariate surveillance data collection may take some time to implement, animal health sys experts are encouraged to already look into stochastic modelling-based approaches to outbreak detection which address more realistic surveillance scenarios than traditional methods such as spc and offer more flexibility. methods such as the two-component model allow for the retention of historical outbreaks; for overdispersion; for non-stationarity; for the inclusion of times series specific parameters, or of covariates known to have an impact on syndrome counts; and for the possibility to base the alarm system on the one-step-ahead predictive distribution rather than comparing the observed number with a predefined threshold, potentially expediting the detection of events of veterinary public health interest and the implementation of containment measures.

abbreviations
aicakaike information criterion

bicbayesian information criterion

bvdbovine viral diarrhea

cusumcumulative sums

dssdawid-sebastiani score

ewmeaexponentially weighted moving averages

fdrfalse discovery rate

lslogarithmic score

mcarmultivariate conditional autoregressive

mcusummultivariate cumulative sums

mewmeamultivariate exponentially weighted moving averages

mspcmultivariate statistical process control

rpsrank probability score

syssyndromic surveillance

spcstatistical process control

