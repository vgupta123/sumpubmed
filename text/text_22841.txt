BACKGROUND
developing thermostable proteins has been a main focus of protein engineering because of its theoretical and practical significance  <cit> . recently, computational protein design methods have been attracted much attention due to their potential cost and time savings over conventional directed evolution approaches  <cit> . these types of approaches utilize information extracted from protein sequences and/or 3d structures to predict favorable mutations that may enhance protein thermostability. clearly, a key step in such approaches is the development of reliable methods for estimating the relative stability of possible mutants to identify favorable mutations. such methods may also help better understand the protein-folding problem since the ultimate outcome of protein folding is a native structure with the lowest free energy among many possible structures of a protein.

a common approach to study the thermostability of proteins is to perform comparative studies of the sequences and/or structures of thermophilic proteins  and their mesophilic counterparts   <cit>  because there exists a direct positive correlation between the optimal growth temperature  of an organism and the melting temperature of its proteins, a key metric of protein thermostability  <cit> . numerous studies have focused on amino acid composition changes caused by thermal adaptation at the whole genome level  <cit> . for example, zeldovich et al. discovered that the total concentration of seven amino acids  in the proteins of an organism has a strong correlation with its ogt  <cit> . overall, the proteins of thermophiles contain more charged and hydrophobic amino acid residues at the expense of polar ones  <cit> . the observed composition differences have prompted the development of predictive models discriminating hps and mps  <cit> . for example, gromiha and suresh applied  <dig> different classification algorithms and the best accuracy achieved reached 89%  <cit> .

several amino acid substitution preference matrices have been created based on the sequence alignments of thermophilic proteins and their mesophilic homologues  <cit> . analyzing these matrices and comparing sequences and structures of hps and mps have revealed a number of substitution trends potentially affecting thermostability  <cit> . notable features include: an increased level of charged residues in hyperthermophilic proteins at the cost of polar residues on surface compared to their mesophilic homologs  <cit> ; elevated levels of proline or β-branched amino acids in loops to reduce the freedom of coil regions  <cit> ; a reduced number of residues in coil regions but increases in helix runs  <cit> ; increased numbers of the high helix-propensity residues such as lys and glu, etc.  <cit> ; an increased compactness of hydrophobic cores resulted in enhanced apolar interactions and interior packing  <cit> ; and reduced deamidation probability by replacing gln with glu and asn with asp  <cit> .

the goal of this study was to develop a scoring function for predicting relative thermostability of protein and their mutants using an integrated statistical and machine learning approach. we used hp/mp orthologs as research subjects because they are equivalent to mutants with multiple substitutions and, as discussed above, the difference between them may encode thermal-adaptation mechanisms. thus a scoring function which can distinguish hp/mp orthologs is presumably able to rank the relative stability of a protein and its mutants, a key step for designing more thermostable proteins.

in this study, we first constructed a set of  <dig> non-redundant hyperthermophilic-mesophilic protein ortholog pairs. since our dataset is significantly bigger than previous studies, we then calculated a substitution preference matrix using an established approach  <cit> . we used a feature selection procedure based on the random forest algorithm to identify sequence-based features important to pairwise discrimination of hyperthermophilic and mesophilic protein orthologs. we then used a hill-climbing algorithm to fit a scoring function based on a linear combination of these important discriminating features. finally, we applied the scoring function to two experimental datasets to demonstrate that this scoring function can indeed be used to rank thermostability of protein mutants with high accuracy.

methods
datasets
we downloaded all protein sequences of nine organisms, including four hyperthermophilic and five mesophilic organisms  from the ncbi http://www.ncbi.nlm.nih.gov/. to identify hp-mp ortholog pairs, we performed blast searches for all mp sequences against all hp sequences  <cit> . the following conservative criteria were used to identify putative orthologs:

• reciprocal best blast hits with the e-values in blast searches less than 10-10;

• the difference in the number of residues is less than 5% of the shorter sequence so that only small insertions/deletions were allowed;

• higher than 30% amino acid sequence identity.

in addition, we removed transmembrane proteins, predicted by tmhmm  <dig>  http://www.cbs.dtu.dk/services/tmhmm/, because they often use different strategies from soluble proteins to survive under high temperature environments  <cit> . furthermore, to reduce the statistical bias caused by redundancy, we clustered paralogues using the blastclust program available in the blast package  <cit> . the minimum length coverage of blastclust was set to  <dig>  and the sequence similarity threshold was set to  <dig> . sequences longer than  <dig> or shorter than  <dig> residues were also removed. the final dataset consists of  <dig> non-redundant hp-mp ortholog pairs. pfam http://pfam.sanger.ac.uk/ domain scans of these proteins confirmed, as expected, that the two proteins of each ortholog pair contain the same domains. thus the selected pairs are very likely true orthologs.

we also used a set of  <dig> structurally well-aligned protein pairs from thermophilic and mesophilic organisms compiled by glyakina et al. for testing purpose  <cit> . the dataset includes  <dig> hyperthermophilic and  <dig> thermophilic proteins.

amino acid substitution matrix
the amino acid residue substitution matrix was constructed following an established procedure  <cit> . in brief, we counted each of the  <dig> types of amino acid residue substitutions in the blast sequence alignments of all mp/hp pairs. substitutions in converting mps to hps are considered as the "forward" direction. two-tail binomial statistics were used to estimate the statistical significance of the asymmetry of the forward and reverse substitutions of any given pair of amino acids  <cit> .

two sets of experimentally investigated protein mutations
in addition to the protein pairs mentioned before, we used two independent datasets for additional testing. the first set contains two wild-type adenylate kinases  from methanococcus voltae and methanococcus jannaschii, and a series of chimeric proteins generated from these two enzymes  <cit> . these proteins share significant sequence identity but differ in their thermostability . the second dataset was collected by montanucci and colleagues  <cit> . it contains  <dig> wild type proteins and  <dig> mutants manifesting thermal stability changes . all protein sequences in these two tests were subjected to blast searches against all sequences in the  <dig> ortholog pairs. only one protein, bscsp , showed greater than 25% similarity to one of the protein sequences in the  <dig> pairs. thus, these proteins can be used as independent testing datasets.

comm_meso and comm_hyp are the counts of the identical residues in the mp sequence mvo and the hp sequence mja, respectively. the last column is the relative stability ranked by our scoring function .

the data were originally collected by montanucci et al.  <cit> . the sequence of cbadh was retrieved from the original literature by goihberg et al. <cit> .

features
a set of  <dig> features derived from protein sequences was calculated using various software programs or in-house scripts . these features can be roughly classified into two groups. the features in the first group, denoted as ck, are the absolute counts of amino acid residues or other properties. the features in the second group, labeled as xk, are the chain length normalized values of the features in the first group. although including structure-based features may be of great help in understanding the mechanisms of mutagenesis induced protein stabilization, the vast majority of proteins lack solved structures. therefore we only investigated the contributions from sequence-based features in this work. furthermore, the theory that the sequence of a protein determines its structure suggests that the knowledge extracted from the sequence may be sufficient to distinguish proteins with different thermostability. besides the general information extracted from the sequence, we also included several predicted features which were obtained by mature and widely-used algorithms, such as those used to predict secondary structure  <cit>  and exposed/buried residues  <cit>  .

**obtained from the merck index, merck & co., inc., whitehouse station, nj  <dig> .

random forest
the random forest algorithm is an ensemble technique that utilizes the results of hundreds or even thousands of decision trees to perform classification or regression  <cit> . each of the member trees is built on a bootstrap sample from the training data and utilizes a random subset of available variables. the algorithm has been applied in broad classification tasks and has frequently demonstrated superior performance compared to other classification algorithms  <cit> . it is robust and particularly suitable for classifying high-dimensional and noisy data. one very useful feature of the algorithm is that it offers several methods to assess the importance of various features based on their contributions to the correctness of the resulting classification  <cit> . in this study, we used the gini importance to rank the importance of all used features. the gini importance is the summation of the gini impurity decreases in node splits made on the feature over all trees in the model. the gini impurity is a common metric to measure the degree of impurity  <cit> . it is defined as:   

where k =  are possible classes and pk is the relative frequency of class k in a node a. therefore i equals to zero when all cases in the node belong to a single class and reaches its maximum when cases are equally distributed to all classes.

we used a random forest package implemented in the r environment for this study http://cran.r-project.org/web/packages/randomforest/index.html. random forest models are usually insensitive to the model parameters  <cit> . consequently the default parameters were used in the study.

RESULTS
in this section, we first report a mp/hp residue substitution preference matrix generated from the blast pairwise alignments of mp and hp orthologs. feature selection using the random forest algorithm is then described, followed by the scoring function construction. the performance of the scoring function in discriminating hyperthermophilic and mesophilic proteins was estimated with a set of holdout testing dataset. finally, the application of the scoring function in predicting relative stability of proteins and their mutants is presented.

amino acid composition
the overall differences in amino acid composition between hps and mps are consistent with previous reports   <cit> . based on the p-values from unpaired and paired t-test, the most significantly increased residues in hps include lys, glu, tyr, and ile, while reduced residues include gln, his, ala, and thr.

the  <dig> hps consist of  <dig> bacteria and  <dig> archaea proteins while all mps are from bacteria. in order to rule out the possibility that the different domains cause bias toward residue composition and the final results, we calculated the correlation coefficients of the amino acid compositions between hps from archaea and mps, hps from bacteria and mps, and hps from bacteria and hps from archaea. the r values of the correlations are  <dig> ,  <dig> , and  <dig> , respectively . therefore, the composition difference possibly attributed to bacteria vs. archaea domains isn't as significant as the contributions by thermal adaptation.

amino acid residue substitutions
all  <dig> residue substitutions are reported in figure  <dig>  we also calculated the ratio of each substitution to the opposite replacement. substitutions with statistically significant bias  are shown in bold. red cells are substitutions favored in the mp to hp direction while blues are favored in the opposite direction. there are  <dig>  significantly biased substitutions and  <dig> of them are in the direction from mp to hp. the overall trends of the substitution preferences are consistent with previous studies  <cit> . for example, charged residues, especially lys and glu, gain significantly in hps at the cost of uncharged polar residues such as ser, gln, and tyr.

many of the significant substitution asymmetries are consistent with various proposed protein thermo stability mechanisms. for example, asp is preferred to be substituted by glu or lys in the direction from mp to hp, both are helix favored while asp is coil favored. this is consistent with previous findings that in general hps contain more helical regions at the cost of disordered regions than mps  <cit> . there is a strong preference for ser, thr, asn and gln to be substituted by lys and glu in hps, which can be explained by the observed significant reduction of polar non-charged residues  <cit>  and deamidation vulnerable residues  <cit>  in hps. leu is preferred to be substituted by ile to enhance thermo stability. this is consistent with the finding that increasing β-branched amino acids in loop regions enhance protein thermostability  <cit> .

it is worth mentioning that the significance threshold  used in this study was significantly more stringent than the criteria used in previous studies  because we used approximately five times as many hp/mp pairs as previous studies. the ratios of forward-to-reverse changes for these substitutions were also calculated based on more examples than in previous studies. for example, the matrix reported by haney et al. contained  <dig> residue replacements with no or only single instances  <cit> . in our matrix, the minimum number is  <dig> and there are only  <dig> substitutions with less than  <dig> examples. therefore the ratios in this matrix may better reflect thermal adaptation induced substitution biases and should be useful in designing thermostable proteins.

ranking features using a random forest algorithm
the analysis of the residue substitution preference between mps and hps clearly indicates that different residues contribute to protein thermostability differentially. in this section, we describe a procedure for ranking the importance of all  <dig> features derived from protein sequences in discriminating mps and hps using the random forest algorithm.

a standard five-fold cross validation procedure was used to determine the importance of features and develop the scoring function. we randomly split the  <dig> pairs into five equal portions. we used four portions as training datasets and reserved the remaining portion for testing purposes. we then constructed a random forest model with  <dig> trees for discriminating these  <dig> ortholog protein pairs in the training set and then used the gini importance to rank these features. the procedure was repeated four more times and each time a different portion was used as the testing dataset. we found that the results from all five runs were very consistent. all features were ranked by their average importance and top  <dig> are shown in figure  <dig>  the levels of glutamine and lysine are most important among the  <dig> features used in this study, followed by the percentage of positively charged residues. we also noticed that the features normalized by sequence length are consistently more important than the corresponding absolute counts. thus, we only used the normalized features in the scoring function. interestingly, all predicted features, such as secondary structure, the ratio of exposed to buried residues, and the disordered region predictions, failed to appear in the  <dig> most important features.

developing the scoring function
we first calculated the relative feature difference Δxi, which is defined as:   

where xi and xi are the values of the ith feature from the first sequence and the second sequence, respectively. we plotted the cumulative curves of the relative feature difference Δxi of the ten most significant normalized features in the training dataset . in this plot, all cumulative curves show typical sigmoid shapes in which the inflexion points are located in the curve at the half height, i.e., the cumulative counts are equal to half of the total counts.

we constructed the scoring function by a linear combination of the ten most important features. the scoring function can be written as:   

where i runs over all  <dig> features are used in the scoring function and wi is the weight for each feature. the sign of the weight of each feature was determined by the location of the inflexion point of its cumulative curve: positive for features located to the left and negative for those to the right of the zero-difference line. thus the signs of x_k, x_e, x_pos, x_charge, and asa are positive, and negative for x_small, x_tiny, x_a, x_q and x_t. we then used a hill-climbing algorithm to fit the weights of these features. the absolute values of all weights were restricted to the range of  <dig> to  <dig>  we randomly assigned an initial weight to each feature and counted the number of correctly ranked ortholog pairs. the weights were then randomly updated and the number of correct ranks was recounted. the new weights were kept if they resulted in more correctly ranked ortholog pairs; otherwise the weights were rolled back to the previous values. this procedure was repeated  <dig> ×  <dig> times and the batch of weights which maximized the number of positive score values was recorded. to check whether the optimization procedure was trapped in a local maximum, we repeated the procedure four more times using different random seeds. the results were very similar and thus we simply used the average of the weights in the scoring function. we then used the same procedure to develop four more scoring functions, each for one of remaining training datasets.

the discrimination ability of the scoring function
we calculated the accuracies of the discriminations made by the five scoring functions on their corresponding training datasets. the scoring functions using optimized weights were able to distinguish in average  <dig>  ±  <dig>  out of  <dig>  ortholog protein pairs in the training datasets. we then tested each of the scoring functions with its corresponding holdout testing dataset. out of  <dig> protein pairs in the testing sets, on average  <dig>  ±  <dig>  pairs were correctly ranked . this was very close to the accuracy obtained from the training sets . thus the scoring function is robust and able to discriminate a broad spectrum of hp and mp homologous protein pairs.

the average weights for each feature determined in all five training procedures are quite consistent. thus we simply use the averages of these weights in the final scoring function . it is noteworthy that while the signs of the weights indicate whether the features are favorable or not in hyperthermophilic proteins, their absolute values are not significant since the features are not normalized to a common scale.

we also applied the scoring function to discriminating thermophilic and mesophilic proteins in the glyakina dataset  <cit> . our scoring function was able to correctly discriminate not only  <dig> hp/mp pairs , but also  <dig> thermophilic and mesophilic pairs . the list of these proteins and their scores are provided in table s <dig> in the additional file  <dig>  we believe that the difference of the accuracy between hyperthermophilic and thermophilic proteins was caused by the different stabilization mechanisms of hyperthermophilic and thermophilic proteins, as previously suggested in literature  <cit> .

discriminating non-homologous protein pairs
encouraged by the results in the above test, we further challenged the scoring function in discriminating non-homologous hp/mp protein pairs. in this test, we compared each hp protein sequence against all mp sequences. the overall accuracy of these 540* <dig> pairwise comparisons was  <dig> %. such a high accuracy in discriminating non-homologous hp and mp sequences confirms that hp sequences share some common sequential patterns to generate sufficient stability at elevated temperature.

application in ranking the thermostability of proteins and their mutants
the first test was carried out on two wild-type adks and a series of chimeric enzymes generated from these two enzymes  <cit> . the predicted ranking of thermo-stability using the scoring function is highly consistent with the experimental results . in all  <dig> () pairwise comparisons, only two resulted in incorrect predictions . moreover, the two inaccurate predictions included one between vjv and jvj in which the tm differed by only  <dig> °c, and the other between v160j and j36v in which the tm differed by just 1°c, probably not an experimentally detectable difference.

in the second test, we used a batch of sequences collected by montanucci, et al  <cit> . the sequence lengths, the gi numbers of the wild-type proteins, and their melting temperatures are listed in table  <dig>  we used the scoring function to rank the relative thermostability of wild-type proteins and their mutants. in the case of proteins with two mutants, the relative stability of these mutants was also predicted. overall there were  <dig> pairwise comparisons between these wild proteins and their mutants. the scoring function achieved an accuracy of  <dig> % . the wrong prediction was for protein pdao and its mutant . it is a single mutation  and the difference in tm is moderate .

overall, the scoring function has consistently demonstrated a remarkable ability to rank the relative thermostability of proteins and their mutants. thus a website http://www.abl.ku.edu/thermorank/ was created and made freely available to the general public.

comparison with other methods
the current study differs at the level of information granules from previous work focused amino acid composition differences between thermophilic and mesophilic organisms  <cit> . we focused on the differences between hp and mp ortholog pairs instead of on the differences between thermophilic or mesophilic proteins at the genome level. the difference between these two approaches is similar to the one between unpaired and paired two-sample t-tests. while previous studies have succeeded in revealing the overall changes caused by thermal adaptation at the genome level, our study has further focused on the protein level. such an approach may reduce or eliminate the effects of confounding factors such as protein families because it is well established that the amino acid composition may vary in different protein classes  <cit> . in addition, a protein level study may be more relevant to designing stable proteins because orthologs are essentially mutants with multiple mutations.

to compare the performance of our algorithm to other approaches is difficult because very few algorithms have been developed to rank the relative thermostability of hp/mp orthologous pairs and these studies have used different datasets  <cit> . targetstar, a scoring function based on the analysis of  <dig> decoy structures for a given protein, can discriminate hp/mp orthologs pairs with 77% accuracy  <cit> . recently, montanucci and colleagues reported a svm model which achieves 88% accuracy on a set of redundancy-reduced hp/mp pairs  <cit> . the svm model used residue and dipeptide compositions as predictive features. thus, the  <dig> % predictive accuracy on the test dataset of our scoring function is considerably higher than the reported accuracies of both previous methods. moreover, in the application of predicting the relative thermostability of proteins and their mutants, our approach achieved an accuracy of  <dig> %  in the second blind test set, which represents one more correct prediction than montanucci et al. on the same dataset  <cit> .

CONCLUSIONS
we have presented a novel scoring function which can distinguish not only hp/mp ortholog pairs, but also non-homologous pairs at high accuracies. most importantly, it can be used to accurately predict the relative stability of proteins and their mutants, as demonstrated in two blind tests. in addition, the residue substitution preference matrix assembled in this study may better reflect the thermal adaptation induced substitution biases than previous studies because a larger dataset was used. the large set of hp/mp is available in the supplementary website and should be useful to other researchers for further development of novel algorithms in this area.

abbreviations
hp: hyperthermophilic protein; mp: mesophilic protein; ogt: optimal growth temperature; tm: melting temperature.

authors' contributions
jwf conceived the project. yl and jwf carried out the study with input from crm. yl, crm and jwf drafted the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file 1
supplementary table s <dig>  s <dig>  and figure s <dig>  this file contains the following contents:  <dig>  table s <dig>  detailed description of the  <dig> features used to construct the scoring function.  <dig>  table s <dig>  a test of the discriminative ability for the scoring function on a dataset containing  <dig> hyperthermophilic-mesophilic protein pairs and  <dig> thermophilic-mesophilic protein pairs.  <dig>  figure s <dig>  the roc curve of the scoring function in discrimination of  <dig> pairs of ortholog protein sequences accumulated from the 5-fold cross testing set.

click here for file

 acknowledgements
we thank drs. robert hanzlik and yang zhang of the university of kansas for their valuable scientific input. we also wish to thank dr. montanucci ludovica for her kindly sharing the test sequences.

funding: this work was partially supported by nih grants p <dig> ag <dig> .
