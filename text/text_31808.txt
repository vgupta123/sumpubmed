BACKGROUND
microarray technology allows the analysis of expression levels for thousands of genes simultaneously and is a powerful tool to characterize mrna level variation due to measured variables of interest . typical approaches to find significant relationships between gene expressions and experimental conditions ignore the correlations among expression profiles and functional categories  <cit> . this dependence structure leads to correlation among test statistics which affects a strong control of the actual proportion of false discoveries  <cit> . indeed, a number of unmeasured or unmodeled factors independent of the variables of interest may influence the expression of any particular gene  <cit> . these factors may induce extra variability in the expression levels and decrease the power to detect links with the variables of interest.

recently, several works have introduced models for the common information shared by all the genes. especially friguet et al  <cit>  propose to model this sharing of information by a factor analysis structure in a method called factor analysis for multiple testing . the estimated factors in the model capture components of the expression heterogeneity. as well, storey et al  <cit>  introduce surrogate variable analysis  to identify and estimate these extra sources of variation. the factors in famt and the surrogate variables in sva are similarly designed to model dependence among tests by a linear kernel but they are estimated differently. contrarily to the sva model, independence between the factors and the experimental conditions of interest is explicitly assumed in famt in order to separate clearly the effects of the experimental conditions on the gene expressions and the nuisance variability due to unmodeled technological effects and other known or unknown effects that could be uncontrolled in the experimental design.

the major sources of expression variation are then assumed to be the experimental conditions of interest, but also gene dependence and uncontrolled factors in the experimental design. indeed, even after normalization, variation due to the experimental design still exists in expression data. the factors extracted in the residual part of the regression models explaining the gene expressions by the experimental conditions of interest are therefore analyzed to give more insight both on expression heterogeneity among sampling units and the contribution of some biological processes to gene dependence. first, factors are extracted from illustrative expression data sets with simple patterns of expression heterogeneity in order to show how they can straightforward be related to sources of heterogeneity. henceforth, the same factor model approach is used to analyze an expression data set initially generated to map quantitative trait loci  for abdominal fatness  in chickens, especially on chromosome  <dig>   <cit> . this data set concerns hepatic transcriptome profiles for  <dig> genes of  <dig> half sib male chickens generated from a same sire. this sire was generated by successive inter-crossing of two experimental chicken lines divergently selected on af and was known to be heterozygous for an af qtl on the gga <dig> chromosome around  <dig> cm . the  <dig> half sib chickens show therefore variation on af. according to the polygenic effect model of quantitative traits, this variation is probably due to multiple mutations and biological processes.

two lists of genes significantly correlated to the af trait are first generated using the raw and the factor-adjusted expression dataset. then, the relevance of the two gene lists to characterize functionally fatness variation in the family are compared, regarding the frequencies of biological processes related to the af trait in their functional annotations. factor-adjusted expression data is finally used to identify a gene whose expression is controlled by the af qtl region.

furthermore, the extracted factors are interpreted using external information on the experimental design such as the hatch, dam and body weight and also gene information such as functional categories, oligonucleotide size and location on the microarray. it is deduced that some factors may have different and complex origins, which confirms the importance of taking into account these extra sources of variability to be more relevant in the transcriptomic analyses.

RESULTS
illustrative examples
similarly to storey et al   <cit> , three simple situations of heterogeneity are considered. for each one, independent expressions for  <dig> genes on  <dig> arrays are simulated according to a standard normal distribution. the sample is split into two equal groups and a constant is added on the first  <dig> gene expressions to mimic a differential expression between these two groups.

case 1: one independent variable affecting all genes
all genes are affected by an independent grouping variable marked by colors red and green on figure 1a. a single factor is extracted by famt. figure 2a helps interpreting this factor and shows that it clearly discriminates the two colored groups of individuals . this shows a high association between the factor and the independent grouping variable. the genes representation does not show any particular structure. in this simple case the factor estimated by famt can therefore be easily interpreted through the individuals representation.

case 2: one independent variable affecting a set of genes
only genes 70- <dig> are affected by an independent grouping variable marked by colors red and green on figure 1b. a single factor is also found using famt. as shown on figure 2b, the factor discriminates the two groups of individuals  and the two groups of genes . in this case, the estimated factor can be interpreted through the individuals and genes representations.

case 3: two independent variables affecting two different sets of genes
gene sets 70- <dig> and 171- <dig> are each affected by an independent grouping variable marked respectively by colors red and green and by colors orange and blue as illustrated by figure 1c. two factors are identified by famt which are now interpreted regarding the two external sources of heterogeneity . the red-green variable seems to be highly associated with the first axis . on the contrary, the orange-blue variable is not associated with this axis considering a significance level of  <dig>  . the same strategy is implemented for the second factor. the red-green variable appears to be not associated with this factor  whereas the orange-blue variable is highly associated . in this case, each of the two estimated factors can be explained by one of the two independent grouping variables.

analysis of the af expression data set
classical approach
examination of the pearson coefficient correlation between hepatic transcript levels and af trait shows that  <dig> genes are significantly correlated considering a significance threshold of  <dig>  without any correction for multiple tests. this low amount of differentially expressed genes might be explained by a poor genetic variability between individuals which are half sib offsprings and could also be due to dependence between genes that can lead to under representation of the smallest p-values  <cit> .

heterogeneity analysis
minimizing the variance inflation criterion proposed by friguet et al.  <cit> , six factors containing a common information shared by all genes and independent from the af trait are extracted. subtracting the linear dependence kernel defined by these factors from the raw expression data yields the factor-adjusted expression data. the significance analysis based on these expressions results in a list of  <dig> gene expressions significantly correlated to the af trait. 93% of the  <dig> genes found with the classical approach are included in this list. this larger number of differentially expressed genes suggests that correlation between many gene expressions and the variable of interest is under estimated due to gene dependence. considering the gene ontology  terms and kegg pathways, one enriched term related to the lipid metabolism is found in the gene list resulting from factor-adjustment  whereas none is observed in the gene list obtained using the raw expressions . this term concerns "steroid biosynthesis process" with  <dig> genes associated . more precisely, these genes are involved in the cholesterol metabolism or in conversion of cholesterol in steroids. several works show relationships between cholesterol metabolism and obesity  <cit> . this result shows that the genes found after factor-adjustment are more related to the fatness trait. furthermore, the impact of factor-adjustment is shown in figure  <dig>  where a principal component analysis  generated with the  <dig> factor-adjusted transcript levels of correlated genes  separates much more fat and lean chickens than the same pca generated with the raw expressions of the same  <dig> genes . this observation displays that factor-adjustment has cleaned up the data from dependence, which highlights masked relationships with the af trait.

enrichment tests were performed using an r program  with go bp terms and kegg pathways. the tests were done on the list of  <dig> genes found using the classical approach and the list of  <dig> genes found by famt. for each enriched term, the identifier , the biological term, the size of the whole list of genes related to the term , the number of genes in the sub-list related to the term , the pvalue of the test and the hgnc hugo abbreviations of the related genes are given. italic terms are those which are present in both lists.

we focus on one of the  <dig> genes involved in the "steroid biosynthesis process", dhcr <dig>  which is only observed in the list of  <dig> genes and known for encoding the last enzyme involved in the cholesterol synthesis. as shown in figure  <dig>  the analysis of the factor-adjusted expressions for this gene highlights an eqtl  colocalizing with the af qtl previously observed  <cit> . the same lrt curve based on the raw expressions does not point out any eqtl. this result shows that the expression of this gene is controlled by a mutation in the same gga <dig> af qtl region. because of the function of this gene related to lipid metabolism, this result suggests that this mutation could be the same as the qtl mutation for fatness phenotype. further investigations are necessary to refine these qtl and eqtl locations.

factor interpretation
in the present study, some external information about the experimental design and the genes is available. as we did in the simulated examples, we interpret the factors extracted from the af expression dataset using this known information.

using information on experimental design
the hatch, the dam and the body weight were previously measured for each bird and should be independent of the af variation. for the body weight, the founder chicken lines were selected on af criteria maintaining a constant body weight. the variables "hatch" and "dam" are both categorical with respectively, four and eight levels and the body weight is a continuous variable. we first focus on the "hatch" and for each factor we represent the individuals colored according to their hatch . factor  <dig> seems to discriminate hatches  <dig> and  <dig>  factor  <dig> hatch  <dig> from the others and factor  <dig> hatches  <dig> and  <dig> from hatch  <dig>  the effect of the hatch on each factor is tested and the results given in table  <dig> confirm our previous observations: factor  <dig>   <dig> and  <dig> can be partly explained by a hatch effect . we then calculate the association for the "dam" and "body weight" with each of the six factors. table  <dig> shows no effect of the dam and a high correlation between the weight and factor  <dig>  contrarily to the illustrative cases where each factor could be interpreted by a unique variable, the factors found here seem to have more complex origins. indeed, three of the six factors can be interpreted by an hatch effect and another one by a body weight effect. the same analysis is now performed after adjustment of the raw expression data for hatch and body weight. interestingly, only five factors independent of the af trait are extracted and still a hatch effect exists but only on the first factor and a weight effect on the second factor . this persistence of both effects suggests that there exists an interaction involving hatch and body weight with other unmeasured and/or unknown variables. therefore, taking into account the hatch and body weight in the statistical model seems to be not sufficient to remove a consequent part of the heterogeneity in gene expression.

the p-value is given for each association test . considering a threshold of 1%, the significant p-values are in bold.

using gene information
to interpret the estimated factors in terms of gene expressions, we use known information about genes as oligonucleotide size and location on the chip: block, row and column . for these variables, we test their association with each factors extracted from the raw data and the hatch and body weight adjusted data. as shown in table  <dig>  there is a strong oligonucleotide size effect and block effect captured by almost all the factors. we exhibit also a row and column effect associated with some factors. moreover, the genes that most contribute to the first two factors are identified . we obtain a set of  <dig> genes for factor  <dig> and a set of  <dig> genes for factor  <dig> and which were as expected not included for 95% of them in the list of  <dig> genes. we perform a term enrichment test for this two sets . as we expect, there are essentially biological terms independent of the lipid metabolism. factor  <dig> is mainly characterized by genes involved in cell division metabolism and interestingly also to pigmentation. factor  <dig> is more characterized by genes involved in the nucleotide metabolism. the enriched terms found are thus not implicated in the metabolim changes induced by the af variability. we previously highlighted a hatch and body weight effects on the factors. as in pca, individuals and genes representations can be interpreted commonly. hatch effect could therefore be related to the particular metabolisms characterizing factor  <dig> 

enrichment tests were performed on the genes contributing the more to the construction of factor  <dig> and  <dig> using the go bp terms and kegg pathways. for each enriched term, the identifier , the bioligical term, the size of the whole list of genes related to the term , the number of genes in the sub-list related to the term , the pvalue of the test.

discussion and 
CONCLUSIONS
the model used in the present study assumes that the gene expressions are uncorrelated given a set of hidden variables called factors. in comparison to classical methods which do not take into account the dependence between genes, this approach provides a list of genes more correlated to the variable of interest. moreover, factor-adjustment of the expression dataset turns out to give more insight to subsequent analyses such as qtl characterization. as a result, a gene is identified as correlated to the af trait and related to the cholesterol metabolism having a trans-eqtl colocalizing with gga <dig> af qtl. because several works show a link between cholesterol and obesity, this gene could be considered as a signature of the mutation underlying this af qtl rather than a mutation close to it. this result provides functional hypothesis about genes whose expression could be impacted by the qtl of interest.

factor analysis was introduced in the psychometric field in  <dig> by spearman  <cit>  in order to extract the common factors in intelligence and personality. in this particular domain, the individuals are explained by their responses to different subsets of tests. the method usually furnished at least five factors which were interpreted as follows: neuroticism, extraversion, conscientiousness, agreeableness and openness to ideas. in our study, the factors were found using an em algorithm presented by  <cit> . our purpose was first to interpret the estimated factors and consequently to investigate which kind of information present in this factor structure could generate heterogeneity of the gene expressions. external information concerning the experimental design and functional annotations of the genes were used to analyse the factors. it is deduced that some factors seem to have a complex explanation with at least  <dig> variables associated to them. for factor  <dig>  the individuals variability independent of the trait of interest is for instance shown to be related to the hatch. enrichment tests also give a characterization of this factor by specific metabolisms.

to remove expression heterogeneity from the data for the subsequent statistical analyses, the basic idea consists in adjusting the raw expression data from the common factor structure. as we extract uncontrolled effects and technological biases from what was before simply considered as statistical noise, analyzing heterogeneity in gene expression yields a new point of view on transcriptomic data. we show in this study the importance of taking into account these extra sources of variation to be more relevant in the transcriptomic analyses.

