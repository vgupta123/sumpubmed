BACKGROUND
micrornas  are a class of small non-coding rnas that are found in both plants and animals. they are known to play important roles in gene regulatory networks by post-transcriptionally regulating the expression of other genes. these mirnas target other transcripts by forming near-perfect or imperfect base pairings. such formations silence genes either by mrna cleavage or translational repression  <cit> .

computational sequence-based methods have been developed to predict mirna direct targets. as animal mrnas have imperfect complementary base pairing to their targets and as they are short in length, most such approaches first search for a perfect 7-mer seed in the 5' end of mirnas that match to their targets. searching for such small motifs can lead to high false positive rates and so additional tests such as conservation filters are typically applied  <cit> . however, although many mirna targets are conserved in related species, restricting the analysis only to recognizably conserved targets would exclude mirnas that have recently diverged or changed rapidly. also, only a small number of such predicted targets have been experimentally validated.

although animal mirnas were originally believed to primarily translationally suppress gene expression, they have also been found to lead to mrna destabilization or degradation. mirna transfection microarray experiments capable of detecting such effects at the mrna level of targets have shown that a large number of transcripts are down-regulated by over-expression of mirnas  <cit> . such high-throughput expression data provide a promising way to assist in mirna target prediction.

the mrna expression changes after mirna transfection could be a result of mirnas directly targeting these messages , or the mrna of genes could also be indirectly down-regulated if they are a part of a mirna-mediated regulatory module controlled by the direct mirna targets   <cit> . in this case, these indirectly regulated genes' response is causally related to the directly regulated genes in the corresponding module. as such, indirect targets would be expected to respond with delayed expression changes over time relative to the direct targets.

time-series microarray experiments that repeatedly measure gene expression simultaneously for multiple genes over a time period can capture temporal patterns and dependency of gene expression changes. a recent study by wang and wang  <cit>  applied sequence-based target prediction to identify targets and then used a time-series mirna transfection microarray analysis to experimentally validate the predictions. another study used a gene set enrichment-like score to measure expression changes at different times  <cit> . however, these methods treated expression changes over time points as separate observations and therefore did not fully utilize the information on time dependency of gene expression changes. in this paper we aim to explore the differences between the expression profiles of genes that are direct mirna targets and indirectly targeted genes, including classification of genes based on their profile. we use functional data analysis  to utilize the higher level structure due to the data being a set of finite samples from a continuous and presumably smooth curve.

functional data analysis  <cit>  is a subfield of statistics applicable when the predictor or response variable can be treated as a set of samples from a function, rather than simply as a feature vector. it is, in essence, the extension of standard multivariate analysis of finite dimensional vector spaces to infinite dimensional function spaces ) using a functional analytic approach. fda entails interpolating and smoothing the set of function samples using some appropriate set of basis functions , kernel smoothing, or regularization. multivariate procedures such as principal component, regression and classification analyses typically involve an inner product  defined on the vector space: for the reconstructed continuous function, the conventional multivariate dot product, 〈x,y〉=∑i=1nxiyi, can be replaced by the corresponding functional inner product, 〈x,y〉=∫0txydt, for time interval t, in the corresponding multivariate analysis method. for example, standard pca can be extended to functional pca   <cit>  as follows. conventional multivariate pca finds the axes of maximum variance in the data by solving the eigenequation vξ = λξ for variance – covariance matrix v = n- <dig> x'x, where x is the  n × p data matrix, with n samples and p features; and λ and ξ are the corresponding eigenvalue and eigenvector. in functional pca, the equivalent eigenequation is generalized to vξ = λξ where ξ is now an eigenfunction and v is the covariance operator defined by: vx = ∫vxdt = ⟨, x⟩; where the variance-covariance function  v=n−1∑i=1nxixi. so, in summary, fpca can be expressed as the eigenanalysis of the covariance operator v, defined by using the covariance function v as the kernel of an integral transform, and this formulation of the eigenequation in terms of inner products, ⟨v, ξ⟩ = λξ, can be applied to either multivariate or functional data, with the respective definition of inner product, where s ∈ t for function domain t for the functional case, and index set t =  <dig> ..., p in the multivariate case. in most cases, this expression can be computed quickly using only matrix expressions utilizing the sampled data points and a matrix of inner products between basis functions, avoiding estimation of the integral  <cit> . similarly, most other standard multivariate data analyses such as canonical correlation, cluster, regression and classification analysis can be extended to functional versions.

in this paper, we use fpca for initial exploratory analysis and a nonparametric functional data analysis  approach  <cit>  for prediction. the advantage of this functional data analytic approach is that the prior knowledge that the data is generated by a continuous smooth dynamics allows for: accurate estimates of derivatives which can then be used in the analysis; effective noise reduction through curve smoothing; applicability to data with irregular time sampling schedules. such functional data analytic approaches have been previously applied to the analysis of temporal microarray expression data e.g. to cluster time-series gene expression data  <cit>  and to classify yeast cell-cycle gene expression profiles and dictyostelium cell-type  <cit> . in this paper, we analyze mirna- <dig> transfection time-series microarray expression data using fda and show that such expression change differences can be modeled as different time activity curves to effectively predict mirna direct targets and distinguish them from indirect targets.

methods
we analyzed the mir- <dig> transfection time-series microarray data previously published in  <cit> , which measures expression levels over  <dig> hours at  <dig> time points. we initially identified a set of genes down-regulated after mirna transfection. to identify, using sequence information alone, a set of true  targets and non-targets to train the functional model, we predicted mirna targets using publicly available target predictors and used the high confidence predictions to determine direct-target and indirect-target sets as training sets for classification. fpca was used for exploratory data analysis and npfda was used to distinguish the direct targets from the indirect targets. an overview of the analysis pipeline in this study is outlined in figure  <dig> and details are described in the following sections.

mirna transfection dataset
we retrieved the mirna- <dig> transfection time-series microarray expression dataset from the geo database  <cit>  . the dataset contains mrna expression profiles generated by over-expressing mirna- <dig> duplexes into human hepg <dig> cells in comparison to negative controls at times  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> hours, using affymetrix microarrays . mirna- <dig> is known to be highly expressed in several tissues including brain and kidney, but is not highly expressed in the cell line used  <cit> . starting with all genes provided on the u133plus <dig> microarray, we first excluded those genes showing low overall expression levels in the control samples as these genes would be unlikely to be able to clearly show down-regulation after mirna transfection. only probes where the expression levels over at least half of all time points of the control samples were greater than the median expression level of control samples were retained for further analysis. expression values were averaged for those genes with corresponding multiple probes.

we next identified genes showing substantial evidence for down-regulation of mrnas. genes with over  <dig> -fold under-expression  of less than - <dig> ) for at least one time point were considered to be down-regulated genes. we subsequently restricted our analysis to these down-regulated genes in this study .

mirna target prediction
we obtained two pre-computed target gene sets for mir- <dig> that were predicted by targetscans  <cit>  and pita  <cit> . the targetscans pre-computed target set for mir- <dig> contains  <dig> down-regulated genes with 7- and 8-mer sites conserved across several mammalian species and  <dig> genes with non-conserved sites. the pita pre-computed target set for mir- <dig> contains  <dig> down-regulated genes with 7- and 8-mer conserved sites and  <dig> genes with non-conserved sites . to construct a control set of genes that were not predicted to be mirna- <dig> targets, we further excluded genes showing even weak sites. to do so, we first extracted annotated 3'utr sequences of genes from ensemble  <cit>  using biomart  <cit> . mirna target predictions were then performed on the 3'utrs using pita  <cit>  with a relaxed parameter setting: a seed of length  <dig> to  <dig> bps and allowing g::u pairing in 7- and 8-mer seeds.

construction of datasets
we constructed two datasets to be used as training data for functional classification analysis.

 direct-target training set: we used the existing computational mirna target predictors described above to construct a relatively high confidence direct-target training set. as current computational target predictors can vary in their effectiveness  <cit> , to increase confidence we required both predictors to agree. we obtained  <dig> down-regulated genes that were predicted by both predictors with 7- and 8-mer seed sites and that were found to be evolutionarily conserved in several other species by both predictors.

 indirect-target training set: we selected the down-regulated genes that had annotated 3'utrs but in which no target sites could be found by either predictor and even no weak sites could be found by using pita prediction with relaxed parameters. from these genes, a set of size identical to the direct-target training set was randomly sampled to form the indirect-target training set.

we also constructed two independent datasets that had not been used for training that we used to further evaluate our model.

 non-conserved direct-target test set: we combined the down-regulated genes that were predicted from either of the predictors, yet that had no evidence of conservation. this set consisted of  <dig> genes and presumably would be enriched for direct targets.

 indirect-target test set: we constructed another independent dataset which met the same criteria as the indirect-target training set but excluding genes that had been used for training the model. this set consisted of  <dig> genes.

functional data analysis
we used fpca to perform exploratory data analysis. to fit a smooth function to the discrete sampled data, we used a set of  <dig> b-spline basis functions of order  <dig> . knots were located at the data points. additional regularized smoothing  was applied .

the npfda approach was used for classification. the first derivative of the expression profile was effectively used as the predictor variable, with a boolean  response variable. the npfda used b-spline basis functions  to produce smooth first derivative estimates. performance evaluation was by  <dig> × stratified 10-fold cross-validation . major parameters were determined via nested cv separately for each fold; other parameter settings were set to their defaults or as appropriate for the data size. to evaluate the discriminability of the classes, the receiver operating characteristics  curves were calculated as well as the associated area under the roc curve .

r code implementing the analysis is available from the authors.

RESULTS
exploratory data analysis with functional principal components analysis 
in the mir- <dig> dataset, wang and wang  <cit>  previously noted that genes directly targeted by mir- <dig> tended to have substantial down-regulation at time points earlier than the indirectly down-regulated genes. this phenomena is as would be expected as the indirect targets would be causally downstream to the directly regulated genes. figures  <dig> and  <dig> show the mean, unsmoothed, gene expression profiles of the direct-target training set and the indirect-target training set, respectively . the measurement time points are plotted equally spaced on the time axis to emphasize the early stages of the expression profile. comparing the mean curves of the two datasets, the direct targets show an immediate decrease in mrna levels reaching a minimum at approximately  <dig> hours. by contrast, the indirect targets show a delayed response and do not, on average, commence decreasing until approximately  <dig> hours, reaching a minimum at about  <dig> hours. figures  <dig> and  <dig> show the smoothed functional profiles that were reconstructed using b-spline basis functions . as discussed in the background section, it can be seen that smoothed functional curves allow us to reduce noise and have a better estimate of curve derivatives.

fpca analysis reveals the modes of variation across the samples. figure  <dig> shows the results of fpca applied to the indirect-target training set and the major modes of variance of the signal compared with the mean . in figure  <dig> the first principal component  function  is added and subtracted from the mean curve, and similarly for the second pc function in figure  <dig>  figure  <dig> shows that there is a large variance in the overall expression fold change along the curves. the curves are normalized in the following classification step to minimize this variance . figure  <dig> shows that the down-regulation peak varies somewhat in the exact time of its minimum across genes. the extent to which this variance is biologically meaningful and represents causal relationships, as opposed to being explained by the relatively low resolution sampling interval used, will require higher resolution studies to investigate. for example, only approximately three time points were available in this dataset to capture the details of the major indirect target down-regulation peak, which is only just sufficient. ideally, for an fda analysis of such noisy data a sampling rate  <dig> or more times higher than this would be needed to capture fine details well  <cit> .

classification using nonparametric fda 
as noted above, the gene expression curves show a large variance in overall fold change in the first principal component of the functional pca. a key preprocessing step in fda is registration of the curves to remove unimportant amplitude or other variations. prior to classification, therefore, each curve was standardized to have a mean  fold change of - <dig>  thus, average fold change differences between the direct and indirect target sets were normalized away, and the shape of the response curves alone was effectively used to distinguish the direct targets from the indirect targets. using curve shape information only would be expected to provide a more robust predictor than also relying on the absolute fold change as a feature, as it varies substantially between genes. an npfda discrimination model was trained on the direct and indirect target training sets . the performance was compared with linear discriminant analysis  as an example of a standard multivariate analysis.

the results are shown in table  <dig>  the npfda gave very good prediction accuracy of 88% and auc of  <dig> . ). the increase in accuracy over lda was statistically significant . figure  <dig> shows the roc curves for npfda and standard lda: npfda shows a substantial improvement over multivariate lda. for comparison, the discriminability of each time point treated separately as a univariate feature was examined: the expression level across genes at each time point was used directly for ranking to compute the corresponding auc. the best discriminating time point was at  <dig> hours with an auc of  <dig> .

to further validate the trained model, we also used it to classify data that was independent of the training set: the non-conserved direct-target test set and the indirect-target test set . although the true status of these data are not known and so explicit accuracy and auc results cannot be computed, we would expect the majority of the non-conserved test set to be true direct targets. however without conservation information we would expect a proportion of false positives i.e. indirect targets in actuality. for the indirect-target test set, we would expect predominantly true indirect targets. we generated histograms of the posterior probabilities from the npfda in these datasets . comparing the histograms of the non-conserved direct target test set  and the indirect-target test set , we see this expected result: the red set has overall high posterior probability  with a large mode approaching  <dig>  based on this evidence, the majority of the predicted genes without conservation information are indeed true direct targets.

CONCLUSIONS
in this study, we presented an fda analysis of the differences in expression profiles between direct and indirect mirna targets in a mir- <dig> mirna transfection experiment. an exploratory fda analysis showed differences in response latency, with direct targets showing an immediate down-regulation whereas indirect targets typically showed an approximately  <dig> hour delay. also, direct mirna target curves show evidence of a biphasic, two-component response with an initial early decrease presumably due to direct effects of the mirna on mrna, and a later component matching the response of the indirect targets, possibly due to secondary effects.

these time profile differences can be utilized for classification, and in the prediction analysis we showed that fda can provide very good discrimination, substantially better than a standard multivariate analysis, as fda utilizes the prior knowledge that the biological process of regulation generates a smoothly varying time profile. such a predictive model would be especially useful in cases where computational approaches are less reliable e.g. lack of evolutionary conservation. further, this approach can be used to provide additional confirmatory evidence  for computationally predicted mirna targets and so improve computational mirna target prediction. this approach would be applicable to the investigation of other mirnas and these results suggest that dynamic microarray studies at a higher time resolution could reveal further details on mirna regulation.

competing interests
the authors declare that they have no competing interests.

authors' contributions
bjp and jw designed the study and analyzed the data. both authors drafted, read and approved the final manuscript. bjp and jw contributed equally to this work.

