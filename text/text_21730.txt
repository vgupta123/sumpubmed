BACKGROUND
the knowledge-based approach to construct biological network models is recognized as one of the most promising advances in computational biology  <cit> . in this approach, the causal relations between biological molecules are described as a directed graph, based on the interaction information extracted from a large number of previous reports, in a manual or automatic manner  <cit> . since each relation has been identified by experimental studies, the existence of edges in the network model is supported by strong evidence. due to the high reliability of each relation, many network models, even those with large, complex structures, have been constructed for various biological phenomena by a knowledge-based approach  <cit> . note that a network generated by a knowledge-based approach is a mixture of molecular relationships identified by experimental studies under different conditions. indeed, it is well known that the relationships between the molecules in a living cell change dynamically, depending on the cellular environment. fortunately, an abundance of such information about molecular interactions under different conditions has been obtained by measuring them on a genomic scale, due to recent advances in experimental techniques, and the information about the interactions is available at various web sites  <cit> . thus, we can evaluate the consistency of the knowledge-based network structure by the available information about the data measured under the different conditions. although the inference of static network structures from the data has been intensively studied by various approaches, such as the bayesian network  <cit> , the dynamic bayesian network  <cit> , the boolean network  <cit> , and the graphical gaussian model  <cit> , the consistency evaluation will be useful to trace the dynamic network structure variations reflecting the molecular relationships that change coordinately in response to the cellular environment.

the consistency evaluation between the network structure and the measured data is well known in statistics as the test for causal hypotheses by using the measured data. the origin of the test for causal hypotheses is attributed to path analysis  <cit> . unfortunately, the importance of this cornerstone research was not recognized for a long time, but the natural extension of path analysis has been established as the well-known structural equation model   <cit> . indeed, the sem has been utilized recently in various fields, in accordance with increased computer performance. however, the sem without any latent variables, which is a natural assumption for its application to biological networks, sometimes has difficulties in the numerical calculation of the maximum likelihood for the observed data. to overcome the problem with this calculation, the d-sep test  <cit>  has been developed, based on the concept of d-separation in a directed acyclic graph   <cit> . note that the graph consistency with the data in the d-sep test is considered by focusing on the absence of edges in the graph  <cit> .

recently, linear regression was applied to reconcile the gene regulatory network with the corresponding data  <cit> . this application is based on the concept that the entire network of gene regulation can be divided into a few network motifs, with a two-layer relationship between the transcription factors and their regulated genes  <cit> . indeed, the division of the entire network into a small and simple network enables us to utilize the standard statistical tests in linear regression for the consistency of the gene relationships with the measured data. unfortunately, the linear regression is limited to the two-layer relationships, and subsequently, its application is constrained to the simple structures of gene regulatory networks.

in this study, we propose a new method for estimating the consistency of a causal graph with the measured data, in combination with the gaussian network   <cit>  and the generalized extreme value distribution   <cit> . the present study partly exploits the previous study  <cit>  about the consistency between the network motif with two-layer gene relationships and the measured data. however, instead of the network motifs with simple structures, here we consider rationally complicated network structures based on the graphical model, and its consistency with the data is expressed as a probability, referred to as the graph consistency probability . the performance of the present method is examined by artificial networks with various structures and actual data measured in escherichia coli. furthermore, the merits and pitfalls of our method are discussed in terms of its possible utility with various actual issues and methodologies, in comparison with previous methods.

RESULTS
calculation of graph consistency probability 
we will illustrate the procedure for calculating the graph consistency probability  with a simple graph, g <dig>  which is a directed acyclic graph with ten nodes and nine edges, and with the corresponding data that are artificially generated on the assumption that the data noise follows the normal distribution. the procedure for calculating the gcp is composed of five steps, as schematically shown in fig.  <dig> .

at the first step, the given graph, g <dig>  is recursively factorized into the subgraphs, according to the parent-descent relationships in dag  <cit> . by recursive factorization, g <dig> is rationally divided into  <dig> subgraphs, based on the parent-descent relationships in the directed graph.

at the second step, we calculated the log-likelihood of the given graph, l, with the corresponding data by a gaussian network model  <cit> . to calculate l, here, we generated the data {xkl} for each node with  <dig> sample dimensions, i.e., for k =  <dig> ,..., <dig> and l =  <dig> ,..., <dig>  instead of the actual data, by the structural equations . the l of the given graph was then calculated to - <dig> . we will estimate the probability of l, gcp, by the following three steps.

at the third step, we generated the graphs based on the given graph, and then calculated the log-likelihoods of the generated graphs according to the two preceding steps.

 we generated  <dig> random graph sets, {gi}, to form a data set, in which each graph has the same number of nodes and edges, but with different connections from those of g <dig> 

  <dig> corresponding log-likelihoods of {gi} were calculated according to the first and second steps. among the  <dig> log-likelihoods, the maximum of the log-likelihood, l, is selected.

 the above procedure is iterated  <dig> times to finally obtain  <dig> values of l. in this step, the dimensions of the sampling data, the number of graphs in one set, and that of the iterations to select l are changeable parameters, and the robustness of our method with them will be evaluated in the following sections.

at the fourth step, we fit the log-likelihoods calculated in the third step to the gev model. the maximization of the gev log-likelihood leads to the following estimate:

 =, 

for which the gev log-likelihood is  <dig> . although the maximum likelihood estimate for ξ^ is negative, corresponding to a bounded distribution, the ξ value larger than - <dig>  indicates that the maximum likelihood functioned well for the estimation  <cit> . furthermore, the goodness of fit can be visually diagnosed, using the three diagnostic plots for assessing the accuracy of the gev model, fitted to the  <dig> log-likelihoods data by the three parameterizations. neither the probability plot nor the quantile plot gave any cause to doubt the validity of the fitted model: each set of plotted points was nearly linear. the return-level curve asymptotes to a finite level as a consequence of the negative estimate ξ^, and also provides a satisfactory representation of the empirical estimates. in addition, the corresponding density estimate seems consistent with the histogram of the data. consequently, the four diagnostic plots lend support to the fitted gev model.

at the final step, we estimated the gcp of the log-likelihood of the given graph based on the fitted gev distribution. according to the gev distribution, the gcp corresponding to l  was calculated to be less than 10- <dig>  as a result, it is natural that the examined given graph was highly consistent with the data generated according to the graph structure.

robustness of the present method
the high performance of the present method described in the preceding subsection depends on a few parameters. by using the same network structure as in fig.  <dig>  we tested the robustness of the present method in terms of the dimensions of the analyzed data, the two parameters in generating artificial graphs for gev, and the degree of noise in the data. furthermore, the robustness of the network structure variation is tested by using the typical network structure in biological interactions in the following four subsections.

robustness in terms of the dimensions of the analyzed data
we test the robustness of our method in terms of the number of data samples for one variable  that is smaller than the data dimension  in fig.  <dig>  this is because the experimental conditions are frequently limited, due to the technical difficulty of performing experiments for different growth conditions. thus, small data dimensions are expected in the actual data.

we performed the same estimation of gcp as that in fig.  <dig>  by using the data with  <dig> and  <dig> dimensions, and in both cases, the present method operated well. the gev fit well to the data: the estimated ξ^ was larger than - <dig> : the estimated ξ^ values are - <dig>  for the 15-dimension data and - <dig>  for the 30-dimension data. in addition, the four gev-diagnostic plots for assessing the accuracy of the gev model show the validity of the fitted model in each case . by the estimated gev distributions, the gcps in the two cases were less than 10- <dig> and 10- <dig>  respectively. the probability for the 30-dimension data was smaller than that for the 15-dimension data. considering that the probability was 10- <dig> in the 50-dimension data in the preceding section, this indicates that the resolution degree about the consistency is higher with larger dimensions.

robustness in terms of parameters in generating the gev model
the gcp depends on two parameters in the graph generation for gev: the number of graphs for selecting the maximum of the likelihood in one set of the generated graphs, l, and the number of iterations for sampling the maximum values from each set of generated graphs, n. in fig.  <dig>  l and n were set to  <dig> and  <dig>  and a total of  <dig>  graphs were generated for gev. here, we examined the fitness of the log-likelihoods to gev based on the graph shown in fig.  <dig>  with nine pairs of l and n: l was set to  <dig>   <dig> and  <dig>  and n was set to  <dig>   <dig>  and  <dig>  the total numbers of graphs for gev ranged from  <dig> to  <dig>  and all of the examinations with the above parameter pairs are provided in an additional file . here, we focused on the case when fewer graphs are generated than the number in the default case. this is because a small number of generated graphs in each set and iterations may tend to violate the distribution of gev, due to some biases in the graph generation.

in the comparison of  =  and  with  in fig.  <dig>  the log-likelihoods calculated in the two cases were fitted to the gev model. indeed, the two ξ^ values were larger than - <dig> : the estimated ξ^ values were - <dig>  in  =  and - <dig>  in  = , respectively. the two sets of diagnostic plots for assessing the accuracy also showed the validity of the fitted model in each case . a closer inspection revealed that the ξ^ value in the  case was slightly less than that in the  case. this indicated that the number of graphs in each set, l, is more sensitive to the goodness of fitness than the number of iterations, n, regardless of the total number of generated graphs. at any rate, the present method operates well, even in the case of a relatively small number of generated graphs.

in general, the optimized values of l and n depend on the size of the examined graph, and may be expressed as the fraction to the total number of possible graphs with the same numbers of nodes and edges as those of the examined graph. although the number of possible graphs composed of arbitrary numbers of labeled nodes and edges can be estimated asymptotically under some constraints on the edge connectivity  <cit> , unfortunately, the total number of possible graphs, in which all of the nodes are connected to form one graph, is not still obtained. in the present stage, we should heuristically define l and n by diagnosing the goodness of fit to the gev model.

robustness in terms of the magnitude of noise in the analyzed data
we estimated the gcp in various noise ranges. for this purpose, the value of the standard deviation in the structural equations for data generation  was changed to three values . by the same procedure as that in fig.  <dig>  we calculated  <dig> gcps for the three ranges of standard deviations. finally, the probabilities of the generated graphs were calculated.

the histograms of the gcps in the three ranges of standard deviations are shown in fig.  <dig>  in this figure,  <dig> gcps were plotted against the number of connections in the generated graphs that were different from those in the examined graph in the respective cases of standard deviations. in the cases of the two small standard deviations , less than 10- <dig> of the gcps emerged most frequently, but the most frequent gcp was found at 10- <dig> in the case of the largest standard deviation . in the former two cases, the largest gcp was 10- <dig> in σ =  <dig>  and 10- <dig> in σ =  <dig> . although some exceptional gcps were also found, the present method operates well within the range of the two noise levels. in contrast, the last case shows the limitation of our method, in terms of the noise of the measured data. careful preprocessing of the measured data may be required to apply our method to actual data. note that the noise is amplified as the number of parents grows in the present simulation. for example, the standard deviation is σ, when a descent has two parents and αi is the path coefficient between the descent and the i-th parent. at any rate, the limitation of the present method in terms of the data noise can be examined by describing the histogram of the gcp, and was estimated between  <dig>  and  <dig>  for the graph in fig.  <dig>  in addition, we assumed that the distribution of the data noise also follows uniform and gamma distributions, and obtained similar results in terms of the robustness about the data noise .

robustness regarding the variation of the network structure
we applied the present method to the three network structures shown in fig.  <dig>  the three networks are analogous to the typical structures of biological networks; the first is analogous to part of a chain reaction in a metabolic pathway, the second represents the simple structure of a gene regulatory network, and the third depicts a cascade in a signal transduction pathway. according to the connectivity in the network, the data were generated with the corresponding structural equations, and the present method was applied to estimate the graph consistency with the generated data.

the present method operated well in all of the network structures. indeed, the log-likelihoods in the three networks fit well to the gev . in addition, the gcps were very small: the gcps of the three networks were less than 10- <dig>  10- <dig>  and 10- <dig>  respectively. interestingly, the magnitudes of the gcps may be related to the network structures. the gcp in fig. 3b is relatively larger than the gcps in figs. 3a and 3c. this is because the present path coefficients between the  <dig> nodes were set at different values, but in the same order of digits. this indicates that the most similar data for respective variables were generated in fig. 3b, and caused pseudo-correlations between the variables with no edges in the network in fig. 3b. although the performance for estimating the graph consistency may slightly decrease, depending on the number of two -layer relationships in the examined data, this simulation shows that the present method can be applied to various structures of networks.

examinations of actual graphs
we examined the performance of the present method with two sets of actual networks in escherichia coli and the corresponding actual measured data. one set is a regulatory network for the sos response system with the expression degrees of the constituent genes measured by fluorescence  <cit> , and the other is  <dig> networks classified by gene functions, with the expression degrees under anaerobic conditions measured by microarray  <cit> . the former examination is a verification of the present method for an actual network with a size similar to the networks shown in fig.  <dig>  and the latter is a demonstration of a high-throughput search of network candidates, consistent with the data measured under particular conditions.

verification for a simple network
the gene network in the sos system is schematically shown in fig. 4a. the sos dna repair system in escherichia coli is a well-characterized transcriptional network  <cit> . one of the sos proteins, reca, acts as a sensor of dna damage, and a master repressor  binds sites in the promoter regions of these operons. the corresponding data to the constituent molecules in the network are the transcriptional activity of genes measured with real-time monitoring by means of low-copy reporter plasmids, in which a promoter controls green fluorescent protein  <cit> .

the gev plots with the likelihood values and the statistics are shown in fig. 4b. the value of ξ^ was larger than - <dig> , and the gev plots were quite similar to those in fig.  <dig>  indeed, each set of plotted points was nearly linear, and the return-level curve asymptotes to a finite level. in addition, the corresponding density estimate seems consistent with the histogram of the data. consequently, the goodness of fitness in the actually measured data lends support to the gev model.

the gcp of the sos network with the corresponding measured data was estimated as  <dig> , and the network structure was estimated to be consistent with the data measured from the examined network. however, the gcp was large in comparison with the gcps in the simulation studies in the preceding sections. this is partly because the cyclic relationship of reca is neglected in the examined network, and partly because most of the relationships in the examined network are composed of 2-layer relationships, due to the production of similar degrees of expression data, as in the situation in fig. 3b. at any rate, the performance of the present method was verified by a well-known network, with a size similar to that in the simulation, and with the corresponding data measured by an experimental study.

demonstration for an actual network set
we further tested the performance of our method for selecting the networks consistent with the data measured under specific conditions from many network candidates. here, we arranged  <dig> regulatory networks in escherichia coli and the corresponding gene expression profiles measured under anaerobic conditions .

gcp values with less than 5% significance probability are indicated in bold type. the id in the classification scheme by ecocyc  <cit>  and the corresponding gene function are denoted in the second and third columns, respectively. two networks in the functions c <dig> and c <dig> are composed of the same constituent genes with the same connectivity. in the following columns, the numbers of nodes and edges of the analyzed networks are denoted: the original network was constructed based on the information about the relationship between the transcription factor and its regulated genes in ecocyc, and the analyzed network was constructed from the original network by excluding the genes that were not found in the expression profile data from ncbi geo   <cit> . the numbers of nodes and edges of the original networks are denoted in parentheses. the graph consistency probability  is denoted in the last column.

the first network  is composed of malt and its regulated genes. malt is involved in maltose transport  <cit> . besides the malt-regulating network, four networks related to carbon compounds  were also included in the examined networks, but they showed no significant probability: the tfs in each network are arac, galr, gutm, and exur, and they regulate products related to the transport of arabinose, galactose, glucitol, and hexuronate, respectively  <cit> . among the four networks, the galr and exur-regulating networks  are coordinated in terms of their products: the exur regulatory gene product controls the expression of the galacturonate pathway operons   <cit> . interestingly, galactose was the least efficiently utilized under anaeorbic conditions, among glucose, lactose, galactose, maltose, maltotriose, and maltohexaose  <cit> . this fact may be one of the reasons why our method revealed the consistency of network no.  <dig> with the data, and the lack of consistency of two of the networks, nos.  <dig> and  <dig>  in the remaining two networks, nos.  <dig> and  <dig>  there are no reasons for their lack of consistency with the present data. thus, the detection of the network related to maltose metabolism is reasonable, at least in comparison with the galactose- and hexuronate-related networks.

as for the second network , the biological function is defined as anaerobic respiration, and its detection is clearly reasonable. the gene encoding the transcription factor in the network is fnr, one of the seven global regulators in e. coli  <cit> , and the modular controlled by its product, fnr, encodes proteins involved in cellular adaptation to growth in anoxic environments  <cit> . since the network is related to adaptations to environmental changes, many genes are comprehensively associated with each other, and the network structure is complex, as seen in fig 5b. thus, the consistency of the fnr-regulating network with the present data demonstrates the validity of the present method for searching a large-size network consistent with data measured under particular cellular conditions.

it may seem overly strict to estimate the network consistency by the present method. some other networks besides the two detected networks might be operating under anaerobic conditions. however, the strictness of the consistency estimation is one of the prerequisites for exploring unknown networks. the falsely detected networks should be excluded as much as possible, and the detection of a few definite network candidates may serve as the initial step for investigating the unknown networks that are unexpected, in terms of biological knowledge. in addition, the strictness for consistency estimation is easily modified by setting the selection degree with a significance probability. as a result, the present method reveals the strictly consistent networks with the expression profiles measured under specific conditions, and will be useful to find the activated network candidates among many given networks.

merits and pitfalls of the present method
the present method successfully evaluates the consistency of a network with the artificial and actual data, which is expressed as a probability, gcp. the gcp of each known network is estimated from one set of data in which the constituent molecules of the network were measured under one particular condition. although a large amount of noise prevents a confident estimation of the gcp, the present method is robust in terms of the data sampling dimensions, the parameters in the method, and the network structure variation. the plausibility of the structure variation and scale is illustrated by the detection of actual networks for the simple network of the sos response and the large and complicated network for anaerobic respiration. thus, the present method is feasible to evaluate the consistency of the networks with a set of data measured under particular conditions.

the present method may be further applied to various analyses of biological issues. one example is a simple extension of the demonstration shown in the preceding section, as follows. assume that we know more than two distinctive cell stages, and that we can measure the data of the constituent molecules in different stages. then, we evaluate the consistency of a set of known networks with the respective data. by this evaluation, we may detect the activated networks, among the known networks that are specific to the respective cell stages. for example, the present method may address the problem of which known networks are activated in progressive diseases and in cell differentiation processes. thus, the present method will be useful to investigate the network variation in various cell stages responding to different environments. another example is a utilization of the graphs generated in gev modeling. assume that we know a network model for a biological phenomenon, and that a few molecules have been newly detected, and are responsible for the phenomenon. then, we face the issue of how the newly detected molecules should be connected to the previous network. in this situation, our method may present a solution. a new network is tentatively constructed, by connecting the newly detected molecules into the previous network with the full use of biological knowledge, and then the consistency of the tentative network is estimated with the data measured under the conditions where the relationship of the new molecules with the phenomenon was found. if the gcp shows the significance probability, then the network is a promising model for the phenomenon. if not, then we can list some network candidates with the significance probability that commonly share the structure of the previous network, among the generated networks for the gev distribution. note that the present method aims to evaluate the consistency between the known network structures and the measured data. thus, the network inference without any given network structures is beyond the present study. at any rate, these two examples will be demonstrated by appropriate networks and data in the near future.

in terms of the methodology, the present method is a rational extension of the previous study based on linear regression  <cit> , by the combination of the gaussian network and the extreme value distribution. indeed, the application range on the network structure is expanded, from simple networks with two-layer relationships to more complex networks with multiple-layer relationships. in addition, the present method is complementary with the d-sep test; the graph consistency is estimated for the associations between variables  in our method, and in contrast, no associations between variables  are considered in the d-sep test  <cit> . however, the d-sep test failed to select the activated networks: when we set the significance probability to 5%,  <dig> networks among the  <dig> networks were consistent with the data measured under specific conditions, and only two networks were not . interestingly, sem also failed :  <dig> networks among the  <dig> networks were consistent with the data, and one of the two remaining networks could not be evaluated, due to a numerical calculation violation. thus, our method may be appropriate for tightly estimating the graph consistency in comparison with the d-sep test and sem. furthermore, our method differs from the d-sep test in a strict sense. the present method is based on the generation of artificial graphs in the estimation of graph consistency with the measured data, while the d-sep test is based on the direct hypothesis of a population distribution  <cit> . thus, our method is an asymptotic approach, and is similar to various methods for model selection in network inference, such as various bayesian network models  <cit> . note that the present gcp is an occurrence probability, and definitely differs from the model selection procedure by using the scores that show a relative difference.

the consistency of a model with the observed data also reminds us of the identifiability problem in the compartmental models for tracer kinetics  <cit> . the identifiability problem addresses the issue of whether the unknown parameters can be determined uniquely or non-uniquely from the tracer data. although a systematic algorithm for the identifiability problem was proposed regardless of the model structure  <cit> , its application is limited to the ideal context of noise-free data. recently, we have partially exploited the identifiability problem algorithm to treat data including noise  <cit> . indeed, a network including a cyclic relationship has been examined to estimate the consistency with noisy data. although this method has a limitation of the network size to smaller than  <dig> nodes and  <dig> edges, another method with a symbolic approach may partly compensate for the statistical approach presented here for the limitation of the network structure.

CONCLUSIONS
we have proposed a novel method to estimate the consistency of a given network with the measured data as a probability , based on the gaussian network and the generalized extreme value distribution. the performance of the present method was validated by application to artificial graphs with simulated data and actual graphs with measured data from escherichia coli. the plausible evaluation of the consistency between the network structures and the corresponding measured data promises to help reveal the network structure variations depending on the environments in a living cell, as well as to form a bridge between the static network from the literature and the corresponding measurements.

