BACKGROUND
disease gene prediction is one of the most important aims in biological and medical sciences. network-based evidence as well as inference approaches has become more and more attractive in the research field of disease-causing gene discovery, and a variety of methods have been developed recently from this point of view  <cit> . researchers also attach great importance to special features embedded in biological networks especially the protein-protein interaction  network for deeply understanding molecular mechanism of common human diseases  <cit> . since genetic diseases are genetically or phenotypically similar, it is promising to combine the protein-protein interactions and the phenotype similarities to a phenotype-gene heterogeneous network to infer the candidate disease genes  <cit> . the so-called "phenotype-gene heterogeneous network" reflects a holistic view of complex relationships among various phenotypes and phenotypes, phenotypes and genes, as well as genes and genes, which consists of the phenotype-phenotype similarity network, gene-disease association network and protein-protein interaction network, respectively. based on such a heterogeneous network, we propose a regression model named cipher  to quantify the concordance between candidate genes and target phenotypes  <cit> . the algorithm of random walk is also proposed to prioritize the candidate disease genes in protein-protein interaction networks  <cit>  and then a random walk with restarts  method is extended to the above heterogeneous network  <cit> .

in general, the network-based disease-gene discovery methods make use of information from both the topological structure and the associations between diseases and genes. the basic assumption is that similar disease phenotypes are caused by functionally related genes and these genes are likely to be close to each other on the protein-protein interaction networks, so that network modules are formed  <cit> . here the network module in computation refers to a group of genes exhibiting network proximity, and in biology refers to certain functional units such as protein complexes, signaling or metabolic pathways and transcriptional programs  <cit> . therefore, the algorithms in  <cit>  prioritize candidate genes based on their closeness to known disease genes. after the similarity information between the phenotypes is provided by van driel et al. through text mining technology  <cit> , the phenotype similarity and the protein-protein interactions are combined together for the prioritization of the candidate disease genes  <cit> .

however, so far little modularity analysis on the phenotype-gene heterogeneous networks has been done. the predicted results from the network inference methods need to be tested to see whether they form the modules and to which corresponding biological function they are related. in this paper, the network inference methods are further developed to measure the modularity property of the disease-gene prediction results. furthermore, we also provide the method to infer the relationship between the subtypes of diseases and the modules formed by these predicted results.

inference on the phenotype-gene heterogeneous network
for the network-based inference, a candidate gene g is prioritized to be a potential disease-causing gene of the target phenotype p if one or both of the followings are satisfied:

 <dig>  the gene g is close to some disease-causing genes associated with p.

 <dig>  the gene g is close to some phenotypes which are highly similar to p.

hence one key point is to define the closeness between two nodes in the network, and this will be used to measure the similarity between the nodes based on the network topology  <cit> . currently the nearest-neighbor method considers the direct interactions information and ignores the long-range interactions. the shortest-path method considers the length of the shortest path connecting two nodes but ignores the number of short paths between them. the random walk with restart method  <cit>  combines the local and global network information to enhance the prediction performance.

another key point is the priori information known about each target phenotype, the known disease-genes and the similar phenotypes. in the phenotype-gene heterogeneous network, for each given phenotype p, its known causing genes and the similar phenotypes are represented as the nodes which link to p directly, and these nodes are termed as the adjacent nodes of the target phenotype p in the heterogeneous network. the paths between p and any other nodes have to cross this adjacency set. therefore, the prioritization can be carried out by measuring the closeness between the candidate genes  and these adjacent nodes.

in this paper, we introduced a closeness measure based on the methods of mean-hitting-time and conditional mean-hitting-time, which not only capture the global relationships within the phenotype-gene heterogeneous network, but also free to rely on any priori parameters. moreover, by studying the different relationships to different adjacent nodes, we assume that the prioritized genes can be further divided into sub-modules which may correspond to the subtypes of the disease. and the conditional mean-hitting-time can be applied to discover such disease subtypes. the present hitting-time-based method with the flowchart illustrated in figure  <dig> is called cipher-hit, as a continuation of our cipher method  <cit> .

candidate disease genes prioritization: which are the most credible?
based on the closeness measure of the phenotype-gene heterogeneous network, the candidate genes can be prioritized according to their topological similarities of the adjacent nodes. the inference is of the same spirit as the methods in  <cit> . however, some disease-causing genes are likely to be topologically similar, whereas some others will be dispersed among the heterogeneous network. as shown in figure  <dig>  for a phenotype that has many known disease genes and similar phenotypes, we probe the relationships among these adjacent nodes and suppose that if an adjacent node  has higher topological similarity with the others, then it will be a more credible reference gene or phenotype for inference of disease-causing genes. here the topological similarity between two nodes means their closeness or connectivity strength on the network, which can be defined as the mean-hitting-time of the random walk. we consider this hypothesis is reasonable since it is widely assumed that similar phenotypes may be caused by functionally close related genes  <cit> , thus if more information about protein-protein interactions, gene-phenotype associations as well as phenotype-phenotype similarities is known, higher inference accuracy in gene-phenotype relationship inference will be achieved. as a graphic illustration shown in figure  <dig>  nodes u <dig>  u <dig> and u <dig> will be the more credible references than u <dig> since they are close to each other. therefore, our cipher-hit method developed is firstly used to measure the connectivity strength between one adjacent node and the others, and then those candidate genes near the credible reference will be marked as the ones being more likely to form modules in the network.

gene sets inference for the disease subtypes
identifying subtypes of diseases such as cancer is of critical importance for predicting clinical outcomes as well as designing more-specific therapies for patients, facilitating a new era of translational medicine and personalized medicine  <cit> . the intrinsic cancer subtypes have been studied in different ways by using histology, molecular pathology, genetic mutation and gene-expression information  <cit> . the classification of human cancer has become more and more informative as the detailed molecular analysis is provided. for example, the molecular heterogeneity in tumor can be recognized according to the different patterns of the gene expression information  <cit> . interestingly, li et al. recently reported an integrative network analysis method to identify recurrent network modules that contribute to breast cancer metastasis by using a set of tumour gene microarrays  <cit> . since molecular network modules have been detected in cancer subtypes  <cit> , it is possible to use network modules to further classify breast cancer into subtypes.

it is well accepted that similar phenotypes may be caused by functionally close related genes  <cit> . an extension of this assumption would be that genes related to different subtypes are likely to form distinct protein-protein interaction modules, which is a common indicator of gene functional relationship  <cit> .

thus, our cipher-hit method is further used to identify the sub-groups of genes corresponding to the cancer subtypes. such groups of genes are called sub-modules in the network, and the main task of our method is to identify the gene sets related to different subtypes of a target disease . in cases where the heterogeneity information of a phenotype is included in its adjacent nodes, it is promising to further classify the prioritized genes based on such information. the similar phenotypes and their associated genes have also provided information for identifying the sub-modules. for example, the phenotype node representing fanconi animia has high topological similarity to the phenotype node breast cancer. recent studies demonstrate that genes fanca, fancb, fancc, fancd <dig>  fance, fancf and fancg associated with fanconi animia are closely related to the susceptibility of breast cancer  <cit> . these genes can be prioritized to be associated with breast cancer by cipher-hit successfully. in addition, by discriminating the adjacent nodes through which these genes are prioritized, they can also be marked as the sub-module corresponding to the subtype of fanconi animia related breast cancer.

thus, in this work, we develop a method to reveal the relationship between each prioritized gene and each adjacent node so that the hierarchical clustering method is applied to discover the potential subtypes of the target phenotype. these results are meaningful for further biomedical and experimental researches, since they help to focus on the genes which are likely to form the sub-modules corresponding to the potential subtypes of diseases.

RESULTS
cipher-hit: the topological closeness measure based on the mean-hitting-time
the cipher method  <cit>  and the random walk with restart method   <cit>  are the approaches which reflect the global structural information of the phenotype-gene heterogeneous network, while the parameters such as the restart rate in rwr, which are related to the performance, are required to be pre-set. in the cipher-hit method, we present a new closeness measure between two nodes based on the mean-hitting-time of the random walk on the heterogeneous network. although this measure is developed from the same mathematical background as the random walk with restart method  <cit> , it both reflects the global topological information very well and refrains from setting up a difficult-to-explain priori parameter. moreover, one extension of this measure - the conditional mean-hitting-time can be used to discover modularity characteristics on the phenotype-gene heterogeneous network and contribute to disease subtype inference.

for a random walk on the network, the hitting-time to the set of nodes b, denoted by τb, is defined as the first time when b is visited. the mean-hitting-time of a random walk starting from the node a to the set b is defined as   

where ℙa refers to the possibility that a random walk starting form node a hits the set b at a time point k, and k is the summing target ranging from  <dig> to positive infinite.

the mean-hitting-time include all the router information between the node a and set b. we define the closeness measure between node a and set b by the scaled mean-hitting-time  with the maximal value for all nodes a' on the network,   

here  can be inconveniently large in actual calculation, so we scale it to ensure the range of mht is between  <dig> and  <dig> 

furthermore, if we need a topological closeness between the node a and the set b without the influence of a given set of nodes, a, the conditional mean-hitting-time will be a natural choice. it is defined as   

where ℙa refers to the possibility that a random walk starting form node a hits the set b at a time point k, conditioning on the same random walk hits the set b before it hits the set a.

similarly, we define the scaled conditional mean-hitting-time  cmht, as the closeness measure between node a and set b, without the influence of set a,   

we also scale cmht to the range between  <dig> and  <dig> to avoid the inconvenient large  in actual calculation. both of the closeness measures defined in equation  and equation  can be computed explicitly without any preset parameters .

performance of cipher-hit in credibly predicting diseases-causing genes
in this work, we firstly apply the scaled mean-hitting-time in ranking candidate disease-causing genes based on the phenotype-gene heterogeneous network. the adjacency set of a certain node n on the network is defined as all those nodes linked to n by an edge on the network, either a 1-valued association as in the protein-protein interaction network and gene-disease association network, or a positively weighed association as in the phenotype-phenotype similarity network filtered by a threshold . for each given phenotype p having an adjacency set , we compute mht for each candidate gene g. after ranking mht from the smallest to the largest, a gene g will be prioritized as the potentially causal gene associated with phenotype p if mht <θr, where θr is the filtering threshold. the detailed setting of θr will be discussed at middle of the second to last paragraph of this subsection. the ranking information of each gene g is recorded as the ranking position rankp. for the target phenotypes p which have many nodes in the adjacency set , we introduce the modularity level through conditional mean-hitting-time as below:   

which can be used to test the connectivity strength between ui and other adjacency nodes. note that a smaller value of the conditional mean-hitting-time ) indicates a higher modularity level, namely a stronger connection between the adjacent node  and other nodes in the adjacency set . by calculating the minimum conditional mean-hitting-time, we assess the modularity level of one node p on the network with regard to its adjacency node ui as the maximum connectivity strength between other adjacency nodes u and ui. different from the concept of topological similarity between two nodes, the modularity level of one node with regard to another takes the other adjacency nodes into consideration, and serves as the measure of connectivity strength among more than two connected nodes. then we set a threshold θm to distinguish the adjacent nodes so that  which satisfies mp <θm will be marked as the one with high connectivity strength to the other adjacent nodes.

hence the adjacent nodes are divided into two parts,  and  which are defined as      

according to the definition above,  denotes the adjacent nodes u including disease-genes associated with p or phenotypes similar to p that are strongly connected with each other. for any , the random walk starting from ui will reach uj easily without passing p. this feature is illustrated in figure 2b.

next, we analyze the prioritized genes for target phenotype p. we measure the closeness between each gene to the nodes in  without the influence of the nodes in . we compute  for each gene g and then rank results from the smallest to the largest, so that we record the ranking position r'p. by comparison of rankp and rank'p for each prioritized genes, and if rankp/rank'p >  <dig>  we conclude that gene g is in association with the node p because it is close to the adjacent nodes in set , and these genes are marked as the most credible predicted results.

the performance of cipher-hit is evaluated by a genome-wide leave-one-out cross-validation. the candidate gene set is defined as all genes on the heterogeneous network. the set of validated genes are the known associated genes of the disease phenotypes. at each round of the validation, one gene associated with the target phenotype will be chosen as a validated sample, the link between the chosen gene-node and the phenotype-node is removed and the scaled mean-hitting-time from each gene-node to the target phenotype-node  is re-computed and ranked from the smallest to the largest. note that a disease gene can be associated with many phenotypes. therefore, the gene is deemed to come from different samples when the validation is carried out for different phenotypes. if a sample for validation satisfies mht <θr, it will be considered a successful prediction. the results of the leave-one-out cross validation are shown as the receiver operating characteristic  curves in figure  <dig>  where the horizontal coordinates  refer to values of θr, and the vertical coordinates  refer to the true-positive rate corresponding to θr. the validation on the disease genes in the set  produces obviously poorer performance than the validation on the disease genes in the set . this is reasonable since the genes in  are likely to be close to the other known disease genes or phenotypes similar to p. from the results shown in figure 3a, we found that the higher the modularity level a gene to the other adjacent nodes is, the higher the successful rate of the validation will be. when compared with the random walk with restarts  method  <cit> , we found that the roc curves of both rwr and cipher-hit are comparable. however, when taking into account the modularity levels, only the adjacent node u of mp <θm =  <dig>  are used for inference in cipher-hit method, the so-called modular cipher-hit can significantly improve the performance of disease gene predictions, making it possible to reach the credible prediction of disease genes .

note that though we mark the prioritized genes that are close to the adjacent node in , we do not exclude the other prioritized genes. the nodes in  are also available to form modules with other genes but they might not be exhibited because of the incompleteness of the network information. since the genes in  already exhibit the inclination to have tight relationship, we suggest the marked genes be selected for further biological investigation with high priority.

disease subtype inference by cipher-hit
the development of a reliable method to identify disease subtypes will not only enhance our understanding of disease mechanism, but also provide principles for designing a tailored diagnosis and treatment for patients. for a long time, identification of disease subtypes by phenotype associations of patients is of highly importance for assigning individual treatments in the medical community, especially in traditional chinese medicine which holds "bian-zheng-lun-zhi"  as its core concept  <cit> . inspired by such a rationale  <cit> , we further note that in the heterogeneous networks, the adjacent set of a target phenotype can be used not only to predict potential disease-causing genes, but also to reveal further structural relationships among the genes with regard to their contributions to disease phenotypes. if the prioritized genes of a query phenotype can be further grouped into several classes according to different functions, then the sub-modules in the network are expected to be distinguished to correspond to these sub-groups of genes.

thus, in the framework of cipher-hit, given a queried phenotype p, suppose its adjacent node and prioritized gene set are {u <dig>  ···, um} and {g <dig>  ···, gk}, respectively, then we define   

which measures the closeness between the gene g and the adjacent node ui without the influence of the other adjacent nodes. note that the selection of prioritized genes set {g <dig>  ···, gk} here is addressed by fitting a threshold θr in the step of disease gene prioritization. since we filter credible disease gene set by the mean-hitting-time mht, we naturally choose the threshold as the critical point of the empirical distribution function of mht for all genes on the network . then, as shown in figure 2b, the value cp will only depend on the path connecting gene g and p trough the adjacent node u <dig>  without considering the paths passing other adjacent nodes u <dig>  u <dig>  ···. after computing cp for all the adjacent nodes of p, we can get feature vectors of the prioritized genes g. by the alignment of such feature vectors of all the prioritized genes, we obtain the following matrix   

next, the classification of the prioritized genes can be done by diagonalization of the matrix c in equation  by using the hierarchical clustering method. furthermore, after matrix diagonalization, suppose the genes are divided into groups g <dig>  g <dig> ···,gl, and the adjacent nodes are divided into , then it is promising to analyze the subtypes of the phenotype p based on such divisions. and the resulted sub-groups of disease genes are likely to be related to the functional units of disease subtypes.

finally, we statistically analyze the subgroups of genes to evaluate whether they are separable in terms of network topology. we calculate the mean-hitting-time between pairs of predicted disease-causing genes, either within the same subgroup or between different subgroups, to assess the topological similarity. the fisher's exact test  <cit>  is employed to access whether gene pairs within the same subgroup are more topologically similar than gene pairs in separate subgroups.

a case study on breast cancer subtype detection
breast cancer is known to be a carcinoma with highly heterogeneous  <cit>  and its heterogeneity is more complicate than the results suggested by histopathological analysis alone  <cit> , so it became necessary to find more molecular evidence to distinguish breast cancer subtypes. therefore, we take "breast cancer" as a typical case to evaluate the performance of cipher-hit for detection of disease subtypes.

as shown in figure 4a, the credible disease genes for breast cancer predicted by cipher-hit were filtered by the critical point of threshold θr =  <dig>  and resulted in a total of  <dig> credibly prioritized genes. interestingly, by classification of the adjacent vectors described above, we found that it is worthwhile to note that  <dig> of the prioritized genes of breast cancer can be divided into two groups . the group containing the members of the fanconi anemia gene family are tightly connected to the phenotypes fanconi anemia , ataxia telangiectasia , breast cancer  <dig> gene , xeroderma pigmentosum  and the disease gene brca <dig>  another group is tightly related to the disease genes brip <dig>  brca <dig>  nbn and rad <dig>  brca <dig> is shared by both groups. in addition, the adjacent nodes of breast cancer are divided into two parts, each of which leads to a sub-group of genes representing a subtype of breast cancer. the two subtypes with genes obtained by the predictions of cipher-hit not only have significant difference in topological features by fisher's exact test , but also yield agreements with the evidence reported by recent studies  <cit> . for example, the genes rad <dig> and mre11a in one of the predicted sub-groups are reported to form a protein complex related to breast cancer  <cit> . moreover, genes in the other predicted sub-group consist of fanca, fancb, fancc, fancd <dig>  fance, fancf and fancg, which belong to the fanconi anemia gene family, have been shown to be risk breast cancer susceptibility genes and contribute significantly to breast cancer predisposition  <cit> . the importance of genes involving in this subtype of breast cancer is also supported by recent studies. for example, the polymorphisms of cyp19a <dig>  are closely related to the status and expression levels of estrogen receptor   <cit> , her2/neu  <cit>  as well as progesterone  <cit> . therefore, we suggest that the subtypes predicted by our method may serve as important genetic determinants that can influence the development of the well-known subtypes of breast cancer such as er positive/negative, her <dig> positive/negative, or progesterone receptor positive/negative  <cit> .

disease subtypes
*: we assess the modularity level of the predicted disease subtypes by comparing topological similarity of gene pairs within each subgroup to gene pairs between the two subgroups.

#: the p value of disease subgroup  <dig>  and the p value of disease subgroup  <dig>  are calculated using the fisher's exact test.

thus, the case study of breast cancer shown in figure  <dig> provides evidence that the connectivity features of the phenotype-gene heterogeneous network can be used to distinguish the molecular bases related to different disease subtypes and lead to novel findings. and the cipher-hit method could serve as an important complementarity to current approaches for identification of cancer subtypes. if the prioritized genes of a queried phenotype are further divided into sub-groups which are related to subtypes of the disease, then we call each sub-group of genes as the susceptible modules of disease subtypes.

from the above example, it can be seen that the polymorphism of the cancer is related to a group of genes, instead of a single gene. we propose to characterize the subtypes of a disease by distinguishing the associated gene groups. if the adjacent nodes of a given phenotype exhibit a genetic or phenotypic difference, namely the prioritized genes can be divided into several sub-groups according to their relations to the adjacent nodes, it is likely to reveal subtypes according to a sub-division. our work demonstrates that the disease subtype analysis can be carried out in the network context and benefit from the integration of phenotype and gene heterogeneous information. we also show that the modularity-based method, cipher-hit, is a promising way to discover the subtype-associated genes based on the heterogeneous network structure. based on the prioritization information on the gene sets, the results will allow for further clinical and experimental researches.

for the limitations of the present work, the cipher-hit method currently only restricts on the genetic level, makes use of relatively simple data resources, and does not consider the quantitative analysis for gene expressions. as one of the future research directions, more efforts are still need to be made to evaluate the performance our method on different data, especially include quantitative information such as microarray and proteomics data for discovering disease mechanism in the gene expression level or protein level. an extension of our method to the systematic identification of disease subtypes also needs to be developed. moreover, we believe that the method can also be easily generalized to enable the credible prediction of drug targets and detect the pleiotropic effects of drugs in our drugcipher framework  <cit>  if we combine drug targets information into the phenotype-gene heterogeneous network.

CONCLUSIONS
in summary, in this work, we introduce a concept of modularity level and propose a cipher-hit method to use the mean-hitting-time to measure global closeness between nodes of the heterogeneous network that consists of both genes and phenotypes. this measure has solid mathematics foundations and is easy to calculate. based on this measure, we proposed a method to select high confident neighbors of a phenotype and detect gene modules that are highly connected to these high confident neighbors. therefore the modularity of prioritized genes can be revealed, which may provide more mechanistic insights to the phenotype-genotype association. we also demonstrate that the performance of disease gene predictions is improved significantly by combining the modularity measure into the network inference, suggesting modularity is one of key features for network-based credible prioritization of candidate disease genes. moreover, by detecting the sub-modules in the heterogeneous network, we revealed the potentially genetic and phenotypic properties of cancer subtypes. we believe this method can also be explored to predict biomarkers associated with disease subtypes in the gene expression and protein levels, as well as detect the pleiotropic drug actions in the future.

materials and methods
dataset and the heterogeneous network
we used the following three data sets to form the three parts, namely the phenotype-phenotype similarity network, protein-protein interaction network and gene-disease association network, of the phenotype-gene heterogeneous network based on which the prediction was carried out.

• the human protein reference database   <cit>  was adopted to construct the protein-protein interaction network. the largest component of the hprd protein-protein interaction network contains  <dig> edges and  <dig> vertices.

• the phenotype similarity came from the results calculated by van driel et al.  <cit> . the phenotype similarity network contains  <dig> phenotypes.

• the associations between the phenotypes and genes were from the omim  records as described in precious studies  <cit> . the edge weights of this phenotype-gene sub-network will be defined in equation .

the heterogeneous network was described by the weight matrix. we constructed it by merging the weight matrices of the sub-networks into one matrix. let wg denote the weight matrix of the hprd network. for any two genes g <dig> and g <dig>  if there was a corresponding protein-protein interaction recorded in the hprd database, then wg =  <dig>  otherwise wg =  <dig> 

the phenotype similarities were used as the description of the diseases relations. the same data as previous works  <cit>  were used, where the phenotype similarity data were calculated by van driel et al.  <cit> . since the high similarities were only present between parts of phenotype pairs, we set a threshold to filter out very low similarity values. let wp denote the weight matrix of the phenotype-phenotype similarity network. if the similarity value between two phenotypes p <dig> and p <dig> was larger than the threshold  <dig> , then the weight wp took this similarity value, otherwise wp =  <dig> 

the phenotype-gene associations were taken from the same data set as  <cit> . if there was an association between phenotype p and gene g, then we specified the weight of the corresponding edge as   

by which we can achieve that for each pair of associated gene and phenotype , the average possibility of "walking" onto a different sub-network at the point g and p in the random walk process will equal  <dig> .

thus, the weight matrix of the heterogeneous network was constructed as   

where  refers to the transpose of wa.

we defined the random walk according to the weight matrix described as equation  and carried out the network inference on it.

the mean-hitting-time and conditional mean-hitting-time in cipher-hit
in the previous random walk with restart method  <cit> , the stationary distribution is used to define closeness between two nodes on a network. here we define the topological properties on the phenotype-gene heterogeneous network in the same mathematical background using the mean-hitting-time of the random walk. this definition is more suitable in solving the problem of both disease-causing gene inference and disease subtype inference, because by adopting this measure, we no longer have to choose the priori parameter required in the former method , and this measure leads us to a natural way of discovering modularity characteristics on the heterogeneous network. the math formula expressions below are mainly adopted from  <cit> .

the random walk on the heterogeneous network was constructed by specifying its transition probability matrix p based on the weighted matrix w in equation .   

the mean-hitting-time from other nodes to a given node p could be obtained by solving the following equation    

where i refers to the identity matrix, and x refers to the vth component of vector x.

the non-negative minimum solution  gave the mean-hitting-time from all other nodes, both the gene-nodes and phenotype-nodes, to the given phenotype-node p. furthermore, the conditional mean-hitting-time  could be computed by solving   

where ℙv, termed as the harmonic potential in the markov process theory, is the probability that a random walk starting from v reached p before b. the harmonic potential could also be obtained from the minimum non-negative solution of   

the theoretical proof of equations , , and  is referred to  <cit> .

authors' contributions
sl directed the research and discovered the relationship between the computational results and the biological evidence. xy and sl designed the whole methodology. xy and hh implemented the algorithm and the computation framework. yl provided constructive suggestions on this work. all the authors have read and agreed to the manuscript.

