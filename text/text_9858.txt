BACKGROUND
the ability of a cell to change shape is crucial for the proper function of many cellular processes, including cell migration. for example, cells of the immune system move in response to pathogen infections by crawling, which involves cycles of protrusions and contractions that deform the entire cell shape  <cit> . traditionally, cell motility has been characterized by a number of different parameters  <cit> . some, such as velocity, directional persistence and chemotactic index, are determined by the position of the centroid of the cell. others, including perimeter, area, roundness and body orientation, describe cellular morphology as the cell migrates. these parameters primarily provide global information about motility-induced cell shape changes. though they can be used to distinguish between strains, they may be insufficient to distinguish phenotypes based on pseudopodial protrusions and retractions, which typify amoeboid motility.

recently, there has been much interest in developing means for processing microscopic images of motile cells and acquiring local morphological information automatically or semi-automatically  <cit> . here we describe a series of automated methods used to characterize both local morphological changes and statistical features during amoeboid locomotion based on the skeleton of a planar shape  <cit> . skeletonization, also known as the medial axis transform, is a technique in image processing used to reduce a binary shape into a series of connected lines - the skeleton - that roughly maintains the form of the shape . this thin-line representation of shape has attracted considerable attention  <cit> . for example, skeletons have been used to measure the lengths and numbers of junctions of tubule complexes in in-vitro angiogenesis assays and to analyze neuronal structures  <cit> . part of the technique's attraction is that skeletons of elongated shape patterns, which are frequently observed in many organisms and biological structures, appear to be close to those perceived by humans  <cit> . furthermore, the skeleton facilitates shape analysis and uses less data than the original shape. though skeletonization has long been used to analyze images in cell biology  <cit> , it has not been applied to track dynamic information about cellular shape.

we demonstrate that the skeleton can be used to identify pseudopods of moving cells in microscopic images. moreover, the time-varying evolution of the skeleton can be used to capture the dynamic nature of the pseudopodial protrusions and retractions. we emphasize that the primary goal of this article is not to suggest mechanisms of directed cell motility, but to provide a useful computational tool to analyze amoeboid motility behavior, thus to facilitate the understanding of specific mechanisms in different studies.

RESULTS
our method consists of a number of separate steps which we describe here individually.

digital image processing
different imaging techniques are used to generate movies of motile cells: fluorescent, phase-contrast, and differential interference contrast . before further image analysis, two steps are performed to process the original cell movies. the first step is segmentation, in which cell areas are extracted from their background and cell shapes in each frame are acquired. based on the image features, different algorithms have been designed specifically for the three microscopy techniques mentioned . the second step is boundary smoothing, aimed at removing high-frequency spatial fluctuations of the cell boundary caused by imaging noise. uniform quadratic b-spline curves, which are smooth curves with continuous first order derivatives and are widely applied in computer aided geometric design, are used to fit cell boundaries  <cit> . the fitting algorithm is based on the shape-space model and recursive least-square estimations  <cit>  .

skeletonization
the skeleton of a shape is defined based on the concept of maximal ball in the context of 2d euclidean space; straightforward extensions are possible in 3d space  <cit> . a ball that is inside a closed boundary curve defined by a planar shape is said to be maximal if it cannot be contained in any other larger ball that is also wholly included in the same curve. the skeleton of a planar shape is defined as the medial axis of the shape, which is the locus of centers of maximal balls in that shape. note that wherever there is a protrusion from the cell membrane, at least one branch occurs in the skeleton .

in practice, because shapes are acquired from digital images, computed skeletons are only approximations of the continuous medial axis. multiple algorithms that determine the skeleton of a shape defined by a discretized curve have been proposed  <cit> . the medial axis described earlier can be determined based on distance maps, "grassfire" simulations, or voronoi diagrams. in the distance map, a value is assigned to each point inside the shape corresponding to the distance from this point to the boundary  <cit> . the skeleton points are defined as the ridges in the constructed contour plot. in grassfire simulations, each point on the boundary of the shape serves as the source of a wave that propagates inward with constant speed  <cit> . the skeleton is determined as the singular points generated as the waves collide. these two classes of algorithms are considered to provide equivalent results. finally, voronoi diagram-based algorithms use the fact that the skeleton of a shape with discrete boundary points can be approximated by a sub-graph of the voronoi diagram  <cit> . the computational load for this class of algorithms is usually greater. without further processing, skeletons generated by these algorithms are quite sensitive to shape variations since small perturbations in the boundary curve can result in significant changes to the medial axis. to acquire a more meaningful representation of the shape, boundary smoothing  and branch pruning  are usually necessary.

another class of algorithms that create a skeletons which look similar to, but do not necessarily correspond to the medial axis, uses an approach called thinning. in these algorithms, the boundary pixels of a region are progressively peeled away without changing the topology of the region, until only a skeletal structure remains  <cit> . although this method is preferred in some applications, as it is more robust to boundary variations, cell shape information of interest could be lost. for this reason, we use medial axis skeletons and acquire them using the function bwmorph in the matlab image processing toolbox, the underlying algorithm of which is grassfire simulation .

branch pruning
boundary smoothing helps to eliminate spurious branches that arise from noisy images . nevertheless, further branch pruning is necessary to map each pseudopod perceived by human eyes to exactly one branch in the skeleton. as the name implies, branch pruning helps to minimize the number of distinct elements in the skeleton description of the cell. many different pruning methods have been developed  <cit> . all these techniques work by defining a metric of significance to skeleton points. in the case of motility-induced cell shape changes, two criteria are designed to prune spurious branches .

first, short skeleton branches correspond to relatively small variations in shape; conversely, long branches arise from more significant shape features. thus, the skeleton is pruned by removing small branches. the outer branches of a skeleton are defined as the line segments with at least one terminal that is not connected to any other part of the skeleton. the point linking an outer branch with the inner part of the skeleton is denoted as the root of this branch . with a preset length threshold of pthreshold pixels and a length ratio r >  <dig> , each outer branch shorter than pthreshold is considered:

 <dig>  if the branch is independent; that is, it does not share a root with any other outer branch, then it is removed from the skeleton .

 <dig>  otherwise, if the branch shares a root with another branch, then their respective lengths are compared:

▪ if either the length of the longer branch is less than r times of the length of the shorter one, or the longer one itself is shorter than pthreshold, then the two branches are combined into a single one arising from the root .

▪ if the longer branch is longer than pthreshold and longer than r times of the shorter one, then the shorter branch is removed and the longer one retained.

if more than two outer branches share a common root, they are compared and if necessary, combined sequentially. to combine two branches, the point at the average position of the two terminals other than the root is identified and linked to the root. by doing this, not only is shortening of the branches by simply removing the two short branches avoided, but it also guarantees that the combined branch represents the approximate center line of a pseudopod .

 <dig> these values are chosen to minimize the discrepancy between the automated method and manual judgments. for the branch pruning algorithm, representative cells with different sizes and shapes are selected, and their pseudopods during movement are identified by experienced cell biologists. for backward tracking algorithm, manual tracking results from representative movies are independently acquired. different parameter values are then tested in algorithms, and the best combinations are selected as given.

2the "length of the cell body" is computed as the average body length among all the cells from the same experiment. thus, it is a constant when analyzing movies from the same experiment, but may vary for different experiments.

3this parameter needs to be set empirically according to specific frame rate used during imaging; the value here was chosen for movies sampled at  <dig> s/frame. for all other parameters, the values given here are applied for all our movies, which include different cell types, frame rate, and magnification of imaging.

the second criterion for pruning is based on the local curvature of the boundary curve, which can be determined by the reciprocal of the radius of the osculating circle  <cit> . typically, each protrusion or retraction occurs near one point where the local curvature is relatively high compared to other parts of the boundary . because the terminal point of an outer branch is the center of the circle associated with this boundary point, the distance from the terminal point to the boundary gives a measure of the local curvature. when this distance is big, the boundary has a small curvature locally. thus, the corresponding branch is unlikely to point to a protruding or retracting region of the cell . to eliminate these branches, a distance threshold  is set and all branches with terminals  farther away from the cell membrane are removed.

detecting pseudopodial activity
as cells move, their shapes deform leading to temporal changes in the corresponding skeletons . we seek to describe this dynamic process and to establish an algorithm to determine whether changes in cell shape correspond to protrusions or retractions. shape differences refer to the regions where the shape changes during motility from one frame to the next  <cit> . they can be "positive" or "negative" flow, depending on whether the areas are growing or shrinking. however, owing to image noise and random perturbations of membrane shape, differences are not always well defined. thus, shape differences are combined with skeletons to detect protrusion and retraction activities.

the process is initiated by segmenting successive images of a moving cell . assume that in and in+ <dig> are the binary segmentations at the nth and st frames respectively, where the pixels within the cell are set to  <dig> and those of the background to  <dig>  denote the pruned skeletons in frames n and  by sn and sn+ <dig> respectively . let d be the 2d space where all the image frames of a movie are defined, and p be a given pixel in d. define by  

and  

the expanding and retracting regions of the cell, respectively, from the nth to the st frame . note that branches of the skeleton from the st frame extend out from their root into  and those from the nth frame extend out from their root into  .

a protrusion is defined as a region in  that includes a branch of sn+ <dig> . the starting position of a protrusion on the membrane in frame n is set by the intersection of sn+ <dig> and the boundary of in, and the length of protrusion between frames n and  is given by the length of branch residing in . similarly, a retraction is defined as a region in  that includes a branch of sn . the starting position on the membrane in frame n and the contraction length are defined in the same way.

there may be situations where a skeleton branch does not touch the cell boundary. in these cases, we extend the branch to the membrane and compute the extended length as the step size of the activity.

if the cell is moving in response to an external cue, for example during chemotaxis, we are also interested in how the protrusion or retraction is aligned to the chemoattractant gradient. to compute this, the 0° line is defined as the ray starting from centroid of the cell along which the chemoattractant concentration increases the fastest. the angle of an activity is calculated as the angle from the previously defined 0° line to the line linking the cell centroid and the starting point of this activity on the membrane .

the time of occurrences, the spatial positions in the starting and ending frames, and the angles from the cell center are recorded for all the detected protrusions and retractions. these data are used to describe the dynamics of these activities.

backward tracking for pseudopodia lineage classification
it has been argued that different cell strains exhibit dissimilar motility and morphological changes because they extend, retract or split pseudopods in different ways  <cit> . to analyze the changing patterns of pseudopodia, the lineage of all detected protrusions and retractions needs to be determined. to this end, we develop an automated tracking algorithm that clusters activities into distinct groups, each representing the protruding and retracting history of a single pseudopod.

the basic idea of the algorithm is to model the pseudopod dynamics using a second-order autoregressive process  <cit> . more specifically, the following assumptions are made:

 <dig>  the changes in spatial position and angle in activities of the same pseudopod from one frame to the next are much smaller than the distance between two different pseudopods;

 <dig>  when either the position or angle of the activity changes, the rate of change tends to be constant.

 <dig>  if no other protrusion or retraction is observed in an interval of time after the last recorded activity for an existing pseudopod, a pseudopod has terminated. this takes into account the fact that pseudopods have limited lifetimes.

because pseudopods are believed to split frequently during movement, they are tracked backwards in time  <cit> . it is necessary to decide whether each protrusion or retraction detected at a given time point is part of an ongoing pseudopod or of a new pseudopod. to achieve this, a weighted distance metric between activities that takes into account differences in the spatial location , the angle , and the time  is defined. more specifically, suppose that two activities p <dig> =  and p <dig> = , with t2>t <dig> have been identified and it has been deemed that p <dig> is associated with activity p <dig> = , with t3>t <dig>  the distance score between p <dig> and p <dig> is computed as  

the terms Δ <dig>  , , ) and Δ <dig>  are the spatial and angular distances, respectively, computed from the equation based on the first- and second-order differences . the values β and 1-β weigh these two distances, and r is the radius of the cell. the term for the time difference inside the square root sign considers that the probability of two activities from the same pseudopod decreases with the time distance between them. values used for β and r are given in table  <dig>  after this distance score is computed from each unassigned activity to all the assigned ones up to t seconds away, the scores are sorted and the minimal one selected. if it is under a given threshold, distthreshold, the activities are deemed to come from the same pseudopod; otherwise, the unassigned activity is labeled as the latest detected activity of a new pseudopod. finally, a split is recorded when two activities find the same earlier activity as their common "ancestor" during backward tracking.

using the methods described above, we calculate a number of quantities for individual pseudopods and single cells . computational results for these parameters and the comparisons between different cell strains are presented in detail below.

correlation analysis
fluorescence microscopy can be used to obtain a quantitative description of the cellular localization of molecular species that are believed to contribute to pseudopod dynamics. the spatial correlation of these data with the locations of pseudopod activities can provide information as to how different proteins contribute to cell motility.

for a given cell during a given period of time, an activity variable, a, is defined as the length of the activity if an activity is detected at frame number k, representing time, and angle θ of the protrusion or retraction activity on the membrane. if no activity is detected, then a =  <dig>  an intensity variable, i, is defined corresponding to the relative intensity value at angle θ and frame k on the membrane. the cross-correlation function between these two signals is given by   

where , , ⟨g⟩k, θ represents averaging over time and angles, and ⟨g⟩θ represents averaging over angles only.

note that the above definitions are invalid if multiple membrane points correspond to the same θ. the situation is usually rare for chemotaxing dictyostelium cells; in our movies no cell exhibited such a shape in any frame. moreover, even if this situation were present, it would not influence the pseudopod detection and tracking method previously described, since these membrane points are parts of different branches of the skeleton, and each activity is defined not only by the angle from the center, but also by the spatial location . thus, if they represent different pseudopodia activities, they will be identified and analyzed separately.

assuming that the cell membrane is sampled every Δθ degrees, measuring pseudopodial activity and intensity variables in a movie of n frames, the cross-correlation computed from equation  <dig> is a matrix of the size  × , where each row corresponds to an angle value from - /Δθ° to 180/Δθ°, and each column corresponds to a time shifting length from - to n- <dig> frames. a high absolute value at  means that a linear relationship, either positive or negative, exists between the activities and the intensities located  away. this correlation has also been used to analyze the ordered patterns of spontaneous cell migration  <cit> .

illustrating the method
to demonstrate the ability of our methods to characterize cell shape changes during amoeboid motility we implement the steps described above to images of chemotaxing dictyostelium cells. developed ax <dig> dictyostelium cells, an axenic laboratory strain, are placed in a shallow gradient of camp, and dic images are acquired at  <dig> s/frame . in this representative cell,  <dig> pseudopods are detected. most  are short-lived, lasting no more than  <dig> s; the remaining long-lived pseudopods last at least  <dig> s and account for over 80% of the total detected activities.

from our analysis, it is clear that the behaviors of individual long-lived pseudopods vary dramatically . pseudopods emerge throughout the membrane; furthermore, the angle drifting of pseudopods is also noticeable . while some  long-lived pseudopods remain near the front or rear of the cell, most  drift away from the front for at least half their lifetime. when a pseudopod shifts from the front to the side or back of the cell, it usually transitions from protrusion to retraction. the size of pseudopods also varies considerably; moreover, the lengths of individual activities from the same pseudopods changes over time .

despite huge differences in positions and sizes among the long-lived pseudopods, their protrusion/retraction state dynamics fall into three main activity patterns: consistent protrusions, consistent retractions, or alternating periods of protrusions and retractions . the average state persistence for this cell is  <dig> , which means that pseudopods tends either to protrude or to retract during most of their lifetime. we observed that whether a pseudopod extends or retracts depends on the angle of the pseudopod relative to the chemoattractant gradient. pseudopods near the front have higher probability of maintaining fast growth . this probability decreases if the pseudopod drifts away from the front . similarly, the probability of retraction is low at the front of the cell, but increases as the pseudopod approached the back . these observations are consistent with previous results  <cit> .

it has been reported that in dictyostelium cells chemotaxing in shallow gradients or moving in the absence of external cues, newly generated protrusions usually split from existing pseudopods  <cit> . using our method, both the origin of a pseudopod and the number of splits during its lifetime are acquired automatically . we find that 74% of all the pseudopods are generated from splitting at an average rate of once every  <dig>  seconds. for long-lived pseudopods, 78% are generated from splitting, with an average rate of once every  <dig>  seconds.

previously published results in quantifying pseudopod production rates have shown significant differences. using manual identification, on average, a new pseudopod is produced every  <dig> s for ax <dig> cells moving in shallow gradient  <cit> . using automated methods based on local curvatures of sampled boundaries, this number drops to around  <dig> s for ax <dig> cells in shallow gradient and  <dig> s in the absence of chemoattractant  <cit> . although the experimental conditions might play a role, it is possible that this discrepancy comes from the different ways of identifying pseudopods. to investigate this, the pseudopodia dynamics of the same ax <dig> cell at different levels are examined . first, the smallest number of pseudopods that cover no less than 50% of all protrusion and retraction activities is selected. using this criterion, only seven long-lasting pseudopods are identified, of which five contained significant protrusion processes. these pseudopods give a production rate of ~ <dig> s per protruding pseudopod, a number similar to that obtained using manual identification  <cit> . when the activity percentage level is set to 60%, the number of pseudopods detected with significant protrusions increases to eight. these have an average interval of ~ <dig> s.

statistics for phenotype characterization
to show how our methods can be used to distinguish different cell strains, movies from two dictyostelium strains: ax <dig> and ax3:tsua mutant are analyzed. ax3:tsua strain, in which the dictyostelium homolog of the fused kinase tsua is knocked out from the parental line ax <dig>  is constructed as previously described  <cit> . undeveloped cells from both strains are placed in the gradient of folic acid released from a micropipette containing  <dig> m folic acid. images are captured using a 60× objective at  <dig> s/frame with a spatial resolution of  <dig>  μm/pixel. the pseudopodial behaviors of individual cells are computed and compared between the two strains . ax3:tsua cells show several chemotaxis defects when responding to folic acid. one of the most significant  defect is the ability to split pseudopods: the ratio of newly generated pseudopods arising from splits decreases 27% and the splitting rate decreases 36%. the other discrepancy is the state persistence. the protrusion persistence decreases 15% and the overall state persistence decreases 10% in ax3:tsua cells. these data suggest that these cells have difficulty generating consistent protrusions. the net speed of pseudopods, which decreases 27%, can also be related to the lower protrusion persistence: pseudopods tend to wander around instead of pulling out the membrane far away.

ax3:tsua
the chemotactic behaviors of developed dictyostelium ax <dig> cells, an axenic laboratory strain, and ax2:dynhp cells, in which dynacortin, an actin cross-linking protein, is depleted by rnai, are also compared . the mutant strain is constructed as previously described  <cit> . cells are placed in the gradient of camp released from a micropipette containing  <dig> μm camp. images are captured using a 40× objective at  <dig> s/frame with spatial resolution of  <dig>  μm/pixel. the ax2:dynhp cells do not show obvious splitting deficiency. the state persistence is also comparable to that of wild type cells. however, this strain produces pseudopods that protrude and retract more slowly: the protrusion speed decreases 39%  and the retraction speed decreases 24% . the net speed of pseudopods decreases accordingly .

to contrast the efficiency of movement during chemotaxis, it is useful to look at the angle distribution of pseudopods. a histogram of protrusion angles for each of the four strains described above is plotted, and a gaussian curve to characterize the distribution is fitted . the mean angle of activities indicates whether cells are able to sense the external cues and generate different responses at the front and the back, while the variance measures how efficiently the activities are produced to enable the directed movement of the cell body. the data reveal that vegetative ax3:tsua cells do not align their protrusions with the chemoattractant gradient. on the other hand, developed ax2:dynhp cells orient their protrusions up the gradient, but not as efficiently as their respective control cells.

correlation between pseudopods and molecular localizations
to investigate the molecular drivers of pseudopod formation, the correlation between the time and location of pseudopod activities with fluorescently-labeled proteins is calculated. an ax3-based cell strain is created where myosin-ii is tagged using gfp, and, simultaneously, dynacortin is tagged using mcherry. at the same time, both endogenous expressions are confirmed to be depleted completely. it is commonly accepted that myosin-ii enriched at the posterior during chemotaxis, generating contractile force at the back and squeezing the cell body forward  <cit> . on the other hand, dynacortin is normally concentrated at the leading edge where it is thought to cooperate with actin to influence cortical viscoelasticity  <cit> . in our study, developed cells are placed in a chemoattractant gradient, and images of chemotaxing cells are obtained using a dual-emission microscope . the respective fluorescent concentrations are detected around the cellular membrane , and pseudopods are identified and classified as to whether they are expanding or contracting . the mcherry-dynacortin is found consistently at the front of the cell, aligned with the chemoattractant gradient. in contrast, gfp-myosin-ii is found to be mostly at the side.

to determine how these protein localizations aligned with the pseudopodial activities, the cross-correlation functions  between the two fluorescent intensities and the protrusion or retraction activities are computed . in nearly all cells displaying good mcherry expressions, peaks in dynacortin concentration occurred at the same time and location as protrusions. on the other hand, retractions and regions of high dynacortin concentration are highly negatively correlated. to probe further these correlations we compute the correlation coefficient between dynacortin fluorescence and activity length to be  <dig>  with 99% confidence interval of  <dig>  to  <dig>  . on the other hand, when compared to the fluorescence at the other side of the cell  the correlation is negative: - <dig>  with 99% confidence interval of - <dig>  to - <dig>  . when measured cell to cell, all cells  have positive correlations between the length of the activity and fluorescence at the location of the activity, and negative correlation with the activity  . the average mcherry intensity at the site of protrusions is significantly higher than at retractions .

a similar analysis of gfp-myosin-ii reveals that myosin-ii concentrations along the cell membrane are negatively correlated with protrusion activities . however, the relationship between myosin-ii and retractions is more complex. in some cases , myosin-ii and retractions are highly correlated. however, in most cases , two peaks of high myosin-ii correlation appear almost symmetrically with respect to the 0° line. in the remaining cells, irregular patterns are observed, not showing obvious maxima or minima. the average gfp-myosin-ii is significantly higher 90° away from a retraction than at the actual retraction  . thus, the relationship between myosin-ii concentration and retraction activities may not be simply described as positively or negatively correlated; instead, factors other than myosin-ii contraction, such as cortical tension, may contribute to pseudopod retraction  <cit> . to probe this connection further the length changes for all the detected protrusion or retraction activities are plotted as a function of the local fluorescence intensities . a range of intensities where the length of the protrusions decreases almost linearly with increasing gfp-myosin-ii intensity is observed. on the other hand, the lengths of retractions increased with myosin-ii intensity, but with a much smaller slope . together, these data suggest that myosin-ii's role is not just to create retractions, but to suppress lateral protrusions. interestingly, although the protrusion speed in ax2:dynhp cells is considerably smaller than that of control cells , the localized presence of mcherry-dynacortin did not contribute greatly to the length of the protrusion, but the retraction length did decrease with increasing of dynacortin concentration on the membrane.

discussion
amoeboid motility is a complex cellular process driven by highly-organized cytoskeletal dynamics involving alternating cycles of pseudopodial protrusions and retractions.

in some cases, the subtle differences in motility between different strains may only be revealed by comparison of pseudopod dynamics. however, because of the highly stochastic fluctuations in the behavior of pseudopods, large data sets may be necessary, making manual detection, identification and quantification impractical. in this study we presented an automated method based on skeletonization that detects and characterizes pseudopodial behavior of cells. these algorithms have been illustrated on movies of chemotactic dictyostelium cells.

several methods for detecting pseudopods automatically or semi-automatically in microscopic cell movies have been proposed previously. in the 3d dynamic image analysis system , pseudopods are identified based on manual identification of the "nonparticulate" cytoplasm using dic images  <cit> . in addition to being completely automatic, our proposed method has the advantage that only shape information is needed, thus allowing one to apply this to fluorescent images, making correlation studies like those of figure  <dig> possible. moreover, though all of our examples are illustrated in 2d images, the skeletonization technique can be easily expanded to 3d shapes. other applications for 3d skeletons have been proposed  <cit> .

pseudopodial activities have also been identified by approximating the local curvature of the boundary using a closed polygon formed from a chain of nodes  <cit> . this form of detection may depend on the magnification, image quality, as well as sampling density. in contrast, the skeletonization technique uses topological and geometrical information from the whole shape, and takes into account not only the local curvature, but also its relationship to the complete path of the membrane, thus allowing great flexibility in applications.

related research, based on level set methods, tracks the evolution of virtual markers to determine the spatial and temporal dynamics of a region of interest on the cell membrane  <cit> . in general, this method requires high resolution imaging in both space and time to deliver topologically consistent solutions. in contrast, our method does not need special boundary markers and can be applied to a relatively broader range of resolutions.

for accurate pseudopod detection, the time resolution of the movies should not be too low, so that a considerable part of the cell body overlaps from frame to frame. the valid range should be decided by the size and speed of the specific cell types of interest. in our case, cells move at ~ <dig> μm/min, and the average length of the cell is  <dig> μm. the minimal frame rate we use is  <dig> s/frame, which is equivalent to a distance of ~1/ <dig> of their body length between successive frames. at the same time, the spatial resolution must be selected so that desired pseudopodia activities can be identified at least by eye. the spatial resolution for most of our movies is either ~ <dig>  μm/pixel when using a 40× objective, or ~ <dig>  μm/pixel when using a 60× objective. the lower the resolution, the more shape features are lost during imaging, and fewer pseudopodial activities, especially subtle ones, can be captured. this will cause a general problem for all detection method, including manual counting. other parameters in table  <dig> are chosen to minimize the discrepancy between results obtained using the automated method and manual observations of pseudopodial activity. these work well with different cell strains, frame rates and magnifications. however, when tracking significantly different cell movements, other parameters may need to be selected.

one possible drawback of relying on topological information is that skeletonization sometimes cannot detect protrusions with bleb-like structures, since the local curvature at these structures is relatively low compared to typical activities. this problem may also exist in other automated methods based on local curvature calculations. however, in most of our studies, bleb-like structures occur rarely and do not influence the results statistically. for example, there is only one bleb in  <dig> s in the movie  at time  <dig> s, which seems to be a short-lived pseudopod but is missed by the algorithm. other than the blebs, we do not find shape structures that consistently cause the method to fail in the movies of dictyostelium cells we analyzed. attempts have been made to characterize the extension of pseudopodia by amoeboid cells in the absence of external cues as well as in shallow gradient of chemoattractant, based on the assumption that spatial differences in chemoattractant receptor occupancy gives rise to biases in the direction of pseudopod extensions  <cit> .

however, other studies suggest that the bias might come from pseudopod retractions  <cit> . here, we view pseudopodial behavior as a dynamic process that includes both protrusions and retractions, and modeled this dynamic behavior using an autoregressive model - in which the state at a given time depends on the historical activities - for each pseudopod. our results are consistent with models that suggest that, for a dictyostelium control cell moving in a shallow gradient, a considerable fraction of pseudopods experience both protrusion and retraction, and they tend to retract back when shifting far away from the right direction . at the same time, the consistent protruding pseudopods may play a more important role in leading the movement of the cell centroid compared to other pseudopods .

published results show a discrepancy regarding the production rate of pseudopods, with manual counting reporting less pseudopods than methods that record pseudopods automatically. our data illustrates that these differences can be attributed to a counting bias. in manual techniques, only the most prominent and persistent protruding activities are identified as pseudopods, whereas automatic methods are able to detect smaller protrusions and retractions. thus, our method can be applied to quantify both the dominant deformations as well as subtler dynamic perturbations of shape. our results suggest a higher ratio of "de novo" pseudopods relative to those from splitting during chemotaxis in shallow gradients, compared to previous published results . we conjecture that this also comes from the fact that not all meaningful boundary activities are captured in these analyses. we note that for cells chemotaxing to a micropipette, the fraction of pseudopods arising from splitting is even lower .

by using the cross correlation method to analyze the molecular drivers of protrusions and retractions, we find that dynacortin, as a marker of f-actin, colocalizes with protrusion activities, consistent with the notion that actin polymerization drives protrusions. on the other hand, myosin-ii is depleted from the front of the cells, and is enriched at the sides of cells. as myosin-ii contributes ~20-30% to cortical viscoelasticity and to cortical tension  <cit> , the localized myosin-ii modulated increase in cortical tension at the side of cells may thus help to inhibit lateral pseudopods, as previously suggested  <cit> . this argues that myosin-ii has a substantial role in enabling of a polarized morphology seen in cells.

CONCLUSIONS
in this article we propose an automated method to characterize cell shape changes during amoeboid motility. based on the skeletonization technique, this method makes full use of both the global and local information of cell shape to detect and track pseudopodial protrusions and retractions, and correlates them with molecular localizations. using the proposed method, the pseudopodial behavior for single cells can be described, the discrepancies among different strains can be disclosed, and the distinct roles of molecules in driving membrane deformation can be revealed. thus, it provides a powerful tool to investigate amoeboid motility.

authors' contributions
yx designed and implemented the algorithms. ck and jfk performed experiments under the guidance of dnr and pnd, who provided the experimental materials and platforms, participated in discussions, and contributed to the manuscript. pai conceived the study, and participated in its implementation and coordination. yx and pai wrote the manuscript which was read and approved by all the authors.

appendix
a. image segmentation
we design three different approaches to segment cell areas, according to the imaging techniques used to acquire a specific microscopic movie.

fluorescence microscopy allows for good contrast between the bright, but of possibly heterogeneous intensity, cell and the dark background. initial segmentation is achieved by selecting an adaptive threshold intensity that lies between those of the background and cell.

the intensity differences in phase-contrast images come from the anisotropic properties of the medium through which the light travels. pixel intensities inside the cell are noisy because of the numerous compartments distributed there. outside the cell, the intensities are considerably smoother. however, a phase ring can be usually observed around the cell periphery, which blurs the boundary and makes the segmentation difficult. to obtain an accurate cell boundary in a phase-contrast image, a deblurring step using the lucy-richardson method  <cit>  is first used to remove the phase ring. next, gradient mappings of the pixel intensity are generated. high gradients are seen in regions where the cell has considerable topological changes and low gradients are seen at the background. segmentation is achieved by connecting disparate areas using morphological operations  <cit> .

in dic images, because of the existence of a prism-induced shear direction in the image, bright and dark edges coexist on the cell boundary, but little contrast is observed between these edges  <cit> . thus, direct methods, either edge detection algorithms or region segmentations, cannot give satisfactory results for cell-shape analysis. a line integration method  has been proposed to transform dic images to pseudo-fluorescent images  <cit> . however, this technique can give rise to stripes as a result of the integration of random noise  <cit> . deconvolution and/or the hilbert transform can be used to correct these images, but neither technique avoids introducing distortions in the shape of the cell. instead, we use a total variation-based approach, in which an optimal image is found by minimizing an energy function defined by the observed image and the properties of the restored image  <cit> . two algorithms: one using texture extraction after lid and the other using denoising before lid, are found to be effective and to give similar results  <cit> . we note that after lid, the pseudo-fluorescent image of the cell will be slightly shifted in the prism-induced shear direction when compared to the cell boundary perceived by human eyes . however, since this is a constant offset everywhere, it does not affect cell shape or the other variables computed during skeletonization.

b. boundary smoothing
the algorithm contains four steps:

 <dig>  segment the image to get the initial boundary;

 <dig>  sample from the initial boundary to get a group of control points for the construction of a b-spline curve, which defines an initial shape estimate and a template in the shape-space;

 <dig>  search for the feature points along the boundary of the initial shape in the normal directions;

 <dig>  use recursive least-square estimation to compute optimal control points according to the positions of the feature points and construct the resultant b-spline curve that fits the boundary best.

as illustrated in figure 2d, boundary smoothing can eliminate part of spurious branches from the skeleton. we note that splines are appropriate for smoothing as long as the prominent features of a shape are retained. in figure 2c, the spline faithfully represents the two spots with high local curvatures at the bottom, thus it would not influence the skeletonization results in spite of the missing of small details. however, if a cell has a lot of spiky structures, such as the shape of a fibroblast, and these structures represent the main features of the shape, the smoothing process might be inappropriate as well as unnecessary.

c. first and second order differences
let dt be the measured data point  at time t. similarly,  and  are the measurements at time t-Δt <dig> and t+Δt <dig>  respectively. we define two measurements describing how data changes over time. the first  

defines the first order difference over two frames. the second  

represents the second order difference. these serve as analogues for the first and second time-derivatives, respectively, of the function dt. thus, the first order difference measures how much the data value changes, and the second order difference measures how much the rate of changes varies over time.

we define a cost function, used in the tracking algorithm that penalizes large changes in both these measures, weighed by constants α and 1-α:  

minimizing the first order difference corresponds to the assumption that changes in spatial position and angle in activities of the same pseudopod from one frame to the next are much smaller than the distance between two different pseudopods. on the other hand, minimizing the second order difference corresponds to the assumption that whenever the position or angle of the activity changes, the rate of change tends to be constant.

because computing the second order difference for an activity requires three time points, if only two are available, the cost function uses only the first order difference.

d. strains used
wt: dynhp ax2:rep orf+ :: pld1a15sn:dynacortin rnai

wt: control ax2:rep orf+ :: pld1a15sn

wt: tsua- ax <dig> Δtsua::pjk1:phcrac-gfp

wt: control ax3::pjk1:phcrac-gfp

myoii: gfpmyoii, mcherry dynacortin mhca :: pbig:gfp-myosin-ii; pdrh:mcherry-dynacortin

supplementary material
additional file 1
movie of a developed dictyostelium cell moving up to a shallow camp gradient. the cell is labeled with detected protrusions  and retractions , and pseudopod ids. the arrows indicate the direction of movement of the cell membrane. the pseudopod ids correspond to those in additional files  <dig> and  <dig> 

click here for file

 additional file 2
parameters describing individual pseudopods for a representative ax <dig> cell chemotaxing in shallow gradient.

click here for file

 additional file 3
activity and angle drifting patterns of the long-lived pseudopods in a representative ax <dig> cell chemotaxing in shallow gradient.

click here for file

 additional file 4
movie of a developed dictyostelium cell expressing mcherry-dynacortin and gfp-myosin-ii moving up to a micropipette needle releasing camp on the left. the white arrows indicate the detected protrusion and retraction activities.

click here for file

 acknowledgements
we are grateful to n. andrew and r. h. insall for providing us the movie in additional file  <dig>  we also thank members of the devreotes, robinson and iglesias labs for many helpful discussions. this work was supported in part by grants from the nih, gm <dig> , gm <dig> , gm <dig> , gm <dig> , and the nsf  <dig> .
