BACKGROUND
the global epidemics of human seasonal influenza are of great concern in public health. the analysis of viruses’ sequence diversity over time and space plays a key role in understanding the epidemiology, as the pattern of their transmission and interaction with host immunity may uniquely shape the trajectory of their evolutionary changes  <cit> . among the strains of human influenza viruses, the subtype h3n <dig> of type a has been the most common cause of seasonal influenza and is also the best understood system evolutionarily due to a large number of gene sequences, among which the most numerous is of hemagglutinin  gene segment, accumulated over several decades. hemagglutinin, coded by one of  <dig> genes located on the eight segments of the viral rna genome, is a surface glycoprotein that mediates the entry of the viral particle into the host cell and, along with neuraminidase , is recognized as an antigen by the host immune system. both ha and na genes are observed to undergo rapid evolutionary changes in amino acid sequences  <cit> . many of these amino acid substitutions are believed to alter the antigenic structure of the proteins, which allows viruses to evade host immunity and thus confers an evolutionary advantage to the variant. clear evidences of positive selection on such variants were obtained when various methods for detecting positive selection were applied to influenza virus sequences .

an overview of the evolutionary history of influenza viruses is provided by a genealogical tree of viral sequences sampled over multiple influenza seasons. the construction of genealogy  is possible when phylogenetic inference is applied to a non-recombining portion of the genome. a characteristic structure of genealogical tree was recognized: it has a long “trunk”, which represents one successfully surviving viral lineage through time, and other short side branches which go extinct within a few years  <cit> . this tree topology simply indicates that the effective population size of seasonal viruses is small relative to the time-scale of serial sequence sampling  <cit> : the lineages of two randomly chosen sequences at a given time coalesce to a common ancestor only one or two years back in time  <cit> , as if there are only a small number of viruses in the entire global population at a given time. the definition of effective population size, ne, is the number of individuals in a hypothetical population that reproduces according to a standard discrete-generation model , the basic evolutionary genetic property  of which is equivalent to that of the actual population of interest. for example, the expected heterozygosity at a nucleotide site is given by π = 2neμ, where μ is per-generation mutation rate. applying a well-estimated mutation rate per year and assuming  <dig>  days per generation , we obtain ne on the order of  <dig> for h3n <dig> viruses. this effective size is in stark contrast to the actual number  of h3n <dig> viruses. considering the large number of human individuals infected with seasonal influenza viruses such as h3n <dig> at a given time, the census size of viral population is believed to be several orders of magnitude larger than the effective size  <cit> .

this small effective size of the viral population is generally attributed to positive selection driven by host immunity. as it is known that homologous recombination within an influenza viral segment does not occur  <cit> , when a sequence carrying a new beneficial allele - a nonsynonymous mutation causing antigenic change or drug resistance - sweeps through the population, it will wipe out pre-existing nucleotide diversity in the population. this effect is termed genetic hitchhiking or selective sweep  <cit> . lower sequence diversity  of the ha segment compared to other segments  <cit>  is one of many evidences for recurrent selective sweeps operating in h3n <dig>  other evidences include the excess of nonsynonymous substitutions at epitope sites  <cit>  and various aspects of allele frequency changes compatible with clonal interference  <cit> . clonal interference occurs when a high rate of positive selection results in beneficial alleles arising at multiple loci that compete with each other to cause the loss of less-strong beneficial alleles . whether the temporal clustering of mutant alleles’ fixation events observed in h3n <dig> viruses is a result of clonal interference was recently questioned because it was found that the stochastic fluctuation of genealogical processes in asexual population can generate such clustering  <cit> . however, in the same paper, recurrent positive selection was shown to be essential in explaining the observed level of clustering, which was actually significantly lower than expected under neutrality, in h3n <dig>  therefore, all of these studies strongly support the operation of recurrent positive selection, thus selective sweeps in the h3n <dig> population.

however, it was not demonstrated clearly whether selective sweeps alone can explain the limited level of sequence polymorphism observed in h3n <dig>  one should first find out whether the rate of nucleotide substitutions driven by positive selection  in h3n <dig> is high enough to cause strong reduction of effective size and genetic diversity. there are however conflicting assessments regarding the rate of adaptive substitutions. koelle et al.  <cit>  proposed that antigenic cluster changes in h3n <dig> at 2- <dig> year intervals are caused by episodes of strong selection separated by periods of neutral evolution. a similar pattern of evolution was shown to emerge when the appearance of a new successful antigenic variant is mutation-limited under a simple model of inter-strain competition and cross-immunity  <cit> . recent experiments showed that most of such antigenic cluster transitions can occur by single amino acid substitutions  <cit> . other studies however found that such “episodic” sweeps cannot generate the observed genealogical structure and suggest that many nonsynonymous sites other than those responsible for major cluster transitions are under positive selection  <cit> . fortunately, the rate of adaptive substitutions may be estimated independently, without considering the rate of antigenic changes and the shape of genealogy, by applying an extension of the mcdonald-kreitman test  <cit> : bhatt et al.  <cit>  estimated that about  <dig>  adaptive substitutions per year occurs in the ha gene; thus, a higher rate than that considering only major antigenic substitutions. strelkowa and lässig  <cit>  also obtained a similar estimate using an equivalent method. they find that this rate is high enough to cause frequent clonal interference  <cit> . in this study, as we are interested in the maximum reduction of variation by recurrent selective sweeps alone, we use an upper estimate of adaptive substitution rate .

it is also important to examine whether selective sweeps in influenza viruses occur as hard versus soft sweeps. when a beneficial mutation that arose once by mutation reaches fixation, it will completely erase polymorphism that existed at the time of mutation . this event is called a hard selective sweep and was considered in the initial studies of selective sweeps  <cit> . on the other hand, if multiple copies of a beneficial mutation at a single nucleotide site that arose independently by recurrent mutation  reach high frequencies together and replace the former wild-type allele, they cannot completely erase the previous polymorphism because multiple linked haplotypes hitchhike along these beneficial copies. this process is defined as a soft selective sweep  <cit> . the prevalence of soft sweeps is known to increase with population size multiplied by per-site mutation rate, because this product  determines the opportunity for recurrent introduction of the same beneficial allele. therefore, investigating which mode of selective sweeps operates in h3n <dig> is likely to inform us about the  population size under which positive selection occurs and about the variation-reducing power of selection.

other evolutionary genetic forces may also contribute to a limited level of sequence polymorphism. if negative selection removes deleterious mutations that arise very frequently on a sequence with little or no homologous recombination, its cumulative effect can greatly reduce the number of viral sequences being inherited and this effect is called background selection  <cit> . previous work by strelkowa and lässig  <cit>  revealed that most of nonsynonymous mutations occurring in influenza sequences are under negative selection and discussed that background selection interferes positively selected alleles. Łuksza and lässig  <cit>  demonstrated that deleterious mutational load is a key to determine the fitness of the viral lineages. however, the impact of background selection on sequence variation has not yet been explicitly estimated. due to its high mutation rate and to there being no within-segment recombination, the effective population size of influenza virus may be significantly decreased by this process. the complex demographic dynamics of seasonal influenza virus is another factor that can significantly decrease its effective population size. recent investigations demonstrated that global patterns of h3n <dig> influenza epidemics are explained by the complex seasonal and inter-regional migration/seeding of viruses  <cit> , mostly from asia to the rest of the world  <cit> . such complex demographic dynamics of the global h3n <dig> population  may imply recurrent population bottlenecks for the global h3n <dig> population, the effect of which on genetic variation would be similar to that of recurrent selective sweeps. the major aim of this study is to quantitatively evaluate the relative contributions of positive selection, negative selection, and complex demography in reducing the effective population size of h3n <dig> viruses. using the simulation model of viral population that incorporates all of these evolutionary forces, we will conclude that background selection and metapopulation dynamics have much greater variation-reducing effect than recurrent selective sweeps.

recently, koelle and rasmussen  <cit>  reported their investigation on the effect of deleterious mutations on the pattern of molecular evolution in h3n <dig>  they reached a conclusion similar to ours: recurrent negative selection limits the emergence of advantageous  variants and, together with selective sweeps, the overall size of genealogy. however, whereas they modeled the evolutionary process embedded in continuous-time susceptible-infected-recovered  epidemiological dynamics, our model uses a conventional population genetic approach using discrete generations, fixed  sizes of viral population, and effects quantified by neutral  polymorphism. this makes it easier to interpret our results in comparison with those in population genetics literature and to quantitatively evaluate the relative effects of variation-reducing evolutionary genetic processes. furthermore, as the evolutionary genetic processes at synonymous and nonsynonymous sites are explicitly modeled, our approach allows us to estimate the strengths of negative selection from the observed nonsynonymous-to-synonymous substitution ratio in h3n <dig> 

RESULTS
low synonymous diversity of ha cannot be explained by positive selection alone
we investigated whether the variation-reducing effect of recurrent positive selection, the rate of which was recently inferred to be ~ <dig>  adaptive substitutions per year on the ha segment  <cit> , is sufficiently strong to explain the observed level of synonymous diversity without other mechanisms known to reduce genetic variation. synonymous diversity πs of ha <dig> was estimated to be  <dig>   when we calculated mean pairwise synonymous substitutions among sequences sampled within the same year and obtained its average over  <dig> to  <dig>  then we performed a simulation of recurrent selective sweeps in a viral population that reproduces in discrete generations. here, one generation corresponds to the duration of viral transmission from one host to another. this approach of modelling each infected host by a single representative gene copy, which is a fair approximation if superinfection is rare and the differential replication of alleles due to within-host dynamics  is translated into the rate of transmission between hosts, was used in previous studies  <cit> . therefore, the meaning of population size, mutation rate, and selection strength in this model needs to be interpreted accordingly. we assume that a single generation corresponds to 1/80 year which is approximately the estimated interval between host-to-host infection  <cit> . then, to yield  <dig>  × 10− <dig> substitutions per site per year by neutral genetic drift, which is approximately the synonymous substitution rate that we obtained from sequence divergence over 46 years, we set mutation rate to μ =  <dig>  × 10− <dig> per site per generation. as our modelling focuses on the ha <dig> segment of h3n <dig>  the length of a viral sequence is initially l =  <dig>  . each sequence is made up of ls =  <dig> “synonymous” sites, which is approximately the average number of synonymous sites at ha <dig>  and ln = l - ls nonsynonymous sites. a subset of nonsynonymous sites  mutate into advantageous alleles with selection coefficient s in the range of between  <dig>  and  <dig>   at a rate μb = μ/ <dig>  at this point, mutations at the rest of nonsynonymous sites are assumed to be selectively neutral . for the given input parameters of positive selection , the rate of adaptive substitutions, k, would increase with increasing s and n . as we are primarily interested in examining genetic variation across different evolutionary conditions that nevertheless generate the same rate of adaptive substitutions, the value of lb was adjusted by trial and error to yield k close to  <dig>  or  <dig> . during the simulation run, the fixation probability of each beneficial allele is much lower than 2 s, confirming that strong clonal interference is operating at this rate of adaptive substitutions  <cit> .

first, we ran a number of simulations with varying population size n  while keeping k close to  <dig>  by adjusting lb . synonymous diversity, πs, increases as a function of n . for example, simulation with s =  <dig>  and n =  <dig>  generates πs =  <dig> , slightly lower than the observed value. with larger population sizes πs below  <dig>  is not observed. when selective sweeps are more frequent to yield k ≈  <dig> , πs is lower than when k ≈  <dig> , as expected . however, synonymous diversity still increases monotonically with n and, for s =  <dig> , exceeds the observed value as n increases over  <dig> . we also find that, conditional on k and n, πs increases with decreasing s . however, even with large s , πs <  <dig>  is satisfied only with n <  <dig> . this result suggests that if the population size of h3n <dig> viruses is much larger than the order of  <dig>  which is likely to be true, the genetic hitchhiking caused by one or two adaptive substitutions per year cannot reduce genetic variation to the observed level unless there are other evolutionary forces to reduce the effective population size of h3n <dig> fig.  <dig> simulation of recurrent positive selection  under various population sizes and selection coefficients. a sequence of length l =  <dig>  contains  <dig> synonymous sites over which the level of polymorphism is calculated, which models the ha <dig> segment of h3n <dig> virus. as we reduced l
b  with increasing s and n, the numbers of adaptive substitutions per year are similar  in all cases. a. per-segment synonymous diversity  as a function of population size with different assumptions on selection coefficient s for beneficial mutations. πs obtained from ha <dig> is indicated by a dashed line. b. the rate of soft sweeps  in the same simulation replicates



the classical theory of genetic hitchhiking  <cit> , which assumes hard selective sweeps , predicts that k imposes the upper bound of the level of neutral polymorphism: given sufficiently large n , as polymorphism in the population is swept away  at a rate k per year on average, pairwise sequence diversity  is predicted to be approximately 2k80μls.  predicted πs is  <dig>  with k =  <dig> , while πs in our simulation  far exceeds this value. furthermore, the monotonic increase of πs with increasing population size is not predicted either. there are at least three potential reasons for this discrepancy between the simple theory of hitchhiking and our result. first, recurrent fixations driven by positive selection may not occur independently but clustered in time due to stochastic whole-population coalescent processes  <cit>  and clonal interference  <cit> . namely, multiple beneficial alleles would often sweep to fixation jointly. then, the expected waiting time  until two gene lineages coalesce could be longer than 1/k. second, even though our simulations were performed conditional on the same number of adaptive substitutions per year, simulated populations of larger n must have experienced more intense clonal interference, and thus more beneficial alleles lost by competition. it is known that clonal interference effectively reduces the strength of positive selection  <cit> . given that smaller s leads to larger πs , an effective decrease in the strength of selection with increasing clonal interference may explain the monotonic increase of πs with n. third, the fixation of a beneficial allele at each site may not result in a hard sweep but a soft selective sweep  <cit>  in our simulation. as we find that considering soft selective sweeps is the key to finding appropriate evolutionary models for h3n <dig> viruses, we analyze this effect in detail below.

rate of soft selective sweeps in h3n <dig> viruses
genetic variation is incompletely wiped out by soft sweeps, which occur when multiple copies of a beneficial allele at a single nucleotide site that are identical in state but of different mutational origins, and that are thus linked to different neutral variants, contribute together to an episode of adaptive substitution. note that our simulation permits soft sweeps as mutation at each site can occur recurrently. soft selective sweep occurs with probability approximately proportional to scaled mutation rate θ = 2nμ  <cit> . therefore, it can explain increasing synonymous diversity with n in our simulation. here, n is the population size that determines opportunity for multiple recurrent mutations arising at a single site. if n for h3n <dig> population is very large, most adaptive substitutions would occur as soft sweeps. therefore, estimating the rate of soft selective sweeps from the viral sequences would shed light on the  population size under which viruses experience positive selection.

we investigated the mode of selective sweeps of  <dig> antigenic-cluster-transition substitutions from  <dig> to  <dig> at seven amino acid positions near the receptor binding site  <cit> . these substitutions are very likely to be driven by positive selection, since their individual antigenic impacts were verified experimentally. for each substitution, a maximum likelihood tree was constructed using all the available sequences sampled from one year before the derived allele’s appearance to the year of its fixation. a selective sweep is soft if multiple copies of an identical beneficial allele arise independently from different ancestral backgrounds, which results in mapping of mutations on different branches of the genealogical tree, and reach fixation together .fig.  <dig> distinguishing the mode of selective sweep on genealogy. a maximum likelihood tree is reconstructed for simulated  sequences sampled over a period that starts before the first mutational origin and ends after the fixation of a  beneficial allele. the copies of the beneficial allele at the branch tips are shown as pink or red dots. red dots indicate copies observed when they reached fixation in the population. a. an example of hard selective sweep. all copies of the beneficial allele at the time of fixation  originate from a single mutation . b. an example of soft selective sweep. there are two clones originating from two different mutation events  at the same site at the time of fixation. examples a and b, from two different sites on the same genealogy, were obtained from the simulation of model b <dig> with l =  <dig>  and n =  <dig> . c. a hard selective sweep of the 156 k allele during antigenic cluster change from si <dig> to be <dig>  identical 156 k mutations arose independently  and co-existed separately in be <dig> and be <dig> clusters. however, when allele frequency became  <dig>  , only 156 k mutants in be <dig> existed



interestingly, we do not find the pattern indicating a soft sweep in any of the  <dig> cases. in most cases, the patterns are compatible with hard sweeps. namely, an antigen changing mutant is observed to occur in only one ancestral background and then to increase to high frequency. in some genealogies we observe different copies of the same beneficial allele arising separately in different backgrounds, but only one clone of the allele going to intermediate frequency and reaching fixation . an identical observation was reported by strelkowa and lässig  <cit> . in summary, the rate of soft sweeps on the ha gene in h3n <dig> population is very low.

to find out in what range of population size the rate of soft sweeps is as low as observed above, we examined the rate of soft sweeps in simulated datasets under models of positive selection considered above. we examined the number and frequency of clones originating from independent beneficial mutations and obtained the proportion, fsoft, of simulated selective sweeps that generate the pattern of soft sweep , while keeping the number of sampled sequences very similar to that of actual viral sequences. with k ≈  <dig>  and s =  <dig>  , in order for fsoft to be as low as  <dig> , for example, n should be as small as  <dig>  . when selection is weaker with s =  <dig>  and the number of beneficial sites  is increased to yield the same rate of advantageous substitutions , fsoft at n =  <dig>  is lowered to  <dig> . however, under this parameter set, synonymous diversity increases to  <dig>  . simulation results with other parameter values also show that, with recurrent positive selection alone, it is not possible to achieve both fsoft <  <dig>  and πs <  <dig>  if n > =  <dig> .

contribution of background selection
the above results show that low level of synonymous  polymorphism and the prevalence of hard selective sweeps observed in h3n <dig> viruses cannot be explained unless assuming a small population size  under which positive selection operates. as the actual size of the viral population is likely to be much larger than that, one needs to invoke the presence of other evolutionary forces that significantly reduce the effective population size  of h3n <dig> before positive selection further reduces it. the first candidate is the effect of negative selection against deleterious mutations . given that the majority of nonsynonymous sites in a viral genome are believed to be under negative  selection  <cit> , the absence of intra-segment homologous recombination and limited reassortment, recombination between different segments , may generate strong background selection.

we added background selection to the above model of positive selection  by imposing negative selection on ld  non-beneficial nonsynonymous sites: the wild-type allele at these “deleterious sites” mutate to an alleles with selective disadvantage sd . with ls fixed at  <dig>  the strength of background selection increases as we increase the total length of sequence l from  <dig>  to  <dig>  or  <dig> . simulations with l =  <dig>  and  <dig>  incorporate the additional effect of negative selection operating on the ha <dig> domain and even on other viral segments, which will affect variation at ha due to limited reassortment between segments. we initially use sd =  <dig> .  again, for each parameter combination of these simulations we adjusted the value of lb to achieve k ≈  <dig> . as expected, under the same rate of adaptive substitutions, synonymous diversity with background selection is lower than without it . compared to the model of positive selection alone but with more frequent sweeps , variation-reducing effect is slightly weaker with l =  <dig>  but much stronger with l =  <dig>  or  <dig>  . again, larger population size results in higher synonymous diversity. however, when background selection is strong as in the case of l =  <dig> , πs is still lower than the observed value at a large n . it is possible that much stronger background selection than that generated with l =  <dig>  is operating in the actual h3n <dig> population since the combined effect of negative selection over the entire viral genome  can be very large assuming a rate of reassortment that is low relative to the frequency of negative selection.fig.  <dig> the joint effect of recurrent positive and negative selection with increasing population size. while the rate of adaptive substitutions and selection coefficient  are fixed at k ≈  <dig>  and s =  <dig> , synonymous diversity is largest in model a  and decreases in model b <dig>  with increasing number of sites under negative selection  with s
d =  <dig> , for a given population size n. simulations with n =  <dig>  in model a and  = , , or  in model b <dig> generate soft selective sweeps at comparable rates  , and they also yield similar levels of synonymous diversity  



addition of background selection also reduces the rate of soft selective sweeps, as expected . this reduction can be understood as a decrease in the fixation probability of an individual beneficial mutation due to the chance of its occurrence on an unfit  sequence, the “ruby-in-the-rubbish” process  <cit>  invoked by koelle and rasmussen  <cit> . it is known that, in an asexual population considered here, the proportion of the population with the least deleterious mutation , which is approximately equal to the effective population size for neutral polymorphism by background selection as long as s is not too large relative to sd, largely determines this fixation probability  <cit> . therefore, we can simply parameterize the rate of soft sweeps by θ1 = 2ne1μ, where ne <dig> is the effective population size after taking only background selection into account.  using an analytical solution, the equation  <dig> of hudson and kaplan  <cit>  that describes the strength of background selection as a function of mutation rate  and selection coefficient, we predict ne <dig> of approximately  <dig>  with n =  <dig>  and l =  <dig> , n =  <dig>  and l =  <dig> , or with n =  <dig>  and l =  <dig> . as expected, in each of these cases the rate of soft sweep is similar to that of model a with n =  <dig>  and these cases also yield very similar levels of synonymous diversity . such small effective population sizes  may be obtained under even larger n if background selection is stronger, namely if the effective number of linked deleterious sites is larger and/or the selection coefficient of deleterious alleles is smaller  <cit> .

next we examine the effect of the strength of negative selection . previous studies found that deleterious nonsynonymous mutants are not eliminated rapidly but accumulate in viral lineages bound to go extinct, which correspond to the external branches of the genealogical tree  <cit> . such an elevation of deleterious genetic load was quantified as the excess of nonsynonymous-to-synonymous substitution rate  in external relative to internal branches. we define ωi and ωe as the average dn/ds in internal and external branches, respectively. the strength of negative selection will affect not only ωi and ωe but also its ratio ωe/ωi. we therefore used varying sd in our simulation and examined its effect on these quantities, in addition to its effect on πs and fsoft. different values of s  were also tested as the relative strength of positive and negative selection is expected to affect ωi and ωe.

nonsynonymous and synonymous substitutions were counted from two data sets of h3n <dig> and the excess of ωe over ωi was observed as expected . in simulations under which all non-beneficial nonsynonymous sites are under negative selection with sd , when sd decreases from  <dig>  to  <dig>  and again to  <dig>  while s and ln are fixed, the values of ωe increase roughly proportionally, among which the best fit to empirical ωe is observed when sd =  <dig> . on the other hand, ωi increases with decreasing sd more dramatically: relative to the empirical value of ωi, ωi in simulation is much smaller with sd =  <dig>  or  <dig>  but approximately twice larger with sd =  <dig> . although ωe/ωi is similar to the observed values when sd =  <dig> , large values of ωi imply frequent hitchhiking of deleterious mutations to fixations, and this may not be the regime of influenza. this effect of sd is consistently observed for all combinations of s and ln. overall, we failed to find a single value of sd that made ωi, ωe, and ωe/ωi fit empirical data simultaneously. however, it might be unrealistic to assume uniform negative selection across all nonsynonymous sites. we thus explored the plausible distribution of sd in more realistic models.table  <dig> effect of s
d on nonsynonymous-to-synonymous substitution ratios for internal  versus external  branches and on πs and f
soft


dataset or modela
l
s
s
d
a
a
a
f
soft
l
b
n
s
d

afor each parameter combination, simulation results were obtained as averages over  <dig> replicates and their standard errors are within 5 % of the values



first, we tested a model in which sd for nonsynonymous sites are either  <dig> ,  <dig> ,  <dig> ,  <dig>  or  <dig>   with the mean of  <dig>  . this led to close agreement with the empirical data. next we also took into account a previous result in which the fraction of nonsynonymous sites under negative selection is at least  <dig>   <cit> , and in which a substantial proportion of mutations in an rna virus is lethal  <cit> . therefore, we modeled that 25 % of nonsynonymous non-beneficial mutations are neutral, another 25 % lethal, and the other mutations deleterious with equal sd . this model yielded ωi, ωe, and ωe/ωi quite similar to the empirical values with ln =  <dig> and sd =  <dig>  or  <dig> . it is highly plausible that other distributions of sd would also generate fitting results, while an exhaustive search for such distributions is beyond the scope of this study. a general conclusion we may draw from the above results is that strong negative selection  as assumed in our models b <dig>  is compatible with the excess of deleterious genetic load observed in the external branches of genealogy, whereas weak negative selection results in too large dn/ds in both internal and external branches.

while its impact on dn/ds is notable, varying sd does not change πs and fsoft greatly . when simulations with the same ld and s are compared, πs and fsoft slightly decrease as sd is lowered from  <dig>  to  <dig> , but increase again as it is further lowered to  <dig> . this is probably because interference between numerous sites under selection in a linked segment reduces effective population size so that the effect of negative selection at individual sites becomes weaker, a phenomenon known as hill-robertson interference  <cit> . therefore, deleterious mutations with small selection coefficient at a linked site do not reduce variation as much as the analytical solution of background selection predicts  <cit> .

the effect of complex demography
as the next candidate for an evolutionary process reducing the effective size of h3n <dig>  we consider its complex demography. viral reproduction in our simulation model is based on absolute fitness as a function of time-dependent carrying capacity, which allows a straightforward realization of metapopulation  dynamics . different geographic regions over which the global h3n <dig> epidemics propagate may be modeled as discrete subpopulations . as the yearly cycle of seasonal influenza is largely characterized by alternating epidemics in northern and southern hemispheres  <cit> , we first consider a simple model with six “northern” demes and two “southern” demes . this model, ignoring the presence of tropical asian populations where viruses were shown to circulate almost continuously to act as the hub of global viral transmission  <cit> , rather represents a demographic scenario with maximal variation-reducing effect . we will later modify this model to take the presence of the tropical population into account.fig.  <dig> model of complex demography  under which recurrent positive selection occurs. a. population is subdivided into six demes in the northern hemisphere  and two demes in the southern hemisphere . viruses migrate between demes in all directions . b. seasonal changes in the carrying capacities  of demes. c. synonymous diversity  and soft sweep rate  according to population size  in metapopulation models. c1: rates of migrations in all directions are equal. c2: immigration and emigration rate of a single northern deme is  <dig> times larger than the other demes. one of the six northern demes does not undergo the extinction-recolonization cycle but maintains k =  <dig> k
max  or  <dig> 



the carrying capacity of a northern deme reaches its peak  at the beginning/end of a year  but decreases to zero in the middle of a year . conversely, the carrying capacity of a southern deme reaches kmax in summer and zero in winter. then, the persistence of the entire metapopulation  is critically dependent on the events of migration between northern and southern demes when the carrying capacities at both sides are non-zero. a small number  of migrant viruses implies recurrent population bottlenecks and thus a reduced effective population size, under which positive selection occurs.

in the simplest model , the rates of migration in all directions are equal . in the second model , in order to test the effect of asymmetric migration rate, a single northern deme which models a region of particularly high viral transmission is receiving and sending  <dig> times more migrants than other demes. in the third, one of six northern demes stops the extinction-recolonization cycle and maintains k =  <dig> kmax  or  <dig>  throughout the year. this deme corresponds to a tropical asian population that exhibits continuous viral epidemics. while some estimates of migration rate in h3n <dig> between actual geographic regions are available  <cit> , it is not clear if those values can be applied to our simplified models of global h3n <dig> demographic structure. instead, we considered a migration rate reasonable if it results in the degree of genetic differentiation among demes  close to the observation from the actual population   <cit> . in each model and for a given kmax, we could find a unique combination of lb and migration rates that yielded both k ≈  <dig>  and fst ≈  <dig>  . note that, to maintain constant fst, migration rate needs to decrease as the size of demes increases in models c <dig>  c <dig>  and c3a, in agreement with the standard island model in which the product of the two parameters determines the level of fst. however, in c3b, the relationship between m and kmax for constant fst is more complicated.

simulation results show that, as population size  increases, πs and fsoft increases as expected . the relationship between πs and fsoft is similar across different models of metapopulation as well as models of constant-sized population with identical k and s . this suggests that an identical two-step process of reducing effective population size occurs both with background selection and with metapopulation dynamics. here, we may define ne <dig> as the effective size determined by complex demography alone. then, positive selection operates under a population with ne <dig> to further reduce the effective population size to ne <dig>  our result is explained if ne <dig> determines fsoft, ne <dig> determines πs, and ne2/ne <dig> is the marginal effect of recurrent selective sweeps that is invariant regardless whether it occurs jointly with background selection or with metapopulation dynamics as long as k and s remains the same .fig.  <dig> summary of evolutionary models and the two-step reduction of effective population size. the degrees of reduction in effective population size due to recurrent selective sweeps are shown by red arrows. reductions due to background selection and metapopulation dynamics, when parameters are chosen to maximize the variation-reducing effect  of the models, are indicated by blue and green arrows, respectively. black dashed line represents the census  or effective population size  under which positive selection results in small probability of soft selective sweeps . red dashed line marks the effective population size  that generate the observed sequence diversity . background selection can generate the observed patterns of soft sweeps and sequence diversity in a population with the largest census size



the effect of reducing effective sizes by metapopulation dynamics is however highly variable depending on the models. in c <dig> and c <dig>  πs ~  <dig>  was obtained with 8kmax = 2 ×  <dig> and  <dig>  respectively. considering that comparable levels of polymorphism were obtained in model b <dig> with n =  <dig> and l =  <dig>  or n =  <dig> and l =  <dig>   and that the census size in c <dig> and c <dig> is certainly smaller than 8kmax, we may conclude that the variation-reducing effects of metapopulation dynamics here are similar or slightly weaker than those of background selection. in the presence of a “tropical” deme, despite its small size , the effect of metapopulation dynamics greatly diminishes and is weaker than that of background selection in model b <dig> with l =  <dig> , probably because this deme eliminates the effects of recurrent population bottlenecks. these results indicate that the variation-reducing effect of metapopulation dynamics is similar to or weaker than that of background selection, at least with the models and their parameters used in our simulations.

we note that ferguson et al.  <cit>  also modeled the spatial and seasonal structure of influenza virus by dividing the population into northern and southern demes. under this model they obtained genealogical structures matching the observed diversity. however, they found only subtle effect of their demographic parameter  on the evolutionary dynamics. this is in contrast to our conclusion that the complexity of demography, especially the presence of a tropical deme, is a key determinant of the level of viral genetic diversity. their result differs probably because they allowed between-season persistence of both northern and southern demes  and thus precluded the extinction-recolonization dynamics of the metapopulation.

relative contributions of evolutionary processes
given that soft sweeps rarely occurs, ne <dig> of h3n <dig> must not be higher than the order of  <dig>  as given in the introduction, from the level of sequence polymorphism and branch lengths of the coalescent tree ne <dig> is estimated to be on the order of  <dig> at ha  <cit> . therefore, reduction from ne <dig> to ne <dig> caused by positive selection is on the order of  <dig> . on the other hand, the reduction of effective size, from n to ne <dig>  caused by background selection and/or complex demography is likely to be much larger than the order of  <dig>  considering a potentially large census size of h3n2: approximately  <dig>  % of the world’s population at any time is infected with influenza viruses  <cit> , among which h3n <dig> is the major subtype causing flu epidemics  <cit> . while both background selection and metapopulation dynamics are important determinants of influenza genetic diversity, background selection is a potentially more important factor in reducing the effective population size than complex demography. in influenza h3n <dig>  actual metapopulation dynamics may have a limited impact in reducing effective size due to persistent populations in tropical asia. on the other hand, background selection may have stronger variation-reducing power than demonstrated in our models, as negative selection against deleterious alleles on the entire influenza genome can affect polymorphism in the ha segment with limited recombination . since we considered one linked segment  and assessed the potential effect of other segments only indirectly by increasing the number of sites subject to deleterious mutations or beneficial mutations, our study is rather conservative in estimating the impact of genome-wide negative and positive selection. it is not easy to extend our model to accommodate genome-wide selective forces and assess their variation-reducing effects quantitatively because the rate of reassortment in h3n <dig> viruses, which appears to vary for different segments  <cit> , has not been estimated. however, our major conclusion – greater reduction in genetic diversity by background selection than by positive selection – is not likely to change after taking genome-wide selection into account, because negative selection is prevalent in all viral segments whereas recurrent positive selection is known to be limited mostly to ha and na segments.

CONCLUSIONS
various models of positive selection have been proposed to explain the limited genetic diversity of ha in h3n <dig>  <cit> . using computer simulations of viral population undergoing recurrent selective sweeps, we have demonstrated that positive selection alone cannot generate the observed level of synonymous diversity and that additional evolutionary forces reducing the effective population size, which also explain the prevalence of hard selective sweeps with antigenic cluster transitions, are needed. the most likely candidates for additional variation-reducing processes are background selection and metapopulation dynamics. both processes are likely to exert strong effect in the h3n <dig> viral population, since seasonal influenza viruses are characterized by the absence of intra-segment recombination and by complex metapopulation dynamics. within the range of parameter values used in our models, which are bounded to match other aspects of h3n <dig> molecular evolution , we conclude that background selection has potentially more important role in limiting sequence diversity in influenza virus.

other population genetic factors not considered above might also contribute to reducing the effective population size of h3n <dig> viruses. for example, the variance of the number of descendant viral copies after replication and transmission, without considering fitness differences, might be very high. poisson distribution was used in the reproduction step of our simulation model, as it mimics the conventional wright-fisher model. we also tried negative binomial distribution with dispersion parameter  <dig> , representing a skewed distribution in which a small fraction of viruses produce a large number of descendant copies. however, it had the effect of reducing the effective population size by less than an order of magnitude . further investigation nevertheless is warranted to explore the effect of realistic patterns of viral transmission on the effective size of h3n <dig> population.

