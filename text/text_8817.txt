BACKGROUND
the execution of specific behaviors relies on specialized motor programs, which generate specific spatial and temporal patterns of muscle contraction. the regulatory circuits that control the patterning are in principle independent of the concrete instantiation of the muscular end organ . the same logical regulatory structure can be used to control a wide variety of behavioral programs. this also means that studying such pattern generating circuitries in experimental organisms can provide insights into fundamental circuit designs that are re-used in the much more complex brains of higher animals. the neuronal circuits of the worm c. elegans are particularly attractive for this kind of basic studies, because all neurons and muscle cells are individually known, their connectivity is constant, and the transparent body facilitates visualization and manipulation of single cells in living animals. in addition, genetic manipulation is much easier than in vertebrates. in the present paper we take advantage of these experimental options to elucidate the logical connectivity of the circuit controlling the egg-laying behavior of c. elegans and show how it implements basic mathematic operations that control the temporal pattern of egg-laying.

c. elegans egg-laying occurs as a time series of stochastic events. in first approximation, egg-laying is a random point process: individual egg-laying events occur aperiodically and are sufficiently brief  that they can be treated as point events. however, it is clear that egg-laying is not strictly random; the time and location of egg-laying events is regulated by diverse environmental and internal factors, and under certain conditions egg-laying can be suppressed for long periods. the overall temporal pattern of egg-laying behavior is clustered  <cit> : short periods of high-frequency egg-laying behavior, called active states , are separated by much longer quiescent periods about  <dig> minutes to  <dig> hour long, called inactive states. figure 1a shows this pattern and also defines the related terminology. the intra-cluster time intervals  are exponentially distributed, with τ1; ~ <dig> sec in wild type worms. likewise, the inter-cluster time intervals  are exponentially distributed with a slower time constant τ2; ~ <dig> min. the exact start and end point of the active and inactive states are impossible to determine, as the first and last egg-laying event of a cluster are close, but not exactly equal, to the transition between states. the uncertainty will be on the order of half an intra-cluster interval , much shorter than the duration of the states themselves. as zhou et al. have shown  <cit> , the clustered pattern can therefore be described by a combination of two poisson processes with different time constants.

the core components of the neural circuit driving each individual egg-laying event have recently been characterized . two major pairs of neurons contribute directly to the control of egg-laying. the hsn neurons are the central command neurons of the circuit; each autonomous individual ca2+ spike in hsn can induce contraction of the vulval muscle cells  and result in one egg-laying event. the hsns are modulated by the vc neurons, and also integrate environmentally-controlled neuromodulatory signals that influence egg-laying frequency. for example, posterior body touch transiently inhibits egg-laying by exciting the plm mechanoreceptor neurons, which in turn directly inhibit hsn activity.

how do these cells create the clustered temporal pattern in egg-laying? which cells are required to cause the regular transition between active and inactive states? in this paper we propose a model to explain this behavior using evidence from cell biology, genetics and statistics. ca2+ levels in the hsns  have been visualized at high temporal resolution using calcium-sensitive fluorescent dyes, giving us an opportunity to directly monitor the transmission and integration of signals in the circuit. furthermore, mutants with defects in individual cells make it possible to discriminate correlated excitation from causal links in the circuit. based on these data, we propose an integrated circuit model that can explain the logic underlying the egg-laying temporal pattern.

RESULTS
hsn is under negative feedback regulation from egg-laying
it has been suggested that in the absence of external modulation, the hsns would be autonomously oscillating  <cit>  . this has been shown by separately depriving hsn of its synaptic or diffusible inputs. in comparison, hsn in the context of an intact neural circuit shows sparse spiking activity , demonstrating that it is normally under negative regulation in physiological conditions.

interestingly, in egl- <dig> worms, which are defective in egg-laying behavior due to abnormal vulval muscle development, we found that half of hsn recordings exhibit unrestrained oscillations very similar to the theoretical pattern in figure 2a, with hsn oscillating about half the time  and silent otherwise . the overall activity of egl- <dig> hsn is much higher than that of wild-type hsn, due to the hyperactive oscillations in the former. this suggests that egg-laying itself provides inhibitory feedback to the hsn neurons.

egg-laying provides inhibitory feedback to the vc neurons
each egg-laying event is preceded by an autonomous depolarization of the hsn and vc neurons, observable as an increase of ca2+ levels in the cell . the egg-laying motor program occurs very quickly, so egg-laying usually is finished well before the excited hsn and vc neurons come back to rest.

to determine the causal relationship between hsn activity and egg-laying muscle contraction, we asked if there is a fixed correlation between the timing of egg-laying and the hsn and vc calcium spikes. specifically, we investigated whether egg-laying is coupled to any specific point during the calcium transient. a co-variation test  showed that egg-laying happens when ca2+ levels are at their peak in the vc neurons. linear regression shows that egg-laying and the calcium peak happen almost simultaneously, as the slope of the regression line is close to  <dig> and the intercept close to  <dig>  thus, egg-laying is tightly coordinated with the end of the calcium transient. from a mechanistic point of view this is surprising: as egg-laying is caused by vc depolarization , we might expect egg-laying to occur at a constant delay after the beginning of the depolarization. in contrast, since the duration of the transient  is highly variable, a correlation between egg-laying and the calcium peak was unanticipated.

as the spike peak reflects the start of repolarization, the simplest explanation for the coupling of egg-laying to spike peaks is that the repolarization of the vc neurons is actually induced by egg-laying. this would establish a negative feedback loop, where depolarization of vc causes egg-laying, which in turn causes termination of the calcium transient and repolarization of the vc neuron.

vc inhibits hsn in the short term
previous work indicated that the vc motorneurons inhibit the activity of the hsns. to learn more about this interaction, we investigated the effect of eliminating the vcs on the dynamics of hsn activity in more detail. we observed that in worms which lack vc neurons because of a lin- <dig> allele  <cit> , single ca2+ spikes in hsn neurons are replaced by oscillatory trains, which are interspersed by very long silent periods. the distribution of short intervals appears sharper than in wild-type animals, suggesting a shift from the poisson distribution . further statistical tests confirmed that the short inter-spike intervals in lin- <dig> animals follow a normal distribution comparable to the pattern observed when the hsn neuron is not receiving any inhibitory input. this implies that the vc neurons are mediating short-term inhibitory effects on hsn activity within the active state.

the vc neurons send arborized processes to the surface of the vulval epithelium in addition to their synapses on the vulval muscles. based on the anatomical arrangement, it can be hypothesized that the function of the processes reaching the vulval epithelium is to sense stretch. thus, vc neurons are suitably positioned to directly register a successful egg-laying event by sensing muscle or vulval epithelial stretch, and feed this information back to the hsn neurons by inhibiting their activity. therefore, we hypothesize that individual egg-laying events might be detected by the vc neurons, which in turn provide short-term negative feed back to the hsns to modulate their activity during the active state.

long-term feedback may be mediated by the uv <dig> cells
while the vc neurons appear to provide important inhibitory feedback to the hsn cells, additional cells are likely to provide further modulatory input to the egg-laying circuit. in lin- <dig> worms, in which the vc neurons are absent, very long silent periods  are still observed between trains of hsn activity . this observation suggests that another there may be additional, vc-independent inhibitory inputs to the hsns that might act on longer time scales  <cit> .

possible candidates for providing such inhibition are the uv <dig> neurosecretory cells  <cit> . these cells are located at the junction between the vulva and uterus, and have been shown to express neuropeptides as well as the catecholamine neurotransmitter tyramine  <cit> . they have been proposed to be potential touch sensors, based on their morphology and their expression of candidate sensory transduction molecules  <cit> . in wild-type worms, low external osmolarity causes constitutive egg-laying and continuous high-frequency calcium oscillations in hsn, while high osmolarity inhibits egg-laying and silences hsn calcium transients  <cit> . in ocr- <dig> mutant worms, where uv <dig> function is impaired due to a dominant negative missense mutation in a trpv channel protein, egg-laying in high osmolarity conditions occurs at extremely high frequency  <cit> , comparable to wild-type worms in low-osmolarity conditions . this suggests that the uv <dig> s may provide a long-term inhibitory input to the egg-laying circuit, and is consistent with a role for the uv <dig> s in mediating egg-laying inhibition by high osmolarity.

since the uv <dig> s are candidate stretch receptor cells  <cit> , we propose that they might be activated by movements of the vulva associated with egg-laying. in particular, they might facilitate the long quiescent periods that follow clusters of egg-laying events. since the uv <dig> s release peptides and amines in a paracrine rather than a synaptic fashion, they may be well-suited to mediate long-lasting inhibition following multiple egg-laying events. neurohormones have a much slower action and clearance kinetics compared to neurotransmitters released at synapses and this slow kinetics means that closely timed repeated neurotransmitter releasing events could give rise to an additive effect, building up a strong enough extracellular gradients to act at a longer distance. we therefore hypothesize that the uv <dig> s release an inhibitory neurohormone in response to a cluster of egg-laying events, inducing long term silencing of hsn activity and egg-laying behavior corresponding to the inactive phase of egg-laying.

circuit model of egg-laying pattern generator
to summarize, our model of the clustered temporal pattern in egg-laying is as follows:  the hsn cells are the command neurons for egg-laying with individual ca2+ spikes corresponding to one egg-laying event;  the vc cells work as "single egg counters" that are briefly and transiently activated during individual egg-laying events and as a result inhibit hsn activity for short periods ; and  the uv <dig> cells are the "cluster counters", activated by a cluster of egg-laying events and inhibiting hsn activity for longer periods . in our model, the vc and uv <dig> cells form two negative feedback loops sensing egg-laying behavior and feeding back onto hsn activity; however, they are different in their physiological activation mechanisms, and, when activated, differ in their kinetics of inhibiting hsn activity. together, they generate a clustered temporal pattern as observed in natural egg-laying behavior. figure  <dig> summarizes the resulting model. the corresponding mathematical equations are supplied in additional files  <dig> and  <dig>  please note that our model elucidates the cellular circuit connectivity, but does not propose a specific molecular mechanism, e.g., how hsn activity returns to the spiking state after being inhibited, or how vc quickly repolarizes hsn activity. this is due to the fact that our model is based on ca2+ dynamics, revealing only cell-level activities, not more detailed molecular mechanisms.

discussion
in our model, the hsn neurons can be seen as an information integration center, processing signals from uv <dig> and vc cells on top of their own autonomous activity. hsn functions as a digital 'nor' gate, giving the output of "1" only if both vc and uv <dig> are inactive. the 'nor' gate is the most universal logical gate in that it can be used to create all other  <dig> elementary logical gates . this means that even the most complex computers  can be constructed based solely on a combination of 'nor' gates  <cit> . the hsn egg-laying circuit is potentially an elegant example of a biological implementation of a 'nor' calculation. it will therefore be a valuable system for more detailed studies of this mechanism, which may have intriguing implications in general biological computations.

this model immediately suggests some new characteristics of the temporal pattern that may be worthy of future investigation. according to our model, the number of eggs per cluster will be maintained at a relatively constant level, as it directly controls the switching off of the active state. furthermore, if our model is correct, the distance between the hsn and uv <dig> cells should influence the number of eggs laid per cluster, because the longer the distance, the more neurohormone releasing events are required to build up a high enough concentration of hormone to terminate the active phase. interestingly, hsn cells are first born at the tail and migrate to a location close to the vulva, traveling almost half of the body length . by evolution, the final position of hsn might be naturally selected to produce a certain number of eggs per cluster to achieve the best strategy for long-term species survival. it will be interesting to see if different natural variants of c. elegans have different hsn-vulva distances.

previously, the clustered temporal pattern in egg-laying was described mathematically as two poisson processes with different time constants ) and a switching probability p  <cit> . the model we developed from biological evidence fits that mathematical description surprisingly well and suggests possible specific biological pathways controlling each parameter. the poisson-like nature of both long and short interval distributions can be explained by the hsn cells randomly switching back to the egg-laying state after being inhibited by either the vcs or the uv1s; the intra- and inter-cluster time constants correspond to the kinetics of these two switching events, respectively. the switching probability p in the mathematical description corresponds to how many consecutive egg-laying events in a cluster are required to activate the uv <dig> pathway. the value of p is determined by the distance between the hsn and uv <dig> cells together with the diffusion constant of uv <dig> neurohormones. this could potentially be validated in morphogenesis mutants, where the distance between neurons is altered.

recently it has been found that reversal behavior of worms can also be described as a sum of two exponential processes . therefore, controlled autonomous switching might be is regular feature of many behaviors . for c. elegans egg-laying, two two-cell circuits, uv1-hsn and vc-hsn, control the state alternation. it will be interesting to see whether or not equivalently structured circuits are employed in other behavioral control situations.

CONCLUSIONS
in systems biology, the usefulness of a computational model is mainly determined by its predictive power. the cellular and molecular model we present here is the first one for generating a clustered pattern and so far the simplest to explain all available data, including our own extensive genetic manipulation results and behavior recordings. at the same time it makes a number of very concrete, testable predictions that can now be explored by further experimentation, using additional advanced technologies. for instance, we suggest using vulva developmental mutants, which are incapable of accomplishing egg-laying, to confirm the existence of the postulated negative feedback loops. likewise, the activity of the uv <dig> cells can be imaged using cameleon ca2+ indicators to see whether or not they are activated by egg-laying events. if the vcs directly sense egg-laying events, they are predicted to contain touch sensitive channels, which could be identified by electrophysiological studies. finally, we predict that the egg-number per cluster is determined by the diffusion distance between hsn and the uv <dig> cells, which can again be tested in mutants or ablated animals. testing concrete predictions like these will lead to a refined understanding of the molecular and cellular circuitry underlying the complex behavior of this important neurobiological model animal.

