BACKGROUND
for template-based modeling  and fold recognition methods, a prediction model can be built based on the coordinates of the appropriate template  <cit> . these approaches generally involve four steps: 1) a representative protein structure database is searched to identify a template that is structurally similar to the protein target; 2) an alignment between the target and the template is generated that should align equivalent residues together as in the case of a structural alignment; 3) a prediction structure of the target is built based on the alignment and the selected template structure, and 4) model quality evaluation. the first two steps significantly affect the quality of the final model prediction in tbm methods.

the secondary structure of a protein is often more conserved than the amino acid sequence, and the prediction accuracy of the secondary structure has been achieved ~80% on average. recently, a number of methods, integrating secondary structures  with primary amino acid sequences, have successfully detected the homologs with remote similarity for automated comparative modeling  <cit>  and fold recognition  <cit> . these methods often used two separated substitution matrices  <cit>  to score secondary structures and primary amino acids, respectively, for aligning a residue pair. the separated matrices are unable to reflect the real score because the amino acid type often prefers to a specific secondary structure.

here, we have developed a substitution matrix, called s2a <dig>  which considers the properties of the secondary structures and amino acid types. the s2a <dig> is a  <dig> ×  <dig> matrix that considers all possible pair combination of  <dig> amino acid types and three secondary structure elements. this matrix was evaluated on the lindahl benchmark  <cit>  for fold recognition and the prosup benchmark  <cit>  for alignment accuracies. according to these evaluation results, the s2a <dig> matrix has higher accuracy than position specific scoring matrix  generated by psi-blast and prof_sim for fold recognition and sequence alignments. by integrating the s2a <dig> matrix and pssm, each having a unique scoring mechanism, the 2-v <dig> server blends the sequence profile and secondary structure information so that they work cooperatively.

numerous enhancements and modifications were applied to original  <dig> servers 2-original)  <cit>  and 2-casp <dig>  <cit>  which participates the casp <dig> experiment, thereby improving the reliability and applicability of the method. there are four main differences in methodology between the present server 2-v2) and our previous works . first, 2-v <dig> integrates s2a <dig> matrix and pssm for the template selection and the target-template alignment to replace a consensus strategy applied in the 2-original server. second, we modified the ssearch  <cit>  search method to replace the psi-blast search method and smith-waterman algorithm applied in the 2-original server and 2-casp <dig>  respectively. third, 2-v <dig> utilized a new multiple template method for modeling different domains of the target sequence. finally, 2-v <dig> added a multiple model strategy and utilized proq  <cit>  to assess and select the final model. we have assessed the prediction accuracy of the 2-v <dig> server based on the  <dig> tbm targets of the casp <dig> dataset. the experimental results show that the s2a <dig> matrix, multiple-template and multiple-model strategies are able to significantly improve the accuracies for protein structure prediction and modeling when the sequence similarity between the template and the target is in the twilight zone.

methods
figures  <dig> and  <dig> show the framework of the 2-v <dig> server for protein structure prediction. 2-v <dig> uses the s2a <dig> matrix and the pssm for the template selection and the target-template alignment. 2-v <dig> first applied the query sequence to generate a pssm by running three iterations of psi-blast against a non-redundant sequence uniref <dig>  <cit>  with an e-value cutoff of  <dig> . the pssm was then used as the input for the psipred  <cit>  tool to predict the secondary structure of this query. we then modified the ssearch  <cit>  search method, using the s2a <dig> matrix and the pssm as the scoring matrices, to identify the template from the protein structure library, and to generate the target-template alignment. the library consists of  <dig>  non-redundant structures  selected from protein data bank   <cit> . the secondary structures of each structure in the library were assigned using dssp  <cit> . based on various target-template alignments of top-ranking  <dig> selected templates, 2-v <dig> generates  <dig> protein structures using modeller  <cit> . finally, the program proq was used to evaluate these models and to select the final model for the target. the s2a <dig> matrix, the aligned method, the modeling process and the final model selection are described in the following subsections. the components of the 2-v <dig> server were built using c, perl and php .

s2a <dig> matrix
a substitution matrix is the key component of protein sequence alignment methods. we developed the s2a <dig> substitution matrix  applying a general mathematical structure  <cit> . to calculate the s2a <dig>   <dig> structural pairs   <cit> , which are structurally similar and with low sequence identity, were selected from scop  <dig>   <cit>  based on two criteria: 1) the root-mean-square deviation  of a protein pair was be less than  <dig>  Å, with more than 70% of aligned residues included in the rmsd calculation, and 2) the sequence identity of a pair is less than 40%. the selected protein pairs had an average sequence identity of 26%, an average rmsd of  <dig>  Å and average aligned residues of 90% . the program dssp was used to assign the secondary structure for each residue of these  <dig> structural pairs. the eight types of the secondary structure used in dssp were reduced to three commonly accepted types , e  and c ) according to the following scheme:  → h;  → e;  → c. the  <dig> amino acid types and  <dig> secondary structure types were converted into  <dig> residue-structure  types.

the s2a <dig> matrix  reveals substitution preferences between homologs with low sequence identity, and was developed in a similar way to blosum <dig>  <cit>  based on these  <dig> structural pairs. the entry , which is the substitution score for aligning a rs letter i, j pair , of the s2a <dig> matrix is defined as sij = λlog <dig>  where λ is a scale factor, and qij and eij are the observed and expected probabilities, respectively, of the occurrence of each i, j pair. the observed probability is given by , where fij is the total number of aligning i, j pairs in these  <dig>  rs letters. the factor eij = pipj if i = j; otherwise, eij = 2pipj , where pi is the background probability of occurrence of the letter i, and equals . the substitution score is greater than zero  if the observed probability is greater than the expected probability. by contrast, sij <  <dig> if qij <eij. the λ is optimized by the salign set  <cit> , and is set to  <dig>  according to the performance and efficiency.

scoring and alignment methods
we modified the ssearch program  <cit> , which used a rigorous smith-waterman algorithm  <cit> , to search for similarity between a query sequence and template sequences in a library. we optimized the score between the query and template using both s2a <dig> and pssm matrices based on alignment accuracies on the salign set. the score is given as

  

where i and j are rs letters on the query and the template, respectively; wstru is a structure-dependent scoring weight, and is set to  <dig> ,  <dig>  and  <dig>  for α-helix, β-strand and coil, respectively; ws2a <dig>  is the weight of the s2a <dig> matrix; s2a <dig> and pssmquery are the scores of s2a <dig> and pssm matrices, respectively, when the rs letter i is aligned to the rs letter j. in addition, we considered structure-dependent gap penalty. here, wgap is a structure-dependent gapping weight, set to  <dig>  ,  <dig>   and  <dig>  , respectively; gs2a <dig> is the gap opening penalty  and the gap extension  for the s2a <dig> matrix. these weights were optimized based on the salign set. gpssm refers to the pssm, where the gap opening penalty is  <dig> and gap extension is  <dig> according to the default parameters of psi-blast.

statistics and template selection
ssearch provides the statistical significance for library searches. the local sequence similarity score  follows the extreme value distribution, so that p =  <dig> - exp) where m, n are the lengths of the query and library sequence. the score shows that the average score for an unrelated library sequence increases with the logarithm of the length of the library sequence. ssearch uses simple linear regression against the log of the library sequence length to calculate a normalized "z-score" with mean  <dig>  regardless of library sequence length, and variance  <dig>  these z-scores can then be used with the extreme value distribution and the poisson distribution to calculate the number of library sequences to obtain a score  greater than or equal to the score obtained in the search. the top-ranking  <dig> templates with the lowest e-values were considered as the templates if the e-values <  <dig> . for each structure in the top-ranking  <dig> templates, the 2-v <dig> server generated six alternative target-template alignments by using different s2a2-matrix  weights, including  <dig>   <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig> . finally, we yielded  <dig> target-template alignments for a target protein.

model building and evaluation
protein structure models were built using the homology modeling tool, modeller  <cit>  according to the selected template and target-template alignment and then the ability to discriminate a correct protein model from incorrect models is critical when a server used multiple model methods. here, we utilized the program proq  <cit>  to assess the quality of protein models based on the lgscore  <cit>  and a model was considered correct if the lgscore was greater than  <dig>   <cit> . the 2-v <dig> server first selected the protein model, generated by the first rank template with ws2a <dig> =  <dig>  as the seed model. the lgscore of the seed model was then compared with those of the other models based on the top-rank  <dig> templates with different ws2a <dig> weights. a model was chosen as the final one if it had the highest lgscore and its lgscore  was significantly better than that of the seed model. otherwise, the server selected the seed model as the final model.

multiple-template method
2-v <dig> considered a target as a multiple domain protein if any region with > <dig> residues has non-aligned residues to the template when using above "model building and evaluation" steps. for a multiple domain protein, 2-v <dig> automatically decided domain boundaries based on the borders of the large gaps between the target and the template, and repeatedly executed above steps to model the structures of the non-aligned residues . finally, these multiple models were then used as structure templates to generate the full-length final model for the query protein.

utility
input format
the 2-v <dig> server is an easy-to-use web server . users input the query protein sequence in fasta format. the server provides three modes  for choosing template . the default mode is 'automatic'. in this mode, 2-v <dig> automatically selects the modeling template. for the 'manual' mode, our server enables users to assign specific template from a list of candidates . the 'use this template' mode allows users to assign a specific protein structure as the template. finally, 2-v <dig> transmits the predicted results to the users by email addresses.

output format
the 2-v <dig> server typically yields a predicted structure within  <dig> minutes if the query sequence length is ~ <dig>  the server shows a list of templates, selected template, target-template alignment, predicted structure and structure evaluations . the predicted structures are visualized in png format generated by the molscript  <cit>  and raster3d  <cit>  packages. if the user clicks a png picture, then the corresponding protein 3d structure is also displayed on the astexviewer  <cit>  . a user can download the predicted structure coordinates in the pdb format. the server also provides the target-template alignments and the structure quality factors .

modeling of ever shorter telomeres 3
the ever shorter telomeres  <dig> , which is essential for telomere replication in vivo, is a small regulatory subunit of telomerase from saccharomyces cerevisiae. according to structure prediction combined with in vivo characterization, it has been reported that est <dig> consists of a predicted ob-fold  with structurally similar to the ob-fold of the human tpp <dig> protein  <cit> . because of the limited degree of conservation between these two protein families, these two proteins could not be recognized from simple sequence profile methods. additionally, the original  <dig> -v <dig> server could not recognize them.

for the target est <dig>  the  <dig> -v <dig> server selected the ob-fold domain of the tpp <dig> protein  from homo sapiens as the template  <cit> , with an e-value of  <dig> . this template shared only  <dig> % sequence identity with the query sequence. figure 2c shows the target-template alignment. the server successfully recognized tpp <dig> as the template since the secondary structure identity between the template and est <dig> was  <dig> %. our method could align together three conserved residues , which are primarily involved in protein folding and/or stability of the ob-fold. seven amino acid positions , which are structurally similar between the two protein families, were also aligned. these  <dig> aligned residues, depicted in cyan, are clustered in the interior of the core of the ob-fold .

RESULTS
in the template-based protein structure prediction, the template selection and the target-template alignment are the two critical steps, since they will significantly affect the quality of the final model prediction. the template selections and the sequence alignments of the proposed method with the s2a <dig> matrix were evaluated by the lindahl benchmark  <cit>  and prosup benchmark  <cit> , respectively. in general, it is neither straightforward nor completely fair to compare the results of different fold-recognition and alignment methods given that each employs different sequence databases for sequence profiles, structure databases for structure profiles and properties, release dates, and scoring functions. therefore, the comparisons between our methods and other published methods serve as an approximate guide. here, we evaluated s2a <dig> matrix, psi-blast and prof_sim using the same sequence database, uniref <dig>  <cit> , with the same parameters to generate a pssm for fold recognitions  and sequence alignment . furthermore, 2-v <dig> was assessed and compared with other  <dig> automatic servers on  <dig> tbm targets in casp <dig>  please note that 2-v <dig> did not participate in the casp <dig> experiment.

evaluation of s2a <dig> matrix
the s2a <dig> matrix  offers insights about substitution preferences of rs letters between homologous protein sequences . the highest substitution score in this matrix is for the alignment of a rs letter 'wβ' with a rs letter 'wβ', where wβ is the residue trp with the β-strand structure . this substitution score is  <dig> . in addition, the substitution scores are also high when two identical structural letters  are aligned. for example, the alignment scores are  <dig>  and  <dig>  while 'wα' and 'cα' are aligned with 'wα' and 'cβ', respectively; where wα is the residue trp with the α-helix structure and cα represents the residue cys with the α-helix structure. most of the substitution scores are positive if two rs letters in the same secondary structure are aligned. on the other hand, the lowest substitution score is - <dig>  in this s2a <dig>  all of the substitution scores are low when the helix rs letters are aligned with the strand rs letters. the above relationships are in good agreement with biological functions of the relevant structures, showing that the matrix s2a <dig> embodies conventional knowledge about secondary structure conservation in proteins.

we compared the s2a <dig> matrix with blosum <dig>  the highest substitution scores are  <dig>   and  <dig> . in contrast, the lowest score for s2a <dig>  is much lower than that for blosum <dig> . the main reasons for this large difference are that α-helices and β-strands constitute very different protein secondary structures, and the rs letters pertaining to these two types of structure are more conserved than amino acid sequences. these results demonstrate that the rs letters with the s2a <dig> matrix may be able to more accurately find remote homologous sequences than simple amino acid sequence analyses.

template selection
for the template selection, our method with s2a <dig> matrix was compared to other methods on lindahl benchmark  <cit> , which consists of  <dig> proteins, for the fold recognition. this set included  <dig>   <dig> and  <dig> assignments for the family, superfamily and fold levels, respectively. the s2a <dig> matrix outperforms psi-blast and is comparative to other methods on this set . our method , incorporating pssm into s2a <dig>  is the best for detecting similarity on the superfamily and fold levels for the top five ranks among the  <dig> comparative methods. at the superfamily level, the s2a2+pssm, psi-blast and prof_sim  <cit>  identified  <dig> %,  <dig> % and  <dig> % of assignments, respectively. at the fold level, the s2a2+pssm  outperformed psi-blast  and prof_sim  in identifying homologous pairs.

athis work.

b, c, d, e, fresults are summarized from previous works  <cit> , respectively.

target-template alignment
for the alignment between the target and the template, our algorithm was evaluated based on the prosup benchmark  <cit> , which consists of  <dig> protein pairs with significant structural similarity but with sequence identity of no more than 30%. the total numbers of correctly aligned residue pairs  of the s2a <dig>  s2a2+pssm, prof_sim and ssaln  <cit>  were  <dig>   <dig>   <dig> and  <dig> pairs, respectively . the percentage σ <dig>  of the s2a <dig>  s2a2+pssm, psi-blast, prof_sim and ssaln were  <dig> %,  <dig> %,  <dig> %,  <dig> % and  <dig> %, respectively. the s2a <dig> matrix is significantly better than those of sequence-based approaches, including fasta, psi-blast and prof_sim. the s2a2+pssm achieved the highest alignment accuracy with slightly better than sparks  <cit>  and ssaln, and much better than the other comparative methods.

athis work.

bresults from qiu and elber  <cit> .

cresults from zhou and zhou  <cit> .

dresults from domingues et al.  <cit> .

etc and tm are total numbers of correctly aligned and missed residue pairs, respectively; ti is the total number of incorrect aligned pairs; σ <dig> is the average percentage of correctly aligned residues

casp <dig> structure prediction
our previous server 2-casp8) and other  <dig> servers participated in the casp <dig> competition, involving  <dig> targets for tertiary structure prediction. these  <dig> targets are officially classified into  <dig> tbm domains . the accuracies of these  <dig> servers were evaluated based on the gdt_ts  <cit>  scores directly summarized from the casp <dig> website .

2-v <dig>  2-original and 2-casp <dig> servers were evaluated on these  <dig> tbm targets . the sum of gdt_ts scores were  <dig>  2-v2),  <dig>  2-casp8) and  <dig>  2-original), respectively. 2-v <dig> yielded  <dig> and  <dig> higher gdt_ts scores than 2-original and 2-casp <dig>  respectively, among  <dig> targets. when the sequence identity between the target and template was more than 30%, these three servers achieved similar gdt_ts scores. however, if the sequence identity was less than 20%, the 2-v <dig> server was significantly better than 2-original server  and 2-casp <dig>  using the paired student's t-test . for each target in casp <dig>  table s <dig>  shows the gdt_ts score improvement with contributing components  between the 2-v <dig> and our previous servers.

these  <dig> tbm targets were also used to evaluate the automatic servers participating in casp <dig>  for the templates selection, the accuracy of identifying the best template of the target protein was used to evaluate the performance of these servers . the accuracies of the 2-v <dig> server were  <dig> % and  <dig> % for identifying the top  <dig> templates and top  <dig> templates, respectively. in addition, 2-v <dig> was the rank 6th among these  <dig> severs based on gdt_ts scores . this server is often able to yield reliable predicted structures  if the e-value is less than 10- <dig> .

the top-rank five serves  are better than 2-v <dig> on  <dig> hard targets  . these serves were much slower than 2-v <dig> because they often utilized ab initio methods to build the unaligned loop regions and to generate the models, such as the poing folding system for phyre_de_novo server, the chunk-tasser  <cit>  for pro-sp3-tasser server, and the rosetta fragment-assembly methodology  <cit>  for baker-robetta server. in the near future, our 2-v <dig> server will incorporate ab initio methods to model long-length loops and hard targets.

a sequence identity  between the target and the best template.

bn is the number of targets.

multiple templates for multiple domains
we used the target t <dig> as an example to describe 2-v <dig> for selecting multiple templates to model protein structures . the 2-v <dig> server first selected the 53bp <dig> tandem tudor domains  as the best template. the template 2g3ra aligned a part of regions  to the target, and the model yielded the gdt_ts scores of  <dig>  and  <dig>  for the target t0504-d <dig> and t0504-d <dig>  since the number of the unaligned residues is  <dig> , the 2-v <dig> server used unaligned residues to search the new template for modeling this segment. after search template library, 2-v <dig> selected the phd finger protein 20-like  <dig>  as the template for modeling this unmodeling residues . the gdt_ts score of this model is  <dig>  for the target t0504-d <dig>  the total gdt_ts score improvement is  <dig>  when 2-v <dig> utilizes a multiple-template strategy. conversely, the gdt-ts scores of the 2-original server, using pdb code 2g3r as the template, are  <dig>  ,  <dig>   and  <dig>  , respectively. for the 2-casp <dig> server, the gdt-ts scores using pdb code 2ns <dig> as the template are  <dig>  ,  <dig>   and  <dig>  , respectively.

multiple models and model selection
the target t <dig> selected from casp <dig> was taken as an example to describe the structure modeling of the 2-v <dig> server using multiple-model strategy . when the multiple-model strategy was not considered, 2-v <dig> selected the 2-dehydro-3-deoxyphosphooctonate aldolase  as the best template with an e-value of  <dig> . gdt_ts score of this model is  <dig> . if we considered the top-ranking  <dig> structures  as the modeling templates, 2-v <dig> generated  <dig> alternative target-template alignments for each template, and obtained  <dig> alignments for this target. the software modeller was then applied to generate  <dig> structures for these  <dig> target-template alignments. figure  <dig> shows the best model with the highest lgscores, assessing by the program proq, for each template. the model generated by the template 1nv8a was selected as the final model, because it had the best lgscore  among these  <dig> models. the gdt_ts score of this final model is  <dig> . the 2-v <dig> server using multiple models is often able to effectively improve accuracies when the e-value between the target and the template is more than  <dig> . the average gdt_ts improvements are  <dig>  and  <dig> , respectively, when the e-value ≥  <dig>  and e-value ≤ 1e- <dig> 

t <dig> in casp8
the target t <dig> selected from casp <dig> was taken to describe the structure modeling of the 2-v <dig> server . the target is the big_ <dig>  domain of putative penicillin-binding protein mrca from nitrosomonas europaea atcc  <dig>  this server yielded the best gdt_ts score  among all participating servers for this target.

for the target t <dig>  the 2-v <dig> server selected the c-terminal domain of translation initiation factor 5a protein  from pyrobaculum aerophilum as the template  <cit> . the c-terminal domain is found to be homologous to the cold-shock protein cspa of e. coli, which has a well characterized rna-binding fold. the best template reported in the casp <dig> website is the yeast exosome core, rrp <dig>   <cit> , which contains four domains . the s <dig> domain has the most similar structure to the target t0409-d <dig>  the s <dig> domain also has a common ob fold characteristic of rna-binding protein, with five anti-parallel β strands. figure 8a shows the target-template alignment and the template shares  <dig> % sequence identity with the query sequence. our server could align the five anti-parallel β strands together. figure 8b shows the superposition of the predicted structure  and the x-ray structure  of the target t <dig> 

CONCLUSIONS
this study presents an automatic server for protein structure predictions by applying numerous enhancements and modifications to the original technique, thereby improving the reliability and applicability. by integrating the s2a <dig> and pssm matrixes, the 2-v <dig> server seamlessly blends the amino acid and structural propensities so that they work cooperatively for the template selection and target-template alignments. in addition, our 2-v <dig> utilizes multiple templates and multiple models for building models and assessing models. experimental results demonstrate that the 2-v <dig> server is efficient and effective for template selections and target-template alignments in template-based modeling. we believe that this server is useful in protein structure prediction and modeling, especially in detecting homologous templates with sequence similarity in the twilight zone.

availability and requirements
project home page: 

operating system: platform independent

programming language: c, perl and php

other requirements: javascript-enabled web browser

any restrictions to use by non-academics: none

competing interests
the authors declare that they have no competing interests.

authors' contributions
conceived and designed the experiments: ccc and jmy. performed the experiments and analyzed the data: ccc and jmy. contributed reagents/materials/analysis tools and wrote the paper: ccc, jkh and jmy.

supplementary material
additional file 1
program. the 2-v <dig> program.

click here for file

 additional file 2
figure s <dig>  the s2a <dig> matrix.

click here for file

 additional file 3
table s <dig>  the summary of  <dig> tbm targets in casp <dig> 

click here for file

 additional file 4
table s <dig>  the gdt_ts scores of the 2-original, 2-casp <dig> and 2-v <dig> servers on  <dig> tbm targets.

click here for file

 additional file 5
figure s <dig>  comparison of the 2-v <dig> server with top-ranking  <dig> servers participating in the casp <dig> competition for the template selection on  <dig> tbm targets. the best templates are directly summarized from the casp <dig> website .

click here for file

 additional file 6
figure s <dig>  the relation between e-values and gdt_ts scores of 2-v <dig> for the targets in casp <dig>  2-v <dig> often yields reliable predicted structures if the e-value is less than 10- <dig> 

click here for file

 additional file 7
table s <dig>  comparison of the 2-v <dig> server and top five servers in casp <dig> 

click here for file

 additional file 8
table s <dig>  2-v <dig> results for using single-model and multiple-model strategies on  <dig> targets in casp <dig> based on gdt_ts scores.

click here for file

 acknowledgements
j.-m. yang was supported by national science council and partial support of the atu plan by moe. authors are grateful to both the hardware and software supports of the structural bioinformatics core facility at national chiao tung university.
