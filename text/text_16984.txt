BACKGROUND
protein structure comparison is an important tool that helps biologists understand various aspects of protein function and evolution. unfortunately highly accurate protein structure comparison methods are computationally expensive and therefore are not suitable for large-scale analysis, such as when all pairwise comparisons have to be performed for a large number of protein structures. one approach for speeding-up protein structure comparison is the projection approach, where a protein structure is mapped to a vector in a high-dimensional space. once the mapping is done, protein structure comparison is reduced to a distance computation between the corresponding vectors and therefore is very efficient. for example, it was shown  <cit>  that once vector representations are computed it takes on average  <dig> seconds for a projection method to perform all pairwise comparisons among  <dig>  domains.  however, the advantage of the projection approach is also one of its main limitations; namely, in the process of mapping, some structural information is lost. furthermore, there is no agreement on what constitutes a good projection technique, and currently known projection methods  <cit>  utilize very different approaches to the mapping construction, both in terms of which structural information is included and how this information is integrated to produce a vector representation.

recently, zotenko et al.  <cit>  performed a comprehensive comparison of projection methods in the context of two typical applications for such methods, high-throughput protein structure comparison and classification. the authors found that the ssef method  <cit>  performed the best in their tests, followed closely by the lff method  <cit> . both methods use the same general approach, which we call structural footprinting, to construct the mapping:  select a representative set of structural fragments as models,  map a structure to a structural footprint, a vector in which each dimension corresponds to a particular model and "counts" the number of times the model appears in the structure.  while both methods use the same strategy to integrate the structural information, they differ substantially in the type of structural fragments used as models and their representation. the lff method  <cit>  uses a pair of backbone segments  as a structural fragment whose conformation is described by a set of  <dig> inter-atomic distances between the corresponding cα atoms. the ssef method  <cit>  uses a triplet of secondary structure elements  as a structural fragment whose conformation is captured by a set of pairwise angles and distances between the corresponding sse vectors. even though the comparison results of zotenko et al.  <cit>  show that the structural footprinting is an adequate approach to the mapping construction, we are not aware of any systematic study that evaluates the effect of the choice of structural fragments on the ability of a structural footprinting method to detect different types of structural similarity.

the main objective of this work is to explore in detail the dependence of a structural footprinting method on the set of structural fragments it selects to model the structure and their representation. towards this end we focus our attention on three structural footprinting methods that vary significantly in their selection of models. to complement the lff and ssef methods described above, we have designed a structural footprinting method that uses contiguous segments  of protein backbone as structural fragments; we call this method the segf method. the conformation of a backbone segment is captured by a set of fourteen shape descriptors introduced by rogen et al.  <cit> . these descriptors build upon a geometric invariant inspired by the writhing number of a closed space curve  <cit> , a concept from knot theory. as opposed to the common geometric invariants such as angles and distances, the fourteen shape descriptors lack intuitive interpretation, with each descriptor being a function of many factors .

we benchmarked the methods' performance against the cath database  <cit> . cath is an hierarchical classification of protein structures, where protein domains are classified into groups at the class, architecture, topology , and homologous superfamily levels. members of the same homologous superfamily group share a clear common evolutionary origin supported either by significant sequence similarity or significant structural and functional similarity, and several superfamilies are grouped into topology  groups based on significant structural similarity. the architecture level further groups proteins based on coarse topological organization of secondary structure elements. finally, the class level groups proteins according to secondary structure element content: mainly α, mainly β, mixed α and β, or small structures.

in the first set of experiments we compared the methods' ability to detect structural similarity characteristic of evolutionarily related structures, i.e., structures within the same cath superfamily. in a recent study  <cit> , reeves and colleagues analyzed the extent and nature of structural diversity across different superfamilies in the cath database. in particular, it was shown that some superfamilies, especially those from layered architectures such as mainly β or α-β sandwiches, are much more structurally diverse than others. moreover, the repertoire of structural changes is very rich, ranging from changes in conformation of the loop regions, to changes in the orientation of secondary structure elements, to insertion/deletion of secondary structures or even whole super-secondary structure motifs. thus, studying the relative performance of the methods across different superfamilies allowed us to observe the relative strengths and weaknesses of the methods in a variety of settings and to propose two strategies to combine the methods to achieve a better performance. we showed that combination methods provide a significant improvement in performance. even though the method that uses the sse information has the best performance on average, combining the methods allows better handling of the whole spectrum of structural variability exhibited by various cath classification groups.

recently several groups  <cit>  demonstrated the existence of meaningful structural relationships between protein domains classified in different folds. harrison and colleagues  <cit> , for example, introduced a measure of gregariousness, where the gregariousness of a fold quantifies how many other folds have a significant structural overlap with it. the presence of common structural motifs, often on a level of super-secondary structure elements, emerged as one of the main reasons for these inter-fold similarities. as a structural footprinting method measures structural similarity based on the presence/absence of common structural fragments, inter-fold similarities of this kind should be prominent in the method's view of the protein structure universe. therefore, in the second set of experiments we tested how the method's definition of structural similarity extends beyond the superfamily level and whether it agrees with the boundaries imposed by the classification groups at the class, architecture, and fold levels of the hierarchy. to study these similarities in a systematic way we defined an affinity score of one superfamily towards the other, which measures how well the method retrieves members of the second superfamily using the members of the first superfamily as queries. we developed a set of techniques that allowed us to summarize the affinity scores for a particular method to expose the agreement between the method and the cath classification hierarchy.

RESULTS
the evaluation procedure
in this work we used the cath database  for benchmarking purposes. we used a set of non-redundant domains  as our set of database domains. from these we selected a set of  <dig> well-populated superfamilies that span  <dig> folds,  <dig> architectures and  <dig> classes . given a structural footprinting method and a well-populated superfamily, every member of the superfamily was used by the method as a query to rank the remaining database domains. we then used the roc <dig> scores  <cit> , which measure to what extent the positives  precede the negative results , to quantify the method's ability to retrieve the other members of a superfamily given one member as a query.

in what follows we use the cath numbering system to refer to individual superfamilies, folds, architectures, and classes. the cath number of a classification group encodes its position within the hierarchy. thus, for example, the  <dig> . <dig>  superfamily is in the  <dig> . <dig> fold group, in the  <dig>  architecture group, and in the  <dig> class group.

structural similarity at the cath superfamily level
even though the ssef method has the best performance on average , no method performs consistently the best over all superfamilies. figure  <dig> shows the roc <dig> scores as a scatter plot; there is one plot per pair of methods; each superfamily is a point on the plot with the coordinates being the roc <dig> scores of the corresponding methods. the performance of the methods is poorly correlated, especially that of the ssef and segf methods. the poor correlation can be attributed to the fact that the methods capture different aspects of protein structure in their footprints. thus structural differences between the members of a superfamily may "confuse" some methods more than others and the amount of confusion depends on how these structural differences affect the structural footprint produced by the method.

to illustrate this point let us consider three outliers in figure  <dig>  superfamilies for which the performance of one method is quite different from that of another, the  <dig> . <dig>  ,  <dig> . <dig>  , and  <dig> . <dig>   superfamilies.

the poor performance of the ssef method on the  <dig> . <dig>  superfamily can be partially attributed to variability in secondary structure assignment as shown in figure  <dig>  since the second helix in the 1quua <dig> domain is split into two helices, the 1quua <dig> domain has four sse triplets that participate in the footprint construction, while the 1cuna <dig> domain has only one such triplet. in this case, the structural change that produced an additional sse is small and therefore both the segf and lff methods perform well since they do not use secondary structure information. in general, the ssef method is most sensitive to structural changes that affect the number and/or relative orientation of sses.

in contrast, the structural variability exhibited by the members of the  <dig> . <dig>  superfamily does not affect the performance of the ssef method, but it does affect the other two methods. as shown in figure  <dig>  the members of this superfamily have approximately the same number of sses, and they are oriented in roughly the same way.

the  <dig> . <dig>   superfamily contains structural representatives of the pas domain, a family of sensor protein domains involved in signal transduction  <cit> . the common fold shared by the pas domains is flexible to accommodate binding of a large variety of co-factors, which allows pas domains to serve as input modules in proteins that sense light, redox potential, and other stimuli  <cit> . as shown in figure  <dig>  in this case the structural variability characteristic of the members of this superfamily confuses the lff method more than the other two methods.

it is reasonable to assume that for structurally conserved superfamilies all three methods would perform well. to check this hypothesis we color coded the points in the scatter plots of figure  <dig> according to the structural diversity of the corresponding superfamilies, where red color denotes the most structurally conserved superfamilies and blue the least structurally conserved superfamilies. even though the concentration of the red points in the upper-right corner is clearly visible on all three plots, there are structurally conserved superfamilies for which one or more methods do not perform well. this can happen when a small structural change triggers a big change in the structural footprint produced by the method; consider for example performance of the ssef method on the  <dig> . <dig>  superfamily discussed above. another reason for a poor performance of a method on a structurally conserved superfamily is its inability to distinguish between the members of the superfamily and members of other superfamilies that are composed of similar structural fragments but have different overall structure.

combining the methods
can we take advantage of variation in performance of the methods across different superfamilies, i.e. can the output of the methods be combined in such a way as to leverage their relative strengths? to answer this question we have studied two combination strategies: voting and linear combination of similarity scores. given a query domain, both strategies use the original similarity scores to produce a new ranking of database domains. in voting, each method's similarity scores are first used to rank the database domains. the new score of a database domain is determined by averaging the domain's positions in the three original rankings, with ties being resolved arbitrarily. in linear combination, a new structural similarity score between the query and a database domain is defined as a linear combination of the original similarity scores, where the optimal coefficients are learned with a support vector machine   <cit>  from a set of positive and negative examples . the new similarity score is then used to rank the database domains.

as shown in table  <dig>  the average roc <dig> scores increase from  <dig>  , to  <dig>  , to  <dig>  . even with the simple voting strategy we obtain an improvement of  <dig>  over the best  method; the introduction of weights  further improves the performance by  <dig> . we used the binomial sign test for two dependent samples  <cit>  to evaluate the statistical significance of improvements due to combination. this test can be applied to evaluate whether a number of superfamilies on which one method outperforms the other differs significantly from what would be expected by chance. we found that both combination strategies significantly improve over the ssef method: the improvement due to voting has a p-value of  <dig> e- <dig> and improvement due to linear combination has a p-value of  <dig> e- <dig> 

the success of a combination strategy largely depends on how consistent are the methods in their ranking of false positives. the combination is most effective when the methods disagree on their ranking of false positive domains, i.e., false positive domains ranked near the top by one method are ranked near the bottom by other methods. thus the success of a combination strategy is a function of the methods being combined. to find out which pair of methods are the most complementary, i.e., their combination gives the best results, we repeated the linear combination experiments for all pairs of methods. the outcomes of these experiments  indicate that combination of the ssef and segf methods gives the best results. this outcome demonstrates that the stand-alone performance is of lesser importance for combination purposes. indeed, while the segf method is the weakest among the three methods, its performance is the least correlated with that of the ssef method .

the success of the combination strategies supports our hypothesis that the methods are indeed complementary i.e., no single approach is able to deal with a full spectrum of structural variability exhibited by different superfamilies. moreover, we observe that the combination of two least correlated methods  is better than ssef+lff or lff+segf.

structural similarity at the cath class, architecture, and fold levels
so far we have evaluated whether the methods' definition of structural similarity agrees with the cath hierarchy at the superfamily level. here we extend this evaluation to the higher  levels of the hierarchy by studying the similarities, as seen by a particular method, among different superfamilies. to quantify these similarities we introduce an affinity score between a pair of superfamilies which measures how well the method retrieves the members of the second superfamily using members of the first superfamily as queries. more formally, the affinity score of superfamily a towards superfamily b is an average roc score over all rankings of database domains produced by the method with the members of a as queries, where the positives are the remaining members of a plus members of b and the negatives are all other domains in the database. it should be noted that affinity scores are not symmetric, i.e., affinity of a towards b is not necessarily the same as affinity of b towards a.

affinity scores can be used to construct an affinity graph a
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@ for a set of superfamilies under investigation; the affinity graph is a complete directed graph with weighted edges, where vertices are superfamilies and weights are affinity scores. the affinity structure of this set of superfamilies can be exposed by a simplified and thresholded representation of the affinity graph, a
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@, where there is an undirected edge between a pair of superfamilies if and only if both affinity scores are above the threshold τ. figure  <dig> shows such a graph for the ssef method . by relating the interconnection patterns in this graph with the known cath classification we can quickly detect where the method's definition of structural similarity violates the boundaries imposed by the hierarchy; consider, for example, an interconnection pattern where a superfamily is connected to a superfamily outside its fold while having very few connections to superfamilies within its fold. for the ssef method ), one such violation is around the  <dig> . <dig>  superfamily. the  <dig> . <dig>  superfamily is connected to the  <dig> . <dig>  superfamily but not to the  <dig> . <dig>  or  <dig> . <dig>  superfamilies within the same fold. .) a similar example is around the  <dig> . <dig>  superfamily; indeed, this superfamily's only connection is to  <dig> . <dig> . in this case the ssef method is unable to distinguish between two different orientations of the last α-helix relative to the β-sheet in  <dig> . <dig>  and  <dig> . <dig>  superfamilies and therefore deems the  <dig> . <dig>  superfamily to be more similar to the  <dig> . <dig>  than to say the  <dig> . <dig>  superfamily.  for structures of representative domains.)

we can also use affinity scores to quantify the agreement between the method and the hierarchy for individual classification groups. given a classification group, we say that there is a perfect agreement between the method and the hierarchy if, for every member superfamily, within-the-group affinity scores  are higher than outside-the-group affinity scores . the agreement is rarely perfect; thus we measure the amount of agreement  for every superfamily within the group and set the degree of agreement for the group to be an average of these values. the agreement values range from  <dig>  to  <dig> , where  <dig>  corresponds to the lowest agreement. in general, an agreement value close to one means that from the method's perspective the corresponding classification groups are structurally isolated from other groups, i.e., the composition of its member protein domains in terms of structural fragments used by the method to model the structure is quite different from that of domains in other groups.

once again we observe that no one method has the highest agreement with the cath hierarchy over all groups at a given classification level. but on average  the ssef method agrees the most with the cath hierarchy at all levels. this not surprising given that the class, architecture, and fold levels of the cath hierarchy are defined in terms of secondary structure. therefore, a method that captures the relationship between secondary structure elements in its footprint is expected to perform better at detecting relationship at these levels. we also observe that all three methods achieve the highest average agreement values at the fold level, which is not surprising since the fold level groups structurally similar superfamilies.

CONCLUSIONS
in this work we evaluated the effect of the model selection process on the ability of structural footprinting methods to detect various types of structural similarity. towards this end we evaluated three methods – the ssef, segf, and lff methods – that vary greatly in terms of what structural fragments are chosen to model the structure and their representation. in our first set of experiments we studied the effect of the structural diversity exhibited by members of well-populated superfamilies in the cath database on the methods' ability to retrieve other members of the group given one member as a query. we found that there is a large variation in performance both across the superfamilies and across the methods. this is consistent with the findings of reeves and colleagues  <cit>  that some superfamilies are more structurally diverse than others. poor correlation in performance among different methods supported the hypothesis that methods are indeed complementary in the following sense: there are types of structural variation that impact some methods to a greater extent than others. we were able to demonstrate the interplay between the nature of the structural variation and the performance of individual methods by looking in depth at several outliers, superfamilies with the most pronounced difference in performance across the methods.

to exploit the complementarity of the methods we tested two strategies, voting and linear combination of similarity scores, to combine the methods' output. we found that both strategies result in significant improvement in average performance over the best method, the ssef method, with the linear combination strategy yielding the biggest improvement. thus, by using a linear combination of the three similarity scores to rank database proteins we were able to improve the average roc <dig> scores from  <dig>   to  <dig> . we next tested which pair of methods is best suited for combination and found that combining the ssef and segf methods gives the best results. this is interesting since the lff method has a significantly better performance on average than the segf method and therefore one might expect that the pair of ssef and lff would be the winner. thus, we conclude that the ability to reverse each others' bad decisions is more important than stand-alone performance for combination purposes.

next we studied whether the methods' definition of structural similarity agrees with the higher  levels of the cath hierarchy. towards this end, we introduced an affinity score as a measure of structural similarity, as seen by a particular method, between a pair of superfamilies. we visualized the affinity scores among well-populated superfamilies by a thresholded affinity graph, where there is a vertex for each superfamily and there is an edge between a pair of superfamilies if both affinity scores are above a certain threshold. by comparing the position of a particular superfamily in the graph to its known cath classification we were able to recover several interesting structural similarities between superfamilies in diffierent fold and even class levels. we also used the affinity scores to quantify the agreement between a particular method and the cath hierarchy for individual classification groups. the agreement values allowed us to identify classification groups that are structurally isolated from other groups and to compare the agreement with the cath hierarchy across diffierent methods. once again we observed that no one method has the highest agreement values across all groups at a given classification level but on average the ssef method agrees the most with the hierarchy.

since a structural footprinting method measures structural similarity based on presence/absence of common structural fragments, we believe that affinity scores produced by the method and their analysis techniques employed in our work can be useful beyond understanding the specifics of the method. in particular, the techniques can easily expose a similar composition of diffierent groups in terms of structural fragments used by the method and thus provide an alternative view of the continuum of the protein structure universe.

