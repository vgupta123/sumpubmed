BACKGROUND
dna sequence alignment is a common step in molecular evolutionary analysis. aligned sequences are used for many purposes, including estimation of patterns of divergence, selection, the tempo and mode of evolutionary change, identification of functional elements and constraints, and phylogenetic history, just to name a few. alignments are a hypothesis of site homology; as evolutionary distance among sequences increases, alignments are known to become less accurate  <cit> . the effect of alignment accuracy on downstream analysis in comparative genomics and bioinformatics is largely an unexplored topic, although some empirical studies have attempted to examine this with respect to functional element identification  <cit>  and phylogenetic analysis  <cit> .

multiple sequence alignment, the alignment of more than two sequences, is generally thought to lead to more accurate alignments than simple pair wise alignments  <cit> . there are numerous approaches to multiple alignment, although most are based in some way on a progressive alignment algorithm  <cit>  where similar sequences are aligned first and additional sequences are progressively added based on their divergence from the initial pair. while empirical studies have demonstrated how multiple alignments perform better than pair wise alignments  <cit> , simulation methodologies have not been employed to characterize the improvement. in the simplest case, one can ask how much a pair wise alignment is improved by the addition of a third sequence . how does varying the position of the third sequence, relative to the first two, affect the alignment? logically, one might hypothesize that the greatest improvement will come when the third sequence is exactly equidistant from the initial pair, splitting the branch separating them in half ; from a rooted perspective, this would be a polytomy. on the other hand, one might expect that the greatest improvement would be found from a third sequence which evenly splits a branch on the rooted tree; in an unrooted perspective this would mean the third sequence is half as close to one of the initial sequences as to the other .

beyond simple accuracy, multiple sequence alignment may affect downstream sequence analysis in unexpected ways relative to pair wise sequence alignment. in a previous study  <cit> , i show that evolutionary distance estimation from dna sequences can be surprisingly robust to alignment error . this previous work was based on alignments of paired sequences; the relationship between accuracy of alignment and distance estimation might differ under multiple alignment conditions.

the primary goal of this study was to use simulation to examine the improvement in alignment accuracy when going from pair wise to multiple alignments, profiling the change versus the position of the additional sequences. how much is the accuracy of alignment of a pair of sequences improved by the addition of a third sequence with an intermediate evolutionary history ? where should the third sequence be in order to maximize the accuracy of the initial pair's alignment? in addition, the effects of these multiple sequence alignment on evolutionary distance estimation were also profiled. does the position of the third sequence have an effect on the estimation of evolutionary distance of the initial pair, independent of the accuracy of the alignments?

RESULTS
accuracy of multiple alignments
additional simulations for 4-taxon trees were also performed . as would be expected from the above results, the maximal improvement in the alignment of sequences a and b was found when the fourth sequence was added to the center of the branch leading from the root to sequence b. simulations of 16-taxon model trees were also conducted to investigate how much improvement can be made with the addition of even more sequences. two extreme 16-taxon trees were used as initial simulation models, a perfectly balanced tree and a perfectly pectinate tree . for both cases, simulations with expected ab distances of both  <dig>  and  <dig>  were conducted and analyzed under the same conditions as the three-taxon phylogenies . the expected accuracies of the ab sequence alignment from a pair wise alignment for these distances are 62% and 7%, respectively  <cit> . the maximal accuracies when a third sequence was added  were 68% and 9%. when all  <dig> sequences were used in a multiple alignment, the observed accuracies of the ab alignment were, respectively, 88% and 38% for the balanced tree and 77% and 19% for the pectinate tree. unsurprisingly, adding additional sequences had a large effect on alignment accuracy when they were added in a balanced fashion and a smaller effect when they were added in a pectinate fashion. also as would be expected, varying the internal branch lengths  or simulating across 16-taxon trees with more realistic branching patterns  yielded intermediate accuracies depending on the exact shape and structure of the tree .

these results add an additional spin to the debate over the importance of taxon sampling in phylogeny reconstruction. although it is generally thought that increased taxon sampling yields more accurate phylogenies, simulation studies have proven to be equivocal and controversial  <cit> . however, all of these studies  tacitly assume perfect sequence alignment. even if increased taxon sampling has no direct effect on phylogenetic accuracy , it certain appears to have an effect on the accuracy of alignment prior to the phylogenetic reconstruction process. how alignment accuracy may directly affect phylogeny reconstruction is a topic in need of further study .

these results also imply a specific strategy for choosing species to sequence when resources are limited. for example, given current estimates of the mammalian phylogeny  <cit> , these results suggest that error in human and mouse sequence alignments could be reduced by about 15% if aligned with a third species with an evolutionary position similar to that of the capuchin  or the blind mole rat . in contrast, inclusion of sequences from the completed rat genome  <cit> , would only be expected to decrease error in human and mouse alignments by about 7%.

multiple alignment and evolutionary distance estimation
one would expect that estimation of evolutionary distance in a multiple alignment setting would follow that of alignment accuracy . for alignments in clustal, this intuition turned out to be surprisingly incorrect. figure  <dig> shows the results of evolutionary distance estimation between sequences a and b from the true alignment, the pair wise ab alignment, and the multiple abc alignments. for the intermediate distances  there was a striking pattern: the estimate of distance between sequences a and b increased linearly under the multiple alignment as the branch leading to sequence c moves closer to the root. this change in distance estimation was uncorrelated with that of alignment accuracy which peaked when sequence c bisected the branch leading to sequence a . the slight dip at the upper end of the curves is explained by the progressive alignment procedure: pair wise alignments and distance estimates are used to set the order of sequence addition in the multiple alignment. when the branch leading to sequence c was close to the root, sequences a and b will occasionally appear to be more closely related to each other than sequence c is to a. when this occurs, a and b are aligned directly  and produce the pair wise distance estimate which was consistently lower than that found from the multiple alignment . this was proved by realigning a subset of the data with sequence c close to the root but specifying the  guide tree rather than allowing clustal to estimate its own. the x marked by an arrow in figure 5b shows the average distance estimate from the abc alignments when the correct guide tree was provided; not only is the average higher than that of the original alignments but it is directly in line with the projected linear increase seen from the alignments where c branches closer to the tips. the largest simulated distance  showed the beginning of a similar pattern to the intermediate distances  before the alignments collapses into random noise . the phylogenetic position of an intermediate sequence appears to bias evolutionary distance estimation, independent of alignment accuracy.

the accuracy  of the pair wise distance estimates were exactly what one would expect from previous work  <cit> . to explain the observed bias in multiple alignment, i partitioned the data that goes into the calculation of evolutionary distance into its base components: observed numbers of transitional and transversional differences. figure  <dig> shows the breakdown for d =  <dig>  and d =  <dig> . each panel has five parts: the percent of observed sites  with the specific change  in the true alignment; the percent of sites with the specific change in the ab alignment; the percent of sites with the specific change in the ab alignment that were correctly aligned ; the percent of sites with the specific change found in the abc alignment; and the percent of sites with the specific change in the abc alignment that were correctly aligned. the true and pair wise alignment both showed the expected pattern of having no relationship between observed  percents of change with a change in the phylogenetic position of sequence c. for the multiple alignment, the proportion of sites correctly aligned  followed the identical pattern seen in figure  <dig>  that is, the peak in alignment accuracy occurs when the branch leading to sequence c bisects the branch leading to sequence a. however, the observed number of transversional changes  increased linearly as the branch leading to sequence c moved closer to the root . the bias in evolutionary distance estimation in multiple sequence alignment appears to primarily be due to an overabundance of hypothesized transversional differences among the sequences.

careful examination of the strict  progressive alignment algorithm  <cit>  used by clustal explains this pattern. when sequences a and b are aligned directly in a pair wise alignment, the hypothesized transitions and transversions are based solely on the properties of these sequences. in the multiple alignment, clustal begins by aligning the closest pair of sequences . the more distant sequence c is from sequence a, the more transversions will have occurred since they shared a common ancestor. more transversions are therefore identified  between this pair during alignment. when sequence b is added to the alignment, numerous potential transversions have already been "set" between sequences a and c. thus, any potential transversional difference between sequences a and b have less cost  than would be found in the corresponding pair wise alignment because a transversion may already have been identified between sequences a and c. the biasing effect of phylogenetic position on distance estimation from pair wise alignment appears to be a consequence of the greedy progressive algorithm implemented in clustal.

this study used clustal because it is one of the most widely used alignment programs, particularly for high-throughput genomic analysis, and tends to be among the most accurate  <cit> . while it is quite possible that the resulting alignments could be improved by changing alignment parameters , the purpose of this study is not to optimize the alignment but rather to examine the difference multiple alignment makes under simple conditions and to see examine downstream effects of these errors on distance estimation.

to partially examine whether the observed results are specific to clustal or may be a more general alignment problem, most of the alignments were repeated with t-coffee  <dig>   <cit> . using the default parameters, t-coffee produced significantly worse alignments and distance estimates than clustal . however, the shape of the alignment accuracy curves were the same . the biasing effect of the position of the third sequence appeared to be less severe, and in some cases, completely absent; unfortunately the differences in accuracy made it difficult to systematically compare these results. unlike clustal, t-coffee uses both global and local pair wise alignments to guide the production of the final global alignment. although it is also a progressive algorithm, the intermediate alignments it produces make use of more information at early stages, which may help prevent the distance estimate bias.

there are many additional multiple dna sequence alignment algorithms and programs available, some of which use similar progressive alignment schemes as clustal and t-coffee but allow for revision of previously aligned sequences, and some of which use very different approaches, including statistical alignments based on maximum likelihood or bayesian methods . some of these methods simultaneously estimate evolutionary distance and alignment  <cit> , while methods for simultaneously estimating phylogenies and alignments are also being developed  <cit> . comparisons of the overall accuracies of some of these programs in pair wise dna sequence analysis has recently been conducted  <cit> . how these programs and algorithms compare under multiple alignment conditions and whether the observed biasing effect is widespread or narrow across algorithms is a task for future investigation.

CONCLUSIONS
multiple sequence alignments do improve upon pair wise sequence alignments. the optimal taxon sampling strategy for maximally improving alignments is to bisect long branches in a balanced framework. independent of alignment accuracy, however, multiple alignment using a progressive algorithm can bias evolutionary distance estimates, with larger estimates consistently found as intermediate sequences appear deeper in the phylogeny.

