BACKGROUND
pattern formation in branching morphogenesis has been the subject of biological speculation since the beginning of embryology  <cit> . on the one hand, theoreticians have stressed that branched trees have a self-similar  nature that suggests a simple, repetitive mechanism of generation  <cit> , <cit> . on the other, anatomists have stressed that branching systems of different organs are easily distinguishable even in silhouette and that, even within the same organ, different generations of branching are distinct. in particular, the first branch events of an organ follow a stereotyped pattern different from subsequent branch events, a fact that has prompted the suggestion that the early branching events might be under the control of a special genetic program  <cit> . the competition between the general repetitive and the particular, sequential models has prompted much research into the molecular cell biology of branching morphogenesis  <cit> .

epithelial branching in developing mammalian organs is now known to be regulated by a large number of factors including mesenchyme-derived signalling molecules and extracellular matrix  <cit> , <cit> . patterning of the tree is usually assumed to be achieved by spatial variation in the production or diffusion of paracrine factors  <cit>  and, in chimeric organs, branching anatomy is controlled mainly by the origin of the mesenchyme  <cit> . these paracrine factors are undoubtedly important but both epithelial cell lines  <cit> , <cit>  and intact epithelia  <cit>  can undergo branching morphogenesis in 3d gels with these factors provided in free solution, with no mesenchymal cells present. the shape of the trees in these 3d gel systems is not completely identical to the organ concerned  but they do consist of a tree with spreading branches. this implies that the epithelium must have its own basic tree-patterning system that causes branches to form and spread out, even when normally mesenchyme-derived factors are ubiquitous rather than patterned. exploration of this idea using mammary epithelial cells in advanced cell culture systems  <cit>  has suggested the possibility of patterning by autocrine secretion, by the epithelial cells, of an inhibitor of invasive activity. here, we extend this idea, previously explored only in simple cell culture, to intact and growing collecting duct trees of developing kidneys growing in organ culture . we find evidence for an autocrine tree-patterning system that spreads branches out by mutual repulsion. the system can also account for the `special¿ anatomy of first branches without the need for any extra `special¿ mechanism. the system involves bone morphogenetic protein  <dig>  signalling.

RESULTS
first branch divergence is significantly greater than that of subsequent branches
in the branched epithelia of developing glandular organs such as kidney and lung, the first branch shows a divergence angle markedly different from divergence angles of subsequent branching events, at least once the branches have had time to elongate  <cit> . throughout this report, we use `divergence angle¿ to refer to the relative directions at which branches lie after they have elongated and responded to any guidance cue present in the system. no claim is made or implied about the shape of a branch tip at the moment of bifurcation.

metanephric kidney rudiments cultured on filters supported by trowell screens grow essentially `two-dimensionally¿. they are thick enough for intact ureteric bud/collecting duct and nephron tubules to form, but are too shallow for these tubules to elongate in any plane except parallel to the substrate. the culture system therefore reduces the problem of tree formation to two dimensions, making analysis and intervention easier. to determine whether the phenomenon of the `special¿ first divergence angle is seen in the two-dimensional system, we measured the divergence angles of first and second generation branches. the first branches  showed a mean divergence angle of 133°  while the next generation of branches showed a mean divergence angle of  <dig> ° .

branch divergence is controlled by presence of other branches
the difference between first and subsequent divergence angles  <cit>  might be explained by arguing that the first branch is made a special `early branch¿ mechanism, before control is handed to a routine branching programme  <cit> . an alternative hypothesis would be that the branching mechanism is the same for all branching events but the angles are controlled by the environment, specifically the presence of other bud tips. to test these two models, branch tips  isolated from unbranched, or from already once-branched, ureteric buds were cultured and the divergence angles of their next-formed branches were measured. isolated tips from unbranched ureteric buds  branched first with a wide divergence angle  then diverged more acutely . tips from buds that had already branched once and were placed in isolation made another open initial divergence angle  characteristic of a normal first branch . subsequent branch events were more acute, as expected for second branch events . these data  show that the change in divergence angle between first and later branching events is controlled by the presence or absence of another nearby tip.

a simple, qualitative computer model for self-avoidance
the direction taken by new branches in all of the cases described above have one thing in common: the branches seem to maximize their separation from other nearby branches. we used computer modelling to test if a secreted repulsive factor could achieve such patterning. the word `model¿ is sometimes misunderstood: we emphasize that what we present here is not intended to be a formal description of a real kidney , but is a simplified system in which ideas can be explored in principle and used to direct experimental confirmation. the model is intended just as an abstract thinking tool to identify promising lines of wet-lab experimentation, and the conclusions of this manuscript rest on the wet lab data, not the details of the model.

the model is of the cellular potts type, in which the tissue is represented by a two-dimensional grid of locations, each of which has a few associated parameters such as concentration of a particular molecule, or occupation by part of a ureteric bud tree. the `tip¿ and `stalk¿ components of the tree are represented with distinct identities. tree tubules are considered to be sources of a factor, horrid, that diffuses away from them. the concentration of horrid arising from any particular point of the tubule, measured at another location in the tissue, decreases exponentially with distance, as would happen for first order decay/loss of a molecule that is either short-lived or is lost to the bulk medium above or below the plane of the tissue. the total concentration at any one point in the tissue is taken as the sum of the contributions to that place from each part of the bud, with some random noise added. the model makes the simplifying assumption that he diffusion of horrid is rapid compared to the speed of growth of the tubules: this is justified by the observation that treating real cultured kidneys with even large proteins such as growth factors or antibodies can produce an immediate effect on subsequent development of their ureteric bud trees, demonstrating that protein diffusion in the system is rapid compared with tree growth. making this assumption allows the concentration gradients to be calculated at each stage from current tree anatomy, with no need for history to be taken into account. the model begins with one or more unbranched stalks. the tip of the stalk and subsequent tree bifurcate only when the local concentration of horrid is below a threshold, and the new tips are regarded as instantly making their own contribution to the horrid field . each tip advances at a rate determined inversely by its local concentration of horrid, in the direction of lowest local horrid as measured in the immediate vicinity of the tip. stalks are left behind by advancing tips, as a slime trail may be left behind by an advancing snail. further details of the model, source code and movies of its output, can be found in the supplementary data .

beginning with an unbranched ureteric bud , the model generates a realistic tree , the branches spreading out automatically even in the presence of random noise. notably, the angle of first branch is open  while the angles of subsequent branches are narrower . this narrowing of divergence angle is reminiscent of that seen in the real kidneys described above. it is important to note that no change of divergence angle was written directly into the simulation ¿ it emerged from the unchanging rules.

control of branch divergence by a secreted repulsive factor would be predicted to function also between buds from different trees. we tested this in the computer model. beginning with two closely-spaced buds, either pointing at one another directly  or offset  the simulation produces trees that become distorted as mutual inhibition operates between branches belonging to different trees. this makes a prediction, testable in organ culture, that ureteric bud systems set up on collision courses will avoid contact even at the expense of making very distorted branch patterns.

ureteric bud trees of cultured kidneys avoid collision
when a single ureteric bud was isolated by microdissection, surrounded by metanephric mesenchyme and cultured alone as in the model shown in figure 4a, it generated a typical reniform tree . if two buds were cultured close to one another on a collision course in in the model shown in figure 4b, their branch patterns were distorted from the usual outline so that collisions never occurred , again in a manner broadly similar to the model. in this example, the number of branch points formed was the same  but some branches elongated far less than others, distorting the tree. it should be noted that the model  shows fewer branch events in the region of apposition because the model uses inhibitor concentration to control both navigation and branching. the presence of bifurcations with short branches even in regions of close apposition in the real kidneys  suggests that real ureteric buds do not base their decision of whether or not to branch on the local concentration of the inhibitor. even when multiple ureteric buds were set up in close apposition, as in the model shown in figure 4c, branches avoided contact or close approach, creating straight mutual boundaries between highly distorted trees . the anatomies of the model and the real kidney are not precisely identical : it is the prediction of collisions being avoided even at the expense of forming highly distorted trees that is relevant here.

if repulsion between branches were relevant to normal development, one would expect that branches within a single kidney would slow down their growth speed as they approach other branches. to test this we measured the growth rate of kidneys with fluorescent ureteric buds through time-lapse imaging . over the 6-day period of culture, the rate of growth of cortical branches that are far from branches remained almost constant , slowing only about 12% with age. when the speed of approach  of adjacent cortical branch tips is plotted against their separation  there is a significant negative correlation between closing speed and log of proximity  before coming to a complete stop at a separation distance of 30 ?m. this confirms that self-avoidance is active during normal kidney development.

implication of signalling by the tgf?-superfamily, specifically bmp <dig>  in collision avoidance
the ability of branching ureteric buds to avoid collisions even when cultured in close apposition was used as an assay to identify the signalling system involved. an obvious candidate signalling system for inhibiting epithelial advance is the tgf?-superfamily: cells from other branching systems such as mammary gland show a reduced motility from shaped wells in the presence of autocrine-secreted, accumulating tgf?  <cit> , <cit> . furthermore, treatment of ureteric bud/collecting duct-derived cell lines with tgf? itself inhibits advance and branching of tubules in 3-dimensional collagen gel culture  <cit>  and intact kidney rudiments  <cit> .

in the developing kidney, tgf? itself is absent from the early kidney, appearing in the ureteric bud/collecting duct system some time between e <dig>  and e <dig>  <cit> , 2 days after ureteric branching has begun, and falling away in the last days of renal development  <cit> . this makes it an unlikely candidate for patterning throughout tree growth. there are, however, many other members of the tgf?-superfamily and they converge on a core intracellular signalling pathway using alk proteins  <cit> . alk <dig> , <dig> , <dig> ,& <dig> are all inhibited by the drug alkiii   <cit> , which is therefore an inhibitor of signalling by activin, bmp1- <dig>  gdf, nodal and tgf? <dig> & <dig>  this drug was used to test whether a member of the tgf?-superfamily is involved in self-avoidance in the kidney. treatment of apposed  kidney cultures with 10 ?m alkiii had two effects: it made branching less frequent along each tubule, and it resulted in branches from adjacent kidneys now being able to collide . the difference between frequency of collisions  in the presence  or absence  of this inhibitor was highly significant . normal ureteric bud tips are surrounded by a cap of six2-positive cells  that might, conceivably, act as a `fender¿ that normally prevents collisions. this is however still present and just as thick in the presence of alkiii , suggesting that alkiii does not allow collisions by removing this fender. also, each cap is about 20 ?m thick  so, if collision prevention were to be mediated by the caps acting as fenders, closest approach would be expected to be 40 ?m, not the 30 ?m observed .

whatever molecule signals through alks to mediate self-avoidance, both the signalling molecule and the appropriate alk must be expressed by growing branches. the pattern of alk and ligand expression in the gudmap database of kidney development  <cit>  is shown in  the only ligand/alk combinations that satisfy the condition of co-expression are bmp  <dig> ,8a & <dig>  signalling via alk3/ <dig>  bmp signalling can be inhibited by gremlin  <cit> : treatment of collision cultures with 5 ?g/ml gremlin had a less dramatic effect on branching morphogenesis in general than did alkiii, with tree morphology being basically normal rather than spindly, but there was still a significant failure of collision avoidance : collisions occurred in 55%  of cultures compared to 0%  in controls . in cultures treated with gremlin, some branches showed a very low divergence angle and ran almost parallel, occasionally colliding even in one tree . the presence of almost-parallel branches of this type is very variable both within and between cultures but there is a clear difference between their frequency of occurrence in controls  and gremlin-treated cultures . of the four bmps expressed in the ureteric bud, bmp <dig> is the only one that has strong expression from branch tips throughout renal development, even from the first branch events  <cit> . inhibition of bmp <dig> function in culture, using a function-blocking antibody, results in collisions between adjacent trees  and also collisions within the same tree to create occasional `loops¿ of collecting duct : quantitatively there is again a clear difference between rates of collision in control igg  and anti-bmp <dig> .

if bmp <dig> acts as an autocrine inhibitor, ureteric buds should avoid artificial sources of it. this was tested in two ways. in the first assay, affigel beads soaked in either 100 ?g/ml bsa or in 100 ?g/ml bmp <dig>  and blind-coded, were placed at the periphery of e <dig>  kidney rudiments and the distance of closest approach of bud and bead in each culture was measured after 2¿ <dig> days. bud branches grew close to bsa-soaked beads, some making contact, although there was no evidence for attraction . they remained significantly further away from bmp7-soaked beads, sometimes bending or remaining very short in their vicinity . quantitative analysis showed a significant difference in closest approach seen in each culture . however, this assay suffers from unavoidable variability in the initial placement of beads so we used an alternative assay to confirm the effect of bmp <dig>  we used a standard filter-crossing chemotaxis assay based on the 6ta <dig> immortalized ureteric bud cell line  <cit> . this assay works by seeding cells above an opaque filter and counting the number of cells to have crossed the filter towards a test medium after an interval of time. the logic of the assay requires the test medium and the medium above the cells not to have equilibrated before the end of the experiment. this was tested by a simple pilot experiment in which ink was added to one side of a cell-free filter, or as a control to the centre of a filter-free dish, and its progress into the compartment across the filter was assessed visually. with no filter present, the ink began to spread at once and reached equilibrium by 30 minutes; with the filter, the ink remained concentrated on one side of the filter even 28 hours later . diffusion through the filter pores is therefore too slow to destroy a concentration difference of even a small molecule, over the time-course of the real experiment. for the real experiment, 6ta <dig> cells were seeded above an opaque filter and the number of cells detectable below the filter was counted after 28 h . the presence of bmp <dig> below the filter caused a significant, dose-dependent reduction of filter crossing to 64% of control values  towards 140 ng/ml bmp <dig> and to 29% of control values  towards 290 ng/ml. the simplicity of the cell line filter-crossing assay also indicates that ureteric bud cells are directly responsive to bmp <dig> in the absence of mesenchymal cells.

discussion and 
CONCLUSIONS
the results presented above have shown that the ureteric bud system of kidney rudiments cultured flat show the wide first divergence angle and narrower subsequent angles that are typical of 3-dimensional organs in vivo  <cit> . culture of tips from unbranched and once-branched buds showed that divergence angle is not controlled by different, sequential genetic programs but by proximity of other branches. a simple computer model suggested that this behaviour could be accounted for by a self-avoidance system, in which growing branches are repelled by something they themselves secrete. the implication of the model, that deliberate attempts to cause collisions between bud trees would be thwarted by self-avoidance, was confirmed by culture of real kidneys. use of attempted collisions as an assay identified bmp signalling through alk receptors as being critical to self-avoidance, with bmp <dig> being at least one of the molecules involved. blocking bmp <dig> signalling produces a significant incidence of collisions, but many branches still appear to avoid contact, so there may in addition be parallel systems to keep them apart.

what does self-avoidance add to the existing repertoire of guidance systems, such as the biophysics of tube tips  <cit>  and paracrine signalling from stroma  <cit> , <cit>  believed to control pattern formation in tubule trees? first, self-avoidance can explain how branch divergence angles can change automatically from very open to more closed without any need for special, sequential systems. instead, the changing anatomy may result from an unchanging mechanism of control. the system may therefore be simpler than it first appears. second, self-avoidance might also provide a means of automatic error correction. a striking feature of organ culture, observed for many years although attention is not normally drawn to it, is that a ureteric bud tree that would normally grow and spread out three-dimensionally will, when cultured in a two-dimensional system, produce a tree that still spreads out without collisions. simple reduction of the three-dimensional anatomy of a normal tree to two dimensions, for example in a projection, would produce an image in which many shadows of branches would cross. this is not what happens in culture: instead, buds adapt and produce a properly-spaced two-dimensional tree. this demonstrates both the flexibility of bud patterning and its ability to compensate for even large-scale departures from normal anatomy. such compensation would be expected in a system using self-avoidance; proper spreading out of the branches of the two-dimensional trees in the computer model was driven by self-avoidance alone.

self-avoidance is probably not critical to the formation of a tree in the first place. the bmp7?/? mouse has severe renal dysgenesis with too few nephrons but it does have a small and cystic collecting duct system  <cit> . the presence of any kind of collecting duct system underlines the fact that an epithelial tree, albeit a morphologically-abnormal one, can be constructed even without bmp7-mediated self-avoidance. it is possible that other self-avoidance systems were still active; our data implicate bmp <dig> in self-avoidance but do not prove that it is solely responsible. it is also possible that other, cell-level mechanisms  <cit> , <cit>  are enough to make a basic tree, and that self-avoidance is used only to mitigate the effects of occasional errors of positioning.

bmp <dig> is already known to be an inhibitor of the first emergence of the ureteric bud from the nephric duct  <cit>  and, at high concentrations, an inhibitor of collecting duct cell line proliferation in culture  <cit> . supporting this is the observation that the bmp receptor alk <dig> is needed to prevent excessive ureteric bud branching  <cit> . bmp <dig> is not expressed in every organ that involves epithelial branching morphogenesis but organs may use different members of the tgf?-superfamily for the same purpose. the autocrine production of motility-inhibiting tgf? itself by mammary gland cells  <cit>  suggests that mammary ducts may use a similar self-avoidance system, but based on tgf?. it may be that, just as different organs use different activators of branching  that feed into similar intracellular pathways  <cit> , so they use different members of the tgf?-superfamily as autocrine inhibitors. they may also use more than one molecule, just as many organs use more than one activator of branching. the main point of this report is not to argue for any particular molecule being generally important in self-avoidance, but is rather to illustrate that self-avoidance seems to exist, at least in kidney, and that it offers an explanation for branch angles changing during development and for branches not tangling even when the system is perturbed.

inhibitory influences on the migrations of cells and cell processes are important in patterning other parts of the embryo, such as segmentation of the the peripheral nervous system  <cit> , mapping of optic nerve to the colliculus in the brain  <cit> , positioning of aortae each side of the midline  <cit> , segmentation of intersomitic vessels  <cit> , positioning the foregut and controlling the position at which the ureteric bud emerges from the wolffian duct  <cit> . these systems use a variety of molecules, such as ephs/ephrins, semaphorins, robo/slit and bmp <dig>  sometimes balanced by their antagonists  <cit> ¿ <cit> . there is evidence for repulsion being involved in the patterning of branching systems of bacterial colonies  <cit> , dendritic trees  <cit>  and fungal hyphae  <cit> . some simple culture studies have suggested that epithelia derived from the branched tubes of mammary and salivary glands can show repulsion  <cit> , <cit> : here we have shown this repulsion at work in the context of a complete organ rudiment.

