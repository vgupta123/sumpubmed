BACKGROUND
understanding the mechanisms underlying adaptation of species to their environment is central to population and evolutionary biology. recent advances in large-scale sequencing and genotyping now allow rapid characterization of molecular diversity in a set of local populations or across an entire species range but reliably identifying the molecular footprints of adaptation remains challenging  <cit> . two analytical approaches can be used to identify sequences genes whose evolution has been driven by environment-specific selection. one avenue is to search for genomic regions exhibiting an excess of differentiation between populations, typically using fst as a test statistic  <cit> . this approach is most likely to be successful when used in conjunction with a set of populations spanning a clear environmental gradient  <cit>  barring a clear environmental gradient, one can still use allele frequency information, the so-called site frequency spectrum , often summarized by a unique statistic such as tajima's d to detect departure from selective neutrality  <cit> . these two methods are based on different aspects of polymorphism data, and thus are expected to be complementary to one another. moreover, combining the methods may allow for the detection of different forms of selection  or increasing power to detect more complex selection histories, for example a selective sweep within a single population that can drive an excess of differentiation merely by reducing the level of intra-population diversity. although genome-wide study of molecular variation and scan for footprints of selection are now routinely reported in major genetical models, candidate gene-centred studies allow for testing of specific hypothesis regarding the evolutionary history of specific functional categories of genes  <cit> .

for plants, timing of flowering is an essential component of fitness. flowering can be influenced by a variety of climatic factors such as day length, average temperature and drought stress. accordingly numerous instances of molecular adaptation have been reported for flowering genes, particularly in the annual model plant arabidopsis thaliana  <cit> . the ability of a plant to engage in successful biotic interactions is also integral to fitness. although numerous work documents the strong imprint of natural selection on plant genes encoding perception of pathogens , both in a thaliana but also a suite of other plant species  <cit> , much less is known on genes encoding the perception of beneficial  partners. the relative paucity of studies might be explained by the fact that the plant model a. thaliana does not engage in symbiosis with any of the two major plant-microorganism symbioses: the ancient and widespread association with mycorrhizae and the more specialized symbiosis with rhizobia.

the barrel medic medicago truncatula is a model legume species used for dissecting the genetics of legume-rhizobia and plant-mycorhizae interactions. its natural habitat spans the mediterranean basin. it is an annual selfer found in ecologically unstable populations, resulting in large rates of genetic drift within and among populations  <cit> . for these reasons the efficacy of natural selection to drive adaptive changes is likely to be challenged by genetic drift and population structure.

in this study we examined signatures of natural selection in several genes of two functionally important and largely independent signalling pathways: the flowering and symbiotic pathways in m. truncatula. to do this, we surveyed patterns of naturally occurring diversity at the species level for a set of genes in each pathway and a set of control genes. we first quantified the strength of purifying selection in m. truncatula and the relative importance of positive selection in genes from both pathways and a set of independent control genes. we then examined broad patterns of genetic subdivision in our sample and split our sample in two ancestral groups. accordingly, we model demographic factors that influence coalescent history and contemporary levels and patterns of diversity within each group  <cit> . the rationale for doing so is that strong substructure can blur inference of non-neutral evolution  <cit> . finally we searched for signatures of natural selection based on the estimated large-scale population structure, within both ancestral groups with the objective of tracking signatures of selective sweeps in candidate genes.

methods
plant material
a panel of  <dig> medicago truncatula genotypes  consisting of naturally occurring inbred lines sampled from throughout the species range was chosen to represent the species level and a regional level. at the species level, we used a core collection containing  <dig> accessions, that was previously defined to represent the geographic distribution of the species and to maximize allelic variation at  <dig> ssr loci initially investigated on a sample of  <dig> accessions  <cit> . to investigate genetic diversity at a smaller spatial scale,  <dig> accessions belonging to a more homogeneous genetic group  were included in the panel. most of these accessions were initially collected in the iberian peninsula and morocco. the list of accessions used is listed in additional file  <dig>  table s <dig> and their geographic origin depicted in figure  <dig>  five other medicago species were included as potential outgroups : m. tornata, m. rigidula, m. rigiduloides, m. arabica, and m. marina. unless noted otherwise, all accessions were collected in natural populations and self-fertilized two generations before being grown for dna extraction.

amplification and sequencing
we used data from  <dig> genic fragments that we pcr amplified and sequenced to model the demographic history of our sample . primers to amplify these fragments were chosen from two sources  <cit>  and within the set of primers available, we selected primers that amplify relatively long fragments . fragments typically consisted of exon-bound primers spanning one or more introns. the fragment length ranged from  <dig> to  <dig> with a mean of  <dig>  and all pcr products were sequenced directly. protocols for dna extraction, pcr amplification, fragments purification and sanger sequencing were identical to those described in de mita et al.  <cit> .

nodulation gene fragments are located in  <dig> genes: dmi <dig>  dmi <dig>  nin, nfp, pg <dig>  involved in the nod factor perception pathway  <cit> . primers used for pcr amplification and subsequent sequencing were identical to the ones described in de mita et al.  <cit> . flowering gene fragments are located in the following genes: col , fca <dig>  frla, ftla, ftlb, ftlc, soc1b, vrn, phya, phyb, phye, which are involved in the signalling pathway controlling day length perception, circadian clock and flowering inception  <cit> . two gene fragments, fca <dig> and soc1b, were amplified from cdna. for these, total rna was extracted from fresh leaves using tri reagent™  buffer and the reverse transcription system kit from promega®. sequences of primers used for pcr amplification and sequencing are available available in additional file  <dig>  table s <dig> 

for all gene fragments, sequence reads base calling and annotation were performed manually using pregap <dig> and gap <dig> programs of the staden software version  <dig>   <cit> . annotation was retrieved either from reference gene sequences when available or from gene index tentative contigs  <cit>  exhibiting an exact match. all sequences are deposited in genbank  and alignments are available from the authors in the dryad archive .

analysis of patterns of polymorphism and divergence
analyses of polymorphism were performed using customized scripts in python and the seqlib library version  <dig>   incorporating bio++ version  <dig>   <cit> . sequences spanning less than 25% of the length of the longest sequence of the alignment  were removed. this threshold was raised to 60% for the analysis of synonymous/non-synonymous variation. the m. tornata sequence was used as outgroup unless the m. tornata sequence was less than 75% of the length of the longest sequence. in these cases, the longest sequence from the other outgroup species was used . for polymorphism analysis concerning synonymous/non-synonymous variation, estimation of the recombination rate and haplotype analysis, all sites with at least one undefined or missing nucleotide position were excluded. for all other statistics, sites with at least 70% defined data were used.

counts of the number of sites exhibiting polymorphism and divergence within each gene fragment were used to study the relative roles of positive and purifying selection in shaping polymorphism and divergence in the coding regions. we followed the approach implemented by welch  <cit>  and recently extended by obbard et al.  <cit>  to infer the fraction 1-f of mutation under strong purifying selection and the proportion α of non-synonymous nucleotide divergence driven by positive selection. we used a series of nested models of increasing complexity ranging from the simplistic pure neutrality  to models incorporating a variable intensity of positive or purifying selection . estimation of parameters for each gene or category of gene was made using the software mk_test  <cit> . we used akaike's information criterion  to compare models, as suggested by welch  <cit> . when models differed by less than  <dig> aic units, we used an averaging procedure to obtain robust estimates of α's and f's parameters. briefly, we computed a model-averaged estimate of α's  as the weighted average of the individual estimates obtained under each model and used the differences in aic of each competing model for weighting  <cit> .

population structure analysis
we used the bayesian clustering algorithm implemented in instruct  <cit>  to analyse population structure. instruct uses multilocus genotype to assign portions of individual genomes to a predetermined number  of clusters and can account for the likely presence of inbreeding within clusters . we used all polymorphic sites detected on control loci. each site was considered as a single locus and we used a haploid setting. we ran instruct, using mode  <dig>  which infers population structure only  and assumes that admixture is possible between groups. for each run, we used a burn-in period of  <dig> ×  <dig> iterations and then  <dig> iterations for estimating the parameters. five independent chains were runs for each of  <dig> k values, k =  <dig> to k =  <dig>  for each run, individual accessions were assigned into a group according to their highest proportion of membership into this group. the clusters thus defined were compared among runs for each k value and the best fitting k was chosen using the Δk method of falush et al.  <cit> . the fraction of the observed genetic variation explained by the inferred clusters was measured by the fst parameter as implemented for nucleotide sequence data  <cit> . the stratification obtained for k =  <dig> appeared as the most robust one  and was used in neutrality tests.

frequency spectrum neutrality test
we used patterns of polymorphism within each group to detect instances of selection causing departure from the neutral frequency spectrum. to do so we devised a test combining two neutrality test statistics relying on the underlying frequency spectrum: tajima's d  <cit>  and the standardized version of fay and wu's h  <cit>  which we call z. in order to obtain the joint distribution of these statistics under the hypothesis of selective neutrality while accounting for demographic history in each group, we followed the strategy used in de mita et al.  <cit>  and fitted population expansion models in each of the two groups. the procedure was repeated independently for each group and a different scaled mutation rate and rate of expansion were assumed for each group. we used an approximate bayesian framework  <cit>  as implemented in the python seqlib library to obtain the joint posterior distribution for parameters.

we used the frequency of four minor allele frequency categories  as summary statistics of the data in each group. then we approximated the joint posterior with  <dig> coalescent simulations and using local-linear regression on tan-transformed data with a tolerance factor of 10- <dig>  the posterior joint distribution  was binned using  <dig> evenly distributed bins over both dimensions. this posterior distribution was then used to obtain - through  <dig> independent simulations  - the distribution of d and z expected at each locus. note that locus specific sample size and alignment length were used in these simulations. a probability of misorientation of sites of  <dig>  was estimated from control loci  <cit>  and incorporated in the simulations used to obtain the null distribution of  at each locus. this was done by randomly switching the orientation  of alleles after each coalescent simulation stage. this additional twist is an effective way to guard false positives, i.e. low p-values at locus evolving neutrally but where snp misorientation is inflating z. the  distribution was discretized over  <dig> categories and the p-value of the bin containing the observed  value of each locus in our data was computed.

evolutionary analysis of nucleotide substitution patterns
patterns of between-species substitutions of dmi <dig>  a gene previously identified as candidate for adaptation  <cit> , were also analysed. to do this we sequenced most of the protein-coding sequence of dmi <dig>  in nine additional medicago species  as well as previously cited m. tornata, m. ciliaris, m. rigidula, m. rigiduloides, m. marina and the l0736d accession from m. truncatula. in addition, we included the reference sequence m. truncatula jemalong a <dig> from the literature .

sequences were aligned at the protein level using muscle version  <dig> . <dig> with default options  <cit>  with minor manual corrections to eliminate spurious amino acid replacements generated by the alignment procedure. for the same reason, the region spanning position  <dig> to  <dig> in the coding dna sequence alignment  consisting of gaps and poorly aligned sequences were removed. a molecular phylogeny was built with phyml version  <dig>   <cit>  using coding and protein sequences. we used the most conservative option of using the protein-based tree for further analysis as it minimizes the number of assumed amino acid changes. using this phylogeny, we applied tests of positive selection based on codon-based substitution models  <cit>  implemented in paml version  <dig>   <cit> . the tests m2a versus m1a and m <dig> versus m8a yielded identical results and we report the first comparison only. we applied the test as recommended in paml documentation and identified positively selected sites using a bayes empirical bayes procedure.

RESULTS
levels of nucleotide variation in medicago truncatula
we surveyed nucleotide diversity within m. truncatula by re-sequencing  <dig> gene fragments . a total of  <dig>  nucleotides were re-sequenced of which  <dig>  were included in statistical analyses . gene fragments were sequenced in  <dig> m. truncatula accessions representing the whole-species diversity and in one outgroup. overall m. truncatula is characterized by a fairly low level of nucleotide diversity at the species-wide level as measured through the scaled mutation rate  and mean nucleotide diversity is π =  <dig> , see table 1), but in the range of studies surveying species with similar mating system: species-wide samples in arabidopsis thaliana , in wild rice , and the self fertilizing worm c. elegans  or within autogamous populations of eichornia paniculata . levels of nucleotide variation for control and candidate genes fragments are virtually identical . one notable exception is the nodulation gene dmi <dig> that exhibits very high levels of polymorphism .

all values are given as averages over the  <dig> control loci.

group  <dig> and group  <dig> are the two groups inferred using instruct on sequence data obtained on control loci: group  <dig> is the spain-morocco group and group <dig> the eastern part of the sample 

&: per site estimates are reported here,

#: z standardization of fay and wu's h.

n/a: not applicable.

the value hudson's ρ reported here is the average of ρ estimates per analysed site.

beyond average levels of polymorphism, we document a rather large variance in the scaled mutation rates as θ estimates span two orders of magnitude .

overall, values for tajima's d statistic in the whole sample vary widely but are generally skewed towards negative values . candidate gene fragments and control fragment distributions are largely overlapping .

the strength of purifying selection and adaptive evolution in medicago truncatula
next, we estimated the fraction 1-f of amino acid changing mutation undergoing strong purifying selection and the proportion α of non-synonymous divergence between m truncatula and our outgroup  that can be attributed to positive selection. we used  <dig> competing models - with varying amounts of purifying and positive selection - and their relative fit is summarized in table  <dig>  model m <dig>  which posits strict neutrality, fits the data poorly and was not considered further. model comparison using differences in aic provides suggestive evidence that, despite low level of polymorphism compatible with a rather small long-term effective size, a substantial amount of purifying selection constrains amino acid changing polymorphism. on average, about 90% of amino acid-changing mutations are removed by strong purifying selection. this is as strong or stronger than what has been reported for a. thaliana where 66% of amino-acid changing mutation where strongly deleterious  <cit> .

m1: homogeneous purifying selection +
m2: purifying selection with variable intensity +
f <dig> =  <dig> 
f <dig> =  <dig> 
f <dig> =  <dig> 
α <dig> =  <dig> 
f <dig> =  <dig> 
α <dig> =  <dig> 
1-f quantifies the intensity of purifying selection through the fraction of new amino acid changing mutation under strong purifying selection. α is the fraction of divergence attributable to adaptive evolution .

the best model  is highlighted in bold and all differences in aic among models Δaic) are computed relative to m <dig>  waic are the statistical weights of each model in the model averaging procedure we used.

subscripts in f <dig>  f <dig>  f <dig>  α <dig>  α <dig>  α <dig> refer to the gene fragment categories. 1: control fragments, 2: flowering gene fragments, 3: symbiotic gene fragments. n/a: not applicable.

the estimated level of adaptive evolution is high  but there is a very large sampling variance and this estimate is not statistically significant from zero . last, we asked if a model  positing that different types of gene fragments experienced different level of adaptive substitution improved the fit of the data. comparison with a model with homogeneous level of adaptive substitutions  suggests that flowering genes may experience more adaptive substitution  and that symbiotic genes experience fewer substitution  but again sampling variance around the estimates of α for each category of genes is very large and the model m <dig> overall fits poorly the data relative to a more parsimonious one . we thus choose to report more robust model averaged estimates of f and α in table  <dig> 

broad patterns of genetic subdivision in medicago truncatula
we studied broad patterns of genetic subdivision in our sample and inferred stratification in k groups within our species-wide sample. we used values of k ranging between  <dig> and  <dig>  consistent estimates of log-likelihood and stratification patterns were obtained for all k values. posterior probabilities of the data always increased with increasing subdivision ; the highest gain occurring between k =  <dig> and k =  <dig> and between k =  <dig> and k =  <dig> .

at k =  <dig>  the inferred structure was stable across runs, geographically consistent, and in agreement with a previous structure inferred on the basis of ssr variation in a set of  <dig> microsatellite loci on a much larger sample  of accessions  <cit> . this stratification splits our species-wide sample into a group of  <dig> accessions originating from the south-west of the mediterranean basin and a group of  <dig> accessions originating from a broad eastern part of the mediterranean basin . except for three accessions , all the accessions in this study were assigned to the same group as when using ssr data. this stratification accounted for 17% of the total genetic variability in our data. at k =  <dig>  independent runs were also consistent, but the stratification obtained was not geographically consistent, splitting the two groups defined at k =  <dig> with no clear pattern . this stratification also explained less genetic variability than k =  <dig>  for k =  <dig>  the stratification was the same as that obtained with k =  <dig> except for one individual  which constituted alone the fourth group. at k =  <dig>  most accessions appeared admixed, i.e. showing proportions of membership into each of the  <dig> clusters lower than  <dig>  or  <dig> .

given the geographic consistency of the subdivision obtained at k =  <dig> and the congruence of this subdivision with that obtained using ssr loci, we choose to use k =  <dig> as the subdivision pattern for further analyses. note that this analysis is by no means intended to infer the actual number of populations underlying our sample but merely a way to group accessions in fairly homogeneous groups. the two groups show relatively similar levels and patterns of nucleotide variation  despite the lower geographic area covered by the western group . both groups also exhibit negative tajima's d values, suggesting recent events of population expansion occurred in both groups .

the frequency spectrum at several flowering genes departs from neutrality and suggests recent or ongoing selection
to determine if patterns of polymorphism departed from selective neutrality we combined two statistics, d and z, summarizing the frequency spectrum. this level of analysis strikes a compromise between retaining high enough polymorphism while using a sample for which we can model patterns of polymorphism . our approach builds on previous work showing that a scenario assuming a single population with exponential growth, although simplistic, can adequately capture patterns of polymorphism in control gene fragments  <cit> .

we mapped the observed values  of each gene fragment on the joint density of  expected under selective neutrality while accounting for the demographic history of each group . a graphical summary of our results is presented in figure  <dig> . p-values of the joint test  obtained in the two groups exhibit virtually no correlation . empirical distribution of p-values at control loci was also slightly l-shaped , suggesting that despite our efforts to account for the coalescent history of our sample, our test is still probably slightly too liberal so that p-values should be interpreted with caution. among the  <dig> surveyed candidate genes, observed patterns of nucleotide diversity  fall outside the simulated neutral distribution for  <dig> fragments: frla and dmi <dig> exhibit z values in both groups that are larger than expected under neutrality, ftlb and phya exhibit too negative z values in the western group  <dig>  vrn and phye exhibit too negative d values in the  group  <dig>  and nin exhibits a negative z value in the eastern group . several loci - including control loci - exhibited low p-values and inspection of the  coordinates reveals loci with abnormally high values of z but typical values of d. negative values of z sign an excess of high-frequency derived mutations, which can be interpreted as hitch-hiking episodes driven by recent selection. in contrast, occurrence of positive z values  cannot be explained by natural selection in any straightforward manner. notably, genes displaying high values of z often exhibit the highest diversity indices . z, unlike d, might be sensitive to variations in mutation rate. even worse, z is very sensitive to variation of gene genealogy structure, as deep genealogies might pre-date the divergence with outgroups and drive spuriously high values of z. as a result, we chose not to report as departing from neutrality loci exhibiting a very high value of z and a high diversity, as for these an artefact due to high mutation rate seems likely .

barring such cases, this method detected footprints of selection in four genes potentially involved in flowering date  and one symbiotic gene . the gene ftlb displayed in the western group a very negative z value compared to neutral expectations, suggesting positive selection on this gene while phya exhibited a negative z value but also a strikingly large d value in this group, as expected under diversifying selection or local adaptation. both vrn and phye, displayed very negative d values as expected under directional selection. for these two genes, however, the deviations from expected values were less important resulting in larger p-values . nin exhibited a negative z value as expected under positive selection in the eastern group only .

evidence for selection in dmi1
dmi <dig> was the only nodulation candidate detected in a previous analysis  <cit>  but is not singled out in the current application of the  test. however several snps located in exon  <dig> of dmi <dig> exhibited an excess of differentiation. the analysis of local variation of patterns of polymorphism shows interesting features , although challenging to interpret. the strikingly contrasted pattern of differentiation and tajima's d might explain why this gene could not be detected using gene-wise summaries of polymorphism and suggest that selection occurred in the gene . codon evolution analysis strongly supports the hypothesis that several sites in dmi <dig> evolved under positive selection in the history of the medicago genus. a model allowing for positive selection on a fraction of the sites  fitted much better the data than a model  with no sites under positive selection . the location of the sites that are very likely to have evolved under positive selection is represented in figure  <dig> 

discussion
m. truncatula nucleotide polymorphism is shaped primarily by purifying selection
the species-wide levels of nucleotide polymorphism we report here are in the lower range of plant studies which is consistent with the expectation that selfing plant species harbour less nucleotide diversity than outcrossing species  <cit> . note however that although mating system was the variable explaining most of the variation in polymorphism across plant species, the portion of the total variance in nucleotide diversity accounted by mating system alone is rather modest . levels of polymorphism in m. truncatula thus lie in the low range although these are by no mean as extreme as the striking instance of some self-fertilizing species - capsella rubella that recently evolved from the outcrossing capsella grandiflora - which only displays one to two haplotypes throughout its species range  <cit> . we also report fairly strong purifying selection removing up to 85% of all non-synonymous  mutations and marginal evidence for heterogeneity in the amount of purifying selection and positive selection among gene categories. although the evidence for positive selection on flowering genes obtained by contrasting polymorphism and divergence  is suggestive and also consistent with evidence obtained on a different time scale using the  test, estimates of α should be viewed as preliminary for two reasons. first, α estimates are inherently noisy  <cit>  and data on many more genes for each category would be needed to reduce sampling variance around estimates. second demography is expected to affect the estimation of both f and α  <cit> .

model-based tests of selection
instead of relying on non-parametric methods for detecting outliers suggestive of selection, we employed model-based methods. these rely on first fitting patterns of nucleotide variation at a set of control loci as a means of parametrizing a model positing selective neutrality and the most salient features of the demographic history that may be responsible for the patterns of nucleotide diversity in our sample. we discussed below insights provided by these approaches but also their limits.

some loci, including controls, displayed large values for fay and wu's standardized h statistic  that were strongly unlikely under our model. these genes also ranked among those with the highest per-site watterson'sθ. while d is virtually insensitive to levels of polymorphism, z and even more the non-standardized h statistic are dramatically so. allowing for variation of the mutation rate among genes would make the  test more robust. one option is to constrain θ to be proportional to an independent estimate of mutation rates or a proxy such as interspecific synonymous nucleotide divergence. the outgroups we used were however too close - in terms of absolute amount of divergence to our sample - for this purpose, yielding putatively very noisy estimates for mutation rates that would exacerbate rather than fix the problem. at the cost of extra parameters, the variation of θ among genes could be treated as a hidden statistical parameter  to be estimated.

our model for patterns of polymorphism within group, by ignoring gene flow between geographic regions comprising each group of accessions, underestimates the variance in coalescence times underlying amounts of polymorphism. thus loci with neutral polymorphism but high θ and in turn possibly high z values were picked as departing from neutrality. a more sophisticated model would treat both populations jointly but addressing this would require a flexible yet computationally tractable population structure component for coalescence models. that remains a theoretical challenge.

we observed a broad population structure  consistent with previous analysis of ssr data  <cit>  which, in the absence of obvious barrier to gene flow, seems likely a relic of past isolation reflecting the existence of glacial refuges both west  and east  of the mediterranean basin. interestingly clear footprints of selection were detected only in one of the two groups  suggesting that selective pressures differ across western and eastern parts of the species range. no obvious environmental differences between these two geographic regions could be identified: both regions span a similar latitudinal gradient and share the mosaic of climate, geology and anthropic pressures that characterize the mediterranean  <cit> . the only notable difference between these two groups is the size of the geographic area they span, the western group being restricted to the iberian peninsula and northern morocco.

molecular adaptation in the nodulation and flowering pathway
although the majority of arabidopsis flowering genes have orthologs in legumes, little is known about the genes underlying variation in flowering time in medicago truncatula. previous studies have shown that as most mediterranean legume species, medicago truncatula exhibits reduced time to flowering under vernalization and under long day conditions  <cit> . we studied orthologs of genes that have been shown to be involved at different levels of the flowering signalling pathway in arabidopsis thaliana: phya, phyb, phye, vrn and fca are involved in the perception of environmental stimuli, col  and frla  are central genes and ftla, ftlb, ftlc and soc1b are integrating genes  <cit> . we detected several signatures of selection in genes involved in the perception of environmental stimuli . phytochromes are a family of plant photoreceptors that mediate physiological and developmental responses to changes in light conditions. in arabidopsis thaliana, five phytochrome  genes have been shown to be involved in the timing of flowerng, with phya, phyd, and phye playing a major role in the control of flowering under cool conditions  <cit> . vrn <dig> and vrn <dig> have been shown to mediate response to vernalization both in arabidopsis thaliana and cereal crops  <cit> .

we note that most footprints of selection detected in this study involve the most upstream genes of the flowering pathway. such genes are expected to be associated with lower pleiotropic effect and are thus expected to be preferential targets of natural selection  <cit> . we also detected a significant deviation from neutral expectations on the integrator gene ft . this gene acts on the floral meristem identity genes to initiate flowering and is one of six candidate genes that have been shown to be located in the support interval of a qtl that explained  <dig> to 60% of the flowering date variation in three rils populations  <cit> .

further phenotypic and climatic data are needed to evaluate the role of these different genes in natural variation for flowering date in medicago truncatula and to understand their involvement in the adaptation of the species to climatic variations.

for nodulation genes, we detected footprints of selection in two genes dmi <dig> and nin. both genes are acting at the signal transduction level, without direct interaction with the symbiotic partner. dmi <dig> appears to have undergone selection both recently - between m. truncatula populations - and more anciently in the medicago genus. a sliding window analysis reinforces this statement  while similar analyses for other candidate genes did not uncover obvious local signatures of selection along the gene .

CONCLUSIONS
we used sanger sequencing to survey nucleotide variation in medicago truncatula. we focused on a set of important genes with known function in the nod factor perception and flowering pathways and asked if selection had affected these genes at different evolutionary time-scales. we did so by contrasting patterns of polymorphism at candidate genes with a set of control gene fragments and a coalescent framework where simple demographic models were fitted to the control data. the fitted demographic models were then used as a basis to obtain - via coalescent simulations - null distributions for statistics characterizing patterns of variation in genes of interest. here we uncover several footprints of selection in both pathways and at different evolutionary time scales. our detailed analysis of diversity within groups demonstrates that model-based methods of analysis can be quite sensitive to assumptions of the underlying models used. future models should explore more detailed demographic scenarios, possibly in a more spatially explicit context . inspection of the empirical distribution of scaled mutation rates also suggests ample variation in per nucleotide mutation rate throughout the genome. even if neutrality test statistics are built in order to minimize sensitivity to underlying variation in mutation rates, incorporating genomic heterogeneities in mutation and recombination along the genome may be needed to generate sound null distributions that integrate over both historical and mutational/recombinational unobserved processes that shape genomic diversity  <cit> . fitting such models requires orders of magnitude of more polymorphism data but these will be available in the near future for the m truncatula species complex  and increasingly so for non model species. thus, barring the computational challenges to "scale up" to genome levels, model based approaches incorporating the additional touch of biological realism described above will be a fruitful framework for understanding evolutionary forces shaping genome variation and, ultimately, symbiotic evolution and flowering time in this system.

availability of supporting data
the data sets supporting the results of this article are available in the dryad repository at doi: <dig> /dryad. <dig> 

authors' contributions
tb and jr designed and coordinated research. sdm, nc, kl performed sequencing, alignment and annotation. sdm, jr, tb analyzed data. sdm tb and jr wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
table s <dig> - list of medicago truncatula accessions. microsoft word document containing the list of medicago truncatula accessions that were re-sequenced in this study, their accession number, country of origin and sample information.

click here for file

 additional file 2
table s <dig> - pcr primers. microsoft excel spreadsheet containing the list of pcr primers used to amplify and sequence flowering and symbiotic gene fragments.

click here for file

 additional file 3
table s <dig> - list of sequenced loci. microsoft excel spreadsheet containing the list of sequenced loci, genomic location and results of sequencing. la is the alignment length and ls is the length of the sequenced obtained from a <dig> with alignment gap stripped.

click here for file

 additional file 4
table s <dig> - standard diversity indices for each fragment. microsoft excel spreadsheet containing standard diversity indices computed for each fragment. the results of different summary statistics are presented in separate sub-tables for control fragments, flowering loci and nodulation loci. nc: not computed.

click here for file

 additional file 5
figure s <dig> - likelihood profile for k, the number of groups in the sample. microsoft word document showing the likelihood profile for k in the structure analysis. likelihood was obtained using the software instruct on the nucleotide polymorphism data from control loci.

click here for file

 additional file 6
figure s <dig> - group membership of the accession in structure analysis. microsoft powerpoint presentation containing the schematic representation of the assignment of the accessions in each group following instruct analysis for k =  <dig>  k =  <dig> and k =  <dig> 

click here for file

 additional file 7
table s <dig> - standard diversity indices for each fragments within both ancestry groups. microsoft excel spreadsheet containing the values of standard diversity indices estimated for each fragment within both ancestry groups. nc: not computed.

click here for file

 additional file 8
table s <dig> - p-values of the joint  test. microsoft excel spreadsheet containing, for each locus, the value of d, z, and the p-value for each group .

click here for file

 acknowledgements
we thank peter tiffin for suggestions and stylistic comments on this manuscript. tb acknowledges support from the danish research council . sequencing was funded by an "aip genomes" grant by inra.
