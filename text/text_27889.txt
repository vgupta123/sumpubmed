BACKGROUND
viruses and their hosts engage in evolutionary arms races in the form of continuous molecular level changes that determine the mechanisms of infection and defense . the evolutionary dynamics are determined in large part by host susceptibility and viral pathogenicity and ultimately depend on molecular interactions between genes and their products . these relentless evolutionary arms races drive genetic diversity in both host and pathogen  <cit> . more generally, host-pathogen interactions have been proposed as a major factor in the evolution of biological complexity .

if we consider humans and other higher organisms as potential hosts, they will usually evolve at much slower rates than the viruses that infect them  <cit> . at the same time these hosts are highly complex organism and will usually have far greater resources in terms of potential defense mechanisms and, more generally, in terms of genetic information to deal with the viral infections. viral entry will commonly involve binding interactions with receptors on the host cell surface  <cit> . most host cells will have a large number of cell surface receptors, many of which are involved in essential functions such as detection of signaling molecules  or nutrients, but which can be usurped by viruses as cell entrance mechanisms  <cit> . functional redundancy among receptors is common. for example, nectins are cell entry receptors of herpes simplex virus  and are involved in cell adhesion. functional redundancy within the nectin family and also other cellular adhesion proteins can compensate for particular nectins  <cit> . also, in humans there are  <dig> known chemokine receptors which activate the same chemokine signaling pathway but some of these have highly specific receptor binding ligands whereas others may bind multiple ligands  <cit> . interestingly, some viruses produce mimics of chemokine receptor binding ligands, or may encode their own chemokines and chemokine receptors  <cit> . for example, ccr <dig> and cxcr <dig> act as co-receptors for hiv- <dig> entry  <cit> , and the respiratory syncytial virus  produces its own version of the chemokine cxc <dig> which binds to the host receptor cx3cri, thus facilitating rsv infection  <cit> .

while there are multiple mechanisms of infection and resistance across many levels, virus entry into the host cell is the first and essential step that must succeed for a viral infection to proceed  <cit> . thus, preventing virus entry has been often been the preferred strategy for therapeutic development  <cit> . on evolutionary timescales, hosts can evade receptor-mediated viral entry in several ways including amino acid changes at the binding sites to inhibit protein interactions, or by regulation of receptor gene expression. several previous studies have provided evidence of evolutionary arms races at the level of virus-receptor protein interactions. for example, transferrin receptor- <dig>  is a key regulator of iron uptake in mammalian cells and is up-regulated when intracellular iron concentrations are low  <cit> . however, tfr <dig> is also used for cell entry by viruses such as the mouse mammary tumor virus  and the machupo virus. clear evidence of positive selection has been found both on the binding sites of tfr <dig> for mmtv and machupo virus and on the corresponding sites in the virus proteins that bind these . mutations at these residues affect receptor-binding interactions and change virulence and host susceptibility, suggesting an ongoing evolutionary arms race. regulation of host cell surface receptors can also be an effective defense strategy against virus entry  <cit> . for example, there appears to be significant variation across human bladder cells for mrna and protein expression levels of the coxsackie and adenovirus receptor  gene, another virus-targeted receptor. thus, the t <dig> bladder cell line has very low car expression and is resistant to virus entry, whereas rt <dig> cells have high car expression level and are highly susceptible to infection  <cit> . thus, regulatory changes affecting cell surface receptor levels are related to susceptibility to viral infection. clearly, however, there may be a tradeoff between reduced receptor expression and the fitness gained by reduced infectivity, which may explain why there are many more published examples of virus-receptor coevolution than for receptor expression evolution .

thus, hosts may adopt different resistance mechanisms at different system levels, e.g., receptor binding vs regulation. however, little previous research has focused on how these different levels of defense mechanisms may evolve in the context of host-pathogen co-evolution. computational models such as the gene regulatory network evolution model , that combine a complex genotype-phenotype mapping  with evolutionary dynamics have previously been used to address a range of questions concerned with evolution of biological complexity  <cit> . in previous studies, the gene regulatory network evolution model has been extended to account for different system levels, including transcription factor -dna binding interactions  <cit>  and protein-protein interactions   <cit>  at the microscopic level, or between two different populations  <cit>  at the macroscopic level. these previous studies  <cit>  showed how robustness and evolvability can evolve to be distributed across different system levels, depending on the model conditions. here, we integrate protein-protein interactions  and gene regulatory networks  in the context of an evolutionary model that represents both host and pathogen populations.

viral proteins commonly evolve to mimic receptor binding sites in order to enter host cells through cell surface receptors . we introduce a model where the host receptor and the corresponding viral protein are represented as linear sequences and binding is quantified by a similarity score, under the assumption that a close match corresponds to better binding and a higher probability of viral entry. hosts can evolve to block viral entry either via binding site mismatches or by regulatory changes in receptor protein expression. we further investigate how hosts evolve resistance to different types of viruses: specialists  vs generalists . we consider how the balance between receptor binding and regulation evolves in the context of host-pathogen co-evolution and the need for virus to enter the host cell and the host to block virus entry. more generally, we consider what evolutionary conditions might drive a shift from protein-protein interaction towards gene regulation, and thus increased biological complexity, a key question in the field of evolutionary biology  <cit> . furthermore, because we specifically consider host-pathogen coevolution, our study begins to address how complex immune systems may have evolved.

methods
host-virus coevolution model
the individual gene regulatory network  structure and gene expression dynamics largely follows the original gene regulatory network evolution model , with  <dig> primary differences:  host individuals are represented by a grn together with a set of receptor binding site sequences,  populations follow the dynamics of an sis model, and  the selection pressure on hosts is given by differential survival probability for the offspring of susceptible vs infected parents and by the rate of disease-related death for infected hosts as selection on the hosts arises from the advantage that resistant offspring have over non-resistant offspring .

a host grn is represented as a matrix  of size n × n
tf where n is the total number of genes, which includes receptor genes  and the transcription factor genes  that regulate them. each element, w
ij indicates a regulation of the gene i by a gene product of the gene j, and can represent activation , inhibition , or no regulation . the network density  is a parameter of the model and is defined as the fraction of nonzero w
ij elements in the matrix w. a founder host individual has a randomly assigned w with a given network density c and with each nonzero w
ij element drawn from a normal distribution, n. each row i of the matrix w represents the cis-regulatory elements of the i
th genes. the grn is composed of two sub-networks. the first sub-network, from the 1st row to the n
tfth row corresponds to the transcription factor  genes and the second sub-network, from the n
tf + 1th row to the last n
th row corresponds to the n
r receptor genes. the expression levels of the n genes at time t are represented as a vector s where the i
th element s
i corresponds to the gene expression of i
th gene. a sub-vector of s of tf genes  ~ s
tf) is called s
tf, and a sub-vector of s of receptor genes  ~ s
n) is called s
r. initial gene expression s is set as a random binary vector where  <dig> corresponds to no gene expression and  <dig> is for full gene expression. gene expression levels are updated according to the equation s = sig), where sigx=11+e−axa= <dig> is a sigmoid function which maps values to gene expression levels in the range . here,  <dig>  corresponds to basal  gene expression. when the gene expression dynamics s reach steady state  <cit>  we simplify gene expression to binary form by applying the function φx= <dig> x≤ <dig> ,x> <dig> , thus defining the phenotype Ŝ.

in the model, we assume there is some degree of functional redundancy for cell surface receptors. among the total number  of receptors which can be expressed on the cell surface, a subset  is required to satisfy the minimum demand for normal host functions. here we tested n
er =  <dig> or  <dig> among n
r =  <dig> receptors. for example, n
er =  <dig> indicates that expression of any single receptor is sufficient for host function and any receptor can substitute for any other. at the other extreme, if n
er =  <dig> then all receptors must be expressed and there is no functional redundancy. there are multiple examples showing that different receptors on a host cell can be targeted for virus entry and also that a single host receptor can be targeted by different viruses  <cit> . hence, offspring individuals whose phenotypes have fewer expressed receptor genes than n
er  are assigned zero fitness since we assume that this is the minimum required for normal host cell functions. the expressed receptor genes produce cell surface receptor proteins that can be targeted by viruses for entry. each receptor protein is represented as a binary vector of length l, where  <dig> indicates a polar amino acid and  <dig> indicates a hydrophobic amino acid. to represent different receptors on the host cell surface, an amino acid sequence is assigned to each receptor protein independently . while a host individual is represented with a grn together with a set of receptor proteins, each virus is represented only by the protein used to enter host cells, represented also as a binary vector of length l.

the initial host population is created in the form of m clones of a founder individual possessing a randomly assigned matrix w and set of receptor amino acid sequences. the host population iterates through cycles of reproduction, mutation and stabilizing selection  for  <dig> time steps in order to generate genetic diversity within the population before the viruses are introduced  <cit> . under asexual reproduction each offspring individual is cloned from a random parent, whereas under sexual reproduction each offspring has two random parents and inherits genes  from either parent randomly assuming free recombination among the genes. since each row represents the cis-regulatory region of each gene, sexual reproduction involves copying each row of w from either of the parents for all n genes. grn mutations change regulatory interactions between genes. as used previously  <cit> , we allow interaction addition , deletion , and modification . the mutation frequency per matrix w is μ including addition , deletion  and modification . ρ and ϕ are set to satisfy Δc=ct+1−ct=μn⋅ntf⋅ρ1−ct−ϕct= <dig> so that the network density  remains close to that of the founder. before contact with viruses, the host population size is fixed and hosts evolve under stabilizing selection to be close to the founder’s gene expression phenotype and expressed receptor amino acid sequences. under stabilizing selection, a host whose phenotype has more than one gene expression difference is not able to survive. protein mutations involve switching between  <dig>  and  <dig> , where the mutation probability is μ
hp per set of receptors. also for the receptor similarity, we measured a fitness value f=e−dσ, where σ =  <dig>   and d=∑r∈er∑i=1l|ar,i−ar,if|er⋅l , which is the mean l <dig> distance from the founder amino acid sequence for all expressed receptors.

in preparation for the infection phase, two founder viruses are generated based on protein sequences from host individuals in order to guarantee a high initial transmission rate. specifically, each founder virus is copied from a receptor protein sequence of a random host, then mutated using the virus protein mutation rate . although we tested a case of larger initial virus population size including a greater diversity of founder viruses, we could not find a significant difference from the small initial founder virus population case in terms of the infection strategy of the virus. hence, in this study, we used two founder viruses for all simulations. once the host-virus coevolution phase begins, the hosts are divided into susceptible and infected populations and the host population is no longer under stabilizing selection, as hosts need to acquire phenotypic variation to defend against virus entry. initially all hosts are susceptible and as the founder viruses infect the healthy hosts, those hosts are moved to the infected population. each individual in the infected group possesses the virus that caused the infection. from this point the population evolves under conditions of co-evolutionary selection and the size of the susceptible  and infected  groups is allowed to vary. the susceptible and infected population dynamics are inspired by the standard sis model with births and deaths as shown in the following difference equations:  <dig> Δs=s−s=η⋅b⋅n⋅k)−ξ⋅rn⋅s⋅i−λn⋅s+γ⋅i 
  <dig> Δi=it+1−it=ξ⋅rnt⋅st⋅it−λn+λd+γ⋅it 


where n = s + i,b = growth rate, k = carrying capacity, η=#ofsurvivedoffspring#ofoffspringcandidates, r = contact rate, ξ=#ofinfections#ofcontacts , r ⋅ ξ = transmission rate, λ
n = natural death rate, λ
d = disease related death rate, γ = recovery rate. the main difference from the standard ode sis model is that ξ and η are determined by the individuals in the population and these parameter values can change as the population evolves. in our model, ξ and η are determined through a complex process that includes random sampling within the population and the evaluation of individual phenotypes. the transmission rate is frequency dependent ), which assumes that a population occupies an area proportional to its size, i.e., per capita contact rate does not depend on population density, i.e. assuming a wide and unrestricted region affected by infectious viruses  <cit> . we also use standard assumptions of logistic population growth and that every offspring is initially susceptible. the difference equations dictate the number of offspring that need to be generated, the number of contact events between infected and susceptible hosts, host deaths, and recovered hosts at every time step, but because our model is individual-based, these numeric changes are applied to the actual populations as follows:

the growth term, η⋅b⋅nt⋅1−ntk, describes the number of offspring, which are generated via sexual or asexual reproduction and mutations in grn and amino acid sequences are generated as described above. the term b⋅nt⋅1−ntk is the total number of offspring candidates who have the stable gene expression and express at least n
er receptors. as candidates who have infected parents are less likely to survive, only a fraction of the candidates  can actually be added to the susceptible population. if phenotypes of the offspring candidates satisfy the criteria of expressing the minimal number  of receptor genes, and depending on the survival probability, the candidate may be added to the susceptible population. the survival probability is  <dig> if both parents are susceptible, k
i <  <dig> if both parents are infected, or ki+ <dig> if only one parent is infected. therefore among the b⋅nt⋅1−ntk candidate offspring, only a fraction η of candidates can be added to the susceptible population when k
i is less than  <dig>  thus, the parameter k
i determines selection due to viral pathogenicity. for the infection term, the number of contacts is rnt⋅st⋅it. here, for each contact we choose a random pair of susceptible and infected individuals. each infected host individual contains a single virus that caused the infection. with each host-virus contact event, the virus mutates the original amino acid sequence at the point of the infection with mutation rate, μ
vp =  <dig>  per protein. the virus can bind a host receptor if the percentage of one-to-one amino acid pairs that match between the virus and the host receptor exceeds a matching threshold, ϵ
seqm. if the virus can bind at least one of the expressed receptors on a susceptible host, then the infection proceeds and the individual moves from the susceptible to the infected population together with the virus that infected it, otherwise the susceptible individual remains in the susceptible population. successive infection attempts by the same infected individual will involve new mutations with each host-virus contact occurs. thus, virus transmission will depend on the coevolving host resistance and pathogen virulence. also, note that the fraction of successful infections ξ in the eqs.  <dig> and  <dig> is determined empirically, rather than as a given parameter.

parameters
there are parameters at both the level of population dynamics and at the individual level, i.e. governing the regulatory network and the protein sequences . as described in the main text and in the figures, we tested a range of parameters including protein binding site amino acid sequence length , the minimum number of required expressed receptors , host protein mutation rate , amino acid matching threshold for receptor binding , offspring survival probability from both infected parents  and disease-related death rate  to investigate the effect of parameter changes on host resistance evolution. unless otherwise stated, in the main text figures we used the following parameters: for the population dynamics model, the number of simulations =  <dig>  initial host population size m
init =  <dig>  initial virus population size =  <dig>  offspring survival probability from both infected parents k
i =  <dig> , amino acid matching threshold for receptor binding ϵ
seqm = 90 %, carrying capacity k =  <dig>  growth rate b =  <dig> , natural death rate λ
n =  <dig> , disease-related death rate λ
d =  <dig> , recovery rate γ =  <dig> , host-virus contact rate r =  <dig>  these parameters are chosen to make steady state host population size large enough to investigate evolutionary mechanisms. for the grn and protein evolution model, virus protein mutation rate μ
vp =  <dig> , the number of tfs n
tf =  <dig>  network density c =  <dig> , mutation rate per w μ =  <dig>  with ρ =  <dig>  and ϕ =  <dig>  . note that ϕ + δ =  <dig>  since for an interaction , deletion and modification are conditional on the interaction being nonzero value . these individual level parameters are chosen based on our previous study  <cit> .table  <dig> the list of model parameters


l

μ
hp

μ
vp

n
tf

n
r

n
er

ϵ
seqm

k
i

ξ
#ofinfections#ofcontacts

η
#ofsurvivedoffspring#ofoffspringcandidates

k

m
init

b

λ
n

λ
d

γ

r

c

μ

ρ

ϕ

δ

σ

a
the list of model parameters at both the level of population dynamics and at the individual level in symbols with descriptions and parameter values used in this study




measure of unevenness among targeted receptors
every  <dig> time steps after the coevolution phase has begun, we use the gini coefficient to calculate unevenness in the targeted receptors among the newly infected hosts. let y
i be the mean number of newly infected hosts who match their sequences to the i
th receptor throughout the simulation. if these values are sorted in ascending order such that y
1′ ≤ y
2′ ≤ … ≤ y
n − 1′ ≤ y
n′, then the ginicoefficient=n+1−2∑i=1nyi′n+1−i∑i=1nyi′/n. gini coefficient is  <dig> for the maximum unevenness  and  <dig> for perfect evenness .

measure of ability to switch multiple receptors using gene regulatory network rewiring
every regulatory interaction in the grn is mutated  <dig> times and we measure how often it switches expression of more than one gene. we then measure the average fraction of such perturbations that caused a multi-receptor expression switch over all regulatory interactions in the network for all susceptible individuals.

RESULTS
population dynamics of infection
for many infectious diseases, hosts never achieve long-term immunity due to rapid pathogen divergence. in particular, rna viruses such as rhinoviruses and coronaviruses mutate so rapidly that even hosts that have recently recovered from an infection can become susceptible again to different strains of the same viruses circulating in the population. the susceptible-infectious-susceptible  model is a simple infectious disease model that has been widely used to describe population dynamics for rapidly evolving pathogens and their target host populations  <cit> . we introduce a model of host-virus coevolution that extends the gene regulatory network evolution model of gene regulatory network evolution, integrating it with a discretized form of the sis model at the population level . in our combined model, population sizes can vary, in contrast to the original gene regulatory network evolution model that considered a fixed population size. since we preserve an explicit representation of each individual genotype in the population, we can observe the evolution of defense and infection mechanisms in both the host and pathogen populations. in its standard form, the sis model uses fixed values to describe parameters such as the infection transmission rate. however, on evolutionary timescales, parameters such as host susceptibility and pathogen virulence are likely to vary over time and consequently key model parameters such as the transmissibility, ξ, will also change. in our model, each host genotype is represented explicitly with a gene regulatory network and the corresponding receptor protein sequences . each virus is represented explicitly with a receptor binding protein sequence, that will be compared to the host receptor sequences during contact  events . hence, rather than determining the rate of infection based on a fixed parameter, as in the standard sis model, we allow the contacting host and pathogen phenotypes to determine infection events. specifically, the key transmission parameter ξ=#ofinfections#ofcontacts that determines the infection rate  changes as both hosts and viruses evolve. analytically, the steady state susceptible and infectious population sizes are s˜=δir⋅ξ⋅k⋅1−1b⋅η⋅λn+λd1−δir⋅ξ and i˜=1−δir⋅ξ⋅k⋅1−1b⋅η⋅λn+λd1−δir⋅ξ respectively when r ⋅ ξ ≠  <dig> and b⋅η−λnλd>1−δir⋅ξ> <dig> where δ
i = λ
n + λ
d + γ. different steady state values of ξ lead to different s˜ and Ĩ since these population sizes ultimately depend on the value of ξ. since our main interest is the evolution of host resistance mechanisms, we only analyzed cases where the mean population size over time is greater than the initial susceptible population size . in cases where the mean total population size < m
init , we found that the susceptible population was too small to investigate and these cases mostly occur when the extremely infectious viruses appear which can spread widely and makes the host population sick.fig.  <dig> diagram of gene regulatory network  and host-virus interaction scheme. a the grn is composed of a transcription factor regulation sub-network and a receptor protein coding regulation sub-network. mutations at the network level can be used to shut down the targetable receptor. mutations at the protein level can result in a protein mismatch to block virus protein binding. b if more than ϵ
seqm % of amino acids are one-to-one matched, we assume the virus protein can bind to the matched receptor . if less than the threshold  are matched, we assume the virus protein fails to bind the receptor




we measured the steady state transmissibility , defined here as the mean value of ξ across the last  <dig> time points in each simulation, and considered how this measure changed under different conditions such as the protein binding sequence complexity , host protein mutation rate , the number of required expressed receptors , the threshold above which the virus and receptor proteins are considered to have matched , the survival rate from infected parents  and the disease-related death rate . as shown in fig.  <dig>  higher receptor binding sequence complexity  and higher host protein mutation rates  tend to generate lower transmissibility ξ and are therefore disadvantageous to virus transmission. similarly, when more receptors have to be expressed on the host cell surface , there are more ways in which viruses can attempt receptor binding and consequently, ξ tends to increase together with the number of required expressed receptor , at least when the receptor binding complexity is low . for similar reasons, the transmissibility ξ also increases for lower matching threshold  value, such that when protein binding sequence complexity  is low, reducing the matching threshold  dramatically increases virus transmission whereas for complex receptor binding, it does not have an advantageous effect on ξ . that transmissibility ξ increases only in the case of low complexity binding can be explained by the way viruses target host receptors, as explained in the next section. intuitively, when a survival rate from infected parents  is low, non-resistant offspring have much lower fitness  than resistant offspring, and thus resistant individuals should increase in frequency. this would actually tend to decrease ξ which is the opposite of what we observe. however, we found that in practice, it is more common for a low k
i value to cause population decay and a large decrease in the number of contacts between host and virus individuals as shown in . a reduced number of contacts causes a larger decrease in the denominator of ξ#ofinfections#ofcontacts, and therefore leads to a net increase in ξ . the observation of higher ξ as a consequence of a high disease related death rate  is due to the same reason as for low k
i . in sum, the virus transmissibility is dependent on various conditions for different underlying reasons. we now consider in greater detail why and how these variables affect the host and virus population dynamics and virus transmission.fig.  <dig> transmissibility changes for different receptor binding complexity and host protein mutation rate. the mean transmissibility  for the last  <dig> time points . ξ increases as the receptor binding complexity decreases  in which case viruses can target multiple receptors and as the host protein mutation rate  decreases which is due to the more limited speed of protein mutations to counteract the rapidly evolving viruses




host resistance strategy depends on the number of targeted receptors
since receptor-virus protein binding enables virus entry and determines whether the infection succeeds, the virus’s ability to target multiple receptors and host’s ability to escape virus protein binding will have a significant impact on host resistance and viral pathogenicity. hence we measured the number of targeted receptors across a variety of different conditions. we next show how the number of targeted receptors can change depending on the receptor binding complexity , the number of required expressed receptors , protein binding threshold , the survival rate from infected parents  and the disease-related death rate . as each simulation proceeded, we measured the frequency with which multiple receptors are targeted simultaneously and also used the gini coefficient to measure the unevenness in the distribution of targeted receptors among the newly infected hosts throughout the simulation . thus, for example, when the frequency of multi-receptor matching is low, this indicates that mostly a single receptor is being targeted by the virus. however, this does not guarantee that the virus population targets the same specific receptor or whether different subpopulations are targeting distinct receptors. in this case, when the gini coefficient of targeted receptors is high, this indicates that all viruses target a common receptor and when the gini coefficient is low, this implies that the matched receptor for each host is different and that viruses have diversified into subpopulations by targeting different receptors.

when binding complexity  is low, viruses can target different receptors by means of a few amino acid mutations, whereas when receptor binding complexity is high, targeting multiple receptors is more difficult since the different receptors are likely separated by more mutations. hence, as shown in , when l is short, multiple receptors are often targeted simultaneously and the frequency of each receptor being targeted is not highly variable . considering this, more permissive receptor binding , increases the chances for multiple receptor targeting when l is short . on the other hand, when binding complexity is high, a single receptor is usually targeted and the gini coefficient is close to  <dig> indicating there are usually one or two dominant targeted receptors . furthermore, in this case, reducing the receptor binding threshold does not help viruses target multiple receptors . these results indicate that for complex receptor binding, one or two receptors are targeted for virus entry and that there is no switch from one targeted receptor to another . based on this observation, as expression of more distinct receptors is required , multiple receptors can be targeted and at the same time the gini coefficient decreases only when receptor binding complexity is low . on the other hand, when receptor binding is complex , increasing n
er does not allow more receptors to be targeted by viruses . hence the number of required expressed receptors only impacts the strategy of the virus when the receptor binding is less complex . interestingly, the survival rate of offspring from infected parents also affects how the viruses target receptors. as we explained in the previous section, a low survival rate from infected parents  causes the host population to become sick  and thus the population size decays. consequently, as shown in fig. 6d, e and f, we observe that variation within the host population decreases, suggesting that viruses will need to specialize on binding to specific receptors . specific receptor targeting as a consequence of high disease related death rate  arises for the same reason as for low k
i . we tested the effect of diversity in the initial virus population on the number of targeted host proteins. we compared a case with a highly diverse initial virus population to the default case of two initial viruses. thus, given an initial population of  <dig> distinct founder viruses, each three viruses were chosen to bind a distinct host receptor. with l =  <dig>  μ
hp =  <dig>  and n
r =  <dig>  all virus strains except one went extinct. in this case, the frequency of multi-receptor targeting was  <dig>  ±  <dig>  and unevenness of targeting receptors  was  <dig>  ±  <dig>  which is close to the values for the  <dig> founder virus case. even with l =  <dig>  μ
hp =  <dig>  and n
r =  <dig>  we could not find a significant difference from the  <dig> founder case. here, the frequency of multi-receptor targeting was  <dig>  ±  <dig>  and unevenness of targeting receptors  was  <dig>  ±  <dig> . in sum, receptor binding complexity  affects viruses by determining the variety of targetable receptors, although this also is dependent on parameters such as n
er and ϵ
seqm. also indirect causality between host population diversity and parameters, k
i and λ
d has an influence on the specificity of targetable receptors. so far, we considered how viruses behave and choose infection strategies for different conditions. we next explore how hosts react to virus infection strategies differently depending on the various environments.fig.  <dig> two different virus infection strategies: targeting a specific receptor or non-specific multiple receptors. a the fraction of time points that multiple receptors are targeted simultaneously and b the gini coefficient of the frequency of targeted receptors for different receptor binding complexities  . a lower gini coefficient  indicates evenness and one that is close to one indicates inequality. as the receptor binding complexity increases  viruses target a specific receptor and do not change the target receptor over time




evolved preference for resistance using network rewiring
hosts can adopt two different resistance strategies in the model: 1) gene regulatory network rewiring to switch a targeted receptor off and 2) protein binding site changes to block protein binding to a targetable receptor. here we consider how hosts balance the usage of these two strategies and what conditions determine their relative preference. at each time step the most frequently targeted receptor is identified among the set of newly infected hosts and from here we measure how often successful resistance events use network rewiring to shut down the most targetable receptor rather than protein sequence changes. we proceed by counting the fraction of hosts who resisted successfully and that do not express the most frequently targeted receptor. if there are multiple equally frequent most targeted receptors, we use the mean frequency across those receptors. the fraction of resisted hosts using network rewiring was measured at every time point. we then accumulated these measurements over all time points throughout the simulation and if the overall use of network rewiring resistance was higher than protein level resistance, we counted the simulation as preferential to rewiring. we subsequently measured the fraction of simulations for which this occurred to quantify the relative use of rewiring across many simulations. using this measure, we find that grn rewiring is preferentially used as protein binding complexity increases . this outcome relates to the number of targeted receptors since when protein binding is more complex, the virus most often targets a single receptor and therefore down-regulating the targetable receptor is usually an effective strategy. conversely when protein binding is low complexity, viruses are able to enter the host cell by binding multiple receptors and therefore rewiring is a less effective host strategy for resistance. as the host protein mutation rate  decreases, hosts also use grn rewiring more often due to the reduced ability to catch up with the relatively fast-evolving virus proteins . as we increase the number of receptors that need to be expressed  then combinatorially there are fewer possible phenotypes for a given number of required receptors, and viruses have more chances to bind to the different receptors so that the frequency of resistance using grn rewiring decreases . reducing the protein matching threshold also favors the protein interaction level . lastly, at low survival rate  from infected parents and at high disease related death rate , viruses tend to target more specific receptors, which is due to population size decay and low population diversity . in fact, as shown in , the potential for resistance  via network rewiring increases. however, the small population size and low variation do not allow this potential to be realized. this explains the apparently contradictory result of , where the observed  number of resistance events occurring via grn decreases when k
i is low but also when λ
d is high. hence, unlike with l, n
er and ϵ
seqm, we observed that low k
i and high λ
d did not promote resistance via network rewiring . in sum, hosts choose a resistance mechanism depending on the virus infection strategy and their defense ability relative to viruses . in the next section, we consider the temporal dynamics of hosts with respect to regulatory network and receptor protein binding evolution.fig.  <dig> preference for resistance using gene regulatory network  rewiring rather than protein mutations. the fraction of simulations where grn rewiring strategy is used more often than protein binding site change for successful resistance under different protein binding complexities  and host receptor sequence mutation rates . in a more complex receptor binding system, hosts tend to select the grn rewiring strategy more often than the protein mutation strategy due to the single receptor targeting infection strategy. since low μ
hp means a lower rate of protein mutations to counteract the rapidly evolving viruses, hosts tend to favor a protein mutation strategy less




evolutionarily gained potential to switch from infectious to resistance using grn rewiring and protein mutations
in the previous section, we showed that hosts determine the resistance strategy between grn rewiring and protein binding site mutation depending on factors such as binding site complexity and mutation rate relative to that of the virus. we now consider the evolution of the potential within the population to resist future virus contact events. for each virus in the infected group, we selected all susceptible hosts in the population that can be potentially infected by that virus and measure how efficiently each host can avoid infection via a random mutation either in its grn or in protein binding sites. every regulatory interaction in the grn was mutated multiple times and we then measured how often it switched to becoming resistant as a consequence of these network perturbations. similarly, for each matched receptor, we mutate the receptor using the host protein mutation rate at each site  and measured the average fraction of such perturbations that caused a switch to resistance. the reason for using the same protein mutation rate that is used within the simulation rather than a single random amino acid mutation for the perturbation is that the impact of a single site amino acid mutation differs depending on the protein binding site length . for example, when l is long, a chance of switching from infectious to resistible is very low, whereas when l is short, a host can easily switch from infectious to resistible.

for resistance acquired via regulatory rewiring, the ability to resist increases only when the protein complexity is high , while it does not increase when the protein binding complexity is low . it is plausible that when the protein binding complexity is low, since network rewiring is not a good resistance strategy  due to multiple receptor binding site matches by viruses , it is unnecessary for individuals to evolve network rewiring potential and for this reason few perturbations are expected to change receptor gene expression to switch the targetable receptor off. in contrast, when the protein binding complexity is high so that the targeted receptor is specialized to one receptor  and switching targetable receptor off by network rewiring is adopted by hosts , hosts evolve the potential to resist by network rewiring. in contrast, for resistance via protein mutations, we observed that under all conditions hosts rapidly evolve the ability to acquire resistance via protein binding site changes  because the protein binding site mutations can directly affect virus protein binding.fig.  <dig> trade-offs in the resistance potential between the gene regulatory network and receptor proteins. for the susceptible host population, the ability to resist using a grn rewiring and b protein binding site changes is measured for different receptor binding complexities . as the receptor binding complexity increases, hosts increase evolutionary potential more on the grn while decreasing it on receptor proteins 




we also observed that there is an apparent tradeoff in that, as the resistance ability via rewiring increases  with receptor binding complexity, the ability to resist using binding site mutations decreases . the complexity of the protein-protein interaction appears therefore to be an important factor driving the transition toward resistance using regulation and thus leading to higher grn complexity. as expected, when the protein mutation rate is low, hosts will use grn rewiring more for resistance as a consequence of the limited capacity for protein mutations to coevolve with the viruses . the ability to resist using network rewiring also depends on the number of required expressed receptors . as more receptors are required to be expressed , viruses have a greater probability of targeting more than one receptor. hence, as shown above in , the fraction of simulations where grn rewiring is used in preference to protein mutation decreases for higher values of n
er. however, for the same reason, hosts are under pressure to evolve the ability to resist using network rewiring more when more receptors are required to be expressed . in the , in higher matching threshold  condition, viruses are not able to target multiple receptors and the fraction of simulations where grn rewiring is preferentially used also increases . consequently high ϵ
seqm results in evolution of the potential to resist infection using grn . a lower survival rate from infected parents induces viruses to target specific receptors . therefore, for such viruses, hosts are evolved to increase the ability to resist using grn rewiring to shut down the targetable receptor .

so far, we explored various conditions that can promote the evolution of the ability to resist using grn rewiring. interestingly, receptor binding complexity balances the usages of grn rewiring vs amino acid mutations for resistance. resistance via protein binding site mutation is much higher than that using network rewiring under all conditions. this may explain why receptor binding site mutations have been reported often for virus entry defense mechanisms in contrast to resistance via regulatory changes.

genetic diversity and host range
in many previous studies it has been shown that antagonistic coevolution between host and pathogen populations correlates with increased genetic diversity  <cit> . we checked that the diversity of the regulatory network, the phenotype and the protein sequence all increase throughout the coevolution phase . to quantify diversity we used the margalef index  <cit> , an ecological measure of biodiversity that takes into account the expected increase in species sampled as a consequence of increased sample size thenumberofgeneticvariants−1lntotalnumberofindividuals. after we simplified each grn using the sign of each interaction matrix entry , we measured the grn diversity of a susceptible host group as thenumberofdistinctgrns−1lnsusceptibleindividuals. we found that diversity of grns, phenotypes and receptor protein sequences all increased throughout the coevolutionary phase, showing that coevolution between hosts and viruses is an important factor in producing genetic diversity. we also used the margalef index to quantify the genetic diversity of the infected group to estimate virus host range. we compared the diversity over the last  <dig> time steps in intervals of 50-time steps to identify variables affecting host range and under what conditions pathogens evolve as specialists or generalists . we observed that pathogens become either specialists or generalists dependent primarily on three parameters: protein binding complexity, survival rate for offspring from infected parents, and the matching threshold. for example, as receptor binding complexity increases, viruses tend to become specialists, which directly relates to the number of targeted receptors due to the difficulty in this case for binding multiple receptors . also a lower survival rate for offspring from infected parents narrows the host range and leads viruses to become specialists because this condition causes the host population size to decay and thus reduces variations within the host population . for the same reason, since a low matching threshold is beneficial for virus entry when the binding complexity is low , viruses become specialists .fig.  <dig> host range measured by infected host population’s genetic diversity under different conditions. the first column is the gene regulatory network diversity, the second column is the phenotype diversity and the last column is the receptor protein sequence diversity. viruses become specialists when receptor binding complexity  increases , survival rate for offspring from infected parents  decreases  and amino acid matching threshold for protein binding  decreases . for low ϵ
seqm and k
i, population dynamics generally follows that shown in additional file 2: figure s <dig> b. hence, in d ~ i) we considered all  <dig> simulations for measuring the genetic diversity




discussion
we showed that regulatory changes can be used to suppress expression of cell surface receptor genes leading to a blocking of virus entry. changes in the expression of virally-targeted receptors has been shown to block virus transmission experimentally, for example, in both dengue virus   <cit>  and hepatitis c virus   <cit> , sirnas can be used to eliminate cell surface receptors and suppress virus entry and infection. at the same time, specific receptors can be intentionally expressed in the context of tumor gene therapy, for example, allowing adenovirus vectors to be used  <cit>  to deliver apoptosis-activating genes to kill tumor cells.

two mechanisms of resistance were addressed in our model: rewiring of gene regulatory networks and receptor binding site mutations. the balance in usage between these two mechanisms depends on various conditions. as the protein-protein interaction at the cell surface increases in complexity , viruses tend to target a specific receptor and hosts preferentially use network rewiring more often than receptor amino acid changes. in contrast, when the receptor binding site has lower complexity, viruses are able to enter via multiple receptors and hosts evolve receptor amino acid changes to escape viral protein binding. one can ask why is it that in nature, examples of resistance via receptor amino acid mutations appear to be more common than network rewiring? in the examples of dengue virus  and hepatitis c virus  resistance through experimentally-induced receptor down-regulation it was shown that, since there several alternative receptors expressed on the cell surface that viruses can use to enter host cells, multiple inhibitory sirnas for different receptors worked better than a single sirna for one receptor, although both studies showed that it was difficult to block infection completely  <cit> . thus, for example, hcv can enter human liver cells via several cell surface receptors including cd <dig> tetraspanin, claudin <dig>  low density lipoprotein receptor receptor  and scavenger receptor class b type  <dig> . in our model, when receptor binding has low complexity, multiple receptors are targeted by viruses and receptor amino acid mutations are used preferentially over network rewiring. given this observation, the capability of viruses to use alternative receptors for host cell entry is a plausible explanation of why resistance using network rewiring changes is difficult in practice. another possible reason for more frequent protein level resistance could be related to the level of functional redundancy among receptors. higher n
er indicates less functional redundancy among receptors, and we found that protein level resistance was favored for higher n
er . although functional redundancy is often observed in receptors such as nectin and chemokine receptors as described in introduction, it is plausible that viruses evolve to target receptors whose absence cannot be compensated for, so that hosts have to express all  required receptors for their normal function, which makes it difficult to use network level resistance.

in order to investigate the importance of including the complex grn for controlling receptor gene expression, we compared our model with one that did not contain gene regulatory interactions for receptor coding genes. we designed this model by using a diagonal matrix regulatory network both for tf genes and for the receptor coding genes. complex gene regulation by tfs were removed by having a diagonal matrix with 1 s for the regulatory gene network. to satisfy the minimum number of required expressed receptors , we set the initial density of non-zeros on the diagonal for the receptor coding genes with probability  <dig> . here, mutations can occur only on the diagonal of receptor coding genes and no regulation from other genes is possible. compared to this model, the benefit of having a complex grn is that the network is capable of evolving increased potential for resistance using network rewiring as shown in fig. 5a for complex protein binding , as an example. here, in the case of complex protein binding where a specific receptor is targeted, it is not possible for the potential for resistance to change because there is only a single entry on the diagonal which can change the expression of the targeted receptor. we compared the preference for grn level resistance between these two models. we found that the preference of grn rewiring decreased for the model without gene regulatory interactions . furthermore, in order to express at least n
er receptors for the normal host cell function, down-regulating a receptor gene for resistance can be deleterious, and therefore, hosts need to be able to change the expression of multiple receptors simultaneously, in particular to compensate for receptor down-regulation. we found that the systems with complex grns evolve the ability to switch the expression of multiple receptors , whereas without the grns, multiple receptor expression change is impossible given a single mutation.

although defending from infection at the level of virus entry would appear to be an effective resistance mechanism, the host evolution rate is usually too slow relative to most virus populations and furthermore, viruses are often capable of entering host cells via interaction with multiple receptors. for these reasons, host strategies may have evolved preferentially to allow viruses to enter cells but to focus defense mechanisms to the post-entry stage by evolving innate and adaptive immune systems. for example, a previous study of north american house finches showed rewiring of gene regulatory networks to up-regulate immune related genes in a relatively short timespan of just 12 years  <cit> .

in addition to network rewiring and receptor amino acid mutations, mutations causing premature stop codons can be used by hosts to block virus entry. ccr <dig>  is a co-receptor for hiv entry that facilitates virus entry. a ccr <dig> allele carrying a 32-bp deletion  in the open reading frame generates a premature stop codon leading to an inactive receptor protein  <cit> . homozygous ccr5Δ32/ccr5Δ <dig> carriers show high immunity to hiv infection and heterozygous wt/ccr5Δ <dig> carriers show partial resistance to hiv cell entry or delayed progression of the disease. a similar example is an allele of the tvbr receptor involving a 4-bp insertion which contains a stop codon resulting in protection against avian sarcoma and leukosis virus  entry in chicken  <cit> . of note is that even though these stop codon-containing alleles can block virus entry, they work effectively only in homozygous form, in contrast to alleles encoding regulatory repression, which may be effective in single copy form.

CONCLUSIONS
entry to the cell is the first step in all virus infections. evolving barriers to infection at the level of entry to the host cell can become an effective resistance mechanism. although many examples of defense mechanisms have been reported that are based on disruption to cell surface receptor binding sites due to copy number variation and mutations producing stop codons have been reported, examples of resistance by gene regulatory changes in receptor expression levels are less commonly observed. we built a host-virus coevolution model where hosts are represented using both receptor amino acid sequences and gene regulatory networks  that control expression of the cell surface receptor genes. we explored a range of evolutionary conditions that might determine the balance of host resistance mechanisms at the grn level compared to protein interaction level. we observed that the complexity, or length, of the receptor binding site  is one of the key factors that have a significant impact on both the infection strategy of the virus and resistance mechanism of the host. when l is short, viruses evolved to be generalists and target multiple receptors for cell entry. in this case hosts evolve to a counter-strategy that uses binding site mutations to defend against virus protein binding. in contrast, when l is long, viruses evolve to be specialists and focus on targeting one particular receptor, whereas hosts evolve a counter strategy at the network level that uses regulatory changes to turn off the expression of the targeted receptor. considering examples of virus entry such as hepatitis c virus, where viruses can make use of multiple receptors for entry to the cell, it is plausible that viruses predominantly evolve low complexity receptor binding and that in these cases hosts evolve to use protein binding level resistance mechanisms rather than grn level mechanisms.

additional files

additional file 1: c++ simulation source codes. 


additional file 2: figure s <dig>  two different types of susceptible and infectious population dynamics. typical population dynamics of a) healthy population case where the mean host population size is greater than the initial host population size and b) sick population case where the mean host population size is less than the initial population and the population is composed of more infected hosts than healthy hosts. . 


additional file 3: figure s <dig>  transmissibility changes for different conditions. the mean transmissibility  for the last  <dig> time points . a) ξ increases as the number of required receptor expression  increases when the binding complexity  is low. for low receptor binding threshold , low survival rate from both infected parents  and high disease related death rate , population dynamics generally follows that shown in additional file 2: figure s <dig> b. hence, in b), c) and d) we considered all  <dig> simulations for the comparison of mean ξ values. ξ increases as  the receptor binding site matching threshold  decreases, as  the survival rate from both infected parents  decreases and as  disease related death rate  increases. 


additional file 4: figure s <dig>  the number of contacts between host and parasite populations for different offspring survival rate from infected parents. the number of contacts between host and parasite populations decreases when offspring survival rate from infected parents  is low . 


additional file 5: figure s <dig>  viruses change their receptor targeting strategy under different conditions. the first column is the fraction of time points that multiple receptors are targeted simultaneously and the second column is the gini coefficient of the frequency of targeted receptors . a, b) when the binding complexity is low, a greater required number of expressed receptors  causes viruses to target multiple receptors simultaneously. however, when the binding complexity is high, a higher required number of expressed receptors does not change the targeting to a multiple receptor binding strategy. for low receptor binding threshold  and survival rate from both infected parents , population dynamics generally follows the trend shown in additional file 2: figure s <dig> b. hence, in c ~ h) we considered all  <dig> simulations for the comparison of the fraction of time points that multiple receptors are targeted simultaneously and the gini coefficient of the frequency of targeted receptors. c, d) the low amino acid matching threshold for the receptor binding  facilitates viruses to target multiple receptors. e, f) the low survival rate of an offspring from both infected parents results in viruses targeting more specific receptors for more robust receptor binding. g, h) the high disease related death rate  causes more specialized receptor targeting. 


additional file 6: figure s <dig>  preference for resistance using gene regulatory network  rewiring to protein mutations under different conditions. the fraction of simulations where grn rewiring strategy is used more often than the protein binding site change strategy for resistance for different a) required number of expressed receptors , b) amino acid matching threshold for the receptor binding , c) survival rate from both infected parents  and d) disease related death rate . for low ϵ
seqm, k
i and λ
d, the population dynamics generally follows that shown in additional file 2: figure s <dig> b. hence, in b, c, d) we considered all  <dig> simulations for the comparison of the preference for resistance using grn rewiring to protein mutations. a) as more receptors are required to be expressed , hosts preferentially use grn rewiring less often than protein mutations. b) when the binding complexity is low, for lower amino acid matching threshold for the receptor binding , hosts do not preferentially select grn rewiring strategy. c) when k
i is low, hosts does not favor the grn rewiring strategy. d) when the disease related death rate  is high, hosts hosts less favor the grn rewiring strategy for resistance. 


additional file 7: figure s <dig>  evolutionary potential for resistance in the gene regulatory network and receptor proteins for different conditions. for susceptible host population, the ability to resist using grn rewiring  and protein binding site changes  is measured for different a, b) host protein mutation rates , c, d) number of required expressed receptors , e, f) amino acid matching threshold for the receptor binding , g, h) survival rate from both infected parents  and i, j) disease related death rate  . for low ϵ
seqm and k
i, population dynamics generally follows that of additional file 2: figure s <dig> b. hence, in e ~ h) we considered all  <dig> simulations for the comparison of the resistance potentials. a, b) for lower μ
hp, hosts evolve a grn based strategy . c, d) when expression of more receptors is required, hosts evolve the potential for resistance using grn rewiring to higher level. , e, f) when receptor binding is simple , for reduced ϵ
seqm hosts does not necessarily evolve the potential for a grn rewiring strategy . g, h) selection pressure triggered by the low k
i evolves the potential for grn rewiring strategy . i, j) the potential for resistance using network rewiring increases both for low and high diseases related death rates . 


additional file 8: figure s <dig>  increased genetic diversity in the gene regulatory networks, phenotypes and receptor proteins. genetic diversity is measured using the margalef index . a) whole grns , transcription factor regulation sub-networks , receptor regulation sub-networks  of susceptible hosts. b) phenotypes  of susceptible populations. c) receptor sequence of susceptible populations. 


additional file 9: figure s <dig>  the effect of having a complex gene regulatory network  for controlling receptor gene expression. a) preference for resistance using grn rewiring to protein mutations decreases when there are no regulatory interactions between genes  . b) the ability to switch the expression of multiple receptors with a complex grn. the probability of multiple receptor gene expression switching  increases during host-virus coevolution . 




abbreviations
carcoxsackie and adenovirus receptor

ccr5cc-chemokine receptor-5

grngene regulatory network

hcvhepatitis c virus

ithe size of infected

mmtvmachupo virus

ppiprotein-protein interactions

sthe size of susceptible

sissusceptible-infected-susceptible

tftranscription factor

tfr1transferrin receptor-1

