BACKGROUND
the past decade has witnessed an exponential increase in epidemiologic studies of dna methylation, driven in large part by increasing appreciation for its critical role in the development and progression of human diseases together with the declining cost of high-throughput technologies for interrogating the epigenome. following the namesake adopted for genome-wide, genetic association studies of disease phenotypes , studies investigating the role of dna methylation in human diseases and exposures have been aptly dubbed epigenome-wide association studies   <cit> . while gwas and ewas data share many of the same analytical challenges, the tissue specificity of dna methylation presents an added layer of complexity in the analysis, and particularly in the interpretation of ewas. owing to the tissue specificity of dna methylation, it is now well established that comparisons of methylation signatures assessed over heterogenous cell populations are susceptible to confounding and misinterpreted associations , issues that are believed by many to be among the foremost challenges currently facing ewas .

recent attempts aimed at minimizing the potential for confounding in the analysis of dna methylation data have prompted some researchers to restrict methylation assessment to purified cell populations  <cit> , for example, cd4+ or cd14+ cells isolated from peripheral blood. although such studies may be less prone to confounding by leukocyte-lineage heterogeneity compared to those involving whole blood  dna methylation assessments, purification of cell populations carrying these markers will not completely eliminate heterogeneity attributable to lineage differences  <cit> . other attempts to address the potential for confounding in blood-based dna methylation data have involved adjusting statistical models with additional terms reflecting the cell composition of study samples using, for example, measurements from complete blood cell counts  or fluorescence-activated cell sorting   <cit> . however, these measurements are not often collected as part of ewas , the reasons for which commonly include: insufficient quantities of substrate for both dna methylation assessment and measurements of cell composition, budgetary constraints, and the inability of technologies - such as facs - to accurately measure biospecimens stored over extended time periods. in addition, because ewas typically represent subsidiary studies, whose associated parent study predate current understanding of the impact of cellular heterogeneity on dna methylation analyses, direct measurements of cell composition were unlikely to have been performed when biospecimens were initially collected. these considerations, together with the emerging consensus concerning the need to account for cell composition in the statistical analysis of dna methylation data  have served to motivate the development of novel statistical/bioinformatic methodologies for addressing the potential confounding effects driven by cell heterogeneity . the first of such methodologies  <cit>  and the most widely applied within the ewas literature leverages the cell-specificity of dna methylation as the basis for estimating the cellular landscape of samples consisting of heterogeneous cell populations. this approach, commonly referred to as cell mixture deconvolution , is grounded on the assumption that the methylation signature for a given target sample  can be viewed as a weighted mixture of the unique methylation signature of each of its constituent cell types, with weights reflecting the proportion of each cell type within the target biospecimen. under certain constraints, fairly routine statistical procedures can be employed to estimate such weights, thereby providing investigators with a “prediction” of the cellular distribution for each target sample to which it is applied. much in the same way one would adjust for cell composition if cell fractions were measured directly, estimates of cell composition obtained using cmd can be added as additional covariate terms to control for the potential confounding effects associated with cell heterogeneity .

the first and most critical step of cmd and the impetus for this research, involves assembling a library of cell-specific methylation biomarkers that collectively reflect the unique methylomic fingerprint of each cell type. in the case of leukocyte subtypes, we refer to such cell-specific methylation biomarkers as leukocyte-differentially methylated regions  to convey their differential methylation status across leukocyte subtypes. motivated by the critical role played by l-dmr libraries and their relationship to the accuracy of cell composition estimates  <cit> , here we develop and evaluate a novel, iterative algorithm for identifying optimal l-dmr libraries  that improves the accuracy and efficiency of cell composition estimates obtained by cmd.

in what follows, we aim to address three key questions:  does the optimal library identified from idol result in improved estimates of cellular composition compared to existing libraries,  if so, are there discernible differences between libraries that might offer an explanation for their prediction performance, and lastly , what impact does the difference in prediction performance between libraries have on ewas when estimates of cell mixture are desired. to address these important questions we begin by applying idol to a training set consisting of samples with both whole-blood dna methylation data ) and flow cytometry measurements of cell composition in order to calibrate the selection of an optimal l-dmr library. to illustrate the utility of the identified idol library as resource for future ewas, we benchmark its performance against existing libraries in two independent hm <dig> data sets and conduct a thorough comparison of libraries to gain insight into their observed prediction accuracy. finally, the impact of different libraries on the false positive rate and statistical power of ewas is evaluated using both simulation studies and a data application involving two large publicly available hm <dig> data sets.

RESULTS
the essential nature of library assembly and its impact on the accuracy of cell composition estimates is highlighted in fig.  <dig>  figure 1a,b depict heat maps generated from hierarchical clustering the k= <dig> major leukocyte components of wb  cells, b cells, monocytes, and granulocytes) based on their methylation signature across two different l-dmr libraries  <cit> . the first of these libraries to appear in the literature  was assembled using the  <dig> cpgs with the largest f-statistics computed from a series of anova models comparing cpg-specific patterns of methylation across leukocytes . the second library is the default library used by the estimatecellcounts function in the minfi biocondutor package  <cit> . while also comprised of  <dig> cpgs, the estimatecellcounts library is instead assembled using the top  <dig> cpgs that uniquely distinguish each cell type from the remaining k− <dig> cell types . while both libraries adequately discriminate lymphoid-derived cells  from myeloid-derived cells , the estimatecellcounts library exhibits far better discrimination of lineage-specific cell types, particularly, nk, cd4t, and cd8t lymphocytes . the net result of its improved discrimination of lineage-specific subtypes is uniformly better prediction performance across the entire immune cell landscape, the largest of such gains being associated with nk, cd4t, and cd8t lymphocytes .
fig.  <dig> impact of l-dmr library on the accuracy of cell composition estimation. a, b hierarchical clustering heat maps of the mean methylation signatures of isolated leukocyte subtypes  <cit>  using  the top  <dig> anova-ranked l-dmrs  and  the  <dig> l-dmrs that uniquely distinguish each cell type from all other cell types . column dendrograms are colored to reflect the cell-lineage of leukocyte subtypes: lymphocytes  and myeloid-derived cells . c image plot showing the difference in the dispersion separability criterion  between the estimatecellcounts and topanova libraries. for a given pair of leukocyte subtypes, larger values of dsc difference  indicate better discrimination associated with the estimatecellcounts library, whereas smaller values of dsc difference  indicate better discrimination associated with the topanova library. d scatterplots of the cmd predicted and facs cell fractions for the n= <dig> adultmixed samples. dashed lines indicate the line of unity, dotted lines represent the fitted regression lines based on cell predictions obtained using the topanova library, and solid lines represent the fitted regression lines based on cell predictions obtained using the estimatecellcounts library. e cell-specific prediction performance for the adultmixed samples based on the topanova and estimatecellcounts libraries



the principle reason for the difference in discrimination power and prediction accuracy between libraries is due entirely to the criteria used for their assembly. while assembling libraries using anova f-statistics might seem reasonable, it is inherently susceptible to the over-selection of cpgs that are capable of discriminating certain subsets of leukocytes , but provide poor discrimination of other subsets . on the other hand, the estimatecellcounts library is constructed by imposing an equal representation of cpgs for each cell type . this strategy leads to better discrimination of lineage-specific cell types and, as a result, improved estimation accuracy of those cell types . despite representing an obvious improvement over topanova, the prediction accuracy associated with estimatecellcounts demonstrates ample room for improvement and suggests that further refinements in the assembly of l-dmr libraries may provide the solution.

motivated by the critical role played by l-dmr libraries on the accuracy of cell composition estimates, we focus here on the development and evaluation of a novel iterative algorithm  for identifying l-dmr libraries that improve the performance of cmd. a schematic diagram illustrating the various steps of idol is given in fig. 2a. idol first involves the construction of a candidate set of l-dmrs consisting of cpg sites exhibiting differential dna methylation across leukocyte subtypes. from this candidate set, subsets of l-dmrs are randomly selected at each iteration, with each randomly selected l-dmr being evaluated for its contribution to cell composition prediction accuracy. the contribution of each l-dmr is then used to modify its probability of selection in subsequent rounds of idol, where selection probabilities are updated in a manner proportional to its contribution to prediction accuracy. this is similar in principle to the weight updating rule in supervised competitive learning networks and the update rules employed in learning vector quantization  <cit> . specifically, l-dmrs found to contribute favorably to prediction performance are updated to have greater chance of being selected in subsequent iterations, whereas l-dmrs that hinder or have no effect on prediction performance are updated to have a reduced chance of being selected . this dynamic process is repeated thousands of times, with l-dmr selection probabilities evolving at each iteration depending on how they impact the accuracy of cmd estimates . by updating selection probabilities in this way, randomly selected l-dmr subsets at each sequential idol iteration become enriched with l-dmrs that were previously marked as beneficial to prediction accuracy. as a result, the temporal evolution of idol witnesses the preferential selection of l-dmr subsets that, as a whole, contribute to improved accuracy of cmd estimates . upon termination, one is left with the subset consisting of the l-dmrs with the largest selection probabilities, henceforth referred to as the optimal idol library.
fig.  <dig> conceptual illustration of the idol algorithm. a schematic diagram showing each step of idol. b, c illustration of the scheme for updating the selection probabilities of l-dmrs. d conceptual depiction of the l-dmr selection probabilities as a function of the sequential progression of idol. at iteration  <dig>  l-dmrs have an equal probability of being selected for inclusion in the randomly assembled l-dmr subset. at each sequential iteration of idol , the selection probabilities for l-dmrs are updated in a manner proportion to their contribution to prediction performance; selection probabilities for l-dmrs that contribute favorably to prediction performance are increased , whereas the selection probabilities for those that hinder prediction performance are decreased . upon algorithm termination, the j
⋆ l-dmrs with the largest selection probabilities are taken to represent the optimal l-dmr library. e, f plots showing mean rmse  and coefficient of determination  respectively, as a function of sequential progression of the the idol algorithm



training the selection of l-dmr libraries for cell mixture deconvolution
to calibrate the selection of optimal l-dmr libraries, we first applied idol to a training data set consisting n= <dig> non-diseased adults with wb dna methylation and immune profiling data  samples’). flow cytometry estimated cell fractions of cd4t, cd8t, natural killer , b cells, monocytes, and granulocytes across the training samples are depicted in fig. 3a. on average, granulocytes represented the most abundant cell type across the training samples , followed by cd4t , cd8t , monocytes , b cells , and nk cells , in descending order of abundance.
fig.  <dig> results obtained from applying idol to the training set. a stacked bar plots showing the facs measured fractions of granulocytes , monocytes , natural-killer cell , b cells , cd8t lymphocytes , and cd4t lymphocytes  across the  <dig> training samples. b hierarchical clustering heat map of the mean methylation signature of leukocyte cell-types  based on the  <dig> optimized l-dmrs  identified by idol. the column dendrogram is colored to reflect the cell lineage of the leukocyte subtypes, where lymphocyte-derived subtypes are colored pink and myeloid-derived cell types are colored blue. c scatterplots of facs measured cell fractions  and predicted cell proportions obtained using the optimized idol library . dotted lines indicate the line of unity and colored lines represent the regression line fit to the facs measured cell fractions and predicted cell fractions. d overlap between idol and estimatecellcounts libraries. e image plot showing the difference in the dispersion separability criterion  between the idol and estimatecellcounts libraries for discriminating specific pairs of leukocyte subtypes. for a given pair of leukocytes, larger values of dsc difference  indicate better discrimination associated with the idol library, whereas smaller values of dsc difference  indicate better discrimination associated with the estimatecellcounts library. f histogram showing the results of a permutation-based testing procedure for examining the difference in the overall dsc between the idol and estimatecellcounts libraries



since the objective of idol is to identify the best subset  of l-dmrs from a larger candidate set of putative l-dmrs, we first focused on constructing this candidate set by identifying cpg sites with differential methylation across leukocytes. using the dna methylation profiles for isolated leukocyte subtypes reported in  <cit> , we first fit a series of two-sample t-tests to compare cpg-specific dna methylation patterns across the k= <dig> immune cell subtypes. specifically, the cpg-specific methylation signature of each of cell type was compared to the k− <dig> remaining cell types and the top  <dig> cpgs with largest and smallest t-statistics were combined into a single candidate list consisting of  <dig>  putative l-dmrs . following construction of the candidate set, we next applied idol to identify optimal libraries across a range of possible library sizes, from  <dig> to  <dig> cpg loci in increments of one-hundred. across the spectrum of library sizes considered, the average r <dig> and root mean square error  between flow cytometry measurements and predicted cell type proportions obtained from the identified optimal libraries was very stable, ranging from  <dig>  to  <dig>  for r <dig> and from  <dig>  % to  <dig>  % for rmse . as noted in additional file 4: figure s <dig>  a subtle drop-off in prediction performance was observed libraries whose size exceeded  <dig> cpgs. given the general preference for prediction models that use fewer features and because the library consisting of  <dig> cpgs  performed favorably both with respect to its average r <dig> and rmse, this library was selected as the representative idol library for all subsequent comparisons and analyses.

hierarchical clustering of leukocytes based on their mean methylation signature across the  <dig> cpgs in the optimal idol library is given in fig. 3b and clearly shows better discrimination of lymphocyte subtypes compared to the topanova library . using the idol library for deconvoluting the cellular mixture of the training set samples revealed a high degree of concordance between flow cytometry and predicted cell type proportions, with nearly perfect r <dig> values across all cell types and rmses ranging from as low as  <dig>  % for monocytes to  <dig>  % for cd4t cells . across the six leukocytes, the average r <dig> and rmse between the predicted and flow cytometry cell type proportions were estimated at  <dig>  and  <dig>  %, respectively. when compared to the results obtained from the application of both the estimatecellcounts and topanova libraries to training set , the idol library resulted better prediction performance for all cell types except b cells, whose predictions from estimatecellcounts exhibited slightly lower rmse . upon further comparison, the greatest improvements in prediction performance associated with the idol library occurred for monocytes and among lymphocyte subtypes. specifically, the idol library resulted in monocyte predictions that explained approximately  <dig> % more variation in the flow cytometry measurements of monocytes compared to estimatecellcounts . similarly, predictions of cd4t, cd8t, and nk cell type fractions obtained from the idol library explained an average of  <dig> % more variation in the flow cytometry derived fractions of these cell types compared to estimatecellcounts, and were associated with rmses that were on average  <dig> -fold lower.

of the  <dig> cpgs encompassing the idol library,  <dig>  were shared with  <dig> l-dmrs used by estimatecellcounts . to understand how differences between these two libraries might explain their observed prediction performance, we next compared libraries with respect to their ability to discriminate specific pairs of leukocytes. for each library we computed the dispersion separability criterion , defined here as the ratio of the average distance between cell-specific centroids and the overall mean to the average distance between samples of the same cell type. as such, increasing dsc values indicate greater between-cell-type dispersion/discrimination. using the leukocyte-specific methylation data reported in  <cit>  as the basis for estimation, we found that the idol library resulted in a significantly larger dsc compared to the estimatecellcounts library  . furthermore, a comparison of the dsc values computed between each pair of leukocytes showed that the idol library resulted in larger dsc values in  <dig> out of the  <dig> comparisons, of which  <dig> were associated with p-values that bordered on statistical significance  . among the  <dig> comparisons with marginally statistically significant p-values,  <dig> involved specific pairs of lymphocyte subtypes.

independent validation of the optimal l-dmr set
to validate the idol library identified in the training set, we next examined its performance for accurately deconvoluting the cellular composition of  <dig> additional samples spread across two independent test sets: methoda and methodb sets. as described in section ‘cell mixture reconstruction experiment’, the methoda and methodb data sets were created by mixing purified leukocyte subtype dna from cd4t, cd8t, nk, b cells, monocytes, and granulocytes in predetermined proportions . as such, the true cellular mixture of the methoda and methodb samples are known with a high degree of confidence, representing ideal candidates in which to validate the optimal library identified by idol in its application to the training set.
fig.  <dig> results obtained from applying the optimal idol library to the testing sets. a stacked bar plots showing the cell type fractions for each testing set sample. b scatter plots of the true reconstructed mixture fractions  and the predicted cell fractions obtained using the optimized idol library . circles indicate method a samples and squares indicate method b samples. dotted lines indicate the line of unity and colored lines represent the regression line fit to the true reconstructed mixture fractions and predicted cell fractions. c box plots showing the predicted cell  − observed cell  across leukocyte cell types, where blue boxes represent estimates obtained from the optimal idol library and red boxes represent estimates obtained from the estimatecellcounts library.  estimated false discovery rate  for a two-group comparison of dna methylation as a function of the dissimilarity in the cellular distribution between groups . colored lines represent different approaches for cell composition adjustment.  difference in the fdr between the estimatecellcounts and idol libraries where points above the dotted line indicate that the estimatecellcounts library resulted in more false positive results compared to the idol library. e mean difference in the fdr for varying sample sizes when cell mixture was adjusted using cell fractions estimates from the estimatecellcounts and idol libraries. bars represent the  <dig> % bootstrap confidence intervals for each point estimate. points to the right of the dotted line indicate that the estimatecellcounts library resulted in more false positive results compared to the idol librarys



as noted in fig. 4a, whereas the methoda samples are characterized by a roughly equivalent fraction of each cell type , the cellular composition of the methodb samples were reconstructed to resemble the immune cell landscape observed in healthy human adults  <cit>  . similar to the results obtained in the training set, cell type predictions in the testing sets using the idol library were highly correlated with true mixture fractions . specifically, the cell-specific r <dig> values computed across both testing sets ranged from  <dig>   to  <dig>  , with an r <dig> of  <dig>  averaged across the six cell types. in addition, the cell-specific rmses computed across the testing sets showed that in  <dig> out of the  <dig> cell types, predictions were, on average, within  <dig>  % of their true reconstructed mixture proportions. the two exceptions being nk cells  and cd8t cells . a comparison of the cell-specific r <dig> and rmses computed within the methoda and methodb data sets separately revealed relatively minor differences in prediction accuracy . for the methoda set, cell-specific r <dig> and rmse ranged between  and  with mean values of  <dig>  and  <dig>  %, respectively. similarly, in the methodb data set, cell-specific r <dig> and rmse ranged between  and  with mean values of  <dig>  and  <dig>  %. furthermore, there appeared to be no association between the prediction performance of a given cell type and its true underlying fraction in the methoda and methodb reconstructed mixture samples .

the prediction performance obtained using the idol library compared favorably to the performance associated with estimatecellcounts, the predictions of which explained, on average,  <dig> % less variation in the underlying reconstructed mixture fractions compared to the idol library . the largest difference in performance was observed for cd4t cells, whose idol associated predictions explained an estimated  <dig> % more variation in the reconstructed mixture proportions of cd4t cells and were associated with a 2-fold lower rmse compared to estimatecellcounts .

implications of cell composition adjustment methodology for ewas
in the overwhelming majority of the studies using cmd, estimates of immune cell fractions are first obtained for each study sample, followed by their inclusion as additional covariate terms in statistical models to control for the potential confounding effects of cellular heterogeneity . for this reason, metrics such as r <dig> and rmse, while providing a useful starting point for comparing different l-dmr libraries, say little about how the prediction error associated with a given library relates to its impact on the power and false discovery rate  of ewas. with this in mind, we conducted a series of analyses aimed at examining how adjustments for cellular mixture in the statistical modeling of dna methylation data impact the ability to correctly identify true negatives  and true positives .

to understand the consequences of prediction error in cell fraction estimates for ewas, we first conducted a simulation study comparing the fdr when different strategies for cell composition adjustment were employed, namely, when cell fraction estimates were obtained using the idol and estimatecellcounts libraries. for our simulations, we assumed simplistic study design that, typical of many ewas, focused on the identification of differentially methylated cpg sites between two groups, i.e., case/control comparison. as described in section ‘simulation study comparing false discovery rates  across different cell composition adjustment techniques’, for each sample, methylation beta-values were simulated for a total of  <dig>  cpgs, assuming within-group sample sizes that ranged from small/moderate  to moderate/large . most importantly, while the underlying cellular composition was permitted to vary across groups, each cell type was assumed to have an identical methylation signature between groups: no group effect. as such, tests of cpg-specific differential methylation between groups with adjustments for cellular composition should not be rejected and therefore represent the basis for our estimates of fdr.

as expected, the fdr was appropriately controlled at  <dig> % when adjustments for cell composition were carried out using the “true simulated” cell distribution . on the other hand, a clear inflation in the fdr was observed when tests for differential methylation were unadjusted for cellular composition, the degree of inflation depending heavily on the between-group dissimilarity in cellular distribution . while a subtle inflation in fdr was observed when cell type adjustments were carried out using cell fraction estimates obtained from the idol  and estimatecellcounts  libraries, the idol library tended to result in a reduced number of false positive results across the spectrum of simulation conditions . this observation is more clearly illustrated in fig. 4e which depicts the average difference in fdr computed between estimatecellcounts and the idol libraries across the range of assumed within group sample sizes. compared to estimatecellcounts, the idol library resulted in, on average,  <dig> %– <dig> % fewer false discoveries when within-group sample sizes ranged from  <dig> to  <dig> 

to further understand the implications of cell type prediction methodology for ewas, we made use of two of the largest publicly-available wb dna methylation data sets  <cit> . our analysis of the liu  <cit>  and hannum  <cit>  data sets was aimed at addressing two different but related questions:  which cell prediction methodology performed better at explaining variation in dna methylation within each data set and  how does the additional variation being explained relate to the statistical power of each study. to address these questions we began by estimating the cellular distribution of the samples in each data set using both the idol and estimatecellcounts libraries .
fig.  <dig> cell mixture deconvolution of the liu and hannum blood data sets using the idol and estimatecellcounts libraries. a, b scatter plots of the predicted cell type fractions obtained using estimatecellcounts library  and the idol library  for the liu and the hannum data sets, respectively. c, d distribution of the difference in the r
 <dig> computed from the idol and estimatecellcounts libraries for the  liu and  hannum data sets. e, f estimated number of additional samples needed  and approximate additional cost  as a function of the desired difference in dna methylation to be detected  when correction for cell mixture was carried out using the estimatecellcounts library. variance estimates were obtained from the  liu and  hannum data sets



as noted in fig. 5a,b, a high degree of correlation was observed in the cell fraction estimates obtained using the idol and estimatecellcounts libraries, with cell-specific r <dig> ranging from  and  for the liu and hannum data sets, respectively. in both data sets, the predicted fraction of monocytes exhibited the greatest variation between the the idol and estimatecellcounts libraries, with the idol library resulting in slightly smaller estimates of monocyte fractions compared to estimatecellcounts, on average:  and  in the liu and hannum data sets, respectively. conversely, estimates of cd4t cells obtained from the idol library were, on average, slightly larger compared to those obtained from estimatecellcounts;  and  in the liu and hannum data sets.

array-wide comparisons of the proportion of cpg-specific variation in dna methylation explained by cell composition estimates revealed that the idol library tended to explain more variation compared to estimatecellcounts . specifically, cell estimates obtained from the idol library explained more variation in dna methylation for  <dig>  % of the cpgs in the liu data set and  <dig>  % of the cpgs in the hannum data set, both of which represent significantly larger proportions than would be expected by random chance . to understand how these findings relate to statistical power of ewas, we used the residual variance estimates obtained from each methodology as the basis for estimating the sample size required for detecting a statistically significant difference in dna methylation at  <dig> % power . figure 5e,f show the number of additional samples needed when cell type correction was carried out using estimates from estimatecellcounts  or no cell type correction , as a function of the desired difference to be detected in the mean methylation beta-values between two groups. using the residual variance estimates computed in the hannum data set, there were only modest differences in the number of additional samples needed when cell type correction was based on estimates from estimatecellcounts, with virtually no difference between the idol library and estimatecellcounts beyond effect sizes of  <dig>  . however, using the residual variance estimates obtained in the liu data set showed that, for effect sizes ranging from  <dig> – <dig>  , approximately  <dig> and  <dig> additional samples respectively would be needed if the analysis was adjusted for cell composition using estimates obtained from estimatecellcounts.

discussion
in this manuscript, we have described and extensively evaluated a novel, iterative algorithm for assembling l-dmr libraries. our objective was to present a methodology that can identify libraries that improve the prediction performance of cmd. building off existing approaches  <cit> , idol involves the targeted curation of libraries whose constituent l-dmrs are selected on the basis of their collective ability to optimize the accuracy and minimize the prediction error associated with cell composition estimates obtained through cmd. the principal difference between idol and the assembly of existing l-dmr libraries is that idol makes use of a training data set consisting of samples with both wb dna methylation signatures and immune profiling data as a means of calibrating the selection of l-dmrs. this in turn results in libraries that enhance the accuracy of cmd estimates and, as a consequence, improve the operating characteristics of ewas, i.e., decreased false positive rate and increased statistical power.

in our application of idol to a training set, we assembled optimal l-dmr libraries across a range of possible library sizes  in order to examine the relationship between library size and the accuracy of cell composition estimates. although only modest differences in prediction performance were observed between the optimal libraries identified at each size considered, our results showed a trend toward diminishing prediction performance for sizes exceeding  <dig> l-dmrs. though caution should be exercised when drawing conclusions on the basis of a single analysis, these results seem suggest that when it comes to assembling libraries for cmd, the quality of selected l-dmrs takes precedence over their quantity . despite being half the size, the prediction performance observed for the final idol library was on par with, and in many cases better than, estimatecellcounts across both the training and independent testing sets. we hypothesized that the better performance associated with the idol library was a result of its ability to find libraries that better characterize the unique methylomic fingerprint of leukocyte subtypes. to examine this hypothesis, we compared each library in terms of how well it performed in discriminating each pair of cell types by computing the dsc. the results of this analysis showed that the idol library better discriminated  <dig> out of the  <dig> pairs of leukocyte subtypes, with significantly improved discrimination strength across the entire immune cell landscape. this observation is noteworthy in that it may suggest a framework for gauging the prognostic potential of dmr libraries in the absence of dna methylation data sets with available immune profiling information, the “gold-standard” for assessing the prediction performance associated with different libraries. more importantly, our results serve to illustrate a key factor underlying the accuracy of cell composition estimates obtained via cmd, namely, that prediction accuracy is strongly related to a library’s ability to provide a powerful discrimination of the entire cellular landscape.

while the library used by estimatecellcounts is a significant improvement over the topanova approach for library assembly, it imposes an equal number of cell-specific l-dmrs for all cell types. in principle, this would be reasonable if cell types were mutually distinct from one another, however this is not the case for white blood cell types whose dna methylation signatures are lineage-specific  <cit> . because of the shared lineages of leukocyte subtypes, more or fewer l-dmrs might be needed for certain cell types depending on strength of their signal, within cell-type variability of those markers, and the lineage relationships between cell types. the data-driven approach for assembling libraries characteristic of idol indirectly addresses this issue by iteratively searching for the subset of l-dmrs that optimize the accuracy of cmd, with no a priori constraints on the number of cell-specific l-dmrs used in assembly of libraries. as demonstrated here, this approach resulted in a library that demonstrated highly accurate cell composition estimates in all data sets considered in our examination. although the estimatecellcounts library showed similar performance across the testing sets, the results of our simulation study and data applications showed that even modest improvements to the overall accuracy of cell fraction estimates results in non-negligible differences in the false positive rate and statistical power for ewas. in particular, our simulation studies showed that when differences in the underlying cellular distribution between groups are large, tests of differential methylation adjusted for cell composition estimates obtained using the default estimatecellcounts library can lead to an estimated  <dig> % inflation in the false positive rate compared to adjustments made using the idol library. on the scale of ewas, which typically involve testing hundreds of thousands to millions of cpgs, this amounts to thousands to tens-of-thousands of cpgs being incorrectly classified as differentially methylated. moreover, in both data applications cell fraction estimates obtained using the identified idol library demonstrated an improved ability to explain variation in whole-blood-derived dna methylation signatures. this lead to increased statistical power, and as a result, fewer samples needed when cell composition correction was carried out using the idol library. although the liu and hannum data applications revealed relatively minor differences in the number of samples needed between libraries, the corresponding cost-differential for a single study can be on the order of several thousand dollars considering the current cost of the illumina humanmethylation <dig> array , a figure whose magnitude becomes substantial when taken across the entire spectrum of past, present, and future ewas involving adjustments for cell composition via cmd.

notwithstanding the potential of idol to identify l-dmr libraries that enhance the accuracy of cell type predictions obtained through cmd, this method is not without certain limitations. as idol does not include an evaluation of the prediction performance of all possible combinations of l-dmr libraries , there is no guarantee that idol will arrive at globally optimal solutions. because of the inherent computational burden that would be required to ensure global optimality in this case, we opted for a more computationally parsimonious approach wherein libraries are identified by sequentially selecting l-dmr subsets preferentially comprised of l-dmrs that were previously marked as beneficial to prediction accuracy in previous idol iterations. our procedure resulted in a optimized library consisting of  <dig> l-dmrs, which compared favorably to existing l-dmr libraries and demonstrated excellent prediction performance in two independent testing data sets. thus, while global optimality cannot be guaranteed our results are encouraging and provide assurance of the capacity of idol to identifying libraries that result in highly accurate estimates of cell composition.

it also deserves mentioning the the ability of idol to find libraries that better characterize the unique methylomic fingerprint of leukocyte subtypes comes at the expense of moderate increases in computational time compared to existing techniques for library assembly. along these lines, the leave-one-out procedure employed in step  <dig> of idol may unnecessarily contribute to slower convergence and thus increased computational demands. to this end, bootstrap resampling  <cit>  as a substitute for our leave-one-out procedure may lead to faster convergence of idol and represents a potential opportunity for future enhancements to this methodology. finally, while the applications presented herein targeted the hm <dig> beadarray, we note that idol is generalizable to other platforms  provided that the reference methylomes for isolated leukocyte subtypes are available on those platforms. as interest in this area continues to grow, future studies should aim to compare the l-dmr library identified here to those identified from technologies with expanded coverage of the methylome.

CONCLUSIONS
motivated by the critical importance of accounting for cellular distribution when dna methylation is assessed in heterogeneous tissue types , along with the logistical and economic considerations that often render direct measurements of cell composition infeasible, our work fills a critical gap in the ewas literature by reinforcing the importance of library assembly and its critical role in cmd. further, we provide the epigenomics research community with a l-dmr library, optimized to improve the accuracy of cell distribution estimates in blood-derived biospecimens from human adults. importantly, while motivated by the problem of deconvoluting the cellular mixture of whole blood, this research provides a framework for the systematic construction of dmr libraries in general, and represents a viable approach for library assembly for ewas moving forward.

