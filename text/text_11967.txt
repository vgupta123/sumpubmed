BACKGROUND
microarray experiments have become an important tool for biological studies, allowing the quantification of thousands of mrna levels simultaneously. they are being customarily applied in current molecular biology practice.

in contrast to the affymetrix based technology, for the two-channel microarray technology assays, mrna extracted from two conditions is hybridised simultaneously on a given microarray. which conditions to pair on the same array is a non trivial issue and relates to the choice of the "microarray design". the most intuitively interpretable and frequently used design is the "reference design" in which a single, fixed reference condition is chosen against which all conditions are compared. alternatively, other designs have been proposed . from a theoretical point of view, these alternative designs usually offer, at the same cost, more balanced measurements in the number of replicates per condition than a common reference design. they are thus, based on theoretical issues, potentially more profitable  <cit> . for instance, a loop design would outperform the common reference design when searching for differentially expressed genes  <cit> . however, the drawback of such alternative design is that the interpretation of the measurements becomes less straightforward. more complex analysis procedures are needed to reconstruct the factor of interest , so that the practical usefulness of a design depends mainly on how well analysis methods are able to retrieve this factor of interest from the data. such analysis would require removing systematic biases from the raw data by the appropriate normalization steps and combining replicate values to reconstruct the factor of interest.

when focusing on profiling the changes in gene expression over time, the factor of interest is the time profile  <cit> . for such time series experiments, the "reference design", where, for instance, time point zero is chosen as the common reference has a straightforward interpretation: for each array, the genes' mean ratio between replicates readily represents the changes in expression of that gene relative to the first time point. however, when using an alternative design, such as an interwoven design, mean ratios represent the mutual comparison between distinct  time points. a reconstruction procedure is needed to obtain the time profile from the observed ratios  <cit> .

several profile reconstruction methods are available for complex designs. they all rely on linear models, and for the purpose of this study, we subdivided them in "gene-specific" and "two-stage" methods. gene-specific profile reconstruction methods apply a linear model to each gene separately. the underlying linear model is usually only designed for reconstructing a specific gene profile from a complex design, but not for normalizing the data. as a result, normalized log-ratios are used as input to these methods . examples of these methods are described by vinciotti, et al.   <cit>  and smyth, et al.    <cit> . two-stage profile reconstruction methods on the other hand, first apply a single linear model to all data simultaneously, i.e. the model is fitted to the dataset as a whole. these models use the separate log-intensity values for each channel, as spot effects are explicitly incorporated. they return normalized absolute expression levels for each channel separately, which can then be used to reconstruct the required time profile by a second-stage gene-specific model. an example of such two-stage method is implemented in the maanova package  <cit> .

so far, comparative studies focused on the ability of different methods to reconstruct "genes being differentially expressed" from different two-color array based designs  <cit>  or the ratio estimation between two particular conditions  <cit> . in this study, we aimed at performing a comparative study focusing on the time profile as the factor of interest to be reconstructed from the data.

we compared to what extent five existing profile reconstruction methods  were able to reconstruct similar profiles from data obtained by two channel microarrays using either a loop design or an interwoven design. we assessed similarities between the methods, their sensitivity towards using alternative normalizations and their robustness against array failure. a spike-in experiment was used to assess the accuracy of the ratio estimates.

RESULTS
assessing the influence of the used methodology on the profile reconstruction
we compared to what extent the different methods agreed with each other in 1) estimating the changes in gene expression relative to the first time point  and 2) in estimating the overall gene-specific profile shapes. results were evaluated using two test sets, each of which represents a different complex design.

the first dataset was a time series experiment consisting of  <dig> time points measured on  <dig> arrays using an interwoven design . this design resulted in three replicate measurements for each time point, with alternating dyes. as a second test, a smaller loop design was derived from the previous dataset by picking the combination of five arrays that connect five time points in a single loop . a balanced loop is obtained with two replicates per condition, for which each condition is labeled once with the red and once with the green dye 

the balance with respect to the dyes  ensures that the effect of interest is not confounded with other sources of variation. in this study, the effect of interest corresponds to the time profile. the replication  improves the precision of the estimates and provides the essential degrees of freedom for error estimation  <cit> . moreover, the interwoven design not only has more replicates, but also increases the possible paths to join any two conditions in the design. as they have different characteristics, using both datasets allows us to assess the reconstruction process under two different settings, while the rna preparations for both designs are the same.

effect of profile reconstruction methods on the ratio estimates
we first assessed to what extent the different methods agreed with each other in estimating similar log-ratios for each single gene at each single time point. to this end, we calculated the overall correlation per time point between the gene expression ratios estimated by each pair of two different methods. table  <dig> gives the results for all mutual comparisons between the methods tested for the loop design. irrespective of which two methods were compared, the correlation between the estimated ratios was high on average, ranging from  <dig>  to  <dig>  . moreover, this high average correlation is due to a high correlation of all individual ratios throughout the complete ratio range , with only a few outliers . note that for the loop design, there was no difference between the results of lmbr and lmbr_dye due to the balanced nature of this design .

correlation between ratios estimated by each pair of applied methods  for a loop design. each ratio corresponds to a time dependent change in expression as compared to the first time point . the last column corresponds to the mean correlation of the  <dig> estimates. since the loop design is balanced with respect to the dyes, the results for lmbr and lmbr_dye were the same , which is why they are not treated differently.

for this loop design the ratio estimates t3/t <dig> or t4/t <dig> obtained by each of the different methods are on overall more correlated than estimates of respectively t5/t <dig> and t6/t <dig>  as can be expected, direct estimates, i.e. estimates of a ratio for which the measurements were assessed on the same array  are more consistent than indirect estimates, i.e. the measurements used to obtain the estimates were assessed on different arrays . a similar observation was already made by kerr and churchill   <cit> , and yang and speed   <cit> . for a loop design, both the anova   <cit>  and the gene-specific methods  <cit> , have trouble estimating ratios between conditions not measured on the same array . the larger the loops  between indirectly measured pairs of conditions, the less precise estimates will be.

for the interwoven design, the correlation between ratio estimates, obtained by any pair of two different methods was even higher, with values ranging from  <dig>  to  <dig>  . for this unbalanced design, the ratio estimates for the lmbr_dye and the lmbr methods were no longer exactly the same. the difference in consistency between direct and indirect ratio estimates was not obviously visible for this design.

effect of profile reconstruction methods on the profile shape
a high average correlation between the ratio estimates obtained by the different methods at each single time point is a first valuable assessment. however, it is biologically more important that gene-specific profiles reconstructed by the different methods exhibit the same tendency over time. therefore, we also compared to what extent profile shapes estimated by each of the methods differed from each other. this was done by computing the mean similarity between profile estimates obtained by any combination of two methods .

values in the table correspond to the similarity between any two methods, expressed as the mean profile similarity of the genes. since the loop design is balanced with respect to the dyes, the results for lmbr and lmbr_dye were the same , which is why they are not treated differently. no filtering applied and similarity is assessed for all  <dig> profile estimates.

differences in the input data  and alterations in the underlying model  are confounded in affecting the final result. therefore, in order to assess in more detail the specific effect of including either a dye or a random effect in the model, we compared results between methods that share the same input data.

to assess the influence of including a dye effect on profile estimation, we compared the results of the gene-specific methods . including a dye effect  has a strong effect under the unbalanced interwoven design . for the loop design this effect is non-existent because of the loop design's balance with respect to the dyes .

the mere impact of including a random effect in the model can be assessed by comparing results of anovafix and anovamix. indeed, they both contain the same input data, the same normalization procedure, and the same model except for the random effect. seemingly, inclusion of the random effect has a higher influence on the loop design than on the interwoven design.

usually in a microarray experiment, an important proportion of the genes does not change its expression significantly under the conditions tested , exhibiting a "flat" profile. we wondered whether removing such flat genes, with a noisy profile would affect the similarity in profile estimation between the different methods. indeed, because the cosine similarity with centering only measures the similarity in profile shape, regardless of its absolute expression level, the higher level of similarity we observe between the methods might be due to a high level of random correlation between the "flat" profiles. therefore, we applied a filtering procedure by removing those genes for which the profile variance over the different time points was lower than a certain threshold . the similarity was assessed for any pair of profile estimates corresponding to the same gene if at least one of the two profiles passed the filter threshold .

mean profile similarity using a filtering threshold of  <dig>  on all profiles estimated by each of the methods. a pairwise similarity comparison is made for all profile pairs  estimated by each of the two methods compared, for which at least one profile is above the filtering threshold.

overall, the results obtained with each of the different variance thresholds confirmed the observations of table 2: 1) the more similar the models and input data, the more similar the methods behaved , 2) including a dye effect has a pronounced effect in an interwoven design , 3) including a random effect has most influence on the loop design. in addition, it seems that, the more flat profiles are filtered from the dataset, the more similar the results obtained by each of the different methods become.

the effect of array failure on the profile reconstruction
in practice, when performing a microarray experiment some arrays might fail with their measurements falling below standard quality. when these bad measurements are removed from the analysis, the complete design and the results inferred from it will be affected. here we evaluated this issue experimentally by simulating array defects. in a first experiment, the interwoven design  was considered as the original design without failure. we tested  <dig> different possible situations of failure, by each time removing a single array from the design, resulting in  <dig> reduced datasets. the same test was performed with the loop design .

we compared for each of the different profile reconstruction methods the mean similarity between the ratios obtained either with the full dataset or with each of the reduced datasets . table  <dig> summarizes the results for the interwoven design, and table  <dig> for the loop design.

the different methods for which the influence of array failure was assessed are represented in the columns. each row shows the mean correlation between the corresponding estimated ratios from the complete design and those obtained from a defect design . mean: shows the overall mean correlation for a given method.

the different methods for which the influence of array failure was assessed are represented in the columns. each row shows the mean correlation between the corresponding estimated ratios from the complete design and those obtained from a defect design . mean: shows the overall mean correlation for a given method. lmbr_dye and limmaqual were not evaluated as in this particular case they lose their main differing characteristic compared to lmbr.

for the interwoven design , it appears that in general removing one array from the original design did not really affect the ratio reconstruction. for all methods, ratio estimates tend to be more affected when an array measuring the reference time point was removed  . overall the two-stage methods, and in particular anovamix, seemed most robust against array failure, while limmaqual was most sensitive . methods including a dye effect were more robust against array failure. similar results were obtained when the effect of array failure was assessed on the similarity in profiles .

for the loop design, the situation was quite different . note that here, the lmbr_dye and limmaqual methods were not used for profile reconstruction as the reduced datasets did not contain sufficient information for estimating all the model parameters. for both lmbr_dye and limmaqual, the linear models lose their main differing characteristics compared to lmbr . for all remaining methods removing one array from the design affected the results considerably more than was the case for the interwoven design. two-stage methods were the most robust, but in this design anovamix performs slightly worse than anovafix. the lmbr method turned out to be very sensitive to array failure, giving a mean profile similarity around  <dig> , indicating no correlation between profiles estimated with and without array failure .

note that overall, all methods seem to be more robust to array failure under the interwoven design than under the loop design. this is to be expected as the latter design contains more replicates.

consistency of the methods under different normalization procedures
in the previous section we compared profiles and ratio estimates obtained by the different methods after applying default normalization steps. however, other normalization strategies are possible, and could potentially affect the outcome. to assess the influence of using alternative normalization procedures, we compared profiles reconstructed from data normalized with 1) print tip loess without additional normalization step , 2) print tip loess with a scale-based normalization between arrays  <cit> , and 3) print tip loess with a quantile-based between array normalization  <cit>  .

similarities between profiles were assessed using the mean cosine similarity measure. rows indicate the different normalization procedures. columns indicate the different models used to reconstruct the profiles.

accuracy of estimation
so far we only assessed to what extent changes in the used methodologies or normalization steps affected the inferred profiles. this, however, does not give any information on the accuracy of the methods, i.e., which of these methods is able to best approximate the true time profiles. assessing the accuracy is almost impossible as usually the true underlying time profile is not known. however, datasets that contain external controls  could prove useful in this regard. spikes are added to the hybridisation solution in known quantities, so that we have a clear view of their actual profile. in the following analysis, we used a publicly available spike-in experiment in attempt to assess the accuracy of each of the profile reconstruction methods  <cit> . for the technical details of this dataset we refer to 'methods' and table  <dig> 

from the total of  <dig> arrays,  <dig> were hybridized with the respective spike mixes labeled in cy <dig> against the reference mix labeled in cy <dig>  the remaining  <dig> arrays were hybridized with the spike mixes labeled in cy <dig> against the reference mix labeled in cy <dig>  spike 11a was removed from analysis due to quality issues .

as lmbr and lmbr_dye and limmaqual gave exactly the same results using this balanced design, we further assessed to what extent lmbr, anovafix and anovamix agreed with each other. fig.  <dig> shows the effect of using different spike concentrations as reference points for ratio estimation. panels a through c reflect decreasing reference concentrations. the choice of reference has little effect on the shape of the profile . however, fig.  <dig> illustrates that 1) lower reference concentrations  introduce a bias in the profile , 2) irrespective of the concentration of the reference ratio's derived for the lower expression values of the test are nearly identical, and thus uninformative. both observations can be attributed to the lower saturation characteristics of microarray data . although not as complex as the previously used loop or interwoven designs, the spiked-in design illustrates that this lower saturation effect, an inherent property of microarray data, can distort estimated profiles: interpretation of ratios with lower signals for test or reference should be done with care.

discussion
in this study, we evaluated the performance of five methods based on linear models in estimating gene expression ratios and reconstructing time profiles from complex microarray experiments. from a theoretical viewpoint, two major differences can be distinguished between the methods selected for this study: 1) differences related to alterations in the input data: the selected two-stage methods make use of the log-intensity values while the gene-specific methods use log-ratios, 2) differences related to the model characteristics: some of the models include an explicit dye effect  or an explicit random effect .

although kerr  <cit>  assumed that observed differences in estimates obtained by different models are due to the differences in model characteristics, rather than to the input data, we cannot clearly make this distinction. indeed, the way the error-term is modeled influences the statistical inference and hence the use of log-intensities or log-ratios does cause a difference between models  <cit> . however, when focusing on results obtained between methods with similar input data, we can assess, to some extent, the effect of different model specificities. in the following sections, some of these effects are discussed more in detail.

the inclusion of the dye effect
in general we observed that, gene-specific methods without dye effects, and two-stage models with dye effect behaved more similar with each other than when they were compared among each other. lmbr_dye  is situated somewhere in between when the design is unbalanced with respect to the dyes. indeed, the gene-specific models lmbr and limmaqual contain a combination of log-ratios plus an error term. however, when adding a dye effect to these models as is the case of lmbr_dye, the formulations and estimations converge with those of the two-stage anova models for unbalanced designs.

originally, vinciotti, et al.   <cit>  and wit, et al.   <cit>  added the dye effect for purposes of data normalization when one is working with non-normalized data. from our results, we also noted a practical advantage of including a dye effect even with normalized data. the fact that adding a dye effect showed pronounced differences for a dye-unbalanced design indicates that, despite the data being normalized, there are still dye-related inconsistencies in the data that might -partially- be compensated for by including a dye effect. moreover, models with dye effects seemed more robust in estimating log-ratios from a design disturbed by array failure. therefore, when working with unbalanced designs, it is advisable to include a dye effect, not only for the two-stage anova models, as was also suggested by wolfinger   <cit> , kerr   <cit> , and kerr and churchill   <cit> , but also for gene-specific models based on log-ratios.

mixed models versus fixed models
several studies advise the users to model the spot-gene or array-gene effects as random variables  <cit> . we observed that under the loop design , profiles estimated by anovamix and anovafix diverged. we also noticed that, for the loop design anovamix had a lower capacity than anovafix to handle array failures. for the interwoven design with  <dig> arrays these effects were less pronounced. the loop design used in our study does not contain a sufficient number of replicates to allow for reliable estimation of the spot-gene effect when using a mixed anova model. as a result, ratios and time profiles estimated by anovamix than anovafix are less reliable for an experiment with few replicates

the effect of using alternative normalization steps on the methods' performance
we tested the influence of using additional normalization steps. differently normalized data give different results, but the effects were not dramatic. moreover, they had the same influence on all methods, indicating that all methods were equally sensitive to changes in the normalization.

accuracy of estimated ratios
based on spike-in experiments for two-channel microarrays, we could also assess to what extent the estimated ratios approximated the true ratios . we observed that all five tested linear methods generated biased estimations, consistently overestimating changes in expression relative to a reference with low mrna-concentration. these results were independent of the method used  or of the number of effects included the model.

CONCLUSIONS
on average the correlation between the estimated ratios was high, and all methods more or less agreed with each other in predicting the same profile. the similarity in profile estimation between the different methods improved with an increasing variance of the expression profiles.

we observed that when dealing with unbalanced designs, including a dye effect, such as in the methods lmbr_dye, anovafix and anovamix, seems to compensate for residual dye related inconsistencies in the data . adding a dye effect also renders the results more robust against array failure. including random effects requires more parameters to be estimated and is only advised when a design is used with a sufficient number of replicates.

conclusively, because of their robustness against imbalances in the design and array failure, we believe lmbr_dye, anovafix and anovamix are most appropriate for practical use .

