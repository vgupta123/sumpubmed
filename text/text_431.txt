BACKGROUND
antibiotics are one of our most powerful tools for treating and preventing bacterial infections and have since their introduction vastly improved human health and drastically reduced mortality rates. the high use of antibiotics in human and veterinary medicine has however resulted in an accelerated development of multiresistant bacteria  <cit> . bacteria can adapt to an antibiotic selection pressure by altering their genome, either by mutations in pre-existing dna or through the acquisition of resistance genes  <cit> . since resistance genes can be horizontally transferred between bacterial cells, antibiotic resistance can rapidly spread within and between bacterial communities  <cit> . many types of antibiotics are derived from compounds that are naturally found in the environment and bacteria have developed resistance genes as a protection mechanism. environmental bacterial communities have therefore been hypothesized to contain a large and unexplored collection of antibiotic resistance genes  <cit> . antibiotic resistance genes were present in environmental bacterial communities long before they emerged in human pathogens  <cit> . as a consequence, many of the antibiotic resistance genes found in clinical settings have been horizontally transferred from environmental bacteria  <cit> .

the broad-spectrum fluoroquinolone antibiotics were introduced in the early 1960’s and are today extensively used in human and veterinary medicine. fluoroquinolones interacts with the essential bacterial type ii topoisomerases  and thereby inhibits dna replication. the most effective fluoroquinolone resistance mechanism is chromosomal mutations in the antibiotic target proteins which confers high levels of resistance in several bacterial species  <cit> . recently, a family of mobile fluoroquinolone antibiotic resistance genes called qnr was discovered  <cit> . these mobile plasmid-mediated quinolone resistance genes  have been grouped into five recognized classes; qnra, qnrb, qnrc, qnrd, and qnrs and it is currently unknown whether more classes exist. the qnr genes encode proteins that prevent fluoroquinolones from interacting with dna/type-ii-topoisomerase complexes formed during dna replication, thus preventing fluoroquinolone inhibition. the levels of resistance conferred by qnr genes are generally lower than chromosomal mutations but can reach up to  <dig> mg/l  depending on the organism and specific antibiotic compound  <cit> .

the qnr genes belong to the larger family of pentapeptide repeat proteins , which are ubiquitously present with more than  <dig> variants described in all forms of life  <cit> . all prps are characterized by a sequence feature consisting of repeating subunits of five amino acid residues following the form alxx. this repetitive pattern makes prps fold into a β-helix that performs a wide range of cellular functions and they are found both membrane bound and in the cytoplasm  <cit> . for qnr genes the β-helix resembles the structure of the dna spiral and interacts with type ii topoisomerases and thereby prevent fluoroquinolone antibiotics to inhibit the function of the complex  <cit> . despite the strong similarity in the repeating amino acid pattern between qnr sequences and other prps it is unclear exactly why qnr genes provide resistance to fluoroquinolones.

further characterization of qnr genes is necessary to fully understand their function and estimate their diversity. assuming the presence of antibiotic resistance genes in clinical settings is the result of transfer of mobile genetic elements from the environment, it is natural to search environmental microbial communities to find previously unidentified qnr genes. recent culture-independent methods such as metagenomics enables unprecedented exploratory analysis of the genetic basis in microbial communities  <cit> . this is especially true considering that more than 99% of environmental bacterial communities do not submit easily to cultivation and would consequently be missed with sampling and analysis of individual strains  <cit> . in combination with next-generation dna sequencing technologies metagenomics provide means for culture-independent studies of bacterial communities at a very high resolution. however, high-throughput sequencing equipment can currently only produce short dna fragments  which substantially limits the sensitivity and specificity of identifying genes such as qnr <cit> .

in-silico approaches have previously been used to identify novel variants of qnr genes. for example, fonseca et al. identified qnrvc <dig> and qnrvc <dig> in vibrio cholerae using sequence comparison to existing plasmid-mediated qnr genes  <cit> . a similar approach was used by sanches et al. to identify several chromosomal qnr variants, including multiple members of the class smqnr from stenotrophomonas maltophilia <cit> , and by velasco et al. to discover smaqnr in serratia marcescens <cit> . however, all of these studies used sequence alignment tools such as blast which do not explicitly make use of the repetitive structure of the qnr genes. furthermore, none of the previous suggested methods were adapted to short sequence lengths and high volumes of data which makes them inapplicable to sequences from shotgun metagenomics.

in this paper, we describe a novel method to identify fluoroquinolone antibiotic resistance genes in dna sequence data. by using hidden markov models combined with a length-dependent classification rule, the method is able to discriminate between qnr and other pentapeptide repeat proteins not associated with a resistance phenotype. cross-validation estimated that the method had a high statistical power of detecting fragments of qnr genes in metagenomic data, even at fragment lengths as short as  <dig> nucleotides. the method was applied to sequence data from various databases and both known and novel putative qnr genes were identified. an implementation of the method is freely available at http://bioinformatics.math.chalmers.se/qnr/.

RESULTS
a hidden markov model  was constructed from a multiple sequence alignment of all currently known and experimentally verified plasmid-mediated qnr resistance gene amino acid sequences  <cit> . using the database search software hmmer <dig>  we analyzed the empirical bit score distributions produced by applying the hmm to two sources of protein sequence data; a) true qnr fragments, created from randomly fragmented qnr sequences and b) non-qnr fragments, created from pentapeptide repeat protein  sequences not associated with a fluoroquinolone resistance phenotype . to visualize the bit score distributions of fragmented sequences, random fragments of qnr and non-qnr sequences were created for each fragment length between  <dig> and  <dig> amino acid residues  and their scores against the hmm were plotted as a function of fragment length. as indicated by figure  <dig> true qnr fragments had bit scores that were approximately linear in relation to their fragment length while the bit score distribution of the non-qnr fragments was centered around  <dig>  a two-part linear classification function was therefore introduced to discriminate between true qnr and non-qnr fragments. for fragments up to a length threshold , the classification function was linear with an intercept m and slope k. for fragments longer than d, the function used a fixed cutoff c = k × d + m .

cross-validation was used to optimize the parameters m, k and d of the classification function for identification of novel classes of qnr genes. the optimization was performed for five different models where each model was created by excluding one class of plasmid-mediated qnr proteins . the cross-validation was then performed using disjoint set of fragments, one for parameter estimation  and one for evaluation of the corresponding performance . the training and validation data sets were created from fragments of both qnr genes and non-qnr prp genes without any associated resistance phenotype. for each of the five models, the excluded qnr class was also removed from the training dataset. the corresponding performance was, on the other hand, evaluated only using the excluded qnr class and a set of non-qnr genes. thus, the ability to classify novel qnr genes was evaluated on fragments of gene classes not included in the model. the cross-validation was performed with random fragments ranging from  <dig> to  <dig> amino acid residues, each length repeated  <dig> times. the parameters of the classification function were estimated to m = - <dig>  , k =  <dig>  , d =  <dig>   . the corresponding fixed cutoff c was calculated to c =  <dig>  .

the optimized classification function parameters were then used to validate the statistical power to detect novel putative fragments. at a fragment length as short as  <dig> amino acids the average power for correctly classifying fragments from novel putative qnr gene classes was 94% . the results differed between the five models : for a  <dig> amino acid long sequence, the power to identify a qnrd fragment  was highest  while the power of identifying a qnrb fragment  was the lowest . the specificity was estimated to be above  <dig> % for all models and all fragment lengths . see methods for full details.

to search for novel putative qnr gene variants a model based on all five classes of plasmid-mediated qnr genes together with the classifier with the optimized parameter values was applied to protein sequences from various databases and metagenomic sequencing projects; genbank  <cit> , camera  <cit> , mg-rast  <cit> , contigs from meta-hit  <cit> , and several data sets from sra  <cit>  . a smaller metagenomic dataset from a recent study where a high abundance of qnr genes was detected was also included  <cit> . the total number of fragments available in all datasets was  <dig> , <dig> comprising  <dig> , <dig>  nucleotides. in total,  <dig>  sequence fragments classified as qnr by the method. for the metagenomes the proportion of qnr fragments was estimated to  <dig>  × 10-4% , reflecting the low abundance of qnr genes in the environment. all fragments that classified as qnr were stringently clustered into  <dig> groups  and annotated against genbank and the list of known qnr genes  <cit>  . among these clusters, all five classes of plasmid-mediated qnr were represented as well as  <dig> previously described chromosomally located variants  <cit> . in addition, one contig in group # <dig>  which consisted entirely of metagenomic fragments, represented a full length sequence of a novel putative qnr gene with 93% identity  to qnrb <dig>  during the course of this project this sequence was accepted as a novel qnrb variant, qnrb <dig>  and submitted to genbank   <cit> . the method was hence capable of reconstructing complete qnr sequences directly from fragmented metagenomic data. this was particularly evident since the complete sequence of qnrb <dig> was not available in any of the datasets at the time of their retrieval in this project.

the method discovered  <dig> fragments of metagenomic origin that clustered in  <dig> groups which did not contain any of the previously described plasmid-mediated or chromosomal qnr genes. an additional  <dig> sequences of novel putative qnr genes in the genomes of  <dig> sequenced bacteria were also discovered . table  <dig> shows five examples of groups containing sequences classified as novel putative qnr genes by the method. sequence # <dig> was constructed from fragments originating from baby stool metagenomes  <cit>   and shared 79% sequence identity with qnrb <dig>  sequence # <dig> was discovered in an environmental samples from coastal sea water outside the north american coast  as a part of the gene ocean sampling expedition  <cit> . this sequence is a  <dig> amino acid long fragment that shares 33% sequence identity with qnrc. the next three sequences were discovered in bacterial genomes in genbank. sequence # <dig> was discovered in the chromosome of dickey dadantii  <dig>  and was a  <dig> amino acid long sequence with 68% identity to qnrb <dig>  sequence # <dig> was found in the chromosome of xenorhabdus bovienii  and was a  <dig> amino acid long sequence with 66% identity to qnrb <dig>  sequence # <dig> came from the chromosome of vibrio furnissii  and was a  <dig> amino acid long sequence sharing 72% identity with qnrc. full results, including all  <dig> groups and their annotation, are available in .

discussion
qnr genes provide resistance to broad-spectrum fluoroquinolone antibiotics and can move between bacteria using horizontal gene transfer. however, the total number of qnr classes and their diversity in environmental bacterial communities is not clear. we therefore developed a novel method to identify new classes of qnr genes in fragmented metagenomic data. the method uses a hidden markov model  to identify candidate qnr fragments which are then further classified based on their model score and sequence length. cross-validation confirmed that the method had a high sensitivity and specificity to detect fragments from novel classes of known qnr genes, even at fragments as short as  <dig> amino acid residues. this makes the method applicable to many forms of nucleotide data, including sequences generated by next-generation dna sequencers. from public sequence repositories the method classified  <dig> sequence fragments  as qnr, which were further clustered into  <dig> groups. the method also identified  <dig> chromosomal qnr variants in  <dig> bacterial species.

several of the novel putative qnr genes identified in this study have to the authors’ best knowledge previously not been described in literature. experimental verification, including phenotypic profiling in multiple bacterial hosts, is therefore necessary to fully evaluate the resistance potential of our predictions. however, the cross-validation demonstrated that the proposed method had a high sensitivity and could discriminate between fragments from classes of known qnr and pentapeptide repeat proteins without a resistance phenotype . the method was also able to identify all previously reported classes of qnr genes, including the variant qnrb <dig> which was at the time for this analysis not submitted to the database and thus not included in the hidden markov model. this shows that the method has a high predictive power and it is therefore possible that several of the predictions indeed represent previously unidentified novel classes or variants of qnr genes.

many of the identified putative qnr gene fragments were discovered in metagenomes sampled from different types of environments, e.g. human gut  <cit> , seawater  <cit>  and river sediment  <cit>  . this indicates that there is an unexplored diversity of qnr genes within environmental bacterial communities and that these can be identified by metagenomic sequencing. however, the amount of nucleotide data currently represented in the sequence repositories merely reflects a tiny fraction of the total microbial diversity on earth  <cit> . in addition, the estimated relative abundance of unknown fragments from putative qnr genes was  <dig>  × 10-4%  underlining the vast amounts of sequence data needed to identify and assemble qnr genes from environmental data. it is therefore possible, and even likely, that there are additional variants of qnr genes present in the environmental bacterial communities currently not represented in the sequence repositories due to the heavy undersampling. the data that is currently being generated by large-scale reference metagenome projects, such as the earth microbiome project  <cit>  and the gene ocean sampling  <cit> , will offer a substantially higher sequencing depth and may therefore reveal additional classes and variants of qnr genes.

our results show that hidden markov models are highly suitable for identifying sequence fragments from qnr genes. the model used in this study was derived from a multiple alignment of qnr genes and can thereby infer information on the degree of variability at different amino acid positions in the sequence  <cit> . this is especially useful for pentapeptide repeat proteins which generally have a low sequence similarity except in the conserved residues of the distinctive repetitive alxx motif. in contrast, traditional sequence alignment tools such as blast cannot distinguish between important variation in the repeating pattern and variation in the intermediate regions. previous methods to identify novel qnr genes from dna sequence data have used blast and may therefore have limited sensitivity and specificity  <cit> . the proposed method has, on the other hand, demonstrated a high power of detecting new classes of qnr genes  and is hence a more suitable approach for identification and annotation of qnr genes.

controlling the number of false predictions is vital for large-scale data analysis. a low specificity can generate a massive amount of false positives and thereby decrease the quality of analysis and the biological interpretation of the downstream results . based on the distribution of bit scores for the sequence fragments  it is clear that a traditional cut-off would not be sufficient to discriminate between qnr and non-qnr prps with both a high sensitivity and specificity. indeed, a single bit score cut-off would have to be set to  <dig> to minimize false positives across all fragment lengths, effectively removing the ability to classify fragments shorter than  <dig> amino acid residues . instead, a linear classification function dependent on fragment length for short fragments enabled correct identification while maintaining a high specificity . this makes the method suitable for analysis of large datasets consisting of short sequence fragments and the method is therefore directly applicable to data from next-generation sequencing technologies such as illumina’s sequencing by synthesis, life technologies’ sequencing by ligation  or roche’s  <dig> pyrosequencing  <cit> .

the hidden markov model used by the method was created from all known plasmid-mediated qnr genes with experimentally validated resistance phenotype. however, several recent studies have described chromosomally located qnr genes in wide range of species   <cit> . these chromosomal qnr genes show a relatively high sequence similarity to their plasmid-mediated relatives and some have been shown to confer resistance towards fluoroquinolones when expressed in e. coli   <cit> . their potential to transfer horizontally between bacteria is however not clear. even though the hidden markov model was based on plasmid-mediated gene variants, the method demonstrated a high sensitivity to detect qnr genes in bacterial chromosomes. in fact, the method identified  <dig> previously reported chromosomally located qnr genes in  <dig> species. in addition,  <dig> potentially novel chromosomal qnr genes in  <dig> different species were also identified . interestingly, four previously suggested chromosomal qnr genes were not classified as such by the method. these genes, which are located in alkaliphilus metalliredigens, bacteroides thetaiotaomicron, bacillus weihenstephanensis and anabaena variabilis have previously been identified as putative qnr genes using blast  <cit> . however, all these genes share low sequence similarity to other qnr genes and their resistance phenotype has so far not been validated. the four genes received very low scores by our model, which may indicate that these are false predictions and hence not qnr genes. all other previously described qnr genes received high scores by the model and were thus classified as qnr.

the method described in this study has been implemented as a freely available application in python. the application searches any specified sequence dataset, classifies the matching sequences as qnr or non-qnr and clusters the results into groups of putative qnr genes . the implementation is straightforward to use, has been optimized to handle data sizes of the order of terabytes, and is suitable for use on standard desktop computers. the package is documented with internal functions thoroughly commented in the distributed source code, making it possible to interface them directly from related applications. the application can be installed and run on any modern gnu/linux system and it is available from http://bioinformatics.math.chalmers.se/qnr/.

CONCLUSIONS
in this study we proposed a new method to detect and annotate novel classes of qnr antibiotic resistance genes in nucleotide sequence data. the method uses a hidden markov model with a fragment length-dependent classification rule and has a high sensitivity and specificity, even for sequences as short at  <dig> nucleotides. this makes the method directly applicable to the immense amount of data generated by the next-generation dna sequencing techniques. based on sequence data currently available in the repositories, the method was able to identify all previously reported plasmid-mediated qnr genes as well as the vast majority of the previously reported chromosomal variants. in addition, the method predicted several novel putative qnr genes and some of these were discovered in shotgun metagenomes, which may indicate a large and unknown diversity of qnr genes in uncultured environmental bacteria.

