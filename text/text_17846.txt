BACKGROUND
mechanistic models of the individual biochemical events that comprise gene expression are quite detailed and are continuously improving. for example, experiments studying the kinetics of promoter initiation and single molecule studies of processive protein movements along dna have revealed intricate regulatory processes that control gene expression  <cit> . as these details accrue, understanding how individual processes work together to determine system-level behavior becomes increasingly difficult to intuit  <cit> . the ability to simulate events on and along dna at base-pair resolution would benefit those interested in studying or attempting to control the consequences of molecular processes on system behavior. however, while currently available simulation techniques are sufficient to study the expression from a single operon at base-pair resolution, they become computational expensive if the system is of much greater scale or complexity  <cit> . also, existing simulators cannot formally account for intermolecular events along dna, such as collisions between polymerases.

there are several mathematical approaches for computing the dynamics of systems of biochemical reactions. for example, the chemical species that define a system can be modeled as continuous variables that change over time. in this "continuous" approach, reactions between chemical species are modeled as a set of coupled ordinary differential equations   <cit> . the set of odes are often numerically integrated using established algorithms to compute the dynamics of the system. as a second example, a system's chemical species can be treated as discrete variables that change over time. in this "discrete" approach, reactions between species are treated as individual events that update the system and can be combined into the chemical master equation  <cit> . the chemical master equation is usually computationally integrated to determine the time evolution of the system using stochastic simulation algorithms . ssas have some theoretical advantages over continuous formulations  <cit> . for instance, in some systems, an individual reaction event can cause a large difference in the likelihood that other reactions will occur, and so the precise order and timing of individual reaction events can influence overall system behavior. this situation may occur when the numbers of any particular reactant in a system are low, as in the case of a single copy of dna bound by a protein. in these cases, ssas provide exact calculations of the system dynamics, while the continuous approximations break down.

however, challenges exist in using either approach to study high-resolution models of gene expression. both discrete and continuous approaches to solving the time evolution of biochemical reactions share the so-called "combinatorial explosion" problem, in which the number of possible states that need to be enumerated in a system becomes exceedingly large  <cit> . for example, the spatial and temporal control of gene endo <dig> expression during s. purpuratu development is controlled by a  <dig>  base-pair  sequence  <cit> . this control sequence contains  <dig> sites that bind  <dig> distinct proteins  <cit> . developing a model that fully enumerates all the possible states of the endo <dig> gene regulatory region requires stating over  <dig> distinct protein:dna species. not only is this computational expensive, it seems unnecessary; the number of possible species far exceeds the copy numbers of the relevant dna and protein molecules in the cell.

two approaches have addressed the combinatorial explosion problem with respect to protein complex formation and modification during signaling  <cit> . the first approach, single-molecule simulation, taken by the stochsim simulator, tracks individual molecules and their state  so that only the complexes formed at any given time are enumerated   <cit> . stochsim allows individual molecules to transition between states , which in turn modulates the reaction rates of processes that the molecules participate in. these transition and state changes are specified at the start of simulation. single-molecule simulators are computationally advantageous when the number of tracked molecules is much smaller than the number of possible states that the system can potentially achieve. a second approach, taken by the molecularizer simulator, is to dynamically generate reactions as they occur based on automatic adjustments to reaction rates based on diffusion considerations  <cit> . moleculizer can construct the set of reactants and reactions that are actually executed during simulation and can use this more manageable set of reactions as input into more traditional simulators. dynamic reaction generation simulators such as moleculizer work well when many of the possible states of the system are never realized, and thus the simulators need only ever represent a fraction of the total possible system.

stochsim and moleculizer were designed to model the binding and unbinding of proteins within complexes. however, these simulators are not well suited for modeling systems in which components within a complex are processive  or when the number of binding states is large. for example, simulating a single rna polymerase transcribing a  <dig>  bp gene at single-base resolution using a single-molecule simulator would require a model for a dna molecule comprised of over  <dig>  different states with enumerated rules for the transitions from one base to the next. using a dynamic reaction generation simulator, such as moleculizer, would not lead to significant speed enhancements because most of the states of the system are reached during a simulation, albeit rarely.

recent efforts to stochastically simulate gene expression have focused on reducing the number of states and complexity of the system being studied by approximating the kinetic delays that occur during transcriptional and translational elongation processes. for example, the stochastic simulator dizzy allows for modeling transcription elongation as a series of equivalent steps that can be sampled in total from the gamma distribution, as gibson and bruck suggest  <cit> . however, these simplifications cannot account for the effects that intermolecular interactions on the dna may have on system dynamics. in addition, roussel and zhu approximated the delays in transcription that can take into account polymerase interactions using a reduced site-oriented markov model that is accurate in cases where there are limited polymerase interactions  <cit> . however, without a priori knowledge for how polymerase interactions affect the expression of any particular gene, especially in the case of multi-promoter, multi-gene, multi-polymerase systems, we must use a more detailed model of gene expression.

thus, in order to efficiently and more realistically simulate base-pair resolved models of gene expression, we developed a single-molecule stochastic simulator, tabasco, optimized to handle molecular events specific to gene expression such as the initiation, elongation and termination of transcription and translation as well as interactions among protein-dna complexes. tabasco tracks individual molecules and reactions on the dna at single base resolution  in order to avoid the specification of many unoccupied system states. tabasco also uses dynamic reaction generation based on encoded rules for gene expression in order to avoid specification of all possible states and transitions within the system . this framework provides the accurate descriptions of gene expression dynamics while allowing analysis of phenomena such as how intermolecular events between dna-protein complexes affect system-wide gene expression.

our motivations for creating tabasco started from our interest in simulating the dynamics of bacteriophage t <dig> gene expression during phage infection. for example, past models of t <dig> infection used odes to simulate t <dig> gene expression dynamics. the use of odes limited our ability to accurately simulate the kinetics of t <dig> gene expression and study how intermolecular events may impact the genome-wide allocation of expression resources  <cit> . for example, the e. coli rna polymerase initiates expression of early t <dig> genes, including the gene encoding t <dig> rna polymerase. thus, newly synthesized t <dig> rna polymerase first initiates transcription behind already transcribing e. coli rna polymerase molecules. e. coli rna polymerase has a ~ <dig> nucleotide per second elongation rate; t <dig> rna polymerase has a ~ <dig> nucleotide per second elongation rate. what happens when a t <dig> rna polymerase molecule overtakes an e. coli rna polymerase is not well understood. however, the transition from e. coli to t <dig> rna polymerase mediated genome entry will impact the timing of expression across the genome; cell-cell variation in the entry transition will limit the precision by which t <dig> can control infection. thus, simulating possible polymerase-polymerase interaction models is an interesting research question. using tabasco, we can explore the dynamics of gene expression during t <dig> development at single-base resolution. in the case of t <dig>  the increased modeling resolution afforded by tabasco allows for direct evaluation of assumptions concerning polymerase interactions, transcriptional coupling to genome entry, and stochastic fluctuations on phage development. although motivated by our interest in t <dig>  tabasco can also be used to represent other genetic systems and, as such, is generally useful to those interested in understanding how detailed molecular processes affect genome-wide gene expression.

RESULTS
algorithm
tabasco is a stochastic simulator that tracks individual molecules of dna and associated proteins at single base-pair resolution. tabasco makes use of a gibson-accelerated gillespie ssa to compute the reaction event timing and the resultant time-evolution of the genetic system  <cit> . tabasco uses predefined rules of transcription and translation such as initiation, elongation, termination, and protein interactions of polymerases, ribosomes, and other dna/rna-associated proteins. based on these rules, tabasco automatically updates the states of molecules and reaction events . for example, if a transcribing rna polymerase temporarily occupies the dna-binding site for a second protein, the simulator makes the site unavailable for binding until the polymerase is no longer occluding access to the binding site.

tabasco transitions between two levels of resolution while simulating gene expression: "single-molecule" and "species level" . reactants and events that occur on the dna are tracked at single-molecule resolution–each copy of dna and proteins associated with them are tracked individually by the simulator. in this regime, events such as binding/un-binding and polymerase movements are dynamically generated based on the current state of the dna molecules and proteins on the dna. on the other hand, the species-level resolution is akin to traditional ssas in which reactants are tracked as groups of equivalent species. for example, tabasco tracks all cellular protein-protein interactions at the species level.

the transition between the single-molecule level and the species level occurs during the tracking of rna abundances . only those rna molecules that are still attached to transcribing rna polymerases are tracked as single molecules. as each coding domain on an rna molecule is completed, it becomes part of the species-level simulation. at the species-level, each of the coding domains is treated separately as a species, and ribosomes that initiate translation on a coding domain are assumed not to interfere with one another. at both the single-molecule and species-level, translation is treated as a series of single amino acid polymerization steps, with the number of steps depending on the length of the coding domain. this gives a more accurate distribution of times for protein production than treating the whole elongation process as a single step. based on the work of gibson and bruck, we compute translation steps in aggregate using the gamma distribution   <cit> .

the structure of tabasco confers at least four advantages. first, treating gene expression at base-pair resolution allows for more accurate representation of the kinetics of gene expression. for example, traditional ssas often lump multi-step reactions as single steps causing inaccurate estimates on pre-steady state kinetics. second, tracking the state of individual proteins on dna and allowing internal logic to automatically generate reactions eliminates the need to enumerate all the possible states of polymerases and proteins associated with the dna. for example, transcribing polymerases and processes such as genome entry into a cell can cause certain protein binding sites to be inaccessible . this feature also allows us to consider and integrate many factors that may influence the rate of rna polymerization for any particular gene, such as the binding of multiple transcription factors or the contribution of rna polymerases that initiated transcription at a promoter connected to an upstream gene . third, protein-protein interactions that may occur on dna, such as collisions between different polymerases, can be accounted for and simulated based on simple and explicit rules . fourth, tabasco can be used to graphically depict the location and dynamics of individual rna polymerase molecules transcribing dna, providing a useful visual tool for considering genome-scale gene expression dynamics.

testing
simple gene expression models
as an initial test, we simulated the expression of a  <dig>  amino acid protein using both tabasco and a standard species-level ssa . both simulators used identical gene expression models except for one difference. in the standard ssa, processive transcription and translation elongation reactions along the dna are treated as a lumped, single-step reaction sampled from an exponential distribution; in tabasco these reactions are treated as a series of individual base-pair elongation steps. in addition, due to internal structural differences between the two simulators, the two underlying models had slightly different rate constants for rna polymerase clearance from the promoter region . thus, the clearance rate was adjusted in the species-level ssa to produce equal steady state levels of protein to the tabasco simulation . at steady state, both simulators produce statistically equivalent results . however, an expected difference arises in the pre-steady state dynamics of the system . the species-level ssa simulation first produces protein by ~ <dig> seconds . this is unrealistic; e. coli rna polymerase transcribes at an average elongation rate of  <dig> bp per second, production of a  <dig>  nucleotide messenger rna should take ~ <dig> seconds. thus, even if a ribosome directly followed the first transcribing rna polymerase, protein production should not take less time than rna production. tabasco produces protein only after a more accurate ~ <dig> seconds .

we compared two models of expression of a single-gene varying only if mrna and protein elongation reactions are treated as series of individual steps or a single lumped reaction . the kclear rates do not exactly match because of small differences in the model structures . the tabasco constant for kclear was adjusted to ensure the steady-state levels of mrna and protein were equivalent in both simulations.

the discrepancy in the time for synthesis of a first protein product occurs for two reasons  <cit> . first, since the rna polymerase and ribosome elongation steps in the species-level simulation are treated as single exponential elementary reactions, 63% of the reactions occur prior to the average reaction time . the second and more substantive reason is that ssas assume that reactions are markovian . in an ssa that treats elongation as a single step, a ribosome that has initiated translation has some non-zero chance of completing protein synthesis; since the ssa treats the reaction as markovian, the greater the number of ribosomes that have initiated translation, the greater the chance that any single protein synthesis event will be completed. thus, if many ribosomes initiate translation before any one ribosome has enough time to complete translation of a coding sequence, then then protein synthesis will be computed at completing in an unrealistically short time. this is physically unrealistic; lumped reactions representing processive reactions should not be modeled as markovian. in other words, a ribosome that begins translation should not affect the speed at which downstream ribosomes will complete protein synthesis. the fact that tabasco treats each elongation reaction as a series of elongation steps alleviates both of these problems. as a result, tabasco provides a more accurate estimate of pre-steady state gene expression kinetics than simulators and models that lump transcription and translation processes into a single reaction. accurate calculation of the pre-steady state kinetics is important for systems in which a steady state is never reached, such as during phage infection, cell cycle, or animal development, and is the reason that many groups have incorporated approximate delays into their simulation frameworks  <cit> .

polymerase interactions
the first natural biological system that we studied using tabasco is bacteriophage t <dig>  during bacteriophage t <dig> infection, the e. coli rna polymerase initiates expression of early t <dig> genes, including t <dig> rna polymerase  <cit> . t <dig> rna polymerase first initiates transcription behind already transcribing e. coli rna polymerase molecules. at 37°c, e. coli rna polymerase transcribes at ~ <dig> bp per second; t <dig> rna polymerase transcribes at ~ <dig> bp per second  <cit> . thus, t <dig> rna polymerases will overtake e. coli rna polymerases. how transcribing rna polymerase molecules interact mechanistically is just beginning to be understood, but experimental studies show that these interactions are important  <cit> .

in order to test how different models of polymerase-polymerase interactions impact gene expression, we first used tabasco to simulate gene expression from a reduced genetic system that captures key features from the layout of the t <dig> genome. briefly, this two-gene system has an e. coli promoter expressing two hypothetical genes encoded on a polycistronic mrna , and a t <dig> promoter expressing a monocistronic mrna that only encodes protein  <dig> . we used tabasco to test three distinct models for how co-transcribing rna polymerases may interact:  the downstream polymerase terminates transcription allowing the upstream polymerase to continue ,  the upstream polymerase terminates transcription while the downstream polymerase continues , or  the upstream polymerase follows at the speed of the downstream polymerase . each polymerase collision model leads to different levels of steady state protein production . for example, in the upstream falloff model, most of the t <dig> polymerases will prematurely terminate because they overtake slower e. coli rna polymerases . as a result, gene expression levels are similar to the situation where there is no t <dig> polymerase at all .

application
genome-scale models and simulation
in order to test the effectiveness of tabasco on genome-scale systems, we simulated gene expression during bacteriophage t <dig> infection. the  <dig>  base pair t <dig> genome, as represented in our test simulation, is comprised of  <dig> coding domains,  <dig> host and phage promoters, two transcriptional terminators, and three distinct transcriptional feedback loops; four t <dig> coding domains were not represented as they are the result of translational frameshifts or alternative start sites for other genes  <cit> . because there are relatively few transcriptional terminators and many promoters, the rates of transcription for individual t <dig> genes depends on the combined levels of transcription initiation from all upstream promoters, as well as the presence of different types of rna polymerases. in the case of t <dig>  there is a further complication in that not all genes are available for transcription at once, since the entry of the t <dig> genome is a relatively slow process that is itself mediated by transcribing rna polymerases.

using realistic parameter sets, we simulated a single cell being simultaneously infected by three phage particles . the protein-dna interactions on the dna were tracked independently for each infecting phage, but use the same pools of soluble proteins in the cell; thus, these simulations track a combined  <dig>  base pairs of dna. we incorporated known mechanisms of cellular entry of t <dig> dna into our simulations. we also developed a method to visualize the results of our simulations that allows for the graphical display of dynamic tabasco output . simulation of a full-scale genomic model of t <dig> gene expression on a single amd athlon mp 2100+  <dig>  ghz processor takes between 1– <dig> hours for a model that represents  <dig> minutes of real-time infection. visualization of tabasco output displays both t <dig> and e. coli rna polymerases transcribing the dna, the extent of genome entry, and the resulting mrna and protein levels from the  <dig> encoded genes . over the course of the simulation, the phage dna enters and is transcribed by the e. coli rna polymerase. as the t <dig> rna polymerase is produced, host transcription is attenuated while the t <dig> rna polymerase takes over transcription and entry of the remaining t <dig> genes. for the first time, we are able to simulate gene expression at single base resolution for all gene expression in a particular organism during its development. in turn this allows us to test specific hypotheses of polymerase interactions, stochastic gene expression, and coupling of entry and transcription. an experimental analysis of the t <dig> gene expression program, using tabasco, will be presented in a forthcoming paper .

discussion & 
CONCLUSIONS
we designed and developed tabasco to revisit approximations encoded within previously available gene expression simulation algorithms, and to develop a method for efficiently computing single-molecule, base-pair resolved models of gene expression. previous tools required either modeling smaller systems at increased resolution, supercomputers, or simplifications and assumptions of the biophysical models that result in reduced simulation accuracy. for example, tabasco's implementation of a gibson-accelerated gillespie ssa allowed us to bypass simplifications that are often made for promoter binding by rna polymerase and transcription initiation  <cit> . we have shown here that the increased resolution of tabasco provides more accurate pre-steady state kinetics of gene expression, gives us the ability to test models of polymerase and protein interactions on the dna, and allows us to fully simulate the dynamics of gene expression during development of bacteriophage t <dig> at base-pair resolution.

like moleculizer, tabasco dynamically generates reactions based on rules. specifically, tabasco uses the mechanics of gene expression as rules in order to avoid specification of all the states and transitions prior to simulation  <cit> . like stochsim, tabasco is a single-molecule simulator, which allows tabasco to track the state of individual molecules of dna, rather than tracking individually all states of a system that could be reached  <cit> . as a result, tabasco differs from previous gene expression simulators in that it is able to automatically represent the effects of molecular collisions, such as polymerase-polymerase interactions and the occlusions of dna elements by transiting molecules.

since tabasco tracks individual molecules of dna, the processing power required for tabasco simulation scales with the copy number and length of the template dna. while requiring significant processing power, tabasco is computationally tractable in regimes for which stochastic simulations are often needed to produce accurate results . those interested in using simulators similar to tabasco to study detailed interactions at the rna level would face challenges due to the higher numbers of rna compared to dna in the cell. such challenges may be overcome in the future by incorporating the work of others on increasing the efficiency of ssas without significantly sacrificing accuracy  <cit> . in particular, if the probabilistic simplifications of russell and zhu can be extended to simulations in larger, more complex systems such as t <dig>  we would expect to see increases in simulation efficiency  <cit> .

while tabasco is an exact ssa, it only exactly simulates the kinetics of the already simplified models that we give it. for example, we model transcription elongation as a first-order reaction, even though we know that this process is more complicated  <cit> . in addition, the general use of physics models based on well-mixed elementary chemical reactions may sometimes be an inappropriate approximation of the inside of a cell. for example, it is known that the binding of proteins interacting with dna often involves one-dimensional diffusion along a dna template  <cit> . the effects of these simplifications on simulation accuracy are not well studied, and are common across currently available simulators of gene expression dynamics. finally, other processes that affect transcription such as mrna secondary structure, sequence-specific kinetics, regulated pausing and backtracking, and many other known biophysical phenomena are not considered here. such processes can and should be incorporated into gene expression simulation frameworks as the particular biological system being studied or engineered warrants.

executables, source code, documentation, and usage notes for tabasco are freely available, and should facilitate future extensions on the current design . we have already found tabasco to be useful in constraining models of t <dig> gene expression by comparing simulator output to new experimental measurements of absolute copies of mrna abundance during infection; these results will be presented in a forthcoming paper . in addition, tabasco should be a good base to further study interactions on dna that lead to transcription and translation. for example, tabasco provides a platform to explicitly simulate hypotheses how many transcription factors can interact to direct eukaryotic gene expression, such as in control of endo <dig> expression  <cit> . finally, the general approach of using simulator-encoded logic and tracking of one-dimensional reaction systems should be useful for studying other biological phenomena – for example, oligosaccharide modifications of proteins.

