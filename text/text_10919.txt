BACKGROUND
as the shape of an organism's transcriptome is determined not only by the coding sequences of the genome but also by the mechanisms of gene regulation, massive efforts in sequencing require a similar follow up with the analysis of regulation systems. in recent years, technology has provided powerful tools to address this task, allowing for the accumulation of sequence, microarray, and functional data. similar advancements are needed in the computational methods of data analysis.

the key role in transcriptional regulation of genes is played by a group of proteins called transcription factors   <cit> . their main function is to bind to the dna upstream of a gene and take part in initiating transcription. tfs bind to the upstream dna sequence selectively, i.e. tfs recognize specific dna sequence motifs. another important property of tfs is that they often interact with each other to create functional protein complexes  <cit> . finding the connections between tfs as well as their respective binding sites and understanding the combinatorial nature of their interactions is currently an active field of research.

our method aims at discovering binding site modules, i.e. functional sets of binding sites present in upstream regulatory regions of genes and used by several tfs in combination to regulate the expression of these genes. this task presents a considerable challenge because motif data are usually derived only from statistically significant over-representations of hypothetical binding sequences and therefore contain many false positives . also, a significant amount of noise in the expression data may lead to errors in identifying correlations among genes.

several studies  <cit>  have applied gene expression clustering to find groups of genes that may be co-regulated. however, some of the transcription factors are active only during certain parts of the cell cycle  <cit> , and therefore genes that are co-regulated by those factors show strong expression correlations only over a subset of data points. consequently, these modules may sometimes be undetectable by means of global expression clustering. here we show how local expression clustering may overcome these shortcomings by means of an extensive comparison of the performance of local and global expression similarity in detecting biologically significant binding site modules.

approach
our method identifies regulatory binding site modules by means of analyzing their ability to predict gene expression. to this end we systematically examine all the combinations of binding sites suggested in the hughes study  <cit> . as input data we use the expression time-profiles of a large group of genes, and information on the presence or absence of binding site motifs in the promoters of all genes in the studied genome. genome-wide expression data are readily available for many organisms, for example from public databases such as arrayexpress  <cit>  or stanford microarray database  <cit> . as for motif data, there are extensive databases such as transfac  <cit>  covering experimentally verified motifs for many model organisms. in cases where there is not enough motif data, putative motifs may be obtained using one of the well established motif finding tools .

in the present study we expand on the framework we have previously developed  <cit>  by adding a capacity for analyzing local expression similarity. furthermore, instead of the heuristic algorithm we have used earlier, we perform an exact and exhaustive search of the rule space. we strive for improvements in both sensitivity and coverage of our approach.

the overall methodology of the current study is schematically depicted in figure  <dig> and consists of four steps :

• clustering. selecting all groups of genes that are co-expressed  limited to any sufficiently long period of time .

• merging. combining motif data and clustering information into decision tables, one table per cluster , such that each cluster is a decision class in the respective table.

• rule induction. finding all motif combinations capable of predicting the expression behavior of each cluster.

• generalization. assigning genes that lack expression data to modules based on the presence of significant motifs in their promoters.

local correlations
we assume that genes that are co-regulated by common transcription factors display strong correlation in their expression profiles. some transcription factors, however, may bind only under certain conditions. indeed, many genes from s. cerevisae demonstrate expression correlation only during parts of the cell cycle . for these genes it is not possible to obtain clusters reflecting this property by using expression similarity over the entire expression profile. however, by introducing time windows and allowing for cluster overlaps, it is possible to group genes into clusters with tightly correlated local expression. the advantage of local expression correlations was earlier identified by gasch et al.  <cit> , who used a fuzzy k-means clustering to allow for multiple cluster assignments of some genes. their method however was not designed to infer temporal properties of co-regulation. time window analysis of expression profiles was then introduced by lagreid et al.  <cit> . the authors used expression analysis and machine learning methods to predict gene function .

the notion of local analysis of expression profiles leads to a modified approach to profile clustering. we consider groups of genes that show very high correlation throughout a part of the expression profile. specifically, we take into account all possible time spans of a given length  and using a simple clustering algorithm  we obtain all groups of genes with expression profiles correlated in any time window.

merging expression and motif data
once we compute all sets of locally co-expressed genes we relate that information to motif data. for each cluster, we create a decision table as shown in figure  <dig> with genes from the cluster labeled in and all other genes labeled out. in these tables, rows correspond to genes and columns correspond to binding site motifs. if a motif is present in the promoter of a gene, then we place a value of  <dig> in the proper row and column . the last column is the decision class, containing the value i n if the respective gene is a member of the considered cluster .

rule induction
as a learning model for describing putative regulatory binding site modules, we develop implication rules of the following form:

rap1∧swi5∧mcm1′→∼ylr197w
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqwgbbqqcqwgqbaucqaixaqmcqghnis2cqwgtbwucqwgxbwvcqwgjbqscqai1aqncqghnis2cqwgnbqtcqwgdbwqcqwgnbqtcuaixaqmgaqbamaaoqcaleaacqggbbwwcqaiyagmcqgguaglcqgguaglcqgguaglcqaixaqmcqaiwaamcqggdbqxcqwi8iiocqggoaakcqaiwaamcqgguaglcqai5aqocqggpaqkaeqakiaawkziaiabdmfazjabdyeamjabdkfasjabigdaxiabimda5iabieda3iabdefaxbaa@5410@

the left-hand side  of the rule requires a set of motifs to be present in the upstream regulatory region of a gene. the right-hand side  predicts that the expression of that gene over some data points  will be similar  to the expression profile of the cluster representative . we say that a gene matches the left-hand side of the rule if its promoter contains all the motifs enlisted in that rule. similarly, we state that a gene matches the right-hand side of the rule if its expression profile in the proper time window is correlated with the expression of the cluster representative with a coefficient greater than the given threshold.

we cannot claim that the rules we derive fully describe the complex nature of gene regulation. rather, we aim at providing a simple model linking the available types of data, which oftentimes are marred by considerable levels of noise. therefore, instead of interpreting the rules in the strict sense , we look for rules satisfying two criteria we have introduced previously  <cit> :

• generality, i.e. each rule covers at least  <dig> genes,

• accuracy, i.e. of all the genes matching the left-hand side of the rule, at least 2/ <dig> of them match the right-hand side of the same rule.

for the task of rule induction, we use an exact algorithm based on suffix trees .

rule generalization
we are interested in finding out whether the rules obtained from the procedure described in the previous section can be used to generate sound hypotheses on co-regulation of genes of unknown expression, i.e. could the information contained in the rules be extended to genes not included in the expression dataset? we investigate this question by searching for the previously identified binding site modules in the promoters of genes with unknown expression, and as a result create larger sets of putatively co-regulated genes. we can then evaluate these extended gene sets and compare with previous results.

RESULTS
we have tested our methodology on a cell cycle expression data set from s. cerevisae . using a range of time windows  and correlation thresholds  we obtained  <dig> rules describing  <dig> unique binding site modules . these rules describe the regulation of approximately  <dig> genes of the s. cerevisae genome. even though our input dataset corresponds to the best-understood biological process of one of the most extensively described species, the knowledge of underlying biological processes is far from sufficient to enable direct evaluation of our rules. indeed one would be hard pressed to find many reported examples of the effects of a particular combination of tfs on a given gene measured under specific conditions in the cell. instead, we limit our evaluation to genomic-scale type comparisons with the available experimentally-derived datasets on gene regulation in s. cerevisae. we provide an extensive analysis of the statistical significance of our results in comparison with published studies concerning s. cerevisae cell cycle datasets. we also present two examples showing how rules obtained for particular time segments of the cell cycle can provide a more specific description of regulation: rules that could not be discovered without current improvements.

to assess the statistical significance of our results, we use the scoring procedure introduced in our earlier work  <cit> . we test putatively co-regulated groups of genes for overrepresentation of annotations from gene ontology  <cit>  and the actual binding of transcription factors in s. cerevisae  <cit>  . to allow for a more direct and complete comparison with the results of other methods  <cit>  we compute our scores for the groups of putatively co-regulated genes they provide. this was also done in an attempt to put all the available results on the same footing with respect to changes in go annotations over time and with respect to the available experimental binding data. although all authors use very similar methods of measuring statistical significance, we fully realize that the above may not be the only way to make such comparisons  <cit> .

in the case of our own approach, evaluation with experimental binding data surprisingly produces better results for groups supplemented with genes not included in the expression dataset. we investigate this phenomenon further by using a second type of evaluation, a pairwise co-regulation coefficient . pcc is characterized by a different dependency on cluster size than the p-value based scores and thus provides an alternative way to evaluate results. the outcome of this evaluation procedure is presented in a separate section.

evaluation with gene ontology
genes sharing a common function are very often co-regulated. many authors use the publicly available information on genes sharing function to assess their predictions of co-regulation  <cit> . although very indirect, this may serve as a crude estimate of the biological significance of the rules we derive. following this line of reasoning we use gene ontology  <cit> , a human-curated set of biological terms  to annotate the function of genes. the terms are organized into three hierarchies  describing biological roles at different levels of detail.

in this work we employ the scoring procedure from hvidsten et al.  <cit>  introduced by cho et al.  <cit> . this procedure treats all sets of genes sharing common gene ontology annotations as sets of co-regulated genes. to this end we consider all go terms at all levels in each hierarchy and treat all genes annotated with that term and its descendants as sharing annotation .

gene ontology scores for our sets of rules  are summarized in table  <dig> and are compared with scores for previously published studies.

comparison of the gene ontology-based scores with other studies. for each method, the presented number represents the fraction of significant gene groups among all gene groups provided by that method . for the present method, the results that score higher than all other studies are shown in bold. correlation thresholds used in the clustering procedure are shown in the left column. numbers in parentheses denote scores obtained for all genes .

evaluation with experimental binding data
in the case of s. cerevisae, there is a much more direct way to evaluate results than using gene ontology. harbison et al.  <cit>  published the results of chip-chip experiments measuring p-values of the binding of  <dig> transcription factors to  <dig> intergenic regions. for evaluation we consider genes with promoters that are bound by the same transcription factor as co-regulated by that tf .

comparison of binding scores . for each method, the presented number represents the fraction of significant gene groups among all gene groups provided by that method . for the present method, the results that score higher than all other studies are shown in bold. correlation thresholds used in the present clustering procedure are shown in the left column. numbers in parentheses denote scores obtained for all genes .

one has to keep in mind that although chip-chip data currently represents the most direct measurements of transcriptional regulation on a genomic scale, it is only a statistical measure of the tfs binding to promoter regions under some specific conditions. in reality, transcriptional regulation is a time-dependant process, with tfs dynamically binding and unbinding to dna, and cannot be accurately described by a single "snapshot" as in chip-chip data. nonetheless we accept this simplification since no better data currently exist. it would be very interesting to include time-series chip-chip data in our analysis once they become available.

pairwise co-regulation coefficient 
since our scoring is based on statistical significance of gene group overlap, it can be argued that the increase in the scores of generalized rules can be attributed to the increase in gene group size rather than to a better quality of rules. to investigate this, we need a different scoring methodology providing additional insight into rule quality for large groups of genes. to this aim we employ the pairwise co-regulation coefficient . for a given set of gene groups the pcc measures the fraction of gene pairs from the same group that are actually co-regulated . here, we choose to restrict our analysis to the experimental binding data as it provides a much more direct way of evaluating co-regulation than the go annotation enrichment.

a pcc value can then be interpreted as follows: assuming that we choose a random pair of genes annotated as co-regulated according to some prediction method , what are the chances that they are actually co-regulated ? moreover, the pcc value has the nice property that all tfs that bind to at least two genes in the same module contribute to the score, and hence all possible subgroups of co-regulated genes are accounted for in one value.

since the number of pairs increases proportionally to the square of the number of genes it is less likely for a large group to obtain a high pcc score than for a small one. this is due to the fact that the introduction of a new gene which is not co-regulated with the others to a group of size n will introduce n erroneous pairs that have to be accounted for in the score.

the results of this type of analysis and comparison with other studies are summarized in table  <dig>  to provide reference values for our results we have computed the pcc scores also for random sets of genes. we sampled  <dig> families of random gene sets generated to reflect the size and number of sets in the real data with the following results:

comparison of pairwise co-regulation coefficient for rules obtained in this study with gene groups from other studies . correlation thresholds used in our clustering procedure are shown in the left column.

• random sets of genes sharing common binding motifs  ,

• random sets of co-expressed genes  ,

• totally random sets of genes .

the pcc scores for our approach show that the increase in the size of the groups caused by the generalization of rules does not result in a notable change in the quality of the rules. although this indicates that the surprising increase in p-value significance  is largely due an increase in the number of genes for which the statistical test is conducted, the pcc scores indicate that generalization indeed can be used as a tool for predicting co-regulation of genes with unknown expression.

predictive strength
to quantify the predictive value of the system of rules as a whole, we have to measure the quality of the rules for all genes. towards this aim we use the experimental binding data and compute the p-values of all rules as in the previous section. as a result of this procedure we obtain p-values for all the genes covered by the rules. since the results of different studies cover different sets of genes, we have decided to present the data as a plot , with the y-axis representing p-values, and the x-axis all the genes sorted by the best p-value. we use the logarithmic scale in y to emphasize the region around the significance threshold . the results for each method are represented by a line with each point  representing the number of genes  covered by the rules with a p-value of y or lower . if a gene is assigned to one rule only, the respective p-value can be interpreted as a predictive strength of the method for this particular gene. because our method describes regulation in terms of overlapping modules it is more difficult, compared to the other approaches, to associate each gene with only one p-value. to demonstrate the full potential of the method we construct the plot in fig.  <dig> using p-values of the best scoring rules for each gene. as a control we also show a similar plot using the p-values of the worst scoring rules .

given a set of rules, an attempt can be made at predicting regulation patterns for other genes in the system, in particular the ones for which no expression data are available. a simple procedure to follow is to select the rules matching the gene in question. since our rules are labeled with binding site modules and expression profiles, they provide a hypothetical regulatory circuitry for that gene. a similar approach could be applied to results of other studies; however, not all of them mark their groups of putatively co-regulated genes with motifs and expression profiles.

we can see from the plot in figure  <dig> that although our methodology  does not have the highest coverage of all studies in general, it clearly performs best in the area of significant p-values . it is important to note that if we do not include the genes with unknown expression in the analysis, the predictive value of our rules is reduced to a limited set of genes, comparable in size to those obtained with other methods .

since our method provides significantly more gene groups  that other methods do, it may be argued that the real reason behind the high coverage we obtain is the large number of overlapping rules and the fact that we select the best rule for each gene. to this end we compare our results with two additional plots :

• scores for the set of generalized rules, calculated by taking the worst rule instead of the best rule for each gene. as we can see from the figure, even if we deliberately choose the worst rule for all genes, we can still annotate over  <dig> genes with rules that are significant.

• scores for the set of generalized rules calculated by taking the best rule for each gene after randomly permuting all gene labels. this test clearly shows that even if we consider a large number of overlapping rules and select the best rules for each gene, we should not expect many genes to be covered by significant rules by chance.

specific examples
in addition to genome wide analysis, it is interesting to take a look at some specific examples of rules, to examine if the information they provide is indeed biologically meaningful. in this paragraph we examine two putative binding modules.

the first combination of motifs, reb <dig>  swi <dig> and scb, can be found overall in  <dig> rules, all of which are based on time windows comprising the 9th and 10th data points. based on the original publication of the expression profiles  <cit>  we can map these points to the m1/g phase boundary which is exactly the active time of the swi <dig> factor . it is interesting that this combination of motifs was not identified by our previous study  <cit> . such identification was not really possible, since the expression profile similarity is strong enough only in the part around the 10th time point . this particular combination of motifs is also strongly supported by a highly significant p-value of  <dig> · 10- <dig> for the chip-chip data.

another interesting example combines motifs mcm <dig>  swi <dig> and ecb. this binding module is also not found in the previous study, where only combinations of mcm1' with swi <dig> are reported. again the reason behind missing this combination in the earlier work is the local nature of the expression correlation that cannot be identified in a global analysis . however, applying local clustering identifies this module as significant in  <dig> rules, all of which are based only on time windows starting at the 2nd, 3rd or 4th time point. this is reasonable, since the ecb motif denotes early cell-cycle box. the module is also highly significant in terms of binding evaluation: p =  <dig> ·10- <dig> 

the two examples presented here show that our approach based on local expression similarity can retrieve significant binding site modules that cannot be found by other methods based on global similarity. furthermore, these modules were not only shown to be statistically significant , but also biologically significant .

discussion and 
CONCLUSIONS
recently, several studies have investigated the combinatorial nature of gene regulation. by analyzing expression coherence of genes containing pairs of binding site motifs in their promoters, pilpel et al.  <cit>  demonstrated that combination of binding sites provides a key to understanding regulation. several later studies  <cit>  employed the methodology of bayesian networks to investigate the structure of regulatory combinations in s. cerevisae using expression data and promoter sequences. the aim of those studies was to identify a partition of the s. cerevisae genome into non-overlapping clusters of putatively co-regulated genes. segal et al.  <cit>  proposed using bayesian models, where genes were assigned to clusters based on the presence of sets of motifs in their promoters. the authors employed the expectation maximization  learning procedure to build a model that best matched the data. during optimization, both gene and motif sets were changed until convergence. as a result the authors obtained a rich probabilistic model describing combinatorial regulation. beer and tavazoie  <cit>  took a slightly different approach by fixing the clustering and learning a bayesian network to predict expression profiles. again, a very complex model taking into account motif placement and orientation was obtained. however, by fixing the clustering  the authors decreased the number of model parameters which lead to better convergence of the learning process.

previously  <cit>  we have proposed a change to this paradigm. the idea was to induce rules connecting groups of binding sites  with possibly overlapping clusters of genes characterized by similar expression profiles. the method aimed at finding general rules predicting similarity in expression from the occurrence of sequence motifs. groups of putatively co-regulated genes could then be obtained by selecting genes matching the left-hand-side of the rules. we have shown that this less complex strategy obtained groups of genes that scored comparably well in relation to previous studies, both in terms of ontology annotations and binding verification. in the current study we present two significant improvements of the above approach: using local expression similarity in clustering of time series data and extending the framework to include genes for which no expression profile data have been reported.

we have also attempted a comprehensive comparison of all of the above mentioned computational methods to assess their biological significance. this is not an easy task since no definitive source of genome-wide data on true co-regulation exists. beer et al.  <cit>  evaluated their ability to predict genes belonging to expression clusters using the classical training-test set division of the genes in a cross validation setting. however, there is of course no guarantee that these clusters correspond to truly co-regulated genes. furthermore, the studies we compare applied different clustering methods resulting in different clusterings. consequently, there is no consistent way of deciding whether a prediction is correct across different studies, and hence it seems inappropriate to use the ability to predict expression as an evaluation criterion here. instead, we argue that a better approach for evaluating the predicted co-regulated genes is to apply external data/knowledge not used to induce the models themselves.

using experimental binding data and gene ontology annotations, we demonstrate improvements in both quality  and coverage  when using local similarity of expression profiles. furthermore, we showed that expanding the modules to include genes without known expression profiles did not reduce the quality of the rules and thus we conclude that the approach indeed is capable of generalizing to these genes.

obviously, also the evaluation data used in this study may be associated with some disadvantages. the chip-chip data is inevitably linked to a specific biological context, and thus different contexts/cellular states would result in different binding data and consequently different evaluation scores in our study. the use of functional categories to search for binding site motifs  <cit>  may also provide an unfortunate bias when evaluating different methods using gene ontology. however, to the best of our knowledge, these are the most appropriate data sets for evaluation that exist. and by comparing different studies using the same evaluation method and the same data, any unfortunate bias should at least be the same for all the methods. on the one hand, the relatively large range of performance observed for the methods we have compared indicates that the problem of finding binding site modules is far from solved. on the other hand, it is also an indication that at least some non-trivial correlations between tf binding and sequence motifs or between functional annotation and sequence motifs are being picked up by our approach. finally, the use of different data in terms of experimental data , and human-curated knowledge  strengthens our confidence in the biological significance of the presented evaluations.

similar methodology, i.e. if-then rules connecting tf modules with expression profiles, was used in a recently published study of pham et al.  <cit> . however, one difference is that we do not use chromatin-immunoprecipitation data  <cit>  for rule inference but only as an independent standard for method evaluation. this means that our method is also applicable to organisms for which no genome-wide chip-chip results are available. the underlying difference in approach also prevents us from direct comparisons with the results of that study. it should be mentioned here that although the rule induction method is applicable to all types of expression datasets, the particular time window improvement evaluated in this study obviously requires time profile expression data. however, the idea of measuring expression similarity over subsets of conditions could still be fruitful in non-time profile expression data by using so-called bi-clustering to identify subsets of conditions  <cit> .

results of all the performed analyses  support the conclusion that local correlation of expression time profiles combined with sequence motif information leads to more accurate predictions of binding site modules than was possible with other methods. it is also clear, provided that enough data are available to develop the initial modules, that the method generalizes well over the genes for which no expression data are available.

