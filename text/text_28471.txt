BACKGROUND
although genome-wide association studies  have identified many common single nucleotide polymorphisms  associated with common diseases , these common variants explain only a small fraction of the phenotypic variance attributable to genetic factors
 <cit> . recently, the scientific community has devoted a lot of attention to the analysis of rare variants, with the hope of finding the missing heritability. indeed, there is growing evidence that rare variants are associated with some complex traits
 <cit> . therefore, research in the area of rare variants has a high potential to discover unknown associations of genomic regions with complex phenotypes. numerous methodologies have been developed to test association of multiple rare variants within a region with a phenotype
 <cit> .

measures of genotype similarity have been the basis of many proposed statistical tests. the idea of similarity-based tests is to consider the relationship between genotypic and phenotypic similarities . similarity-based tests are motivated by the fact that haplotypes carrying the same causal mutation are more related compared with those without causal mutations; so, case haplotypes are expected to share longer stretches of dna identical by descent
 <cit> . one of the major advantages of similarity-based tests is the ability to accommodate multiple types of dna variations  observed within a region, given flexibility in the choice of similarity measures between two sequences
 <cit> . another issue that similarity-based tests address is the possible interaction of different variants within a region, which is potentially accounted for by considering multi-site similarity measures
 <cit> . for unrelated individuals, similarity measures have been incorporated within a framework of single snp analysis of variance
 <cit> , multiple regression
 <cit> , u-statistic
 <cit>  and distance-based regression
 <cit> . methods based on genotype similarity include the following: sequence kernel association test 
 <cit> ; kernel-based association test 
 <cit> , multivariate distance matrix regression test 
 <cit> ; and aggregate u-test
 <cit> . however, so far, no attempts have been made to evaluate the performance of similarity-based tests on rare variants association scenarios when common variants are included into or excluded from the analysis. even though many non-causal common snps are removed by considering only rare variants, it is unclear if consideration of fewer variants would be sufficient to compensate for the loss of association signal from common snps. also, when both rare and common variants are included into the analysis, it is of interest to evaluate the change in the performance of the tests when rare variants have lower effect sizes than common snps. additionally, statistical tests may utilize different pooling strategies for rare variants, e.g. weighting or collapsing. given the choice, it is unclear which pooling strategy is the best to be applied with similarity-based tests.

in this article, we compared the performance of the four similarity-based tests  applied with two popular rare variants pooling strategies . the comparison was performed based on population-genetics simulations under four different disease models and the gaw <dig> sequencing data set. the results highlighted that, under the presence of strong rare variants association signal and moderate association of common variants, weighting may be a much better strategy than collapsing, whereas collapsing tends to outperform weighting when common variants possess a strong effect. moreover, we discovered that the magnitude of the difference in power among similarity-based methods, when applied with weighting and collapsing strategies, may be very high, sometimes over 50%. under the strong effect size of rare variants when common variants were excluded from the analysis, we observed better performance of collapsing strategy and lower power of weighting pooling strategy. also, when the appropriate pooling strategy is applied, both skat and kbat showed consistently high power among all the four similarity-based tests compared here.

RESULTS
population genetic simulations
for each test,  <dig> permutations were performed to assess the significance of association. to make sure the empirical type- <dig> error is controlled, we ran the analysis of simulated data under the null model. as can be seen from additional file
1: table s <dig>  the type- <dig> error was well controlled by using the permutation procedure to estimate the significance level. it is noticeable that for “risk rare” scenario when weighting pooling strategy is applied and for “risk common” scenario the estimates of type- <dig> error are below  <dig> . this suggests that in these cases the methods show slightly conservative behavior. the double-sided 99% confidence interval for the type- <dig> error estimate is approximately  <dig> – <dig> . this can be derived from the normal approximation, given that the estimate of type- <dig> error rate is distributed as an observed probability of success for a binomial random variable with a success probability of  <dig>  under no inflation of type- <dig> error and the sample size of  <dig>  which is the number of data replicates. as can be seen, the empirical type- <dig> error estimates for population genetics simulations were within the 99% confidence interval.

figure 
 <dig> shows the power of the four tests with collapsing and weighting pooling strategies under different association scenarios. as can be seen from panel  <dig> , the power of the tests was in the following order: for collapsing mdmr performed no worse than skat but no better than u-test, which in turn had lower power compared to kbat; for weighting, mdmr performed worse than kbat, and kbat was no more powerful than skat, whereas u-test was the most powerful among all the four tests considered. also, weighting increased the power of all the tests, except for mdmr. the same situation was observed when a weak association signal from common variants was introduced, together with weaker signal from rare variants . the performance of the tests when rare variants had lower effect compared with common variants  is presented in panel  <dig> of figure 
 <dig>  as can be seen, the pattern is different from those observed for the previous two scenarios. for all the tests, the collapsing strategy performed better than weighting. these results suggest that weighting outperforms collapsing when strong rare variants association is present; however, when common variants explain a significant portion of phenotype variability, collapsing is more advantageous since the weighting scheme undermines the signal from common variants.

finally, we investigated the performance of the tests in the “mixed rare” scenario which incorporated both risk and protective variants within a region . as expected, collapsing underperformed weighting pooling strategy because collapsing risk and protective variants annihilates the association signal. overall, the simulation results highlighted the consistently high power of kbat and skat when the appropriate rare variants pooling strategy was applied . although these two tests had slightly lower power compared to the u-test for “risk rare” and “risk both” scenarios, they had much higher power for the other two scenarios. additionally, we calculated the maximum absolute power difference over the type- <dig> error rate for each test and phenotype scenario. as can be seen from table 
 <dig>  the maximum absolute power difference was substantial, and ranged from as low as 10% to as high as 55%. the average maximum absolute power difference for the considered tests across the phenotype models were  <dig> %,  <dig> %,  <dig> % and  <dig> % for mdmr, skat, kbat and u-test respectively. this result shows the extreme importance of choosing the right rare variants pooling strategy for different disease models. as in our simulations no adjustment for population stratification was made, we analyzed the data using another popular similarity measure: identity-by-state
 <cit> . the results were similar to those obtained for exponential similarity .

we also analyzed the simulated data after excluding all common variants defined as those with maf > 1% . since all common variants were excluded, association tests under collapsing were performed only on a collapsed super-locus. in contrast to the previous results, for “risk rare” and “risk both” scenarios, collapsing performed better and weighting performed worse. for the collapsing strategy, the reduction in the number of snps was beneficial despite the loss of association signal from the excluded common snps. however, for the weighting pooling strategy, the loss of some of the causal variants with maf above 1% lowered the statistical power of the tests. hence, the results suggest that under strong rare variants effect size in one direction, one should prefer collapsing to weighting when common variants are excluded from an association test. for the “risk common” scenario, the power of all the tests and all pooling strategies was lower, as the strong association signal from common variants had been removed. for the “mixed rare” scenario, we observed that the results were similar to those depicted in figure 
 <dig>  also, it is notable that across the four scenarios, the performances of the four tests were very similar under the collapsing strategy. this suggests that for a single snp analysis, the power of the four tests is very similar to one another.

gaw <dig> data set
the gaw <dig> data set is a large scale exome sequencing data set with genotypes from the  <dig> genomes project . the dataset consists of  <dig> unrelated individuals from six populations  samples, tuscan, chinese, japanese, yoruba and luhya). the complex phenotype model incorporates environmental covariates  and both common and rare causal snps from genes in particular pathways. totally  <dig> replicates of several quantitative traits and case–control status were simulated under the phenotype model. a more detailed description of the simulations can be found in almasy et al.
 <cit> .

we performed an association analysis of causal genes that affect two quantitative traits, q <dig> and q <dig>  and a dichotomous trait, d. adjustment for covariates was done in a similar way as in jiang et al.
 <cit> . let g be the genotype matrix, qj,j =  <dig>   <dig> are vectors of two quantitative traits, eii =  <dig>   <dig>   <dig>  are vectors of covariates , and r is the matrix of ten principal components of genotype matrix obtained using the software eigenstat
 <cit> . the corrected genotype, phenotypes and covariates are
g⌣=g−rrtd,
q˜ j=qj-rrtqj,j= <dig> ,
d˜ =d−rrtd and ˜ei = ei-rrtei, i =  <dig> , <dig>  next, covariates are regressed out of adjusted phenotypes using the regression models:

  q˜1=a0+∑i=13aie˜ i+ε1;q˜2=b0+∑i=13bie˜i+ε2;d˜=c0+∑i=13cie˜+ε <dig> 

the residuals from the regression models  were dichotomized  and tested for association with adjusted genotype Ğ of the causal genes. the type- <dig> error was set at  <dig> , and  <dig> permutations were performed for each of the  <dig> phenotype replicates to assess the power. to assess the empirical type- <dig> error rate for all the statistical tests, we ran the analysis with randomly permuted adjusted phenotypes obtained from the regressions . the resulting type- <dig> error rates are presented in additional files
 <dig> and
 <dig>  the double-sided 99% confidence interval for the type- <dig> error estimate is approximately  <dig> – <dig> . this can be derived from the normal approximation, given that the estimate of type- <dig> error rate is distributed as an observed probability of success for a binomial random variable with a success probability of  <dig>  under no inflation of type- <dig> error and the sample size of  <dig>  which is the number of phenotype replicates. as can be seen, the empirical type- <dig> error for gaw <dig> data was within the 99% confidence interval.

figure 
 <dig> depicts the results of the analysis of the causal genes with the respective phenotypes . for the majority of genes with rare causal variants, the weighting strategy, on average, performed better than collapsing . for example, the weighing strategy resulted in substantial power improvement for the genes arnt, sirt <dig>  vnn <dig> and vwf. all of these genes contained multiple causal rare variants with a moderate or high effect size. however, collapsing yielded a much higher power for elavl <dig> and vnn <dig> genes. closer examination revealed that the two most common snps in the vnn <dig> gene were causal, whereas association with the elavl <dig> gene could be explained by association of the only two common snps that were non-causal. to show this, we analyzed these two common snps with the four similarity-based tests and found that the power to identify an association with a phenotype was as follows: mdmr –  <dig> , skat –  <dig> , kbat –  <dig> , u-test –  <dig> . the results of the dichotomous phenotype analysis are presented in the additional files
 <dig> and
 <dig>  among genes with maximum achieved power of greater than 40% for at least one of the tests, weighting was advantageous for the arnt gene, whereas collapsing yielded higher power for flt <dig> and prkca, which both contained common causal snps. so, the results of the gaw <dig> data set support the conclusion derived from population genetics simulations concerning pooling strategies. we also considered the maximum absolute difference in power between weighting and collapsing for each statistical test and each gaw <dig> phenotype  over the respective causal genes. as can be seen from table 
 <dig>  the maximum absolute power difference ranged from  <dig> %  to 84% . the average maximum power differences across phenotypes were  <dig> %,  <dig> %,  <dig> % and  <dig> % for mdmr, skat, kbat and u-test, respectively. this observation confirms the results obtained from our population genetics simulations and highlights the importance of the right choice of rare variants pooling strategy in sequencing association studies.

the genes at which the maximum difference was achieved are in brackets.

discussion
in this article, we compared the performance of the four similarity-based tests together with two rare variants pooling strategies using population genetics simulations and the gaw <dig> real data set. the results suggest that weighting may be a much better strategy than collapsing under the assumption of strong effect from rare variants, and moderate or low effect from common variants. collapsing, in turn, showed much better performance when common variants possessed a strong effect. the absolute power difference of a statistical test when applied with collapsing and weighting pooling strategies may be substantial. from our study, it follows that if researchers are inclined to believe in the association of rare variants within a region, weighted pooling should be applied with similarity-based tests, whereas collapsing is more appropriate if common variants are suspected to be associated with phenotype. additionally, under strong rare variants effect size in one direction when common variants were excluded from the analysis, collapsing performed equally good or better than weighting. finally, both skat and kbat had consistently high power compared with other considered similarity-based tests when applied with the appropriate pooling strategy.

recently, basu and pan
 <cit>  compared the performance of multiple statistical tests to identify an association with rare variants. the authors included skat with unweighted linear and quadratic kernels as one of the testing strategies. based on the results, basu and pan
 <cit>  concluded that skat was powerful compared with other methods when only rare variants were considered. however, the authors found that the method lost its high power when neutral common variants were added. our results suggest that using weighted kernels in skat may preserve high power to identify an association with rare variants even if multiple neutral common variants are included into the analysis. however, since we compared the performance of similarity-based tests, additional investigation is required to compare weighted similarity-based tests with other statistical strategies, including those considered in basu and pan
 <cit> .

from our results, the mdmr test does not seem to perform well when applied with weighting pooling strategy. to have a more detailed picture, we applied weighted mdmr test to the “risk rare” data sets with modified weights wlp, l =  <dig>  … l, where the power value p varied from  <dig> to  <dig>  so, p =  <dig> corresponded to the beta weights applied in our study, whereas p =  <dig> corresponded to the analysis without weights. additional file
 <dig> shows the power surface as a function of significance level and a value of p. it is clear that for all significance levels, the power of mdmr monotonically decreased with higher values of p, which corresponded to higher relative weights for rare variants. in the additional file
 <dig>  we proved that when the number of cases equals the number of controls , skat and mdmr test statistics are equivalent to the sum of, and the sum of squares of dissimilarities for all case–control pairs respectively. when weighting pooling strategy is applied, dissimilarity tends to be relatively large for pairs of individuals whose genotypes differ in multiple rare minor alleles. squaring dissimilarity measure puts much more emphasis on pairs with a larger dissimilarity. thus, the magnitude of the mdmr test statistic may be completely defined by the number of case–control pairs whose genotypes differ by at least two rare minor alleles. we suppose that pairs with a difference of one rare allele may not have sufficient dissimilarity to significantly influence the mdmr test statistic, which leads to a loss of power. to illustrate our reasoning, let us have two rare variants with only eight observed minor alleles each across  <dig> cases and  <dig> controls. to simplify the description, assume that individuals have either zero or one copy of a minor allele across the two variants. also, we will use the equivalence of the mdmr test statistic to the sum of squared case–control dissimilarities. consider the following cases under the null and alternative hypotheses, respectively: cases and controls have four minor alleles for each variant, and cases have all minor alleles. under the alternative hypothesis, we have zero case–control pairs with a difference of two alleles across genotype, whereas under the null hypothesis, we have  <dig>  however, under the alternative hypothesis, there are 16 ×  <dig> case–control pairs with a difference of one minor allele, whereas under the null hypothesis, there are only 16 × . now it becomes clear that if the dissimilarity of pairs of individuals with a difference of two alleles is large enough relative to the dissimilarity of pairs of individuals with a difference of only one allele, the mdmr test statistic may become lower compared to the null test statistic. the consideration above explains the low performance of mdmr with weighted similarity and the fact that for the “risk rare” scenario, the power of mdmr test was below type- <dig> error rate.

one limitation of the current study is that the minimum significance level in population genetics simulations was  <dig> . for genome-wide significance, the number of permutations needed to reliably estimate the significance is very large. this makes the comparison of the similarity-based tests at the genome-wide level prohibitive. in real gwas studies, only few highly-significant genes will require a very large number of permutations to estimate p-values, as many genes with low or no association signal can be dropped out after a few thousand permutations. for highly significant genes, permutation procedure can be split into several parts and performed in parallel on a cluster.

CONCLUSIONS
the performance of similarity-based tests applied with two rare variants pooling strategies was investigated. population genetics simulations and sequencing data set analysis showed consistently high power of two similarity-based tests and a substantial difference in performance of the two rare variants pooling strategies.

