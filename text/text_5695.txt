BACKGROUND
in phylogenetic studies, data matrices are assembled and analysed to infer evolutionary relationships among species or higher taxa. depending on the study, character-state data or distance matrices may be used, and several different types of data may be available to estimate the phylogeny of a particular group  <cit> . an increasing number of phylogenomic studies are published for data sets including more than  <dig> genes  <cit> . whereas character-state data  are commonly used for parsimony, maximum likelihood or bayesian analyses, distance methods can be selected as an alternative option to decrease computing time when analysing large data sets, or else, can be used in comparative studies where the primary data are not available.

different approaches have been proposed to analyse the growing amount of information that may originate from different sources. the total evidence approach  <cit> , also called character congruence approach  or combined analysis , combines different data sets in a single supermatrix  <cit> . the taxonomic congruence approach , or consensus approach  <cit> , analyses each matrix separately, and combines the resulting trees a posteriori using a consensus  <cit>  or a supertree method  <cit> . the pros and cons of these competing approaches have been debated at length in the literature  <cit> . an intermediate approach, referred to as the conditional data combination, consists in testing a priori the level of congruence of different data sets. only the data sets that are considered statistically congruent, i.e. in phylogenetic agreement, are combined in a supermatrix. the remaining incongruent data sets are analysed separately  <cit> .

the approach used often depends on the level of congruence or incongruence in the data. in phylogenetic analysis, "incongruence" can be defined as differences in phylogenetic trees. it is observed when different partitions, or data sets, sampled on the same taxa suggest different evolutionary histories  <cit> . however, incongruence may also arise when the data violate the assumptions of the phylogenetic method. incongruence among data sets is fairly common and can be present at varying degrees  <cit> . hence, statistical tests have been designed to detect the presence of incongruence and its magnitude  <cit> . in general, such incongruence tests are used to determine if the topological differences observed could have simply arose by chance  <cit> . the null hypothesis of most of these tests  is congruence, i.e., topologically identical trees, where any topological difference is the result of stochastic variation in the data sets . the most commonly used test of this type is the incongruence length difference test . however, numerous problems are known to be associated to it. for example, type i error rates were shown to be well above the nominal significance level when data sets  were compared  <cit> . therefore, nominal significance levels of  <dig>  or  <dig>  have been suggested as more appropriate  <cit> . also, power was low when short nucleotide sequences simulated on different tree structures were compared  <cit> .

numerous factors have been described to explain differences in phylogenetic trees obtained from the analysis of data sets containing the same species. a wide range of evolutionary processes may cause nucleotides at different sites to evolve differently, for examples due to their codon positions or to different functional constraints  <cit> . also, various parts of the genome may have experienced different phylogenetic histories  and trees inferred from different data types  may support different phylogenies  <cit> . other evolutionary processes can explain incongruence between data sets: horizontal transfer, duplications, insertions or losses, incomplete lineage sorting, mobile elements, recombination, hybridization and introgression . furthermore, the use of an inappropriate method to analyse a given data set may lead to a spurious phylogeny, that can be erroneously incongruent to some extent with another phylogeny that has been correctly estimated  <cit> . thus, given two data sets, one of which has parameters prone to long-branch attraction  <cit> , the choice of an inconsistent phylogenetic method to analyse both data sets may produce different trees. incongruence due to systematic errors can be addressed by changing the evolutionary model or the phylogenetic method so that it conforms better to the data. however, incongruence resulting from genealogical discordance processes must be detected and handled in some appropriate ways, e.g., by using phylogenetic network inference methods . thus, three main causes can be invoked to explain incongruence: 1) different phylogenetic trees may be inferred due to random sampling errors, 2) different trees may be produced due to the presence of systematic errors, leading to erroneous phylogenetic inference, or 3) real differences may exist between phylogenetic trees due to contrasting evolutionary histories  <cit> .

alternatively, the term "congruence" is often used to describe data sets, characters or trees that correspond to identical  relationships among taxa  <cit> . however, many authors use a definition of congruence that is looser than the previously described identical topology and that incorporate varying degrees of topological similarities. for example, taxonomic congruence, as defined by  <cit> , is the degree to which different classifications of the same taxa support the same groupings. since the pioneer study of  <cit> , different measures and indices have been proposed to quantify the level of congruence . conditional data combination often relies on such indices to determine the degree of congruence and on statistical tests in order to determine whether or not the data sets should be combined  <cit> .

as described above, the term "congruence" and "incongruence" can have a more or less strict meaning with regards to the level of similarity. the definitions used in this paper are in concordance with the test of congruence among distance matrices . cadm was introduced by  <cit>  and is applicable to two or more matrices. the null hypothesis of the test  is the complete incongruence of all trees , which corresponds to phylogenies with different topologies and/or very different branch lengths. hence, the method can also account for branch lengths . for two matrices , the alternative hypothesis  is that the inferred trees are partially or completely congruent. when more than two matrices  are tested, h <dig> postulates that at least two trees in the group are partially or completely congruent. it is then possible to test for specific pairs. in this paper, incongruence refers to phylogenetic trees with different topologies, which suggests completely distinct evolutionary histories. at the opposite, congruence refers to two or more identical trees with an underlying identical evolutionary history  or to two or more phylogenetic trees with a partial degree of similarity in their evolutionary relationships . the level of congruence can be measured by the test statistic, which ranges from  <dig> to  <dig> 

more specifically, given two or more data sets  studied on the same species, a concordance statistic  is calculated among the distance matrices corresponding to the gene sequences or to the trees and tested against a distribution of permuted values to estimate the probability that the data correspond to the null hypothesis. cadm is an extension of the mantel test of matrix correspondence, which can be used to test the null hypothesis of complete incongruence of the distance matrices . as a complement to the p-value, the w statistic provides an estimate of the degree of congruence of two or more matrices on a scale between  <dig>  and  <dig> . note that when trees have identical topologies but different branch lengths, a statistical conclusion of partial congruence or even incongruence may be reached, depending on the level of differences among the distance matrices that cause differences in relative distance rankings. the test allows users to detect these two cases; thus, both topological and phylogenetic congruence can be tested with cadm .

a posteriori tests can be used to identify which data sets are congruent and to estimate their level of congruence. when the level of congruence among all distance matrices is low, researchers can decide to analyse the matrices separately or in subgroups. however, rejection of independence of the gene trees does not imply that inference of a tree from the combined data set is appropriate. in the case of partial congruence, phylogenetic network methods  <cit> , instead of traditional tree reconstruction methods, can be more appropriate to combine congruent data sets into a single analysis. indeed, in these cases, evolutionary relationships may be better depicted as reticulated relationships. additional tests or studies can also be performed to determine the causes underlying partial congruence . thus, with its null hypothesis  of complete incongruence of all trees, cadm differs from most other available phylogenetic tests of congruence/incongruence, which assume a common evolutionary history  and test the alternative hypothesis of different histories among the data sets .

previously published simulations have shown that the global and a posteriori cadm tests have a correct type i error rate and good power when applied to dissimilarity matrices computed from independently-generated raw data  <cit> . identical results were obtained in simulations involving ultrametric distance matrices  <cit> . cadm has also been successfully used to detect congruence among phylogenetic trees obtained from different gene sequences  <cit> . in this paper, we expand on previous cadm simulations to assess the performance of the test when it is applied to phylogenetic trees. specifically, the type i error rate and power of the global and a posteriori cadm tests were assessed using distance matrices obtained from nucleotide sequences simulated on additive trees under various phylogenetic conditions.

RESULTS
type i error rate
type i error rate was evaluated by calculating the proportion of replicated simulations that rejected the null hypothesis when h <dig> was true by construct. to construct data sets under a true h <dig> of complete incongruence among matrices, im were compared using cadm. table  <dig> presents type i error rates of the global cadm test, at a nominal significance level of  <dig> , obtained for different numbers of im ; n ; and l . in all cases, the 95% ci of the rejection rates included the nominal  <dig>  alpha level, suggesting an adequate type i error rate when cadm is applied to compare distance matrices in a phylogenetic context. type i error rates were also investigated for a posteriori cadm test, where matrices included in a set under comparisons are permuted one at a time. as for the global test, in all cases and for each matrix, the 95% ci included the nominal  <dig>  alpha level, suggesting an adequate type i error rate .

rejection rate are given at a significance level of  <dig> , with 95% confidence intervals in parentheses. calculated from  <dig> replicates, except for cells with * . im = incongruent matrix, n = number of taxa, l = nucleotide sequence length.

power: different levels of congruence among matrices
the estimated power is the proportion of replicates for which the null hypothesis is rejected when h <dig> is false by construct. for  <dig> replicates, a power of  <dig>   indicates that all replicates rejected the false null hypothesis, and thus power is maximal. figure  <dig> shows power curves obtained when different numbers of taxa were permuted to construct congruent matrices , l =  <dig>  <dig> bp and n =  <dig> and  <dig> taxa. when the proportion of permuted taxa is equal to  <dig>  the distance matrices were obtained from nucleotide sequences simulated on identical trees . when the proportion of permuted taxa is greater than  <dig>  the distance matrices were obtained from nucleotide sequences simulated on partly similar trees , and thus, it corresponds to different levels of partial congruence . power decreased with a decrease in the level of congruence among the three matrices . a power close to  <dig>  was observed when identical trees were used , regardless of matrix sizes . reduced power  was observed for matrices with 25% or more permuted taxa, when n =  <dig> taxa; whereas it was observed for matrices with 50% or more permuted taxa, when n =  <dig> taxa.

in a posteriori cadm tests, the rejection rate of each individual matrix was similar to the power level obtained in the global test. figure  <dig> presents the rejection rates obtained for each matrix tested individually for m =  <dig> . the three partly similar matrices  were obtained from nucleotide sequences simulated under identical evolutionary conditions. in situations where not all matrices are congruent in a replicate, incongruent matrices are expected to fail to reject the null hypothesis of incongruence , whereas partially congruent matrices should reject h <dig> . this is exemplified in figure  <dig>  where partially congruent matrices  present rejection rates above  <dig> , thus above the significance level alpha that was used for each test. rejection rates for incongruent matrices  <dig> and  <dig> were near  <dig> , for both n =  <dig> and  <dig> taxa. the power curves in figure  <dig> are nearly identical to those in figure  <dig> for data sets of the same size n, when partially congruent matrices were tested . tables  <dig> and  <dig> present rejection rates for m =  <dig>  and that included a varying number of cm. in table  <dig>  cm correspond to distance matrices obtained from nucleotide sequences simulated on identical trees , whereas in table  <dig>  cm correspond to distance matrices obtained from nucleotide sequences simulated on partly similar trees with 40% of permuted taxa . for both tables, power increased with  an increase in the number of objects ;  an increase in the number of congruent matrices ; and  an increase in sequence lengths . however, power increased much more rapidly in table  <dig>  which corresponds to a situation of complete congruence, with maximum power obtained when three or more cm were included in a replicate, regardless of matrix sizes . in table  <dig>  which corresponds to a situation of partial congruence, maximum power was observed only for four matrices or more, included in a set of m =  <dig>  and with larger matrices .

a false h <dig> was constructed by including a different number of completely congruent matrices  together with a different number of incongruent matrices , for a total of five distance matrices . when cmi =  <dig>  all matrices included in the test are congruent. rejection rates are given at a significance level of  <dig> , with 95% confidence intervals in parentheses. calculated from  <dig> replicates, except for cells with * . dashes  correspond to a ci of  <dig>  -  <dig> .

a different number of partially congruent matrices  and a different number of incongruent matrices  were included in each test, for a total of five distance matrices . to generate cmp, nucleotide sequences were simulated on partly similar trees . rejection rates are given at a significance level of  <dig> , with 95% confidence intervals in parentheses. calculated from  <dig> replicates, except for cells with * . dashes  correspond to a ci of  <dig>  -  <dig> .

power: effect of different evolutionary parameters
power was also calculated for distance matrices obtained from nucleotide sequences simulated on identical trees under a gtr model, with identical or different evolutionary parameters. in table  <dig>  distance matrices obtained from nucleotide sequences simulated with identical evolutionary parameters were compared, for cmi =  <dig>  rejection rates of pairwise comparisons tested for different values of mutation rates  and heterogeneity of substitution rates among sites  are presented. in table  <dig>  distance matrices obtained from nucleotide sequences simulated with contrasting evolutionary parameters were compared. in both cases, and for every condition tested, rejection rates were high, with at least 79% of the replicates rejecting h <dig>  the lowest rejection rate was observed when matrices obtained from nucleotide sequences simulated under more extreme parameters of evolution  were tested. but in general, most cases rejected the null hypothesis of complete incongruence . identical simulations were also performed for cmi =  <dig>  m = 5; and rejection rates were of  <dig>  in every case .

results are shown for a gtr + Γ + i model with different s and α. rejection rates are given at a significance level of  <dig> , with 95% confidence intervals in parentheses. calculated from  <dig> replicates.

rejection rates are given at a significance level of  <dig> , with 95% confidence intervals in parentheses. calculated from  <dig> replicates.

discussion
incongruence among data sets is widespread in phylogenetic analyses  <cit> . our simulations clearly demonstrate the validity of cadm to estimate the level of congruence  among different data sets or partitions and to test its statistical significance. however, in comparison to other tests used in phylogenetic analysis, the null and alternative hypotheses are reversed. most phylogenetic incongruence tests assume that the data sets share an identical evolutionary history and the null hypothesis is congruence  among trees  <cit> . on the contrary, the null hypothesis of cadm is complete incongruence. kendall's coefficient of concordance w is widely used in other fields, especially psychology, where it is used to assess the degree of correspondence or strength of association among different estimators  <cit> . in a phylogenetic context, cadm evaluates the level of congruence, i.e., the degree of agreement among different estimators  of phylogenies, represented by their evolutionary distances, and can be used to test for congruence among matrices or trees.

in order to investigate type i error rates, which is the proportion of replicates that rejected h <dig> when it was true by construct, incongruent distance matrices were compared. in every case, the 95% ci of the rejection rate included the nominal significance level of  <dig>  used for the test . hence, cadm accurately detects completely incongruent matrices even when multiple data partitions are tested simultaneously. in comparison, the incongruence length difference test  produces inflated type i error rates under particular conditions. computer simulations were designed in  <cit>  to assess the performance of ild under different conditions of rejection of the null hypothesis . in that paper, observed rejection rates were well above the alpha level when sequences were simulated on identical trees, but with important differences in the substitution rates among sites. furthermore, the rejection rates increased for longer sequences and for asymmetrical trees. similarly, ild was shown to be strongly biased in detecting topological congruence  <cit> , and to be negatively influenced by the presence of a substantial number of noisy characters  <cit> . different methods have been proposed to alleviate this problem, such as using an alternative null model  <cit>  or an arcsine transformation of the standardized length of the trees in order to linearism the relationship between noise and tree length  <cit> .

numerous congruence tests have also been designed recently such as principal component analysis on log-likelihood ratios or p-values  <cit> , or heat maps to identify groups of congruent markers  <cit> . bayesian approaches have also been suggested  <cit> . caveats associated to each method are discussed in  <cit> , where a hierarchical clustering method based on log-likelihood ratios  <cit>  is introduced to test congruence. however, these tests are dependent upon tree inference  <cit> , and thus could produce spurious results if inadequate models of evolution are used  <cit> . when using the cadm procedure, it is possible to compare the results obtained by computing a distance matrix on the nucleotide sequences using different distances or different substitution models to investigate possible bias. alternatively, cadm can also be applied to the path-length distance matrices obtained from phylogenetic trees  <cit> . these different possibilities were all tested in preliminary simulations , and no effect on the outcome of the test was observed.

as observed in previous simulation studies  <cit> , the power of cadm increased with the number of taxa, with the level of congruence and with the number of congruent matrices within a set of distance matrices . thus, the test performs according to expectations. indeed, the power of a test should increase with the number of objects and with effect size, that is, the degree to which congruence is present  <cit> . interestingly, power also tends to increase with longer nucleotide sequences from which distance matrices are calculated. this novel observation is opposed to the prediction in  <cit> , where it is showed that power is not affected by the number of variables in the raw data. these authors argue that the number of variables should not affect the outcome of the test since data partitions are converted into distance matrices prior to computing the test. however, a weighted version of cadm, which can be used to assign weights to each matrix in the global analysis, is presented in  <cit> . comparison of distance matrices obtained from nucleotide sequences is a particular application of the cadm test. we believe that the higher power observed for longer sequences can be explained by the number of informative sites. however, it appears that power increases more rapidly with the number of taxa than with the number of characters, and even more rapidly with the number of congruent matrices under comparison.

when the overall level of congruence decreases among congruent matrices, so does power . for nucleotide sequence matrices simulated on phylogenetic trees with 40% permuted taxa , a drastic decrease in power was observed when compared to nucleotide sequence matrices simulated on identical phylogenetic trees . the greater the effect size, the greater the power of the test will be  <cit> . tables  <dig> and  <dig> present the rejection rates for two matrices that have been simulated on identical trees , and nearly all cases tested rejected the null hypothesis of complete incongruence, regardless of the evolutionary parameters used. in this study, topological differences are reflected by a decrease in congruence among the sequence matrices, and this can be interpreted as noise in the data or to real incongruence. indeed, power decreases quite abruptly with an increase in topological differences . the level of congruence among distance matrices is indicated by the statistic value in a posteriori tests.

one of the main advantages of cadm lies in its ability to test several matrices in a single analysis, and identify partially or completely congruent and incongruent members of a set of matrices. this is achieved through a posteriori testing, which compares each matrix to all other matrices by permuting a single matrix at a time. our results show that power of a posteriori cadm tests is equivalent to the power observed for the global test . when the null hypothesis of incongruence is rejected, a posteriori tests should be used to identify the matrices that can be combined in a supermatrix, and those that should be analysed separately, or combined in a supernetwork approach  <cit> . other tests, such as ild, can be modified to test for incongruence among multiple matrices. different approaches have been proposed to identify incongruent matrices within a set of multiple matrices; the methods and problems associated are discussed in  <cit> . the concaterpillar program also allows testing for incongruence among multiple matrices through pairwise comparisons  <cit> . however, the number of tests increases exponentially with the number of data sets, and it becomes excessively computationally demanding when numerous data sets have to be compared.

CONCLUSIONS
in the light of our results, cadm has proven to be statistically valid to detect partial or complete congruence among distance matrices and estimate its level in a phylogenetic context. one important advantage of this permutation method is its computational efficiency in significance testing. cadm offers several other advantages with respect to previously described incongruence tests:  the statistic is calculated directly from the distance matrices, thus different types of data can be compared after convertion to distance matrices using an appropriate function.  data that readily come in the form of distance matrices do not have to be further transformed into character-state data matrices.  given that distances can be calculated directly from the raw data without inferring a phylogenetic tree, possible biases introduced by the use of an inappropriate phylogenetic method can be reduced.  also, appropriate distances can be chosen for each individual data set to accurately model its evolutionary parameters.  if needed, path-length distances calculated on phylogenetic trees can also be used, which provide an interesting method to test for congruence among different trees in a supertree approach.  distance matrices can be weighted differentially to account for different numbers of characters.  a posteriori tests can be performed to identify which particular matrices are congruent among all data sets tested.  an estimate of the level of congruence can be obtained by the statistic value of a posteriori test. with the growing amount of taxa and sequences that are used in phylogenomics, cadm offers a simple alternative to compare multiple matrices and identify congruent data partitions. cadm could also be used in cophylogeny studies, where congruence between species phylogenies is assessed to determine the level of host specificity . further simulations designed specifically in a coevolution, cospeciation or cophylogeny context could be performed to validate the use of cadm in these particular settings.

