BACKGROUND
in recent years, tandem mass spectrometry  has become a popular technique in proteomics for protein identification. in a typical "bottom-up" approach, proteins are enzymatically digested into short peptides, each of them is measured with ms/ms and produces an ms/ms spectrum. analytical software is used to identify a peptide for each qualified spectrum. then the peptides are used for protein identification and characterization. many software programs  have been developed for ms/ms data analysis  <cit> .

database search and de novo sequencing are two main approaches for peptide identification from ms/ms data. database search requires a protein sequence database, and tries to find a peptide from the database that best explains the ms/ms spectrum. de novo sequencing does not require a sequence database, and instead constructs a peptide sequence from scratch to best explain the ms/ms spectrum. algorithms and software developments using these two approaches have been one of the research focuses in bioinformatics community recently. some exemplary work for database search approach can be found in  <cit> , and for de novo sequencing approach can be found in  <cit> .

both approaches identify peptides with two steps. first, a set of candidate peptides are selected either from a protein database or with a sequence construction algorithm for a given spectrum. second, each sequence candidate is evaluated with a score function that measures the quality of the match between the sequence and the spectrum, and the peptide with the best matching score is then output. inevitably, the quality of the score function greatly affects the quality of the peptide identification and its following analysis. in a tandem mass spectrometer, a peptide ion is fragmented into fragment ions. normally, the fragmentation can occur at any position of the peptide backbone, resulting in different types of fragment ions ). each ion will result in a peak at the corresponding mass to charge ratio , and all the ions together form a theoretical mass spectrum ). the real ms/ms spectrum is more complicated due to the existence of noise peaks, the missing of some fragment ion peaks, and the different intensities of each peak .

the collision induced dissociation  is among the earliest ways developed for peptide fragmentation in a tandem mass spectrometer, and is also the most widely studied in bioinformatics. it is known to produce more y and b-ions than the other ion types. recently, more fragmentation mechanisms such as infrared multiphoton dissociation   <cit> , electron capture dissociation   <cit> , and electron transfer dissociation   <cit>  have been developed. particularly, etd is regarded as a promising method complementary to cid because etd is better suited for sequencing larger and more basic peptides.

due to the importance of the matching score function, many scoring methods have been proposed. one straightforward approach is based on the match between the real spectrum and the theoretical spectrum generated from a candidate peptide  <cit> . another approach is based on the probabilistic model of fragmentation process  <cit> . these probabilistic models study and employ the statistical differences between peaks produced with different ion types. frank et al. further exploited these properties by a probabilistic network for collision induced dissociation  data to improve the accuracy of de novo sequencing  <cit> .

most of the existing score functions are designed and trained specifically for cid data. etd spectra differ from cid spectra in the magnitude and the complexity of fragment ion signals. although a few software tools such as peaks and mascot have been adjusted to work on etd data, they are better suited for cid data and give poorer results with etd data. to better utilize the advantage of etd spectra on longer and more basic peptides, in this paper, we propose a score function for etd data based on a probabilistic model. the experiments on real data showed that the score function significantly improved the de novo sequencing performance when used in the peaks software  <cit> . our method for developing this score function is general enough to be used to develop new score functions for cid and other types of ms/ms data.

RESULTS
we used an etd dataset of  <dig> spectra from a complex c. elegans protein mixture digested with trypsin followed by alkylation with iodoacetamide. the spectra were acquired on an ltq orbitrap xl etd. the peptide mixtures were separated with surveyor lc equipped with microas autosampler using a reversed phase peptide trap and a reversed phase analytical column at a flow rate of  <dig> nl/min. a gradient of  <dig> ~ 30% acetonitrile in  <dig> minutes was employed.

the database search modules in peaks  <dig>   <cit>  and mascot  <dig>   <cit>  were used for peptide identification. the tandem mass spectra were matched against ncbi c. elegans protein sequence database. for both programs, the error tolerances for parent mass and fragment mass were set as  <dig> ppm and  <dig>  da, respectively. each program reported no peptide or one best peptide with a confidence score for each spectrum.  peaks  <dig>  reported  <dig> peptides and mascot  <dig>  reported  <dig> peptides. we applied several filters to remove low quality spectra. a spectrum is kept only if it satisfies the following three conditions:  the peaks confidence score is no less than 50%;  the mascot confidence score is no less than 30%; and  the two peptides reported by peaks and mascot are the same. finally, we selected  <dig> spectrum-peptide pairs from the dataset. both programs identified the peptides consistently with high confidence scores. thus, the peptides are very accurate and can be used as positive controls in our experiments. among them,  <dig> spectrum-peptide pairs are used for training and the remaining  <dig> pairs are used for testing.

an etd spectrum often contains several peaks generated from its precursor ions. these peaks often have high intensities, and may affect the performance of the matching score function. thus, we removed these precursor ion peaks from the spectra in data preparation.

most de novo sequencing software developed so far is for cid data and does not work for etd data. the only software available to us for performance comparison using etd data is the peaks software  <cit> . recent versions of peaks have a built-in set of parameters for etd, which was adjusted from its cid parameters. we compared our score function with the function used in peaks  <dig> . to make a fair comparison, the result of our new score function is obtained by simply replacing the score function of peaks  <dig>  without making any change to the algorithm. thus, the improvements reported in the following are purely caused by the difference in the score functions.

we mainly compared the accuracies of the peaks de novo sequencing results with the two score functions, respectively. there are two ways to define the accuracy:  

and  

accuracy ii is the same as the accuracy defined in  <cit> . we note that accuracy ii is a fair comparison measure only if two methods output similar number of predicted amino acids. otherwise, the accuracy of the method with shorter output will be unfairly boosted. for this reason, we also show the average prediction length of the two methods in table  <dig> 

in addition, we search the maximum correct consecutive subsequences in the predicted peptides. for each predicted peptide p, the length of the maximum correct consecutive subsequence is denoted by lmax. we count the number of predicted peptides with lmax â‰¥ l, for l =  <dig>   <dig>  ...,  <dig>  the error tolerance for the position of a predicted amino acid subsequence is  <dig>  da, and the amino acids leucine and isoleucine are considered as the same since their mass values are the same.

the testing data contain  <dig> peptides and  <dig> amino acids. using the function in peaks  <dig>  and our score function, we acquired two sets of predicted peptides, each contains  <dig> de novo peptides. the accuracy and the maximum correct consecutive subsequences of the resulting peptides are reported in table  <dig>  the results show that the new score function significantly improves the accuracy of de novo sequencing from  <dig> % to  <dig> % for accuracy i, and from  <dig> % to  <dig> % for accuracy ii. in peaks  <dig> , about 56% of predicted peptides contain a corrected subsequence with length at least  <dig>  for the new score function, more than half of the predicated peptides contain a correct subsequence with length at least  <dig>  from the experiments, we conclude that the new score function has better performance in de novo sequencing with etd data than the score function in peaks  <dig> .

discussion
we note that the independence assumption in our score function development in section methods is not very realistic because different types of ions generated by the fragmentation between the same pair of adjacent residues of the peptide are often correlated to each other. to more accurately model this, a probabilistic network  can be used similarly to  <cit> . we also tried this approach on our data and found no apparent improvement over the model used in this paper. one possible reason is that our training data is of limited size, and not sufficient to train the many parameters of the probabilistic network accurately. another possible reason is the following. the probabilistic network is advantageous over our simple model only in dealing with the dependence between different types of fragment ions at the same location . however, when a de novo sequencing method makes an error at a location, normally there is either no fragment ion or only one low fragment ion at the location. under this condition, the dependence between different types of fragment ions is weak. as a result, a model with the independence assumption would work as well as a more sophisticated one without this assumption.

CONCLUSIONS
in this paper, we proposed a significance level measurement to distinguish signal peaks from noise. based on this, a score function for de novo sequencing with etd data was defined. experiments on real data showed that our score function greatly improved the score function used in the latest peaks  <dig>  software. the method used to develop our etd score function can be easily reused to train new score functions for other types of ms/ms data.

