BACKGROUND
the current estimates of the prevalence of alternative splicing in the human genome fall into the interval 35–60%  <cit> , whereas the estimated number of human protein-coding genes has decreased from more than  <dig> thousand  <cit>  through 30– <dig> thousand  <cit>  to 20– <dig> thousand  <cit> . thus alternative splicing emerges as a major mechanism of generating protein diversity. continuing sequencing of ests, whose number currently approaches  <dig> million, uncovers rare, tissue- and stage-specific isoforms. on the other hand, a considerable number of ests seem to arise from experimental artifacts  or errors of the cellular splicing machinery itself . the latter might be a relatively frequent event, as there exists a special mechanism for surveillance of splicing errors, leading to elimination of aberrant mrna isoforms by nonsense-mediated decay  <cit> .

the algorithms for construction and enumeration of full-length isoforms should take into account as many sources of errors as possible. in early studies est contigs were constructed as consensus exon sequences so that each exon was used only once. this precluded combinatorial explosion, but led to generation of short single-exon contigs, and besides did not allow for enumeration of isoforms. the use of contigs for estimation of the number of isoforms  <cit>  leads to estimates that depend on est coverage  <cit> . recent algorithms construct splicing graph whose vertices correspond to sites and edges to sequence fragments in such a way that each path in this graph corresponds to a possible isoform  <cit> . here we apply the isoformcounter algorithm that constructs the splicing graph aligned to the genomic sequence and computes the number of possible protein isoforms. the latter procedure employs coverage-dependent thresholds for filtering artifacts.

we used isoformcounter to compute the number of isoforms of alternatively spliced genes from the edas database  <cit>  for different functional classes of proteins from go  <cit> . we estimated the probability of spliceosome error  and suggested a simple probabilistic model for filtering exons and introns obtained by est-genome spliced alignment. as a result we have obtained a robust method for enumeration of protein isoforms independent of est coverage. we observed that the fraction of genes with less alternative splicing  is higher in "small gtpase-mediated signal transduction" and "ribosome" classes, and lower in the "dna replication and chromosome cycle" class, compared to the average distribution. we also analyzed the correlation between alternative splicing and protein-protein interactions and demonstrated that interacting proteins are more likely to be encoded by alternatively spliced genes.

RESULTS
algorithm for counting alternatively spliced isoforms
the following terms will be used. exons and introns are genome fragments that correspond to exons and introns respectively in spliced alignment of some est, mrna, or protein with genomic dna. initial and terminal exons correspond respectively to first and last exons in spliced alignment. support of an exon is the number of clone libraries containing ests whose spliced alignments contain exactly this exon; specific cases are spliced alignments with mrna and proteins that generate exons of mrna and protein support respectively. protein-supported exons are ascribed the reading frame derived from protein spliced alignment, whereas est- and mrna-supported exons are considered as triples with the same splicing sites and all possible reading frames.

for each gene  the algorithm constructs the splicing graph. each splicing site corresponds to three vertices of this graph , and its edges are exons and introns. the reading frames of vertices and corresponding edges are consistent. thus each path through this graph corresponds to a candidate mrna isoform. there is also a special type of vertices, start and stop codons, that open and close a reading frame respectively. a protein isoform is a path starting at a start codon or 5'-boundary of an initial exon and ending at a stop codon, with an additional condition that initial and terminal exons are supported by at least two clone libraries.

the isoformcounter algorithm filters isoforms  unlikely to be expressed as a functional protein. the filters are listed below.

 start codons 
an atg codon generates a vertex only if it is confirmed by spliced alignment with a protein or if it is preceded in an exon by a stop codon in the same reading frame. thus a protein isoform starts with the leftmost methionine in a given reading frame or by a methionine supported by a protein spliced alignment. to account for a possibility of insufficient coverage of a gene 5'-region, we also allow a protein isoform to start at a 5'-end of an initial exon, if this isoform does not contain in-frame protein-supported methionine codon.

 initiation of translation 
translation initiation of most eukaryotic mrnas uses the so-called linear scanning mechanism: 40s ribosomal subunit binds the cap structure at the 5'-terminus of the mrna and slides to the proximal atg codon, where it initiates translation, if the codon is in a favorable context  <cit> . stable hairpins and upstream atg codons decrease the efficiency of the linear scanning. a minor fraction of mrnas  contain internal sites of translation initiation  <cit> . to emulate this mechanism, isofomcounter considers only isoforms with at most two upstream atgs, unless the start codon is supported by a protein.

 short protein isoforms
we assume that alternative splicing may eliminate up to 50% of the average protein length, that is, the average length of proteins from refseq corresponding to the given gene. if the gene does not have refseq entries, the average length of corresponding proteins in edas is used. further, no proteins shorter than  <dig> amino acids were considered.

 consistency with proteins
we required that an isoform had at least one amino acid overlapping with a known protein encoded by the gene. this filter is sufficient to remove long open reading frames in 5'-untranslated regions. on the other hand, selecting a stricter threshold would lead to the loss of some known isoforms. further, we require that there are no conflicts between reading frames generated by intersections with proteins.

 premature termination of translation 
it is known that transcripts containing premature stop-codons due, in particular, to spliceosomal errors, are degraded by a specific mechanism of nonsense-mediated decay   <cit> . as we have no criterion for distinguishing between functional and aberrant alternative splicing, we implemented a filter imitating the nmd action, requiring that the last exon-exon junction in an isoform were at most  <dig> nucleotides downstream its stop-codon. as above, this filter was not applied to protein-supported isoforms.

counting protein isoforms
to compute the number of protein isoforms, isoformcounter finds the number of all paths in the splicing graph and subtracts the number of paths not consistent with any known protein, see filter . the former value is computed in linear time  by dynamic programming. to compute the latter value, isoformcounter constructs a subset a of acceptor sites of protein-supported exons and exons that overlap the former in consistent reading frame. then the complement set a* of acceptor sites is determined, and the number of paths coming through a*  is calculated by dynamic programming. by definition, these paths are not consistent with any known protein.

computing the numer of alternative regions in the longest protein isoform
constitutive regions are exon fragments whose genome projections never overlap with introns or intergenic spacers. the procedures described above allow for segmentation of the longest protein isoform into constitutive and alternative regions so that only valid isoforms that have passed all filters are taken into account.

normalization procedure for est-derived exons and introns
the following model was considered. let α be the probability of splicing error , and let ξ be the expression level . we assume that ξ = f, where n is the observed number of ests. let p be the probability that the cell contains at least one aberrantly spliced transcript, p =  <dig> - ξ. then the probability that the error occurred in an interval supported by k clone libraries is pk ≤ β, where β denotes the significance level, that is, the probability with which we accept a splicing error. solving this inequality with respect to k, we obtain k ≥ ln / lnξ). we estimate the expression level as ξ = n/ <dig>  to estimate the probability of a splicing error, we considered losses of one or two sites corresponding to a protein-supported intron. the number of such events noverlap can be estimated as the number of ests which overlap the intron sites and are not spliced at these sites. this is an overestimate, as real alternative splicing events also are counted. further, let nsplice be the number of ests whose spliced alignment contain protein-supported introns. the probability of the spliceosome error was estimated as α = noverlap/ computed as  <dig> . note that one est could be counted both for noverlap and nsplice, so the above value could be an underestimate. finally, we used the following threshold on the number of clone libraries required to accept an exon : k = . exons and introns confirmed by alignment with mrna or protein are always accepted.

the restricted set of protein isoforms
for each gene in edas we constructed the restricted set of protein isoforms that are amino acid sequences are available at  <cit> . define isoform support as the minimum support of exons and introns forming the isoform. for each edge in the splicing graph  we construct the longest isoform passing through the edge, whose support is not less than the edge support. at each level of support, the restricted set consists of such longest isoforms for all edges of the given support.

analysis of alternative splicing in functional categories of genes
when isoformcounter was applied to all genes from edas, in  <dig> cases  no isoforms were found. this could happen in one of there cases.  protein-dna spliced alignment does not end at stop codon, and there is no downstream terminal exon where the induced reading frame contains a stop codon.  protein-dna spliced alignment does not start at methionine, and there is no upstream exon where the induced open reading frame contains an atg codon preceded by a stop codon .  protein-dna spliced alignment does not start at methionine and the candidate atg found by the algorithm is eliminated by the filter on translation initiation , or the alignment does not end at a stop codon, and the candidate stop codon is eliminated by the filter on premature termination of translation . the first and second cases are due to incomplete proteins where no candidate start or stop codon could be assigned. in the third case a start or stop codon could be assigned based on spliced alignment with incomplete protein and ests, but the obtained reading frame was eliminated by the filters. it may happen if the gene has an internal translation initiation site or a special mechanism to keep the isoform from the nmd degradation. in both cases algorithm needs an alignment with a complete protein. all these genes were ignored.

the obtained distribution of the isoform numbers is shown in fig.  <dig> . as it is known that the predicted number of isoforms may depend on the est coverage, we analyzed the dependence between the est coverage of a gene and the number of isoforms . the blue plot, corresponding to the initial  data demonstrates that genes with high est coverage  have a large number of isoforms . in particular, this tail contains many genes of ribosomal proteins , which seems to be an artifact. indeed, it is highly likely that the high expression level of a gene leads to appearance of relatively rare aberrant isoforms that are not seen for weakly expressed genes.

thus we believe that the threshold level of est support for exons and introns should depend on the est coverage of a gene, so that weakly and highly expressed genes could be comparable. red columns in fig.  <dig> show the number of isoforms with this more stringent threshold. the distributions with raw and normalized data do not differ much, but comparison of two plots in fig.  <dig> shows that normalization removes the dependence between est coverage and isoform number. one functional category strongly affected by the normalization procedure is "ribosome". further we consider results obtained after normalization.

most genes  have a relatively small number of isoforms . the number of genes with an even number of isoforms is higher than the number of genes with odd number of isoforms. indeed, the algorithm assumes independence of individual elementary alternatives, and thus the number of paths between two alternatives is roughly the product of the number of variants. moreover, most local alternatives preserve the reading frame. thus, to have an even number of alternatives, it is sufficient to have a frame-preserving local alternative with two variants . 23% of genes had only one functional isoform.

fig.  <dig> shows the distribution of the number of alternative and constitutive regions in the longest isoform. the fraction of genes not containing constitutive fragments at all is ~1%, which shows that the applied filters remove a considerable fraction of aberrant events. without these filters most genes would contain only alternative regions. the fraction of constitutive genes represented in fig.  <dig> is 24%, which is higher than the above estimate. it is caused by the fact that introns not overlapping with the longest isoform are not taken into account. the average number of all  fragments per gene is  <dig> .

we considered the link between protein function and the isoform number. the following functional categories from go were considered: "small gtpase-mediated signal transduction" , "catabolism" , "dna replication and chromosome cycle" , "ribosome" . significant differences from the distribution for all genes  were observed for "ribosome" and "small gtpase-mediated signal transduction" categories. both of them contain fewer than expected genes with a large number of isoforms. in particular, there are 46% constititutive genes in "ribosome", although to very high est coverage this is observable only after normalization . genes from the "dna replication and chromosome cycle" have more isoforms that the average . in particular, there is a higher fraction of genes with two or more isoforms. the distribution of the isoform number for genes from these categories is shown in fig.  <dig> 

of  <dig> human interaction pairs in the mppi database,  <dig> pairs were heterogeneous and different . locuslink information was available for  <dig> of these pairs, containing  <dig> proteins. of these proteins,  <dig> are encoded by genes from edas, and pairs with both members present in edas form  <dig> interacting pairs.

no correlation was observed between the number of contacts for a given protein and the number of isoforms or alternative regions . however, the probability to be alternatively spliced was higher for genes encoding proteins participating in at least one protein-protein interaction . this observation was significant for alternative splicing with all considered levels of support  at the level < <dig> –1% , although the difference between observed and expected numbers is not large . no significant correlations were observed for larger, but noisier non-curated protein-protein interaction datasets dip and ophid .

discussion and 
CONCLUSIONS
isoformcounter is a system of filters aiming at distinguishing functional isoforms from non-functional ones. unlike other programs for isoform generation  <cit>  it assumes independence of variants selected at elementary alternatives.

the prevalence of genes with a relatively small number of isoforms agrees with the observation of  <cit> , where all genes had less than  <dig> isoforms. on the other hand, the prevalence of genes with the even number of isoforms not observed in  <cit> , where the minimal number of isoforms required to explain all local alternatives was computed, as opposed to all isoforms. the fact that 73–77% genes had more than one isoform also is consistent with previous estimates: the fraction of single-exon human genes is 20%  <cit> , and, as the latter are not covered by edas, the fraction of alternatively spliced genes is approximately 60%   <cit> .

it has been reported that alternative splicing tends to affect genes involved in signal transduction  <cit> , although no estimates on the significance of these findings was done. we have also expected that there would be considerable differences between such go categories as "metabolism" and "signal transduction". however, this was not observed, probably because these categories are too large and contain many genes with diverse functions and properties. still, we observed significantly lower number of isoforms for genes from the "small gtpase-mediated signal transduction" 

the correlation between alternative splicing of genes and protein-protein interactions of encoded proteins was somewhat unexpected, especially given previously described lack of correlation between alternative and contacting regions  <cit> . further, although it has been reported that alternative splicing often targets domains involved in protein-protein interactions  <cit> , there was no increase in the rate of alternative splicing of such domains.

the effect observed here was not particularly strong , but still statistically significant, and was independent from the support level of alternatively spliced isoforms. on the other hand, the result crucially depended on the reliability of protein-protein interaction data: no correlation was observed for non-curated, large-scale experimental  or inferred  data.

