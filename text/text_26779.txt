BACKGROUND
among the eukaryotic pathogens whose genomes have so far been sequenced, the malaria parasite, plasmodium falciparum , posed the most technical challenges both in sequencing and assembly of the draft genome  <cit> . the biggest hurdle was the complexity of the genome, which is extremely base biased. the p. falciparum genome is very at-rich; coding regions have a mean at content of more than 75%, with up to 100% in intergenic and non-coding regions  <cit> . although biased base composition has been a challenge to the sanger sequencing methods, it has continued to be a major problem for the current high-throughput next-generation sequencing  technologies  <cit> . much work has focused on solving amplification and sequencing problems associated with high gc content but nothing has been done to improve on those caused by at-rich parts of the genome  <cit> . since completion of the malaria genome sequencing and the subsequent development of massively parallel sequencing technology, there has been increased effort in using genetic information obtained through re-sequencing initiatives to control and ultimately eliminate malaria . the wellcome trust sanger institute is currently using illumina ngs technologies to re-sequence thousands of clinical isolates from various malaria endemic regions, mainly sourced from africa and asia. re-sequencing of these samples has faced two major challenges: low mass of total parasite dna and extremely high at-base composition of the genome. these problems pose major technical challenges predominantly in the library preparation stage of the ngs pipeline and also in subsequent data analysis. due to extreme at bias, standard illumina library preparation procedures produce libraries with poor representation that are generally low in complexity compared to the genomic dna from which they were derived. polymerase chain reaction  amplification conditions as currently used in the standard library preparation procedures, have been shown to introduce biases in sequence coverage towards dna regions with balanced base composition <cit> . furthermore, genomic regions with high at or very high gc content generally result in little or no amplification at all. these pcr-introduced artifacts have been shown to cause misleading or inaccurate conclusions in the analysis of genome-variation data  <cit> .

attempts have been made to overcome coverage problems associated with pcr amplification by omitting the pcr step in library preparation <cit> . although the pcr-free approach has improved read distribution and produced more even genome coverage, it requires large amounts of starting dna material, which is difficult to obtain especially from clinical isolates. the low mass of dna in clinical isolates demands some form of amplification to generate sufficient quantities for an illumina library preparation. we have therefore investigated various amplification possibilities and developed library-preparation procedures that are optimal for extremely at-rich genomes using the illumina sequencing platform.

here we report alternative library-amplification procedures optimized for at-rich templates and suitable for low mass dna starting material especially from malaria clinical isolates. we have tested various library amplification methods including linear and isothermal amplification strategies. we have also explored various pcr amplification conditions by testing different polymerases, and their tolerance to at-rich templates, in the absence or presence of tetramethylammonium chloride , a pcr additive that increases thermostability of at base pairs  <cit> .

RESULTS
conventional pcr amplification of an at-rich locus
in order to identify polymerases and pcr conditions that are efficient and tolerant to high at content templates, we performed conventional pcr using commercial enzymes. the pcr was targeted at a  <dig> bp locus  with a high at-content  and a  <dig> bp locus  with a relatively balanced base composition  from the p. falciparum 3d <dig> genome http://www.plasmodb.org <cit> . pf_ <dig> and pf_11_ama <dig> oligo pairs  were used to amplify the high at-rich and positive control fragments respectively. for each enzyme, two sets of pcrs were performed, one using reagents and conditions provided by the manufacturer  and the other deviating only by inclusion of  <dig> mm tmac in the reaction mixture . tmac is a dna-binding reagent that has been shown to increase the melting temperature of at base pairs, thereby improving thermostability of the at-rich regions during pcr amplification. although in the presence of 3m tmac, the thermostability of at base pairs is equal to gc base pairs, this concentration is also inhibitory to polymerase activity. it has been shown that low concentrations of tmac  improve at base pair stability and result in increased specificity and yield of pcr products  <cit> . as shown in figure  <dig>  most enzymes tested were able to amplify the relatively balanced base composition fragment in the absence of tmac additive, although with different efficiencies. the presence of tmac inhibited the activity of most enzymes except for kapa hifi, kapa2g robust and platinum pfx, where the additive had a positive effect in amplifying the base-balanced region. at the extreme at-rich region, nearly all of the enzymes tested were unable to produce detectable amplification either in the presence or absence of tmac additive. accuprime taq hifi and phusion enzymes produced low but detectable amplification of the test region only in the absence of tmac. however, kapa hifi and kapa2g robust were the only enzymes that showed efficient amplification of the at-rich locus in the presence of tmac additive. interestingly, the two kapa enzymes did not produce detectable amplification of this locus in the absence of tmac, which demonstrates the effect of tmac on an at-rich template. pcr amplification of the two test loci were performed at least twice for each enzyme tested and in each case the same results were obtained. enzymes and pcr conditions that showed some level of amplification of the at-rich locus were used to amplify genomic libraries for illumina sequencing. we analyzed the sequence data to assess suitability of each polymerase and conditions for amplification of at-rich libraries.

pcr amplification of illumina genomic libraries
although phusion polymerase is the standard enzyme for illumina sequencing library amplification, it produces libraries with poor representation of loci with extreme base composition particularly the at-rich regions  <cit> . in our screening above, many enzymes failed to show efficient amplification of the test locus and were clearly intolerant to at-rich templates. we evaluated the efficiency of genomic library amplification using polymerases that showed some tolerance to the at-rich template. we tested phusion, accuprime taq hifi, platinum pfx, kapa2g robust and kapa hifi. we used these enzymes to amplify pe adapter-ligated genomic libraries made from malaria parasite clinical isolate and the reference strain p. falciparum 3d <dig>  in the presence of tmac, accuprime taq hifi and phusion produced undetectable amplifications that were not processed further. however, alternative amplification conditions produced high amplification yields , that were sequenced and analyzed. all sequence data sets generated were normalized to average coverage before analysis. two data sets were generated in parallel: one from a lab-cultured parasite  genomic dna; and the other one from p. falciparum clinical isolate containing ~53% host dna contamination. sequence data from the clinical isolate were filtered to remove host contamination before analysis resulting in lower coverage depths compared to those from 3d <dig>  to analyze and compare the data generated under optimized conditions against standard procedures, we developed analysis metrics that assess four aspects of data quality: evenness of coverage depth metrics was used to analyze the distribution of coverage depth for each library across the entire genome and plot results of multiple data sets in a single graph for comparative analysis; gc content analysis was used to compute the average gc content for each library and assess base-composition biases; tolerance metrics was used to assess representation of extreme base-composition loci, focusing on selected regions; and fidelity metrics was used to assess enzyme-dependent amplification errors.

using these metrics, we show that libraries prepared under standard conditions  produced less even coverage compared to the optimized conditions in both 3d <dig> and the clinical isolate. as shown in figure 2a &2b, up to 30% of the genome was covered at depths of ≤10× for 3d <dig> and ≤5× for clinical isolate in phusion-amplified libraries. in contrast libraries amplified under optimized conditions had most of the genome covered at high depths and only <10% of the genome covered at depths ≤10× and ≤5× for 3d <dig> and clinical isolate respectively. libraries prepared under standard conditions also showed strong bias towards the gc-rich templates as shown by a shift in average gc content from ~ <dig> %  towards gc neutral base composition . table  <dig> shows the average gc content for each amplification condition tested. to illustrate this further, we used artemis  <cit>  to view mapped reads on chromosome  <dig> and assess coverage depth distribution with respect to base composition as depicted by a gc content plot . we show that under standard conditions, high gc content regions across chromosome  <dig> including telomeres were over-amplified whereas regions of high at content were under-amplified. on the other hand kapa hifi amplification was close to that of a pcr-free library in coverage of either extremes of base composition.

calculated values of average gc content corresponding to each library preparation. deviation from the  <dig> %  indicates the effect of amplification bias. see figure  <dig> a & b for a global graphical presentation of the gc content distribution. 3d <dig>  p. falciparum strain 3d7; pk <dig>  p. falciparum clinical isolate.

we also assessed coverage across chromosome  <dig> and then focused on specific regions of balanced gc content, high at content and variable base compositions. a box plot showing variation in depth coverage for both p. falciparum strain 3d <dig> and the clinical isolate is shown on figure 4i & ii respectively. in these analyses, we observed relatively even coverage depth across the base-balanced region  by all the enzymes and conditions tested . however, large variations in coverage depths were observed across the at-rich and the variable base composition loci . although most enzymes showed more consistency in coverage depth than phusion, kapa hifi produced the best coverage at the at-rich regions with evenness almost matching that of pcr-free library. at this at-rich locus in 3d <dig> , 75th and 25th percentiles of base coverage depths by both kapa hifi libraries produced ~18× and 13× coverage respectively. on the other hand 75th and 25th percentile of base coverage depth by both phusion libraries produced ~13× and 3× coverage respectively. the wider gap in coverage depth distribution by phusion-amplified library indicates uneven and poor coverage of at-rich regions. for all conditions, coverage of positions 29092- <dig>  was generally very low and inconsistent in the clinical isolate  d) compared to 3d <dig>  d), perhaps due to the antigenic variation phenomenon associated with these genes. overall, we show that our optimized conditions improve the quality of coverage in both clinical and non-clinical samples.

isothermal exponential amplification of illumina genomic libraries using rpa technology
high extension temperatures in conventional pcr procedures have been associated with bias and other negative effects on high at content libraries. we therefore assessed the suitability of an isothermal exponential amplification method provided by the recombinase polymerase amplification  technology  <cit> . rpa uses recombinase enzymes which bind oligonucleotide primers  to form nucleoprotein filaments that stimulate searching for homologous sequences in a duplex-dna template. the primer-recombinase complex is able to attach to the homologous dna duplex and facilitate strand exchange, eliminating the need to denature the template as in pcr. disassembly of the recombinase allows strand-displacing dna polymerase to begin primer extension from the 3' end. two opposing oligonucleotide primers initiate an isothermal exponential amplification through automatic cyclic repetition of this process. we used rpa technology  with illumina pe primers to amplify adapter-ligated libraries before sequencing. we obtained a relatively high yield of rpa-amplified library compared to t <dig> libraries . analysis of sequence data obtained from rpa-amplified libraries showed reduced bias towards gc rich templates compared to standard illumina libraries for both p. falciparum 3d <dig> and the clinical isolate . coverage of extreme at base-composition loci was however inferior to kapa enzymes . furthermore, rpa amplified libraries showed relatively high levels of chimeric and duplicate reads .

linear amplification of illumina genomic libraries using t <dig> rna polymerase
exponential amplification of sequencing libraries is thought to be the source of biases and artifacts. to avoid this, we explored a recently described linear amplification for deep sequencing  protocol  <cit> . lads uses t <dig> rna polymerase to transcribe dna fragments bearing a t7-promoter sequence at the 5' end. this is an in-vitro transcription system whereby the t <dig> rna polymerase transcribes a dna fragment multiple times producing several rna transcripts under isothermal conditions and resulting in a linearly amplified template. the resulting rna material is then converted to cdna using a reverse transcriptase. we sequenced the t <dig> polymerase-amplified libraries and analysed the quality of the data generated using our analysis metrics. the overall yield of the library generated using the lads protocol was very low compared to those amplified exponentially . however, coverage of extreme base-composition loci was better than standard illumina libraries. libraries produced under optimized pcr conditions were generally superior to the lads protocol  in coverage of at-rich loci for both p. falciparum 3d <dig> and the clinical isolate . surprisingly, an over-representation of fragments with high gc content was observed in t7-amplified library when viewing sequence reads aligned to the reference genome using artemis  <cit>  . t <dig> polymerase-amplified libraries were also associated with the highest level of duplicate and chimeric reads .

effect of tmac on illumina genomic library amplification
tmac has been shown to improve thermostability of at-base pairs  <cit> . however, it inhibits the activity of most polymerases. in our analysis, phusion and accuprime taq hifi were inhibited by tmac and produced no library amplification . on the other hand platinum pfx and the kapa enzymes were tolerant to the concentration of tmac used in this assay . we analyzed and compared libraries prepared with kapa enzymes in the presence and absence of tmac. our analysis indicates that the overall evenness in coverage across the genome was significantly improved in the presence of tmac . we observed less bias towards gc rich sequences and an overall improved coverage on at-rich regions. all amplification data shown for kapa hifi, kapa2g and platinum pfx in figures  <dig>   <dig> and  <dig> were performed in the presence of tmac. the positive effect of tmac was observed in both p. falciparum 3d <dig> and the clinical isolate .

fidelity and coverage ranking
we analyzed the accuracy of each enzyme in terms of base incorporation by counting mismatches and indels at regions of low complexity . at these regions of low complexity, rpa generated the least number of errors  whereas t <dig> polymerase had the highest . kapa hifi showed a relatively low mismatch score which was largely due to high number of insertions observed at tata repeat regions where most of the enzymes tested showed little or no coverage. enzymes were also scored on evenness of coverage depth by counting the number of regions with zero and less than 5× base coverage. based on these criteria, phusion had the highest number of regions with zero and <5× coverage, thereby scoring poorest. kapa hifi had the best coverage score after pcr-free. finally, we calculated the overall fidelity and evenness of genome coverage and ranked each amplification condition based on average overall score. as shown in table  <dig>  libraries amplified by kapa hifi came second to pcr-free, whereas phusion polymerase had the lowest overall score .

ranking was based on genome coverage and accuracy. coverage score: pcr-free and kapa hifi had the lowest percentage of genome covered at  <dig> or <5× thereby scoring the highest. mismatch  score: loci of low complexity were used to generate mismatch ranking . the number of true positive mismatches, false positive mismatches, deletion and insertions obtained for each library were used to generate a score before combining all scores to generate an overall mismatch rank. using these criteria, rpa produced the highest score and t <dig> scored the least. see additional file  <dig>  table s <dig> for raw ranking data.

discussion
library amplification is an important step in preparing samples for sequencing with the current ngs platforms, especially when the starting material is severely restricted in quantity. pcr amplification, however, has been shown to be the major source of artifacts and base-composition bias in library fragments. although alternative library-preparation approaches that omit the pcr amplification show a significant reduction in base-composition bias, this strategy requires large quantities of starting material. therefore, pcr-free library preparation is unsuitable where amounts of dna starting material are limited, as is the case with most clinical isolates.

we demonstrate that problems associated with pcr can be ameliorated through optimization, thereby allowing amplification to be used in generating sequencing libraries even from extremely at-biased genomes. through careful selection of polymerases and the use of a pcr-additive that normalizes melting temperatures of the different library fragments, we have optimized illumina library amplification. these alternative pcr conditions generate library fragments with increased coverage of extreme at-rich regions.

standard illumina amplification procedures that use phusion polymerase generate libraries with biased base-composition and are depleted of at-rich loci. the sequence data generated under these standard conditions are of reduced complexity and maybe unsuitable for resequencing to identify relatively rare genetic variants of important biological function. we set out to solve this problem by focusing on the library amplification step, which is the primary source of biases in almost all ngs platforms. we started by screening commercially available polymerases for tolerance to an extremely at-rich template. this initial screening procedure identified a preferred polymerase and amplification conditions that showed improved tolerance to at-rich templates. we demonstrated that most commercial polymerases are inhibited by tmac. however, this chemical can have a tremendous positive effect in amplifying at-rich templates for the tmac-tolerant enzymes. with tmac additive we have developed illumina library-amplification protocol suitable for extreme at-rich genomic dna. quality analyses of sequence data from both p. falciparum 3d <dig> and a clinical isolate generated by our optimized conditions showed less bias towards base-balanced regions and produced an average gc content that matches that of the unamplified genome.

to date, no single polymerase or amplification method has been shown to efficiently amplify both extremes of base composition with equal and optimum efficiency. the two isothermal amplification methods  tested here showed some level of improved coverage relative to standard amplifications, but they were both associated with high levels of chimeric and duplicate reads. under the optimized conditions we show that the kapa series of polymerases in the presence of tmac produced the best coverage that was relatively consistent across regions of extreme base composition. worthy of note is the low template-dependent fidelity score for kapa hifi , where we detected a number of false-positive insertion calls mainly in regions of tata repeats. other enzymes had zero or extremely low coverage in these regions, limiting our ability to perform accurate comparative analysis on enzyme's fidelity at very low complexity regions.

CONCLUSIONS
despite the bias problem associated with it, pcr still remains an essential step in many ngs library preparation procedures, especially when the starting dna material is limited. we describe robust alternative pcr conditions optimized for extremely at-biased genomes. we show that the optimized conditions significantly reduce bias and also retain the complexity of either extremes of base composition. this observation was consistent in both the lab-cultured strain  and the clinical isolate. the optimized procedures described here will greatly benefit the malaria genomic research and control initiatives that have faced serious challenges with the parasite's extreme at-rich genome.

