BACKGROUND
streptococcus suis is a major swine pathogen responsible for severe economic losses to the porcine industry, and an emerging zoonotic agent of disease  <cit> . s. suis strains are typed based on a serological reaction against the capsular polysaccharide , whose biosynthesis machinery is encoded by genes located in the cps locus  <cit> . thirty-five different s. suis serotypes were originally described   <cit> . however, serotypes  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> have recently been shown or hypothesized to belong to novel bacterial species  <cit> . therefore, the s. suis species currently comprises a total of  <dig> serotypes. accurate s. suis serotype identification is of significant epidemiological importance for the control of swine infections, since different serotypes are prevalent in different parts of the world  <cit> . although it is widely considered the gold standard for typing, serology is expensive and time-consuming, and can only be performed at select reference laboratories. in addition, serology cannot readily discriminate between serotypes  <dig> and 1/ <dig>  or between serotypes  <dig> and  <dig>  which cross-react on the coagglutination test  <cit> . recently, elaborated pcr schemes targeting the cps locus permitting rapid “serotyping” of s. suis strains were described  <cit> . however, due to the similar gene content of their respective cps loci, these pcr schemes do not differentiate between serotypes  <dig> and 1/ <dig>  and between serotypes  <dig> and  <dig>  <cit> . accurately distinguishing between serotypes  <dig> and 1/ <dig>  as well as between  <dig> and  <dig>  is important since, based on current data, serotypes  <dig> and  <dig> are heavily associated with zoonotic disease  <cit> .

recent advances in whole-genome sequencing  technologies now permit the sequencing of hundreds of bacterial genomes rapidly and relatively inexpensively. wgs approaches are revolutionizing microbial typing in both the human and veterinary fields, and enhancing public health objectives such as disease surveillance, epidemic investigation and infection control . in addition to typing, wgs data analysis permits rapid identification of known and putative virulence factors present in the genomes of the strains of interest  <cit> . here we report the development of a user-friendly bioinformatics pipeline running on the linux operating system that combines available free software, and which can be used for rapid determination of s. suis serotype directly from the short-read wgs data. the pipeline correctly discriminates between all 29 s. suis serotypes, and permits to differentiate between serotypes  <dig> and  <dig>  and between serotypes  <dig> and 1/ <dig>  the pipeline also uses the short-read wgs data to determine strain multilocus sequence typing  sequence type  and virulence factor content.

methods
whole-genome sequencing
we sequenced the genomes of 121 s. suis strains belonging to  <dig> different serotypes . the strains used in this study have not been collected specifically for this study. they were part of the author’s extensive collection of clinical isolates. serotyping was performed using the coagglutination test as previously described  <cit> . strains were grown overnight in todd-hewitt broth  supplemented with  <dig>  % yeast extract at 37 °c with 5 % co <dig>  dna was prepared using the qiaamp dna minikit  following the manufacturer’s protocol for gram-positive organisms. genomic libraries were prepared using nextera xt kits  and sequenced as paired-ends using either a hiseq  <dig>  or a miseq  instruments . generated data was deposited in the sequence read archive  under the accession numbers provided in additional file 1: table s <dig> 

capsular typing pipeline
our pipeline automates the execution of software that aligns wgs short-reads to custom or available s. suis sequence databases and permits subsequent sequence comparisons. briefly, the nucleotide sequence of gene recn, which is unique to the s. suis species  <cit> , was retrieved from the genome of s. suis serotype  <dig> strain nsui <dig> , and included as s. suis species control. short-read wgs data were then aligned to the recn sequence using the program srst <dig>  a software originally conceived as a means to derive mlst information from bacterial short-read wgs data  <cit> . however, srst <dig> can be used to derive any typing information of interest if an appropriate sequence database is provided, as exemplified by reported pipelines permitting emm typing of group a streptococcus from short-read wgs data  <cit> . we next created a s. suis cps database by first downloading from genbank sequences corresponding to each of the 27 s. suis cps loci differentiable by a multiplex pcr . serotype specific cps loci regions were defined using in silico pcr and the primer sequences described in a multiplex pcr assay designed to differentiate s. suis serotypes  <cit> . specific sequences for serotype defining amplicons were extracted using custom scripts. after species confirmation, our pipeline uses srst <dig> to align short-read wgs data to the abovementioned cps database and makes an initial serotype assignment. serotype pairs  <dig> and  <dig>  and  <dig> and 1/ <dig> cannot be identified directly using srst <dig> . therefore, to resolve these ambiguous results, our pipeline next uses custom scripts that identify single-nucleotide polymorphisms in the cps2k gene of every strain identified as a putative serotype  <dig> or  <dig>  or as putative serotype  <dig> or 1/ <dig>  followed by translation of the amino acid sequences for each strain. based on the amino acid present at position  <dig> of the predicted translated sequence of the cpsk gene, the pipeline assigns the final serotype for the strain.

sanger sequencing of the cpsk locus
in order to confirm findings for the differences in the cpsk gene, we amplified a fragment of interest from dna of  <dig> additional serotype 1/ <dig> strains using primers cpsk-f  and cpsk-r , followed by sanger sequencing of the generated amplicon using the same primers.

mlst, virulence marker gene content, and validation of the pipeline
the s. suis mlst database was downloaded from the s. suis mlst website available at ssuis.mlst.net. sequence types  were determined directly from the short-read wgs data using srst <dig>  <cit> . the sequences of virulence marker genes epf, sly, and mrp were compared between multiple strains, and conserved subsequences were extracted. the presence or absence of these virulence factors was determined based on short-read alignment to these conserved sequences using srst <dig>  pipeline partial outputs  were then combined in a final output file. to validate our pipeline, previously generated wgs short-read data for 367 s. suis strains were downloaded from the sra .

RESULTS
species confirmation
we sequenced the genomes of 121 s. suis strains representing  <dig> different serotypes. the coverage across the genome was on average 56x, considering an average s. suis genome size of  <dig>  mbp . an overview of our pipeline is presented in fig.  <dig>  essentially, the pipeline uses srst <dig>  <cit>  to align the short-read wgs data to various databases that are modifiable. in a first iteration, short-reads are aligned against the sequence of the gene recn. all  <dig> strains were positive for this gene. although the specificity of this gene for the s. suis species has been verified extensively  <cit> , here we assessed recn specificity using short-read wgs generated in our laboratories for  <dig>  strains of streptococcus agalactiae, streptococcus pyogenes, streptococcus pneumoniae, streptococcus pluranimalium, streptococcus porcinus, actinobacillus pleuropneumoniae and listeria monocytogenes. none of the genomes of the strains of these species were recn positive .fig.  <dig> schematic of the s. suis serotyping pipeline. the pipeline takes in s. suis wgs reads in fastq format and first confirms that the isolate belongs to the species s. suis by aligning reads to the gene recn using srst <dig> software. once species has been confirmed, srst <dig> is invoked in three parallel instances to identify serotype, mlst information, and virulence gene content using provided databases. the serotyping component cannot differentiate between serotype  <dig> and serotype  <dig>  or between serotype  <dig> and serotype 1/ <dig> without additional comparison of the sequences of the cps2k gene . final serotype determination results are then combined with mlst and virulence results to provide the user a single output file



capsular typing from short-read wgs
next, our pipeline aligns short-read wgs data to a custom cps database. the cps database is constructed based on expected amplicons defined by kerdsin et al.  <cit> . since this database cannot differentiate between serotypes  <dig> and  <dig> or between serotypes  <dig> and 1/ <dig>  it represents  <dig> of the currently accepted 29 s. suis serotypes. at this step, our pipeline is also unable to discriminate between these two serotype pairs. a total of  <dig> strains were assigned a serotype, or putative serotype in the case of the abovementioned serotype pairs by short-read alignment to the custom cps database . one strain, typed by coagglutination as serotype  <dig>  was not assigned a serotype by our pipeline, i.e., it was designated as “non-typable”. to investigate this unexpected result, we manually inspected the bam file containing the alignment of the reads of this strain to the cps <dig> locus. manual inspection revealed several areas of very low short-read coverage. alignment of reads of this strain to de novo genome assemblies for other serotype  <dig> strains generated using the a <dig> pipeline  <cit>  revealed that coverage across the genome of this non-typable strain was uneven , and some areas of the cps <dig> locus had a coverage depth of 1x . the program srst <dig> requires, by default, a read coverage of at least 3x in order to identify an allele  <cit> . thus, this result exemplifies one limitation of our pipeline, which is that adequate and even short-read coverage is necessary to confidently identify serotypes. resequencing of the genome of this isolate permitted us to reach a coverage of  <dig> x. with these novel data, the pipeline correctly assigned the isolate to serotype  <dig>  as a general rule, we recommend that users of our pipeline generate wgs data with an across-genome read coverage of at least 30x, which is in accordance with the american college of medical genetics and genomics recommendations for the use of next-generation sequencing in clinical laboratories  <cit> . alternatively, in cases where a serotype is not assigned, expert users that have low coverage samples for which a positive recn result is obtained could manually inspect the bam files reporting alignment to each type-specific cps sequence before concluding the strain is non-typable.table  <dig> serotype determination using the s. suis serotyping pipeline


an/a: not applicable; at this stage serotype 1/ <dig> strains are presumptively assigned to serotype  <dig> and serotype  <dig> strains are presumptively assigned to serotype 1


ball six serotype  <dig> strains were assigned to serotype  <dig> by our pipeline after resequencing of the genome of one serotype isolate whose genome had originally been sequenced at low read coverage due to technical issues during genomic libraries preparation



differentiating between serotypes  <dig> and  <dig> and between serotypes  <dig> and 1/2
genetic studies have shown that the cps loci of s. suis serotypes  <dig> and  <dig> have exact gene content  <cit> . similarly, the cps loci of serotypes  <dig> and 1/ <dig> strains have the same gene content  <cit> . we hypothesized that differences exist at the single-nucleotide level in the cps loci of those pairs of serotypes, and that those differences permit to resolve each serotype pair into individual types. to test the initial hypothesis, we de novo assembled the short-reads of all  <dig> isolates of each of these serotypes included in our collection using the a <dig> pipeline  <cit> . the de novo assemblies were screened to identify each cps loci, which were then aligned using clustalw  <cit>  and interrogated for polymorphisms unique to each serotype. the analysis revealed that all serotype  <dig> and all serotype  <dig> strains had a g nucleotide at position  <dig> of the cpsk gene, while all serotype  <dig> and all serotype 1/ <dig> strains contained either a c or t at that nucleotide position. thus, the predicted sequence of the cpsk protein in serotypes  <dig> and  <dig> possess amino acid tryptophan at position  <dig>  while the predicted sequence of the cpsk protein in serotypes 1/ <dig> and  <dig> has amino acid cysteine at this position . the genome sequence of a serotype 1/ <dig> strain from china has been published  <cit> . when we examined the reported sequence of the cpsk gene of this chinese strain , we did not find the abovementioned polymorphism, i.e., the cpsk gene of the chinese strain has a g nucleotide at position  <dig> resulting in a tgg codon. since this reported cpsk sequence raises concerns about the universality of the polymorphism permitting differentiation of serotypes  <dig> and 1/ <dig> identified in this study, and in order to study the issue in more detail, we performed sanger sequencing of the cpsk gene of  <dig> additional serotype 1/ <dig> strains recovered in canada. in agreement with our genomic findings, sanger sequencing identified that the cpsk gene of these additional serotype 1/ <dig> strains contained a t nucleotide at position  <dig>  moreover, when we used external wgs data to validate our pipeline , none of the  <dig> genomes of serotype 1/ <dig> strains reported in a previous publication  <cit>  had a cpsk gene sequence similar to the serotype 1/ <dig> chinese strain, but, instead, they had one of the polymorphisms described here. cpsk is a glycosyltransferase predicted to add galactose  or n-acetylgalactosamine  to the polysaccharide chain . we speculate that the polymorphism at amino acid position  <dig> of cpsk is critical in defining the sugar that this enzyme recognizes. using targeted mutagenesis , we have very recently been able to switch the capsular polysaccharide from  <dig> to 1/ <dig> in a serotype  <dig> strain. conversely, after inverting the substitution, i.e. c to w substitution, we transformed a serotype 1/ <dig> strain into a serotype  <dig> strain . we thus believe that either the reported genome sequence of the chinese serotype 1/ <dig> strain contains an error in the cpsk gene sequence or that the strain was misidentified as serotype 1/ <dig> when it is, in fact, serotype  <dig>  unfortunately, short-reads for the chinese strain are not available to confirm this speculation.fig.  <dig> schematics of cps loci and identification of a single-nucleotide polymorphism permitting differentiation of the s. suis serotypes  <dig> and  <dig>  and  <dig> and 1/ <dig>  the cps loci of serotypes  <dig> and  <dig> are identical in gene content , as are the cps loci of serotypes  <dig> and 1/ <dig> . however, analysis of all available serotype  <dig>   <dig>   <dig> and 1/ <dig> strains in our collection revealed that serotype  <dig> strains consistently differed from serotype  <dig> strains, and that serotype  <dig> strains consistently differed from serotype 1/ <dig> strains by a single-nucleotide change  in the cpsk gene, which is predicted to result in an amino acid change from tryptophan to cysteine. our pipeline uses this amino acid change to differentiate between those otherwise unresolvable serotype pairs and assign the serotype to the strain under investigation. red bars indicate regions used in the first step of the pipeline to differentiate serotypes  <dig> and  <dig> as well as serotypes  <dig> and 1/ <dig> from other serotypes



our pipeline takes advantage of the abovementioned polymorphisms in cpsk to discriminate between these otherwise unresolvable pairs of serotypes. briefly, after alignment to the custom cps database, the pipeline assigns a presumptive label of “serotype 1” to the potential pair 1– <dig> and a presumptive label of “serotype 2” to the potential pair 2-1/ <dig>  next, it invokes a second mapping step, which by aligning short-reads of the strain under investigation to cps2k sequences, identifies snps and outputs the predicted amino acid sequence of cpsk. this amino acid sequence is then scanned for the presence of a tryptophan or a cysteine amino acid residue at position  <dig>  a final serotype assignment  is then made based on the predicted translated codon. using this second step, our pipeline matched coagglutination results in  <dig> cases .

validation of the pipeline with external datasets
next, we sought to validate our pipeline using available wgs datasets generated by others  <cit> . to this end, we downloaded from the sra wgs short-read data for 375 s. suis strains. of them,  <dig> represented  <dig> serotypes , whereas  <dig> strains had been described as non-typable by serology  <cit> . based on the presence of serotype specific sequences, we were able to assign a serotype to  <dig> of the  <dig> non-typable strains using our pipeline. it must be noted, however, that serotype assignment by our pipeline cannot predict whether a strain actually expresses capsular material. as reported previously  <cit> , mutations in cps loci genes, which occur frequently and which our pipeline is not designed to detect, as well as insertion of mobile genetic elements in the cps locus of any given s. suis strain, may lead to the absence of capsule expression. however, serotype determination of unencapsulated strains is useful to understand a variety of strain traits, including their origin and evolutionary path. the remaining eight strains present in the external collection that were reported as non-typable  <cit>  did not match any of the sequences in our cps database, and thus were also identified as non-typable by our pipeline. the genomes of these eight strains were de novo assembled and blastn comparisons against the reference sequences of all  <dig> cps loci were carried out. we were unable to identify homology to any of the  <dig> cps loci. thus, we conclude that these eight strains may represent novel s. suis serotypes.

our pipeline and previously reported serotyping results  <cit>  agreed in  <dig> of the  <dig> strains in the external collection . we examined the  <dig> mismatched isolates by manual inspection of bam files containing the short-read data alignments to each of the specific cps regions defining serotypes in our database. the analysis revealed very poor short-read alignment to sequences for the loci encoding the previously reported serologically-determined serotypes  <cit> . on the other hand, in  <dig> out of these  <dig> cases, bam inspection revealed very good coverage relative to the serotype-specific sequences corresponding to the serotype identified by our pipeline. however, in  <dig> cases, bam file examination did not show good alignments to any of the sequences in the database. to unambiguously determine the quality of our pipeline results, wgs short-read data for these  <dig> strains were de novo assembled and local blastn comparisons were performed to identify the cps loci of the strains. in  <dig> cases, the strains had the cps loci expected for the serotype identified by our pipeline , and not the one expected based on the reported serological results  <cit> . the remaining four strains were identified as non-typable by our pipeline. we were unable to assign any of these four strains to any known s. suis serotype based on blastn comparisons to known cps loci of the de novo assemblies . therefore, we conclude that these  <dig> strains are bona fide nontypable s. suis strains, while the  <dig> other strains had been mistyped by the serological method used to ascertain their serotype  <cit> .

mlst determination and virulence factor content
using the mlst database for s. suis, our pipeline next invokes srst <dig> to determine the mlst sts of each strain . the vast majority of the strains were assigned to known sts already described in the s. suis mlst database, but we also identified  <dig> novel sts. our pipeline was also used to determine presence or absence of virulence factors . the virulence factor database provided with our pipeline was designed as a proof of principle, and only screens for conserved regions of mrp, epf and sly genes, encoding a muramidase-released protein, an extracellular protein factor, and a hemolysin known as suilysin, respectively . users may add any virulence gene of interest to the pipeline virulence database. results are presented in additional file 1: table s <dig>  our virulence results for mrp, epf and sly matched those described in previous studies in serotypes  <dig>  1/ <dig>   <dig>   <dig>   <dig>  and  <dig>  <cit> , which so far have been studied in a more consistent fashion than other s. suis serotypes.

CONCLUSIONS
serotyping of s. suis strains is crucial to infection control efforts and to reduce the possibility of zoonotic disease outbreaks  <cit> . the need to accurately differentiate between serotypes  <dig> and  <dig>  and between serotypes  <dig> and 1/ <dig> is emphasized by the zoonotic potential of serotypes  <dig> and  <dig>  <cit> . here, we show that wgs short-read data, which now can be generated rapidly and relatively inexpensively for large numbers of strains, can be used to precisely identify the serotype of s. suis strains, as well as to obtain other relevant strain information in an automated fashion. one limitation of our pipeline, which is common to previously reported multiplex pcr tests targeting the cps locus  <cit> , is that we only analyzed one or a few representative strains of rare serotypes such as  <dig>   <dig>   <dig>   <dig>   <dig>  analysis of a more important number of strains of these rare serotypes, when they become available, should increase the confidence in a pipeline positive result for these serotypes. importantly, our pipeline can differentiate with high accuracy between serotypes  <dig> and  <dig>  as well as between serotypes  <dig> and 1/ <dig>  which cannot be resolved by available multiplex pcr assays, or which require multiple serological reactions using specific antisera available only at a few selected reference laboratories worldwide. compared to serology, one limitation of our wgs approach is that it does not identify whether a strain actually expresses a capsule. however, insights gained by determining the cps locus type of serologically non-typable strains are important for phylogenetic and evolution purposes. as demonstrated here when validating our pipeline with external data, it is not uncommon that s. suis isolates are mistyped using serological assays. thus, using our pipeline reduces the variability introduced by different personnel performing such serological tests. if strains must be confirmed by using serological means, our pipeline can pinpoint the specific serotype that needs to be tested, thus saving time and money by eliminating the need for multiple serological reactions. the pipeline is open source and available for download from https://github.com/streplab/ssuisserotyping_pipeline.

abbreviations
cps, capsular polysaccharide; mlst, multi-locus sequence type; pcr, polymerase chain reaction; snp, single nucleotide polymorphism; sra, sequence read archive; srst <dig>  short read sequencing typing version 2; st, sequence type; wgs, whole genome sequencing

additional file
additional file 1: 
s. suis strains used in this study; serotypes and accession numbers for reference capsule type sequences used in this study; information and pipeline results of s. suis strains downloaded from the sequence read archive and comparison of cps loci of selected s. suis strains this supplementary file contains: 1) three supplementary tables, 2)  <dig> supplementary figures. 



