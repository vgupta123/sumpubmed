BACKGROUND
comparative analysis of orthologous dna has revealed that many cis-regulatory enhancers contain multi-species conserved sequences  that are essential for their transcriptional regulation . we have previously described evoprinter and cis-decoder, both web-accessed tools for discovering and comparing conserved sequences that are shared among three or more orthologs  <cit> . generated from superimposition of multiple pair-wise blat alignments  <cit> , an evoprint provides an ordered uninterrupted representation of conserved sequences as they exist in the genome of interest. when multiple species are included in the analysis, near base-pair resolution of conserved sequences required for gene function can be achieved. for example, when  <dig> drosophila species, representing ~ <dig> million years of cumulative evolutionary divergence, are included in the evoprint process, one can identify sequences that are essential for cis-regulatory function , conserved protein encoding sequences, and micro-rna binding sites. evoprinterhd is a second-generation alignment tool that automates the comparative analysis to rapidly identify a significantly higher percentage of conserved sequences shared among evolutionarily distant orthologs even if they exist within rearranged dna. in contrast to most comparative multi-sequence alignment tools , which display columns of sequences that contain gaps to optimize alignments, the species-centric evoprint is a single uninterrupted sequence and thus displays more bases in a single view than is possible with conventional alignments. in addition, the uninterrupted readout allows for the rapid extraction and automated curation of conserved dna from the genome of interest.

at the core of the original multi-genome evoprinter alignment algorithms is the blat algorithm  <cit>  for pairwise alignments. although blat alignments generate uninterrupted representations of the aligning regions, one drawback of blat when performing alignments of evolutionarily distant dnas, as initially noted by kent  <cit> , is that short regions of homology that span the non-overlapping 11-mers go undetected. we developed eblat to overcome the inability of blat to detect these short blocks of homology. to accomplish this, each genome is indexed three independent ways, each staggered differently; additionally, the alignment parameters have been adjusted to enhance the detection of short blocks of sequence conservation. by performing three independent alignments using the staggered indices with the optimized alignment parameters and then superimposing the resulting alignments to show all aligning sequences, the overall detection of conserved sequences has been improved by as much as 75% when evolutionary distant orthologous sequences are aligned.

in addition to the automated alignments for bacteria, nematode, mosquito, drosophila, and vertebrate genomes, and the higher eblat resolution, evoprinterhd includes algorithms that search the intra-genomic aligning regions for rearrangements, duplications and sequencing gaps. evoprints generated with composite eblats highlight conserved sequences within the reference dna irrespective of genomic rearrangements within one or more of the aligning regions. four additional programs have been added:  an evodifferences profile, portraying in a single view the conserved sequences that are detected in all but one of the species included in the evoprint;  input reference dna exchange, allowing for detection of species-specific changes in the less-conserved dna flanking mcss;  automated extraction and curation of conserved sequence blocks , facilitating their comparative analysis  <cit> , and  for bacteria, an evounique print that highlights unique or uniquely shared sequences among subsets of genomes. due in part to its speed and flexibility of genome selection, evoprinterhd interfaces well with other web-accessed tools. the time required to undertake a comparative genome analysis of sequences that contain putative cis-regulatory enhancers is significantly reduced. for example, a  <dig> drosophila evoprint analysis and curation of csbs within a  <dig> kb genomic region that contains a cluster of transcription factor dna-binding sites  requires less than  <dig> seconds. once csbs are discovered, subsequent analysis via cis-decoder algorithms enable the generation of conserved sequence tag libraries that further facilitate enhancer comparative studies.

RESULTS
the following is a description of the sequential steps and accompanying algorithms used by evoprinterhd to identify conserved sequences shared among multiple genomes. instructions and a tutorial for optimizing its use can be accessed at the evoprinterhd web site  <cit> .

genome indexing
in addition to the original non-overlapping 11-mer genomic index of blat  <cit> , evoprinterhd indexes each genome into a second set of non-overlapping 11-mers, offset by four base pairs from the initial indexing, and into a third set of non-overlapping 9-mers. the resulting staggered indexing increases the likelihood that homologous regions missed by any one of the individual indices will be identified. the use of multiple genome indices and optimization of the alignment phase parameters  is the basis of the enhanced detection of conserved sequences between evolutionarily distant orthologous dnas.

evoprinterhd currently holds in memory three independent indices of each of  <dig> bacteria,  <dig> mosquito,  <dig> nematode,  <dig> drosophila and  <dig> vertebrate genomes, representing ~ <dig> billion bp in total memory.

modification of blat search and alignment parameters
the alignment sensitivity of evoprinterhd for the discovering short blocks of conserved sequence homology between evolutionary distant orthologs was increased by optimizing the genomic finding  client program parameters of the original blat algorithm  <cit> . the search and alignment parameters were adjusted by:  optimizing the stringency factor for low homology alignments by increasing it from  <dig>  to  <dig> ,  reducing the initial expansion gap between adjacent hits from a setting of four to three,  reducing the additional expansion gap penalty from three to one,  maximizing the allowable gaps and inserts from  <dig> to  <dig>  and  changing the value of allowable codon gap parameter from two to three to optimize for codon polymorphisms in open reading frames.

detecting conserved sequences with evoprinterhd algorithms
to maximize the identification of short csbs between evolutionary divergent orthologs, evoprinterhd generates  <dig> different input reference dna vs. test genome blat alignments to the same aligning region using the three indices described above. as an output of the client program, evoprinterhd then generates a superimposed composite of the  <dig> different alignments. the algorithm does this by first creating an array of nucleotide strings of each of the  <dig> input reference dna blat alignment sequences and then loops through the strings one base at a time, outputting a capital letter when at least one of the  <dig> readouts has an aligning base at that position, thereby generating a composite readout that displays all conserved bases. the program also generates blat readouts of the test genome aligning region and both are stored in memory for later analysis, evoprint generation and for exchange of input reference dna, accomplished by selecting one of the aligning region sequences as the new reference sequence to reinitiate the analysis. the algorithm also generates eblats for the second and third highest score aligning regions for each of the selected genomes.

the mosquito, nematode, drosophila and staphylococcus evoprinterhd algorithms automatically generate, respectively,  <dig>   <dig>   <dig> and  <dig> pairwise blat alignments, assembles  <dig>   <dig>   <dig>  and  <dig> eblat readouts, and then superimposes the individual pairwise eblat alignments  to generate a color-coded composite-eblat  for each aligning region. the vertebrate evoprinterhd and enteric bacteria evoprinterhd both generate up to  <dig> pairwise blat alignments assembling  <dig> eblat readouts and  <dig> ceblats. to reduce alignment times, evoprinterhd algorithms currently employ two dell poweredge  dual quad-core processor servers operating in parallel with the redhat enterprise linux  <dig> operating system and the network file system to simultaneously query multiple indexed genomes.

to assess the efficacy of eblat alignments in comparison to the original blat, we compared the pairwise alignment scores  of eblat to those obtained with blat, using  <dig> different intergenic regions from the drosophila melanogaster genome . the genomic fragments  were selected because they each had been previously shown to contain cis-regulatory transcriptional enhancers. they include dna flanking the following genes: gooseberry-neuro  <cit> , snail  <cit> , hunchback  <cit> , slit   <cit> , string   <cit> , atonal  <cit> , sex combs reduced   <cit> , toll   <cit>  and par domain protein  <dig>   <cit> . nine of these regions are described in redfly, the regulatory element database for drosophila  <cit> , while the tenth, the nerfin- <dig> neuroblast enhancer was identified by a. kuzin in the odenwald laboratory . in addition, twelve genome evoprint analysis of each of the ten intragenic regions revealed that each region contained highly conserved sequences that were shared by all drosophilids . as demonstrated in figure  <dig>  the pairwise eblat alignment exhibited only a modest increase in the identification of shared sequences between closely related species over the conventional blat alignment; however, eblat identified significantly more conserved sequences when the d. melanogaster genomic fragments were aligned to the more evolutionarily distant orthologs. the increased identification of shared sequences varied from a  <dig> % increase for d. simulans  to  <dig> % for d. grimshawi . the same enhanced discovery of sequence conservation was also observed when evolutionarily distant nematode or vertebrate species were compared. for example, eblat alignments between c. elegans and c. briggsae or human and xenopus orthologous dnas both identified greater than 70% more shared sequences when compared to original blat alignments .

another measure of eblat efficacy in identifying evolutionary conservation is to compare the detection of conserved sequences when eblat vs. blat alignments are used to generate an evoprint. to demonstrate the increased alignment sensitivity of eblat over blat in the evoprint analysis, the drosophila melanogaster krüppel central domain enhancer  <cit>  was evoprinted using  <dig> of the drosophila species . the original evoprinter  detected a total of  <dig> conserved bases compared with  <dig> conserved bases identified with an eblat generated evoprint – a 50% increase in alignment recognition. in addition, the evodifferences profile identified additional bases  that are conserved in all but one of the genomes used to generate the evoprint .

we also compared evoprinterhd-generated evoprints to multi-genome alignments obtained from the ucsc comparative genome bioinformatics alignment program  <cit> . the alignment resolution of evoprinterhd is equivalent to the multi-species ucsc alignments in detecting csbs. the two alignment programs detect the same conserved sequences with 93% to 95% correspondence in five different enhancers compared .

evoprinterhd repeat finder
one prominent feature of all bacteria and metazoan genomes is that they harbor diverse populations of repetitive elements that range in copy number from single duplications to thousands of transposable elements dispersed throughout the genome. given that many of these repeats contain highly conserved sequences that may interfere with alignments between evolutionary distant orthologs, it is important to first identify the repetitive sequence within the reference genome before comparative analysis is considered. to accomplish this, the evoprinterhd repeat finder algorithm superimposes the first, second and third highest scoring eblat alignments of the input dna to its own genome and then color-codes the readout to identify single or multiple repeat sequences within the input reference dna . sequences that have one additional copy in the reference genome are noted with blue-colored uppercase bases while those that are present three or more times are highlighted with red-colored bases. the algorithm also reveals if one of the multiple repeat sequences is more homologous to the repeat present in the input dna by highlighting single repeat sequences that flank the core multi-repeat element . by underlining repeat sequences in the evoprint and evodifference readouts potential 'false positive' alignments that have their origin in repetitive elements are highlighted.

alignment scorecard
as a prelude to generating an evoprint, the inter-genome comparative program first displays the results of the different alignments in a tabular form referred to here as the alignment scorecard . the scorecard shown in figure  <dig> was generated from a cis-regulatory enhancer region associated with the drosophila melanogaster fushi tarazu gene . the alignment score for each species' eblat alignments shows the total number of aligning bases in the input reference dna. the positions of the first and last aligning bases in the input reference dna are also noted, along with the number of sequencing gaps detected in the aligning regions of the test genomes and the total number of "ns" . links to the alignment readouts for each species are provided on the scorecard, allowing the user to view the individual reference dna and test species alignments. a second link for each species leads to a color-coded composite eblat of all  <dig> of its alignments that highlights sequence rearrangements and/or duplications in the test species . the data is arrayed in a descending order of alignment scores. by default, top scoring genomes with no sequencing gaps in their highest scoring alignments are selected for the initial evoprint analysis. after the initial evoprint and evodifferences profile is examined, it is recommended that the lower scoring species be included one at a time to extend the evolutionary comparison .

identification of rearranged and duplicated conserved sequences
once the initial eblat alignments are completed, the evoprinterhd intra-genomic comparative algorithm automatically determines:  the number of aligning bases in the second and third eblat alignments that are not identified in the first  alignment for each species, called the "r" value indicating putative rearrangements in the test species,  the number of aligning bases in the second and third alignments that are also aligning in the highest score alignment, termed the "d" value for putative duplications, and  the number of aligning bases that are shared by all three alignments, indicating conserved sequences within putative repetitive elements. for example, the alignment scorecard of a d. melanogaster  <dig>  bp input reference sequence, located  <dig> kb 5' to the fushi tarazu gene, reveals that  <dig> of the  <dig> species included in the analysis have undergone putative rearrangements in their aligning regions compared to the reference genome . the rearrangements within  <dig> of the  <dig> genomes  flank the aligning bases in each of their highest score aligning regions  . ceblats of these  <dig> species identified that each contained at least two different mcs rearrangements relative to the input d. melanogaster reference dna .

generating evoprints, and evodifferences profiles and evounique prints
based on the data provided on the alignment scorecard, different combinations of ceblat alignments can be chosen to generate an evoprint. the evoprinter algorithm  <cit>  creates an array of nucleotide strings from each of the selected alignments and then looks for conservation of sequence by looping through each of the strings one base at a time, outputting an uppercase base for only those input reference dna nucleotides that are aligned in all of the different ceblats included in the analysis . those dna bases within the input dna that are not shared with all species are represented as lowercase nucleotides. the "all alignments or none" options for each species allows for rapid changes in the repertoire of species alignments used to generate an evoprint. as a default setting, evoprinterhd selects ceblats to generate an evoprint; however, the user can select just the highest scoring alignment to generate an evoprint, and doing so eliminates potential false positives that are identified as repeat sequences. as discussed above, when evolutionarily distant species are included in the analysis, mcs containing genomic rearrangements in one or more of the selected genomes are identified in the second and third eblat alignments. to include the rearranged sequences in the analysis, ceblats are used to generate the evoprint. the use of the intra-species ceblats in the evoprint procedure, rather than selecting first, second or third alignments for generation of the evoprint, enhances the ability of evoprinterhd to identify and display, in a single uninterrupted sequence, conserved sequences within the input dna even though the mcss reside within genomic rearrangements in one or more of the orthologous dnas included in the comparative analysis. our experience indicates that highly repetitious sequences do not interfere with the use of ceblats, because the presence and position of repeats varies across the species used to generate the evoprint. for the  <dig> vertebrate or for the enteric bacteria, genomes can be added or removed from the initial analysis simply by returning to the selection page and adding or deselecting different genomes. because evoprinterhd holds the previous alignments in memory, the time required to add additional genomes to the comparative analysis is significantly reduced.

an additional readout, the evodifferences profile, is also displayed along with the evoprint; it highlights the unique differences  that each species contributes to the comparative analysis . the evodifferences profile can also be considered a "relaxed evoprint" since bases identified by the different colors are present in all species except for the single species denoted by that color. the apparent absence of a conserved sequence or base change in a single species could have several explanations:  the difference represents a unique evolutionary change,  it may be the result of a sequencing error, and/or  the sequence is present but not identified by the ceblat due to three or more genomic rearrangements in the aligning region.

for bacteria, a third readout, the color-coded evounique print, highlights those bases in the input reference dna that are unique  and those bases that align with only a single other or two other genomes included in the analysis .

parsing and curation of selected conserved sequences
to facilitate the comparative analysis of different conserved sequences from different enhancers, evoprinterhd allows for the curation of csbs by enabling the user to automatically extract and collate csbs in both forward and reverse-complimented orientations . the "extract conserved sequence block" option  provides for the automatic extraction, naming and consecutive numbering of  <dig> bp or longer csbs from selected regions of an evoprint or evodifferences profile . in addition to the annotated list of forward and reverse sequences the readout shows the selected evoprinted region from which the conserved sequences were extracted. a link is also provided to the cis-decoder csb comparative algorithms  <cit> .

identifying species-specific changes in less-conserved dna
evoprinterhd allows for the rapid exchange of the input reference dna; it draws from memory the genomic sequence of the highest aligning region of any species identified in the initial analysis. once a change in reference dna is requested , the alignment process is automatically reinitiated using the highest scoring aligning region of the selected genome as the new input reference dna. figure  <dig> highlights the genome-specific variability of less-conserved sequences between vertebrate mcs regions. within the second intron of the human casz <dig> gene  <cit> , a homolog of the drosophila castor gene  <cit> , two highly conserved mcss were identified that are each present once in most, if not all, vertebrate genomes. using the human casz <dig> 2nd intron as the input reference dna and all  <dig> vertebrate genomes, a relaxed evoprint reveals that the intervening distance between the mcss in the human genome is  <dig> bp . by exchanging the human sequence with the highest scoring aligning region from the zebrafish genome and repeating the analysis, the separation between the conserved sequence clusters was found to be  <dig>  bp . both human and zebrafish relaxed evoprints identified the same conserved bases in the two msc clusters with few exceptions, and the spacing between conserved sequence blocks within the mcss remained almost unchanged. additional reference dna swapping revealed that the non-or less-conserved intervening sequence between these mcss is quite variable. for example, in fish the length varied between  <dig>  to  <dig>  bp and in frogs and chickens the distance was  <dig>  and  <dig> bp, respectively .

CONCLUSIONS
evoprinterhd affords a rapid, convenient way to detect and curate dna sequence conservation between related and evolutionarily distant animals. when multiple genomes are included in the analysis, the uninterrupted evoprint readout provides a species-centric view of conserved sequences that are required for gene function. evoprinterhd advances the evoprint method by providing an automated higher-definition view of sequence conservation from which the conserved sequence blocks can be rapidly curated for subsequent analysis. evoprinterhd also identifies genomic regions within one or more of the selected species that harbor rearrangements of the conserved dna, and identifies unique or uniquely shared dna sequences within bacterial genomes.

