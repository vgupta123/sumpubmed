BACKGROUND
single nucleotide polymorphisms  are the most abundant type of polymorphism in the human genome. with the parallel developments of dense snp marker maps and technologies for high-throughput snp genotyping, snps have become the markers of choice for genetic association studies. the use of dense but incomplete maps of snp markers for genetic association is based upon the premise that low penetrance but fairly common disease variants can be detected by virtue of indirect association between snp markers and disease status. as a general rule, the denser the map of markers used, the greater the probability that at least one marker will be in strong linkage disequilibrium  with a disease susceptibility allele, and therefore indirect association between marker and disease will be detected  <cit> .

with the development of genotyping platforms that permit analysis of several hundreds of thousands of markers, it is now possible to apply this principle of indirect association to the whole genome rather than just candidate genes or candidate linkage regions. for example affymetrix , recently released microarrays that can interrogate ~ <dig>  snps, and illumina  released in january  <dig> the sentrix humanhap <dig> genotyping beadchip which can genotype  <dig>  high-value snp loci derived principally from tag snps. theoretical predictions  <cit>  as well as empirical data concerning the structure and distribution of ld in the human genome  <cit>  suggest that analyses on this scale will probably be adequate for whole genome association studies targeted at common disease variants.

the number of subjects required to detect the influence of a risk allele by indirect association depends upon the locus-specific genotype relative risks conferred by the susceptibility variant and the maximum ld between it and any assayed marker. for unknown loci, these parameters can only be guessed, but the expectation is that the relative risks will usually be small and therefore the required samples large. substantial samples are also required to offset the enormous degree of multiple testing inherent in genome-wide studies. thus an uncorrected threshold for statistical significance of α = 10- <dig> is required to achieve a genome-wide type i error rate of only  <dig>  in the face of testing  <dig>  independent snps. although this is somewhat conservative since many markers are in ld , it serves as a rough approximation to the scale of the statistical burden. these dual considerations of small genetic effect sizes and adjustment for multiple testing have led many to assume that samples in the region of at least  <dig> or more cases and a similar number of controls will be required for most complex disorders . given these expected sample sizes, while genome-wide association are indeed technically feasible, they are also expensive.

one way to reduce the cost is to undertake quantitative analyses of allele frequencies in dna pools, a process often referred to as 'dna pooling'  <cit> . here, equal amounts of dna from patients and controls are mixed to form two sets of pools. the pools are then genotyped and the frequency of each allele estimated. the power of such studies is approximately the same as for individual genotyping of cases and controls  <cit> , but at a hugely reduced cost. dna pooling has proved remarkably accurate when applied to simple tandem repeats  <cit>  or to snps using a variety of different genotyping technologies  <cit> . typically, when estimates of allele frequency differences between two pools are compared with those obtained by individual genotyping, the mean error rate of pooled analysis is in the region of 1–2%.

several groups have begun to apply pooled genotyping to the new ultra-high throughput genotyping technologies. butcher et al,  <dig>  <cit>  and meaburn et al,  <cit>  pioneered this method by assessing the performance of the affymetrix  <dig> k array xba  <dig> for pooled genotyping. they validated by individual genotyping pooling data obtained from  <dig> snps in their first experiment  <cit>  and  <dig> snps in the follow-up work  <cit> . they also compared the pooled data from the remaining markers on the chip with allele frequency data from a reference caucasian population. the same group recently  <cit>  reported an applied dna pooling study based upon the  <dig> k array with mild mental impairment as a phenotype. they followed up the pooling data for the  <dig> most significant markers by individual genotyping in a larger replication sample. four of these snps remained significantly associated. liu et al,  <cit>  recently reported the results of a study where pools of  <dig> individuals each were used to identify differences between substance abusers and controls . this strategy allowed them to identify  <dig> "nominally reproducibly positive" snps.

although these studies give cause for optimism, it is clear that the validity of pooled genotyping using array technology has not been proven for a sufficiently large number of snps to allow researchers to apply the method with confidence. in this paper, we have undertaken a more comprehensive analysis of the accuracy of microarray-based pooling experiments. rather than examine a small selection of snps, we examined  <dig> fully informative snps out of a total of  <dig>  snps represented on the affymetrix  <dig> k xba  <dig>  <dig>  array. our results suggest that pooled genotyping using affymetrix arrays is as accurate as that obtained with lower throughput platforms, and that it can be performed instead of individual genotyping with only a minimal loss of power.

RESULTS
reproducibility
to estimate allele frequencies in pooled dna samples, we used the relative allele signal  scores given in the output of the affymetrix genechip dna analysis software . ras scores are produced separately for the sense and antisense strand for each snp and can be analysed separately, or can be averaged. the test-retest estimates of allele frequency in pools were high for duplicate experiments. this is illustrated in figure  <dig> in which estimates of allele frequency at  <dig> snp loci obtained in one array  are compared with the same data from another single array. when all possible pairs of such data were analysed, the mean correlation between single arrays ranged from r =  <dig>  to  <dig> . the correlations between sense only analyses and between antisense only analyses were virtually identical.

while the average correlations are strong for any pair of arrays, the spread of the data with respect to individual snps, as depicted by the width of the bounded zone capturing 95% of the data points , clearly shows weak reproducibility for a large number of individual markers. we therefore attempted to reduce measurement errors by using the repeated measures of the same pool. when the ras scores for the sense and anti-sense strands in a single array were averaged, reproducibility improved, with mean correlations now ranging between r =  <dig> – <dig> . the correlation continued to improve when data from replicate arrays were included. with a maximum of  <dig> arrays performed on a single  sample, our data allow us to compare the composite data from  <dig> arrays with what should be identical data from an independent set of the other  <dig> arrays. as each array has sense and antisense data, we have a total of  <dig> observations per pool. even at this fairly modest degree of replication, very high reproducibility was obtained, with an r =  <dig> . equally important, the bounded zone containing 95% of the data is much narrower .

allele frequency estimation
we averaged the ras values  from the five replicate measures of the offspring pool and the six replicate measures of the parental pool. the true allele frequencies in the parental and the offspring samples were calculated from the hapmap genotype database. without correction with k for unequal representation of alleles  the allele frequencies we estimated from the pooled analyses correlated well with the true frequencies derived for each sample from the hapmap . the data for the offspring sample are shown in figure  <dig> 

while the correlation is high, the spread of the data does not allow confidence that any single allele frequency can be accurately predicted. however the main aim of pooled analysis is to predict differences in frequencies between pools rather than the absolute allele frequencies per se. the true allele frequency differences between parents and offspring were calculated from the hapmap data and compared with the allele frequency differences predicted from the pooled analyses. the results  are presented in figure  <dig>  the mean error in estimating the allele frequency differences between the two pools was only  <dig> %, with 95% of all results showing an error of < <dig> % and 99% of results < <dig> %. the error distribution in bins of 1% is shown in figure  <dig> 

we estimated how the distribution of the error in pooled analysis varies with attempts to reduce measurement error through repeat measurement. the results are presented in figure  <dig> which shows how the mean error in estimating allele frequency differences between pools changes with increasing number of replicate analyses. we also present the error thresholds below which lie 95% and the 99% of the data. the number of arrays used per pool is plotted on the x axis. the x point of  <dig>  corresponds to analysis of  <dig> arrays for offspring and  <dig> for parents . the x data-point of  <dig>  corresponds to the data obtained for just one strand  for each array . with each replicate, we obtain an improvement in the mean error and a lowering of the thresholds for 95% and 99% of the data. although in each case the degree of improvement begins to plateau, even the addition of the final replicate contributes to reduction in error.

correcting the data
we performed several sets of corrections to see if our results can be improved. first we applied k, a correction factor often used in pooling experiments to correct the data for any unequal efficiencies in representing alleles  <cit>  . as for other pooling methods  <cit> , this procedure improves the correlation between measured and true allele frequencies  and also reduces the spread of the data . for a small proportion of snps, the true allele frequency in the pools was substantially different from the measured allele frequency in that pool. where this occurs, extreme values of k are derived  for the use in other pools. for technical reasons which are entirely understandable, this usually occurs for low frequency snps. consider a putative snp that is actually non-polymorphic . ras scores are seldom exactly zero. the result is that k reaches  <dig>   depending upon which allele is arbitrarily designated allele a . since the use of inappropriate values for k markedly affects the type i and type ii errors where either the true allele frequencies are very low and/or the correct k values extreme  <cit> , the data for snps whose derived k is small or large may not be reliable.

we therefore discarded  <dig> snps whose values of k were > <dig> or < <dig> :  and re-examined the distribution of errors. this procedure had little impact on the error in estimating differences between pools, with no change in the mean error . this is not surprising since this procedure affected only snps with very small minor allele frequencies  which cannot reach big differences between the pools used in our experiment. correction with k is likely however to a have a substantial effect in true case-control association studies, where a small difference in the frequencies of rare alleles can easily result in significant p-values. 

we also sought to identify poorly performing snps based upon large test-retest variation between arrays. within each pool, we measured the difference between the highest and lowest ras value for each snp produced by the replicate arrays. we term this difference the "maximum variability of the results". just over 5% of snps showed a maximum variability of >25% between the lowest and highest signal of any array. given that snps which show a higher degree of variability are likely to produce less reliable results, we removed these  <dig> snps. this correction did not change substantially the error in estimating differences between pools.

discussion
we have investigated the accuracy and reproducibility of dna pooling using the affymetrix  <dig> k xba  <dig>  <dig>  array by comparing pooled data with individual genotype data. in this respect, our analyses were greatly facilitated by the availability of individual genotype data for  <dig> snps on all the individuals from whom we made pools, courtesy of the hapmap project. our data show that pooled estimation of allele frequencies was highly reproducible. when we compared the allele frequencies calculated from the average of only three microarray replicates from one pool with that calculated from the average of a second set of three estimates for the same pool, the correlation between measures was r =  <dig>  . when we use as our outcome measure the magnitude of the error in estimating differences in allele frequencies between samples , while continued improvement is evident with increasing number of arrays, our data show further improvements are rather small beyond  <dig> replicates per sample. our data therefore suggest this as the minimum number of arrays that should be hybridised per pool, although more replicates are likely to further reduce the rate of false-positive and false-negative results.

pooled analysis yielded accurate estimates of the relative allele frequencies in pools but not estimation of the absolute allele frequencies when the data were not corrected for unequal allele representation. using the average values obtained from five  and six  arrays as artificial case and control pools, the system performed well, with a mean error of just  <dig> % which is comparable with other commonly used lower throughput methods  <cit> . 95% of all estimated differences between pools were within <  <dig> %, and 99% of them were within <  <dig> % of the true differences.

data correction
there are many reasons why alleles might be unequally represented even when present in equimolar amounts  <cit> . for microarrays, this might include differential allele specific pcr hybridisation efficiencies. correction for this with a coefficient k has been shown to improve both type i and type ii errors in dna pooling experiments  <cit> . this is because the estimation of the statistical significance of any observed difference requires that the approximate true allele frequency in the sample be known, a process significantly improved by use of the coefficient k. the improvement in estimating true allele frequency is in fact better than is apparent from figure  <dig>  this is because k is derived from parental data  and then applied to the data obtained for children . therefore any errors in estimating the parental allele frequencies are incorporated in the estimate of k with the result that the estimates of allele frequencies in offspring include the measurement errors from both samples.

where the application of k is required, the solution until now has been to derive k from the ratio of the intensities  of the signals representing each allele specific products from heterozygous individuals. to this aim, simpson et al,  <cit>  have recently initiated the development of a central resource for the accumulation of microarray data from heterozygous individuals. however, finding several heterozygous individuals for rare snps is problematic and the whole process rather complex if  <dig>  snps need to be examined. our approach avoids this problem. instead of analysing heterozygous individuals, we suggest using hapmap reference samples  thus eliminating the need to obtain genotypes from heterozygotes for every snp.

under the  assumption that to some extent, the value of k varies with laboratory practice, the greatest accuracy will be achieved if each group constructs their own pools of ceph individuals  and then conducts their own array replicates  to derive their own laboratory specific k values as described in the methods section. it should be noted that k corrects for technical artefacts in allele representation rather than population specific differences in allele frequency and that the k values derived in one sample are applicable to any other sample regardless of differences in allele frequency. however, the use of the most similar ethnic group represented in the hapmap to those comprising the main focus of research within a lab does have the advantage that k values for any population-specific snps can be derived .

however, it may well be the case that with the use of the highly standardised operating procedures which are always used for the work with affymetrix arrays, inter-laboratory k values will be modest and in most cases insufficient to be a significant source of error  <cit> . this is an issue we are currently exploring and if confirmed, we will deposit k values for the two  <dig> k arrays on our institutions website, and/or provide them to researchers upon request.

in terms of practical utility, our results indicate that moderate differences in allele frequency should be easily detected by pooled analysis followed by a very limited amount of individual genotyping, thereby greatly enhancing the cost-efficiency of the study. as an example, let us assume we are interested in detecting an unknown snp which has a frequency of 30% in the  <dig> controls and 38% in  <dig> cases. this scenario corresponds to an allele with an odds ratio of  <dig>  and an association which surpasses our approximate genome-wide threshold for significance of p = 10- <dig> . in our sample,  <dig> snps have true allele frequency differences >8% between parents and offspring. if we set as our target to individually genotype all snps which in pools showed an 8% difference, we would end up genotyping  <dig> snps which include 54% of the  <dig> snps with true 8% allele frequency differences . thus, by undertaking the pooled experiment, we would have identified 54% of the target loci  and all  <dig> best loci, but at the cost of genotyping only a very small proportion of the snps.

if we use the correction with k, our correct discovery rate remained similar at 50% . however, most designs aim to follow up the results surpassing a given threshold of statistical significance. for a given sample size, the calculated statistical significance depends not just on the magnitude of the allele frequency difference between samples but also on the allele frequency. our data concerning corrected and uncorrected data  clearly show that estimates of absolute allele frequencies are greatly improved by correcting for k. this correction improved the estimation of allele frequencies in the current study from a correlation with the true data of r =  <dig>  for the offspring pool  to r =  <dig>  when k correction was applied to that pool . therefore we expect that when the best p-values in an experiment are targeted, then a correction with k will lead to an improvement of the discovery rate. fortunately, with the method we propose, and the availability of genotyped reference samples, the process of deriving k is now quite straightforward.

we have illustrated the efficiency gains obtained by dna pooling with affymetrix arrays by choosing differences of 8% or more, but clearly this is a very arbitrary threshold and smaller differences are likely to be of interest to some researchers, particularly in larger samples. useful cost efficiency gains can still be made, though self evidently, the smaller the difference sought, the less the absolute magnitude of the gains. where the goal is to detect more modest differences in allele frequency, it is possible that cost-efficiency might be improved by more replicates. this is because even though our data show that the improvements in the mean error rate beyond  <dig> replicates are relatively small , the absolute number of snps falsely predicted by pooling continues to go down with more replicates.

 <dig> k versus  <dig> k arrays
we have to consider whether the conclusions we have drawn with respect to the  <dig> k array are likely to be valid for the  <dig> k arrays . each snp is interrogated by  <dig> features on the  <dig> k array but by only  <dig> features on the  <dig> k array . this reduction in the number of features per snp, as well as the reduction of the feature size from  <dig> to  <dig> microns, may reduce information content. this suggests that more replicate arrays will be needed to achieve accuracy and reproducibility equivalent to that reported in the present study. a slight problem is created by the fact that for the  <dig> k arrays the affymetrix software does not calculate automatically ras scores. however, these can easily be calculated from the intensity values reported for each array feature, using the algorithms described by liu et al,  <cit> .

so far there have been only a few published fairly high density genome-wide association studies and these have so far been based on around  <dig>  snps. klein et al,  <cit>  genotyped  <dig>  snps in a sample of  <dig> patients with age-related macular degeneration, and  <dig> controls. they identified a snp in the complement factor h gene  which was strongly associated with disease , a result that has been replicated since. yamazaki et al,  <cit>  genotyped  <dig>  snps in  <dig> japanese patients suffering with crohn's disease, and  <dig> controls. this lead to the discovery of a highly significant association with the tnfsf <dig> gene, p =  <dig>  × 10- <dig> in a large replication sample. several more studies on a variety of phenotypes have been performed but have not been fully published yet. summaries of such studies on multiple sclerosis and cardiovascular disease using  <dig>  snp, and graft-versus-host disease using  <dig>  snps are available in the affymetrix microarray bulletin of april  <dig>  <cit> . while the results of each study give cause to believe that genome association approaches can deliver novel genes, the costs are likely to prevent similar approaches being applied in all reasonably sized samples across the whole spectrum of complex disorders. until the costs reduce further, our data suggest that as an interim step, dna pooling based upon arrays will allow laboratories with relatively modest budgets to usefully contribute to this research.

CONCLUSIONS
when performed on affymetrix snp genotyping arrays, dna pooling provides a fairly accurate method for identifying allele frequency differences between samples, with a mean error of  <dig> %. in order to minimise measurement error, the final data should be based upon composite scores from 4– <dig> replicates for  <dig> k arrays, but this number will probably need to be increased for  <dig> k arrays, or where smaller differences in allele frequency are required. while not essential for measuring differences in allele frequencies between samples, to obtain estimates of the statistical significance of those differences, the data should be corrected for unequal representation of the two alleles using the coefficient k. instead of deriving k from the ratio of signals in heterozygous individuals, we suggest deriving it from pooling data obtained from samples of reference individuals from whom dna and vast quantities of genome-wide genotype data are available through cell repositories and the hapmap respectively. the cost-efficiency of dna pooling on arrays should enable even small laboratories to contribute to genome-wide association studies.

