BACKGROUND
as a fundamental concept, evolution has profound implications in a variety of applications in modern molecular biology; e.g., functional annotation of dna/protein sequences through comparative sequence analysis has become an important and integral part of biological sciences  <cit> . accurate reconstruction of the evolutionary history of species, usually represented by a phylogenetic tree, is critical for the success of such applications. phylogenetic analysis of molecular sequence data has drawn significant attention ever since protein/dna sequences have become available  <cit> . there exist many models , but all of them specify site evolutions at the dna level for obvious reasons: structure constraints  are hard to model. based on sequence evolution, different approaches have been developed to either explicitly use an evolutionary model  or approximate one   <cit> .

understanding functional evolution
it is clear that many other evolutionary constraints  are not considered in phylogenetic analyses using conventional approaches based on sequence comparisons. as the genome of an organism is affected throughout evolution, the structure and hence the inner dynamics of networks representing the functional relationships of these genes evolve in parallel with the genome. most changes on genes, as little as one residue, might affect the functional relationships among interacting biomolecules. these functional relationships include transcriptional and translational regulation, protein-protein interactions, gene modifications, post-translational protein modifications, metabolic reactions, and indirect interactions such as genetic interactions . the structure of these networks can vary over time and space, accounting for the dynamics of the system  <cit> . while networks contain a more solid base for understanding biological systems, the evolutionary path that is taken by cellular organization and cellular signaling is yet to be uncovered.

comparative network analysis
availability of high-throughput data that relates to the organization and dynamics of biological systems enables understanding of biological functions from a systems perspective  <cit> . an important source of data that pertains cellular organization and signaling is in the form of physical interactions between proteins, organized into genome scale protein-protein interaction  networks  <cit> . comparison of recently available ppi networks that belong to diverse model organisms reveals that parts of extant molecular networks are conserved across diverse species  <cit> . furthermore, it is observed that proteins that are organized into cohesive interaction patterns are more likely to be conserved  <cit> . comparative network analysis is also shown to enhance the performance of computational approaches to basic problems in functional genomics, such as identification of orthologs across species and annotation of protein functions  <cit> . furthermore, recent studies show that incorporation of evolutionary models and knowledge enhances the performance of network alignment methods significantly  <cit> . such findings demonstrate that network comparisons provide essential biological information beyond what is gleaned from the genome  <cit> . consequently, phylogenetic analysis of network topology and function has the potential to provide key insights on the evolution of biological functions at a systems level  <cit> .

phylogenetic analysis of network modularity
in this paper, we propose a modularity based approach to phylogenetic network analysis. the proposed framework, mophy, is illustrated in figure  <dig>  our approach differs fundamentally from existing approaches, in that we focus on the conservation and divergence of modular components, rather than one-to-one comparison of network topologies. in our framework, we first identify modular subgraphs in different networks independently. then, we project these modules on networks of other species to understand the conservation and divergence of different modular processes in these networks. while projecting a module on different species, we rely on the conservation of network proximity between homologs  of its constituent proteins in other networks. consequently, by utilizing network information, our approach captures functional evolution beyond conservation of sequences. namely, network information is incorporated into the analysis by  considering network modules as "features" of each network and  assessing the conservation of modularity in terms of the network proximity between proteins with conserved sequences.

our approach is motivated by several observations:

• existing evidence suggests that modularity plays an important role in the evolution of biological systems  <cit> . therefore, by explicitly incorporating modularity into the analysis, we can capture the evolutionary relationships between extant networks more accurately.

• explicit identification and projection of modules also enables the study of the evolutionary histories of specific modules, identification of module families, and construction of module-specific phylogenies  <cit> .

• available interaction data are highly incomplete and noisy  <cit> . compared to topology based analysis, modularity based analysis is likely to be more robust to such imperfections in the data, since it relies on conservation of aggregate network properties , rather than conservation of individual interactions.

• comparative network analysis is computationally expensive because of the intractability of the underlying subgraph isomorphism problem, difficulties in formulating and accounting for approximate matches, and existence of multiple mappings between proteins in different species  <cit> . modularity- based analysis alleviates this problem by avoiding one-to-one comparison of network topologies.

evaluating network comparison methods
in this study, we also take a novel approach to the calibration and validation of comparative network analysis methods. based on theoretical models on the evolution of molecular interactions  <cit> , we simulate network evolution to generate networks with known underlying phylogeny. then, we use our algorithms on the generated networks to reconstruct a phylogenetic tree. by comparing the reconstructed tree with the underlying tree, we evaluate the performance of different methods and assess the effect of various parameters on the accuracy of our methods. we also use simulated networks to evaluate the robustness of our methods against noise and missing data, by perturbing the simulated networks to mimic data collection processes. extensive experiments on simulated data show that the proposed algorithm is extremely successful in reconstructing the underlying phylogenies and is quite robust to noise. we also use the proposed method, mophy, to reconstruct the phylogeny of seven species, for which reasonable interaction data is available. we show that our method constructs a phylogenetic tree that is in accordance with the phylogenetic relationships and evolutionary distances inferred by independent methods. furthermore, we demonstrate that mophy outperforms existing phylogenetic network analysis methods.

learning from phylogenetic network analysis
it should be noted that the application of the proposed framework extends well beyond phylogenetic tree reconstruction. the methods and results presented here rather constitute a step towards establishing modularity based analysis as a key approach in understanding the functional evolution of cellular organization. indeed, our results show that conservation of modularity and network proximity is likely to provide useful insights into the evolutionary histories of networks, by providing statistical evidence for the following observations:

• conservation of network proximity is a better indicator of evolutionary relationships when modular network components are considered  .

for the simulated networks, we compare the performance of mophy with the random module method, random homolog selection method, rdl and a method that only uses protein similarity in the networks. nodal distance for five simulation instances as well as the average values of these five runs are shown in the table. for mophy, the result used is the best performance achieved with coverage  <dig>  and diameter  <dig>  by using the most specific modules. similarly for the random module method, the best performance is achieved for the instance with coverage  <dig>  and diameter  <dig>  with the most comprehensive modules. for the random homolog selection method, the best result is achieved with coverage  <dig>  and diameter  <dig>  by using the most specific modules. as clearly seen, mophy outperforms the other methods in terms of capturing the evolutionary distances between species.

performance of mophy in capturing the topology of underlying phylogeny for simulated networks. for each parameter setting, the symmetric distance between the underlying tree and the tree reconstructed by mophy/randomized method is shown. reported values are averages over five runs. p-values indicate the statistical significance of the performance difference between mophy and the randomized method. **: p <  <dig> , *: p <  <dig> .

for each parameter setting, the nodal distance between the underlying tree and the tree reconstructed by mophy/randomized method is shown.

• modularity based analysis is quite robust to noise and missing data in terms of capturing evolutionary relationships, and therefore may be more promising in comparative analysis of extant protein-protein interaction networks, which are highly incomplete and susceptible to noise ).

• network modules are likely to be conserved more in evolutionarily closer species, in terms of the network proximity between the homologs of their constituent proteins .

these results motivate elaborate studies of modular evolution, including identification of module families and reconstruction of evolutionary trajectories for these module families, which in turn will be useful in constructing the "periodic table of systems biology"  <cit> .

RESULTS
here, we first present all the algorithmic details of our method in algorithms subsection. it is followed by the testing subsection in which results when the algorithm is applied to simulated and real network data are illustrated in a detailed way.

algorithms
our modularity-driven approach to phylogenetic network analysis, mophy, which is illustrated in figure  <dig>  can be summarized as follows:

 <dig>  considering each extant network individually, identify network modules that represent functional and topological properties of each network.

 <dig>  project modules identified on each network to other extant networks, based on the conservation of functional and topological properties, to obtain a module map for each species. a module map can be thought of as a mathematical representation of the conservation of extant network modules in the corresponding species.

 <dig>  using module maps, compare networks of diverse species to construct network phylogenies.

 <dig>  using resulting network phylogenies, investigate the evolutionary histories of extant network modules to gain insights on the evolution of functional modularity.

in the rest of this section, we formulate this approach based on biologically sound abstractions and present algorithms to effectively solve the resulting computational problems.

problem formulation
an interaction network g =  is specified by a set v of proteins and a set e of interactions between these proteins. for vi, vj ∈ v, viv j ∈ e indicates that proteins vi and vj interact with each other. interactions are also associated with reliability scores, specified by weight function w: v × v →  <cit> , where larger w indicates higher confidence in the existence of an interaction between vi and vj  <cit> .

in this paper, we particularly focus on protein-protein interaction  networks. however, the proposed method can be easily extended to different sources of data that relates to the organization of cellular systems  - to provide an integrated view and analysis of cellular organization. consider a set  = {g <dig>  g <dig>  ..., gk } of k ppi networks, each belonging a different extant species.

the proteins in these networks can be associated with each other through a sequence based similarity measure, ψ:  ×  →  <cit> , where  = v <dig> ∪ v <dig> ∪ ...∪ vk is the set of all proteins in all networks. in practice, we estimate the sequence similarity scores using blast e-values  <cit> . let eij denote the e-value of the most significant bidirectional blast hit between proteins vi and vj . we define ψ  =  <dig> + 1/log, if eij <ω, and  <dig> otherwise, where ω denotes the threshold for the e-value being considered significant. if ψ  >  <dig>  i.e., eij <ω, we call vi and vj homologs. note that ψ is quite sparse in practice, i.e., most proteins have only a few homologs in other species.

network modularity
an important class of network components that are used in characterizing the networks consists of functional modules  <cit> . a functional module is in general defined as a set of macromolecules  that perform a distinct function together   <cit> . it is shown that these functional modules generally manifest themselves in interaction networks as subgraphs with distinctive local properties. for instance, protein complexes would have high inner connectivity in the network, while being somewhat loosely connected to the rest of the network  <cit> . furthermore, it is observed that functionally modular groups of proteins and their interactions are likely to be conserved together  <cit> . consequently, modular subgraphs provide an excellent substrate for understanding the evolutionary relationship between networks that belong to diverse species. for this reason, we use conservation of modular subgraphs as an indicator of evolutionary proximity between networks. note that, comparative methods that target identification of conserved functional modules on a group of networks are also available. however, there are several advantages to our approach of discovering modular subgraphs on each network individually, followed by projection of these subgraphs on other networks:  multiple graph alignment is a computationally expensive problem  <cit> ,  noisy and incomplete nature of available interaction data makes it particularly difficult to account for mismatches , and  by identifying modular subgraphs in each extant network individually, we can quantify not only the conservation, but also divergence of modularity in different evolutionary lineages and understand the evolutionary histories of functional modules in diverse species.

proximity as an indicator of modularity
in order to assess the modularity of a group of proteins in a network, we use a proximity based measure, motivated by three key observations:  network proximity is shown to be correlated with functional similarity  <cit> .  ppi networks are generally incomplete and prone to noise, therefore existence of alternate paths may account for missing interactions  <cit> .  existing evidence suggests that existence of alternate paths relaxes the evolutionary pressure on conserving the interaction between two proteins  <cit> .

consequently, while assessing the modularity of a subgraph in a different network, it might be evolutionarily more relevant to consider the conservation of network proximity rather than conservation of individual interactions.

let  denote a simple path connecting proteins vi and vj in network g. we define the reliability of this path as the aggregate reliability of all interactions on the path, i.e., . then, we estimate the proximity between two proteins with respect to g as the reliability of the most reliable path between these two proteins, i.e., , where ∏  denotes the set of all simple paths between vi and vj . note that, according to this measure, proximity decays exponentially by path length. this is in agreement with the relation between functional similarity and network proximity  <cit> . if the interactions are not associated with reliability scores , we assign a score of 1/ <dig> for all interactions, to ensure exponential decay of the proximity measure. in addition, mutual clustering coefficient, as a measure of graph connectivity, is used to complement proximity in identifying network modules, which is very effective in breaking ties in the unweighted case .

projection of proximity on other networks
now consider evaluating the proximity of two proteins with respect to another network, g' ≠ g, with a view to assess the conservation of their functional association. in order to measure the proximity of vi and vj with respect to g', we aggregate the proximities of their homologs in v . for this purpose, we normalize the similarity measure with respect to network g ' to obtain , where vi ∉ v  and vk ∈ v then, the proximity of vi and vj ∉ g' with respect to g' is defined as

   

modularity and projection of modularity
we can now define the modularity of a set of proteins with respect to a network. for a set s of proteins, all in the same species, i.e., s ⊆ v  for some g ∈ , the modularity of s with respect to network g' ∈  is given by

   

which is the average proximity between all pairs of proteins in s with respect to g' in other words, the modularity of a group of proteins in one network with respect to another network measures the extent to which the modularity of the homologs of these proteins is conserved in the corresponding network, through aggregation of proximities of all homologs. observe that our framework provides a universal view of modularity by facilitating assessment of the modularity of a set of proteins in one species with respect to a network that belongs to another species.

concerns could be raised that the proposed measure might be heavily influenced by the sequence information, resulting in an inadvertently sequence based analysis . however, as we demonstrate in section testing, the biological signals captured by this measure depend on network topology and the use of sequence information is minimal. namely, we randomly rewire all interactions  and keep sequence similarities as they are. in this case, the performance of the proposed measure in phylogeny reconstruction becomes equivalent to that of a random algorithm . this result indicates that biological signal is lost if the network is completely noisy, even if the sequence information is completely preserved.

module identification
in our framework, network modules are identified on each network individually, and then projected on other networks to construct module maps. in order to identify modular subgraphs in a single network, we use a hierarchical clustering algorithm with a hybrid similarity measure that integrates the concepts of proximity and connectivity for network clustering. integration of these two alternate measures enables discovery of tightly coupled subgraphs with low diameter.

module identification via hierarchical clustering
we first describe our algorithm based on proximity. for a given network g = , this algorithm starts with |v | distinct clusters, each containing a single protein. then, it iteratively merges two clusters that are of maximum proximity to each other, until a single cluster containing all proteins in the network is formed. observe that, this algorithm requires generalization of proximity measures to pairs of clusters. measures that are commonly used for this purpose are single linkage , complete linkage , and average linkage . we use complete linkage clustering to ensure that all proteins in identified subgraphs are tightly coupled to each other.

proximity vs. connectivity
an important problem associated with the application of proximity based clustering to molecular interaction networks is that, these networks are "ultra-small", i.e., distances between most pairs of proteins are very low. particularly when the interactions are not associated with reliability scores, there are many pairs of proteins with identical proximity at early steps of hierarchical clustering, resulting in many candidate pairs of clusters to be merged. this problem is often alleviated by running the algorithm multiple times with random decisions, and then reconciling the clusters based on the number of times each pair of proteins are assigned to the same cluster.

mutual clustering coefficient complements proximity
in this study, we propose an alternate approach, which uses mutual clustering coefficient  <cit>  between two sets of proteins as a secondary measure of similarity between clusters. mutual clustering coefficient captures the overlap between the interaction profiles of two proteins, providing an estimate of the likelihood that the two proteins together belong to a functional module. we generalize the notion of mutual clustering coefficient to pairs of clusters  as follows. for a set si ⊆ v of proteins in network g = , let ni = {vk ∈ v: ∃ vl ∈ si such that vkvl ∈ e} be the set of interacting partners of the proteins in si. then the mutual clustering coefficient of clusters si and sj is given by

   

note that this is a measure of the statistical significance of the number of shared interacting partners, which is modeled as a hypergeometric random variable.

our algorithm uses mutual clustering coefficient as a tie-breaker. in other words, at each step, it merges two clusters with maximum proximity if this pair of clusters is unique. otherwise, among all pairs of clusters with maximum proximity, it merges the pair with largest mutual clustering coefficient. consequently, at early stages of the algorithm, mutual clustering coefficient effectively acts as the primary similarity criterion. on the other hand, the proximity criterion ensures formation of clusters with the minimal diameter throughout the course of the algorithm. once a hierarchical clustering is obtained using this method, we identify the modular subgraphs by properly choosing thresholds on proximity. in section testing, we evaluate the effect of the proximity threshold on the performance of our algorithms in detail.

constructing module maps
once modular subgraphs are identified on each network, we project these subgraphs to all networks and construct a module map for each network. module maps can be thought of as feature vectors, where features represent the modularity of each subgraph in the corresponding network. the modularity score of each module with respect to each network is calculated as in equation  <dig>  to be more precise, assume that we identify mj modules in network gj . let the set of these modules be . then, for each network gi,  <dig> ≤ i ≤ k, the module map fij of gi with respect to gj is an mj-dimensional vector, defined as

   

consequently, the module map of network gi,  <dig> ≤ i ≤ k is represented as fi = . network modules represent a particular functional component of each network. these modules, when considered altogether, provide a high level representation of each network. in other words, the module maps are signatures of each network and can be utilized to identify the overall phylogeny of these networks.

phylogenetic tree reconstruction
once modules are projected to each network and module maps are created, we use these module maps as feature vectors that characterize the cellular organization in each species. namely, we compute the pairwise distance between each pair of species by comparing module maps, and apply a traditional phylogenetic tree reconstruction algorithm  based on these pairwise distances.

clearly, a straightforward way of estimating evolutionary distances between pairs of species is to consider the correlation between their module maps, i.e., to define . however, this method is likely to be significantly affected by the incompleteness of data, since some modules may not exist in some species just because of the unavailability of interaction data. for this reason, while computing the evolutionary distance between two species, we only consider the modules that are identified on the networks of these two species. this avoids the bias introduced by the large number of modules in species for which more comprehensive data is available. furthermore, we consider one-directional conservation of a single module as a bi-directional hit, to account for missing data. for instance, in the ppi data obtained from dip, m. musculus  ppi data is relatively incomplete compared to h. sapiens  ppi data. however, available mouse network is quite similar to parts of the human network. therefore, almost all modules identified in mouse ppi network are also conserved in human ppi network.

consequently, by considering only the conservation of modules in the smaller network, i.e., defining

   

we avoid the effect of missing interactions in the network when incomplete data is used.

simulation of network evolution
in order to evaluate and calibrate our algorithms for network based phylogeny reconstruction, we apply our method to synthetic networks that are generated by simulating network evolution. the goal of this simulation is to generate a set of networks with known underlying phylogeny, construct a phylogenetic tree for these networks using our methods, and compare the underlying and reconstructed trees to evaluate the accuracy of our algorithms.

network evolution models
we generate synthetic networks by utilizing a model that can accurately reflect the basics of network evolution. there are a variety of duplication based evolution models proposed to model the growth of ppi networks  <cit> . these models are inspired by theoretical models of molecular and functional evolution and aim at reproducing the topological properties observed on extant ppi networks. among these models, we employ a slightly modified version of an iterative model called duplication- mutation-complementation , which is shown to regenerate the subgraph distribution of d. melanogaster ppi network significantly better than other network generation models  <cit> . the dmc model works in iterations and each iteration consists of three steps.  gene duplication: a protein vo is chosen uniformly at random and duplicated to create a new protein v, with all interactions of vo.  mutation/complementation: for each pair of interactions vo v' and vv', one is chosen and deleted with a probability p, based on the notion that the duplication results in redundant protein functionality, relaxing the evolutionary pressure on preserving one of the redundant interactions.  self-interaction: an interaction is added between vo and v with probability p'. in our experiments, we choose p =  <dig>  and p' =  <dig>  as suggested in  <cit> .

incorporating speciation
unlike other network generation models that focus on evolving a single network, in this work, we evolve multiple networks in parallel to construct a phylogenetic tree of networks. starting with a single network, the networks evolve concurrently with respect to an evolutionary timeline. we assume that, at each branch, speciation occurs with a constant rate rs, resulting in two networks and splitting the evolution process into two new branches.

throughout network evolution, a species s =  is specified by its ppi network g, the current size of its network nc, and the target size nf . the steps taken while generating the phylogenetic tree of these species can be summarized as follows: initially, the phylogenetic tree has only one species at the root position with , where g contains only two interacting proteins, i.e., nc is set to  <dig>  the value of nf is assigned randomly from a gaussian distribution .

at each iteration t of the evolutionary process, for each species s that has not reached to the target interaction network size, i.e., nc< nf, the following actions are performed:

• s is evolved by a single iteration of the dmc model. this results in the addition of a new node to g, incrementing nc by one.

• if the network size reaches the target value after this addition, i.e., nc = nf, the network is recorded as a leaf network.

• otherwise, a speciation event takes place for s with probability rs. this process is analogous to generating two new species and replacing the original s with an internal node. these new species initially have the same set of interactions with their parent. they are also assigned new nf values right after the speciation, chosen from the same distribution. note that, common proteins in these new species are recorded as homologs.

when all species reach their targeted network sizes, the simulation terminates with leaves representing the resulting species. note that each speciation event increases the total number of species by one. the desired number of networks for a given distribution of target network size  can be achieved by properly adjusting rs and the number of iterations.

the evolutionary distances between species are recorded according to the occurrence of speciation events with respect to evolutionary timeline. this enables evaluation of our algorithms in terms of its accuracy in estimating evolutionary distances, as well as the topology of the resulting phylogeny. furthermore, to obtain similarity scores between proteins in different species, we record homologs after each speciation event and assign scores to each pair of proteins based on the number of duplications that occur after their common ancestor is split into two different proteins. more precisely, we set ψ  = 1/dij, where dij is the number of duplication events that occur after the common ancestor of these two proteins is split.

testing
in this subsection, we evaluate the performance of mophy on simulated, as well as real data - in terms of  success in accurately reconstructing the underlying phylogeny,  robustness to noise and missing data, and  performance as compared to existing algorithms.

results on simulated data
we test our method on synthetic networks generated by simulation of the evolutionary process. in our experiments, in order to keep the size of the networks at a realistic scale with sufficient variability, we set the average number of proteins in a network to  <dig>  with a standard deviation of σ =  <dig>  here, average network size is kept relatively smaller as compared to that of extant networks for feasibility constraints, since these experiments are performed multiple times to assess statistical significance and the effect of varying parameters. our results on extant networks show that the method also scales to larger networks and is applicable in practice. using this configuration, we generate ten networks for each experiment. for all experiments, we generate five different instances, and for each performance figure, we report the average over these five instances. note that, in these experiments, the interactions are not associated with reliability scores.

evaluating performance:comparison of phylogenetic trees
in order to quantify the performance of a tree reconstruction method, it is necessary to compare the reconstructed tree with the underlying tree based on a sound measure of similarity between two phylogenetic trees. for this purpose, we investigate the similarity between the two phylogenetic trees by using two methods:  symmetric difference of robinson and foulds  <cit>  is defined as the total number of partitions that are on one tree and not on the other. we use this measure as a metric of success in reconstructing the topology of the phylogenetic tree.  nodal distance  <cit>  takes into account the branch lengths and computes a similarity metric by comparing the sum of distances of every node pair in each tree. we use this method to evaluate the performance of algorithms in capturing the evolutionary distances between different networks.

comparison of performance with other methods
we compare the performance of mophy in reconstructing the correct phylogeny to that of four alternate methods

• rdl: an existing method for network-based phylogeny reconstruction, which uses relative description length to assess the similarity between networks  <cit> .

• random modules: this method implements an algorithm similar to that of mophy, but it uses random groups of proteins as modules. these random modules are selected in a way that they reflect the modules incorporated by mophy in terms of their quantity and size distribution. we use this method as a reference method to assess the contribution of the information on modularity in reconstructing the correct phylogeny.

• only protein similarity: this method incorporates only the similarities between proteins to reconstruct a phylogenetic tree. namely, we still compute feature vectors for each network, but each entry of the feature vector represents the conservation  of a single protein. the purpose of using this method as a reference is to assess the contribution of the use of network information  in reconstructing the correct phylogeny.

• random homolog selection: in this method, we investigate the impact of the assessment of homology on the performance of mophy. namely, homologous proteins across different species are chosen randomly instead of using sequence similarity of proteins. by the comparison of mophy against this method, we aim to verify that the assessment of conservation in mophy is not arbitrary; mophy rather makes effective use of sequence homology to assess conservation of network modules.

the comparison of the performances of these methods over five different instances, obtained through simulation of network evolution, is shown in table  <dig>  as seen on the table, mophy performs drastically better than any of the four alternate methods in terms of minimizing the nodal distance between the correct evolutionary history and the reconstructed evolutionary history. furthermore, the random modules method performs clearly better than rdl, suggesting that incorporation of network proximity, i.e., aggregation of interactions, is more useful than incorporation of network topology, i.e., incorporation of single interactions, in capturing the similarity of networks. however, comparison of the performances of random modules and only protein similarity suggests that, when modularity is not considered, incorporation of network information provides marginal improvement. results obtained by using random homolog selection method are also significantly less accurate as compared to those obtained by mophy, indicating that mophy makes use of homology information provided by sequence similarity effectively.

design parameters and module selection
in mophy, the module identification process can be tuned by adjusting several parameters:  the threshold on proximity adjusts the trade-off between the tightness and comprehensiveness of modules . since the interactions in the simulated networks are unweighted, we use diameter, i.e., the maximum distance between two proteins in a module, to represent the proximity threshold.  as multiple modules are identified in each network, using all modules in phylogeny reconstruction may lead to problems associated with high-dimensionality. therefore, we investigate the effect of network coverage provided by the modules considered, where coverage is defined as the percentage of proteins included in the selected modules.  in order to understand which modules are more informative, we consider two different module selection strategies: most specific, i.e., the set of smallest  modules for a given coverage or most comprehensive, i.e., the set of largest modules for a given coverage.

performance of mophy for different parameters
detailed statistics on the comparison of underlying and reconstructed phylogenetic trees for systematic experiments on simulated instances are shown in tables  <dig>   <dig>  and in figure  <dig>  to evaluate the performance of mophy statistically, we evaluate the statistical significance of its performance with respect to the random modules method. the performance difference between mophy and random modules can be thought of as an indicator of the usefulness of relying on conservation of modular network structures as opposed to arbitrary  proteins and their interactions. we quantify the statistical significance of the performance difference between mophy and random modules based on student's t-test to compare the means of two populations. the p-value for an experiment gives the probability that an algorithm that incorporates sequence conservation and network proximity, but not modularity can achieve as good as mophy solely based on chance. as seen in table  <dig>  for any configuration of parameters, the accuracy of the topology of the phylogenetic tree reconstructed by mophy is highly significant. in general, more specific  modules appear to be more informative. indeed, as seen in table  <dig>  when evolutionary distances are considered, the performance with more comprehensive  modules is not statistically significant. furthermore, performance degrades with increasing diameter , suggesting that conservation of tightly coupled modules is more informative in reconstructing evolutionary histories. the effect of coverage on performance is shown in figure  <dig> and  <dig>  when more specific modules are used, the effect of coverage on performance is marginal. this indicates that careful selection of a concise set of small, tightly coupled modules may be adequate to reconstruct network phylogenies accurately. finally, it is interesting to note that the randomized method performs better with large clusters, which is probably due to the increased likelihood that a random group of proteins will contain an informative subset of proteins.

robustness against noise and missing data
currently available ppi data is likely to be highly noisy and incomplete. hence, we evaluate the robustness of mophy against random noise and incompleteness of data. for the purpose of observing the effect of noise, after generating the networks via simulation of network evolution, we randomly perturb the resulting networks by repeatedly swapping randomly selected interactions. furthermore, in order to evaluate the effect of missing interactions in our experiments, we apply two interaction removal strategies, namely uncorrelated and correlated removals. for the uncorrelated removal method, a certain percentage of protein interactions in each separate network is removed randomly. whereas for the latter removal method, if an interaction is selected for removal from one network, then one of the interactions among the homologs of the interacting proteins is also removed from all the other networks where it exists.

the behavior of the performance of mophy with respect to noise rate  and missing interactions is shown in figure  <dig>  these experiments are performed for diameter =  <dig>  coverage = 60%. as seen in the figure, although the accuracy of mophy decreases with noise and missing interactions as expected, the performance difference between mophy and the randomized method is significant even at the presence of 50% noise or 40% correlated missing data.

this observation suggests that mophy can be used to extract meaningful information on evolutionary histories of networks even when the networks are highly noisy and incomplete. on the other hand, the performance of mophy degrades more rapidly with increasing number of uncorrelated missing interactions. this is expected since in the case of uncorrelated missing interactions, after a sufficient number of interactions are removed, the network distance between the homologs of two interacting proteins in one species becomes infinite in the network of another species.

however, as evident in figure  <dig>  mophy's performance is significant  with respect to the random algorithm even when 20% of the interactions are removed from the networks at random. moreover, note that the performance of the randomized method is not affected by noise, and the performance of mophy becomes equivalent to that of the randomized method at the presence 100% noise . these results indicate that the biological signals captured by mophy depend on network topology and the use of network proximity and modularity provide significant information on conservation of function that is beyond sequence similarity.

results on extant ppi networks
we test our method on the available ppi networks from seven diverse species. the ppi data is obtained from the database of interacting proteins   <cit> . these networks include those of d. melanogaster , s. cerevisiae , e. coli , c. elegans , h. pylori , and m. musculus . although the network sizes in this database vary dramatically for different species, mophy can effectively deal with such incompleteness by considering each pair of species separately and considering the conservation smaller network's modules in the larger network .

to reconstruct the phylogeny of these seven networks via mophy, we use the most specific modules that contain at least three proteins and set the coverage to 50%. while identifying homolog proteins, we set the blast e-value threshold score ω to  <dig> . as in our experiments on simulated data, we compare mophy with four alternate methods;  rdl,  using random modules,  using only protein similarities, and  random homolog selection method. for reference, we also consider the phylogenetic tree that is reconstructed based on sequenced genomes  <cit> , which is shown in figure  <dig>  the phylogenetic trees reconstructed based on the seven ppi networks by mophy, rdl, using only protein similarities, using random modules and random homolog selection method are shown in figures  <dig>  , , ) and  <dig> respectively. unlike other methods, the tree reconstructed by mophy complies well with common knowledge on the underlying phylogeny of these seven diverse species and is also consistent with the whole genome based phylogeny. it should be noted that, as evident in figure  <dig>  network-based distance measures tend to overestimate evolutionary distances between extant species. therefore, methods for normalizing the estimated distances between networks are necessary.

incidentally, these results also provide evidence supporting the coelomata topology in the coelomata vs. ecdysozoa debate regarding the evolutionary relationship between nematodes, anthropodes, and vertebrates, which has also been supported recently through rigorous analysis of the conservation patterns in intron positions  <cit> . it is worth to note that, due to limited availability of data, ppi networks differ significantly in size from one species to another. this actually introduces a lot of artificial variation between networks, which might, on a common graph measure, overwhelm desired biological signals. indeed, as seen in figure  <dig>  rdl is significantly affected by the variability in data availability; it assigns mouse ppi network to the same clade with prokaryotic networks, presumably because the interaction data for this species is quite limited. on the other hand, by focusing on the signals harbored by some more informative modules, we avoid the interference of this global difference among networks. the discriminative power of mophy suggests that functional modules identified on ppi networks are important carriers of evolutionary messages. these functional hotspots convey some information beyond that of the apparent graphical variation among the networks, which help overcome the artificial bias commonly introduced to ppi networks by noise or unavailability of protein-protein interactions.

CONCLUSIONS
in this paper, we propose a phylogenetic framework for analyzing modularity in protein-protein interaction networks. our approach is motivated by the premise that biomolecular interactions and their modularity are likely to provide direct functional information on the evolution of biological systems. we also develop a method based on the simulation of network evolution to evaluate phylogenetic tree reconstruction methods. comprehensive experimental results on simulated, as well as real data show that our algorithm is highly successful in reconstructing the underlying phylogenies based on ppi networks, is quite robust to noise, and performs significantly better than existing network-based phylogeny reconstruction algorithms on available protein-protein interaction data. these results demonstrate the promise of modularity-based approaches in comparative network analysis and motivate the study of the evolution of network modularity within a phylogenetic framework.

authors' contributions
se and xl contributed equally to the manuscript. all authors contributed in the planning of the study and development of algorithms. se, xl and gb implemented and tested various parts of the framework. jl and mk coordinated the study and drafted the manuscript. all authors contributed to finalize the manuscript. all authors read and approved the final manuscript.

