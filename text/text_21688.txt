BACKGROUND
cell shape varies widely across bacterial species and has been linked to a diverse range of processes including adhesion, motility, pathogenicity, and differentiation  <cit> . the cell wall, a polymer network of sugar strands crosslinked by short peptides, is both necessary and sufficient for defining a particular cell shape  <cit> . the precise morphology and size of a cell is determined by the equilibrium between cell-wall mechanics and the turgor pressure caused by the high concentration of osmolytes inside the cell. cell shape is maintained via feedback between the spatial pattern of cell-wall synthesis and the cell’s current geometry. in many rod-shaped organisms, especially those that grow by inserting cell wall material along the cylindrical region of the cell, the spatial pattern of growth is dictated by the cytoskeletal protein mreb  <cit> , an actin homolog that forms filaments bound to the inner membrane  <cit> . cell volume is positively linked with fitness  <cit>  and increases exponentially with growth rate on different nutrient sources that vary growth rate over a wide range  <cit> . moreover, in long-term evolution experiments with escherichia coli, cell volume more than doubled in all evolved lines after  <dig>  generations  <cit> . thus, an outstanding challenge in biology is to understand the mapping between genotype and morphological phenotypes.

to achieve such an understanding requires accurate quantification of cell morphology, particularly for very subtle changes such as the sub-micron curvature preference of mreb  <cit> . several computational tools were previously developed to quantify cell shape  <cit>  in order to investigate intracellular organization and size homeostasis. the first software to interpolate cell contours at subpixel resolution was psicic  <cit> , which has generally been applied to precisely quantify the subcellular localization of proteins. simulations of point spread functions and their effects were combined with diffraction-limited imaging to achieve generational tracking and superior cell-division classification using objectj  <cit> . another software package, microbetracker, enabled segmentation of cells within a dense population  <cit> ; microbetracker and its successor oufti  <cit>  were recently used to investigate the relationships among growth rate, elongation, and division in e. coli  <cit>  and caulobacter crescentus  <cit> . for rod-shaped bacteria, most quantitative studies involving cell size have essentially studied the dynamics of cell length, since cell width is generally maintained during elongation. however, e. coli b/r cells that experienced a nutrient upshift from minimal to rich medium increased in cell width progressively over a few doublings  <cit> , consistent with bulk measurements linking growth rate and cell volume  <cit> . further, mutations in mreb  <cit>  and key cell-wall synthesis enzymes such as pbp <dig>  <cit>  have been identified that alter cell width, and sublethal doses of antibiotics such as a <dig>  which depolymerizes mreb, or mecillinam, which inhibits pbp <dig>  lead to cell-width increases in a concentration-dependent manner  <cit> . finally, osmotic shock subtly alters cell width  <cit> , signifying a change in turgor pressure. these data are evidence that the cell’s ability to determine its width may be important for its regulation of cell growth and fitness. while powerful for many applications, packages such as psicic, microbetracker, and microbej  <cit> , the latter of which has an elegant interface for tracking lineages and measuring sub-cellular localization , require a relatively large number of parameters; measurements of cell width are sensitive to the values of these parameters. critically, our ability to link these subtle shape changes to underlying genotypes and chemical environments relies on accurate, unbiased morphological characterization.

the keio collection of single, nonessential gene deletions in e. coli bw <dig> is a powerful resource for discovering the phenotypes of genes of unknown function  <cit> . a visual screen of the qualitative shapes of the knockouts in this collection revealed only one mutant that was obviously non-rod-shaped  <cit> . ∆rodz cells are round, and it was subsequently found that rodz interacts with mreb . by profiling mutants from the keio collection across hundreds of chemical treatments and environmental conditions, the functions of several genes have been discovered  <cit> , such as the lipoprotein co-factors lpoa/b that activate the bifunctional penicillin binding proteins pbp1a/b, respectively  <cit> . this chemical-genomics approach can be used to cluster genes whose functions are related by virtue of a common pathway. given previous discoveries of close connections between cell size and growth rate  <cit>  and size and fitness  <cit> , measuring cell shape and size in distinct environments will likely reveal the mechanisms of growth regulation. moreover, imaging data may constitute a phenotype vector for individual cells or populations of cells containing multiple morphological features such as cell width and length, curvature, and polar morphology  <cit> . a preliminary analysis of cell shape classified mutants in the keio collection as short, normal, long, or very long . however, detailed features such as cell width, size variability, or polar morphology have been difficult to accurately measure due to computational and software limitations.

to quantify various aspects of cell morphology, a software platform must accurately and robustly identify changes in cell width and curvature, ideally with high computational efficiency on imaging datasets from large libraries of strains. the focus of many existing software packages has been on defining a cell contour that can be used for comparing intracellular localization patterns or for computing the dynamics of a global parameter such as cell length. datasets estimating local cell geometry with high accuracy can enable machine-learning tools to identify low-dimensional representations of cell shape and may reveal novel biological principles connecting cell shape to other behaviors. principal component analysis  was previously harnessed to analyze the cell contours of populations of cells, leading to the identification of cell-shape modes in the bacterium c. crescentus  <cit>  and in keratocytes  <cit> . for c. crescentus, pca enabled the clustering of mreb mutants  <cit> , while for keratocytes, distinct pca modes were strongly correlated with motility characteristics such as speed or turning  <cit> . in previous studies, we developed software tools to analyze cell shape in a variety of contexts. using phase-contrast images, we measured the changes in cell width and length resulting from point mutations in mreb  <cit> ; we verified that the changes in cell width correlated with the distance between peaks in fluorescence of a membrane dye on opposite sides of the cell  <cit> . in another study, we previously measured the curvature of e. coli cell contours and showed that mreb localized to concave regions of the cell  <cit> , targeting new cell-wall growth to these locations and straightening the cell. when we measured the correlations among cell size, cytoskeletal dynamics, and cell twisting for cells with a range of sizes generated via genetic or chemical perturbations, we found that cells systematically altered cell-wall structure as cell width increased  <cit> . in a morphological screen of the effects of depleting essential genes in b. subtilis, partial depletion led to cell-width outliers that highlighted both shape actuators  and modulators   <cit> . however, the molecular mechanisms that regulate cell size are currently relatively unknown, motivating an unbiased examination of a genomic-scale library.

here we present cell-shape measurement tools in a user-friendly, computationally efficient matlab-based package called morphometrics. this software segments cell contours from phase contrast images, fluorescence labeling of the cell surface, or cytoplasmic fluorescence, without assumptions about cell shape or size. once cells have been identified, cell contours are determined via a straightforward, essentially parameter-free algorithm that yields robust measurements of cellular dimensions and contour curvature, allowing for automatic characterization of mutants with subtle variations in morphology. since judging the accuracy of contour detection requires the ability to measure cell shape from images of cells with known size, we also present a separate software platform, blurlab, that generates simulated fluorescence microscopy images  <cit> . while other software tools have been developed to generate fluorescence images for predefined shapes and structures  <cit> , blurlab addresses arbitrary distributions of fluorescent molecules in space and time and has the capacity to mimic a wide variety of techniques, features, and sources of noise in light microscopy. in the current investigation, we used morphometrics to measure cell size from phase contrast and fluorescence images, and blurlab to validate our measurements and to determine the relative shifts in cellular dimensions between imaging modalities. we then applied morphometrics to quantify cell shape and size across ~ <dig>  images of the keio collection, revealing an inverse correlation between cell width and the robustness of cell-shape maintenance. finally, we demonstrated that cell-shape parameters such as width and length correlate with particular chemical sensitivities. ultimately, we envision that morphometrics and blurlab will provide fast, reproducible quantification of cell shape as well as the ability to test quantitative models, thus complementing canonical tools for biochemistry and cell biology.

implementation and 
RESULTS
assessment of the consistency of cell contours determined by different imaging modalities
to facilitate quantitative analysis of contours from cells with a wide variety of shapes and sizes, we sought to implement an algorithm that made no assumptions about specific cell shapes and that extracted a parameter-free contour not subject to user biases. the morphometrics algorithm can be conceptualized in two stages. first, with a small number of user-defined parameters, discrete ‘objects’ are detected as contiguous groups of pixels through watershed and distance-transform segmentation. second, a smooth parameter-free contour defining the boundary of each object is calculated by treating the image intensity as a metric surface on which contour ‘energy’ can be minimized, with the segmented object boundary as an initial contour guess. further information about the algorithm can be found in the morphometrics user manual included with the software download. three types of images can be used for contour detection: i) phase contrast images, in which the cell interior appears dark; ii) interior fluorescence images, e.g. from uniformly distributed cytoplasmic fluorescent proteins; and iii) peripheral fluorescence images, e.g. from membrane dye. calculating the magnitude of the image gradient transforms the first two image types into an intensity map similar to that given by a fluorescence marker on the surface, which constitutes the common basis for calculating contours.

after optional image scaling, contrast adjustment, and background removal, the software offers multiple algorithms for segmenting contiguous groups of pixels  that meet specified constraints on size and intensity. each object is checked against criteria for false-positive detection based on the ratio of interior to boundary pixel intensities and, depending on user input, these objects may be linked with objects in other frames for tracking across a set of time-lapse images . parameters may be tested on individual images before being applied to the processing of large data sets. ultimately, each segmented region serves as a seed to begin contour fitting. once a contiguous object composed of discrete pixels is identified, a contour is calculated by treating the intensity features of the object as an interpolated energy landscape and then fitting a closed-loop contour in continuous coordinates to the minima of that energy landscape. from the cell contours, morphometrics can be used to calculate an interior mesh; for rod-shaped cells, this mesh defines a cellular coordinate system with a midline and associated perpendicular meshlines that connect the two sides of the cell, thereby also measuring local cell width along the midline. the contour is also used to calculate one-dimensional profiles such as curvature , fluorescence signals along the cell boundary , or fluorescence signals along the interior centerline of the cell, among other features. optical shifts between fluorescence imaging channels can be corrected by translating the contour coordinates by an amount appropriate to the particular imaging system; these translation values can be determined visually using the included post-processing contour viewing software.

to illustrate the capabilities of morphometrics for contour detection, we stained e. coli cells expressing cytoplasmic gfp with the surface marker alexa 594-conjugated wheat germ agglutinin  <cit>  and imaged the cells using phase contrast and epifluorescence microscopy . morphometrics successfully segmented isolated and dividing cells  from all three imaging modalities , interior fluorescence , and peripheral fluorescence ), leading to three sets of contours, with the pf contour exterior to the if contour as expected . the meshlines for these cells  define a cellular grid that can be associated with regions of the contour or cell midline that show positive or negative curvature .fig.  <dig> quantitation demonstrates consistency among contour measurements from different imaging modalities, despite small differences. a
e. coli cells imaged using phase contrast , interior fluorescence  from cytoplasmic gfp, and peripheral fluorescence  from the surface marker alexa 594-wheat germ agglutinin. top: original images; middle: segmentation output from morphometrics; bottom: extracted contours and meshlines. the pole from which all contours are measured is marked by orange and maroon dots for the beginning and end of the contours, respectively. meshlines are colored cyan if the cell contour has positive  curvature at both endpoints, maroon if the contour has negative curvature  at both endpoints, and yellow if the contour has opposite signs of curvature . scale bar: 5 μm. b overlay of the pc, if, and pf cell outlines from . c branching mesh  and centerline mesh  of the cells in , using the pf contours. these meshes are used to measure width profiles along the cell. d comparison of the single-cell width profiles from pole to pole among all three imaging modalities for the cell on the left in . pc contours consistently estimate larger widths than pf or if contours. e the pc, if, and pf contours have similar curvature profiles, with slight differences consistent with width differences in . f differences in cell-length measurements among imaging modalities are consistent across a wide range of cell lengths. in the legend, the first and second modality for each color correspond to the measurements along the y- and x-axes, respectively. black line is y = x. g in cell area measurements, differences in length between imaging modalities shown in  are exacerbated due to width-dependent offsets in cell widths between imaging modalities, as shown in 




from these cells and their associated meshline grids, we measured width profiles along the midline, obtaining values that increased from  <dig> at the two poles to ~1 μm near the middle of the cell . as previously reported  <cit> , there was little intracellular variability in cell width along the midline away from the poles, and all three profiles showed similar variability . the contour measurements represented an approximately cylindrical body with hemispherical endcaps , although all three contour measurements displayed slight variations in curvature  that were previously shown to correlate with mreb localization  <cit> .

pc, if, and pf images are expected to provide distinct positions of cell boundaries. across many cells, there were strong correlations among length measurements from the three modalities; lengths from pc images were consistently larger than those from if or pf images by ~400 nm . similar comparative behavior was observed in cell width measurements . the combined effects of shifts in width  and length  led to an increasing divergence in the area measurements of the three imaging modalities across many cells . nonetheless, all three imaging modalities were highly correlated, indicating a consistent picture of cellular dimensions that can be applied to wide variety of organisms. to demonstrate the utility of morphometrics for unbiased contour detection across a wide range of object shapes, we analyzed pf images of the root tissue of arabidopsis thaliana plants , pf  and pc images  of curved rod-like caulobacter crescentus, pc images of red blood cells , brightfield images of budding yeast saccharomyces cerevisiae , pc images of dense pseudomonas aeruginosa communities , transmission electron microscopy images of neisseria gonorrhoeae , pc images of branched bifidobacterium breve dsm <dig> , brightfield images of zebrafish , and if images of filamentous e. coli . in all cases, morphometrics successfully segmented the cells or organisms, regardless of shape or imaging modality.fig.  <dig> 
morphometrics achieves unbiased contour extraction across a wide range of cell shapes and object types, including densely packed communities and tissues. a contours extracted from the root-tip cells of an a. thaliana plant expressing a yfp-fusion to the membrane protein lti6b, showing that morphometrics is capable of segmentation of a complex tissue. scale bar: 15 μm. b, c contours extracted in pf mode  or pc mode  from fm4-64-labeled c. crescentus cells. d contours extracted in pc from approximately spherical hypotonic red blood cells. e contours extracted in pc from the budding yeast s. cerevisiae. f contours extracted in pc from a densely packed p. aeruginosa community. g contours extracted from transmission electron microscopy images of n. gonorrhoeae. h contours extracted in pc from branched b. bifidum dsm <dig> cells. i contours extracted from bright-field microscopy of live zebrafish danio rerio. j contours extracted in if from filamentous e. coli expressing cytoplasmic gfp




simulated fluorescence microscopy for validation of quantitative analyses
given the differences in cellular dimensions extracted from pc, if, and pf data , we wondered which modality accurately represented cell size. other experimental methodologies with higher resolution such as electron microscopy still do not provide a “true” measure of cell size, since sample preparation likely perturbs the cell, for example by disrupting turgor pressure. to identify a strategy for comparing measurements with known geometric parameters, we developed blurlab, a software package that generates simulated fluorescence images. blurlab takes as input a set of locations of fluorescent molecules and convolves these locations with a point spread function  to generate a simulated image. the psf can be directly measured for a particular microscope and objective using sub-diffraction-limited particles such as quantum dots or fluorescent beads; alternatively, blurlab can generate a psf for a given set of objective parameters . blurlab can also mimic camera noise, thermal noise, and shot noise, yielding simulated images that are more realistic for head-to-head comparison with experimental images. additional blurlab functionalities include simulation of imaging at other focal planes for creating z-stacks, modeling total internal reflection fluorescence imaging, boxcar averaging of positions during simulated time-lapse imaging to account for particle motion during the exposure interval, simulating mean-field and stochastic photobleaching, and simulating fluorescence recovery after photobleaching. detailed descriptions of these functionalities and examples can be found in the blurlab manual.

to validate cellular dimensions and morphological features of e. coli cells, we used blurlab to generate sets of uniformly distributed molecules at high density on the surface of cylinders with hemispherical endcaps over a range of cell widths and lengths. for an in silico cell with width 1 μm, we also simulated images of the same cell at focal planes up to 500 nm above and below the cell midplane . as the cell goes out of focus, the image attributes used for contour fitting become blurred by the psf. nonetheless, a bright boundary, the signature of surface-bound fluorescence, was evident in each image . we then applied morphometrics to each simulated image and successfully resolved a cell contour at each z-offset. the width measured from these cell contours peaked at the midplane and monotonically decreased as the offset from the cell midplane increased . these data illustrate the importance of midplane focus, and provide an estimate of the deviation in width measurement when using out-of-focus cells. interestingly, these data also show that the measured cell width  is more robust to changes in the focal plane than the actual cell width at a given focal plane .fig.  <dig> simulated fluorescence images permit quantification of the accuracy of cell-geometry measurements. a simulated fluorescence images of uniform surface labeling of an in silico cell with width 2r = 1 μm and length 4 μm. the focal plane of each image relative to the cell midplane is indicated. scale bar: 5 μm. b the measured width  of the middle cell in  at different offsets relative to the midplane, does not vary as strongly as the actual width  at that focal plane. c-e
blurlab permits the precise quantification of errors in geometry measurements from extracted contours and meshlines , width profiles , and curvature profiles  for cells of different radii r. scale bar in : 5 μm. the colors of the meshlines in  are maintained in . dashed curves in  are the actual values for the in silico cells.  width  and area  display a systematic bias for narrow cells relative to the lines of equal measured and actual area . this bias is negligible for cells with width above ~ <dig>  μm. h conceptual flow chart of the utility of blurlab for quantitative comparison of experimental and simulated images to test the validity of an underlying model 




next, we examined the contours extracted from simulated images of in silico cells with different widths . the error in the extracted contour was practically zero for widths greater than 2 μm, but increased as cell width decreased . the extracted contours were smaller than the true midplane contours because the cell curvature introduced light from out-of-focus planes in which the cellular cross-section had a smaller width; for cell widths much larger than the wavelength of light used for imaging, this curvature became negligible . to determine the accuracy of other geometric measurements, we computed the curvature along the cell contour. the curvature along a 2-μm in silico cell was relatively accurate everywhere except in the transition region between the cylinder and the hemispherical end caps , where the psf blurred the step-function curvature into a smooth transition. for a 1-μm in silico cell, the curvature remained accurate along the cylindrical portions of the cell , although there was a slight overestimate of the curvature at the ends of the cell ; this error was exacerbated as the cell width was further narrowed . we note that these systematic morphological errors with decreasing cell size result from the limitations of light imaging at wavelengths comparable to the cell size, not from imprecision in fluorescence simulation or contour detection.

to evaluate the overall bias, we used blurlab to compute the difference between the actual and measured widths and areas for in silico cells 400 nm to 8 μm in width and a range of cell lengths in the peripheral fluorescence modality. the error in the width asymptotically approached zero, and was essentially undetectable in cells with width above ~ <dig>  μm . error in area behaved in a similar fashion, regardless of cell length , indicating that pf measurements provide an accurate measure of cell length without systematic bias. this application illustrates the intended purpose and power of blurlab: to assess the accuracy of imaging data in the context of a particular model by consistently comparing analyses of both experimental and simulated images .

morphological analysis of a genomic library of nonessential gene deletions
to demonstrate the efficacy of morphometrics for rapid quantification of bacterial morphology, we analyzed ~ <dig>  images of the keio collection, a collection of single knockouts of all non-essential genes in e. coli  <cit> . we obtained phase contrast images from the national bioresource project and segmented isolated cells from each strain in an unbiased manner . mean cell width varied from ~ <dig>  to  <dig>  μm, and mean cell length varied from ~ <dig>  to 4 μm . interestingly, mean cell width and length were strongly correlated with each other , as were mean cell width and length standard deviation . from our data, we determined the distributions of morphological parameters such as mean width and length across the population of cells for each strain. moreover, we utilized the meshing of each cell to measure the local cell width , from which we calculated the mean variability in cell width within individual cells in the population. both the standard deviation across the population  and the intracellular fractional width variability  increased with mean cell width, indicating that cells are increasingly unable to maintain cell width as they widen. interestingly, although wild-type e. coli cells increase in cell size with nutrient-induced increases in growth rate  <cit> , we found no significant correlations between maximal growth rate  and cell width  or length . we note that these results are not contradictory; for example, a previous study showed that cell size is not correlated with growth rate within a population of cells  <cit> .fig.  <dig> morphological analysis of the keio collection reveals correlations between morphological features but not with growth rate. contours from > <dig> cells per keio deletion strain were extracted from images acquired from the nbrp repository and used to compute the mean length and width and standard deviation of cell width across each population. in , white circles and error bars were obtained by binning strains by mean width or length; blue lines are the fit to binned averages. r is pearson’s correlation coefficient. a-b heatmaps of the number of strains with geometry parameters in each bin show that mean length  and standard deviation of mean width  are positively correlated with mean width. c-d neither mean width  nor mean length  are correlated with maximal growth rate, as measured from microplate growth curves in  <cit> . e-h top: representations of the pca modes around the mean shape. modes 1– <dig> represent elongation, bending, width, and tapering, respectively. bottom: scatter plots of the proportion of modes 1– <dig> and mean cell width of each strain demonstrate that width is correlated with variation represented by modes  <dig>   <dig>  and 4




to identify other morphological correlations across the library or in particular strains, we aligned  <dig> cell contours from each strain of the keio collection for which at least  <dig> contours were available in order to calculate an average cell shape, and performed pca on the covariance matrix to identify significant shape variations. the first two, three, and four pca modes accounted for  <dig> %,  <dig> % and  <dig> % of variation in cell shape, respectively , and by far the greatest amount of variation was accounted for by a mode that clearly captured elongation . this result, which is not surprising for rod-shaped growth, indicates that length changes are the most significant source of shape variation within the keio library. nonetheless, the next three modes representing cell bending, widening, and tapering, respectively , have potential for revealing cells or strains that are shape outliers. mean width strongly correlated with pca mode  <dig>  and with the projection from mode  <dig>  , as expected based on the correlation between length and width noted above . there was also a significant correlation between mean width and mode  <dig>  , potentially indicating a connection between cell-width determination and cell division. our analysis demonstrates that most of the variation in cell shape is captured by length and width, although other morphological features such as tapering may be informative for characterizing certain outlier strains. pca of the correlation matrix, which involves rescaling that avoids heavy skewing by cell length variation, led to an increased emphasis on cell width, bending, and tapering in the decomposition, with the mode corresponding to the largest eigenvalue representing tip morphology . taken together, correlations among features suggest underlying feedback between elongation and division in rod-shaped cells  <cit> .

identification of chemical sensitivities correlated with cellular dimensions
given the range of cellular dimensions across the keio library and the correlations between morphological observables, we wanted to systematically probe the physiological significance of cell size. we previously found that the mreba53t mutation led to wider cells during growth in a variety of carbon sources; cells harboring this mutation had a large gain in fitness when competed against the parental strain in glucose-rich medium  <cit> . however, the change in fitness was carbon-source dependent, with neutral fitness in lactose and a reduction in fitness in galactose  <cit> . we also previously observed that sublethal treatment with the mreb inhibitor a <dig> led to a dose-dependent increase in cell width in wild-type e. coli mg <dig> cells  <cit> . based on these data and the increase in width variability with increasing mean cell width across the keio collection detected here , we hypothesized that wider cells may be more sensitive to a <dig> than thinner cells, and more generally that morphological observables may be predictive of the severity of phenotypes in certain environments or chemical treatments.

to test these hypotheses, we made use of an existing chemical genomics dataset  <cit>  in which the keio collection was grown as colonies on agar plates in  <dig> conditions including media, drugs, dyes, detergents, metal stresses, and hormones. from the colony sizes, a statistic called an s-score was previously computed to represent the severity of the growth phenotype in each condition  <cit> ; a positive/negative s-score indicates more/less growth than expected based on the changes to wildtype in the condition of interest . we compared our quantification of cellular dimensions with the previously reported s-scores from treatment with  <dig>  μg/ml a <dig> for each knockout, and detected a significant correlation between cell width and s-score , consistent with our hypothesis. we then wondered whether other chemical or environmental perturbations were correlated with mean cell width or length. we calculated the correlation coefficients of these quantities with each of the  <dig> condition datasets  and determined statistical significance with a bonferroni correction for multiple hypothesis testing . for cell width, a <dig> treatment was the most significant negative correlate; six other compounds  also exhibited significant negative correlation   <cit> . of these compounds, three also targeted cell-wall synthesis , possibly indicating inhibitory effects similar to those of a <dig>  the list also included compounds targeting the membrane or proton motive force  and translation  , indicating potential links between cell-width control and other metabolic processes.fig.  <dig> morphological parameters predict certain chemical sensitivities.  schematic of s-score interpretation and strategy for correlating with cell-shape parameters. gene-condition pairs that result in bigger  colonies, normalized to the size of a wild-type colony in the same condition, than expected based on average size across all conditions have positive  s-scores.   after  <dig>  μg/ml a <dig> treatment, s-scores of keio-collection knockouts were negatively correlated with mean cell width across populations of cells of each strain, indicating that wider strains are generally more sensitive to a <dig>   s-scores after treatment with  <dig>  μg/ml ceftazidime, a cephalosporin division inhibitor, were negatively correlated with cell length, indicating that longer cells are more sensitive to ceftazidime. p-values computed with student’s t-test.  the distribution of correlation coefficients with  mean cell width and  length across the  <dig> conditions screened in  <cit> . red bars highlight conditions with statistically significant correlations, bonferroni corrected for multiple hypothesis testing.  connections between clusters of orthologous groups  and drugs that target particular processes. a connection is defined by a statistically significant correlation between cell width  or length  and s-scores for knockouts of genes within the cog class indicated in the rectangles.  examples of cog-specific correlations, with the colors of the dots and best-fit line the same as the appropriate cog rectangle in . p-values computed with student’s t-test.  sensitivity to  <dig>  μg/ml a <dig> is negatively correlated with cell width in knockouts of genes related to signal transduction.  sensitivity to  <dig>  μg/ml verapamil  is negatively correlated with cell width in knockouts of genes related to the cell cycle.  sensitivity to  <dig>  μg/ml minocycline  is positively correlated with cell width in knockouts of genes related to nucleotide metabolism and transport.  sensitivity to  <dig>  μg/ml gentamycin  is positively correlated with cell length in knockouts of genes related to post-translational modification, protein turnover, chaperone functions




there were  <dig> unique conditions for which the knockouts had s-scores with significant positive correlation with cell width   <cit> , indicating that wider cells were less sensitive. these conditions target a broader range of cellular processes, including dna/rna, stress, and fatty acid metabolism in addition to the ribosome and cell-wall and membrane synthesis   <cit> . carbonyl cyanide m-chlorophenyl hydrazone, a proton ionophore that inhibits oxidative phosphorylation, was positively correlated at all tested concentrations   <cit> ; interestingly, we observed in a separate study that this ionophore increases bending rigidity, which is an expected outcome of increased cell width based on the mechanics of a thin cylindrical shell. there was also a compound  with an unknown target that exhibited a significant positive correlation with cell width   <cit> , indicating that cell-size profiling may be an effective tool for associating chemical exposure with the molecular pathways that control cell morphology.

we next considered correlations of s-scores with cell length. six conditions were associated with significant negative correlations : high iron, treatment with the cell-wall inhibitor ceftazidime, and four carbon-source limitations, which may reflect the known coupling of cell size with nutrient-dependent growth rate  <cit> . of the eight conditions positively correlated with length , several involved ribosomal inhibitors , inhibitors of fatty acid and membrane synthesis , or dna/rna synthesis . in some cases, correlations indicated differences in the underlying mode of drug action; for example, the cephalosporin cefaclor was positively correlated with cell length, while the structurally similar compound ceftazidime was negatively correlated with length.

given that the observed correlations between cell size and s-scores involved chemicals with many target processes, we conjectured that the correlations for subsets of strains deleted for genes with similar functions may yield further insight into the relationships between cell size and cellular processes. we separated genes into  <dig> clusters of orthologous groups, a common classification scheme  <cit> . as compared to the correlations from the full library , we detected higher correlations between cell size and s-scores within some of these gene clusters   <cit> . a <dig> again was significantly  and negatively correlated with cell width for strains harboring deletions of genes associated with signal transduction mechanisms , indicating that signaling pathways, such as those activated in response to stress, may respond to the changes in cell width caused by a <dig> treatment. although the cog for cell-cycle control, cell division, and chromosome partitioning comprises only  <dig> genes, sensitivity to the division inhibitor verapamil nevertheless exhibited a strong and significant correlation of − <dig>  with cell width , while s-scores for minocycline sensitivity of knockouts of genes involved in nucleotide metabolism and transport were positivity correlated with cell width . surprisingly, for the large number of strains carrying deletions of genes of unknown function , mean cell width was negatively correlated with sensitivity to low iron stress and the folic acid synthesis inhibitor sulfamethizole . strains harboring deletions in genes involved in amino-acid transport and metabolism had mean cell lengths that were negatively correlated with sensitivity to four carbon-source starvations , while cells harboring deletions in genes involved in transcription and post-translational modification, protein turnover, and chaperones had lengths positively correlated with ribosomal inhibitor sensitivity . as with cell width, strains deleted for genes of unknown function had lengths both positively and negatively correlated with some treatments   <cit> , further supporting the importance of these genes to cell shape. taken together, our correlation analyses based on the entire keio collection and subdivided into clusters of orthologous groups suggest that a variety of intracellular factors, beyond those controlling cell-wall synthesis or turgor, contribute to the cell’s determination of its size, and that responses to some extracellular perturbations have general connections with cell size . these correlations were revealed through precise and automated measurements of cellular dimensions that were enabled by our open-source software packages morphometrics and blurlab.


discussion and 
CONCLUSIONS
quantifying subtle connections among environmental conditions, cellular morphology, and genetics is a crucial step in uncovering new biological roles for genes and their corresponding phenotypes. microscopy is a powerful workhorse for establishing these connections, but the spatial constraints of light microscopy and our computational assumptions limit the set of measurable morphological perturbations. we developed morphometrics and blurlab to expand the utility of multiple imaging modalities and to minimize the presence of bias in image-based analyses. here, we applied our software to bacteria, which are a technically challenging class of organisms to explore with quantitative image processing due to their small size and strong connections among fitness, genotype, and morphology. we envision that combining the morphological measurement techniques of morphometrics with the unbiased hypothesis testing of blurlab will enable the quantitative and automated characterization of libraries targeting cell morphology ) as well as the growing collection of genomic libraries, including knockout libraries of salmonella typhimurium  <cit>  and transposon-based libraries of the pathogen pseudomonas aeruginosa  <cit>  and the gut commensal bacteroides thetaiotaomicron  <cit> . the relationships we discovered among cell length, cell width, and width variability  across the genomic-scale keio collection suggest general links between cellular physiology and cell size  <cit> . screens that used the keio collection to reveal new phenotypes previously focused on growth  <cit>  or envelope permeability  <cit> , both of which naturally led to studies of cell shape. since morphometrics is sensitive to small morphological variations and can rapidly analyze tens of thousands of images, it crucially enables forward genetic screens for genes or mutations that affect a morphological phenotype.

the relatively high throughput and unbiased morphological characterization of morphometrics make it well-suited to the study of morphological and functional connections in genomic libraries, to the screening of environmental conditions like carbon sources, osmolytes, and antibiotics, and to analyses of dynamic cell-cycle data via time-lapse imaging  <cit> . similarly, new rules of cellular homeostasis encoded by time-dependent morphology in many organisms  will be accessible with our software, particularly when spatial resolution is limited. it remains to be seen to what extent detailed measurements of cell morphology will be sufficient to uncover relationships among genotypes, chemical treatments, and cell morphology ; in some cases, lack of shape variation or degeneracies in shape phenotypes may make identification of a morphological signature challenging. for instance, drug treatments and attendant mutations could lead to global changes in gene expression such as a stress response that result in similar non-specific changes in cell morphology .

while we have focused on bacteria, morphometrics is amenable to morphological analysis of any organism for which high-contrast images can be obtained, especially walled organisms like plants   <cit>  and fungi   <cit> . morphometrics has relatively few parameters and makes no assumptions about object morphology, strengths that are important considerations when tuning algorithms to examine new organisms with poorly understood morphology and growth cycles and when developing custom scripts for post-processing, such as the detection of spatial and temporal morphological correlations  <cit> , detailed localization studies  <cit> , and testing of biophysical models  <cit> . the small size of bacteria leads to a smaller visual dynamic range, which makes human observers more prone to apophenia . blurlab has a wide array of potential applications in defining null hypotheses about fluorescence imaging data, such as the expected distribution of a uniform surface label at the poles versus the lateral walls of a rod-shaped cell, the integrated intensity of a homogeneous cytoplasmic label such as 4′,6-diamidino-2-phenylindole  as a function of cell size , and the level of noise in cytoplasmic distributions as a function of molecule number for testing whether noise is spatially heterogeneous. blurlab can be coupled to any analysis platform, and should have growing utility given recent genome-scale screens of fluorescence localization  <cit> . we note that evaluations of null hypotheses should also be important for eukaryotic cells, for which it is equally critical to connect molecular models to diffraction-limited fluorescence images  <cit> .

for large data sets, image processing must be efficient in terms of computational resources and speed. the data structures, algorithms, and graphical user interfaces of morphometrics and blurlab are designed to exploit optimized image processing algorithms in matlab and to allow users to easily construct seamless custom scripts for data analysis  <cit> ; these packages also take advantage of the large body of user-generated algorithms online . additionally, high-level programming languages reduce the barrier to acquire coding skills and ensure that the varied and general needs of the quantitative imaging community for custom analysis can be met. speed limitations in matlab can be resolved by recoding computationally intensive subroutines in c, as we did in morphometrics. while morphometrics and blurlab enable new levels of precision and quantitative morphological characterization, like any analysis software they have certain limitations. ultimately, the precision of contours from morphometrics is limited by i) image quality, specifically spatial resolution, signal-to-noise, evenness of illumination, dynamic range of intensities, and degree of saturation; and ii) sample characteristics such as object contrast, the proximity of objects and attendant overlap in the light fields, the degree of blurring due to motion, and, where fine segmentation is desired, the number and degree of construction points in the image outline. as a general rule of thumb, images that are visually difficult to segment will be difficult for morphometrics to segment. blurlab is a simulator for linear optical microscopy, but specific nuances of an optical system or objective, atypical or time-dependent noise sources, camera chip-specific noise, and sample-dependent effects  all reduce the accuracy of simulation. similar limitations will very likely apply to any image analysis or simulation software.

the importance of quantitation in cell biology will continue to increase, and the small size of bacteria and lack of organelles make both morphometrics and blurlab especially important for identifying subtle localization and morphological phenotypes in these organisms. however, despite the breadth and versatility of morphometrics and blurlab, significant challenges for computational image processing remain, including reconstruction of three-dimensional morphology in both static and dynamic environments, segmentation and tracking of dense and/or highly dynamic groups of objects, and the development of algorithms to process different imaging modalities such as fluorescence recovery after photobleaching, total internal reflection fluorescence, and super-resolution imaging. morphometrics and blurlab should serve as a foundation for developing new software to address these challenges.

precise quantification of cell morphology in bacteria and eukaryotes will undoubtedly be a valuable tool for mapping genotype-phenotype relationships. extending the analysis of static images carried out here to the dynamic response of cells to perturbations, for instance in microfluidic chambers, can further reveal the physiological basis of a particular phenotype, such as the mechanism of cell death during entry into stationary phase in an e. coli mutant with disrupted lipid homeostasis  <cit> . excitingly, cell morphology can even serve as a diagnostic tool for assessing cellular states in diseases such as cancer. to fully exploit the information obtained through these studies, we must develop and implement computational tools with high levels of accuracy and precision and couple them to methods for validation and compelling visual display. as demonstrated here, morphometrics and blurlab constitute an important step toward meeting these goals.

