BACKGROUND
rna sequencing has been one of the first applications of the revolutionary ultrahighthroughput dna sequencing technologies  <cit> . this work has demonstrated the power of deep rna sequencing for determining comparative gene expression and for discovering the full extent of 5' and 3' untranslated regions, novel splice junctions, novel transcripts, alternate transcription start sites, and rare transcripts. in this work, we explore the quantitative power of illumina sequencing-by-synthesis, analyze the same samples using dna microarrays, and extensively validate our results using quantitative pcr. because one of the powerful advantages of new sequencing technologies is the ability to characterize sequence variation, we also determined the accuracy of rna sequencing for discovering sequence variation.

in this study, we examined the use of full length cdna sequencing for measuring differential gene expression in two divergent haploid strains of s. cerevisiae  <cit> . because of the comparable cost of a single lane of an illumina  <dig> g sequencer and a gene expression microarray, we compared the data obtained from one lane of the illumina  <dig> g to a highly replicated collection of 2-channel agilent array data from a study that profiled two divergent strains of s cerevisiae: by <dig> and rm11-1a <cit> . in the present study we sequenced cdna prepared from the same mrna samples used in the microarray study, controlling for both biological variance and variance in mrna isolation simultaneously.

in contrast to gene expression microarrays, which measure gene expression by quantifying the hybridized and labeled cdna, the illumina  <dig> g measures gene expression by sequencing fragments of cdna. the sequencing reads are aligned to a known reference genome sequence, and quantitative gene expression values are obtained by counting the number of these fragments matching a known open reading frame . one of the consequences of the adapter ligation cloning approach used in this study is that strand origin of the expressed transcript is lost. if two genes overlap, one on the watson and the other on the crick strand, their expression levels will be indistinguishable for the region of overlap.

the primary limits of the illumina  <dig> g sequencer are short read length and total number of reads obtainable in a single lane of a sequencing reaction. read length at the time of our study was  <dig> base pairs, and the total number of reads obtainable in a sequencing reaction was about  <dig> million. short read length increases the likelihood of reads that map to multiple locations. if these multiple-mapping reads are not removed, they will contribute mixed signal that does not distinguish expression of different genes. the second limitation, the number of reads, is more problematic given that a small subset of transcripts are highly abundant . these highly abundant transcripts will be sequenced more frequently, leaving few reads for transcripts that are in low abundance. as a result, the low abundance transcripts will be more affected by sampling error. microarray analysis is much less limited by the presence of highly abundant transcripts, because each mrna binds independently to its complementary sequence feature on a microarray.

in addition to quantitative measurement of gene expression, we report initial results showing that full length cdna sequencing can discover heterozygosity and measure allele specific expression  in diploid strains of yeast. many organisms are primarily found in nature as highly heterozygous, diploid individuals. further, many species, including some major crop plants, are descended from multiple hybridization events and are highly polyploid  <cit> . the large, closely related gene families in such species can complicate array analysis but in most cases are distinguishable by sequencing analysis. finally, discovering the genome-wide extent of heterozygosity in any diploid species with a large genome can be impractical by full genome re-sequencing, even with the aid of high throughput sequencing methods. by examining base pairs exlusively within coding regions, we find it is possible to identify heterozygous sites as well as their relative, or allele-specific, expression.

RESULTS
illumina read alignment
the basis of our comparison was a dna microarray array experiment in which the gene expression in two different haploid strains of s. cerevisiae, rm11-1a and by <dig>  in two different growth media was measured using six biological replicates   <cit> . two color agilent arrays were used, with a common reference consisting of a mixture of all of the original conditions and strains. using the same rna samples profiled in the array replicates, we sequenced full length cdna corresponding to each strain and condition with a single lane of the illumina  <dig> g sequencer.

differential gene expression information from the illumina  <dig> g sequencer was obtained by aligning reads to a reference genome and counting the number of reads that overlap each orf. samples were denoted byg, bye, rmg, rme where by indicates strain by <dig> and rm indicates rm11-1a. the lower-case e and g denote two nutrient conditions: ethanol and glucose as carbon sources. we used a simple alignment strategy that assumed a low error rate and determined the alignment with the entire reference genome with the fewest number of differences  of the reads. between  <dig> % and  <dig> % of the reads obtained from a single lane of the illumina  <dig> g sequencer aligned with the reference s. cerevisiae sequence . the by <dig> strain has few differences from the s288c reference strain. using the unfinished assembly of the rm11-1a genome sequence from the broad institute, we found  <dig> genes that were reciprocal best matches with at least 98% sequence identity between the two strains across alignments of orfs, including  <dig> kb upstream and  <dig> kb downstream sequence <cit> . expression values were only computed for these  <dig> genes using the illumina  <dig> g data.

we separated reads into unique reads that aligned to a single location in the genome and reads that aligned to multiple locations. among the reads that mapped to a unique position, we separated reads into those that mapped to an orf, a ribosomal rna  gene, or a transfer rna  gene. we observed that the vast majority of the unique reads originated from orfs . the distribution among multiple-mapping reads was different . among these reads, most originated from rrna genes. even though we reduced the population of rrna in our samples by depleting ribosomal small and large subunit rnas with a lna probe and by using reverse transcription with an oligo-dt primer, between  <dig> %– <dig> % of the total number of reads originated from rrnas . furthermore, one of the consequences of the short read length of the illumina  <dig> g is that reads from rrnas might also align to orfs of protein-coding genes. in the five samples, we found that between  <dig> %– <dig> % of the total number of reads matched both an rrna gene and an orf. a smaller fraction of reads,  <dig> %– <dig> %, aligned to two or more orfs. in all further analyses we used only reads that uniquely align to an orf, including the few reads that mapped to more than one location within a single orf.

statistically significant differential gene expression
to carefully assess the ability of the sequencer to detect differential expression we focused our analysis on the rme and rmg samples, which show significant differential expression between the two environmental conditions, had similar data quality, and contain differences from the reference sequence. analysis of the other samples is summarized in . we obtained  <dig> , <dig> reads for rme and  <dig> , <dig> reads for rmg that aligned to orfs and passed our filtering criteria, resulting in  <dig> genes covered by at least one read. for each orf a digital measurement of expression was obtained by counting the total number of reads that align to it . differential gene expression between rme and rmg was determined by taking the log <dig> ratio of rme to rmg counts, normalizing for the different total number of read counts between the two samples. for the  <dig> genes that passed quality criteria for both the microarrays and sequencer, the resulting ratio was highly correlated  between microarrays and the sequencing data .

we identified the subset of differentially expressed genes for each platform. we detected significant differential expression for  <dig> genes by arrays and  <dig> genes by sequencing, with  <dig> genes detected as differentially expressed by both platforms . the subsets of genes detected as differentially expressed in a single technology had distinct array intensities and read coverage. the subset of genes that were called significantly differentially expressed only by arrays had significantly lower read counts in the sequencing data than the set of all genes examined  as well as significantly lower average array intensity , suggesting that differential expression of genes with low expression levels is detected more readily by arrays. the subset of genes that were called significantly differentially expressed by sequencing alone had higher read counts than the set of all genes examined  as well as higher array intensities , indicating that differential expression of genes with high expression is detected more frequently by sequencing than by arrays.

modeling sampling error for low abundance transcripts
we modeled the effect of counting noise on sequencing-based measurements of differential expression . the scatter plots comparing differential gene expression determined from arrays and from simulated sequencing results predicted from our noise model were similar to what was experimentally observed . both the observed results and simulations show similar increases in correlation when thresholding on the number of reads, indicating that modeling counting error captures most of the noise in the cdna sequencing data . in addition to this comparison between the rme and rmg samples discussed above, we computed all between-strain-within-condition, and between-condition-within-strain pearson correlations for the byg, rmg, rme, and rmg samples . the correlations showed a similar dependence on a threshold on the number of reads obtained from a gene.

investigating differences by qpcr
to better understand the disagreement between the cdna sequencing and array results, we performed qpcr on a large subset of genes. we randomly selected  <dig> genes from genes significantly differentially expressed in the following categories: in the illumina  <dig> g sequencing data only, in microarrays only, and as measured by both technologies. of the  <dig> candidates,  <dig> genes that showed non-specific amplification or unexpected size amplification products were removed from the analysis. qpcr results are highly correlated with both microarrays  and sequencing results . of the  <dig> genes that were significantly differentially expressed in both technologies but where the technologies disagreed on the direction of the change,  <dig> out of  <dig> showed no differential expression by qpcr. because of the number of genes we measured, we were able to examine the discrepant subsets more closely than previous studies <cit> . specifically, we found that the subset of genes recognized as significantly differentially expressed by arrays only was highly correlated with qpcr  whereas as the subset of genes recognized as differentially expressed only by illumina sequencing was moderately correlated with qpcr measurements .

simultaneous discovery of heterozygosity and allele-specific expression
as a prelude to detecting heterozygosity and measuring allele specific expression , we examined the capability of the illumina  <dig> g sequencer to locate cdna single nucleotide polymorphisms  in our haploid rm11-1a strain samples. alignments of orfs from the reference sequence with the rm11-1a unfinished genome sequence provided the known position of  <dig>  snps. we tested how accurately these known rm11-1a snps were rediscovered using the illumina  <dig> g reads aligned with the divergent s288c reference sequence. we tested a total of  <dig> , <dig> bases covered by at least one read.  <dig>  bases showed at least one discrepancy between an illumina base-call and the reference sequence. considering all discrepancies gives more than a sevenfold overestimate of the known snps, so we calculated a likelihood ratio statistic for each discrepant base to more accurately identify snps . with this additional filter we were able to detect  <dig>  known snps while only falsely calling snps for  <dig> bases .

next, we focused on detecting heterozygosity and quantifying ase simultaneously in data from diploid organisms. first, we simulated the results that could be expected from a diploid strain by combining the haploid byg and rmg data sets together. this in silico diploid had twice the total number of reads that we obtained from a single lane for an actual diploid. thus, it has greater power to detect sites of heterozygosity and sets an upper limit to what we could expect from an actual diploid strain. we tested a total of  <dig> , <dig> bases covered by at least one read.  <dig>  bases showed at least one discrepancy between an illumina base-call and the reference sequence. after applying the same statistical filter described above, we were able to detect  <dig>  known sites of heterozygosity while falsely calling  <dig> bases  for this in silico data set. we calculated simulated ase expression by separating reads directly aligning over the snp base into two groups based on which base they contain, counting the total reads in each group, and calculating the log <dig> ratio to determine differential gene expression. ase measurements from the in silico byg/rmg diploid for genes with over  <dig> sequencing reads were significantly correlated  with the differential expression values calculated by summing all reads aligning to an orf from the haploid samples.

last, we used sequencing data obtained from an actual byg/rmg diploid s. cerevisiae strain grown in glucose to discover sites of heterozygosity and simultaneously quantify allele specific expression. we tested  <dig> , <dig> bases covered by at least one read, and  <dig>  bases showed at least one discrepancy with the reference sequence. using the likelihood ratio statistic, we were able to detect  <dig>  known sites of heterozygosity while falsely calling  <dig> bases . we calculated ase at these heterozygous sites by calculating the ratio of the number of reads containing the by base and the number of reads containing the rm base. considering only the heterozygous sites assessed by at least  <dig> sequencing reads, we observed limited correlation  with the ase previously quantified for those transcripts in a by/rm diploid by allele-specific rt-pcr  <cit> . although the allele-specific rt-pcr results for the by and rm strains were obtained in a separate experiment, the rna samples were prepared from cells grown under similar conditions.

as another assessment of ase, we compared our ase predictions to results from genetic linkage analysis of gene expression levels. using  <dig> haploid segregants from a cross of the by and rm strains, expression levels were linked to both local and distant loci  <cit> . local linkages can be mechanistically explained by polymorphisms in promoters, 3' untranslated regions, or coding sequence  <cit> . approximately 25% of all transcripts show local linkage. in many cases, these types of local linkages alter gene expression in cis, such that local-linkage effect sizes in a sample of transcripts have been observed to correlate with ase as quantified by allele-specific qpcr  <cit> . therefore, we compared our ase estimates to genes with known local linkages and found that ase ratios determined by cdna sequencing data from the byg/rmg diploid were weakly correlated with average effect sizes of genes with local linkages . thresholding on only those genes with at least  <dig> sequencing reads at the site of heterozygosity improves this correlation .

discussion
quantitative measurement of rna-cdna hybridization kinetics demonstrates that the eukaryotic transcriptome is dominated by a relatively small number of highly expressed genes <cit> . 20% of the yeast transcriptome is expressed at hundreds of copies per cell, while most other transcripts are present in tens of copies per cell or fewer  <cit> . these predictions from hybridization data are consistent with sage experiments in yeast  <cit> . full characterization of gene expression by sequencing requires sufficient data to accurately measure transcripts with low abundance.

we found that a large fraction of illumina  <dig> g reads originated from highly abundant ribosomal rrnas. between  <dig> %– <dig> % of the total number of reads in our six samples originated from rrnas. even though we depleted each cdna sample of ribosomal rna before priming cdna synthesis using the mrna polya tail, the remaining highly structured ribosomal rnas self-primed a significant amount of reverse transcription, so that the final sample contained a large amount of cdna originating from ribosomal rna. this problem of limited mrna coverage can be addressed in one of three ways: by combining data from several lanes of the sequencer , by developing new techniques in order to selectively and efficiently deplete abundant rrnas, and through advances in sequencing technology that increase the number of reads per run.

the effect of the limited number of reads was observed in our model of sampling error. the most striking similarity between the simulated and real correlation plots is the vertical cluster centered at a log <dig> value of  <dig> . this vertical cluster suggests that small gene expression ratios were less reliably measured by the illumina  <dig> g than by the agilent microarray platform. the majority of the genes in this vertical cluster were low-abundance transcripts with few reads. reflecting the low reliably of these measurements, filtering genes based on a threshold number of reads in all six samples improves the correlation between array and sequencing data .

the correlation between array measurements and rna sequencing has been addressed by a number of recent studies and in most cases ranges from  <dig>  to  <dig>  <cit> . similar correlations were observed when comparing microarrays to massively parallel signature sequencing  and sage  <cit> . this suggests that the disparity may arise through differences between the array and sequence technologies rather than noise specific to new sequencing technologies. while correlation is a useful comparison method, a key metric for comparing expression technologies is the accuracy of detecting differential gene expression.

counting error limits the ability of cdna sequencing to accurately identify changes in mrna levels for low abundance transcripts. in our analysis of the rmg and rme samples, only  <dig> genes were detected as differentially expressed by both platforms, about half of the total genes found differentially expressed by each platform individually. the subset of genes that were called significantly differentially expressed by only arrays had significantly lower number of reads than the set of all genes examined, as well as lower average array intensity. because of the limited number of filtered reads for these genes, low abundance transcripts were less accurately measured by the illumina  <dig> g. in contrast, the subset of genes that were called differentially expressed by sequencing was enriched for genes with both higher read counts and higher array intensities. this indicates that additional sequencing data would improve quantification of genes with lower expression levels. furthermore, for highly transcribed genes having more than  <dig> read counts and for which differential expression was assessed by arrays, sequencing, and qpcr, qpcr ratios were more strongly correlated with sequencing results than with array results . this suggested that the illumina  <dig> g was less subject to saturation effects than microarray analysis.

based on our qpcr assessment of transcript levels for a large number of genes, we find both sequencing and array technologies have similar overall accuracy for measuring differential gene expression. one report has observed very high  correlations between cdna sequencing and qpcr, but selected just  <dig> genes spanning a 6000-fold range of expression  <cit> . another study used qpcr only to address discrepancies in  <dig> genes identified as differentially expressed  <cit> , observing that sequencing made  <dig> of  <dig> correct calls of differentially expressed genes while arrays correctly identified  <dig> of  <dig> differentially expressed genes. unlike our study, these studies used either much smaller sample sizes or were biased in selecting genes to be interrogated by qpcr. because of the large sample of genes we measured by qpcr assays, we were able to examine subsets of these genes with differential expression more closely than previous studies <cit> . we found that the subset of genes recognized as significantly differentially expressed by arrays only was highly correlated with qpcr , whereas as the subset of genes recognized as differentially expressed only by illumina sequencing was moderately correlated with qpcr . although caution must be exercised in distinguishing between the effectiveness of the statistical method to evaluate differential expression and the accuracy of the technology, our results suggests that arrays may have an advantage in measuring differential gene expression for low-abundance transcripts.

for  <dig> genes that were significantly differentially expressed in both technologies but where the technologies disagreed on the direction of the change, the qpcr results were inconclusive. all  <dig> genes were measured with fewer than  <dig> reads. the majority, six out of  <dig>  showed no differential expression by qpcr. they were likely false positives for both sequencing and arrays or false negatives for qpcr. two of the qpcr assayed genes agreed with the array prediction, while the third agreed with the sequencing data. these numbers were too small to draw definitive conclusions.

our analysis, both in our comparison to arrays and qpcr, focused on the differential gene expression within the rm11-1a strain across two environmental conditions . this represents a realistic situation in which the strain of interest has several polymorphisms compared to a reference sequence. moreover, gene expression differs greatly between these conditions  <cit> . the use of a non-reference strain allowed us to assess the accuracy of snp detection in cdna using the illumina  <dig> g. using alignments of the orfs from a draft assembly of rm11-1a, we catalogued snps from genomic sequence and assessed how well these could be detected from cdna. simply flagging every site of sequence discrepancy from reference would have generated  <dig>  predicted snps. the majority of these discrepancies most likely represent illumina  <dig> g sequencing errors, as the sequence of rm11-1a has been established with 10× coverage sanger sequencing  <cit> . calculating a likelihood ratio statistic allowed snp detection with high sensitivity and specificity.  <dig>  known snps were detected, and the false discovery rate was  <dig>  × 10- <dig>  cdna sequencing shows great promise for generating a coding snp map in any genome for which a reference sequence is available.

in our assessment of heterozygous site detection in a diploid, the total number of reads available limited predictive power. in the in silico data set, generated by combining reads from rmg and byg, we are able to detect  <dig>  known sites of heterozygosity while falsely calling  <dig> sites . this performance was notably worse than detecting snps from haploid cdna. heterozygous site detection requires more reads than homozygous snp detection because bases from each allele must be present to provide sufficient evidence for the existence of the site. this is further complicated by the presence of strong allele specific expression  for many genes, resulting in fewer reads from the less expressed allele. consequently, our results with an actual by4716/rm11-1a heterozygous diploid indicated that at high specificity only a smaller percentage, approximately 15%, of heterozygous sites could be detected. the discrepancy between the ability to detect heterozygosity for the in silico diploid and the actual byg/rmg diploid can also be partially attributed to the fact that the in silico diploid was modeled by combining data from two sequencing runs and so had twice the data generated for the actual diploid.

similarly, in our assessment of the quantitative measurement of ase in a diploid, the total number of reads available limited the accuracy of the results. correlation of ase as determined by sequencing with ase as measured by rt-pcr was weak . in contrast, ase calculated for the in silico diploid showed significantly higher correlation with gene expression . because the in silico diploid contained the number of reads obtained from two lanes of a sequencer, this result suggests that the total number of reads was the limiting factor.

CONCLUSIONS
our analysis of next generation sequencing was motivated by the rapidly converging cost of microarray analysis with a single lane of data from an illumina  <dig> g sequencer. in summary, our results indicate that, at least for the present, microarrays remain a highly competitive technology for quantitative measurement of differential gene expression. arrays have an advantage in measuring low-abundance transcripts. also, the current throughput of array experiments is higher than the  <dig> lanes present on an illumina  <dig> g instrument. it is routine to process 24– <dig> arrays in a single day, while the illumina instrument is limited to  <dig> lanes that require approximately  <dig> hours to run. multiplexing approaches can increase the number of samples per lane of the instrument, but our analysis suggests that accurate analysis of gene expression in yeast by full-length cdna sequencing requires at least the entire output of a single lane. more lanes may be necessary in other species with more complex mrna pools.

