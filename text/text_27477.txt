BACKGROUND
studies on gene expression rely heavily on dna microarray technology  <cit> . in a typical microarray experiment, the two rna samples to be compared are reverse transcribed in cdna, labeled using two different fluorophores and then hybridized simultaneously to the glass slide to measure the relative gene expression level  <cit> . essential to the analysis of microarray data is the normalization process, which allows comparison among samples by adjusting for individual hybridization intensities. there are many approaches to normalize expression levels and the most commonly used, referred to as global normalization methods, apply to experiments in which most of the genes are equally expressed in both channels  <cit> . the global normalization approach is based on the use of the majority of genes on the slide to normalize microarray experiments and a constant adjustment is used to force the distribution of signal ratios to have the same measure of central tendency, e.g., the same median. these methods can be applied when the elements spotted on the array are representative of a random and large number of genes  <cit>  and when there is symmetry in the frequency of the up/down-regulated genes  <cit> . alternative approaches have to be developed when the majority of the genes represented on the array are coordinately up- or down-modulated as in the case of diagnostic chips  <cit> . diagnostic chips are designed as low-density microarrays containing a number of selected genes expected to be concomitantly up- or down-regulated in response to given signals, drugs, or pathological conditions. the advantage of low-density over high-density platforms is the competitiveness in price and the flexibility of design.

we propose the use of external reference rnas  to normalize the data of low-density microarray. spike rnas show no sequence similarity to the genome of the studied species and they are added in defined amounts to experimental rna samples before labeling. the oligonucleotides specific for the spike rnas are spotted onto the slide. the use of spikes allows not only data normalization but also the evaluation of several parameters of the platform quality, including the sensitivity and specificity of the microarray experiments, the accuracy and reproducibility of the measurements and the assessment of technical variability introduced by labeling procedure, hybridization and image scanning  <cit> .

our laboratory is involved in the study of the cellular response to hypoxia, a condition of low oxygen tension that characterizes many pathological situations  <cit> . hypoxia occurs in cardiovascular, hematological, and pulmonary disorders, inflammatory processes, and fibrosis  <cit> . areas of low oxygen concentration are present in solid tumors and are known to contribute to tumor growth, metastasis, and resistance to radio and chemotherapy  <cit> . we and others have applied microarray technology to define the profile of gene expression associated to hypoxia utilizing the affymetrix genechip  <cit>  and we are in the process of designing low-density microarrays that will identify the hypoxia-inducible genes in tumor specimens, and may serve as prognostic indicators of the aggressiveness of the disease and of the sensitivity to therapy. a prerequisite for the development of such tool is a correct normalization procedure and a sound analysis of the data that does not require preexisting information on the expected pattern of results and that will be suitable even if the majority of the genes is modulated or the distribution of up- or down-regulated genes is asymmetric.

in this study, we demonstrate that a composite loess normalization  <cit>  based on spike-in controls is the proper way to deal with low-density microarray platforms that applies also to extreme distribution of the data when the global normalization approaches will generate erroneous results.

RESULTS
experimental planning
we describe a normalization/validation procedure of a low-density array  based on spike-in controls . the spike rna consists of eight, commercially available, purified bacterial mrnas with no similarity to the mouse genome . the corresponding  <dig> mers were spotted on the test-array which contains a total of  <dig> replicates of each spike printed by  <dig> different pins and distributed on the slide as described in the methods section. the experiments were aimed at evaluating spike signals when variable amounts of spike rna are added to experimental rna and hybridized to the test-array. experimental rna was purified from the murine macrophage cell line ana- <dig>  <cit>  that was cultured in a normoxic or hypoxic environment for  <dig> hrs in order to define the hypoxia inducible genes. experimental rna from normoxic and hypoxic macrophages was spiked with the eight different spike rnas. the samples were labeled with red and green fluorophores, mixed, hybridized to the test-array and tested for fluorescence signals. the oligonucleotides spotted on the test-array represented  <dig> mouse genes induced- or inhibited- by hypoxia or by other stimuli and those specific for the spike rnas. rough data were filtered on the bases of the signal and only signals with more than 50% of the pixels falling two standard deviations over the local background were considered for the analysis. this filtering procedure, described by bahler et al.  <cit> , discarded unreliable data coming from weak signals, caused by nonspecific hybridization, and retained those in which at least half of the spot was significantly brighter than the background. whenever a spot did not pass this criterion for one channel but in the other channel had more than 95% of the pixels satisfying the inclusion criteria, the spot was included in the analysis. the reason for this procedure was the effort of including in the analysis genes weakly expressed in one experimental condition but with reliable expression in the other  <cit> .

spikes' signal
initial experiments were performed to characterize the signals of the spike rna in the biological setting. experimental rna from control and hypoxia treated macrophages were mixed with equal amounts of each spike rna generating an expected ratio of  <dig> in the spike signal. the experiments were designed in such a way that each pin printed quadruplicate subarrays containing the entire set of eight oligonucleotides corresponding to the spikes and one fourth of the oligonucleotides specific for the experimental genes.

the first issue that we addressed was the reproducibility of the signal of the spike rna. we calculated the coefficient of variation  for each spike on the  <dig> replicates present on each individual test-array and we averaged the cv and standard deviations  of seven independent test-arrays analysed . we found that the cv ranged from  <dig> % to  <dig> % depending on the spike, indicating low variation and a good level of reproducibility of the results similar to what described for other platforms  <cit> . this conclusion was supported by the analysis of the standard deviations that were quite homogeneous and ranged from  <dig>  and  <dig> .

analysis of variance  was used to estimate the contribution of each potential source of error to the overall variability. for this purpose, several pairs of experimental rna from control or hypoxic macrophages were mixed with increasing amounts of the eight spike rnas  each of which generated an expected ratio of  <dig>  the anova explored the association between the log ratio of all spikes and the potential sources of variance including spike characteristics , mrna spike concentration, position on the array , and interaction term between the spike characteristics and spike concentration. the results are shown in table  <dig> in the "before normalization" panel. we found that the major portion of the variability could be attributed to the spike concentration  followed by the interaction term , and the spike characteristics . the position on the array did not seem to contribute significantly to the variability of the system , in contrast to what observed in other platforms  <cit> .

the difference between the observed ratios of the various spikes and the expected ratio of  <dig> was rather small but occasionally some outlier spikes were far from  <dig>  we explored the possibility to reduce the variability eliminating outlier values. outliers were defined as those spikes showing either great variability among replicates or ratios far from  <dig>  we developed a filtering procedure to keep the spikes that showed low variability, defined as cv less than 10% <cit> , and a mean ratio falling  <dig> ± two standard deviations to exclude values in the extreme 5% of the distribution. table  <dig> shows the results of one experiment in which we utilized the data of the seven independent microarray experiments used to calculate the reproducibility shown in table  <dig>  the mean ratios and standard deviations of the eight spikes within each experiment were calculated and the outliers were removed using the above criteria. the results demonstrated that some spikes were very reproducible and did not generate any outlier. in some instances one or two outliers out of seven replicates  were detected and excluded from the analysis of the data. after the removal of the outliers a significant decrease in the cv was observed demonstrating the value of the filtering procedure.

in summary, these results clearly show that the information provided by spikes' signal is reproducible, characterized by low variability  and suitable to normalize the results of our test-array.

normalization of the spikes' signal
the relative fluorescence intensity between channels must be normalized to adjust for systematic biases such as differences in rna levels, dye incorporation and detection efficiencies  <cit> . the dye balance may vary with spot intensity and with spatial position on the array. loess and print-tip loess normalization are among the most commonly used methods to remove such variability although the application of this algorithm is not free from potential risk on the interpretation of the results  <cit> . we utilized, as a routine, the loess normalization procedure, which does not take into consideration the tip-to-tip variability because, under the present experimental conditions, the anova showed that the contribution of the position on the array to the total variability were negligible.

we applied a composite loess normalization to the spikes' signal  <cit> , which corrects the expression log-ratios for intensity-based trends by subtracting from each expression log-ratio the corresponding value of the loess curve. the loess curve is constructed exclusively on the spike-in controls expression data and it is not biased by experimental genes values  <cit> . being r and g the background-corrected red and green intensities for each spot respectively, the expression log-ratio  corresponding to a generic spot is m = log2r - log2g, whereas the log-intensity  of each spot is defined as a = / <dig>  the effect of normalization on the distribution of the ratios of the spikes in four independent measurements is shown in the box-plots in figure  <dig>  before normalization  the values are dispersed around the theoretical value of zero, but following loess normalization  the spreading was clearly diminished providing further evidence of the need for normalization in comparing different experiments.

to define the effects of normalization on the variability the spikes' signal data were analyzed by anova  and compared to those obtained in the absence of normalization . when dissecting such variability into its components we found a major decrease for the spike concentration  indicating that any spike concentration within the range from  <dig> to  <dig> pg could be used, including low amounts of spike with a substantial saving of reagents.

the normalization did not affect the variability associated to the array position, and most variability is now explained by the spike characteristics  or by their interaction with the spike concentration . the little change in the r squared between the two anova models  is due to the change in the relationship between the components and the interaction term and it does not affect the reliability of the model.

comparison among different experimental arrays may require a scalarization of the data following normalization to adjust for dyes unbalance. we assessed the possibility of a further improvement of the data consequent to the spike signals scalarization. figure  <dig> shows the empirical cumulative distributions  of the standard deviations for m-values on four technical replicates in which data were not normalized , normalized but not scaled , normalized and scaled through the quantile method   <cit> , or normalized and scaled through the scale method   <cit> . the shift of the blue line confirms the importance of normalization of the results. the red, green and black lines are almost superimposed showing that the scaling process does not provide any practical improvement in terms of standard deviation of m-values. the small deviations of the black and green line curves from the red one suggest that the noise introduced by the scaling may be more detrimental than a small difference in scale. we conclude that spike signal normalization is a necessary step for subsequent use as internal reference whereas scaling is not required.

analysis of the experimental platform using the spikes
having identified experimental conditions for optimal analysis of the spikes' signal, we studied the experimental rna expression values following spike-in based normalization. the loess normalization based on spike-in controls corrects the whole set of expression data constructing a loess curve on spikes log-ratios. the experimental rna log-ratios are corrected for intensity-based trends subtracting from each expression log-ratio the corresponding value of the loess curve  <cit> . the normalized results of four replicate experiments in which we added  <dig> pg of spike rna to the experimental rna are represented as box plots in figure 3a. a variation of the spread and of the alignment among replicate experiments is evident suggesting the need for scaling to compare the results. after scaling with the quantile method  <cit>   a good alignment and a similar spread can be demonstrated indicating that scaling is important for the experimental data although not needed for the spikes themselves as previously discussed. the variability of the experimental data following normalization and scaling is measured by calculating the standard deviations  and the coefficient of variations  of the signal from spikes and experimental genes among replicate arrays  . the variability of the technical repeats measured on spikes' signal  was very similar to that calculated on experimental genes  indicating a high degree of reproducibility of the platform.

quantitative spiking experiments were carried out to determine the sensitivity of the system. increasing amounts of spike  were added into a sample of  <dig> μg of experimental rna . we found that the signal readout was linear over the entire range of concentrations. the detection limit was at a dilution of 1: <dig>  , which corresponds approximately to  <dig> pg of specific mrna.

to define the theoretical cut-off ratio identifying regulated genes, we calculated the roc curve  <cit>  on the values obtained in experiments in which spikes were added at pre-defined amounts to obtain ratios of  <dig> ,  <dig>  ,  <dig>  and  <dig> . dye swap was performed to generate reverse ratios. the results are shown in figure  <dig> where the true positive rate  is plotted against the false positive rate  for the different thresholds applied. we defined the genes with ratios =  <dig> ,  <dig>   <dig> as positive and genes with ratio =  <dig> as negative. roc curve analysis was performed comparing the distribution of positive versus negative genes. the roc curve indicates that  <dig>  is the best cut-off ratio to discriminate regulated genes from non-regulated genes, with a sensitivity  of  <dig> %, a specificity  of  <dig> % and a rate of genes correctly classified of  <dig> %. according to our experimental system,  <dig>  is the ratio corresponding to the point on the roc curve nearest to the left-hand corner, representing the highest theoretical value of accuracy . the ratio of  <dig>  resulted in 100% of probability to classify true regulated genes since above this ratio the false positive rate is equal to zero. we conclude that genes showing ratios above  <dig>  are definitively up-regulated and below  <dig>  are definitively non-regulated. the choice of thresholds at intermediate levels will be dictated by the nature of the experiment and the required stringency that can be deduced from the roc table. efficient normalization using the loess curve requires that the platform manifests specific characteristics in terms of spike properties and number of replicates. the first requirement is that the intensities of the signals of the various spikes span across the range of intensities of the experimental data  <cit> . the relationship between our experimental data and the eight spikes used is shown in figure  <dig>  the spike-in controls have a range of log-intensities spanning between  <dig> and  <dig>  which comprises 75% of the  <dig> expression data. such differences of log-intensity among spikes are caused by intrinsic characteristics including base composition, length of the mrna and interaction with other rna molecules, and they are unpredictable and must be verified for each set of spikes. in our situation, the spikes were suitable for normalization without further adjustments. modification of the spike concentration and/or the number of spikes used must be considered in the event of a partial coverage of the range of intensities of the experimental data by the spikes' signal.

a second consideration is the strength of the loess curve with respect to the number of replicates. we calculated the minimum number of replicates needed to have a robust loess procedure. the robustness was calculated on the basis of reproducibility of the normalized data considering an increasing number of replicates and we set as a threshold for our system a cv of 10%. in our platform we have  <dig> spikes each replicated  <dig> times in each slide for a total of  <dig> replicates. we applied a monte carlo resampling procedure aimed at sampling  <dig> times the  <dig> replicates collecting randomly each time a fixed number of replicates . each sample was used for normalization of the array, the mean expression value of the experimental data was computed and the cvs based on each sample were calculated . we found that the cv was less than 10% when the number of replicates was equal or greater that  <dig> and we concluded that a minimum of  <dig> replicates is needed for an accurate normalization of the platform. in our platform we spotted  <dig> replicates per spike and, theoretically, five spikes would be sufficient to reach the threshold number of  <dig> replicates. however, this is the minimum number required and five spikes would not allow, for example, the elimination of the outliers. on the bases of our limited experience, we propose that a platform that uses the spike-in normalization system, as that described here, must adhere to the requirement of a minimum of  <dig> replicates among all spikes and a set of spikes representative of the range of expression values of the experimental data. in general, the optimal number of spikes/replicates to be used will have to be calculated considering the range of log-intensities covered by the spikes and the reproducibility of the normalized data with an increasing number of replicates.

normalization and scaling of the experimental platform
one purpose for developing this spike-in controls platform is the possibility of applying this methodology to normalize microarrays with an asymmetric representation of modulated genes. we modelled this situation in the analysis of the changes of gene expression in macrophages following exposure to hypoxia. rnas from control or hypoxia-treated macrophage cell line were mixed with the spikes and hybridized to our test-array. the  <dig> gene expression results  were normalized using the method described here that applied the loess algorithm based on the spikes only  or using the loess applied to all genes  or the median  algorithm applied to all experimental data without including the spikes' values. we used the fold change of  <dig>  as the threshold value to identify modulated genes as derived from the roc curve analysis. we found 25% of up-regulated, 19% of down-regulated and 56% of unchanged genes in response to hypoxia  when the data were normalized with the spike-based normalization. similar results were obtained when the median normalization algorithm and the loess based on all genes were used. furthermore, we plotted the frequency of genes with increasing fold change values. similar curves were obtained using the three methods of normalization. these results demonstrated that the spike-based normalization is interchangeable with global normalization algorithms under condition in which the representation of modulated and not modulated genes is symmetric such as that shown in figure 8a. the use of the frequency of genes with the given fold change is a read out of practical interesting that, however, is not suitable for measuring the relative performance of the normalization systems, based on assessment of relative biases and variances, that is thoroughly discussed in park et al.  <cit> . depending on the platform and on the aim of the analysis some normalization may perform better than others, but in our system with our read out we failed to appreciate significant differences. however, different results were obtained when we considered a case limit in which the microarray contained only up-regulated genes. we modelled this scenario by considering only the  <dig> genes up-regulated identified in figure 8a. the distribution of modulated genes on the bases of the three normalization methods is shown in table of figure 8b. the spike-based normalization identified 100% of the inducible genes as expected. in contrast, the median normalization algorithm identified only 13% inducible genes because it assumes a non-existing normal distribution of the data. the majority of the genes were classified as not changed. the loess normalization based on all genes generated analogous results. similar conclusions were drawn when we plotted the frequency of genes with increasing fold change. the spike-based normalization originated a curve of frequency that had a similar slope as that observed in figure 8a indicating that this normalization can be applied irrespectively to the symmetry of modulated genes on the array. in contrast, the curve generated with the median normalization algorithm and the loess based on all genes failed to identify up-regulated genes indicating that these methods can not be applied to an asymmetric distribution of genes such as that depicted in figure 8b. in conclusion, the spike system has a broader applicability and is suitable for the analysis of asymmetric arrays because it normalizes the results according to an external reference independent from the experimental rna and, therefore, not affected by the symmetry of the array.

the genes that are up-regulated in macrophages by hypoxia with a probability of 100% are listed in table  <dig>   <dig> out of  <dig> genes are known to be up-regulated by hypoxia or they have been validated by independent assays including microarray with other platforms. in contrast, three genes were not previously associated with the hypoxic response  and are currently under investigation. these results confirm that we could detect hypoxia inducible genes and that our platform is suitable for testing hypoxia diagnostic chips to be applied to inflammatory diseases or cancer.

CONCLUSIONS
we describe the use of spike-in external control to normalize a low-density microarray. the spikes are an external reference that allows data normalization independently from the expression of the experimental rna particularly suitable for situation in which there is asymmetric distribution of modulated genes. this approach does not rely upon the low-density property of the array and, theoretically, it can be applied to high-density arrays. we can not exclude that the source of the experimental rna may affect the spike performance and some evaluation of the parameters described here may be needed in different experimental conditions. we demonstrate that the application of loess normalization to the spikes' signal decreases significantly the major source of variability. furthermore we introduce a criterion for the removal of the outliers that is quite useful to further reduce the system variability.

the choice of normalization method is critical for a correct interpretation of the results when the distribution of the expression values in not symmetrical and/or the number of spotted genes is limited. in fact, we show that median normalization method or loess normalization based on all genes spotted are unable to cope with situations in which only up-regulated genes are present on the array. unfortunately, the nature of the distribution of gene expression is generally unknown and normalization methods that are independent from this variable are desirable. we demonstrate that the spike-in method is as effective as other global normalization methods in dealing with symmetric distribution of the expression values. more important, we show that it can be successfully applied also to situation in which the distribution of the expression values is highly asymmetric. we conclude that the spike-in system is a method of choice for arrays with a potentially biased distribution. a situation in which there is the potential for an asymmetric distribution is represented by low-density diagnostic chip where the choice of the genes spotted may be deliberately biased towards those that are up-regulated in a given pathological condition.

there is no reason to believe that the spike-in normalization method could not be suitable for high-density microarrays. the only possible technical limitation is the inclusion of spike probes in commercially available chips. however high-density microarrays are characterized by a symmetric distribution and commonly used normalization approaches are equally effective or possibly superior as the intensity-dependant normalization procedure. a thorough comparison among normalization methods has been published  <cit> .

we describe the use of eight spikes for an accurate normalization of the platform and in our experience this conditions allows an accurate normalization in every experiment. on the basis of a monte carlo resampling procedure we determined that theoretical minimum number of five spikes each replicated  <dig> times is needed for the normalization of our platform. however, such number has severe limitations including the impossibility of excluding the outliers. in general, the number of spikes to be used in different applications may vary depending on the stringency of the criteria used, on the desired variability threshold and on the robustness of the platform and it may have to be recalibrated when using other sources of rna.

our experimental system consists of rna from cell line cultured in normoxic condition or exposed to hypoxia, a condition of low oxygen tension that characterizes several pathological conditions. very often, arbitrary expression cut-offs are set to discriminate between genes that are modulated or not changed. we describe here the successful use of the roc curves to assess objectively the threshold to identify hypoxia-modulated genes. the expression data obtained with our platform are consistent with previous information generated in our laboratory using other platforms and with the data in the literature relative to the response of macrophages to hypoxia confirming that we could detected hypoxia inducible genes and that our platform is suitable for supporting hypoxia diagnostic chips.

in summary, we present an accurate description and characterization of a normalization procedure of a low-density microarray based on spike in external controls that has the potential of a broad applicability to different types of arrays including those in which there is an asymmetric distribution of the up/down-regulated genes.

