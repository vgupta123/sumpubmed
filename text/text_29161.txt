BACKGROUND
in researching adaptive evolution processes, it is important to detect protein coding genes that are under an active natural selection process. traditionally, this is described as the ratio of ka/ks. ka is the rate of non-synonymous substitution and ks is the rate of synonymous substitution. the ka/ks ratio can be used to estimate either negative or positive selection tendencies for genes of interest  <cit> . however, most ka/ks ratio values of complete coding genes have been found to be too low to be easily detected. this is because, in general, non-synonymous substitutions occur much less frequently than synonymous substitutions  <cit> . therefore, regions that may have important protein function and structure showing ka/ks values over  <dig> are not readily detectable with classical methods. conventional methods often use sliding windows for detecting high ka/ks values that may represent high selection pressure at a single amino acid site or gene region  <cit> . however, these methods can be ineffective at detecting good candidate sites when natural selection is under way or when a small number of alignable sequences are provided.

recently, the selecton program  <cit>  has been developed to detect the evolutionary effects on a single amino acid site within the three-dimensional  protein structure. this tool is powerful at detecting active substitution regions if the 3d structures of genes are available and if at least five homologous sequences are provided. unfortunately, not all genes have corresponding 3d structures, and it may be difficult to provide five homologous sequences from five different species. this paper presents wspmaker , a new web tool for assisting in the detection of gene regions under differential selection pressure when only two pair-aligned protein-coding sequences are provided.

the most important feature of the wspmaker is that it compares the selection constraints of domain and non-domain regions. it provides a simple  method to detect for defining positive and negative selection pressure regions within protein-coding sequences.

RESULTS
wspmaker  uses the clustalw sequence alignment tool  <cit> . as a default, it requires two orthologous mrna sequences. it translates them into protein sequences and chooses the longest open reading frame  by a user-selected genetic code table. this step is skipped if users submit their own alignment of orthologous cdss. this alignment file is extracted to window-sliding sub-regions with the window size provided by the users. the users may select an option for assigning functional domain regions in the proteins. wspmaker is able to produce a plotted graph with ka/ks value for different regions of the coding gene, and emphasizes specific regions of proteins that are under selection pressure, with five different user-defined methods to detect selection and selection values . the schematic overview and the data flow of wspmaker are shown in figure  <dig> 

implemented evolutionary models
wspmaker implements several different evolutionary models widely used to estimate the level of selection operating on a gene or coding region. in the 'single size' option, there are three model pairs . the first pair includes m1a  and m2a . the second pair includes m <dig>  and m <dig> , while the third pair includes m <dig>  and m <dig> . comparison of these model pairs allows the for statistical testing of the hypothesis that there is positive selection on proteins  against the null hypothesis model. the output is the likelihood of each model, allowing for a comparison using a likelihood ratio test . the program predicts when a site is undergoing positive selection. in the second option, 'user defined size,' there are two models. the yang and nielsen model  <cit>  and the nei and gojobori  <cit>  model are commonly used in estimating synonymous and non-synonymous substitution rates and detecting positive selection in protein-coding sequences.

input data format and parameters
wspmaker takes a default input data type of user-curated orthologous dna coding sequence pairs. wspmaker allows users to submit various sequence formats, such as fasta, embl, gcg, clustalw, and phylip/phylip <dig>  for the input data containing codon-based alignment of paired sequences. wspmaker provides a choice of one of the  <dig> ncbi genetic codes  <cit>  for automatically generated codon-based alignment after translating orthologous cdss. there are two additional advanced options: 'single size' and 'user defined size.' if users select 'single size,' they can choose one of three models to detect the sites that are under significant selection pressure. the default window and sliding size is  <dig> bp for calculating the ka/ks ratio. the 'user defined size' parameter is for calculating ka/ks using a user-defined sliding window size, and allows the users to choose one of two models in common use . the default window size is 6% of the given gene sequence. this value is set empirically and can be altered. in addition, users can set positive or negative threshold values . hmmpfam  <dig> . <dig> was used to analyze domain distribution among all orthologous genes and to extract pfam domain sequences  <cit> . a threshold e-value <=  <dig>  gave the best quality results, and thus was used in the present system. this domain architecture of the input orthologous genes was visualized with functional domains using pfam in the resulting web interface.

output
the results page consists of four sections. they are 1) file download, 2) ka/ks graph, 3) pfam domain position annotation, and 4) ka/ks calculation. an example output is shown in figure  <dig>  the first section contains the files available to download, the input and intermediate results produced in the automatic pipeline of the wspmaker server. "cdss" provides the longest dna sequence with a start codon. "protein sequence" provides the translated amino acid sequences. "clustalw result" provides the aligned pairwise sequences using the clustalw program. "ka/ks values of orf" provides the ka/ks ratio generated by the codeml program in the paml package  <cit> . "pfam annotation" provides the information on the pfam domains. the second section contains a ka/ks graph, which shows the window-sliding selection pressure between two orthologous coding genes that have been entered in the input page. each sliding window's ka/ks value can be displayed as a colored bar; a red bar means that the ka/ks value of its position is equal to or greater than the positive selection value , and therefore that the region has undergone positive selection. a yellow bar means that the score is equal to or greater than the negative selection value  and lower than the positive selection value, and therefore that this region has undergone neutral evolution. a dark-gray bar means that the score is lower than the negative value, indicating a purely negative selection. the bars that have ka/ks values over  <dig> have been treated as 0-scored bars due to alignment errors or gaps. to highlight the the region of lower ka/ks values, the bar heights have been scaled in a logarithmic manner. optionally, there is one more section  in the 'single size' option. this section compares the significance levels of two given models by performing the likelihood comparison . the green-colored domain box has been positioned below the ka/ks graph, and the matched area has been highlighted by the light-gray color in the graph. when the mouse points to a bar, a tool-tip is shown that contains the selected bar's information in the ka/ks calculation. when the mouse points to a domain box, a tool-tip is shown that contains the selected domain's info in the pfam domain position. the third section is the pfam domain position annotation table, which contains the analyzed information of each domain. the last section shows the ka/ks values, which contains the analyzed information of each sliding window.

applying wspmaker to biological cases
here, we give an example illustrating wspmaker's use for detecting positive selection .

the subset of genes implicated in nervous system development is known to display significantly higher rates of protein evolution in primates than in rodents  <cit> . the higher average ka/ks values of nervous system genes in primates are suggestive of adaptive evolution, especially a positive selection process. however, none of the genes have ka/ks ratios greater than one with previous tests of adaptive evolution. thus, to detect interesting evolutionary signatures, a good statistical power and other test methods are necessary. one such method is our mspmaker, which scans and calculates selection pressure  in sub-regions of two protein-coding dna sequences . here, nervous system genes mcph <dig> and chrm <dig> were used as inputs for the wspmaker server. disturbing the mcph <dig> gene can result in a severe reduction in brain size , and chrm <dig> is related to defects in acquiring reward-mediated behaviour. both genes showed ka/ks values lower than one in primates  with the traditional methods, despite the fact that phenotypes of the nervous system such as brain size had apparently undergone far greater selection pressure in primates than in most other mammals. to test selection pressure in the sub-regions, we ran wspmaker with human and macaque sequences of each gene. options were set as follows: 'user defined size,' the default widow size and sliding size, and the yang and nielsen method. the results of the run are shown in figure  <dig>  the outputs showed many gray-colored regions, indicating that these regions have undergone neutral evolution, as was shown in traditional methods. however, there were exceptions in some regions, where the red colors indicated ka/ks values higher than one. we suggest that these regions have undergone amino acid fixations during primate evolution, even though the entire genes followed neutral evolution. in addition, the domain information provided by wspmaker lets users compare the selection pressure on the protein domain regions and understand which particular positions are functionally important.

CONCLUSIONS
wspmaker is a useful web-based visualization tool that shows which dna sub-regions of coding sequences are under strong selection pressure. it can assist researchers in easily detecting candidate genes and partial gene regions for fast base substitution in functional and evolutionary analyses, using its window-sliding visual graphs. the wspmaker server can be accessed at .

competing interests
the authors declare that they have no competing interests.

authors' contributions
ysl, thk, and twk wrote the code for wspmaker. whc worked on the visual display of the results. gss designed the overall web site and coordinated the project. ysl wrote the main draft of the paper. all authors have read and approved the final manuscript.

