BACKGROUND
a homologous recombination event between two dna sequences can be either reciprocal or non-reciprocal. in reciprocal recombination, genetic information is transferred or exchanged between two similar dna sequences. in non-reciprocal recombination, a contiguous region of dna is replaced by, rather than exchanged with, the transferred region. both types of recombination are a consequence of the dna mismatch repair mechanism which protects genetic information from damage. gene conversion, for example, is a cross-over process between homologous sequences in which a dna strand replaces a damaged partner dna strand with a copy of its own sequence  <cit> . a number of models describe the mechanisms of recombination, addressing issues of strand breakage, displacement and extension, and mismatch repair in double-stranded dna  <cit> . gene conversion events can lead to reshuffling of parental open reading frames, or of structural and functional motifs within protein domains, and these can generate a gene with novel functions  <cit> . therefore, reciprocal and non-reciprocal recombination events are important mechanisms in the creation of genetic diversity  <cit> .

recombination events have been inferred in prokaryotes  <cit> , unicellular eukaryotes  <cit>  and multicellular eukaryotes  <cit> . homologous recombination has contributed to the evolution and functional divergence of multi-gene families such as the β-globin gene family  <cit> , heat shock proteins  <cit>  and the major histocompatibility complex gene family  <cit> . while most cases reflect recombination between dna sequences within a genome, recombining dna can also come from the external environment of a cell, which results in the acquisition of foreign dna by a genome  <cit> . if lateral genetic transfer via homologous recombination is a significant contributor to prokaryotic evolution  <cit> , the detection of recombination events will be essential in the inference of phylogenetic relationships among genomes  <cit> .

elucidating patterns of genetic transfer will enhance our understanding of the role selective forces play in shaping genomes. homologous recombination events can produce genes with mosaic evolutionary histories in which the underlying evolutionary pattern is not a tree but a network  <cit> ; such an evolutionary pattern confounds analyses that assume a common evolutionary path for every component of a biological sequence. the task of delineating recombination events is hard for two major reasons. firstly, if the recombining sequences are too similar, subsequent detection of the event may be impossible due to the lack of 'signal' to distinguish among sequences. secondly, evolutionary events that occur after recombination will tend to obscure the true relationships between sequences. homologous recombination events can overwrite previous such events, fragmenting the regions with consistent evolutionary histories until the events cannot be distinguished with confidence  <cit> . sequence substitutions after a recombination event will diminish the apparent similarity between fragments of a gene and their closest relatives in other sequences; this phenomenon has been shown to influence the accuracy of phylogenetic inference  <cit> .

a number of approaches are available to detect evidence of recombination events and/or to identify the recombination breakpoints. they are classified into different categories based on the algorithms used  <cit> . distance-based methods generate statistics of genetic distances with the use of a sliding window along a set of aligned sequences  <cit> . abnormal inversions of distance patterns are detected without reference to the underlying phylogenetic relationship among the sequences. phylogenetic-based methods are based on the detection of alignment partitions with discordant phylogenetic relationships  <cit> . in compatibility-based methods, inference of recombination and phylogenetic incongruence is based on parsimoniously informative sites identified within an alignment  <cit> . substitution distribution-based methods detect regions within a set of sequences that are significantly similar or clustered together, with the level of significance based on a modelled statistical distribution of nucleotide substitution  <cit> . computer simulations and empirical data have been used to evaluate the performance of a number of available methods in detecting and analysing recombination events based on the amount of recombination and sequence divergence  <cit> . a uniform outcome from these studies is that compatibility-based and substitution-based methods perform better than the phylogenetic-based approaches. furthermore, posada and crandall  <cit>  demonstrated that phylogeny reconstruction from sequences could be biased owing to the reciprocality and the age of a recombination event, as well as the parental divergence of the sequences involved in the event. these studies suggested that conclusions about recombination should not be drawn on the basis of a single method due to biases of different approaches to the nature of the dataset, e.g. some methods were found to detect far fewer recombination events and breakpoints than expected  <cit> . using simulated sequence data, we examined the effect of subsequent substitution after a recombination event on the prediction accuracy of different recombination-detecting programs, within the simplified framework of homogeneous substitution rate and nucleotide composition throughout the lineages.

RESULTS
we simulated the evolution of four-sequence sets with  <dig> nucleotides  per sequence under a homogeneous evolutionary model as illustrated in figure  <dig>  each simulation consisted of three phases. during the pre-recombination phase, sequences were simulated along lineages of length θ. a lineage length is defined by the average number of substitutions per site. the lineages of length θ <dig> and θ <dig> in the non-reciprocal set represent the pre- and post-speciation lineage, respectively. the notation 'l05/50' refers to a set of four sequences that were simulated along a tree topology with θ <dig> =  <dig>  and θ <dig> =  <dig> , prior to the simulated recombination event. at the recombination phase, an exchange of the recombined region  was performed between sequences  <dig> and  <dig> to simulate a reciprocal event . to simulate non-reciprocal recombination, the region in sequence  <dig> between r <dig> and r <dig> was replaced with the corresponding region from sequence  <dig> . the recombined regions of sequences  <dig> and  <dig> were identical immediately after a non-reciprocal event, leading to a change of tree topology in which  <dig> and  <dig> were sister taxa, and taxon  <dig> was separated from the root by a single branch of length θ <dig> + θ <dig>  during the post-recombination phase, subsequent nucleotide substitutions were simulated independently for each sequence with λ substitutions per site in each lineage. for each simulation set, the same evolutionary model with equal rate of substitutions was applied to all four lineages following speciation. within the context of reciprocal recombination, the exact point at which a recombination event occurs along the lineages after speciation cannot be distinguished. therefore, reciprocal recombination was performed immediately after the speciation event at the end of lineage θ <dig>  while θ <dig> is the length of the branches immediately preceding a non-reciprocal recombination event, θ <dig> is the lineage length immediately preceding a reciprocal event. lambda  represents the amount of independent subsequent substitutions after a recombination event in both reciprocal and non-reciprocal sets.

the five programs compared in this study were geneconv   <cit> , recpars   <cit> , reticulate   <cit> , barce  <cit>  and dualbrothers  <cit>  . these programs were selected based on their capabilities for large-scale automated analyses, their usage within the scientific community and/or strong performance within their class of algorithm in recent reviews  <cit> . a brief overview of our methods for calculating prediction accuracy is provided below, with further details in the methods section. the phylogeny of the recombined region between points r <dig> and r <dig> in each sequence set was assessed by bayesian inference using a markov chain monte carlo  approach, implemented in mrbayes  <cit> . as the amount of subsequent substitutions increases, the phylogenetic signal becomes weaker, and the bayesian posterior probability  of the tree topology is expected to decrease. failure to assign high bpp to the correct topology within the recombined region indicates a loss of phylogenetic signal, and suggests that statistical searches for recombination events or breakpoints, particularly those based on phylogenetic relationships, may be futile.

substitution distribution- and phylogenetic-based approaches
the prediction accuracy of geneconv and recpars was determined based on separate calculations of the number of correctly assigned residues within the recombined and the non-recombined regions . perfect classification of both the recombined and non-recombined regions would yield a score of  <dig> , while the assignment of a single tree topology to the entire alignment  would lead to a score of  <dig>  the prediction accuracy of the two programs and bpp assigned to the correct tree topology for the recombined region are depicted in figure  <dig> for simulations of  reciprocal and  non-reciprocal events and different amounts of sequence substitution. when λ was ≥  <dig>  substitutions per site, recpars in general showed higher accuracy  than geneconv . geneconv, with lower standard deviations , was more consistent across simulated replicates. the accuracy of both programs showed an inverse relationship with the increase of subsequent substitution after recombination. the observation can be related to the fact that geneconv and recpars identified multiple fragments rather than a whole fragment within the recombined region when λ was ≥  <dig>  substitutions per site.

the phylogenetic signal of the recombined region was stronger when the recombining sequences were more divergent, i.e. when the immediate preceding lineage length leading up to the recombination event was longer. the bpp values obtained with mrbayes were >  <dig>  in all cases when the immediate preceding lineage was at  <dig>  substitutions per site, even when subsequent substitutions were high . the recombination signal and prediction accuracy decreased more rapidly in response to increasing λ when the recombining sequences were more similar to one another .

compatibility-based approach
reticulate generates a compatibility matrix displaying the most-parsimonious relationships among sequences for each informative site in a sequence alignment. two informative sites are considered compatible if they can be explained by the same phylogenetic tree with the most parsimonious change  <cit> . a cluster of mutually compatible sites that is incompatible with sites outside the cluster suggests a recombination event. the neighbour similarity score  has a range between  <dig>  and  <dig> , and represents the extent to which mutually compatible sites are found in contiguous blocks. this score was used as the criterion of prediction accuracy. the relationship between site clustering efficiency in reticulate and the extent of subsequent substitution occurring after recombination is shown in figure  <dig>  in all cases, the nss approached the minimal value of  <dig>  as subsequent substitution  reached  <dig>  substitutions per site.

within the reciprocal set , when recombining sequences were more dissimilar , reticulate showed higher nss  and higher proportions of sets with significant clustering  compared to l <dig> . in comparison to the reciprocal set, lower nss were obtained within the non-reciprocal set even when no subsequent substitution was simulated e.g. nss in l05/50:  <dig>  and l50/50:  <dig>  at λ =  <dig> . when λ reached  <dig>  and the immediate preceding lineage length  was long, the proportion of significant clustering within the non-reciprocal set was low . this can be explained by the resulting identical sequence fragments in a non-reciprocal event, which yielded fewer parsimoniously informative sites in the alignment. the measure of statistical significance within a set of data is lower when the sample size is smaller, because the probability of obtaining a result by chance is higher. therefore, as fewer parsimoniously informative sites were being considered in a non-reciprocal event, the clustering efficiency of sites in the compatibility matrix was lower.

bayesian phylogenetic-based approach
for each site  of an alignment, barce and dualbrothers assign bpp to possible tree topologies. average accuracies within the recombined and non-recombined regions were computed in a manner similar to recpars and geneconv above, but each site prediction contributed to the accuracy only if one tree topology had a bpp greater than a specified threshold, as shown in figures  <dig>  and  <dig> . experimental sets showing high accuracy in both recombined and non-recombined regions  are an indication of desirable performance. in general, the prediction accuracy of barce and dualbrothers are better in comparison with the other methods examined. both programs tended to identify a single contiguous recombined region in comparison to the multiple fragments identified by geneconv and recpars.

for the reciprocal sets , both barce and dualbrothers showed high accuracy when recombining sequences were more divergent , with dualbrothers showing higher accuracy than barce; within the recombined region, dualbrothers showed a minimum accuracy of  <dig>  and barce showed a minimum accuracy of  <dig>  when λ =  <dig> .

a slightly different trend was observed in the non-reciprocal set . consistent with the observation in figure  <dig>  when the immediate preceding lineage length  was short , the phylogenetic signal of the recombined region was diminished to a greater extent by the resulting identical sequence fragments. barce and dualbrothers showed lower accuracy in recovering this region than the non-recombined region, especially when λ was high. for instance in l50/ <dig>  dualbrothers showed lower accuracy in recovering the recombined region  than in recovering the non-recombined region . the exact opposite trend was observed in l05/ <dig> when recombining sequences were more divergent, with accuracy in recovering the recombined region higher  than in recovering the non-recombined region . similar bias in recovering recombined or non-recombined region was observed with barce, although to a lesser extent. when both primary and secondary lineage lengths of a tree were long  prior to recombination, both programs showed high accuracy in recovering both regions, dualbrothers  more so than barce .

barce and dualbrothers, which use a bayesian approach to represent the sequential relationship and interaction among different sites of the alignment, proved to be more accurate in defining recombination breakpoints as compared to the other approaches. figure  <dig> shows the posterior probability of a site being proposed as a change-point of tree topology by dualbrothers across all sites in the alignment. two sharp peaks proximate to the designated breakpoints r <dig>  and r <dig>  were obvious in all cases when no subsequent substitution was simulated after recombination. the posterior probability decreased with increasing amount of subsequent substitution. for the non-reciprocal set, the observation was consistent with figure 5: more false positives were observed within the recombined region in l50/ <dig>  and more false positives were observed within the non-recombined region in l05/ <dig> 

the markov chains generated by dualbrothers were always initiated from a random point in the space of trees, breakpoints and models. to assess the sensitivity of sampled breakpoint posterior probabilities to the choice of start point, a subset of our simulated datasets was used, in which dualbrothers was implemented on each simulated set ten times, each time starting at a random point . for the majority of parameter combinations, the posterior probability of breakpoints at each of the  <dig> sites in the sequence was extremely stable  across all ten replicates, with higher variability observed at the 'shoulder' regions of breakpoints . even higher variability was observed in parameter combinations that yielded the most difficult-to-detect breakpoints , showing that the dataset requires a much longer run to achieve stable bpps. nevertheless, when a given site was assigned a breakpoint bpp ≥  <dig>  in a replicate, the bpp assigned to the same site in each of the other replicates was always greater than each respective median bpp. consequently, breakpoint identification was at worst still consistent across replicates, in spite of the high bpp variation seen for this combination of parameters.

sensitivity to parameter settings
although recpars tended to show higher prediction accuracy than geneconv , the optimal recombination cost was determined separately for every simulated data set in this study to yield the best possible prediction accuracy. we found little consistency in the choice of optimal recpars recombination cost across multiple simulations. when the cost of assigning a recombination breakpoint was too low for a given set of sequences, recpars defined a great number of incongruent tree topologies across the sequences, with some regions having a length of one column within the alignment. in contrast, no recombined region was detected if the recombination cost was too high. figure  <dig> shows the relationship between prediction accuracy of recpars and the recombination cost for l05/ <dig> and l50/ <dig>  the appearance of sharp peaks in the graphs shows that prediction accuracy is highly sensitive to the recombination cost. a similar situation applies to geneconv with respect to setting the value of the gscale parameter. gscale is a scaling factor of mismatch penalties on the polymorphic sites; setting gscale to zero prohibits fragments with internal mismatches, while gscale =  <dig> allows internal mismatches in the pairwise comparisons. posada  <cit>  reported that geneconv at gscale setting =  <dig> gave misleading results in a number of divergent empirical datasets. in separate optimisation tests on the simulation sets in this study, a gscale value of  <dig> was found to recover the largest fraction of the recombined regions in the simulated datasets .

relationship between simulation parameters and prediction accuracy
in this study, for each reciprocal and non-reciprocal set, the variation in prediction accuracy of recombination-detecting programs was related to a few major factors:  evolutionary history prior to recombination ,  substitutions after the recombination event , and  parameter settings for certain programs i.e. geneconv and recpars. to examine the relationship between these factors and prediction accuracy, multiple linear regression  analysis was carried out for each program individually. across all five detection programs in this study, all of the factors considered had significant effects on the prediction accuracy . since extremely low p-values could not be differentiated, comparison of the t-statistics associated with different factors was assessed to determine the relative strength of their effects on prediction accuracy. of the factors examined, the extent of subsequent substitution had the strongest effect on prediction accuracy in all approaches, e.g. geneconv with t-values - <dig>  in the reciprocal set and - <dig>  in the non-reciprocal set, consistent with the observed trends in figures  <dig> through  <dig> 

the overall f values obtained in the mlr analysis for each factor examined are associated with very small p-values , supporting the graphical evidence in figures  <dig> to  <dig> that the effects of simulation parameters on prediction accuracy are statistically significant. the adjusted r <dig> value shows the percentage of the outcome that could be explained by the factors examined in the study. the highest r <dig> value  was assigned to the substitution distribution-based approach , implying that approximately 85% of the outcome could be explained by the factors examined. the compatibility-based approach, reticulate, showed a similarly high r <dig> value . the phylogenetic-based approaches recpars , barce  and dualbrothers , had lower associated r <dig> values . most of the mlr assumptions  <cit>  were not violated by the data analysed, except for a slightly non-linear relationship observed between independent and dependent variables, and evidence for heteroscedasticity in some analyses . although the assumption of homoscedasticity was sometimes violated, mlr is robust to violations of this assumption when sample sizes are large, so the observed heteroscedasticity is unlikely to have a strong influence on our analysis.

discussion
using simulated sequence data and multiple regression analysis, we have shown that the prediction accuracy of recombination-detecting programs is affected by the reciprocal and non-reciprocal nature of the recombination event, prior evolutionary history, subsequent substitutions after the recombination event, and the choice of parameter settings in certain programs.

reciprocal versus non-reciprocal recombination events
the approaches showed higher accuracy in recovering reciprocal recombination events than non-reciprocal events, owing to the strength of the phylogenetic signal within the recombined region. in a reciprocal event, two lineages are exchanged, disrupting the phylogenetic relationship while retaining the original tree shape that has four terminal edges of equal length. in a non-reciprocal event, one sequence is over-written by another, reducing the genetic diversity in the set and producing a four-taxon tree in which two of the sequences are identical. this effect is stronger when all four sequences are more similar to each other at the point of recombination: while the region consisting two identical sequences was easily identified as a recombined region, a relatively small number of substitutions simulated afterward was sufficient to attenuate the phylogenetic signal of this region. therefore, the phylogenetic signal of non-reciprocally recombined regions was more sensitive to subsequent substitutions than was that of the reciprocally recombined regions.

evolutionary history prior to recombination
the prior evolutionary history of the four sequences also affects the accuracy of a program in assigning the correct phylogeny to the recombined and non-recombined regions. two good examples that illustrate this point are l50/ <dig> and l05/ <dig> in the non-reciprocal set .

in the case of l50/ <dig>  barce and dualbrothers showed high accuracy in recovering the phylogeny of the non-recombined region, but not of the recombined region. the phyletic grouping of sequences  and sequences  is supported by more shared substitutions in l50/ <dig> than in l05/ <dig>  so the program can recover the non-recombined region more easily. the lower accuracy within the recombined region is due to the effect of topological structure as mentioned above when the sequences are more similar to each other, i.e. when θ <dig> is short. the exact opposite trend was observed in l05/ <dig> , where the phylogenetic signal of the non-reciprocal event was stronger. since θ <dig> was short in this case, the phyletic grouping of sequences  and sequences  is not as obvious as in the case of l50/ <dig>  therefore, the programs showed low accuracy in recovering the non-recombined region, but high accuracy in recovering the recombined region. similarly with the observation in l <dig> of the reciprocal set , recombination-detecting programs showed high accuracy in recovering the phylogeny of both the recombined and non-recombined regions when the recombining sequences are more divergent. this observation supports previous studies that suggested that recombination is easier to detect with increasing levels of sequence divergence  <cit> , and that phylogenetic analyses of non-reciprocal recombination events are more sensitive to the prior evolutionary history of the sequences than are similar analyses of reciprocal events  <cit> .

substitutions after the recombination event
the extent of substitution after the recombination event  also plays an important role in determining the prediction accuracy of an approach. the phylogenetic signal of the recombined region becomes attenuated as subsequent evolution progresses, and the task of detecting evidence of ancient recombination events can be difficult or impossible. while all approaches in this study showed lower prediction accuracy with increasing amounts of subsequent substitution, the substitution distribution-based approach was found to be most sensitive. high rates of subsequent substitution independently on each sequence disrupt long contiguous matches in a local pairwise comparison, which the substitution distribution-based approach i.e. geneconv is solely based on. by iteratively sampling phylogenies across the alignment and suppressing minor variations in the phylogenetic pattern across a set of sequences, the bayesian phylogenetic-based approach was least sensitive to the effects of subsequent substitution. as recpars is based on finding parsimonious topological changes across alignment columns, and geneconv is based on significant pairwise alignments of fragments, these programs perform better when recombined regions are longer.

parameter settings
we demonstrated that the prediction accuracy of certain programs  is highly sensitive to specific parameter settings. when dealing with real datasets, it is almost impossible to know in advance the optimal recombination cost to use in recpars  <cit> . this supports the finding from a previous study that the phylogenetic approach performs poorly in detecting recombination  <cit> . a similar trend was observed in geneconv, for which prediction accuracy was shown to be affected by the gscale setting, as described in the results section.

identification of recombination breakpoints
previous studies suggest that reticulate and geneconv have similar detection power in detecting recombination events  <cit> , and that the compatibility approach of reticulate is one of the more reliable methods  <cit> . although these methods are computationally less intensive than the bayesian phylogenetic-based approaches, some of them  were designed to detect the presence of recombination events, not to locate recombination breakpoints  <cit> .

the bayesian phylogenetic-based approach proved to be the best in delineating recombination breakpoints, showing high accuracy. this approach has a great advantage over the other approaches in detecting ancient recombination events, as the prediction accuracy was the least dependent on the extent of subsequent substitution. in many instances, barce showed a pattern of gradual transition from one topology to another, with intervening sites that have no dominant topology. this pattern is a good indicator of a recombination event, but the exact location of the breakpoint is not obvious. although an abrupt change of tree topology bpp proposed between two adjacent sites is a good indication of a recombination breakpoint in some cases, there is no explicit proposal of breakpoints in barce. while the whole alignment was assumed to be under the same evolutionary pressure in barce, the dual multiple change-point  model in dualbrothers  <cit> , designed specifically to identify recombination breakpoints, proposes change point within the alignment, independently based on changes of tree topology and evolutionary rate. although more false positives in defining phylogenies  were observed with dualbrothers, the explicit proposal of breakpoints in the program can be analysed in a more systematic manner. as shown in figure  <dig>  the breakpoints were identified with two sharp peaks in the graphs.

as is the case with other iterative mcmc approaches, the accuracy of barce comes at the expense of runtime, and the program can only be applied to datasets having exactly four sequences. dualbrothers can be applied to datasets with more than four sequences, but the program can be very time-consuming because the dual mcp model is described by eight parameters related to location of breakpoints, tree topologies and evolutionary rates.

combinatorial approach
of all approaches examined, the conventional phylogenetic-based approach  is of least practical use due to dependency of the program on parameter settings. based on our findings in this study, we recommend use of the bayesian phylogenetic-based approaches in detecting recombination events and breakpoints. since the approach is time-consuming, faster approaches based on compatibility or substitution distribution can be used in the first instance to suggest the occurrence of a recombination event. for example, a marginally significant or significant clustering of incompatible sites in reticulate or an unusually similar fragment  determined by geneconv can be taken as suggesting a recombination event. bayesian phylogenetic-based approaches, e.g. dualbrothers, can then be applied to confirm, in a more-accurate manner, the possible breakpoints in the recombination event. we assumed a homogeneous evolutionary regime throughout the course of sequence evolution in this study using simulated data. when the evolutionary scenario is more complicated e.g. with different rates and different evolutionary models within a tree  <cit> , and for difficult detection problems involving highly divergent sequences, the use of fundamentally different approaches can provide multiple lines of evidence in support of the observed results.

CONCLUSIONS
in this study, we highlighted the strengths and weaknesses of different classes of recombination detection programs. we demonstrated differences in phylogenetic signals within recombined and non-recombined regions, between a reciprocal and a non-reciprocal event, and how these signals affect prediction accuracy of different approaches in detecting occurrence and identifying breakpoints of a recombination event. bayesian phylogenetic-based approaches showed high accuracy in identifying recombination breakpoints but are time-consuming due to the complexity of mcmc and the models used. the compatibility-based approach is fast and does not depend on specific parameter settings. the conventional phylogenetic-based approach, and to a lesser extent the substitution distribution-based approach, are sensitive to key parameter settings, and infer recombination events and breakpoints only when these settings are tuned to the data, which may be impossible to achieve with empirical data. in detecting recombination events, the negative dataset can be filtered out by a first-pass run using faster methods; the more-accurate  methods can then be used in delineating the recombination breakpoints among the positive dataset. the combinatorial approach is more time-efficient, especially when scanning through a large dataset. since the methods applied here are different in principle, identification of an event by multiple methods may also increase our confidence that a recombination event has indeed occurred.

