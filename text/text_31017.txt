BACKGROUND
the detection of periodically behaving gene expression time series has been an area of enormous interest lately. since more and more microarray  <cit>  data is becoming available, including time series, the periodicity detection methods from other branches of science are being modified for use in gene expression studies. periodicity detection methods can be broadly divided into generic and more specific detection rules. the generic approaches use the available statistical theory to seek strong periodic components at all the available frequencies  <cit>  and use exact tests to yield significance values with multiple correction. the more specific methods try to find periodic phenomena at specific frequencies, e.g. the assumed cell cycle frequency 

some of the most severe problems of processing gene expression time series data include short time series length, the presence of noise of unknown distribution, outliers , non-uniform sampling used in performing the experiments and other non-linearities involved in the measurement technologies themselves. outliers can be thought of as low-probability values from a mixture model where with a high probability the noise in the signal is modelled by a  distribution and with a low probability by another distribution whose variance is much higher than that of the first one. in earlier work we presented a robust modification  <cit>  of fisher's g-test  <cit>  for finding hidden periodicities in time series data. the method performs well both under the gaussian noise assumption and when outliers and other non-linearities are present. however, non-uniform sampling, other than the one resulting from missing values, was not considered and the aim of this paper is to evaluate different robust methods for periodicity detection that can handle non-uniform sampling. non-uniform sampling in periodicity detection has been previously considered in  <cit> . the authors use a so-called lomb-scargle periodogram to find the spectral estimate for a time series, not limited by non-uniform sampling, and then test whether the maximum value of the spectral estimate is significantly higher than the other values. while the method is mathematically sound and is based on an exact test, it is non-robust, as is the basic fisher's test. the same issue applies to most of the other previously published methods. exceptions to this are in  <cit>  and in  <cit> , where the authors use bayesian detection and show that the method can handle data that is corrupted with uniform and laplacian noise as well .

the matter of choosing the sampling scenario in a cost-effective way is discussed in  <cit>  where the authors present an active learning based online algorithm for choosing the sampling strategy.

in  <cit>  the authors have developed a periodicity detection method in which they fit orthogonal periodic polynomials to non-uniformly sampled data. if the periodicity of interest is not sinusoidal , the method improves on the performance of the lomb-scargle periodogram, but reduces to it in the case of sinusoidal model, which is the case of interest for us. an approach based on similar ideas is presented in  <cit>  where the authors use least squares fitting of wavelets which is especially suitable if we want to search for periodicity in non-uniformly sampled data with non-sinusoidal cyclic components.

in  <cit>  the authors use the lomb-scargle periodogram for periodicity detection and show that it performs better than the combination of interpolation to uniform sampling and ordinary periodogram. they point out that there is a low-pass effect involved in interpolation that is a major problem. in  <cit>  the authors use a complicated approach of neural networks for periodicity detection in non-uniformly sampled time series but use interpolation to uniform sampling first, which, according to  <cit> , causes problems in the high frequency end of the spectra. in  <cit>  the authors actually make use of non-uniform sampling in digital alias-free signal processing applications. however, their approach is based on the idea of being able to choose the sampling intervals, which is not the usual case in biological studies. a model similar to the one in this paper is presented in  <cit> , where the authors aim to estimate a wide spectral range of frequencies of a non uniformly sampled signal. their approach is, however, aimed more at real-time applications and longer signals than those usually present in microarray studies. some of these methods can be thought to be improvements over the standard periodogram but non-robust when it comes to heavy tailed distributions and/or mixture models where the presence of  outliers can cause large residuals in the estimators and thus bias the results. the bayesian approach  <cit>  is a clear distinction to the aforementioned approaches and presents an opportunity to make use of prior knowledge, such as the frequency of the oscillation. it is shown in  <cit>  that the bayesian detector performs better than methods that assume a strict frequency of periodicity  <cit>  in case the frequency is not exactly known a priori. other bayesian periodicity detectors are presented in  <cit> .

in this paper we follow the general direction of fisher's g-test together with multiple testing correction for the detection of periodic time series in multiple time series data. several modifications are needed to take into account non-uniform sampling and unknown noise characteristics. we use several different robust regression based methods  <cit>  to find the spectral estimate of a time series instead of using the basic non-robust periodogram. by using regression we can readily take non-uniform sampling into account.

after finding the spectral estimate we propose to replace the periodogram in the g-test with the robust spectral estimate. since no analytical results for such modifications exist, we resort to permutation tests in finding the p-values. we also note that the test can be modified to yield a test for one specific chosen frequency if an a priori hypothesis is made about the frequency of the periodicity of interest.

to compare the performance of the different regression methods and some of the previously introduced novel methods  <cit>  in this framework, we use simulations and show the receiver operating characteristic  figures under several noise and signal configurations and non-uniform sampling. the computational complexity of the different methods is also briefly considered.

as an application we choose one of the best performing methods and apply it to microarray data measured from the mussel mytilus californianus. our experiments indicate that there is no statistically significant connection between the circadian rhythm and cell cycle regulated genes that could be expected to show periodic expression.

RESULTS
simulation based performance
the performance of the different introduced estimators when using the g-test framework is now verified by simulations and through the use of receiver operating characteristic curves . the following simulations are first based on the assumption that we do not know the frequency of the underlying periodic signal. in addition, we iteratively subtract the fitted sinusoidals in the process of calculating the fourier coefficients when using the robust regression based methods . we then simulate time series where we have approximate a priori knowledge on the frequency of periodicity and compare the performance of the regression approach to the rank based method presented in  <cit>  and the bayesian detector presented in  <cit> .

before going into the details of the roc curves, we first present two non-uniformly sampled simulated periodic time series of length  <dig> and their estimated power spectra as examples. the periodic time series and the corresponding spectral estimates are shown in figure  <dig>  the sampling of the first time series ) is chosen according to the experimental mussel data  that was conducted at time points  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  hours after the beginning of the experiment , so that the samples are taken usually approximately every three hours but sometimes there are four to five hour gaps. this sampling is a good representative of a real world measurement. the sampling of the second time series ) is an artificially deteriorated version of the first one, so that sometimes the samples are closer together and sometimes farther apart. these artificial sample times were chosen to be  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  hours after the beginning of the experiment. the three spectral estimates in figure 1b) and figure 1d) correspond to an ideal spectral estimate , the periodogram of the samples  and the regression based m-estimate. as we can see, in the first case  the periodogram estimate is still quite good but when the sampling gets worse , the periodogram no longer operates properly since it assumes uniform sampling. to test more formally which of the methods, if any, outperforms the others we now resort to the roc curves.

the roc curve is a plot of sensitivity 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaamaalaaabagaemivaqlaemiuaafabagaemivaqlaemiuaalaey4kasiaemoraykaemota4eaaagaayjkaiaawmcaaaaa@3615@ on the y-axis, versus 1-specificity 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaamaalaaabagaemoraykaemiuaafabagaemoraykaemiuaalaey4kasiaemivaqlaemota4eaaagaayjkaiaawmcaaaaa@35f9@ on the x-axis. tp stands for true positive, fn for false negative and so on. for a perfect test the sensitivity is  <dig> for a specificity of  <dig>  for any non-ideal tests the roc curve shows the sensitivity-specificity tradeoff. the line segment from  to  is called the chance diagonal since the discrimination ability of a test is near to random if the curve is near to the diagonal.

a priori unknown frequency
we use the model of equation  in the generation of  <dig> periodic time series corresponding to the alternative hypothesis and  <dig> nonperiodic time series corresponding to the null hypothesis. we consider the same two cases of non-uniform sampling described above. for each time series we calculate the g-statistic and order the values. we repetitively accept one more time series as periodic and since the ground truth is known, we can now tell the number of true and false positives and true and false negatives to construct the roc curves for each of the methods. since we assume the null distribution to be the same for all the time series we do not use permutation tests here. we chose to consider three types of noise for both of the non-uniform samplings, namely where the additive noise is gaussian , gaussian  with outliers at random locations ) or laplacian . the underlying periodic signal in the alternative hypothesis set always has an amplitude of 2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabikdayawcbeaaaaa@2db9@  as in  <cit>  and the frequency of periodicity is uniformly random chosen in the interval 2π.

a priori known frequency
in case we have prior knowledge on the frequency of the periodicity of interest, it is desirable to take this into account when trying to rank the time series according to periodicity. for the purpose of performance comparison we compare here the simulated roc curves of three methods under the two presented sampling scenarios when the frequency is approximately known. we choose for the simulations the m-estimator as a representative of the regression estimators, the bayesian approach method presented in  <cit>  and the rank based method not designed for not-uniform sampling  <cit> . the strength of the bayesian method  <cit>  is that it is training-free and it does not assume a single frequency for the periodicity but rather a prior distribution whose mean and scale can be tuned according to prior knowledge.

we generate four sets of  <dig> time series according to the null hypothesis with gaussian noise  and  <dig>   <dig>   <dig> or  <dig>  randomly placed outliers of amplitude ±  per series. for the alternative hypothesis sets  we generate sinusoidals of random phase, amplitude 2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabikdayawcbeaaaaa@2db9@ and frequency uniformly distributed in the range 2π in addition to the additive noise similar to the null hypothesis set. we then deliberately choose the frequency that is given to the periodicity detectors incorrectly as 2π  <dig>   and observe the roc curves for the three methods. the standard deviation for the bayesian method was set to  <dig>  as in  <cit> .

as we can see in figure 4a) and 4b) , the bayesian method is superior to the other chosen periodicity detectors in case the additive noise present in the signals is pure gaussian and our knowledge on the frequency is inaccurate. however, a single outlier changes the whole situation and, as can be seen, the performance of the m-estimator in case of  <dig> outliers , although suboptimal on gaussian data and having chosen the frequency incorrectly, is approximately the same as the performance of the bayesian method in case of one outlier. thus, the m-estimator is much more robust when it comes to inconsistencies in the data.

as we can see, there is no single best approach to periodicity detection and one must weigh the options. if we want to reject outliers and have non-uniformly sampled data, the m-estimation based regression estimator is a safe choice. if we have a reason to trust in the gaussian noise model  and we have weak prior knowledge on the frequency of the cycle period, the bayesian approach  <cit>  should be the best alternative. in the case of uniform sampling and no prior knowledge on the frequency, the rank based estimator  <cit>  is also a considerable option, among others.

computational complexity
without going into more subtle considerations of asymptotic time complexity we just present the needed time to calculate the fourier coefficients for two signal lengths using a modern laptop computer and matlab. although this running time comparison is not absolute and depends on particular implementations, it is indicative of general computational costs. in table  <dig> we can see that the least trimmed squares  and minimum covariance determinant  regression methods take a lot of time if compared to the lomb-scargle and the tukey's biweight m-estimator. in case of non-uniform sampling we therefore suggest to use the m-estimator since it performs quite fast and robustly as was seen in the subsection simulation based performance. the bayesian detector is not included in this comparison since it does not involve similar spectral estimation of the whole spectrum as the regression based methods here do. the implementation of the bayesian detector is relatively slow if compared to the m-estimator when considering single frequency detection.

the methods in practice
we analyse here the microarray time series data set obtained from the mussel species mytilus californianus, by measuring the gene expression over several days with non-uniform sampling. it is expected that the gene expression of some of the genes of the population would correlate with the tidal cycle or day and temperature cycle. we therefore seek the genes that are periodically expressed in the 24-hour cycle and show the annotations and time series profiles of the best ranking signals. in practice we use m-estimator based regression to fit sine and cosine signals of 24-hour cycle to the time series. to estimate the null hypothesis distribution  for the estimated coefficients we use  <dig> random permutations of each time series.

because we use a finite number of permutations in forming the null hypothesis distributions, p-values of zero  are now possible. in fact,  <dig> of the best time series had a p-value of zero. the  best  <dig> time series are plotted in figure  <dig> with the x-axis showing time in hours. as the first time point is at 8: <dig> am, we can see that there is a positive peak in  and a negative peak in  at around 12: <dig> am, and every  <dig> hours from then on. since 12: <dig> am usually corresponds to the highest daily temperature, this suggests that these genes could have temperature  as a regulator. two of the genes were not sequenced and seven of the genes were not annotated as of yet. the annotations for myt_12d <dig>  myt_22j <dig> and myt_12p <dig> are transcription elongation factor b polypeptide  <dig> , protein c3orf <dig> and ubiquinol-cytochrome c reductase complex  <dig>  kda protein, correspondingly. as a comparison, we also applied the bayesian detector  <cit>  to the mussel data set. forty genes were found that were in the list of top hundred ranked genes according to both of the methods, implying that the methods produce fairly similar results.

to determine how many of the best ranked genes we should accept as periodic we use the false discovery rate at a level of  <dig> . this corresponds to  <dig> of the best time series out of  <dig>  this is quite a conservative decision boundary since the visual inspection of the first few hundred time series clearly shows similar patterns as in figure  <dig> 

the best detected genes were mostly expressed at small amplitude. to determine if there was a biological theme to the best detected genes, a gene set enrichment analysis   <cit>  was performed using the list of genes ranked by the significance of periodic signal against  <dig> gene sets which were defined by their shared participation in a specific biological process in the gene ontology database. these gene sets covered biological processes which are known to be under circadian regulation in mammals such as the cell cycle and metabolic pathways. this analysis revealed that none of these gene sets were statistically significantly enriched towards the top of the ranked list of periodic genes. one explanation for this finding is that biological prior knowledge may be incomplete and does not capture the sets of genes that are under circadian regulation in mussels, or that the circadian cycle is attenuated in the tidal environment and does not really contribute much to the cyclic expression of the genes.

replicate spots of each gene  were removed prior to enrichment analysis to prevent false hits.

CONCLUSIONS
the usual motivation for using methods based on least squares and a gaussian model assumption, is that the theoretical background is thoroughly understood and computations are easier than in the case of robust methods. however, in reality, outlying data points are present in biological high throughput measurements such as microarrays. we have shown here that even a small number of outliers cause problems in periodicity detection if least squares methods are used. taking into account the amount of data produced by microarray experiments, the manual replacing of these outliers is not possible and even if it was, the question of how to replace the outliers raises even more questions.

this leaves us with two reasonable approaches: we could either use a robust filter to clean the data first and then use methods based on least squares or use robust methods in the first place. if we however take a closer look at the filter cleaner proposed in  <cit> , the method first evaluates a robust spectral estimate with m-estimator regression and then takes the inverse discrete fourier transform to yield a cleaned time series. if we then evaluate the periodogram of the time series we end up with the same estimated power spectrum as we would have gotten by just using the m-estimator. this shows that in this case the two mentioned approaches are actually the same.

in addition to robustness against outliers we have shown in this paper that if sampling is not performed uniformly, it is very important to choose analysis methods that can adapt to not-uniform sampling. the regression based periodicity detection method implemented with the tukey's biweight m-estimator was shown to have excellent performance in simulation studies and provided visually good results with real measurement data as well. since the method can be readily implemented and is relatively fast to use, we propose it to be used as a first choice in periodicity detection with non-uniformly sampled data.

future work includes the use of wavelets in periodicity detection. this has been previously considered in the literature in the context of spectrum estimation  and gene expression periodicity analysis  <cit>  but it would be interesting to try to robustify the wavelet transform to reject outliers. besides straightforward periodicity detection with wavelets, the robustify interpolation of the non-uniformly sampled time series to uniform sampling would be one reasonable approach as well. the ever growing need for data integration is also an urgent matter that must be given much attention in the future. combining computational predictions from different data sources to increase statistical power is of utmost importance.

