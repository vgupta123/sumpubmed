BACKGROUND
microarrays have become a widely used tool to measure gene expression levels on a genome-wide basis and are available from a number of manufacturers. each platform incorporates proprietary technology, with differences in probe design, probe bioinformatics, probe creation and deposition, reagents and protocols across platforms introducing variability into expression analysis. a large body of work has studied the reproducibility of microarray data and therefore the interchangeability of commercial platforms. a dialogue over data sets, analysis methods, and concordance measures has evolved, but no clear consensus on the level of agreement or disagreement in expression results has been reached.

it is generally understood that differences between platforms exist. the source of contention is the interpretation of the magnitude of these differences. some conclude from the data that microarray results are sufficiently comparable across platforms  <cit> . others caution that the technological differences have not yet been sufficiently resolved to combine experimental results from different platforms  <cit> . regardless of the overall interpretation, both sides hypothesize that some of the differences may be attributable to the presence of splice variants  <cit> .

although alternative splicing is a logical source of cross-platform differences, there has been no direct evidence to show that this is the case. studies have indicated 40% or more of all human genes are alternatively spliced  <cit>  and expression measurement differences may arise when probes on different platforms target differentially expressed splice variants of the same gene. it has been previously demonstrated that a sequence matching method between probes increases cross-platform consistency and reproducibility  <cit> . others have matched probes to genes and shown that annotation discrepancies affect analysis  <cit> . here, we combine the two ideas to provide evidence for alternative splicing based cross-platform disagreement.

we created an in-depth probe/genome/transcript annotation using the aceview transcript database. aceview is a comprehensive annotation of transcripts and genes that incorporates data from genbank, dbest and refseq  <cit> . it has been shown to offer a richer view of the transcriptome, with  <dig> to  <dig> times more high-quality transcript forms than ucsc known genes, refseq or ensemble  <cit> . capturing transcript diversity is important because probes may be derived from the same loci, but match different transcript sequences due to alternative splicing.

using this new annotation, we categorized genes on each platform according to their susceptibility to splice variant differences and measured their cross-platform agreement in a biological data set using a traditional correlation measure and a euclidean distance measure. the novel usage of the distance measure lends itself to a visualization that can show alternative splicing differences or other poorly performing probes.

RESULTS
matching platform-specific probes to aceview and refseq transcripts
we created a transcript-level annotation of microarray probes to study the effects of alternative splicing on cross-platform microarray discordance. microarray probe sequences from affymetrix , agilent  and codelink  were aligned to the genome and annotated as matching transcripts through shared genomic coordinates from the aceview and refseq  <cit>  transcript databases . table  <dig> shows the results of both the genome and transcript mappings.

"unique probes" is the number of probes on each platform that had sequences to be aligned. the other alignment categories indicate the number of probes that had a specific alignment.

greater than 95% of all probes on the three platforms had genome alignments. overall, 73%, 94% and 90% of agilent, codelink and affymetrix probes, respectively, had aceview transcript alignments. the comparatively fewer alignments for agilent stem from the strict coordinate restrictions we placed on the multiple-exon cdna genome alignments. a detailed account of probe alignment conditions is available .

as anticipated, more probes were found to match to aceview transcripts than refseq transcripts, with 21%, 11% and 13% more total probes for agilent, codelink and affymetrix, respectively. the rest of our analysis was therefore conducted using aceview data. agilent and codelink utilize single probes to target a gene and generate expression measurements. the affymetrix u95av <dig> chip is different. it targets a gene with a probe set consisting of up to  <dig> probes and summarizes the probe set to generate expression measurements. to create a transcript-level annotation of probe sets, a probe set was said to target a transcript if  <dig> or more probes matched it. an internal study showed five probes are necessary for reliable summarization measurements . of the  <dig> affymetrix probe sets,  <dig> matched at least one transcript with  <dig> or more probes.

genes categorized by susceptibility to alternative splicing based differences
to detect the effects of splice variation on gene expression measurements, we categorized each gene by probe specificity against known splice variants as annotated in aceview. genes most susceptible to expression measurement differences from splice variants are those in which the probes from each of two different platforms interrogate mutually exclusive, or disjoint, sets of transcripts. genes that are not susceptible to these measurement differences are those in which probes on both platforms target the same, or equal, sets of transcripts. in between the two extremes are genes that are susceptible to splice variants, but the effect of which cannot be measured because the platforms target common transcripts as well as transcripts specific to each platform. using our transcript annotation results, we categorized genes commonly targeted by each pairwise platform combination based on their susceptibility to alternative splicing. to match the affymetrix gene expression data used below, the affymetrix probe set annotation was used, as described above. the number of genes in each category for affymetrix/agilent, affymetrix/codelink and agilent/codelink is shown in table  <dig> 

let a be the set of transcripts a probe on platform a targets

let b be the set of transcripts a probe on platform b targets

equal a = b : number of genes in which platform a and b target equal transcript sets.

disjoint a ⋂ b = Ø: number of genes in which platform a and b target disjoint transcript sets.

a\b ≠ Ø: platform a and b target the same gene, but platform a targets extra transcripts that b does not.

b\a ≠ Ø: platform a and b target the same gene, but platform b targets extra transcripts that a does not.

note: the total number of classified genes can exceed the number of common genes because a gene may be a member of both a\b = Ø and b\a = Ø.

correlation measure of alternative splicing discordance
we looked for overall splice variant differences utilizing gene expression data from a previous biological experiment. rna was obtained from panc- <dig> cells of a pancreatic ductile cell phenotype and an early stage of their differentiation to a pancreatic islet phenotype . five technical and biological replicate microarray experiments were run on each platform and their results were averaged to produce a single fold change value for each gene. we analyzed the expression data by creating scatter plots of the log <dig> fold changes for genes in the equal and disjoint transcript sets for each pairwise platform combination, shown in figure  <dig>  only genes that were statistically significant at p-value <  <dig>  on at least one platform were included in our analysis. table  <dig> shows the computed pearson and spearman correlation coefficients for each of the disjoint and equal gene groups.

r – correlation coefficient

95% ci – rho is the 95% confidence interval around r calculated using fisher's transform

p-value – value for testing the hypothesis of no correlation against the alternative that there is a non-zero correlation

n – number of genes in each pairing used in correlation calculation

there is a drastic drop in the correlation coefficients from the equal to the disjoint transcript sets for all three platform pairs; the difference being  <dig> ,  <dig>  and  <dig>  for pearson and  <dig> ,  <dig> , and  <dig>  for spearman from the affymetrix/agilent, affymetrix/codelink and agilent/codelink comparisons, respectively. as genes with disjoint transcript sets are most susceptible to alternative splicing based differences and genes with equal transcript sets are unsusceptible to alternative splicing based differences, the drop in the correlation coefficients between these two groups suggests alternative splicing is a contributing factor to platform discordance.

distance measure of alternative splicing discordance
a distance measure provides an alternative view of the data to confirm the correlation coefficient results. we calculated the log <dig> fold change of experimental versus control groups for each of the five replicates individually, creating a vector of the five fold change values for each gene on each platform. using log <dig> fold change places each platform into a common measurement space. we then calculated the euclidean distance between expression vectors from different platforms for the genes in the equal and disjoint transcript sets. unlike the previous scatterplots, no restriction was made on statistical significance of the gene. next, we plotted a cumulative distribution function  of all calculated distances for each grouping to highlight the differences attributable to alternative splicing, shown in figure  <dig> 

a curve that rises steeply and is shifted to the left represents a distance distribution that includes smaller distances than a curve shifted farther to the right. smaller distances between expression vectors across platforms indicates higher agreement. the cdf curve for probes with equal transcript sets  is shifted to the left and rises faster than the cdf curve for disjoint transcripts sets  for all pairwise platform combinations. thus, equal transcript sets tend to have smaller distances and higher agreement than disjoint transcript sets, indicating a distinct alternative splicing effect in platform discordance.

to establish a baseline for comparison, we randomly paired expression vectors from genes on different platforms and calculated the distances. a cdf of distances from unrelated expression vectors provides an unbiased worst-case distribution and the baseline cdf is plotted in figure  <dig>  by comparison, if two platforms agreed completely, the cdf would be a unit step function. platform distance distributions based on equal and disjoint gene sets fall in between the two extremes, as the baseline cdf is shifted to the right, establishing the distance for unrelated measurements.

probe-level distance measure
agilent and codelink both use single probes to target a gene, but the affymetrix u95av <dig> genechip utilizes probe sets consisting of  <dig> probes to target a gene. probe set gene expression measurements are statistical summarizations of member probes, which can be influenced by dead probes, cross-hybridization and other effects  <cit> . in order to generate a clearer view of expression measurements and agreement levels, we thought to analyze probe-level expression vectors instead of probe set summarizations for affymetrix platform combinations.

we conducted a similar analysis as before, creating a vector of fold change values from the five replicates for each individual probe. to better isolate the effects of alternative splicing, we reduced the effect of cross-hybridization by removing from the analysis the  <dig> %,  <dig> % and  <dig> % of individual affymetrix, agilent and codelink probes, respectively, that matched multiple aceview gene symbols. probe cross-hybridization results, as implied by sequence, are shown in table  <dig> 

for all genes shared between platforms, individual probe-probe comparisons using the probe annotations were made for equal or disjoint transcript set targeting. by examining all possible combinations of individual probes, it was hoped that details masked by the probe set annotation would become apparent. we created cdfs of all of the probe distances in each category and established a baseline by randomly pairing probe expression vectors, shown in figure  <dig>  the alternative splicing effect is again apparent, with a left shift of probe distance cdfs for the equal transcript set versus disjoint transcript set.

kolmogorov-smirnov test
the kolmogorov-smirnov test is used to determine if two samples are drawn from the same underlying distribution. we used it to test whether the equal-disjoint, equal-random and disjoint-random cdf combinations for each of the platform pairs differ from each other. table  <dig> illustrates the test results, laid out to match the ordering of the platform pairings in figure  <dig>  at p <  <dig> , we reject the null hypothesis of drawing from the same distribution for all cdf combinations except for disjoint-random on affymetrix probeset/codelink . we accept that the equal, disjoint and random distance distributions are different from each other, except in the case of disjoint-random for affymetrix/codelink , where we cannot reject the null hypothesis that they are the same.

the distance distributions are different, indicating the shifts towards smaller distances and better agreement are meaningful in figure  <dig>  however, the disjoint transcript set in any pairwise combination involving affymetrix probes  is not appreciably better than random, unlike the probe set-level cdfs, indicating affymetrix's reliance on probe sets and robust algorithms for accurate expression measurements.

individual gene expression visualization
we generated a distance matrix containing all pairwise probe distances for each gene. by turning the matrix into a heatmap colored by distance, with probes ordered by their position along the transcript, clusters of probes with signals showing high agreement and similar patterns show up as darker blocks along the main diagonal. figures  <dig> and  <dig> are examples of the visualization for the genes thioredoxin-like  <dig>  and flap structure-specific endonuclease  <dig> , respectively. txnl <dig>  otherwise known as picot  is a hypertrophy-inducible, pkc-inhibiting negative regulator of hypertrophy. no biological function has as yet been ascribed to be splice-variant specific. fen <dig> removes 5' overhanging flaps in dna repair and processes the 5' ends of okazaki fragments in lagging strand dna synthesis. the top part of each figure shows the aceview transcript forms and where the probes align.

txnl <dig> is a case of disjoint transcript sets being targeted by affymetrix and agilent. the affymetrix probe set targets txnl <dig> caug <dig> . two agilent probes target txnl <dig> baug <dig> . in the heatmap, the agilent probes clearly form a dark cluster distinct and distant from the affymetrix probes. examining the log <dig> signal intensities, agilent shows a clear separation between the control and experimental groups while affymetrix shows no pattern at all. agilent microarray results indicate that txnl <dig> is downregulated, with fold changes of - <dig>   and - <dig>  . affymetrix microarray results indicate no change, with a fold change of - <dig>  .

these results were validated by pcr experiments. real-time pcr showed a fold change of - <dig>   for the transcripts targeted by agilent. the transcript targeted by affymetrix failed to amplify after  <dig> cycles. the lack of amplification corroborates the low signal intensity and lack of signal pattern in the microarray data, meaning the affymetrix transcript is likely not present in the sample. therefore txnl <dig> represents a gene whose discordant expression measurements are attributable to alternative splicing, because each platform targets mutually exclusive transcripts with different, validated results. there were three additional transcripts for which we could adequately design a real-time pcr assay and for which probe alignments are shown . in the first case, cdc <dig> was significantly downregulated when assayed by codelink  but unchanged by affymetrix . surprisingly, we were not able to validate either result by real-time pcr , suggesting a false positive result for codelink and a false negative one for affymetrix. in two other cases where increased transcript expression was detected by affymetrix ,  <dig> , p <  <dig> ) and by codelink , , both were validated by real-time pcr . correspondingly, results from the agilent platform showed no change for different variants of both genes,  and fmo <dig> , respectively). nevertheless, we further determined by real-time pcr that these specific variants were also upregulated . these results demonstrate that additional factors clearly contribute to the dissociation of results across platforms, and that splice variants may only play a partial role in explaining these differences.

one of these factors might be the existence of poorly performing probes possibly resulting from failure to hybridize, or susceptibility to cross-hybridization. fen <dig> is an example of a visualization revealing poorly performing probes. a group of four affymetrix probes, outlined in green, are distant from all of the other probes for the gene, including the agilent and codelink probes . due to an existing non-disclosure agreement with ge healthcare, we are unable to show the position of the codelink probe on the genome, but it is in the vicinity of affymetrix probe 41583_at- <dig>  the group of four probes shows poor or no separation in the log <dig> signal intensity between the control and experimental groups, unlike the other probes that show clear downregulation. this difference is not due to transcript specificity and highlights the fact that individual probes can misbehave for other reasons.

discussion
mapping probes to transcripts via the genome yields more information and is more complex than a direct probe/transcript mapping. genome coordinates show the cause of alignment failures, such as probes aligning to an intron. in addition, genome builds are more stable than transcript databases and allow for enhanced future study. for instance, a probe may have been designed using proprietary transcript sequences or map to an unexplored area where tiling arrays indicate transcriptional activity  <cit> . while we may miss some alignments involving rare non-standard introns or some agilent cdna clones due to our algorithm, we maintain a high stringency of matches between genome coordinates, probes, and transcripts.

the algorithms that generate genomic alignments and transcript annotations differ for the three platforms. they serve as an abstraction layer to transform the different probe designs from each platform into commonly comparable annotation data. annotation quality is the key factor when investigating alternative splicing disagreement. although we maintain a high stringency in the alignments, the agilent cdna probes have lower transcript hybridization specificity than affymetrix or codelink due to their length. therefore, under actual hybridization conditions, agilent may target more transcripts than our purely sequence-based annotation indicates. while this may slightly impact the agilent results, our annotation provides a good starting point for alternative splicing analysis. for instance in txnl <dig>  agilent and affymetrix target disjoint transcripts based on sequence alone. it is possible that agilent could bind to the affymetrix transcript, txnl <dig> caug <dig>  though we do not know for sure. even so, we were able to assay the terminal exon exclusive to affymetrix to show splicing-based disagreement. screening for such candidate genes most susceptible to alternative splicing requires at least a detailed sequence-based annotation.

the drop in correlation coefficients of expression measurements across platforms from genes impervious to alternative splicing based differences to those genes most susceptible to alternative splicing based differences seems to indicate alternative splicing plays a role in platform discordance. although correlation coefficients are widely used measures of platform concordance, the large drop was not necessarily supported by a corresponding visual change in the distribution of data points underlying the coefficient calculations.

we verified the correlation coefficients by using a distance measure derived from gene and probe-level log <dig> fold change data from replicate samples. instead of using other fuzzy measures such as percent gene list overlap to measure improvement, our distance measure provides a clearer measure that cuts to the signal differences attributable to alternative splicing. the cdf shows that probes that target equal transcripts have fold changes that on average are closer and more agreeable between the two platforms than probes with disjoint transcripts. a key point is that the cdfs were generated without any arbitrary p-value or fold change filtering of the probes. since we are not concerned with methods to improve concordance, we did not utilize any filtering method or thresholding that could change the interpretation of microarray results. the cdf differences show that alternative splicing is a layer on top of the basic platform technology differences that contributes to platform discordance, independent of any post-processing method.

while alternative splicing clearly affects platform discordance, making a broad-based quantification of its effects is difficult. first, alternative splicing is tissue dependent  <cit> ; not only do the variants need to be differentially expressed, but the genes affected will change in each experiment. while we categorized genes based on their susceptibility to alternative splicing differences, the majority of genes have both common and specific transcript targets on each platform, making it difficult to isolate the effect of alternative splicing from the underlying technological discordance represented in the common transcripts. though it is not possible to establish a universal boundary on alternative splicing's contribution to discordance in this study, we have provided evidence for its existence.

basic platform technology differences are revealed in the cdfs for genes with equal transcript sets on any two platforms compared. these genes are unsusceptible to alternative splicing differences, yet the cdf does not approximate a stair-step function that would indicate complete agreement. other platform differences may include high probe/mrna secondary structure, difficulties in labelling and other design and protocol considerations. therefore underlying platform-based differences exist and are unexplainable by alternative splicing alone. in this respect, our inability to validate some of our discordant microarray results demonstrates that clearly other factors exist. to aid in understanding this phenomenon, our distance measure also offers a way to visually examine similarly performing probes. in a heatmap of pairwise probe distances for a gene, clusters of probes became visually apparent based on shared signal intensity patterns according to positional ordering. the presence of clusters of "close" probes provides both insights into probe performance behaviour and a sanity check on the distance measure itself. however a more in-depth study using other clustering techniques on different factors could show probes grouped together on the basis of gc content or hybridization conditions, revealing the causes of differing probe behaviour for the same transcripts.

in addition to probe design-dependent differences in sensitivity and specificity, systematic and random sources of variability unrelated to probe sequence can contribute to an "intrinsic" level of discordance across expression arrays. for instance, context-dependent differences in expression data have been reported across generations of affymetrix arrays with identical probe sequences  <cit> . moreover, a study by the maqc consortium showed that cross-site concordance rates for a single array platform was ~50–65% for the most highly ranked differentially expressed genes when two related samples were compared . this within-platform agreement rate is noteworthy compared to the ~40% cross-platform agreement rate previously reported  <cit> . in our current analysis, more detailed anova models were used to describe and subsequently remove non-biological sources of variability specific to each platform, such as batch effects due to rna extraction and array- and dye-specific bias. assuming that systematic errors typical of a microarray experiment can be accounted for in this manner, the remaining discordance is still only partly explained by the presence of splice variants. in this regard, a similar re-analysis of other multi-platform datasets would be highly interesting and our code is made available for this purpose .

as known transcript diversity increases, we expect the number of genes with equal transcripts on both platforms to decrease, raising the confidence of the annotation of the remaining genes, producing lower distances and a sharper cdf. despite the certain existence of technical variables affecting cross-platform concordance, we believe inter-platform agreement rates can be further improved as use of the transcriptome for probe annotation increases. to further advance this goal, we have recently provided custom chip-description-files and annotation files for a transcript-based probe set redefinition of the human affymetrix arrays  <cit> .

CONCLUSIONS
using an in-depth transcript annotation, we categorized genes as being either impervious or susceptible to alternative splicing cross-platform differences. examining gene expression data for these genes in two manners, we provided evidence that alternative splicing cross-platform discordance exists. utilizing a distance measure, we were able to create a gene visualization that can highlight probe differences. alternative splicing's contribution depends heavily on the prevalence of alternative splicing in the experimental data set and it is a factor adding to omnipresent and underlying technical differences.

