BACKGROUND
in the decade since the publication of the haemophilus influenzae genome sequence in  <dig>  <cit> ,  <dig> microbial genomes have been completed, with another  <dig> in progress  <cit> ; as of october  <dig>  2004). multiple strains of the same organism, or multiple species of the same genus are being sequenced or have been completed, making comparative genomic analysis possible on an unprecedented scale. as the technology continues to improve, the number of completed microbial genome sequences will further increase â€“ a major challenge of the comparative genomic era is to fully exploit this data. however, the development of tools for analysis of such data sets has not kept pace.

blast analysis has become a ubiquitous method of interrogating new sequence data, but there are limitations to using blast alone as a discriminating tool. many other methods and individuals use blast output e-values as a criterion for data parsing. while this measure may be efficient, the output is often skewed by both the database used for comparison and the length of the match  <cit> . small regions of high similarity can generate an artificially low e-value and negate the global level of similarity exhibited by the sequence. this bias is eliminated when using the blast raw score as it is directly derived from the similarity of the match. however the value of the blast score varies with the length of the peptide queried, and hence is not suitable alone for comparative analysis using universal cutoffs  <cit> .

several other tools utilize the blast algorithms to compare nucleotide or peptide sequences from genome projects. the wellcome trust sanger institute act software  <cit>  can display nucleotide similarity between two genomes based on blastn e-value. act builds upon artemis and displays regions of high similarity mapped on the genome annotation. the genomecomp tool  <cit>  displays a similar analysis also based on blastn e-values to compare genome sequences. ncbi taxplot, a three-way genome comparison tool based on precomputed protein blastp e-values displays a point for each protein in the reference genome based on the best alignment with proteins in each of the two genomes being compared  <cit> . on the other hand, the simitri program utilizes blastp comparisons of three proteomes and uses the raw blast score, not e-values. however, only protein similarity data is represented and no information on the comparative structure of the genomes is provided  <cit> . moreover, the simitri program does not address blast artifacts derived from the size of the database or the length of the match. this paper describes the blast score ratio  algorithm that enables comparative analysis of multiple proteomes, together with visualization of genome structure .

bsr analysis is a departure from traditional genome scale analyses as it overcomes the limitations of blast e-values in comparative studies by normalizing the blast raw scores. bsr analysis is a tool for the rapid comparison of complete proteomes of any three genomes, and enables a visual evaluation of the overall degree of similarity of these proteomes and their genomic structure.

implementation
we have implemented the bsr algorithm using perl. the inputs are the predicted proteomes of each of the three genomes under analysis, formatted as multi-fasta files. an additional file for each of the proteomes is required. this file must contain a unique identifier, matching the fasta header of the corresponding peptide in the multi-fasta file, the relative genomic location of the start and stop of the coding region as well as the annotation for each peptide. the user selects one proteome as the "reference"; the other two proteomes are termed "query1" and "query2" respectively. initiation of the script results in each of the putative peptides in the reference proteome being compared to all of the other peptides in the reference and query proteomes using ncbi blastp.

the bsr is then computed as follows. the blast raw score for each reference peptide against itself is stored as the reference score. each reference peptide is then compared to each peptide in the query <dig> and query <dig> proteomes with each best blast raw score recorded as query <dig> and query <dig>  respectively . the bsr is calculated by dividing the query score by the reference score for each reference peptide . thus, for each peptide in the reference genome, two numbers are generated, one from each from the best matches in query <dig> and query <dig>  thus normalizing all scores in the range of  <dig> to  <dig>  a score of  <dig> indicates a perfect match of the reference peptide to a query peptide and score of  <dig> indicates no blast match of the reference peptide in the query proteome. the blast raw score is used rather than the e-value for the blastp results as it more accurately accounts for the length of the similarity between the reference and query peptides  <cit> . this normalized pair of numbers can be plotted as coordinates in cartesian space for each peptide in the reference proteome, enabling the visualization of the entire reference proteome in comparison to the two query proteomes .

outputs
following calculation of the bsrs, a number of output files are generated, including both text and graphical formats. the text files are tab-delimited for ease of parsing; filenames are derived from the named proteome files used as input into the script. the r_q1_q <dig> txt  output contains an ordered list including the reference peptide unique identifier, annotation, and reference blast raw score, in addition to the unique identifier of the best hits in the query proteomes, corresponding blast raw scores and the calculated bsr. additionally, four unique files are generated corresponding to the peptides within the four quadrants delineated in figure 1b. the four quadrants are derived from a bsr threshold value of  <dig> , which was empirically determined to represent approximately 30% amino acid identity over approximately 30% of the peptide length, a commonly used threshold for peptide similarity  <cit> . this threshold value can be adjusted using the "-c" option .

the graphical output files are viewed with gnuplot  <cit>  to reveal the global similarity of the compared genomes as well as the level of conserved genome structure. postscript and xfig  <cit>  graphic files are subsequently generated by gnuplot. the scatter or similarity plot provides an overall view of the level and number of similar and dissimilar proteins in the reference proteome when compared to the query proteomes . the regions of the graph are color-coded depending on the level of similarity between the three genomes . quadrant a , colored in orange, contains peptides unique to the reference proteome with little similarity in either of the query proteomes. quadrant c , colored red, contains peptides that have significant similarity in all three compared proteomes. quadrant b, colored green, contains reference peptides with similarity to only query proteome  <dig>  whereas quadrant d, colored blue, contains reference peptides that have similarity to only query proteome  <dig> 

two additional plots, termed synteny plots, are generated, one for comparison of the reference proteome to each query proteome, by plotting the genomic location of the reference peptide on the x-axis and the genomic location of the most similar query peptide on the y-axis. this plot alone would demonstrate the level of synteny  between the two genomes  <cit> , however, an additional level of information is included by coloring each point based on the bsr . the color provides an additional visual clue to the global level of similarities of the proteomes. for example genomes can be highly syntenic with relatively low levels of proteomic similarity as is shown in figure 2a and 2b or they may have a high degree of protein similarity andconserved genome structure .

the gnuplot, postscript and xfig outputs allow publication-quality, global visualization of the similarity and synteny of the selected genomes. however these formats do not allow the annotation associated with individual peptides to be viewed interactively. to overcome this limitation, additional xml files for the similarity and synteny plots described above are generated. these files are the input for the freely available ggobi software. ggobi is a data visualization system for viewing high-dimensional data  <cit> . the tools provided in the ggobi software package allow the annotation associated with individual points within the similarity and synteny plots to be viewed interactively .

the ggobi package also allows the expansion of the bsr approach to include more than three genomes or other additional parameters associated with proteomic or genomic data, enabling interactive, user-driven exploration of these complex datasets. the current bsr implementation uses three genomes as input; however, additional genomes can readily be added as new dimensions simply by repeating the analysis with the same reference genome and varying the query genomes. additional non-bsr dimensions are readily included, such as pi or %gc, or factors such as surface localization or some other feature of the peptides of interest.

RESULTS
genome structure is often altered during the evolution of species  <cit> . visualization of this structure often lends insight into genome evolution and examination of the various bsr outputs rapidly reveal alterations of the genome structure as well as the overall similarity of the two query proteomes to the reference proteome. the genomes of the order chlamydiales  provide an example of this insight. in figure 1a large proportion of the peptides are conserved, with  <dig> % of the proteins shared between all three proteomes. if the query proteomes are further used as the reference proteome and vice versa we still see a similar trend . additionally, the proteome of c. pneumoniae ar <dig>  is more similar to c. caviae gpic  than c. muridarum strain nigg  as  <dig>  % of the proteome is shared between only c. caviae gpic and c. pneumoniae ar <dig> compared to only  <dig> % between c. caviae gpic and c. muridarum strain nigg. finally, figure  <dig> demonstrates that  <dig> % of the c. caviae proteome has no significant hit to any of the peptides in the query proteomes, although many of these peptides  are currently annotated as hypothetical.

from the analysis in figure  <dig> we could conclude that the chlamydial proteomes are extremely similar and suggest that the genome structure will also be similar. however, the synteny plots in figure 2a and 2b demonstrate that while the chlamydial proteomes exhibit a high degree of similarity, there is significant alteration in the genomic structure. the comparison of the proteomically similar organisms, c. caviae gpic and c. pneumoniae ar <dig> reveals that the genomes contain two points of inversion . one of these points of inversion is centered on the terminus of replication. there are more extensive genomic rearrangements between the c. caviae gpic and c. muridarum strain nigg genomes . the additional color information extends the utility of these synteny plots. while the chlamydial genomes show regions of conserved synteny, as demonstrated by the peptides in the same genomic location forming a line with a slope of  <dig> or - <dig>  the absolute degree of similarity between the peptides, demonstrated by color indicates divergence. by contrast the synteny plot of two escherichia coli genomes  demonstrates a high level of synteny with a number of unique insertions, however no inversions are present. moreover the color dimension on this plot reveals that unlike the chlamydial proteome comparisons the e. coli proteomes have a high level of similarity andsynteny.

in the analysis of the chlamydial proteomes using bsr score and blast e-values approximately 1% of peptides examined have a bsr score >  <dig>  and blast e-value >  <dig> Ã— 10- <dig>  these peptides were all very small in size  and greater than 50% amino acid identity. this group of peptides is more readily identified by bsr analysis than blast e-value, which is artificially low due to the small peptide size. additionally, peptides that have a bsr score <  <dig>  but a blast e-value <  <dig> Ã— 10- <dig> correspond  <dig> % of the proteome. these represent divergent peptides with an artificially high blast e-value score resulting from limited regions of identity. the bsr analysis more accurately classifies these peptides based on the amino acid identity over the entire peptide. as the bsr comparison utilizes a single genome as a reference, the bsr score is calculated using a unidirectional best blast hit. however, when the chlamydial proteomes were compared only one case in over  <dig> could be found with a bsr score >  <dig>  that was not also a bidirectional best blast hit.

CONCLUSIONS
the bsr approach allows rapid evaluation of the level of conservation of any three proteomes and the degree to which the genome structure between the three genomes is similar. while in this report we discuss the applications of this approach to whole genomes, the analysis has been performed on portions of genomes such as genomic or pathogenicity islands, plasmids and phage to identify peptide similarity and regional structure.

more genome sequences are being generated from closely related organisms â€“ a trend which shows no sign of abating. the bsr approach has become a crucial tool in our comparative genomics armamentarium and has been utilized in a number of genomic comparisons, revealing regions of similarity and difference between both closely and distantly related organisms  <cit> .

availability and requirements
project name: bsr.pl

project homepage: 

operating system: unix and macos x

programming language: perl

other requirements: perl statistics::descriptive module 

license: none

any restrictions to use by non-academics: none

list of abbreviations
bsr â€“ blast score ratio; blast â€“ basic local alignment search tool.

authors' contributions
dar, gsam and jr conceived and implemented the first versions of bsr and prepared the manuscript. all authors have read and approved the final manuscript.

acknowledgments
the authors would like to thank timothy d. read for initial consultation on development of the bsr algorithm. jr and dar are supported by federal funds from the national institute of allergy and infectious disease, national institutes of health, under contract no. n01-ai <dig>  gsam is supported by niaid r <dig> ai <dig> 

figures and tables
