BACKGROUND
gene expression profiling is widely used to investigate the dynamics of cellular responses through quantification of changes in transcript abundances. microarray methods have been widely used  <cit>  to monitor global gene expression changes during investigations of transcriptional regulatory mechanisms and have been the gold standard in expression profiling studies for most of the last 15 years. alternate methods, such as sequencing of expressed sequence tags   <cit>  and differential display pcr  <cit>  were restricted by cost and design difficulties. with the advent of serial analysis of gene expression   <cit> , sequencing-based expression profiling emerged as a cost-effective alternative to microarrays. despite various improvements like longsage  <cit>  and supersage  <cit> , issues such as lower data acquisition rates, laborious protocols, and the requirement for specialized equipment have restricted rapid adoption of sequencing-based methods. recent improved sequencing techniques  have led to a remarkable increase in data acquisition rates, and have enabled simplified protocols. with wider accessibility of these sequencing systems, there has been an increase in the use of sequencing-based expression profiling methods; these have several advantages, such as the opportunity to detect all expressed genes and to determine their absolute abundances without hybridization biases. additionally, higher depth of sequencing enables superior dynamic range of detection, highly sensitive differential expression assays, and also an opportunity to minimize costs through multiplexed sequencing.

recent advances in next generation sequencing  technologies have been discussed in detail in several reviews . ngs technology has facilitated genome re-sequencing  <cit> , de-novo genome assembly  <cit> , transcriptome and non-coding rna sequencing, transcriptome assembly , as well as sequencing of genome wide protein binding or methylation sites  . ngs transcriptome sequencing methods are broadly referred to as rna-seq methods and have also been used for differential gene expression analysis  <cit> . rna-seq is a powerful method for whole transcriptome annotation, identification of novel splice junctions and rare transcription events. several other methods were developed based on the principles of sage  methods that sequence a small fragment of cdna from a defined position for expression profiling . these methods can be broadly referred as tag-seq methods as they are aimed at sequencing a small and relatively defined region of mrna generally referred as ‘tags’. rna-seq can be used to measure differential expression, but the need for 10– <dig> times more reads than a typical tag-seq, biases associated with transcript lengths  <cit> , and the absence of uniform coverage of regions in mrna  <cit>  make inferences about relative gene expression levels difficult. with tag-seq methods one cdna tag is sequenced from each expressed gene, thereby making relative expression analysis straightforward by simply counting tags for each gene. increased depth of sequencing allows investigators to make these methods cost-effective through barcoded-multiplexed sequencing.

most existing tag-seq methods such as nlaiii-dge  or super sage or 5′ sage methods use restriction enzymes and adapter ligation for cdna tags. for sage to work, each transcript requires the presence of a restriction enzyme recognition site . therefore, no expression information can be obtained for a gene without the anchoring enzyme site. in arabidopsis,  <dig> and 5 % of genes lack dpnii and nlaiii sites respectively. the sage methods also involve digestion using a tagging enzyme , which produces a short cdna tag that is sequenced later. each of these tagging enzymes has a complex restriction nuclease activity and the mechanism of restriction digestion of these enzymes is not entirely understood. an additional shortcoming of sage is that the tagging enzyme sites often occur within the genes and lead to longer tag sequences, resulting in loss of such tags during size selection. for example, in arabidopsis  <dig> genes  have at least one recognition site  for mmei in the sense strand. mmei, a type iis restriction enzyme, has both restriction and methylating activity and inhibits restriction digestion at high enzyme concentration due to methylation of the recognition site  <cit> . similarly ecop15i, a type iii restriction enzyme with restriction and methylation activity, needs two restriction recognition sites in head-to-head orientation to effectively digest the dna, and the distance between two recognition sites can influence digestion efficiency . methods based on analysis of 5′ ends of cdnas either involve low throughput methods eg using methyl cap  <cit>  or have amplification biases that are less reliable in strand specificity   <cit> . there is thus a need for a tag-seq method that produces reliable expression data with no or minimal biases and is amenable for analysing hundreds of samples.

others have attempted to generate restriction digestion independent tag-seq using nebulisation  <cit> . however, nebulisation for cdna shearing of many samples is not practical. we used adaptive focussed acoustics , a technology from covaris  that uses high frequency ultrasonic sound waves, to shear dna to a desired size. afa-sheared dna or cdna has been successfully used for whole genome and whole transcriptome sequencing  <cit> . we have developed a protocol named expression profiling through randomly sheared cdna tag sequencing  that employs afa random shearing of double-stranded cdna for high throughput expression profiling. implementation of exprss tag generation protocol is not limited to afa sheared cdna but can also be used for sonicated cdna derived from other technologies such as sonicman  or bioruptor .

RESULTS
exprss tag-seq protocol and experimental setup
the exprss tag-seq method involves the following steps . first strand cdna is synthesized through reverse transcription of poly rna from total rna using a custom oligo-dt primer. the oligo-dt primer, at the 5′ end, has illumina single end flow cell primer sequence referred as p <dig>  <cit>  and the oligo-dt sequence was terminated with  <dig> two nucleotide combinations comprising v  & n  to initiate reverse transcription at a poly  junction. second strand cdna synthesis was carried out according to okayama and berg  <cit> . purified cdna was sheared using covaris afa to a target size of ~200 bp and sheared cdna was end-repaired and da-tailed. a y-shaped adapter with a dt overhang was ligated to da-tailed sheared cdna fragments. the y-shaped adapters were designed as described previously by prashar and weissman  <cit>  so that the primer binding sites for amplification on the adapter end will only be synthesized after priming from the p <dig> sequence on oligo-dt end. therefore, the y-shaped adapters ensure selective amplification of the 3′-most fragment of each cdna, so that only one tag per transcript is sequenced at a defined average distance from the 3′ end, specified by the choice of shearing parameters. this adapter design also prevents adapter dimer amplification and also provides the opportunity to directly sequence on illumina without prior amplification. the adapter also contains  <dig> to  <dig> base barcodes at the ligation junction for multiplexed sequencing of libraries. barcodes of different lengths were introduced to avoid predominance of t at any particular base position, resulting from t/a ligation. alternative implementation of “bareback” from the babraham institute  <cit>  would have enabled us to use a simpler barcode design. however, it is not possible to store sequence data images with current data analysis pipeline of gaii and no such option exists for hiseq. hence, the approach we adopted is an excellent method for multiplexed sequencing with reliable base calling on the illumina platform. alternatively, an unsupported version of the base calling pipeline is available with a delayed base calibration option, which was found to give mean quality of reads less than those from real time analysis  <cit> . the barcodes were designed so that with an equimolar mixture, there would be near equal distribution of all four bases at each position in the first 5– <dig> bases. therefore, it is not necessary to run a phix lane for base calibration of cdna tag sequencing especially for samples with gc content < 40 %, such as the arabidopsis transcriptome.figure  <dig> 
schematic diagram representing exprss tag-seq.  library preparation  data analysis pipeline.



to test the exprss method, an experiment was conducted in which leaf discs from 5 week old plants of arabidopsis ecotype col- <dig>  were treated either with water or flg <dig>  for 60 minutes  <cit> . four biological replicates were collected and 5 μg of total rna was used from each sample for library preparation. for comparative purposes, 5 μg of each rna sample was also subjected to nlaiii-dge library preparation protocol  <cit> . however three modifications were made to the nlaiii-dge protocol ;  barcodes were introduced in the adapter <dig> for multiplexed sequencing and  methylation of adenosine was used in the nlaiii recognition site  to favour adapter <dig> ligation to cdna over cdna and cdna ligations  <cit>  and  adapter <dig> was biotinylated to avoid two rounds of size selection to remove adapter <dig> self-ligated products, which would get preferentially amplified creating pcr biases in the library  <cit> . a detailed protocol is provided in additional file  <dig>  eight libraries  prepared for each method, were mixed in equimolar ratios and sequenced using illumina genome analyzerii .

exprss sequence tags can be reliably assigned to transcripts
exprss library preparation uses total rna and unlike nlaiii-dge no prior selection for poly rna was performed. most of the total rna is ribosomal rna , and the number of reads mapped to arabidopsis rrna sequences  <cit>  was examined to rule out non-specific reads from rrna. reads mapping to rrna from the eight sequenced exprss libraries accounted to  <dig>  %. a similar analysis on nlaiii-dge reads indicate about ~ <dig>  % of reads map to rrna. most of the rrna reads in exprss are from transcripts downstream of the  <dig> s rrna-encoding loci  with cdna evidence in tair database . although nlaiii-dge has less reads from rrna, there were no reads from the transcripts downstream of  <dig>  s rrna-encoding loci, as they lack nlaiii restriction sites, exemplifying one of the caveats for restriction enzyme based methods.

individual libraries from multiplexed samples were aligned to tair <dig> genome sequences  <cit>  using bowtie short read alignment software  <cit> . three main groups of tag sequences were observed from the uniquely mapped reads of exprss data sets . type a tags  align within ~ <dig> bp from the 3′ end of existing gene models. type b tags align upstream of  <dig> bp from the 3′ end, revealing genes with early polyadenylation sites. type c tags align to antisense strands of existing gene models. in the following three sub-sections, we explain various sequence tag groups detected and their assignment to gene expression analysis.

i exprss tag-seq generates cdna tags at a controlled distance from polyadenylation site


characteristics of exprss tag-sequences.  uniquely aligned tags to the sense strand of cdna and genome sequences from all arabidopsis genes are used to plot tag alignment position as a distance from 3′ end of annotated genes against the frequency of reads mapped. rectangle selection is shown as inset picture.  example of alternative polyadenylation. a distinct cluster of tags from both full length  and short  sense transcripts of fca , which are about  <dig>  kb apart. evidence from cdna sequences  in the tair database corroborates short transcripts. reads from such alternative polyadenylation transcripts result in a long tail in tag alignment frequency distribution presented in a.  frequency distribution of antisense tags aligning to  <dig> selected transcripts plotted against mapping position as a distance from 5′ end of annotated genes. each individual abundantly expressing an antisense transcript has a distinct peak of tag alignment suggesting a defined polyadenylation site for antisense transcripts identified through exprss method.



the exprss method is mainly intended to produce a tag sequence from the 3′ end of each cdna. as the cdna is randomly sheared to ~200 bp, which includes 48 bp of oligo-dt_p <dig> primer, the resulting fragments should contain ~150 bp of transcript sequence. if shearing of cdna is random, most sequenced reads should align within ~300 bp  from the 3′ end of cdna. this distribution however, depends on the precision of polyadenylation machinery and the dexterity in fragment size selection. furthermore, shearing of cdna overcomes the bias associated with longer genes since to make a tag from cdna for a gene, only the last 300–400 bp need to be reverse-transcribed. also, each gene produces only one tag per transcript thus, avoiding the need for length-based data transformations usually employed in quantitative rna-seq protocols. the efficiency of random shearing was tested by plotting mapping frequency against the alignment distance from the 3′ end of cdna. uniquely matched tags to the sense strand of genes were included in this analysis and the distance for the longest splice variant was taken into consideration for tags that match to multiple splice variants of a gene. figure 2a shows the plot of pooled frequency of tags aligned against the distance from 3′ ends in bp from the start position of the tag. as expected for random shearing, ~90 % of the tags aligned within the ~300 bp distance from 3′ end with a clear peak at ~150 bp. tags derived from transcript variants, with either premature or alternative polyadenylation, contribute to the long tail of distribution reaching the 5′ end . tags aligning to distinct long and short transcripts of fca  support this interpretation. identification of alternative polyadenylation sites in exprss data sets is only reliable when these sites are >200 bp apart so that tag peaks can be identified and distinguished. affymetrix microarray probes for each arabidopsis gene were designed to span up to ~ <dig> bases upstream of the stop codon  <cit> , which thus also pools expression information from alternative transcripts of a gene as one. therefore, for expression analysis purposes, both type a and type b tags that align to a particular gene and its splice variants are combined. all reads aligning to different splice variants of a gene are pooled.

ii antisense transcription



the tag sequences resulting from the exprss method are directional. thus, type c tags aligned to the alternate strand are either due to antisense transcription or novel transcripts on the antisense strand of annotated transcripts. antisense transcription revealed by sage or rna-seq analysis has been widely reported from plants and animals . in the present study, ~ 17% of the transcripts that provide tags  were found to be derived from the antisense strand of genes. antisense transcription observed in this study is not due to second strand cdna synthesis by reverse transcriptase, which was shown to compromise strand specificity of microarray based techniques  <cit> . such artefacts would not influence exprss data sets, since the strand synthesized from mrna using oligo-dt primer acts as a template for sequencing, thus providing the same strand information as that of the mrna.

one hypothesis for the high amounts of antisense transcription observed is gene looping during transcription  <cit>  which might lead to antisense transcription by jumping of the transcriptional machinery to the other strand. in this scenario, genes with high levels of sense transcription should have a higher chance of antisense transcription. if that were the case, genes with differential expression in both sense and antisense transcripts , would be expected to show high correlation between sense and antisense counterparts and relatively high expression level of the sense transcripts . however, this was not the case, as the pairwise correlation of mean expression represented as tpm for the  <dig> genes between sense and antisense transcripts showed that apart from a few genes on the diagonal and genes with high expression, the distribution was either side of the diagonal . additionally the distribution of mean expression for the  <dig> genes shows that about 44% of sense transcripts have less than  <dig> tpm, while only 6% of the genes have more than  <dig> tpm . it has also been suggested that antisense transcription might arise due to convergently overlapping gene pairs   <cit> . further analysis identified that only  <dig>  are part of  <dig> genes identified as cops in arabidopsis by jen et al.  <cit> . the majority of genes with antisense transcription had a clear peak of tags at a defined position suggesting a relatively defined polyadenylation position for these transcripts , supporting a possible regulatory role for these antisense transcripts. these data rule out that antisense transcription is an artefact. since the current study is focussed on establishing a method for high throughput expression profiling, this antisense transcription was not further investigated.

iii non canonical transcription and tag to gene assignment


differential expression observed for sense and/or anti-sense transcripts of genes using exprss


nd - no differential expression.



two other types of tags obtained from this study are sequences from novel polyadenylated longer transcripts and sequences from regions of genome without predicted gene models . tags not assigned to any genes from the arabidopsis genome  alignment were further analysed to identify regions with novel transcription and alternative polyadenylation. a transcript downstream of at1g <dig> shows flg22-dependent downregulation , while a chloroplast-derived transcript upstream of atcg <dig>  shows similar and high expression in all replicates of control and treatment samples. further instances of novel transcription were identified when all the un-assigned reads from eight libraries were pooled , highlighting the need for increased depth of sequencing to investigate such phenomena.

to assign tags to genes, reads were initially mapped to arabidopsis genome sequences  <cit>  and unaligned reads were mapped to transcript sequences  <cit> . details of tag to gene association and alignment parameters are explained in the methods section. we have created modules of our analysis pipeline and implemented them in galaxy, an open web-based research platform  <cit>  and modules are provided in additional file  <dig>  exprss tag-seq can generate long  reads. with exprss reads, we found that ~94% of reads aligned uniquely, ~5% mapped to multiple positions and 1% were unmapped. the longer cdna tags prompted us to test the number of genes each multiply-matched read aligned to. from the plot of cumulative frequency of multiple matched reads against the number of genes, it was striking to observe that ~77% of multiple matched reads aligned only to two genes . with arabidopsis having duplicated at least 2– <dig> times  <cit> , many genes show paralogous gene families. the exprss data either can reveal differential expression patterns between paralogs or sum expression levels of indistinguishable paralogs. where tags could be assigned to up to  <dig> multiple paralogs, matching reads were split equally between them.

multiplexing with reproducible tag sequencing
since our experiments commenced, reads per lane on the illumina gaii increased from  <dig> million to 35– <dig> million reads. this enables ~ <dig> fold multiplexing for  <dig> million reads per library. we employed barcodes of varying length in exprss, with  <dig> fold multiplexing for experiments presented in this manuscript and  <dig> fold multiplexing at present in our lab. for exprss ~ <dig>  million reads passing the illumina quality filter were obtained of which ~ <dig> % reads with “n” and below quality threshold were discarded . for nlaiii-dge ~ <dig> million reads passing the illumina quality filter were obtained of which ~10% were discarded as reads with “n”, below quality threshold, adapter only and shorter than  <dig> bp tag sequence. sequenced libraries were computationally assigned to sub-libraries based on perfect match to barcode for exprss data and up to  <dig> mismatch allowed for nlaiii-dge data. for exprss, each sub-library received ~12% reads, while  <dig> % have no distinct barcode. for nlaiii-dge, each library received ~ <dig> % reads, and  <dig> % reads with no distinct barcode were discarded. library distributions are presented in table  <dig>  artefact filtering using fastx-toolkit  <cit>  resulted in loss of  <dig> % and 4% of reads in each sub-library for exprss and nlaiii-dge respectively. most of these reads were found to be due to poly sequences, initially assumed to be resulting from the poly tail. on further inspection these reads in exprss were found to result from ligation of excess oligo-dt primer to the adapters. however, this factor introduced no technical bias into exprss libraries as evident from higher reproducibility of replicates presented later. since these fragments occur due to t/a ligations, we have designed an approach to reduce oligo-dt primers ending with adenosine. since our oligo-dt primer is a mixture of  <dig> primers ending with vn  we have used an equimolar mixture of  <dig> primers ending with v*b  and  <dig> primers ending with va. after 2nd strand synthesis, primers ending with adenosine were depleted by exonuclease i digestion.table  <dig> 
library distribution of exprss and
nla
iii-dge multiplexed sequencing



total sequences

quality filtering

without barcode

1h_water_r1

1h_water_r2

1h_water_r3

1h_water_r4

1h_flg22_r1

1h_flg22_r2

1h_flg22_r3

1h_flg22_r4
r <dig> - r4: replicates  <dig> to  <dig> 



in order to verify that tag generation and barcoding process do not create any technical variability,  <dig> independent libraries were prepared from the same arabidopsis water- and flg22- treated leaf disc rna samples and different barcodes ligated. eight million reads passing the illumina quality filter were obtained for each of water and flg22-treated exprss technical replicate libraries . pair-wise pearson correlations of log <dig> transformed count data are presented in figure 3a-c  and additional file  <dig>  figure s <dig> . very high correlations  between technical replicates support that the tag generation and barcoding process have not introduced any significant variability . similarly, higher correlation  was observed between biological replicates of exprss tag-seq libraries , while correlations between biological replicates of nlaiii-dge tag-seq libraries  were less than those of exprss . fewer tag sequences were retrieved for control replicate  <dig> and treatment replicate  <dig> of exprss samples . however, the correlations between exprss replicates are still very high indicating robust sampling . most of the deviation for these less sequenced samples is observed for genes with very low tag frequencies compared to other replicates.figure  <dig> 
higher reproducibility and better dynamics of differential expression detection using exprss.  pairwise scatter plots of gene counts from treatment replicates, expressed as tags per million in log <dig> scale. correlations between four independent technical replicates of exprss tag-seq , made from same rna sample; four independent biological replicates of exprss tag-seq  and nlaiii-dge  are presented. pearson correlation of log <dig> transformed tag counts per million plus  <dig> is depicted at left hand top corner of each comparison. right hand bottom corner indicates replicate number depicted on x and y-axis, respectively.  example of differential expression using reads aligned  to wrky <dig>  a flg <dig> responsive gene are presented from control  and treatment .



comparison of differential expression between exprss, nlaiii-dge and microarray
differential gene expression analysis was carried out using the bayseq r package  <cit>  for both exprss and nlaiii-dge data; genes with fdr < <dig>  were classified as differentially expressed. an example of differential expression from exprss data is provided in figure 3d-e. it depicts the number of tags observed for wrky <dig>  a flg22-inducible gene encoding a wrky transcription factor, in control and flg22- treatment data sets . tags observed upon flg <dig> treatment are ~ <dig> times more compared to tags observed with water treatment, in line with previously published microarray analysis  <cit> . it is apparent that there are multiple polyadenylation sites in wrky <dig> and all of them are induced upon flg <dig> treatment. the distribution of tags aligning to wrky <dig> at the 3′ end is wider than expected . this observation is in agreement with varying lengths of cdna, resulting from alternative polyadenylation, in the tair database . full-length transcripts of wrky <dig> have most of their tags aligned and thus provide an example that not only illustrates the dynamics of expression differences but also supports the choice of summation of tags from alternative transcripts for each gene to identify differential expression at the gene level. once differential expression is validated, further investigations can be carried out on alternative transcripts.

microarrays have been widely used for gene expression analyses. we therefore compared differential expression results derived from exprss data, microarray data and nlaiii-dge data. exprss and nlaiii-dge data sets were generated from the same rna sample, while microarray data is from similar rna samples from a previous study, hybridised to affymetrix ath <dig> chip  <cit> . analysis of exprss data identified differential expression in  <dig> transcripts;  <dig> of which were derived from sense transcripts  and  <dig> from antisense transcripts  . a similar analysis on nlaiii-dge data revealed differential expression in  <dig> transcripts  . microarray analysis using the rankproducts method  <cit>  revealed differential expression in  <dig> probe sets  associated with  <dig> genes  . comparisons were performed between these three methods, using only the sense gene list. figure 4a shows the venn diagram representing the results from a 3-way comparison. not only does exprss have a higher overlap with nlaiii-dge  but it also has a similar overlap with microarray data , while the overlap of nlaiii-dge with microarray is 23% . as mentioned in the introduction, one of the main advantages of tag-seq methods is the opportunity to identify all genes expressed in a cell, unlike detecting only spotted genes on a microarray. genes not present on the ath <dig> microarray chip that are detected by exprss and nlaiii-dge are highlighted in red in the respective section of venn diagram . to find the similarities with respect to expression changes detected between the methods compared, fold- changes of genes commonly found from each pairwise comparisons are used for correlation analysis. correlation of fold changes from genes commonly found by exprss & microarray is  <dig> , exprss & nlaiii-dge is  <dig>  and microarray and nlaiii-dge is  <dig>  . correlations from expression fold-changes indicate that there is generally a good agreement between platforms and more so for exprss with ath <dig> microarray data and nlaiii-dge. the data showing higher overlap of exprss data with microarray and nlaiii-dge, better agreement of expression changes, and increased differential expression detection, highlights the potential of exprss tag-seq as an expression profiling method.figure  <dig> 
comparison of differential expression between exprss,
nla
iii-dge and affymetrix ath <dig> array.  venn diagrams showing overlap of differential expression identified from the same rna samples  and similar rna sample . overlap of  sense transcripts   antisense transcripts identified by exprss and nlaiii-dge.  q-pcr confirmation of differential expression observed through exprss. three up-regulated genes  and five down-regulated genes  that are found differentially expressed with exprss are verified with qpcr. error bars indicate standard deviation from three biological replicates. fdr values are provided for exprss log <dig> fold changes.



one key observation coming from the differential expression analysis is that additional genes are identified in exprss compared to the other two methods. validation of differential expression was carried out to verify some of the genes identified from exprss tag-seq through qpcr. a set of genes spotted on the microarray or not spotted on microarray that were differentially expressed in exprss was chosen for qpcr verification. details about all the genes and their expression levels in exprss and qpcr are provided in additional file  <dig>  double stranded cdna samples subjected to exprss library preparation were also used for qpcr verification. figure 4c and d verify that differential expression of selected genes could be confirmed with qpcr. evidence from qpcr supports differential expression from the selected genes identified by exprss method. however, there are  <dig> genes that are not differentially expressed in exprss but found to be differentially expressed using microarray data. further analysis revealed that  <dig> genes of these were identified in exprss data and about one third of the genes had fdr between  <dig>  and  <dig> , suggesting that they are near the statistical threshold . most of the remaining genes had mean expression levels less than  <dig> tpm and high variability among replicates. such discrepancies can thus be associated with depth of sampling and statistical techniques employed.

higher sensitivity of the exprss method
exprss revealed differential expression in more genes than the other two methods and we wanted to verify if differential expression was observed for these additional genes in previous flg <dig> experiments. therefore microarray data from previously published flg <dig> treatments of plants at various developmental stages were compared with exprss tag-seq data. ath <dig> microarray data from seedlings treated with  <dig> μm flg <dig>  <cit> , mature leaves infiltrated with  <dig> μm flg <dig>  <cit>  and leaf discs generated from mature leaves incubated in  <dig> nm flg <dig> solution  <cit> , were used for the analysis. flg <dig> samples were compared against  <dig> hr water treated samples for leaf and seedling arrays and with untreated samples for leaf disc arrays. details of differential expression are provided in additional files  <dig> and  <dig>  the rank products method  <cit>  was used to generate differential expression lists  from the  <dig> hr flg <dig> treatment microarrays and resulting lists were compared against the exprss data. the outcome of these comparisons is summarised as venn diagrams in figure 5a and b. the majority of flg22-induced genes from various tissues are in good agreement among microarray experiments. in pair-wise comparisons of microarray data, the overlap for upregulated genes ranged from  <dig> to 74% . for upregulated genes exprss has 92% overlap with leaf disc data , 77% overlap with seedling data  and 74% overlap with leaf data . there is a substantial overlap of exprss tag-seq with three microarray datasets , for common as well as specific identifications. 64% of the upregulated genes identified by exprss that are spotted on ath <dig> chip, were found to be differentially expressed in at least one of the three microarray datasets. although some these genes were only identified at a different developmental stage or with differing concentration of flg <dig>  exprss tag-seq is sensitive enough to identify responding genes.figure  <dig> 
sensitivity of exprss in differential expression detection for specific responses to treatment.  venn diagram representing overlap of differential expression for flg <dig> treatment from four different experiments   up-regulated genes between the four methods are compared.  down-regulated genes between the four methods are compared.  depiction of the overlap among the sections of venn diagram. number under each experiment represents number of genes differentially expressed.   scatter plots showing fold change distribution for commonly detected genes between two experiments.  comparison of log <dig> fold changes between leaf and seedling microarray shows more restricted dynamics on negative scale  than positive scale .  similar comparison of log <dig> fold changes between leaf disc data from exprss and nlaiii-dge showing more even distribution .



compared to upregulated genes, the overlap of downregulated genes between three microarray experiments is less. in pair-wise comparisons of microarray data, the downregulated gene overlap ranged from  <dig> to 37% . however, exprss profiling data has better overlap with two of the three microarray data sets. exprss has 64% overlap with leaf disc data , 49% overlap with seedling data  and 23% overlap with leaf data  for downregulated genes. to understand the poor overlap of downregulated genes from three microarray experiments, fold-changes of genes commonly detected among three microarray experiments were compared pairwise. it was interesting to observe the detection dynamics is restricted for downregulation compared to upregulation . similar analysis on the genes commonly detected between exprss and nlaiii-dge has shown that fold-change distribution is relatively even on both positive and negative scales . it appears that there is a detection bias with microarray analysis in favour of gene induction rather than down-regulation, while sequencing based methods do not show such a limitation. with such a sensitive technique available there is a tremendous opportunity to study tissue-specific as well as other response-specific genes. higher overlap of exprss tag-seq with data from previous flg <dig> treatment of various tissue microarrays supports the sensitivity of the exprss method.

exprss tag-seq reliability and paired-end sequencing
expression profiling of flg <dig> responses in arabidopsis ecotype col- <dig> was carried out over a time course to study transcriptional regulation during flg <dig> triggered pti and to validate the reliability of the exprss tag-seq. additionally we performed a flg <dig> time course on mutants from three major hormonal pathways . we collected three replicates each of  <dig> time points of flg <dig> treatment  and a water treatment control. comparison of correlation between  <dig> replicates of 60 minutes flg <dig> samples from time course data with  <dig> replicates of data presented earlier, from validation of exprss tag-seq, show significantly high correlation . differential expression analysis over 60 minutes of flg <dig> treatment revealed ~80%  and ~90%  of genes found differentially expressed using  <dig> replicate data from expss validation. the high correlation  between log <dig> fold changes of  <dig> genes from two experiments supports the consistency of exprss tag-seq . additional genes found in the time course experiment could be due to comparison using a different control sample than with the validation experiment. high correlations  have been observed between three biological replicates of  <dig> data points collected . samples were sequenced on different lanes of the same flow cell , or on different flow cells from separate runs . the high correlations of replicates confirm that variation due to library preparation or sequencing lane or sequencing runs is minimal. differential expression analysis on the time course data identified flg22-dependent gene expression changes as early as 8 minutes. details of genes differentially expressed during the flg <dig> time course from four genotypes are provided in additional file  <dig>  hormonal signalling mutations  responded similarly to col- <dig> during flg <dig> treatment, while ein2- <dig> appeared to show a weaker response . on further investigation it is evident that ein2- <dig> displayed higher induction or repression of flg22-responsive genes in uninduced conditions . direct comparison of expression levels during the flg <dig> time course from mutants and col- <dig> confirmed that there are no significant differences between wild type and mutants in flg <dig> responsiveness, though a few genes in ein2- <dig> showed a stronger response to flg <dig> .

exprss tag-seq was initially designed with illumina single end adapters that are compatible with single read flow cells of gaii and hiseq. we have modified exprss to be compatible with the illumina paired-end flow cell, so we can now sequence exprss tag-seq samples from both ends on a gaii, a hiseq, a hiseq <dig> and a miseq. the second sequence read from polyadenylation junction enables verification of polyadenylation site assignments of transcripts. we have performed paired end sequencing on cdna libraries made from temperature-shifted  samples of arabidopsis ecotype no- <dig> and slh <dig> leaves. we pooled eight libraries and sequencing was carried out on a miseq and resulted in  <dig>  million paired reads. as our primary focus was on the technical feasibility of the paired-end sequencing the biological relevance of this data is not further considered here. as anticipated, forward reads aligned at a defined position from the 3’ end depending on the sonication parameters . for the second read, an oligodt primer comprising the illumina p <dig> sequence was used as sequencing primer and 75% reads from 2nd sequencing read passed the quality filtering, compared to 95% from sequencing read  <dig>  this difference is probably due to the less complex sequencing primer used. nevertheless, for differential expression analysis read  <dig> data should be sufficient and read  <dig> data would assist primarily in polyadenylation position assignment. the resulting paired reads enabled us to define the position of polyadenylation from selected genes . these data support that paired read sequencing from exprss tag-seq can be used to define the polyadenylation location of expressed genes, in addition to relative gene expression information obtained from read  <dig> 

discussion
we have developed a restriction enzyme-independent tag-seq method for expression profiling  and we present evidence that it performs better than existing restriction enzyme- based  methods. the main drawback associated with sage-derived ngs expression profiling methods is restriction enzymatic bias. we overcame this bias using adaptive focussed acoustics from covaris to shear cdna and using a specific adapter, we could sequence cdna tags from a defined position in a transcript for expression profiling. additionally, use of sonication for fragmenting cdna allowed us to sequence tags from all expressed genes, unlike restriction enzyme based methods, which require the enzyme recognition site in the gene to get a sequence tag. afa shearing could be replaced with other available physical fragmentation techniques , as the prerequisite is to shear cdna to a desired size.

in principle, the exprss method has the following advantages over the enzyme-based and other existing tag-seq methods . exprss generates one tag per transcript at a relatively defined position from the 3′ end of a gene, ensuring no length-based data transformation and enabling straightforward statistical analysis. reverse transcription of only the 3′ ~300 bp of mrna is required to generate a tag. shearing using afa, followed by gel purification, allows us to generate unbiased cdna tags at a user-specified distance from the poly site for mapping to the transcriptome. dna shearing and dna ligation are more high-throughput than rna fragmentation and rna ligation. a comparative analysis of frequency distribution of lengths of tair <dig> genes  against that of genes detected  and differentially expressed in exprss tag-seq, revealed no preference for or against longer transcripts , unlike rna-seq  <cit> . however, transcripts less than 250 bp are slightly depleted in detection. however, 50% of the transcripts less than 250 bp in tari <dig> are pre-trna and other non-coding rnas, suggesting exprss may not lose information on protein coding genes. tag sequences are longer than existing tag-seq methods  thus increasing the accuracy of read mapping to reference; exprss tags are directional and can distinguish sense and antisense transcripts since the strand synthesized from mrna acts as template for sequencing, thereby providing the same strand information as that of mrna. smart cdna amplification might result in amplification biases and has been shown to have reduced strand specificity  <cit> , while exprss does not use amplification for cdna generation. if enough quantity of input is provided or enough samples are pooled, exprss samples do not require any amplification before loading on to the illumina flow cell, as they have adapters required to bind in the flow cell. handling losses are minimal, resulting in lower variability which is an essential factor for a high-throughput method. for example in arabidopsis,  for every ~200 bp 3′-most fragment of cdna there are  <dig> to  <dig> additional fragments resulting from shearing. these fragments act as carrier dna until the size selection step, thereby minimizing variation in handling. exprss can be carried out with minimal input of rna and addition of a carrier dna, at the end of the second strand cdna reaction, reduces any losses during subsequent steps. carrier dna would not result in tags, as they lack sequences for amplification in the flow cell. we have successfully employed lambda phage dna as carrier in our sample preparation without any interference. with these advantages, exprss tag-seq is an excellent method for expression profiling.

improvements in ngs techniques have resulted in improved and increased sequence yield, thereby providing an opportunity for multiplexed tag sequencing. how should one judge sufficient depth of sampling of the library? a simulated study based on pooled sage data  <cit>  indicated that a cell with a million mrna copies, requires three million sage tags to identify ~90% of expressed genes. according to zhu et al.,  <cit>  a million reads would sample ~85% of mrna tags expressing at 1– <dig> copies per cell. further evidence from recent studies  suggest that a rna-seq sample resulting in 20– <dig> million reads would identify ~80% of the genes.

how do tag-seq methods compare with whole transcriptome sequencing rna-seq methods? rna-seq is invaluable for annotation of a transcriptome and detection of splice variants and novel transcripts. however, rna-seq as a tool for differential expression analysis has its drawbacks. tag-seq methods generate one tag per transcript, mostly from a defined position, thereby avoiding transcript length biases and length-based data transformation for differential expression analysis. according to tair <dig> transcript data, the mean cdna length of arabidopsis is  <dig>  kb. thus, for every one fragment sequenced per transcript by exprss there would be 10 ~ 150 bp fragments from rna-seq, one could reasonably assume that  <dig> million reads from exprss are equivalent to ~ <dig> million reads of rna-seq data, without transcript length and reverse transcription biases. illumina single end sequencing on gaii provides about 35-40 m reads per lane, while a hiseq lane provides about ~100-150 m reads. this means sequencing of only  <dig> rna-seq samples per lane on gaii and 4– <dig> rna-seq samples on hiseq is required to provide sufficient depth for differential expression analysis. multiplexing is thus more valuable with tag-sequencing than rna-seq. tag-seq methods like exprss therefore provide an attractive option for expression profiling with superior dynamics and reliability at substantially reduced cost.

based on pilot experiments using four replicates each of arabidopsis  control and 60 minute flg22-treated leaf discs, we found that exprss captures tags resulting from annotated and novel transcription units and also poly transcripts from antisense strands. read alignments indicate that cdna is randomly sheared, as ~90% of tags are aligning around ~150 bp  from the 3′ end. exprss tag-seq is highly reproducible between biological replicates and was also superior to nlaiii-dge tag-seq libraries made from the same rna samples. exprss revealed expression of 26% more genes compared to nlaiii-dge in libraries made from the same rna samples . differential expression analysis performed on absolute tag counts facilitates interpretation of expression levels. analysis using exprss has identified more than 80% of the genes found by nlaiii-dge and ath <dig> microarray, though one could argue this is due to the higher numbers of genes found differentially expressed by exprss compared to nlaiii-dge and ath <dig> microarray. a comparative study of flg22-treated microarray data from three different developmental stages in arabidopsis has shown that exprss data had a better overlap with the three microarray data sets than the overlap observed between the three microarray data sets. two thirds of the upregulated genes from exprss  were also found differentially expressed in at least one of the three array experiments. this supports the view that exprss is sensitive enough to detect response-specific differential expression.

with respect to downregulated genes, exprss had good overlap with two of the three-microarray data sets; although the three-microarray data sets had poor overlap among themselves. the number of genes found downregulated, using the exprss tag-seq, was greater than those detected from other microarray experiments. therefore, one could argue this higher overlap might be due to the higher number of genes identified as downregulated with the exprss method. there appears to be a detection bias against identification of down-regulation with microarrays, explaining the poor overlap between the three microarray data sets tested. the down-regulated genes found in this study could have been previously undetected in microarray analysis. additionally, qpcr verification of selected genes from exprss data confirmed that differential expression identification is reliable. these results thus emphasize the advantages of exprss tag-seq sensitive detection and absence of hybridization related issues, unlike microarrays.

alternative splicing is another interesting phenomenon to detect during gene expression profiling. however, finding alternative splice-junctions is computationally intricate with a tag length of ~30 bp and requires higher depth of sequencing  <cit> . variable levels of expression of different alternative transcripts of a gene results in fluctuating tag densities for each variant. li et al.  <cit>  found that even at a tag density as high as ~ <dig> million rna-seq reads, only ~20% of verified alternative splice variants were discovered in the human transcriptome. due to such insufficient tag densities, quantitative differences among alternative polyadenylation and alternative transcripts are unreliable. however, with the possibility of longer tags  exprss tags could be used to find alternative splice junctions, provided they occur within the last ~300 bp from a polyadenylation site.

through exprss we identified cdna tags from regions of the genome without prior annotation. paired end exprss tag-seq could greatly improve annotation of 3′ regions and determine precise poly sites for these rare transcripts. with improvements in technology the length of sequencing reads continues to increase, so that longer cdna tags can be obtained. longer cdna tags not only enable us to match tags with higher confidence, but also to expression profile during host-pathogen interactions, and thus study gene expression patterns of both host and microbe. we are using such methods to address gene expression changes during arabidopsis interactions with white rust and downy mildew.

CONCLUSIONS
exprss is a restriction enzyme-independent tag-seq method and avoids biases of existing restriction enzyme- based  methods. in addition to identification of expression in annotated genes, exprss reveals alternative polyadenylation sites and antisense transcripts with a defined polyadenylation site. exprss also identified expression in regions of the genome without prior gene annotation. exprss tag-seq provides sensitive and reliable gene expression data and enables high-throughput expression profiling. sequencing technologies continue to improve and costs of sequencing continue to decline. however, as noted by sboner et al.,  <cit> , even though the cost of sequencing has reduced, the cost of experimentation hasn’t. it is therefore vital that not only sample preparation and sequencing costs are reduced, but the downstream analysis should also be relatively simple. the exprss method by all these criteria is highly suitable for cost-effective expression profiling of large numbers of mrna samples.

materials and methods
plant material and flg <dig> treatment
arabidopsis thaliana  plants were grown under short-day conditions . no- <dig> and slh <dig> plants were grown in short day conditions  for 4 weeks at 28°c after germination on ms plate. leaf discs from 5-week-old col- <dig>  npr1- <dig>  jar1- <dig> and ein2- <dig> plants were prepared 2 hours after start of light period and vacuum-infiltrated with water for 1 min. leaf discs were placed in water in 50 mm petri dishes and left in the same growing conditions for ~20 h. a day after leaf disc generation the water in the petri dishes was replaced with water or  <dig> nm flg <dig> and samples were harvested 1 h after incubation. for flg <dig> time course experiment samples were harvested after 8 minutes incubation in water and  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> & 180 minutes incubation in  <dig> nm flg <dig>  four weeks old no- <dig> and slh <dig> plants grown at 28°c were transferred to 21 °c growth chamber at the beginning of the light cycle and samples were harvested at 0 h, 6 h, 9 h and 24 h after transfer.

rna preparation
total rna was extracted using the tri reagent  and 1-bromo-3-chloropropane , as per manufacturer’s guidelines. rna was precipitated with half volume of isopropanol and half volume of high salt precipitation buffer . rna samples were treated with dnasei  according to the manufacturer’s recommendation and phenol/chloroform extracted and ethanol precipitated.

q-rt-pcr
for quantitative reverse transcription pcr, rna samples were reverse-transcribed into complementary dna  using superscriptii reverse transcriptase . the cdna was used to quantify gene expression using a sybr green quantitative pcr kit  and gene-specific primers . themocycling and intensity detection was carried out with chromo <dig> system on mj research thermal cycler and data extracted using opticon monitor software.

tag-seq library preparation and sequencing
exprss
typically 5 μg of total rna was used to generate first strand cdna using a oligo  primer comprising p <dig> sequence of ilumina flow cell. double strand cdna is synthesized as described previously  <cit> . purified cdna is subjected to covaris shearing . end repairing and a-tailing of sheared cdna is carried out as described by illumina. y-shaped adapters are ligated to a-tailed dna and subjected to size selection on 1x tae agarose gel. the gel-extracted library is pcr enriched and quantified using qpcr with previously sequenced similar size range illumina library.

nlaiii-dge
library preparation was carried out with 5 μg of total rna as mentioned previously  <cit> . in our modified protocol, ligation of biotinylated adapter <dig>  harbouring methylated adenine, was carried out in the presence of nlaiii and t <dig> dna ligase at 37°c as described previously  <cit> . after adapter <dig>  ligation, streptavidin magnetic beads  were used to capture ligated constructs and which were taken forward for pcr enrichment as in the default protocol. detailed protocols for exprss and nlaiii-dge are provided in additional file  <dig>  both exprss and nlaiii-dge libraries are sequenced on illumina genome analyzer ii.

bioinformatics analysis and data processing
illumina sequence library is quality filtered using fastx toolkit  <dig> . <dig> with parameters -q <dig> and -p <dig>  <cit>  and reads containing “n” are discarded and read qualities are converted from illumina fastq to sanger fastq format. exprss libraries are separated using perfect match to the barcode. for nlaiii-dge, fastx toolkit fastx_clipper is used to trim 3′ adapter sequence  and libraries are separated using barcodes allowing up to  <dig> mismatch. each sub-library is quality filtered  and artefact filtered using fastx-toolkit. for nlaiii-dge libraries nlaiii recognition site  was added at 5′ end of each tag sequence and “ffff” as fastq quality. quality filtered library was aligned to the arabidopsis thaliana col- <dig> genome sequences   <cit>  using bowtie version  <dig> . <dig>   <cit>  and selected reads with up to  <dig> reportable alignments. unaligned reads from previous step are used to align to transcript sequences of arabidopsis  <cit>  using bowtie version  <dig> . <dig> .

tag to gene association is carried out using following considerations. reads aligning in sense orientation with in each gene limits are assigned to that gene. a read aligning to all splice variant of a gene is counted once, and the reads uniquely aligning to various splice variants of a gene are pooled. reads aligning to genes with overlapping gene limits are split equally between them. reads aligning to more than  <dig> genes are discarded. reads aligning to up to  <dig> genes are split equally between them. reads aligning on the anti-sense strand of any gene are tested for if the read falls within 500 bp from 3′ end of another gene in sense direction. otherwise reads are assigned as antisense tags for the specific gene . the tag assignment process was implemented in perl and scripts are available on request. our analysis pipeline modules for implementation in galaxy web-based research platform are provided in additional file  <dig> 

differential expression analysis was performed using the r statistical language version  <dig> . <dig>  <cit>  with the bioconductor  <cit>  package bayseq version  <dig> . <dig>  <cit>  using  <dig> iterations to estimate empirical distribution on the parameters of the negative binomial distribution. the multi-experiment viewer software from the tigr website  <cit>  was used to cluster similarly expressed genes using hierarchical clustering  <cit> .

eight samples were pooled and sequenced at  <dig> bp paired end reads in a miseq from each end of the exprss library. the insert size of the library was > =  <dig> bp and also to be comparable with other runs of this manuscript sequence reads were truncated to  <dig> bp and quality filtered and used for downstream analysis. paired end reads were aligned to arabidopsis genome sequence  using burrows-wheeler aligner  <cit>  sampe with default parameters. generated sequence alignment/map  format files are converted to sorted bam files and indexed using samtools  <cit> . sorted bam files with index are loaded on to integrative genomics viewer  v <dig> . <dig>  <cit>  for visualization of paired reads.

microarray data analysis
microarray data cel files from flg <dig> treatment on the seedlings   <cit> , mature leaves   <cit>  and leaf discs generated from mature leaves   <cit>  were used. data analysis was performed using the r statistical language with the bioconductor packages limma  <cit>  and affy  <cit> . robust multiarray average background-corrected, quantile normalized, and log-transformed perfect match only expression values were obtained using medianpolish summary method  <cit> . differentially expressed genes were identified using the rank products method with a false discovery rate of < <dig>   <cit> .

availability of supporting data
the sequence data discussed in this publication have been deposited in ncbi’s gene expression omnibus  <cit>  and are accessible through geo series accession number gse <dig> 

electronic supplementary material
additional file 1: supplemental figures.
figure s <dig>  modified nlaiii-dge tag-seq protocol. figure s <dig>  transcription at rrna loci observed with exprss and nlaiii-dge tag sequencing. figure s <dig>  correlation between sense and anti-sense transcript expression. figure s <dig>  novel transcription detection using exprss tag-seq. figure s <dig>  cumulative frequency distribution multi-matching reads. figure s <dig>  pair-wise scatter plots of gene counts from flg <dig> treated replicates. figure s <dig>  pair-wise correlation of fold changes between three methods tested. figure s <dig>  pair-wise scatter plots of gene counts from 60 minutes flg <dig> treatment replicates from two independent experiments. figure s <dig>  pair-wise scatter plots of gene counts from col- <dig> flg <dig> time course replicates. figure s <dig>  pair-wise scatter plots of gene counts from npr1- <dig> flg <dig> time course replicates. figure s <dig>  pair-wise scatter plots of gene counts from jar1- <dig> flg <dig> time course replicates. figure s <dig>  pair-wise scatter plots of gene counts from ein2- <dig> flg <dig> time course replicates. figure s <dig>  hierarchical clustering of genes differentially expressed during flg <dig> time course of four genotypes. figure s <dig>  heat maps of log <dig> fold changes from all data points of genes that are differentially expressed at least from one time point of flg <dig> time course. figure s <dig>  hierarchical clustering of genes differentially expressed during flg <dig> time course of four genotypes compared to col- <dig>  figure s <dig>  frequency distribution of read <dig> and read <dig> from paired end sequencing. figure s <dig>  examples showing read <dig> and read <dig> from paired end sequencing. figure s <dig>  length distribution of genes detected in exprss. figure s <dig>  cartoon depicting tag assignment to genes. 

 additional file 2: detailed protocols of exprss and nlaiii-dge and information of primers used. 

 additional file 3: zip archive of the analysis tools designed to import in to galaxy web tool. 

 additional file 4: details of genes differentially expressed in exprss tag-seq. 

 additional file 5: details of genes differentially expressed in nlaiii-dge tag-seq. 

 additional file 6: details of genes differentially expressed in ath <dig> array flg <dig> treatment of leaf discs. 

 additional file 7: details from exprss tag-seq, for genes used for qpcr verification. 

 additional file 8: details of genes differentially expressed in ath <dig> array  but not in exprss tag-seq. 

 additional file 9: details of genes differentially expressed in ath <dig> array flg <dig> treatment of leaf. 

 additional file 10: details of genes differentially expressed in ath <dig> array flg <dig> treatment of seedlings. 

 additional file 11: overlap among three flg <dig> ath <dig> array differential expression represented as pair-wise comparison. 

 additional file 12: locus details, log  <dig> fold change values and fdr of differentially expressed genes at 60 minutes of flg <dig> treatment from two independent experiments. 

 additional file 13: details of genes and log  <dig> fold change values of differentially expressed during flg <dig> time course in col- <dig> 
npr1- <dig> 
jar1-1
and
ein2- <dig>  

 abbreviations
afaadaptive focussed acoustics

sageserial analysis of gene expression

dgedigital gene expression

estexpressed sequence tag

rna-seqwhole transcriptome sequencing

tag-seqcdna tag sequencing

tpmtags per million

fdrfalse-discovery rate

dedifferential expression.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

conceived and designed the experiments: gr, emk, ars, khs, jdgj. performed the experiments: gr, cs. analyzed the data: gr, dm. analysis tools: gr, dm, ge. wrote the paper: gr, jdgj. prepared data for submission to databases and did the submission: gr. all authors read and approved the final manuscript.

