BACKGROUND
identifying the combinatorial logic of transcriptional regulation is key for understanding the mechanisms of development, cell commitment and differentiation and the way in which external and internal signals are converted into specific patterns of gene expression. transcriptional regulation is accomplished by the coordinated activity of specific regulatory proteins that recognize and bind regulatory elements – short dna motifs located in the untranscribed regions of the genes  <cit> . regulatory elements such as tfbss, enhancers, and silencers, are commonly located in the promoter region of genes, while others, such as splicing control elements, may be located within the introns or exons of a gene. as more sequence and expression data have become available, the task of understanding gene regulation has come to rely on a combination of experimental and computational approaches. among the many bioinformatics approaches aimed at understanding the role of regulatory elements in transcriptional control, several research themes have emerged  <cit> . they include search algorithms that extract putative regulatory elements  <cit> , search engines for their retrieval  <cit>  and databases of experimentally characterized or computationally derived regulatory elements  <cit> . moreover, combinations of regulatory elements that occur in close proximity to each other form cis-regulatory modules that control gene expression. their presence suggests the existence of a combinatorial code for transcriptional regulation  <cit> , with ample effort being devoted to developing algorithms for its elucidation  <cit> .

in sequences of orthologous genes, regulatory elements that have a functional role are often conserved throughout evolution by selective pressure. this led to the development of many algorithms that use 'phylogenetic footprinting' – a method for inferring regulatory elements based upon sequence conservation of orthologous genes  <cit> . however, recent evidence  <cit>  shows that functional elements are not necessarily located in conserved regions; this requires the development of computational methods to detect binding sites with high specificity without relying primarily on sequence conservation data.

one of the most common strategies for identifying putative tfbss in dna sequences relies on matching a general pattern abstracted from sequences of experimentally characterized binding sites and expressed in the form of a probability weight matrix that describes the probability distribution of the four possible nucleotides at each location  <cit> . several programs, such as patch, match, matinspector and tess, rely on the nucleotide weight matrices  of transfac – a large and frequently updated database that contains information on the transcription factors  and their binding sites in target genes  <cit> . the assumption underlying the construction and use of nwms is that each nucleotide contributes independently to the binding site consensus and that the contribution of the nucleotides to the site is additive  <cit> . this assumption was tested experimentally in the case of binding sites for two transcription factors – the mnt repressor protein and the mouse egr <dig> protein. nucleotides at positions  <dig> and  <dig> in the mnt repressor protein binding site  <cit>  and the central nucleotide triplet in the mouse egr <dig> binding site  <cit>  were systematically mutated to all possible combinations and the binding affinity of the respective tfs  for these sites was determined. the results pointed out that the assumption of independence of nucleotides within a site is not entirely accurate, but that although nwms do not capture the dependencies between nucleotides within a site they represent a good enough approximation for modeling it <cit> . nevertheless, it is generally recognized that using nwms to identify putative tfbss often leads to the retrieval a very high number of false positives  <cit> .

in this work, we rely instead on hidden markov models  as a more accurate probabilistic method to model the sequence of nucleotides within a binding site that in addition to abstracting the probability distribution of the nucleotides at each site can also model insertion or deletions and retrieve fragment matches to the model in the search procedure  <cit> . hmms are statistical models able to represent stochastic sequences of symbols and can be used to generate sequences that conform to a given model, or to determine the likelihood that a given sequence was generated by that model. hmm techniques have become the basis of many bioinformatics applications for recognizing conserved domains in amino acid sequences or gene features in dna sequences  <cit> . several publicly available implementations such as hmmer  <cit> , sam  <cit>  and meta-meme  <cit>  build hmms based on multiple sequence alignments and, among other functions, search input sequences for matching domains. the hmmer package was used to generate the large collection of annotated protein domains of the pfam database  <cit>  and consists of several modules for which the source code is available, well commented and easily modifiable. hmms were previously considered for modeling and searching for tfbss. the reports so far were either theoretical in nature  <cit> , where not extended to genome-wide searches  <cit> , or focused only on a small number of transcription factors  <cit> . a hmm for creb binding sites was used to scan upstream sequences of  <dig> kb in length from the human and mouse genomes  <cit> , while a markov model for the hepatocyte nuclear factor  <dig>  was used to scan sequences between positions - <dig> to + <dig> relative to the transcription start site of confirmed genes in the human genome  <cit> . recently, a method for identifying nuclear hormone receptor bindings site was developed based on the use of classification hmms  <cit> . however, to date no study used hmms of multiple tfbss in a large-scale search across three or more genomes.

the work described in this paper focuses on developing methods to generate accurate and complete information on putative tfbss in genes across multiple genomes . our methodology relies on combining the information on experimentally determined binding sites contained in curated databases such as transfac and jaspar with the pattern matching power of hmms. as transfac and jaspar provide manually curated representative nucleotide sequences of binding sites for most tfs included in the databases, we leveraged this information to recreate the alignments used to calculate the nwms, and we used them as input to hmmer instead. we thus generated a library of  <dig>  hmm profiles containing one model for each transfac matrix or factor entry  or jaspar matrix for which alignments of binding sites were available. the performance of selected models was evaluated by their ability to retrieve experimentally characterized binding sites, and the sensitivity and specificity of the method were assessed in a large-scale comparison with a nwm-based method using synthetic data. a flexible interface was implemented  that allows the user to search a sequence in fasta format or a gene and its orthologs across five genomes against the library of  <dig>  hmm models or against a model built by the user starting with a multiple sequence alignment of binding sites. although the tools developed for this work were used to find putative tfbss, they are directly applicable for identifying other types of regulatory elements for which sequence alignments are available.

RESULTS
the mapper hmm library
hmms were built using multiple sequence alignments of binding sites compiled from the transfac  <cit>  and jaspar  <cit>  databases. transfac provides two sources of information regarding the binding sites for tfs: nucleotide sequences of binding sites referenced in the description of the transfac matrices that were optimally aligned and used to derive nwms , and nucleotide sequences of binding sites referenced as part of the description of the tfs – also referred to as "factors", used to extract alignments designated below as factor-derived alignments and catalogued with accession numbers starting with "t". by parsing the transfac flat files  we obtained  <dig> alignments corresponding to matrices and  <dig> alignments corresponding to factor entries. in addition,  <dig> alignments were obtained from data downloaded from the jaspar database. thus, the total number of alignments used to build hmms was equal to  <dig> . figure 1a shows the distribution of the length of the models and of the number of sequences and size of the nucleotide matrix used to train them. the models have an average length of  <dig> nucleotides and were trained on an average of  <dig> sequences. transfac assigns a quality value to the sites used to build the factor-derived models, based on the existing biological evidence of the binding . the distribution of the median and average quality of the sites used for the factor-derived models suggests that the large majority contains high quality sites .

the  <dig>  models retrieved correspond to  <dig> transcription factors entries with distinct names in transfac and jaspar. table  <dig> in additional file  <dig> lists the names of all tf entries in the two databases for which hmms were built and the models that describe them. it is important to note that different databases  often use different names for the same tf or for isoforms of the same tf ; nevertheless, for the purpose of this paper, entries with different names were considered as distinct.

while the matrix-derived models are generated by combining binding sites for homologous factors from multiple organisms, every factor-derived model and jaspar model is derived from sites from a single organism. our search engine does not place restrictions on the use of a model associated with a tf from one organism when searching a sequence from a different organism. the rationale for this is that ortholog tfs from different organisms usually show very high structural and functional conservation that extends to their binding site specificities. this allows the user to use all available models for a given tf when searching, and to evaluate a posteriori whether the resulting hits are significant.

evaluation of the method
evaluating the sensitivity and specificity or our method compared to other commonly used ones is not straightforward, for a variety of reasons. first, in order to measure the false positive and false negative rates we would need to be able to reliably classify occurrences of the motif  into "true" and "false" positive categories. this is obviously impossible by computational means, and too expensive and time consuming to pursue experimentally for a large number of transcription factors and binding sites. on the other hand, the experimental data sets that make available genome-wide positions of "true" hits pertain to a limited number of factors of interest and usually report a region for which binding was detected and not the precise locations and sequences of the binding sites  <cit> . for a limited number of well-characterized factors, collections of binding sites were compiled from the literature  but the total number of such sites is still too small to enable a statistically significant comparison. as such sites usually come from promoter regions that are rich in regulatory sites, we were forced to use short flanking sequences to avoid including extraneous additional sites. the results of testing a method on such short sequences are not entirely predictive of its performance when long genomic regions are used as input, as in most experiments. moreover, for all these datasets and even for other ones that contain binding data for multiple factors  <cit> , no information is available about "false" hits . although it is clear that only a large-scale biological validation of the predictions of this method can provide a definite estimation of its performance, such goal is beyond the scope of this paper.

given these constraints, we performed three types of evaluations of our method. first, for three different factors we performed control runs to determine if our method is able to correctly identify a total of  <dig> experimentally characterized binding sites in  <dig> different genes with the exact sequence and at the positions reported in the literature. secondly, for a collection of  <dig> experimentally characterized sites for six other transcription factors, we determined the number of sites retrieved and the percentage of false positives reported by our method and compared them with the results of four other methods: match  <cit> , patser  <cit> , lmm  <cit>  and scanace  <cit> . finally, we conducted a large-scale evaluation based on synthetic data for  <dig> models in our database in order to compare, using modified roc curves, the sensitivity and specificity of our method with the ones of a nwm-based method .

control runs
to obtain a preliminary evaluation of the performance of our method in detecting tfbss we used control sequences consisting of promoter regions of genes in which binding sites for specific factors were determined experimentally and were shown to play a role in the regulation of the gene. we selected as controls hmm models for three transcription factors – p <dig>  su and mef- <dig> and used them to scan control sequences chosen so that they contain experimentally determined tfbss for the factors whose nucleotide sequence were not included in the multiple sequence alignments used to train the models.

a hmm corresponding to p <dig> was built based on the alignment for matrix m <dig> of transfac, and was used to scan promoter regions from the following genes: the human 14-3- <dig> sigma protein gene for which two p <dig> binding sites, bds- <dig> and bds- <dig>  were characterized  <cit> , the mouse cycling <dig> gene that contains one p <dig> binding site  <cit> , and the mouse b99/gtse <dig> gene, encoding the g two s phase expressed protein  <dig> for which a p53-responsive element containing three p <dig> half-sites was reported  <cit> . with the exception of one half-site in the latter sequence, hmmer retrieved all the described p <dig> binding sites at the positions indicated in the literature, with significant scores and e-values . model m <dig> for the drosophila su  was used to scan the following sequences: the promoter of drosophila him  <cit>  containing four su binding sites that were identified computationally and confirmed experimentally, the sequence of an enhancer containing three su sites located  <dig>  kb upstream of the first exon in drosophila yan  <cit>  and the promoter sequence of the human erbb- <dig> gene containing one su binding site  <cit> . while the sites in drosophila him where identified with positive scores, the binding sites in the last two sequences were reported with negative scores, pointing out that, as mentioned in the hmmer documentation  <cit> , real matches can in some cases have negative scores  sites in the drosophila yan enhancer was missed). model t <dig> corresponding to human mef- <dig>  was used to search the promoter sequences from the following genes, each containing one well characterized mef- <dig> site: drosophila actin57b gene  <cit> , mouse mef2c gene  <cit>  and human c-jun  <cit> . the characterized mef- <dig> binding sites in these sequences were also retrieved by hmmer . in total our method identified correctly  <dig> out of the total  <dig> binding sites .

small-scale evaluation
the purpose of this evaluation was to measure the performance of our method compared to other widely used tools for the computational detection of tfbss, using a high-quality dataset of experimentally validated binding sites. the criteria we used to compare the tfbs detection methods in our experiment are the following: first, we required a method to be able to detect all the experimentally validated sites  in the input sequences, except for one at most. next, we counted the number of hits not corresponding to true sites  having a score greater then the lowest-scoring true positive, and we expressed it as a percentage of the sum of the number of true positives and false positives. according to this definition, the false positives represent those hits that cannot be separated from the true ones on the basis of their score, since raising the score threshold to exclude them would cause the method to miss some true positives.

the dataset used for this evaluation contained  <dig> experimentally characterized binding sites for six factors: e2f, the estrogen receptor , the glucocorticoid receptor  and the hepatocyte nuclear factors  <dig>   <dig> and  <dig>  previously compiled from the literature  <cit> . for each factor the dataset contained a  <dig> bp long sequence extracted from a given gene in which the binding site was always located in the same positions throughout the dataset . the length of the sites was  <dig> for hnf- <dig>   <dig> for e2f,  <dig> for er and hnf- <dig>   <dig> for gr, and  <dig> for hnf- <dig>  adopting this consistent format for the datasets allowed us to define a true positive as a hit that overlaps at least 60% of the sequence of the site and a false positive as any other hit retrieved in the sequence. hits retrieved on both strands that overlapped more than 75% were considered equivalent and only the best scoring one was reported.

we included in this evaluation four other methods for tfbs detection: match  <cit>  and patser  <cit>  that scan a sequence using a supplied nwm, lmm   <cit>  that uses a p-value-based scoring measuring the similarity of the hit to the known binding sites for the factor and its contrast to the local genomic context, and scanace  <cit>  that scans a sequence for matches for a given motif using a scoring method based on a maximum a priori log likelihood score. in order to conduct a fair evaluation for each factor we used as input either the hmm  or the corresponding nwm  that were built on the same alignment. this alignment was also used directly as input for scanace. for three factors  the matrix used in the analysis was not found in the lmm matrix library, therefore we used the closest matrix available as judged by examining its consensus sequence. to preserve this correspondence we were in some cases forced to use a sub-optimal model in the hmmer run; in these cases we also included an alternative hmm model in the analysis . we also filtered the collection of binding sites in order to eliminate the ones that appear in the training set , resulting in a dataset that contained a total of  <dig> sites. information regarding the binding sites in the alternative matrices used for lmm is not available in transfac, so it is possible that in these cases the alternative matrix used overfits the dataset.

the results of the small-scale evaluation are presented in table  <dig>  the complete listing of the hits found  as well as the consensus of the models and matrices used is provided in the additional file  <dig>  table  <dig> summarizes the results: for each method tested we report the overall percentage of true positives identified, and the lowest and highest percentage of false positives in each of the six datasets. in several cases, two of the methods tested  did not reach a sufficient number of true positives, so their performance is not directly comparable to the one of the other methods. their performance in terms of false-positive hits suggests that they are too specific, and therefore prone to missing true sites. the other two programs that we tested against, match and patser, show a minimum false-positive percentage of 12% and 3% respectively. in contrast, hmmer reaches a minimum value of  <dig> false-positive hits, while detecting all  true sites in all cases. the highest percentage of false positive hits ranges from  <dig> % for hmmer  to  <dig> % for patser. while on individual models other methods might perform better in particular cases, these results indicate that hmmer is powerful enough to detect the target binding sites in all the datasets tested, and that its sensitivity-specificity trade-off is consistently better than those of the other methods.

large-scale evaluation
to add to the rigor of this analysis and perform it in a context closer to a real-life biological investigation, we resorted to a computational evaluation based on synthetic data generated similarly to the technique described by barash et al.  <cit> . this allowed us to compare the proportion of false positive hits returned by our method and by a tfbs prediction program based on nwms, in this case match  <cit> . we applied the following procedure to the  <dig> hmms in our database  for which a corresponding nwm built using the same multiple sequence alignment was available: we generated a random nucleotide sequence of a fixed length  and we inserted in it, at random locations,  <dig> "synthetic" binding sites. these binding sites were not generated by sampling from the matrix nor from the hmm as that could have conferred an advantage to one of the two methods. instead the sites were generated by sampling from the alignment with an algorithm designed to make the test as fair as possible for both methods by preserving both the dependencies between nucleotides in the sequences and the core matrix if it exists . before each hit was planted the random sequence was scanned to eliminate any other occurrence of its sequence that might have been present by chance. we defined our planted hits as the "true positives", while any other reported instance of the pattern was considered a "false positive". we then scanned the resulting nucleotide sequence with the match program and with hmmer, we repeated the experiment  <dig> times for each model independently and we averaged the results to eliminate fluctuations due to randomization.

we measured the performance of the two methods using modified roc curves – roc <dig> curves  <cit>  and compared the areas obtained with both methods by using a bonferroni-corrected wilcoxon signed rank test. out of the original  <dig> models tested  <dig> were eliminated due to the fact that the average roc <dig> area for either method was smaller than  <dig> , leaving  <dig> filtered models on which the comparison was conducted. at a significance level of  <dig>  and with a bonferroni correction of  <dig>  our method performed better than match for 96% of the models for which the result was significant , suggesting that it can provide a better trade-off between sensitivity and specificity that translates into being able to retrieve more true positives with fewer false positives. the results of this test are presented in table  <dig> of additional file  <dig>  it should be noted that in many cases the length of the matrix used by match differs from the length of the hmm even though the same alignments were used to construct both. this situation confers an advantage to match because the planted hits have the same length as the alignment.

we then analyzed the results of these runs to determine, for each method and model, the percentage of true positive hits within the first n reported hits , and the amount of false positives expressed as a percentage that needs to be accepted in order to retrieve the first m true positive hits ; these tests are referred below to as the first and second tpp  tests. the values used for n and m were  <dig>   <dig>   <dig> and  <dig>  tables  <dig> and  <dig> of additional file  <dig> show these results for all  <dig> filtered models tested. while the roc tests give an indication of the overall performance of the method, the tpp tests assess its performance in the "early" and "late" stages of the search, respectively. by the stringent criteria used for comparison  in the first tpp test our method performs better for 78% of the cases for which a difference was noted suggesting that these models are better suited for retrieving a relatively small number of hits that are true positives  while reporting a minimal number of false positives. in the second tpp test our method performs better for 85% of the cases in which a di fference in performance between the two methods was noticed, suggesting that these models can retrieve a large number of hits while limiting the number of false positives, as for example in the case of a genome-wide search for putative tfbss for a given factor. it should be noted that since each of the three tests measures a different aspect of the performance of the method, the list of models that perform better in each case might not entirely overlap.

the mapper interface
we designed and implemented a web-based application, called mapper , to facilitate the retrieval of putative tfbss in a given sequence based on the library of  <dig>  hmm models described above. the interface takes as input a gene identifier  or a user supplied sequence in fasta format. the user then selects the models to be used  and has the option to build his/her own model starting with a multiple sequence alignment of binding sites in fasta format. the search can be performed on the entire gene region flanked by a user-specified distance upstream and downstream, on a specified gene region  or within a certain distance upstream of the atg or the start of the transcript . if a gene identifier is provided the program will also display the actual nucleotide sequence scanned , a useful option in the case of those genes for which discrepancies exist between different annotations.

the user can choose to display all hits for a given sequence, or only the hits for factors that are common across the orthologs of that sequence . the output of the system is the list of putative hits found in the specified conditions – default score and e-value thresholds are  <dig> and  <dig> respectively . for each hit the system displays the model used to retrieve it, its location, score and e-value and  the alignment between the model and the sequence at that site. the hit set can be sorted by position , by model name, model accession, score or e-value. in addition the results page highlights adjacent sites  retrieved for tfs that are known to physically interact with each other , and also the classes of tfs for which putative sites were found. for each transfac factor-derived or jaspar-derived model the organism in which the factor was described is specified. the user can choose to highlight hits in evolutionarily conserved regions representing the most conserved elements between sets of organisms provided by the ucsc genome browser annotations . figure 4a shows a graphical representation of the position and orientation of the hits listed in figure  <dig>  arrows are drawn to scale and in some cases represent the sum of overlapping sites for the different transcription factors that are listed above or beneath them. hits occurring in evolutionarily conserved regions are displayed in red. while the results page in figure  <dig> lists and sorts all putative tfbss independently from each other, the graphical representation in figure 4a makes it easy to identify regions in which more than one model  detects a binding site making it, therefore, more likely to represent a true binding site. the set of hits can also be exported and displayed in the ucsc genome browser using its "custom tracks" feature . this allows the user to view the tfbss in the general context of the genomic region in which they appear and to take advantage of the powerful visualization tools of the ucsc genome browser in order to highlight important features of the genomic region.

figures  <dig> and  <dig> present the output of mapper when the human mcm <dig> gene  is used as an example. the promoter of the human mcm <dig> gene contains multiple experimentally characterized binding sites for the e2f transcription factor. these binding sites were retrieved by our search, and were found to be conserved across the human, mouse and drosophila mcm <dig> orthologs. mcm <dig> genes code for proteins involved in the initiation of dna replication  <cit> , and are members of the mcm family of chromatin-binding proteins that participate in cell cycle regulation. the e2f family of transcription factors plays a critical role in the control of cell proliferation and consists of six factors, e2f- <dig> to e2f- <dig>  that heterodimerize with two other subunits, dp- <dig> and dp-2; the activity of these complexes is modulated by the retinoblastoma tumor suppressor protein  that binds e2f  <cit> . transfac and our database contain multiple models describing the binding sites in target genes characterized for different combinations of e2f and dp proteins, complexed or not with prb. below, we refer to these models generically as "e2f" models given the fact that, while the transcriptional role of e2f family members is different given the identity of the e2f and dp moieties that forms the complex  <cit> , no specificity has been detected in vivo for the association of particular complexes to known e2f-regulated promoters  <cit> . experimental evidence showed that the upregulation of the human mcm <dig> gene in response to growth stimulation is mediated by the binding of e2f to four sites within the mcm <dig> promoter, and that mutations in these sites abolish this response  <cit> . the four e2f binding sites consist of two sets of overlapping sequences running on opposite strands and were mapped by rnase protection assays to positions - <dig> to - <dig> and + <dig> to + <dig> respectively, relative to the start of the transcript  <cit> . in our search, three models for the e2f family  retrieved all four e2f sites at the location and in orientation described in the literature . to simplify the display in these figures and to highlight the four e2f binding sites retrieved by the three models, a more stringent set of parameters was used for the query . figure  <dig> shows the list of all tfbss retrieved given these input parameters with the four e2f binding sites described by ohtani et al. boxed, as well as the list of factors for which putative binding sites where found also in the other two mcm <dig> homologs selected . for each hit in the listing the model identifier is displayed as a double link, to a pop-up window showing the match between the sequence and the model  and to a separate page giving detailed information regarding the model including its length, the number of sequences in the training set, associated models, hmm logo  <cit> , and the references used to build the alignment .

discussion
our method offers several advantages over other similar tools, with respect to the extent and quality of the models it uses, its sensitivity and specificity, and the overall functionality of the web-based interface.

mapper includes a large database of profile hmms corresponding to  <dig> tf entries that was built using the data provided by the transfac and jaspar databases, consisting of sets of experimentally validated binding sites for several hundred tfs. in addition to the models based on optimal alignments provided by transfac and jaspar, our database includes a large number of additional models generated by extracting the representative motif from the "raw" binding site sequences contained in transfac with the program meme   <cit>  that usually provide a tighter definition of the binding site specificity. as a result our method can make use of a larger number of models that provides an increased ability to detect putative binding sites. in many cases, several models are available for a single tf; in addition to increasing the probability of detecting a binding site for the factor, this redundancy also allows the user to evaluate whether a putative site is a "true" one  or a potential false positive. although the plan <dig> architecture on which hmmer is built does not take into account the dependencies between the nucleotides within a site and, similarly to nwms, weights each state independently  <cit> , several features of the hmmer modeling and search procedure confer an added level of generality to hmms as compared to nwms built upon the same alignments. first, profile hmms model insertions, deletions and allow fragment matches to the model  <cit> . this property becomes significant in the case of those tfs that bind to sites comprised of half sites separated by spacer regions of variable length ; while insertion and deletions are rare in the functional half sites they can occur with higher frequency in the spacer regions that are much more divergent  <cit> . moreover, allowing fragment matches to the model ensures that binding sites that may contain a well defined half-site and an imperfect one or half-sites separated by long spacers can still be retrieved as fragment matches to the model. secondly, all hits returned by hmmer are subject to a bias composition filtering based on a second null model that is computed for each alignment and leads to a rescoring of the hits penalizing the ones for which the nucleotide composition is biased  <cit> . even in equal performance conditions, as could be the case for short alignments that do not allow insertions or deletions or fragment matches to the model, this filtering alone would still confer an advantage to using hmmer versus nwms.

using profile hmm for modeling bindings sites has also limitations. to build a model hmmer converts the observed counts in the training set into probabilities by combining the actual counts with pseudocounts from priors, in this case single-component dirichlet priors  <cit> . the latter can have a more pronounced effect and can bias the model in the case in which the number of sequences in the training set is low. these cases would be difficult to model accurately by any statistical approach  and their suitability for the desired analysis will have to be evaluated case by case by the user. to facilitate this, we report for each model the length, the number of sequences in the training set, the hmm consensus , the hmm logo  <cit> , the other associated mapper models, and the references used to curate the binding sites used in the training set. the presence of models trained on small number of sequences usually does not represent a problem, as in the large majority of cases mapper makes available multiple models for any given tf.

we compared the predictive performance of our method with that of several other similar computational tools, by testing them on a dataset of over  <dig> experimentally determined binding sites as well as on synthetic data. the factors for which experimentally characterized sites were tested were selected so that they bind sites with different overall organization and belong to different categories of tfs such as fork head tfs , mads box , helix-turn-helix/homeo domain , cys <dig> zn finger of nuclear receptor type , beta-scaffold factors with minor groove contacts , and ipt/tig domain ). as presented in the results section our method correctly identified  <dig> out of  <dig> binding sites reported in the literature for p <dig>  su and mef- <dig>  moreover, from a collection of  <dig> binding sites for six other tfs  our method identified 98% to 100% of the true positives with false positive ratios ranging from 0% to 16% . the other methods tested  either retrieved a comparable number of true positives at the expense of higher false positive ratios  or attained lower false positive ratios at the expense of missing a high number of true positives .

although encouraging, the results of this evaluation cannot be easily extrapolated to a scenario in which very long sequences  are scanned with hundreds of models. in order to make our analysis more general, we performed a large-scale evaluation using synthetic data for  <dig> models in our database  for which a hmm and a nwm was available and compared the performance of our method with the one of match in scanning sequences of  <dig> kb in length. models that performed very poorly for one method or the other or both were filtered out and among the remaining  <dig> models 74% showed a statistically significant difference based on a bonferroni corrected wilcoxon signed rank test. among the latter our method performed better in 96% of the cases.

however, we recognize that the entire enterprise of tf binding site annotation is burdened by the challenge of a robust definition of what constitutes a true positive, even those based on binding studies. for example, tronche  <cit> and others note the evolutionary conservation of binding sites for genes transcribed in tissues that do not even express the transcription factor. in these instances as in others, computational or even biochemical binding assays are only a first step on the path to focused functional studies.

finally, the mapper interface offers several advantages over other similar tools. it accepts as input a user-supplied fastaa sequence or a gene identifier for any annotated gene in the human, mouse, fly, worm or yeast genomes. it can use in the search all or each of the different categories of models in our database  or a model built on a multiple-sequence alignment supplied by the user. the results are presented in a simple yet comprehensive manner providing detailed information regarding the gene, the sequence scanned and the putative sites retrieved, and powerful graphical and export options facilitate the analysis and the interpretation of the results.

CONCLUSIONS
the purpose of our work was to establish a methodology for the detection of tfbss in multiple genomes endowed with enough sensitivity and specificity to be effective in large-scale analysis . accomplishing this requires a large library of high-quality tfbs models and a computational method able to reliably detect instances of the models in a given dna sequence.

the model library used by our program was created from the data contained in the transfac and jaspar databases, with a procedure that generated over a thousand high-quality models. the computational method we implemented relies on hmm profiles built from nucleotide sequence alignments. using hmm profiles instead of nwms is a powerful way for capturing the characteristics of a binding site and several observations suggest that our method is reliable and performs well. first, hmm profiles for selected factors retrieved binding sites in the promoter regions of genes used as controls with high specificity, as described in the results section. secondly, on an extended collection of experimentally characterized tfbss, our method identified 98% to 100% of the true positives with a false positive ratio that was consistently smaller than the ones reported by the other methods tested. thirdly, roc and true positive proportion tests performed on a large number of models for which both a nwm and a hmm was available showed that in the majority of the cases our method performs significantly better than a nwm-based program such as match. this translates into an increased ability to detect true binding sites while reducing the number of false positive sites reported. finally, our method takes advantage of a larger set of models for a given tf, and this results in an increased ability to detect true hits.

the web-based interface was design to maximize usability and to facilitate the analysis of the retrieved hits; it has simple and flexible input requirements, a clear and comprehensive display of the results and powerful graphical and export options.

the current work and its future extensions make available a novel and reliable method for the identification of tfbss that, used in combination with existing molecular genetic information and biological validation, represents a powerful tool for understanding the logic of combinatorial regulation. the search engine can be seen as the foundation for more advanced applications, such as highlighting patterns of tfbss involved in the regulation of particular genes, assessing the conservation of such patterns across multiple genomes, or identifying the tfbss overrepresented in a set of coexpressed genes.

