BACKGROUND
maddison et al.  <cit>  described a method using a binary-state speciation and extinction model  that estimates rates of change in a binary character and rates of speciation and extinction contingent on the character state, given a known distribution of observed states on the tips of a tree of contemporaneous species. the bisse method assumes that the tree includes all extant species and that all species have known data for the state of the single binary character  <cit> . fitzjohn et al.  <cit>  provided additional methodology for including known species diversity into an incomplete phylogeny if a researcher could confidently place taxa into unresolved terminal clades. bisse provides estimates for the rates of speciation in each character state , extinction in each state , and character transition rates between states . such estimates are important to studies of whether a particular feature is controlling the diversification rates of clades and whether the effect is on speciation, extinction, or both  <cit> . recent studies have also modified the basic approach of the bisse method to estimate further parameters associated with quantitative characters  <cit>  and geography  <cit> .

maddison et al.  <cit>  discussed the development of the bisse method and demonstrated its ability to estimate rates from simulated data sets. recently there has been a burst in the number of studies that have utilized the bisse method to explore rates of diversification in various taxonomic groups for the purpose of testing hypotheses involving key innovations and the evolution of characters  <cit> . however, the majority of these studies explore diversification and character evolution hypotheses with fewer than  <dig> taxa, despite the initial warning by maddison et al.  <cit>  that the power of analysis may be affected by low sample size.

wise use of any statistical method should be guided by an understanding of its power and ability to distinguish hypotheses of interest, but current empirical studies lack sufficient guidance, because there has been little work on the bisse method’s behavior under different sample sizes  and parameter values. the primary goal of this study is to explore the power and accuracy of parameter estimation of the bisse method. using simulations we explore the number of species needed to obtain good power, the advantages of estimating fewer parameters, and the effect of the extreme asymmetries in rates. additionally, because there are many ways that an observed excess of a character state can be explained through macroevolutionary processes , there is also concern regarding confounding effects  <cit> , and whether bisse can identify which rate asymmetries are causing the observed character excess in empirical data.

RESULTS
power of bisse method
asymmetries in speciation rate
extremely low power  was observed when tree size included  <dig> taxa, regardless of the degree of rate asymmetry . power marginally improved for tree sizes of  <dig> taxa, but decreased considerably as the asymmetry increased to  <dig> and 20× rate difference . a tree size of  <dig> tips indicated a higher overall power for each difference in rate than those observed with  <dig> or  <dig> taxa. power increased as the degree of difference in rate asymmetry increased, until reaching a rate difference of four times the speciation rate where the power begins to decrease as the degree of rate asymmetry grows. this same pattern was observed for a tree size of  <dig> tips . in general, power increased as tree size increased , and a pattern of power decrease following an increase in tip-ratio bias resulting from rate asymmetry was observed in the simulation including more tips .


asymmetries in rate of character state change
for each asymmetrical model of character change , power increased with an increase in tree size . power remained low and did not increase with a difference in rates when the tree size was  <dig> taxa. there was a slight increase in power as the degree of difference in rates increased with tree sizes of  <dig> taxa . power was higher for simulations with  <dig> taxa for each respective difference in rates compared to the same simulations with  <dig> and  <dig> taxa. power increased as the rate difference increased to 5× then leveled off to 10×, followed by a strong decrease in power as the difference in rates increased to 20× and 40× . this same pattern was observed in simulations of  <dig> taxa and in general there was a decrease in power observed in all tip sizes beyond a 10x difference in rates of character change .

asymmetries in extinction rate
as with rates of speciation and character state change, power increased as tree size increased regardless of the amount of difference in extinction rate . with tree sizes of  <dig> taxa, power was low regardless of the degree of rate asymmetry, and power was similarly low with  <dig> taxa. with tree sizes of  <dig> and  <dig> taxa, power increased until a rate difference of 3×, with power decreasing as the degree of rate asymmetry continue to increase. overall, power in hypothesis testing with extinction rates was lower than those for speciation or character state change .

power of six parameter model vs. four parameter model
the change in power among low and high tip bias scenarios when using a model that estimates fewer parameters is observed in figure  <dig> . the reduced four parameter model differs from the full six parameter model  with two of the rates constrained to be equal in both character states, for example . in nearly all cases, especially with tree sizes greater than  <dig> taxa, there was an increase in power when the four parameter model was used compared to the six parameter model . the greatest increase in power occurred in the scenarios with a greater degree of bias , and the effect was observed regardless of which parameter possessed the rate asymmetry . as was the case with the six parameter estimations, power is low when tree size is below  <dig> taxa with a four parameter model.


parameter estimation
estimating parameters under asymmetrical speciation
as previously identified by maddison et al. , the bisse method estimates speciation rates well, with strong delimitation of known asymmetrical rates given an appropriate tree size , although precision decreases as the speciation rate asymmetry, and tip bias, increases. for estimates of known symmetrical rates of character change under asymmetrical speciation rates, accuracy and precision of estimating the known rates become significantly worse under the higher tip bias scenario . a similar pattern is recovered for estimates of known symmetrical extinction values where rates were estimated with more accuracy and precision under low tip bias , with accuracy and precision strongly decreasing under high tip bias  as observed in figure 3c. accuracy and precision of parameter estimation greatly decreases for all rates with a small sample size of tips, regardless of low or high tip bias .


estimating parameters under asymmetrical character change
estimates of asymmetries in character change are not as accurate or precise as estimating rates of speciation . in general, precision decreases as the rate difference increase results in a high tip bias scenario, with parameter estimation being poor for a known estimate of a 40× rate difference in character change. symmetrical speciation rates  are well estimated when the rate of character change is 2×  as seen in figure 4a. however, with a 40×  difference in the rate of character change the precision of parameter estimation appears to decrease, and the number of estimates for highly asymmetrical speciation rates increases . parameter estimation of known extinction rates  is more accurate under the 2×  scenario rather than the 40×  scenario where estimates of known extinction values are very poor .


estimating parameters under asymmetrical extinction
estimates of known extinction values are poor and seem to lack precision, with precision decreasing as the difference in extinction rates increase . speciation values are well estimated to the known values  when the difference between extinction rates is 2× , but accuracy and precision seems to decrease dramatically as the extinction rate asymmetry increases , leading to an abundance of highly asymmetrical estimates of speciation rates . parameter estimation of character change has the same pattern, in which the known rate  is well estimated under 2×  extinction rate differences , but is poorly estimated under an increased difference in extinction rate asymmetry that leads to high tip bias . this poor estimation leads to a dramatic increase in asymmetrical rates of character change that favor transitions from state  <dig> to  <dig> 


discussion
impact of tree size on power
the statistical power of the bisse method depends on the number of taxa and the degree of asymmetry in rates of speciation, extinction, and character state change. in terms of tree size, bisse achieves extremely low power when testing hypotheses of rate asymmetry if fewer than  <dig> taxa are used in the analysis, even when rates are known to be highly asymmetrical . as a result, the potential for a type ii error  is extremely high.

the highest power attributed to any rate asymmetry associated with  <dig> taxa is only 50%  under a six parameter model. researchers that attempt to utilize the bisse method with fewer than  <dig> taxa should take caution. below  <dig> taxa there is little statistical power associated with identifying rate asymmetries, regardless of whether strong asymmetries exist. maddison et al.  <cit>  hypothesized that large amounts of data would be needed to distinguish significant asymmetries because there are many ways to arrive at a given phylogeny.

power of simplified models
if external information justifies a simplification of the model, then greater power can be achieved. we found an overall increase in power when utilizing a four parameter model over a six parameter model regardless of which rate possesses the asymmetry , although tree sizes greater than  <dig> tips are still desirable. whether researchers can take advantage of this greater power using a model with fewer free parameters depends of course on whether it is reasonable to assume in advance that any asymmetries are restricted to one rate.

confounding processes
strong asymmetries in rates of speciation, character state change, and extinction yielded, as expected, a strong excess of tips with a single character state . the question to a biologist observing such a pattern is; which rate’s asymmetry might have led to such excess? maddison  <cit>  hypothesized that teasing apart parameters that are the cause of taxonomic state frequency asymmetry is difficult, and that simultaneously estimating these parameters may help address this issue. we found that under best-case scenarios where high tip bias is absent and sample size is high , parameters are estimated accurately and precisely . this indicates that the bisse method is capable of identifying the rate asymmetry that is causing taxonomic excess when datasets are used with a sufficient amount of tips and where high tip bias is absent, as seen in figures  <dig>   <dig>   <dig> . in these scenarios, bisse is able to properly identify the known process with the rate asymmetry , whether it was speciation , character change , or extinction . this is further corroborated by the power, which remains high in cases where sample size is large and tip ratio bias is minimized . however, teasing apart which rate asymmetries are causing taxonomic excess of one character state is a problem under two conditions; if tree size is small , regardless of the degree of tip bias, and if there is a high degree of tip ratio bias towards one state, even while simultaneously estimating parameters using the bisse method with trees of substantial size . below we discuss why high tip ratio bias leads to a decrease in power and parameter estimation, and how much tip ratio bias is necessary to have an adverse affect on teasing apart confounding processes.


the observed percent of terminals with state  <dig> are for simulations with  <dig> taxa. observed tip ratios were nearly identical for other taxa sizes .

when taxa are saturated for a particular state , the bisse method estimates high rate asymmetries to explain this pattern, even for those rates known to be low and symmetrical . for example, when extinction is 10× higher for state  <dig> than state  <dig> , the extinction asymmetry is detected, but the rate of character change is also estimated to be highly asymmetrical . the method infers rapid change from state  <dig> to  <dig>  when in fact, the constrained rates were fairly low and symmetrical . the inability to identify confounding processes when there is high tip ratio bias results in the observed decrease in power when the degree of rate asymmetry increases in either the rate of speciation, extinction, or character change . this issue is not resolved with larger tree sizes , and the degree of tip bias needed to adversely affect the accuracy and precision of parameter estimation varied with the process .

the amount of bias needed to reduce accuracy and precision of parameter estimation, leading to worst-case scenarios, changed depending on the process. when estimating parameters associated with asymmetries of speciation rates, power sharply decreases when fewer than  <dig> % of the taxa have one of the binary traits . character change and extinction rate asymmetries are more adversely affected by trait rarity, with the worst-case scenarios happening when a binary trait occurs in fewer than 8–10% of the terminal taxa. as with speciation, high tip ratio bias leads to a sharp decrease in power regardless of sample size . overall, caution is recommended when using the bisse method if tip ratio bias is greater than a 10: <dig> ratio for binary states in terminal taxa, as this level of trait rarity in one state may have a negative impact on the power of the analysis  and the ability to identify confounding processes under these worst-case scenarios.

the observed pattern of a decrease in power associated with speciation, extinction, and character change when rates become increasingly asymmetrical is troubling . in general, investigators should be cautious using the bisse method when one of the binary characters in question is exceedingly rare in their data sets . bisse may mistakenly estimate the wrong parameter  to be the cause of taxonomic excess in situations where high tip ratio bias is observed, and increased tree size does not alleviate this issue. if investigators report a significant result, there is a possibility that the inability to identify confounding processes in these scenarios may impact the interpretation of the causes for the observed pattern of state asymmetries. further work is needed to establish a robust methodology within the bisse framework for teasing apart the parameters that are directly contributing to character state bias under these high tip ratio scenarios.

difference in estimation accuracy among processes of change
we found that the bisse method is far more accurate and precise with estimates of rates of speciation and character change than with extinction rates , which was also noted by maddison et al.  <cit> . overall, a greater degree of tip ratio bias is needed to reduce the accuracy and precision of speciation parameter estimation and a loss of power when the rate asymmetry is related to speciation . while extinction can leave a signal in molecular phylogenetic trees recovered from extant taxa alone  <cit> , estimating extinction rates from molecular phylogenies often results in rates approaching zero, which is potentially the result of cladogenetic events being directly inferred from molecular phylogenies and not extinction events  <cit> . recently, rabosky  <cit>  indicated that without information from the fossil record, estimating extinction rates from molecular data alone may be potentially impossible if rates of diversification vary across a topology. as demonstrated by this study, bisse is capable of estimating rates of extinction from known values given sufficient data , albeit with far less accuracy and precision than rates of speciation or character change. also, if an asymmetry in extinction rates leads to a high tip ratio bias, the accuracy and precision of extinction rates estimation decreases . finally, the accuracy and precision of estimating rates is also impacted by a small sample size  regardless of tip ratio bias as indicated in additional file 2: figure s <dig>  in addition to low power associated with small tree sizes, investigators should be cautious of a significant result if tree size is less than  <dig> tips, as the inferred cause for the potential evolutionary pattern may be misled by the issue of confounding processes.

identifying critical values
an additional issue uncovered in this analysis is the difficulty in finding appropriate critical values. the critical values from our simulations suffer from a great deal of variation . the nearly consistent difference in critical values suggests that simply comparing the statistic to a χ <dig> distribution may not be appropriate as suggested by maddison et al.  <cit> . therefore, we suggest simulating your own critical values, using as many replicates as possible, as we did here. suitable simulators are available in both mesquite and the diversitree r-package  <cit> .

implementation issues
another possibility is that the method performs better than these results suggest, but limitations of our likelihood optimizer limit the power of our implementation. our implementation, as described in maddison et al.  <cit>  uses several techniques to overcome the limitations of the brent  <cit>  optimizer, including using multiple searches from randomly generated starting points, and the option of starting searches from values estimated from more constrained models. tests  with alternative optimizers, using the diversitree package described fitzjohn et al.  <cit>  indicate that little, if any, loss of power is actually related to the choice of optimizer.

CONCLUSIONS
the power of the bisse likelihood method to test hypotheses of rate asymmetry is susceptible to both tree size and variation in parameter rates. overall, power of the bisse method is low if the tree size is below  <dig> taxa, and investigators should take special care to investigate the power of their results if applying the bisse method to topologies with fewer than  <dig> tips. power is increased when estimating fewer parameters, so utilizing a four parameter model to test hypotheses may be preferable if appropriate.

this study indicates that contrary to the hope expressed in maddison  <cit> , the problem of confounding effects can still occur while estimating process parameters simultaneously if there is low sample size and/or high tip ratio bias. under scenarios of large sample size  and low tip bias, the bisse method accurately and precisely identifies the rate parameters contributing to the observed taxonomic excess. however, if diversification rate parameters are too asymmetrical  and/or sample size is low, bisse is unable to accurately estimate rates. this in turn results in a dramatic decrease of power. we recommend that investigators must be cautious when interpreting their results if there is a character state bias among tips greater than a 10: <dig> ratio in favor of either binary state. in these worst-case situations, properly identifying the process responsible for taxonomic excess may be impossible regardless of the number of tips in the dataset. if investigators using data with fewer than  <dig> tips and/or with high tip bias report a significant result, there exists a possibility that the issue of confounding effects has misled the identified rate cause of the significant result. further work is needed within the bisse framework to develop methods to better identify which parameters are causing the character state bias in these worst-case scenarios . further exploration of the impact of multiple rate asymmetries is also needed. however, it is clear that if multiple rate asymmetries are occurring that promote high tip ratio bias there will be difficulties with power and parameter estimation.

