BACKGROUND
biomolecules often feature asymmetries in stereochemistry. many biologically active molecules are chiral, i.e., they exist in two forms, called enantiomers, which are non-superimposable mirror images of each other. of particular relevance to biological compounds is the carbon atom as a chiral center: a carbon atom is chiral if it carries four nonequivalent substituents. thus, all amino acids save glycine have at least one chiral center at cα . threonine and isoleucine have an additional chiral center at cβ. interestingly, only one of the two enantiomers is widely used in nature: according to the d-/l-naming convention, most naturally occurring amino acids are found in the l-configuration. note, however, that d-amino acids do occur in biology, e.g., in cell walls of bacteria  <cit> . nucleic acids also have chiral centers. for example, in dna the atoms c1', c3', and c4' of the sugar moiety are chiral, while in rna the presence of an additional oh group renders also c2' of the ribose chiral . although the origin of the homochirality is not understood, the asymmetry due to preferential use of one enantiomer in biological systems has wide consequences. in particular, recognition processes of chiral molecules are impacted as can be demonstrated, e.g., by the different smell of d- and l-carvone or by the inhibition of proteases by d-amino acids  <cit> . on the level of protein structure, the occurrence of d-amino acids in an l-amino-acid environment is known to disrupt secondary structure  <cit> . the crucial role of the correct enantiochemistry can be also seen in the fact that organisms tightly control the use of d-amino acids. some of the aminoacyl-trna synthetases, which implement the genetic code by loading a trna with the corresponding amino acid have proofreading capabilities to exclude d-amino acids  <cit> . additionally, organisms have evolved specific enzymes, deacylases, which are able to recognize trnas acylated with a d-amino acid and cleave the bond between the amino acid and the trna, thus preventing a d-acylated trna from entering into protein synthesis  <cit> .

another type of asymmetry is encountered in the conformation of the peptide bond connecting the carboxy end of one amino acid to the amino end of the next one in a peptide or protein. due to the partial double-bond character of the cn-nn+ <dig> bond, the atoms cα, n, cn, on, cα, n+ <dig>  nn+ <dig> and its hydrogen are in a plane  and the rotation around the cn-nn+ <dig> bond is restricted by a barrier of about  <dig> kcal/mol  <cit> . depending on the value of the dihedral angle ω described by cα, n, cn, nn+ <dig> and cα, n+ <dig>  one can distinguish cis  and trans  isomers  <cit>  . for sterical reasons, the trans isomer is energetically more stable and, thus, is the prevalent form in proteins. additionally, the rather high rotational barrier makes the interconversion of the two isomers a very slow process at room temperature. nevertheless, cis peptide bonds can be found in nature  <cit> . the vast majority of cis bonds are observed before a proline residue, xaa-pro, with xaa being any amino acid. the formation of these cis peptides is catalyzed by special enzymes, prolyl-cis/trans isomerases  <cit> . prolyl-cis/trans isomerization is an important molecular switch  <cit>  and the occurrence of enzymes specialized for this particular isomerization underpins its biological significance. non-prolyl cis peptide bonds can also be found in proteins, but much less frequently than xaa-pro  <cit>  and only one protein, dnak, is known to promote peptide isomerization of non-prolyl peptide bonds  <cit> . in particular, dnak was found to accelerate the isomerization of ala-xaa bonds, xaa being ala, gly, glu, ile, leu, lys, met, or ser. metal ions can also play a role both in stabilizing the cis isomer and in promoting isomerization  <cit> .

correct stereochemistry of a structural model is important for its interpretation and critical if the model is to be subject to a molecular dynamics simulation. force fields typically employed in biomolecular simulations do not contain terms to enforce stereochemistry and support either enantiomer or peptide isomer. errors in the input structure usually persist throughout the simulation and, as will be shown below, can propagate and lead to severe artifacts. even in cases where stereochemical errors do not lead to such large-scale problems, such errors must be avoided since they represent deviations of the simulated system from the biological reality that is to be modeled. there is a steady trend in the field of biomolecular simulations toward the study of large biomolecular assemblies and the usage of models based on structure prediction. our recent experience  <cit>  shows that stereochemical errors often arise in the preparation of large systems for simulation, particularly when some components must be modeled prior to simulation.

a variety of servers and programs are available for structure validation, a vital stage in the preparation of files for deposition in a coordinate database. one example is the saves server  <cit> , which provides an interface to tools such as procheck  <cit> , what_check  <cit> , and other programs to detect irregularities in geometry and structure such as chirality, bond angles, close contacts, or rotamer states of amino acid side chains. other examples with similar functionality include the molprobity  <cit>  server as well as the pdb validation service  <cit> .

all of the aforementioned tools for structure validation are primarily designed to validate experimentally obtained models and not to ensure proper stereochemistry in simulations. additionally, although irregularities are reported, none of the tools we are aware of allow the user to inspect and correct stereochemical errors easily and immediately. we have thus written software tools to help researchers easily detect, correct, and avoid stereochemical errors in simulations.

in the following, we start by illustrating how errors in chirality and peptide bond configuration can affect secondary structure of proteins in molecular dynamics simulations. we then present software tools to identify, visually inspect, and interactively correct stereochemical errors in structural models of proteins and nucleic acids. next, we discuss the most common sources of stereochemical errors in simulations, alongside a systematic analysis of the entire protein data bank  <cit> . finally, we provide a recommended workflow to avoid stereochemical errors in biomolecular simulations.

RESULTS
consequences of stereochemical errors in biomolecular simulations
in order to understand more directly the effects that errors in chirality or peptide bond configuration have on secondary structure, consider three simulations involving a 15-amino-acid-long α-helix aaqaaaaqaaaaqaa solvated in water. in the first simulation, the helix is stereochemically correct. for the second simulation, a chirality error is introduced at cα of gln <dig> . in the third case, the peptide bond between gln <dig> and ala <dig> is present as a cis isomer .

as demonstrated above, the impact of errors in chirality or peptide bond isomerization on secondary structure can be dramatic. note, however, that the chosen example represents the worst case scenario in terms of severity of the structural disturbance - in a real protein, tertiary interactions may provide stabilization of the native structure and, thus, dampen the effect or extend the time scale on which the structural disturbance becomes apparent.

tools to identify, inspect, and correct stereochemical errors
having demonstrated the impact of stereochemical errors on structure, the question of how to ensure stereochemical correctness in simulation naturally arises. in general, biological systems can contain amino acids or sugars of different chirality, as well as both peptide isomers. thus, an automatic procedure to "correct" the structure is not appropriate unless one is absolutely certain that only one enantiomer and isomer occurs. therefore, we designed a semi-automatic four-step protocol to correct errors and to ensure stereochemical integrity of a simulated system. for both chirality and peptide bond conformation, the protocol was implemented into easy-to-use plugins for the molecular visualization and analysis program vmd  <cit> , referred to as chirality and cispeptide plugins, respectively. the plugins make use of the molecular dynamics simulation package namd  <cit>  in the correction step. both software packages are open source and freely available. the current implementation provides both a graphical and a command-line user interface. use of each plugin follows a similar 4-step process, namely:  identify stereochemical anomalies;  visually inspect each anomaly and decide if it should be corrected;  move selected atoms as to change the stereochemical configuration; and  locally optimize the structure. in the following, we describe the four steps using the cispeptide plugin as an example. full documentation is available on the vmd website  <cit> . an additional step-by-step practical guide can be found in a tutorial describing both plugins  <cit> .

in step , unusual stereochemical configurations  are identified. a peptide bond is considered to be an irregularity if the value of the dihedral angle ω' formed by on, cn, nn+ <dig> and cα, n+ <dig> is larger than 85°. the slightly different, but equivalent, definition of the angle with respect to ω ensures unique atom names used for the angle measurement  and the threshold is chosen so as to avoid false positives while maximizing the sensitivity when all the structures of the pdb were tested . for chiral centers, the improper angle made up of non-hydrogen atoms with the chiral atom in the center is used to define non-standard configurations: a negative value of the considered improper indicates an unusual chirality. all identified irregularities are displayed in the corresponding panel . in step , the irregularities are inspected and a decision is made whether to keep or to modify each stereochemical configuration. clicking on each stereochemical anomaly generates a corresponding molecular visualization . as mentioned before, there are tools  <cit>  that may help decide if the cis configuration is correct or if it should be switched to trans. in step , for each cis peptide bond to be manipulated, the user selects an atom  to be moved . cα atoms are not allowed to move in order to minimize the structural impact. the movements are reflections of the positions of hydrogen or oxygen relative to the peptide nitrogen or carbon, respectively . which of the two atoms should be moved highly depends on the environment, and is thus not automated. by visual inspection, the user can quite confidently determine which atom  should be moved in order to optimize the hydrogen bonding network. finally, in step  a local structure optimization is carried out using namd through the interactive molecular dynamics  <cit>  interface in vmd . to enforce the target isomer, local restraints on the peptide dihedral are employed. the local nature of the manipulation and relaxation, which only involves residues within a given cutoff, prevents widespread influence of the procedure on the system. finally, once the system is stereochemically correct, restraints can be constructed and used during further relaxation steps, prior to production simulations, to prevent changes in stereochemistry.

sources of stereochemical errors
most molecular dynamics simulations of single proteins are relatively safe from stereochemical errors, given that molecular structures are validated upon deposition into the pdb. the irregularities detected in the validation step are usually either corrected or reported in the header of the pdb file. using a structure from the pdb for simulations, together with a careful examination of the file header, usually means that the stereochemical integrity of the simulation is secure , because during an equilibrium simulation the force field will preserve stereochemistry. however, since force fields used for molecular dynamics simulations support both types of chirality as well as both peptide bond isomers, an existing error will persist throughout the simulation.

to quantify stereochemical anomalies within the protein data bank, all the structures contained in the pdb were analyzed using the chirality and cispeptide vmd plugins introduced above. as shown in table  <dig> around  <dig>  unusual configurations with respect to chirality could be found in protein and nucleic acid structures, as well as more than  <dig>  cis peptide bonds. analysis of the complete dataset shows that one chirality error is expected for every  <dig>  residues, whereas for every few hundred residues a cis peptide bond can be expected. the likelihood of stereochemical anomalies varies with the structure determination method, in particular when chirality is concerned. for example, for structures derived from electron microscopy, one chirality error can be expected for every  <dig> residues . the higher error rate seen in electron microscopy-derived structures are likely due to the much lower resolution on average, combined with use of a wide range of modeling approaches, including manual manipulation of structures.

 <dig> as given by expdta record on each pdb file. entries with more than one method were classified based on the first method listed. only methods with at least  <dig> solved structures are shown in the table.

 <dig> total number of chirality errors or cis peptide bonds detected by the chirality and cispeptide vmd plugins, respectively.

 <dig> total number of residues divided by total number of chirality errors or cis peptide bonds. for chirality errors, all protein and nucleic acid residues are counted; for cis peptide bonds, only protein residues are counted.

 <dig> for chirality, only structures containing at least one protein or nucleic acid residue were considered. for cis peptide bonds, only structures containing at least one peptide bond were kept in the analysis.

in a subset of structures, chirality errors  and cis peptide bonds  were reported in the pdb file, but were not detected by the plugins. to understand the discrepancies, about half of the structures in each subset was visually inspected. in the case of cis peptides, the differences were due to missing atoms in the deposited model, errors being present in only one alternative conformation or model , pathologically distorted structures, and, most frequently, incorrect entries in the pdb header. similarly, the reasons for the discrepancies in chirality were that errors occurred in cofactors not checked by the plugin, the anomalies were present in only one alternative conformation or model , or the annotations in the pdb header were incorrect.

the plugins also identified many structures with stereochemical anomalies not reported in the pdb header. according to the current pdb format standard, each cis peptide bond should be reported in a separate cispep record. it is then possible to compare each identified cis peptide bond with the pdb header. there were in total  <dig>  cis peptide bonds identified by the cispeptide plugin but not reported in the pdb files. visual inspection of  <dig> such files did not reveal any incorrect identification by the plugin. chirality issues should be reported in caveat records of the pdb header. unfortunately, since caveat records are free format, rarely are chirality errors individually reported. furthermore, many pdb structures have chiral errors inconsistently documented in remark  <dig> records instead. thus, a similar comparison on a per-error basis cannot be performed for the chirality plugin; instead, we can only report that  <dig> pdb files contain chirality anomalies according to the chirality plugin, but lack the corresponding annotation in their pdb headers. upon visual inspection of  <dig> files, the structures fell into two categories: either there should be a d-amino acid  or the pdb header is simply missing the required annotation.

apart from errors already present in experimentally determined structures, our experience shows that there are three main sources of stereochemical errors in simulations. the first source is found in modeling steps, particularly homology modeling: any regions of a structure that were modeled de novo, especially at the junctions of the known and modeled part of a protein, are prone to peptide isomerization errors. the second common source is found in the setup protocol for a simulation. this includes the preparation of the system and its initial relaxation. in particular, sterical clashes between atoms can lead to errors in chirality and isomerization state of peptide bonds. again, such behavior is particularly likely at the interface between known and modeled portions of a structure, which may contain severe distortions prior to equilibration. although the barriers for isomerization or a flip in chirality are large enough to prevent these events in an equilibrium simulation at physiological temperatures , forces arising during the initial structure optimization, necessary to relax possible clashes, may be large enough to introduce errors into the structure. this source of errors becomes increasingly important as the field of computational biophysics moves towards multi-component assemblies, the structures of which are often modeled based on high-resolution models of their constituents and low-resolution data of the whole complex. finally, errors can also be introduced during structure optimizations if additional forces are applied on the system. of particular interest at this point is the molecular dynamics flexible fitting  method  <cit> , which flexibly fits atomic-resolution structures into low-resolution density maps. in some  cases, it was observed that forces arising from the mdff method during initial structure optimization were large enough to cause stereochemical errors. system setup protocols where the system is simulated at very high temperatures  may also allow incorrect isomerization events.

the chirality and cispeptide plugins can be used to generate harmonic restraints designed to preserve the current isomerization state of each chiral center and peptide bond. the restraints can be used in simulations with namd, effectively preventing stereochemical errors from arising during simulation. these restraints should be removed prior to production equilibrium simulations, since they are not required and would represent an unnecessary modification of the force field employed.

recommended workflow
in order to avoid stereochemical errors, the following simple workflow is recommended for standard md simulations:

 <dig>  build system for md simulation .

 <dig>  energy-minimize structure.

 <dig>  check stereochemistry with the chirality and cispeptide plugins, correcting errors if applicable. repeat until no further errors are detected. make sure that the detected irregularities are indeed errors and not naturally occurring.

 <dig>  proceed to production simulation.

for simulations in which large forces are expected , it is recommended that, in addition to the workflow above, harmonic restraints generated by the chirality and cispeptide plugins are applied throughout the simulation.

CONCLUSIONS
the simulations presented here illustrate the drastic effects that stereochemical errors can have in biomolecular simulations. experimentally determined structures may contain stereochemical errors, and various modeling approaches can further increase the number of such errors. as the community moves toward simulation of large, multi-component complexes and uses to an increasing extent models based on structure prediction, the issue of stereochemical correctness becomes even more relevant. we thus developed tools to identify, inspect, and correct stereochemical errors in protein and nucleic acid structures. in particular, chirality and the isomerization state of a peptide bond are examined. the main advantage of the offered tools is the possibility to immediately inspect and correct the detected errors. the tools are implemented as plugins to the molecular visualization and analysis program vmd. the recommended workflow presented above effectively avoids artifacts in simulations due to stereochemical errors. we hope that checks for stereochemical correctness become a standard step of any biomolecular simulation or generation of predicted structural models for proteins and nucleic acids.

availability and requirements
• project name: cispeptide, chirality; included into vmd

• project home page: http://www.ks.uiuc.edu/research/vmd

• operating system: platform independent

• programming language: tcl

• other requirements: vmd  <dig>  or higher, for molecular dynamics part: namd  <dig>  or higher

• license: uiuc open source license http://www.ks.uiuc.edu/research/vmd/plugins/pluginlicense.html http://www.ks.uiuc.edu/research/namd/license.html

