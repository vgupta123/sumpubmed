BACKGROUND
owing to new sequencing technologies, the number of microorganisms with completely or partially determined genomic sequences is rapidly increasing, inclusive of many species that cannot be artificially cultured and many new/unknown species collected from environmental samples. as the amount of genomic information increases, interdependent relationships between species  and the survival strategy of certain microbes and their living environment  become particularly interesting. as a result, the microbiology field has gradually expanded its focus from microbial clones to microbial communities, and some new research fields have accordingly formed, such as metagenomics  <cit> . because species are no longer studied through clonal isolates, the first question encountered by microbial genomics researchers looking at a heterogeneous population is often "who is there?". a number of short biomarkers, such as the 16s rrna genes, exhibit detectable sequence variations in a basically conserved framework between species and can be used both to identify individual species within a community and to infer their phylogenetic relationships  <cit> . however, there are drawbacks in analysis of short sequences. these markers generally comprise just a small proportion of an organism's genome; for example, 16s rdna contributes less than  <dig> % of the bacterial genome  <cit> . previous studies have suggested that the lack of metabolic information in this small amount of genetic material renders it insufficient to describe the way of life for an entire organism or species  <cit> .

many studies have used existing metabolic databases, e.g., kyoto encyclopedia of genes and genomes , to understand metabolic relationships between organisms and to construct complete relationship trees  <cit> . interestingly, although relationship trees constructed using metabolic data are generally consistent with existing phylogenetic trees; there are important differences in the details  <cit> . in some ways, these relationship trees more effectively explain the survival strategies that organisms have developed to handle unique metabolic relationships, such as how symbiotic bacteria share metabolites with hosts  <cit> . however, these methods still have many basic shortcomings, including the dependence on complete quantitative information of metabolites, difficulty in defining reactants and intermediates, heavy reliance on human annotation, and the requirement to deal with excessively complex metabolic data  <cit> . many of the problems associated with constructing organismal relationships from metabolic data may be avoided by using a proteomic approach. since proteins are the basic functional units of biological systems, construction of proteomic trees may prove effective in describing the metabolic relationships between species and in reconstructing phylogenetic relationships  <cit> .

microorganisms were chosen as the initial test subjects for our proteome-based classification method. distinct from complex multicellular organisms, most microorganisms are unicellular and structurally simple. in addition, most microbial intracellular proteins react directly to external stimuli. while there are differences among related proteins, functionally critical protein domains are typically very conserved  <cit> . this study used a common set of conserved protein sequences -- which is called a probe-set -- to determine relationships between organisms, an analysis that could be labelled "seeking commonality among variation". then, "seeking variation among commonality", differences in conserved sequences between organisms were used to categorize individual organisms. currently, the genomes of more than one thousand microorganism strains have been sequenced  <cit> . the habitats of these microorganisms vary greatly, from symbiotic environments to extreme ecosystems. since ample biochemical and metabolic data concerning these microorganisms are available, they were selected for the initial development and evaluation of our method.

we first verified that the proposed probe-set method could identify differences between enzymes and between metabolic pathways. next, we demonstrated that the method could accurately differentiate host-associated from free-living bacteria. finally, using sequence data from hundreds of microorganisms, we constructed a large-scale relationship tree. several factors contribute to the success of the probe-set method for clustering microorganisms that share unique metabolic relationships, that coexist in extreme environments, or that possess extraordinary metabolic capabilities . the probe-set method is essentially a compositional analytical method that avoids the disadvantages of conventional sequence-based classification methods, including the difficulty of classifying sequences containing exchanges or recombinations  <cit> . an important advantage of the probe-set method is its ability to classify organisms whose genomes have not been sequenced. this should make this method feasible for metagenomics studies, which generally involve incomplete and poorly annotated genomic sequences  <cit> . in addition, the proposed method is able to detect metabolic differences between organisms with very close evolutionary relationships. finally, to compare trees generated by the probe-set method with other kinds of classification trees, a tree topology comparison method is developed in this work. this tree comparison method is useful for large scale phylogenetic tree comparing and can be a standard evaluating approach for further tree building methods.

RESULTS
probe-set method: definition and evaluation
the probe-set concept
we used short, highly conserved, amino acid sequence fragments to define the proteomic probe-set. for implementation, the prosite descriptors  were selected as probes in this work. each prosite descriptor represents a conserved protein sequence extracted from a number of proteins with similar biological functions. a descriptor can be considered a consensus of a group of text strings that occur frequently at the functional site of a certain kind of enzymes, transporters, receptors, etc. for example, descriptor ps <dig>  which represents the sequence pattern commonly found at the active site of chloramphenicol acetyltransferase, can be written as q--h-h--x-d-g--h. sequences such as q-l-h-h-s-g-g-d-g-f-h and q-v-h-h-a-g-g-d-g-y-h match this pattern descriptor, or probe. if a probe is found in a protein, that protein generally has the function represented by the probe. although a single probe only describes a small fraction of the functions of a proteome/genome, a reasonable representation can be obtained by using a sufficiently large collection of probes. this is the core concept of the proposed method, which utilizes approximately  <dig>  probes. to determine relationships among a chosen set of organisms, probe frequency patterns of the  <dig>  probes were calculated for each proteome. these frequency patterns were then clustered to construct the classification tree. the probe-set method is thus a global-scale method that disregards noise in the system  and focuses on conserved protein sequences that more accurately describe an organism's functional capacities.

protein-level evaluation
as a first test of the probe-set method, we focused on enzymes with well-defined functions. the enzyme commission  has hierarchically categorized enzymes using a system consisting of four levels. the classification of each enzyme is represented by a four-digit number representing the four levels . the first ec level is a rough functional classification consisting of six classes: oxidoreductases , transferases , hydrolases , lyases , isomerases , and ligases . enzymes within the same level  <dig> class perform similar chemical reactions, but can have large differences in sequence and structure. in addition, their target substrates and reactants may be very different. based on these "existing variations among commonality", we chose the first ec level of enzyme classes as the first data set for evaluating the probe-set method. a non-redundant set of  <dig>  enzymes was created by randomly selecting one enzyme from each level  <dig> ec classification. probe-set frequency patterns for the six ec level  <dig> classes are shown in figure 1a. to visually represent the results, frequency patterns were color-coded and scaled by brightness . correlation coefficients  were calculated to compare probe-set frequency patterns. very clearly, each ec class had a unique probe frequency pattern, and the cc values between classes were generally low. although enzymes within a single ec class might have differences in sequence and structure, differences between classes were even larger, as they include diverse catalytic mechanisms, substrates, and cofactors. these results demonstrate that the probe-set method can distinguish between groups of proteins with fundamental functional differences, and that it may be computationally feasible to develop an automated proteome classification procedure.

pathway-level evaluation
it is perhaps not surprising that enzymes with different functions have different probe-set frequency patterns. we next asked whether entire metabolic pathways could be distinguished using this method. this task is inherently more challenging and more relevant, as pathways are not composed of proteins with the same function, but of proteins with multiple functions that act cooperatively. for example, according to the kegg database , a typical glycolysis/gluconeogenesis pathway requires  <dig> enzymes, including  <dig> ec <dig>   <dig> ec <dig>   <dig> ec <dig>   <dig> ec <dig>   <dig> ec <dig>  and  <dig> ec <dig> enzymes. five major metabolic pathways are commonly shared among organisms: the carbohydrate , energy , lipid , nucleotide , and amino acid  pathways. as shown in figure 1b, different metabolic pathways possessed different probe-set frequency patterns, and the cc values between pathways were low. these data indicate that the probe-set method can effectively discriminate between major metabolic pathways. it is noticeable that metabolic reactants and intermediates were not considered in this analysis; therefore, the discriminatory power of the probe-set method would not be significantly affected by unclear definitions of reactants and intermediates .

proteome-level evaluation
so far we have shown that different categories of enzymes and metabolic pathways possess well-distinguishable probe-set frequency patterns. however, relying solely on enzymes to categorize proteomes is inadequate, as organisms require many non-enzymatic proteins to survive, such as those involved in signal transduction or transcriptional regulation. in fact, the five metabolic pathways used in the previous analysis contain polypeptide sequences recognized by only around  <dig> probes . to more comprehensively test the method's capability, entire proteomes of both host-associated and free-living microorganisms  were examined by constructing a probe-set based classification tree . figure  <dig> clearly shows that host-associated and free-living organisms were differentiated using the probe-set method. both the color-coded probe frequency patterns and the classification tree revealed considerable differences between the two groups of organisms. the disparity in living environments between the two groups has perhaps leaded to the utilization of different metabolic pathways, allowing probe-set clustering to differentiate successfully between the two groups.

previous studies have found that host-associated microbes often lack certain metabolic pathways. the reason for this involves shared metabolites, such as the ability to obtain non-essential amino acids from the host  <cit> . most organisms of the class pseudomonadales are free-living microbes; however, organisms of the genus acinetobacter, which also belongs to class pseudomonadales, are mainly host-associated microbes. as shown in figure  <dig>  the acinetobacter organisms were all clustered in the same subgroup that is distant from other organisms of pseudomonadales in the probe-set classification tree. over time, host-associated organisms adapt to the living environment and alter/lose metabolic capabilities to better co-exist with their host organisms  <cit> . these changes would be expected to significantly alter the probe-set frequency pattern and therefore allow the proteome-based method to differentiate host-associated from free-living microorganisms.

global proteomic tree
we next sought to thoroughly evaluate the proposed classification method and compare our proteomic tree with the standard phylogenetic tree. a large-scale clustering of  <dig> microbial species was performed using the probe-set method. as shown in additional file  <dig> , the majority of probe-set classification results were consistent with existing taxonomic classifications. for example, archaea and bacteria were separated. besides, species were mostly grouped in accordance with their phylum and class taxonomic ranks. as for lower taxonomic levels, such as order and family, the classification results of our method also correlate well with regular taxonomic ranks . however, there are still several groups exhibiting significant differences from traditional phylogenetic classifications.

within the bacteria superkingdom, the proteobacteria phylum was divided into two groups by the probe-set method . this grouping is different from regular taxonomic classifications, according to which proteobacteria species should be clustered in the same group. the first group consisted of organisms mainly from phyla proteobacteria, spirochaete, and chlamyidae; most organisms in this group have parasitic/symbiotic characteristics. the second group comprised many species characterized by their unique ways of energy production, such as photosynthesis  and chemosynthesis . these results imply that, at taxonomic ranks lower than class, the probe-set method tends to classify species according to their biological and metabolic characteristics. since, in the example of proteobacteria, the characteristics were acquired due to the living environments of the organisms , it is expected that our classification method can help identify organisms living in similar environments and provide information about how they survive in and interact with their environments.

as expected, in the archaea superkingdom , we also found that the similarities of living environment exerted important effects on the classification results of our method. phylum euryarchaeota, for instance, were divided into two major groups that were consistent with the taxonomical classes of those organisms , but the grouping of organisms in each class did not exactly follow traditional taxonomic classification; instead, halophiles , thermophiles  and methanophiles  were respectively clustered together.

from these results, the probe-set method is able to reconstruct traditional phylogenetic classifications from a proteomic perspective and detect non-phylogenetic commonalities in organisms that have adapted unique biochemical capabilities. we believe that this is because the conserved sequences of a proteome can reflect the biological characteristics of an organism more accurately than genomic dna.

metabolic classifier for closely related species
traditional phylogenetic analyses based on short biomarkers may not be sensitive enough to differentiate organisms with highly close evolutionary relationships  <cit> . in traditional taxonomy, metabolic characteristics of organisms derived from biochemical and metabolic analyses are often used to help differentiate closely-related species  <cit> . however, analyses such as these are time-consuming and expensive. if bioinformatics techniques could be used in this process, the identification and classification of microorganisms would be much easier. we supposed that the probe-set method, which effectively classifies organisms according to their metabolic differences, is applicable in this regard. for instance, there are two types of lactic acid fermentation activities, i.e., the homo-fermentation and hetero-fermentation, evolved in the genus lactobacillus, that is, lactic acid bacteria fermenting lactose into lactic acid. as of the date of this article, there have been  <dig> species in the genus lactobacillus possessing known fermentative capability as annotated in the gold database  <cit> . classification results of these  <dig> species by the proposed probe-set method clearly revealed that they belong to two different groups: the hetero- and homo-fermentive groups . very probably, the proteomes associated with these two kinds of fermentative activities are different, allowing the probe-set method to distinguish between them. since the metabolic variances of these lactobacteria cannot be determined by 16s rrna homolog analysis but only through metabolic analysis  <cit> , this example demonstrates that the proposed method may be applied to finely classify organisms with such close evolutionary relationships that traditional phylogenetic analyses are inadequate to differentiate.

phylogenetic classifier for metabolic related species
to see whether our method could recognize the phylogenetic relationships among organisms possessing similar metabolic or phenotypic characteristics, we constructed a classification tree for various microbes capable of photosynthesis . though all harvesting energy from light, these  <dig> organisms belong to six different phyla. as shown in figure  <dig>  clearly, microbes in the same phyla are clustered together. since there were no non-photosynthesizing microorganisms serving as references for our classification method, the results demonstrated that metabolic or phenotypic similarities would not blurred the focus of our probe-based classifier -- which would first classify microorganisms according to their phylogenetic relationships at higher classification levels and then distinguish them based on their functional similarities at finer levels.

influences of horizontal gene transfer on classification quality of the proposed method
due to the dynamic nature of microbial genomes, horizontal gene transfer  often occurs  <cit> . as a result, proteome-based strategies to build classification trees may be vulnerable to the influence of foreign genes. to determine to what extent the hgt phenomenon would influence the classification results of our method, we compared two proteomic trees that it generated -- one contained hgt genes while the other did not. hgt database is a database of microorganisms that bear hgt genes  <cit> . we first constructed a hgt-genes-containing probe-set classification tree, tree hgt+, for all the  <dig> species recorded in the hgt database . next, from the genomes of the same  <dig> species we removed all potential hgt genes determined by the hgt database. these hgt-genes-filtrated genomes were subjected to our tree-construction procedure and produced tree hgt- . since there is no convenient method for comparing the similarities between large classification trees like tree hgt+ and tree hgt-, we developed a method to quantitatively describe the topological similarity between two classification trees as a correlation coefficient  of their leaf-to-leaf traveling distance matrices . a high degree of similarity between trees results in a high cc value. the cc value for two exactly the same trees is  <dig>  theoretically, two randomly-constructed trees have a cc value of  <dig>  the cc between tree hgt+ and tree hgt- was very high . as shown in additional file  <dig>  in which different colors were labelled to different groups of organisms, the grouping of organisms  on the hgt+ and hgt- trees are highly similar, implying that the existence or inexistence of hgt genes did not significantly influence the classification quality of the proposed method.

simulated testing of organisms with incomplete genomes
genome sequencing methods often split contiguous sequences into thousands of fragments that must be recombined in the correct order according to overlapping regions. reconstructing an entire dna genome is not trivial and there are many publicly available genomic sequences still incomplete. compositional analysis, which is the main concept behind the proposed probe-set method, represents a possible solution for analyzing incomplete genomic sequences. in this study, we simulated two scenarios to assess the reliability of the probe-set method in dealing with incomplete genomes.

first, we randomly selected three strains from each phylogenetic class of microorganism and constructed a reference classification tree of  <dig> species. for each species, we performed random truncation of its proteome  before reconstructing a new classification tree. if the topology of the new tree was exactly the same as the reference tree, a precise classification was recorded. after every species was tested, the accuracy of reclassification was computed as the number of precise classifications divided by  <dig>  at any given extent of truncation, this random truncation experiment was repeated  <dig> times to obtain the average and standard deviation values of the accuracy. the average accuracy values with various extents of truncation are illustrated in figure 8a. notably, even if only 50% of the genome was retained, an average accuracy of 94% could still be achieved, proving that the probe-set method has good fault tolerance.

next, we performed a more stringent assessment, in which every of the  <dig> species was randomly truncated before reconstructing the classification tree. the topological similarity between the reconstructed tree and the reference tree was quantified as a cc value as described in the above subsection. as shown in figure 8b, the probe-set method does not require full amount of information to obtain good classification results; the cc value for the reconstructed tree with 50% truncated genomes was ~ <dig> . the high accuracy and cc values obtained in these truncation tests imply that the probe-set method represents a potential and convenient tool for microbial taxonomy, particularly for species whose genomes have not been completely sequenced.

an example of incomplete genome: leptospirillum ferrodiazotrophum
l. ferrodiazotrophum is a small nitrogen-fixing bacterium living in acidic environments and using ferrous iron as the only electron donor to perform chemolithotrophic activities  <cit> . it was isolated from an environmental sample by a metagenomics project  <cit> , and a fully sequenced genome of this strain is not available yet. only  <dig> genomic scaffolds  and one 16s ribosomal rna gene of this species could be downloaded from genebank. taken together, these scaffolds were ~ <dig>  kb in length and contained  <dig>  annotated protein sequences. the phylogenetic position of this species is phylum nitrospirae, which contains only one completed genome sequence . figure  <dig> demonstrates the clustering results for all nitrogen-fixing bacteria recorded in the gold database. as expected, l. ferrodiazotrophum, even with its genome sequence incomplete, was clustered with t. yellowstonii, properly reflecting their closeness in phylogenetic relationship. based on this real case, the probe-set method proved again its effectiveness in classifying species with incomplete genome sequences.

discussion
advantages of the probe-set method
a classification method with a combinative nature
due to the immense diversity of microbial morphologies distributed in various living environments, classification strategies for the microorganisms based on wet-lab techniques may be costly, time-consuming and thus inefficient when compared with strategies based on computation. classification methods with different properties and emphases have been proposed. phenetic classification methods classify microbes according to measurable features such as cell shape, staining properties, and metabolic characteristics  <cit> . proteomic comparisons based on two-dimensional polyacrylamide gel electrophoresis were also applied to distinguish closely-related species  <cit> . biomarkers, e.g., the 16s rrna genes, cytochrome c, and atpases, are used as molecular clocks to elucidate the evolutionary history of species  <cit> . approaches such as whole genome alignment  <cit>  and gene ordering analysis  <cit>  construct phylogenetic trees from a genomic point of view. the proposed probe-set method focuses on expressible information contained in the genome and thus its classification emphasizes the functional relationships among species. in order to comprehensively understand the evolutionary relationships among organisms, several attempts have been made to combine all existing classification methods, such as the polyphasic taxonomy introduced by colwell  <cit>  and refined by vandamme et al.  <cit> . polyphasic taxonomy researches classify organisms based on their phenotypes, genotypes, and chemotaxonomic characteristics and the results suggested that any single feature or biomarker is insufficient to properly classify organisms at every level of taxonomy  <cit> . since the proposed probe-set method utilizes almost all currently known consensus protein sequence patterns to perform classification, its combinative nature may make it a good alternative and comprehensive way to classify microorganisms.

a classification revealing metabolic phenotypic similarities
in our large-scale proteomic tree, the positions of several species differed significantly from their positions in the traditional taxonomic classification tree, which is established according to the similarities of 16s rrna genes. compared with the classifications based on 16s rrna genes, our method tends to classify organisms according to the similarities of their metabolic capabilities . a metabolic capability of an organism is made possible by the cooperation of many genes, the existence of which, as we supposed, may be revealed by the composition of genome of the organism. indeed, as shown in figure 1b, the probe-set compositions of various metabolic pathways can be very different. since the proposed probe-set method classifies organisms according to their genomic compositional differences, this method should be able to detect the genomic differences correlated with the metabolic capabilities of organisms.

possible applications
large-scale and whole genome-based clustering
the probe-set method compares genomes by transforming the coding sequences into probe frequency patterns and then clustering them. the clustering of these frequency patterns is much simpler than performing multiple sequence alignment of whole microbial genomes. the probe-set classification takes only  <dig>  minutes to build a large proteomic tree containing  <dig> organisms on a computer with an intel xeon  <dig>  ghz processor and  <dig> gb memory. this high speed makes the proposed method well applicable to perform large-scale classification of microorganisms. moreover, the proposed method compares organisms based on information extracted from their whole genomes and thus considers more function-related characteristics than traditional phylogenetic analyzing strategies do. the example shown in figure  <dig> has well demonstrated that lactobacteria, the functional differences of which can not be detected by the traditional  <dig> rrna-based method, are classified according to their fermentative capabilities.

classification of incomplete genomes
computing the probe frequencies uses only the coding regions of a genome sequence. it is now possible to obtain these coding sequences directly by using next generation sequencing technologies . instead of completed whole genome sequences, the contigs of genomes or transcriptomes assembled by ngs can be the source data for the probe-set method. there are more than two thousand whole genome sequencing  projects, and over half of the genomes handled by them are still in the contig form . this situation is probably caused by the fact that sequence assembly is a highly complex problem and may be the current bottleneck of wgs. without well assembled genome sequences, conventional whole genome comparison methods, such as whole genome alignments, might not be applicable. we have proven that the probe-set method can highly correctly classify incomplete genome sequences . besides, this method possesses an order-independent nature, which means that even the order of contigs of a genome is unknown, the probe-set frequencies of the genome can still be accurately obtained. thus, as the ngs and wgs fields continue to increase the number of microorganisms being sequenced, the proposed method can be a useful method for the phylogenetic or functional analyses of organisms either with or without complete genome sequences.

tree comparison method
the tree comparison method designed in this study measures the topological similarity between classification trees. we suppose that this method can be utilized as a standard procedure for tree comparisons. to measure the similarity/difference between phylogenetic trees constructed with different methods, or to quantify how well a tree reconstructs the relationships in phylogeny, metabolism or community among organisms involves tree comparisons. previously, such comparisons were often done manually, lacking a quantitative measure. however, manual comparison is applicable only when the number of organisms is small. the tree comparison method that we developed is well applicable for big trees with hundreds, thousands or more organisms, facilitating the development and evaluation of future tree construction methods. for instance, in the hgt-removing experiment , where trees constructed with and without hgt genes were subjected to our tree comparison procedure, the similarities between trees were clearly revealed.

future work
at present we utilized all available probes provided by the prosite, except for the highly frequent ones  to develop our probe-set based classification method. however, it is likely that some probes contribute little to the classification power of the proposed method. we have planned to establish a reduced version of the current probe-set by perhaps removing some highly infrequent probes or performing some critical factor analyses to identify the probes that exert major effects on the classification power. in addition to classifying microorganisms, the probe-set may also be applied to the identification of microorganisms with specific metabolic properties or phenotypes. for example, two microbial groups with opposite biological characteristics, e.g., nitrogen-fixing and non-nitrogen-fixing organisms, can be put together to compare their probe frequencies. the probes with significant difference in occurring frequency between the two groups may serve as good markers for detecting the nitrogen-fixing ability of other organisms.

so far, we have not considered the non-coding region of a genome when implementing the probe-set method. however, many regulatory sequences in a genome are not translated into proteins while they may still be functionally and evolutionarily important. for instance, some rnas, such as ribozymes, act as enzymes. the 5' and 3' untranslated regions of messenger rnas often contain sequence conserved regulatory elements  <cit> . integrating these regulatory sequences and functional non-coding rnas to the probe-set expands the source of information for species classification from the proteome level to the transcriptome level. this expansion is supposed to improve the comprehensiveness of the classifications.

CONCLUSIONS
a classification method has been purposed to classify microbial genomes. a set of probes  are used to encode microbial genomes into frequency patterns. the classification is achieved by hierarchical clustering of these frequency patterns. the method itself is a kind of compositional analysis which features computational inexpensiveness and high fault tolerance. this method can classify hundreds of genomes in minutes. its classification results agree well with the phylogenetic relationships of microorganisms at higher classification levels, and clearly reflect the functional similarities among microorganisms at finer classification levels. importantly, complete genome sequences are not the requisite for our method to obtain reliable results. in this post genomic era, when the amount of genome sequence data increases so rapidly, the high efficiency and novelty of the proposed method make it feasible for large scale classifications of microorganisms and phylogenetic studies of species with similar metabolic properties or incomplete genome sequences.

