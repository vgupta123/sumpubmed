BACKGROUND
recent advancements in molecular biology technologies, systems biology, and computational toxicology are poised to transform a primarily in vivo animal toxicity testing paradigm into a new one dominated by in vitro assays  <cit> . this new paradigm makes predictions and cross-species extrapolation based on modes or mechanisms of action . however, many challenges remain before this transformation turns into a reality, including:  how to incorporate toxicity mechanism information into the next generation risk assessment framework,  how to obtain quantitative dose-response and time-course data on the perturbed biological processes or pathways, and  how to differentiate transient adaptive perturbations from permanent alterations  <cit> . current moa approaches mostly focus on identification of differentially expressed genes in canonical pathways. although some efforts have been made to infer non-observable transcriptomic effect levels  or transcriptional benchmark dose values  <cit> , little has been done to investigate gene interaction alterations in toxicity pathways  that are often inferred from time series gene expression profiling data using reverse engineering techniques such as a state-space model with hidden variables  <cit> .

to address some of the aforesaid challenges, we conducted a proof-of-concept study using a simple and convenient prokaryotic model organism, escherichia coli, in order to make a direct connection between moas and quantitative risk assessment   <cit> . in this study, e. coli was exposed to a chemical stressor of three concentrations, and we hypothesized that in stress response:  the bacterium had to reassemble biological pathways that differed from their canonical counterparts, and  the degree of pathway perturbation was dependent on the exposed concentration. we chose e. coli as the test organism also because a microbial live cell reporter array system was constructed recently from its k <dig> strain mg <dig>  <cit> . this system contained a genome-wide library of modified green fluorescent protein  expressing promoter reporter vectors. live cell array  is a novel technology that enables the acquisition of high-resolution time-series profiles of bacterial gene expression by measuring the fluorescence level in living cells carrying fused fluorescent protein  <cit> . this genome-wide e. coli lca has been used to study moas of a wide variety of chemicals  <cit>  and was used in our study to collect time-course gene expression data  <cit> .

here, we report a novel differential networks  approach we developed to derive a toxicity threshold based on the degree of perturbations in reconstructed gene interaction networks. our approach consists of the following six steps:  collect time-series gene expression data of test organisms that received different treatments,  identify significantly changed genes involved in normal cellular growth and stress response from the gene expression dataset,  reconstruct interaction networks of the altered genes under the control and perturbed/treated conditions using reverse engineering techniques,  infer differential edges, i.e., interactions gained or lost from the control to the treated, to construct dns,  annotate and map the genes in the dns to biological pathways and functions, and  establish concentration-pathway perturbation causal relationships. using this approach we made direct connections between treatment dosage and perturbed pathways.

methods
live cell array  system
lca is a new technology that quantitatively measures the real-time gene expression. it is based on the molecular fusion of a reporting gene system to gene promoters from select stress response regulons. compared with oligonucleotide hybridization-based microarray technology  <cit> , lcas avoid complex protocols of pre-treatment and high-cost experimental materials, have less interference, and require less testing time  <cit> . it involves the generation of a large number of strains that contain transcriptional fusions with fast-folding gfps and monitoring their accumulation under some certain treatments  <cit> . an advantage of using bacteria as the organism for lcas is the ease by which they can be genetically engineered to respond by a dose-dependent signal to environmental stimuli  <cit> . the promoter activity profiles of individual gfp fusions can be obtained at a very high resolution in a microtiter plate format by determining the difference in fluorescence levels at successive time points after the chemical is administered. promoter activation or suppression can be easily detected by an increase or a decrease in the fluorescence accumulation rate.

collection of e. coli lca time-series dataset
a time-series dataset of dynamic gene expression profiling used in this study was collected in a previous study  <cit>  using the genome-wide e. coli lca made up of twenty-one 96-well plates. among these  <dig> wells,  <dig> wells were occupied by  <dig> gfp strains with promoter genes , another  <dig> wells were filled with strains with two promoterless genes, and the remaining  <dig> wells were empty. the standard deviations of the expression values of two promoterless genes were later used to correct for background noise in data normalization steps  <cit> . there was one empty well on each of the first  <dig> plates and  <dig> empty wells on the last plate. these empty wells were used to set the cut-offs in the active gene selection step . optical density  values were measured before treatment. then the e. coli cells received four treatments of a technical mixture of naphthenic acids , i.e.,  <dig> ,  <dig>   <dig>  or  <dig> mg/l of nas. the fluorescence levels of all  <dig> wells were measured every  <dig> min for three hours, resulting in a dataset of  <dig> time points. the entire experiment was performed once without any repeat.

data pre-processing
the direct estimation of promoter activities from the time-series profile of the fluorescence level change contains high levels of noise  <cit> . therefore, a series of pre-processing procedure needs to be done to correct for noise. first, raw gfp readings were divided by the od values measured before treatment. od values reflected the population density of e. coli cells in a well before initiation of a treatment. because the number of cells in each well might be different due to cell growth, by dividing gfp with od, we got a preliminary value that reflected the activity of our target genes. then, the result matrix was smoothed by calculating the moving average of every neighbouring three time points. a possible low level of auto-fluorescence of e. coli might bring some background noise. to eliminate this type of background noise, the gfp expression produced by the eight promoterless plasmid values were averaged  and subtracted from the values of each gene at the corresponding time point in both experimental and control tests.

because the promoter activity of each gene might be different at the onset of the experiment, the values of the same gene at time point one in four treatments were averaged, and the differences between the averages and each of the  <dig> values were calculated. then, the differences were subtracted from the values of each gene at all of the subsequent time points to eliminate the internal measurement noise. in order to filter the system noise, any value was set to zero if it was less than twice the amount of the standard deviation of the aforementioned processed promoterless values.

identification of differentially expressed  genes
de genes are often sought in genomic studies as they are potential candidates of biomarkers. different from studies where gene expression is measured at a single time point, time-series experiments have two types of de genes: type i: active genes that display differential expression within the same treatment across different time points over the entire course of experiment, and type ii: de genes whose expression vary significantly between different treatments at any given time point. in this study, we identified the first type of de genes  using a one-sample gaussian process  regression method developed by  <cit> . in the gp regression model, the continuous trajectory estimation of a gene expression was treated as an interpolation problem on functions of one dimension, given the observations . subsequently, the differential expression of the gene's profile was assigned a marginal log-likelihood ratio by which it was ranked. in the ranking list, the wells with no e. coli cells  served as cutoff points. those genes that ranked higher than the highest ranked empty wells in any of the four treatments were included in the active gene list.

the second type of de genes was identified in the previous study  <cit>  by applying a linear regression model and a cutoff of  <dig> -fold change in gene expression at one or more time points between the control and at least one of the three concentrations. these two types of de genes were pooled together to form the final list of de genes.

reconstruction of gene interaction networks
an in-house developed bayesian learning and optimization model  was used to reconstruct a network of interaction between the identified de genes for each of the four treatments. blom was based on the state space model with hidden variables and an expectation-maximization algorithm to estimate model parameters . pre-processed expression data of the identified de genes were used as the input for blom. like other reverse engineering models such as dynamic bayesian network  and probabilistic boolean network , the outcome of blom-reconstructed networks is an n Ã— n matrix of connectivity  between two genes with n being the number of nodes/genes. the connectivity is expressed as confidence level in the form of direction , action type  and strength . the reconstructed networks were visualized using cytoscape v. <dig> . <dig>  <cit> .

inference of differential edges to build differential networks
the reconstructed networks of all three chemical treatments  were compared pair-wise with that of the control to derive differential edges, i.e., edges lost or gained from the control to the chemically treated. from the comparison, the following statistics were obtained for each de gene: total number of edges in each of the four networks, number of gained or lost edges in the treatment networks, and the percentage of edges changed in the treatment networks. lost edges are those present in the control network but absent in the low, mid, or high concentration network, whereas gained edges are those absent in the control network but present in the chemical treatment network. the following formula was used to calculate the percentage of edges changed as a result of chemical exposure: /. the changed edges  of all involved de genes were used to construct differential networks for the three chemical treatments.

functional annotation and pathway mapping of altered genes
gene ontology  terms provide information on molecular function, biological processes and cellular component of a gene product. one gene may have multiple go terms associated with it. the go tool at http://www.ecogene.org was used to assign go terms to the genes of interest . for pathway mapping, we searched the ecocyc  <cit> , kegg pathway  <cit>  and regulondb  <cit>  databases. the pathway tools software v. <dig>   <cit>  was used to extract pathway mapping information from the ecocyc database.

RESULTS
identified de genes
de genes were statistically identified from the time-series gene expression dataset collected using the genome-wide e. coli lca. a total of  <dig>   <dig>   <dig>  and  <dig> genes were identified as active genes  for the control, low, mid, and high concentrations of nas exposure respectively, using the gp regression method . after excluding duplicated genes, there were  <dig> unique active genes. these genes were pooled together with a group of  <dig> type ii de genes previously identified using a linear regression model and a  <dig> -fold gene expression change filter  <cit> . this resulted in a final list of  <dig> unique de genes, with  <dig> genes appearing in both type i and type ii de gene lists .

reconstructed interaction networks of de genes
four interaction networks of  <dig> nodes  were reconstructed using blom, one for each treatment. each network had  <dig>  edges, which were ranked by their strength  . obviously, the ~31k edges are not equally important and should not be treated equally. the higher an edge ranks, the more likely it actually exists. in selecting edges for further analysis, a cut-off level can be set for either the total number of top edges per network or the lowest edge strength allowable in a network. the latest release of ecocyc database  curated  <dig> reactions catalyzed by  <dig> enzymes that are encoded by  <dig> e. coli transcription units , suggesting that the average number of interactions per gene might be very low. we have also observed that the total number of edges in a real-world gene interaction network  generally does not exceed four times the total number of its nodes . furthermore, we plotted four histograms to show edge strength against edge rank . in the four reconstructed networks, the top ranked  <dig> edges  accounted for ~30% of the total strength of all ~31k edges, and the edge strength declined by 94% from the 1st ranked edge to the 704th edge . therefore, we selected the top  <dig> edges per network for further differential edges inference and differential network construction.

differential edges and differential networks
linking pathway alteration to toxicity threshold
the  <dig> genes possessing a significant number of differential edges were mapped to biological pathways curated in kegg and ecocyc databases as well as to go terms . all but  <dig> genes were mapped to  <dig> kegg pathways. to link pathway alterations to toxicity thresholds, we determined the pathway perturbation degree as the average percentage of edge change per gene for all de genes involved in any particular kegg pathway at each exposure concentration . a toxicity threshold was defined herein as the concentration at which no pathways were perturbed relative to controls.

the limited number of concentrations that e. coli cells were exposed to and the lack of independent treatment replications in the current study prevented a statistical approach to deriving toxicity thresholds from pathway perturbation degrees. therefore, for purposes of proof of concept, we established a simplified causal relationship between concentration and pathway perturbation, which was defined as the perturbation degree at the high concentration being higher than that at both the mid and the low concentrations. twenty-two perturbed pathways met this definition . these pathways varied substantially in the size of identified de genes, from one gene in pyruvate metabolism to  <dig> genes in ribosome. the perturbation degree varied from  <dig>  to  <dig> .

twenty-two kegg pathways were identified as being altered in a concentration-dependent manner by exposure to nas . the perturbation degree was determined as the average percentage edge change per gene for all genes involved in a particular pathway, and concentration-dependence was defined as high > mid and high > low in perturbation degree. note that perturbation degrees are expressed in decimals instead of percentages.

even at the low chemical concentration, some pathways were altered to a degree of 50% to 70%, including biosynthesis of amino acids, secondary metabolites, and aminoacyl-trna, as well as nitrogen, amino sugar and nucleotide sugar metabolism . therefore, the toxicity threshold for nas would be considered lower than the lowest exposure concentration,  <dig> mg/l. while compensatory responses in metabolism or biosynthesis may occur at low chemical concentrations, this suggests that pathway perturbations can be a sensitive endpoint for toxicity if additional evidence links the perturbed pathways to adverse outcomes at the physiological, organismal or population level. a more refined toxicity threshold could be derived using regression approaches such as a benchmark dose method  <cit>  if more concentrations were tested in addition to more replications per treatment.

discussion
cellular exposure to toxicants often results in pathway alterations reflected as changes in gene expression regulation and gene interactions. such information is often used to elucidate toxicological modes of action. from a risk assessment perspective, alterations in biological pathways are a rich resource for setting toxicant thresholds, which may be more sensitive and mechanism-informed than traditional toxicity endpoints. here we reported a proof-of concept study to connect pathway perturbation with toxicity threshold setting using the dns approach to analyzing time-series gene expression datasets.

studies involving gene expression profiling at a single time point have limited power in both deciphering moas and quantitative risk assessment because the snapshot of gene expression profiling misses the dynamic and interactive nature of cellular gene expression. as the costs of acquiring genome-wide gene expression technologies steadily decrease, it has become more feasible and affordable to perform time-series gene expression studies  at http://www.ncbi.nlm.nih.gov/geo and arrayexpress at http://www.ebi.ac.uk/arrayexpress/ for large-scale time-series datasets). in order to take advantages of technological advancements in high throughput microarray, dna sequencing and lca, novel experimental and computational approaches are needed to transform conventional toxicology to predictive toxicity in order to meet the requirements of more rapidly assessing toxicity of chemicals and other materials to humans and animals in the 21st century risk assessment  <cit> .

a distinction has to be made between edges in the graphical representation of a literature curation-based biological pathway  and those derived in silico from time-course data. the former are experimentally validated interactions, whereas the latter represent potential gene-gene interactions. it was not our intention to estimate the accuracy of our blom-inferred edges by comparing them with those gene-gene interactions curated in kegg pathways or ecocyc databases, but rather to use the inferred edges to provide an estimate of the overall degree of alteration in a gene's interaction/connectivity with other genes.

our dns approach differs significantly from existing de gene-based approaches such as the gene set enrichment analysis  method  <cit>  and the genomic benchmark dose method  <cit>  in at least three aspects:  our approach is based on reverse engineering techniques including blom, pbn and dbn;  significantly altered pathways are identified through analysis of dns instead of enrichment of de genes mapped to canonical pathways; and  our approach is particularly suitable for analyzing time-series gene expression datasets whereas existing approaches like gsea are suitable for static datasets often collected at a single time point.

while the current proof-of-concept study demonstrates that our dns approach is capable of identifying perturbed pathways in relation to chemical exposure, several caveats remain to be resolved. first, no analytical chemistry work was carried out in the study to confirm the concentration and/or biotransformation of nas throughout the 3-hr exposure. many xenobiotic toxicants such as polycyclic aromatic hydrocarbons, aryl and heterocyclic amines require metabolic activation by cytochrome p <dig> metabolism  <cit> . chemical analysis, in parallel to bioassays, can provide useful information about the chemical of concern for toxicity threshold derivation. second, as the time-course dataset used in this study lacks treatment replication, the derived degrees of pathway perturbation  are statistically inadequate to determine a point of departure or toxicity threshold for each perturbed pathway. this limitation can be ameliorated by incorporating more treatments and treatment replications into the experimental design. third, no apical endpoints such as physiology or biochemistry assays were measured, which would have permitted linkage of the derived lowest observable pathway perturbation concentrations to toxicity thresholds derived from apical endpoints and hence applicable to chemical risk assessment  <cit> . finally, while the e. coli lca system is a very rapid approach to assessing impacts on biological pathways, it is not free from limitations. for instance, less than 50% of known transcriptional genes have a promoter that can be fused with a gfp  <cit> , leading to an incomplete genome coverage. alternative high-throughput technologies such as dna microarray and next-generation sequencing can be used to generate genome-wide time-series gene expression dataset.

CONCLUSIONS
findings from this proof-of-concept study suggest that our approach has a great potential in providing a novel and sensitive tool for threshold setting in chemical risk assessment. in future work, we plan to analyze more time-series datasets with a full spectrum of concentrations and sufficient replications per treatment, and eventually extrapolate our approach from prokaryotic systems to eukaryotes. the pathway alteration-derived thresholds will also be compared with those derived from apical toxicology, biochemistry and physiology endpoints such as cell growth rate.

competing interests
the authors declare that they have no competing interests.

authors' contributions
pg conceived the project and designed the approach. yy conducted gene selection, network reconstruction and comparison, and gene functional annotation. xz provided the live cell experimental data. xz and am participated in data pre-processing and analysis. pg, cz and nw supervised this work. yy, pg and am drafted the manuscript. pg, ejp, xz, cz and nw revised the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
differentially expressed genes. breakdown of the two types of differentially expressed genes

click here for file

 additional file 2
gene connectivity. connectivity between  <dig> genes in four networks reconstructed from the control e. coli cells and those treated with  <dig>   <dig> and  <dig> mg/l naphthenic acids

click here for file

 additional file 3
differential edges. statistics on differential edges derived by pair-wise comparison between the top  <dig> edges of the four reconstructed networks 

click here for file

 additional file 4
pathway mapping. annotation, go terms and pathway mapping to ecocyc and kegg pathway databases for  <dig> select genes with at least  <dig> differential edges in any of the three differential networks

click here for file

 additional file 5
pathway perturbation. pathway perturbation was determined as the average percentage in edge change per gene of all genes involved in a particular pathway.

click here for file

 acknowledgements
this collaborative work was partly supported by an nsf epscor  grant to cz and nw. xz acknowledges financial support from the new century excellent talents in universities program funded by the chinese ministry of education. pg and ejp were funded by the u.s. army environment quality and installations program under a focus area project "impact of munitions constituents on biological networks" and a basic research project "population-level temporal drift in sensitivity to army relevant chemicals: phenotypic plasticity or genetic variation?". permission to publish this information was granted by the chief of engineers.

declarations
funding for publication of the article came from nsf epscor .

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2013: proceedings of the tenth annual mcbios conference. discovery in a sea of data. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/14/s <dig> 
