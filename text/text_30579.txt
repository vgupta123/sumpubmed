BACKGROUND
the number of sequenced and annotated genomes is rapidly increasing. there are currently  <dig> published genomes and  <dig> genome sequencing projects underway  <cit> . of those underway, over  <dig> are eukaryotic, genomes whose large size and intron-containing genes complicate annotation. even assuming as few as  <dig>  genes/genome, these new eukaryotic genomes alone will add more than nine million annotations to genbank. tools to manage and analyze these gene annotations are badly needed. consider too that next-generation sequencing technologies will soon make it possible for individual labs to sequence and annotate genomes, thus the number of gene annotations could well exceed one billion in a few years time.

gene annotations are not static entities, and how to best mange them is a complex and challenging problem. gene annotations must be tracked from release to release, and problematic annotations identified, reviewed and modified. by nature this is a comparative process. standardization of formats and database schemas has helped matters greatly. the sequence ontology  <cit>  and gmod projects  <cit> , for example, provide tools and standards that promote database interoperability. this in turn has made possible common formats for data exchange such as chado xml  <cit>  and gff <dig>  <cit> . the result has been an ever-proliferating number of groups annotating and redistributing their own annotations, independent of the annotation pipelines used by genbank. examples include not only model organism databases such as c. elegans, and d. melanogaster but also emerging model organisms such as the planarian s. mediterranea  <cit> . the growing numbers of annotation providers – and users – is creating a pressing need for tools and techniques for gene annotation management and analysis.

today, most annotation management and comparison at the whole-genome scale is restricted to analyses of basic traits – for example differences between releases are usually evaluated in terms of gene and transcript numbers  <cit> . though indisputably useful, these simple statistics only tell part of the story. comparisons of different genomes' annotations also suffer from a paucity of measures, with most studies restricted to analyses of protein alignments  <cit> . here too, new measures of comparison are needed, measures that move beyond the amino acid sequences and take into account other aspects of the annotations such as similarities in intron-exon structures and patterns of alternative splicing.

some previous work has been done in this area. the sequence ontology project  <cit> , for example, has created a categorization system for alternative splicing that can identify problematic annotations for later manual review. the debd  <cit>  and astra  <cit>  projects have also proposed genome-wide categorizations of alternative splicing using graph-based approaches. in principle these classification systems could be used for whole-genome annotation management, but to our knowledge they have not yet been applied for this purpose. furthermore, useful as qualitative classification systems are, quantitative metrics are also needed – measures akin to the sensitivity, specificity and accuracy metrics used by the gene-prediction community to evaluate gene-finder performance  <cit> . these measures have seen wide use  <cit> . however, they also have recognized shortcomings. indeed, the recent egasp contest concluded with a call for new performance measures for alternative splicing and utr prediction  <cit> . moreover, these measures are designed for evaluating gene-prediction algorithms. the problems faced in annotation management are similar in spirit, but distinct enough to require different measures and software. in response to these issues, we have formulated a set of metrics for annotation comparison.

we introduce two new measures to evaluate changes to annotations across releases: annotation turnover, and annotation edit distance. annotation turnover tracks the addition and deletion of gene annotations from release to release. we show that tracking annotations in this manner supplements traditional gene and transcript counts, allowing the detection of 'resurrection events' – cases where an annotation is created in one release, later deleted, and then after a lapse of one or more releases a new annotation is created at the old genomic location, with no reference to the previous annotation.

we use a second, complementary, measure, called annotation edit distance  to quantify the changes to individual annotations from release to release. aed is similar to performance measures employed by the gene-prediction community, but takes into account aspects of annotations not well addressed by conventional sensitivity/specificity measures  <cit>  such as alternative splicing. aed complements annotation turnover and gene and transcript numbers in that it measures structural changes to an annotation. two releases can differ dramatically from one another, with every annotation's intron-exon structure having been revised, yet still have identical gene and transcript numbers and no annotation turnover; aed provides a means to distinguish between a new release with no changes, and one wherein the intron-exon coordinates alone have been altered. moreover, it provides a means to quantify the extent of these changes.

we also introduce a new measure for quantifying the complexity of alternative splicing, which we call splice complexity. those in the field of gene annotation often speak of one gene as having a more complex pattern of alternative spicing than another. for example, a gene with  <dig> transcripts, each with different combinations of exons, is said to be more complex than a gene producing two transcripts that differ from one another by only a few nucleotides at their 5' ends. splice complexity provides a means to quantify transcriptional complexity; moreover, because it is independent of sequence homology, splice complexity can be used to compare any alternatively spliced gene to any other. this makes possible novel, global comparisons of alternate splicing across genomes. we have used splice complexity in conjunction with a classification scheme for alternatively spliced genes developed by the sequence ontology project  <cit>  in order to obtain a global perspective on alternative splicing in different genomes. these novel analyses suggest that the complexity and mode of alternative splicing varies considerably amongst the different genomes in our collection.

in total we have analyzed over  <dig>  annotations in this study. to our knowledge this is the largest meta-analysis of gene annotations ever undertaken. our results reveal both global differences among the annotations of different genomes and unexpected similarities – demonstrating the utility of these new measures for whole-genome annotation management and for comparative genomics studies.

RESULTS
our analyses fall into two classes – intra-genome comparisons of annotations that track and summarize genome-wide changes in annotations from release to release, and inter-genome comparisons that compare and contrast the annotations of different genomes to one another. we chose five annotated genomes for these analyses: homo sapiens, mus musculus, drosophila melanogaster, anopheles gambiae, and caenorhabditis elegans. for d. melanogaster and c. elegans we used gff <dig>  <cit>  releases from flybase  <cit>  and wormbase  <cit>  respectively. for h. sapiens, mus. musculus and a. gambiae we used genbank releases  <cit> . we also took practical issues into account when choosing which releases to analyze, such as completeness, and usability. the early gff <dig> releases of flybase and wormbase, for example, were alpha releases designed to troubleshoot the release process; in some cases this precluded effective analyses of some aspects of their contents. in total we analyzed six human genbank releases , five m. musculus genbank releases , four d. melanogaster flybase releases , and five c. elegans wormbase releases . we also included an a. gambiae release  from genbank in some of our analyses. see additional file  <dig> for details of the dataset.

annotation edit distance
we used a measure we term annotation edit distance  to quantify the amount of change to individual annotations between releases . in order to measure rates of annotation revision independently of changes to the underlying assembly, we excluded from these calculations any annotation version-pair with changes to the underlying genomic sequence . figure  <dig> summarizes the total amount of annotation revision between releases for four of the genomes in our dataset. d. melanogaster is by far the most stable genome. though small numbers of new gene annotations have been added incrementally since release  <dig>  , the vast majority of its annotations have remained unchanged at the level of their transcript coordinates . overall, 94% the genes in the current release  have remained unaltered since  <dig>  and only  <dig> % have been altered more than once . the c. elegans genome, by comparison has undergone significant revision with each release. although gene and transcript numbers have changed by less than 3% since  <dig>  , 58% of annotations in the current release have been modified since  <dig>  32% more than once . it is also worth noting that although far fewer d. melanogaster annotations than c. elegans annotations were revised from release to release, the changes to d. melanogaster annotations tended to be of greater in magnitude ; the average aed/modified transcript for d. melanogaster was  <dig>  compared to  <dig>  for c. elegans.

columns: organism, number of genes modified at least once, number of genes in the most recent release, percentage of genes modified at some point it the past. c. elegans: release ws <dig>  annotations since ws <dig> . d. melanogaster; release r <dig>   annotations since r <dig>  . m. musculus; release  <dig>   annotations since  <dig> . h. sapiens release  <dig>   annotations since  <dig> .

the first column gives the number of revisions. time intervals are the same as those in table  <dig>  because not every gene could be identified in every release, percentages do not exactly tally with those in table  <dig> 

average aed  for each transcript in the current release that has been modified at least once in its past. time intervals are the same as those in table  <dig> 

h. sapiens and m. musculus annotations are also undergoing considerable revision from release to release. 55% of current human annotations  have been modified at least once since  <dig>  with an average aed/revised transcript of  <dig> . substantial numbers of mouse annotations have also undergone revision. 29% of annotations in the release  <dig>   have been modified at least once since their creation. finally as figure  <dig> makes clear, mouse release  <dig>  is somewhat atypical in that no transcript coordinates were altered, though the cds coordinates of  <dig> transcripts were changed. in addition, release  <dig>  saw the deletion of  <dig> genes and  <dig> transcripts .

these results show how aed naturally supplements gene and transcript numbers. consideration of gene and transcript numbers alone, for example, would lead one to believe that the c. elegans and d. melanogaster annotations are both relatively static, when in fact the c. elegans annotations are evolving rapidly compared to those of d. melanogaster. considering aed in conjunction with gene and transcript counts also makes it clear that the dynamics of the two invertebrate annotation sets differ markedly from the vertebrate ones, which are characterized by large fluctuations in both gene and transcript numbers – and aed.

annotation turnover
we also measured annotation turnover – the addition and deletion of gene annotations from release to release . figure  <dig> summarizes annotation turnover from two perspectives: the red line shows the fraction of annotated genes in the current release that were present in prior releases; the blue line, the fraction of annotations in the first release still present in subsequent releases. for example, 92% of the annotations in the latest d. melanogaster release were present in release  <dig> . <dig> ; likewise 99% of annotations present in release  <dig>  still exist. these facts together with the low annotation edit distances characteristic of this genome show that since the omnibus release  <dig>  <cit> , changes have largely been due to the addition of modest numbers of new genes. the situation is similar for the c. elegans genome. it's annotations have undergone a low and balanced rate of annotation turnover: 95% of the ws <dig>  annotations still remained in one form or another as of the ws <dig> release , and 91% of the current annotations were present as long ago as ws <dig>  .

the h. sapiens and m. musculus genomes have undergone higher rates of annotation turnover than either of the two invertebrate genomes . less than 60% of annotations present in human release  <dig> and mouse release  <dig> were still in existence by the next release, e.g. human release  <dig>  and mouse release  <dig> . most of the turnover was due to annotation deletion: between april and october  <dig>  human gene counts fell by 28% , and between february and october  <dig> mouse gene numbers fell 20%. since this early clean up, mouse and human gene numbers have risen by 10%. interestingly, about  <dig> in  <dig>  of the new mouse genes are resurrections of release  <dig> annotations deleted from release 32; this is the underlying cause of the upward trend in blue line since release  <dig>  in figure  <dig> 

we also measured annotation turnover for the human and mouse refseq nm and nr annotations  <cit> . these are shown as dotted lines in the human and mouse panels in figure  <dig>  turnover rates for these curated annotations are much lower. for both genomes, over 95% of refseq nm and nrs present in the first releases in our collection  were still present in last . likewise, more than 90% of  <dig> human and mouse refseq nm and nrs were present as long ago as  <dig>  thus, the nms and nrs paint a very different picture of annotation turnover, one that closely resembles the c. elegans and d. melanogaster turnover data , making it clear that most of the turnover in human and mouse genomes has been due to addition and deletion of automatically generated annotations for which there is little experimental support.

alternative splicing
alternatively spliced genes pose special challenges for annotation efforts. because they are not predicted by most gene finders, and predicted with poor accuracy by those that do  <cit> , alternatively-spliced transcripts are generally the product of manual annotation efforts. as such, they provide an important indication of the extent and completeness of active curation efforts. 15% of human genes , 7% of mouse , 24% of d. melanogaster, 9% of mosquito, and 19% of c. elegans genes have more than one annotated transcript .

there has been a strong trend towards ever increasing numbers of alternatively spliced annotations from release to release for every genome in our collection . although this trend illustrates the growing focus on the annotation of alternatively spliced genes, it says nothing about how the contents of alternatively spliced annotations have evolved from release to release and how they differ between genomes. we have undertaken two analyses to address these points. first, we classified alternatively spliced annotations using a scheme developed by the sequence ontology. we also used a measure we term splice complexity  to quantify the complexity of each alternatively spliced annotation.

so-based classifications
we used a classification system developed by the sequence ontology group  <cit>  to characterize the alternatively spliced annotations in our collection of annotated genomes; this is the first application of this classification system to multiple genomes and releases. these data are summarized in figure 4b. the sequence ontology's classification system categorizes an alternatively spliced gene into one of seven modes based upon shared and unique exons among its transcripts  <cit>  . some classes of alternative splicing are especially indicative of errors in annotation. class n:0: <dig> genes, for example, have multiple transcripts that share no exon sequence in common. thus n:0: <dig> annotations are likely to be multiple genes, incorrectly merged into a single annotation. when considering n:0: <dig> annotations it is important to understand that even though when viewed in a genome browser these appear to be separate genes, they are – within the host database – a single gene. thus queries to the database to determine gene numbers, the number of alternatively spliced transcripts, etc are distorted by these mis-annotations. also suspect are 0:n: <dig> genes. none of these genes' transcripts share any exon coordinates precisely in common; hence, each transcript encodes a slightly different peptide. though a formal possibility, eilbeck et al  <cit>  suggest that 0:n: <dig> annotations should be subjected to manual review in order to make sure that their unusual patterns of alternative splicing are confirmed by est evidence.

previous work on the d. melanogaster genome  <cit>  has shown that the vast majority of its alternatively spliced genes belong to the 0:0:n class. we find that this trend also holds true for every genome in our collection . however, the m. musculus and a. gambiae genomes are enriched for problematic annotations: 33% of a. gambiae and 15% of m. musculus alternatively spliced genes, for example, consist of transcripts lacking any exon borders in common . the high percentage of such genes in the mus and anopheles genomes indicates that these annotations are in need of review, as many of them may be mis-annotated. conventional release statistics such as gene and transcript numbers or percentages of alt-spliced genes can never reveal trends such as these. thus, these results highlight the usefulness of the so classification scheme for annotation management.

splice complexity
to further characterize alternatively spliced genes, we developed a new measure that we term splice complexity. splice complexity provides a means to quantify  the complexity of a genome's alternatively spliced annotations; it thus naturally complements existing classification systems such as the sequence ontology's  <cit>  and graph-based splicing schemes  <cit> . the methods section describes in detail how splice complexity is calculated.

the top panel of figure  <dig> shows the distribution of splice complexities for the current release of each genome in our study. in order to better characterize these distributions, we also broke each genome's alternatively spliced annotations into  <dig> bins based upon their splice complexities and then categorized their contents using the so classification system . regardless of genome, annotations with low splice complexities per transcript-pair tend to fall disproportionately into the 0:0:n class, and as splice complexity increases there is a concomitant enrichment for problematic annotations that belong to the n:0: <dig>  and 0:n: <dig> classes. for, example, overall 8% of genes with splice complexities between  <dig>  and  <dig>  fall into the 0:n: <dig> class, whereas 31% of genes with splice complexities greater than  <dig>  fall into the 0:n: <dig> class. thus, alternatively spliced genes with high splice complexities tend to fall into classes that should be prioritized for manual review according to the sequence ontology classification system  <cit> .

interestingly, the h. sapiens, d. melanogaster and c. elegans alternatively spliced annotations all have very similar distributions of splice complexity, whereas the m. musculus and a. gambiae genomes are biased towards higher frequencies of splice- complex annotations . the so based classifications shown in the lower panel of figure  <dig> suggest an explanation for these differences. relative to the other three genomes, m. musculus and a. gambiae annotations tend to have higher splice complexities because they contain more annotations that belong to problematic so classes. moreover, the enrichment of these problematic classes grows steadily more pronounced as their splice complexity increases . these results once again illustrate the utility of our measures for annotation management and meta-analysis and how they complement the so schema – providing a global overview of an entire genome's alt-spliced genes and allowing the direct comparisons between genomes to reveal an excess of problematic – likely incorrect – annotations in mouse and mosquito genomes that should be subjected to manual review.

columns: organism, gene name, so classification code , number of transcripts, splice complexity .

conservation of alternative splicing
we also investigated how often alternative splicing was a trait shared among orthologous loci. est-based analyses have shown that alternative splicing tends to be conserved even over relatively large phylogenetic distances  <cit> . we examined to what extent the current crop of annotations capture this fact. we found that alternatively spliced orthologous pairs occur more frequently than would be expected by chance alone. the human-mouse odds ratio is  <dig> ; p <  <dig> . the melanogaster-gambiae odds ratio is  <dig> ; p <  <dig> . we also found a statistically significant correlation in the splice complexities of these orthologous pairs. the spearman correlation coefficient  <cit>  of the human-mouse alternatively spliced pairs is  <dig> ; p <  <dig> . it was  <dig> ; p <  <dig>  for melanogaster-gambiae alternatively-spliced orthologous pairs. table  <dig> gives human-mouse, and melanogaster-gambiae pairs  with the greatest differences in splice complexity. these facts suggest that the current crop of annotations has only begun to capture the repertory of alternatively spliced transcripts in each genome. the ability to identify pairs of orthologous genes with very different splice complexities provides a means to follow up on this hypothesis – further analysis of the member of the pair with the lower splice complexity may reveal additional transcripts, not yet annotated, or in cases where there are no missing transcripts, functional differences between the two orthologs.

columns: organism, gene name, so classification code , number of transcripts, splice complexity . the d. melanogaster – a. gambiae pair is shown in the top half of the table, the m. musculus – h. sapiens below. orthologous genes were identified using reciprocal best hit blastp searches.

discussion
we have used a variety of new approaches to investigate the annotations of five large eukaryotic genomes, four of them across multiple releases. our meta-analyses provide novel, global perspectives on the contents of more than  <dig>  annotations and their evolution over a period of several years. these analyses have brought to light previously unknown differences and unexpected similarities between their annotations, and allowed us to tease apart differences due in annotation practice from underlying biology. we have also shown how analyses combining splice complexity and the sequence ontology's classification system can be used to identify and prioritize likely mis-annotated genes for manual review.

our analyses of annotation turnover show that the h. sapiens and m. musculus annotations are characterized by very high rates of turnover. the major cause of turnover in both genomes appears to be due to incremental changes in the ncbi's annotation protocols, especially as regards pseudogene identification  <cit> . since  <dig>  far fewer annotations have been deleted from either vertebrate genome; and gene addition has been the dominant trend, some of these being resurrected from the earlier releases. this is especially true for mouse, wherein gene numbers rose by 17% between releases  <dig> and  <dig>  once again the cause appears to be changing annotation methodologies. between these two releases the ncbi's gene prediction program, gnomon, was altered to use a new repeat masking program and to incorporate protein alignments to the genome. this resulted in an increase in gene models in build  <dig> compared to build  <dig>   <cit> . for both vertebrate genomes, turnover of refseq  <cit>  nm and nr annotations has been much lower ; these form a stable core amid a continuous flux of more ephemeral annotations.

the high turnover rates characteristic of the human and mouse genomes stand in stark contrast to the more static d. melanogaster and c. elegans genomes. almost 99% of d. melanogaster annotations present in the omnibus  <dig>  release  <cit> , are still present in some form today. c. elegans gene numbers are also quite stable, with rates of gene addition and deletion almost balanced – 90% of annotations present in  <dig> were still present in  <dig>  and vice versa. the stability of gene numbers in both organisms is certainly not due to neglect. genome-wide searches for new protein coding genes followed by pcr-verification have been undertaken in both animals  <cit> .

we used annotation edit distance  to measure active curation independently of annotation turnover. whereas the d. melanogaster annotations are undergoing little revision, the c. elegans, h. sapiens and mus musculus annotations have undergone significant revision with each release. 58% of c elegans annotations and 55% of human annotations for example, have been altered since 2003; by comparison only 6% of d. melanogaster annotations have been altered during this time. these results show how annotation edit distance can be used to assess the intensity of annotation curation efforts among different databases.

our analyses of alternatively spliced genes indicate that these are incompletely annotated in every genome in our collection. despite the fact that alternate splicing is a trait frequently shared among orthologous genes  <cit> , this trend is poorly captured by the current crop of annotations. for example, estimates based on est data suggest that around 50% of d. melanogaster and a. gambiae alternative exons are conserved  <cit> . at time of writing, however, only  <dig> % of melanogaster-gambiae orthologous genes are alternatively spliced in both genomes. likewise, only  <dig> % of orthologous human-mouse annotations are alternatively spliced in both genomes, considerably less than the published estimate of 40% based upon est analyses  <cit> . we did, however, detect a weak but statistically significant tendency for human-mouse and melanogaster-gambiae orthologs to both be alternatively spliced when either member is. there is also a statistically significant correlation in their splice complexities. these facts suggest that the current crop of annotations have begun to capture the conserved aspects of alternative splicing, but that much progress remains possible. certainly, a rigorous review of alternative splicing patterns among orthologous genes could do much to improve the annotation of all four genomes.

our analyses using the sequence ontology classification system revealed genome specific differences in the frequencies of different modes of alternative splicing. m. musculus and a. gambiae, for example, are highly enriched for genes whose transcripts share no exon borders in common. our splice complexity based analyses complement these findings: unexpectedly, the human, c. elegans and d. melanogaster distributions are all very similar to one another despite the vast evolutionary distances separating these genomes . this may indicate that common selective forces govern the transcriptional complexity of alternative spliced genes. inconsistent with this hypothesis, however, the m. musculus and a. gambiae splice complexity distributions are skewed towards higher values due to enrichment for genes with unusual modes of alternative splicing. we believe that annotation quality, rather than biology is the likely cause of the skew towards higher splice complexities in these two genomes. if this explanation is correct, the mouse and mosquito distributions should converge upon those of the other three genomes as their annotations mature. but whatever the cause – mis-annotation or fundamental differences in biology – their in-silico identification is the first step toward review and experimental investigation of these unusual annotations.

CONCLUSIONS
although the information encoded in genomic dna provides a foundation for modern medicine, genome sequences in themselves are not very useful. their value is dependant upon identifying and annotating the genes they contain. incomplete and incorrect annotations poison every experiment that employs them. in light of these considerations, accurate and complete genome annotation seems a laudable and achievable goal, especially for model organisms. because the datasets are so large and complex, in silico methods for annotation management must necessarily play a major role in this process. in response, we have formulated three new measures for annotation management – annotation turnover, annotation edit distance and splice complexity – and used them to investigate the annotations of five genomes. our results show how these measures can be used to better monitor changes to a genome's annotations from release to release; to compare the magnitude of curation efforts among different genome databases; and to identify and prioritize problematic annotations for manual review.

