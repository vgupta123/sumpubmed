BACKGROUND
genotype information generated by individual and international efforts carries the promise of revolutionizing disease studies and the association of phenotypes with alleles and haplotypes. given the enormous amounts of public genotype data, tools for analyzing, interpreting and visualizing these data sets are of critical importance to researchers.

in past works we have developed the following analysis algorithms:

 <dig>  gerbil  <cit>  – an algorithm for simultaneously phasing genotypes into haplotypes and block partitioning. the algorithm is based on a stochastic model for recombination-poor regions , in which haplotypes are generated from a small number of core haplotypes, allowing for mutations, rare recombinations and errors. the genotype phasing and block partitioning is solved by an expectation-maximization algorithm. gerbil accepts genotype data as input and outputs the phased genotypes for each individual, the block structure of the entire population and the common haplotypes in each block. as part of the algorithm, gerbil also accurately completes missing data according to the common haplotypes found. gerbil was shown to be quick and accurate even for many hundreds of individuals  <cit> .

 <dig>  stampa  <cit>  – an algorithm for tag snp selection. the algorithm finds a set of tag snps with maximal prediction accuracy. the prediction accuracy of a set of tag snps is the expected accuracy of predicting untyped snps, given the tag snps. dynamic programming is used in order to efficiently find the set of tag snps. halperin et. al tested stampa on many different genotype datasets from different sources, and showed that it finds tag snps with considerably better prediction ability than two other state-of-the-art tag snp selection algorithms  <cit> .

both gerbil and stampa were available until now only as batch executables. in this work we introduce gevalt . gevalt  is an integrated software providing easy access to the gerbil and stampa algorithms as well as to some other tools for genotype analysis. gevalt is based on haploview version  <dig>   <cit>  and it maintains the user-friendly interface and strong visualization capabilities of haploview, as well as its other functionalities, including computation of marker quality statistics and ld information.

implementation
gevalt is implemented in java based on the open source code of haploview version  <dig> . the analysis algorithms  are implemented in c++. both linux and windows versions of gevalt are available for download, as well as the java source code.

RESULTS
gevalt accepts input in a variety of formats. genotype data can be loaded as unphased genotypes in the standard linkage format, or as either partially or fully phased chromosomes. genotype data dumps from the hapmap website  <cit>  can also be loaded. when using the standard linkage format, the user can specify family structure as well as disease status. the user can also specify marker information, including name and location. upon loading a dataset, gevalt first phases the genotypes in the following manner: for data consisting of unrelated individuals, gevalt uses gerbil to phase the genotypes. for data consisting of two-generation pedigrees, gevalt first creates a set of trios, one per family, where each trio contains the child with least missing data. in each trio phasing is done, if possible, according to mendelian rules. then only the children's genotypes are phased using gerbil and each parent's haplotypes are deduced from its child's haplotypes. gerbil is then run again on the set of the parents' genotypes only to complete the missing data. the haplotypes of the children that were not included in the trios are deduced from their parents' haplotypes.

after phasing is completed, gevalt generates several displays and option menus including the following:

• phased genotypes: the phased genotypes of each individual are displayed. different colors are used to indicate alleles phased by gerbil, missing data and mendelian errors . for data consisting of pedigrees, the phased genotypes are divided into two groups, parents and children, and each group is displayed separately.

• stampa: select tag snps using the stampa algorithm . the user can specify the desired number of tag snps, and the algorithm finds an optimal set of tag snps and reports its prediction accuracy. the user can add or remove tag snps from the set manually and gevalt recalculates the prediction accuracy of the new set.

• individual stats: summary statistics for each individual are displayed . these include the percentage of missing genotypes, the percentage of heterozygous markers, the percentage of minor alleles and a tally of mendelian inheritance errors.

all of haploview's displays and option menus are available. see  <cit>  for a full description of these features. in addition, the following changes and extensions are introduced:

• association: gevalt contains a faster implementation of the permutation test in c++ instead of java. the new implementation runs about  <dig> times faster than the java implementation in haploview. in the haplotype associations tab, a p-value is calculated for each block and for each haplotype .

• ld plot: the ld between each pair of snps can be calculated using either the phased or the unphased genotypes . the block structure displayed by default is that found by gerbil. the user can still employ any of haploview's block identification methods or select blocks manually. markers that were chosen as tag snps in the stampa tab are highlighted in this display.

• haplotypes: the common haplotypes in each block are computed based on the gerbil solution.

• check markers: phasing by gerbil is done only for the set of picked markers. whenever the set of picked markers changes, gevalt recalculates the phasing, and all displays are updated accordingly.

each of these displays and option menus is shown on a separate tab, allowing the user to move from one to the next. interactive modifications made by the user in any panel are reflected in all the others. the information on each panel can also be exported to a png image file or to a text file. additionally, the program has a command-line mode, which allows the user to run all the analyses without opening the gui on one or more files at once.

the running time of gevalt is dominated primarily by that of gerbil and stampa . all other operations, such as parameter adjustments and display changes, are done with no noticeable delay even for data sets with hundreds of markers and hundreds of individuals. gerbil can currently handle up to  <dig> markers, while stampa can handle thousands of markers. both algorithms can handle thousands of individuals.

to the best of our knowledge, only two extant programs offer both algorithmic and visualization tools for genotype analysis: haploview  <cit>  and hapscope  <cit> . as described above, gevalt maintains the popular, user-friendly interface of haploview, but replaces its standard em algorithm for phasing with the gerbil algorithm. this allows a more accurate estimation of the phased haplotypes and a visualization of each individual's inferred haplotypes . besides the tagger algorithm for tag snps selection implemented in haploview , gevalt also offers stampa, which is not only very efficient, but also allows the user to choose the amount of tag snps. other advantages and improvements over haploview are listed above. a current limitation of gerbil is allowing at most  <dig> markers. we intend to remove this limitation in the future . the hapscope software includes analysis programs and a visualization tool. most of the analyses are done separately using the command line and the results are then loaded into the visualization tool. in contrast, in gevalt all the analyses are done within the graphical user interface, which makes it more user friendly and easy to use. hapscope uses phase  <cit>  or snphap  <cit>  as its phasing algorithm. phase was shown to be slightly more accurate than gerbil but much slower  <cit> . in contrast to hapscope, gevalt facilitates association tests and can handle family structures. on the other hand, only hapscope includes modules for reference sequence annotation, snp mapping and snp classification.

we intend to continue the development of gevalt. in particular, we shall extend gerbil to handle more snps, and improve stampa so that it incorporates into its solution predefined tag snps. we also intend to incorporate a new algorithm for evaluating the significance of disease association, which is dramatically faster than the standard permutation test  <cit> .

CONCLUSIONS
gevalt is an integrated viewer that uses state of the art phasing and tag snp selection algorithms. it streamlines the application of gerbil and stampa, which were available until now only as batch executables, and allows using them together with the strong visualizations of haploview for assessment of the results. both running the algorithms and visualizing the results are done within the graphical user interface, unlike, e.g., the hapscope software  <cit> , which only enables the latter. this makes the algorithms accessible to the broad community of researchers in genetics.

availability and requirements
• project name: gevalt

• project home page: 

• operating systems: windows and linux.

• programming language: java and c++

• other requirements: java  <dig>  or higher.

• license: free non-commercial research use license.

• any restrictions to use by non-academics: license needed for commercial use.

authors' contributions
od and gk contributed to the design of gevalt. od implemented gevalt and gk implemented the analysis algorithms. rs supervised the project. all authors participated in the drafting and revising of the manuscript, and read and approved the final manuscript.

