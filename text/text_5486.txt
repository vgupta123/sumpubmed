BACKGROUND
with the advent of genome-wide functional data, cross-species comparisons are no longer limited to sequence information. a classic extension of sequence alignment is structural alignment, which has been used to compare evolutionary distant rnas  <cit>  and proteins conserved in structure rather than sequence  <cit> . here we use protein interactions as evolutionary information beyond sequence  <cit> .

we perform a cross-species analysis of two herpesviruses, the varicella-zoster virus , causing chicken pox and shingles, and the kaposi's sarcoma-associated herpesvirus , responsible for cancer of the connective tissue. the two viruses have diverged approximately  <dig> million years ago. their sequence dynamics is characterised by a high rate of point mutations  and a high rate of gain and loss of genes . as a result, homologous proteins have an amino acid sequence identity of only about 20%. moreover, many open reading frames are only about  <dig> amino acids long. thus, the sequence similarity between the two species is in the 'twilight zone' of detection by alignment, i.e., orthologous open reading frames have alignment scores just marginally above the background of unrelated sequences.

to improve the cross-species comparison, we jointly use the similarity of coding sequences and of protein interactions. our hybrid comparison method called graph alignment establishes a mapping between genes of two species  <cit>  using a probabilistic scoring system based on evolutionary rates of sequences and interaction networks. several recent studies have used orthologs identified by sequence similarity to compare networks, for instance to identify ancestral networks  <cit> , network parts enriched in conserved links  <cit>  or to decide between paralogous genes, see  <cit> . here this approach is turned on its head: we use network information to identify evolutionary and functional relationships in cases where there is no detectable sequence similarity. related approaches appeared in  <cit> , reviewed in  <cit> .

however, these approaches use ad-hoc scoring parameters, or parameters derived from a database of known orthologous genes  <cit>  to determine the alignment. our method uses an evolutionary model to infer all necessary parameters from the data set itself. in ref.  <cit>  we have applied this method to co-expression networks, which are fully connected. here we explore the complementary regime of sparsely connected networks with noisy link and node similarity data, where graph alignment is used to resolve the twilight regime of evolutionary correlations. in this regime, statistically significant alignments have to be distinguished from a low-fidelity regime of spurious graph alignments. understanding the statistics of graph alignment in both regimes turns out to be important for validation of the results in the twilight regime.

our cross-species comparison is grounded on a two-level evolutionary picture for protein coding sequence including  the specific sequence parts responsible for protein-protein interactions and  the background coding sequence, most of which is unrelated to these interactions. the relevant processes include divergent sequence evolution, gain and loss of interactions, duplication of genes and the corresponding interactions, and gain and loss of genes. functional relationships may stem from common ancestry and thus be detectable by sequence homology, but they may also arise by convergent evolution, this analogy displayed by similar interactions without sequence similarity. an example is given in figure  <dig>  where one gene has functionally replaced another gene by acquiring its interactions, a process called non-orthologous gene displacement  <cit> . similarly, an orthologous gene pair may diverge in sequence beyond detectability, but conserved interaction patterns remain detectable due to functional constraints. such functional or evolutionary relationships are to be deduced from the network of interactions between genes.

the essence of our graph alignment approach is as follows: experimental data on interacting proteins defines a protein interaction network consisting of nodes  and links . at this point, nodes can simply be labelled by a protein name, or orf identifier, without recourse to sequence information. the local link similarity between pairs of aligned nodes defines the link score of the alignment. aligned nodes can either both interact , both not interact , or interact in one species and not in the other . the sequence similarity between aligned nodes defines their node score. the total score is the sum of link and node terms, with scoring parameters depending on the evolutionary distance between the species compared. finding high-scoring graph alignments is an algorithmically hard problem, and we use the algorithm introduced in  <cit>  to perform the search. however, since many proteins have no clear sequence ortholog and few interaction partners, it turns out that high-scoring alignments are not guaranteed to be statistically or biologically significant. there exists a regime of spurious alignments consisting of islands of locally matching topology which do not respect sequence similarity: the low-fidelity regime discussed further in the methods section. it turns out that optimal alignments are produced using scoring parameters in the high-fidelity regime close to the transition to the low-fidelity regime.

for the graph alignment between the vzv and kshv viruses studied here, both the interaction networks and the gene sequences are crucial to determine functional or evolutionary relationships, while each part of the data by itself is less significant. in particular, we find protein pairs with low sequence similarity for which the interaction similarity strengthens the statistical inference of homology, as well as protein pairs without sequence similarity, which are aligned based on their interactions alone. we use this alignment to make functional predictions, which turn out to be consistent with published gene expression data, as well as gene position and molecular weight. given a validated alignment, we can quantify the evolution of protein interactions. we find that interactions between functionally related proteins are more conserved than other interactions.

RESULTS
optimal graph alignment between vzv and kshv
the protein interaction network of the herpesvirus vzv consists of  <dig> open reading frames  and  <dig> protein-protein interactions . the protein interaction network of kshv consists of  <dig> orfs and  <dig> interactions ,  <cit> , see figure 2a. thirty-four orfs in vzv have reciprocally best matching sequence homologs with reading frames in kshv. between pairs of orfs with such homologous partners, there are  <dig> interactions in vzv and  <dig> interactions in kshv. of these interactions,  <dig> occur in both species, that is the overlap between interaction networks is about 13% when the alignment is given by sequence homology. the optimal alignment of the two networks is shown in figure 2b. the list of aligned orfs and details on the scoring are given in the supplementary text . the alignment consists of  <dig> pairs of aligned orfs, spanning one third of the protein interaction networks of vzv and kshv. the alignment contains  <dig> interactions,  <dig> of which are self-interactions. of the  <dig> interactions between distinct orfs,  <dig> are matching interactions occurring in both protein interaction networks, only one of the  <dig> self-interactions matches. of the  <dig> pairs of aligned orfs,  <dig> pairs have detectable sequence similarity. the remaining  <dig> aligned pairs involve orfs which have no detectable sequence similarity with each other or any other orf. the mean connectivity of the aligned part of the protein interaction network is  <dig>  interactions per orf, compared with a mean connectivity of  <dig>  of vzv and  <dig>  of kshv.

the quality of the alignment we have obtained can be tested by comparing the genomic positions of the aligned orfs. we count the ranks of orfs from the initial terminal repeats of the two genomes . in figure 3a the ranks of reading frames in vzv are plotted against the ranks of their alignment partners in kshv. aligned orfs without any sequence similarity fit very well into the sequence of orfs in their respective genomes. the molecular weights of the aligned nodes are highly correlated, see figure 3b. in addition, we find that interactions among the aligned orfs are more likely to be conserved across several other herpes species, including herpes simplex virus  and murine cytomegalovirus . the mutual information on the interactions in different species within the alignment is  <dig> -times higher than for the interactions among orfs outside of the alignment .

in some cases, sequence similar pairs of orfs are not aligned because of mismatched interactions. as an extreme case an orf may have several interactions in one species, but none in the other, indicating most likely an unsuccessful yeast-two-hybrid assay  experiment. examples are kshv orf64/vzv orf <dig>  22/ <dig>  42/ <dig>  36/ <dig>  and 33/ <dig> 

functional relationships detected by interaction similarity
some orfs are aligned due to their matching interactions, either with low or with no detectable sequence similarity. we discuss these cases separately.

kshv orf <dig> /vzv orf25
these orfs have a sequence identity of only 18% over  <dig> aa . they are listed as homologs in the vida <dig> database  <cit> , and both of them are thought to be homologs of the hhv- <dig> protein ul <dig>  <cit> . the alignment of these orfs largely results from  <dig> matching links out of  <dig> in kshv and  <dig> in vzv  with a local link score sl =  <dig>  versus node score sn =  <dig> . our alignment thus confirms the homology.

kshv orf28/vzv orf65
these orfs have a sequence identity of only 11% over  <dig> aa. they are not listed as sequence homologs in databases vocs  <cit> , vida <dig>  <cit>  and ncbi  <cit> . however, the sequence alignment extends over their complete length, with no gaps. again, the alignment of these nodes results from  <dig> matching links out of  <dig> in kshv and out of  <dig> in vzv  with a local link score sl =  <dig>  versus node score sn =  <dig> . functional annotation is available only for vzv orf65; it belongs to the membrane/glycoprotein class, most likely it is a type-ii membrane protein  <cit> . the alignment of kshv orf <dig> with vzv orf <dig> leads us to predict that kshv orf <dig> also codes for a membrane glycoprotein, see figure 2c for illustration.

several experimental studies support this prediction. gene expression studies show that orf <dig> is co-expressed with tertiary lytic orfs and hence probably falls in the classes of structural or host-virus-interaction genes  <cit> . the expression of orf <dig> is affected by blocking dna replication  <cit>  showing orf <dig> is a secondary or tertiary gene. furthermore, orf <dig> has been detected in the virion by mass spectroscopy, leading to a tentative functional classification as a glycoprotein-envelope protein  <cit> . finally, orf <dig> is a positional homolog of the epstein-barr virus orf bdlf <dig>  which is known to encode glycoprotein gp <dig> 

kshv orf23/vzv orf39
these orfs have no significant sequence similarity: although the alignment obtained with clustalw  <cit>  has a sequence identity of 18% over  <dig> aa, it is statistically insignificant; a randomised test yields a p-value of  <dig> . a systematic analysis involving a wide range of different scoring parameters does not yield a statistically significant sequence alignment either . the reading frames kshv orf <dig> and vzv orf <dig> are aligned purely due to  <dig> matching interactions out of  <dig> of kshv and  <dig> of vzv . the local link score equals  <dig>  versus a node score of - <dig> . functional classification is available only for vzv orf <dig> as a membrane/glycoprotein  <cit> . the alignment thus leads us to predict that kshv orf <dig> also codes for a membrane glycoprotein.

this prediction is supported by several experimental studies. again orf <dig> is co-expressed with tertiary lytic orfs  <cit>  and is sensitive to blocked dna replication  <cit> , so it is a late gene. the expression patterns of orf <dig> are similar to those of structural and packaging genes.

kshv orf41/vzv orf60
these orfs have  <dig> matching interactions out of  <dig> in kshv and  <dig> in vzv , but no significant sequence similarity . they are aligned with a local link score of  <dig>  versus a node score of - <dig> . both orfs are functionally annotated. kshv orf <dig> codes for a helicase/primase associated factor  <cit>  and is not affected by blocking dna replication  <cit> . on the other hand, vzv orf <dig> codes for the glycoprotein l  <cit> . it may be that either of them has a so-far unknown function, leading to the matching protein interactions. this idea finds support in  <cit> , where the expression maximum of orf <dig> was found to come after the secondary lytic phase. this is surprising because the transcript is needed already during the secondary lytic phase . no other dna-replicating gene controlled by a different operon to kshv orf <dig> has an expression dynamics with this property. such a delay of the maximum of expression may have two reasons: either the transcription of the orf <dig> is not controlled after its role is finished, or orf <dig> indeed has a hitherto uncharacterised function in the tertiary lytic phase, possibly a structural one.

we also note that orf <dig> is specific to the class of γ-herpesviruses, of which kshv is a member. analogously, orf <dig> is a-herpesvirus specific. it is possible that the homolog of orf <dig> in vzv and the homolog of orf <dig> in kshv were lost as a result of either of these proteins acquiring a new function. this would be an example of non-orthologous gene displacement  <cit> .

interaction clusters
the alignment shown in the figure  <dig> contains a cluster of proteins all interacting with each other. this cluster comprises the aligned pairs kshv orf23/vzv orf <dig>  28/ <dig>  29b/ <dig>  and  <dig> / <dig> connected by matching links only. the p-value for such a fully connected cluster  to emerge at random is approximately  <dig> × 10- <dig>  the pair kshv orf41/vzv orf <dig> discussed above is connected to this cluster by two matching links, forming an almost fully connected cluster of  <dig> orfs pairs with  <dig> of  <dig> possible links present and matching. surprisingly, while all the other orfs in the cluster code for structural proteins , orf <dig> of kshv is annotated as a helicase/primase associated factor, and hence codes a protein involved in dna replication. the association with structure-related genes may be interpreted as a further evidence towards another function of orf <dig> as a structural protein.

this cluster of interacting proteins is also found in a third species, the epstein-barr virus ebv, which is of the same viral family as kshv. three of the four orfs of the cluster in kshv have sequence homologs in ebv, namely orf <dig>  orf <dig> , orf29b. all of the corresponding orfs in ebv are found to interact with each other .

the individual species kshv and vzv contain further clusters, but these are not conserved across species. for instance, the cluster comprising orfs  <dig>  29b,  <dig> and k <dig> in kshv contains genes coding for predicted virion proteins, virion assembly and host-virus interaction proteins. orfs  <dig>   <dig>   <dig>  and  <dig> forming a fully connected cluster in vzv code for proteins involved in virion assembly, nucleotide repair, metabolism, and host-virus interaction.

interaction conservation and protein function
protein interactions which are conserved across species shed further light on the functional relationship of the interaction partners. we compare the functions of interacting proteins  when the interaction is conserved between kshv and vzv, and  regardless of conservation.

each annotated protein can be assigned to one of two functional classes: it is either a 'structural protein' , or an 'information-processing' protein . we take the functions of two proteins to be similar if both their functional annotations fall into the same class. based on this classification, we measure the correlation between functional annotations of interacting proteins by mutual information. for conserved interactions, this is nearly 20-times higher than for the set of all interactions . hence, conserved interactions are more likely to connect functionally similar proteins. conversely, functionally similar proteins have more conserved interactions than functionally unrelated genes. the mutual information between interactions in the two species is nearly ten times higher for pairs of functionally similar proteins than for pairs of functionally different proteins .

CONCLUSIONS
graph alignment results from sequence and interaction similarity
protein interactions are encoded in mutually matching binding domains. the evolutionary dynamics of these domains is governed by different evolutionary constraints and hence, by different tempi than the overall coding sequence. moreover, the sequence of a domain may evolve considerably while its interaction is conserved. therefore, we treat the experimental interaction data as evolutionary information independent of sequence data. our alignment of herpesviruses vzv and kshv yields a cross-species mapping between orfs based jointly on the correlation between amino acid sequences and on the correlation between their protein interactions. the latter correlation depends both on the evolutionary divergence of the interaction networks, and on experimental noise. this approach is distinct from searching for the overrepresentation of matching interactions among sequence homologs  <cit> . it allows the identification of homology in cases where sequence similarity between two orfs has decayed to statistically insignificant levels. resolving the 'twilight zone' of sequence similarity by additional information on protein interactions is particularly relevant for the case of short genes , or high levels of domain shuffling. our method also allows to detect functional analogs, i.e., proteins with similar interactions but without common ancestry. the resulting alignment is corroborated by genomic position and by molecular weight of aligned orfs.

functional predictions from interaction similarity
we find several cases of orfs with no detectable sequence similarity which are aligned with each other solely on the basis of matching interactions. there are different possible mechanisms generating this situation;  a pair of orthologous genes loses their sequence similarity below the threshold of detectability,  convergent evolution, and  a gene functionally substitutes for another gene. the original gene may then be excised from the genome without phenotypic effect. this process has been termed non-orthologous gene displacement  <cit> . in all three cases, sequence information is insufficient for functional prediction. based on the alignment due to matching interactions and on the annotation of one of the alignment partners, we predict the function of several orfs. these predictions are supported by gene expression experiments and by the genomic position of the orfs.

functional cluster as conserved subgraph
the optimal alignment  contains a cluster of  <dig> orfs whose products all interact with each other in both viruses. all members of this cluster belong to a single functional class; they are involved in virion formation and structure and code for tertiary lytic transcripts.

there are other fully connected clusters both in vzv and kshv, but none of them occur in both viruses. these clusters contain proteins in different functional classes; one cluster in vzv contains proteins involved in virion assembly, nucleotide repair, metabolism, and host-virus interaction.

guilt by conserved association, evolutionary constraints on network links
the guilt-by-association scheme of assigning like functions to interacting proteins  <cit>  would fail in these cases of non-conserved clusters. however, we can refine this principle to guilt by conserved association, assigning similar functions only to proteins with an interaction in both species, which correctly describes the functional correlations in the above clusters. indeed, while the functional classes of interacting proteins in a single species are only very weakly correlated, pairs of proteins with conserved interactions are more likely to share the same function.

the guilt-by-conserved-association principle might be more than a statistical filter for false positive interactions by cross-species comparison. interactions between proteins of the same functional class are more likely to be conserved across species than interactions between proteins of different functions, which may indicate a lower rate of evolution of interactions related to function. this, in turn, is consistent with natural selection imposing a specific constraint acting jointly on protein interactions that contribute to a cellular pathway. with data on further species, phylogenetic analysis will shed light on the evolutionary forces at the level of the protein interaction networks, particularly if adaptive events can be traced in the data  <cit> .

