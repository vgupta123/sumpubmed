BACKGROUND
the functions of a protein are determined by its three dimensional structure. it is believed that the functional space of all proteins can be spanned by combining a rather small number of structural units, termed folds. the number of different folds is small compared to the total number of proteins, of the order of  <dig> for globular, water-soluble proteins  <cit> . this is in contrast with the exponential complexity of the amino acid-level configuration space of proteins. therefore, for some purposes, the description of the configuration based on amino acid coordinates is over-detailed. the number of degrees of freedom needed for the description, comparison and classification of the macroscopic, biologically-relevant features of proteins is necessarily much smaller than that associated with the collection of amino acids. selecting the relevant degrees of freedom and defining methods to compare structures in their reduced space is deemed useful.

the comparison of structures is a central component of many research objectives. for formulations of the problem and a review of various methods of comparison see for example  <cit> . the problem is particularly important in protein classification. various classification schemes that have been developed thus far  approach the objective of selecting the degrees of freedom by using a combination of various empirical and/or qualitative descriptors of protein conformations and parameters derived directly from coordinates of corresponding amino acids , recognizing implicitly that, for the purpose of describing its function, the conformation of the proteins is highly unstructured in the microscopic  configuration space. despite this, however, when it comes to quantitatively measure the difference between protein structures, in most cases, the measure of choice remains the root mean square deviation  between aligned atomic coordinates.

a disadvantage of the rmsd-based measures is that it assumes a strict one-to-one correspondence between at least the c alpha  atom coordinates of the compared proteins, i.e., it requires an alignment at the amino acid level of detail. unfortunately, there is no unique formulation for the problem of aligning protein sequences from structure and, as a result, the existing methods produce results which differ in details  <cit> . moreover, there exist problems where the shape of a certain region in the molecule is what is analyzed in the context of a biological function. for example, binding sites from different proteins need to be compared for the detection of any similarities  <cit> . in those cases there is no alignment, or the alignment between amino acids is not relevant and the rmsd cannot be defined. thus far, from a shape perspective, the comparison has included only the molecular surface in that region  <cit> . one limitation  is that some methods of surface representation impose restrictions on what kind of surfaces can be studied . another disadvantage is that it may be the case that other properties of the site, which are three-dimensional in nature might be relevant in defining the function. for example, the distribution of charge, hydrophobicity, etc deep beneath the surface of the site. these properties can not be included in a natural way when only the surfaces are compared. in other words, the intrinsic behavior of a protein is a combination of its properties defined through both the internal and external structure of the protein. to more correctly represent a protein warrants the search for alternative parameterizations of protein structure. the approach presented here represents such an alternative.

a fold is characterized by structural features at the multi-residue level. even though these features are easily recognizable visually in many cases, there is no obvious quantitative way to relate them to the underlying atomic coordinates that exactly describe the structure of the protein. that is, atom coordinates only offer a local description of the structure, while the features defining the fold represent global, shape related properties. starting with the very rich description given by the coordinates of the atoms that make the protein, one would then need a way to distill from this set of coordinates only the information that is directly associated with these general traits. we do not know of the existence of any systematic approach for the elimination of the redundant information, starting from the initial set of coordinates. here, we adopt an approach that starts from the other end of the spectrum. instead of starting from the atom description and discarding non-relevant features, we start from the global level with a very coarse description and refine it by adding descriptors for more and more detailed features.

the need for methods that use global descriptors for the comparison of protein structures has been recognized before. one such method  <cit>  has been proposed recently that relies on results from knot theory to extract a number of quantitative features of the path of the protein backbone and compare two such paths in the reduced space of this set of features  <cit> . here we present another method that is based on a hierarchical set of descriptors for the distribution of atoms in space. the method is general enough so that it can be refined to describe the protein spatial profile with a geometrical level of detail. it can potentially interpolate between the coarsest description of the structure  and the most detailed description, equivalent in amount of information to the complete set of atom coordinates. this is achieved by using as coordinates the series of multipolar components associated with a given atom property. to be specific, we will refer here to the multipole tensors associated with the mass of cα atoms. note, however, that as long as the property is distributed uniformly over the set of atoms , the nature of the property is not relevant. the multipoles themselves represent, up to a constant multiplicative factor, a set of parameters describing exclusively the spatial configuration of the atom set.

our approach can be combined with other important parameters, for example, mass of the residue instead of the cα, charge, hydrophobicity or secondary structure conformation. in those cases, the method will enable the description of the spatial profile of those quantities instead of just the pure geometrical configuration of the molecule. correspondingly, the method will provide a means to quantitatively compare the proteins according to those properties.

the notion of multipoles originates in physics  <cit>  and is closely related to the representation of functions in terms of spherical harmonics  <cit> . the use of spherical harmonics in biomolecular research is not new. they have been used for example for the representation and rotation of molecular surface and other properties in an efficient way  <cit> , for the purpose of molecular docking  <cit> , for the comparison of binding sites in molecules  <cit>  or for the display of molecular surfaces in molecular visualization  <cit> . the lower order  multipoles  have been used before as a signature for the electrostatic field in the comparison of small molecules for the purpose of drug design  <cit> . here, we take the approach that the whole set of multipoles can be interpreted as an alternative set of coordinates for the description of the structure of the molecule. we then show how their tensorial properties can be used for the definition of a distance function in protein configuration space.

the organization of the paper is as follows. in the results and discussion section we first define the multipoles and present a qualitative motivation for their use as an alternative parameterization of the shape of the protein. then we show how their tensorial properties can be used to define a distance function in the conformational space. since the multipoles are dependent on the location and orientation of the system of axes, the following subsection is used to define a "canonical" reference frame to be used for the purpose of comparison. the concluding subsection is devoted to testing the method. we show that, given the biological relevant portion of the structure, the method successfully discriminates between the families in a test set of proteins from the protein kinase-like superfamily  <cit> . we then study the correlation between the multipole and cartesian coordinates representations for the same test set and show that, as expected, the correlation increases with the level of detail of the multipole representation approaching the dimensionality of the fold space. we conclude the paper with a discussion of the advantages of the method and of the various directions in which it can be generalized.

RESULTS
mutlipolar representation
the notion of multipoles comes from physics where they are used to describe the field generated by the spatial distribution of a scalar quantity such as mass  or charge  density. the potential of the field created by such a quantity, at a given distance outside the region it occupies in space, can be conveniently expressed in the form of a multipole expansion  <cit> . each multipole in the series accounts for the contribution of a certain type of deviation of the density field from a spherically symmetric distribution and, in general, the higher the order of the multipole the smaller the spatial scale of the deviation it describes. in this sense, the multipoles can be viewed as descriptors for the shape of the scalar distribution. the use of multipoles as shape descriptors is also closely related to the more general methods of 3d moments used in the field of object recognition in computer science  <cit> . in the above physical example the multipoles of higher orders typically account for relatively small contributions in the force field compared to lower order multipoles, and they may be neglected for many practical purposes. in a similar way, higher order multipoles representing small scale details of the shape, can be ignored in the process of describing protein structures when only a rough comparison is needed. before giving a formal definition of multipoles in general, let us start by discussing the few lower order multipoles which are more familiar and more widely encountered in the research literature.

quantitatively, the multipoles associated with the space distribution of a scalar property  form a sequence of tensors over the three dimensional position space. the multipole of rank zero, or the monopole, is just the space integral of the scalar property. when the scalar property is the mass density then the monopole is the total mass of the set of atoms.

the multipole of rank one is proportional to the position of the center of mass. we will use it to set the origin of the coordinate system with respect to which all multipoles are calculated. therefore, in our calculations, the multipole of rank one, , is always going to be a null vector. for completeness, we should mention that for the multipoles of a distribution of charge this can not always be done. if the total charge is zero there may be a non-zero dipole moment that can not be made to vanish by a translation of coordinates. this is however a technical problem and it has been addressed before  <cit> .

the multipole of rank two, or the quadrupole has nine cartesian components. for our discrete distribution, the components are given by the following expression:

∑α=1n.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaamaabmaabagaeg4mamjaemieag3aasbaasqaaggaciab=f7ahjabcycasiabdmgapbqabagccqwg4baedawgaawcbagae8xsdemaeiilawiaemoaaogabeaakiabgkhitiabdkhaynaadaaaleaacqwfxoqyaeaacqaiyagmaagccqwf0oazdawgaawcbagaemyaakmaeiilawiaemoaaogabeaaaogaayjkaiaawmcaaawcbagae8xsdemaeyypa0jaegymaedabagaemota4eaniabgghildgccqgguaglcawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaaa@506c@

here, δi,j =  <dig> for i = j and  <dig> otherwise. the sum runs over all n cα atoms in the structure, xα,i is the component i of the x→α
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwg4baegawcamaabaaaleaaiigacqwfxoqyaeqaaaaa@3009@ position vector  and rα represents the length of the x→α
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwg4baegawcamaabaaaleaaiigacqwfxoqyaeqaaaaa@3009@ position vector. for example, the first diagonal component is ∑=∑
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeabqaamaabmaabagaeg4mamjaemieag3aa0baasqaaggaciab=f7ahbqaaiabikdayaaakiabgkhitiabdkhaynaadaaaleaacqwfxoqyaeaacqaiyagmaaaakiaawicacaglpaaacqgh9aqpdaaeabqaamaabmaabagaegomaijaemieag3aa0baasqaaiab=f7ahbqaaiabikdayaaakiabgkhitiabdmha5naadaaaleaacqwfxoqyaeaacqaiyagmaagccqghsislcqwg6bgedaqhaawcbagae8xsdegabagaegomaidaaagccagloagaayzkaaaaleqabeqdcqghris5aawcbeqab0gaeyyeiuoaaaa@4ecb@ and one of the non-diagonal terms is ∑xαyα.

for higher order multipoles, enumerating the cartesian components in closed form is not a simple task. moreover, there is a large number of symmetry properties obeyed by the cartesian components and therefore keeping all components of a given multipole would be redundant. instead, more commonly, the irreducible spherical components are defined since they have a compact form when represented in terms of spherical harmonic functions and are independent. this makes them suitable for analytical and numerical calculations. within the rest of the paper we will use the term multipoles to denote these irreducible components which represent the focus of our attention. we will explicitely name the cartesian components if needed to distinguish them from the spherical components.

for a discrete set of n atoms the multipoles of rank l are defined as:

qlm=∑i=1nrilylm*     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbqcdawgaawcbagaemibawmaemyba0gabeaakiabg2da9maaqahabagaemocai3aa0baasqaaiabdmgapbqaaiabdygasbaakiabdmfaznaadaaaleaacqwgsbabcqwgtbqbaeaacqggqagkaagcdaqadaqaaggaciab=h7axnaabaaaleaacqwgpbqaaeqaaogaeiilawiae8nxdy2aasbaasqaaiabdmgapbqabaaakiaawicacaglpaaaasqaaiabdmgapjabg2da9iabigdaxaqaaiabd6eaobqdcqghris5aogaaczcaiaaxmaadaqadaqaaiabikdayagaayjkaiaawmcaaaaa@4f06@

where ri, θi, φi represent the spherical coordinates of atom i, ylm denotes a spherical harmonic function and the * denotes complex conjugation. for the definition and summary properties of these functions, see for example  <cit> . here, since we will only consider the cα atoms, we set the mass of each atom to unity to simplify the notation. for a set of arbitrary atoms, each term in the sum would be weighted by the mass of the atom .

the rank l can take any integer value from  <dig> to ∞ and for each given l the number m can take values in the range -l...l. then, the number of irreducible components, specified by the index m, increases linearly with the rank l of the multipole as 2l +  <dig>  when all multipoles with rank from  <dig> to n are used, the total number of independent components describing the shape of the protein is  <dig>  as n increases, this number approaches the number of cartesian components of the position vectors of the cα atoms. when the two numbers are equal, the description provided by the set of multipolar components for the structure of the protein is of the same level of detail as the original description offered by the atomic coordinates. we fully recover the amount of information provided by those coordinates. when this happens, from a mathematical standpoint the multipole series is just a coordinate transformation and if not singular, at least in principle, we can transform back and forth from one description to the other.

as a last remark, we will note that the set of multipoles that we use here is only a subset of a larger set which, in its entirety, uniquely describes the potential field surrounding the distribution of charge   <cit> , for a given set of boundary conditions. the formalism that we present can be extended to include any portion of this complete set of multipoles and this leaves open the possibility for further optimization of a protein comparison process. the reason for retaining this particular subset of multipoles is that they describe the field outside the region occupied by the molecule and therefore they are more likely to correlate with its interaction capabilities and consequently its function.

constructing a distance function in the protein conformation space
what makes the set of multipoles defined in eq.  a good set of descriptors for comparison purposes is that they form a series of quantities with remarkable symmetry properties. specifically, for any given rank l, the 2l +  <dig> components qlm, m = l, l - <dig>  ... -l +  <dig>  -l form an irreducible tensorial set of order l  <cit> . this means that under regular rotations in the three-dimensional  physical space, these components are transformed according to a well defined induced rotation matrix , in a way similar to the behavior of a 2l +  <dig> dimensional vectorial quantity. the immediate benefit is that one can apply the regular operations with vectors to the multipoles of a given rank and one can construct invariant quantities following the known rules from euclidian vectors. in particular, if we denote by q <dig> the set of all components {qlm}m=−l,l¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagadaqaaiabdghaxnaabaaaleaacqwgsbabcqwgtbqbaeqaaagccagl7bgaayzfaawaasbaasqaaiabd2gatjabg2da9maanaaabagaeyoei0iaemibawmaeiilawiaemibawgaaaqabaaaaa@3a77@, we can define the length of the multipole of rank l using the scalar product:

‖q1‖=1/2=mqlmql−m)1/ <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqbdaqaagqabiab=fhaxnaabaaaleaacqwfxaqmaeqaaagccagljwuaaypcsdgaeyypa0jaeiikagyaaabcaeaacqwgxbqcdawgaawcbagaemibawmaemyba0gabeaakiabdghaxnaadaaaleaacqwgsbabcqwgtbqbaeaacqggqagkaagccqggpaqkdaahaawcbeqaaiabigdaxiabc+caviabikdayaaaaeaacqwgtbqbcqgh9aqpcqghsislcqwgsbabaeaacqwgsbaba0gaeyyeiuoakiabg2da9iabcicaomaaqaeabagaeiikagiaeyoei0iaegymaejaeiykakyaawbaasqabeaacqwgtbqbaagccqwgxbqcdawgaawcbagaemibawmaemyba0gabeaakiabdghaxnaabaaaleaacqwgsbabcqghsislcqwgtbqbaeqaaogaeiykakyaawbaasqabeaacqaixaqmcqggvawlcqaiyagmaaaabeqab0gaeyyeiuoakiabcycasiaaxmaacawljawaaewaaeaacqaizawmaiaawicacaglpaaaaaa@654f@

where the last part of the equation follows from the definition of the multipoles and well known symmetry properties of the spherical harmonic functions  <cit> . this norm can then be used to define a distance between two structures inside the subspace defined by the multipolar components  of a given rank, provided that either the structures have been previously spatially superimposed, or, a "canonical orientation" of the structures has been set in some consistent manner:

δl = ||q <dig> - q1'||.     

there is no a priori prescription for combining distances in subspaces of different ranks l to construct a global distance function. such a prescription needs to be extracted from numerical experimentation with the problem to be modeled and/or from more general principles. the alternative discussed here is the result of our tests of the sensitivity and selectivity in discerning protein structures. since the dimensionality of multipoles differs with l, in order to combine distances from different subspaces to construct a global metric one has to first define quantities with the same dimensionality. the solution adopted in this paper, is to redefine the distance in all ranks so that it has the same dimensionality, say dimensionality of length. except eventually for a general factor , the dimensionality of the multipoles is a power of length equal to their rank. the general factor can be rendered dimensionless by a proper rescaling. then, one can obtain a quantity with dimension of length by taking an appropriate root of the euclidian distance as follows:

dl = ||q <dig> - q1'||1/l, l >  <dig>      

note that, once the multipole components have been calculated, any reference to the original cartesian coordinates disappears from the representation. as a consequence, unlike the rmsd which requires a one-to-one correspondence between the set of atoms in the structures compared, the distance in eq.  is defined for arbitrary structures, without any restriction with respect to their number or sequence of amino-acids. therefore no alignment is implied. in practice, a normalization with respect to the "size" of the structures involved may still be necessary. for that purpose, each multipole in eq.  can be separately rescaled with a factor inversely dependent on the "size" of the corresponding molecule. then, instead of eq. , we will use



the notation we use in this formula for the "size" dependent factors  is motivated by the fact that the multipole of rank  <dig>  is up to a constant numerical factor the "size" of the molecule . when the two structures have the same size, the rescaling of the multipoles in eq.  reduces to a rescaling of the distance  by a factor inversely proportional to the common size of the two molecules. this is qualitatively equivalent to the 1/n factor in the rmsd distance ). it can be shown that eq.  satisfies the triangle inequality and therefore a global distance function which also satisfies the triangle inequality can be defined by adding the distances  for all ranks of the multipoles. here, we use the following formula:



this function will be used as a dissimilarity measure for proteins in our study. the upper limit in the summation is the maximum rank of the multipoles retained in the representation and determines the dimensionality of the representation and, implicitely, its level of detail.

the interest for reduced representations is manifest in the literature. from a shape perspective, similar to ours, such representations emerge in approaches such as that described in  <cit> . from a different perspective, starting from individual atomic coordinates and using an averaging approach, an alternative method is presented in  <cit> .

defining a canonical reference frame
the multipoles behave like vectorial quantities and the numerical values of their components depend on the location and orientation of the reference frame. for the comparison of structures to be meaningful, we need to either minimize the distance in eq.  over all rigid transformations  of one of the molecules, or to choose a standard for the reference frame with respect to which the multipolar configurations of the molecules are calculated  <cit> . since the second approach is much more efficient for large scale computations, we chose to test this second alternative.

the problem of choosing such a standard arises in many research areas where 3d systems are involved  <cit> , and various schemes can be found in the literature, depending of the research field. a common choice is to select a system of axes that is placed at the center of mass and having its three orthogonal directions along the eigenvectors of a suitable, symmetric matrix . while the location at the center of mass is natural, its orientation as described above is ambiguous. this prescription is not appropriate in our case since it does not uniquely define the axes: any combination of permutations and inversions of the versors of a given principal axes frame form also a principal axes frame. since we are using multipoles of ranks higher than the quadrupole , which are sensitive to these various orientations, we can not allow an arbitrary choice. we need a prescription that uniquely defines a frame. our choice is based on the use of lower order vectorial  counterparts of the multipoles introduced above. specifically, we start by defining the following vectors:

e→1=∑i=0n−1=.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwglbqzgawcamaabaaaleaacqaixaqmaeqaaogaeyypa0zaaabcaeaadaqadaqaaiqbdiha4zaalawaasbaasqaaiabdmgapjabgucariabigdaxaqabagccqghsislcuwg4baegawcamaabaaaleaacqwgpbqaaeqaaagccagloagaayzkaagaeyypa0zaaewaaeaacuwg4baegawcamaabaaaleaacqwgobgtaeqaaogaeyoei0iafmieagnbasaadawgaawcbagaegimaadabeaaaogaayjkaiaawmcaaawcbagaemyaakmaeyypa0jaegimaadabagaemota4kaeyoei0iaegymaedaniabgghildgccqgguaglcawljagaaczcamaabmaabagaegioagdacagloagaayzkaaaaaa@511a@

e→2=12∑i=0n−1×.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwglbqzgawcamaabaaaleaacqaiyagmaeqaaogaeyypa0zaasaaaeaacqaixaqmaeaacqaiyagmaawaaabcaeaadaqadaqaaiqbdiha4zaalawaasbaasqaaiabdmgapjabgucariabigdaxaqabagccqghrawkcuwg4baegawcamaabaaaleaacqwgpbqaaeqaaagccagloagaayzkaagaey41aq7aaewaaeaacuwg4baegawcamaabaaaleaacqwgpbqacqghrawkcqaixaqmaeqaaogaeyoei0iafmieagnbasaadawgaawcbagaemyaakgabeaaaogaayjkaiaawmcaaawcbagaemyaakmaeyypa0jaegimaadabagaemota4kaeyoei0iaegymaedaniabgghildgccqgguaglcawljagaaczcamaabmaabagaegyoakdacagloagaayzkaaaaaa@568b@

the first vector reduces to the relative position of the last amino acid with respect to the first, while the second one is a more complex quantity that is sensitive to the details of the path of the protein backbone. except for special cases  are not well-defined, or they become parallel), these vectors are independent. then, they can be orthonormalized and the resulting unit vectors will serve as the first two versors of our canonical reference frame. the third one will be their cross product.

the "canonical" reference frame defined by eqs.  is unique by construction. however, other unique definitions can be developed  <cit> . we are not aware of any rigorous prescription for constructing such a reference frame and therefore our choice remains heuristic.

testing the multipole representation
to test our representation of protein structure, we performed a number of calculations with the goal of assessing both its discriminatory power and, where meaningful, its correlation with the cartesian description.

comparing biologically relevant molecules
as already stated, the use of multipoles opens the possibility of protein shape comparisons without the need for a pre-existing amino acid alignment. however, while technically our representation allows for the comparison of arbitrary collections of atoms, in biological applications, such as protein classification, not any comparison will make sense: we need to restrict the comparison to those portions of the proteins which are relevant to the problem, for example, the functional regions. in principle, the multipoles can be used in identifying corresponding domains in structures, however, as of this moment we do not have fully functional tools to do that. therefore, as a benchmark for testing the method, we use a manual alignment of the catalytic cores from the protein kinase-like superfamily  <cit> . the set contains  <dig> typical protein kinases  and  <dig> atypical protein kinases  which phosphorylate non-proteins. as has been shown  <cit>  these diverse structures can be traced to a common ancestor, but today their sequence identity is below 15% in some cases and significant structural changes have taken place, particularly in the c-terminal lobe so that a variety of substrates can be phosphorylated using the same atp gamma-phosphate transference mechanism. these structures represent an excellent test case for structure recognition since the accurate hand curated alignment provides a valuable benchmark.

we performed an all-against-all comparison of the proteins in the benchmark set, using as input coordinates of cα atoms identified as part of the catalytic core  <cit> . some of these atoms needed to be omitted because of unresolved portions of some structures as will be discussed later in this section. in this first set of calculations, we did not use any alignment information and there is significant variability in the number of amino acids used for each structure. eq.  was used to generate the distance matrix for all pairs of structures. the results are shown in figure  <dig>  the ordering of the proteins along the two axis is the one provided by the authors of the set  <cit> . therefore, the first six proteins are each a representative of an ak family and the rest are all tpks. within the tpks, the proteins are ordered roughly according to its various groups  <cit>  . this implies grouping of all pairs involving an ak kinase in either the upper or left hand band of six rows or columns, respectively. the shading is such that greater distances map into darker squares. a sharp discrimination between any tpk and any ak family on one hand, and between any pair of ak families on the other hand, is observed. thus, the multipole representation is capable of distinguishing between the major different families included in the test, without the need for detailed alignment and spatial superimposition.

even at the subfamily level with relatively little shape discrimination, the distance matrix retains some of its discriminatory power. a close examination reveals distinct patterns along the diagonal corresponding to the various groups of kinases in the test set .

the discriminatory power at the family level is limited by unresolved portions of some structures. the lack of coordinates for parts of the polypeptide chain affects the calculated distances both directly  and indirectly . to reduce these perturbations, we chose to ignore in our calculations any portion of the alignment corresponding to missing parts in at least one of the proteins in the set. most unresolved portions are relatively short  and do not affect the shape dramatically.

correlation with the cartesian representation
the multipolar description offers a hierarchical approach to characterizing the shape of a molecule. while at the coarsest level there is no information about the shape, except that defined by the length of the chain, at the most refined level of details  the description is as rich as the original amino acid coordinate set. at this end of the spatial spectrum we would expect a good correlation with results provided by the cartesian coordinates. to empirically prove this, we need to devise experiments in which both representations can be applied and then compare the results.

an obvious choice is the comparison of aligned proteins, alignment being necessary for the rmsd to be defined. since as yet we do not have tools for aligning proteins based on their multipole representation, we used the high quality expert alignments provided by the authors of the benchmark set  <cit> . we performed an analysis of how well distances calculated based on the multipole representation compare with the ones based on the cartesian coordinates. two different cases were considered, each defined by how the cartesian and multipolar representation were calculated in the two proteins.

case 1
in the first case, the rmsd distances were calculated based on a prior spatial superposition of the aligned structures . the rmsd-distance was calculated using the formula

rmsd=1n∑i <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgybgccqwgtbqbcqwgzbwccqwgkbazcqgh9aqpdagcaaqaamaalaaabagaegymaedabagaemota4eaamaaqafabawaaewaaeaacuwg4baegawcamaabaaaleaacqwgpbqaaeqaaogaeyoei0iafmyeaknbasaadawgaawcbagaemyaakgabeaaaogaayjkaiaawmcaamaacaaaleqabagaegomaidaaaqaaiabdmgapbqab0gaeyyeiuoaasqabagccqgguaglcawljagaaczcamaabmaabagaegymaejaegimaadacagloagaayzkaaaaaa@485d@

the two vectors in eq.  denote the coordinates of aligned residues. the multipoles of the aligned portions of the proteins were calculated with the coordinates expressed in the canonical reference frame defined by eqs. .

the multipoles of each protein in a given pair were computed from the cα coordinates only. the distances were calculated several times, each time retaining a different range of multipoles to analyze the results at different levels of structural detail. the coarsest calculation corresponds to retaining only multipoles up to rank  <dig>  and the finest one contains all multipoles up to rank  <dig>  for each set of distances obtained in this way we calculated their linear correlation coefficients with the set of rmsd values.

the correlation calculations are shown in figure  <dig> as a function of the highest rank of the multipoles retained in the description, i.e. of the level of detail. in this way, we have an image of how the level of detail of the representation affects the relationship between the two descriptions. the results in figure  <dig> are highly significant. the total number of pairs compared in the correlation set is  <dig> which places even the lowest point on the curve well below a p value of  <dig> . it is apparent from the correlation curve that, as expected from a theoretical standpoint, as the rank of multipoles retained in the representation increases, the similarity with the rmsd results improves. this tendency saturates after a certain level of detail is reached. if the relationship between the two sets of distances was linear, then the saturation would happen at a value equal to unity. in our case, the definition of the multipoles makes the relationship between the two quantities very non-trivial and therefore the linearity between them is, in general, excluded. this is one of the factors that contribute to the saturation of the correlation curve at values smaller than unity.

in figure  <dig> we show side-by-side the distance matrix in the multipole   and cartesian  representations. again, we see a clear discrimination between the various families in the set, especially in the multipole description. there are a number of extra features inside the tpk family that show up in the cartesian description and not in our representation. there are also some extra features in the multipole representation, especially inside the ak category, that do not appear in the distance matrix calculated from the cartesian coordinates. these extra features represent another factor that affects the correlation coefficient. as will be seen from the next calculations, the differences in these details are to a great extent related to the different prescription in the positioning of the proteins, for the purpose of comparison.

for a better understanding of how the two descriptions correlate, we need to analyze more carefully the distances in the two representations. to make the discussion more quantitative, in figure  <dig> we show the distances between all pairs of non-identical structures in a subset of the original collection of proteins. the subset contains nine structures: 1bol, 1ia <dig>  1e8x, 1cja, 1nwl, 1j7u, 1cdk, 1csn and 1ir <dig>  the first six are all ak representatives while the last three all belong to the tpk family. the ordering of the  <dig> resulting independent pairs is as follows: the first structure in the set is paired with all the rest in order; then the second in the set is paired with the rest, etc. for enhanced visibility, we rescaled the multipoles-based distances  and then shifted the whole set of values by the same amount. both figure  <dig> and figure  <dig> show that the multipolar distances follow in general big inter-family variations in the rmsd distances, but tend to smoothen the intrafamily variations. this is especially obvious inside the tpk family where more pronounced features are visible in the distance matrix in figure 3b. a closer examinations of figure  <dig> also reveals a clearly better correlation in the region of proteins placed closer in our ordering to the tpk family. this region includes roughly all pairs between the subset of structures from 1cja to the end of the list of representatives. the conclusion of a stronger correlation in this area is reinforced if we recalculate the correlation curve with only this subset of structures. the new curve, shown in figure  <dig>  saturates at values around  <dig>  for the correlation coefficient. the major disconnect between the two representations can be attributed to the left hand series of about  <dig> points in figure  <dig>  we can see that there is a high variability in the rmsd distances between at and tpk proteins which is not followed accurately by the multipoles-based distance. with our ordering, these are pairs of less related proteins. in this cases we are in the common situation where the rmsd in general has little informative value  <cit>  regarding the similarity of the structures and we need to look at global feature in order to characterize similarity. shape-based descriptors like ours offer a natural path towards a meaningful extension of the notion of similarity.

case 2
in a second set of calculations, both the multipole and rmsd-based distances were calculated in either the "canonical" reference frame, or after spatial superposition. in the second case the superposition was done by minimizing the rmsd between the structures. the results are shown in figures  <dig> and  <dig>  there is a visibly higher similarity between the two distance matrices than in figure  <dig>  this is quantitatively confirmed by a recalculation of the correlation coefficients which show a significant improvement over the previous case.

it is clear that, while the multipole description differs in some intrafamily details from the typical rmsd results, especially when the latest are calculated with spatial superposition, the results are quite robust in their capacity to discriminate between the families. the level of correlation increases with the level of detail of the representation, i.e. with the number of multipole approaching the dimensionality of the fold space. these latest results, when compared with the previous ones, suggest that the two ways of positioning the structures for the purpose of comparison are not entirely equivalent and the use of a "canonical" positioning produces a more robust clustering of the structures.

CONCLUSIONS
in this paper we propose a new parameterization of protein structure which provides a new form of characterization and comparison. the approach uses components of the multipoles of consecutive ranks associated with cα coordinates.

we have shown:

• once an approximate "superposition" has been calculated using our canonical reference frame, the multipole distance function is capable of discriminating between protein families.

• the multipole description allows for the adjustment of the level of detail of the comparison and, implicitly, it provides a systematic method for deriving reduced representations of the protein configuration space.

from a biological perspective, our tests show that the comparison based on multipoles is more robust with respect to intrafamily details and the results are more meaningful biologically. from the comparison tests with the cartesian description, its robustness appears to be related in part to the use of a "canonical" reference frame for the comparison rather than the spatial superposition of the structures. also, the visible relationship between the distance matrix in figure  <dig> and the family classification of the set, in contrast to the distance based on an exact amino acid alignment, suggest that multi-residue shape features are more important to the biological classification than local variations in the alignment. this supports the idea that evolution is more likely driven by shape optimization as required by molecular recognition. evolutionary events such as sequence insertions and deletions are merely the means to achieve optimal shape complementarity.

for illustration of the multipole method, we used the mass of the cα atoms as the relevant physicochemical property. this led to comparison of proteins with respect to their geometrical structure. the method can be refined with minimal changes to use various residue-specific quantities. the only technical difference will be the use of a weight for each term in eq. . the weight is a numerical functions that measure the property of interest, such as hydrophobicity, assigned charge, numerically encoded secondary structure information, etc. it can also represent a composite index reflecting a set of properties assumed to be relevant for investigating a given biological concept.

the use of alternative residue-specific quantities would provide a powerful tool for the comparison of proteins since the residue specific quantities allow an easier discrimination between structures with similar spatial location of the cα atoms but differing in local properties of the chain, such as secondary structure conformation for example.

our plans for further development and extension of the method include:

a) rigorous definition of the notion of "canonical" reference frame. our choice, based on features rigidly tied to the set of atoms is inspired by the body reference frames used in physical and engineering-sciences and is intuitive. however, the problem of comparing structures is different and criteria are needed for the identification of "good" reference frames and/or how they affect the protein comparison.

b) algorithms for fast superposition by minimization of the multipolar distance would be needed as an alternative to the use of a "canonical" reference frame.

c) the definition of a global metric  contains coefficients controlling the combination of multipoles of various orders. further optimization of these coefficients for the purpose of protein comparison can lead to biologically more meaningfull metrics.

as a final remark, our representation allows an estimation of the number of degrees of freedom necessary to describe a given class of properties. the saturation of the correlation with the cartesian representation marks the maximum number of degrees of freedom necessary to "macroscopically" distinguish structures within that class. since the structure determines the whole biology of the proteins, one can infer from here that the same number of degrees of freedom describes the whole functional space of that class of proteins. the number obtained from such a correlation curve can be used to adjust the dimensionality of the representations used in protein comparisons.

