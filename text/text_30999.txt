BACKGROUND
comparative genomics of bacteria and archaea  reveals extensive variation of gene repertoires, which is thought to reflect a highly dynamic regime of genome evolution . prokaryotic genomes present a wide variety of genome sizes, from approximately 150 kb in some intracellular endosymbionts of insects  <cit>  to approximately 13 mb in the largest cyanobacteria  <cit>  and myxobacteria  <cit> . this broad range of genome sizes is reflected in the diversity of gene repertoires: only a tiny minority of prokaryotic genes are  universal whereas the great majority are present in small subsets of genomes  <cit> . substantial differences in genome size and gene content are often evident between species within the same genus  and even between strains of the same species .

the enormous diversity of the gene repertoires among bacteria and archaea implies that prokaryotic genomes exist in a state of incessant flux, expanding through horizontal gene transfer , gene duplication and possibly de novo emergence of genes, and contracting via gene loss . beyond the comparative genomic observations, estimates of the genome dynamics rates in prokaryotes have been obtained via explicit evolutionary reconstruction using maximum parsimony or maximum likelihood  methods. these approaches typically employ the pattern of gene presence/absence in a set of species, which is mapped onto a guide phylogenetic tree . all evolutionary reconstructions performed with widely different groups of bacteria and archaea infer various combinations of vertical inheritance, gene loss and gain. averaged over long spans of evolution, gene loss appears to be a more common process than gene gain as shown for different groups of bacteria and archaea . in obligate intracellular parasitic bacteria as well as in parasitic archaea, gene loss is the single dominant evolutionary process . however, genome reduction, often described as streamlining, also prevails in the evolution of bacterial saprophytes  <cit>  and some free-living microbes, particularly in marine environments  <cit> . these findings are compatible with the observation of the overall deletion bias in the evolution of prokaryotic  genomes  <cit> . furthermore, gene loss has been reported to be a more uniform, ‘clock-like’ process than gene gain, which shows a stronger episodic character  <cit> . taken together, these findings have inspired the concept of genome reduction as the ‘default’ evolutionary process counterbalanced by episodes of gene gain, primarily via hgt  <cit> .

the discovery of the diversity of the gene repertoires, even among bacteria and archaea with closely related nucleotide sequences, led to a conceptual shift in microbiology. under the new view of the microbial world, the key unit of microbial evolution is not the genome of an individual bacterium or archaeon but rather the pangenome of a prokaryote species . the term ‘pangenome’ has been used alternatively to describe either the superset of the genes present in the genomes of all sequenced isolates of a given species, or the entire pool of genes that are potentially available for acquisition to the given species  over the course of its evolution. hereinafter, to avoid ambiguity, we restrict the use of ‘pangenome’ to denote the empirically detected superset of genes and use the term ‘supergenome’  <cit>  to refer to the entire gene reservoir. obviously, the supergenome of any microbial species cannot be characterized directly and can only be estimated from the analysis of samples of the relevant genomes. such estimates have pointed to vast, ‘open’ supergenomes for most prokaryotes because analysis of newly sequenced isolates did not show any signs of saturation of new gene discovery  <cit> . however, for a minority of bacteria, the supergenomes appear to be ‘closed’, with new genomes adding few if any new genes  <cit> . attempts to estimate microbial supergenome sizes have been made using either statistical approaches or explicit mathematical models of the evolutionary process. in particular, snipen et al.  <cit>  estimated the supergenome size for several bacteria using a binomial mixture approach  <cit>  to approximate the gene frequency distribution in an analyzed set of genomes. this analysis, unlike the earlier approximations, yielded closed and relatively small supergenomes that were only several fold larger than a typical microbial genome. a recent model of microbial genome evolution by gene replacement, known as the infinitely many genes model, under which the replacing genes are drawn from a formally infinite reservoir  <cit> , also suggested a close but much larger supergenome for the cyanobacterium prochlorococcus. on the whole, the accuracy of the available supergenome estimates and the validity of the underlying models remain uncertain. thus, delineation of supergenomes across the diversity of bacteria and archaea and elucidation of the factors that underlie the supergenome evolution are major tasks for evolutionary microbial genomics.

hgt is at present universally recognized as a major factor in the evolution of prokaryotes and a key source of innovation and adaptation to new environments and lifestyles . however, attempts at quantification have yielded widely different estimates of the prevalence of hgt. some early studies that involved a small number of genomes resulted in modest estimates, which implied a limited importance for hgt compared to vertical inheritance  <cit> . more recent phylogenomic analyses that included larger sets of genomes widely representative of the bacterial and archaeal diversity, generally reveal a much greater level of hgt . for example, a quantitative assessment of the contributions of vertical inheritance and hgt to the evolution of prokaryotes based on the topological comparison of thousands of phylogenetic trees suggested that nearly two-thirds of evolutionary events originate from hgt  <cit> . furthermore, evidence has been presented that hgt rather than gene duplication is the principal contributor to the evolution of gene families in prokaryotes  <cit> .

we were interested in taking a comprehensive census of various events of genome dynamics across the diversity of prokaryotes. to obtain reliable rates of these events, we sought to analyze groups of multiple, closely related genomes so that robust identification of gene orthology and estimation of phylogeny and evolutionary distances would be ensured. the rates of gene dynamics were estimated for  <dig> clusters of prokaryotic genomes that make up an updated version of the collection of alignable tight genome clusters   <cit>  using a phylogenetic birth-and-death ml model  <cit> . the results reveal extremely rapid genome dynamics, albeit with broad ranges of gene loss and gain rates among prokaryotic species, and indicate an overall tendency to genome contraction, which is partially compensated by gene gain via hgt. we show that the overall flux of genes is the defining parameter of genome dynamics and provide estimates of the supergenome size for diverse groups of prokaryotes.

RESULTS
genome dynamics in prokaryotes: extensive gene family loss and gain dominate over family expansion and reduction
we employed an updated version of the atgcs  <cit>  to reconstruct the genome evolution for  <dig> groups of bacteria and one group of archaea . from the clusters of orthologous genes  that are associated with each atgc, we derived the phyletic patterns  as well as data on the number of members of each family including all paralogous genes. these patterns were mapped onto the phylogenetic tree of the respective atgc  and employed for the evolutionary reconstruction using count, an ml method based on a phylogenetic gene birth-and-death model  <cit> . it should be emphasized that the cogs derived under this procedure account for the entire pangenome of each atgc, and thus include genes shared between any number of organisms within the atgc as well as genes unique to a single genome . thus, no biases that could result from using a subset of genes preselected on certain criteria, such as, for example, the degree of sequence conservation, affect the estimates described below.

the rates of four types of elementary evolutionary event  were analyzed:  gain of a gene family not present in the ancestor node ,  loss of all gene family members ,  expansion of a gene family, i.e. addition of one or several family members  and  reduction of a gene family, i.e. elimination of one or several family members . in mechanistic terms, gains are most likely to originate from hgt, and perhaps on rare occasions, from de novo gene birth; extreme divergence of duplicated genes that could lead to the appearance of a new family is highly unlikely on the short evolutionary scale of an atgc. gene family expansion is a combination of bona fide gene duplication and acquisition of a new member of a pre-existing family via hgt .

the number of gdes of each type associated with each tree branch shows a strong significant positive correlation with the branch length . thus, all these events appear to occur under a genomic clock, by analogy to the traditional molecular clock of sequence evolution  <cit> . the accuracy of the genomic clock was found to be the highest for gene family gain and the lowest for gene family loss  although this difference has to be taken with caution due to the limited number of data points . a bootstrap analysis  of the gde rates shows that the estimated rates are not disproportionately affected by a small number of outliers and also supports the observation on the wider scatter of the loss rate compared to the gain rate . previous analyses performed on genomes representing diverse branches of bacteria, have suggested that gene loss was more of a clock-like process than gene gain, which showed a tendency to occur in isolated episodes  <cit> . the present results suggest that this trend is not manifest at the short evolutionary scale of the atgcs, compatible with more recent observations of an apparent clock-like character of hgt, at least among universally conserved prokaryotic genes  <cit> .figure  <dig> 
the clock of genome dynamics. the figure shows the correlation of branch lengths and number of  gains,  losses,  expansions and  reductions. it excludes singletons, i.e., gains in the terminal branches of the tree. both x and y axes are have a logarithmic scale. all p <  <dig> . bl, branch length or number of nucleotide substitutions per site.



the demonstration of the existence of the genomic clock justifies the estimation of the rates of gain, loss, expansion and reduction per unit of nucleotide substitution and in what follows, we primarily use this measure.

table  <dig> shows the rates of each type of gde for the  <dig> atgcs. five major trends are immediately apparent:table  <dig> 
rates of the four types of genome dynamics events
a



atgc
genera
gain
loss
expansion
reduction

site
gene
site
gene
site
gene
site
gene
enterobacteria
enterobacter–klebsiella
streptococcus
streptococcus
streptococcus
bacillus
bacillus
chlamydia
chlamydia–chlamydophila
mycobacterium
mycoplasma
rickettsia
helicobacter
staphylococcus
lactobacillus
corynebacterium
corynebacterium
pseudomonas
clostridium
burkholderia
burkholderia
sulfolobus
bifidobacterium
bifidobacterium
listeria
shewanella
yersinia
xanthomonas
brucella–ochrobactrum
neisseria
francisella
campylobacter
acinetobacter
propionibacterium
legionella

afor each atgc, the rates of each type of gde per nucleotide substitution per site and per nucleotide substitution per gene are indicated.

i). the rates of gain and loss are approximately an order of magnitude greater than the rates of expansion and reduction.

ii). the loss rate typically is nearly threefold higher than the gain rate.

iii). the expansion rate is almost  <dig>  times higher than the reduction rate.

iv). the rates of all types of gde vary within a broad range, spanning almost two orders of magnitude ; the ratios between the rates of different events vary within similar ranges . this trend is independent of the number of species in an atgc .

v). the rates of genome change are remarkably high, typically tens of thousands of gdes per nucleotide substitution per site, or tens to hundreds of gdes per substitution per gene .
distributions of the genome dynamics rates across the atgcs.  rates of gain, loss, expansion and reduction per nucleotide substitution per site.  loss/gain and reduction/expansion ratios.  gain/expansion and loss/reduction ratios. g/e, gain/expansion; l/g, loss/gain; l/r, loss/reduction; r/e, reduction/expansion.



on the whole, the dominant process in prokaryote genome evolution is the loss of gene families, i.e. genome contraction. this finding provides definitive quantitative support for the previous, more qualitative conclusions of the importance of genome streamlining in evolution, particularly among prokaryotes  <cit> . however, due to the high variation in the rates of different processes of genome evolution, this general trend is reversed in some of the analyzed groups of microbes . in particular, despite the overall dominance of gene family loss, there are clear gainers among the analyzed bacteria, such as enterobacter, klebsiella, campylobacter and listeria. furthermore, the switch from the loss mode of evolution to the gain mode appears to occur in the course of evolution of some relatively close-knit groups of bacteria . specifically, the enterobacteriaceae and campylobacterales clades include both gainer and loser atgcs . rapid, extensive gene loss  is particularly prominent in legionella and corynebacterium .figure  <dig> 
distribution of the gain, loss, expansion and reduction rates over the evolutionary tree of prokaryotes. the tree is from microbesonline  <cit> . the areas of the circles are proportional to the rates of the respective events to a logarithmic scale. the numbers in parenthesis indicate the number of species in the atgc. the atgcs with episodes of rapid gene gain are denoted with * or **. atgc, alignable tight genome cluster.



estimates of gene dynamics rates and phylogenetic depth
when the events are analyzed on individual tree branches, the rates of all four types of gde strongly and negatively correlate with the phylogenetic depth of the respective branch . most likely, this observation reflects the fact that count only estimates the number of gdes for those gene families that survived in at least one extant genome. genes that were present at some point during the history of the atgc but have been subsequently lost, are missed altogether so that the corresponding gdes do not contribute to the calculations. these findings point to the high prevalence of such transient gdes in microbial evolution and suggest that our reported estimates  represent the low bound of the actual gene flux.figure  <dig> 
dependence of the rates of gains, losses, expansion and reductions on phylogenetic depth.  gains,  losses,  expansions and  reductions per unit of branch length vs the phylogenetic depth. the figure excludes singletons, i.e., gains in the terminal branches of the tree are not represented. both x and y axes have a logarithmic scale. the phylogenetic depth is measured in the number of nucleotide substitutions per site.



to estimate the extent to which count underreports the number of gdes, we used the dependence of the estimated rates on the depth of the branch mid-point. within each atgc, the observed rates were normalized to 100% at the depth of  <dig>  substitutions per site . the results indicate that at a phylogenetic depth of  <dig>  , count might underestimate the rates by up to 40%. at the more typical tree branch depth, the expected deficit is much lower. thus, we expect our estimates to be accurate within a factor of  <dig> at most. furthermore, we show that the relative gde rates are consistent independent of the phylogenetic depth . in agreement with the trend observed for individual branches, the atgc-wide estimate of the gene flux rate  also shows significant negative correlation with the total phylogenetic tree depth, estimated as the mean root-to-leaves distance .

factors of microbial genome dynamics
despite the substantial variability among individual atgcs, the genome dynamics rates appeared to be  randomly scattered across the diversity of prokaryotes  and in particular showed no significant differences between the three major bacterial phyla represented by multiple atgcs, namely proteobacteria, actinobacteria, and firmicutes . thus, the trends of genome contraction  and expansion  appear to hold for most of the lineages across the entire bacterial domain.figure  <dig> 
dependence of the rates of gain, loss, expansion and reduction on bacterial taxonomy and lifestyle.  rates of the four types of event for actinobacteria, firmicutes and proteobacteria.  rates of the four types of event for bacteria and archaea with three different lifestyles. fha, facultative host-associated; fl, free-living; p, obligate intracellular parasite.



we also compared the rates of gain, loss, expansion and reduction between microbes with three lifestyles, free-living, facultative host-associated and obligate intracellular parasite . perhaps unexpectedly, given the typically much smaller genomes of the intracellular parasites, the overall relationship between the rates of the four types of event did not depend on the lifestyle: loss > gain > > expansion > reduction. nevertheless, among the three groups, free-living bacteria present the highest rates of gain , expansion  and reduction , whereas obligate intracellular parasites and facultative host-associated bacteria show a modest but significantly higher rate of gene family loss than free-living bacteria  . thus, on the whole, genomes of free-living prokaryotes appear to be more dynamic than genomes of intracellular parasites which is compatible with the greater exposure to hgt in extracellular compared to intracellular habitats.

perhaps surprisingly, no connection was found to exist between the rates of the gdes and the strength of the selection pressure on protein sequences estimated as the ratio of non-synonymous to synonymous substitution rates in protein-coding genes   <cit> , which shows a robust correlation with various atgc-wide characteristics  <cit>  . neither did we detect any dependence of the four gde rates on the genomic gc content , notwithstanding the strong positive correlation between the gc content and genome size  <cit> , or with the genome shuffling rate .

flux and balance in prokaryotic genome evolution
we further examined possible correlations between different types of gdes. strikingly, relatively high, statistically significant, positive correlation was shown to exist between all types of event . these findings suggest that the dynamics of genome evolution in prokaryotes is largely determined by the overall gene flux.figure  <dig> 
correlations between the rates of gain, loss, expansion and reduction.




to further investigate key factors of genome dynamics, we performed principal component analysis  of the rates of gain, loss, expansion and reduction . in this case, the pca was remarkably efficient in revealing major trends of genome evolution. the first principal component explained approximately 64% and the second principal component approximately 19% of the variance in the gde rates, indicating that each of these composite variables reflected a major trend of genome evolution. the loadings plot  shows that all four rates  contributed to the first principal component with the same sign. accordingly, this principal component appears to reflect the overall gene flux, which thus appears to be the key determinant of genome dynamics. the second principal component was dominated by gene family gain and loss, which contribute with opposite signs . thus, this component reflects the balance of family loss and gain.figure  <dig> 
principal component analysis of the rates of gains, losses, expansions and reductions.
 xy-plot of the two first two principal components.  principal component analysis loadings. comp., component.



to account for the difference in the contributions of different gdes to the net extent of the genome change , we use the sum of all event rates as the measure of the total gene flux and the gain + expansion to loss + reduction ratio as the measure of the balance.

gene flux but not the balance of the gde positively and significantly correlates with the genome size . combined with the observations on the transient character of many genomic events, this finding implies that the larger microbial genomes are products of recent and conceivably short-lived gene accretion.figure  <dig> 
correlation between gene flux and genome size. the horizontal axis shows the median number of genes in a genome in an atgc. atgc, alignable tight genome cluster; gde, total gene flux .



evolutionary dynamics of different functional classes of genes
we further estimated the overall gene flux and the rates of each type of gde for broad functional categories of genes as defined in the cogs  <cit> . all rates showed largely consistent ranking of functional categories , in agreement with the overall positive correlation between them . predictably, genes encoding protein components of the translation system, which constitute the great majority of the  universal genes in cellular life forms , make up the category with the lowest flux per gene , closely followed by enzymes of nucleotide and coenzyme metabolism as well as molecular chaperones, which also tend to be highly conserved in evolution . in contrast, by far the most dynamic class included genes of mobile elements, followed by uncharacterized genes and genes involved in defense functions . it appears likely that numerous genes in the uncharacterized category actually are unidentified components of the mobilome or defense systems  <cit> , suggesting that, as one might expect, these two categories jointly make up the most dynamic component of microbial genomes. the difference between the per gene flux rates of the mobilome components and the translation genes was approximately fourfold, and when the gain rates were compared, the difference was greater than an order of magnitude. these findings are generally compatible with the patterns of long-term gene conservation  <cit>  and emphasize the heterogeneity of gene dynamics in bacterial and archaeal genomes.figure  <dig> 
genome flux by cog functional categories.  flux.  gain.  loss.  expansion.  reduction. designations of the functional categories : c, energy production and conversion; d, cell division; e, amino acid metabolism and transport; f, nucleotide metabolism and transport; g, carbohydrate metabolism and transport; h, coenzyme metabolism; i, lipid metabolism; j, translation; k, transcription; l, replication and repair; m, membrane and cell wall structure and biogenesis; n, secretion and motility; o, post-translational modification, protein turnover and chaperone functions; p, inorganic ion transport and metabolism; q, biosynthesis, transport and catabolism of secondary metabolites; r, general functional prediction only ; s, function unknown; t, signal transduction; u, intracellular trafficking and secretion; v, defense systems; x, mobilome. cog, cluster of orthologous genes.



supergenome size estimation
the results described above indicate that prokaryote genome evolution is an extremely dynamic process that involves rapid gain and loss of numerous gene families. this process can be naturally represented as sampling of a gene pool by the evolving genomes, which draw new gene families at random. we denote this gene pool the supergenome of an atgc, to differentiate it from the pangenome, the empirically observed superset of genes of a group of genomes. the size of the supergenome is unknown but can be estimated from the number of families that have been gained multiple times: obviously, with a vast supergenome, the chance to draw the same family again is effectively nil, whereas with a supergenome only slightly exceeding the typical genome size of a given group, many families will be gained repeatedly. we developed an ml model to estimate the size of the supergenome from the number of repeated gains; the estimates were obtained for two models of genome evolution, namely the simplest conceivable model, with a uniform probability of drawing a gene from the supergenome and a more complex model with a power-law distribution of the drawing probabilities .

the results obtained with the two approaches were consistent and showed a wide spread of estimated supergenome sizes, from approximately four genomic equivalents  to effectively open supergenomes  . in atgcs with closed supergenomes , the characteristic size of the supergenome was estimated at about an order of magnitude larger than the typical number of families in a genome . for these closed supergenomes, the estimates were highly reliable, with the confidence intervals typically less than 10% of the estimate .table  <dig> 
supergenome size estimates



atgc
genera
f
p
k
m
s
, uniform
s
, power

a
b
a
b
enterobacteria
enterobacter–klebsiella
streptococcus
streptococcus
streptococcus
bacillus
bacillus
chlamydia
chlamydia–chlamydophila
mycobacterium
mycoplasma
rickettsia
helicobacter
staphylococcus
lactobacillus
corynebacterium
corynebacterium
pseudomonas
clostridium
burkholderia
burkholderia
sulfolobus
bifidobacterium
bifidobacterium
listeria
shewanella
yersinia
xanthomonas
brucella–ochrobactrum
neisseria
francisella
campylobacter
acinetobacter
propionibacterium
legionella

a, number of gene families in the estimated supergenome; b, supergenome size in genome units ; f, median number of gene families per genome; k, total number of gene family gains; m, number of multiple gene family gains; p, pangenome size ; s, supergenome size .
comparison of genome, pangenome and estimated supergenome sizes.  median genome vs supergenome size.  density distribution of median genome, pangenome and supergenome size.
distribution of the median genome, pangenome and estimated supergenome sizes over the evolutionary tree of prokaryotes. the tree is from microbesonline  <cit> . areas of the circles are proportional to the number of genes in the respective genomes , pangenome, a006ed supergenome. fha, facultative host-associated; fl, free-living; o, open supergenome; p, obligate intracellular parasite.



the estimated supergenome size positively correlated with the mean genome size in an atgc, indicative of a trend of genome growth dependent on the pool of available genes . by contrast, and perhaps unexpectedly, the estimated supergenome size, expressed either as the number of families or relative to the genome size , does not correlate significantly with the gene flux or with gain, loss, expansion and reduction rates separately . in other words, microbes with large supergenomes can, at least transiently, evolve in a relatively static regime and conversely microbes with rapidly evolving genomes can have small supergenomes.

supergenome size estimates show a strong positive correlation with the total tree depth . this dependence is likely to stem from at least two factors. first, the deeper the divergence of the atgc, the more variation in the history of the environments, and therefore, in the adaptive requirements and the available gene pool, is expected. second, our supergenome estimate procedure is intrinsically dependent on the number of multiple gene gains, derived from the phyletic patterns. as shown above , the gene gain rate is underestimated in the deeper trees and branches; accordingly, the number of multiple gene gains is underestimated as well, resulting in inflation of the supergenome size estimates.

supergenome size estimates also show a strong and significant negative correlation with the atgc-wide estimate of the dn/ds ratio . this dependence might reflect genuine relationships between the characteristic population dynamics of the respective group, which affect the strength of the purifying selection on the protein-coding genes  <cit> . however, the dn/ds ratio estimates themselves are negatively correlated with the atgc tree depth  and genome size  <cit>  . thus, the apparent connection between the supergenome size and the protein-level selection might be due, at least in part, to indirect effects.

there are clear connections between the obtained supergenome size estimates and the microbial lifestyle. thus, nine of the eighteen free-living microbes in the analyzed set but only two of the seventeen host-associated microbes were estimated to possess open supergenomes  . this substantial excess of open supergenomes among free-living organisms could be expected as the result of their greater exposure to diverse gene pools. also in line with the lifestyles of the respective microbes, by far the smallest supergenomes were estimated for intracellular  and extracellular  parasites with highly reduced genomes; intracellular parasites with somewhat larger genomes  appeared to have larger supergenomes, suggestive of a distinct evolutionary history .

previously published supergenome size estimates  can be broadly classified into three categories. estimates based on the sampling curve use an approximation for the number of new genes brought into the pangenome by additional genomes with a  function . if such a function converges to a finite total number of genes, a supergenome is considered closed and a quantitative estimate can be produced, otherwise the supergenome is considered open. another category of estimates employs an explicit sampling model that assumes random independent sampling of genes from a common pool into individual genomes  <cit> . the third category employs a tree-based model of evolution of a group of genomes where sampling is performed along the tree branches  <cit> . the latter two approaches explicitly or implicitly fit the sampling model parameters to the observed distribution of gene frequencies in the analyzed set of genomes.

a comparison of the published estimates with those obtained in this work  shows that our estimates are consistently higher than those obtained with the models that assume that genomes are random independent collections of genes. the likely explanation is that the independence assumption inherent in these models leads to overestimates of the number of multiple gene gains by counting such gains for a family found in each genome within a clade, whereas the most likely scenario is that this family had been gained only once. overestimation of the number of multiple gains necessarily leads to underestimation of the supergenome size. the estimates based on sampling curves yield open supergenomes for the majority of microbial groups. these approaches attempt to derive the exponent of the approximating power functions from the limited available samples, leading to much uncertainty. the fact that the infinitely many genes model could not be rejected, even in a tree-based analysis  <cit> , might indicate that many microbial supergenomes are close to the closed/open boundary. thus, it appears possible that neither the sampling curves nor the distributions of gene frequencies contain sufficient information to produce robust supergenome estimates. the approach employed here used the number of multiple gene gains directly inferred from the superposition of phyletic patterns of genes over a phylogenetic tree and, being independent of the assumptions of other models, could potentially improve the reliability of supergenome estimates, compatible with the narrow confidence intervals .

discussion
the rapid dynamics of prokaryotic genome evolution
the analysis of prokaryotic genome dynamics described here unequivocally shows that rapid gene flux involving extensive loss of genes and families, partially balanced by gain of new gene families via hgt, is the principal mode of microbial evolution. indeed, the estimated rates of gene family gain and loss in some groups of bacteria are such that multiple genes appear to come and go over the time required for a single nucleotide substitution to occur in an evolving gene. these findings are compatible with experimental results demonstrating bacterial genome contraction in real time  <cit> .

given that the great majority  of nucleotide substitutions in evolving microbial genomes are silent  <cit> , and even among those that affect protein sequences many are effectively neutral, it seems indisputable that rapid gene flux is the most important route of change in prokaryotic evolution. notably, the present results show substantially greater rates of gene family loss and gain compared to family contraction and expansion rates. thus, the gene flux is not only rapid and extensive but often leads to qualitative changes in the gene repertoires. in general terms, these results emphasize that prokaryotic evolution is largely driven not by small variations, such as single nucleotide substitutions, but by much more dramatic changes brought about by hgt and gene loss.

in agreement with previous observations made for larger evolutionary scales  <cit> , we found that on the microevolutionary perspective that is provided by the atgc analysis, gene family loss prevails over gain, and the difference between the rates of loss and gain is often substantial. why, then, do prokaryotic genomes not shrink out of existence? the answer is likely to be twofold. some of the bacteria actually might be headed towards extinction as observed for the tiny genomes of some intracellular parasites  <cit> . however, the more common scenario would involve evolving prokaryotic lineages going through long phases of genome contraction, and our analysis caught most of them, punctuated by shorter bursts of extensive gene gain, which we detected in a few groups and which compensate for the gradual gene loss. the non-clock like character of gene gain inferred on a longer timescale  <cit>  implies that such periods could be short but would involve massive amounts of genetic material, making detection of such episodes through comparative analysis of tight groups of microbes unlikely.

the median relative and to a large extent even absolute  rates of loss, gain, reduction and expansion are highly consistent between the major bacterial phyla, surprisingly do not depend on the atgc-wide dn/ds estimates, and only weakly depend on the lifestyle . however, these rates showed a clear link to gene function, in a good agreement with prediction made from the long-term conservation of different functional classes of prokaryotic genes.

the variation in the gde rates among individual atgcs is substantial, spanning nearly two orders of magnitude . at present, it is unclear why some genomes rotate genes fast and others slowly, apparently irrespective of the size of the gene pools that are available for hgt. the weakness of taxonomic coherence and connection to the microbial lifestyle imply that the defining factors have to do with specific, local aspects of microbial ecology. identification of these factors is a major challenge for future comparative genomic and experimental studies.

a limitation of the evolutionary reconstructions reported here is that the ml approach implemented in count  <cit>  takes as input the gene family membership matrix, without explicitly exploiting information on the level of sequence similarity and phylogenetic relationships within individual families. in principle, more precise reconstructions taking into account this additional information are possible through the use of tree reconciliation approaches that compare gene trees to species trees . most of the available tree reconciliation algorithms are computationally prohibitive but recently, efficient, fast methods have been reported  <cit> . nevertheless, application of even this promising approach on the scale addressed in this work and statistical assessment of the results remain challenges for future studies. in practice, it appears that tree reconciliation has the potential to uncover cases where a gene in a particular lineage, although included in a cog, shows a phylogenetic position significantly different from that in the species tree, and hence could actually have been acquired via hgt. such cryptic hgt events could be of two kinds:  displacement of an existing family member by a xenolog, i.e. a homolog from a distant lineage, known as xenologous gene displacement and  acquisition of a ‘pseudoparalog’ , i.e. an additional family member, again from a distant source  <cit> . importantly, only events within families would be involved and the family gain estimates would remain unaffected. the findings of this work indicate that the contribution of pseudoparalog acquisition is small, given that the estimated family expansion rates are about an order of magnitude lower than the gain rates. the extent of xenologous gene displacement is unknown and remains an interesting target for further analysis. regardless, it should be emphasized that the refinement of the gde rate estimates that potentially could be obtained through tree reconciliation, can only lead to an upward reassessment of the rate of hgt. thus, taking into account also the apparent underestimation by count of events at deeper branches of the atgc trees , the gde rates obtained here, even if strikingly high, should be considered as lower bound estimates.

the supergenomes
the supergenome size estimates from the rates of repeated gene gain showed, in a broad agreement with previous observations, that some of the microbes possess well-defined closed supergenomes whereas other supergenomes appeared to be open. the typical closed supergenome size was estimated to be about tenfold larger than the characteristic genome size in the respective atgc, indicating a large but clearly limited gene pool available to genome dynamics. the supergenome size does not show significant correlation with the overall gene dynamics, but seems to be associated with the phylogenetic depth of the atgc tree and with the lifestyle, as open supergenomes are substantially more common among free-living compared to host-associated microbes. the accelerating sequencing of microbial genomes will put these estimates to test without much delay.

CONCLUSIONS
the reconstruction of short-term gdes shows that microbial genomes exist in a state of perennial flux, gaining, losing, expanding and contracting gene families. typically, genome dynamics processes are rapid, with gains and losses of multiple gene families occurring within the time frame of a single nucleotide substitution per gene. thus, gene flux is the dominant mode in microbial evolution such that microbes primarily differ from each other on the scale from static to highly dynamic. the rates of gene family gain and loss in most microbial groups are approximately an order of magnitude greater than the rates of expansion and contraction of pre-existing families, indicating that hgt is the principal source of new genes in prokaryote evolution. overall, gene family loss notably prevails over gain, i.e. evolving genomes appear to spend more time contracting than expanding. it seems most likely that the gradual gene loss is compensated for by episodes of rapid gene gain; most such bursts are outside the evolutionary scale accessible through atgcs although a few were detected. the absolute as well as relative rates of gdes show remarkable variance among bacteria, spanning almost two orders of magnitude, and do not significantly depend on the atgc-wide dn/ds estimates, the taxonomic affinity of microbes or their lifestyle. conceivably, genome dynamics is highly sensitive to local ecological factors, the exact nature of which remains to be elucidated. the analysis of genome dynamics allowed us to estimate the size of microbial supergenomes, which in the majority of the analyzed microbial groups turned out to be large but closed, exceeding the characteristic genome size by about an order of magnitude, but for a minority of microbes appeared to be open.

