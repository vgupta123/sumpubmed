BACKGROUND
protein-rna interactions play a vital role in various fundamental cellular processes, such as transcription and the post-transcriptional processing of pre-mrna, the stability and localization of mrna and translation  <cit> . defects in these rna-binding proteins  may lead to many human diseases, including neuropathies, muscular atrophies and cancer  <cit> . consequently, the detection of the rna-binding residues  in a protein will provide insight into the underlying molecular mechanism of these important biological processes and contribute to the development of new therapeutic methods for relevant diseases. several experimental approaches are used to detect rna-binding sites in a protein, such as x-ray crystallography, nuclear magnetic resonance , ultraviolet crosslinking and immunoprecipitation   <cit>  and site-directed mutagenesis. however, these experimental methods are inefficient in identifying rbrs because they involve laborious and time-consuming procedures  <cit> ; therefore, accurate and efficient computational techniques are required to infer the most likely candidate residues in rna interfaces directly from the sequences or/and structures of rbps. with the assistance of these excellent computational methods, researchers can perform more targeted assays to detect rna-binding sites and further explore the mechanisms behind the interactions between proteins and rnas.

recently, a significant number of computational methods predicting rna-binding sites have been developed through the comprehensive analysis of sequences and structures of rna-binding proteins. several fundamental structural and physicochemical principles underlying the mutual recognition of protein and rna have been discovered . these computational predictors can be broadly divided into sequence- and structure-based predictors in terms of the key information that they use to characterize protein residues. sequence-based methods are usually machine learning-based and their classifiers are trained using features derived directly from protein sequences. amongst the sequence-derived features, evolutionary information in the form of position-specific scoring matrix  is one of the most frequently used features and is proved a powerful descriptor for discriminating rbrs from non-rbrs . several other descriptors are also commonly used including predicted solvent accessibility , predicted secondary structure  <cit> , physicochemical property  <cit> . most of these sequence-based methods are developed by support vector machine , but in a few methods, some other classification algorithms are adopted, such as naïve bayes  <cit> , c <dig>  decision tree  <cit> . unlike sequence-based methods, structure-based methods use various features extracted from the atomic coordinates of protein-rna complexes to recognize interface residues using different techniques, such as machine learning , scoring  and template-based methods  <cit> . as proteins directly recognize their target rnas by some of their surface residues and because the geometrical properties of these surface residues may be different from those not in the protein-rna interfaces, several structure-based approaches have calculated surface geometry from the structure of an rbp  <cit> . in addition, various other structural features, such as solvent-accessible surface, electrostatics and secondary structure, as well as evolutionary and statistical features are also frequently used. template-based methods commonly align a target protein structure to the known protein-rna complexes in the templates library using a certain structural alignment program  <cit>  and then select a most likely predicted complex structure containing the target protein and rna of the template library. finally, the rna-binding residues of the protein are inferred directly from the predicted complex structures. one recently developed structure-based method could predict both rna- and dna-binding residues with excellent performance  <cit> .

the number of known proteins that can interact with rna only account for a small fraction of the solved structures, other structures may also have unknown potential rna-binding activities. structure-based prediction methods can use the known structural information to identify likely rna-binding sites on the structures of hidden rbps, and these discriminative structural characteristics cannot be calculated from pure protein sequences because the mechanisms of protein folding from sequence to spatial structure are not exactly known. consequently, the key to accurately predicting rbrs from protein structures is to compute structural descriptors that can distinguish between residues that interact with rna and those that cannot interact with rna efficiently.

to design structural features with relatively strong discriminatory power and excellent applicability, two structural features are computed, the residue electrostatic surface potential and the triplet interface propensity. although the calculation of the residue electrostatic surface potential in our study only involved several simple processes without considering other factors such as solvent and ion, this newly designed feature was helpful for detecting rbrs, and the electrostatic interactions between a protein and its partner rna are commonly observed; therefore, the electrostatic feature was expected to be applicable to different rbps. the feature triplet interface propensity in our study was calculated based on the protein secondary structure and spatial atomic coordinate information in each protein-rna complex; moreover, for each interface triplet type, we divided the interface triplet into four subtypes according to the rna-binding properties of two neighboring residues of the centre residue. we believe that the incorporation of different types of features may uncover the mechanisms for protein-rna interaction from different angles and will help a classifier generate a more accurate prediction. therefore, several excellent features, such as evolutionary information in the form of pssms, physicochemical properties and geometrical features were used together with the two newly designed structural features. to encode a target protein residue with the feature information of its neighboring residues, we searched the optimal type and size of a patch containing several neighboring residues of the target residue for each type of feature. thus, we developed a random forest classifier, as was implemented in a web server named rnaprosite , combined with hybrid features from both sequences and structures, and the area under the receiver operating characteristic  curve  of five-fold cross-validation on a non-redundant training dataset containing  <dig> rbp chains was  <dig> .

methods
datasets
two groups of datasets are used in this study: i) rbp <dig> was used to construct the prediction model proposed in this study; rbp <dig> was used for benchmark test of our prediction model with other common available models. ii) rbp <dig> and rbp <dig> were constructed for evaluating the importance of some important factors on the prediction performance such as the composition of datasets, the selection of machine-learning algorithms and the definition methods of rna-binding sites of proteins.

rbp <dig> and rbp68
all of the available structures of protein-rna complexes in the pdb ≤  <dig>  Å and resolved by x-ray crystallography before january  <dig> were obtained. then, we used the pisces program  <cit>  to ensure that the resulting dataset shared ≤ 40 % sequence similarity. thus,  <dig> rna-binding protein chains were left, and two of which  had residues lacking carbon alpha  atoms; therefore, we discarded the two chains to enable the execution of the dssp  <cit>  software, which was used to generate secondary structure features for proteins. then, we excluded protein chains whose sequence length was less than  <dig>  and finally, a dataset consisting of  <dig> protein chains was constructed,  <dig> of which were randomly selected to constitute the rbp <dig> for model training, the others were used to construct rbp <dig> for the benchmark of prediction models. the ratio of rbrs and non-rbr from rbp <dig> and rbp <dig> is about  <dig>  and  <dig> .

rbp <dig> and rbp42
as the sequence of identity of 40 % cannot necessary exclude redundancy, so we used the cutoff of 25 % for pisces program  <cit>  to remove the redundant sequences in rbp <dig> and rbp <dig>  and many rna binding proteins in different organisms may share sequence identity below 20 % but with the similar structure, and such homologous proteins could easily be detected by pssm profile, so we further removed the protein chains sharing the same class, architecture, topology and homologous   <cit>  code with other protein chains. finally, a dataset rbp <dig> containing  <dig> rbp chains was constructed from rbp <dig>  and rbp <dig> containing  <dig> rbp chains was derived from rbp <dig>  no pair of chains in  rbp <dig> and rbp <dig> shared more than 25 % sequence similarity and same cath code. the ratio of non-rbrs and rbrs in rbp <dig> and rbp <dig> is about  <dig>  and  <dig> . a complete list of all of the pdb codes for the datasets constructed could be found in additional file  <dig> 

distance-based definition of rna-binding residues is frequently used  <cit> . two kinds of cut-off values for the definition of rna-binding protein residues, namely 5 Å and  <dig>  Å, were used in this study to explore the effects of the selection of cut-off values on the prediction accuracy of our method. a cut-off value of 5 Å was used to define the rna-binding sites on rbp <dig> and rbp68; specifically, an amino acid residue was considered an rna-contacting residue if it contained one or more heavy atoms within 5 Å of any atom in the bound rna. the cut-off value of  <dig>  Å was used on rbp <dig> and rbp <dig> 

random forest  implementation
the prediction of rbrs is actually a binary classification problem, and rf was used to perform the binary classification in this study. the rf algorithm is a popular machine-learning method that uses an ensemble of tree-structured classifiers  <cit> , each of the tree classifiers in the forest is constructed using different bootstrap samples from the original training data set. the rf is very user friendly because it is usually not sensitive to its only two main parameters   <cit> , which makes rf more efficient than the frequently used svm because learning with svm is time-consuming with respect to the selection of the optimal parameters and kernel functions for the classifier. in addition, rf is relatively robust to outliers and noise. several practical applications of rf have demonstrated excellent performance in prediction studies  <cit> . an open-source rf tool for the matlab windows  was used to develop our classifier, in which the default parameters for rf were used.

protein features
to develop a powerful structure-based site predictor for rbps, one of the keys is to design discriminative features derived from the protein structure information and to adopt other different features charactering the mechanisms of protein-rna interactions. in this study, five types of features were used to characterize protein residues: two newly designed structure-derived features  and three other common excellent features .

electrostatic feature for each surface residue
protein surfaces mediating protein-rna interactions are commonly characterized by positive electrostatic potential due to the charge complementarity with negatively charged phosphate groups in the rna  <cit> . moreover, these surface residues are commonly spatially near to each other, therefore, we calculated the electrostatic potential value for each residue located on the protein surface and then applied a density-based clustering algorithm to determine whether an amino acid residue is in the largest surface patch with positive electrostatic potential and negative electrostatic potential. although the role of electrostatic interactions has been extensively used, we provided a new procedure for the calculation of electrostatic interactions in this study.

first, the dms program  was used to generate the surface points of each rbp extracted from protein-rna complexes. the output consists of a series of atoms and surface point records; each atom is followed by the surface points that belong to it. second, each protein structure was assigned charge and radius parameters from the parse force field  <cit>  using the pdb2pqr software  <cit> , which could also rebuild the missing heavy atoms of the initial protein structure and then add hydrogen atoms to the reconstructed structure to ensure the calculation accuracy of electrostatic potential. third, we calculated the electrostatic potential at a surface point; the classical formula for the calculation is given by:  <dig> vf=∑iqiε|ri−f| 

where qi is the charge for atom i whose euclidean distance away from point f is |ri − f|. here, we used a distance-dependent dielectric constant to define ε as |ri − f|. the calculation of electrostatic potential vf considers all of the atoms within a distance threshold of 7 Å as distances ≤7 Å can be important for protein-nucleic acid interactions  <cit> . the electrostatic potential for an atom  is defined as the mean of vf values of all of the surface points belonging to the atom. similarly to the calculation for an atom, a residue’s electrostatic surface potential  is defined as the mean of va values of its component atoms. for any residue that has no surface points according to the results of the dms program, its vr value is assigned as zero.

to construct the largest spatially continuous positive patch on the rbp surface, dbscan  <cit> , a density-based spatial clustering algorithm, was used to find the largest positive surface patch and the largest negative surface patch on a protein. we initially represent a surface amino acid residue as a point, and the x, y and z for the point are calculated as follows:  <dig> x=∑i,   <dig> y=∑i,   <dig> z=∑i 

where  is the coordinate of the point representing a surface residue,  is the coordinate of atom i of the surface residue, ni is the number of surface points belonging to an atom i of the surface residue, and n is the sum of surface points belonging to all of the atoms of the surface residue. based on a set of coordinates of the points representing protein residues, dbscan  <cit> , a density-based spatial clustering algorithm was used to cluster the residues with positive vr values to construct the largest positive surface patch or with negative vr values to construct the largest negative surface patch. the reason for using dbscan instead of other clustering methods, such as hierarchical clustering, which has been used in several studies  <cit> , is because the protein-rna interfaces frequently have irregular shapes and dbscan can find arbitrarily shaped clusters on the protein surface. two parameters are required by dbscan: the minimum number of points  needed to form a cluster and ε. the clustering algorithm can find all of the potential clusters that consist of a maximum of possible core points and their neighboring points within a sphere of radius ε. a core point is defined as a point surrounded by no less than minpts neighboring points within a distance ε. all of the core points in a cluster must satisfy one condition: for each two core points, represented by x and y, there exists at least one consecutive sequence of n +  <dig> core points represented by  in the cluster and each core point pi is not farther away from its next and former core point in the sequence than a given distance ε. based on the clustered surface residues, we selected the cluster containing the largest number of residues to be the largest surface patch. as the distances of important interactions  between proteins and rnas are usually ≤7 Å  <cit> , so ε was set to 7 Å. according to our statistics, there averagely exist about two surface residues with negative  electrostatic potential within a distance of 7 Å of a surface residue with negative  surface electrostatic potential in rbp <dig>  thus minpts was set to  <dig>  which is larger than the average value  <dig>  finally, the electrostatic feature for a particular residue in a protein sequence can be described by a three-dimensional vector, the first value in the vector is the vr of the residue; the second is assigned by number  <dig> or  <dig> to specify whether the residue is in the largest positive patch; and the third is assigned by number  <dig> or  <dig> to specify whether the residue is in the largest negative patch. for residues with no surface points, the three values are assigned to the number  <dig> 

triplet interface propensity
the sequentially adjacent neighbors of interface rna-binding residues have significant biases in amino acid types  <cit> , this phenomenon also exists in protein-dna interfaces  <cit> . here, we designed a statistical feature to describe the phenomenon, namely triplet interface propensity, based on the rbp chains in the datasets used here. a consecutive three-residue segment along the sequence of an rbp chain is designated as an interface triplet when its centre residue is rna-binding and the three-residue segment is a surface triplet, in which each residue has a relative solvent accessibility  greater than 3 % . the calculation of triplet interface propensity is first defined by the following equation:  <dig> rx=∑p=1p=nfx,p×lnfx,pfx',p 

where x represents a type of triplet on protein-rna interfaces, x ' represents the same surface triplet as x , p represents a certain rbp chain, n is the number of protein chains involved in the statistical procedure, fx,p represents the frequency of an interface triplet x in the interfaces of a rbp chain p and its bound rna, fx,p is calculated as:  <dig> fx,p=nx/nall 

where nx represents the number of heavy atoms interacting with rna in the triplet x, and nall is the total number of heavy atoms interacting with rna in protein p. fx ',p represents the frequency of a surface triplet x ' in an entire protein p, fx ',p is calculated as:  <dig> fx',p=tx'/tall 

where tx ' represents the number of surface triplets of x ' in protein p and tall represents the number of all of the likely surface triplets in protein p. an interface triplet may have different types when considering the rna-binding properties of the two neighboring residues of the centre residue. to specify the contributions of the two neighboring residues to the propensity of an interface triplet, we further described the propensity of a given interface triplet x with a vector of length  <dig>  specifically, rx is represented by rx <dig>  rx <dig>  rx <dig> and rx4; these four values describe the propensities of four subtypes of an interface triplet, namely, triplet_ <dig>  triplet_ <dig>  triplet_ <dig> and triplet_ <dig>  respectively. in triplet_ <dig> of interface triplet, both the first and third residues are rna-binding, whereas in triplet_ <dig>  the first and third residues are not rna-binding. in triplet_ <dig>  the first residue is rna-binding, and the third is not; however, in triplet_ <dig>  the third residue is rna-binding, and the first is not. therefore, any interface triplet may have one or more of the four subtypes, represented by triplet_ <dig>  triplet_ <dig>  triplet_ <dig> and triplet_ <dig> 

the protein secondary structure information is widely used in the prediction of rna-binding sites; here, we calculated the propensities of secondary structure types for interface triplets, and the secondary structure type of an interface triplet was determined by that of its centre residue. the dssp program  <cit>  was used to calculate the secondary structure type for each individual amino acid residue, and the resulting eight secondary structure types were further divided into three states using the following rule: secondary structure types i, g, and h were considered to be helices and represented by the number 1; types e and b were considered to be sheets and represented by the number 2; and the other types were considered to be coils and represented by the number  <dig>  the following equation was used to calculate the propensity for the secondary structure type of an interface triplet:  <dig> ix,s=∑p=1p=nnx,s,p/∑p=1p=n∑s'=1s'=3nx',s',p 

where x represents a type of triplet in the protein-rna interface, x ' represents the same triplet as x on the protein surface, nx,s,p represents the number of interface triplets x with secondary structure type s in protein p, and nx ',s ',p is the number of existing surface triplets x’ with secondary structure type s’.

when the propensity for the secondary structure type of an interface triplet is considered, the 4d vector describing the propensity for a supposed interface triplet x should be calculated using two procedures. one procedure is to compute the values of rx <dig> rx <dig>  
rx <dig>  
rx <dig> and ix,s for the triplet x, whose secondary structure type is known as s according to the output of dssp program  <cit> , after which the 4d vector can be finally defined as ix,s×rx <dig> ix,s×rx <dig> ix,s×rx <dig> ix,s×rx <dig> 

pssm profile
the position-specific scoring matrix , generated by using the psi-blast program  <cit>  to search against the ncbi’s non-redundant  database , was used to represent the evolutionary conservation of each amino acid in a protein sequence. for those with missing residues in protein structures, we just use its sequence to generate pssm profile and then we remove the information of missing residues from the generated pssm profile. the generated pssm scoring matrix of a protein with n residues has 20 × n elements.

geometrical characteristic
in this study, the accessibility of protein residues was calculated using the program naccess  <cit> , which uses the lee and richards algorithm  <cit> . five values that describe the relative solvent accessibility  of all atoms, side chain atoms, main chain atoms, non-polar side chain atoms and polar side chain atoms of each amino acid residue were extracted from the outputs. to characterize the shape feature of a residue on the protein surface, the cx value  <cit>  of the residue is calculated by the summation of the cx values of its component atoms. for a residue with one or more atoms with an accessible surface area  that exceeds  <dig>  Å <dig>  the residue may have one of the following shape characteristics based on the cx value of the residue: dented  represented by the number  <dig>  intermediate  represented by the number  <dig> and protruded  represented by the number  <dig>  for a residue that is buried and has no cx value, its shape characteristic is set to the number  <dig>  the asa for each atom was also calculated by the program naccess. the rsa and shape characteristics for a residue were considered the geometrical characteristics of the residue as represented by a 6d vector .

physicochemical property
in our study, the physicochemical property of a residue was characterized by a vector of length  <dig>  representing the ten types of properties of an individual amino acid residue extracted from the aaindex  <cit> , as shown in table  <dig>  the selection of properties from aaindex mainly involved the calculation of correlation coefficient between interface propensities   <cit>  and properties of twenty amino acid residues in aaindex. the details could be seen in additional file  <dig> table  <dig> list of the aaindex indices used in this article



encoding scheme
previous studies have demonstrated that considering the neighborhood of a residue can significantly improve the accuracy of identifying whether the residue is a rbr  <cit> . two types of patches to incorporate neighboring residues are commonly adopted: a sequential patch that is often used in sequence-based methods and a structural patch that is frequently employed in structure-based methods. a sequential patch of size n for a target residue is the set of n- <dig> residues nearest to the target residue along the primary protein sequence and the target residue itself. similarly, a structural patch of size n for a target reside is defined as the set of the target residue and its n- <dig> nearest neighbor residues according to the euclidean distance between the coordinate of these neighbor residues and that of the target residue  <cit> . in this study, we analyzed the prediction performance for each individual feature combined with the two types of neighborhood construction techniques, which was expected to select the best patch type with optimal size for a certain feature type. then, for a single target residue that was initially represented by five types of descriptor vectors whose size are d <dig>  d <dig>  d <dig>  d <dig> and d <dig>  with optimal sizes of the optimal patch type for each descriptor of s <dig>  s <dig>  s <dig>  s <dig> and s <dig> , respectively, the target residue is represented in a feature vector with  <dig> , d1 = 3; d2 = 4; d3 = 20; d4 = 6; d5 = 10; s1 = 11; s2 = 7; s3 = 5; s4 = 5; s5 = 9) elements.

evaluation measures for the prediction model
to assess the predictive power of rnaprosite on test datasets, five parameters were used, i.e., sensitivity , specificity , positive predictive value , accuracy , f-score and matthews’s correlation coefficient . mathematically, these parameters are defined in the following equations:  <dig> sn=tptp+fn,   <dig> sp=tntn+fn,   <dig> ppv=tptp+fp   <dig> acc=tp+tntp+tn+fp+fn,   <dig> mcc=tp×tn×fp×fntp+fntp+fptn+fptn+fn,   <dig> f−score=2×tp2×tp×fp+fn. 

where tp is the number of true positives, tn is the number of true negatives, fp is the number of false positives, and fn is the number of false negatives. the fivefold cross validation method was used to evaluate the prediction model. for fivefold cross validation, the entire protein residues in a dataset were randomly partitioned into five parts with approximately the same size, after which the classifier was trained in the four parts and tested on the remaining part. this procedure was repeated five times to ensure that each protein residues is tested once. the performance of fivefold cross-validation was measured by means of roc curves and area under the roc curve .

web server
the rnaprosite web server can be freely accessed at http://lilab.ecust.edu.cn/nabind.

RESULTS
distribution of electrostatic surface potentials
to explain the importance of the electrostatic surface potential in the identification of rbrs, we analyzed the distribution of the electrostatic potential values for all of the rbrs and non-rbrs in rbp <dig> in fig.  <dig>  from the two distribution curves of positive samples and negative samples, the two distribution curves cross at a point whose electrostatic potential value is approximately  <dig> , and when the electrostatic potential value is less than that of the cross point, the negative samples have a higher proportion than the positive samples, but the opposite occurs when the value is larger than that of the cross point. in total, the evident difference in the two distribution curves demonstrates that the tendency for a residue to be an rbr occurs when the residue has a positive electrostatic surface potential, whereas that for a residue to be a non-rbr occurs when the residue has a negative electrostatic surface potential.fig.  <dig> the distribution of electrostatic surface potentials for both positive  and negative  samples in rbp <dig>  the cross point of the two distribution curves is at 



distribution of clustered patches in rbrs and non-rbrs
to investigate the effectiveness of the dbscan clustering that determines whether a surface residue is in the largest positive patch or largest negative patch, we counted all of the protein residues in rbp <dig> that interact and do not interact with rna. for positive samples and negative samples in rbp <dig>  the proportion of residues in the largest positive patch and largest negative patch of each protein chain was calculated. as shown in fig.  <dig>  the residues in the largest positive patch accounted for approximately  <dig>  % of all of the positive samples, but the percentage of residues in the largest negative patch was only approximately  <dig>  %, demonstrating the excellent capability of the clustering feature to distinguish residues involved in rna-binding from those not involved and revealing the preference of interface residues for a connective surface area with positive electrostatic potential. a moderate percentage  of the residues belong to “other residues”, indicating that some rna-interacting residues were just not in the largest positive patch. when the composition of negative samples was analyzed, the residues in the largest negative patch accounted for approximately  <dig>  % more than the percentage for those in the largest positive patch.fig.  <dig> the distribution of patch types in positive samples and negative samples. the residues neither in the largest positive patch nor in the largest negative patch of each chain in rbp <dig> are labeled as “other residues”



analysis of the triplet interface propensity and subtypes of interface triplet
to illustrate the significance of the triplet interface propensity in the inference of interface residues, the residues of two proteins are colored from white to blue according to the propensity values, as shown in fig.  <dig>  because the interface propensity of a certain residue triplet is represented by a 4d vector representing the four subtypes of the residue triplet, as mentioned in methods section, we summarized the four values of the vector and used the results to color the center residue of the residue triplet. larger calculated values are represented by darker colored residues. figure  <dig> and  demonstrates that in most cases, the residues interacting with rna are colored darker than those that do not interact, indicating that the feature triplet interface propensity may be distinguishing. the variation range of the summarized triplet interface propensities of residues in rbp <dig> was from − <dig>  to  <dig> ; the mean triplet interface propensity of all of the protein residues in rbp <dig> was  <dig> . we hypothesize that the residues with summarized triplet interface propensities greater than the mean value are more likely to be rbrs; these residues are colored blue, while the others are colored white. according to our statistics on two proteins in fig.  <dig>  and , the overlapping residues  between real rbrs  and the blue- colored residues account for approximately  <dig>  % of the real rbrs for chain a of protein 1qtq, and the overlapping ratio is  <dig>  % for chain a of protein 2zzm. as shown in fig.  <dig> and , many blue-colored residues are in the overlapping area; and these overlapping residues scatter in the protein-rna interfaces of the two proteins.fig.  <dig> the triplet interface propensities for residues in protein 1qtq_a  and 2zzm_a . in a and c, the residues colored from white to blue , and the darker the blue color of the residues, the more likely the residues are involved in rna-protein interactions. in b and d, the residues having triplet interface propensities larger than the average propensity value are colored blue, the residues interacting with rna is colored red, those residues colored yellow are the overlaps of the residues colored blue and red. all of the rna molecules are colored orange



to demonstrate the necessity of describing the interface propensity of a residue triplet with a 4d vector, we explored all of the residue interface triplets on the protein-rna interfaces in rbp <dig> and rbp <dig> and found that some of the interface residue triplets consisted of only one subtype of triplet_ <dig>  triplet_ <dig>  triplet_ <dig> and triplet_ <dig> , and these interface triplets consisting of only subtype triplet_ <dig>  triplet_ <dig>  triplet_ <dig> or triplet_ <dig> accounted for approximately  <dig> ,  <dig> ,  <dig>  and  <dig>  % of all of the interface triplets, respectively. the other interface residue triplets consisted of more than one type of the four triplet types. the difference in the triplet subtypes of each type of residue interface triplets suggested that characterizing a given three-residue segment with a 4d vector could be meaningful for inferring the two neighboring residues of the centre residue. as shown in fig.  <dig>  four types of interface residue triplets consisting of only one of the four triplet subtypes with a relatively high interface propensity were used for this analysis. the first residue triplet is erg, an interface triplet consisting of only triplet_ <dig> in chain d of protein 2hvy and chain a of protein 2zio, in which the central arginine residue is bound to rna using its long positively charged side chain, but the two neighboring residues, glycine and negatively charged glutamic acid, do not participate in rna-protein interactions. in a triplet consisting of only triplet_ <dig>  the residue triplet drv has its centre residue and the first residue of the triplet in the protein-rna interface, as shown in chain a of proteins 4lgt and 4goa. in erg, the side chain of arginine is bound to the negatively charged phosphodiester backbone of rna, but the negatively charged aspartic acid appears to bind to the nucleic acid base instead of the phosphodiester backbone because of electrostatic repulsion. the residue triplets hkf and krr have only triplet_ <dig> and triplet_ <dig>  respectively. in triplet hkf of chain a of proteins 3bx <dig> and 3 k <dig>  the central residue and third residue of the triplet are rbrs. in the krr of chain  <dig> of protein 1vq <dig> and chain x of protein 4kix, the three residues of the triplet are interface residues. in fig.  <dig>  the conformations of the two triplets hkf have some similarities, and for the interface triplets krr shown in fig.  <dig> , the rna residues interacting with the triplets krr were frequently not consecutive along the sequences.fig.  <dig> interactions between rnas and four types of interface triplets in different proteins. the two interface triplets in  are same as erg and the first is from protein 2hvy_d, the second is from 2zio_a. the two interface triplets in  are same as drv . in , two interface triplets hkf are from 3bx2_a and 3k49_a, respectively. the two interface triplets in  are same as krr and the first is from 1vq4_ <dig>  the second is from 2zio_a. the main chains of rnas are colored orange



model construction using five types of calculated features
in most cases, the background residues of a target residue are selected with the same patch type and patch size; here, we adopted the optimal patch type and patch size for each individual feature to select the background residues of the target residue. thus, each chain is encoded by a feature vector of l* <dig> , where l represents the length of the protein chain. based on the  <dig> protein chains in rbp <dig>  we developed a prediction model using an rf classifier combined with the five types of characteristics using default parameters for rf algorithm, and to evaluate the robustness of our prediction model, a fivefold cross-validation was performed on rbp <dig>  the roc curve of the fivefold cross-validation is shown in fig.  <dig>  the prediction results of fivefold cross-validation when selecting other parameters of rf algorithm could be seen in additional file  <dig>  according to the auc value of  <dig>  for the roc curve, we could conclude that the adoption of different structural and sequential features will help to develop a prediction model with good prediction performance.fig.  <dig> the roc curve of five-fold cross-validation for our method on rbp195



the contributions of each feature of rnaprosite
five types of features are used to represent each residue in this study, to verify the effect of these five types of features for the predicting power of constructed prediction model, we extracted each type of feature from the whole feature vector and used the left four types of features to develop a rf classifier. table  <dig> presents the results of fivefold validation on rbp <dig> for each developed rf classifier and we could find that the prediction performance will decrease when any type of feature is not adopted relative to that when all the five types of features are used. we could also find from table  <dig> that the prediction performance decreases larger when triplet interface propensity was excluded from the whole feature vector than that when other types of features were extracted, which shows that the feature triplet interface propensity can provide more useful information concerning protein-rna interaction. when comparing the results in tables  <dig> and  <dig>  we could find that although the prediction power of geometrical characteristic is relatively lower when used individually than other features, but excluding this feature can decrease the prediction performance larger than other features except triplet interface propensity, which shows that adopting a feature of different type will help to improve the prediction performance of the classifier when other discriminative features are used. from the importance values  for each of the five types features, calculated by random forest algorithm when model construction, also proved that the two new structural features  is helpful for the prediction of rna-binding residues.table  <dig> the prediction performance for five-fold cross validation on rbp <dig> when one of the five types of features is excluded



benchmark of prediction with rnaprosite and other excellent methods
to further evaluate the prediction performance of our prediction model, the non-redundant dataset rbp <dig> and rbp <dig> were used as comparative benchmark datasets. the cutoff value of  <dig>  Å is used for the definition of rbrs for rbp <dig> and rbp <dig> the training dataset is rbp <dig> for our method when rbp <dig> is used as the benchmark dataset. six kinds of available web-servers and one program are used, namely, bindn  <cit> , pprint  <cit> , rnabindr  <cit> , kyg  <cit> , aarna  <cit> , rbscore  <cit> , prna  <cit> . we predicted the protein chains in rbp <dig> and rbp <dig> by our predictor and compared the prediction results with seven common available sequence-based and structure-based web servers in table  <dig>  as shown in table  <dig>  when tested on rbp <dig>  the prediction sensitivity of rnaprosite was  <dig> , which is better than all of the listed web servers except rnabindr  <cit>  and rbscore  <cit> , whose prediction sensitivity was  <dig>  and  <dig> , and the specificity, accuracy, positive predictive value, f-score and mcc of rnaprosite was better than the other prediction models on rbp <dig>  we could find that when the cutoff value is set to  <dig>  Å instead of 5 Å for rbp <dig>  the prediction performance for all the methods mentioned in table  <dig> decreased especially for predictors using structural features, the reason may be that less rbrs are defined and several of these non-rbrs with similar properties with rbrs are predicted as rbrs.table  <dig> the comparison of prediction performance between rnaprosite and other excellent sequence-based and structure-based methods on rbp <dig> 



the effects of dataset, algorithm, and the definition of rbrs on the prediction performance
it is known that if the sequences or structures in a dataset have some kind of similarities, then the classifier may learn these similarities and result a prediction model with relatively better performance than expected, so we compared the prediction result of five-fold cross validation on rb <dig> and rb <dig>  from the results of “5 Å ” and “5 Å ” in table  <dig>  we could find that the values of sn for rb <dig> is only slightly higher rbp <dig>  but the sp, acc, f-score, mcc and ppv for rb <dig> is slightly lower than that for rbp <dig>  which means that our method seems not sensitive to the composition of dataset. we could find that the different machine learning algorithms may have different five-fold cross validation results from the prediction results of “5 Å ” and “5 Å ” and the random forest classifier was better than the svm classifier when the features in our method were adopted, which could also be found when analyze the results of “ <dig>  Å ” and “ <dig>  Å ”. for the construction of svm classifier, the kernel function of rbf was used and other parameters are optimized by grid search method to deliver high accuracy. when comparing the results of “5 Å ” and “ <dig>  Å ”, we could find that the prediction results is slightly worse considering the balanced measures of f-score and mcc when the cutoff value is set to a lower value of  <dig>  Å relative to that when a cutoff value of 5 Å is chosen, this phenomenon could also be found in the study of comparison for different prediction methods  <cit> . from the recently published study  <cit>  for comparing the performance of different prediction methods, we could also find that our method shows stable prediction performance when different distance cutoff values and datasets are chosen.table  <dig> the effects of datasets, algorithm, and the definition of rbrs on the prediction performance of our method



the effects of conformational change upon binding rna
to assess whether the performance of rnaprosite would be affected by protein conformational changes that accompany rna binding, we used the  <dig> rna-free structures and  <dig> respective rna-bound structure from a published dataset datasetii  <cit> ,the root-mean-square deviation  of the cα atoms for each pair of rna-free and respective rna-bound structures ranges from  <dig>  to  <dig>  Å. from the results in table  <dig> we could find that the prediction results for rna-bound proteins are only slightly better than that for rna-free protein and the difference values of the six evaluation measures between rna-bound proteins and rna-free proteins are not more than  <dig> . by analyzing the results in table  <dig> we could find that the rmsd values for most pairs of rna-free and respective rna-bound proteins are between 1 Å to 2 Å. for seven pairs of these proteins whose rmsd distribution intervals are in “[2 Å, 3 Å)” and “[3 Å, 4 Å)”, the prediction performance for rna-free proteins decreases more relative to that for rna-bound proteins when comparing to proteins in other rmsd distribution intervals in table  <dig>  in a whole, our method is not very sensitive to the conformational changes upon rna binding.table  <dig> the effects of conformational change upon rna binding on the prediction performance of our methods



discussion
due to the methodological differences, rnaprosite may identify some real rbrs that cannot be determined by the other seven approaches. so we selected four protein chains from rbp <dig> and searched some of the residues predicted by rnaprosite but not by the other seven common methods  that was also truly predicted by rbscore), as shown in fig.  <dig>  according to the rbrs predicted by rnaprosite but rarely by the other methods, all of the yellow-colored residues had positive electrostatic surface potential values and were in the largest positive surface patch, except for the residue in fig.  <dig>  we selected the rbp chain 3zgz  to analyze the important contributions of the triplet interface propensity feature in prediction of rbrs, because the yellow-colored glutamic acid in 3zgz  had a negative charge and was in the largest negative surface path and because glutamic acid is rarely located on the rna-protein interface relative to other positive-charged residues. the surface residue triplet of the residue glutamic is neq, this triplet contains only the second type of triplet_ <dig>  triplet_ <dig>  triplet_ <dig> and triplet_ <dig> , and its propensity value is  <dig> , which is higher than the mean  <dig>  of all analyzed triplets, meaning that the first and centre residues may be rna-binding instead of the third residue for the surface triplet neq . according to our statistics on the prediction results of our methods and other seven prediction programs in additional file  <dig>  we could find that each prediction method could find really rna-binding residues not predicted by other prediction methods, which proved the difference in adopted features for predicting rna-binding sites on proteins may lead to the difference in prediction results.fig.  <dig> the prediction results of rnaprosite on four rbp chains. a residue is colored blue when it is falsely predicted as rna-binding and green when it is truly predicted as rna-binding. the residues colored by yellow mean they are truly predicted as rbrs but not predicted by other methods. the rna is colored orange. the pdb codes of the four rbp chain in , ,  and  are 4glt , 2azx , 3qjj  and 3zgz , respectively



CONCLUSIONS
in this study, we designed two discriminative structure-derived features, namely residue electrostatic surface potential and triplet interface propensity, to characterize a protein residue together with other commonly used descriptors. a comprehensive analysis of the two newly designed features from different aspects demonstrated that the two features have excellent discriminative power on a large dataset and may reflect the underlying mechanisms of rna-protein interactions. to incorporate information from neighbor residues to determine the rna-binding properties of each target residue, the optimal patch type and patch size for different features are searched, and by using the searched optimal patch type and patch size for each used feature, a random forest classifier is developed and implemented in the web server rnaprosite. from the results of a fivefold cross validation on a training set and the prediction performance on a test set, we concluded that our method can predict rbrs with results better than or comparable to those of the existing approaches and could assist researchers in performing more targeted assays.

abbreviations
acc, accuracy; auc, area under the receiver operating characteristic curve; mcc, matthews’s correlation coefficient; ppv, positive predictive value; rbps, rna binding proteins; rbrs, rna-binding residues; sn, sensitivity; sp, specificity

additional files
additional file 1: a complete list of all of the pdb codes for datasets rbp <dig>  rbp <dig>  rbp <dig> and rbp <dig>  

additional file 2: the effect of rsa cutoff values on prediction performance for triplet interface propensity. 

additional file 3: details for the selection of physicochemical properties from aaindex database. 

additional file 4: the selection of optimal patch type and patch size for each type of feature. 

additional file 5: the effects of number of trees grown  and number of predictors sampled  on prediction performance. 

additional file 6: statistics for the number of truly predicted rna-binding residues  only by one prediction model. 

additional file 7: the mean decrease in accuracy  and gini index  for five types of features. 



