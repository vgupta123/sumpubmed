BACKGROUND
co-expression methods are widely used for analyzing gene expression data and other high dimensional “omics” data. most co-expression measures fall into one of two categories: correlation coefficients or mutual information measures. mi measures have attractive information-theoretic interpretations and can be used to measure non-linear associations. although mi is well defined for discrete or categorical variables, it is non-trivial to estimate the mutual information between quantitative variables, and corresponding permutation tests can be computationally intensive. in contrast, the correlation coefficient and other model based association measures are ideally suited for relating quantitative variables. model based association measures have obvious statistical advantages including ease of calculation, straightforward statistical testing procedures, and the ability to include additional covariates into the analysis. researchers trained in statistics often measure gene co-expression by the correlation coefficient. computer scientists, trained in information theory, tend to use a mutual information  based measure. thus far, the majority of published articles use the correlation coefficient as co-expression measure  <cit>  but hundreds of articles have used the mutual information  measure  <cit> .

several articles have used simulations and real data to compare the two co-expression measures when clustering gene expression data. allen et al. have found that correlation based network inference method wgcna  <cit>  and mutual information based method aracne  <cit>  both perform well in constructing global network structure  <cit> ; steuer et al. show that mutual information and the pearson correlation have an almost one-to-one correspondence when measuring gene pairwise relationships within their investigated data set, justifying the application of pearson correlation as a measure of similarity for gene-expression measurements  <cit> . in simulations, no evidence could be found that mutual information performs better than correlation for constructing co-expression networks  <cit> . however, mi continues to be used in recent publications. some authors have argued that mi is more robust than pearson correlation in terms of distinguishing various clustering solutions  <cit> . given the debates, it remains an open question whether mutual information could be supplanted by standard model based association measures. we affirmatively answer this question by i) reviewing the close relationship between mutual information and likelihood ratio test statistic in the case of categorical variables, ii) finding a close relationship between mutual information and correlation in simulations and empirical studies, and iii) proposing polynomial and spline regression models as alternatives to mutual information for modeling non-linear relationships.

while previous comparisons involved the pearson correlation, we provide a more comprehensive comparison that considers i) different types of correlation coefficients, e.g. the biweight midcorrelation , ii) different approaches for constructing mi based and correlation based networks, iii) different ways of transforming a network adjacency matrix , and iv)  <dig> diverse gene expression data from yeast, mouse and humans. our unbiased comparison evaluates co-expression measures at the level of gene pair relationships and at the level of forming co-expression modules .

this article presents the following results. first, probably the most comprehensive empirical comparison to date is used to evaluate which pairwise association measure leads to the biologically most meaningful network modules  when it comes to functional enrichment with go ontologies. second, polynomial regression and spline regression methods are evaluated when it comes to defining non-linear association measures between gene pairs. third, simulation studies are used to validate a functional relationship  between correlation and mutual information in case that the two variables satisfy a linear relationship. our comprehensive empirical studies illustrate that the cor-mi function can be used to approximate the relationship between mutual information and correlation in case of real data sets which indicates that in many situations the mi measure is not worth the trouble. gene pairs where the two association measures disagree are investigated to determine whether technical artifacts lead to the incongruence.

overall, we find that bicor based co-expression measure is an attractive co-expression measure, particularly when limited sample size does not permit the detection of non-linear relationships. our theoretical results, simulations, and  <dig> different gene expression data sets show that mi is often inferior to correlation based approaches in terms of elucidating gene pairwise relationships and identifying co-expression modules. a signed correlation network transformed via the topological overlap matrix transformation often leads to the most significant functional enrichment of modules. polynomial and spline regression model based statistical approaches are promising alternatives to mi for measuring non-linear relationships.

association measure and network adjacency
an association measure is used to estimate the relationships between two random variables. for example, correlation is a commonly used association measure. there are different types of correlations. while the pearson correlation, which measures the extent of a linear relationship, is the most widely used correlation measure, the following two more robust correlation measures are often used. first, the spearman correlation is based on ranks, and measures the extent of a monotonic relationship between x and y. second, “bicor”  is a median based correlation measure, and is more robust than the pearson correlation but often more powerful than the spearman correlation  <cit> . all correlation coefficients take on values between − <dig> and  <dig> where negative values indicate an inverse relationship. a correlation coefficient is an attractive association measure since i) it can be easily calculated, ii) it affords several asymptotic statistical tests  for calculating significance levels , and iii) the sign of correlation allows one to distinguish between positive and negative relationships. other association measures, such as mutual information, will be introduced in the next sections.

association measures can be transformed into network adjacencies. for n variables v <dig> …,vn, an adjacency matrix a =  is an n × n matrix quantifying the pairwise connection strength between variables. an  network adjacency satisfies the following conditions: 

  0≤aij≤ <dig> aij=aji,aii= <dig>  

an association network is defined as a network whose nodes correspond to random variables and whose adjacency matrix is based on the association measure between pairs of variables  <cit> . association networks describe the pair wise associations between variables . for a given set of nodes, there is a one-to one relationship between the association network and the adjacency matrix. in order to build an association network for n variables v = , we start by defining an association measure assocmeasure as a real valued function of two vectors x, y. we then apply this function on the set of n = n2variable pairs {pair <dig> = ,pair <dig> = ,…,pairn = }, resulting in an n × n dimensional matrix 

  s=). 

then, one needs to specify how the association matrix s is transformed into an adjacency matrix. this involves three steps: 1) symmetrize s ; 2) transform  s to  <cit>  ; 3) set diagonal values to  <dig>  as for step  <dig>  many methods can be used to symmetrize s if it is non-symmetric, such as the following three ways: 

  sijmin=min 

  sijave=sij+sji <dig> 

  sijmax=max. 

as for step  <dig>  if lowerbounds and upperbounds denote symmetric matrices of element-wise lower and upper bounds for s, then a simple transformation can be defined as: 

  a=s−lowersboundupperbounds−lowerboundβ, 

where the power β is constant and denotes a soft threshold. as an example, assume that the association measure is given by a correlation coefficient, i.e. s = ). since each correlation has the lower bound − <dig> and upper bound +  <dig> , eq.  <dig> reduces to the case of a signed weighted correlation network given by  <cit> : 

  aij=1+cor2β. 

additional details of correlation based adjacencies  are described in materials and methods.

network adjacency based on co-expression measures
when dealing with gene expression data, xi denotes the expression levels of the i-th gene  across multiple samples. in this article, we assume that the m components of xi correspond to random independent samples. co-expression measures can be used to define co-expression networks in which the nodes correspond to genes. the adjacencies aij encode the similarity between the expression profiles of genes i and j. in practice, transformations such as the topological overlap measure   <cit>  are often used to turn an original network adjacency matrix into a new one. details of tom transformation are reviewed in materials and methods.

mutual information networks based on categorical variables
assume two random samples dx and dy of length m from corresponding discrete or categorical random variables dx and dy. each entry of dx equals one of the following r levels ldx <dig> …,ldxr. the mutual information  is defined as: 

  mi=∑r=1rx∑c=1ryplogppp 

where p is the frequency of level r of dx, and log is the natural logarithm. note that the following simple relationship exists between the mutual information  and the likelihood ratio test statistic : 

  mi=lrt.statistic2m 

this relationship has many applications. first, it can be used to prove that the mutual information takes on non-negative values. second, it can be used to calculate an asymptotic p-value for the mutual information. third, it points to a way for defining a mutual information measure that adjusts for additional conditioning variables z <dig> z <dig> … specifically, one can use a multivariate multinomial regression model for regressing dy on dx and the conditioning variables. up to a scaling factor of 2m, the likelihood ratio test statistic can be interpreted as a  measure of mutual information between dx and dy that adjusts for conditioning variables. more detailed discussion of mutual information can be found in  <cit> . in additional file  <dig>  we describe association measures between categorical variables in detail, including lrt statistic and mi.

as discussed below, numerous ways have been suggested for construct an adjacency matrix based on mi. here we describe an approach that results in a weighted adjacency matrix. consider n categorical variables dx <dig> dx <dig> …,dxn. their mutual information matrix mi is a similarity matrix s whose entries are bounded from below by  <dig>  to arrive at an upper bound, we review the relationship between mutual information and entropy : 

  mi=entropy+entropy−entropy 

where entropy denotes the entropy of dx and entropy denotes the joint entropy . using eq.  <dig>  one can prove that the mutual information has the following  <dig> upper bounds: 

  mi≤min,entropy), 

  mi≤entropy+entropy <dig>  

  mi≤max,entropy). 

using eq.  <dig> with β =  <dig>  lower bounds of  <dig> and upperboundsij =  + entropy)/ <dig>  results in the symmetric uncertainty based mutual information adjacency matrix: 

  aijmi,symmetricuncertainty=2mientropy+entropy. 

a transformation of ami,symmetricuncertainty leads to the universal mutual information based adjacency matrix version  <dig> : 

  aijmi,universalversion1=aijmi,symmetricuncertainty2−aijmi,symmetricuncertainty 

one can easily prove that 0≤aijmi,universalversion1≤ <dig>  the term “universal” reflects the fact that the adjacency based dissimilarity dissmiijuniveralversion1=1−ami,universalversion <dig> turns out to be a universal distance function  <cit> . roughly speaking, the universality of dissmiijuniveralversion <dig> implies that any other distance measure between dxi and dxj will be small if dismiijuniveralversion <dig> is small. the term “distance” reflects the fact that dissmiuniveralversion <dig> satisfies the properties of a distance including the triangle inequality.

another adjacency matrix is based on the upper bound implied by inequality  <dig>  we define the universal mutual information based adjacency matrix version  <dig>  or auv <dig>  as follows: 

  ami,universalversion2=mimax,entropy). 

the name reflects the fact that dissmiuniveralversion <dig> = 1−ami,universalversion <dig> is also a universal distance measure  <cit> . while ami,universalversion <dig> and ami,universalversion <dig> are in general different, we find very high spearman correlations  between their vectorized versions.

many alternative approaches exist for defining mi based networks, e.g. aracne  <cit> , clr  <cit> , mrnet  <cit>  and relnet  <cit>  are described in materials and methods.

mutual information networks based on discretized numeric variables
in its original inception, the mutual information measure was only defined for discrete or categorical variables, see e.g.  <cit> . it is challenging to extend the definition to quantitative variables. but, several strategies have been proposed in the literature  <cit> . in this article, we will only consider the following approach which is based on discretizing the numeric vector x by using the equal width discretization method. this method partitions the interval  into equal-width bins . the vector discretize has the same length as x but its l-th component reports the bin number in which xl falls: 

  dxl=discretizel=rifxl∈binr. 

the number of bins, no.bins, is the only parameter of the equal-width discretization method.

in our subsequent studies, we calculate an mi-based adjacency matrix using the following three steps. first, numeric vectors of gene expression profiles are discretized according to the equal-width discretization method with the default number of bins given by no.bins=m. second, the mutual information miij = mi,discretize) is calculated between the discretized vectors based on eq.  <dig> and the miller madow entropy estimation method . third, the mi matrix is transformed into one of three possible mi-based adjacency matrices: ami,symmetricuncertainty , ami,universalversion <dig> , ami,universalversion <dig> .

RESULTS
an equation relating mi,discretize) to cor
as described previously, the mutual information mi,discretize) between the discretized vectors can be used as an association measure. note that mi,discretize) is quite different from cor in the following aspects. first, the estimated mutual information depends on parameter choices, e.g. the number of bins used in the equal-width discretization step for defining dx = discretize. second, the mutual information aims to measure general dependence-relationships while the correlation only measures linear or monotonic relationships. third, the equations for the two measures are very different. given these differences, it is surprising that a simple approximate relationship holds between the two association measures if xy are samples from a bivariate normal distribution and the equal-width discretization method is used with no.bins=m. under these assumptions, we will show that ami,universalversion <dig> can be accurately approximated as follows: 

  ami,universalversion2=mimax,entropy)≈fcor−mi), 

where the “cor-mi” function  <cit> 

  fcor−mi=loglog+ω 

depends on the following two parameters 

  ω= <dig> m− <dig> ε=ω <dig> . 

in general, one can easily show that fcor−mi is a monotonically increasing function that maps the unit interval  <cit>  to  <cit>  if the two parameters ω and ε satisfy the following relationship 

  0<ε≤ω< <dig>  

eq.  <dig> was stated in terms of the pearson correlation, but it also applies for bicor as can be seen from our simulation studies.

simulations where x and y represent samples from a bivariate normal distribution
here we use simulation studies to illustrate that fcor−mi  can be used for predicting or approximating ami,universalversion <dig> from the corresponding correlation coefficients . specifically, we simulate  <dig> pairs of sample vectors x and y from a bivariate normal distribution. each pair of vectors x and y is simulated to exhibit different pairwise correlations. figure  <dig> shows the relationships of the mi-based adjacency measures with the  pearson correlation  or biweight midcorrelation  when each of the vectors contains m =  <dig> components but the relationship has been confirmed for m ranging from  <dig> to  <dig>  as can be seen from figures , the cor-mi function  with parameters specified in eq.  <dig> provides a highly accurate prediction of ami,universalversion <dig>  on the basis of cor and m. since x and y are normally distributed, the pearson correlation and bicor are practically indistinguishable . thus, replacing cor by bicor leads to equally good predictions of ami,universalversion <dig> . figure  shows that ami,universalversion <dig> is practically indistinguishable from ami,symmetricuncertainty. this suggests that cor-mi function can also be used to predict ami,symmetricuncertainty on the basis of the correlation measure. figure  indicates that ami,universalversion1and ami,universalversion <dig> are different from each other but satisfy a monotonically increasing relationship.

empirical studies involving  <dig> gene expression data sets
our simulation results show that both the robust biweight midcorrelation and the pearson correlation can be used as input of fcor−mi for predicting ami,universalversion <dig> when the underlying variables satisfy pairwise bivariate normal relationships. however, it is not clear whether fcor−mi can also be used to relate correlation and mutual information in real data applications. in this section, we report  <dig> empirical studies to study the relationship between mi and the robust correlation measure bicor. to focus the analysis on genes that are likely to reflect biological variation and to reduce computational burden, we selected the  <dig> genes with highest variance across the microarray samples for each data set. description of data sets can be found in materials and methods.

we first calculate bicor and ami,universalversion <dig> for all gene pairs in each data set. the two co-expression measures show strong monotonic relationships in most data sets . then, we predict ami,universalversion <dig> from bicor based on fcor−mi . our predictions are closely related to true ami,universalversion <dig> values . these results indicate that most gene pairs satisfy linear relationships in real data applications. among the  <dig> data sets, safhs shows the strongest association between bicor and ami,universalversion <dig>  and also gives the most accurate ami,universalversion <dig> prediction . a possible reason is that the large samples size  leads to more accurate estimation of mutual information, thus enhancing the association with bicor and the performance of the prediction function. in contrast, the small sample size  of the yeast data set adversely affects the calculation of mutual information and hence the prediction performance of fcor−mi. in summary, our examples indicate that for most gene pairs, ami,universalversion <dig>  is a monotonic function  of the absolute value of bicor. this finding likely reflects the fact that the vast majority of gene pairs satisfy straight line relationships. this approximation improves with increasing sample size m, possibly reflecting more accurate estimation of mutual information.

although fcor−mi reveals a close relationship between bicor and ami,universalversion <dig> for most gene pairs, there are cases where the two association measures strongly disagree. in the following, we present scatter plots to visualize the relationships between pairs of genes where mi found a significant relationship while bicor did not and vice versa. to facilitate a comparison between bicor and mi, we standardized each association measure across pairs, which resulted in the z scores denoted by z.miij=)/) and z.bicorij=)/). next we selected gene pairs whose value of z.miij was large but z.bicorij was low and vice versa. the resulting pairs correspond to the blue and red circles in figures  <dig> and  <dig>  to see what dependence patterns drives the discordant behavior of mi and bicor, we used scatter plots to visualize the relationship between the pairs of variables . gene pairs in figure  have extreme ami,universalversion <dig> but insignificant bicor values. note that the resulting dependencies seem haphazard and may not reflect real biological dependencies. for example, the gene pair in the brain cancer data set exhibits no clear relationships as correctly implied by bicor, while the significant mi value is driven by an array outlier with extremely high expression for both genes. in the safhs data, the gene pair exhibits an unusual pattern that is more likely to be the result of batch effects rather than biological signals. the mouse liver data set displays a pairwise pattern that is neither commonly seen nor easily explained. the nd data set shows no obvious patterns at all, making mutual information less trustworthy. on the contrary, gene pairs with significant value of z.bicor but insignificant z.mi values show approximate linear relationships in all data sets . thus, bicor captures gene pairwise relationships more accurately and sensitively than the mutual information based adjacency ami,universalversion <dig> 

in summary, bicor usually detects linear relationships between gene pairs accurately while mutual information is susceptible to outliers, and sometimes identifies pairs that exhibit patterns unlikely to be of biological origin or that exhibit no clear dependency at all. we note that mi results tend to be more meaningful when dealing with a large number of observations . although we only consider  <dig> genes with highest variances, our results are highly robust with respect to the number of genes. for example, in additional file  <dig>  we report results when considering all  <dig> genes in the mouse adipose data set or considering  <dig> randomly selected genes  in the nd data set. these results demonstrate that our findings do not depend on the number of genes.

gene ontology enrichment analysis of co-expression modules defined by different networks
gene co-expression networks typically exhibit modular structure in the sense that genes can be grouped into modules  comprised of highly interconnected genes . the network modules often have a biological interpretation in the sense that the modules are highly enriched in genes with a common functional annotation   <cit> . in this section, we assess association measures  by the gene ontology  enrichment of their resulting modules in the  <dig> empirical data sets.

in order to provide an unbiased comparison, we use the same clustering algorithm for module assignment for all networks. toward this end, we use a module detection approach that has been used in hundreds of publications: modules are defined as branches of the hierarchical tree that results from using 1−adjacency as dissimilarity measure, average linkage, and the dynamic tree cutting method  <cit> . an example of the module detection approach is illustrated in figure  <dig>  to provide an unbiased evaluation of go enrichment of each module, we used the goenrichmentanalysis r function to test enrichment with respect to all go terms  <cit>  and retained the  <dig> most significant p-values for each module.

the  <dig> different adjacencies considered here are described in the last  <dig> columns of table  <dig>  we first compare modules based on ami,universalversion <dig> with those resulting from  <dig> bicor based networks: unsigned adjacency , signed adjacency  and topological overlap matrix  based on signed adjacency. go enrichment p-values of modules in the  <dig> real data applications are summarized as barplots in figure  <dig>  figure  <dig> indicates that, in terms of gene ontology enrichment, tom is the best bicor based gene co-expression network construction method, and it is superior to ami,universalversion <dig>  note that signed correlation network coupled with the topological overlap transformation exhibit the most significant go enrichment p-values in all data sets, and the difference is statistically significant  in  <dig> out of  <dig> comparisons. the effect of module size is discussed below. an obvious question is whether the performance of mi can be improved when using an alternative mi based network inference method. to address this, we compared the performance of the signed correlation network  versus  <dig> commonly used mutual information: aracne, clr, mrnet and relnet . aracne allows one to choose a tolerance threshold ε ranging from  <dig> to  <dig>  as εincreases, more edges of the aracne network will be preserved. we evaluated aracne , aracne  and aracne  into our comparison. similarly to figures  <dig> and  <dig> summarizes the go enrichment p-values of modules in the  <dig> real data applications. tom leads to the highest enrichment p-values in  <dig> cases, and the difference is statistically significant in  <dig> of them. in two applications, aracne  performs best, and mrnet performs best in one application. we need to point out that another mutual information based method, maximal information coefficient   <cit> , has been proposed recently. although computational intensive, the mic has clear theoretical advantages when it comes to capturing general dependence patterns. additional file  <dig> compares the performance of mic with that of tom when it comes to go ontology enrichment. tom clearly outperforms mic to identify go enriched modules in  <dig> out of  <dig> data sets which may suggest that mic tends to overfit the data in these applications. safhs data set is not included because the computation of mic was time-consuming on this large data set.

for each network method, the table reports what kinds of biological insights can be gained and what kind of data can be analyzed. column “grn” indicates whether the network has been  used for studying gene regulatory networks. column “reduce” indicates whether the method has been used for reducing high dimensional data . column “direct” indicates whether the the network can encode directional information. column “time” indicates whether the network method is suited for studying time series data. column “nonlin. ” indicates whether the network can capture non-linear relationships between pairs of variables . column “sign” indicates whether the network adjacency provides information on the sign of the relationship between two variables, e.g. a correlation coefficient can take on positive and negative values. the table entry “na” stands for not applicable. adjacencies discussed in this article: unsigneda: unsigned bicor; signeda: signed bicor; tom: tom transformed signed bicor; asu: ami,symmetricuncertainty; auv1: ami,universalversion1; auv2: ami,universalversion2; aracne: aracne, ε =  <dig> ; aracne <dig> : aracne, ε =  <dig>  ; aracne <dig> : aracne, ε =  <dig> .

overall, these unbiased comparisons show that signed correlation networks coupled with the topological overlap transformation outperform the commonly used mutual information based algorithms when it comes to go enrichment of modules.

polynomial and spline regression models as alternatives to mutual information
a widely noted advantage of mutual information is that it can detect general, possibly non-linear, dependence relationships. however, estimation of mutual information poses multiple challenges ranging from computational complexity to dependency on parameters and difficulties with small sample sizes. standard polynomial and spline regression models can also detect non-linear relationships between variables. while perhaps less general than mi, relatively simple polynomial and spline regression models avoid many of the challenges of estimating mi while adequately modeling a broad range of non-linear relationships. in addition to being computationally simpler and faster, regression models also make available standard statistical tests and model fitting indices. thus, in this section we examine polynomial and spline regression as alternatives to mi for capturing non-linear relationships between gene expression profiles. we define association measures based on polynomial and spline regression models and study their performance.

networks based on polynomial and spline regression models
consider two random variables x and y and the following polynomial regression model of degree 3: 

  e=β0+β1x+β2x2+β3x <dig>  

the model fitting index r <dig>  can be used to evaluate the fit of the model. one can then reverse the roles of x and y to arrive at a model fitting index r <dig> . in general, r <dig> ≠ r <dig> 

now consider a set of n variables x <dig> …,xn. one can then calculate pairwise model fitting indices rij2=r <dig> which can be interpreted as the elements of an n × n association matrix . this matrix is in general non-symmetric and takes on values in  <cit>  , with diagonal values equal to  <dig>  a large value indicates a close relationship between variables xi and xj. to define an adjacency matrix, we symmetrize  through eqs.  <dig>   <dig> or  <dig> 

spline regression models are also known as local polynomial regression models  <cit> . local refers to the fact that these models amount to fitting models on subintervals of the range of x. the boundaries of subintervals are referred to as knots. in analogy to polynomial models, we build natural cubic spline model for all pairs of xi,xj. we use the following rule of thumb for the number of knots: if m >  <dig> use  <dig> knots, if m <  <dig> use  <dig> knots, otherwise use  <dig> knots. we then calculate model fitting indices and create corresponding network adjacencies. 

compared to spline regression, polynomial regression models have a potential shortcoming: the model fit can be adversely affected by outlying observations. a single outlying observation  can “bend” the fitting curve into the wrong direction, i.e. adversely affect the estimates of the β coefficients. spline regression alleviates this problem by fitting model on sub-intervals of the range of x.

relationship between regression and mi based networks
previously, we discussed the relationship between correlation and mutual information based adjacencies in simulations where x and y represent samples from a bivariate normal distribution. here, we consider the performance of polynomial and spline association measure in the same scenario . with all x,y pairs following linear relationships, both regression models reduce to simple linear models, and perform almost identically to correlation based measures  and ). we find that the cor-mi function introduced previously also allows us to relate spline and polynomial regression based networks to the mi based network  and ), e.g. auv2ij≈fcor−mi,r2)). note that different symmetrization methods  applied r <dig> result in similar adjacencies in our applications , thus it’s valid to use any of them.

in addition, our empirical data show that regression models and mutual information adjacency ami,universalversion <dig> are highly correlated, and the relationship is stronger than that between bicor and ami,universalversion <dig> . this indicates that ami,universalversion <dig> and regression models discover some common gene pairwise non-linear relations that can not be identified by correlations. the neurological disease  and mouse muscle sets are shown in figure  <dig> as representatives. a detailed analysis of all data sets can be found in additional file  <dig> 

simulations for module identification in data with non-linear relationships
our empirical studies show that most gene pairs satisfy linear relationships, which implies that correlation based network methods perform well in practice. but one can of course simulate data where non-linear association measures  outperform correlation measures when it comes to module detection. to illustrate this point, we simulated data with non-linear gene-gene relationships. here we simulated  <dig> genes in  <dig> network modules across  <dig> samples. two of the simulated modules, labeled for convenience by the colors turquoise and blue, contain linear and non-linear  gene-gene relationships . we then use several different network inference methods to construct networks and define modules. to evaluate how well each network inference method recovers the simulated modules, we use the rand index between the inferred and simulated module assignment. in this case, non-linear association measures, i.e. auv <dig>  polynomial and spline regression, identify modules more accurately than correlation based measures . in networks based on correlations, the simulated turquoise and blue modules are clearly divided into two separate ones, indicating that they miss the non-linear relationships within these two modules. in contrast, regression models capture non-linear gene pairwise relations and correctly assign these genes into the same modules. to study the effect of the number of observations, we repeated the analysis for m ranging from  <dig> to  <dig>  figure  <dig> shows that non-linear association measures, especially regression models, outperform correlation based measures as data sample size increases. note that polynomial and spline regression based co-expression measures perform as well as mi based networks in this situation. overall, our results validate the usage of polynomial and spline regression models as alternatives to mutual information for detecting non-linear relationships.

overview of network methods and alternatives
a thorough review of network methods is beyond our scope and we point the reader to the many many review articles  <cit> . but table  <dig> describes not only the methods used in this article but also alternative approaches. table  <dig> also describes the kind of biological insights that can be gained from these network methods. as a rule, association networks  are ill suited for causal analysis and for encoding directional information. while association networks such as wgcna or aracne have been been successfully used for gene regulatory networks   <cit> , a host of alternatives are available. for example, the dream  project has repeatedly tackled this problem  <cit> . a limitation of our study is that we are focusing on undirected . structural equation models, bayesian networks, and other probabilistic graphical models are widely used for studying causal relationships. many authors have proposed to use bayesian networks for analyzing gene expression data  <cit>  and for generating causal networks from observational data  <cit>  or genetic data  <cit> .

while it is beyond our scope to evaluate network inference methods for time series data , we briefly mention several approaches. a  boolean network  <cit>  is a special case of a discrete state space model that characterizes a system using dichotomized data. a bayesian network is a graph-based model of joint multivariate probability distributions that captures properties of conditional independence between variables  <cit> . such models are attractive for their ability to describe complex stochastic processes and for modeling causal relationships. several articles describe the relationship between boolean networks and dynamic bayesian networks when it comes to models of gene regulatory relationships  <cit> . finally, we mention that correlation network methodology can be adapted to model time series data, e.g. many authors have proposed to use a time-lagged correlation measure for inferring gene regulatory networks  <cit> .

a large part of grn research focuses on the accurate assessment of individual network edges, e.g.  <cit>  so many of these methods are not designed as data reduction methods. in contrast, correlation network methods, such as wgcna, are highly effective at reducing high dimensional genomic data since modules can be represented by their first singular vector   <cit> .

discussion
this article presents the following theoretical and methodological results: i) it reviews the relationship between the mi and a likelihood ratio test statistic in case of two categorical variables, ii) it presents a novel empirical formula for relating correlation to mi when the two variables satisfy a linear relationship, and iii) it describes how to use polynomial and spline regression models for defining pairwise co-expression measures that can detect non-linear relationships.

mutual information has several appealing information theoretic properties. a widely recognized advantage of mutual information over correlation is that it allows one to detect non-linear relationships. this can be attractive in particular when dealing with time series data  <cit> . but mutual information is not unique in being able to detect non-linear relationships. standard regression models such as polynomial and spline models can also capture non-linear relationships. an advantage of these models is that well established likelihood based statistical estimation and testing procedures are available. regression models allow one to calculate model fitting indices that can be used to define network adjacencies as well as flag possible outlying observations by analyzing residuals.

for categorical variables, mutual information is  equivalent to other widely used statistical association measures such as the likelihood ratio statistic or the pearson chi-square test. in this case, all of these measures  are arguably optimal association measures. interpreting mi as a likelihood ratio test statistic facilitates a straightforward approach for adjusting the association measure for additional covariates.

we and others  <cit>  have found close relationships between mutual information and correlation based co-expression networks. our comprehensive empirical studies show that mutual information is often highly related to the absolute value of the correlation coefficient. we observe that when robust correlation and mutual information disagree, the robust correlation findings appear to be more plausible statistically and biologically. we found that network modules defined using robust correlation exhibit on average higher enrichment in go categories than modules defined using mutual information. since our empirical studies involved expression data measured on a variety of platforms and normalized in different ways, we expect that our findings are broadly applicable.

the correlation coefficient is an attractive alternative to the mi for the following reasons. first, the correlation can be accurately estimated with relatively few observations and it does not require the estimation of the  frequency distribution. estimating the joint density needed for calculating mi typically requires larger sample sizes. second, the correlation does not depend on hidden parameter choices. in contrast, mi estimation methods involve  parameter choices, e.g. the number of bins when a discretization method is being used. third, the correlation allows one to quickly calculate p-values and false discovery rates since asymptotic tests are available . in contrast, it is computationally challenging to calculate a permutation test p-value for the mutual information between two discretized vectors. fourth, the sign of the correlation allows one to distinguish positive from negative relationships. signed correlation networks have been found useful in biological applications  <cit>  and our results show that the resulting modules tend to be more significantly enriched with go terms that those of networks that ignore the sign information. fifth, modules comprised of highly correlated vectors can be effectively summarized by the module eigennode . sixth, the correlation allows for a straightforward angular interpretation, which facilitates a geometric interpretation of network methods and concepts  <cit> . for example, intramodular connectivity can be interpreted as module eigennode based connectivity.

our empirical studies show that a signed weighted correlation network transformed via the topological overlap matrix transformation often leads to the most significant functional enrichment of modules. the recently developed maximal information coefficient  <cit>  has clear theoretical advantages when it comes to measuring general dependence patterns between variables but our results show that the biweight midcorrelation coupled with the topological overlap measure outperforms the mic when it comes to the go ontology enrichment of resulting coexpression modules.

while defining mutual information for categorical variables is relatively straightforward, no consensus seems to exist in the literature on how to define mutual information for continuous variables. a major limitation of our study is that we only studied mi measures based on discretized continuous variables. for example, the cor-mi function for relating correlation to mi only applies when an equal width discretization method is used with no.bins=m.

a second limitation concerns our gene ontology analysis of modules identified in networks based on various association measures in which we found that the correlation based topological overlap measure  leads to co-expression modules that are more highly enriched with go terms than those of alternative approaches. a potential problem with our approach is that the enrichment p-values often strongly depend on  module sizes, and tom tends to lead to larger modules. to address this concern, in additional file  <dig> we show the enrichment p-values as a function of module size for modules identified by tom and by auv <dig>  it turns out that in most studies, the enrichment of modules defined by tom is better than that of comparably sized modules defined by auv <dig> 

a third limitation concerns our use of the bicor correlation measure as opposed to alternatives . in our study we find that all  <dig> correlation measures lead to very similar findings .

CONCLUSIONS
our simulation and empirical studies suggest that mutual information can safely be replaced by linear regression based association measures  in case of stationary gene expression measures . to capture general monotonic relationships between such variables, one can use the spearman correlation. to capture more complicated dependencies, one can use symmetrized model fitting statistics from a polynomial or spline regression model. regression based association measures have the advantage of allowing one to include covariates . in case of categorical variables, mutual information is an appropriate choice since it is equivalent to an association measure  of a generalized linear regression model but categorical variables rarely occur in the context of modeling relationships between gene products.

materials and methods
empirical gene expression data sets description
brain cancer data set. this data set was composed of  <dig> microarray samples of glioblastoma  patients. gene expression profiling were performed with affymetrix high-density oligonucleotide microarrays. a detailed description can be found in  <cit> .

safhs data set. this data set  <cit>  was derived from blood lymphocytes of randomly ascertained participants enrolled independent of phenotype in the san antonio family heart study. gene expression profiles of  <dig> samples were measured by illumina sentrix human whole genome  series i beadchips.

nd data set. this blood lymphocyte data set consisted of  <dig> samples from patients with neurological diseases. illumina humanref- <dig> v <dig>  expression beadchip were used to measure their gene expression profiles.

yeast data set. the yeast microarray data set was composed of  <dig> samples from the saccharomyces genome database . original experiments were designed to study the cell cycle  <cit> . a detailed description of the data set can be found in  <cit> .

tissue-specific mouse data sets. this study uses  <dig> tissue-specific gene expression data from a large f <dig> mouse intercross  previously described in  <cit> . specifically, the surveyed tissues include adipose , whole brain , liver  and muscle .

definition of biweight midcorrelation
biweight midcorrelation  is considered to be a good alternative to pearson correlation since it is more robust to outliers  <cit> . in order to define the biweight midcorrelation of two numeric vectors x =  and y = , one first defines uivi with i =  <dig> …,m: 

  ui=xi−med9madvi=yi−med9mad 

where med is the median of x, and mad is the median absolute deviation of x. this leads us to the definition of weight wi for xi, which is, 

  wi=2i 

where the indicator i takes on value  <dig> if 1−|ui| >  <dig> and  <dig> otherwise. therefore, wi ranges from  <dig> to  <dig>  it decreases as xi gets away from med, and stays at  <dig> when xi differs from med by more than 9mad. an analogous weight wi can be defined for yi. given the weights, we can define biweight midcorrelation of x and y as: 

  bicor=∑i=1m)wi)wi∑j=1m)wj2∑k=1m)wk <dig>  

a modified version of biweight midcorrelation is implemented as function bicor in the wgcna r package  <cit> . one major argument of the function is “maxpoutliers”, which caps the maximum proportion of outliers with weight wi =  <dig>  practically, we find that maxpoutliers =  <dig>  detects outliers efficiently while preserving most data. therefore,  <dig>  is the value we utilize in this study.

types of correlation based gene co-expression networks
given the expression profile x,the co-expression similarity sij between genes i and j can be defined as: 

 sij=|cor|. 

an unweighted network adjacency aij between gene expression profiles xi and xj can be defined by hard thresholding the co-expression similarity sij as follows 

  aij=1ifsij≥τ0otherwise, 

where τ is the ‘hard’ threshold parameter. hard thresholding of the correlation leads to simple network concepts  but it may lead to a loss of information.

to preserve the continuous nature of the co-expression information, we define the weighted network adjacency between  <dig> genes as a power of the absolute value of the correlation coefficient  <cit> : 

  aij=sijβ, 

with β ≥  <dig>  this soft thresholding approach emphasizes strong correlations, punishes weak correlations, and leads to a weighted gene co-expression network.

an important choice in the construction of a correlation network concerns the treatment of strong negative correlations. in signed networks negatively correlated nodes are considered unconnected. in contrast, in unsigned networks nodes with high negative correlations are considered connected . as detailed in  <cit> , a signed weighted adjacency matrix can be defined as follows 

  aij=)β 

and an unsigned adjacency by 

  aij=|cor|β. 

β is default to  <dig> for unsigned adjacency and  <dig> for signed adjacency. the choice of signed vs. unsigned networks depends on the application; both signed  <cit>  and unsigned  <cit>  weighted gene networks have been successfully used in gene expression analysis.

adjacency function based on topological overlap
the topological overlap matrix  based adjacency function atom maps an original adjacency matrix aoriginal to the corresponding topological overlap matrix, i.e. 

  atomij=∑l≠i,jailoriginalal,joriginal+aijoriginalmin−aijoriginal+ <dig>  

the tom based adjacency function atom is particularly useful when the entries of aoriginal are sparse  or susceptible to noise. this replaces the original adjacencies by a measure of interconnected that is based on shared neighbors. the topological overlap measure can serve as a filter that decreases the effect of spurious or weak connections and it can lead to more robust networks  <cit> .

mutual-information based network inference methods
there are  <dig> commonly used mutual-information based network inference methods: relnet, clr, mrnet and aracne. in order to identify pairwise interactions between numeric variables xi,xj, all methods start by estimating mutual information mi.

relnet
the relevance network  approach  <cit>  thresholds the pairwise measures of mutual information by a threshold τ. however, this method suffers from a significant limitation that vectors separated by one or more intermediaries  may have high mutual information without implying a direct interaction.

clr
the clr algorithm  <cit>  is based on the empirical distribution of mi. it first defines a score zi given the mutual information mi and the sample mean μi and standard deviation σi of the empirical distribution of mutual information mi,k =  <dig> …,n: 

  zi=max <dig> mi−μiσi. 

zj can be defined analogously. in terms of zi,zj, the score used in clr algorithm can be expressed as zij=zi2+zj <dig> 

mrnet
mrnet  <cit>  infers a network by repeating the maximum relevance/minimum redundancy  feature selection method for all variables. the mrmr method starts by selecting the variable xi having the highest mutual information with target y. next, given a set s of selected variables, the criterion updates s by choosing the variable xk that maximizes uj−rj where uj is a relevance term and rj is a redundancy term. in particular, 

  uj=mi 

  rj=1|s|∑xi∈smi 

the score of each pair xi and xj will be the maximum score of the one computed when xi is the target and the one computed when xj is the target.

aracne
the aracne  <cit>   developed by andrea califano’s group is an extension of relnet. given the limitation of relnet, aracne removes the vast majority of indirect candidate interactions using a well-known information theoretic property, the data processing inequality . the dpi applied to association networks states that if variables xi and xj interact only through a third variable xk, then 

  mi≤min,mi) 

aracne starts with a network graph where each pair of nodes with miij > τ is connected by an edge. the weakest edge of each triplet, e.g. the edge between i and j, is interpreted as an indirect interaction and is removed if the difference between min,mi) and mi lies above a threshold ε, i.e. the edge is removed if 

  mi≤min,mi)−ε. 

the tolerance threshold ε could be chosen to reflect the variance of the mi estimator and should decrease with increasing sample size m. using a non-zero tolerance ε >  <dig> can lead to the persistence of some 3-vector loops.

the outputs from relnet, clr, mrnet or aracne are association matrices. they can be transformed into corresponding adjacencies based on the algorithm discussed in introduction.

mic
another mutual information based method is the recently proposed the maximal information coefficient   <cit> . the mic is a type of maximal information-based nonparametric exploration  statistics  <cit> . in our empirical evaluations, we calculate the mic using the minerva r package  <cit> .

fitting indices of polynomial regression models
while networks based on the pearson correlation can only capture linear co-expression patterns there is clear evidence for non-linear co-expression relationships in transcriptional regulatory networks  <cit> . the following classical regression based approaches can be used for studying non-linear relationships. the polynomial regression model: 

  e=β01+β1x+β2x2…+βdxd=mβ, 

where 

  m=. 

one can show that the least squares estimate of the parameter vector β^ is 

 β^=−mτy, 

 where- denotes the  inverse, and τ denotes the transpose of a matrix.

given β^, we can calculate the fitting index r <dig> as: 

  r2=cor2=cor <dig> 

in the context of a regression model, r <dig> is also known as the proportion of variation of y explained by the model.

spline regression model construction
to investigate the relationship between variable x and y, one can use another textbook method from the arsenal of statisticians: spline regression models. here knots are used to decide boundaries of the sub-intervals. they are typically pre-specified, e.g. based on quantiles of x. the choice of the knots will affect the model fit. it turns out that the values of the knots  is not as important as the number of knots. we use the following rule of thumb for the number of knots: if m >  <dig> use  <dig> knots, if m <  <dig> use  <dig> knots, otherwise use  <dig> knots.

to ensure that fit between y and x satisfies a continuous relationship, we review the hockey stick function() +  to transform x : 

  +=sifs≥00ifs< <dig>  

this function can also be applied to the components of a vector, e.g.  + denotes a vector whose negative components have been set to zero. so  +  is a vector whose u-th component equals x−knot <dig> if x−knot <dig> ≥  <dig> and  <dig> otherwise.

we are now ready to describe cubic spline regression model, which fits polynomial of degree  <dig> to sub-intervals. the general form of a cubic spline with  <dig> knots is as follows 

  e=β01+β1x+β2x2+β3x3+β4+3+β5+ <dig>  

the knot parameters  knot <dig> knot <dig> … are chosen before estimating the parameter values. analogous to polynomial regression, r <dig> can be calculated as the association measure between x and y. this method guarantees the smoothness of the regression line and restrict the influence of each observation to its local sub-interval.

other networks
boolean network  <cit>  and probabilistic network  <cit>  are briefly mentioned in table  <dig> 

availability of software
project name: adjacency matrix for non-linear relationships

 project home page: http://www.genetics.ucla.edu/labs/horvath/coexpressionnetwork/rpackages/wgcna

operating system: platform independent

programming language: r

licence: gnu gpl 3

the following functions described in this article have been implemented in the wgcna r package  <cit> . function adjacency.polyreg and adjacency.splinereg calculate polynomial and spline regression r <dig> based adjacencies. users can specify the r <dig> symmetrization method. function mutualinfoadjacency calculates the mutual information based adjacencies ami,symmetricuncertainty , ami,universalversion <dig>  and ami,universalversion <dig> . function afcormi implements the fcor−miprediction function  <dig> for relating correlation with mutual information.

abbreviations
mi: mutual information; bicor: biweight midcorrelation; mic: maximal information coefficient; aracne: algorithm for the reconstruction of accurate cellular networks; go: gene ontology; lrt: likelihoood ratio test; tom: topological overlap matrix; wgcna: weighted correlation network analysis.

competing interests
we declare no conflict of interest.

authors’ contributions
ls and sh performed the research; ls, sh, and pl wrote the paper and developed r software functions. sh designed the research. all authors read and approved the final manuscript.

supplementary material
additional file 1
detailed methods descriptions. in this document, we provide detail information of entropy, mutual information, likelihood ratio test statistics and p-value calculation of correlation coefficients.

click here for file

 additional file 2
empirical analysis using large number of genes in the mouse adipose and nd data sets. page one is an empirical analysis using all  <dig> genes without restricting to  <dig> genes for the mouse adipose data set.  absolute value of bicor versus ami,universalversion <dig>  one million randomly sampled gene pairs are plotted to reduce computational burden. the two measures show good monotonic relationship. the red curve predicts ami,universalversion <dig> from bicor. the blue circle highlights the probe pair with the highest ami,universalversion <dig> z-score among those with insignificant bicor z-scores ; the red circle highlights the probe pair with the highest bicor z-score among those with insignificant ami,universalversion <dig> z-scores . red and blue circles are selected based on all gene pairs rather than sampled ones.  prediction from bicor based on eq.  <dig> and observed ami,universalversion <dig> are highly correlated. as in , one million randomly sampled gene pairs are plotted. line y=x is added.  gene expression of probe pairs highlighted by blue circles.  gene expression of probe pairs highlighted by red circles.

page two is the same analysis for nd data set using  <dig> randomly selected genes rather than  <dig> genes with highest variance.

click here for file

 additional file 3
comparison of mic and correlation based co-expression measures. comparison of mic and correlation in our empirical gene expression data sets except safhs. this is an extension of figure  <dig>   <dig> best go enrichment p-values from all modules identified using mic and tom are log transformed, pooled together and shown as barplots. error bars stand for 95% confidence intervals. on top of each panel is a p-value based on multi-group comparison test. tom outperforms mic in all data sets except the mouse brain data.

click here for file

 additional file 4
compare polynomial and spline regression models to correlation or mutual information based co-expression measures in simulation. each point corresponds to a pair of numeric vectors x and y with length m =  <dig>  data is simulated as in figure  <dig>   square root of r <dig> from polynomial regression symmetrized by eq.  <dig> versus absolute pearson correlation values. the two measures are indistinguishable since the data is simulated to exhibit linear relationships.  r <dig> from polynomial regression symmetrized by eq.  <dig> versus ami,universalversion <dig>  the red line predicts ami,universalversion <dig> from r <dig>   same plots for spline regression models.

click here for file

 additional file 5
polynomial and spline regression models for estimating non-linear relationships in real data application. in this document, we use polynomial and spline regression models to estimate non-linear relationships in real data applications.

click here for file

 additional file 6
the relationship between module size and gene ontology enrichment p-values in  <dig> real data applications. in each panel, module size  is plotted against −log <dig> go enrichment p-values in dots. loess regression lines are provided to show the trend. red and black color represent network modules constructed using tom and ami,universalversion <dig> based measures, respectively. in most data sets, the enrichment of modules defined by tom is better than that of comparably sized modules defined by ami,universalversion <dig> 

click here for file

 additional file 7
comparison of bicor, pearson correlation and spearman correlation based signed adjacency in  <dig> empirical data sets. each panel show the −log <dig> transformed  <dig> best gene ontology enrichment p-values of all modules identified using each type of adjacency. error bars stand for 95% confidence intervals. on top of each panel is a p-value based on multi-group comparison test. all three types of correlation are similar in terms of go enrichment.

click here for file

 acknowledgements
we acknowledge grant support from 1r <dig> da030913- <dig>  p50ca <dig>  r01ns <dig>  and the ucla ctsi.
