BACKGROUND
acupuncture, an important therapeutic method in traditional chinese medicine , has been used to treat various diseases for thousand years in china. recently it has been gradually accepted in western countries as an alternative or complementary treatment. however, how the acupuncture works remains an open question though acupuncture exists as one of the oldest continuous systems of medicine dating back  <dig>  years. extensive studies have been conducted on the mechanism of acupuncture to explain the effects of acupuncture on various systems and symptoms  <cit> . compared to the relatively widespread use of acupuncture, systems biology is a new term to describe the recent trends in biology research. it emphasizes the high-throughput measurement of biological systems and focuses on the complex interactions in biological systems  <cit> . we highly expect that systems biology, a biology-based inter-disciplinary study field, will provide tremendous opportunities for revealing acupuncture mechanism at the molecular level.

in this paper, we use systems biology method to study the acupuncture treatment effect by identifying a subset of important molecules from high-throughput metabolic data. specifically, we separate the acupuncture from moxibustion and only study the effect of acupuncture on normal people by investigating the difference between acupuncture at particular acupoint and without acupuncture. towards this aim, we utilize 1h nuclear magnetic resonance  to investigate the effects of acupuncture at several meridian points on plasma metabolites. then metabolite profiles  are generated from a collection of case samples and control samples . these high-dimensional profile data is very similar to snp , gene expression , mass spectrum , and small molecules  data in different levels. then the straightforward task is to identify differentially expressed molecules and further classify and predict the diagonostic category of a sample, based on its metabolite profile  <cit> .

generally speaking, there are two difficulties in analyzing these high-dimensional profile data. first, a large number of features  are available to predict classes for a relatively small number of samples. the presence of a significant number of irrelevant features that are unrelated to the case status makes such analysis prone to the curse of dimensionality. second, predictive accuracy is not the only goal and further biological validation and mechanism understanding call for explanatory power other than black box predictive results. thus it is especially important to know which molecules largely contribute towards the classification. ideally we can improve the generalization performance of classifier by identifying only the molecules that are significantly contribute to the classifier. this effect is attributable to the overcoming of the curse of dimensionality. for example, if it is possible to identify a small set of metabolites that is indeed capable of providing complete discriminatory information, inexpensive diagnostic assays for only a few metabolites might be developed and be widely deployed in clinical settings. knowledge of a small set of diagnostically relevant metabolites may provide important insights into the mechanisms responsible for acupuncture treatment itself. those molecules are usually termed as biomarkers. the procedure to reveal them is referred as feature selection, biomarker identification, or feature ranking.

feature selection is known to be np-hard  <cit>  and the search becomes quickly computationally intractable. suppose we treat the feature selection task in a brute force way. given n features, we need to select m features which can get the best classification accuracy  regarding to a predefined cost function. usually in classification or prediction problem, the cost function is selected as the accuracy of the prediction. the exhaustive search method goes through all the possible combinations, with the computation complexity o. thus, this method is not practical for realistic applications.

existing feature selection strategies can be roughly categorized into three types  <cit> . considering the partial ordering properties of the subset space, we can either start with an empty set and successively add features, or start with the set of all features and successively filter them. the former type is referred to as forward selection while the latter is referred to as backward elimination. the third type is the combination of the two approaches. however, all the above methods relies on the greedy strategy. as an example of forward feature selection, we might first look for the single most discriminative feature using any classifier. then we could search the single additional feature that gives the best class discrimination when considered along with the first feature. keeping augmenting the feature set iteratively in this greedy fashion, we stop until cross-validation error estimates are minimized. as a result, the global optimal solution usually cannot be guaranteed.

in this paper, we proposed a novel linear programming  model to address this important problem. feature selection problem is cast into an optimization problem with two objectives, one is to minimize the number of chosen features and the other is to maximize the predictive accuracy based on the centroid classification framework. in other words, our feature selection method simultaneously improves classification accuracy and selects features. comparing with several state-of-the-art feature selection methods, our linear programming based feature selection  method can select a small set of features by applying strong regularization while keeping high accuracy. we then apply our method to analyze the metabolite profile data generated for acupuncture treatment. we identify important molecules  related to the acupuncture treatment for several meridian points. further characterization of the biomarkers and the common and difference among several meridian points provide biological insights for acupuncture mechanisms at molecular level. preliminary results in this paper were presented in our conference paper  <cit> . in this extended paper, we further provide the detailed derivation of the method and comparison with existing works. in addition, we performed more analysis and descriptions for the biological insights of the acupuncture biomarkers.

method
analytic workflow
in this paper, the acupuncture treatment effect is investigated in the framework of systems biology. the basic analytic workflow is shown in figure  <dig>  as the first step, metabolite profiles are originally generated by 1h nmr from control samples and the samples with acupuncture treatment in meridian points. then we develop a linear programming based feature selection method to compare the two groups of metabolite profiles. finally, a small set of metabolites are selected as biomarkers for acupuncture treatment effect.

overview of the linear programming based feature selection
to investigate the high-dimensional data for acupuncture treatment effect, we develop a novel method, lpfs, to select a small set of metabolites to characterize acupuncture treatment effect. the schematic illustration of lpfs is shown in figure  <dig>  lpfs performs feature selection based on the nearest centroid classifier. on one hand, we want to attain the best classification accuracy by minimizing the loss function. on the other hand, feature selection algorithms should be robust to noise and outliers in the data by applying strong regularization. here we use the parsimony principle  by minimizing the number of selected features. then the feature selection problem is formulated as a multi-objective programming. the next step is to convert this multi-objective programming into a single-objective linear programming by applying the ε method. after solving the linear programming model in an efficient way, the optimal features can be selected.

centroid classification prototype
a fast and simple algorithm for classification is the centroid method  <cit> . this algorithm assumes that the target classes correspond to individual  clusters and uses the cluster means  to determine the class of a new sample point . a prototype pattern for class cj is defined as the arithmetic mean:

  μcj=1cj ∑si∈cjxi 

where si is the i-th training sample labeled as class cj. recall that the training sample is a metabolite spectra represented as a multi-dimensional vector . in a similar fashion, we can obtain a prototypical vector for all the other classes. during classification, the class label of an unknown sample s is determined as:

  c=argmincjdis 

where dis is a distance function or:

  c=argmaxcjsim 

where sim is a similarity metric. this simple classifier will form the basis of our lpfs method. the advantages is that it works with any number of features. and its run-time complexity is proportional to the number of features and the complexity of the distance or similarity metric used. according to the experiments in  <cit> , we select l <dig> distance metric, which is robust to outliers and most appropriate for the centroid classification algorithm. it is defined by:

  l1=s-μ <dig> 

with ║y║ <dig> = ∑i |y|, and y being the i-th element of vector y. the value l <dig> has a linear cost in the number of features. in this study, data sets contain two classes and hence the number of calls to the distance metric is also two. therefore, the centroid classifier, at run-time, is linear in the number of features. during training, two prototypes are computed and the cost of computing each prototype is o, where n is the number of features and m is the number of training samples which belong to a given class. note that m only varies between data sets and not during training or feature selection processes. thus, we can view m as a constant and the centroid classifier has o cost in the training phase.

multi-objective optimization model
suppose we have two groups in the training dataset, the case group and the control group as the gold-standard data to classify new samples. we denote them set t and f respectively. supposing |t| = m <dig>  |f| = m <dig>  and the computed centroids are μt and μf respectively. a simple classification scheme is as follows. given a new sample s, we want to decide which group it belongs to. the l <dig> discrepancy between the sample s and the groups t and f can be calculated as ║s - μt║ <dig> and ║s - μt║ <dig>  thus a simple rule is

  s∈tifs-μt1<s-μf <dig> 

  s∈fifs-μt1>s-μf <dig> 

let the feature number be n. we introduce the variables for feature selection as x = , where xi =  <dig> . when xi =  <dig>  it means feature i is selected in the biomarker set. otherwise it is not selected.

suppose the test dataset is u. and it is composed by the case group ut and control group uf. u = ut ∪ uf, and |ut| = l <dig>  |uf| = l <dig>  given a case sample sl = , l ∈ { <dig>   <dig> ⋯, l1}, if it is classified correctly, we should have

  ∑i=1nsli-∑j=1m1tji/m1xi< ∑i=1nsli-∑j=1m2fji/m2xi 

where tk =  ∈ t, k =  <dig>   <dig>  ⋯, m <dig> and fk =  ∈ f, k =  <dig>   <dig>  ⋯, m <dig> 

similarly given a control sample sl = , l ∈ {l <dig> +  <dig>  l <dig> +  <dig> ⋯, l <dig> + l2}, if it is classified correctly, we should have

  ∑i=1nsli-∑j=1m1tji/m1xi> ∑i=1nsli-∑j=1m2fji/m2xi 

with the above constraints for variable x = , the objective function is to choose as few as features, i. e.,

  minx <dig> x <dig> ⋯,xn ∑i=1nxi 

thus the feature selection problem is formulated as an integer linear programming problem in equation .

  minx <dig> x <dig> ⋯,xn ∑i=1nxis.t. ∑i=1npli-∑j=1m1tji/m1xi< ∑i=1npli-∑j=1m2fji/m2xi,pl=∈ut,l∈{ <dig> ,⋯,l1}, ∑i=1npli-∑j=1m1tji/m1xi> ∑i=1npli-∑j=1m2fji/m2xipl=∈uf,l∈{ <dig> ,⋯,l2},xi= <dig> ,i∈{ <dig> ,⋯,n} 

when we consider the noise in the measured data, not all the test samples can be classified exactly. we introduce the tolerable error y = {y <dig>  y <dig>  ..., yl1+l2} for every sample in ut ∪ uf. and yi ≥  <dig>  i ε { <dig> , ..., l <dig> + l2}. when yi is not equal to zero, it means sample i is wrongly classified. otherwise this sample should be correctly classified.

given a case sample sl = , l ∈ { <dig>   <dig> ⋯, l1}, we should have the following constraint considering the tolerable error

  ∑i=1nsli-∑j=1m1tji/m1xi-yl< ∑i=1nsli-∑j=1m2fji/m2xi 

similarly given a control sample sl = , l ∈ {l <dig> +  <dig>  l <dig> +  <dig> ⋯, l <dig> + l2}, we should have the following constraint considering the tolerable error

  ∑i=1nsli-∑j=1m1tji/m1xi+yl> ∑i=1nsli-∑j=1m2fji/m2xi 

thus the objective function composes two parts, i. e., we want to choose as few as features minx <dig> x <dig> ⋯,xn ∑i=1nxi and at the same time we want to reduce the classification error  miny <dig> y <dig> ⋯,yl1+l <dig> ∑i=1l1+l2yi. in general, there is a trade-off relationship between the classification error and the number of features. hence, the feature selection problem can be formulated as a multi-objective optimization problem with discrete variables x =  and continuous variables y= as shown in equation .

  vector - minimize∑i=1nxi, ∑i=1l1+l2yi,subjecttowithxi∈{ <dig> },i∈{ <dig> ,⋯,n},yi≥ <dig> i∈{ <dig> ,⋯,l1+l2} 

the first term of objective function in equation  is to minimize the number of chosen features, and the second one is to minimize the total classification error.

mixed integer linear programming
the optimal solutions of the two-objective optimization problem consist of a pareto set, which can be solved by transforming the two objectives of  into a single objective. one typical technique is the ϵ-method, which alternates a positive scalar parameter λ to obtain the pareto set, with the formulation in equation .

  minx,y ∑i=1nxi+λ∑i=1l1+l2yis.t. ∑i=1npli-∑j=1m1tji/m1xi-yl< ∑i=1npli-∑j=1m2fji/m2xipl=∈ut,l∈{ <dig> ,⋯,l1}, ∑i=1npli-∑j=1m1tji/m1xi+yl> ∑i=1npli-∑j=1m2fji/m2xipl=∈uf,l∈{ <dig> ,⋯,l2},xi= <dig> ,i∈{ <dig> ,⋯,n},yj≥ <dig> j∈{ <dig> ,⋯,l1+l2} 

 is a mixed integer programming . the objective function in  is ∑i=1nxi+λ∑i=1l1+l2yi. theoretically, we can obtain all optimal solutions belonging to the pareto set by changing the parameter λ for the single-objective optimization problem . clearly, λ transforms the number of chosen features into equivalent classification error in , and controls the balance between them.

by solving the proposed mixed integer linear programming model , we can get solutions for the feature selection variables xi, i ∈ { <dig>   <dig>  · · ·, n}, and classification error variables yj, j ∈ { <dig>   <dig>  ⋯, l <dig> + l 2}. checking if xi is equal to  <dig>  we can know if the corresponding feature should be selected in the classifier. meanwhile checking the values of all the yj, we can estimate the classification accuracy. for example, suppose the number of all j such that yj =  <dig> is n <dig> and the number of all j such that yj >  <dig> is n <dig>  we can simply calculate the classification accuracy by n1/l1+l <dig> and n2/l1+l <dig> 

leave-one-out cross validation
the above model  is based on the general idea of cross validation, thus it depends on the choice of t and f. we noticed that there are different ways to do cross validation in feature selection  <cit> . one way is that the feature selection is done with all the samples and the cross-validation is only done for the classification procedure. this kind of cross validation may severely bias the evaluation in favor of the studied method due to "information leak" in the feature selection step. another way is to include the feature selection procedure in the cross validation, i.e., to leave the test sample out from the training set before undergoing any feature selection. our feature selection model allows the freedom to choose the suitable cross validation procedure according to the practical need. if more information is preferred to select biomarkers due to the scarcity of samples, we can use all the samples to estimate the cross validation error in the following resubstitution validation in equation .

  minx,y ∑i=1nxi+λ∑i=1l1+l2yis.t. ∑i=1npli-∑j=1m1tji/m1xi-yl< ∑i=1npli-∑j=1m2fji/m2xipl=∈t,l∈{ <dig> ,⋯,m1}, ∑i=1npli-∑j=1m1tji/m1xi+yl> ∑i=1npli-∑j=1m2fji/m2xipl=∈f,l∈{ <dig> ,⋯,l2},xi= <dig> ,i∈{ <dig> ,⋯,n},yj≥ <dig> j∈{ <dig> ,⋯,l1+l2} 

resubstitution error rate indicates only how good are our biomarkers on the training data. however, this model has "information leak" and will underestimate the classification error. in our implement, we choose the model for leave-one-out cross validation in equation .

  minx,y ∑i=1nxi+λ∑i=1l1+l2yis.t. ∑i=1npli-∑j=1m1-1tji/xi-yl< ∑i=1npli-∑j=1m2fji/m2xipl=∈t,l∈{ <dig> ,⋯,l1},tk=∈t\{pl},k∈{ <dig> ,⋯,m1}\{l}∑i=1npli-∑j=1m1tji/m1xi+yl> ∑i=1npli-∑j=1m2-1fji/xipl=∈f,l∈{ <dig> ,⋯,l2},fk=∈f\{pl},k∈{ <dig> ,⋯,m2}\{l}xi= <dig> ,i∈{ <dig> ,⋯,n},yj≥ <dig> j∈{ <dig> ,⋯,l1+l2} 

we adopt leave-one-out experiment since this particular form of cross validation is an unbiased estimator of the generalization performance of classifier. it makes the best use of the available data and involves no random subsampling. every time we pick out one sample  from the training data and try to classify it correctly. and by doing m <dig> + m <dig> times test we add m <dig> + m <dig> constraints.

linear programming approximation
in general, mixed integer linear programming is difficult to solve. to ensure the computational efficiency, mixed ilp in equation  can be relaxed to the corresponding linear programming . linear programming is the simplest type of mathematical programming and has been widely used in systems biology study  <cit> . therefore, sophisticated algorithm can be adopted to efficiently solve this lp. in terms of computational complexity, the proposed approach makes the computation of biomarker tractable. finally we construct the lpfs model in equation .

  minx,y ∑i=1nxi+λ∑i=1l1+l2yis.t. ∑i=1npli-∑j=1m1-1tji/xi-yl< ∑i=1npli-∑j=1m2fji/m2xipl=∈t,l∈{ <dig> ,⋯,l1},tk=∈t\{pl},k∈{ <dig> ,⋯,m1}\{l}∑i=1npli-∑j=1m1tji/m1xi+yl> ∑i=1npli-∑j=1m2-1fji/xipl=∈f,l∈{ <dig> ,⋯,l2},fk=∈f\{pl},k∈{ <dig> ,⋯,m2}\{l}xi≥ <dig> i∈{ <dig> ,⋯,n},yj≥ <dig> j∈{ <dig> ,⋯,l1+l2} 

after relaxing to continuous value, the value of the optimal solution of xi  indicates the importance of feature i in the nearest centroid classifier. it should be noted that we can use other distance definitions instead of l <dig> in our model to achieve the nonlinear classification effect. the parameter λ can be determined by checking the output leave-one-out predictive accuracy. we also notice that lpfs model can be extended to multi-classification task and n-fold cross validation.

metabonomics profiling by 1h nmr spectra
venous blood  was collected into a heparin sodium tube and the plasma was collected by centrifugation at 1000× g at 4°c for  <dig> minutes. an aliquot of  <dig> μl plasma was mixed with  <dig> μl d2o and  <dig> μl tsp  in d2o  in  <dig> mm nmr tube. the d2o provided a field-frequency lock solvent for the nmr spectrometer and the tsp served as an internal reference of chemical shift. 1h nmr spectra of the plasma samples were acquired on a varian inova  <dig> mhz nmr spectrometer at 27°c by using carr-purcell-meiboom-gill  spin-echo pulse sequence. with a total spin-spin relaxation delay  of  <dig> ms. the free induction decays  were collected into 32k data points with a spectral width of  <dig> hz and  <dig> scans. the fids were zero-filled to double size and multiplied by an exponential line-broadening factor of  <dig>  hz prior to fourier transformation . in addition, diffusion-edited experiments were also carried out with bpp-led  pulse sequence  <cit> . the gradient amplitude was set at  <dig>  g cm- <dig>  with a diffusion delay of  <dig> ms. a total of  <dig> transients and 16k data points were collected with a spectral width of  <dig> hz. a line-broadening factor of  <dig> hz was applied to fids before fourier transformation.

all plasma 1h nmr spectra were manually phased and baseline corrected using vnmr  <dig> c software . for cpmg spectra, each spectrum over the range of  <dig>  to  <dig>  was data-reduced into integrated regions of equal width . for bpp-led data, each spectrum over the range of  <dig>  to  <dig>  was segmented into regions of equal width . the regions containing the resonance from residual water  were excluded. the integral values of each spectrum was normalized to constant sum of all integrals in a spectrum in order to reduce any significant concentration differences between samples  <cit> . identification of metabolites in spectra was accomplished based on literatures and the chenomx nmr suite  <dig>  .

RESULTS
metabonomics data generation
to investigate the acupuncture treatment effects, we originally obtained metabonomics data of plasma metabolites in healthy males at five meridian points using proton nmr. proton nmr  applies nuclear magnetic resonance in nmr spectroscopy with respect to hydrogen- <dig> nuclei within the molecules of a substance, in order to determine the structure of the molecules  <cit> .

as a result, most organic compounds are characterized by chemical shift values, which are usually expressed in parts per million  by frequency and are in the range + <dig> to - <dig> ppm. chemical shift values are not precise, but typically they are regarded mainly as orientational. the exact value of chemical shift depends on molecular structure and the solvent in which the spectrum is being recorded. these chemical shift values can be mapped to eight metabolic subsets . in our experiment,  <dig> chemical shift values are measured for their concentration in plasma, and mathematically every sample is represented by a vector in  <dig> dimensional space.

fifty healthy young males were randomly allocated to zusanli , liangmen , juliao , yanglingquan , and weizhong  groups . each group contains  <dig> persons. inside each group the corresponding meridian points were separately acupunctured for  <dig> consecutive days. in addition, twenty healthy young males are recruited as the blank control groups. all the twenty people are measured before the start of  <dig> consecutive days and additionally ten of them are measured after  <dig> consecutive days. fasting venous blood was taken in all the subjects. plasma metabolites were measured by 1h nmr to derive metabolic profiles . furthermore to exclude possible noises, all the seventy males are strictly trained to make sure their metabolic profiles are measured in very similar conditions. the detailed experimental method can be found in  <cit> . in summary, we have  <dig> samples grouped into zusanli , liangmen , juliao , yanglinquan, weizhong , control i , and control ii .

classification experiments design
with the data, we design experiments to identify biomarkers for the acupuncture treatment of each meridian point. the overall design of biomarker identification experiments is shown in figure 3b. we categorize eighty samples into  <dig> groups shown as the circles in figure 3b. st <dig>  st <dig>  st <dig>  gb <dig>  and bl <dig> each has  <dig> samples. the  <dig> samples in control ii are naturally decomposed into two groups with equal size, pre <dig>  and pre <dig> . treating the pre <dig> as the common control set, we have seven classification tasks  shown as the lines in figure 3b. for example, task exp <dig> tries to identify a subset of metabolites to classify pre <dig> as the control and st <dig> as the case. in this way, exp <dig> to exp <dig> aim to identify the biomarkers for acupuncture treatment on st <dig>  st <dig>  st <dig>  gb <dig>  and bl <dig> respectively. while exp <dig> tries to capture the metabolite change by  <dig> consecutive days without acupuncture. and exp <dig> tries to test if there are significant metabolite change for the people under similar condition. exp <dig> and exp <dig> serve as the control studies to guarantee the significance of our result.

global characterization of the data
we first perform hierarchical clustering on the  <dig> metabolic profiles. the results are shown in figure 4a. if the samples can be clearly discriminated by global pattern, the  <dig> samples should be clustered by with or without acupuncture treatment and then by their meridian points. however, all the sample labels are mixed in the clustering result  and we cannot see clearly boundaries.

furthermore, we calculate the centroids for the seven groups of samples in figure 4b by averaging the  <dig> samples for their metabolite expression values. these centroids are plotted side by side in figure 4b, which shows that these centroids are very similar and it's very difficult to detect the global difference.

the above results together demonstrate that global pattern in metabolic profiles cannot discriminate the zusanli, yanglingquan, liangmen, juliao, weizhong, pre <dig>  pre <dig>  and control i groups. thus it is necessary to find the local pattern in the profile data. our strategy is to find a subset of metabolites as biomarkers to achieve clear discrimination.

comparison with other approaches
before we conduct the acupuncture biomarker identifications, we benchmark our lpfs method by comparing with several existing state-of-the-art methods. there are many existing feature selection methods and they can be roughly categorized into three types, filter, wrapper, and embedded methods. to make the comparison simple and comprehensive, we pick out some representative methods in each type to compare in the same dataset.

filter methods select features as a preprocessing step and feature selection part is independent of a machine learning algorithm . this is computationally efficient. fold change and t-test are the simplest and popular methods to identify biomarker. they are usually the representative methods for filter methods.

let xij and yij denote the log expression values of metabolite i in sample j in the case and control, respectively. we define the ordinary two-sample t-statistic  <cit>  as

  tix ¯i-ȳisi 

where x ¯i,ȳi, and si are the mean of case, mean of control, and the standard deviation of the samples for metabolite i. from t-statistic ti we can easily calculate a p-value. usually a feature is selected if its corresponding p-value is smaller than a predefined threshold  <dig> .

the standard definition of the fold-change  <cit>  for metabolite i is

  fci=′x¯i′y¯i 

where x ´ij and ýij are the raw expression values of metabolite i in sample j in the case and control, respectively. in our implementation, we computes the difference of means  and then rank the metabolites by their absolute values. we choose a cutoff  <dig> to select the significant ones.

on the other hand, wrapper method ranks features based on their effects on classification accuracy. it takes dependencies of the feature subset on the learning algorithm into account and is computationally more demanding. support vector machine-recursive feature elimination  is one of the most successful wrapper method based algorithm in the feature selection  <cit> . svm-rfe conducts feature selection in a sequential backward elimination manner, which starts with all the features and discards one feature at a time by checking the svm accuracy. it has been widely used and extended in high-dimensional data analysis  <cit> . we compare our lpfs method with svm-rfe in metabolite data.

since our lpfs method is an embedded method and simultaneously optimize classification accuracy and the number of selected features, we specifically choose to compare with an existing method with similar strategy, called sparse multinomial logistic regression approach . it was developed to jointly and simultaneously identify the optimal nonlinear classifier, and select the optimal set of features via the optimization of a single posterior objective function . smlr has been extensively applied in problems in systems biology  <cit> . smlr is freely available at http://www.cs.duke.edu/~amink/software/smlr/ and we take the default values for the parameters in our calculation.

without loss of generality, we take exp <dig> in figure 3b as an example to identify a subset of metabolites to discriminate st <dig> and pre <dig>  we select biomarkers from the metabolic profiles and compare the results in two ways.

firstly, we compare different methods in figure  <dig>  by assessing the quality of the selected biomarkers. we simply plot all the metabolites by their standard derivation versus the difference of mean expression value. this is a scatter-plot used in  <cit> , which plots significance versus fold-change on the y- and x-axes, respectively. conceptually, it is very similar to the volcano plot in statistics  <cit> . plotting points in this way results in two regions of interest in the plot: those points that are found towards the bottom of the plot and far to either the left- or the right-hand side. these represent values that display large magnitude fold changes as well as high statistical significance with small standard derivation.

the t-test based method identifies  <dig> metabolites if we choose a cutoff  <dig>  . a strict threshold will still select  <dig> metabolites with cutoff  <dig>  . we list the top  <dig> in table  <dig> and plot them in figure 5a. we find that the ordinary t-statistic selects metabolites with low standard deviations.

the fold change based method identifies  <dig> metabolites if we choose a commonly used cutoff  <dig>  <cit> . and there are still  <dig> metabolites by choosing a cutoff  <dig>  again the top  <dig> are listed in table  <dig> and plotted in figure 5b. it's clear that the fold-changes select metabolites with large shifts between control and treatment.

while smlr selects  <dig> features to achieve the 100% leave-one-out predictive accuracy. these  <dig> metabolites are plotted in figure 5c and  <dig> of them  are listed in table  <dig>  figure 5c demonstrates that smlr is quite efficient to cover almost all the metabolites with large fold change and small standard derivation. however,  <dig> metabolites is too much from the viewpoint of practical usage of biomarkers.

svm-rfe selects  <dig> metabolites in total to achieve the 100% leave-one-out predictive accuracy. these metabolites are illustrated in figure 5d and the top ten are listed in table  <dig>  figure 5d shows that svm-rfe favors the metabolites with small standard derivation.

our lpfs method finally selects  <dig> features as the biomarkers to discriminate st <dig> and pre <dig>  by using only  <dig> features we can achieve 100% leave-one-out predictive accuracy. to show these four important biomarkers are not dependent on the nearest centroid classifier, we use svm to do five-fold cross validation, the predictive accuracy is still 100%. this demonstrates that we can select a small set of important features really matters by applying strong regularization. the selected  <dig> metabolites are listed in table  <dig> and scatter plotted in figure 5e. figure 5e also shows that our lpfs method tends to reveal the metabolites with small standard deviation and large shifts, which exactly serves our requirement for good biomarker. the four metabolites are with ppm  <dig> ,  <dig> ,  <dig> , and  <dig> . ppm  <dig>  and  <dig>  are annotated as a-glucose/glycine and lactate respectively. the expression level of ppm  <dig> ,  <dig> , and  <dig>  goes down after acupuncture treatment while the expression level of ppm  <dig>  goes up.

secondly, we compare the results of these five methods in a venn diagram in figure  <dig>  figure 6a shows the overlap among the results from fold change, svm-rfe, smlr, and lpfs. the  <dig> metabolites selected by our lpfs, metabolites with ppm  <dig> ,  <dig> ,  <dig> , and  <dig> , also correctly selected by fold change, svm-rfe, and smlr. interestingly, all the results obtained by svm-rfe, smlr, and lpfs are included in the results by fold change. figure 6b shows the overlap among the results from t-test, svm-rfe, smlr, and lpfs. again, metabolites with ppm  <dig> ,  <dig> ,  <dig>  are consistently supported by svm-rfe, smlr, and t-test. metabolite with ppm  <dig>  is not included in the t-test result but supported by svm-rfe and smlr. svm-rfe and smlr also select some metabolites which are not included by t-test results. the venn diagram demonstrates that fold change method is more consistent with current feature selection methods when the sample number is not so large.

in addition to the overall venn diagram, the top ten biomarkers obtained by the t-test, fold change, svm-rfe methods are summarized in table  <dig>  when comparing the overlap with top  <dig> list, lpfs still gets consistent results with other methods. metabolite with ppm  <dig>  has a t-test score  <dig>  and fold change score  <dig> . it is ranked the first by all the three methods with rank information. metabolites with ppm  <dig>  and  <dig>  rank high in fold change, svm-rfe. ppm  <dig>  ranks high in the result obtained by fold change.

biological insights for the identified biomarkers
we then applied the proposed lpfs method to identify the biomarkers from the designed seven experiments. as a result, we identified  <dig>   <dig>   <dig>   <dig>  and  <dig> biomarkers for the acupuncture treatment effects of st <dig>  st <dig>  st <dig>  gb <dig>  and bl <dig> respectively. these selected biomarkers can achieve 100%,100%,100%,100%, and 95% leave-one-out cross validation accuracy. the results are summarized in table  <dig>  as expected, exp <dig> fails to find any biomarkers. exp <dig> finds several metabolites due to the fact that the expression values of these metabolites vary after consecutive  <dig> days. so we carefully check the obtained metabolites list by exp <dig> and exclude these metabolites in our final results. some biomarkers identified in table  <dig> are annotated as glucose and lipid. most of them need further investigation on their chemical structures and biological functions.

from table  <dig>  we can see that acupuncture at yangming meridian points  influence mainly plasma micromolecular metabolites and was closely related to energy metabolism pathway. acupuncture at yanglingquan influences mainly plasma macromolecular metabolites and is closely related to lipid metabolism and transport. acupuncture at weizhong doesn't largely influence plasma metabolites. this study suggests that yangming meridian points have certain characteristics, which are different from those of both yanglingquan and weizhong. metabonomics techniques based on 1h nmr and biomarker identification method provide experimental evidence for distinguishing between yangming meridian points and other meridian points from the metabolic aspect. this fact may become a new useful information source to study the specificities of meridian points.

to reveal the similarity and difference of the identified biomarkers regarding to meridian points, we calculate the overlaps of these biomarkers and present them in figure  <dig>  we found that weizhong is slightly different from other meridian points. there is no overlapped metabolites for weizhong and other meridian points. compared to that, zusanli, yanglingquan, juliao, and liangmen are close to each other by sharing two common metabolites: ppm  <dig>  and  <dig>  . in them  <dig>  is annotated as a-glucose/glycine. among the five points, zusanli, liangmen, and juliao are on the same meridian. from the venn diagram in figure  <dig>  we can clearly see this trend. yanglingquan has a unique biomarker with ppm  <dig> . our biomarker analysis indicates that acupuncture has some common molecules in metabolic level. at the same time, acupuncture at different meridian points has different molecular response. our result is consistent with the theory on specificities of meridian points.

our results show that metabolite with chemical shift value  <dig>  is clearly a common biomarker for st <dig>  st <dig>  st <dig>  and gb <dig>  in figure  <dig>  we visualize the metabolic profiles as a two-dimensional graph and highlight this important molecule. the two dimensional graph, called the gedi-"mosaics", provide a unique, one-glance visual engram that gives each high-dimensional sample a face. a characteristic of gedi's analysis is that it does not prejudicate any particular structure in the data . thus, it allows the researcher to use human pattern recognition to perform a global first-level analysis of the data  <cit>  . it is clear that the highlighted metabolite has distinct expression value in case and control group . this demonstrates the effectiveness of our biomaker identification method.

importantly, our lpfs method reveals the metabolite with ppm  <dig>  as a biomarker for meridian points st <dig> and st <dig>  this molecule is annotated as lactate. lactate has been extensively studied over years for many important functions. for example, the lactate has always been regarded as the central nervous system metabolic waste and a sign of hypoxia  <cit> . also in recent years, evidences show that the role of lactate in brain energy metabolism should be re-recognized. firstly, investigations find that lactate is not only a very important energy resource for brain, but a sensor of brain energy homeostasis  <cit> ; secondly, lactate in adult brain mainly comes from astrocytes, and it is a collaborative carrier for neuron and astrocytes  <cit> ; thirdly, lactate plays an important role in coupling energy metabolism and functional activity  <cit> ; and lastly, lactate has neuroprotective effect in a number of pathological conditions. it's interesting to see lactate as a biomaker closely relating to acupuncture in our result. whether lactate plays a substantial role in acupuncture effect at st <dig> and st <dig> needs follow-up biological experiments.

discussions and 
CONCLUSIONS
biomaker identification or feature selection considers the problem of constructing a prediction rule from only a feature-subset and accurately classifying the context of diagnosis and treatment observations . such problems have become increasing important and quite general in genomics , proteomics , metabolics , and other areas of computational biology. due to the number of features is much larger than the number of observations, simple, highly regularized approaches are in pressing need. here, we proposed a novel linear programming based feature selection  model to address this important problem. the feature selection problem is cast into an optimization problem with two objectives, one is to minimize the number of chosen features and the other is to maximize the predictive accuracy. mathematically the feature selection problem is formulated as a mixed integer linear programming problem. then the model is further relaxed to linear programming to ensure the efficient identification of a feature-subset. we can solve the in-essence combinatorial optimization problem in a computational reasonable way. in summary, our lpfs method can select feature and learn the classifier in a joint way and we can select a small set of features by applying strong regularization. our methodology is general and can be easily applied to other scenarios  <cit> .

we extensively compared our lpfs method with existing methods in the real datasets on acupuncture treatment at different acupoints. we find that, 1). our method can select the fewest features while achieve accurate predictions. 2). our method is free of arbitrary threshold choice. 3). close check of the selected feature shows that our method can identify those biological meaningful features. 4). in addition, the cross-validation results show that our method can achieve relatively high accuracy in prediction.

prior information allows further improvement of our method. currently the identified biomarkers are independent to each other. we can move further step to interpretation by considering a group of biologically meaningful biomarkers. for example, we can incorporate the network information  into the feature selection procedure. as a result, a pathway or modules in the network will be finally selected instead of single molecule as the biomarker, so called network biomarker. we note that prior information can be easily incorporated into our optimization model either by adding some constraints or penalizing in the objective function.

in this paper, the biomarker identification for each acupuncture point is treated as a single binary classification task. we then compare the revealed biomarkers for their similarity and difference across different acupuncture points. we note that a multi-classifier can be developed to systematically integrate all the profiles from different points together. this topic is in progress as our further direction.

finally, the metabolic profile is known for its high variance. we note that the main source of variance is from nmr technology instead of acupuncture effect  <cit> . to maximally reduce the variance from metabolic profile, we carefully design our experiments. firstly, we used the relatively stable blood samples instead of urine sample. secondly, we specifically use the pareto scaling and orthogonal signal correction  method  <cit>  to normalize the raw data, which will reduce the variance of samples inside each group and enhance the differences among groups. even with all these efforts, the remaining high variance may due to the change of environments and conditions and will eventually prevent the high accuracy for identification of biological meaningful biomarkers. in addition to variance, the limited number of sample in our study may also bring some potential effects on the results. from this viewpoint, these identified biomarkers should be carefully validated for their biological functions. also, additional control study should be carefully designed to exclude other possible cofactors. further integration of the data from other levels, such as gene expression and proteomics levels, will improve the robustness of the identified biomarker.

competing interests
the authors declare that they have no competing interests.

authors' contributions
yw proposed the computational method. qfw, xzy, sgy, and frl designed the experimental study and generated the data. yw, cc, lyw, and xsz implemented the method, performed the experiments and analyzed the data. yw and qfw wrote the manuscript. all authors revised the manuscript and approved the final version.

