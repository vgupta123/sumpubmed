BACKGROUND
during the evolution of proteins there is interplay between selection acting to keep some residue identities constant, thus preserving protein function, and selection acting to accept new sequence variants with altered properties that confer improved survival. thus, when studying the evolution of the structure-function relationship in a family of proteins, identification of invariant residues within the family identifies parts of the protein that are of central importance to its function. this idea is central to many comparative studies of protein structure/function relationships, and the concept has been extended to studies of pairs of residues whose identities co-vary in an apparently compensatory manner  <cit> .

however, the converse idea, that varying residues are not centrally important to the protein's function, is not necessarily true. although it is true that residues that do not have a major impact on protein function will show extensive variation over time, it is also true that residues that contribute to the quantitative variation in a protein's properties will also vary.

the problem that arises, then, is how to distinguish the residues whose variation in identity is responsible for functional variations in the protein from those residues whose variation in identity is relatively immaterial to function. these residues will not be detected by evaluating the extent of variation in a given residue or in pairs of residues. rather, the residues will co-vary with the property of the protein that they affect. to solve this problem it is necessary to use techniques that can detect associations between combinations of residue identities at any position in the protein and the quantitative value of the parameter of interest. we here report an analysis to detect such an association between structure and function in voltage-gated potassium channels  using machine learning techniques.

vkcs are membrane proteins that regulate the passage of potassium ions through membranes  <cit> . when the voltage difference across a membrane reaches a threshold, the probability that vkcs will open begins to become significant, allowing increased potassium ion diffusion through an ion-selective pore in the channel. this voltage-regulated potassium ion permeability is critical in cellular excitability. mutations in vkc genes have been shown to be associated with cardiac arrhythmias  <cit> , episodic ataxia  <cit> , and other diseases  <cit> . consequently, vkc proteins have been considered good targets for drug design directed at a number of diseases  <cit> .

a functional vkc consists of four subunits, each containing six transmembrane regions, s <dig> through s <dig>  s <dig> has been shown to function as the main voltage-sensing domain  <cit> , acting by moving perpendicular to the plane of the membrane upon depolarization  <cit> . this movement causes a conformational change in the region of the pore to open the "gate" and allow potassium ions to pass through. there is currently heated dispute over which of several mechanisms that have been proposed to explain how the sensor movement changes the channel conformation is correct  <cit> .

elements of the molecular basis of vkc function have been elucidated through structural studies  <cit> . the structures of several potassium channels of different types have been determined crystallographically  <cit> . the structure of the ion selective pore is very similar in all of the models; these studies have clearly identified many aspects of the molecular dynamics of selective ion permeability. although the structure of one voltage-gated potassium channel has been determined  <cit> , the unusual mobility of the voltage sensor region and the necessity of using a bound antibody to stabilize the crystallized conformation raise serious questions of how similar that determined structure is to the functional conformation of the ion channel  <cit> . extensive mutagenesis and biophysical studies of different voltage-gated ion channels have lead to several models of function that are quite different from each other and from the model proposed based on the kvap crystal structure . thus, although the molecular basis of ion selectivity and permeability is well supported by the current structural knowledge, the molecular basis of voltage sensing, and in particular the molecular basis of the fine differences in voltage sensitivity between channels, is not well defined by structural studies.

in the absence of three-dimensional structures of various vkcs that unambiguously show different opening/closing stages, mutagenesis of individual residues of different vkcs has been the main method for inferring the structure-function relationship of vkcs. however, it is prohibitively time-consuming and costly to do mutagenesis of all residues individually and in combinations in different vkcs. computational tools, usually multiple sequence alignment, have been used to identify conserved regions of vkcs and limit the priority in mutagenesis experiments to evolutionarily conserved residues  <cit> . unfortunately, details of the complex structure-function relationship between individual residues and the electrophysiological properties, which are mostly continuous quantitative parameters  <cit> , are too complicated to understand by simple inspection of aligned vkc sequences. with dozens of vkc sequences of a few hundred residues each and continuous electrophysiological variables, more mature data mining tools, such as machine learning, are necessary.

machine learning generalizes an underlying data model for a phenomenon by "learning" from existing data from specific examples of that phenomenon, using various classification rules. it yields a mathematical or computational model that can best describe the existing data and predict classifications of new data  <cit> . because of its ability to extract complex models from large datasets, machine learning has been successfully applied to many data-rich problems such as marketing reports, weather prediction, automatic genome annotation and microarray data analysis  <cit> .

in this report we tested several learning algorithms, as implemented in the weka program package  <cit> . most of these were categorical learners; they evaluate how features can be used to assign each sequence to a pre-defined discrete category. the oner classifier identifies a set of rules based on the identity of the amino acid residue at only one of the various aligned amino acid positions that best classifies each sequence in the training set. the decision tree classifier identifies a minimal set of amino acid positions, and branching decisions based on residues at these positions, that correctly classify the training data. the naïve bayes classifier uses observed frequencies of residues at selected positions to apply bayes' theorem to make probabilistic predictions of the category to which a sequence belongs. kernel density estimation estimates the probability distribution for use in the bayesian analysis if a non-normal distribution is suspected. the k nearest neighbour  classifier was used for both categorical classification and for classification that treats v <dig> as a continuously varying quantitative characteristic; this method uses a distance measure to determine which elements of the training set are closest in attribute space to the example being evaluated and assigns the average of the k examples that are most similar to the test example as the predicted value.

typically, a protein family comprises dozens of members with hundreds of residues in each member. such datasets present a unique type of problem for machine learning. first, a typical training dataset for machine learning contains distinctively labelled "features" in every instance. with protein sequence datasets, all sequences must be aligned with each other to identify homologous residues . second, dozens of sequences with hundreds of residues each create a dataset with very high dimensionality, which compromises learning performance. finally, besides generating a classifier with high accuracy, it is pertinent to bench biologists to evaluate the biological importance of individual residues  that contribute to a good learning performance during training, so it is desirable to use learning methods that return the basis for their prediction.

in this report, we have mined available vkc sequence and electrophysiological data using machine learning and related feature selection techniques, and derived a model that predicts one of the central electrophysiological parameters, half activation voltage   <cit> , of a given vkc, based on only its amino acid sequence. our best result was obtained using a k-nearest neighbor classifier  combined with feature selection using a wrapper algorithm  <cit> , yielding a mean absolute error  between the predicted and published v <dig> values of  <dig>  mv in a repeated ten-fold cross validation. the prediction by our final predictor was validated by permutation test and by comparison of predictions to independently obtained experimental results. the training process also provides a rational basis for identifying residues potentially critical to the activation of vkcs, and several identified key residues are located in regions that have been proposed to modulate vkc activation.

the methods that we have applied to the study of vkcs are general. with appropriate alignment, feature selection and model validation, this analytical approach can be used to generate biological hypotheses in other protein families and these hypotheses can be practically tested using site-directed mutagenesis.

RESULTS
learning without feature selection
a dataset consisting of  <dig> aligned positions from  <dig> vkc sequences  was initially used to train different learning algorithms to predict the v <dig> value of a given vkc sequence. figure  <dig> illustrates schematically the process that was used in developing the final predictor. v <dig> values were divided into seven nominal classes for categorical learning. the accuracy of the best categorical learning was below 30% . the mae of the best numerical prediction of v <dig> values with the knn classifier  was close to  <dig> mv. this analysis is equivalent to assigning a predicted v <dig> to a channel based on the v <dig> of the channel's nearest neighbor or neighbors in a distance-based phylogenetic tree. evidently, these learning algorithms alone do not produce an accurate model for prediction if they are trained with such a high dimensional dataset of less than  <dig> instances. this is likely because a relatively small number of residues affect the v <dig> of a channel and the majority of residues affect other parameters, which do not co-vary with v <dig>  of the channels.

learning with data filtering
to improve learning performance with this high dimensional dataset, we added feature selection before learning, using a filtering algorithm to decrease the dimensionality. all residues  were ranked based on their information gain scores  <cit> . different numbers of top-ranked residues were then used for learning. the best learning performance was obtained using only the top five ranked features , and the categorical accuracy improved to 36%. the mae of the numerical prediction of v <dig> values with a knn classifier was now reduced to  <dig> mv . while dimension reduction by filtering to select residues with high information gain did appear to yield a better learning performance, the improvement is marginal.

learning with wrapper
we also applied a wrapper algorithm, a more learning performance-driven feature selection method than filtering  <cit> . from a large number of sets of residue  combinations, wrapper selected the residue set that yielded the best learning performance. the prediction accuracies with all categorical learning algorithms improved, with the best classification of 60% accuracy using the knn classifier. when the knn classifier  was combined with wrapper to predict a numerical v <dig> value based on a vkc sequence, the mae of prediction improved to  <dig>  mv from  <dig>  mv . the best prediction accuracy was obtained with six residues .

effect of scoring matrix choice and distance formula
we used an identity matrix  and transformed blosum <dig> and pam <dig> amino acid matrices  for calculating distances in knn classification. the best maes were the same for all three scoring matrices in repeated ten-fold cross validations. the best predictors obtained with each scoring matrix used  <dig> features ,  <dig> features  and  <dig> features . we performed the remainder of our analyses using the blosum62-based matrix because it yielded the best accuracy with the fewest features. five of the six features identified with the blosum62-based matrix were identified by analyses with at least one of the other two scoring matrices .

we also evaluated the result obtained by summing the individual character distances  to the result obtained using the euclidian distance as described in materials and methods, using the transformed blosum <dig> distance matrix. we obtained the same mae with the same six selected features, indicating that the learning method is robust to the distance calculation method, at least with this data set.

learning combined with outlier selection
since the dataset has only  <dig> vkc sequences, a small number of outliers, or incorrect class labels, might have greatly affected the training process and thus led to poor learning performance. we evaluated the effect of deleting each sequence from the dataset, by training the knn classifier with each of the  <dig> possible subsets of  <dig> sequences. the top  <dig> subsets with  <dig> vkc sequences that produced best learning performances using a repeated ten-fold cross validation were kept and the pruning procedure was then repeated with each of the  <dig> subsets as a starting point . the six-feature set that gives the best learning performances using dataset  <dig>  was used during outlier selection. in spite of the plateau in round  <dig> and  <dig>  there were significant improvement of learning accuracies in round  <dig> and round  <dig>  after four pruning rounds the improvement in accuracy significantly slowed down in the following rounds . thus, we believe that round 1– <dig> represents informative gains in accuracy from deleting true outliers, whereas the improvement in later rounds is due to over fitting. this outlier selection improves the mae from  <dig>  to  <dig>  mv

during the pruning process, four vkc sequences, vkc <dig> , vkc <dig> , vkc <dig> , and vkc <dig>   <cit> , were consistently selected as outliers from rounds 1– <dig>  although the order by which they were deleted varied. we therefore created a new dataset of  <dig> sequences . the new dataset was used to construct the knn final classifier, for which the best mae improved to  <dig>  mv . we also re-ran the complete training protocol using the wrapper algorithm with dataset  <dig>  and exactly the same feature set was again selected, producing the best mae of  <dig>  mv.

we also evaluated two other measures of prediction quality, the r-squared value, which represents the percentage of variance in the training set that is explained by the predictor, and the correlation between the actual and predicted v <dig> values. for dataset  <dig> the r-squared value for all characters is - <dig>  and the correlation coefficient is  <dig> ; the r-squared value for the selected six features is  <dig>  and the correlation coefficient is  <dig> . for dataset  <dig> the r-squared value for all characters is - <dig>  and the correlation coefficient is  <dig> ; for the selected six features the r-squared value is  <dig>  and the correlation coefficient is  <dig> .

permutation tests
one hundred permuted datasets were generated by randomly shuffling the v <dig> values among the vkc sequences in the dataset  <dig>  with the same parameters and settings with which we obtained the predictor, we applied knn classification combined with the wrapper algorithm for feature selection to each one of these permuted datasets, yielding  <dig> different predictors with different feature sets and performance values. these  <dig> replicates provide an estimate of the probability distribution of the maes for the null hypothesis that there is no functional relationship between the sequence and the v <dig> value. the maes with the permuted datasets range from  <dig>  mv to  <dig>  mv . the performance of the predictor with the original dataset  is significantly better  than would be expected if there were no connection between the sequence and v <dig> value.

validation of predictor with independent experimental data
thirteen wild type vkcs that were not part of the training data were evaluated with the final predictor. the v <dig> values of these "new" vkcs had been determined independently in electrophysiological experiments  <cit>  . the mae of these predictions is  <dig>  mv . within this test set, two vkcs are from species that are evolutionarily distant from any of the other sequences in the training dataset, hirudo medicinalis and ciona intestinalis  <cit> , and the prediction errors for these two vkc are both over  <dig> mv . when the most distant sequence  is removed, the mae of the remaining twelve vkcs is  <dig>  mv, and if both sequences are removed mae =  <dig>  mv, below the mae we estimated using a repeated ten-fold cross validation .

we also evaluated the predictor by comparing the predicted v <dig> values of a number of vkc mutants with experimental data from an alanine mutagenesis scan of rat kv <dig>  by li-smerin et al  <cit> . the comparison is shown in table  <dig>  the mae between our predictions and data obtained experimentally is  <dig>  mv, which is reasonably close to our estimated mae of  <dig>  mv using cross validation. note that in five of the cases the predicted values for v <dig> are the same; this is because none of the mutations to alanine makes a new set of informative sites that is closer to a new training sequence. in the two cases where one of the informative residues was mutated to a residue that is represented in one of the channels in the learning set , the prediction improves significantly  .

identification of informative features 
the wrapper algorithm identifies a relatively small number of residues that are the primary determinants of accurate learning. with both dataset  <dig>  and dataset  <dig> , six residues were consistently selected to produce the best learning performances , using a knn classifier and a transformed blosum <dig> scoring matrix. we reason that the residues that were identified as most informative in learning are more likely involved in modulating the physical activation process of vkcs. the selected residues were mapped onto a schematic of the s1–s <dig> structure . all of them reside in s1–s <dig>  a region that likely plays a modulating role in vkc functioning  <cit> .

independent evolution of character states in informative characters
a phylogenetic tree was inferred with mrbayes v <dig> b <dig>  <cit>  using the  <dig> channel data set. the evolution of individual characters was then inferred on this tree using maximum parsimony criteria as implemented in macclade  <cit> . in the case of all six of the informative characters, at least one of the character states has arisen multiple times during channel evolution . in all cases, the residue identities that have arisen independently during channel evolution have large hydrophobic side chains .

discussion
learning with high dimensional data
data with high dimensionality are a "curse" to learning performance. as a rule of thumb, the number of instances should be no less, and preferably more, than the number of features to obtain a reasonable learning accuracy  <cit> . even with a large number of instances, a large number of irrelevant features can still compromise the learning performance  <cit> . for biological data, however, enough examples with relatively small dimension are not always achievable. without feature selection or some other form of dimension reduction prior to data analysis, learning performance with high dimensional data is poor. many dimension reduction methods have thus been applied to improve learning performance, including principle component analysis and linear discriminant analysis  <cit> .

we faced this problem in our analyses. there were less than  <dig> vkc sequences with published v <dig> values, and there are nearly  <dig> residues in each sequence alignment after trimming poorly aligned regions. most residues likely have little or no role in determining v <dig> values, and thus are "irrelevant features". training without feature selection using several machine learning algorithms yielded categorical prediction accuracies consistently lower than 30% .

application of a filtering analysis before learning improved the accuracy marginally . filtering is a pre-learning data processing method based on evaluation of the information content of the dataset, and thus is independent of the training process. it has been successfully used in other tasks to obtain better learning performance  <cit> . however, it may or may not select truly relevant features, depending on the datasets and the selection criteria. considering the number of features and number of instances in our datasets, some irrelevant features may well correlate with the final class labels by chance and display a high information gain potential that does not reflect a functional connection between sequence and v <dig> 

we then applied a wrapper algorithm to select features during the learning process. wrapper uses a heuristic search to select the subset or subsets of features that yield the best learning performance  <cit> . it "wraps" around the learner and selects best feature sets based on learning accuracies. in a heuristic search there is no formal guarantee that the search will not become trapped in a local optimum and miss the global optimum. to decrease the chance of missing the global optimum without making the analysis intractable, we selected the top  <dig> residue combinations at each round and used them all as starting points for the next round of searching. best-first searching was continued until learning performance stabilized. the learning accuracies with wrapper increased greatly for all learning algorithms we used. the best categorical result was obtained with the knn classifier  with an accuracy of 60%. to generate a numerical predictor for v <dig>  we also trained the knn classifier combined with wrapper for numerical classification; the mean absolute error of prediction improved to  <dig>  mv from  <dig>  mv .

since wrapper does not use an exhaustive search and does not guarantee optimal feature selection, we applied "residue swapping" to explore the possibility that one or more residues would yield better results in the context of the finally selected residue set than they would in the initial search. however, residue swapping did not produce any feature sets that yielded significantly better predictive performance. although, as an empirical operation, branch swapping does not guarantee the global optimum in phylogenetic analysis  <cit> , this process is a reasonable heuristic approach for searching in the neighborhood of an optimum for other, better, feature sets.

outlier selection
typically, with a sufficient amount of data, classification using machine learning is expected to be insensitive to outliers. however, a dataset with a low number of instances relative to features of structural and functional data increases susceptibility to outlier effects.

the v <dig> values in our dataset were obtained from publications from dozens of labs. we used averages for three v <dig> values in our datasets because different investigators have published different v <dig> values for the same vkc sequences. the difference in v <dig> values of same vkcs from different labs sometimes for two of those channels exceeds  <dig> mv  <cit> . thus, it is almost certain that some vkcs in our datasets compromise learning because they are incorrectly labeled.

we evaluated the prediction accuracies with datasets from which one sequence was pruned at each round of training . based on the variations in learning performances, we stopped at round  <dig> . at both round  <dig> and  <dig>  learning performances displayed an improvement of mae of almost  <dig>  mv . the improvement of learning performances after round  <dig> decreased significantly .

one sequence was deleted in each round of pruning. creating the best learning performance from the remaining data, the top fifty such "remaining" sequence sets were all used as starting points for the next round of searching. four sequences were consistently selected for "deletion" in the first four rounds, although in different orders. the best learning performance produced a mae of  <dig>  mv with the new dataset of  <dig> vkc sequences , after deleting the four potential outliers; with the outliers the mae was  <dig>  mv.

outliers may arise from experimental errors, or the channels may be activated by different mechanisms so v <dig> values would be affected by a set of residues that is different from those that affect the non-outliers. in the latter case, the "deleted" outliers become interesting research targets  <cit> . however, we could not rigorously exclude the possibility that they were selected as outliers due to the specific dataset we used and possible data over-fitting in our training.

among the deleted outliers, vkc <dig>  a squid kv <dig> channel, was shown to undergo extensive rna editing, leading to its functional diversity  <cit> . its g-v curve, which was used to obtain its v <dig> value, had to be fitted with two boltzmann functions, adding another layer of complexity to its gating mechanism  <cit> . vkc <dig>   <cit>  is a fast inactivating channel. its activation might overlap its inactivation, which would make it difficult to obtain an accurate v <dig> value  <cit> .

we also tested the possibility channels with the most distant nearest neighbors might be outliers. we identified the nine sequences that were most distant from their nearest neighbors and sequentially removed them from the dataset, evaluating the mae of the resulting predictor after each deletion using a  <dig> times 10-fold cross-validation. none of the four channels mentioned above was among this set. the maes of the first  <dig> deletion datasets were greater than that for the full set of  <dig> sequences ; after the ninth deletion the mae was  <dig>  mv. thus, an a priori assumption that the most distant sequences will cause poor prediction performance is not valid in this case.

the predictor performance was also evaluated using the r-squared statistic and correlation coefficient of the predicted vs. the actual v <dig> values. both of these measures showed a significant improvement of prediction performance with feature selection and outlier removal. the 10-times 10-fold cross validation of best predictor, using the six selected characters and dataset  <dig>  yielded an r-squared value of . <dig>  indicating that the predictor was accounting for approximately 77% of the variation on v <dig> between channels. the linear correlation coefficient between the predicted and actual v <dig> values was  <dig> , which also indicates that the predicted v <dig> values are well correlated with the actual values for the channels.

statistical evaluation using a permutation test
the machine learning approach that we have implemented searches for an optimal value of mae, so it will always yield a model that associates the identity of some residues with the v <dig> value, even if that association is specious. to evaluate whether the association of residue identity and v <dig> is significant, a statistical test of significance is necessary.

a permutation test is a special case of randomization tests. with a small sample of data, a permutation test generates an approximate probability distribution for a null hypothesis. permutation tests have been widely used in biomedical and other areas including microarray analysis, snp research, and clinical studies  <cit> . compared with other statistical analyses, a permutation test works well with small sample sets and it does not require a normal distribution, which many small samples do not have. some researchers have even proposed that permutation test should be used in all cases  <cit> .

we evaluated whether there is significant information linking the sequence of a vkc to its v <dig> value using one hundred permutations of the original dataset, where v <dig> values were randomly reassigned to sequences. one hundred different computational models were generated with one hundred different sets of features . the best and worst maes among these permutation learning are  <dig>  mv and  <dig>  mv, respectively, with a mean mae of  <dig>  mv and standard deviation of  <dig>  mv. the mean mae,  <dig>  mv, differs significantly from that of the predictor that was generated with the original, non-permuted, dataset,  <dig>  mv . since both knn classification and the feature selection process were involved in the permutation test, each test yielded a best model that mathematically correlates a set of residues with a permuted set of v <dig> values. the fact that the original model significantly outperforms any of the "permuted" models strongly supports the conclusion that the original learning has detected a valid association between sequence elements of vkcs and their v <dig> values.

evaluation of predictor using independent experimental data
due to the limited number of data, we did not retain a portion of data as an independent test set when constructing the predictor. instead, we used a repeated ten fold cross validation to estimate prediction errors on unseen data. to obtain an independent objective assessment of predictor performance, we located another thirteen vkcs that have been functional characterized, including vkcs that were recently cloned  <cit> , as an independent test set. using the predictor, the mae of predictions of all thirteen new vkc instances is  <dig>  mv , which is higher than what we estimated using a repeated ten-fold cross validation .

we also tested an alternative model, that the v <dig> could be predicted by assigning the average v <dig> value of the sister group of each channel on a phylogenetic tree that was constructed based on the full set of  <dig> aligned amino acid positions. we tested both a distance tree and a bayesian maximum likelihood tree . the phylogeny-based predictions were significantly poorer than those we obtained with the fully optimized predictor .

the optimal predictor was built with a knn classifier. in knn classification, a close "neighbor" from the training set will be used as a template to classify a new instance. if the training data are not evenly distributed in the instance space, some areas contain fewer instances with larger empty space than others, as is shown in the distance tree of the training data . evidently, instances that are in these sparse areas will likely be less accurately classified, since they do not have close neighbors. in fact, superposition of the test vkc data on the distance tree of the training data clearly showed an unequal distribution in the sequence space . among the thirteen test vkc data, all but two are from species that exist in the training set. one vkc is from hirudo medicinalis  <cit>  and the other is from ciona intestinalis  <cit> . the difference between the h. medicinalis channel sequence and its nearest neighbor in the training set is much greater than for any other sequence and its nearest neighbor. the prediction errors of these two vkcs using the predictor are  <dig>  mv and  <dig>  mv, respectively. when the h. medicinalis sequence is removed from the analysis the mae for the test set is  <dig>  mv, and if both of these sequences are removed the mae is  <dig>  mv. this analysis indicates that a more phylogenetically diverse selection of channels in the training set should improve prediction performance.

in the training set, all v <dig> values were determined from channels expressed in xenopus oocytes. in the test set, however, we also included vkcs that have v <dig> values determined in other cells, such as hek <dig> and cho cells  <cit> . although it is known that the experimental v <dig> values of vkcs can vary if they are measured in different cells, the difference is often not significant, as shown by experimental data of several vkcs that have been characterized in both xenopus oocytes and other cells. therefore, we believe that the test set serves as a valid independent test set. in fact, it is likely that a better estimate would be obtained if all test instances were measured in xenopus oocytes, which would remove variation due to differences in expression systems.

we also compared experimental data from a mutagenesis scanning study by li-smerin et al with predictions by our predictor   <cit> . despite using a test set comprising results from vkc mutants, and the presumably drastic difference between data distributions of the test set and our training sets, prediction results are consistent with results from the published mutagenesis study of vkcs . this result supports the conclusion that our estimated prediction error is close to the true error.

although all of the mutations have changed one of the six informative residues, only two of them have mutated to an amino acid that is represented at that position in one of the training set sequences. the v <dig> predictions for these two mutants, marked with asterisks, are much closer to the observed v <dig> values than those for the other three mutants. this suggests that as more channels are cloned and characterized and the variety of the training set increases the performance of this kind of machine learning and prediction will improve.

little variation of voltage sensitivity from the wild type  was predicted for most vkc mutants . these mutants were shown to have little impact on voltage sensitivity if they were mutated to ala in kv <dig>   <cit> . consistently, these mutants were predicted to have a v <dig> value close to that of the wild type . one mutant, a154y of kv <dig>  rat, displayed a large shift of v <dig> of over  <dig> mv  <cit> , and our predictor also predicted a large positive shift in v <dig> value . although this is the largest margin between the predicted v <dig> and the experimental data, the correct prediction of direction in v <dig> shift by our predictor is encouraging.

identification of biologically important residues 
one goal of building a model that can predict v <dig> value of a given vkc sequence with reasonable accuracy is to identify residues that are involved in modulating voltage sensitivity. in our analysis, different feature  sets were selected by wrapper and screened to identify the feature set that yielded the best learning performance. in a forward selection approach, one feature  was added at each round. although different features were sequentially selected in different orders during the first five rounds, the feature set that produced the best learning performance converged to six residues. these six residues are the best features in predicting the v <dig> value of vkcs based on their amino acid sequences. the prediction was also validated by independent experimental data . likely, these residues are central to setting the voltage sensitivity of vkcs.

some functionally important residues may not be identified using our approach. if a group of residues co-vary because they interact with each other to affect v <dig> values of vkcs, for example, after one residue is identified, the addition of the other residues may not further improve learning performances, and thus they would not be selected. however, no feature co-varied precisely with the six selected features in a covariation analysis . also, our datasets contain a tiny subset of all the vkcs in nature that may not be an unbiased representation of all vkcs, so the residues that are selected may be only pertinent to these specific datasets. the quality of the experimental data are also a factor, indicated by the different v <dig> values obtained by different research labs for a same vkc  <cit> . outlier selection may have helped alleviate the problem, but it is still a potential error source. nevertheless, the combination of the selected residues should be a good indication of potentially functionally important structure elements.

the positions of the six features selected with a modified blosum <dig> matrix are shown mapped onto a schematic of the vkc channel in the membrane in figure 4a. all six selected residues are on one of the transmembrane helices s <dig>  s <dig> or s <dig>  none are found on the primary voltage sensor, s <dig>  or on the pore/gate complex s5–s <dig>  although the s1–s <dig> region is not the primary voltage sensor, there is extensive experimental evidence that interactions between the s <dig> helix and the s1–s <dig> region are important in setting the value of v <dig>  tiwari-woodruff et al.  <cit>  and papazian et al.  <cit>  have demonstrated that three acidic residues in s <dig> and s <dig>  interact with basic residues in s <dig> during the process of voltage response, and that altering these residues in the d. melanogaster shak channel will alter the value of v <dig> by more than  <dig> mv  <cit> . those results suggest that one face of both s <dig> and s <dig> face the charged surface of s <dig> at least during the process of activation, and possibly constitutively. there is also a highly conserved acidic residue at the c-terminal limit of s <dig>  of the six residues that have been identified as relevant features in the current study, four are exactly two residues before or after one of these highly conserved acidic residues in the sequence. as illustrated in figure 4b, this spacing along an alpha helix places the variable residues that we have identified approximately on the opposite face of the helix from the charged residues that have a demonstrable role in setting v <dig> 

the variation of the six selected residues are mostly limited to nonpolar, hydrophobic residues including ile, leu, val, phe, and ala, although there are several incidences of polar residues and one charged residue, the his at position  <dig> of the data in all kv <dig>  channels) <cit>  . thus, it appears that the observed variations in these six residues are responsible for many of the small energetic differences between channels that are responsible for differences in v <dig> values; whether these energy differences involve intramolecular interactions between several helices of a single channel protein or interactions between the helices of the protein and the surrounding hydrophobic layer of the lipid bilayer is unknown.

many residues of vkcs that are responsible for voltage sensing and selective ion permeation are charged or polar amino acids, which generate relatively strong ionic interactions  <cit> . variation of residues involved in strong ionic and bonding interactions often lead to, if not inactive channels, drastic variation in function  <cit> . hydrophobic interactions among nonpolar residues or between nonpolar residues and lipids, on the other hand, are often energetically of lower magnitude and thus variations in these interactions will cause quantitatively small variations in functional parameters. these hydrophobic interactions can yield a practically continuous range of interaction energy magnitudes. small variations in these kinds of residues are less likely to cause functional disruption, but are more likely to play "secondary" roles in vkc functioning and help tuning and shaping the sensitivity of different functional properties. the nonpolar hydrophobic features of the predicted voltage modulating residues are consistent with a role in modulating the targeted functional feature, the voltage sensitivity of vkcs.

the extant models for voltage sensing all focus on the movement of the voltage sensing s <dig> transmembrane helix and how it may alter the conformation of the pore and the s <dig> and s <dig> helices to open and close the ion channel. in most cases, the consequent movements of other parts of the molecule are not explicitly addressed. the "paddle" model based on the structure of the kvap channel  <cit>  predicts that the c-terminal half of the s <dig> helix moves in concert with the s <dig> helix during gating. however, both of the informative residues in the s <dig> helix are in the n-terminal half of s <dig> and so would not be directly involved in the primary gating movement.

the results of the current study indicate that as the interactions of s <dig> with the other transmembrane helices change, the interactions of those helices with each other or the lipid bilayer, or both, are also changing. these changes in interaction are in turn responsible for the small incremental differences in the v <dig> value for the channel. this analysis neither confirms nor rejects any of the current models of voltage response. it does predict that that when these models are formulated more precisely, the energy differences between the open and closed states must take into account hydrophobic interaction energies.

one possible confounding effect in a comparative study is the possibility of evolutionary hitchhiking, the possibility that the residue identities are correlated with functional variation by virtue of having been independently fixed in an ancestral population at the same point as a voltage variation evolved. however, if that were the case, then it would be expected that evolutionary reconstruction of the individual features would not show multiple independent origins of specific residues. this is not the case for the features selected in this analysis. each of the six selected residue positions has evolved independently to specific residue identities .

in a recent study pairs of residues that co-vary during evolution and are presumably involved in the essential functions of vkcs, were computationally identified. most of these residues are located in the so-called core functional elements   <cit> , the pore region and the voltage sensor. our approach to structure/function analysis is aimed at identifying structural elements that modulate the voltage sensitivity, not those that are essential for voltage sensitivity. while s <dig> is considered the main voltage-sensing unit, s1–s <dig> is thought to play a modulating role in the voltage sensitivity of vkcs  <cit> . consistent with their modulating roles, all residues selected in our study are indeed located in s1–s <dig> region . it is not surprising that other residues in the s1–s <dig> region that were not selected in the present study have been shown to modulate the voltage sensitivity of vkcs  <cit> . most of these highly conserved residues appear to interact directly with the positively charged key residues in the voltage sensor  through charge interactions. these residues are highly conserved among vkcs and so do not co-vary significantly with v <dig> values in most channels.

CONCLUSIONS
machine learning methods have been widely used in biological analyses because of their capacity for dealing with data-rich tasks. using a dataset of  <dig> vkc sequences with their v <dig> values, we built a predictor that predicts the v <dig> value of a given vkc based on its amino acid sequence. despite the limited number of training data, and the uncertain quality, an mae of prediction of  <dig>  mv was obtained using a knn classifier combined with a wrapper for feature selection . the prediction accuracy was evaluated by a repeated  ten-fold cross validation. it is also validated by v <dig> prediction from independent experimental data . as more data become available from ongoing isolation and characterization of novel vkcs, better prediction is expected. during training, four possible outliers were singled out and removed from the training set to improve the learning performance . several residues with potential biological implications were identified for further study .

the analysis presented in this report demonstrates how machine learning methods can be productively applied to structure-functional study with datasets of limited size. these analyses can predict certain biological functions with a reasonable accuracy and can identify potentially functionally important residues for experimental testing of specific hypotheses of the structure/function relationship in a family of proteins.

