BACKGROUND
new human viral pathogens, such as the etiologic agent causing severe acute respiratory syndrome  and avian influenza, continue to emerge and have become major health problems worldwide. traditional viral detection techniques such as in vitro viral cultures, immunologic assays, and the pcr method  <cit>  can identify only one or just a few specific viral targets in a single test. when presented with patients having symptoms of unknown etiology, multiple diagnostic assays are often performed in parallel, which is a time-consuming and labor-intensive process.

oligonucleotide microarrays have been used for monitoring and analyzing viral pathogens  <cit> . there are currently two types of dna microarrays used for virus identification:  those based on using short oligonucleotide probes that are sensitive to single-base mismatches, which are used to detect or identify subtypes of known viruses; and  those based on using long oligonucleotide probes to uncover the identity of the virus present in a sample. for the former application, the entire set of probes on the microarray is designed to detect the mutations in the viral genome to allow one specific viral species and its subtypes to be discerned. an example of this application is the virus microarrays for discriminating different subtypes of influenza viruses  <cit> . for the latter application, long oligonucleotide probes  that tolerate sequence mismatches are used for broad detection specificity to a large number of viruses. this study focuses on the latter application: uncovering the identity of viruses present in a sample rather than detecting the mutations of a specific known virus.

previously reported studies  <cit>  have employed the tiling approach  to design microarray probes for uncovering the identities of viruses in a sample, using the blastn sequence alignment program to select the most similar sequences in the respective viral family of each sequenced viral genome. the unknown or unsequenced members of existing viral families can be detected by hybridization to the microarray elements with sequence similarity. conserved sequences were selected based only on the unidirectional relationship between one genome and the others in the same viral family. a substantial percentage of sequence redundancy exists among these family probes, and a family probe set usually contains a large number of redundant conserved probes. for virus identification, microarray data have been categorized into individual viral families and converted to a linear visualization scale   <cit>  or an alignment of the probe sequences giving hybridization signal intensities has been employed to determine the true identity of specific viruses  <cit> .

based on the experiences of identifying novel viruses, such as the sars coronavirus  or the nipah virus, a virus can exhibit considerable sequence identity with other viruses in the same genus  <cit> . although long probes possess a high hybridization efficiency, they often exhibit poor discrimination of specific viruses. therefore, significant cross-hybridization of a viral genome to the highly similar noncognate long probes is expected. thus, identifying viral species using the previously reported viral microarray probe design strategy requires additional intensive computation to analyze the complex hybridization patterns. a software program for implementing such a virus identification strategy has been developed  <cit> . the program determines the identity of specific virus in a test sample by comparing observed patterns of microarray hybridization intensities with a set of theoretical hybridization energy profiles as computed from the alignments of microarray oligonucleotides against all completely sequenced reference viral genomes available in the genbank database.

in order to design a virus microarray capable of identifying a larger number of viruses with high accuracy but with fewer probes than previously reported, we have developed a new method for designing probes for the precise and direct identification of viruses at the genus, species, and strain levels. our method narrows down the computation of conserved sequences to the genus level and eliminates sequence redundancy within a viral genus probe set by considering the mutual sequence similarity among all the viral genomes in the same genus. compared with the tiling approach, our approach greatly reduces the redundancy and number of conserved probes for a given viral genus. the method involves two separate sets of probes:  the conserved sequence probes for genus identification; and  specific probes for viral species or stain identification. the probe set for each genus contains a panel of 70-mer oligonucleotides that not only covers all the sequenced known viruses of the genus but also maximizes the likelihood of detecting emerging or unsequenced viruses. long 70-mer probes help to alleviate sequence-dependent hybridization variation, improve hybridization efficiency, and enhance the capability of identifying unknown viruses. to compensate for the poor discrimination capability of long probes, additional species- or subtype-specific probes were designed for each fully sequenced virus to enhance the specificity of virus identification. the identity of a virus is determined based on a simple arithmetic algorithm that calculates the average signal intensity of the multiple probes for a virus, in contrast to the intensive computation needed for pattern comparisons. the use of separate genus and species probe sets facilitates a cross-examination strategy to increase the identification accuracy. the identity of a virus is established by the concordant results for both the genus- and cognate-species-specific probes.

RESULTS
viral sequences for computation
more than  <dig>  full-length viral genomes covering  <dig> viral families and  <dig> genera were obtained from ~  <dig>  viral sequences archived in the genbank viral database . the genome segments of the viruses with segmented or multipartite genomes were treated as individual viral sequences. additional partially sequenced viral genomes were included for computing the conserved genus probes for genera with ≤  <dig> fully sequenced members and viruses with segmented or multipartite genomes, which made up a total number of  <dig>  viral genome sequences for the computation. viral genome sequences with more than  <dig> % similarity were treated as redundant, and only the longest sequences were retained; the resulting  <dig>  nonredundant viral genome sequences were used in the analysis.

algorithm for designing the conserved probe
the probe design strategy employs two separate probe sets: species-specific probes and conserved genus probes. genera with insufficient viral sequences for identifying conserved probe sequences are marked in the virus probe database and extra species-specific probes are designed for each viral species of each such genus. the species-specific probes were designed using the algorithm described by chang and peck  <cit> , and the conserved genus probes for each viral genus were designed according to the following guidelines:

 <dig>  a viral genus g = {vi| i =  <dig> ..., n} is a collection of n viruses, in which each virus vi  is associated with a subset of g, where subset g ≡ g-{vi}.

 <dig>  given a virus vi ∈g, the blastn result for the comparison of this virus with another virus in the same genus, vj ∈g, can be expressed as an indicator function iji:

iji={ <dig> x∈similarity sequence segments of vj and vi <dig> otherwise,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgjbqsdawgaawcbagaemoaaomaemyaakgabeaakmaabmaabagaemieaghacagloagaayzkaagaeyypa0zaaiqaaeaafaqaaegabaaabagaegymaejaeiilawiaemieagnaeyici4saee4camnaeeyaakmaeeyba0maeeyaakmaeeibawmaeeyyaemaeeocainaeeyaakmaeeidaqnaeeyeaknaeeiiaaiaee4camnaeeyzaumaeeycaenaeeydaunaeeyzaumaeeoba4maee4yammaeeyzaumaeeiiaaiaee4camnaeeyzaumaee4zacmaeeyba0maeeyzaumaeeoba4maeeidaqnaee4camnaeeiiaaiaee4ba8maeeozaymaeeiiaaiaemoday3aasbaasqaaiabdqgaqbqabagccqqggaaicqqghbqycqqgubgbcqqgkbazcqqggaaicqwg2bgddawgaawcbagaemyaakgabeaaaoqaaiabicdawiabcycasiabb+gavjabbsha0jabbigaojabbwgaljabbkhayjabbeha3jabbmgapjabbohazjabbwgalbaaaiaawuhaaiabcycasaaa@7efe@

where x is any sequence segment within the genome of vi, and the similarity sequence segment is any segment of virus vi having either  more than 75% local sequence similarity in a 50-bp window with any virus vj ∈g, as determined using the identity percentage calculation in the blastn program ; or  > <dig> consecutive bases pairing with vj  <cit> .

 <dig>  the sequence segments of virus vi similar to other viruses in g are then defined as the summation of all these indicator functions,si = ∑j≠i iji, which is a step contour function from  <dig> to n- <dig> 

 <dig>  the conserved sequences of vi are defined as the regions with the maximum number of similarity hits in si: ci = {x| si = max⁡x
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawfqaqaaigbc2gatjabcggahjabciha4bwcbagaemieaghabeaaaaa@3284@ )}.

 <dig>  the conserved sequence set of g is the union of all ci's: c' = ∪i=1nci
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawewbqaaiabdoeadnaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6gaubqdcqwiqisvaaaa@35c0@. to eliminate sequence redundancy, the longest sequence segment cl  in c' is selected first and aligned against the other sequences in it using the blastn program. any sequences in c'-{cl} having ≥ 80% similarity with cl are grouped together with cl to form c' <dig>  the first subgroup of c'. cl is then renamed as c to represent the first subgroup. the first subgroup,c' <dig>  is then excluded from c'. this procedure is repeated for the remaining sequence segments in c' until k such longest sequence segments {c,..., c and k subgroups {c' <dig> ..., c'k} are identified, with every sequence in c' assigned to one subgroup. the union of all the longest sequences, ∪i=1kc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawewbqaaiabdoeadnaabaaaleaadaqadaqaaiabdmgapbgaayjkaiaawmcaaaqabaaabagaemyaakmaeyypa0jaegymaedabagaem4aasganiablqiivbaaaa@3743@, represents the nonredundant conserved sequence set of g. a simplified illustration delineating the above procedures is provided in additional file  <dig> 

 <dig>  to prevent significant cross-hybridization to noncognate viral genus sequences, a 70-mer conserved probe set p = {pj| j =  <dig> ..., m is selected from each nonredundant sequence in ∪i=1kc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawewbqaaiabdoeadnaabaaaleaadaqadaqaaiabdmgapbgaayjkaiaawmcaaaqabaaabagaemyaakmaeyypa0jaegymaedabagaem4aasganiablqiivbaaaa@3743@ based on the following criteria:  gc content between 40% and 60%,  < <dig> continuous mononucleotide repeats,  <25-bp blastn sequence identity matches, and  ≤  <dig> consecutive bases pairing with other viral sequences in the noncognate viral genus. the probes exhibiting sequence overlap are further screened using the mfold program  <cit>  to pick the one that has the maximal gibbs free energy of the secondary structure, such that there is no sequence overlap among p.

 <dig>  to search for a subset of p with the minimum number of probes that can collectively yield similarity hits with all the virus members of g, each pj ∈p is aligned against vi ∈g using the blastn program. the blastn result between pj and vi can be expressed as an array,aj × i:

aj×i={hit, aji∈pj having>38−bp blastn identify matches to vino hit, otherwise.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgbbqqdawgaawcbagaemoaaomaey41aqraemyaakgabeaakiabg2da9maaceaabaqbaeaabiqaaaqaaiabbigaojabbmgapjabbsha0jabbycasiabbccagiabdggahnaabaaaleaacqwgqbgacqwgpbqaaeqaaogaeyici4saemicaa3aasbaasqaaiabdqgaqbqabagccqqggaaicqqgobaacqqghbqycqqg2bgdcqqgpbqacqqgubgbcqqgnbwzcqgh+agpcqaizawmcqai4aaocqghsislcqqgibgycqqgwbaccqqggaaicqqgcbgqcqqgmbatcqqgbbqqcqqgtbwucqqgubavcqqgobgtcqqggaaicqqgpbqacqqgkbazcqqglbqzcqqgubgbcqqg0badcqqgpbqacqqgmbgzcqqg5bqecqqggaaicqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaacqqglbqzcqqgzbwccqqggaaicqqg0badcqqgvbwbcqqggaaicqwg2bgddawgaawcbagaemyaakgabeaaaoqaaiabb6gaujabb+gavjabbccagiabbigaojabbmgapjabbsha0jabbycasiabbccagiabb+gavjabbsha0jabbigaojabbwgaljabbkhayjabbeha3jabbmgapjabbohazjabbwgalbaaaiaawuhaaiabc6cauaaa@8e6f@

thus, the 70-mer conserved probe set can be redefined as p = {pj| j =  <dig> ..., m}, pj ⊆g', and g' = {v'i| i =  <dig> ..., m, where v' i represents similarity hit with vi by pj ∈p. let card be the cardinality of probe pj  in array aj × i. we first search for a minimum coverage set ps*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaem4camhabagaeiokaocaaaaa@304d@ ⊆ p such that card = min card for all subsets of p  satisfying the following sequential criteria:  =g′
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaamaatafabagaemicaa3aasbaasqaaiabdqgaqbqabaaabagaeyiaiiiaemicaa3aasbaawqaaiabdqgaqbqabawccqghiiizcqwgqbaudaqhaaadbagaem4camhabagaeiokaocaaawcbeqdcqwiqisvaagccagloagaayzkaagaeyypa0jafm4rackbauaaaaa@3e02@ <cit> ,  max  if more than one set of ps*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaem4camhabagaeiokaocaaaaa@304d@ having card = min card, and  randomly pick one of those ps*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaem4camhabagaeiokaocaaaaa@304d@ with the same max  if more than one set of ps*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaem4camhabagaeiokaocaaaaa@304d@ satisfy condition . we then keep searching for other subsets of p-ps*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaem4camhabagaeiokaocaaaaa@304d@ with the same criteria until the probe set finally has a twofold coverage of g.

illustration of the conserved sequence design method
to demonstrate the conserved sequence design method, a simplified example of the procedure is shown in figure 1a. assuming that there are six  viruses in a viral genus , the similarity sequence segments for a given virus vi compared to the other five  viral genomes ) are designated iji  . these similarity segments are then ranked by the number of similarity hits with other viral genomes  and plotted along the vi genome. the highest-ranking ) similarity sequences should be the most-conserved sequences  for virus vi and the other five viral genomes .

the above procedures are repeated until a panel of conserved segments derived from all of the viral genomes in g is obtained. assuming that nine 70-mer candidate conserved probes  are selected by steps  <dig> and  <dig> in the probe design algorithm, table  <dig>  demonstrates how to search for the minimal number of 70-mer genus probes that give similarity hits with all six viral members  of g. each "×" in table  <dig>  indicates that pj has a similarity hit with vi. based on the similarity-hit array , at least two probes ) are required for the full detection of all the viruses in g. among the eight two-element probe sets , , , , , , , }) that can collectively yield similarity hits with all the virus members of g =g′
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaamaatafabagaemicaa3aasbaasqaaiabdqgaqbqabaaabagaeyiaiiiaemicaa3aasbaawqaaiabdqgaqbqabawccqghiiizcqwgqbaudaqhaaadbagaem4camhabagaeiokaocaaawcbeqdcqwiqisvaagccagloagaayzkaagaeyypa0jafm4rackbauaaaaa@3e02@), probe set  is the best selection since the two probes together maximize the similarity hits  with g and therefore increase the likelihood of detecting a virus. subsequently, probe set  is randomly selected for second-round coverage of g among the three probe sets , , and  because all of them produce the same eight similarity hits with all the virus members of g.

we subsequently used the coronavirus genus to test the procedure for finding similar viral sequence segments. the sars-cov genome  was aligned with the other  <dig> genomes g of the coronavirus genus using the blastn program . in the figure, each viral genome of the coronavirus genus is represented by a color-coded block, where the height of each pile of blocks along the sars-cov genome sequence represents the number of similarity hits  with the other  <dig> genomes of the same genus for that particular sequence location . the two viral segments showing the highest number of similarity hits with the other genomes  were extracted for microarray probe design.

in silico validation of the conserved sequence detection method
to validate the method in silico, the sars-cov genome was removed from the coronavirus genus and treated as a test genome. the remaining  <dig> coronavirus viral genomes were used as the calibration set for computing the conserved sequences by the aforementioned procedures. to obtain high similarity genus probes, we used a high stringency criterion for hybrid formation in the conserved sequence detection method: 38-bp blastn sequence identity matches or > <dig> consecutive base pairing nucleotides  <cit> . figure 3a shows the computed conserved sequence segment pool with redundancy ) in step  <dig> of the above probe design algorithm). these segments can be further sorted into five nonredundant groups by the blastn alignment program. the five longest sequences  in each of the groups represent the nonredundant conserved sequence set of the coronavirus genus without sars-cov. a blastn sequence alignment between the sars-cov genome and the five nonredundant conserved sequences shows that the longest conserved sequence in group  <dig> had 80%  sequence similarity with the sars-cov genome at nucleotide positions from  <dig> to  <dig>  but no significant similarity with any genome in the other viral genera .

to provide a more comprehensive in silico validation, we also performed leave-one-out cross-validation to the other viral members of the coronavirus genus and  <dig> other viral genera. in total,  <dig> viral genera and  <dig> nonredundant viral genome sequences were included in the large-scale cross-validation to verify the probe design algorithm . based on a recent report that blastn sequence identity matches as short as 25-bp are sufficient to form a dna hybrid  <cit> , a lower hybrid formation criterion  was used to determine whether a test viral genome can be detected by a set of conserved sequences computed from the calibration genome set for a given genus. in figure 3c, the column entitled "sequenced genomes" lists the number of viruses included for the computation in each genus, and the column entitled "detection by cross-validation" contains the number of viruses detected using the in silico method for each genus. the rightmost column is the positive detection rate for the in silico method for each genus. the computation results showed that most of the computed genus probes – especially for those genera having a larger number of sequenced viral genomes – displayed a good capability of detecting novel viruses, except for the genus of lentivirus, which yielded a worse prediction outcome. this result indicates that both the number of sequenced genomes and the extent of sequence conservation of viral members in a genus are useful factors for assessing the predictive power of the computed conserved sequences. nevertheless, the in silico cross-validation results produced an average successful detection rate of 92%, which demonstrates the feasibility of the probe design method.

experimental verification
to experimentally verify the probe design method, we constructed a test virus chip with  <dig> 70-mer oligonucleotides, which included genus probes covering  <dig> viral genera  and specific probes covering  <dig> species of viruses in the coronavirus  and flavivirus  genera . a blank control  and seven viral samples , all of which are pathogens found in nasopharyngeal swabs, were used for the experiments.

the identity test results for the seven test samples are shown in figure  <dig>  the virus genus and species identification methods are described in the methods section. in figure 4a, the z-axis represents the genus signal strengths of the three genus probe sets  hybridized to the seven test viral samples . the possible genus identity  of a test viral sample can be determined from the magnitude of the genus signal. figure 4b demonstrates the determination of the identity of a specific virus. the z-axis is the specific signal strengths of  <dig> virus probe sets  hybridized to the  <dig> test viral samples . the specific identity of the test virus can be read directly from the extent of the specific signal strength in the chart. verifying the results for the genus-specific  and cognate-species-specific  probes with virus taxonomy  results in the identities of all the test viruses being determined accurately and unambiguously. figure  <dig> also demonstrates the use of this method for detecting emerging and unsequenced viruses. we intentionally left out ev <dig> sequence information in the conserved probe design process and made no ev <dig> species-specific probes on the test chip. however, the hybridization of ev <dig> to the chip resulted in a high signal intensity for the enterovirus genus probes, which clearly indicated that the virus belonged to this genus . moreover, as shown by the hybridization result of the mixed viral sample ev71+sars-cov , the probe design method also allows two viruses of different genera to be accurately identified simultaneously. although jev cross-hybridized to three noncognate virus probes  that are of the same genus as flavivirus, the signal strength resulting from the specific hybridization of jev to its probe was 5-, 30-, and 33-fold higher than that of the probes for the three other viruses, respectively. therefore, the virus was correctly identified as jev. all the experiments were performed at least twice. in some cases, the signal intensity of the probes varied in different experiments for the same viral sample. however, our strategy for determining identities exhibits high signal-to-background ratios  and is both accurate and reproducible. taken together, these results demonstrate the high specificity of the virus chip design.

discussion
the two conserved sequence fragments are highly similar to all of the coronavirus viral genomes archived in genbank . this is not true in all cases: in general, most of the conserved sequences have significant similarity hits only with a fraction of the viral genomes in a genus. as demonstrated in table  <dig> , the design method selects a panel of conserved genus probes, each one similar to several  of the viral genomes of a genus. the use of the whole panel of probes covers all the viral genomes of a genus. to enhance the capability of detecting emerging or unsequenced viruses, we created multiple probes sufficient for twofold coverage of the entire virus members in a genus.

the robustness of the computed genus probes is determined mainly by two parameters:  the number of existing fully sequenced viral genomes in a genus, and  the degree of genome structure diversity for the viral members of the same genus. a larger number of available sequenced viral genomes in a genus makes it easier to identify the conserved sequences of the genus, and greatly enhances the probability of detecting unknown or unsequenced members of the genus. in addition, traditional virus taxonomy is not based on viral genome sequences. thus, in some cases, the viral genomes are highly divergent among the members of a genus, such that each computed genus probe is only similar to a small fraction of the genus members, or may even be unique. the genus of lentivirus is one example, for which a poor detection rate  based on in-silico cross-validation of the conserved genus sequences is shown in figure 3c.

the principle behind the conserved probe design is to search for high similarity sequences that could hybridize to all the virus members of a given genus but not to the viruses of other genera. therefore, accurate prediction of cross-hybridization is a prerequisite for the feasibility of the probe design method. in general, 70–80% global sequence similarity or a high local sequence similarity between two sequences could cause substantial cross-hybridization  <cit> . significant cross-hybridization was reported for a nontarget 70-mer probe that had a  25-bp blastn identity match  <cit> . to obtain as many reliable genus probes as possible, we used a 38-bp blastn sequence identity match criterion  <cit>  in the genus probe design. this criterion was chosen to take into account both the global and the local sequence similarities in hybrid formation. our experimental results show that the criterion reduces false-positive and -negative predictions of hybrid formation. additionally, the number of genus probes sufficient for twofold coverage of all virus members in a genus ensures high detection accuracy in cases where the hybrid formation criterion may not apply. the experimental results shown in figure  <dig> indicate that the hybrid formation criteria used in the genus probe design are sufficient to yield detectable genus probe signals to the target viruses but not to viruses of non-target genera.

the accurate detection of specific viruses by species-specific probes depends on avoiding nontarget cross-hybridization. nevertheless, cross-hybridization to strains of viruses with extremely similar genome sequences or by confounding mechanisms may be inevitable. for example, to investigate the jev cross-hybridization issue in figure 4b, we performed blastn alignments for the cross-hybridizing virus probe sequences with the sequence of jev, and found that none of the probe sequences had significant sequence similarity with jev. thus, the sequence complementarity guidelines do not explain why the jev viral sample cross-hybridized to the other three non-target probes – this might instead be attributable to non-watson-crick base pairing  <cit> .

in addition to the cross-hybridization issue, different probes for the same virus can yield very different signal intensities . this may be attributed to the combination of the sequence-dependent effects of dna hybridization  <cit>  and the failure of random-primed pcr amplification to amplify the target regions of the probes.

collectively, nucleic acid hybridization involves complex mechanisms that cannot yet be predicted purely by computation. cross-hybridization and sequence-dependent variation in hybridization efficiency may be unavoidable in hybridization reactions involving a large number of probes, such as in the microarray method, making it desirable to have multiple specific probes for each virus. viruses can be identified on the basis of the specific signal strength derived from the average signal intensity of multiple probes, since the cross-hybridization signals are always lower for the nontarget sequences than for the target sequences   <cit> .

there are, however, limitations to the virus microarray approach described here. an obvious one is that the range of viruses detectable by the method is limited by the content of viral genera archived in the database. therefore, if the emerging new virus belongs to a heretofore unknown genus, then none of the probes would reveal a detectable hybridization signal.

although our method ensures identification accuracy by verifying the results with the concordant taxonomical association of a genus and species, it is common for an assay sample to contain viruses of more than one genus or more than one species of viruses belonging to the same genus. as described in the methods section, the viral genus is assigned using a scoring method based on signal strength; that is, sum/max⁡g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawfqaqaaigbc2gatjabcggahjabciha4bwcbagaem4raceabeaaaaa@3222@). if more than one genus are present, there will be more than one non-zero sum values. one of the genera will be given 100% and the others will be given a percentage smaller than 100%. whether the signals are true genus signals or cross-hybridization signals can be verified by the presence of hybridization signals from the cognate species-specific probes. only concordant genus and species identification results are accepted for assigning virus identities, which is one of the advantages of having separate probe sets for genus and species identification.

moreover, the situation is more difficult than the above multigenus determination if more than one species belonging to the same genus are present,. accurate discrimination of true signals from cross-hybridization depends on setting the correct signal thresholds together with discretion based on epidemiology statistics. high threshold values for the signal strengths increase the virus identification accuracy. as shown in figure 4b, the cross-hybridization signals are several-fold lower than the true signal of jev. comparison with the results shown in figure 4b reveals that the mev, wnv, and liv signals are false not only based on the threshold setting but also from the epidemiology statistics that coinfection or coexistence of any of these viruses in one assay sample is highly unlikely.

in this study we gathered virus information from genbank which contains viral sequences of varying lengths, qualities and redundancy. it is noted that the viral sequences in genbank are not well moderated  <cit>  and taxonomic discrepancies exist among the curated viral databases available to the public, e.g., ncbi viral reference genome collection  <cit>  and the universal virus database of international committee on taxonomy of viruses   <cit> . this report describes an algorithm for identifying conserved genus sequences from a viral sequence database. the algorithm can be applied to any publicly available viral sequence database. however, for the purpose of computing conserved viral genus sequences, a large number of available sequences are needed and genbank provides the most comprehensive collection of viral sequences available to the public. the large volume of data in genbank fully satisfies the purpose of the present study: to develop a universal and comprehensive chip for identifying viruses, regardless of whether their genomes have been completely sequenced. the proposed approach of employing genus- and species-specific probe sets makes it possible to minimize the number of probes and cover all known viruses, including animal- and plant-infecting viruses, on a single chip.

CONCLUSIONS
most existing virus detection and identification methods are capable of identifying only a small number of known viruses in a single assay. parallel screening for a broad spectrum of uncharacterized viruses using microarray technology overcomes this limitation and also provides a means of discovering emerging new viruses. our probe design concept employs a panel of conserved sequence probes to directly classify emerging or unsequenced viruses at the genus level, and specific probes for known virus identification in a direct-readout manner. moreover, using the two types of probes to determine the identity of a virus in a complementary way further assures detection accuracy. the ability to detect a large variety of viruses using the virus microarray approach has great potential in facilitating the discovery of emerging viruses and diagnosing diseases of unknown etiology or patients infected with unknown or multiple simultaneous viral pathogens.

in summary, we have established a virus probe design method and virus identification process for viral classification and identification based on a microarray approach. our new probe design strategy and virus detection method allow direct reading of virus identity, and differ significantly from the probe design and virus detection methods described in the literature  <cit> . the concept and feasibility have been demonstrated using several example viruses. the methods and protocols can be applied to the analysis of large-scale virus microarray data to determine the identities of detected viruses by direct readout of a computer program.

finally, the genera and species-specific probes for more than  <dig>  viruses are archived in a database that is available on the internet . to our knowledge, this database is the most comprehensive virus probe database currently available to the public. the use of the new probe design algorithm, which does not involve tiling probes, reduces the number of probes on a virus microarray yet retains high identification accuracy. the new probe design method makes it feasible to construct a virus microarray with sufficient probes for identifying all the sequenced viruses that infect animals and plants.

