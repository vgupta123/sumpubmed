BACKGROUND
bioscientists routinely interact with biological sequence databases. often the interactions are with one of the several large national or international databases that provide web-based tools; for example, national center for biotechnology information   <cit> , embl nucleotide sequence database  <cit>  and dna data bank of japan  <cit> . to maintain data accuracy and integrity, well-defined procedures exist for submitting and changing entries in these databases. although these procedures ensure a reliable resource for scientists around the world, they present significant restrictions to researchers who want to maintain their own sequences of interest in a web-accessible database that can be searched and shared with other users.

we present the personal sequence database . the psd is a suite of tools that allows a user to create, maintain and share small- to medium-size sequence databases. all interactions between a user and the database are over the internet with a web browser. although at its core the psd stores dna and protein sequences, it also offers several data analysis tools, including clustalw  <cit>  and cap <dig>  <cit> , and the blastagent, a custom tool that monitors ncbi sequence databases for new entries with sequence similarity to a particular psd entry. sequences in the psd can be organized into groups that represent a user-defined level of association. the psd allows a user to run blast  <cit>  searches against the database sequences or against specific sequence groups within the database. sequence groups can be maintained privately or shared with public users. if a sequence group is shared publicly, anyone can run blast searches against the sequences within the group. the psd is maintained as a web-accessible public resource and is available, free of charge, to any educational user  <cit> .

implementation
user and database interfaces
the psd user interface is generated by perl  common gateway interface  scripts. the scripts utilize the html::template library   <cit>  to separate perl code from the html markup. the web services are delivered by an apache hypertext protocol daemon   <cit>  from a sun microsystems  v40z server running the red hat  linux operating system. the database tier is provided by the mysql  <cit>  database engine  from a separate, dedicated sun microsystems v40z running the red hat linux operating system. interactions between the scripts and the mysql database are facilitated by a private ethernet network and the perl dbi library   <cit> .

ncbi sequence databases
local versions of ncbi  <cit>  dna and protein databases are maintained by the center for genome research and biocomputing . once every  <dig> hours, custom perl scripts download newly submitted sequences from ncbi and merge them into the local copies of each database. dna and protein sequences submitted to ncbi within the last month are also maintained as separate databases. periodically, new versions of the full databases are downloaded and replace the local merged versions. when necessary, individual sequences are extracted from these databases using tools distributed in the ncbi toolbox  <cit> ; for example, fastacmd.

blast searches
all blast searches use local ncbi blast  <cit>  engines and local copies of ncbi sequence databases. blast searches are submitted to a local computer cluster and the results are parsed by custom perl scripts.

soap interface
the soap interface is facilitated by the soap::lite perl library   <cit> .

other software
the psd makes use of various other software packages. bioperl, version  <dig>   <cit> , is used to manipulate biological sequences. multiple sequence alignments are generated by clustalw, version  <dig> . <dig>  <cit> . cap <dig>  <cit>  is used to generate contigs from overlapping dna fragments. some metadata is compressed using the zlib library, version  <dig> . <dig>  <cit> .

RESULTS
although the psd encompasses several distinct programs, users mainly interact with a handful of perl cgi scripts  that access a mysql database. layers of abstraction render many of the underlying details invisible and users are presented with a consistent interface to perform database functions. we will describe the primary interface elements presented in a user's web browser.

psd registration
an online registration system is available from the main psd website . upon successful registration the psd is available for immediate use. during the registration, the user supplies a user name and password for login purposes. subsequent changes to registration information are facilitated by a user administration interface.

sequence data entry
the psd allows sequence entry either individually or in batch. after logging in to the psd, a user can enter a single sequence by following a link to "add a sequence." the raw sequence and associated metadata are entered in the appropriate areas of the page, see figure 1a, which include: sequence name, description and sequence type, and the primary sequence. as described below, other options include enrolling the sequence in the blastagent and identifying protein domains within the sequence. upon entering as much information as desired, the entry is saved and the data becomes part of the user's database. an additional method is available to add a batch of multiple sequences. by following a link to "add many sequences," the user is presented with a form to either upload a fasta  <cit>  file from their desktop computer or to copy and paste multiple sequences in fasta format in a supplied box form element. although not optimized for entering single sequences, the bulk form can also serve this purpose. in either case, sequence names and descriptions are extracted from the fasta formatted sequence. using either the single or bulk sequence entry forms, the sequences are available for immediate use once deposited into the psd. currently, public users are limited to  <dig> sequences of up to  <dig> residues each. these limitations may change in the future and can be negotiated by contacting the author. as described below, the limitations are designed to mitigate the computational demands of hosting the psd but still provide adequate functionality for the average user.

blast hit tracking system – blastagent
an especially useful feature of the psd is the ability to store results of blast searches. this process starts by initializing the blastagent for a specific sequence. the user has the option of choosing from several combinations of blast  <cit>  algorithm and ncbi  <cit>  sequence database, including: blastn, tblastn, tblastx of non-redundant dna; blastp or blastx of non-redundant protein; blastn or tblastn of gss or sts; and blastn, tblastn or tblastx of mouse, human or other est databases. all blast databases are maintained locally and updated nightly. after a blast search finishes, the results are viewable in a table format. this static list of blast hits remains available until the sequence is deleted from the user's database.

subsequent to blastagent initialization, it is possible to periodically re-run the blast search and identify new blast hits – ostensibly sequences added to the ncbi database since the last search. this process is either done manually, by pressing the "search for new hits" button, or automatically by choosing the "yes" option for the form menu element entitled "enroll in blastagent?". if the blastagent is activated, blast searches automatically run weekly. if new blast hits are identified the user will receive an email listing the sequences that have new hits. if no new blast hits are identified, the user will not receive an email message. currently the user has no ability to alter when or how often the automatic blastagent searches run, although this feature will be added in the future. however, a user has the option to re-run the blastagent search manually at any time.

blast results can be filtered using two methods. first, a blast expect value  limitation can be imposed. the e-value limit is always in effect, but the default value of 1e- <dig> can be modified by the user to allow either a higher or lower value. current e-value choices range from 1e- <dig> to  <dig>  filtering by e-value is particularly effective at limiting the number of blast hits for sequences with high representation within the ncbi databases; for example, 16s ribosomal rna genes. users can also filter blast hits by ncbi entrez terms. the psd can use any valid entrez term to filter blast hits. filtering by entrez query is especially effective at targeting a specific set of sequences; for example, sequences from a particular organism. the entrez vocabulary is available from the ncbi website  <cit>  or from links within the psd.

blast hit sequence manipulation
if a blast search identifies hits for a psd sequence, several options are available to manipulate the hit sequences. when viewing the blast results, links are provided to the specific entry at ncbi and to display the blast alignment of the query sequence and the database hit sequence. additional analysis options are available depending on the type of blast database searched. for example, if the hits are from a protein database, specific hits can be selected and subjected to a clustalw multiple sequence alignment. if the hits are from a dna database they can be subjected to either a clustalw or cap <dig> multiple sequence alignment algorithm. all database hits are available for direct download in fasta format irrespective of sequence type. blast, clustalw and cap <dig> alignments can be saved as metadata associated to the psd sequence used as the query in the blast search .

psd sequence domain identification
any psd sequence can be subjected to protein domain identification. domain identification is facilitated by a blast search of local copy of the ncbi conserved domain database   <cit> . a blastp or blastx search is used depending on whether the psd sequence is a protein or dna sequence, respectively. results of the cdd blast search are saved both as text and as a graphical representation of the domain hits relative to the query sequence, see figure 1b. links to the ncbi web page for each domain are provided in the text output. the results of a domain search remain associated with the psd sequence entry until the domain search is deleted or the psd sequence entry is removed from the database.

psd sequence notes
metadata, referred to as "sequence notes", can be associated and saved with any psd sequence entry, see figure 1c. these metadata can be hand-entered text, a blast alignment, or a multiple sequence alignment generated by clustalw or cap <dig> . when a sequence alignment is generated within the psd, it is presented as a web page that can be permanently associated with the psd sequence entry. if saved, the graphical nature of the alignments as well as the text output are faithfully stored until they are manually deleted or the psd sequence entry is removed from the database. additionally, an interface is provided to manage the notes; for example, changing a note title or deleting batches of notes.

psd sequence groups
often it is useful to collect sequences related to each other by some characteristic. the psd facilitates this process through the creation of sequence groups. any psd user can create an unlimited number of sequence groups. individual sequences are submitted to a group using checkboxes and a pull-down menu to select the desired group. if the sequences are added in bulk , the user can select a group to which the sequences will be added upon submission of the form. an interface is available to add or delete sequences from a group or to change the group membership of sequences from one group to another. additionally, group characteristics can be changed using the sequence group administration  page. sequence groups are a powerful way to organize sequences for further analysis; for example, blast searches or sequence sharing .

blast searches of psd databases
any user can search their psd using blast. if a user has created sequence groups, these can be searched independently from the other sequences in the database. all of the blast algorithms are available from a pull-down menu on the blast interface. before the blast search occurs, the psd collects the sequences appropriate for the blast algorithm; for example, dna sequences for a blastn search or protein sequences for a blastp search. the collected sequences are converted to a blast database, the blast search runs on a psd server and the data are delivered to the user's browser. multiple query sequences can be submitted at once – the blast output is concatenated. each blast search is accompanied by a graphical representation of the blast hits relative to the query sequence. users can easily move between blast results and psd sequence entries using links back to the psd in the blast results.

sharing psd sequence groups
using the sga page , any psd sequence group can be made publicly available, which is described as "published" within the psd. all data associated with published psd sequences are available for browsing by public users, including: the sequence, sequence notes, protein domain information and blast hits, if available. however, public users cannot alter any characteristic of the sequence or associated metadata. the published sequence groups are available through a common interface specialized for this purpose. a link to the public interface, which can be distributed to collaborators or displayed on a web page, is provided on the sga page when the group is published. the sga page allows a user to provide optional text that will be rendered in html on the public interface. this optional text can be used to provide links to other resources the user feels is appropriate or valuable for the specific sequences contained within the group. any public sequence group can easily be made private again using the sga page.

in addition to the shared sequences and associated metadata, public psd sequence groups are available for blast searches by public users. a link to the public blast search page is provided on the public interface. when public users follow this link, they are presented with a simple blast form that can be submitted with a query sequence in fasta format. the blast results contain links back to the sequences in the published sequence group of the psd. using the sga page, a user can supply a template for links to an external resource; for example, an external database containing more extensive information about sequences within the group. these external links will be displayed for every hit in the blast report. external links require a specialized syntax, which is explained on the sga page.

each public sequence group has its own home web page. thus, users can maintain multiple independent public sequence groups, each available as a distinct shareable and/or public resource. as mentioned above, there is no limit to the number of sequence groups that can be created by a single user.

simple object access protocol  interface
a soap interface to public sequences  is available for users interested in writing custom software to interact remotely with the psd. full psd functionality has not been included in the soap interface, but this is a future goal. for detailed information about using the soap interface, users are directed to the psd information website  <cit> .

computational requirements and considerations
from the perspective of providing a public resource such as the psd, an obvious concern is the potential computational requirements needed. although still a concern, several mechanisms have been devised to minimize the computational load. there are two main components to the computational load: storage space and server central processing unit  usage. multiple strategies reduce the storage space requirements for the mysql tables storing the psd data. the most obvious strategy, as described above, is to limit the number and length of sequences a user can store in a particular psd. these limitations are first approximations and may be altered in the future as space requirements are re-evaluated. another strategy is to not store blast alignments in the database. the necessary information to recreate a particular blast alignment on the fly using bl2seq  is stored in the psd, alleviating storage of the actual alignment text. finally, when a user stores metadata, which is often a web page, the data are subjected to a zlib compression algorithm  <cit>  to minimize their size within the database.

currently, the psd contains  <dig>  sequence entries with a length of less than  <dig> residues. given the above sequence constraints, this represents approximately  <dig> users if each user stored the maximum of  <dig> sequences. to store these sequences, the database engine requires approximately 84mb of disk space. about 1% of these sequences are enrolled in blast searches, which increases storage requirements by about  <dig> mb. given these parameters, we estimate that psd usage could increase 4000-fold and still be rather inexpensive to manage at current hard drive prices. it is expected that the cost per byte of disk space will continue to drop, increasing the manageable number of potential psd users.

as mentioned above, another concern is cpu usage. three aspects of the psd affect processor load: the apache web delivery engine  <cit> , the mysql database engine, and the blast searches. the most fundamental strategy to manage these loads is to distribute the services to distinct machines specialized for their purpose. demands on the psd web server are manageable and are less of a concern than the mysql and blast cpu requirements. currently the mysql database is hosted by a single four-processor machine with 4gb of ram. it is likely that this will be the weak link within the psd architecture. imposing the above limits on an individual user's psd will help to manage mysql load, but depending on its popularity the psd could easily outgrow the current mysql machine. if necessary, multiple mysql servers could be incorporated into the architecture to provide parallel and redundant database servers. as database load gradually increases over time, additional database servers can be added. several strategies are used to manage the computational demands imposed by the blast searches. the psd runs three types of blast searches. when a user initializes a blastagent an initial blast search runs against a full ncbi database; i.e., nt or nr. these blast searches are quite demanding and usually last for several minutes. alternatively, when identifying new hits, blast searches most often run against databases that contain only those sequences deposited into ncbi within the last month. therefore, these are smaller databases and the blast searches are much less demanding, usually lasting only several seconds. the majority of blast searches are of the latter type, which minimizes the computational demands. blast searches can also be run against a user's database. due to the size limitation imposed on individual psd databases, these blast searches are quite fast and do not require significant cpu time. in addition to the above measures, a custom-designed daemon process running on a psd server manages jobs to limit the number running at any given time, which mitigates the computational demand. finally, no method exists to bulk-submit sequences to the blastagent system. although seemingly a drawback, this design is intentional and requires a user to decide which sequences are most important for blast searches and minimizes inefficiencies associated with running blast searches with many highly similar psd entries.

the psd is currently supported by the cgrb at oregon state university. the cgrb maintains an extensive computational infrastructure, including a computer cluster that the psd leverages to run blast searches and multiple sequence alignments. several nodes within the cluster are dedicated to the psd and additional nodes can be added when necessary. we estimate that the number of blast searches could increase 100-fold and still remain manageable. the psd represents an important public resource and the cgrb is committed to supporting it into the foreseeable future.

CONCLUSIONS
the personal sequence database is an integrated suite of tools that allows users to create and maintain small- to medium-sized biological sequence databases. multiple requisite database functions exist, including: sequence uploading and downloading, database searching by keyword and blast sequence similarity searching. the psd provides several sequence analysis functions, including protein domain identification and multiple sequence alignments. the psd also offers blastagent, a powerful resource that provides an automated system for tracking new blast hits appearing in ncbi databases. although some shared functionality exists with other software  <cit> , the psd represents a unique set of resources that is unavailable from any other single location.

a user can organize database entries into sequence groups, ostensibly representing some shared relationship. sequence groups behave as individual units within the larger database. each sequence group can be maintained privately or publicly. public sequence groups, also referred to as "published" groups within the psd, are available to any user as a read-only resource. as such, a published group represents an individual web-accessible sequence database that can be distributed to colleagues  or maintained as a long-term public entity. therefore, any single user can maintain multiple sequence groups, each of which can be either private or published. an interesting use of these capabilities is to incorporate psd sequence groups into other web resources. for example, the marine microbial genomics  website  <cit>  uses psd sequence groups to allow visitors to run blast searches against the genomes of dozens of newly sequenced bacterial genome sequences. although the mmg website is maintained in association with the authors, anyone could mimic this method on their own sites with no involvement of the author. therefore, the psd can provide computationally-intensive resources to researchers within less well-developed computational infrastructures.

it is common for a geographically distributed group of researchers to collaborate on large projects. often these projects revolve around accumulating dna sequences, either for genome assembly, gene discovery or expression analysis. for these types of projects, the psd can facilitate research and data sharing between groups by serving as a central resource to which all groups can refer for sequence data. although in its current version the psd does not allow multiple users to have read/write access to individual databases, future versions will include this capability. interested parties can contact the authors for more information about this functionality.

finally, there are several areas of additional functionality scheduled for future psd releases. these include more extensive search capabilities, an advanced blast interface, more configuration options , downloadable blast results, automatic determination of gene ontology  <cit>  terms associated with user-specified entries and a more extensive collection of sequence analysis tools, including pfam searches  <cit>  and basic phylogeny tools. these improvements will appear gradually as development proceeds. interested parties should refer to the psd information web page for future announcements.

availability and requirements
project name: the personal sequence database

project home page: 

operating system: platform independent

programming language: perl, sql, javascript

other requirements: online registration – 

license: gnu general public license

any restrictions to use by non-academics: contact corresponding author

authors' contributions
sag conceived project and contributed all perl and javascript code and designed complete database schema, and provided test-case scenarios. cmm designed, tested and optimized all computational and network hardware and provided test-case scenarios. jcc contributed to infrastructure development and provided test-case scenarios. all authors reviewed and approved manuscript.

