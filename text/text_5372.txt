BACKGROUND
mass spectrometry
mass spectrometry  is a common analytical technique used to identify unknown compounds, quantify known materials, and elucidate the molecular structure and chemical composition of organic and inorganic substances. a mass spectrometer is an instrument used to measure the mass-to-charge ratio of individual molecules that have been converted into electrically charged molecules, or ions  <cit> . these ions are filtered and ordered from a lower to higher mass-to-charge ratio  before passing through an ion detector in the instrument  <cit> . in the field of proteomic analysis, matrix assisted laser desorption ionisation  and electrospray ionization  are two ionisation techniques generally used. mass spectrometry is currently experiencing rapid growth in mass-spectrometry-based biomarker discovery and clinical proteomics, where hundreds of proteins can be sequenced quickly. as a consequence, large amounts of proteomics data are produced and made available to the public  <cit> .

although the generation of raw ms spectra has become easier, the analysis and identification of the data still post many challenges. many protein identification tools have been developed, such as peaks  <cit>  mascot  <cit> , phenyx  <cit> , sequest  <cit>  and omssa  <cit> . in the case of high throughput proteomics, it involves the analysis of hundreds of thousands of peptide spectra derived from biological samples. four general types of algorithms can identify these spectra,

 <dig>  de novo calling of the sequence directly from the spectrum  <cit> .

 <dig>  use of unambiguous "peptide sequence tags" derived from spectra that are used to search known sequences  <cit> .

 <dig>  cross-correlation methods that correlate experimental spectra with theoretical spectra  <cit> .

 <dig>  probability-based matching that calculates a score based on the statistical significance of a match between an observed peptide fragment and those calculated from a sequence search library  <cit> .

cross-correlation methods and probability-based matching are two well-received methods for protein identification. in these methods, a theoretical mass spectra database is first generated from known protein sequences. to search this database with experimental spectra, the correlation of the experimental and theoretical spectra is calculated. based on the statistical properties of the protein database and the correlation values , a score is given for the matched spectra.

most of these tools have attained a certain degree of success thus far; nevertheless reliable protein identification using these methods is still a time-consuming and program-dependent task. a considerable frequency of false positive protein identifications has been reported from independent studies  <cit> . knowing that the quality of mass spectra is crucial in protein identification, several attempts to address the issue have been made using some information obtained from mass spectra generated by fragmented peptides  <cit> . in particular, purvine et al  <cit>  used a prefilter with three features for tandem ms spectra classification; one feature addressed the uncertainty in charge state assignments, the second was based on total signal intensity and the third on a signal-to-noise estimate. they obtained good results by adjusting these features. although these approaches have been useful, we introduce an additional prefilter feature based on the symmetry property of the b- and y-ions, to compliment and improve the pre-filter process.

convolution
convolution is a mathematical operation commonly used in digital signal processing . for discrete time series, the convolution is given as:

 hi=∑j=0mfigi−j
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobaadawgaawcbagaemyaakgabeaakiabg2da9maaqahabagaemozay2aasbaasqaaiabdmgapbqabagccqwgnbwzdawgaawcbagaemyaakmaeyoei0iaemoaaogabeaaaeaacqwgqbgacqgh9aqpcqaiwaamaeaacqwgtbqba0gaeyyeiuoaaaa@3f95@ 

where fj and gj are two time series data sets. self-convolution refers to convolution applied onto the same data series, where gi-j is the time-reversal copy of the data series fj.

self-convolution has been used in many applications, where symmetry property is key feature of the signal, such as those found in the field of digital communication  <cit>  and image processing  <cit> . we will show in this work that ms do have such property inherited naturally from the fragmentation process, and hence the same approach can be used to extract information from the spectra. the success of this method depends on the availability of the complementary b- and y-ions, which are the two types of most commonly found ions in the conventional tandem mass spectrometry.

peptide fragmentation
peptide fragmentation is a process where peptide fragment ions are generated by dissociation in an ion trap of a mass spectrometer. in this process, the breakage can occur between any bonds in the peptide, but commonly occurs at the peptide bond. when a peptide is fragmented at a single peptide bond between the carbonyl and nitrogen, two fragments are formed. in the case where one peptide fragment retains the positive charge at the c-terminus of the peptide ion, it is called a y-ion. if the fragment retains the positive charge at the n-terminus, it is known as a b-ion. when a singly charged peptide is fragmented, the charge is retained only at one terminus and only the fragment containing the charge is detected while the other fragment is lost as a neutral fragment. doubly charged peptides tend to produce two singly charged ions, though sometimes doubly charged ions can also be formed.

the types of fragment ions observed in an tandem ms spectrum depend on many factors, including primary peptide sequence, amount of internal energy and how the energy was introduced, charge state, etc. the accepted nomenclature for fragment ions was first proposed by roepstorff and fohlman  <cit> , and subsequently modified by johnson et al  <cit>  and biemann  <cit> . there are different dissociation methods available, including commonly used gas phase collision-induced dissociation   <cit> , surface-induced dissociation  <cit> , photodissociation  <cit> , electron-capture dissociation  <cit> , and electron transfer dissociation  <cit> . the b-ions and y-ions are usually formed when fragmentation occurs under low energy conditions. fig.  <dig> shows all possible breakage points along a peptide bond.

other ions like a-ions and x-ions, which form a complementary pair, and c-ions and z-ions, which form another complementary pair, are also formed. the a-ions and x-ions are formed when the peptide fragments between the amino acid side chain and the carbonyl molecule. the c-ions and z-ions are formed when the peptide fragments between the nitrogen and the amino acid side chain molecule. these ions are formed when fragmentation occurs high-energy conditions since higher amounts of energy are required to break these bonds. fig.  <dig> shows a typical tandem ms spectrum.

the development of chemical theory of peptide fragmentation  <cit>  has enabled the de novo prediction of fragmentation spectra from peptide sequences. using a kinetic model, zhang made the first successful attempt at predicting the low-energy cid spectra of singly and doubly charged peptides  <cit> . elias et al.  <cit>  were first to successfully utilize a set of well-annotated fragmentation spectra acquired from an electrospray ion-trap mass spectrometer in an attempt to infer the probabilistic rules of fragmentation. more recently, randy et al. used machine-learning algorithm to predict various fragment-ion types of doubly and triply charged precursor ions by learning peptide fragmentation rules in mass spectrometry in the form of posterior probabilities  <cit> . yu et al. proposed a novel method to automatically learn the factors influencing fragmentation from a training set of tandem ms spectra  <cit> . despite the availability of the various prediction models, it is unclear how these models could be used for predicting fragment ions in different types of mass spectrometry machines.

RESULTS
to validate the proposed method of tandem ms spectra assessment, we conducted series of tests on theoretical ms spectra as well as experimental ms spectra. the results of the tests on theoretical ms spectra are tabulated in table  <dig>  we then used another  <dig> sets experimental tandem ms spectra to tests its effectiveness and robustness.

in our work, we tested the qualitative measurement of the tandem mass spectra based on different noise intensities , additional spurious peaks , different b-ion intensities , different y-ion intensities , different percentage loss of b-ion , and different percentage loss of y-ion . we observed the drop in score as the quality of the theoretical mass spectrum deteriorates.

quantitative measurement of theoretical tandem ms spectra
we first compute the quality score  on theoretical ms spectra based on our derivation shown in eq.  <dig>  the protein sequence  was chosen arbitrary to form the theoretical spectra for our work. the theoretical spectra are subjected to different degradation processes, including introduction of white gaussian noise, reduction in ion peak intensities, removal of ion peaks, as describe in the method section. the test results are tabulated in table  <dig> 

in the first test, we included all the theoretical b and y-ions peaks in the spectrum, with white gaussian noise  of different amplitudes added. the scores are captured in section a of table  <dig>  we observed that the qs scores remain stable for noise amplitudes between  <dig> and 10% of the peak intensity.

in the second test, we added in random peaks of equal amplitude to the b and y-ions in addition to the white gaussian noise. the random peaks could represent spurious ion peaks intended to degrade the quality of the spectrum. we observed that with  <dig> and  <dig> random peaks added, the scores are not much affected, with qs equal to  <dig>  and  <dig>  respectively. this shows that the scores are not much affected by the random peaks, as long as the b and y-ions are intact.

in the next two test scenarios, we reduced the intensity of b and y-ions to simulate the lack of fragmented b and y-ions in the spectrum. as b-ions reduce in intensity, the qs drops from  <dig>  to  <dig>  at 10% to 70% reduction of the b-ion intensity, as shown in section c in table  <dig>  the reduction of y-ion intensity shows similar effect on the qs score, it drops from  <dig>  to  <dig>  at 10% to 70% reduction in intensity, as shown in section e in table  <dig>  the results are shown in fig.  <dig>  as the intensity is reduced further, there is no longer any peak detected at the mid-point window of the self-convolution result.

lastly, we removed randomly some of the b or y-ion peaks to simulate loss of certain ion fragments. the number of ions removed varies from  <dig> to  <dig> and we observed that the qs drop from  <dig>  to  <dig>  and from  <dig>  to  <dig>  for b-ion and y-ion loss respectively, as shown in section e and section f of table  <dig>  as the number of ion peak is further reduced, the mid-point peak is no longer detectable. these tests show the relation between the qualities of the spectrum to the qs that we established to assess the quality of the ms.

qualitative measurement of experimental tandem ms spectra
we started the quality assessment by simply performing a self-convolution on some of the experimental ms spectra. fig.  <dig> shows a plot of the result of self-convolution of one of the raw tandem ms spectra. although the plot does show a high peak at the mid-point window of the result, we found out that the product of two high intensity peaks happened incidentally to be at the mid-point. this could cause misinterpretation and therefore erroneous for us to consider this result as an indication of good quality spectrum. we have thus further improved on the approach by considering side peaks and normalisation process.

the proposed method was subsequently tested on  <dig> sets of real tandem ms spectra . they were subjected to the qs scoring function described in the eq.  <dig>  we considered  <dig> highest intensity peaks to the left and right of the mid-point window of each spectrum. the self-convolution result is shown in fig.  <dig>  the dc shifted self-convolution plots of the original tandem ms spectrum is contrasted with that of the newly generated plot, as shown in fig.  <dig>  we have also assumed that  <dig> peaks are sufficient in our calculation, but this number can be increased in the case where more ion fragments are expected. all tandem mass spectra having high scores have been identified successfully using mascot  <cit>  with high confidence .

discussion
the fragmentation of peptide sequence using conventional mass spectrometer produces spectra consists mostly of b and y-ion peaks. the quality of the mass spectra depends therefore mainly on the presence of the b- and the y-ions in the spectra. current state-of-the-art database search tools depend heavily on these ion peaks and the lack of such peaks would lead to no protein match, or in the worst case, the erroneous matching of proteins in the database. some database search algorithms allow inclusion of a- and/or z-ions; such inclusion makes the search more complex and computationally intensive, hence significantly slows down the protein identification process.

we proposed a novel method where the quality of the mass spectrum is determined from self-convolution of the mass spectra. this approach complements existing methods in selecting good quality tandem ms spectra to be processed by database search and/or de novo sequencing. this method is unique, as it does not depend on the charge of the fragmented ion, nor its length. random peaks such as those produced by machine noise or contaminants , irregardless of its intensity will not affect the process, as it requires a complementary pair to work.

knowing that the presence of a fair amount of complementary b- and y-ions constitute to good quality mass spectrum, we can be assured that by selecting spectra with high qs values, only good quality tandem ms are pre-filtered to be processed for protein identification.

we note that tandem ms spectra having non-complementary b and y-ions might score poorly using this approach. examples of such spectra are those having large number of y-ions but only very few complementary b-ions, and vice versa.

CONCLUSIONS
we conclude that the new approach is effective and useful in assessing the quality of tandem mass spectrum by analysing the self-convolution result of the spectra. this method relies mainly on the symmetry property inherited from the formation of complementary b and y-ions found in the tandem ms spectra. the proposed assessment scheme can be used to complement existing pre-filter/assessment processes to ensure that only good quality spectra are sent for protein identification process, reducing false positive protein detection by database search and de novo sequencing protein identification tools. this method can be further improved by taking into consideration of other complementary ions, such as a-ions and x-ions.

