BACKGROUND
the study of the conformational space explored by a protein has long been of interest to structural biologists. the small region of this conformational space in which a protein is biologically active is known as its native state. the native state generally has the lowest free energy of all states under the native conditions  <cit> , and the physical mechanism by which a protein finds it is known as the folding pathway. the vastness of the search space for a folding protein was first appreciated by levinthal  <cit>  who conceived the paradox of a long and non-biological time scale needed for a folding mechanism based on random pathways  <cit> . the solution of the protein folding problem requires an accurate potential that describes the interactions among different amino acid residues to enable the prediction and assessment of protein structures  <cit> . however, the use of such physical-based potentials  <cit>  is computationally prohibitive and often it cannot ensure the native and biologically active conformation. therefore, an alternative approach to the full atomistic description was to construct a scoring function whose global minimum corresponded to the native structure  <cit> . this scoring function is obtained by analysing the set of known native high-resolution structures deposited in the protein data bank   <cit>  and it is termed as knowledge-based or statistical potential.

state-of the art methods are often able to predict the three-dimensional  structure of protein domains with a rmsd  from native conformation ranging between 1Å and 6Å, where models with rmsd smaller than 2Å imply a resolution comparable to many experimentally obtained structures <cit> . among these methods, fold recognition and comparative modeling belong to the category of template-based modelling while de novo methods do not rely on any similarity on the fold level to known 3d structures   <cit> . state of the art of structure prediction procedures  are able to assemble approximately correct structures when a weakly homologous structure is available in the pdb  <cit> . however, the main problem displayed by most methods is the impossibility to distinguish a correct  model from a plethora of generated solutions. selecting the closest model to the native conformation of a given protein out of an ensemble of models  <cit>  is thus the crucial step for the protein structure prediction  <cit> .

there are some common problems shared between template-based de novo prediction methods related to the selection of templates, detection of errors, and refinement of structures. for instance, one needs an energy function whose global minimum is in the protein's native state and which energy surface is funnel-like to drive the structure toward native-like conformations . these conditions have led many authors to use specialized scoring functions  <cit>  and to combine knowledge-based force-fields and physical force fields with different objectives: 1) assessment of the correct fold  <cit> ; 2) detection of local errors after modelling  <cit> ; 3) studying the stability of mutant proteins  <cit> ; discriminating between native and near-native states  <cit> ; and 4) selecting near-native conformations in a set of decoys without the native structure  <cit> .

on the one hand, statistical potentials have been derived for structural features such as torsion angles  <cit>  and solvent accessibility  <cit> . in addition, residue-residue and all-atom based statistical potentials can be categorized into distance-independent contact energies  <cit>  and distance-dependent potentials  <cit> . furthermore, statistical potentials for the all-atom representation are generally more accurate than those that represent the interaction with centroids of amino-acid residues  <cit> . a vast amount of statistical potentials have been described and tested . many works have focused on the combination of knowledge-based potentials using artificial intelligence  regression <cit> ) and some have included physics-based energy functions with atomic detailed description of the interactions <cit> , like hydrophobic <cit> , hydrogen bonding, electrostatic, van der waals, backbone torsions and binding harmonic terms . these approaches have prompted the problem lying on the physics of knowledge-based potentials: 1) what is the origin of the boltzmann-like distribution for structural features in a sample of native structures  <cit> ; 2) what is the most appropriate reference state  <cit> ?; 3) is it possible the addition of individual terms of a statistical potential  <cit> ?; 4) what is the offset between statistical potential and other energetic terms to define a scoring function that predicts protein structure  <cit> ?; and 5) what's the connection between statistic potentials and the energy-landscape of the free energy of a protein?. on the first two questions, the origin of the boltzmann-like contribution and the definition of the reference state are still controversial. on the third and last question, simons et al. presented a detailed derivation of scoring functions with particular attention to the interplay between solvation and residue pair interactions to split the terms involved in the statistical potential <cit> . they provided a recipe for combining environment and residue pair specific effects in a systematic and non-redundant manner in rosetta <cit> . although the addition of the components of the energy cannot be transformed in the addition of free energy terms  <cit> , it is still possible to split in different features the knowledge-based potential and to include additional terms on the core of a scoring function  <cit> . this permitted the evaluation of effectiveness in recognizing native-like structures among large decoy sets using different descriptions of sequence-dependent and sequence-independent features of proteins   <cit> .

in this work we demonstrate the decomposition of knowledge-based potentials in energy terms with different levels of detail of residue-residue interactions. the new potential is based on the sum of terms that describe sequence-dependent/independent and distance-dependent/independent features of proteins that show biological and functional significance . our approach also circumvents the problem of a reference state of the statistical potential by means of a spare function without relevance on the assessment of native conformation. finally, we compare our composite scoring function to other knowledge-based functions on: i) characterizing the relevance of the potential terms involved in native and near-native conformations; ii) finding the native conformation of several target proteins among decoy structures; iii) detecting near-native conformations; and iv) identifying local conformational errors.

outline of the algorithm
our goal is to develop a new scoring potential independent of a reference state, able to discriminate between native and non-native conformations of proteins and able to detect local errors of a protein structure. this was obtained by: i) decomposing the score function in terms where some of them were functions of the reference state; ii) transforming the score into a sum of zscores where the zscore of the functions containing the reference state could be neglected; and iii) proving that the zscore definition could still be applied to score the accommodation of individual residues in the structure. here we present an outline of the algorithm. details of the development of the equations are in the additional files .

the interaction between two residues can be described by means of a potential of mean force <cit> . energy can usually be split in independent terms from which different forces are derived. therefore, we also wish to split the statistical potential in terms that would describe the different parts of the interaction. the disconnection of energetic terms can be used not only to recognize the main interactions, but also to improve its individual expectation-values compared with a random approach. our approach is similar to the scoring method in rosetta by simons et al.  <cit> , where local and structural environment play an important role with the sequence.

a potential of mean force has usually been used to score the interaction between two residues. the distance between a pair of residues can be calculated as the minimum distance between all atoms of both residues or as the distance between the cβ atoms . the maximum distance to calculate the potential of mean force is different depending on this definition . force fields obtained with cβ-cβ distances are named cβ-cβ force-fields or cβ-potentials, while those obtained with minimum distances are named min force-fields or min-potentials.

we have defined a new set of knowledge-based potential terms converting the reference state function into a new energy component. the new score is defined in equation  <dig> and derived by comparison with the standard definition of knowledge-based potential    

where n is the total length of the sequence. equation  <dig> cannot be applied straightforward to discriminate between correct and incorrect conformations because the magnitudes of each single term are very different: this is, the average value of some energy-terms  have values around the standard deviation of others . consequently, we have defined a zscore, named ze . zscores are obtained for each energy-term using a random distribution of residue-residue interactions per fold with the formulae: zscore = /σ, where "energy" is the energy-term calculated with the interactions of original sequence, μ is the average of this energy calculated with real and random interactions and σ its standard deviation. random interactions between amino-acids are obtained by reshuffling the sequence of the protein. a total of  <dig> random sequences are used to calculate the zscore. the zscore of an energy-term is identified with a z prefix . hence, we calculate zeref, ze3d, elocal, zes3dc and ze3dc. ze3d is null because e3d is a constant value that depends only on the fold conformation. also, the parameterization of eref should not have any compensatory effect to discriminate between correct and incorrect folds. therefore, we hypothesize that eref should have similar distribution for real and random sequences and consequently zeref should fluctuate around  <dig>  this also implies that the reference state function introduced in equation  <dig> by two energy terms, e3d and eref, can be neglected by the use of zscores .

we reformulate the zscore in equation  <dig> with a linear combination and we define ze by neglecting the term zeref and omitting the optimization of parameters .   

to distinguish between terms calculated with statistical potentials obtained using the minimum distance  or with cβ-cβ distances  we use the sub-index min and cβ, respectively .

in summary, we have two composite zscores  and six energy-terms . zes3dc terms refer to the distance-dependent interaction between residues in specific local conditions. ze3dc terms explain the distance-dependent interaction between local conditions, with independence of the residues involved. finally, zelocal terms describe the cost to place one residue in a specific local condition. because of the definitions of ze3dc and zelocal they tend to positive values in folded structures. it is interesting to note that zelocal terms do not involve pairs of residues at certain distance, but only the requisites to accommodate a residue, buried or exposed, with a specific secondary structure.

RESULTS
development of an empirical scoring schema and parameter optimization
we first develop a new set of empirical potentials based on the theory formulated above. we split the database  in five groups and performed a 5-fold analysis of the data to extract the φ parameters required to calculate zeref and to check the distribution of the energy-terms of the potential . a total of  <dig> φ parameters are obtained for pairs with local-conditions expressed as a triad of polar character, secondary structure and exposure degree with min and cβ potentials. although this amount of parameters might leave some doubts of a possible overfitting, we have to note that zeref is neglected on the evaluation of the scores for the prediction of correct folds , thus being irrelevant for the prediction and for the evaluation of the new scores.

the distributions of zscores of the energy-terms of the potential are averaged using the results from the 5-fold validation procedure. average distributions and standard errors of these zscores calculated with cβ-potentials and min-potentials are plotted in figure  <dig>  the comparison with the random set shows that the distribution of zeref of real conformations mostly overlaps with the distribution of randomly shuffled sequences using min or cβ-cβ force-fields. consequently, we can neglect the contribution of φ parameters  on the selection of the correct fold of a protein sequence, as stated previously and in the outline of the algorithm section. zelocal and ze3dc distributions accumulate positive scores . interestingly, the deviation of zelocal with respect to the random distribution shows a low overlap, revealing the importance of the local conditions that apply on the protein sequence. this effect is the consequence that some residues are more comfortably accommodated on specific secondary structures, either exposed or buried, than others.

we construct the new potential with the total database of structures, formed by  <dig> domains of scop with non-homologous sequences. still, we need to prove the relevance and applicability of these new potentials. therefore, the next step is to check if some of the energy-terms are more relevant than others to detect correctly folded structures or if the new composite scores  require the information from each energy-term in equal proportion. this analysis is performed on a set of model-decoys derived from few target proteins with known structure. we used the set of decoys from moulder. this set contains several near-native structures  from protein sequences that were not used on the generation of statistical potentials. we compare the pearson product-correlation between the zscores of energy-terms of the potential and the rmsd of the models for  <dig> target/model sets of decoys . this shows a positive correlation between zemin,  and the rmsd for many of the  <dig> target/model sets. also, we compare the distribution of probability of scores of all energy-terms and composite zscores of the model-decoys with the distribution of their near-native structures . the distribution of probability is calculated as the ratio of the number of structures with a specific score over the total of decoys  or the total of near-native structures . the average of the distribution of the  <dig> sets of target/model decoys is shown in figures  <dig> a and  <dig> b. because of averaging the distribution, some scores show a non-gaussian behavior, presenting more than one maximum . positive values of ze3dc and zelocal have higher occurrence in near-native structures than in non-native decoy models, while zes3dc of near-native structures are negative.

pearson product-correlation between root mean square deviation  of moulder decoys of  <dig> target/model sets  and zscores : , , , , zemin, zes3dc-min, ze3dc-min, and zelocal-min.

we also compare the min and cβ-cβ force-fields for the terms zes3dc, ze3dc and zelocal. first, we observe that ze3dc is a good descriptor to identify near-native structures when using the cβ-cβ force-field, but not with the min force-field. on the other hand, zes3dc is a good descriptor to identify near-native structures with the min force-field, but not with the cβ-cβ force-field. this indicates that the description of residues as hydrophobic or hydrophilic, their location in secondary structure and their degree of accessibility in the surface, are sufficient to identify the interacting pairs of a near-native fold when using a rough model of the backbone structure. second, it is remarkable that the conditional location of residues produces a discriminative measure of the correct fold. this is related with the tendency of certain residues to be involved in specific secondary structures and with a particular degree of surface-accessibility. besides, the definition of zelocal is virtually independent of the force-field used . finally, both composite functions, zemin and , take advantage of zelocal, while compensating zes3dc and ze3dc into a single score. still, we need to further compare them with other scoring functions in order to prove its utility to detect the native and near-native conformations among the sets of decoys.

detection of native conformations
to test the ability of the derived potentials to find the native conformation among different models we used four decoy data sets  and we compare zemin and  with dope, dfire, prosa <dig> and ga <dig> . we find that most methods can successfully identify the native fold for over  <dig> targets. dope and dfire scores obtain best results in fisa_casp <dig>  lmsd, and 4state_reduced decoy sets, and zemin is also successful. in summary, zemin and  of the native conformations rank similar to dope, dfire and prosa <dig> in most targets. thus, the utility of zemin and  to detect the native conformation on a set of decoys is evinced and similar to dope, dfire and prosa <dig>  still, it would be interesting to explore further if zemin and  help to find near-native conformations  and to discard incorrect folds.

ranking position of the native structure among the sets of model/target decoys for several scoring functions. in the first column it is shown the code of the target protein used to generate the set of decoys. next columns show the results for dope, ga <dig>  prosa <dig>  dfire, , zemin scoring functions. the set of decoys is split in groups: moulder, 4state_reduced, fisa_casp <dig>  and lmds.

detection of near-native conformations
to test whether the derived potentials are able to identify near-native conformations among the set of decoy structures, we define the nearest-native conformation of a target as the model with the smallest rmsd to the target native conformation different than zero. in a similar design as for table  <dig>  we calculate the rmsd difference  between the rmsd of the best non-native candidate and the rmsd of the nearest-native conformation   <cit> . the best candidates are chosen using the scores of dope, dfire, prosa <dig>  ga <dig>  zemin and  among the set of models excluding the native conformation. figure  <dig> shows the superposition of the native structure with the best and the worst candidates from the decoys of target "1dxt" in moulder. as expected, Δrmsds are large for most models of fisa_casp <dig> and lmsd decoys and small on sets of 4state_reduced and moulder. the smallest values of the average of Δrmsd are obtained with dfire, zemin and  in moulder model/target sets while for the 4state_reduced set the smallest averaged Δrmsds are obtained with prosa <dig> and zemin. however, it has to be noted that zemin uses information of side-chain conformation, while classical functions prosa <dig>  dfire, dope and ga <dig> use only information of cβ atoms.

in the first column it is shown the code of the target protein used to generate the set of decoys. next columns show the Δrmsd for dope, ga <dig>  prosa <dig>  dfire, , zemin scoring functions. the set of decoys is split in groups: moulder, 4state_reduced, fisa_casp <dig>  and lmds.

we use the same moulder decoy set to compare the rmsd and the scores calculated with , zemin, dope, dfire, ga <dig> and prosa <dig> . roc curves of sensitivity/specificity and sensitivity/ppv are calculated with all conformations from the sets of models from moulder and 4state_reduced . they show the ability of  and zemin to identify wrong conformations without lost of coverage but less capacity to detect near-native conformations. we use the program star  <cit>  to assess the statistical significance of the observed difference between these scoring functions when used as binary classifiers . with the set of moulder decoys  the scoring functions , zemin, dope and ga <dig> show similar performance if we consider that for p-values smaller than  <dig>  the difference is significant. with the set of 4state_reduced decoys  only the difference between  and ga <dig> have significant p-value higher than  <dig>  and we can assume that the differences among all scoring functions are significant.

ppv and sensitivity curves with respect to scores and zscores are used to select a threshold to accept a putative conformation. figure  <dig> shows the plot of the average  of ppv and sensitivity of the  <dig> model/target sets on moulder decoys versus the thresholds used. also the total ppv and sensitivity is calculated with all models and plotted in figure  <dig>  the zscore  at the cross points between the curves with the total ppv and sensitivity produce high values of average ppv and sensitivity for all methods. these cross-points obtain a good balance between total ppv and sensitivity for each method. therefore, conformations with zscores lower than their thresholds were accepted as correct predictions . the distribution of rmsds among positives of the scoring-functions indicates that  works as many other methods . also, most positives have rmsd smaller than 5Å . more than 50% of true positives in moulder set were obtained either with prosa <dig>  or by all methods except prosa <dig> . the remaining set of true-positives is obtained by many scoring functions and often by more than one . interestingly, all scoring functions discriminate well among the set of true-negatives  in moulder. moreover, almost 50% of false positives are found among those conformations accepted by dope, dfire and prosa <dig>  the use of  ensures a large amount of conformers which structure differed from the native conformation by less than  <dig> Å, while purging more than 80% of spurious conformations. therefore,  and zemin are not redundant with any of the classical scoring functions, while in combination with them they may help to cover a larger set of correct conformations.

distribution of true-positives and false-positives among decoys of moulder according to one or more scoring functions and their thresholds. columns show the number of decoys  found by one or more scoring functions .

distribution of true-negatives and false-negatives among decoys of moulder according to one or more scoring functions and their thresholds. columns show the number of decoys  found by one or more scoring functions .

in summary, the utility of  to detect near-native structures has been attested. moreover, the global-statistic results  are similar to state-of-the-art methods like dope, dfire, ga <dig> and prosa <dig>  but the individual results for each particular decoy conformer are different. this proves the convenience of using  in combination with other methods. more in detail, most near-native conformations are found by more than 50% of methods, but few of them are detected by one or at most two methods. thus, it is convenient to use more than one method to confirm a prediction and to increase the coverage of near-native structures. even though the best results are obtained with prosa <dig>  the combination with dfire, dope, ga <dig>   and zemin can increase the coverage up to 50%, while the number of non-native-like conformations is not largely distended. the best strategy to detect near-native structures is to use a composite score . here we have proved that: 1)  and zemin can detect near-native structures undetected by other methods, thus it is worth to use them with other composite scores; 2)  and zemin are already composite functions that can itself be improved using weights for each individual component; and 3) each component term of  and zemin disclose the features of residue-pair interactions and the local environment of residues, thus they can be used to detect the main components affecting the structure either to be considered near-native  or non-native-like . still, besides characterizing the main components affecting the zscore it is usually interesting to identify the region of the structure stabilizing or destabilizing the protein conformation, not only the energetic component affected . this implies to distribute the zscore along the sequence. however, only those methods scoring the energy in a sum of terms per residue can split the score along the protein sequence. this is possible only for few methods , but not for all and even more difficult for composite functions. the use of zscores instead of original energies  impedes its distribution along the protein sequence because by definition it cannot produce a sum of terms per residue. in the next section is presented an approach to distribute the zscore of a model structure along its protein sequence and its applicability to detect local errors in the structure.

detection of local errors in the conformation of decoy models
the rmsd between cα atoms of the decoy-model conformations in moulder and their corresponding target are compared to sc, sczemin,  and zaemin . on the one hand we compare the rmsd and the residue-position zscores of the models. we expect that the highest rmsd between cα atoms  will have the highest scores . on the other hand, we compare the cα rmsds' with the difference of residue-position zscores between each decoy-model and its target . due to the different magnitudes of rmsds and zscores, these curves have to be normalized for the sake of comparison. the normalized values are defined as /σ where xi is either any of the zscores on position i or the cα rmsd of residue i, <x> is the average along the sequence and σ the standard deviation . the coincidence of picks in rmsd and zscore curves identifies the differences detected between the near-native and decoy structures .

the pearson product-correlation between the cα rmsds' and the residue-position zscores of the model decoys  show the possibilities to use the zscores to detect the accuracy of the models . in general, residue-position zscores of decoy structures work better than zscore differences with respect to the original target to validate local conformation, and zscores based on cβ-potentials are better than min-potentials. nonetheless, the number of times that the pearson correlation is higher than  <dig>  for models with backbone rmsd smaller than 7Å with respect to the target is not large enough to guarantee its use for identifying locally erroneous conformations. potentials  of a residue or a continuous fragment of residues are affected by the rest of the protein-sequence. therefore, regions with near-native conformation may have peaks of energy  due to other regions wrongly modeled. this diminishes the correlation between cα rmsds and local residue-position scores. interestingly, there is a remarkable correlation between sc and  and between sczemin and zaemin :  <dig> out of  <dig> models with rmsd smaller than 7Å have pearson correlation higher than  <dig>  between sc and  , while  <dig> out of  <dig> had pearson correlation between sczemin and zaemin higher than  <dig>  . this supports the use of just one of the methods for the assessment of the local conformation.

pearson correlation between rmsd of cα atoms and residue-position zscores of structure-models in moulder decoy set. in the first column is shown the code of the native protein used to generate the decoys of a model/target set. next columns show: i) the average of pearson correlation  of those models with rmsd from the native structure smaller than 7Å and using only correlations higher than  <dig> ; and ii) the ratio p/n, being p the number of models with correlation larger than  <dig>  and n those with correlation smaller than or equal to  <dig>  among models with rmsd larger than 7Å. residue-position zscores are: sc, sczemin, , zaemin and the differences of sc and sczemin of the decoy conformers with respect to their native structure . pearson correlations between cα rmsds and zscores are denoted as c - in even columns -, while correlation of cα rmsds and zscores normalized by length are indicated as cl - in odd columns -.

in summary, we have introduced the equations to distribute the protein zscore along its sequence. we have also provided some evidence of their utility to identify regions where the conformation deviates from the native structure. however, further analyses are needed to fully prove the use of the local zscores, by remodeling local fragments of the structure and recalculating the zscores, but this is beyond the scope of the present work.

CONCLUSIONS
we have introduced a method to split knowledge-based potentials and to solve the definition of the reference state. we have defined two scoring functions as linear combinations of energetic terms, transformed into a sum of zscores and proved that the functions containing the reference state could be neglected on both. there is room still for improvement using machine-learning approaches or optimization rules, like support vector machines or artificial neural networks, to assign the weights of the linear combination of energy-terms. with the simplest approach we obtained predictions similar to the state-of-the-art of other methods  for several testing decoy sets. this included finding the native conformation or finding the closest set of conformers to the native structure . it is remarkable that some predictions were not obtained by some classical approaches  but were obtained using .

finally, we defined four scoring approaches for local conformation in order to find errors on model structures. we found a good correlation between the residue-position zscore  and the residue-scanning zscore , which allow us to use the less expensive computational approach  to analyze the local conformation. we compared the residue-position zscores with the local rmsd of cα atoms and proved that it can be used to identify wrongly modeled regions.

