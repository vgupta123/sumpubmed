BACKGROUND
with the sequencing of the human genome it became evident that protein coding sequences only make up about ∼ <dig> % of a mammalian genome
 <cit> . it has since then been a main challenge to analyze the remaining part of the genome. a non-negligible fraction of the genome consist of noncoding rnas , an abundant class of genes which are not translated to proteins and instead function directly in the rna form. in spite of the progress in both computational rna biology and experimental techniques, annotating ncrnas in mammalian genomes remains a major challenge. the challenge is to carefully pin point only functional ncrnas, which can be done through similarity to existing ncrnas or de novo through a combination of rna structure prediction and rna-seq data. the latter may with subsequent effort reveal full length transcripts, yet with unidentified function
 <cit>  and functional assignment will require tedious lab work on each instance.

the human genome is the most comprehensively annotated mammalian genome. yet, the annotation of ncrnas is still an ongoing effort, which was initiated with the release of the human genome more than a decade ago based on similarity search
 <cit>  and have expanded several times most noteworthy in the recent encode and gencode projects
. within the most recent gencode annotation ∼ <dig> long ncrnas  have been identified
 <cit>  by manual intervention, though their functionality in general is yet to be uncovered.

more and more mammalian genomes are being sequenced . thus it becomes important to annotate ncrnas in mammalian genomes at least in a version containing the most well established rnas and rna families. the annotation of new mammalian genomes will in general build upon the existing annotation of the human genome; however, the corresponding number of years of effort is not feasible and a more direct strategy is needed.

the most comprehensive collection of structured rnas is found in rfam
 <cit> , which has been constructed in a large collaborate effort by the  rna community. however, even in rfam the annotations lack explicit functional annotation and the models for structured rnas do not always hold a strong discrimination power to pseudogenes, as these may be incorporated into the rfam seed sequences on which the structure models are based
 <cit> . it is in general not possible to distinguish between real genes and pseudogenes, except for a few cases, exemplified by trnas
 <cit> .

analysis on early and incomplete pig sequencing data for structured rnas have been carried out previously both on genomic as well as on est data
. whereas, the annotation of est sequences was based on de novo assembly comparison of the resulting contigs to related organisms, the annotation of genomic dna as fragmented due to low coverage and annotation was carried out for all of the contiguous pieces in a similar way. interestingly the est annotation provided additional expression profiles as well. these studies on the incomplete genome included discovery of homologues as well as de novo predicted ncrnas. as it was shown for the full transcriptomic analysis on the pig ests, the most diverse expression is in brain and testes tissues
 <cit>  and particular brain and developmental tissues hold a relatively higher expression of putative ncrnas
 <cit> . the search for lncrnas in the pig genome has just begun and includes expression analysis of an mrna-like ncrna
 <cit> , suggestion of an mrna-like ncrna
 <cit>  and two other cases in the lncrna database
 <cit> . other studies indicate a larger number of putative lncrnas in pig
 <cit> . also, recent work has indicated a further potential for ncrnas in sus scrofa, for example, by the use of the genomic sequence to map small rnas in the cumulus-oocyte complex and in early embryos in the pig
 <cit> . likewise for the discovery of mirnas in the pig intestine
 <cit>  and in pig skeletal muscles
 <cit> . while these provide initial information, the sequencing of the full genome for the first time opens for a systematic analysis and annotation of ncrnas in pig. by annotating the pig genome for ncrnas a range of related production animals e.g., cow are being annotated as well using comparative genomics in this study.

when annotating genomes of model animals such as the pig it is also of interest to narrow down organisms or lineage specific ncrnas, as one would like to avoid these in studying basic genetic mechanisms which can be used as a template in for example human diseases. conversely, the lineage specific ncrnas can potentially be highly relevant when studying the underlying genetic mechanisms of not only animal health, but also production.

to address the problem of ncrna annotation of a mammalian genome using a reasonable amount of man-power resources, we here focus on structured rnas, a main characteristic of many ncrnas and regulatory elements in utrs of mrnas. we introduce a pipeline using the complementing resources of sequence or structure homology search, and small rna-seq data analyzed for the potential of mirnas. on top of this we address de novo annotation by employing rnaz
 <cit> . the pipeline exploits that a range of related organisms exists where the genomes match up in regions extending beyond the individual structured rnas. this enables manual curation of the structured rnas and allows for synteny analysis of the annotation produced in this paper. the recent sequencing of the pig genome has provided insight into a range of medical, production and evolutionary aspects
 <cit> . the full genome sequence, furthermore, makes it possible to obtain a good overview of the structured rnas, genes as well as well as regulatory rna structure, all with relevance for the mentioned topics.

RESULTS
the modules of the pipeline
in the following section we present a pipeline for annotation of structured rnas. the pipeline is targeted towards annotation of complete vertebrate genomes, but could in principle be used to annotate other types of genomes or even a collection of individual sequences. the pipeline also adds additional information to annotation in the form of synteny and contextual information such as close-lying protein coding genes.

the pipeline for annotation of structured rnas presented in figure
 <dig> is based on three main modules,  annotation,  pairwise and multiple alignments, and  tagging of the annotation. the last module adds additional information to the annotation.figure  <dig> 
pipeline. the modules of the rna pipeline. module  <dig> : the annotation pipeline takes as input any number of sequences and runs a number of external annotation tools on it . this leads to the initial annotation of the rna loci in the sequence. a naming and resolving tool decides on the final annotation of the locus. the  <dig>  ncrna genes cover  <dig> conflicts of annotation,  <dig> loci moved to the medium confident annotation during the curation step,  <dig> novel mirna loci found exclusively by mirdeep, and  <dig>  ncrna genes found by homology. lncrna loci and cis-regulatory elements are annotated separately. module  <dig> : the multiple alignment pipeline runs on a genomic scale and aligns the genomic sequence of the input genome against any number of other genomes, finally forming multiple alignments in maf blocks. module 3: the post-processing part of the pipeline adds context to the rnas, which in many cases will allow for a curation of the structured rna loci. the numbers in parenthesis are those obtained after the removal of  <dig> annotations as part of the curation procedure:  <dig> trnas,  <dig> homology based mirnas, and  <dig> de novo mirnas.



module : the annotation pipeline. here structured rna loci in a given input sequence are annotated . the annotation is based on a number of methods, classified as either sequence based homology search, structure based homology search, rna class specific methods, or de novo structured rna prediction. the sequence based homology search is presently based on blast
 <cit>  and a number of databases of known ncrna sequences . structure based homology search is performed with infernal
 <cit>  and covariance models  from rfam
 <cit> . class specific methods are typically based on sequence or structure homology search but with some additional knowledge about the rna, at present trnascan-se
 <cit> , and rnammer
 <cit>  are built into the pipeline. snostrip
 <cit>  is another class specific tool used in the present study, but is not yet fully integrated into the pipeline. the prediction of structured de novo ncrnas requires information in addition to the sequence to be reliable, either in the form of multiple alignment of  the input sequence used with tools like rnaz
 <cit>  or cmfinder
 <cit> , or in the form of rna-seq data used with tools like mirdeep
 <cit> . this submodule of the pipeline thus requires additional user supplied input data, which sets this submodule aside from the other three classification methods, which work on the input sequence alone. levels of certainty of the rna predictions are provided, as high, medium, low corresponding to the different cutoff levels for the individual tools, and the input to the annotator module will depend on the input from the tools as well as the confidence level. an overview of the cutoff levels are given in table
 <dig>  the next step is to mark and resolve the conflicts that are introduced by the individual tools, or introduced by the merging of the results of the tools. some tools are inherently conflict free like rnammer, trnascan-se and snostrip. some tools, however, are supposed to be conflict free, like the rfam models investigated with infernal. also when employing a tool like blast on a number of databases it is expected that a number of conflicts are introduced. the conflicts introduced by running blast were partly resolved by choosing the hit with the lowest e-value within each database and class of rnas, e.g., mirnas or snornas. conflicts between rfam families introduced by running infernal were marked. conflicts of annotation introduced by different databases and conflicts introduced by different tools between databases are only marked if they represent a conflict in classification, e.g., a genomic locus is marked as a conflict if annotated as both snorna and mirna. different tools may indicate different names for the same rna. we assumed that if two tools both classified a loci as belonging to the same class, but that the name used by the two tools were different, this did not indicate a real conflict, but only a conflict in naming. therefore a name of the rna is chosen based on a specific ranking of the tools annotating the loci. in general, the class specific methods add extra information to the rnas that they annotate  or they annotate full length rnas, e.g., rnammer, where blast or infernal may be unable to. the predictions made by high confident blast runs will normally be more confident than the ones obtained from infernal on the same model. therefore, in the naming procedure class specific methods are preferred over blast, which in turn is preferred over infernal/rfam. for a full overview see additional file
1: table s <dig>  de novo methods like mirdeep and rnaz are only used as a last resort in the naming and classification procedure.table  <dig> 
cutoffs for individual tools at different global confidence levels



blast

infernal


trnascan-se

rnammer

snostrip

mirdeep
the results from the individual tools are merged at  <dig> different cutoff levels: high, medium and low. this table shows the correspondence between the cutoff levels of the merged annotation and those of the tools. for each computational  strategy, we define these levels. note that infernal screen have been divided into infernal  and infernal mirna which is only for mirna families. the infernal results were filtered by the family specific gathering scores as well. for as is, we refer to the programs default values for the respective versions  without subsequent cleaning.



the result of the two steps of module  is an uncurated annotation which is to be analysed and curated in module  and .

module : pairwise and multiple alignments. this module works on a full genome and aligns the genome against any number of related genomes. a user supplied phylogenetic tree is needed as well as a decision on the parameters to use for the pairwise alignments. three sets of parameters for the pairwise alignments are provided: 1) highly related genomes, 2) related genomes, 3) distantly related genomes. these parameter choices are based on those used for the ucsc 46-way alignment of the human genome, where the three sets approximate the respective choices made for primates, placental mammals, and non-placental mammals as well as other vertebrates. the module is a framework built over pairwise alignments with lastz
 <cit>  and subsequent chaining and filtering with the ucsc
 <cit>  tool chain.

module : this module provides genomic context to the rna annotation, or additional knowledge about the annotations. at present the following submodules are implemented: 1) genic context, requires the ensembl  gene annotation. 2) clustering of rna loci, checks for other rna loci annotated in the vicinity of the one in question. 3) conservation of the sequence in other organisms derived from the pairwise alignments. 4) conservation of structure derived from the multiple alignments using rnaz. based on this information a curation of particular rna loci or rna classes is possible, which leads to the curated annotation.

the pipeline for rna annotation presented above in module  is a flexible framework for rna annotation, which may be extended by any number of future tools.

rnas of the individual annotation tools
the pipeline presented above was used to annotate the pig genome version  <dig> . in this section we present and discuss the results of the rna annotations obtained from the individual tools ordered by their classifications as sequence based homology search tools, structure based homology search tools, and class specific search tools. details about the cutoffs used for the tools at high, medium and low confident levels are given in table
 <dig>  while the medium and low confident results are mostly confined to additional file
 <dig> 

sequence based homology search using blastwas performed against a number of databases . the databases have not been redundancy reduced and the sequences are used without modifications. the only exception is the mirnas from the rfam seeds, which had special problems and they were therefore excluded from the high confident results. the reason is that at least some rfam mirna families are inconsistent with mirbase .

we found  <dig>  high confident  rna loci belonging to a total of  <dig> different rna families see additional file
1: table s <dig> for the high confident sequence homology search results; the medium and low confident results are included in the table for completeness. special care must be taken when using mirbase for annotation, since it contains both experimentally determined mirnas and mirnas determined by homology. in a few cases even purely in silico discovered mirnas have entered the database . this resulted in removal of  <dig> mirna loci, which were found by homology to sequences without experimental evidence in mirbase, and which have no experimental support in this study . in total we obtained  <dig> annotation conflicts, within the sequence similarity search results. the conflicts were always found to be between a mirna from mirbase and a snorna , or a mirna from mirbase and srp rna from rfam. for an overview of misannotation of mirnas from small rna-seq data see langenberger et al.
 <cit> .

structure based homology search was performed with infernal
 <cit>  on the covariance models of the rna families from rfam 
 <cit> . here, we only used the  <dig> families with seed sequences in vertebrates. each rfam family comes with a family dependent gathering score cutoff, however this alone proved insufficient for high confidence annotation since without additional filtering the scan of the rfam families in the pig genome with infernal yielded  <dig>  loci, where 8% of them had conflicting rfam annotation.

in light of the high number of matches presented by the unfiltered infernal results we decided to impose additional filters on the structure based annotation. the details are found in the methods section. in the current section, we touch upon the methodology and present the results of imposing these additional filters. for an overview see also table
 <dig> 

the mirna families come with special problems and must therefore be treated separately. these problems include families specifying a very broad range of mirnas, which makes these families unsuitable for specific annotation and the rfam mirna families also come with a very high number of conflict loci without very strict filtering . for the non-mirna families we in most cases use the infernal e-value cutoffs corresponding to the family specific gathering score cutoff level. however, for families where this infernal e-value cutoff would be higher than 1e- <dig> we keep it at 1e- <dig>  for a sequence to be matched with high confidence to a particular family, we require that the sequence shows overlapping infernal and blast matches to the family. for the high confident annotation we set the blast e-value cutoff to 1e- <dig>  for the medium confidence annotation we lower the blast overlap requirement to a blast e-value cutoff of  <dig>  and for the low confidence annotation we need no overlap in the blast comparison. even a loose blast overlap requirement has the effect that it anchors the hit to the right family, thereby greatly reducing the number of conflicts and number of false family assignments at these levels.

just as the rfam precursor mirna families were removed from the high confident sequence based annotation, we also removed them from the high confident structure based annotation . for the medium and low confident annotations of rfam mirna families, we impose infernal e-value cutoffs of 1e- <dig>  and 1e- <dig>  respectively. the mirna precursor families are further required to have an overlapping blast hit, in both medium and low confidence annotations.

it is worth noticing some pitfalls of using infernal with the rfam families. first of all, we root out most problems by imposing a blast filter, by discarding the non-mirna families, and by only looking at families with seeds in vertebrates. this causes the loss of a few families that otherwise would have been detected at lower cutoffs. for example, we find an extra  <dig> non-mirna families at the lowest cutoff level. two of them, va and acat, are likely false positives without synteny to their origins in the original organisms. the other four, gait, cotc_ribozyme, snord <dig> and aca <dig>  however, are syntenic to their human counterparts and could well be true matches that we miss because of the filtering. on the other hand, some families will still have false positives, pseudogenes or remote homologs, and we are left with no clear way to distinguish these by automatic means alone. we therefore proceed to curate the annotation in the coming sections. hence, the high confident annotation represent a conservative automated structured rna annotation, without curation of individual rnas or rna families.

we found  <dig>  high confident loci with structure based homology distributed on  <dig> families . in contrast to the sequence similarity based results, conflicts are marked between overlapping rfam families, rather than overlapping rna classes. however, with the applied cutoffs we found conflicts only in the medium and low confident results, while the high confident results were free of conflicts. if we compare the  <dig> high confident blast results based on the rfam database  with the high confidence results of the infernal run in additional file
1: table s <dig> we found that an additional  <dig> rfam families and an additional  <dig>  loci may be annotated with high confidence using structure based homology search.

class specific methods were used to further enhance and extend the annotations of trnas , rrnas , and snornas .

we scanned for trnas with trnascan-se
 <cit>  in addition to the pure homology-search methods presented above. in the human genome trnascan-se predicts a reasonable number of trnas  but for other mammalian genomes number of trnas predicted by trnascan-se is often much higher . here we adopt the cutoffs used for cow in the trnascan-se database to gain a set of high confident trna candidates . the unfiltered  scan generated  <dig>  trna loci compared to the  <dig> loci of the filtered results .  <dig> different trna types were found within the filtered results; trna.sec were found in addition among the loci of the unfiltered results. the division of the trnascan-se results on types are found in additional file
1: table s <dig> 

the combination of trnas found by blast, infernal and trnascan-se produced  <dig> high confident results. however, as part of the cleanup of the annotation we changed the  <dig> trnas not detected by trnascan-se from high to medium confident annotation. thus reducing the number of trnas to  <dig>  it is noteworthy that  <dig> of the  <dig>  high confident trnas were found to be conserved in at least  <dig> other organisms , while less than 2% of the  <dig>  low confident trna candidates are conserved in at least  <dig> other organisms.

the rnammer
 <cit>  scan generated  <dig> rrna loci subdivided on two 28s fragments, four 18s fragments and  <dig> 8s fragments. the rnammer hits were considered to be high confident. the results of the rnammer scan were not directly comparable to the sequence similarity search since rnammer detects the larger ribosomal fragments, which blast have difficulties with, unless the hits are subsequently clustered. however, the  <dig> large ribosomal rnas found by medium confident sequence similarity search are all included in the rnammer results.

snostrip
 <cit>  generated a total of  <dig> snorna families in  <dig> loci, these are considered high confident results. in comparison, infernal identified  <dig> rfam based snorna loci. however, out of the  <dig> combined infernal and snostrip loci,  <dig> are unique to infernal and  <dig> are unique to snostrip. the annotation created by snostrip will like the infernal/rfam snornas include pseudogenes and possibly false positives as well .

the annotation obtained in this section represents the raw annotation, which in the next section will be refined.

merged annotations of the homology based rna loci
the annotations obtained from the individual tools are merged in an automated fashion, which will on the one hand ignore simple naming differences between the tools, but will on the other hand highlight real annotational conflicts.

we merged the high confident results of the individual tools to obtain the high confident annotation of structured rnas . we found a total of  <dig>  homology based high confident structured rna loci and structural rna elements after moving  <dig> trnas and  <dig> mirnas to the medium confident annotation . of these  <dig> are cis-regulatory elements,  <dig> lncrna loci ,  <dig>   ncrna genes, and  <dig> conflicts of annotation. the distribution of the loci on those found by sequence similarity search, structure homology search and class specific tools is shown in figure
 <dig>  a similar table with the homology based tools merged at the medium confident level and low confident level, respectively, is found in additional file
1: table s <dig> table  <dig> 
results of the homology based pipeline


the combined results of the sequence similarity search, structure homology search and class specific tools at the high confident cutoff level . the column rna class contains cisreg-elements: cis-regulatory elements from rfam/infernal; lncrna-loci: infernal lncrna structure loci; the next  <dig> rows contain  ncrna genes, mirna: blast from mirbase and mirdeep predictions; ribozyme: ribozymes from rfam/infernal; rrna: ribosomoal rnas primarily from rnammer; snrna and snorna: blast results and results from infernal/rfam; trna: trnas trnas from blast; trnascan-se and infernal/rfam; lncrna-loci: structural loci from larger genes; other: rna families from rfam not belonging to one of the other classes; conflict: conflicts of annotation. loci are the number of rna loci of a given class; families are a subdivision of classes into rnas with the same name.  <dig> trnas and  <dig> mirnas were moved to the medium confident annotation as part of the curation procedure. see text for details. note that for the final high confident annotation we add  <dig> rna-seq based mirna candidates, reaching the total of  <dig>  high confident rna loci.
homology based annotation in overview. the venn diagrams for counting the high confident structured rna loci found with sequence homology search , structure homology search  and class specific tools .  the diagram includes all  <dig>  high confident structured rna loci obtained by homology.  the similarity search is confined to the rfam seed sequences .  <dig> loci found by high confident blast against the rfam sequences is missed by high confident structure homology search . the reason is our additional infernal e-value cutoff of 1e- <dig> imposed on all families. see text for detailed discussion. the numbers in parenthesis are after removal of  <dig> trnas and  <dig> mirnas loci removed in the cleanup procedure. a total of  <dig>  rna loci were found. of these  <dig>  loci were found by sequence similarity,  <dig>  were found by structure similarity, and  <dig>  were detected by class specific methods.



the high number of loci found by sequence similarity alone  are primarily mirnas found by similarity to mirnas in mirbase, but mirna families were excluded from the high confident structure similarity search. however,  <dig> loci found by sequence homology to sequences from rfam were unconfirmed by structure homology. these are indicated by the red and purple areas in figure
 <dig>   <dig> of these  <dig> loci belong to two cis-regulatory families ,  <dig> are trnas and  <dig> is a snorna belonging to the u <dig> family. in particular a cluster of  <dig> ire loci located on chromosome  <dig> appear to be valid.  <dig> of these were confirmed by sequence similarity alone, however our imposed infernal e-value cutoff of 1e- <dig> filter them out, while  <dig> were confirmed by both sequence and structure homology. the three trnas all fail the e-value filter of 1e- <dig>  however, two of the trnas appear to be valid family members, both confirmed by low confident trnascan-se. the third sequence might be incorrectly entered into the rfam seeds with an infernal e-value of  <dig> e- <dig>  the u <dig> locus may be an incorrectly curated sequence in rfam with a score only half of the gathering score cutoff.

the substantial change between the two venn diagrams  in the counts of the loci found by class specific tools and/or sequence and structure homology is caused by trnas found by blast against trnadb, but not found by blast against the trna seeds from the rfam family. amongst the  <dig> loci found by class specific tools alone were  <dig> rrnas ,  <dig> snornas , and  <dig> trnas . all but  <dig> rrnas found by the class specific rnammer were recaptured by infernal in the 5s rrna family in the complete infernal scan without any blast filtering and using the family specific gathering score as cutoff. however, the gathering score cutoff imply an infernal e-value cutoff of ∼ <dig> for the 5s rrna family. similarly,  <dig> of the  <dig> trna candidates found by trnascan-se but missed by high confident structure homology search were also found in the trna rfam family in the complete infernal scan. here the gathering score cutoff implied an infernal e-value cutoff of ∼ <dig>  finally,  <dig> of the  <dig> snornas found by snostrip were also found in the complete infernal scan. for the 5s ribosomal rnas, trnas and for the snornas detected by snostrip, the difference in the loci detected by infernal and by the class specific tools, indicates that sequence based homology search and additional test for class specific methods is a more optimal way of searching for these classes and genes. as a final remark,  <dig>  of the  <dig>   loci found by infernal, but missed by the class specific tools, were marked as pseudogenes in the curation procedure .

merging the results of the tools at the high confidence level introduced two kinds of inconsistencies. firstly, naming differences due to inconsistent naming of the rnas in different databases and by different tools. this type of inconsistencies were resolved by consistently preferring one tool over the others within each class of rnas . secondly, the remaining inconsistencies will be genuine conflicts that needs to be resolved by hand, if possible. the conflicts within the high confident results are all between a mirna and a non-mirna. that is, some mirna and one of the following snornas: snora <dig>  snora <dig>  scarna <dig>  snord <dig>  snora <dig>  scarna <dig>  and snora18; mir- <dig> and metazoa _srp; and finally 28s rrna and  <dig> different mirnas.

this concludes the homology part of the annotation. overall the homology part of the pipeline contributed  <dig>  high confident structured rnas , after removal of  <dig> trnas and  <dig> mirna loci in the cleanup procedure. the next section will deal with the small rna-seq data, which will not only add confidence to the high confident mirnas annotated above, but will also move a few medium or low confident mirnas annotated by homology into the high confident annotation.

small rna sequencing and novel mirna predictions
ten combined small rna libraries were sequenced and scanned for mirnas using mirdeep . the read profiles are available for download and online visualisation from
http://rth.dk/resources/rnannotator/susscr102/version <dig> .

the raw output from mirdeep indicated  <dig> putative mirna loci with at least  <dig> reads present. however, due to duplication of genomic sequence in assembled chromosomes as well as unplaced scaffolds only  <dig> unique mirna precursor sequences and  <dig> mature sequences were found. . the cleanup procedure described in the methods section reduced the number of sequences to  <dig> spanning  <dig> loci.

of the  <dig> precursor sequences  <dig> are already known for pig in mirbase version  <dig>  a further  <dig> could be identified by high confident sequence identity to mirnas from other organisms in mirbase version  <dig>  finally  <dig> precursors without high confident annotations were identified using a combination of low-confident sequence identity , and synteny to other organisms.

the rna annotations from the pipeline were checked for overlap with the small rna library. we required a block of at least  <dig> reads overlapping with at least  <dig> nucleotides of the annotation and found overlap with  <dig> of the high confident annotations and  <dig> of the low confident annotations . see additional file
1: table s <dig> for a complete list of read supported high confident annotation.

the small rna-seq data may have reads from ncrnas yet to be discovered, beyond the mirnas found by mirdeep. in the next section we present analysis with a recently developed tool, which may aid in finding new ncrnas based on reads from small rna-seq data.

annotation of de novo rna transcripts using read profiles and deepblockalign
small rna sequencing data may contain transcripts, beyond mirnas. to detect these de novo rna transcripts, the closely spaced  set of mapped reads were grouped into distinct so-called block groups using blockbuster
 <cit>  and the resulting block group structures were compared by their read profiles using deepblockalign
 <cit>  to obtain putative rna annotations of the unknown transcripts. see methods section for details.

from blockbuster we found  <dig>  block groups with a length of at least  <dig> nt, of which  <dig> overlapped with homology based annotations. out of the  <dig> unannotated block groups  <dig> overlapped with mirdeep predicted novel mirnas. by comparing  the read profiles of the annotated and unannotated rna transcripts using deepblockalign we were able to give putative annotations to  <dig> block groups having no high confident homology annotation. the results are summarized in table
 <dig> table  <dig> 
annotation of unannotated block groups


the transcripts from the small rna study without annotation by the homology based pipeline were analysed with blockbuster resulting in  <dig> transcripts . the table displays a comparison of the de novo annotation of these block-groups by deepblockalign and with mirdeep. the table shows a comparison of the deepblockalign and mirdeep annotation of the  <dig> unannotated block groups. the second column contains the  <dig> block groups not annotated by mirdeep, the third column the  <dig> block groups annotated by mirdeep and the fourth is the sum of the two previous columns, i.e. all  <dig> block groups. the rows contain the deepblockalign annotations: the second row contains the block groups without deepblockalign annotation, rows 3– <dig> contains the deepblockalign classifications, row  <dig> is the sum of rows 3– <dig>  and finally row  <dig> is the sum of rows  <dig> and  <dig>  that is all  <dig> block groups and depending on the column, their mirdeep annotation.



deepblockalign and mirdeep share  <dig> predictions and in most  of the cases deepblockalign agrees with the mirna assignments of the loci, however,  <dig> predictions made by mirdeep had read profiles that according to deepblockalign were most similar to snornas and  <dig> had no matching profiles at the deepblockalign score cutoff of  <dig> 
 <cit> . these nine profiles are shown in additional file
1: figure s <dig> and figure s <dig>  in general, the mirdeep predictions with read profiles that align poorly with read profiles of known mirnas, either have unusually long or short loop regions or have read profiles different from the two peaks normally observed for mirnas.

five interesting examples among the unannotated read profiles not overlapping with mirdeep predictions can be found by requiring both a deepblockalign classification as well as an overlap with a structurally conserved region as predicted by rnaz. these five examples are displayed in additional file
1: figure s3–s <dig>  and amongst these examples we find  <dig> mirnas that are missed by both high confident blast and mirdeep, but deepblockalign identifies the read profile as mirna like, and low confident blast identifies the mirnas as mir- <dig> and mir- <dig>  one further mirna, mir- <dig>  is identified by low confident blast and by deepblockalign, but is not overlapping with an rnaz loci .

the examples presented above show how deepblockalign present an experimentalist with extra information on top of conventional analysis of small rna-seq data. both the  <dig> putative mirnas with uncertain mirna profiles, and the  <dig> mirnas missed by both blast and mirdeep require additional experimental scrutiny, which, however, is outside the scope of this work.

a multiple alignment of pig and  <dig> other vertebrate genomes
this and the following sections are concerned with adding context to the annotation provided above. we begin with a synteny analysis of the pig genome and of the structured rna annotation.

to investigate synteny between pig and  <dig> other vertebrate genomes, we formed lastz/ucsc
 <cit>  pairwise alignments, which were subsequently cleaned for non-syntenic alignments. the resulting coverage of the pig genome ranged from around  <dig> % for zebrafish to 64% for horse measured on the coverage of the non-ns of the pig genome . a multiple alignment was formed from the pairwise alignments with the threaded-blockset-aligner 
 <cit>  using the phylogenetic tree presented in figure
 <dig> as guide. this pig-centered multiple alignment featured a coverage of 79% of the pig genome . note that the combined pipeline of tba/multiz and lastz is also known as multiz.figure  <dig> 
phyologentic tree. phylogenetic tree for the pig genome multiple alignments. this phylogenetic tree is derived from the human phylogenetic tree from ucsc based on the 46-way alignment. the organisms has been reordered to put pig on top and the branch lengths have been ignored. a tree in this form is needed as parameter for the tba/multiz program. the tree is without branch lengths since these have not been recalculated for the pig genome.


pairwise alignments


pairwise and multiple alignments of the pig genome. the other genomes were obtained from the ucsc genome browser website in their lower-case masked form. masking was performed by the ucsc with repeatmasker and tandem repeat masker. the ucsc genome designation is given in the first column. the options for the pairwise alignments are given in the third column as either closely or distantly related to the pig in accordance with the choices made by ucsc for the human genome. the distance to pig has implications for the lastz and axtchain options as listed in additional file
1: table s <dig>  the coverage of the pig genome is given in % in the fourth column based on the number of non-ns covered by the pairwise alignment after cleaning of the alignments as specified. the pairwise alignments are cleaned either by synteny  or by deleting all but the best alignments where the target genome is multiply-covered. both methods reduces the coverage of the pig genome by the alignment. the choice of cleanup method is given in the last column. a graphical representation of the coverage is given in figure
 <dig> 
coverage of the pig genome. absolute coverage of the pig genome by the genomes used for the multiple alignment. the coverage is based on the cleaned alignments with single best coverage of the pig genome. however, depending on the method of cleaning the coverage of the target genomes  may be multiple in some locations. far left, in green, is the result of the coverage of the pig genome by any genome in the multiple alignments.

the coverage of the pig genome featured in table
 <dig> and figure
 <dig> is a less than ideal measure of the phylogenetic distance between the pig  and the other species . ideally the distance is measured on the sequence change within a set of known and carefully selected genes. the coverage is influenced not only by varying rate of sequence change depending on the genomic loci but also on the different alignment parameters used for different genomes , on the size of the completed genomes, and also on the degree of completion of the genomes.

the multiple alignment obtained in this section will be further used to find structurally conserved rnas using rnaz. an application of the pairwise alignments is the synteny analysis of the structured rna annotation in pig. however, to fully utilize the alignments we need a good annotation of structured rnas in the query organism. the best annotated organism among the vertebrates is human and we therefore proceed with a more detailed analysis of the synteny between human and pig.

human and pig synteny analysis
we performed a detailed synteny analysis of the relationship between the pig and human genomes based on the pairwise alignment between the two. the analysis lead to blocks at least  <dig>  nt long in which the synteny and strand information of the pairwise alignments was unbroken. these blocks, referred to as synteny blocks, were broken at gaps larger than  <dig> nt. we identified  <dig>  such synteny blocks between human and pig, which covered 79% of the non-ns of the assembled pig chromosomes. the syntenic blocks contain gaps not covered by alignments, and the coverage is therefore larger than the raw coverage of 56% of the pig genome by the human genome as reported in table
 <dig>   <dig>  of the  <dig>  high confident annotations were found on the assembled chromosomes and of these 78% are in the human syntenic blocks .table  <dig> 
synteny of the rnas of the homology based pipeline


the columns are, rna class, # rna loci. # loci in human syntenic blocks, # loci conserved in human by 80% sequence identity. # loci both syntenic and conserved that is the number of ncrnas in syntenic blocks where the ncrna is actually conserved in human. # loci rnas conserved in n other organisms, grouped by number of loci conserved in at least  <dig>   <dig>  or  <dig> other organisms. conservation is determined by the sequence identity in the pairwise alignments. the rna loci are located in the pairwise alignments and the sequence identity is calculated when at least 80% of an rna locus is covered. the rna locus is counted as conserved in that organism if the locus has a sequence identity of at least 80%. in the table the number of rnas conserved in at least n  of the other genomes: bostau <dig>  canfam <dig>  chohof <dig>  danrer <dig>  dasnov <dig>  echtel <dig>  equcab <dig>  erieur <dig>  felcat <dig>  galgal <dig>  hg <dig>  loxafr <dig>  mm <dig>  mondom <dig>  ornana <dig>  rn <dig>  orycun <dig>  tarsyr <dig>  turtru <dig>  xentro <dig> 



when we merged neighbouring synteny blocks with identical chromosome and strand information, we found that the number of blocks could only be reduced to  <dig> . if we instead ignored the strand information and merged neighbouring synteny blocks based only on a requirement of identical chromosome information, the number of blocks could be reduced to  <dig> synteny regions between human and pig, which cover 99% of the pig assembly . the number of synteny regions found here, may be compared to the  <dig> synteny groups and  <dig> conserved segments found in the experimentally based human pig comparative map in reference
 <cit> .

when we did a similar analysis for the horse/human pairwise alignment we found the initial  <dig>  initial synteny blocks could be reduced to  <dig>  synteny regions when we ignored the gaps but respected the strand, and finally to  <dig> synteny blocks when gaps and strand were both ignored. these cover 99% of the horse genome. the difference lies in the assembly of the two genomes. the horse contigs are ordered and oriented correctly using a combination of probe sequences and positional information from the comprehensive radiation hybrid and fish maps
 <cit> . notice that the  <dig> regions represent a pig-centered view of the pig-human synteny regions. the corresponding regions in human may contain  gaps and in certain cases overlap. a cleaned up version consisting of  <dig> smaller regions is found on the webpage . in this version large gaps in the human regions are ignored, but in some cases small regions will overlap with large regions when viewed in the human coordinates.

the analysis of the synteny between human and pig highlights some issues in the current pig assembly, which will be touched further upon in the following sections. these issues however, only makes a detailed synteny analysis more desirable, since it enables the identification of some of these issues.

annotations having duplicated sequence
a particular issue in the current assembly is duplicated sequence, both within the assembled chromosomes, and between sequence on the assembled and unplaced scaffolds.

we found that annotations expected only once in a mammalian genome were found in more than one place in the pig genome with the exact same sequence. sometimes these duplicated annotations were found twice on the same chromosome in close proximity  and sometimes they were found both on the assembled chromosomes and within the unplaced contigs . furthermore, sequence from the unplaced scaffolds are in some cases largely identical to sequence placed on the assembled chromosomes. to investigate this problem we formed a pairwise alignment of the pig genome with itself using blat
 <cit>  requiring high sequence identity  and allowing no introns in the alignments. the result of the alignment of the assembled chromosomes against unplaced scaffolds were that 63% of the sequence of the unplaced scaffolds were aligned to sequence on the chromosomes. the self alignment also allowed the identification of a number of annotations that were duplicated in the pig genome. some of these are known to have many copies in mammalian genomes, like 7sk, 8s rrna, gp_knot <dig>  histone-3-prime-utr, snora <dig>  snord <dig>  trnas, u <dig>  and u <dig>  however, others like the mirnas listed above were not expected to be found in multiple copies with high sequence identity. a module was therefore added to the pipeline which identifies annotations with identical sequences. we found that 10% high confident mirna genes had exact duplicates in the assembled chromosome or unplaced scaffolds. a full list of duplicated annotations is found in additional file
1: table s <dig>  note that, all copies of duplicated genes are used in the remaining analysis as it raises problems with the statistics when the genomic context is different between two copies. for example one copy may be conserved in another organism, while the other is not.

general synteny analysis of the pig annotation
to further enhance the annotation we performed a general analysis of the conservation of the structured rna loci. the full benefit of this analysis is only obtained when we have a good annotation of structured rnas in the query organism. special emphasis is therefore put on the pig/human conservation of the annotation.

we analyzed the synteny of the structured rna annotation using the pairwise alignments is to check the coverage of a given annotation by transferring the coordinates to the target species using the pairwise alignment . however, since the alignments are single best coverage of pig, but may be multiple coverage of the target genome in some region, the annotation will in some cases be matched with a paralogous sequence in the target genome. this problem is to some degree mitigated by using the cleaned-up pairwise alignments described above, which should reduce the coverage of paralogous alignments.

to annotate the rnas in the non-pig organisms, each annotation is located in the pairwise alignment and the per-base identity is calculated. in table
 <dig> we list the loci that are conserved in human  and in depth in the phylogenetic tree . we have chosen 80% sequence identity as a cutoff for conservation between pig and other organisms. this choice is based on our experiences with the conservation of mirnas between pig and human . in general, deciding on such a cutoff is difficult if not impossible, and should depend on the class of the rna annotation as well as the phylogenetic distance between the two organisms.

genic context of the annotations
another important characteristic of the ncrna annotations is their contexts of protein coding genes. we therefore marked the annotations with genic context as either utr, coding-exonic or intronic using the coding genes from ensembl version  <dig>  annotations overlapping a coding gene were marked as having a) coding-exon context if at least 50% of the annotation overlapped with a coding exon or b) 5’ or 3’ utr context if the annotation overlapped with a non-coding exon. if an exon was marked as both coding and non-coding for different transcripts, the coding-exonic context was preferred. when an annotation is close to more than one protein coding gene all genic context designations are kept. we also look for proteins coding genes  <dig>  nucleotides up or down stream of the annotation . a summary of the genic contexts for the different rna classes are shown in additional file
1: table s <dig> 

note that the protein annotation of the pig genome is at an early stage and is further made difficult by incorrect ordering and strand assignment of the contigs of the pig genome hinted at in the section about the human/pig pairwise alignment. also the utrs of are not always well-defined or even known. therefore the assignment of context as coding-exonic, utr, or intronic will in some cases be immature or even incorrect.

we will touch upon the genic context again when analyzing conservation of contexts for particular classes of structured rnas, e.g. cis-regulatory elements and snornas.

clustering of the annotations
certain structured rnas are known to form clusters based on genomic position. examples include, mirna clusters, snornas spliced from itrons, clusters of trnas and clusters of cis-regulatory elements, e.g. iron response elements .

all pairs of high confident annotations less than  <dig>  nt apart on the same strand, were used to form clusters by single linkage. the distribution of the cluster size is shown in additional file
1: figure s <dig>  the cutoff of  <dig>  was chosen in accordance with the cutoff used by mirbase for the clustering of mirnas. we found  <dig> clusters of which  <dig> contained at least three mirnas. a number of large snorna clusters were also observed. detailed examples of the clusters are given in later sections for mirnas, and snornas. in additional file
1: table s <dig> the number of rnas in different classes and different clustering distances is shown.

de novoprediction of structurally conserved rnas
when novel structural rnas in e.g., utrs are predicted by computational methods or by experiments, structural conservation may help the experimentalist in asserting their validity and phylogenetic domain. we therefore predicted de novo structured rnas in the pig genome using rnaz and the maf blocks of the multiple alignment of pig against  <dig> other vertebrate genomes. details are in the methods section, including a discussion of false positive rates of rnaz.

we found  <dig>  strand specific structurally conserved loci with a p-score cutoff of  <dig> , which could be merged to  <dig>  conserved loci when the strand prediction of rnaz was ignored. additional file
1: table s <dig> shows the overall statistics of the rnaz hits. the rnaz predictions were assigned genic contexts according to the same criteria as for the homology based annotations. most of the rnaz predictions were found in intergenic regions  or were intronic ; however a small number are found to be overlapping with exons of protein coding genes  or near the beginning or the end of protein coding transcripts  and  respectively, 7% lie in the context of multiple genes, and their gene context is undecided.

the annotations of the pipeline were marked as structurally conserved, if there was an overlap of at least  <dig> nt to an rnaz loci irrespective of strand. the results are show in table
 <dig>   <dig> of the high confident annotations were found to overlap with rnaz loci and as expected the highly structured mirna has the highest recovery rate in the rnaz results. it is, however, somewhat lower than one might have expected when table
 <dig> is compared to table
 <dig>  which shows the statistics of rnas conserved in genomic location. for example, based on the pairwise alignments 90% of the high confident mirna candidates obtained by sequence homology are conserved in genomic position in at least  <dig> organisms including pig, which is included in the pig-centered alignments by default. however, rnaz only predicts 62% to be structurally conserved. this is not necessarily a flaw in rnaz, but more likely in the multiple alignment maf blocks. for example, mir-30e is found to be conserved in  <dig> of the  <dig> species but is not confirmed with rnaz. examination of the sequences shows that mir-30e is partially sequenced in the tenrec genome, which breaks the multiple alignment maf block and thereby prohibits the rnaz prediction. repairing the maf blocks on a genome wide scale would in principle be possible. it is however, not straightforward and is outside of the scope of the present study.table  <dig> 
overlap of the
rnaz
predicted
de novo
with the high confident annotation


comparison of the strand specific rnaz results with the result of the automatic annotation pipeline. the columns are, rna class, # rna families in the high confident annotation, # rna loci in the high confident annotation, # rna families that overlap with the rnaz predictions, # rna loci that overlap with the rnaz predictions.



as a final remark, it is noteworthy that while around 65% of the mirnas obtained by similarity search are overlapping with rnaz loci, the same is only true for around 10% of the novel mirnas. 16% are conserved in  <dig> organisms and  <dig> or 6% appear to be conserved in human and may thus represent mirnas in human yet to be discovered.

lineage specific structured rna loci
the lineage specific structured rnas are important for the pig, both for the understanding of pig specific traits and when considering the pig as model organism as these can help pointing towards potential concerns in some pathway modelling.. we therefore investigated the lineage specificity of structured rnas inside and outside of the laurasiatheria .

the bulk part of the structured rnas obtained here were found by homology search, and will therefore not be pig specific. however, the de novo rnas may be lineage specific and both homology and de novo based annotations may be found in lineage specific loci, that is loci preserved only in a branch of the phylogenetic tree. our search will therefore initially focus upon lineage specific regions in the pig genome.

in general, determining lineage specific rnas is non-trivial since it require clear annotation in one or several closely related organisms, however, at some cutoff the annotation is not to be found in organisms outside the organism or the closely related organisms. furthermore, determining the lineage specific annotations might be impacted by the lack of genomic coverage and the quality of the genomic sequences, as it is the case between human and neanderthal
 <cit> . the search for lineage specific structured rna is further complicated by the fact that many structured rnas can hold the same structure while being highly divergent in sequence. structural alignment of genomic sequence is in these cases required to elucidate the structural conservation e.g.,
. hence, we employ a conservative strategy where the sequences within the laurasiatherian branch should exhibit relatively high sequence identity  between all pairs of organisms considered while at the same time have relatively low sequence identity  to all organisms outside the branch.

to find lineage specific structured rnas, we calculated the sequence identity of the obtained structured rnas between pig and the organism for which we have pairwise alignments, preferably, using the synteny cleaned pairwise alignments where available. the rnaz results are particularly well suited for this analysis, since structural conservation in at least  <dig> organisms including pig is required to yield a result in the first place. in concordance with our strategy, we need to find a lower cutoff in sequence identity for the loci to be not considered with the organisms in question.

in additional file
1: figure s <dig> we plotted the number of rnaz loci grouped by a given identity cutoff outside the laurasiatherian branch . up until 30% sequence identity cutoff the number of grouped loci remains fairly constant , but from around 50% quickly increase. we therefore choose a conservative sequence identity cutoff of 30% outside the lineage, which corresponds to around  <dig> % of the rnaz loci.

in additional file
1: figure s <dig> we plot the number of rnaz loci that have at most 30% sequence identity to pig outside the lineage versus the minimum pairwise sequence identity between pig and the other species found in the pairwise alignment. the number quickly drops above 60% sequence identity and we therefore decide on a cutoff of 60% and reach a final number of  <dig>  lineage specific loci containing rnaz predictions.

the high confident annotation was investigated for lineage specificity by the same criteria, however, only the annotations with at most  <dig> occurrences in the genome were investigated, as highly repetitive sequences are often skipped in the alignments. furthermore, annotations with exact duplicates in the genome and annotations found in the unplaced scaffolds were excluded as well. with these criteria, we found  <dig> lineage or pig specific structured rna loci on the assembled chromosomes within the high confident annotation shown in additional file
1: table s <dig>  these are mirnas mir- <dig> and mir- <dig>  four de novo mirnas,  <dig> snornas and one vault rna. only four of these are conserved in other species within the lineage, three haca box snornas  and one known mirna , specific for the cow/pig/dolphin part of the tree. the vault rna found on chromosome x is likely a pseudogene since it lacks a polii promoter sequence. it does, however, score very high according to infernal . for further discussion about the vault rnas see the section curation based on the detection of polii and poliii promoter sequences. one mirna, mir- <dig>  is previously known only for rodents, and could also be a mis-annotation induced by the otherwise strict filtering of the blast results.

lineage specific ncrnas is still a relatively unexplored area, which is expected to grow as more analysis is performed on new genomes and organisms. mirnas are one class of ncrnas where lineage specific ncrnas have been discovered in pig, but more classes are expected to follow when the tools for novel ncrna detection in small rna-seq data are developed further.

mirnas in the pig genome
in this and the following sections we discuss the curation of the structured rna annotation utilizing the different types of contexts added to the annotation in the preceding sections. we begin with the mirnas in pig and the synteny between pig and human mirnas, which in conclusion will allow us to curate the  <dig> mirna genes that were found to be part of mirna clusters common to human and pig.

the high confident homology pipeline provided  <dig> mirna loci and the mirdeep pipeline adds an additional  <dig> de novo mirna loci for a total of  <dig> mirna loci.  <dig> of the mirdeep loci where renamed and reclassified by homology to human or by low confident  sequence identity to sequences from mirbase. see also additional file
 <dig> 

mirna clusters are known for a number of organisms. in the analysis of the pig genome we observed  <dig> mirna clusters, i.e. multiple mirna loci within  <dig>  nucleotides of each other, all on the same strand. in certain cases, mirnas in clusters are found like pearls on a string. in the pig genome we found  <dig> mirna clusters with at least three mirnas.  <dig> had a cluster size of up to around  <dig> nucleotides per mirna, while the last  <dig> had sizes of approximately  <dig> - <dig>  nucleotides per mirna.

in comparison to the  <dig> pig mirna clusters, a total of  <dig> of strand specific mirna clusters are known in the human genome according to mirbase version  <dig>  in the following, we have analyzed how many of these mirna clusters were conserved in human using a combination of blast, and the genome scale pairwise alignments between the two organisms.

mirnas are often well conserved between mammalian genomes, however, a simple blast of the mirnas will either include too many false positives or occlude the more distant homologs. in additional file
1: figure s <dig> we have plotted the conservation in pig of the  <dig>  human mirna loci from mirbase  <dig> using the genome scale human-pig pairwise alignment. from the figure we conclude that there is no clear indication of a identity cutoff where a mirna may be said to be conserved between human and pig. however, if we restrict the plot to the mirnas from human mirna clusters  a steep drop-off in the number of conserved mirnas is observed at around 80–90% identity. throughout the paper, we will use a cutoff of 80% sequence identity in the pairwise alignments to accept conservation between pig and human. this results in a total of  <dig> mirnas from the human mirna clusters that are considered conserved in pig. these form  <dig> clusters in pig, which again contains  <dig> mirnas, i.e.,  <dig> mirnas are conserved, but no longer a part of a mirna cluster in pig at this cutoff level.

the  <dig> mirna clusters from human with at least  <dig> mirnas are shown in additional file
1: table s <dig>  in the following, we discuss the conservation of these clusters in pig.

the mir- <dig> cluster is known to be primate specific according to mirbase, and we see no evidence to the contrary. the mir- <dig> cluster is incomplete in pig , where it is found in an unplaced scaffold in pig missing part of the sequence. a similar issue is seen with the mir- <dig> cluster. the mir- <dig> cluster appear to be broken in pig. most of the mirnas are found in a cluster on chromosome  <dig>  however they are located on both strands . the cow, dolphin and horse genomes, which are phylogentically close to the pig genome, all harbors near complete mir- <dig> clusters, so this is likely an assembly issue in pig.

a more difficult case is the mir- <dig> cluster located on chrx in human , which contains  <dig> known mirnas from mirbase: mir- <dig>  mir- <dig>  mir-500a, mir- <dig>  mir- <dig>  mir-500b, mir- <dig>  mir- <dig>  in pig we found a cluster on chrx of mir- <dig>  mir- <dig>  mir- <dig>  mir- <dig>  mir- <dig>  mir- <dig>  and a mature unknown mirna picked up by mirdeep. investigation of the human-pig alignment revealed that mir- <dig> is poorly conserved with a pairwise identity of 57%, while the unknown mirna picked up by mirdeep is mir- <dig> with a pairwise identity to human of 87%. mir- <dig> is also poorly conserved in cow , but somewhat better in horse .

the mir- <dig> and mir- <dig> clusters are well conserved and supported by reads . in the mir- <dig> cluster only  <dig> of the  <dig> mirnas are identified by high confident blast, however, the cluster appears complete in the pairwise alignment .

the mir-513a and mir-514b clusters are incomplete in the pig genome , leading to several problems in the pairwise alignments. three mirnas are observed in the mirdeep analysis of these clusters, which may be assigned as mir- <dig>  mir- <dig> and likely mir- <dig> 

the mir-450b cluster is incomplete in the assembly, but the mirnas that we find are supported by blast and reads . mir- <dig> found on the opposite strand of the cluster is obtained by sequence similarity from cow.

the cluster containing mir-892c appear at first glance to be missing in pig. however, the six mirnas in the mir- <dig> cluster on chrx in human, are conserved in a cluster on chrx in pig . the pairwise identities between the human and pig mirnas in this cluster are in the 55–70% range and are thus under the cutoff chosen above. the mir-891a/b are two different loci in human but only one of them is observed in the pairwise alignments in the pig. the cluster is supported in the pig by  <dig> de novo structured rna predictions by rnaz.

in conclusion, we include the  <dig> mirna loci in the curation annotation, for which we have high confident annotation and which are are part of mirna clusters in both pig and human.

snornas in the pig genome
the conservation and curation of snornas in pig are discussed in this section. using synteny between pig and human we curated  <dig> or 42% of the snornas loci in pig.

we annotated  <dig> snorna loci  in the pig genome using a combination of blast, snostrip and infernal on snorna families from rfam.

like mirnas, snornas are often found in clusters and we identified  <dig> clusters containing multiple snornas within a distance  <dig>  nt. in two particular cases large snorna clusters identify snorna host genes in pig, which are at present missing from the ensembl annotation. in human these two transcripts, called snhg <dig> and gas <dig>  are known to harbour a number of snorna. the human version of snhg <dig> harbours snord <dig>  snord <dig>  snord <dig>  snord <dig>  snord <dig>  snord <dig>  snord <dig>  snord <dig>  and the same genes in the same order are observed in pig. gas <dig>  similarly displays exactly the same genes in human and pig. the  <dig> snornas contained in these two host genes were curated based on this information.

the snorna database contains a set of curated human snornas. using the syntenic pairwise alignments between human and pig, we manually inspected the auto generated snorna annotations. we obtained the human coordinates for the pig snornas and calculated the coverage using the methods explained in the synteny section above. we filtered the results by 60% sequence identity between human and pig and considered the coordinates of the curated human snornas from the snorna database. in total we curated  <dig> loci, corresponding to  <dig> snorna families. the  <dig> non-curated members of these families were marked as pseudogenes. while the cutoff for sequence identity is 60%, all curated members were found to have a sequence identity above 70% between pig and human. it is noteworthy that only  <dig>  of the curated snornas are found with high confident blast.

this kind of synteny analysis limit ourselves to known genes in other organisms, here human. as an example we find  <dig> copies of snord <dig> in pig. a closer inspection, however, reveals that  <dig> of them have exact copies close to each other. these copies are likely to be the result of incorrect assembly. we thus find two snord <dig> clusters in pig, one with two members and one with three members, all scoring about equally well with infernal. in human we find only two curated copies in the snorna database, which we are able to match and curate in pig using synteny. however, a full infernal search reveals a total of  <dig> copies in human all scoring about equally well. and these form two clusters with  <dig> and  <dig> members, respectively, each cluster syntenic to those in pig.

in summary, we curated 42% of the snornas in pig. however, it is expected that more snorna genes may be curated as the snorna discovery methods improve.

ribosomal rna clusters in the pig genome
the ribosomal rnas  are known to have a number of pseudogenes in the mammalian genomes, often only as part of the full length rrna genes. for the rrnas we only found one full length copy of the rrna cluster. on chromosome  <dig> we found 28s, 18s, and  <dig> s clustered closely together, and the finding is further confirmed by the existence of a prna locus upstream of the 28s locus on chromosome  <dig>  ribosomal rnas part of this cluster are curated, all other rrnas are marked as pseudogenes.

cis-regulatory elements in the pig genome
the cis-regulatory elements are regions of the rna  that regulate genes on the same chromosome, often on the same transcript or located relatively close up- or down-stream. here, we only annotate those cis-regulatory elements that have rna structure as extracted from rfam. the genic context of the annotated cis-regulatory elements allowed us to curate 66% of them. for the remaining 34% the genic context could not be ascertained and the cis regulatory elements were marked as pseudogenes.

normally close proximity between the cis-regulatory element and the gene is observed. accordingly, the genic context of the cis-regulatory elements are of particular interest. as expected, we found that most of the annotated cis-regulatory elements are close to or overlapping with protein coding genes. only  <dig> of the total  <dig> cis-regulatory elements are more than  <dig>  nucleotides away from a protein coding gene, while  <dig> are between  <dig>  and  <dig>  nucleotides away. of these  <dig> cis-regulatory elements  <dig> belong to the ubiquitous gp_knot <dig> family.  <dig>  nucleotides is therefore chosen as the cutoff for the curation procedure of the cis-regulatory elements. of the  <dig> annotated cis-regulatory elements,  <dig> cis-regulatory elements are found to be antisense to protein coding genes. however closer inspection reveal all but two to be sense to a protein coding gene as well. many of the intergenic cis-regulatory elements are found to be from highly repetitive families like gp_knot <dig> and ire, while others are very confident and highly specific like e.g., secis- <dig> and ires-c-sis. only detailed analysis can reveal if these are true positives where the corresponding protein coding gene is undetected by for what ever reason.

in all  <dig>  cis-regulatory-element loci were curated based on having sense genic context within  <dig>  nucleotides.  <dig> cis-regulatory elements more than  <dig>  nucleotides away from a protein were marked as pseudogenes.

as a final remark, the annotation of protein coding genes in the pig genome is at an early stage and is further complicated by the incorrect ordering and strand of the pig genome contigs. therefore, we are unable to curate the cis-regulatory elements according to their exact genic contexts , and just note in passing that certain elements are expected to have certain contexts, e.g., ires are supposed to be part of the utrs, and we were not always able to confirm this.

curation based on the detection of polii and poliii promoter sequences
in the preceding sections we presented the curation of specific classes of structured rnas. we now present a more general class of ncrnas, namely those where active genes are expected to have polii or poliii promoter sequences. this class includes ncrnas such as snrnas, vault rna, rnasemrp, and y rnas.

a number of ncrnas may be curated based on the presence of polii/poliii promoter sequences. for this we used position weight matrices  extracted from human sequences to detect polii- and poliii-specific sequence elements derived from known human polii and poliii transcripts . based on the poliii-pwm, a total of  <dig> out of the  <dig> u <dig> candidates returned by the infernal/rfam search, were selected. among these  <dig> are found to be well conserved in the same genomic location in other species, and  <dig> are located in introns. single instances of u6atac, rnasemrp, rnasep_nuc were similarly found. finally even though two 7sk were found to have satisfactory tata-boxes and proximal sequence elements , only one sequence was highly similar to other mammalian 7sk sequences.

for snrnas,  <dig> u <dig>   <dig> u <dig>   <dig> u <dig>   <dig> u <dig>   <dig> u <dig>   <dig> u <dig>   <dig> u <dig>   <dig> u <dig>   <dig> u <dig> and  <dig> u <dig> were found to have polii promoters sequences. in case of u4atac, the pseb and psea segments were spatially inverted, i.e. pseb was located upstream of psea. still, due to the high conservation of u4atac in all other mammals, u4atac was kept in the annotation.

the structure based homology search picks up  <dig> vault rnas. two copies on chromosome  <dig> where one is an active copy with a degraded copy nearby conserved in pig, cattle, and dolphin . it appears to be a common thread amongst the species within the laurasiatherian lineage that only one good copy of the vault rna gene exists within the vault rna cluster, unlike the one in human which feature  <dig> good copies . a high scoring pseudogene is found on chromosome x, in pig, as well as human. a lower scoring vault rna is found on chromosome x in cow, and possibly in dolphin, however in the latter the genome is not assembled on chromosomes. note that these pseudogenic copies on chromosome x cannot be related through the genome wise pairwise alignments.

y rnas are pol-iii transcripts with the canonical copies transcribed from a single gene cluster, see
 <cit> . we find  <dig> y rnas in the pig genome using structure based homology search.  <dig> are low-scoring and are scattered over the genome. in most mammalian genomes they are accompanied by a large number of retro-pseudogenes
 <cit> . in the pig these numbers are relatively small .

the pig genome harbours a complete y rna cluster: the arrangement on pig chromosome  <dig> y <dig>  y <dig>  y <dig>  y <dig> conforms to the ancestral eutherian prototype . it is unclear, however, whether the y <dig> locus is still functional in the pig genome or already a pseudogenized remnant. the divergence from the human sequence is much higher than that of the other three pig y rnas, indicating a drastic reduction of stabilizing selection: y <dig>  <dig> %, y <dig>  <dig> % y <dig>  <dig> % y <dig>  <dig> % based on ucsc browser repeat annotation. this is to be compared with the situation in cow and dolphin were y <dig> is deteriorated to a degree were it is almost certainly non-functional. to further test this we tested the y rnas with cmalign for all seven organisms including pig where the pairwise alignment points to complete y rna clusters. the seven organisms are pig, cow, dolphin, horse, dog, human and rabbit. alignment to the covariance model  clearly shows that y <dig> and y <dig> fits the model consistently in all organisms, while the y <dig> and y <dig> rnas are all somewhat divergent in the pig/cow/dolphin part of the tree. however, only the cow and dolphin y <dig> rnas scores badly in the rfam y rna model. the y rna alignments in stockholm format are available on the website of this paper.

this section concludes the discussion about specific classes of structured rnas and the curation of these rnas. we proceed with a summary of the complete curated annotation

curated annotation
the high confident annotation is a combination of the results of the high confident homology pipeline and the mirdeep detected mirna candidates. we obtained a total of  <dig>  high confident loci . using a variety of methods presented above we were able to curate 13% of the annotated rna loci while 37% of the annotations are marked as pseudogenes. pseudogenes are either ncrnas expected, but failing, to be polii or poliii transcripts, cis-regulatory elements not in the vicinity of annotated protein coding genes, or ribosomal rnas not part of the cluster on chromosome  <dig> table  <dig> 
curated annotation


the high confident annotation is a combination of the results of the high confident homology pipeline and the mirdeep results. see table
 <dig> for row labels. column labels: high confident is the high confident annotation prior to curation; curated are the number of loci curated by methods explained in the text; pseudogenes are the loci expected to be polii/poliii transcript, but failing to be so, ribosomal rnas not part of the cluster on chromosome  <dig>  and cis-regulatory elements without gene context. in the column overlaps to structured rna loci annotated by homology as well as putative mirnas are given. curated annotation contains loci that are a) curated or b) loci not tested in the curation procedure, e.g., mirna loci. high confident: is the complete high confident annotation .  <dig> mirnas detected by mirdeep, but not by high confident blast where re-annotated in the section mirnas in the pig genome. a table with the  <dig>  medium confident loci and  <dig>  low confident loci are found in additional file
1: table s <dig> 



the curated annotation presented in table
 <dig> contains the  <dig> genes that passed the curation procedures presented in the preceding sections. the same curation procedures marked  <dig>  ncrna genes as pseudogenes. the curated annotation represents a substantial manual annotation effort, which considered several aspects of the different classes of structured rnas discussed in the previous sections, including the context of protein coding genes, clustering of neighbouring rna loci, synteny, as well as sequence and structural conservation of the annotation in other organisms. the curated structured rnas are clearly those that comes with the highest certainty, however, fields such as small rna-seq, will benefit from the high confident annotation, and in some cases even from the medium or low confident annotations.

discussion
annotating genomes for functional elements is in general a non-trivial problem, in particular, if this is considered to include full functional annotation. a recent conservative effort to characterize proteins, charprotdb, contains only  <dig> human entries
 <cit> , approximately one percent of the total number of protein coding genes. clearly the use of sequence homology to screen the genome for known sequences is useful. however, in contrast to protein coding genes, search for structured rnas is a much harder task, partly due to the long ranging interactions in rna  structure.

other protocols for annotating ncrna exists, such as rnaspace, but it is not feasible for full genome-wide analysis of a mammalian genome
 <cit> .

our pipeline utilized sequence and structure homology search, small rna-seq and de novo rna structure prediction in genomic sequence. we obtained high confident annotation of  <dig>  structured rnas distributed over  <dig>   ncrna genes,  <dig> conflict loci,  <dig> cis-regulatory elements, as well as  <dig> lncrna loci. the  <dig> conflict loci are all identified as very good matches to either snornas, to srp rnas or to the rrna subunit 28s. however, part of these rna sequences have been identified as mirnas in other studies and added to mirbase. deciding if the  <dig> conflict rnas can also serve as mirnas is outside the scope of this study. we chose to keep these annotations as high confident as we have no doubt about their annotation, only their possible function as mirnas are yet to be determined. note, that  <dig> of the conflicts are also annotated as conflicts between snornas and mirnas in human or mouse;  <dig> conflicts are found by high confident blast to be between mirnas and seed members of the srp rna family; and the annotation of 28s is beyond dispute as it is part of a full rrna cluster. this leaves  <dig> conflicts unaccounted for, which are the results of more recent additions to mirbase from organisms besides mouse and human.

we found  <dig> mirna loci from  <dig> different  mirnas precursor sequences, of which  <dig> were annotated for pig already.  <dig> are so far annotated only in pig, however, only  <dig> appear to be confined to the laurasiatheria,  <dig> found only in pig and one specific to the cow/pig/dolphin part of the tree.

the sequence based part of the pipeline complete the highly conservative part of the pipeline, by employing blast cutoffs of  <dig>  in e-value, 95% identity with a coverage of at least 95% coverage of the rna query sequence. correspondingly, for the infernal screen we employed only the family specific gathering score cutoffs and ran infernal directly on the genomic sequence, which is in contrast to the official rfam annotation where blast pre-filtering is performed. our infernal screened yield  <dig>  loci matches, and we found that blast filtering as well as additional infernal e-value filtering were needed to obtain confident results. our results are not directly comparable to those of rfam, because the exact filtering procedure used by rfam is unpublished and thereby not directly available for assessment.

the high confident annotation is the result of an automated pipeline, while the manual annotation is presented in the form of the curated genes. in particular the results of the infernal and snostrip results will contain pseudogenes and the infernal results may contain false positives as well. we therefore ran all tools on a local  shuffled version  of the pig genome to obtain an estimation of the false positives on random data. we found that most tools, even at their lowest confidence levels produced no results on the shuffled sequence. this includes, rnammer, trnascan-se, snostrip, and blast . the exception is infernal, which produces a high number of hits on the shuffled sequence without filtering in addition to what is offered by the family specific gathering score cutoffs. however, by introducing a global infernal e-value cutoff of 1e- <dig> in addition to the gathering score cutoff, we were able to cut the number of false positives in the shuffled data down to just one low confident hit and no high confident hits. a second potential problem using infernal is the possibility for incorrect family assignment . however, with zero conflicts in the high confident infernal results on the unshuffled data and only  <dig> within the low confident results, this appears not to be a problem with infernal used as we do here.

this work represents a substantial computational effort. while most of the annotation tools, and the post processing could be run for the whole genome on a fast stand-alone workstation, two major parts of the pipeline precludes this. firstly, running infernal for all rfam models takes around  <dig> cpu years. secondly, the pairwise alignments take in the order of  <dig> cpu year per genome we aligned against the pig genome. infernal has recently achieved a substantial speed up by taking full advantage of the recent developments in the hmm’er code
 <cit> . the improved hmm’er filtering will hopefully replace the need for blast filtering of the infernal results since a much better false discovery rate is reported in the cited paper. however, we will have to wait for a later version of the rfam database as even the latest version  is constructed with infernal version  <dig> . <dig>  with the improved infernal code the annotation part of the pipeline could be run on a normal workstation within a few weeks. however, the pairwise and multiple alignments, and thereby the synteny analysis will still require access to a high-performance computing cluster.

to further ensure confidence, we manually or semi-automatically inspected a selected subset of the  <dig>  annotated rna loci to reach a total of  <dig> curated structured rna and  <dig>  pseudogenes. one class of genes inspected was y rnas for which the inspection gave rise to the observation that the y <dig> loci, in contrast to the others, already might have mutated into a non-functional state.

ensembl version  <dig> provides ncrna annotation for the pig genome as part of their annotation pipeline. ensembl version  <dig> contains  <dig>  structured rna loci for the pig genome divided on rrnas, mirnas, misc-rnas, snornas and snrnas. of the  <dig>  high confident annotations obtained by our homology search only  <dig>  are present in the ensembl annotation. in particular all trnas are missing entirely or are annotated as mirnas, though the basis for annotation is unclear to us. likewise the cis-regulatory elements are missing completely from the ensembl annotation. in the other end of the spectrum, we find that  <dig> of the  <dig>  ensembl annotations are not found in the low confident annotation. the ncrnas found extra in the ensembl annotation are in most cases mirnas without an assigned gene name, indicating that they are probably low confident mirnas from rfam. a comparison of the two annotations is found in see additional file
1: table s <dig> 

to further search for de novo rna structures we employed rnaz
 <cit> . rnaz uses a sliding window based approach which chop out sections  of multiple  alignments and measure the structure potential over a background in that window. a main concern is the input multiz maf blocks, which are typically used as outset. the more organisms the maf blocks contain, the more fragmented they become and the input space is not covered optimally. another concern is the heterogeneous distribution of the evolutionary distances between the organisms in the alignments. ideally rnaz should be fed with equally distanced organisms. the rnaz search provided  <dig>  structurally conserved rna loci of which  <dig> overlapped with the high confident homology based annotation or novel mirnas. the class best covered by rnaz loci were the mirnas, where 65% of the loci were recovered. most rnaz loci were found in the intergenic or intronic regions, however, around 10% were found near the beginning or end of protein coding transcripts.

a second source of novel candidate rnas in pig comes from the small rna-seq data presented in this work. here, the main analysis of the sequencing data is performed with mirdeep and we therefore only annotate novel mirna candidates. however, with deepblockalign  we also found novel rna candidates in other classes of rnas, but without more computational support or experimental evidence these are not annotated with high confidence and are therefore only presented as a special track. for mirnas, the rna-seq profiles are particularly specific and the mirdba tool
 <cit>  for aligning mirna rna-seq profiles directly against a compiled database of rna-seq profiles was developed in parallel with this work. future updates will use the full potential of mirdba.

early versions of the pig genome have been investigated for ncrnas, these studies investigated a low  coverage version of the genome
 <cit>  in which  <dig> mirnas were identified and a later study investigated the pig ests
 <cit>  in which  <dig> additional mirnas not found in the previous study were identified. we confirm all these  <dig> mirnas in this paper, except for  <dig> where the sequence is missing in the current assembly of the pig genome. the study of the low coverage version of the genome did not include a search for other types of ncrnas, while the ests from the second study were selected with a bias against small ncrnas and a comparison of the obtained full ncrna annotations with the present is therefore not entirely meaningful.

here, we focused on annotating structured rnas  and we did not include lncrnas with the exception of partial lncrnas included in rfam. lncrna in contrast to the many structured rnas are just emerging and systematically characterized by genomic coordinates, e.g.,
 <cit> . these lncrnas have been obtained through comprehensive transcription studies. given that lncrnas in general are poorly conserved and similar studies have not been carried out in pig, we in this study focused on structured rna .

overall our ncrna annotation is of further interest in the light of pig as production and model animal. the known ncrnas holds potential to be studied in specific problems, where for example mapped rnas can be useful in subsequent studies, such as differential expression of ncrnas, e.g., in necrotic lung tissue
 <cit>  and skeletal muscle tissue
 <cit> . furthermore, as next generation sequencing will make it possible to increase the quality of quantitative trait loci  and genome-wide association studies, these regions can be analyzed for ncrna content. for example we considered all qtl contributing regions less than  <dig>  nt listed in the pigqtldb
 <cit>  and by fischer exact test we found  <dig> qtl regions to be enriched  with rnaz candidates  . a similar, but weaker trend is observed for a few cases when testing the enrichment for only the annotated families and classes of structured rnas.

as an example of what one can do with an ncrna annotation in relation to a larger set of genes, we analyzed the  <dig> regions of the pig genome containing olfactory receptor genes
 <cit> . the regions overlapped with  <dig> of our high confident ncrna candidates, including,  <dig> trnas,  <dig> known mirnas,  <dig> mirna predicted by mirdeep,  <dig> snornas and  <dig> cis-regulatory elements. in particular the mirnas and cis-regulatory elements could be involved in regulation of the olfactory receptor genes. the genome structure can be relevant for further studies aiming at mutually to elucidate the functionality as well as the mechanisms underlying these traits.

CONCLUSIONS
we have conducted the, to date, probably most comprehensive ncrna annotation of a mammalian genome in a single analysis, and we have obtained an extensive annotation of structured rnas in sus scrofa. we constructed a semi-automated pipeline enabling manual curation at reasonable level while also incorporating rna-seq data and including a layer of de novo rna structures. overall we annotated  <dig>  high confident structured rnas of which a subset was inspected leading to  <dig> curated annotations. in addition we found  <dig>  structurally conserved loci using rnaz, of which  <dig> overlapped with the homology based annotation or novel mirna candidates. these structured rnas constitute an essential resource for studying and generating hypothesis of genetic mechanisms underlying the various production traits. all the data resources are available at
http://rth.dk/resources/rnannotator/susscr102/version <dig> .

