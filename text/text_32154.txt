BACKGROUND
understanding the neuronal mechanisms that control motor behavior, such as locomotion, is one of the major challenges in neuroscience research. for this purpose, mice have become an important animal model mainly due to the recent advances in mouse genetics that allow the precise manipulation of the neuronal networks that underlie motor behavior  <cit> . further, these advances have resulted in a large number of mutant mice lines that model human diseases that affect motor behavior  <cit> . these advances also increase the importance of developing assays that measure motor behavior in quantitative and objective ways.

a large number of assays have been developed that allow indirect behavioral profiling of motor deficits either by manual qualitative assessments, the automatic quantification of motor activity in an open arena  <cit> , or motor performance tests scoring the execution of a specific motor task. some examples are measuring the time and number of failures an animal takes to cross a narrow beam  <cit> ; the rotarod test, which measures the time an animal can remain in a rotating cylinder  <cit> ; reaching tests, which measure manual dexterity while an animal tries to retrieve food pellets  <cit> ; or the speed and distance traveled in a stationary running wheel  <cit> . although these behavioral tests provide readouts for general motor performance, they reflect a combination of multiple deficits that cannot be teased apart post hoc and, in addition, do not provide specific information about locomotor coordination.

to analyze walking, several assays have been developed. for example, by placing reflective markers at leg joints, leblond et al. measured angular variations of leg joints during walking in a treadmill of wild-type and spinalized mice allowing a complete reconstruction of the step cycle  <cit> . the same preparation can also be combined with simultaneous electromyographic recordings , which provide a correlation between muscle activation and leg movement. although informative, this approach remains invasive and laborious while focusing on only one leg, thus precluding the extraction of additional gait features. gait analysis is frequently achieved using the footprint test, in which the paws are coated with ink and the animal is allowed to walk over a sheet of white paper to generate a footprint pattern  <cit> . these patterns can be further analyzed for several static step parameters including stride length, feet support or footprint spread. however, this test fails to provide dynamic parameters of locomotion such as the duration of the step cycle or inter-leg coordination. such parameters could be acquired by recording videos of rodents as they walk on a transparent surface, followed by a frame-by-frame analysis. however, this is a very labor-intensive approach and prone to errors due to the ambiguous transition between the swing and stance phases. to overcome this obstacle, hamers and colleagues developed a quantitative gait analysis assay using an optical touch sensor based on frustrated total internal reflection , which records and tracks the footprints of rodents as they move in a walkway  <cit> . this approach has the additional advantage of not depending on any markers within the animal’s body that could interfere with the locomotion pattern. this method was later made available commercially  <cit> . however, the associated analysis software packages only monitor footprints and do not have the flexibility to allow users to extract additional and unanticipated metrics. moreover, these systems are very costly, deterring individual laboratories from acquiring them.

sophisticated machine vision algorithms that provide increased temporal and spatial resolution have also been developed . these methods allow the extraction of detailed data sets and provide a powerful, unbiased and quantitative description of animal behavior. however, they lack the resolution to provide a quantitative measure of gait and other kinematic features.

to accommodate the need for an improved method to analyze locomotion in the mouse, we describe a simplified and inexpensive ftir setup combined with an open-source and user-friendly software package. using this system, which we called mousewalker, we extracted a large set of kinematic parameters from freely walking wild-type animals, including step patterns, footprint positioning, inter-leg coordination, and footprint contact parameters.

RESULTS
mousewalker
we previously described an approach to track and quantify kinematic properties of untethered walking fruit flies  <cit> . using this approach we quantitatively described the walking behavior of wild-type and genetically modified animals  <cit> . this method is based on the reflection of light within a transparent material through an optical effect termed total internal reflection  <cit> . foot contacts disrupt this effect causing ftir, which generates scattered light that can be detected by a high-speed video camera . we built a simple walking apparatus from readily available and inexpensive supplies , mostly precut acrylic glass and aluminum components , in which the rodents can walk freely down a narrow corridor. the floor is of acrylic glass surrounded by led lights, thus producing a touch sensor . empirically, we found that an acrylic glass surface resulted in a better ftir signal-to-noise ratio compared to glass, possibly due to a rougher surface thus allowing more contact between the animal’s paws and the walking surface. although acrylic glass scratches more easily than glass, thus interfering with the fitr signal and subsequent tracking, it can be easily replaced. a light box positioned above the walking apparatus allows the outline of the mouse body to be visualized as the animal moves along the walkway . finally, a mirror placed at 45° below the walking surface reflects the ftir signal and body outline, allowing them to be captured by a high-speed camera . depending on the type of camera available and color of the leds and light box, the setup can generate monochromatic or color videos .fig.  <dig> optical footprint detection system. a schematic of the ftir effect. led light sources are located at the edges of a piece of acrylic glass and light propagates within the glass via internal reflection. footprints disrupt this optical effect leading to the light scattering, which is detected by a high-speed camera. single frame of an ftir video in black and white  and color . the ftir effect is visible while the legs are in contact with the acrylic glass surface during the stance phase. background light allows detection of body contour



recorded videos are loaded into a program developed specifically for this assay . the mousewalker software was written in matlab and compiled as a standalone program, which analyzes the sequence of images from the videos by registering the position of the body, tail, and each footprint . each video is loaded into the graphics user interface  of the program where the auto-tracking feature can identify each footprint, body contour, and position of the tail, with an accuracy > <dig> %, depending on the acquisition conditions and settings. footprints and body contours are identified based on pixel intensity thresholds defined by the user in a dedicated settings window, which can be determined in a few minutes by an experienced user with the help of a preview section or by auto-tracking for a few frames . optimal settings can be stored for subsequent movies. importantly, since the program can discriminate between red, green, and blue inputs, body elements can be identified based on color . subsequently, the user can manually edit any mislabeled footprints or body features if necessary. in addition, the user can toggle between different visualization modes , which help in setting the parameters and accurately editing the video. these are particularly important in identifying the footprint contacts and body. most importantly, the user interface allows the generation of a set of output files , including an excel file containing > <dig> quantifiable parameters  and an annotated video . the system is flexible in that add-on scripts can be written to extract additional parameters from the matlab tracks or excel files.fig.  <dig> mousewalker software interface. a program layout. videos are loaded, automatically tracked, and edited in a single window. a' settings window provides detection and display options. visualization options: tracking can be visualized simultaneously with the original video , with only the footprints , with only the body contour , or none of these 



walking by wild-type mice
as a proof of principle, we examined the walking behavior of a laboratory wild-type c57bl/6j strain moving across an 80-cm-long walkway. we collected  <dig> videos from four animals and analyzed the data as they moved continuously in the center  <dig> cm of the walkway.

the footprint test is a common qualitative readout that displays the footprint pattern and footprint contacts, potentially highlighting gait abnormalities  <cit> . mousewalker can generate such a readout displaying the footprint pattern generated by the walking animal in addition to the path created by the body center . footprints are converted to heat maps, as determined by the intensities of the ftir signal, which are proportional to the pressure applied. using a proper calibration procedure where, for example, all four paws are in contact with the acrylic surface while the animal is immobile, the user can quantify the pressure. our data set displays the typical wild-type pattern with evenly spaced steps. hind paw placement partially overlaps the previous forepaw placement, although offset at slightly lateral positions. since this footprint overlap makes leg identification more challenging, an additional footprint pattern is generated where pixel intensity is eliminated by a leg-specific color code, allowing the unambiguous identification of the footprints from each leg .fig.  <dig> footprint analysis tools and step parameters. a complete footprint pattern. a heat map represents pixel intensity and the horizontal line represents the body path. a' individual feet are labeled with different colors: the left fore, left hind, right fore, and right hind legs are represented in yellow, blue, orange, and green, respectively. b stance phase dynamics. each row shows successive frames for a single stance phase. all four legs are represented, top to bottom: left fore , left hind , right fore , and right hind . stance initiation is to the left and each frame is  <dig> ms apart. white bar,  <dig> cm scale. c individual full stance footprint. each footprint is individually represented by a pixel intensity heat map. a pixel to centimeter conversion allows the user to measure changes in toe spreading for each footprint . d–g step parameters as a function of speed. graphical fits are included. x-axis error bars represent standard deviations of the average speed. d step length increases with speed. e swing and stance phase durations are inversely proportional to speed. f duty factor decreases with speed. linear regression line  determines that for speeds faster then  <dig>  cm/s , the duty factor falls below  <dig>  , which confines the transition from a walk to a run-like gait. g swing speed increases linearly with speed



because video acquisition is carried out at a high temporal resolution of  <dig> hz, a series of frames spanning an entire stance phase can be generated. the data extracted from this series are referred to as footprint dynamics. at  <dig> hz, we observed that the initial contact with the surface at touchdown is typically done with the entire paw touching the surface almost simultaneously, with most of the pressure exerted by the metatarsal and metacarpal pads on the hind and fore legs, respectively . this characteristic is distinct from human walking, where stance phases begin with contact by the heel  <cit> , or the cat, where contact is initiated by the most rostral section of the paw  <cit> . during the stance phase in the mouse, pressure is gradually transferred rostrally to the toes prior to liftoff . the time spent when the stance phase was supported by the toes can be up to one-third of the entire stance phase . visual inspection of the complete data set suggests that this behavior is independent of the walking speed .

the mousewalker program also compiles the complete set of footprints present in each video . we observed that at the end of the swing phase, just prior to touchdown, the toes changed their conformation from a closed to an actively open conformation . this behavior occurs typically 20– <dig> ms before contact with the ground, indicating that it is under active neuronal control. consistent with this notion, toe spreading has been used as a metric to study sciatic nerve function . due to the orientation of the footprints relative to the displacement axis, automatic quantification of toe spreading can be prone to errors. nevertheless, each set of images generated by mousewalker is provided with a scale calibration, allowing the user to measure distances easily and accurately using imagej from the national institutes of health  or similar software.

we also quantified several gait parameters as a function of walking speed . we observed that faster animals display ~ <dig> % longer step strides, changing from ~ <dig> mm in slower animals to ~ <dig> mm in faster animals . a much larger variation was observed in stance phase duration , with values becoming exponentially shorter as speed increases, with a minimum of approximately  <dig> ms for the fastest animals. swing duration exhibits a much smaller variation as observed in other experimental conditions  <cit> . although a similar variation is observed in invertebrate systems, stance phases last longer than swing phases at all speeds  <cit> . in contrast, in our data set, we observed that above ~ <dig> cm/s, swing duration is longer than stance phase duration, consistent with recent results  <cit> . we also used these data to measure the duty factor, defined as the fraction of the step cycle where the leg is in the stance phase   <cit> . this parameter has been used to distinguish walks from runs, as values ≥ <dig>  are described as walks, while values below  <dig>  are considered runs  <cit> . from our data, we find that swing duration surpasses stance duration at a duty factor of  <dig> , which corresponds to a speed of  <dig>  cm/s . above this speed, the feet spend on average more time in the swing phase than in the stance phase, which is typical of running  <cit> . accordingly, swing speeds also increase with increased speed .

our mousewalker software tracks not only footprints but also body features. despite some tracking inaccuracies of the body center and footprint center, these measurements allow the stance phase of each leg to be reconstructed as it is anchored at the floor relative to the body . thus, each stance trace reflects the amount of body wobble during stance phases. each stance trace is normalized to body length to account for variations in body size and is defined as the position of the foot relative to the center of the body from paw touchdown  to the end of the stance phase   <cit> . regardless of the speed, stance traces run parallel to the body axis with the forelegs positioned more medially . a measure of the straightness of the stance traces, the stance linearity index, is calculated by computing the average difference between the actual stance trace and a smoothed version of the trace  <cit> . similarly to what was observed for the fruit fly drosophila melanogaster, stance traces become straighter as speed increases . in addition, we also measured the variability in the aep and pep coordinates for all steps in each video . this parameter, termed footprint clustering, corresponds to the standard deviation of the average aep and pep coordinates for each video  <cit> . thus a smaller value for this parameter corresponds to a more consistent position for paw touchdown or takeoff . as with drosophila, we observed smaller footprint clustering values for aep compared to pep, indicating a more consistent foot placement at the onset of the stance phase, possibly due to tighter motor control. in contrast to the fly, where faster animals had smaller footprint clustering values, there was little dependence on speed for this parameter in the mouse  <cit> .fig.  <dig> stance traces and inter-leg coordination parameters. a stance traces. representative plot of an animal walking at  <dig>  cm/s. traces are generated by the position of the stance phase footprints relative to the body center . for each leg, stance onset corresponds to the anterior extreme position  while stance offset is termed the posterior extreme position . b stance linearity index decreases as a function of speed. each data point measures the average jitter of the stance traces for all the legs. x-axis error bars represent standard deviations of the average speed. c footprint clustering values are on average higher for pep compared to aep and increase with speed. d gait patterns and step combinations. from top to bottom: gait patterns , instantaneous speed, color-coded leg conformation, and leg combination traces. e–g leg combination indexes. y-axis upper limits are set to  <dig>  to facilitate comparison. graphical fits are also represented. e diagonal swing index as a function of speed. diagonal swing is the most representative leg combination, which increases with speed. f single swing index decreases significantly with increased speed. g the all-legs swing index is observed primarily at higher speeds. the inset is the adjusted y-axis. the vertical dashed line is the transition from a walk to run-like behavior



adult mice are typically described as using a walk gait at slower speeds, a trot gait at intermediate speeds, and a gallop or bound gait at higher speeds  <cit> , although additional variants have been described  <cit> . the walk gait is generally defined as when only one leg is swinging, a trot is defined by the simultaneous swinging of diagonal feet, and a gallop has two defining characteristics: only a single foot is in the stance phase and there is an aerial phase   <cit> . with these definitions in mind, mousewalker outputs the step pattern with the instantaneous speed and step combinations associated with each frame in the video . although videos are selected based on the animal’s average speed, plots of instantaneous speed display a wave-like appearance with minimum speeds typically occurring at step transitions . these observations are consistent with other experimental conditions in mice as with other quadrupeds and walking insects  <cit> . as a proxy for assessing the presence of specific gaits, mousewalker computes the fraction of frames assigned to a particular leg combination . we defined seven categories for the possible stance combinations: no swing, single-leg swing , diagonal-leg swing, lateral-leg swing , front or hind swing , three-leg swing, or all-legs swing. in our data set, the two diagonal swing conformations, which are typically observed in the trot gait, are the most representative configuration, present in more than  <dig> % of the frames . the presence of this gait pattern increases with speed, reaching approximately  <dig> % even at intermediate speeds. concurrently, there is a decrease in the fraction of frames in which only a single leg is swinging , typical of walk gaits, and in the fraction of frames with all feet in the stance phase . we also observed an increase in the fraction of frames with three legs in a swing position, typical of gallop gaits . these results reveal that there is progressively reduced contact with the ground as speed increases. consistently, for speeds greater than  <dig>  cm/s, the mice have a duty factor below  <dig>  , suggesting the presence of an aerial phase  <cit> . we find that for most of the animals with a duty factor below  <dig> , and thus are considered to show a run-like behavior, there are some frames in which all legs are in the swing phase . the mousewalker program also calculates the fraction of lateral swing conformations, typical of the pace gait , and simultaneous front or hind swing, found in bound and hopping gaits . in our data set, we found a poor correlation between these step configurations and speed . although most laboratory strains rarely display bound or hopping gaits  <cit> , some mouse species and genetically modified mice that lack left–right coordination use these gaits more frequently  <cit> .

finally, the mousewalker software package also analyzes phase values between contralateral legs , which provide a measure of inter-leg coordination. as expected, these measurements indicate that contralateral legs move in anti-phase with phase values of  <dig>  ±  <dig>  and  <dig>  ±  <dig>  for fore and hind legs, respectively.

discussion
the quantification of rodent motor patterns is important for the phenotypic characterization of motor outputs in a wide variety of experimental conditions, including human disease models, gene and circuit disruption studies, following induced brain or spinal cord injury, and in response to drugs. motor assays should provide a thorough, cost-effective and minimally laborious approach to describing shifts in locomotor performance compared to a baseline or control group.

here we describe a simple and easily accessible ftir arena combined with a complete and open-source software package to track and quantify the walking behavior of rodents without the use of any body markers. using this approach, we measured a large number of parameters and readouts, which provide researchers with an easily accessible method for describing locomotor defects quantitatively and qualitatively. many of the described outputs, such as footprint patterns or toe-opening measurements, are typical metrics of motor function , while other parameters, such as stance linearity or footprint clustering, have not been described previously for rodents . importantly, these parameters have been shown to provide a sensitive readout for motor coordination in the fruit fly  <cit> . our freely available software package does not require expertise in programing, as it can be used as a self-contained executable file format or as a matlab script. the former mode also allows the user to modify the existing script to extract additional kinematic parameters or change the output files. importantly, the software can interpret both black and white and color videos, which increases the range and functions of compatible video cameras. moreover, the ftir arena can be easily redesigned with larger walking surfaces to accommodate larger animals or groups of animals. this setup can also be combined with other kinematic and physiological readouts, such as stick diagrams or electromyographic recordings.

both versions of the software, the documentation in addition to detailed instructions for building and using the ftir apparatus can be downloaded for free  <cit> . we expect that this approach will stimulate the inclusion of highly quantitative kinematic features for phenotypic characterization.

CONCLUSIONS
here we present a simple and readily applied approach to quantitatively describe rodent locomotion with high precision and detail. our user-friendly software package provides a large set of parameters covering multiples aspects of locomotion, which will facilitate comparison between control and experimental groups. in addition, the affordable and easy to build setup will allow a larger number of researchers to study motor behavior under wild type or aberrant conditions and unambiguously measure relevant phenotypes.

