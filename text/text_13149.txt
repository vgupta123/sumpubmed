BACKGROUND
metabolomics relies extensively upon the multivariate analysis of data  <cit> . unsupervised data mining tools such as principal component analysis   <cit>  and hierarchical clustering  <cit>  and supervised methods such as partial least squares discriminant analysis   <cit>  are commonly used to search for patterns and other features within metabolomic data sets. many multivariate techniques evaluate possible relationships between samples by examining the variance of the data  <cit> , the most notable being pca for which principal components  are calculated along the directions of maximum variance. hence the structure of the variance within a metabolomics data set can have a major effect on the output of the multivariate analyses. it is therefore important to assess  the variance structure of a metabolomics data set prior to multivariate analysis. variation between samples can be broadly classified into one of two types – 'technical' and 'biological'  <cit> . technical variance is created by the experimental procedure, and includes sample preparation and analytical measurement errors, whilst biological variance is the inherent variation between samples created by genetic differences, pathological or environmental factors, etc  <cit> . clearly, the technical variance does not contribute any useful information to discriminate between different biological sample classes and so, ideally, this variance would not contribute to any multivariate analyses.

data processing methods can be used to affect the structure of the variance of experimental data sets, helping to focus the subsequent multivariate analysis onto more biologically relevant information arising from the biological variance  <cit> . common processing methods in nuclear magnetic resonance  spectroscopy based metabolomics include autoscaling  <cit>  and pareto scaling  <cit> . the generalised logarithm  has also been investigated, but only in a limited number of studies  <cit> . for each variable in the spectrum, the glog transforms the intensity at that point to a value dependent on both the original intensity and the value of a transform parameter. the equation for the glog transform is shown below, where y represents the untransformed data, λ is the transform parameter, and z is the transformed data.

 z=ln⁡
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg6bgecqgh9aqpcyggsbabcqggubgbcqggoaakcqwg5bqecqghrawkdagcaaqaaiabdmha5naacaaaleqabagaegomaidaaogaey4kascccigae83udwgaleqaaogaeiykakcaaa@3b6a@ 

autoscaling is a processing technique in which the variance of each variable is scaled to unity and the mean of each variable is set to zero  <cit> . in pareto scaling each variable's intensity is scaled by the square root of the standard deviation of that variable  <cit> , producing a data set where the variance changes from variable to variable, but the range of variance across each spectrum is much reduced from the initial, unscaled data.

the glog is a transformation that was originally applied to microarray data  <cit>  and is based on the two-component error model  <cit> . specifically, the measurement error of an observation is characterised by one component representing the error of the data as being proportional to the intensity of the measurement, and a second, additive, component of the error characterising the noise. previously, the glog transform has been applied to one-dimensional  nmr data as first shown by purohit et al  <cit> . unlike autoscaling and pareto scaling, the glog transform initially requires a single parameter to be calibrated from a series of 'technical replicates'. these replicates must be recorded from one biological sample that has been divided into five or more components, each of which is subject to independent sample preparation and nmr analysis. the variance within this data set arises solely from technical sources  <cit> , upon which the glog transform is calibrated  <cit> . hence, when the glog is then applied to a biological data set it effectively reduces the amount of technical variance present, leaving the biological variance to dominate any subsequent multivariate analysis. to date, the glog transform has not been compared against other processing techniques used in metabolomics. furthermore, the calibrated glog transform has only been tested using a single, relatively small 1d nmr data set  <cit> . recently, due largely to severe peak congestion in 1d nmr spectra, there has been a significant increase in the range of 2d nmr experiments conducted in metabolomics  <cit> . although many of these experiments require substantially longer acquisition times and so are not appropriate for high throughput metabolomics, 2d j-resolved  spectroscopy has been shown to provide spectra with low peak congestion and high metabolite specificity in a short acquisition time  <cit> . consequently, several multivariate analyses of 1d projections of 2d jres spectra have been reported  <cit> . to our knowledge the applicability of the glog transform, including the initial calibration of the function using technical replicates, has not been evaluated for these 1d projections of 2d jres spectra, nor for the analysis of the intact 2d jres spectra.

here, we first aimed to evaluate comprehensively the glog transform compared to two other commonly used scaling methods in nmr metabolomics as well as against unscaled data. this evaluation was conducted using three disparate data sets to confirm the broad applicability of the approach, including: urine samples to discriminate between two dog breeds, muscle tissue extracts to discriminate between hypoxia and normoxia in marine mussels, and liver tissue extracts to discriminate between fish collected from two different rivers. the performances of each of the scaling methods – autoscaling, pareto and glog – were assessed by conducting pca of each of the processed two-class data sets. this was achieved by calculating the sensitivities and specificities derived from applying linear discriminant analysis  to each of the resulting pca scores plots. the effect of each scaling method upon the ability to discover potential metabolic biomarkers was also investigated. this was accomplished by selecting the largest peaks in the pca loadings plots and then evaluating if the corresponding peaks in the nmr spectra were of significantly different intensity between the biological classes. secondly, we aimed to evaluate the applicability of the glog transform for 1d nmr spectra, 1d projections of 2d jres spectra, and intact 2d jres spectra. this enabled the first nmr metabolomics study of intact 2d jres spectra; including the reconstruction of the pca loadings plot to a 2d format analogous to the jres spectra, which is anticipated to have significant benefit in terms of the ease of metabolite identification. during this second aim we also sought to extend the glog transform to reduce the deleterious effects of noise.

RESULTS
for each data set under consideration, the data has been normalised and binned prior to any scaling or transformation techniques having been conducted. for ease of reference the normalised, binned spectra are referred to as "unscaled" data, and autoscaling, pareto scaling and the glog transformation are all referred to as "scaling" methods. furthermore, as described in the methods section, the glog transform must initially be calibrated once for each type of biological sample. the resulting calibration parameter  can then be used for all subsequent metabolomics analyses of that sample type that use the same nmr acquisition and processing parameters.

data structure
prior to assessing the effects of scaling on variance, it is important to contrast the technical versus biological variability in the datasets. this can be achieved by calculating the median and range of the coefficients of variation  for all the bins across a series of nmr spectra. technical variability is measured by the cv of the technical replicates, and biological variability  by the cv of the biological dataset. for the mussel 1d nmr data, the median cv of the technical replicates is  <dig> % . in contrast, the median cv of the mussel biological data is  <dig> % . clearly the technical variance is a significant proportion of the biological variance, and therefore must be treated appropriately prior to multivariate analysis. similar results are found for the two other data sets: the dog pjres nmr data has median cvs of  <dig> %  and  <dig> %  with ranges of  <dig> – <dig> % and  <dig> – <dig> %, respectively. and for the fish 2d jres nmr data the median cvs are  <dig> %  and  <dig> %  with ranges of  <dig> – <dig> % and  <dig> – <dig> %, respectively.

effects of scaling on variance
scaling techniques are applied after the other processing steps, such as normalisation and binning, have been completed and can radically change the appearance and structure of the spectra of all the different nmr data sets. for example, the canine urine data set is shown in figure  <dig>  where the effects of autoscaling, pareto scaling and the glog transform are clearly visible. in particular, for both the pareto scaled  and glog transformed  spectra, the weak peaks have been scaled up in intensity while the stronger peaks have been scaled down, the effect being more pronounced for the glog data set. the signal to noise ratio is particularly low for the autoscaled spectrum , where it is difficult to distinguish between a peak representing a metabolite and the noise.

the appearance of the spectra is only one indication of the structure of the processed data. for more information specifically relating to the ability of the scaling techniques to minimise technical variance, it is more useful to examine the variance exhibited by the bins across the spectra of technical replicates. figure  <dig> shows the relationship between the variance associated with each bin and the mean value of that bin across all of the technical replicates. here the mean intensities have been ranked such that the left of the plots describe the bins with the smallest mean values and the right hand sides show the bins with the largest mean intensities in the data set. for the unscaled data , it appears that the majority of the bins have a similar variance while a few bins with large mean intensity possess a large variance. in fact on closer inspection this behaviour is repeated across the ranked bins , highlighting the large range in the variance throughout the data set – even for technical replicates where the differences between spectra are minimal. subsequently, a pca of these unscaled spectra would result in the bins with largest variances  contributing most to the first few principal components. these bins, whilst being the most intense in the data set, may not however hold the most relevant biological information.

scaling methods can radically change the variance structure of the data set. figure 3b shows the variance versus ranked mean for the mussel technical replicates after the spectra have been autoscaled. here, the variance is now totally uniform, with the variance of every bin set to unity. this removes any bias that may arise due to the peak intensity. however, every bin is now treated equally, giving no differentiation between wanted signals representing peaks and unwanted signals such as noise. for pareto scaled data , there is considerable similarity in appearance to the unscaled data since there are a few bins with large mean intensity that clearly have a large variance. this structure is also repeated amongst the bins of lower mean intensity in a similar manner to the unscaled data . this highlights that the pareto scaled spectra also have a large range of variance throughout the data set, which would affect which bins contribute to the loadings in a pca. finally, figure 3d shows the impact of the glog transform upon the variance of the spectra. here the variance structure is very different from the other scaling methods as there is a wide range of bin intensities giving rise to bins with similar variances, demonstrating the variance stabilising effect of this transform. although there are still bins with higher variances compared with the majority of bins, these bins are spread throughout the range of bin intensities and so removes any bias of pca towards the largest peaks.

effects of scaling on classification accuracy
pca was employed to provide an unbiased method to evaluate the usefulness of the scaling techniques, since this provides a clear strategy to observe the effects of the scaling on the variance of the data. however, all the transformations are equally applicable as a processing step prior to supervised multivariate analysis such as pls-da. also, to provide a quantitative method to evaluate the models, lda was then applied to the first and second pcs. the solid black line in figures  <dig>   <dig>   <dig> and  <dig> represents the border between the decision regions generated by the lda which were used to determine if a sample was correctly or incorrectly classified. table  <dig> summarises the classifier statistics used to evaluate the effects of the various scaling methods on the pca models across all three data sets.

mussel adductor muscle samples
the  <dig> largest bins in each loadings plot have been tested as potential biomarkers using one-way anovas. clearly, as shown in figures 5a, 5b and 5c for the unscaled, autoscaled and pareto scaled data respectively, none of these bins are significantly different between the two classes and so are poor biomarkers. in contrast, only the glog transformed spectra yielded bins with the largest loadings that are all significantly different between the hypoxic and control animals . this highlights a significant benefit of the glog transform for discovering useful and significant biomarkers from nmr metabolomics data.

canine urine samples
for the pjres nmr data set of urine samples from two breeds of dog, the processing methods show a similar effect upon the data . the pca scores plot for the unscaled data shows little noticeable structure between the different classes, with the lda classifier correctly identifying only  <dig> of the  <dig> samples . pareto scaling performs only slightly better, also with no noticeable separation of the two classes, and only  <dig> samples correctly classified . however, both the autoscaled  and glog transformed  data yield improved classifications of  <dig> of the  <dig> samples, with the same six samples being misclassified. the margin of separation between the two distinct clusters remains approximately the same for the autoscaled and glog transform analyses, giving no clear 'best' scaling method for this data set. the explanation behind the misclassification of the  <dig> samples is beyond the scope of this study, although it is important to realise that this potentially interesting result was only revealed when the data set was appropriately scaled to reduce the effects of technical variance.

for the unscaled and pareto scaled data that produced the lowest classification accuracies, the loadings plots for the pc perpendicular to the lda decision line  yielded no useful biomarkers since none of the bins with the largest loadings are significantly different between classes. however, for the autoscaled and glog transformed data that produced better classification, the loadings plots perpendicular to the lda decision line  both identified bins that are significantly different between the two breeds of dog. also, several bins were predicted as potential biomarkers by both analyses.

fish liver samples
the pca scores plots from the analysis of the intact 2d jres nmr data are shown in figure  <dig>  where the two classes correspond to fish sampled from different rivers in the uk. here, the appearance of the four scores plots is somewhat similar for the unscaled and scaled data. in all cases there is partial separation of the two classes, and the lda decision line reveals that  <dig> of  <dig> samples are correctly classified for the unscaled data which improves to  <dig> of  <dig> samples following autoscaling, pareto scaling and glog transformation . further examination of the glog transformed data set reveals that only a small proportion of the variance is captured by the first two pcs in the pca model. this unexpected result can be explained by examining the glog transformed data itself. figure 9a shows a glog transformed 2d jres spectrum following concatenation of each of the slices along the j-coupling axis into a single row vector, which facilitates a comparison of the peak heights compared to the noise. the glog transformation has not only increased the heights of the small peaks relative to the larger ones, but has also greatly magnified the noise in the spectrum.

an algorithm to increase the relative signal to noise ratio of the data was then investigated by extending the glog transformation to include an additional parameter, as shown in equation . figure 9b shows the same 2d jres spectrum after application of the extended glog transformation. the pca scores plot of the extended glog transformed data is also changed  compared to the original glog transformed data , with the variance expressed by the first two pcs almost doubled to  <dig> % and  <dig> %. the most noteworthy result is that the reduction of noise using the extended glog transform also improves the lda classifier, with all  <dig> of  <dig> samples now correctly assigned to their correct classes and separation between the two classes in pca space now readily apparent .

the corresponding pc <dig> loadings plot for the scores plot in figure 10a is shown in two different orientations in figures 10b  and 10c . when used in combination with the extended glog transformation the resulting loadings plot provides a powerful visualisation tool from which the metabolic differences between the two sample classes can be identified. in particular, the significant advantages over the more traditional 1d loadings plots derived from both 1d nmr data as well as 1d pjres data  <cit>  include the decreased congestion of peaks and the preservation of j-coupling information. ultimately this approach could increase the confidence of metabolite identification in nmr metabolomics.

CONCLUSIONS
we have demonstrated that autoscaling, pareto scaling and the glog and extended glog transformations can significantly alter the variance structure of nmr metabolomics data, which in turn can improve the classification accuracy of multivariate models generated from the scaled data. this can help to extract important information from data sets, since improving the discrimination between sample classes can help to identify metabolic biomarkers. specifically, we have demonstrated that the glog and extended glog transformations achieve the best, or equal best, classification accuracy compared to unscaled, autoscaled and pareto scaled data on three example data sets. a classification accuracy of 100% was achieved for two data sets – the effect of hypoxia in invertebrate muscle extracts and the effect of sampling location on fish liver extracts – and an accuracy of  <dig> of  <dig> correctly classified for a third dataset examining breed discrimination using dog urine. furthermore, from an analysis of the top five peaks in each of the corresponding pca loadings plots, we have confirmed that glog transformed data is considerably better at discovering metabolic biomarkers that can discriminate significantly between sample classes. we have also confirmed the broad applicability of the glog approach using three disparate data sets from different biological samples using 1d nmr spectra, 1d projections of 2d jres spectra, and intact 2d jres spectra. finally, we have reported an extension to the original glog algorithm that effectively suppresses the noise, which was critical for the analysis of intact 2d jres spectra. in conclusion, we have thoroughly evaluated and proven the benefits of utilising the glog transformation for stabilising the technical variance associated with metabolomics experiments, which can lead to significantly beneficial effects on the discrimination between sample classes using multivariate analysis.

