BACKGROUND
the endogenous control and external perturbation of biological processes are inherently dose-dependent. examples include developmental events that require gradients of growth factor concentrations  <cit> , zonation in the liver due to differences in oxygen and nutrient concentration  <cit> , the pharmacological inhibition of key proteins in disease  <cit> , and the toxic effects of environmental chemicals  <cit> . without a proper understanding of the dose-response characteristics, the molecular mechanisms underlying the regulation or perturbation of these biological processes would remain unknown.

microarray technology has been broadly accepted as an efficient and reproducible way to explore the gene expression changes involved in the regulation of biological processes. the ability to survey thousands of genes allows a comprehensive assessment of the transcriptional changes involved in specific cellular events. bioinformatic methods have been developed to interpret these changes by applying standardized functional annotations to each gene and identifying whether certain biological processes or molecular functions are over- or under-represented  <cit> . this approach has been referred to as a gene ontology  enrichment analysis and allows large lists of transcriptional alterations to be distilled down into changes in cellular processes such as the immune response, dna repair, apoptosis, etc.

to quantitatively assess the dose-response behavior of endogenous molecules and environmental chemicals, benchmark dose  methods have been employed to estimate reference doses  <cit> . in the bmd method, dose-response data for the biological effect is fit with a statistical model and a bmd is identified that results in a defined level of response over that observed in control populations. the bmd method has been used extensively by regulatory agencies to set standards for human health effects  <cit> .

a method for integration of bmd calculations with go classification analysis in the examination of microarray dose-response data has recently been developed  <cit> . the combination of microarray technology with these analysis methods results in a unique bioinformatic tool that provides both a comprehensive survey of transcriptional changes together with dose estimates at which different cellular processes are altered based on a defined increase in response. in this application note, we describe the development and availability of a user-friendly software tool that integrates these standard methods in the analysis of microarray dose-response data.

implementation
bmdexpress was written in the java programming language with a swing graphical user interface. the application requires a java runtime environment of  <dig> . <dig> or newer. model fitting to the dose-response data is performed using a dynamic link library  written in c and fortran that are called using a java native interface. the dll was written using source code modified from the bmds software application developed by the u.s. environmental protection agency  <cit> . in mapping the affymetrix probe identifiers to corresponding go categories, the software application queries a client-accessible mysql database that resides at the hamner institutes. the database is constructed using annotations provided by netaffx  <cit>  and the gene ontology consortium  <cit> . the database is updated weekly to ensure the annotations are current. at the present time, only affymetrix microarrays are supported by bmdexpress and include the following: human ; mouse ; rat ; drosophila ; and zebrafish .

RESULTS
the bmdexpress software is designed to perform a stepwise analysis on dose-response microarray data that combines standard bmd methods with go classification analysis. the program has a series of interfaces that guide the user through the analysis process.

data import
the first step in using bmdexpress is to load the gene expression data from a data file . the data file must be in tab-delimited format with plain text. each column in the data matrix should be the gene expression values for an individual sample and the first row should include the dose at which that sample was treated. if the data has an extra row of column headers, the program provides an option for removing them. an example data file is included in the software installation .

one-way anova
the number of probe sets on a standard affymetrix microarray is relatively large and in the typical experiment, most probe sets are not significantly altered by the experimental treatment. as a result, an initial probe set selection process is recommended to reduce both the computational requirements and the variability in the final analysis by selecting probe sets that show significant dose-response behavior. the probe set selection process consists of a one-way analysis of variance  together with a false discovery rate correction for multiple comparisons  <cit>  . the user is allowed to input a cutoff based on the adjusted p-value and may choose whether to filter out the various control genes  present on an affymetrix array. the output of the one-way anova lists the probe set identifier, the associated degrees of freedom, the f-value, the p-value, and the adjusted p-value. the user can export the list to a tab-delimited file by right-clicking on the corresponding node in the data tree within the left-hand window.

benchmark dose analyses
the generic definition of a bmd is the dose or concentration of a substance that corresponds to a specified level of response above or below that observed in a control or background population. the specified level of response within this definition is referred to as the benchmark response  and a statistical lower confidence bound on the bmd  has been typically used by regulatory agencies to set safe levels of exposure. in bmdexpress, the identification of the bmd involves fitting the gene expression data to a selection of statistical models  and selecting the model that best describes the data with the least amount of complexity . the user is allowed to select which statistical models they would like to fit to the data. by default, the power model and the three polynomial models are selected. however, the user can select a single model or any combination of two or more models. the user should note that depending on the number of doses in the study, the 3° polynomial may not be appropriate. in addition to model selection, the user is allowed to modify several critical parameters associated with the bmd analyses including the maximum number of iterations, the bmr, and the confidence level for calculation of the bmdl. the maximum number of iterations is a convergence criteria for the model fitting. the bmr is the number of standard deviations at which the bmd is defined. as a default, a bmr of  <dig>  is provided. to derive this value, a normal distribution was assumed for control animals and it was assumed, a priori, that the changes in expression could occur in either tail, with a 1% chance of that occurring in the absence of exposure . a bmr of  <dig>  is the amount required to shift the mean response of the control distribution such that the treated distribution contains 11% in a single tail, i.e., a 10% increase over the assumed background rate of response. the 10% value for the shift in the tail area of the distribution is standard for bmd analysis  <cit> . the confidence level is the statistical lower confidence limit applied to bmd estimated by the model. the resultant lower bound on the bmd is the bmdl and is a conservative estimate of the dose at which the particular gene is altered.

in processing the model output, the user is allowed to choose the method for selecting which model best describes the data with the least amount of complexity. in the first method, a nested likelihood ratio test can be used to select among the linear, 2° polynomial, and 3° polynomial models followed by an akaike information criterion  comparison  <cit>  between the best nested model and the power model . in the second method, a completely aic-based selection process is performed. finally, the user is allowed to remove probe sets where the bmd is greater than the highest dose. this option was provided to avoid model extrapolation.

in the output from the bmd analyses, the probe set identifier is provided with the best overall model together with selected values for each of the statistical models evaluated. these include the bmd, the bmdl, the fit p-value from the likelihood ratio test, the log-likelihood value for the fit of the model, the aic, and the direction of the response . on an average computer,  <dig> probe sets can be processed per minute.

gene ontology analyses
the bmd values from the previous step in the analysis process are used as input for the go analyses . in the go analyses, the probe set identifiers are combined into unique genes based on their ncbi entrez gene identifiers. when two or more probe sets are associated with a single gene, the bmds for the individual probe sets are averaged to obtain a single value. the entrez gene identifiers are then matched to their corresponding biological process, molecular function, and cellular component go categories. the program returns a wide range of summary values representing the central tendencies and associated variability of the bmd and bmdl values for the genes within each category .

example analysis on estrogenic dose-response in zebrafish 
to illustrate the features and functionality of bmdexpress, microarray data were taken from a study of hepatic gene expression changes in zebrafish following exposure to  <dig> α-ethynylestradiol    <cit> . in this study, female zebrafish were exposed to ee <dig> in the water at nominal concentrations of  <dig>   <dig>   <dig>  and  <dig> ng/l for  <dig> and  <dig> h. gene expression changes in the liver were then evaluated using the affymetrix zebrafish array to identify potential genomic biomarkers for endocrine disrupting compounds  that are released into the environment and obtain a better understanding of the biological effects of these compounds in fish. the data from the study was downloaded and normalized using robust multi-array averaging  with a log <dig> transformation  <cit> . the log <dig> transformed data for each time point were imported and analyzed separately using bmdexpress. the data were pre-filtered using a one-way anova with a false discovery rate of 5%. a total of  <dig> and  <dig> probe sets showed significant dose-response behavior at the  <dig> h and  <dig> h time-points, respectively. the data were then fit to linear, 2° polynomial, and power models and the best model was selected using a likelihood ratio test for the linear and 2° polynomial followed by an aic comparison with the power model. the bmd values from the best model were then used as input for the go analysis.

results from the analysis at the  <dig> h time point showed that the most sensitive single gene was tryptophanyl-trna synthetase   and the most sensitive biological process to ee <dig> exposure was amino acid glycosylation  . the four responsive genes in this category all showed similar dose-response behavior. based on the bmd values, the genes relating to amino acid glycosylation and tryptophanyl-trna synthetase may be a more sensitive set of biomarkers than the current single standard biomarker of vitellogenin  <cit> . changes in serum vitellogenin concentrations were only significantly altered at the  <dig> ng/l concentration following the  <dig> h exposure  <cit> . the regulation of protein glycosylation by sex steroids has been well established  <cit> . for example, the glycosylation of follicle-stimulating hormone is regulated by estrogens and androgens and affects its biological activity  <cit> . another example is the glycosylation of vitellogenin itself. vitellogenin has been shown to be a highly modified protein  <cit>  and the post-translational changes include glycosylation by hepatocytes  <cit> . the glycosylation of vitellogenin provides a source of carbohydrate for the developing embryo  <cit>  and may play a role in transport, folding, and uptake of vitellogenin  <cit> . other go categories that showed low bmd values were cell migration involved in gastrulation, monocarboxylic acid metabolism, trna aminoacylation, nitrogen compound metabolism, and regulation of apoptosis. at the  <dig> h time point, the most sensitive single gene was dihydrolipoamide dehydrogenase   and lipid transport was the most sensitive biological process  . in the lipid transport category, one of the genes was vitellogenin and another was apolipoprotein a-i. both genes have been previously shown to be transcriptionally-regulated by estrogen  <cit> . other go categories that showed relatively low bmd values were glycolysis, protein-dna complex formation, and protein import.

aredundant child go categories containing the same genes and mean bmd were removed from the list.

in the original analysis of the data, the investigators used a linear model to identify genes that were significantly affected by dose together with a nonparametric stratified test for trend  <cit> . pairwise comparisons between dose-levels and the control group were also performed. the investigators summarized these results using venn diagrams showing overlap of genes between doses and used a go enrichment analysis at each individual dose showing which processes were affected. the reanalysis of this dataset using bmdexpress provides several improvements over the standard analysis performed by the investigators in the original article. first, the statistical modeling capabilities of bmdexpress utilized the dose-response information inherent in the data and identified concentrations at which the response to the treatment was significantly changed based on the variability observed in the control animals. these reference concentrations were not limited to the specific doses used in the study unlike the analysis using the linear model and pair-wise comparisons. second, the ability to model the dose-response curves and calculate associated confidence limits identified a set of potential biomarkers that were sensitive and robust. third, instead of performing a go enrichment analysis at each dose level, the analysis by bmdexpress summarized the data by showing which biological processes were the most sensitive to environmental estrogens and provided reference concentrations at which they were affected. in this manner, the analysis was able to highlight the changes in amino acid glycosylation that occur at lower concentrations than the effects on trna aminoacylation and apoptosis.

CONCLUSIONS
despite the numerous software programs for microarray data analysis, the majority do not provide any statistical modeling tools for analyzing dose-response studies. in the past, microarray dose-response studies have been typically analyzed using anova with pair-wise comparisons between dose groups and the associated control. this type of analysis only identifies which genes are significantly altered at the specific doses used in the study. in bmdexpress, a statistical model is fit to the data and a dose-level is identified at which the response to the treatment is significantly different than that observed in the control animals. using this method, the analysis is not constrained to the experimental doses and provides better use of the dose-response information  <cit> . the software tool then allows users to summarize the statistical modeling of the individual genes based on go categories and characterize the dose-dependent behavior of specific cellular processes. these integrated capabilities make bmdexpress a useful tool for the dose-response analysis of microarray data.

availability and requirements
project name: bmdexpress

project home page: 

operating systems: windows  <dig> and xp

programming languages: java, c, fortran

other requirements: java  <dig> . <dig> or higher

license: mit public license

any restrictions to use by non-academics: none

list of abbreviations
go, gene ontology; bmd, benchmark dose; dll, dynamic link library; anova, one-way analysis of variance; bmr, benchmark response; bmdl, bmd lower confidence limit; aic, akaike information criterion; ee <dig>   <dig> α-ethynylestradiol; rma, robust multi-array averaging.

authors' contributions
ly created the software and drafted the manuscript. bca consulted on the statistical modeling and analysis workflow. rst conceived and supervised the project and helped to draft the manuscript. all authors read and approved the final manuscript.

