BACKGROUND
multi-locus sequence typing  has become the gold standard for the analysis of bacterial populations  <cit> . mlst involves pcr amplification and sequencing of 5– <dig> loci of ~500 bp in length, with each sequence variant assigned a unique locus variant or allele number. each unique combination of locus variants is assigned a sequence type , which is then used to denote a precise set of sequences. public mlst databases are used to store and share information linking dna sequences to locus variant numbers and sequence types and are available for > <dig> bacterial species including important human pathogens such as staphylococcus aureushaemophilus influenzae and neisseria species . this format allows quick, simple and direct comparison of bacterial populations analysed in different laboratories and over time. the databases also link individual bacterial isolates to sts, serotypes, sources and other meta-information with public health utility.

advances in sequencing technology continue to bring down the costs of whole-genome sequencing of bacteria – indeed it is already close to the cost of mlst  <cit> . because bacterial genomes are relatively small in size  they can be sequenced in multiplex, allowing the high read depths of e.g. a single lane of illumina hiseq to be distributed among up to  <dig> different samples via the use of individually-tagged libraries  <cit> . whole-genome sequencing provides a lot more information than mlst and can be used to study microevolution in much finer detail and over small time scales  <cit> . as an assay, whole genome shotgun sequencing can be simpler than mlst, which requires multiple independent pcr and sequencing reactions to be performed for each sample. this will become increasingly true as automation becomes widely used in whole-genome library preparation workflows. also, while mlst requires the design and purchase of species-specific specific primer sets, whole genome sequencing can be applied to any bacterium, without species primers or even prior knowledge of species. however, while the advantages of whole-genome sequencing over mlst are clear, it is crucial that newly sequenced isolates  can be analysed in the context of the vast amount of population data currently stored in mlst databases. mlst can be used to assess the frequency and expansion of particular clones, and most mlst databases store not only st information for each isolate, but also detailed meta-information such as serotype, host or source, date of collection and in some cases spatial information . mlst provides a framework against which new isolate collections can be compared and interpreted, but can only be utilized if the sts of newly sequenced isolates can be accurately derived from whole-genome sequencing data.

the only method currently available to perform mlst allele assignment on short read data is web-based, requiring sequence data to be uploaded to a server and compared to public mlst databases  <cit> . this poses problems for data security and confidentiality, is unfeasible for the large datasets typically generated in high-throughput multiplex sequencing projects and excludes the use of privately maintained mlst databases. all of these issues are likely to be significant barriers for use in the majority of research or public health laboratories. furthermore the method depends on de novo assembly  <cit> , which limits its sensitivity, particularly for genomes sequenced at low read depth.

here we present an open-source software tool, srst, to derive sts from illumina short read sequence data using a mapping-based approach to maximise sensitivity. srst can be used together with any public or private mlst scheme and generates output files suitable for comparative analysis with existing mlst datasets, compatible with standard mlst tools such as eburst  <cit> , clonalframe  <cit>  and phyloviz . in this paper, we introduce the srst approach and demonstrate its accuracy with real datasets including  <dig> genomes from four species-specific and four plasmid mlst schemes, and discuss the usefulness of the method for quality control in high-throughput sequencing projects and outbreak investigations.

implementation
srst takes as input  locus variant sequences and st profile definitions, retrieved from a public or private mlst database ;  sequences flanking each locus, retrieved from an appropriate reference genome sequence using the supplied script;  illumina read data . srst runs on any linux based computer or cluster  and requires the installation of the free packages bwa and samtools for alignment functions  <cit> . full instructions are available at http://srst.sourceforge.net.

each readset is mapped to each of the possible locus variants v  and a score s is calculated to assess the quality of the match, as follows. consider a single base position i in the mapping of read set r to locus variant v, in which ni reads map to position i, which has base vi in v and majority-rules consensus  base ri in r. if ri ≠ vi we record a mismatch and rule out v as a possible locus variant. otherwise, we compute the probability that the base call ri  is erroneous, by calculating binomial probabilities for the three alternative bases x:

  prx≥x=∑j=knintkpj1−pni−j 

where k = the observed read count for base x at position i. the probability that a non-consensus nucleotide  is the best explanation for the coverage at position i is the sum of the three probabilities. the probability that a sequence other than v is the best explanation for the observed coverage across the whole locus is the sum of these probabilities across all positions i. the final score s reported is the negative log of this probability, so that higher scores reflect more hits. note this treats the probabilities at each position as independent, which they are not. however the assumption is conservative, and only results in non-trivial over-estimation of the probability in cases where the score will be below a threshold of acceptance in any case.

for each readset and locus, the highest scoring variant, with zero mismatches and passing a user-settable cut-off value, is assigned. if all loci are assigned for a particular readset and the combination of variants is a known st, this st will be returned; if a novel combination of locus variants is detected this will be assigned a novel st. if any loci are not confidently assigned, no st can be called.

the main output is a file specifying the locus variants and sts of all input datasets, suitable for analysis with common mlst tools such as eburst or phyloviz.

a log file is also generated, detailing scores and coverage statistics for each locus and readset. where an exact match to a known allele cannot be found, the closest allele  is reported and the closest st is determined; these results are flagged so as to be distinguished from precise st assignments.

optionally, verbose output can be switched on in order to retain full sequence information for novel alleles, including the alignment , pileup  and consensus sequence  obtained from mapping to the closest-matching locus variant. see additional file  <dig> for an example fastq generated by srst. this is intended to facilitate investigation of novel alleles, in which case visual inspection of alignments or pileups is recommended. some mlst databases may also accept fastq or bam files for submission of novel alleles.

RESULTS
accuracy in calling sequence types
to determine a suitable cut-off score and test the accuracy of srst, we utilized three publicly available datasets each representing a different group of bacteria – streptococcus pneumoniae <cit> , staphylococcus aureus <cit>  and salmonella bongori <cit> . all short read, mlst and reference data were downloaded from public databases . we ran srst on each read set  and examined the sensitivity  and specificity  obtained using different cut-off scores. as figure  <dig> shows, best results were obtained with a cut-off score between  <dig> and  <dig>  we therefore set the default cut-off score for srst to  <dig>  and use this cut-off for all subsequent analyses reported below. in the few cases where an allele could not be confidently assigned using a cut-off score of  <dig>  the expected allele and st were still correctly identified by srst as the most likely result.

pe = paired end sequencing, se = single end sequencing.

quality control in high-throughput sequencing projects
the most obvious application of srst is to assign sts to novel isolates whose sts are unknown. however we were also interested to use srst for quality control in large-scale sequencing studies of bacterial clones, to allow early detection and identification of read sets that should be excluded from comparative analysis of the clonal group of interest. to demonstrate the utility of srst for this purpose, we used it to analyse a set of shigella sonnei genomes sequenced using paired-end multiplex illumina gaii   <cit> . note shigella species are actually sublineages of e. coli <cit> , hence the e. coli mlst scheme  <cit>  is used to investigate shigella.

a total of  <dig> shigella data sets had sufficient mean read depth  to analyse and  <dig>  of these matched a known st with srst scores ≥ <dig> for all loci. the other  <dig> samples comprised   <dig> with ≥ <dig> locus scoring < <dig> but identified as a known s. sonnei allele and   <dig> with novel locus variants  differed from a known s. sonnei allele by one mismatching base). hence all  <dig> were recognizable as single-locus variants of known s. sonnei sts, confirming their suitability for inclusion in a s. sonnei study. consensus sequences and quality scores for the novel alleles, generated using srst’s verbose option, are given in additional file  <dig>  of the  <dig> sts assigned with score ≥ <dig>   <dig> matched known s. sonnei sts . four matched those of other, non-sonnei, shigella , indicating they were erroneously included in the s. sonnei isolate collection and should be excluded from the intended analysis of s. sonnei. the species status of these four isolates, identified by srst, was confirmed by serotyping of the original isolates, and comparison of the read sets to reference genomes of s. flexneri and s. boydii. hence srst could successfully detect and identify outliers for removal. in contrast, allele assignment by blastn search of de novo assembled contigs  succeeded for only 60 % of the shigella read sets.

plasmid mlst
there are currently mlst schemes available for four types of plasmid – inci <dig>  <cit> , incn  <cit> , inchi <dig>  <cit>  and inchi <dig>  <cit>  . to test the accuracy of srst for plasmid mlst, we used it to detect and assign 5-locus sts to inci <dig> plasmids in the s. sonnei dataset. since we do not have traditional plasmid mlst sequences available as a control, we mapped the reads to the reference sequence for inci <dig> st <dig> plasmid pek <dig>   <cit>  and used the proportion of the plasmid covered by each read set as a measure of the real presence of inci <dig> plasmids in the data . as figure  <dig> shows, there was a strong correlation between the number of inci <dig> plasmid mlst loci that could be assigned with confidence by srst, and the coverage of the inci <dig> reference plasmid, indicating that srst is useful for screening for the presence of specific plasmid types. a total of eight read sets were assigned the same inci <dig> st  as pek204; their coverage of pek <dig> ranged from  <dig>  %- <dig>  % , while the highest coverage of pek <dig> in other read sets was  <dig>  % . this suggests that srst’s assignment of plasmid sts is as accurate as that for chromosomal sts.

high-confidence inci <dig> plasmid sts were assigned to a total of 26 s. sonnei. as figure  <dig> shows, these represent a variety of very distinct inci <dig> plasmid types, indicative of multiple transfers of divergent inci <dig> plasmids into s. sonnei. the plasmid sts clustered geographically and, within geographic regions, temporally , suggesting there have been several, highly localized, transfers of distinct inci <dig> plasmids into the global s. sonnei population.

outbreak analysis
chromosomal and plasmid mlst can provide useful insights into bacterial pathogen outbreaks. srst allows these insights to be rapidly extracted from whole-genome shotgun sequencing, which can be performed without prior knowledge of the species and with no need for pcr with species-specific mlst primers. to illustrate this, we utilised five illumina short read data sets from the outbreak of e. coli o104:h <dig> causing hemolytic uremic syndrome in germany in  <dig>  <cit>  . the data was generated in two different sites . we used srst to screen the outbreak data using the e. coli mlst database to identify the chromosomal st and all publicly available plasmid mlst databases to identify inci <dig>  incn, inchi <dig> or inchi <dig> plasmids . details of the datasets and results are provided in table  <dig> 

the srst st calls and scores are indicated for the chromosome  and plasmid . no other plasmids with mlst schemes available  were detected using srst

srst correctly identified the chromosomal st of all five outbreak isolates as e. coli st <dig>  which matches that reported using traditional mlst approaches  <cit> . the closest available finished reference genome sequence to the e. coli outbreak strain, ec <dig>  shares this st, and has formed the reference for phylogenetic and gene content analyses of the german outbreak in all published studies  <cit> . this illustrates the utility of srst to rapidly identify the most suitable reference sequence for whole-genome analysis during an outbreak. at the time of the german outbreak, ec <dig> had not been entered into the e. coli mlst database and extensive read mapping to all available e. coli sequences  was required to identify the most suitable reference  <cit> , however assuming all available reference sequences are entered into the relevant mlst databases, this could be achieved much more quickly and easily in future using srst.

srst also correctly identified the presence of an inci <dig> plasmid of st <dig> in each of the e. coli o104:h <dig> outbreak isolates . the outbreak strain’s antibiotic resistance plasmid was previously confirmed as inci <dig> st <dig> using traditional plasmid mlst . as figure  <dig> shows, this plasmid is quite divergent from any we detected in the s. sonnei data. the inci <dig> plasmid mlst database shows inci <dig> st <dig> plasmids have previously been identified in a variety of other e. coli hosts circulating in both humans and animals, often containing extended spectrum beta-lactamase ctx-m genes similar to that encoded in the outbreak isolates’ inci <dig> plasmids . no incn, inchi <dig> or inchi <dig> plasmids were identified by srst, consistent with published reports of the outbreak genomes  <cit> .

other potential applications
as srst is database driven it could be used for other sequence typing tasks beyond mlst, provided appropriate databases are used as input. for example, it could be used to annotate drug resistance genes and alleles. used in conjunction with the recent ribosomal mlst database  <cit> , srst could potentially be used for species designation of novel isolates. these applications could be useful in outbreak analysis, strain identification, surveillance, studies of mechanisms and transfer of drug resistance, and a variety of other public health and research applications.

CONCLUSIONS
srst uses read mapping to assign sequence types to novel bacterial genomic sequence data, which offers several advantages over traditional mlst using pcr and sanger sequencing. srst is accurate and sensitive at allele assignment and can identify and retrieve novel allele sequences for further investigation. being mapping-based it is more sensitive than assembly-based allele assignment for short read data sets, and can be run locally without reliance on web-based services or data uploads. srst can be used in a variety of contexts, including simple allele assignment to novel data sets, quality control in batch sequencing projects, outbreak investigation, plasmid mlst and potentially in any scenario where database-driven sequence typing is required.

availability and requirements
project name: srst 

project home page:http://srst.sourceforge.net/

operating system: linux/mac

requirements: samtools  <dig> . <dig>  bwa  <dig> . <dig> 

programming language: python  <dig> .4

license: bsd

any restrictions to use by non-academics: no

competing interests
the authors’ declare that they have no competing interests.

authors’ contributions
all authors contributed to methods design, editing and approved the final manuscript. tcc also wrote and tested code. mi performed software testing and data analysis. keh wrote and tested code, sourced data, performed data analysis and drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
example of novel allele output using the verbose option. consensus sequences and quality scores for three novel shigella sonnei alleles identified using srst. 

click here for file

 acknowledgements
this work utilised publicly available mlst databases for salmonella and e. coli ), for s. aureus and s. pneumoniae , and for plasmids . data for all schemes was retrieved from the collation at http://pubmlst.org , the development of which has been funded by the wellcome trust. keh, mi were supported by fellowships # <dig>  # <dig> from the nhmrc of australia; national ict australia  is funded by the australian government's department of communications, information technology and the arts, australian research council through backing australia's ability, ict centre of excellence programs. this research was supported by a victorian life sciences computation initiative  grant #vr <dig> 
