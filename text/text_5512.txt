BACKGROUND
high-density genome-wide views of biological samples, using high-throughput dna mapping and mrna gene expression microarrays facilitate the identification of recurrent molecular lesions. both types of microarrays, which are being produced by different manufacturers, e.g., nimblegen, agilent, sequenom, applied biosystems, illumina and affymetrix, typically contain large numbers of small oligonucleotides that interrogate the genome. currently available dna arrays contain over  <dig>  probe sets, while the gene expression arrays target over  <dig>  genes. efficient analysis of these large datasets remains a challenge for many researchers.

the affymetrix and illumina dna mapping platforms have been designed to specifically target sequences containing single nucleotide polymorphisms . snps are currently estimated to be present at a frequency of  <dig> out of  <dig> nucleotides  <cit> . by including different probe sets to detect the possible snp variants, genome-wide genotyping is feasible. in fact, these types of arrays have been developed for genome-wide association studies; however, these platforms can easily be applied to determine copy numbers of these chromosomal markers, similar to array comparative genomic hybridization . because of the high number of snps, sample dna can be examined with an inter-marker distance of  <dig> to  <dig> kb, and  deletions and/or amplifications are detectable. by comparing disease samples to normal germ line dna, a detailed overview of acquired gains and losses of the genome is obtained. in fact, although our knowledge is still developing, it has recently become apparent that that copy number variation  accounts for a substantial amount of genetic variation in the human genome  <cit> . the high-resolution scanning technologies enable the analyses of cnv and associated phenotypes  <cit> .

the power of dna mapping has been shown extensively in cancer research. chromosomal gains and losses as well as regions of loss-of-heterozygosity  have been shown in, for instance, leukemia  <cit> , lung cancer  <cit>  and colon cancer  <cit> . recognition of recurrent lesions will ultimately result in the identification of pathogenic genes. for instance, snp array analysis of a set of cancer cell lines has lead to the identification of the microphthalmia-associated transcription factor mitf as a melanoma oncogene  <cit> .

on the illumina platform genotypes are determined using hybridization of genomic dna to beadchips followed by an enzymatic discrimination step. on the affymetrix platform, genotype calls and copy numbers are determined by a probe set consisting of mismatch and perfect match probes. in analogy with the expression probe set, the genotype and copy number of an individual snp is dependent on the balance of genotype calls in the associated probe set. several methods for genotype calling  <cit>  and assessment of copy number  <cit>  have been developed. advanced analysis methods of dna mapping array data have focused on the identification of regions of loh, or gains and losses  <cit> .

a particular snp genotype or a numerical change in chromosome copy number can have profound effects on gene expression. a possible relation to tumor development was shown in breast cancer, where a 17q <dig> amplification was related to increased expression of genes at that locus  <cit>  and in acute myeloid leukemia , where amplification of 8p <dig> was associated with increased expression of genes such as myc  <cit> . in fact, snps as well as cnvs have recently been shown to have consistent effects, often in cis, on gene expression  <cit> . the integrated analysis of gene expression and snp array data is a prerequisite to recognize these effects. to our knowledge, only one software package is able to visualize chromosome copy number and gene expression levels  <cit> . here, we present a package, snpexpress, which allows concurrent interpretation of genotype, hmm inferred loh regions, copy number, cnvs, hmm inferred copy number and gene expression data. due to the simple format of the input data, our package is not restricted to specific methods to determine genotype, copy numbers or expression level. little knowledge of software is necessary to use snpexpress, making the tool accessible for a wide audience.

implementation
snpexpress, written in java , uses tab-delimited files as input and is currently available for use with affymetrix dna mapping arrays , illumina humanhap <dig> genotyping beadchip and affymetrix genechips . a file containing a matrix with each column representing the genotypes of one array and rows starting with illumina or affymetrix snp ids is mandatory. the genotype should be formatted as homozygous 'aa' or 'bb', heterozygous 'ab', or, 'nocall' /'nc' . similar matrix files containing copy numbers or gene expression values are optional. copy numbers should be centered around  <dig>  where  <dig> represents the normal copy number of the autosomes and  <dig> for the male x chromosome. the maximum displayed copy number is  <dig>  in case the copy number is above  <dig> this is indicated by the greyblue background. copy number-, genotype- and gene expression files required for snpexpress can be generated through tools such as affymetrix brlmm  <cit> , gcos/cnat  <dig>   <cit> , or dchipsnp  <cit>  with additional formatting in microsoft excel. in case of illumina data, snp express includes the non-synonymous snps and the mhc region, however, mitochondrial snps and y-chromosome snps are not visualized. all files can be optionally uploaded as tab- or comma-delimited .txt files or binary files. these binary files can be created from .txt files by the menu item 'convert data source'.

snpexpress maps both the snp ids  and the expression probe set ids  to the genome through internal alignment tables, using annotation provided by the manufacturer  <cit>  and  <cit> . annotation was generated using ncbi build  <dig> .

regions showing loh are calculated through a hidden markov model, which has been described previously  <cit> . the probability values for heterogeneous calls required for the hmm have been generated through sets of genotypes of normal samples. for the  <dig> k and  <dig> k array,  <dig> samples and  <dig> samples, respectively, of different ethnical background from the hapmap project are available through the ncbi geo website   <cit> . for the  <dig> k array normal matched blood samples available through the geo public repository have been processed  <cit> . since reference normal illumina genotype datasets are currently not publicly available, loh regions using this platform are not supported in this version of snpexpress.

snpexpress includes the option to visualize the results of a novel analytical method that infers the copy number of each snp based on a hmm model, which is implemented in dchipsnp  <cit> . also, all cnvs  <cit> , currently cataloged in the database of genome variants  <cit> , can be visualized.

example expression, copy number, genotype and hmm copy number example files of two aml patients can be downloaded from  <cit> .

RESULTS
genotypes and copy numbers are displayed as sequential blocks of which color indicates genotype, horizontal coordinate indicates position on the chromosome and vertical coordinate indicates copy number . the colored genotype blocks are drawn sequential in chromosome-wide view and proportional to chromosomal location when zoomed into a region of interest. gene expression levels are visualized as vertical bar at the chromosomal position of the gene-specific probe set. the height of the bar is proportional to the gene expression value. the default value is  <dig> and expression higher than  <dig> is capped at  <dig>  however, these values are user-definable. in the event that multiple probe sets span the same region in the chromosome-wide view the vertical gene expression bars are red and proportional to the highest expression value. zooming into the location of interest discloses the individual probe sets. links of snp ids to public databases are available by holding the ctrl-key and clicking on a snp id.

distinct background colors are used to accentuate genomic changes. individual copy numbers are indicated as gain  or loss  when their value exceeds a user-defined value. the default deviation threshold is  <dig> . loh is highlighted at diploid level by a bold magenta line . all colors can be adapted to the users' preferences.

from the menu, the user is able to choose to visualize either one chromosome of multiple samples or the complete genome of one sample. detailed information, containing information such as snp id, associated gene symbol, probe set id, cytoband and expression value, is shown on a mouse-over display. furthermore, a gene of interest is directly visualized through a search function, and its associated snps are indicated with an orange background color. the options to display known cnvs  or the hmm copy number results  are included . finally, relevant data of a particular minimal deleted of amplified region can be exported , cytoband, associated gene, genotype, copy number and inferred loh of the selected region) and high-resolution images of the visualization can be saved in the portable network graphic  format.

to illustrate the power of snpexpress, dna mapping array profiles of tumor samples of a series of  <dig> patients with aml were generated using affymetrix  <dig> k nspi dna mapping arrays. ficoll separation of the mononuclear cells from aml typically yields >80% pure population of leukemic blast cells. high molecular weight dna was isolated from these malignant cells and the affymetrix mapping arrays were used according to the protocol of the manufacturer. genotypes were calculated using brlmm and copy numbers were assessed using dchipsnp. biotin-labeled crna of the same aml samples was hybridized on affymetrix hg-u <dig> plus  <dig>  genechips, as described elsewhere  <cit> . the resulting dataset was imported in snpexpress for analyses. large chromosomal regions showing loss or gains of genetic material are known to be apparent in leukemic blasts of aml patients. well-known examples of chromosomal lesions in aml are monosomies of chromosome  <dig> and  <dig>  which have been associated with a poor prognosis  <cit> . using snpexpress, monosomies of chromosome  <dig> were evidently demonstrated in aml samples, previously shown by cytogenetics to have lesions involving chromosome  <dig> . snpexpress also correctly predicted the presence of loh as a result of the absence of one chromosome  <dig>  in fact,  <dig> out of  <dig> numerical cytogenetic aberrations, i.e., whole chromosomes and interstitial deletions, in  <dig> aml samples analyzed, were recognized by using snpexpress. four numerical abnormalities abnormalities, present in less than 30% of the aml cells, were missed. chromosomal gains, losses as well as uniparental disomy  may also have other important consequences, such as affecting expression of  genes. combinatorial visualization of genotype, copy number and gene expression is a prerequisite to recognize these aberrations. for example, the majority of genes show located on chromosome  <dig> show an overall decrease in expression in aml samples with a monosomy  <dig> .

large regions of homozygosity are present in approximately 20% of primary aml cases as a result of segmental upd  <cit> . these regions of upd seemed to be non-random and may be used to unmask pre-existing recessive mutations in leukemia genes, such as cebpa, wt <dig>  flt <dig> and runx <dig>  <cit> . snpexpress adequately identified regions of upd involving e.g. chromosome 11p , in two patients with a normal karyotype. upd involving chromosome  <dig> is associated with homozygous mutations in wt <dig>  <cit> . interestingly, in  <dig> out of  <dig> aml patients  large regions of segmental upd continuing to the telomere were recognized using snpexpress.

these examples demonstrate the power of snpexpress. to our knowledge, no tool is currently available that allows concurrent interpretation of genotype, hmm inferred loh regions, copy number, cnvs, hmm inferred copy number and gene expression data. moreover, no specialized knowledge is necessary to work with snpexpress.

discussion
since genome-wide dna mapping array and mrna expression studies become more cost effective, the number of samples profiled on these platforms will increase. specialized user-friendly tools for efficient visualization, such as snpexpress, will therefore be indispensable. in fact, the initial version of snpexpress has already been successfully applied in showing segmental uniparental disomy as a recurrent mechanism for homozygous cebpa mutations in acute myeloid leukemia  <cit> .

other tools for visualizing and processing snp array data, such as snpscan  <cit> , sigma  <cit> , array fusion  <cit> , partek genomics suite  <cit>  and genepattern  <cit>  have been developed. most of these tools incorporate visualization options for displaying loh  and copy number , whereas snpscan and arrayfusion have output functionality that facilitates linking snp data to the ucsc genome browser  <cit> . some are linked to a private database, which restricts pre-processing of the array data, but gives the advantage of data storage  <cit> . genepattern and the partek genomics suite provide normalization and data smoothing functionality. these two packages and snpscan have also incorporated options for combined analysis of paired samples, i.e., tumor and normal. like snpexpress, snpscan, genepattern, and the partek genomics suite can detect regions of loh, amplification and deletion. none of these tools describe the ability to process illumina beadarray files. where snpexpress may lack the opportunity to directly process raw data files , it adds integrated visualization of expression  and dna copy number and genotype  data. moreover, we believe that this is provided in a user-friendly way that does not require specialist computer knowledge.

snpexpress has some limitations. a full-length chromosome view depicting gains, losses and the regions showing loh is feasible using snpexpress. however, the large datasets generated by the  <dig> k mapping array platform makes it impossible to visualize the sequentially aligned snps of the full-length chromosomes on one screen. selecting the most informative snps, i.e., representative for particular haplotypes, may solve this issue. such algorithms are currently in development. furthermore, the current implementation of the hmm could also be improved by implementing a hmm that takes into account the effects of linkage disequilibrium, i.e., ld-hmm  <cit> . the number of samples to be visualized concurrently is limited by the memory available to the application.

CONCLUSIONS
the power of snpexpress, as with previously developed tools  <cit> , is its high accessibility and powerful visualization, which facilitates the identification of biologically and clinically relevant entities. we have shown that recurrent biologically relevant entities, such as chromosomal gains or losses and loh in aml, are accurately identified with snpexpress. hence, snpexpress will be beneficial to genome-wide studies by providing an integrated view of data from dna mapping and mrna expression arrays in an easily accessible and accurate way.

availability and requirements
project name: snpexpress

project homepage: 



operating system: platform independent

programming language: java

other requirements: java  <dig>  or higher.

license: the tool is available free of charge. source code is available upon request.

any restrictions to use by non-academics: none

list of abbreviations
aml: acute myeloid leukemia; png: portable network graphics; brlmm: bayesian robust linear model with mahalanobis distance classifier; snp: single nucleotide polymorphism; hmm: hidden markov model; cnv: copy number variation; loh: loss-of-heterozygosity.

authors' contributions
mas wrote and designed the software; rgwv designed the software, performed the analysis and wrote the manuscript; wgk performed experiments; sa gave intellectual contributions; sh contributed code; pjs gave intellectual contributions; bl gave intellectual contributions; pjmv designed the study, gave intellectual contributions and wrote the manuscript. all authors read and approved the final version of the manuscript.

