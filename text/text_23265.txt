BACKGROUND
metacyc  <cit>  and kegg  <cit>  are large metabolic pathway database  projects that have been under development for more than a decade. both projects provide reference pathways that are used to predict the metabolic pathways present in an organism from the annotated genome of that organism. metacyc has been utilized for pathway prediction in the biocyc database collection  <cit> , and in many other pathway/genome databases developed by researchers around the world  <cit> . the kegg project consists of both a reference pathway database, and the resulting projection of the reference pathways onto organisms with sequenced genomes. kegg is also widely used.

the goal of this article is to compare the data content of metacyc with the data content of the kegg reference pathway db to provide an understanding of their relative sizes, their degree of overlap, their scope, and the breadth of data that they provide. these questions are particularly important because the accuracy of metabolic pathway prediction is directly dependent upon the coverage of the reference pathway db that the pathway predictor utilizes  <cit> . most metabolic pathway predictors predict the presence of pathways that exist in a reference pathway db. another important and active area of research is the development of steady-state metabolic flux models. these models are highly dependent upon the source of metabolic reactions from which the models are derived. our analysis considers kegg and metacyc because they are the largest curated databases of metabolic reactions and pathways , containing significantly more reactions than rhea, bigg, unipathway, biopath, and reactome. although the seed and brenda contain comparable numbers of reactions, the metabolic content of the seed is largely derived from kegg  <cit> , and brenda does not include metabolic pathways.

metabolic pathway data can be thought of as consisting of three tiers: the metabolites form the lowest tier; reactions are built upon metabolites, and pathways are built upon reactions. our analysis considers all three tiers. our comparison does not include other aspects of kegg or biocyc, such as their orthology data, or their genome-based pathway predictions for sequenced organisms.

to analyze the degree of overlap of metacyc and kegg, we must know the correspondences between compounds, reactions, and pathways in metacyc, and those in kegg. establishing these correspondences is a non-trivial problem because of the non-standard terminologies used in the scientific literature for these three entities , because some metabolites lack chemical structures in one db or the other, and because stereochemical information is not present for every metabolite that contains a stereo center, thus precluding complete matching using chemical structures. we devoted significant effort to the problem of matching metabolites and reactions . as a result, many metacyc compounds and reactions now contain db links to the corresponding objects in kegg. metacyc pathways do not contain such links because metabolic pathways have more subjective definitions than do metabolites and reactions, and hence we do not expect there to be exact correspondences between the pathways in metacyc and kegg.

consider the following problem that is common to this study, to other recent studies that compare bioinformatics dbs  <cit> , and to efforts that integrate data from multiple metabolic dbs  <cit> . to compare, for example, the metabolite complements of two pathway dbs, we must know which metabolites within the dbs correspond to one another. but the algorithms that compute such correspondences are imperfect. if metabolite m in one db is found to have no counterpart in the other db, does this observation reflect the true state of affairs, or a false-negative result by the matching algorithm? we present a method for approaching this problem — namely, to sample matched and unmatched objects from the dbs and manually validate or search for correspondences to quantify the accuracy of the correspondences. a caveat for all of our analyses is that they are dependent on the accuracy and completeness of the compound and reaction correspondences that we have curated, imported, and computed. all curated, imported, and inferred links from metacyc compounds and reactions to their corresponding entries in kegg may be found in the metacyc files that are available for download from the web.

we also introduce a general method for assessing where is the semantic overlap between two dbs: we use enrichment/depletion analysis to detect whether areas of one db are disproportionately populated or depopulated with respect to the other db.

methods
we used metacyc version  <dig>   and a version of kegg downloaded on february  <dig>   <dig> for the purpose of this study, unless otherwise noted. the kegg datasets were downloaded using the kegg soap object-retrieval web services  <cit>  using the following functions via the biobike software  <cit> : list_organisms, binfo, list_pathways, bfind, bget, get_compounds_by_pathway, get_ reactions_by_pathway, and get_element_rela‐ tions_by_pathway.

the kegg data were loaded into a new pathway tools  <cit>  db  that uses the same schema as metacyc. the loaded kegg datasets were compound, reaction, map, and module. kegg chemical structures were obtained from the compound dataset, not from kegg mol files. this kegg loader was implemented in common lisp, and is available in the additional file  <dig>  once loaded into a pathway tools db, the kegg data can be queried and visualized using pathway tools. the kegg analyses reported herein were performed using common lisp programs that queried keggcyc.

comparing compound data
correspondences between metacyc compounds and kegg compounds are encoded as metacyc compounds db links to the corresponding kegg compound. such db links are added to metacyc by several means. the metacyc curation staff members add such links during their manual curation. in addition, we submit metacyc compounds with chemical structures to the pubchem standardization pipeline in order to match metacyc compound structures with pubchem compound entries. kegg compounds are also periodically processed by the same pubchem standardization pipeline. we have imported links to kegg compounds from pubchem compound dataset that are linked to both metacyc and kegg compounds. we also received compound correspondences between metacyc and kegg compounds from other research efforts, which we checked for errors before programmatically importing them into metacyc .

we implemented a rule-based system to predict additional compound matches between metacyc and kegg. we defined a set of compound match features, such that a proposed compound match required one or more features from the set, along with a compound name exact string match, in order for a match to be predicted. we defined the set of compound features for metacyc and kegg compounds as molecular fingerprint matching via pubchem  <cit>  coupled with the pathway tools compound structure matcher, exact stereo-structure matching, and “all-but-one” inference. we utilized the pre-computed molecular fingerprints for kegg and metacyc compounds in pubchem to detect compound pairs that had a tanimoto coefficient  <cit>  greater than  <dig> . we then further filtered the compound pairs by using the compound structure matcher from pathway tools, which can detect compounds with the same structure, even if there are differences in protonation state.

“all-but-one” compound match inference is where a pair of known corresponding reactions, one from metacyc and the other from kegg, have all of their substrates matched except for one pair of substrates — cm from the metacyc reaction and ck from the kegg reaction. if cm does not already have a compound link to a kegg compound, and ck does not already have a compound link to a metacyc compound, we infer a match between cm and ck.

for the exact string matching of the compound common name, name strings were “canonicalized” to remove differences such as punctuation and capitalization prior to checking for exact matches. any pair of compounds consisting of a metacyc compound and a kegg compound that had at least one feature match from the set, had an exact string match of their names, and had no contradictory matches  were inferred as compound matches. automatically inferred compound matches were randomly sampled for review by our curation staff for quality assurance.  <dig> compound correspondences were inferred using this system.

the international union of pure and applied chemistry international chemical identifier  is a method of generating a unique string representation of a chemical compound structure  <cit> . we used the official inchi software package  for generating standard inchi strings from compounds with structures in metacyc and kegg. the inchi executable was called with the following arguments: ‐stdio ‐nolabels ‐auxnone. we infer two compounds as having matching structure if their standard inchi strings are identical. we used inchi strings to detect compound matches between metacyc and kegg, and to detect duplicate compounds within metacyc or kegg. inchi strings may be used to detect differences in stereo-center orientation between two compounds that otherwise have the same structure. both kegg and metacyc contain compounds with one or more unspecified stereo centers, and thus using inchi strings to detect matching compounds may miss some legitimate matches. furthermore, inchi strings are different for two different protonation states  <cit>  of the same compound, and thus equivalent compounds with different protonation states between kegg and metacyc may be overlooked by comparing inchi strings. for related work on establishing correspondences between metabolic databases using string matching, see metrxn  <cit>   and bkm-react  <cit>  .

we assessed the accuracy of our correspondences between kegg and metacyc compounds. specifically, we applied the binomial distribution to estimate the proportion of false negatives at a confidence level of 90% and with a confidence interval of 10%, which indicated that  <dig> samples were necessary. thus, we sampled  <dig> metacyc compounds with no inferred link to a compound in kegg and manually searched for a corresponding kegg compound. we found  <dig> metacyc compounds  that did have a corresponding entry in kegg. this result implies that we have 90% confidence that the true proportion of false negative predictions is between  <dig>  and  <dig> , meaning that as many as  <dig> metacyc compounds remain to have their corresponding kegg compound determined. we used a separate sampling of  <dig> metacyc compounds with inferred links to kegg compounds in order to estimate the proportion of false positives at the same confidence level and interval. manual verification of the correspondences identified one compound  that had an incorrect correspondence. this implies that we have 90% confidence that the true proportion of false positive predictions is between  <dig> ×10− <dig> and  <dig> %, or as many as  <dig> compounds with incorrect correspondences. with the false positive and false negative rates estimated, the overall accuracy is  <dig> %, with an upper bound of  <dig> % and a lower bound of  <dig> % for the given confidence level and interval.

in addition to reporting the number of compounds in the intersection between metacyc and kegg for various compound categories, we compute the jaccard coefficient as a measure of the similarity between the two sets. the jaccard coefficient can be simply defined as the size of the intersection of the two sets divided by the size of the union of the two sets  <cit> . thus, two sets that are identical will have a jaccard coefficient of one, while two disjoint sets will have a jaccard coefficient of zero. we use the jaccard coefficient in comparing the overlap of reactions in metacyc and kegg as well.

comparing reaction data
the kegg compound dataset contains entries that are pharmaceuticals or glycan compounds, and thus have matching entries in the kegg drug and glycan datasets, respectively. these objects are designated with “d” and “g” prefixes in their identifiers and are duplicates of the standard compound objects, in the compound dataset, that use an identifier prefix of “c”. we found that the kegg reaction dataset contains duplicate reactions, where one version of a reaction will use the “c” identifiers, while the other version of the same reaction would use the “g” or “d” identifiers. we analyzed only reactions that consisted of “c” identifiers for the purpose of this study to avoid double-counting reactions.

we used a combination of manual curation, a computational rule-based system for inferring reaction correspondences, and bulk extraction of reaction correspondences from databases such as bkm-react, go, metrxn, and rhea  <cit>  to create links between metacyc and kegg reactions.

a proposed reaction match required a significant similarity of reactants and products, along with at least one match from a set of three reaction features. the first feature from the set checked the enzymes that catalyzed the pair of reactions from metacyc and kegg to see if they had at least one uniprot  <cit>  accession number in common. the second feature employed exact matches of international union of biochemistry and molecular biology  enzyme commission   <cit>  enzyme classification number matches. the third feature checked for exact enzymatic activity name matches, using kegg reaction entry names and enzymatic activity names from metacyc enzyme information associated with reaction objects. reaction and enzymatic activity name strings were “canonicalized” to remove differences such as punctuation and capitalization prior to checking for exact matches.

to detect similarities of reaction reactants and products, we defined a feature by representing reactions as column vectors in a stoichiometric matrix  <cit> . in brief, a stoichiometric matrix represents reactions as columns, and each distinct compound in the metabolic network is represented by a row. matrix values are zero unless a particular compound participates in a particular reaction, in which case the coefficient of the compound in the reaction is inserted at the corresponding row and column in the matrix. reactant coefficients are entered into the matrix as negative values; product coefficients are positive.

we inferred a match if the absolute value of the cosine similarity  <cit>  of the metacyc stoichiometry vector and the kegg stoichiometry vector was greater than  <dig>  , along with the reaction pair having one or more matches from the set of three reaction match features, and no contradictory matches. finally, any remaining pairs of reactions between kegg and metacyc that had no other matches, yet had the same ec number, and the ec number based matching was one-to-one, were inferred as matches.  <dig> reaction object correspondences were inferred using this system.

we sought to assess the accuracy of our reaction correspondences using a sampling procedure. as described for compounds, we sampled  <dig> metacyc reactions with no inferred link to a reaction in kegg and  <dig> metacyc reactions with an inferred link to a reaction in kegg. we found  <dig> metacyc reactions without links  that did have a corresponding entry in kegg. this implies that we have 90% confidence that the true proportion of false negative predictions is between  <dig>  and  <dig> , or as many as  <dig> metacyc reactions remaining to have their corresponding kegg reaction determined. we found  <dig> reactions  that had an incorrect link. this implies that we have 90% confidence that the true proportion of false positive predictions is between. <dig> and  <dig> , or as many as  <dig> reactions with incorrect links. with the false positive and false negative rates estimated, the overall accuracy is  <dig> %, with an upper bound of  <dig> % and a lower bound of 58% for the given confidence level and interval.

to assess the balance state of reactions in metacyc and kegg we used the reaction balance checker in pathway tools. this software counts the atoms present on both sides of a given reaction and checks for equality of atom counts. although metacyc compounds are protonated consistently relative to a defined ph  <cit> , we are not aware of any consistent protonation among kegg compounds. to avoid unduly penalizing kegg reactions, we also checked the balance state of reactions in both metacyc and kegg for all atoms aside from hydrogen.

comparing pathway data
metacyc contains two types of pathways: base pathways are individual metabolic pathways ; super pathways combine sets of base pathways, super pathways, and individual reactions into larger composite pathways . similarly, kegg contains analogous notions of modules and maps. kegg modules were introduced to “define tighter functional units than kegg pathway”  <cit> . the kegg pathway data were obtained from the module and map datasets. kegg modules are of four types: pathway modules, structural protein and rna complexes, functional sets, and signature modules. the latter three types of modules are not metabolic pathways and are excluded from our analyses, thus excluding more than half of kegg modules. kegg defines three “global pathways” in the map dataset: map <dig> , map <dig> , and map <dig> . these pathways include thousands of reactions from many other maps. since these three large maps are qualitatively different entities than the other kegg maps, we excluded them from the analysis herein. furthermore, kegg pathway classes where none of the associated pathway instances have any metabolic reaction data  were also excluded since they do not contain metabolic pathway data.

RESULTS
compound comparison
for each type of compound , we report the number of compounds in metacyc, the number of compounds in kegg, and the number of compounds in common between metacyc and kegg. “all chemical compounds” includes both compound classes and compound instances for metacyc; for kegg it includes all compounds in the kegg compound file. “all reaction substrates” is the union of all literal reaction substrates  in the specified db. m: all metacyc compounds; m: compounds in metacyc base pathways; m: compounds in metacyc super pathways; k: all kegg compounds; k: compounds in kegg module; k: compounds in kegg map; common: corresponding compounds by total number and by the jaccard coefficient in parentheses.

compound entries in either db may not have information on their chemical structures, and may not have comments describing the properties of the compound. associated pathways of a compound include base pathways and superpathways in metacyc and kegg maps and modules. compounds were considered duplicates if they had identical standard inchi strings.

the table presents shared attributes , and attributes unique to metacyc; the two attribute sets are further sorted based on the number of objects containing non-null values for each attribute. gibbs- <dig> is the gibbs free energy of formation of a compound. creator, creation-date, and credits provide data provenance. kegg compound attribute data are derived from the kegg compound dataset.

reaction comparison
mens are pathway reactions if they are part of one or more base pathways or superpathways. kegg reactions are pathway reactions if they are part of one or more modules or maps. columns are the same as defined for table  <dig> 

we report the number of reactions, the number of duplicate reactions, the number of reactions with comments, the number of unbalanced reactions disregarding hydrogen imbalance, the number of unbalanced reactions including hydrogen imbalance, and the average number of associated pathways. associated pathways of a reaction include base pathways and superpathways in metacyc and kegg modules and maps.

attributes are sorted based on the metacyc frequency column. attribute physiologically-relevant? describes whether a reaction occurs in vivo. reaction-direction specifies the directionality of the reaction. orphan? is true when no nucleotide or amino-acid sequence has been determined for any enzyme catalyzing this reaction  <cit> . rxn-locations specifies the cellular locations in which a reaction occurs . spontaneous? specifies whether a reaction occurs spontaneously in living organisms and therefore requires no enzyme. kegg reaction attribute data are derived from the kegg reaction dataset, and thus include glycan reactions.

since hydrogen imbalance in kegg reactions can be the result of inconsistent protonation states of the compounds involved, we consider such imbalance as a potentially less serious problem than imbalance by other elements. thus, we conducted a special set of analyses for reaction balancing where we did not count hydrogen atoms.

two reactions r <dig> and r <dig> are duplicates if the reactants of r <dig> are the same as the reactants of r <dig>  and the products of r <dig> are the same as the products of r <dig>  or ditto for the reverse of r <dig> 

pathway comparison
a summary of metacyc base and super pathways, and kegg modules and maps is presented in table  <dig>  a comparison of pathway data in metacyc and kegg is presented in table  <dig> 

kegg pathway classes were extracted from the map and module datasets based on the class attribute. comment length is measured in number of characters.

a histogram plot of the frequency of metacyc base pathway sizes  and kegg modules sizes  is presented in figure  <dig>  and a histogram plot of the frequency of metacyc super pathways and kegg maps sizes by reaction count is presented in figure  <dig> 

see table  <dig> for a comparison of other metacyc and kegg pathway object attributes. note that the kegg module attribute called compound links compound objects with modules. in metacyc the equivalent relationship is represented via reaction objects, and thus there is no need for an additional attribute.

attributes are sorted based on frequency. kegg pathway attribute data are pooled from all objects in the kegg module and map datasets . attribute species specifies the organisms in which the pathway has been studied experimentally. pathway-links lists important substrates that connect to other metabolic pathways, whereas kegg attribute rel_pathway links pathways to one another without specifying the compound in common. taxonomic-range describes the taxonomic groups in which the pathway is likely to be found; this information increases the accuracy of pathway prediction. predecessors specifies for each reaction the reaction that precede it in the pathway, and thus defines the connectivity structure of each pathway. kegg encodes equivalent data in the “ecrel” relationship, obtained from the get_element_relations_by_pathway api function. key-reactions increases the accuracy of pathway prediction by specifying reactions whose presence is highly indicative of the pathway, and distinguish the pathway from other, similar pathways. hypothetical-reactions identifies pathway reactions that are speculative and have not been firmly established experimentally. the disease attribute consists of links to the kegg disease dataset when disease-related genes encode enzymes for one or more reaction steps in the pathway.

we next sought to understand how much kegg and metacyc pathways overlap, a question that we approach from several directions. table  <dig> explores the degree to which kegg and metacyc pathways cover their respective reaction spaces. for example, if a kegg module m contains six reactions, and none of those reactions are present in  metacyc , we think of m as unique to kegg because it covers a part of reaction space that is not present in metacyc. we say that a pathway class c is enriched/depleted for reaction links if the reactions ri contained within pathway instances pj in c, are enriched/depleted  for links to reactions in kegg. such analysis is, of course, limited by the fact that our reaction links are imperfect. table  <dig> summarizes the fraction of metacyc pathways for which all, some, or none of their reactions correspond to reactions in kegg, and the converse — the fraction of kegg pathways for which all, some, or none of their reactions correspond to reactions in metacyc. metacyc pathways include a total of  <dig>  reactions not found in kegg, whereas kegg pathways include a total of  <dig>  reactions not found in metacyc.

for example, for three kegg maps, all reactions in the pathway are present in metacyc.

another way to address the degree of overlap of their pathways is through the metacyc pathway ontology. we performed enrichment/depletion analysis in order to determine pathway classes that had sets of matched reactions that were significantly smaller or larger than what might be expected by chance  <cit> . for determining the pathway classes of metacyc that were significantly enriched or depleted for reactions linked to kegg reactions, we used the pathway tools enrichment analysis feature. specifically, we ran the enrichment analysis using the exact fisher method with a maximum p-value of  <dig>  and employing the bonferroni multiple hypothesis testing correction. the results are summarized in table  <dig> for metacyc pathway classes, and in table  <dig> for kegg pathway classes. complete results are available in additional file  <dig> 

class size is the number of pathway instances for the given pathway class. the ‘links’ column is the number of reactions among the pathways of the pathway class that have links to kegg reactions, over the total number of reactions for the pathway class. the bonferroni-corrected p-value from the hypergeometric test indicates the probability that the observed proportion of reactions with links within the pathway occurred by chance. pathways with a p-value at or below a cut-off of α =  <dig>  are shown. the full list may be found in the additional file  <dig> 

class size is the number of pathway instances for the given pathway class. the ‘links’ column is the number of reactions among the pathways of the pathway class that have links to metacyc reactions, over the total number of reactions for the pathway class. the bonferroni-corrected p-value from the hypergeometric test indicates the probability that the observed proportion of reactions with links within the pathway occurred by chance. pathways with a p-value at or below a cut-off of α =  <dig>  are shown. the full list may be found in the additional file  <dig> 

we also asked whether the pathways that are unique to metacyc have a taxonomic bias. metacyc curators associate an approximate “taxonomic range” for a pathway based on their assessment that most species within the taxonomic range are likely to contain the pathway. the taxonomic-range slot lists one or more particular organisms or higher-rank taxa such as phyla or kingdoms. table  <dig> scores a metacyc pathway as unique if one-third or fewer of the pathway’s reactions have links to kegg reactions within the same kegg pathway. only metacyc taxa with  <dig> or more corresponding metacyc pathways are included. an equivalent analysis was not performed using kegg pathways, as they do not contain taxonomic information in their map or module datasets.

the id column is the ncbi taxonomy db  <cit>  identifier. the pathways column is the number of metacyc pathways that occur in that taxon based on its taxonomic-range slot. the unique pathways column is the number of metacyc base pathways for that taxon that are unique relative to kegg pathways. the percent unique column is the fraction of metacyc base pathways for that taxon that are unique relative to kegg pathways, with rows with a fraction greater than 50% shown in bold. the rows of the table are sorted with respect to the ncbi taxonomy. relative taxonomic rank is indicated by indentation. taxa of the same rank are ordered by decreasing percent unique pathways. the taxon of “cellular organisms” is included to provide a baseline from which to compare other taxa.

discussion
compounds
kegg contains more duplicate compound entries than does metacyc, but overall compound duplicates are relatively low in both dbs.

metacyc provides a richer set of compound data fields than kegg does, including smiles  <cit>  and inchi  <cit>  strings for most compounds . in addition, metacyc compounds are cross-referenced to the enzymes for which they are activators, inhibitors, and cofactors.

kegg contains  <dig>  times more compounds with comments than does metacyc, but the kegg comments are extremely short, averaging  <dig>  characters per comment. metacyc comments average  <dig>  characters in length. many kegg comments are single phrases such as “pesticide”.

metacyc contains  <dig>  names per compound compared to  <dig>  for kegg, which may render metacyc more able to recognize chemical names in chemical datasets that use non-standard nomenclature . on the other hand, kegg does contain significantly more compounds than metacyc.

reactions
as noted earlier, many metabolites within the two dbs are not substrates of any reaction; similarly, many reactions within the two dbs are not components of any pathway. this situation occurs for a variety of reasons. biologically, many metabolic reactions have not been assigned to a metabolic pathway. metacyc attempts to gather a comprehensive compendium of bioreactions for applications such as flux-balance analysis and design of novel metabolic pathways, that do not depend soley on reactions within defined metabolic pathways. in addition, some reactions in metacyc and kegg will probably be assigned to pathways curated in the future.

overall, metacyc contains  <dig>  times as many reactions as does kegg. applications such as flux-balance analysis require reactions that are fully balanced  because unbalanced reactions violate conservation of mass and thus the model can generate non-physical flux values. metacyc curators routinely encounter unbalanced reactions in the literature, and although many such unbalanced reactions can be corrected by curators, for some unbalanced reactions it is not clear how to correct them.

we can calculate for each db the number of “high quality reactions” by subtracting from each total the duplicate reactions, and the unbalanced reactions. the results are metacyc:  <dig>  and kegg:  <dig> , a ratio of  <dig> : <dig> 

metacyc also provides a richer set of attributes for reactions than does kegg, such as identification of spontaneous reactions.

the atom mapping of a reaction describes for each reactant non-hydrogen atom its corresponding atom in a product compound. kegg has provided atom-mapping data through its rpair attribute for several years; the feb  <dig> version of kegg contains atom-mapping data for  <dig>  reactions. metacyc began providing atom mapping data in version  <dig>  in november  <dig>  which contains atom-mapping data for  <dig>  reactions.

although both dbs employ generic reactions, some details of the treatment of these reactions differ. generic reactions are reactions in which one or more substrates denote a set of possible compounds, often by using r-groups. for example, the metacyc reaction deoxycytidine‐kinase‐rxn describes the reaction deoxycytidine+a nucleoside triphosphate →dcmp + a nucleoside diphosphate

kegg contains the same reaction  with the same equation. however, kegg represents the compound classes differently. in metacyc “a nucleoside triphosphate” is described by a class frame . the metacyc ontology links that class frame to several subclasses, and ultimately to eleven specific compounds that are instances of that class, such as atp. this representation allows software within pathway tools to generate instantiations of generic reactions — namely, to generate all possible instance reactions  that are specializations of the generic reaction. metacyc contains  <dig>  generic reactions, from which many additional reactions can be generated through instantiation. in contrast, although kegg contains an object representing the generic compound , that generic compound is not found in the kegg brite ontology, nor does kegg contain links from the generic compound to instances of that compound. thus, so far as we know, the kegg representations do not facilitate programmatic instantiation of generic reactions.

pathways
based on table  <dig>  metacyc contains  <dig>  times as many base pathways as kegg contains modules. metacyc contains  <dig>  times as many superpathways as kegg contains maps. because pathway size measured in reactions varies so strongly between the two dbs, comparing the dbs purely based on pathway counts can be misleading — the average metacyc base pathway contains  <dig>  reactions, whereas the average kegg map contains  <dig>  reactions. furthermore, 17% of metacyc pathways consist of a single reaction step — namely, in those cases where the metacyc curation rules on defining pathway boundaries  <cit>  result in single-reaction pathways.

a more meaningful way to compare the pathway complements of the two dbs is to compare the size of the metabolite and reaction spaces covered by these pathways. table  <dig> shows that metacyc pathways refer to  <dig>  distinct metabolites, or  <dig>  times as many as kegg. a small difference exists between the substrates covered by metacyc base pathways versus metacyc super pathways, most likely because metacyc super pathways are ultimately defined in terms of base pathways, plus some additional reactions not present in the base pathways. in contrast, there is a large difference between the substrates covered by kegg maps versus modules — modules cover a very small set of substrates compared to maps and compared to metacyc pathways.

we posit that kegg has such a small number of modules because modules were introduced to kegg in the last few years, and their coverage is still limited. for example, kegg contains one module for proline biosynthesis; metacyc contains four such pathways. kegg lacks modules for biosynthesis of the amino acids valine, glycine, aspartate, alanine, glutamine, and glutamate . that metacyc contains  <dig>  times as many base pathways as kegg contains modules means that studies such as  <cit>  that analyze the pathway content of metagenomic samples may be incomplete because they may miss pathways using the limited repertoire of kegg modules that could be found using metacyc base pathways .

metacyc pathways refer to  <dig>  reactions, or  <dig>  times as many reactions as referred to in kegg pathways. thus, the reaction spaces covered by the two dbs are very similar in size.

metacyc provides a more extensive array of pathway attributes than does kegg. some of these attributes can be used to increase the accuracy of pathway prediction, e.g., taxonomic-range and key-reactions. lacking those attributes, pathway predictions performed using kegg pathways are likely to be less accurate than for metacyc pathways.

in the years before kegg introduced its modules, kegg and metacyc employed very different conceptualizations of pathways. as discussed in detail in  <cit> , kegg maps are larger than metacyc base pathways because kegg maps are mosaics that integrate reactions from multiple organisms and multiple biological pathways. for example, kegg map <dig>  integrates reactions from pathways involving the biosynthesis of both l-cysteine and l-methionine, and their conversion to compounds such as l-cystathionine and l-homocysteine, from all domains of life. in contrast, metacyc creates separate base pathways — called pathway variants — for each distinct pathway of l-methionine biosynthesis  and l-cysteine biosynthesis  that has been experimentally elucidated in a given organism . metacyc pathway boundaries are defined  <cit>  based on evolutionary conservation, on the metabolism literature, on regulation, and on stable high-connectivity metabolites. we estimate that kegg modules are created according to principles similar to those of metacyc base pathways.

these differences in pathway conceptualization have different implications, depending on the intended uses of pathway data.  metacyc pathways  more accurately portray the exact biological pathways that occur in a specific organism, because for a kegg map, its mosaic nature means that the user cannot tell which subset of its reactions was experimentally elucidated in a particular organism.  kegg maps  are more effective at portraying the set of possible reactions that can impinge on a given metabolite in a wide range of organisms.  kegg maps are not effective for statistical correlation studies because they encompass so much metabolic ground. for example, if we compare two metagenomic datasets and find that map <dig>  is present in one but not the other, is it the biosynthesis of cysteine that is over represented, or that of methionine? or is it the biosynthesis of other compounds in this map  that are over represented? abubucker et al. make a similar point  <cit>  about kegg maps.  we argue that for pathway reconstruction in sequenced genomes, metacyc pathways are more effective because their smaller size produces more focused predictions. for example, kegg shows its map <dig>  as present in e. coli k- <dig> mg <dig> with  <dig> reactions  colored as occurring in this organism. yet, e. coli k- <dig> mg <dig> does not produce methane. a counter-example of kegg pathway prediction comes from the photosynthesis map , for which only annotations based on photosynthetic organisms can be selected on the kegg website. thus, it is unclear what rules kegg uses to call a given map as present or absent in a given organism; the rules used by pathway tools are published  <cit> .

when a map is called as present by kegg, does it predict all reactions in the map as present in that organism? for example, for the methane metabolism pathway in e. coli, are the additional  <dig> uncolored reactions inferred as present in textite. coli? since kegg pathways are known to be multi-organism mosaics, such an inference will surely contain many false-positive reactions. in contrast, when a metacyc pathway is predicted as present, the assertion is that all of its reactions are probably present, permitting a more focused and accurate prediction of the reactome of an organism. this more accurate prediction of the reactome has implications for metabolic modeling using flux-balance analysis, where missing reactions usually yield non-solvable models, whereas extra reactions can yield models that make erroneous predictions. kegg may resolve these issues once its collection of modules is more extensive, but currently its modules cover too little of metabolism to have broad utility.

we analyzed the degree of overlap on a pathway-class basis in tables  <dig> and  <dig>  revealing the pathway classes that are enriched for reaction links , and the pathway classes that are depleted for reaction links . the kegg pathway class depletion in table  <dig> shows that the metabolism of metacyc is under-represented for counterparts of the kegg maps for xenobiotics, glycans, and polyketides. for glycans and polyketides, we expect that this is because metacyc does not currently have the ability to represent abstracted versions of glycan chemical structures, nor abstracted versions of polyketide pathways, found in kegg map drawings.

miscellaneous
metacyc contains extensive data on metabolic enzymes. version  <dig>  of metacyc contains  <dig>  metabolic enzymes. metacyc describes enzyme subunit composition, substrate specificity, activators, inhibitors, and cofactor requirements. kegg does not describe the protein properties of metabolic enzymes, and therefore lacks this type of data; kegg does associate cofactors with reactions.

metacyc and kegg also differ in their licensing terms. metacyc data are freely available to all users via data file download in multiple formats, and may be openly redistributed. kegg dataset ftp downloads are available for a fee to all users, and may not be openly redistributed. kegg provides a web service api for requesting entries individually, as does metacyc.

CONCLUSIONS
we have compared the contents of the kegg and metacyc pathway dbs. because pathway dbs contain multiple types of data, our comparison is necessarily multidimensional. kegg contains significantly more compounds than does metacyc, whereas metacyc contains significantly more reactions and pathways than does kegg. however, the number of reactions occurring in pathways,  <dig>  for metacyc and  <dig>  for kegg, are quite similar. only  <dig>  of those reactions have been identified as reactions shared by the two dbs. we expect that as many as  <dig>  additional shared reactions will be found, which would leave a substantial number of reactions that are unique to each db. we estimated the set of pathways that are present in one db but not in the other db, and found that metacyc pathways not found in kegg are predominately from plants, fungi, metazoa, and actinobacteria; kegg pathways not found in metacyc are for xenobiotic degradation, glycan metabolism, and metabolism of terpenoids and polyketides. metacyc contains more reactions that are fully balanced, which facilitates metabolic modeling such as using flux-balance analysis. metacyc includes generic reactions that may be instantiated computationally. both databases contain atom-mapping data.

competing interests
the authors benefit financially from commercial licensing of the pathway tools software.

authors’ contributions
ta authored substantial text, and performed most of the comparisons and analyses. mt authored the keggcyc loader software. ak curated and checked many correspondences between kegg and metacyc. rc commented on the manuscript and provided valuable discussions on many issues. pdk supervised the research and authored substantial text. all authors read and approved the final manuscript.

supplementary material
additional file 1
the software used in building the keggcyc db is available for use with pathway tools as a common lisp source code file.

click here for file

 additional file 2
the full results of the enrichment/depletion analysis may be found in the additional file in a spreadsheet file.

click here for file

 acknowledgements
we thank joseph m. dale for helpful discussions on the jaccard coefficient, the tanimoto coefficient, and cosine similarity measures.

this work was supported by award number r01gm <dig> from the national institute of general medical sciences of the national institutes of health; and by grant number de-sc <dig> from the the office of science , u.s. department of energy. the content of this article is solely the responsibility of the authors and does not necessarily represent the official views of the national institutes of health, or of the department of energy.
