BACKGROUND
with the advent of high-density genome-wide snp arrays, examination of individual genetic data has revealed that runs of homozygosity  - many homozygous snps in a row - are a common occurrence in all populations worldwide  <cit> . consequently, there has been interest in understanding if rohs serve as risk factors underlying complex and simple disorders. there are sound theoretical reasons to suspect that rohs are associated with disorder risk. long rohs  are unlikely to have arisen by chance. rather, they are likely to denote autozygosity, which occurs when two genetic strands in the same individual come from the same ancestor - in other words, when  inbreeding occurs. inbreeding has long been known to increase the risk of many disorders. much research suggests that such "inbreeding depression" occurs via an increase in autozygosity and a corresponding increase in homozygosity at rare, partially recessive, deleterious mutations . in order for researchers to investigate the effects of autozygosity on disease, it is critical to accurately distinguish truly autozygous rohs from the larger pool of often non-autozygous rohs in a sample. the goal of this study is to investigate how accurately existing roh detection programs identify autozygosity in genome-wide snp data and which thresholds within these programs maximize the ability to detect genomic signatures of inbreeding depression.

roh analyses to date have investigated questions relevant to both basic population genetics theory and disease risk. population genetics studies have analyzed the distribution, prevalence, and location of rohs across various sub-populations to infer population structure, history, and natural selection  <cit> . phenotypic studies have used both family-based and population-based samples to identify specific associated risk rohs as well as differences in overall roh burden  <cit> . there has been recent success in identifying genes underlying simple autosomal recessive disorders in families within populations with high consanguinity using homozygosity mapping, with dozens of publications in recent years . larger scale studies using genome-wide snp data have also been conducted for complex phenotypes such as schizophrenia  <cit> , bipolar disorder  <cit> , parkinson's disease  <cit> , alzheimer's disease  <cit> , colorectal cancer  <cit> , childhood acute lymphoblastic leukemia  <cit> , and breast and prostate cancer  <cit> . non-clinical traits such as height  <cit>  have also been examined using roh analyses . however, results from these previous studies on complex phenotypes have been mixed. while significant roh have been identified for height and alzheimer's disease, no or weak evidence exists for the effects of specific roh on other phenotypes. moreover, the effects of roh burden on some complex phenotypes  were significant, whereas no effects of roh burden were found on other complex phenotypes .

a central limitation to current studies analyzing rohs is the lack of consensus criteria or even guidelines for defining a roh  <cit> . for example, lencz et al.  <cit>  only examined rohs shared by ten or more subjects and that spanned at least  <dig> snps, and did not allow for any heterozygote calls, whereas spain et al.  <cit>  examined overall roh burden across various snp and kb length thresholds, analyzed both complete and low linkage disequilibrium  snp datasets, and permitted a 2% heterozygote allowance. the discrepancy between definitions of rohs makes comparisons between study results difficult, and the lack of consensus criteria for defining roh increases the probability of false positive results due to the potential for choosing the most significant among many roh thresholds investigated  <cit> .

in a recent study  <cit> , we found that inbreeding coefficients estimated from rohs are much better at detecting the overall burden of rare, recessive mutations  than several alternatives, including inbreeding coefficients defined on a snp-by-snp basis and those defined from pedigrees. while snp-by-snp homozygosity provides an adequate test for recessive effects of common causal alleles , rohs track autozygosity, and therefore can be used to investigate the effects of homozygosity at both rare and common causal variants  <cit> . non-autozygous rohs, stretches of homozygous snps that are actually heterozygous at unmeasured variants, are less likely to contain rare, partially recessive, deleterious mutations in their homozygous form. therefore, the central criterion for defining rohs - and the only reason one would measure rohs rather than snp-by-snp homozygosity - is to assess autozygosity. in practice, this means differentiating rohs that are not autozygous and are identical-by-state  from rohs that are autozygous and are identical-by-descent . however, there has been no systematic investigation to date into which roh detection program is optimal at detecting autozygosity and which parameters within those programs maximize statistical power. the current study addresses these unanswered questions and offers some consensus criteria to capture autozygosity through roh analysis.

methods
overview of approach
our analysis simulated sequence data that mimicked ld and polymorphism properties found in modern european heritage populations, thus allowing the sequence to resemble expected autozygosity in an outbred population as well as provide perfect information about truly autozygous segments. snp data was obtained from the sequence by sampling common polymorphisms that mimicked the allele frequency distribution and snp density found in a modern dense snp chip , adding error rates and missingness patterns that were also empirically derived. using this snp data, we evaluated the performance of existing roh detection programs to detect known autozygous segments. there are three primary roh detection programs that have either been used in previously cited roh studies and/or that have been the focus of a recent publication on detection of autozygosity: plink  <cit> , germline  <cit> , and beagle  <cit> . to assess how accurately each program identified autozygosity, we estimated the rate at which non-autozygous rohs were called "autozygous"  and the rate at which truly autozygous rohs were not detected .

while low type  <dig> and type  <dig> error rates are always preferred, they cannot be minimized simultaneously: an inherent trade-off exists such that an increase in the type  <dig> error rate leads to a decrease in the type  <dig> error rate and vice versa. determining which ratio of type  <dig> to type  <dig> errors should be preferred is not obvious; here, we used a second, independent simulation to find which ratio of type  <dig> and type  <dig> error rates would maximize power to detect an association between autozygosity burden and a simulated phenotype. we started by simulating a phenotype associated with autozygosity, and from this population drew a sample containing autozygous segments at the rate found in our simulated sequence data . we then regressed the simulated phenotype on the sum of segments identified as "autozygous, " which included truly autozygous segments  as well as non-autozygous segments , as indicated by the type  <dig> and type  <dig> error rates found for the program/thresholds from the previous analysis. power in this case is defined as the proportion of significant results observed in the simulation. by comparing power across programs and across thresholds within those programs, we have an empirical, objective foundation for deciding which program and which thresholds are most suitable for detecting autozygous rohs.

generation of sequence data and mapping of autozygous segments
sequence data
in order to test the performance of detecting autozygous segments for each program, we needed genomic data that identified which segments of some arbitrary length were truly autozygous from a common ancestor within some time frame . one method would be to use real sequence data in existing samples, but detecting autozygosity in sequence data given current small samples, low pass coverage, and high error rate estimates  poses a substantial problem in accurately estimating autozygosity. instead, we generated sequence data  that tracked every allele, rare or common, in the population, allowing us to identify autozygous segments without error by finding genomic areas of some arbitrary length  that were perfectly  homozygous at the sequencing level.

we used the forward-time simulation program fregene  <cit>  to simulate full sequence data. fregene simulates a monoecious diploid population that evolves over non-overlapping generations according to a wright-fisher model  <cit> . we simulated a  <dig> mb chromosome in an effective population  of constant size  <dig>   <dig>  for  <dig>   <dig> generations, long enough for mutation-drift equilibrium to be assured  <cit> . using neutral simulation parameters recommended by fregene, we set the mutation rate at  <dig> e- <dig>  the gene conversion rate at  <dig> e- <dig> with a  <dig> bp gene conversion length, and no variants under selection. the average recombination rate was  <dig> e- <dig>  but fregene allows for realistic differences across the genome in recombination, with most  recombination occurring in hotspots of length ~ <dig>   <dig> bp that encompassed 20% of the chromosome  <cit> . it was critical to simulate patterns of ld that mimicked as closely as possible those observed in real human snp data, as the lengths, distributions, and frequencies of truly autozygous rohs and non-autozygous rohs are influenced by the population size, the degree of real inbreeding in the population, and the ld patterns between snps. for example, an isolated population with long haplotypes and long distance ld would exhibit a high proportion of long roh even if few arose from recent inbreeding. for both the sequence and resulting snp data parameters, we used snp data from control subjects in the molecular genetics of schizophrenia nongain sample  <cit>  as our empirical snp data set to check the validity of the simulation. the empirical data was ascertained on an affymetrix  <dig>  snp chip and contained ~ <dig>   <dig> snps across the  <dig>   <dig> mb of the autosomal portion of the human genome that is 'snp-mappable.'

ld in data simulated under a neutral mutation-drift model is known to have much lower ld than is observed in human data  <cit> . both reich et al.  <cit>  and schaffner et al.  <cit>  found that one or two population bottlenecks between  <dig> to  <dig>   <dig> generations ago led to ld patterns that mimic data from a population of european heritage. older bottlenecks led to less ld and more recent ones to more ld. starting from the population of ne =  <dig>   <dig> in mutation drift-equilibrium, we varied bottleneck parameters until we found those that mimicked real ld patterns when we sampled snp data from the sequence. we found that a population bottleneck reduction from  <dig>   <dig> to  <dig> individuals for  <dig> generations, followed by  <dig>   <dig> generations of evolution back at  <dig>   <dig> best mimicked the ld patterns seen in our empirical snp data , and similar to the results seen in reich et al.  <cit> .

we then turned our attention to generating simulated data that led to similar lengths and frequency of rohs as seen in our empirical snp data. we found that reducing population size to  <dig>   <dig>  and selective sampling of individuals from that reduced population best mimicked the length of rohs seen in our real data. in particular, we chose  <dig>   <dig> individuals from the sequence data that closely matched the overall proportion of roh seen in our empirical data across various roh analyses. thus, we simulated genetic sequence data that mimics as closely as possible the two parameters - ld and distribution of rohs - central to the present investigation. our sample of simulated sequence data contained  <dig>   <dig> total variants, with  <dig>   <dig> having a minor allele frequency  > 1%, and on average one variant per  <dig> bp.

mapping of autozygous segments
it would be ideal to keep track of autozygous segments through the course of our sequence simulation. unfortunately, no sequence simulation program that we are aware of tracks autozygosity. as a substitute that will detect all but the shortest autozygous tracks, we identified autozygous segments by finding stretches of sequence data that were perfectly homozygous. to do this, we first used the genetic distance map derived from the fregene simulation to estimate the expected length of autozygous segments. by definition, both genetic strands making up an autozygous segment originate from a single common ancestor, however the length of this segment decreases on average over time due to recombination. specifically, the expected length of an autozygous segment follows an exponential distribution with mean equal to 1/ <dig> g morgans, where g is the number of generations since the common ancestor. thus, the expected length of an autozygous segment caused by sib-sib inbreeding  is 1/ <dig> morgan or  <dig> cm, while the expected length of an autozygous segment originating from a common ancestor  <dig> generations in the past is  <dig> cm .

because the shortening of autozygous lengths due to recombination occurs gradually across generations, any choice of distance threshold to define autozygosity is ultimately arbitrary. we chose two thresholds that were consonant with the lengths of homozygous runs being reported in the literature and that were realistically detectable using modern snp platforms. the first  threshold captured 80% of autozygosity originating in common ancestors within the past  <dig> generations , and the second  threshold captured 80% of autozygosity originating within the past  <dig> generations . as shown in the areas under the curve in figure  <dig>  these thresholds correspond to a minimum genetic distance of  <dig>  cm  for  <dig> generations back and  <dig>  cm  for  <dig> generations back, where the genetic distance derived from fregene recombination is  <dig>  cm/mb. by requiring segments in our sequence data to be completely homozygous, new mutations arising within the last  <dig> or  <dig> generations on either segment would cause regions to be missed that were truly autozygous. to ensure that autozygous segments were completely homozygous and therefore detectable with 100% fidelity, we allowed no new mutations to arise during the final  <dig> generations of the simulation. such a 'mutational freeze' has a negligible impact on the resulting snp data, as recent neutral mutations very rarely rise in frequency to be considered snps   <cit> . on the other hand, the mutational freeze did affect sequence data, but given that sequence data was only used for inferring autozygosity, this strategy did not affect our conclusions. within the past  <dig> generations, the average autozygous segment spanned  <dig>   <dig> variants and  <dig> kb in length, with total autozygosity covering  <dig> % of the sequence data. within the past  <dig> generations, the average autozygous segment spanned  <dig>   <dig> variants and  <dig> kb in length, with total autozygosity covering  <dig> % of the sequence data.

extracting snp data from sequence data
we extracted a subset of variants from the simulated sequence data to mimic several properties found in empirical snp data measured on a modern, commonly used snp platform . we first sampled a subset of snps that matched the maf distribution from our empirical data . we then extracted snps that matched the spatial snp density found in a  <dig> mb portion of chromosome  <dig>  of our empirical snp data, giving us  <dig>   <dig> snps . we then added 'genotyping errors' through random sampling of the snp data at a low  and high  rate, the low rate corresponding to error rates observed in rabbee & speed  <cit>  and the high rate corresponding to the error rate of a small number of duplicate genotyped individuals in our empirical data . we used error probabilities informed by the discordant calling rates observed by rabbee & speed  <cit> , with heterozygous snps being called homozygous at a roughly threefold higher rate than homozygous snps being called heterozygous. missingness was then added through random sampling by converting snps to missing values based on missingness rates  seen in the empirical data. finally, we applied standard gwas cleaning procedures   <cit> , resulting in a dataset of  <dig>   <dig> snps in the low error rate data , and  <dig>   <dig> snps in the high error rate data . plink, germline, and beagle used these two snp datasets for their roh analyses.

roh detection algorithms, tuning parameters, and thresholds
plink
the -homozyg option in plink v <dig>   <cit>  makes roh calls using a sliding window that scans along an individual's snp data to detect homozygous stretches. plink first determines whether a given snp is potentially in a roh. to call a snp as part of a roh, plink calculates the proportion of completely homozygous windows that encompass that snp. for example, a snp inside a  <dig> snp window has  <dig> chances to be part of a homozygous stretch as the window slides across one snp at a time. using the default -homozyg-window-threshold of  <dig> , if 5% of these windows are completely homozygous, then the snp will be included in the roh. finally, a roh is called if the number of such "roh snps" in a row surpasses a user-defined threshold in terms of snps  and/or kb distance . plink provides numerous other user-defined parameters, such as the size of the sliding window measured in units of snp length , the number of heterozygous snps  allowed in the roh, the number of missing snps  allowed in the roh, and several other parameters detailed on the plink website . of note, the --homozyg-window-kb option in plink, which defines windows in terms of distance rather than snps, is currently non-functional.

- heterozygote allowance
- snp threshold to call a roh
- sliding window size in snps
- missing snp allowance
- window threshold to call a roh
fixed parameters:
- sliding window size in kb
- kb threshold to call a roh
- minimum snp density to call a roh
--homozyg-window-het
--homozyg-snp
--homozyg-window-snp
--homozyg-window-missing
--homozyg-window-threshold

--homozyg-window-kb
--homozyg-kb
--homozyg-density 
0/1
15/25/50/75/100/200/350/500
same as snp threshold



 <dig> 
 <dig> 
 <dig>   <dig> 
- mismatching heterzygote allowance
- minimum roh length 
- window size in snps
fixed parameters:
-err_het
-min_m 
-bits

0/1
 <dig> / <dig> / <dig> / <dig> /1/2/ <dig> /5
expected number of snps for given cm length

- non-hbd to hbd transition rate
- hbd to non-hbd transition rate
each program can be run using a command line prompt allowing for each tuning parameter to be defined.

plink does not account for maf or ld in its algorithm. aside from the roh tuning parameters available in plink, taking into account maf and ld in snp data will also affect how roh are identified. in particular, many low maf snps in a row can increase the probability of chance  roh segments, and high ld within dense snp regions can also have this effect. to minimize the probabilities of spurious roh calls, we used ld-pruned data , such that we first removed snps with maf <  <dig> , and then used plink's --indep command to prune for ld at two levels, which we term "moderate" and "heavy" ld pruning. moderate ld pruning removed snps within a  <dig> snp window that had r <dig> >  <dig>   with all other snps in the window, removing  <dig>   <dig> snps  within the low error snp data, and removing  <dig>   <dig> snps  within the high error snp data. heavy ld pruning removed snps within a  <dig> snp window that had r <dig> >  <dig>  with other snps , removing  <dig>   <dig> snps  within the low error snp data, and removing  <dig>   <dig> snps  within the high error snp data. we used vif ld pruning because we found this procedure led to more consistent snp densities across different snp platforms than ld pruning based on pairwise comparisons of snps. using these two levels of ld-pruned snp data along with the unpruned snp data, we ran a total of  <dig> roh analyses in plink , with specific parameters detailed in table  <dig>  we used snp size roh thresholds rather than kb length roh thresholds in plink because the former outperformed the latter , which is likely because snp size thresholds are more robust to the variance in snp density across the genome.

germline
the principal use of germline  <cit>  is identity by descent  mapping between individuals, where roh analysis is the special case of ibd within an individual. a roh analysis in germline is carried out with the -homoz or -homoz-only command. for reasons of efficiency, germline breaks up snp data into non-overlapping windows of a user-specified length in snps . windows that are completely homozygous are tagged. if several tagged windows are in a row and surpass a user-defined length threshold in terms of genetic  or physical  distance, the region is called a roh. we used minimum genetic distance rather than minimum kb for our roh thresholds because genetic distance is likely to be more sensitive to variation in recombination rates across the genome. to accommodate various genetic distances, we set the window size threshold to be the expected number of snps for a given genetic distance. for example, given that our simulated data encompasses  <dig> cm, a  <dig> cm window size would be  <dig> snps in the low error snp data , but only  <dig> snps in the low error snp data heavily pruned for ld . because rohs must be in multiples of the window size threshold, germline's resolution of roh start/end points is less fine grained than plink's, and small autozygous segments may be missed by germline. like plink, germline also allows for a user-defined number of heterozygous calls to exist in a window . also like plink, germline does not account for snp maf or ld. thus, we included the same maf and ld pruned data subsets used in the plink analysis. we ran at total of  <dig> roh analyses in germline , with specific parameters detailed in table  <dig> 

beagle
beagle's roh detection algorithm  <cit>  uses a fundamentally different approach than plink or germline. beagle employs a hidden markov model  that incorporates ld between snps and haplotype probabilities from the entire sample when calling roh segments . two user-defined prior probabilities set the baseline expectation of detecting an autozygous segment in a single cm stretch of snp data. the non-hbd to hbd transition rate is the prior probability per cm of a non-autozygous snp becoming autozygous  . lower values mean that autozygosity is expected to be less common. conversely, the hbd to non-hbd transition rate is the prior probability per cm of an autozygous snp becoming non-autozygous . lower values mean that autozygous runs are expected to be shorter. beagle outputs an individual × snp matrix of posterior probabilities that each snp is part of an autozygous segment.

because beagle's hbd program accounts for ld, we did not use pruned snp data in the beagle analysis. for prior parameters, we set the non-hbd to hbd transition rates of  <dig> ,  <dig> , and  <dig> , and set the hbd to non-hbd transition rates at  <dig>   <dig> , and  <dig> . it should be noted that this is a large range of priors, and that they include the default priors  <cit> . as suggested in browning and browning  <cit> , to avoid false negatives, we also used the maximum posterior probability for each snp across  <dig> independent iterations of their program to compare with results from a single iteration. in all, we ran at total of  <dig> beagle analyses .

all simulations, statistical programming, and graphing were done using r statistical software  <dig> . <dig> http://www.r-project.org.

comparison of true autozygosity to detected roh
to get an estimate of the type  <dig> error rates  and type  <dig> error rates  for each program, we compared known autozygosity from the sequence data  to detected roh from each analysis. these two types of errors were called on a per-snp rather than per-roh basis, as calls can be correct for one part of an autozygous segment and wrong for another. to calculate the type  <dig> error rate, we summed the total number of snps that were type  <dig> errors and divided it by the total number of non-autozygous snps. to calculate the type  <dig> error rate, we summed the total number of snps that were type  <dig> errors and divided it by the total number of autozygous snps. we then estimated d', an index of measurement sensitivity in signal detection that incorporates both type  <dig> and type  <dig> error rates . d' is estimated as: φ - φ, where φ is the distribution function of a standard normal, which converts a proportion to a z-score value. our estimated d' values are included in the table of our top regression power estimates .

estimation of regression power
while d' measurements are a good estimate of measurement sensitivity, it has limitations. first, as the type  <dig> or type  <dig> error rate approaches zero, d' approaches infinity. second, two identical d' estimates can have very different ramifications on the actual number of errors made if the prior probabilities of the errors differ, making it difficult to know which ratio of type  <dig> to type  <dig> error rates is optimal. an alternative and preferable method to d' is to ask what ratio of type  <dig> to type  <dig> errors would maximize statistical power to detect a relationship between whole-genome autozygosity burden and a phenotype . this approach not only circumvents the limitations surrounding d' estimates, but also addresses a commonly tested hypothesis in clinical roh research. furthermore, power results derived from testing whole-genome roh burden apply to single roh association hypotheses  as well because the error probabilities in detecting autozygosity are equivalent at the single roh level and at the whole-genome level.

to estimate statistical power of a whole-genome roh burden analysis informed by the type  <dig> and type  <dig> error rates, we simulated a sample of  <dig>   <dig> individuals, with every individual's genome split into 'potential' autozygous segments of equal length  and  <dig>   <dig> segments for the  <dig> generation autozygosity map ). each segment had a probability of being autozygous at the rate observed in our simulated sequence data . while the true level of autozygosity in modern outbred populations is unknown, these base rates are likely to be close to the true level because the simulation parameters and selective sampling of the sequence data were chosen to mimic the level of ld and distribution of rohs found in modern european populations. a continuous phenotype was created for each individual such that the summed autozygous segments within individuals accounted for a small percentage  of the variance of their phenotype score. the choice of the variance accounted for  is purely arbitrary; other choices would raise or lower the absolute levels of detected power but have no effect on the relative differences between various estimates of statistical power, and therefore would have no influence on our final conclusions. we then simulated true calls, false calls , true non-calls, and false non-calls  using the observed error rates from each roh analysis. we summed the called rohs for each individual  and regressed the simulated phenotype on this sum. to derive our power estimates, we repeated our simulated regression  <dig>   <dig> times for each analysis. regression power was defined as the proportion of trials associated with a positive slope and p-value <  <dig> , so a power estimate of  <dig>  would mean that  <dig> of the  <dig>   <dig> simulations positively associated the simulated phenotype with overall roh burden.

RESULTS
overall, plink consistently generated the highest regression power estimates for detecting autozygosity, outperforming germline and beagle. figures  <dig> and  <dig> show the range of regression power estimates for plink, germline, and beagle . in general, plink and germline power estimates were highly sensitive to their tuning parameters, whereas beagle power estimates were insensitive to all prior probability parameters. for the plink results, power was highest when using moderately ld-pruned snp data, with un-pruned and heavily ld-pruned snp data performing below the top power estimates. not surprisingly, higher genotyping error rates generally led to lower regression power estimates in plink and germline.

given these initial results, we decided to look in more detail within the plink roh analyses for the optimum level of ld-pruning and minimum snp threshold. in addition to moderate ld-pruning, we included "light" ld-pruning, where we removed snps that had r <dig> >  <dig>  with other snps in a  <dig> snp window , removing  <dig>   <dig> snps  within the low error snp data, and removing  <dig>   <dig> snps  within the high error snp data. we also included "moderate-heavy" ld-pruning, where we removed snps that had r <dig> >  <dig>  in a  <dig> snp window , removing  <dig>   <dig> snps  within the low error snp data, and removing  <dig>   <dig> snps  within the high error snp data. we also varied the minimum snp threshold between  <dig> and  <dig> snps in increments of  <dig> snps.

the fine-scale results from plink  show that power was maximized using light to moderate ld-pruning, with the power from moderate-heavy ld-pruning peaking well below the maximum power estimates. comparisons with the results presented in figure  <dig> show that both light and moderate ld-pruning are roughly equivalent in terms of regression power. the effect of allowing for a heterozygote call often depended on the minimum length of called roh, but with respect to the highest power results, allowing for heterozygote calls never performed better than allowing for no heterozygotes. finally, the optimum snp threshold for calling rohs depended on how ancient the autozygosity was. when using moderate ld-pruned data, a  <dig> snp minimum threshold worked best to detect autozygosity within the past  <dig> generations, whereas a  <dig> snp minimum threshold worked best to detect autozygosity within the past  <dig> generations. in general, higher minimum snp thresholds  detect recent autozygosity better, whereas lower thresholds better detect ancient autozygosity. this is expected as autozygous segments are broken into shorter lengths due to recombination over generational time. table  <dig> lists the top regression power results within the past  <dig> and  <dig> generations for both high and low genotyping error rates.

listed are the top four repression power results for detecting autozygosity within the past  <dig> and  <dig> generations, and within low and high snp genotyping error. low genotyping error =  <dig> % genotyping error rate. high genotyping error = 1% genotyping error rate. length = minimum snp or cm length to call a segment. est kb = minimum expected kb distance for the given length. het = number of heterozygotes allowed in a segment. α = type  <dig> error rate. β = type  <dig> error rate. d' = d-prime estimate. ld-pruning = level of ld-pruning. moderate = removal of snps within a  <dig> snp window that had vif greater than  <dig> . light = removal of snps within a  <dig> snp window that had vif greater than  <dig> .

regression power estimates for germline were similar in pattern but consistently lower than power estimates for plink, which was likely driven by the lower start/end resolution of roh calling in germline . to ensure that the discrepancy between germline and plink results were not due to the different ways that roh length thresholds were defined, we also looked at minimum snp thresholds in germline , finding virtually identical results to plink, but with slightly lower regression power estimates at all thresholds .

beagle was very conservative in detecting autozygous segments, with consistently high type  <dig> error rates despite using the maximum posterior probability from  <dig> iterations and a reduced threshold for calling roh to any posterior probability greater than 10% . in short, applying liberal roh calling parameters did not significantly improve the conservative estimates for beagle.

computational time
there were major differences in computational time between the three programs. for our  <dig> mb data using  <dig>   <dig> individuals, a single plink and germline roh analysis took under  <dig> seconds, whereas a single beagle hbd analysis took ~ <dig> minutes . both plink and germline analysis times scale up linearly with respect to distance, so a whole-genome analysis for  <dig>   <dig> individuals should take under  <dig> minutes. on the other hand, beagle analysis run time scales exponentially, so while beagle runs a separate analysis on each chromosome, chromosome size and sample size greatly affects the computational time.

discussion
by simulating sequence and snp data to match important population genetic properties found in empirical snp data, we were able to compare the performance of roh detection programs to identify true levels of autozygosity expected in large, outbred populations of european heritage. plink consistently outperformed both germline and beagle, producing higher regression power estimates for detecting autozygosity within  <dig> and  <dig> generations, regardless of the genotyping error rate. while we found, as expected, that germline performed worse than plink due to the lower resolution of start/end points of rohs, we were surprised by the lower performance of beagle; we expected that the incorporation of ld information to result in higher accuracy to detect autozygosity. however, this did not appear to be the case. rather, beagle was consistently conservative, and changing the tuning parameters did not alter this. as currently designed, at least, beagle appears optimized to detect rather long autozygous segments arising from a recent common ancestor, but has not been designed to detect the more ambiguous autozygous signals from distant common ancestors.

recommendations
our results suggest that plink is the most suitable program for detecting autozygosity arising from distant ancestors . our results also demonstrate that removing low maf  snps and removing snps through light-to-moderate ld-pruning  prior to the analysis minimizes the trade-off between the exclusion of non-autozygous rohs and the cost of missing shorter autozygous rohs. in particular, ld-pruning improves detection accuracy by removing redundant snps within snp-dense regions, making snp coverage more uniform with respect to recombination distance and allowing roh calls to be less dependent on the variation in snp density across platforms. moreover, our results suggest not allowing any heterozygote snps to exist in a called roh. our recommendations regarding the minimum snp threshold, however, vary slightly depending on what strength of ld pruning is used and on the time since the common ancestor of the autozygous segment. for example, to detect autozygosity arising from a common ancestor within the past  <dig> generations, a  <dig> snp minimum threshold is preferred when using light ld-pruning, while a  <dig> snp minimum threshold is preferred when using moderate ld-pruning. both thresholds cover a minimum physical distance of ~ <dig> kb, but moderate ld-pruning retains fewer snps across that distance. analyses geared towards detecting more recent autozygosity should increase the minimum snp length threshold. when we examined autozygosity arising from common ancestors within the past  <dig> generations, a  <dig> to  <dig> snp minimum threshold performed best when using moderate ld-pruning, depending on how much error is expected in the snp data. because our recommendations include ld-pruning, the increased snp density of modern platforms should have a minimal effect on our recommendations, as the level of ld between snps remains roughly constant regardless of snp density.

-  <dig> snp threshold
-  <dig> snp threshold
-  <dig> snp threshold
-  <dig> snp threshold
low genotyping error =  <dig> % genotyping error rate. high genotyping error = 1% genotyping error rate. moderate ld-pruning = removal of snps within a  <dig> snp window that had vif greater than  <dig> . light ld-pruning = removal of snps within a  <dig> snp window that had vif greater than  <dig> .

limitations
despite our efforts to simulate realistic sequence and snp data, additional factors that occur in real data, such as genotyping plate effects, autozygous runs caused by positive selection, hemizygous deletions, snp-poor centromeres, and uniparental isodisomy  were not simulated and may affect estimates of roh in real data. we did not investigate several additional questions, such as the effects of our recommendations for detecting rohs in non-european heritage or isolated populations. we also did not investigate optimal thresholds/program for detecting more recent or more ancient autozygosity. however, autozygosity arising from more recent ancestors becomes increasingly easy to detect, and most programs/thresholds should detect it with very high fidelity. autozygosity arising from more ancient common ancestors is more difficult to detect but may nevertheless be detectable as snp chips become denser. however, the variation between individuals in overall burden of such ancient autozygosity becomes very small  <cit> , and thus there are diminishing returns from attempting to detect such ancient autozygosity, at least with respect to analyses investigating overall roh burden.

CONCLUSIONS
plink has been the most commonly used roh detection program to date. however, only one study analyzed data that was pruned for ld  <cit> , which we have found to be an important step for improving the accuracy of detecting autozygous rohs. two studies adjusted their minimum roh snp threshold upward to account for ld creating roh by chance  <cit> , but our results show that without explicit ld-pruning, the increase in detection error cannot be overcome by larger roh size thresholds. while thresholds for calling rohs varied across previous studies due to the lack of consensus criteria, most previous studies adopted more liberal thresholds than our results suggested are optimal. thus, power in previous studies was likely to be lower than optimal due to inclusion of many non-autozygous rohs.

the current study is the first of its kind to directly assess the ability of current roh detection programs to estimate genome-wide autozygosity. our results should apply equally well to research on autozygosity using whole-genome roh burden or single roh association mapping. none of the programs tested perfectly detects autozygosity, and new parameters and algorithms may further minimize detection error and increase sensitivity to detect autozygous segments. until then, the results in this study represent an important step for developing working 'consensus criteria' for defining roh.

competing interests
the authors declare that they have no competing interests.

authors' contributions
dph designed the study, performed all statistical analyses, and drafted the manuscript. mck conceived of the study, simulated the genetic data, participated in study design, and helped to draft the manuscript. mas participated in the study design and helped to draft the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file 1
maf distribution of empirical snp data, simulated sequence data, and simulated snp data drawn from sequence

click here for file

 additional file 2
after maf pruning of the simulated sequence data, snps were drawn to closely match snp base positions observed in empirical snp data

click here for file

 additional file 3
type  <dig> and type  <dig> errors for autozygosity within  <dig> generations using plink and germline

click here for file

 additional file 4
type  <dig> and type  <dig> errors for autozygosity within  <dig> generations using plink and germline

click here for file

 additional file 5
type  <dig> and type  <dig> errors using beagle

click here for file

 additional file 6
figure legends for additional files  <dig>   <dig>  and 5

click here for file

 acknowledgements
the authors would like to thank sharon browning, brian browning, itsik pe'er, alexander gusev, peter visscher, and michael goddard for their helpful comments and useful suggestions.

funding
contribution by dph and mas was partially supported by two institutional training grants from the national institute of child health and human development  and the national institute of mental health . contribution by mck was supported by a grant from the national institutes of health and the national institute of mental health .

funding support for the molecular genetics of schizophrenia  genome-wide association of schizophrenia study was provided by the national institute of mental health  , and the genotyping of samples was provided through the genetic association information network  and the mgs non-gain network. the datasets used for the analyses described in this manuscript were obtained from the database of genotype and phenotype  found at http://www.ncbi.nlm.nih.gov/gap through dbgap accession numbers phs <dig> v <dig> p <dig> and phs <dig> v <dig> p <dig>  samples and associated phenotype data for the genome-wide association of schizophrenia study were provided by the molecular genetics of schizophrenia collaboration ) and university of chicago .
