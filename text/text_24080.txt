BACKGROUND
microarray experiments are routinely conducted to assess associations of experimental factors  with gene expression profiles. the affymetrix genechip® gene expression analysis array, one of most commonly used microarray technologies, uses multiple oligonuleotides  to measure expression abundance of a single gene. recognizing that non-specific hybridization could significantly alter the accurate quantification of transcript abundance, affymetrix designs the array to contain two types of probes. probes that are perfectly complementary to the target sequence, called perfect matches , are intended to measure mainly specific hybridization. a second set of probes identical to pm except for a single nucleotide in the center of the probe sequence , called mismatches , are intended to quantify non-specific hybridization  <cit> . a pm and its corresponding mm constitutes a probe pair, and multiple probe pairs, i.e. a probe set, are summarized to measure transcript abundance for a particular gene. "probe measure" is used in this paper to refer to the manner in which probe hybridization is quantified based on a pair of pm and mm intensity values. for example, pm-mm is a probe measure, and pm only is another probe measure.

a number of methods have been developed to quantify gene expression abundance from genechip® expression analysis array data using different probe measures and summary schemes. among them, microarray suite  <dig>    <cit> , dchip  <cit>  and robust multiple-array average   <cit>  are the best known.

prior to mas  <dig> , the probe measure used in mas  <dig>  was pm-mm  <cit> . the problem arises when a significant proportion of mm values, , is greater than the corresponding pm values, which makes pm-mm negative. to resolve this anomaly, in mas  <dig> , affymetrix computes an "ideal mismatch"  based on missing data theory such that pm-im is always greater than zero  <cit> . then, all probe pairs are used to estimate a gene expression value based on tukey's biweight algorithm. however, even with the use of im, the variation among probes could be greater than between samples.

li and wong modelled probe level data to generate model based expression index  and implemented it in the dchip software  <cit> . noting that probe specificity is significant, highly reproducible and predictable, li and wong used a hybridization rate parameter to account for the hybridization specificity for a probe. for a probe pair, hybridization rates are different for pm and mm; the former is always greater than the latter, and both are greater than zero. the rate was fixed for the same probe across all the samples. both pm and mm together or pm only, can be used in the li and wong model.

another approach, rma, available from bioconductor  <cit> , summarizes probe intensities into a gene expression measure based on an additive model on the logarithmic scale of a background corrected pm   <cit> . rma estimates a common mean non-specific hybridization background  from pm using a convolution model and then subtracts this background from pm to generate the pmrma.

the gene expression obtained from either mas  <dig>  or dchip or rma can then be used to associate the gene expression values with experimental factors using an algorithm of the users' choice. three main factors affect the analytical results of differential gene expression analysis: the probe measure chosen, the algorithm used to summarize probe level data into gene expression , and the model used to associate gene expression with the experimental factors . direct comparisons of the various approaches proposed for analyzing genechip® gene expression data are complicated considering these three factors. generalizing the various algorithms into one framework would facilitate comparisons.

in this paper we propose a class of generalized probe models  that includes various analytical approaches for genechip® gene expression analysis array data as special cases. using an empirical dataset, we assess the impact of different processes on the analytical results by comparing different formulations of gpm as well as gpms with three other methods, mas  <dig> , dchip, and rma.

RESULTS
we applied gpm to the analyses of data obtained from a study investigating gene response to atra  or drug diluent . briefly, at twenty-four hours after treatment, total rna was extracted from cells, processed and hybridized to the hugenefl genechip®. the dataset consists of ten samples from the atra treatment group and ten samples from the control group  in four medulloblastoma cell lines. we are interested in identifying genes that are differentially expressed between the two treatment groups.

we used three different probe measures: pm-im, pm only and pmrma, and compared the performance of different methods using standardized coefficients, defined as the estimated coefficient divided by its standard error. the reason for using this index is that the standardized coefficients, usually known as z-score test statistics, are independent of scale, and may be used to make statistical inference.

gpm- <dig> , gpm- <dig>  and gpm- <dig>  can be derived from the full gpm model  by making different statistical modeling assumptions. gpm- <dig> takes summarized gene expressions and associates them with experimental factors; gpm- <dig> and gpm- <dig> directly associate probe level data with experimental factors without first summarizing gene expressions .

comparison of gpms with three other commonly used methods
we compared gpms with three commonly used methods, i.e. mas  <dig> , dchip, and rma. each of these methods dictates its own specific probe measure, i.e. pm-im in mas  <dig> , pm-mm, or pm only in dchip and pmrma in rma. we found that all the methods were similar when the same probe measure was used, and the dissimilarity between the mas  <dig>  and other pm based approaches most likely stems from the different probe measure used. we first computed the gene expression using the software available for mas  <dig> , dchip  and rma, and then estimated the standardized coefficients for each gene with the association model gpm- <dig>  we refer to these analytical options as mas  <dig>  pm-im and hereafter , dchip pm and rma pmrma, respectively. figure  <dig> shows the pair-wise comparisons among mas  <dig>  pm-im, dchip pm, and rma pmrma. for each pair-wise comparison, we plotted the standardized coefficients for each pair in a xy plot. to assess the similarity between two methods, we computed the correlation coefficients  between the standardized coefficients generated from the two methods. in addition, we computed the mean squared error  between the two standardized coefficients, i.e. , where n is total number of genes, zj <dig> and zj <dig> are the standardized coefficients for j th gene, for two methods, respectively. when two methods are similar, the xy plot of their standardized coefficients will lie closely along the diagonal line. correspondingly, the correlation coefficient will be closer to one and the mse will be closer to zero. in figure  <dig>  we see smaller r and larger mse in the comparisons of mas  <dig>  pm-im versus dchip pm, and mas  <dig>  pm-im versus rma pmrma compared to dchip pm versus rma pmrma.

next, using probe measures of pm only and pm-im, we directly  estimated standardized coefficients with gpm- <dig>  and gpm- <dig>  respectively. figure  <dig> shows the pair-wise comparisons among mas  <dig>  pm-im, gpm- <dig> pm, gpm- <dig> pm, gpm- <dig> pm-im, and gpm- <dig> pm-im. we see greater similarity between mas  <dig>  pm-im and gpm- <dig> pm-im or gpm- <dig> pm-im , than between mas  <dig>  pm-im and gpm- <dig> pm or gpm- <dig> pm . in the latter comparisons, only the probe measure is different indicating that the probe measure plays a more significant role than the combined effect of the summary algorithm and the association model.

comparison among the gpms
we also compared the results from gpm- <dig> , gpm- <dig>  and gpm- <dig> , to evaluate their differences, and found similar results when using the same probe measure. we selected the top eight candidate genes from the results of mas  <dig>  pm-im and used them to compare the performance of gpm- <dig> pm-im and gpm- <dig> pm-im. in table  <dig>  for the eight selected genes we list estimated coefficients, their standard errors and standardized coefficients, estimated under the three gpm models. from table  <dig>  for these eight selected genes, the statistics generated from the three gpms formulation are similar using probe measure of pm-im. next, to compare the standardized coefficients on a genome-wide scale, figure  <dig> panel a shows the pair-wise comparisons using probe measure of pm-im. figure  <dig> panel b shows the pair-wise comparisons using pm only and pmrma. the six plots in figure  <dig> demonstrate the similarity of standardized coefficients on a genome-wide scale among variants of gpms when the same  probe measures are used in the analyses.

estimated coefficients , their standard errors  and standardized coefficients  for eight candidate genes from gpm- <dig> , gpm- <dig> and gpm- <dig> using pm-im

in summary, we conclude that the gpms are similar to mas  <dig> , dchip and rma on a genome-wide level when using the same probe measures and that the choice of probe measure may be more important than the summary algorithms to obtain the gene expression or models used to compute the coefficients.

discussion
in this paper, we have described a general framework that can be used to compare various methods and evaluate their similarities and differences. we found that various methods tend to generate similar results, on a genome-wide scale, when the same probe measure is chosen, and probe measure seems to have greater impact on the analytical results than other factors.

in figure  <dig>  we compared the standardized coefficients estimated with gpm- <dig> using gene expression computed from mas  <dig> , dchip and rma with their own dictated probe measures. since we consistently used gpm- <dig> as the association modeling machinery for each analysis, we assessed the combined impact of probe measure and summary algorithm. we found that the results obtained from dchip pm and rma pmrma were similar to each other, but different from those obtained from mas  <dig>  pm-im. although dchip pm and rma pmrma use different summary algorithms, their analytical results are similar due to the pm based probe measures used in both analyses.

in figure  <dig>  we see again, that on a genome-wide scale, results from mas  <dig> , gpm- <dig> and gpm- <dig> are more similar when same probe measure is used than when the probe measures are different, indicating that the probe measure plays a key role in determining the similarity of results from two methods. our preliminary analyses suggest that the choice of probe measure has bigger impact on the results than summary algorithm and association modeling.

for the three variants of gpms, we compared the standardized coefficients from gpm- <dig> or gpm- <dig> with those from gpm- <dig> using the gene expression values computed in mas  <dig> , dchip and rma. from the high r values  in the six plots shown in figure  <dig>  we infer that the standardized coefficients obtained from variants of gpms are similar when they used the same probe measure.

for seven of the eight candidate genes selected by gpm- <dig> using gene expression values generated by mas  <dig> , the gene-specific regression coefficients were similar among the mas  <dig>  pm-im, gpm- <dig> pm-im and gpm- <dig> pm-im. this indicates that for these seven genes it makes little difference between using summary measures or modeling directly at the probe level data in gmp- <dig> or gpm- <dig>  when the same probe measure is used.

in addition to the three factors we mentioned  that have an impact on analytical results, data pre-processing/normalization could also affect the analytical results. some researchers combine the probe measure and pre-processing normalization together. normalization matters the most when the arrays in an experiment are not comparable to each other. in such cases, normalization process could significantly impact on the result. in our case, we normalized the data in the gpms using a regression-based approach  <cit> , either at probe level in gpm- <dig> and gpm- <dig>  or on gene expression level in gpm- <dig>  the expression measures obtained from dchip and rma were normalized by their own normalization schemes. however, even with the different normalization schemes, probe measure appears to be the primary factor to impact the results in our data set.

an important feature of the framework presented in this paper is that it accommodates various probe measures  to quantify the abundance of the transcript. a question arises: how does one combine results from analyses using different probe measures. this is the dilemma we face when we analyze thousands of genes simultaneously. on the one hand, microarray technology is still imperfect and it is prudent to evaluate a number of exploratory approaches. on the other hand, by the very nature of the problem, it is unlikely that a single approach will be equally appropriate for each gene. the reality is that microarrays afford a rapid preliminary assessment of thousands of genes for future experimental validation. ultimately, any scientific validation has to be drawn from further bench experiments.

to facilitate the evaluation and use of gpms, we have developed a software program, called probeplus that implements our gpms. this program will be made available to academic researchers through the website .

CONCLUSIONS
in this paper we describe a general framework to analyze genechip® gene expression analysis array data. this framework is flexible to permit comparisons of different methods with respect to the choice of probe measure and analytical models used. we found that different methods yield similar result when probe measures are the same.

