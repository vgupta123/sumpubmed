BACKGROUND
the identification and quantification of proteins in biological samples play crucial roles in biological and biomedical research  <cit> . for example, in biomarker discovery studies, the aim is to elucidate a set of proteins that can be used to reliably differentiate diseased and normal samples. accurate protein identification and quantification are required to achieve this goal.

many researchers have pointed out that biologically meaningful proteins are often of low abundance  <cit> , therefore, the percentage of low abundance proteins identified determines the likelihood of success in biomarker discovery studies. recent improvements in sample preparation and instrumentation directly address this problem. in contrast, the current data processing algorithms for low abundance proteins have been a neglected component of protein biomarker discovery. this reality has underscored the need for the improvement of peak detection algorithms for low abundance proteins.

in this paper, we focus on label-free liquid chromatography/mass spectrometry  for protein/peptide identification and quantification. although currently, most of the quantitative proteomics approaches by mass spectrometry utilize isotopic labels such that samples from difference class/disease states can be analyzed in one lc/ms run. however, the capacity of the lc column must be shared by the number of isotopically- or isobarically-labeled samples to be compared, which severely limits the sensitivity for observing the low abundance proteins; consequently, the use of label-free quantification methods are preferred.

it is possible to employ lc/ms/ms, or lc-tandem mass spectrometry for biomarker discovery. however in  <cit> , it is demonstrated that while  <dig> to 98% of the most abundant proteins can be identified in a triplicate lc/lc/ms/ms experiment, only  <dig> to 25% of lower abundance proteins, which are the vast majority, were identified. the limitations of lc/ms/ms also preclude the replicate analysis required to gather statistical information from a large number of samples and often only the most abundant ’housekeeping proteins’ are observed. thus, while critical to identify low abundance proteins from complex biological mixtures, lc/ms/ms and lc/lc/ms/ms are less ideal than label-free lc/ms for biomarker discovery applications

challenges in the detection of low abundance proteins by capillary lc/ms
the high resolution separation of peptides by lc improves the sequence coverage of low abundance proteins by ms. however, such approach also complicates the subsequent detection of low abundance proteins from noise by a number of factors: 1) information of peptides is dispersed to multiple locations. a peptide species will register peaks in a series of ms scans within its elution period. 2) within an ms scan, a peptide species could register several peaks in different charge states and isotope positions. 2) lc/ms systems are subject to considerable noise and variability, which have not been characterized completely. it is critical to perform computational peak picking to tease apart noise and peptide peaks. peak detection effects biomarker discovery the most because error made at this stage will propagate to subsequent processing steps in biomarker discovery.

most peak detection algorithms proposed to date focus on the detection of high abundance peptides and cannot meet the requirement of low abundance peptide peak detection mainly due to the following two reasons: 1) current algorithms do not consider all possible signals generated by a peptide spices for peak detection. most of software packages including peplist  <cit> , viper  <cit> , superhirn  <cit> , openms  <cit> , and msinspect  <cit>  perform peak detection in one charge state and one ms scan. then, peaks detected in single scans are linked together to form lc peaks. 2) there lacks accurate signal and noise models. for instance, mapquand  <cit>  assumes a gaussian model for the elution peak and treats lc peaks that do not conform to the model as noise. however, a lot of real lc peaks, especially low abundance ones, do not conform to the gaussian shape. also, the noise models are highly instrumental dependent. for example, in  <cit> , ms noise for ion-trap instruments is modeled as poisson but in  <cit> , the lc dimension noise is modeled to have a variance that grows quadratically with signal intensity. the distribution of noise is also instrumental dependent and generally unknown. the optimal peak picking algorithm has to be adapted to different noise models. however, current algorithms generally assume one noise model  and use a fixed model for different instruments and intensity ranges. deficiencies in these two aspects clearly explain why current peak picking methods cannot utilize 2d lc/ms data effectively for low abundance peptide detection and quantification  <cit> . there exists a huge potential for performance improvement of peak identification algorithms. in this paper, we propose a novel peptide peak identification algorithm-information combining peak detection  to address this problem.

signals generated by a peptide
a peptide species with molecular weight m may generate a group of related peaks in an lc/ms dataset. first of all, when a peptide species enters the mass spectrometer, different number of charges will be attached during the ionization process, which results in different charge states. apart from peptide charge state dispersion, each peptide species would register as a series of isotope peaks in ms. given the total count of a peptide species, the percentage of the peptide with ’iso’ carbon isotopes is governed by the poisson distribution  <cit> , and it is referred as an isotope pattern, ratio or distribution f. it shall be noted that other chemical elements such as oxygen also contribute to the isotope pattern. however, c <dig> is the dominating factor. there exists various methods  <cit>  addressing the calculation of isotope patten. one of the most popular is based on “averagine”, an averaged molecular formula for peptides  <cit> . using the “averagine” molecular formula, one can estimate the number of carbons/oxygens etc. contained in a peptide sequence given the total molecular mass, which in turn will allow for the calculation of an estimated isotope pattern. the details of theoretical isotope pattern calculation can be found in  <cit> . the presence of isotope patterns predicted by the “averagine” is an important evidence on the existence of peptides since non-peptides that do not have similar chemical composition as the “averagine” will not register similar isotope patterns as that of peptides.

isotope and charge state dispersion result in a phenomenon where multiple peaks will be registered for one peptide species in ms spectrums at different m/z locations. also, at these m/z locations, similar chromatographic peaks will occur in their elution time profiles. these facts enormously complicates the accurate identification of peptide identity.

RESULTS
performance evaluation method
a fair way for evaluating the performance of peak picking methods is to compare their roc curves, which plot the false positive rate vs. true positive rate as the threshold on peak picking criteria varies. suppose the list of peak candidates produced by an lc/ms processing algorithm is outlist with n peaks. each item in the list is annotated by its mass and peak picking parameters such as the isotope pattern matching score. then a threshold can be applied to one of the parameters such as isotope matching score. peak candidates that pass the threshold will be treated as detected peaks. detected peaks consist of true positives  and false positives , which can be determined by comparing the detected peaks with the set of p “true peptides” obtained using some peak identification methods such as lc/ms/ms. the rest of peaks that do not pass the threshold can also be partitioned to false negatives  and true negatives  by comparing them to the true peptide list. the true positive rate is estimated as tp/, which indicates the probability of detecting a true peak. the false positive rate is estimated as fp/, which indicates the probability of false peaks being detected as peptide peaks. as we adjust the thresholds, more or less peaks will be detected and the false and true detection rates also change. tracing these changes will result in the roc curve. note that the true positive rate is equivalent to the sensitivity of the algorithm and  <dig> — fp is the specificity of the algorithm on peak detection. the performance of a peak picking algorithm is better when its true detection rate is higher at a given false detection rate, which is reflected as larger area under the curve . besides the roc curve, it is also useful to plot the precision-recall curve  <cit> . precision equals true positive rate, and recall rate can be calculated as recallrate = tp/tp + fp. the precision-recall curve is useful when large false positives exists.

test data preparation
to verify the performance of the proposed algorithm, it is important to obtain a test dataset. in research such as , a mixture of  <dig> known peptides is used for performance evaluation. however, it is hard to draw statistically significant conclusions on the performance of peak detection algorithms based on such a small number of peptides. it is also impractical to manually mix large number of know peptides for testing. instead, we elect to use the lc/ms dataset generated using the proteomics dynamic range standard set  from sigma - aldrichtm. the ups <dig> set is comprised of one vial of proteomics dynamic range standard and one vial  of proteomics grade trypsin. the proteomics dynamic range standard is produced from a mixture of  <dig> individual human source or human sequence recombinant proteins, each of which has been selected to limit heterogeneous post-translational modifications . the protein standard has a dynamic range of  <dig> orders of magnitude, ranging from  <dig>  fmoles to  <dig>  fmoles. the total protein content in each vial is  <dig>  mg. each protein has been quantified by amino acid analysis  prior to formulation.

although protein content in ups <dig> is known, however, peptide components after trypsin digestion is unknown. theoretical prediction can provide the list of all possible peptide species when allowing multiple miscleavages of the protein by enzyme. some entries in the theoretically predicted list have very low probability of occurrence and do not register any signal on the instrument. thus this theoretically predicted list can not be treated as the “true peptide list”. to establish the “ground truth”, we injected ups <dig> sample which contains the same set of  <dig> proteins as in ups <dig>  but with higher protein concentration for lc/ms/ms analysis.

the ups <dig> sample was analyzed using an ftms mass spectrometer . both lc/ms and lc/ms/ms scans were collected in this experiment. lc/ms/ms of ups <dig> data was searched with the mascot protein identification algorithm. mascot returns a list of probable proteins based on ms/ms spectrums. the mascot search result is then compared to the original protein list. out of the  <dig> probable proteins returned by the mascot search results,  <dig> out of the original  <dig> proteins contained in the sample are present. we treat the set of observed peptides in lc/ms/ms scans associated with these  <dig> proteins as the set of “true peptides” denoted as lpeptide with size p that is contained in the trypsin digested sample. note that this list of  <dig> peptides can not be the complete set of peptide contained in the ups <dig> sample due to a separate trypsin digestion process, however, it is a very close approximation which can be used to compare the performance of various peak picking algorithms.

subsequently, we process the lc/ms dataset of ups <dig> by the icpd algorithm we proposed that combines information in multiple ms scans and multiple charge states. the algorithm produces a candidate peptide peak list. each entry in the list is annotated by mass value, elution time period and a score  that indicates how likely the peak candidate is a peptide peak.

effect of information combining
in this section, we demonstrate the effect of the information combining. in fig.  <dig> and fig.  <dig>  we plotted the roc and precision-recall curves of the proposed algorithm when different thresholds are applied. the noise variance is assumed to scale with the third power of peptide abundance . in fig.  <dig> and fig. <dig>  we plotted the roc and precision-recall curves based on a single ms scan with the highest peak intensity. in this experiment, the isotope pattern is estimated based on a single scan without combining information from multiple scans. then the matching score is calculated similarly as in the case with information combining and the total peptide abundance is assumed to be the highest peak intensity of the peptide candidate.

in the presence of large false positives, the percentage of correct detection is a critical. a precision-recall curve reflects this critical aspects well. while the improvement on roc curve is not obvious, a clear improvement on precision is shown especially for peptides with abundance of 5000fmol and 5fmol at the same recall rate. the highest precision is at around 43% with our proposed score and only 23% for the single scan case. this clearly shows that the combining of multiple scans improves the performance for lower abundance peptides.

effects of noise variance assumption
we experimented with different choice of noise variance assumptions. if the poisson model predicted in  <cit>  prevails than the noise variance should scales with the total abundance and the parameter p = <dig>  in this case the snr should increase linearly with total abundance . if we choose the same model as adopted in algorithms such as viper, then a quadratic growth of noise power is implied and p =  <dig>  in this case the snr is assumed to be linear. we also experimented with p =  <dig> which implies that snr actually gets worse as the peak intensity grows. the precision curves with p =  <dig>  p =  <dig>  and p =  <dig> are show in the fig.  <dig>   <dig>  and  <dig> 

these curves indicate that p =  <dig> gives the best peak picking performance overall. however, it is interesting to notice that with p =  <dig>  peak detection on peptides with the highest abundance level provides the best performance. this suggests that the poisson model in  <cit>  is more accurate in high intensity regions and it is necessary to adapt peak detection strategies on different peak intensity regions.

comparing proposed score with other peak picking criteria
peak detection can be based on various parameters such as peak volume, maximum peak intensity, and lc scan length. these parameters have all been used in the past for peak picking. how does the proposed score compare with other peak picking criteria? among many criteria reported using our peak list, peak volume reports the best performance. we plotted the precision-recall curve based on peak volume in fig.  <dig>  comparing fig.  <dig> and fig.  <dig>  it is clear that the proposed score improves the precision of peak detection by more than one fold for peaks with lower abundance although the precision for higher abundance peaks is lowered. this shows that the proposed score improves the precision for lower abundance peaks greatly. for higher abundance peaks, a simple volume peak picking algorithm should be sufficient.

comparing to other algorithms
note that direct comparison to software packages is generally not possible since software packages like msinspect and mzmine offer many options for peak detection. rather, only peak picking criteria can be compared. here, we present peak picking results using the software package msinspect for corroborating our results. msinspect is also used for comparison in recent works of  <cit> . msinspect produces a peptide peak list annotated by various peak parameters such as mass value, elution time period, peak intensity, total peak intensity and kl distance . it also allows the user to set up thresholds in peak intensity, snr and other parameters. by setting all thresholds to their most admissible values, msinspect can report all probable peptide peaks which allow us to plot roc curves for comparison. the peak detection algorithms in some other software packages can find similar parts in msinspect. for example, viper employs isotope matching in each scans whose performance is found to be very similar to the result produced by msinspect when using kl distance as the peak picking criteria. algorithms that employ lc peak shape matching like mzmine and mapquand generally perform a lot worse than msinspect when processing our lc/ms data set. it is observed that significant amount of lc peaks do not conform to gaussian or extended gaussian shape as assumed in mzmine and mapquand. the algorithm described in  <cit>  is not compared since the algorithm is focused on separating overlapping lc and ms peaks which is a common problem to low resolution data sets. otherwise, the algorithm is very similar to msinspect.

in fig.  <dig>  we plotted the roc curve of the peak picking algorithm by msinspect. we applied thresholds to various parameters and found that peak intensity provides the best roc performance which is plotted in fig.  <dig>  the rocs of the lowest three abundance peptides are lower than the  <dig> degree line with significantly smaller area under the curve than that of the proposed icpd algorithm. the maximum detection rate of the low abundance peptides is around  <dig> - <dig> . we can see a significant improvement in sensitivity and specificity for the detection of peptides with lower abundance provided by our icpd algorithm. the precision-recall curve reflects the same performance trend and is omitted here.

CONCLUSIONS
in this paper, we proposed a new peak detection algorithm-icpd for high resolution lc/ms data by combining information. we demonstrated significant improvement in precision for lower abundance peptides over other algorithms. we demonstrated that by assuming a noise model with variance that scales with the third power of peptide abundance, the peak detection performance for low abundance peptides can be improved. this shows that peak picking algorithms have to be adapted to the noise characteristics of instruments.

