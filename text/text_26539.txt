BACKGROUND
high-density microarrays <cit> , in combination with high-throughput sequencing efforts <cit> , are proving invaluable in the investigation of complex systems. researchers, however, struggle with the challenges associated with analyzing and interpreting the enormous amounts of data generated by microarray experiments. while initial analysis techniques focused on individual hybridizations and selected differentially expressed genes based on the ratio of the measured levels of gene expression between two samples <cit> , the results of any single microarray hybridization is subject to substantial variability <cit> , and consequently are unreliable. therefore, as with any biological assay, robust microarray experiments rely on replication <cit> .

kerr et al.  <cit>  first described the use of analysis of variance  in combination with optimal experimental designs incorporating replicate measures, for microarrays. this technique uses a basic additive linear model to account for known sources of variability, thereby improving estimates of differences in gene expression and providing a measure of confidence for those estimates. others have expanded these techniques to incorporate mixed models <cit> , multi-factorial designs <cit> , and biological replication strategies <cit> . in addition, advancements in data transformation  <cit>  and normalization <cit>  have improved the quality of the data to which subsequent analyses are applied.

in an effort to apply many of these powerful statistical techniques to our microarray datasets, we have developed an analysis platform with supporting software named carma . in addition to performing anova on microarray datasets that incorporate replication, carma also performs all of the necessary steps for calculating differential expression in a microarray data set including importing, transforming, and normalizing the raw data files. the analysis is designed to be easy to apply, require only a basic understanding of the underlying principles, and provides output in both an easy to interpret graphical format and a delimited text file. each step in the process was chosen for its broad applicability to microarray data, with user-defined parameters tailoring the analysis to each experiment. to demonstrate the utility of our approach, we present an example analysis of a microarray experiment designed to characterize gene expression in an aquaporin- <dig> knockout mouse model.

implementation
carma was implemented using the r programming language and environment <cit>  because of its "wide variety of statistical  and graphical techniques". in addition r is available at no cost and runs on a variety of computing platforms. under carma, analysis begins with data files and user-defined parameters being read from delimited files. normalization between the two channels of each array and between both channels of all arrays is achieved using the loess function, which was chosen because of its ability to perform simultaneous location and intensity dependent lowess normalization. anova is implemented using the aov function utilizing partitioned error for replicates, or the lme function for more complicated models, including mixed models. graphical output and delimited text files are generated to present the results of the normalization, analysis of variance, and the anova contrasts. carma is available as an r package for microsoft windows , and as an r source file . a user manual is also available .

RESULTS
example dataset
the microarray dataset used for this manuscript contains measurements of gene expression in kidneys from adult aquaporin- <dig> knockout and wild type mice <cit>   . in brief, rna from kidney medullae of three aquaporin- <dig> knockout mice and three wild type mice was reverse-transcribed incorporating an amino modified dutp, labeled using alexa fluor  <dig> and  <dig> ester dyes, and hybridized to a custom microarray containing the nia mouse  <dig> k cdna clone set <cit>  with each clone printed in duplicate. slides were scanned using an applied precision arrayworx biochip reader and image analysis was accomplished using softworx tracker software. because this experiment is balanced for both mouse  and genotype , it was possible to perform two different analyses; one to determine differences in gene expression between mice and the other to determine differences in gene expression between the aquaporin- <dig> knockout and wild type groups. the results of the comparison between the aquaporin- <dig> knockout and wild type groups have been reported previously  <cit> , therefore this paper presents the comparison of gene expression between individual mice in order to demonstrate the functionality of carma.

experimental design
successful microarray data analysis depends on a sound experimental design. the most common approach consists of all samples of interest being hybridized against a common reference sample  . while this approach is useful for experiments with large numbers of samples, or cases where all samples are not available at one time, it is usually possible to implement a more efficient design. in the "interwoven loop" design <cit>  employed in the aquaporin- <dig> knockout experiment , samples are hybridized against each other, thus providing twice as much data for the samples of interest than the reference design for the same number of hybridizations. applying this balanced design, in which each variable of interest participates in the same number of hybridizations, enables the calculation of both experimental and biological effects.

analysis of variance  and linear model
in the simplest sense, microarray data is the measured intensities, at defined wavelengths, of elements , which have been arrayed on a glass slide. included in these measurements are numerous sources of variability. given that a two-channel microarray experiment consists of multiple samples labeled with two dyes hybridized to multiple arrays containing multiple spots , there are four main sources of variability termed: array, dye, gene, and variety <cit> . the array term refers to the variability in the measured intensities associated with a specific hybridization, due to either variability between slides, variability between hybridizations , or both. the dye term refers to variability caused by differences in fluorochrome chemistry, coefficient of extinction, incorporation efficiency, photobleachability, scanner sensitivity, etc. the gene term refers to each element  on the microarray. since each element will hybridize to its complementary sequence in each sample, the intensity of each spot will depend on its nucleotide sequence, which is considered unique. the variety term refers to the distinguishing feature of interest  in the experimental samples. the goal of most microarray experiments is to determine the effect of this variety term on the measured intensity for each element. in other words, how does dosage  affect the expression of each gene?

based on the four main effects  and allowing for all interactions between those effects, there are  <dig> possible terms that could be included in the model <cit> , however many of the interaction effects do not make practical sense. in addition, performing a log-based transformation  on the microarray dataset before applying the linear model allows the use of an additive linear model. equation  <dig>  describes the collection of mathematical equations that can be used to calculate values for each of the known factors that contribute to the transformed measured intensities:

iijkl = μ + ai + dj + gk + ij + ki + kj + kl+ ε ijkl    

equation  <dig>  defines a relatively complete model for the sources of variability in a microarray experiment; however there are practical limitations to its implementation. utilizing a least squares approach to solve equation  <dig> , even for reasonably small microarray datasets , requires gigabytes of memory, precluding the use of a personal computer. in addition, it assumes equal variance between all genes. splitting equation  <dig>  into two equations, one containing all gene independent terms, and another equation containing all gene-dependent terms, yields equations  <dig>  and  <dig>  respectively:

iij = μ +ai + dj +adij + ε ij    

iijkl = gk + gaki + kj + kl+ ε ijkl    

applying these two models sequentially <cit>  to a dataset significantly reduces the memory requirements and time required for computation, and allows for gene specific variances. when using these two models, equation  <dig>  effectively serves to perform a linear global normalization between the two channels for each array and between arrays. instead, because only the gene × variety effect is usually of interest, and in order to allow for non-linear global normalization, carma performs a lowess normalization between the two channels of each array and between both channels of all arrays, followed by a gene-by-gene anova implementing equation  <dig>  alone. limiting equation  <dig>  to the subset of data for each gene yields equation  <dig> :

iijkl=gk+gaki+gdkj+gvkl+εijkl⇒iijl=μ+ai+dj+vl+εijl     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgpbqadawgaawcbagaemyaakmaemoaaomaem4aasmaemibawgabeaakiabg2da9iqbdeeahzaawawaasbaasqaaiabdugarbqabagccqghrawkcqwghbwrcuwgbbqqgagfamaabaaaleaacqwgrbwacqwgpbqaaeqaaogaey4kasiaem4rackafmiraqkbaybadawgaawcbagaem4aasmaemoaaogabeaakiabgucariabdeeahjqbdafawzaawawaasbaasqaaiabdugarjabdygasbqabagccqghrawkiigacqwf1oqzdawgaawcbagaemyaakmaemoaaomaem4aasmaemibawgabeaakiabgkdielabdmgapnaabaaaleaacqwgpbqacqwgqbgacqwgsbabaeqaaogaeyypa0jae8hvd0maey4kasiaemyqae0aasbaasqaaiabdmgapbqabagccqghrawkcqwgebardawgaawcbagaemoaaogabeaakiabgucariabdafawnaabaaaleaacqwgsbabaeqaaogaey4kasiae8xtdu2aasbaasqaaiabdmgapjabdqgaqjabdygasbqabagccawljagaaczcamaabmaabagaegymaejaeiola4iaeginaqdacagloagaayzkaaaaaa@7407@    

implementing this form of the equation reduces computation times to a few hours on a basic personal computer  for even relatively large data sets .

background subtraction and transformation
most microarray scanners generate  <dig> bit numbers, resulting in measurements ranging from  <dig> to  <dig>  for each pixel in the generated images. microarray image processing software is then used to analyze each image, generating a multitude of measures for each spot, which are usually further processed to produce one measure of intensity for each channel for each spot. the most controversial part of this process is whether to subtract some measure of background  from each spot . background subtraction is often used to reduce the negative impact of local image artifacts, and provide better estimates of gene expression by subtracting fluorescent signal that is unrelated to the fluorescently labeled hybridized target cdna. nevertheless, some researchers have concluded that background subtraction increases variance and degrades the performance of subsequent analyses <cit> . in most cases, however, this increase in variance is not simply due to background subtraction, but the combination of background subtraction and a log-based transformation of the data. in effect, subtracting the background intensities from the spot intensities reduces the values for low intensity measurements to the point that error is no longer multiplicative, but additive, causing a log-based transformation to inflate the variance of these small values. in other words, the measurement error associated with small values is not proportional to the true value, but is a combination of some random error added to the true value. for instance, a log base  <dig> transformation assigns the same significance to the difference between  <dig> and  <dig>  - log <dig> = 4) as the difference between  <dig> and  <dig>  - log <dig> = 4), even though a difference of  <dig> is well within the noise of current microarray scanning technology and of no real significance.

the logarithm base  <dig> of the expression ratio is the most widely used transformation for microarray data due to its continuous range of values and similar treatment of up- and down-regulation <cit> . it has the added effects of improving linearity and variance homogeneity, and converting multiplicative error into additive error, thus allowing the application of a linear additive model <cit> . while log transformations work well for moderate to high signal intensities, they have the undesirable effect of magnifying small differences in intensity at low signal intensities <cit> . in addition, log transformations cannot be applied to negative numbers, which can result from background subtraction, and they transform numbers between  <dig> and  <dig> into negative values. to address these problems some researchers have proposed discarding data below a threshold <cit> , while others have proposed variance-stabilizing transformations  <cit> . carma implements a version of the linlog transformation <cit>  that has been adapted to better cope with large negative numbers  as follows.

zik={log⁡2+2*log⁡2−2/ln⁡yik≤−dilog⁡2+yik/)−1/ln⁡−di<yik<dilog⁡2yik≥di
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgabgwdawgaawcbagaemyaakmaem4aasgabeaakiabg2da9maaceaabaqbaeaabmgaaaqaaigbcygasjabc+gavjabcegannaabaaaleaacqaiyagmaeqaaogaeiikagiaeyoei0iaegymaejaei4la8iaemywak1aasbaasqaaiabdmgapjabdugarbqabagccqggpaqkcqghrawkcqaiyagmcqggqagkcyggsbabcqggvbwbcqggnbwzdawgaawcbagaegomaidabeaakiabcicaoiabdsgaknaabaaaleaacqwgpbqaaeqaaogaeiykakiaeyoei0iaegomaijaei4la8iagiibawmaeioba4maeiikagiaegomaijaeiykakiaacjavdqaaiabdmfaznaabaaaleaacqwgpbqacqwgrbwaaeqaaogaeyizimqaeyoei0iaemizaq2aasbaasqaaiabdmgapbqabaaakeaacyggsbabcqggvbwbcqggnbwzdawgaawcbagaegomaidabeaakiabcicaoiabdsgaknaabaaaleaacqwgpbqaaeqaaogaeiykakiaey4kasiaemywak1aasbaasqaaiabdmgapjabdugarbqabagccqggvawlcqggoaakcqwgkbazdawgaawcbagaemyaakgabeaakiabcqcaqigbcygasjabc6gaujabcicaoiabikdayiabcmcapiabcmcapiabgkhitiabigdaxiabc+cavigbcygasjabc6gaujabcicaoiabikdayiabcmcapaqaaiabgkhitiabdsgaknaabaaaleaacqwgpbqaaeqaaogaeyipawjaemywak1aasbaasqaaiabdmgapjabdugarbqabagccqgh8aapcqwgkbazdawgaawcbagaemyaakgabeaaaoqaaigbcygasjabc+gavjabcegannaabaaaleaacqaiyagmaeqaaogaeiikagiaemywak1aasbaasqaaiabdmgapjabdugarbqabagccqggpaqkaeaacqwgzbqwdawgaawcbagaemyaakmaem4aasgabeaakiabgwmizkabdsgaknaabaaaleaacqwgpbqaaeqaaaaaaogaay5eaaaaaa@a48f@

where zik represents the transformed intensities, yik represents the untransformed intensities, and di represents the threshold between the log and linear portions of the transformation. the subscripts i and k denote the array and element  for each intensity, respectively. this modified linlog transformation is symmetrical around  <dig>  and both it and its first derivative are continuous. it is similar to a log <dig> transformation for both large positive and large negative intensities, and a linear transformation at low intensities . for the example analysis in this manuscript, the crossover point  between the linear and log portions of the transformation was calculated based on the median of one standard deviation of the local background of all spots. this method of calculating the cutoff for the linlog function was based on the observation that the variability in the measured intensities at background levels provides a good indication of the minimum intensity that the scanner can accurately measure . this approach has worked well in practice, and has the advantage of not assuming any distribution for the data. recently carma has been enhanced to include the capability of calculating the linlog crossover point based on minimizing the absolute deviation of the inner quartile range  for each bin from the median iqr, for  <dig> bins spanning the range of intensities for each hybridization.

utilizing the aquaporin- <dig> dataset, we compared the effect of local background versus no background subtraction, and the consequences of applying either a log <dig> or linlog transformation, on the ability to detect differentially expressed genes. because this dataset consists of four replicate measurements for  <dig> mice, one success criterion is minimizing the within mouse variance while maximizing the between mouse variance <cit> , which equates to maximizing the anova f value for the variety  term, in equation  <dig> . in the case of log <dig> background subtracted data, values less than  <dig> were set to  <dig>  and in the case of the linlog transformation, the crossover point between the linear and logarithmic segments was set to the median of one standard deviation of the background for all spots. figure  <dig> illustrates the effect of each background subtraction/transformation method on one of the hybridizations in the dataset. the most obvious change due to background subtraction is the expansion of the range of the data resulting from the removal of the relatively large signal floor associated with the longer exposure times and ccd-based image capture employed in the applied precision arrayworx biochip reader. this large signal floor also negates any difference between the log <dig> and linlog transformation on the non-background subtracted data because error remains multiplicative across the entire range of values. the difference in transformation applied to the background subtracted data however, is obvious as indicated by the larger spread of the lower range of the log <dig> transformed data as compared to the linlog transformed data. table  <dig> presents a summary quantitative comparison of the effect of each transformation on the ratio of the between group mean squares over the within group mean squares after location and intensity dependent lowess normalization and gene-by-gene analysis of variance. on a row-by-row basis after ranking, the anova f values for the linlog transformed local background subtracted data were larger than any of the other combinations of background subtraction and transformation, for every element in the dataset. also, applying a step-up p-value procedure <cit>  to the anova p-value controlling at a 5% false discovery rate resulted in  <dig> genes being identified as differentially expressed for both of the non-background subtracted datasets, and  <dig> and  <dig> genes being identified as differentially expressed for the log <dig> transformed and linlog transformed background subtracted data, respectively.

normalization
differences in fluorochrome characteristics, scanner wavelength sensitivities and settings, dye incorporation, and other non-biological effects all contribute to differences in the intensities between the two channels of any hybridization. and while global normalization techniques apply the same adjustment to every spot for a hybridization <cit> , it is often necessary to correct for intensity and location specific effects <cit> . carma implements a locally weighted regression  <cit>  transformation that can adjust for either intensity or location  dependent effects. in addition, carma normalizes between both channels of all arrays, serving to minimize the array term in the linear model and aiding in the visualization of the normalized data.

variance shrinking
microarray datasets usually contain thousands of elements, each representing one gene, but only a few measurements for each element. whereas performing a global anova on the entire dataset assumes equal variance within the data for each gene, it is generally accepted that independent analysis of the subset of data for each gene does not utilize sufficient data to determine an adequate representation of the variance associated with each gene. on the other hand, the major consequence of performing a gene-by-gene anova is the overestimation of the significance of the calculated differences in expression for genes with abnormally small variances, and the underestimation of the significance of the calculated differences in expression for genes with abnormally large variances. researchers have addressed these issues by including information from all genes on the array when assessing the significance of differences in expression for each gene  <cit> . carma calculates four variances and associated p-values for each gene <cit> : gene specific variance, pooled variance , half of the gene and half of the pooled variance, and an estimator based on the james-stein-lindley shrinkage concept <cit>  that uses a formula to calculate the variance based on both the gene and pooled variances.

data filtering and outlier detection
given that the samples hybridized to most large microarrays will contain transcripts for only a subset of the genes represented on the microarray, removing spots that exhibit low intensities for all samples can both reduce the number of genes incorrectly identified as differentially expressed between samples and decrease the computing time required for subsequent analyses. as implemented in carma, the anova is usually  performed on only those genes that have background subtracted intensities greater than  <dig> or  <dig> background standard deviations for at least 51% of the measurements for at least one sample in the hybridization scheme. furthermore, in the case of microarrays with replicate elements, usually at least 51% of the replicates must have background subtracted intensities greater than  <dig> or  <dig> background standard deviations in order for any of the replicates to be included in the anova. in other words, the anova is only performed on genes that are consistently expressed at measurable levels in at least one of the samples.

carma also has the capability to remove anomalous measurements through outlier detection. dust, impurities, surface inhomogeneities, fluorochrome-specific effects, local hybridization effects, technician effects, etc. all contribute to non-systematic variability in the measured intensities. anomalous measurements can be identified by their incongruity with other measurements within a hybridization and through inconsistencies between replicated measures <cit> . following the anova of the normalized data for a gene, carma applies the following formula to identify outliers:

rti > |quantile/n, df -1)|

where rti = studentized residual of the ith element, op = user defined outlier probability, n = the number of measurements, and df = degrees of freedom. anova is performed recursively, removing the most extreme outlier after each step, until all outliers  have been removed. the results of both the original anova , and the last anova, performed on the dataset with all outliers removed, are shown in the graphical output .

missing data
most microarray hybridizations will have regions that are obviously problematic. while it may not be worthwhile to flag small abnormalities such as fine dust particles, large abnormalities should be flagged for exclusion from analysis. missing data, whether flagged manually, filtered out, removed through outlier detection, or unavailable because of a failed hybridization may result in some experimental imbalance. this imbalance, however, is less problematic than including erroneous data. therefore, carma utilizes functions that can accommodate missing data, to apply the linear model and perform the anova.

output and display
any analysis is only as good as its ability to portray relevant information to the researcher. in addition to generating tab delimited output files, carma creates an adobe portable document format  file containing easy to interpret graphical output  including an estimate, and its standard error, for each level  of the variety effect, as well as plots of the normalized data and other statistical quality control information. this graphical output allows the researcher to refine and prioritize the list of differentially expressed genes by helping to identify cases of non-normality, outliers, unexpected patterns, etc. visualizing the normalized data and the results of the anova also helps to identify and correct cases of mislabeled samples and misaligned grids. all of the numbers used and generated by the anova, and a file containing the contrasts between all pair-wise combinations of the levels of the variety effect are also provided in delimited text files.

CONCLUSIONS
microarray experiments are intended to determine relative differences in gene expression between various treatments or conditions. as with nearly all experiments, and exacerbated by the number of measures obtained from microarray hybridizations, experimental noise can confound measurements and lead to the incorrect identification of random variations as significant differences in gene expression. we have employed a generalized approach and developed supporting software  for performing anova on microarray datasets that is easy to implement, generates readily interpretable graphical results, and accounts for experimental sources of variability. applying anova to microarray datasets incorporating replicated measures improves estimates of differences in gene expression between samples and provides a statistical basis for determining the significance of these differences. also, because each sample is involved in multiple hybridizations, it is possible to identify and remove incongruous data points that are caused by dust particles, local background, etc, as well as allow for missing data caused by occasional failed or abnormal hybridizations. carma provides a clear quantitative and statistical characterization of each measured element on the microarray that can be used to assess marginally acceptable measures and improve confidence in the interpretation of microarray results. overall, applying carma to microarray datasets incorporating replicated measures effectively reduces the number of gene incorrectly identified as differentially expressed and results in a more robust and reliable analysis.

in some situations it is advantageous to study the effects of more than one variety on gene expression. for example, in gene knockout studies both genotype and treatment dependent effects may be important. also, in cases where subjects are exposed to multiple treatments, accounting for individual-specific effects may expose differences in gene expression due to treatment that might otherwise be obscured. in these cases equation  <dig>  can be modified to include terms for each of the varieties of interest. for example, the following model could be used to examine the effects of genotype , drug treatment , and the interaction between genotype and drug treatment :

iijlm = μ +ai + dj + v1l + v2m + v1v2lm +ε ijlm    

theoretically equation  <dig>  could be expanded to include any number of varieties, however because of an exponential increase in the number of hybridization that must be performed most researchers limit their experiments to studying a maximum of two varieties.

implementation of carma depends on a few assumptions. first, the lowess normalization assumes that the expression levels for the majority of genes in each sample are the same. while this is usually the case, even under conditions where the expression levels of the majority of genes are affected, lowess normalization produces the desired result of adjusting the dataset such that genes that behave dissimilarly from the majority are more likely to be identified as differentially expressed. second, when determining the significance of differences in gene expression between samples, it is assumed that the data is normally distributed after the application of the linear model. we make this assumption in order to utilize the readily available r packages that perform anova and their superior computational efficiency over non-parametric approaches. lastly, in order to apply the anova to each gene individually, it is assumed that after transformation and normalization each gene is independent of the other genes on each array. theoretically, because each element  is on every array there is not complete independence between genes, however we chose to implement the anova on each gene independently in order to allow genes to have dissimilar variances, and to efficiently implement the anova.

background subtraction has been criticized for inflating the variance of microarray datasets, but this increased variability is almost always limited to elements that exhibit low intensity measures. this increased variability is not simply due to the smaller numbers, but rather the methods by which these numbers are measured and transformed. both photomultiplier tubes  and charge-coupled devices  cannot accurately distinguish small differences in intensity. therefore the assumption that error is multiplicative for these values is inaccurate and thus the application of a basic log-based transformation is inappropriate. the commonly seen flaring of the data at lower intensities, in either a simple green channel vs. red channel or a ratio-intensity plot, is not usually an indication of the inappropriate application of background subtraction, but rather an inappropriate transformation. in addition, not removing the relatively large uniform background associated with some datasets, such as those generated by ccd based scanners, can completely obscure the magnitude of any differences in gene expression. as illustrated by this dataset, different approaches to background subtraction and transformation can have a significant effect on the identification of differentially expressed genes. in fact, at most only  <dig> % the top  <dig> genes were shared between the background subtracted and non-background subtracted results.

many statisticians are hesitant to remove outliers based solely on statistical criteria. in the case of microarray datasets, however, we know that there are invalid measurements in every dataset; yet it is often impractical to manually flag each instance. carma not only automatically detects and removes outliers, but also provides supporting graphs to assist in the final determination of the validity of the measurements that were removed. for example, in figure  <dig>  panels b and c, the green 'x' that indicates one of the excluded outliers is clearly separated from the rest of the measures . of course the researcher can also investigate each spot on the images from which the measurements were derived to further authenticate measurements flagged as outliers, or turn off outlier detection altogether if so desired. in addition to removing sporadic anomalous measurements, outlier detection has proven invaluable for detecting mislabeled samples and misaligned grids. in these cases, without outlier detection, all or a part of a microarray dataset is often labeled as too variable and of little value. a quick inspection of carma's graphical output reveals these problems as a series of genes for which the same hybridization's values were dropped as outliers, providing not only an indication that there is a problem, but also the exact hybridization that is the cause of the problem.

because of the balanced design of this experiment we were able to assess the affects of inter-individual variability in the aquaporin- <dig> knockout vs. wildtype microarray dataset. the fact that 3%  of the confidently measured genes were identified as differentially expressed between mice of the same genotype highlights the significant amount of variability in gene expression between even genetically similar mice. this finding corroborates the results of an earlier study <cit> , underscoring the need for including biological replicates in any study, especially those addressing gene expression and molecular activities.

carma was designed to be an integrated, easy to use, analysis platform that researchers can apply to their microarray datasets without preprocessing their data or writing any computer code, with an emphasis on providing results in an easily interpretable format. in particular, we have attempted to identify and address issues such as the relatively high background and scanning related photobleaching that can occur with ccd based imaging systems, and include means to address many of the real-world problems associated with microarray experiments. there are already a number of existing microarray analysis tools that prove useful in analyzing microarray datasets  <cit> . carma implements many of the same statistical and analytical processes employed in these packages and includes the following additional features:

• ability to read data files generated by most microarray image processing software

• no need to preprocess or combine raw data files

• automatic exclusion of genes with low confidence measures for all samples

• modified linlog transformation that better handles large negative numbers 

• automatic computation of linlog crossover point

• simultaneous intensity and location lowess normalization

• ability to process incomplete datasets for fixed effect models

• automatic outlier detection and removal

• detailed graphical output for each gene

• ability to detect and identify misaligned grids or mislabeled samples

the relative expression values generated by carma , can be further processed by commercial and freeware software packages designed to organize, cluster and display microarray data. in this regard, the relative expression values are analogous to the more traditional ratio-metric measures in that both provide a relative difference in expression between samples. of course more advanced users can modify or extract portions of carma to integrate into their own analyses if so desired. future development of carma may include developing a graphical user interface, improving the implementation of mixed models, adding new methods of normalization, implementing bootstrapping to calculate significance, and adapting carma to function as a bioconductor <cit>  package.

availability and requirements
project name: carma

project home page: 

operating system: platform independent, only tested on microsoft windows 2000/xp

programming language: r

other requirements: r version  <dig>  or higher

license: gnu general public license

restrictions to use by non-academics: permission from university of arizona required

authors' contributions
kg designed and developed the software and drafted the manuscript. mm performed all experiments related to the aquaporin- <dig> experimental dataset. hb conceived of the aquaporin- <dig> study and participated in its design and coordination. jh participated in the conceptualization, design, review and testing of the software, and assisted in the preparation of the manuscript.

grants and support
this research was supported in part by a university of arizona foundation award , the diamond family foundation, panda  , university of arizona bio <dig> graduate research award, and nih awards #dk <dig>  and #hl <dig> .

supplementary material
additional file 1
carma user document.doc a microsoft word document describing how to install and use the carma software.

click here for file

 additional file 2
carma_ <dig> .zip an r package for installing carma under the microsoft windows operating system.

click here for file

 additional file 3
carma_source.zip the r source code for carma.

click here for file

 additional file 4
carmaaquaporin <dig> zip the configuration files used to process the aquaporin- <dig> example dataset using carma.

click here for file

 additional file 5
data <dig> zip comma separated value data files containing the microarray experimental data.

click here for file

 additional file 6
data <dig> zip comma separated value data files containing the microarray experimental data.

click here for file

 additional file 7
data <dig> zip comma separated value data files containing the microarray experimental data.

click here for file

 additional file 8
data <dig> zip comma separated value data files containing the microarray experimental data.

click here for file

 acknowledgements
we thank dave henderson for valuable discussions during the preparation of this manuscript.

figures and tables
the sum of the gene variety term anova f values for the first  <dig>   <dig>  or  <dig> genes ranked by variety term anova f value. larger numbers represent higher ratios of the between mouse variance over the within mouse variance.
