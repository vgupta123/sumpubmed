BACKGROUND
statistical measures of sequence similarity are routinely applied to quantify the results of sequence database searches  <cit> . however, having identified an interesing similarity, it is common practice to quote a value of percentage sequence identity  for the alignment. pids may also be used in estimating phylogenetic trees from multiple sequence alignments, but this application is not addressed in this paper. pids are also frequently used as a cutoff when removing redundancy from large sets of sequences. at first sight, pid is a simple to understand measure, but in fact there is no standard method to calculate the value. pid calculations reported in the literature include those derived by dividing the number of identical positions in the alignment by the number of aligned positions  <cit> , dividing by the shortest sequence  <cit>  or dividing by the length of the aligned region   <cit> . when a pid value is quoted, it is rare for the method of calculation to be reported as well, but for the same alignment, each pid method may produce different values. since pid is really a group of different similarity measures, it is important when interpreting a reported pid to know what variation in pid may be expected due to the differences in commonly used calculations. the value of pid is further complicated by the observation that different alignment techniques when applied to the same pair of sequences, or the same technique used with different parameters, may give alignments that show different values of pid. together, these factors make it difficult to judge the significance of a pid value quoted for two protein sequences. this is a particular problem when comparing a pid value to general cutoffs for homology 

recently, may <cit>  compared four different methods of calculating pid on a set of  <dig> alignments derived from 3d-structure comparison to determine which were most similar. he concluded that dividing the number of identities by the mean sequence length gave pids that were most like pids calculated by other methods. however, may <cit>  did not explicitly report the range of pid observed for the same alignment, nor the effect of different alignment methods on the reported pid. accordingly, in this paper we have examined the range of pid expected due to differences in the pid calculation method as well as the effect of different alignment techniques. our analysis suggests which pid calculation is most robust, and as expected, indicates that pid by any method is a poor substitute for sequence comparison measures based on randomisation.

RESULTS
range of percentage identity seen for different pid calculations
out of  <dig> aligned pairs there were only  <dig> pairs where all four percentage identity measures had the same value.  <dig> pairs had differences in pid between 2% and 5%. there were  <dig> pairs for which the difference was greater than 5%. the greatest difference seen was  <dig> %.

the difference between the maximum and minimum pid decreases slightly with increasing minimum pid. thus, the average difference in pid for alignments with a minimum pid ≤ 30% was  <dig>  ±  <dig>  %, while the average difference for alignments with pid > 30% was  <dig>  ±  <dig> %.

pid <dig> was always largest since it considers only the aligned positions. pid <dig> was ≤ pid <dig> on most of the pairs. differences between pid <dig> and pid <dig> were observed in pairs where one sequence overhangs at the n-terminal and other at the c-terminal. for most of the alignments, pid <dig> was higher than pid <dig> or pid <dig>  pid <dig> gave slightly more consistent values of pid that were less prone to artefactually high or low values as a result of overhangs. pid <dig> also gave a slightly better correlation with structural similarity as shown in table  <dig> and discussed below.

nas: normalised alignment score, .

range of percentage identity seen for different alignment methods
ideally, one would calculate the pid between two sequences from the comparison of the protein three – dimensional structures. in the absence of structures for both proteins, sequence alignment techniques must be applied. since alignment of sequences is an optimisation based on the parameters and algorithm, the resulting alignment depends on these factors. accordingly, the range of pid <dig> was examined for the reference structural alignment and for sequence alignments obtained by the amps <cit>  alignment package with default parameters. for most pairs of sequences, the sequence alignment gave a higher pid <dig> than the reference alignment. this is to be expected, since the sequence alignment algorithm aims to produce an alignment that optimises sequence similarity, while the reference structural alignment is the result of an optimisation of structure comparison.

in order to understand the effect of the alignment algorithm on the pid, the same sequence pairs were aligned by amps  <cit> , clustalw  <cit>  and gap  with default parameters. the difference in pid <dig> was between 0% and  <dig> %. most of the pairs had differences between 0% and 5%. a similar trend was observed for pid <dig>  pid <dig> and pid <dig> . one extreme example was the pair of domains linel- <dig> and 2hft- <dig> for which pid <dig> was  <dig> % for the gap alignment,  <dig>  % for the clustalw alignment and  <dig> % for the amps alignment. however, none of these alignments agreed with the reference structural alignment. overall, the difference in pid <dig> decreases with the increase in minimum pid <dig>  thus, the average difference for pid <dig> ≤ 30% was  <dig>  ±  <dig> % and > 30% was  <dig>  ±  <dig> %. this simply reflects the smaller dependency on parameters for alignments between sequences of higher similarity.

in the real-world situation where one is comparing pid values calculated in different ways by different algorithms, the results presented here suggest the range in pid difference will be between  <dig> and  <dig>  %. the average difference for pid ≤ 30% was  <dig>  ±  <dig> % and > 30% was  <dig>  ±  <dig> %.

discussion
in this article it has been shown that the pid value was affected both by the way in which it was calculated, and by how the alignment was generated. while neither of these facts is particularly surprising, to our knowledge, this is the first time the range of pid has been reported for these effects. the combined effect of algorithm and calculation gave rise to differences in pid of up to 22%. given these limitations, which pid calculation gave the most reliable estimate of similarity?

the stamp structural comparison algorithm that was used to generate the reference alignments in this study provides a measure of structural similarity  which takes account of distance and conformational similarity, for each pair of proteins  <cit> . the correlation between sc and pid <dig> to pid <dig> when calculated for the reference alignment is shown in table  <dig>  pid <dig> was the least correlated , while pid <dig> was best correlated , with pid <dig> marginally worse . this suggests the order of reliability to be pid <dig> ≥ pid <dig> > pid <dig> > pid <dig>  table  <dig> also illustrates correlation values for pid1- <dig> for sequence alignments generated by amps  <cit>  for the same pairs of proteins. although the correlations are weaker, the trend is the same. two further measures of sequence similarity were calculated for each pair of sequences. the normalised alignment score   <cit>  was calculated by applying the blosum <dig> matrix to the alignment, subtracting penalties for internal gaps, then dividing by the number of positions not aligned with gap. the z-score was calculated by shuffling each sequence  <dig> times and comparing the shuffled sequences by the dynamic programming alignment algorithm  <cit> . the z-score is given by:

z-score=σ     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgabgwcqqgtaqlcqqgzbwccqqgjbwycqqgvbwbcqqgybgccqqglbqzcqgh9aqpdawcaaqaaiabcicaoiabdafawjabgkhitiqbdiha4zaaragaeiykakcabaaccigae83wdmhaaiaaxmaacawljawaaewaceaacqaixaqmaiaawicacaglpaaaaaa@41a7@

where, v is the alignment score for two sequences, σ and x¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwg4baegaqeaaaa@2e3d@ are the mean and standard deviation of distribution of scores for shuffled sequences. the z-score has the advantage over pid scores in that it corrects for the effect of alignment length and sequence composition. z-scores for pair-wise sequence alignments may be converted to probabilities by applying the methods described by webber & barton <cit> . the correlation value of  <dig>  suggests the z-score to be the best measure of similarity in the absence of a structural alignment, with nas a close second.

CONCLUSIONS
in this paper we have quantified the variation in reported percentage identity seen in  <dig> structural alignments, due to different denominators in the pid calculation and due to alignment method. the overall conclusions are:

 <dig>  the four different pid denominators considered, gave up to  <dig> % difference in pid on a single alignment in the test set.

 <dig>  sequence alignments by three different methods resulted in variation of up to  <dig> % pid on a single alginment in the test set.

 <dig>  combination of pid calculation and alignment method led to variation of up to 22% pid on a single alignment in the test set.

 <dig>  pid calculations that take account of gaps  were more highly correlated with the stamp sc score for structural similarity between the proteins, than those that do not consider gaps .

 <dig>  all pid calculations were less well correlated with the stamp sc score than the z-score obtained by comparison to shuffled sequence scores.

these overall conclusions are not surprising to those expert in sequence analysis, but to our knowledge this is the first time that the variation in pid has been quantified explicitly. quantification of the variation in pid is valuable, since although pid is a poor substitute for more sophisticated scoring methods that take account of the physico-chemical properties of the amino acids and correct for sequence length, pid remains widely quoted. the findings presented here should prove helpful to those new to sequence analysis, and as a guide to those who seek to interpret the value of a pid reported in the literature.

