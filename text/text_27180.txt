BACKGROUND
application of mass spectrometry to stable isotope tracing experiments for the elucidation of glucose dates back to at least the early 1980's  <cit> . the general scheme for these experiments is to supply a labeled precursor such as uniformly-labeled 13c glucose  to a bacterial culture, tissue culture, or a whole multicellular organism and then extract a set of cellular or excreted metabolites for analysis  <cit> . for identified metabolites, specific patterns of isotopologues are usually observed, which are then interpreted within the context of known cellular metabolic pathways  <cit> . recently, we applied this technique to elucidate specific aspects of lipid metabolism  <cit> .

the ultra-high resolution capability of fourier transform-ion cyclotron resonance-mass spectrometry  makes it possibility to identify simultaneously hundreds, if not thousands, of metabolites from crude cell extracts without the need for chromatographic separation  <cit> . the better than  <dig> ppm mass accuracy of state-of-the-art ft-icr-ms is often high enough to provide mass-to-charge ratios  down to the 3rd and 4th decimal place for metabolites less than a few thousand daltons. this is accurate enough to distinguish relativistic mass differences between expected isotopes of chonps elements and unambiguously determine the isotope-specific molecular formula of an individual peak. furthermore, the ft-icr-ms's high mass resolution allows for the direct detection or deconvolution of individual isotopologues or mass-equivalent sets of isotopomers for a given metabolite.

isotopologue identification and quantification of thousands of metabolites in these metabolomic experiments can provide a wealth of data for modeling the flux through metabolic networks. but before isotopologue intensity data can be properly interpreted, the contributions from isotopic natural abundance must be factored out . this is a computationally expensive and analytically intractable problem for data from lower mass resolution spectrometers where individual isotopically-resolved isotopologues cannot be distinguished  <cit> . in these instances, numerical methods have been employed to approximate and subtract the contributions from isotopic natural abundance  <cit> . some of these calculations are aimed at a different deisotoping problem, namely identifying the related isotopologues and calculating the monoisotopic mass from its isotopic mass distribution  <cit> . fortuitously, with the isotope-resolved isotopologue peaks from ft-icr-ms histograms, we can pose a similar but distinct problem that allows for the derivation of a computationally tractable analytical solution. in addition, isotopologues derived from the same molecule  neatly handle peak intensity referencing issues by providing a natural internal reference.

RESULTS
derivation of the analytical solution
equation  <dig> represents the relative distribution of carbon isotopologues from natural abundance only, as a sum of multinomial coefficients multiplied by the intensity of im+ <dig>  the theoretically untainted 12c monoisotopic peak. the terms being summed are similar in form to those presented in snider,  <dig>  im+i;na is the expected intensity of the ith isotopologue peak representing i additional nucleons. naxc is the fractional natural abundance of the xc isotope. cmax is the number of carbons in the molecule. the multinomial coefficients, derived from the multinomial theorem with  <dig> variables represent the number of possible isotopomers of identical mass for a molecule with cmax carbons given  <dig> isotopes of carbon: 12c, 13c, and 14c.

isotopologue peaks containing 14c are typically not observed, since the isotope is very rare. moreover, due to the very high mass resolution in ft-icr-ms histograms, isotopologue peaks representing molecules comprised exclusively of the major isotope of chonps elements  along with 13c, are completely resolved/deconvoluted and identified. thus, we can ignore the contributions from 14c and from minor isotopes of all other elements excluding carbon. this simplifies the calculation to a single term with a binomial coefficient  shown in equation  <dig>  where na13c â‰ˆ  <dig> . the binomial coefficient represents the number of possible isotopomers of identical mass for a molecule with cmax carbons given only  <dig> isotopes of carbon: 12c and 13c.   

at natural abundance, each peak, im+i;na, is directly related to the theoretically untainted 12c monoisotopic peak, im+ <dig>  that has a fractional intensity of  <dig> when dividing by the sum of isotopologue intensities. however, once 13c is incorporated into the molecule from a labeling source, the calculation of the contributions from natural abundance becomes more complex  <cit> . the effects of 13c natural abundance now depend on the amount of 13c label already present. with each 12c/13c isotopologue resolved in the ft-icr-ms histogram, we can use a series of binomial terms to accurately describe and correct for 13c natural abundance. equation  <dig> shows the basic form of these binomial terms as bc where k represents the total number of 13c carbons present, n represents the number of 13c carbons due to incorporation from a labeling source, and k-n is the number of 13c carbons due to natural abundance. the binomial coefficient in equation  <dig> enumerates the number of ways that k-n 13c carbons can be incorporated into the molecule when n carbons are already labeled with 13c. equation  <dig> shows the first series needed in the correction, bcsum which represents the fraction of im+i intensity that is converted to other isotopologues due to the effects of natural abundance.   

equation  <dig> shows the full correction as the original isotopologue intensity minus natural abundance contributions based on lower mass untainted isotopologue intensities. division by the fractional intensity,  <dig> - bcsum, compensates for natural abundance effects that lower the intensity of the given isotopologue. as illustrated in table  <dig>  equation  <dig> must be applied in a sequential fashion starting with i =  <dig>  since the results of each step are needed in subsequent steps. in other words, the natural abundance corrected intensities of isotopologues with lower 13c incorporation from labeling are needed to calculate the natural abundance correction of isotopologues with higher 13c incorporation from labeling.   

im+ <dig> =  <dig>  = 
the example involves a four-carbon molecule with 13c-labeling involving a single carbon 50% of the time. each row represents a single application  of equation  <dig>  all numbers rounded to three significant figures.

bcorrected isotopologue values. the use of these values in subsequent steps is highlighted in bold.

ccontaminated isotopologue values.

since 15n incorporation can be distinguished from 13c incorporation due to the very high mass resolution in ft-icr-ms histograms, it takes only a trivial conversion of equations  <dig>   <dig>  and  <dig> to handle labeling in 14n/15n isotopologues. we simply replace nmax for cmax and na15n for na13c. however, handling all of the mixed 14n/15n/12c/13c isotopologues that arise from simultaneous 13c and 15n labeling requires a series of two binomial terms multiplied together as shown in equations  <dig> and  <dig>  given the peaks are isotopically resolved, there are cmax * nmax separate observable isotopologues, whose intensities are represented by im+i, j;na. the multiplied binomial terms, bc * bn, describe the combined effects from both carbon and nitrogen natural abundance.   

a version of each equation in larger fonts is available in additional file  <dig> 

implementation of the algorithm
we implemented equations  <dig>   <dig>  and  <dig> as an iterative algorithm in the perl programming language . iteration allows the algorithm to partially compensate for missing  isotopologues. the algorithm  starts with cmax and the observed 12c/13c isotopologue intensities contaminated by contributions from 13c natural abundance. based on cmax, the algorithm precalculates the binomial coefficients needed in later steps using equations  <dig> and  <dig>  during each iteration, the algorithm performs three steps. in step  <dig>  the algorithm calculates the set of uncontaminated 12c/13c isotopologue intensities using equation  <dig> and the observed intensities supplemented with calculated contaminated intensities for missing isotopologues. from equation  <dig>  it is apparent that this must be done in ascending mass order starting with im+ <dig>  sometimes, small negative uncontaminated intensities arise from errors in the observed intensities. these negative intensities are flattened to zero, since they have no basis in reality. next, the algorithm renormalizes the uncontaminated intensities based on the sum of observed intensities. this is required since missing isotopologues were supplemented with calculated values and negative intensities are flattened to zero. in step  <dig>  the algorithm calculates the set of contaminated intensities based on the uncontaminated set by solving for im+i;na in equation  <dig>  in step  <dig>  the algorithm calculates the absolute difference between observed and calculated contaminated intensities. if this difference decreases, the algorithm performs another iteration until no more improvement is seen. finally, the algorithm prints the results and ends.

testing the implementation
we created several sets of simulated isotopologues  with varying levels of 13c-labeling and added the expected contributions  from 13c natural abundance by solving for im+i;na in equation  <dig>  we then tested the implementation with these test sets. figure  <dig> shows the results for three of these test sets of a hypothetical metabolite with  <dig> carbon atoms. the 13c natural abundance contaminated intensities are in red and corrected intensities in green. the red bars in figure 2a represents the expected observed isotopologue intensities when no 13c-labeling is present. this naturally collapses into a single green 12c monoisotopic peak with correction. figure 2b shows the contaminated and corrected isotopologue intensities when equal amounts of 13c-labeling for  <dig>   <dig>  and  <dig> carbons are present. there is a tapering phenomenon observed in the contaminated intensities due to the fact that the number of carbons affecting the intensities decreases with increasing amounts of 13c-labeling. equation  <dig> captures this phenomenon within its binomial coefficient where it is further demonstrated in figure 2c with natural abundance having no effect on a metabolite with 100% 13c-labeling.

the implementation is also quite efficient even in an interpreted programming language like perl.  <dig>  repetitions of this algorithm for all  <dig> simulated test sets took only  <dig> seconds on a single core of an intel t <dig> core  <dig> duo mobile processor with 2gb of ram and running release  <dig>  of the redhat enterprise linux operating system. the implementation is also very accurate. given the perfect data in these three simulated test sets, the largest error was  <dig>  Ã— 10- <dig> seen in the im+ <dig> corrected intensity for the test set representing no 13c-labeling . furthermore, the implementation appears quite robust since the relative error actually decreases as the number of carbons  increases. at a cmax =  <dig>  the relative error is  <dig>  Ã— 10- <dig>  this implementation does have some numerical limitations, for example, the cmax must be less than  <dig> carbons due to all numerical quantities being represented as double precision  floating point numbers. however, this limitation is easily overcome by using higher precision floating point numbers.

application to phosphatidylcholine 34: <dig> observed isotopologue intensities
discussion and 
CONCLUSIONS
overall, correcting for the effects of natural abundance makes interpretation of isotopologue intensities from stable isotope tracing experiments easier within the context of cellular metabolism. such a correction is required before using more quantitative methods of interpretation. since the relative error is virtually zero with perfectly simulated data and the algorithm is very robust with increasing cmax, the accuracy of this correction is really only limited by the error in the isotopologue intensities themselves. thus, the propagation of data error through this algorithm should be straightforward to analyze and quantify. moreover, from equation  <dig> it is evident that effects from natural abundance significantly link together groups of observed isotopologue intensities. this difference between calculated and observed intensities should be highly sensitive to the error in a set of isotopologue intensities. therefore, this difference should be usable as an independent check on the quality of the observed set of isotopologue intensities. such a quality control check would be especially useful when it is not possible or practical to repeat experiments or to determine whether additional experiments are necessary.

