BACKGROUND
modelling phenotypic variation in biological pattern generation
the whole development process of higher organisms can be mathematically conceptualised as a recursive mapping - i.e. successive cell differentiations leading to a sequence of unfolding patterns at many different spatiotemporal scales, each pattern defining the context for further differentiation and thus for subsequent patterning processes. a deep understanding of what causes the phenotypic variation arising from such patterning processes cannot be claimed before we are able to recreate this variation theoretically by what we call causally cohesive genotype-phenotype models   <cit> . unlike the broader class of mechanistic mathematical models describing how complex biological phenotypes arise from the interactions of lower-level systemic entities, cgp models are distinguished by linking together  the individual's genotype and its phenotype in a causal mathematical structure. cgp models thus allow the construction of genotype-phenotype maps, i.e. mappings predicting the phenotype associated with a given genotype based on what we know about the regulatory anatomy of a given biological system.

irrespective of the level of biological resolution of a cgp model, genetic variation has to be represented as parametric variation. in a genotype-phenotype-map perspective one is thus interested in getting a clear understanding of the mappings between genotype parameter space and the generated phenotypic space. however, in the context of multicellular patterning models it is not trivial to establish this relation. the very concept of pattern implies that what matters is not the state of every single cell, but certain emergent qualities of the total cell aggregate which express relations between the states of subsets of the cells. thus, in order to set up a genotype-phenotype map in such a spatiotemporal pattern setting one cannot just establish a mapping between domains in parameter space and certain properties of locally defined intracellular and extracellular state variables. one is actually forced to construct new descriptors of the emergent pattern features, express them in an abstract pattern descriptor space, and establish their relations to properties of the original model. in addition to leading to a genotype-phenotype map, this approach opens possibilities for additional validation of the model through prediction of higher level and empirically observable properties that are by no means part of the model's premise set, and which represent emergent features of the pattern that are interesting and relevant from the point of view of purpose and objectives of the original pattern-generating model.

there is today no general procedure for how to relate a set of patterns and their characteristic features to the functional relationships, parameter values and initial values of the original pattern-generating model. here we propose a multivariate data modelling approach which is based on three major elements:  cost-effective computer simulations to probe the high-dimensional parameter space,  informative ways to describe the model's graphical patterns quantitatively as points in a pattern descriptor  space, and  ways to establish two-way mappings between the pd space and the parameter space in terms of a statistically reliable and interpretable statistical prediction model .

we illustrate our approach on a simple mathematical model of pattern generation, and show that even in this case, traditional and intuitive methods prove inadequate to describe and understand its full potential of pattern formation, while our approach provides an overview and reveals unexpected features and their relationship to the model parameters.

the illustration model
a large number of cell differentiation processes involve the membrane-bound protein notch which interacts with several transmembrane ligands in neighbouring cells  <cit> . thus, understanding the diverse functions of notch is of paramount importance in itself. one patterning mechanism in which notch is involved is lateral inhibition: a cell-cell interaction whereby a cell developing a specific fate inhibits its neighbours from developing in the same way. delta is one of the ligands binding to notch; delta in one cell binds to notch in the cells in physical contact, leading to juxtacrine signalling  <cit> . the multicellular gene network regulating this process is called the neurogenic network  <cit> . however, as early as  <dig> collier et al.  <cit>  presented what can be considered as a simplified multicellular cgp model for delta-notch activity in a one- or two-dimensional lattice of discrete cells. in this model the rate of change of notch activity increases with the average activity level of its ligand delta in neighbouring cells, while the rate of change of delta activity decreases with increasing activity level of notch in the same cell, both relationships being expressed in terms of sigmoidal response functions.

on a two-dimensional lattice of n identical hexagonal cells we let dk and nk, k =  <dig> ..., n, represent the activity level of the two proteins delta and notch in cell number k. in suitably scaled variables, assuming first-order degradation, and with the standard hill function representing sigmoid stimulus-responses, the dimensionless model of collier et al. is

   

   

in which μ is the ratio between the degradation rates for delta and notch,  is the average value of delta in the six neighbours of cell k, and s is the standard hill function s = xp/. thus, θd and θn are the thresholds for the action of delta and notch, respectively, and pd and pn are the corresponding steepness parameters .

the positive feedback loops between any pair of neighbouring cells which these interactions generate, lead to differentiation: high delta and low notch activity in a cell favours low delta and high notch activity in neighbouring cells, and vice versa. on a one-dimensional string of discrete cells, the final, differentiated states are strongly dominated by an alternating pattern: apart from scattered exceptions in which two neighbouring cells both express either delta or notch, every second cell expresses delta and suppresses notch, and vice versa. on a two-dimensional lattice of square cells this behaviour is consistent with the well-known checkerboard pattern. using standard linearisation methods, collier et al.  <cit>  showed that the system of regular, hexagonal cells possesses three basic 3-periodic patterns consisting of up to three cell types. in our simulations the basic regular patterns appear either by cells expressing notch surrounded by cells in which notch expression is inhibited, or vice versa.

however, two-dimensional lattices of real cells are usually rather irregular and do not have periodic patterns. podgorski et al.  <cit>  have combined the model of collier et al. with models for apoptosis and differential adhesion to study the patterning process on irregular cell lattices. but even on a regular lattice of hexagonal cells irregular patterns arise because the system is frustrated  <cit> : it is impossible to satisfy the requirement of opposite expression of delta and notch between all pairs of neighbouring cells. if cell  <dig> expresses notch, its neighbouring cells  <dig> and  <dig> should both express delta, which causes frustration because cells  <dig> and  <dig> also may be neighbours. this results in a multitude of different patterns, sometimes with a high number of different notch and delta levels, depending on parameter values and initial conditions .

in fact, our simulations showed that the majority of patterns and pattern features are highly irregular. initial trial and error simulations for different combinations of parameter values revealed a wide range of different kinds of patterns, and for certain parameter value combinations we observed a large number of different equilibrium levels. trying to describe these irregularities as combinations of basic regular patterns did not seem to make much sense. rather, our approach was to try to introduce new concepts and pattern descriptors to classify and describe the irregular pattern as patterns in their own right. it was also obvious that without a systematic, planned simulation design as outlined above, there could be no hope of achieving a sound description and classification of the pattern and reveal their relation to variations in parameter values.

RESULTS
general procedure
we combined various explorative principles in order to maximise insight from the computer simulations. factorial statistical design plans ensured that the parameter space was spanned systematically. each solution image was characterised by a range of dedicated, quantitative descriptors, and the results interpreted by multivariate data modelling.

we analysed the high-dimensional, non-linear delta-notch model on a 2d lattice of hexagonal cells by this approach. for each set of parameter values the system of differential equations was integrated in time until a stable state was reached. the spatial distribution of the stable-state notch concentrations were plotted as black and white 2d images of the cell lattice for easy visual inspection.

the exploratory process proceeded through four distinct stages . together, these four stages were intended to yield maximum new insight into the behavioural repertoire of the model with minimum effort and minimum number of additional assumptions.

 the interesting ranges for the model parameters were determined in a preliminary exploration. in this trial-and-error based phase the parameters were changed one at a time, and the solution images inspected informally, to determine values to be used as "high" and "low" for each parameter in the subsequent designs.

 secondly we defined a  <dig> full-factorial design and expansions of this in order to explore the parameter space domain found interesting in phase . the equilibrium solutions images were submitted to computerised image analysis by standard mathematical filters of various kinds, like gray-tone density and spatial frequency histograms. this profile of many, but per se meaningless image descriptors could be related to the seven known model parameter values by well-established multivariate methods from chemometrics, primarily conventional reduced-rank partial least squares regression   <cit>  with optimal rank determined by cross-validation as described in  <cit> . this permitted us to identify parameter combinations which could be ignored in the main explorative experiment because they had little or no effect on the solution patterns.

 in the main experiment we employed a more informative, but also more laborious solution profiling. it consisted of a fractional factorial design created in order to span the range of all parameters and their combinations that were found to have a clear effect in , by means of a minimum number of numerical simulation solutions. due to the insight obtained from our previous screening, our new design could be reduced to only  <dig> selected combinations of a high or low value of each of the seven model parameters, with six non-informative  solutions replaced by two replicates of an intermediate parameter combination with independent random starting value sets, each assessed independently in three sensory parallels .

human sensory descriptive analysis was used for image description. it provides systematic, inter-subjective description in intelligible terms with high repeatability. such sensory descriptive analysis is standard procedure in food science  <cit>  and also used for describing and comparing e.g. perfumes or the quality of mri images  <cit> . here we used it for assessing printed images of outcomes from the model of cell differentiation. a panel of professional human assessors first developed adequate terminology, and was then trained in describing and comparing a set of images of steady-state solutions from the simulations with respect to these descriptor terms  <cit> . during this process each assessor's subjective "private language" was replaced by a common "inter-subjective" set of terms which was agreed upon by all persons involved, both with respect to what it means qualitatively and to how it should be reported quantitatively. the sensory analyses are detailed elsewhere  <cit> .

the resulting tables of profile data were modelled by multivariate "soft modelling" based on reduced-rank partial least squares  regression  <cit> . the main covariation patterns among the observed descriptors were identified and related to the chosen model parameter values in a subspace-model defined by statistically significant covariance eigenvectors. cross-validation was used to distinguish between phenomena with predictive validity and apparent noise effects. this made it possible to find and interpret the main patterns of co-variation while ignoring minor details that otherwise would have lead to over-parametrisation.

the  <dig> image profiles could thereby be mapped onto points in the pd space, and plsr was used for further analysis of the descriptors and their relation to the model parameters. figure  <dig> shows examples of pattern classes thus identified.

 finally, we pursued unexpected pattern types discovered in the main experiment  in more detail in a final follow-up experiment, involving a dense sampling of the model parameter θd for a few fixed combinations of the other parameters. the solutions were characterised by both sensory descriptive analysis and by a computational method by which the frequency of the observed notch concentration levels were recorded at each parameter value.  in the following we summarise the main results.

pattern descriptor space and pattern descriptor model
the parameter ranges found to be of interest in the preliminary exploration   were used for designing the subsequent two experiments  and . the image analysis filters employed in the extensive screening experiment   revealed systematic co-variation patterns in the image analysis profile data. but these patterns were difficult to interpret. the main, sensory-based experiment  employed a modified version of the reduced design , and consisted in using a trained sensory panel to define verbal pattern descriptors and then quantify the patterns in each image in terms of these descriptors. based on input from the investigators the sensory panel defined  <dig> descriptors which they considered sufficient and by which they subsequently quantified the patterns . this allowed us to develop a pd model  by bi-linear plsr regression in latent variables, relating the chosen  <dig> sensory descriptors , to the seven model parameters via  <dig> latent variables, over the  <dig> images. perturbations in the model parameters θd, θn, pd and pn, alone and in combinations, clearly affected the solutions in systematic ways, while variations in μ  and in the initial conditions had fairly small effects. based on split-half cross-validation  <cit> , the pd model correctly predicted 88% of the variance in the  <dig> sensory descriptors from the model parameters. conversely, 85% of the variance in the selected non-linear model parameter combinations was correctly predicted from the pattern descriptors.

we found that the pd model clustered the  <dig> graphical patterns in four main classes, here named i, ii, iii, iv . in a cross-validation experiment in which each image was treated as unknown against a pls discriminant analysis model estimated from the other  <dig> images, the set of pattern descriptors could be used for successful classification of each of the  <dig> images into the four classes. the clustering was confirmed by independent hierarchical cluster analysis of the patterns based on their euclidean distances in pd space, and appears to be quite robust .

images belonging to one and the same class share obvious visual pattern characteristics that distinguish them from images from the other classes, and can be associated with different domains in parameter space . for example, low values of θd are a clear indication that the resulting pattern will fall into class i. the images in class i are likely to be high in the descriptors sharpness, contrast and patternblack, and low in whiteness and patternwhite, implying primarily black and white cells, the former outnumbering the latter and participating in the curls which dominate the pattern in this class .

parameter-dependent differentiation phenomena
we subsequently  checked that the clustering is not just an artefact stemming from the low number of patterns in the fractional factorial design by running the fourth and final set of simulations to pursue details. we varied the delta threshold parameter θd in small steps to traverse the pd space along a straight line, illustrated in the biplot of figure 4a from the previous simulation experiment, from class i  via class iii  and up to θd =  <dig> . some new sensory descriptors were added .

from these results, good predictive pls regression models were developed between the sensory descriptive profile and the model parameters within the parameter range calibrated for, as exemplified for θd in figure  <dig>  moreover, rather than spreading evenly in pd space, the image properties jump between a few clearly separated domains in the 3-dimensional pls component space, with few intermediates .

as θd increased, the estimated notch activity passed through a series of complicated, abrupt changes resembling bifurcations , showing that the statement of collier et al.  <cit>  that the patterns are insensitive to the precise values of the model parameters is only partially true. ordinary bifurcation diagrams show the number of coexisting stable states of which the system may occupy just one at a time, but figure 7a shows the number of stable notch levels actually expressed simultaneously over the lattice for each value of θd. that is why this is not a bifurcation diagram in the common sense. we propose to call it a differentiation diagram, where θd is a differentiation parameter regulating the number of simultaneous levels, or the degree of differentiation. this being said, the diagram shows a large number of "bifurcation" values of θd for which the number of simultaneous notch levels changes. the number of levels is related to the complexity of the image: a high number of levels come with a complex and highly irregular pattern. a high number of equilibrium levels, e.g. at either side of θd =  <dig>  and  <dig> , correlates with long integration time . both can be seen as a consequence of high frustration  <cit> , which implies that the system needs extensive fine-tuning and either takes a long time to settle in a stable, patterned state or is chaotic. despite the fact that no descriptor was designed with analysis of differentiation in mind, the descriptors characterise the patterns in a way that at least partly reflects the complicated differentiation pattern for varying θd .

initial state variations, repeatability and boundary effects
for a given set of parameter values the total number of stable states in a large network is probably very large. however, each initial state  lies in the attractor basin of just one patterned state. an important question is whether the patterns generated by all  for a given set of parameter values lead to more or less the same state in pd space. for a realistic model of a biological system we would expect this to be true, as biological systems are almost by definition structurally stable and thus insensitive to internal and external stochastic fluctuations. thus, contrary to stable points in phase space, we would expect points in pd space to have large attractor basins.

once the clustering into four classes was discovered during the multivariate analysis of the sensory data, it was straightforward to test the robustness and the visual appearance of these pattern types. varying initial conditions within the imposed limits  changed the details of the patterns without appreciably altering their descriptor profiles. this is illustrated by the proximity of the two independent random initial condition replicates in class iv . the precision of the sensory descriptive analysis is also illustrated in the same figure by the closeness of the three independent sensory parallels within each of these two initialisation replicates.

with periodic boundary conditions, which are commonly used to mimic an infinite domain, we expected that the boundary effects would be negligible as regards the pattern characteristics. this was confirmed by simulations in which the original  <dig> ×  <dig> lattice was embedded in a larger  lattice which was run with the same set of random initial perturbations as in the  <dig> ×  <dig> lattice. the final patterns in the  <dig> ×  <dig> lattice in the two cases belonged to the same class, and in most cases were almost identical . some very large-scale spatial patterns appear as boundaries between domains with a three-periodic pattern, but with a phase shift along the boundaries . in an infinite-sized lattice we expect these patterns would fail to appear. by increasing the pattern size to  <dig> ×  <dig> we found that some of these changed to a 3-periodic pattern all over the lattice without phase-shift boundaries .

discussion
spatial patterns are determined by the concentrations of certain species in each separate cell. but to handle and analyse differentiation and patterning we need mathematical variables that express the macroscopic, essential properties that allow us to describe, classify, and distinguish qualitatively different patterns in biologically meaningful ways. to this end it is of little value to specify the equilibrium values and positions of millions of individual cells. the macroscopic pattern is an emergent, aggregate property, and the pattern characteristics of interest can only be described meaningfully by new, dedicated variables defined explicitly to describe and quantify just the macroscopic properties of the patterns that the modellers deem of interest.

for a moderately sized model, any number of numerical simulations can be run and almost unlimited amounts of simulation data can be stored with modern high speed and high capacity computers. however, more data does not necessarily lead to more insight. the challenge is to maximise discovery, overview and statistical power, while minimising work and risk of over-interpretation. multivariate data modelling in latent variables has proven to be a highly useful approach for extracting and displaying the main co-variations in high-dimensional response profiles.

in the present case, we chose a pragmatic explorative approach, involving qualitative methods that facilitate the detection and conceptualisation of novel phenomena, and quantitative methods that permit modelling, prediction, validation and interpretation. for each stage in our approach there exist general and well-documented methods that have proved their efficiency and reliability in a large number of applications. as others have experienced before us in various settings, the human visual system combined with a task-specific vocabulary is a scientifically reliable and superbly versatile tool  <cit>  for finding, quantifying and communicating regular as well as irregular patterns. for example, we discovered the pattern type "two-headedness"  because the class-iii parameter combination showed abnormally high scores of the sensory descriptor multishade in the  <dig> ×  <dig> lattice in the first sensory experiment. once this feature was discovered, we developed a specific term, "two-headedness" for it, with the descriptor twoheadedness. the sensory panellists were "calibrated"  for this trait to ensure intersubjectivity and repeatability. then it was quantified along with the other sensory descriptors in the second sensory experiment , which allowed it to be compared to the differentiation diagram . prior to its detection, it was difficult to pick up this strange feature by the automatic computerised image analysis. but after having discovered it during the sensory assessments we were able to construct a specific mathematical image analysis filter that quantifies it. this will be described elsewhere.

our set of descriptors is clearly not sufficient to describe or classify all images generated by the model. that was never our goal. we selected those descriptors that we found best suited to describe those pattern features that after the initial scans appeared to be most interesting to us. models are always constructed with a purpose, and the researcher's interest will in general be focused on those aspects of the images that are relevant for this purpose. a need for extensive investigations of complex model arises simply because one cannot say in advance how the model will behave and which behaviours may turn out to be of interest and importance.

it seems that our approach promotes effective investigation of the outcomes of pattern-generating models , and is characterised by a number of attractive features. it is cost-effective: initially screening many conditions by low-cost, but non-specific profiling test methods, and then pursuing selected conditions by more informative methods. it is statistically stable: only relationships that show predictive ability in "secret" simulation  are accepted. it is focused: searching for a description of only those properties of the original model that are of interest, ignoring all irrelevant details and leading to an enormous phase space reduction. it is wide-ranging: yielding an overview as well as the ability to predict details. it is analytic: providing an explanation of the dominant pattern features in terms of properties of the original model, i.e. of the real system that is being modelled. it is adaptive: if the researchers' attention should be turned towards other or additional features, the model can be adapted or replaced by another system-level model generated in the same fashion. it is inter-subjective: using standardised and well-tested methods from sensory science and chemometrics helps to keep subjectivity due to the researchers' individual bias and preferences to a minimum. it leads to a system level model: seeking a description and understanding of the emergent phenomena and features of the patterns that are the result of the system as a whole and that only have meaning on the level of the system itself, and relating the relevant characteristics of the final patterns directly to the system parameters without specifying the levels of every single cell. as far as the relevant features of the final, stable patterns are concerned, the system-level model replaces the original ode-based pattern-generating model. given a set of parameter values, we can predict the corresponding type of pattern without actually integrating the system, and given a pattern, we can predict the parameter domains leading to it.

in our opinion, there is little hope that realistic multi-scale spatiotemporal cgp models which explain high-dimensional phenotypic variation associated with the emergence of biological structure, organisation and function through differentiation, can be expressed in a simple way. in contrast to our simple illustration model, realistic pattern-generating cgp models will in general be dynamic, non-linear and complex, with numerous variables and parameters, possessing a hierarchical structure and perhaps containing continuous processes as well as discrete event processes, and discrete or distributed time delays. they will also have to deal with noise and stochastisity as well as random perturbations during the course of development. large and complex models for open systems will possess emergent features that cannot be inferred from the building blocks of the model, and may generate a large repertoire of different mathematical behaviours depending on initial values and boundary conditions, parameter values and details of the functional relationships. in this connection the behaviour of the model could simply mean its ensemble of final, stable states, or the transient motions leading to these states might also be included. in either case, achieving a complete survey of all possible, relevant behaviours is hardly possible using a traditional mathematical analysis where analytical investigations are combined with intuition-based simulations and global or individual parameter fits to data. that approach is widely used, but may fall short of disclosing the full range of possible behaviours of even quite simple models. as the disclosure of a substantial part of the phenotype space is a prerequisite for developing comprehensive genotype-phenotype maps, there is indeed a need to develop robust and generic methodological standards for discovering the behavioural repertoire of complex patterning models. it is likely that combined with analytical investigations and numerical "experiments", a factorial design approach as outlined here will become part of such a standard.

CONCLUSIONS
the number of cells could have been increased many-fold without complicating the analysis apart from being computationally more demanding. this suggests that our approach could be used on biologically more relevant and mathematically more complex pattern models with many chemical species, larger numbers of parameters and more complex interactions. scaling issues may appear, though, and we do not know how human pattern description scales up to three dimensions and irregular cell lattices. this should be addressed so that we can make a realistic assessment of to which degree a combined use of system dynamics methodology and multivariate data modelling in latent variables has the potential to become a generic approach to explain higher-order differentiation phenomena.

