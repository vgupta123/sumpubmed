BACKGROUND
affymetrix genechip arrays have become a widely used microarray platform. an advantage of such a broadly accepted platform is that it greatly helps to compare rna expression patterns between experiments from different researchers. rna expression patterns are a starting point for high-level analysis such as clustering, self-organising maps or metabolic pathway analysis. the importance of "low level analysis", that is, calculating the expression levels and the normalization procedure as explained below, is easily underestimated.

calculating gene expression is more complex with affymetrix arrays compared to spotted arrays, as the latest generation affymetrix arrays have  <dig> probe pairs available to interrogate each gene, whereas spotted arrays in general have only one cdna or oligo probe per gene. ideally, the signal intensity from all of these  <dig> probes should be equal because they all interrogate the same gene. in reality, however, there are enormous differences between individual probes in a probe set. the pattern of the probe signals in a probe set is called a "probe response pattern"  <cit> . the probe response pattern of one gene is roughly the same from all rna samples isolated from a given tissue, irrespective of the treatment  <cit> . the affymetrix system uses microarray suite  or its successor genechip operating software  for operation of the microarray scanner and also for calculation of the expression values. the expression values are calculated according to the so-called "one-step tukey's biweight algorithm", which is based on a weighed median  <cit> . recently, more methods have become available for calculating gene expression values, such as "model-based expression indexes"  from li and wong  <cit>  that are implemented in the freeware program dchip. also available is the "robust multi-array average"  software from irizarry et al.  <cit> . in contrast to mas  <dig>  or gcos, in which information from only one microarray is used, model-based algorithms incorporate information from multiple microarrays to calculate the expression of a gene. the probe response pattern is fitted over multiple arrays with a multiplicative model in dchip and an additive model in rma software. these algorithms use the fitted models to detect abnormally behaving probes, which are subsequently excluded for calculating gene expression. therefore, gene expression from these model-based algorithms can be expected to provide more reproducible results. both dchip and rma use a stochastic model to estimate gene expression. a potentially better way of estimating gene expression would be the use of a physical model, that is, a model that explains the probe response pattern by physical laws. a few attempts have been made to make such physical models  <cit>  such as "positional-dependent-nearest-neighbour model" , or a combination of the two model types genechip and rma .

a specific feature of affymetrix microarrays are the so-called mismatch  probes. each of the  <dig> probe pairs in a probe set has a perfect match  and a mismatch probe, with each probe having  <dig> bases. the pm probes are designed to bind perfectly to the gene of interest and the mm probes have a contrasting base at position  <dig> with the intention to measure non-specific binding  <cit> . the pm and mm probe of one probe pair are located physically next to each other on the microarray. both mas <dig> and dchip in the pmmm mode use this information to calculate gene expression. however, in the literature there is a debate over the usefulness of mm probes, which has resulted in new algorithms that use only the pm signals to calculate gene expression. these algorithms are implemented in dchip pm mode  <cit> , in the "robust multi-array average"  software  <cit> , gc-rma  <cit>  and in pdnn from zhang et al.  <cit> .

when dealing with experiments involving multiple arrays, there is a need for data normalization, after calculating gene expression. the overall signal intensity can vary between arrays and if this variation does not have a biological origin, it should be removed. non-biological variation can arise due to differences in sample preparation, production and processing of arrays. there are different algorithms available to normalize microarray data. the mas  <dig>  or gcos software currently assumes that intensity differences between two or more arrays are linearly related and have a zero y-intercept. this allows for a very simple and robust normalization factor. however, the drawback is that this method cannot adjust for non-linear relations. schadt et al.  <cit>  found  <dig> to 50% differences in the slope between the low and high expressed genes in many arrays. in those cases an alternative normalization method is needed. for example, dchip uses a non-linear smoothing method  <cit> . in mas <dig> and dchip one array is chosen as the base line array, to which the other arrays are normalized. rma does not use a base line array, but "quantile normalization", based on the complete data set  <cit> . furthermore, it is preferred that genes changing in expression should not be included in the normalization procedure. therefore, some algorithms  use invariant sets; these comprise a set of probes that most likely have the same expression between arrays. an invariant set is determined by ranking probe intensities such that when a probe has approximately the same ranking number in two arrays, then this probe is likely to have the same expression in both arrays  <cit> .

thus different algorithms calculate gene expression and normalize the data in completely different ways. we hypothesize that the signal of gene expression, and therefore the identity of genes that are significantly up/down regulated, depends on the algorithm used. to test this hypothesis a microarray experiment was performed with arabidopsis thaliana accession columbia- <dig> and various calculation methods were compared. plants were exposed for  <dig> hours to elevated ethylene levels  or were transferred to low-light levels for  <dig> hours . both conditions induce an identical phenotype; the upward bending of the leaves by  <dig> degrees . the treated and control petioles were harvested at the same time with three biological replicates. the dataset is publicly available  <cit> . these data were analysed with six different methods: mas <dig> , dchip pmmm, dchip pm-only, rma, gc-rma and pdnn. some other studies have compared different calculation methods. barash et al.  <cit>  compared only three algorithms with a very limited amount of microarrays. furthermore, choe et al.  <cit>  compared many options in the bioconductor's affy package, including the calculation of the expression values, however, again only three algorithms were compared. seo et al.  <cit>  compared six methods, four of which are also used in this paper.

different algorithms are optimised for different experimental data sets and hence to different signal to noise ratios. thus, the best method can depend on the specific experiment, so there might not be a perfect method suitable for all conditions  <cit> . it is therefore, important to test for each experiment which method is the most appropriate.

since different calculated expression patterns were expected between algorithms, various criteria were designed and tested to compare the different methods, and to select the best method. 1: we compared the performance of the six methods on the spike-in data set of affymetrix  <cit> . 2: theoretically, we expected that model-based algorithms would produce more reproducible results because aberrant probes are efficiently removed. therefore, we compared the distribution of the coefficient of variation for three replicated microarrays between the algorithms. 3: on the basis of data from the literature or previous experiments we expected that specific genes are affected by a treatment or mutation . 4: furthermore, the problems with the use of mm signals as discussed in the literature are mainly statistical. based on the following arguments we would like to discuss the use of mm values. i: first, we expected that crnas smaller than  <dig> base pairs bind perfectly to both probes. calculation of the melting temperature is performed to estimate the likelihood of those events. ii: secondly, we expected no correlation between the signals from the mm probes and the pm probes because the non-specific binding should have a random influence on the mm probes. to test this, we calculated correlation coefficients between pm and mm signals of  <dig> randomly chosen probe sets. 5: microarray-obtained gene expression of a subset of the common genes was compared with real-time rt-pcr. furthermore, we compared the expression from genes which are exclusively predicted with the best method.

the proposed criteria for biological relevance and reproducibility are easily applied by any microarray user on their own dataset. on the basis of all of the criteria described above a choice for the most suitable algorithm for each dataset is rationalized.

RESULTS
differences between six array algorithms
we hypothesized that the calculated level of gene expression is dependent on the algorithm used because these are based on completely different ways of calculating gene expression and normalization. as a result, a different set of genes may be identified as differentially expressed between a treatment and control.

after calculating gene expression with mas <dig> , dchip pmmm, dchip pm, rma, gc-rma and pdnn, a t-test was performed to analyse differences in expression between plants treated with ethylene and air control. between  <dig> and  <dig> genes were significantly differentially expressed . these results showed that there were differences between the six algorithms in the number of genes differentially expressed within one treatment. however, the differences between the algorithms were relatively small. more strikingly, only 27% to 36%  of the differentially expressed genes between control and ethylene treated plants were identical in the six methods . similar results were obtained when control and low-light conditions were compared . this means that the total number of genes expressed differentially as calculated with these six algorithms was within the same order of magnitude, but the six algorithms identified totally different sets of genes!

when instead of a t-test with p <  <dig>  more stringent conditions were used , less genes were found to be significantly regulated  and also the percentage genes significantly regulated in all algorithms decreased . moreover, if genes were selected that showed more than twofold up or down regulation, different numbers were obtained. however, the huge differences between the algorithms remained . the set of genes that was detected by all methods had on average a lower p value  than the genes identified solely by one method . on average the percentage genes that overlapped was 61% over all possible double combinations but dropped to  <dig> ,  <dig> ,  <dig>  and finally to 32% . our results showed a poor overlap between algorithms. this is not in full agreement with barash et al.  <cit>  and choe et al.  <cit>  who showed  <dig> to 70% overlap between algorithms. however, their results were based on a small number of microarrays or on a special  spike-in experiment. to our knowledge this is the first time that such large differences between algorithms are reported.

from the venn diagram  it is clear that mas <dig> has the highest absolute number of uniquely identified differentially expressed genes compared to the other methods. when expressed relatively, mas <dig> had the highest percentage of unique genes , followed by pmmm , pdnn , pm , rma  and gcrma . furthermore, there are six possible combinations in which five methods might identify the same genes , and the only combination in which mas <dig> was not included  contains dramatically more genes  than the other five combinations in which mas <dig> was included. these data show that mas <dig> gives more unique results compared to the other five methods .

the differences observed between the six methods might have resulted from differences in calculated gene expression values between algorithms. mas <dig> gave the lowest signals and pdnn the highest . overall there was a good correlation  between the signal intensities calculated with the different methods . however, despite this good overall correlation, large local variation remained . for example, a gene with an expression of  <dig>  in mas <dig> may have an expression value that ranges between  <dig>  and  <dig>  in rma. this variation between methods can explain partly the differences found between the algorithms, since 50% of the genes with an intensity between  <dig>  and  <dig>  from mas <dig> are significantly different from rma, after normalization for signal intensity.

there were large differences between the six algorithms with respect to both gene expression and the genes that were significantly up/down regulated. this was a consequence of different ways of calculating gene expression and normalization of the microarrays. the discrepancy between the different algorithms can also be exploited. when the only aim of a microarray experiment is to select new candidate genes then the list of new candidate genes is shortened by approximately 68% by using genes predicted by all six methods. however, when the aim is to obtain expression values from a microarray experiment, a decision regarding which method to use has to be made. various criteria were designed and tested to compare the different methods. cope et al.  <cit>  compared different methods and focused their research on the assessments of performance in terms of bias and variance. this was studied on the spike-in experiment from affymetrix with the hgu95a chips and on a rna dilution study by genelogic. these authors also wrote a program to compare other available algorithms  <cit> . our study further explored the performance of individual algorithms further by five criteria: 1) comparison with spiked-in genes, 2) reproducibility, 3) biological relevance, 4) the use of mm probes, and 5) comparison with real time rt-pcr.

1) spike-in comparison
a commonly used rna spike-in experiment from affymetrix was used to test which method produced the most accurate results. in this spike-in experiment rna of  <dig> genes in  <dig> concentrations were added to a human rna sample. virtually all signal intensities found in real microarray experiments are covered by the signal intensities found for the spike-in genes. in this experiment, the relation between known concentrations of spiked-in rna and signal intensity can be compared between the six methods.

the differences between the six methods were not very large between genes, which were intermediately or highly expressed . genes expressed at low levels, however, showed large differences between the six methods. pdnn and dchip pm performed worst, rma was intermediate, and mas <dig> and dchip pmmm, gc-rma showed the most accurate results with respect to the rna spiked-in. a good accuracy, however, should not be at the expense of precision.

as a measure of precision, the significance level was calculated between successive concentrations of all of the  <dig> rna's spiked-in, so between  <dig> and  <dig>  pm, between  <dig>  and  <dig>  pm up to  <dig> pm. subsequently the fraction of genes that were up regulated significantly was plotted . for the higher concentrations of spike-in genes , dchip pm, dchip pmmm, rma and gc-rma showed almost perfect results, this in contrast to pdnn and mas <dig>  the results of the roc curves from cope et al.  <cit>  also showed that mas <dig> performed worse than rma and pm. for the genes expressed at low levels, all methods performed inadequately. also, when all successive spike-in concentrations were compared with the zero control, again the six methods showed adequate results only at higher concentrations . this shows that although there are differences between methods in accuracy at low concentrations , these do not seem to be relevant, since no significant differences between any of the methods were observed in this lower range .

by extrapolating the results of the  <dig> spike-in genes and using the signal intensity from  <dig> pmol spike-in rna, it is easy to calculate the number and percentage of genes which are equal to the background control . in the normal data analysis these genes can be ignored. depending on the method expression levels of  <dig> to 49% of the genes should be considered as not above background. a possible explanation for the poor results of the spike-in controls for the mas <dig> and pdnn models at the higher expression levels would be the lower reproducibility of these methods. the data for the genes with the highest and lowest 10% of all the standard deviations from the spiked-in genes are excluded, then as expected mas <dig> , pdnn  and gc-rma  showed on average the highest standard deviations followed by rma , pmmm  and pm .

2) reproducibility
algorithms that are model-based can detect abnormally behaving probes more efficiently than non model-based algorithms. therefore, gene expression values from dchip, rma, gc-rma and pdnn result in more reproducible results. the coefficient of variation  is a measure of reproducibility which is independent from the mean. the coefficient of variation for all genes from the three control microarrays were calculated using the six algorithms . when gene expression was calculated with mas <dig> algorithm,  <dig> genes  showed a coefficient of variation lower than 20%. therefore, in general the results from three biological replicates were highly reproducible, with only a small portion of the genes behaving inconsistently between the replicates. as expected the model-based algorithms produced more reproducible results in that  <dig> ,  <dig> ,  <dig> ,  <dig> , or  <dig>  genes had a coefficient of variation lower than 20%. furthermore, if the data for the genes with the highest and lowest 10% of all the standard deviations from all the genes were excluded, than mas <dig>  showed on average the highest standard deviations, followed by pmmm , gc-rma , pm , rma  and pdnn . surprisingly, the pdnn method showed the most reproducible results, which contrasted with the reproducibility of the spike-in data. similar results were obtained with the microarray data for the ethylene or low-light treatments . the model-based algorithms showed the best reproducibility and discarding the mm values improved the reproducibility of these methods even more. cope et al.  also calculated the median standard deviation for different methods and showed that rma and pm gave better results than mas <dig> 

3) biological relevance
for many genes it has been unambiguously demonstrated that their expression is affected by a particular treatment or mutation. it is well known that upon addition of ethylene the expression of several genes in ethylene biosynthesis and ethylene signal transduction pathways show a consistent up-regulation. for example, the expression of acc oxidase increases after ethylene addition in several model systems  <cit> . also, some ethylene receptors  <cit>  and the ctr <dig> gene  <cit>  are known to be up-regulated after ethylene addition. since the change in expression has been reported to occur within  <dig> hours after ethylene treatment we also expect such changes in our array data, based on a treatment of  <dig> hours. data calculated using all six algorithms indeed showed up regulation of an acc oxidase and of several ethylene receptor genes . there were small differences between the results depending on the method used. nevertheless, on the basis of these few genes all six methods produced biologically correct data. therefore, this "biological relevance" criterion is not useful to differentiate between the methods until it is biologically proven how thousands of genes may respond to a given treatment.

4) the usefulness of mismatch  probes
mm signals on affymetrix arrays are designed to interrogate the level of non-specific binding for the pm probes. in principle, carefully designed mismatches but not conventional probes can be used to solve the cross-hybridisation to non-target sequences from genes in large families  <cit> . only choe et al.  <cit>  concluded that subtraction of the mm signal yields better results, because by subtracting the mm signals the variance at low signal-intensity levels is increased, thereby effectively reducing the false positive call. however, the use of mm values has been questioned by others  <cit> . zhou and abagyan  <cit>  concluded that the mm values are not necessary as a previous version of mas software, mas  <dig> , discards the one-one correspondence between a pm and its mm partner and still gives satisfactory results. a large number of mm probes show higher intensities than the corresponding pm probe and can therefore not simply be reporting background hybridisation. for this reason, neaf et al.  <cit>  concluded that mm values should not be used. according to irizarry et al.  <cit>  it is possible that information about non-specific binding is contained in the mm values, but their empirical results demonstrate that "mathematical subtraction does not translate to biological subtraction". they stated that, until a better solution is proposed, simply ignoring these values is preferable. also, allemeersch et al.  <cit>  concluded that the mm values should be ignored because rma outperformed mas <dig> in reproducibility, dynamic range and other related criteria. in this paper we would like to discuss the use of mm values. we assessed whether identical crnas bind to both the pm and mm probes by i) calculating melting temperatures, and ii) analysing the relation between signals from pm and mm probes.

i) one possible contributor to the mm values may be binding of small crnas to the lateral sequence of both pm or mm probes. in other words, since the difference between the pm and mm is at position  <dig> of an oligonucleotide  <dig> bases long, any crna that can bind to either of those lateral  <dig> bases might remain bound in the detection step. it is similarly likely that a crna fragment with its terminal  <dig> base pairs complementary to either lateral  <dig> base sequence of the probe may also remain bound at detection. in this latter case if the crna represents a truncated version of the expected signal crna then true transcript signal may be added to both pm and mm values. according to the rules regarding maximum gc content for probes described by lockhart et al.  <cit>  the experimental hybridisation for affymetrix arrays is performed at a temperature  and stringency wash  which are both higher than the maximum possible melting temperature of a  <dig> mer. based on this argument, crnas smaller than  <dig> bases will not contribute to the microarray signal values. furthermore, since the crnas are fragmented before hybridisation to an average length of  <dig> bases long the percentage of small stretches is low.

ii) one of the probe rules described by lockart et al.  <cit>  is that each probe should differ at least three bases with any other locus on the genome, to avoid cross hybridization. the mm probes are designed on purpose in such a way that they violate this rule, because mm probes differ by only one base from the pm probes. therefore, dna or rna binding to the pm could possibly also bind to the mm probes and vice versa. this hypothesis is supported by the results of resequencing  microarrays. on these arrays the position of a genomic mutation is detected by a so called "footprint", a characteristic decrease of signal for the probes flanking the mutation  <cit> , also illustrated in figure  <dig> of both chee et al.  <cit>  and wang et al.  <cit> . this loss of signal in the footprint shows clearly that a mm probe binds to the same targets as a pm probe but at a much lower efficiency or resulting signal intensity. to further test this hypothesis we checked the correlation between the mm signals and the corresponding pm signals in our data set. the mm signals of the nine arrays were plotted against the pm signals, and since each probe set has  <dig> probe pairs, a maximum of  <dig> data points were plotted per probe set. probe pairs were only plotted when the mm signals were smaller than pm signals . on average  <dig> % of the probe pairs on the arabidopsis ath <dig> microarray had mm signals higher than pm signals. this is similar to results found by naef who showed that 17%  to 35%  of the mm probes have a higher signal than the pm probes. possibly this is related to the complexity of regulatory processes like rna editing and alternative splicing.

in figure 6a and 6b we show two examples in which there is clearly no correlation  between the mm and pm signals and two examples  with a clear correlation . it is obvious that in the latter two examples the gene expression levels of those two genes were severely underestimated. the slope and pearson correlation coefficient of  <dig> ×  <dig> randomly chosen probe sets were calculated. only probe sets were used that represent one gene , because those probe sets should have the least likelihood of cross hybridisation. the results of the first and second  <dig> probe sets were identical  therefore only the result of the combined data set is shown . from the  <dig> probe sets  <dig> had a slope larger than  <dig>  and  <dig> probe sets had a pearson correlation coefficient larger than  <dig> . this means that in 30% of all genes the expression was underestimated with at least 50% and that in  <dig> % there was a clear correlation between the mm and pm signals. ignoring the mm probe signals lead to an increase in the calculated expression values . there was no clear relation between the level of gene expression and probe sets with a correlation between the pm and mm signals . to our knowledge we show for the first time that many probe sets had a correlation between the mm and pm signals, and mm probes could therefore be less good estimators for the non-specific binding of pm probes. it is not clear though in which cases there really is non-specific binding, or binding of the same gene transcript to both mm and pm probes. considering the strong correlations found, probably the same transcript is binding to both probes. if this is true then algorithms making use of mm signals can seriously underestimate the gene expression signal intensity, and as a result, different genes will be falsely identified as differentially regulated.

if mm signals are important for detecting genes expressed at low levels, differences are expected between algorithms using the mm signals  and methods not using the mm signal. analysis of the spike-in data shows  that mas and pmmm are, at best, performing equally well in detecting low expressed spiked-in genes. of the four methods that do not use the mm signals one performed poorly for highly expressed spike-in genes, compared to one out of two for the methods using the mm signals. these data suggest that the mm signals do not increase the detection of spike-in genes in this data set. future research with independent techniques and independent data sets will have to prove how useful mm signals are.

5) real time rt-pcr
to further test which algorithm calculates microarray gene expression most accurately, the results of the six algorithms were compared with real time rt-pcr on a subset of  <dig> genes. these  <dig> genes are predicted by all the six methods to be differentially regulated. real time rt-pcr data can also be calculated with several different algorithms. most widely used is the ΔΔct method  <cit> . one of the assumptions of this method is that the efficiencies of the pcr reactions are the same for the gene of interest and for a reference gene. more recently, other methods have become available, such as the "assumption-free analysis"  <cit> . this method determines the efficiency of each pcr reaction by calculating the slope for the exponential part of the curve. czechowski et al.  <cit>  combined the two methods by using the average efficiency of a gene to correct each ΔΔct value.

a comparison was made between three real time rt-pcr algorithms and six microarray algorithms. the Δct and the Δct in combination with the assumption free method gave highly significant correlations with all microarray methods . the real time rt-pcr assumption free method had less significant correlations with the microarray methods. regardless of the used real time rt-pcr method the best correlation was always found in combination with rma. moreover, the highest correlation was found for rma  <cit>  in combination with the ΔΔct method  <cit> . no significant different correlations were detected. however, the used test is very conservative and will only render significant differences if the correlation coefficients are very different or if the sample sizes are much larger .

to test if there are differences between genes  with respect to what the best method for calculating expression levels, the same correlations were calculated per gene. however, due to the low number of data points per correlation , hardly any significant correlations were found. therefore, we were not able to determine if there is a gene dependency for the best method. to resolve this matter, a wider range of expression levels per gene should be examined.

we also tested if the correlations between the microarray and real time rt-pcr data depended on signal intensity. possibly such correlations might be weak or absent at low signal intensities. however, we did not find any significant relation between these parameters. moreover, except for one, the signal intensities where all larger than the minimal signal intensity to detect spike in gene expression as found in table  <dig> 

besides comparing gene expression values from genes predicted to be changed in expression by all microarray methods we also measured real time rt-pcr  expression from  <dig> genes which were only shown by the rma method to have a changed expression but not by one of the other algorithms. of these  <dig> genes,  <dig> showed the same change in direction  with real time rt-pcr upon ethylene treatment . from those  <dig> genes, only one showed a significant change in expression. there could be two reasons why the rma microarray data poorly corresponds with the real time rt-pcr data. first, the changes in expression of genes exclusively detected with rma are rather small . differences of this magnitude are difficult to detect with real time rt-pcr. second, the standard deviation of the calculated gene expression is compressed by rma, which could result in a high number of false positives. so while the correlations suggest that rma is the best method, for the most part we could not verify expression changes exclusively detected by rma with real time rt-pcr.

CONCLUSIONS
gene expression was calculated with six algorithms, mas <dig>  dchip pmmm, dchip pm, rma, gc-rma and pdnn. all six algorithms resulted in different levels of gene expression, with mas <dig> calculating the lowest and pdnn the highest signals. consequently, depending on the method used, different genes will be identified as up or down regulated by a given treatment. therefore, it is up to the user to decide which method to use to calculate the gene expression profile. the spike-in experiment showed that the differences between the methods for the low expressed genes are not relevant since measurements up to  <dig> pmol rna, did not result in significant signals above background. furthermore, for relatively high expressed genes mas <dig> and pdnn showed the lowest percentage of correctly calculated genes. in our comparison all six methods yielded the expected biological results, with respect to ethylene-induced gene expression. furthermore, all model-based algorithms produced more reproducible results in comparison to mas <dig>  moreover, we conclude that mm signals do not represent non-specific binding for pm signals, since in  <dig> % of the cases there was a significant correlation between the mm and pm signals. subtracting the mm from the pm signals will therefore most likely underestimate the expression signal. rma generally yields the most reproducible results. however, we were not able to verify most genes which were solely identified as having changed expression by rma with real time rt-pcr. different experimental systems may require different methods to obtain the best result  <cit> . if the only purpose of the microarray experiment is to find new candidate genes, and too many genes are found, then mutual exclusion of the genes predicted by contrasting methods can be used to narrow down that list of candidate genes.

