BACKGROUND
traditionally, the nonsynonymous to synonymous rate ratio  is a measure of the strength of selection acting on a protein coding nucleotide sequence. when the nonsynonymous substitution rate is higher than the synonymous substitution rate at a particular codon site, this site is assumed to be undergoing positive selection, i.e. selection in favor of new nonsynonymous mutations. conversely, if the nonsynonymous substitution rate is lower than the synonymous substitution rate at a codon site, it is interpreted as evidence for negative selection, i.e. selection against mutations.

it is well-known that the rate of substitution between amino acids at a particular site depends on both its location in the protein  and the physicochemical properties of the amino acids involved . site specific models have been successful in identifying particular residues, or codon sites, that have been targeted by positive selection . however, relatively little has been known regarding the particular physicochemical properties that have been subject to positive selection. site-specific information regarding the physicochemical properties that have been subject to positive selection is of great interest in many systems. for example, in viral genes, site-specific information regarding physicochemical properties targeted by selection may shed evolutionary light on the biochemistry underlying mutational evasion of an immune response . therefore, it would be very helpful to have statistical methods that can determine the physicochemical properties subject to selection at specific sites.

sainudiin et al.   <cit>  conducted a study to detect selection acting on the physicochemical properties at individual codon sites using the maximum likelihood framework by  <cit>  and  <cit>  generalized the concept of the nonsynonymous to synonymous rate ratio by replacing it with the property-altering to property-preserving rate ratio  that is invoked by a partition of the amino acids according to the physicochemical properties of interest, to explore the physicochemical properties that were targeted by positive selection. a major limitation of their model is that it divided substitutions into two groups:  synonymous mutations and property conserving nonsynonymous mutations, and  property altering nonsynonymous mutations.

in this paper, we generalize the idea proposed by  <cit>  by allowing three categories of mutations: synonymous mutations, property conserving nonsynonymous mutations, and property altering nonsynonymous mutations. the rate of the latter two types of mutations, each of which is scaled relative to the rate of synonymous mutations, is denoted by ω and γ, respectively. this allows us to investigate the selective pressure acting on any physicochemical property of interest using γ, while simultaneously accounting for the non-specific selective pressure at the amino acids level using ω. we also develop a set of new mixture models that allows site-specific inferences of selection acting on specific physicochemical properties. finally, we illustrate the method on both simulated and real data sets.

RESULTS
implementation
modeling physicochemical pressure
in order to test whether there is selective constraint or preference acting on a particular physicochemical property at the amino acid level, we introduce a new parameter γ within the framework of the continuous-time markov chain models of codon evolution proposed by  <cit>  and  <cit> . the state space of the model, assuming the universal genetic code, is given by the  <dig> sense codons. the  <dig> ×  <dig> rate matrix q = {qij} gives the rate of transition from codon i to codon j. the transition rate from codon i to codon j is assumed to be proportional to the stationary distribution of codon j. here we propose two modifications to the basic model to allow selection to act on specific physicochemical properties.

in model a, if codon i and j differ by exactly one nucleotide, then

qij={πj          if i≠j by a synonymous transversionκπj       if i≠j by a synonymous transitionγijωijπj        if i≠j by a nonsynonymous transversion  γijωijκπj     if i≠j by a nonsynonymous transition            where {γij = 1 and ωij = ω, if i and j have the same physiochemical propertyγij = γ and ωij =  <dig>  if i and j have different physiochemical properties     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaajugybuaabeqabiaaaqaabegcbaqclbwacqwgxbqckmaabaaaleaajugybiabdmgapjabdqgaqbwcbeaajugybiabg2da9owaaiqaaeaajugybuaabaqaeeaaaagcbaacciqclbwacqwfapackmaabaaaleaajugybiabdqgaqbwcbeaajugybiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbmgapjabbagamjabbccagiabdmgapjabgcmi5kabdqgaqjabbccagiabbkgaijabbmha5jabbccagiabbggahjabbccagiabbohazjabbmha5jabb6gaujabb+gavjabb6gaujabbmha5jabb2gatjabb+gavjabbwha1jabbohazjabbccagiabbsha0jabbkhayjabbggahjabb6gaujabbohazjabbaha2jabbwgaljabbkhayjabbohazjabbmgapjabb+gavjabb6gaubgcbaqclbwacqwf6owacqwfapackmaabaaaleaajugybiabdqgaqbwcbeaajugybiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbmgapjabbagamjabbccagiabdmgapjabgcmi5kabdqgaqjabbccagiabbkgaijabbmha5jabbccagiabbggahjabbccagiabbohazjabbmha5jabb6gaujabb+gavjabb6gaujabbmha5jabb2gatjabb+gavjabbwha1jabbohazjabbccagiabbsha0jabbkhayjabbggahjabb6gaujabbohazjabbmgapjabbsha0jabbmgapjabb+gavjabb6gaubgcbaqclbwacqwfzowzkmaabaaajuagbaqclbwacqwgpbqacqwgqbgaakqbagqaakqzgfgae8xydcncdawgaaqcfayaakqzgfgaemyaakmaemoaaogajuagbeaajugybiab=b8awpwaasbaasqaakqzgfgaemoaaogaleqaakqzgfgaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeyaakmaeeozaymaeeiiaaiaemyaakmaeyiyikraemoaaomaeeiiaaiaeeoyaimaeeyeaknaeeiiaaiaeeyyaemaeeiiaaiaeeoba4maee4ba8maeeoba4maee4camnaeeyeaknaeeoba4maee4ba8maeeoba4maeeyeaknaeeyba0maee4ba8maeeydaunaee4camnaeeiiaaiaeeidaqnaeeocainaeeyyaemaeeoba4maee4camnaeeodaynaeeyzaumaeeocainaee4camnaeeyaakmaee4ba8maeeoba4maeeiiaaiaeeiiaacakeaajugybiab=n7anpwaasbaakqbagaajugybiabdmgapjabdqgaqbqcfayabaqclbwacqwfjpwdkmaabaaajuagbaqclbwacqwgpbqacqwgqbgaakqbagqaakqzgfgae8nudsmae8hwdancdawgaawcbaqclbwacqwgqbgaasqabaqclbwacqqggaaicqqggaaicqqggaaicqqggaaicqqggaaicqqgpbqacqqgmbgzcqqggaaicqwgpbqacqghgjsucqwgqbgacqqggaaicqqgibgycqqg5bqecqqggaaicqqghbqycqqggaaicqqgubgbcqqgvbwbcqqgubgbcqqgzbwccqqg5bqecqqgubgbcqqgvbwbcqqgubgbcqqg5bqecqqgtbqbcqqgvbwbcqqg1bqdcqqgzbwccqqggaaicqqg0badcqqgybgccqqghbqycqqgubgbcqqgzbwccqqgpbqacqqg0badcqqgpbqacqqgvbwbcqqgubgbcqqggaaicqqggaaiaaaakiaawuhaaaqaakqzgfgaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaee4dacnaeeiaagmaeeyzaumaeeocainaeeyzaumaeeiiaaicdagabaqclbwaeaqaboqaakqzgfgae83sdcmcdawgaaqcbawaakqzgfgaemyaakmaemoaaogajeaybeaajugybiabbccagiabb2da9iabbccagiabbgdaxiabbccagiabbggahjabb6gaujabbsgakjabbccagiab=l8a3pwaasbaakqagfaajugybiabdmgapjabdqgaqbqcbawabagccqqggaaijugybiabb2da9iabbccagiab=l8a3jabbycasiabbccagiabbmgapjabbagamjabbccagiabdmgapjabbccagiabbggahjabb6gaujabbsgakjabbccagiabdqgaqjabbccagiabbigaojabbggahjabbaha2jabbwgaljabbccagiabbsha0jabbigaojabbwgaljabbccagiabbohazjabbggahjabb2gatjabbwgaljabbccagiabbchawjabbigaojabbmha5jabbohazjabbmgapjabb+gavjabbogajjabbigaojabbwgaljabb2gatjabbmgapjabbogajjabbggahjabbygasjabbccagiabbchawjabbkhayjabb+gavjabbchawjabbwgaljabbkhayjabbsha0jabbmha5bgcbaqclbwacqwfzowzkmaabaaajeaybaqclbwacqwgpbqacqwgqbgaakqagfqaakqzgfgaeeiiaaiaeeypa0jaeeiiaaiae83sdcmaeeiiaaiaeeyyaemaeeoba4maeeizaqmaeeiiaaiae8xydcncdawgaaqcbawaakqzgfgaemyaakmaemoaaogajeaybeaakiabbccagkqzgfgaeeypa0jaeeiiaaiaeeymaejaeeilawiaeeiiaaiaeeyaakmaeeozaymaeeiiaaiaemyaakmaeeiiaaiaeeyyaemaeeoba4maeeizaqmaeeiiaaiaemoaaomaeeiiaaiaeeiaagmaeeyyaemaeeodaynaeeyzaumaeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeiiaaiaeeicaanaeeiaagmaeeyeaknaee4camnaeeyaakmaee4ba8maee4yammaeeiaagmaeeyzaumaeeyba0maeeyaakmaee4yammaeeyyaemaeeibawmaeeiiaaiaeeicaanaeeocainaee4ba8maeeicaanaeeyzaumaeeocainaeeidaqnaeeyaakmaeeyzaumaee4camhaaogaay5eaaaaaeaajugybiaaxmaacawljagcdaqadaqaakqzgfgaegymaedakiaawicacaglpaaaaaaaaa@15d4@

similarly in model b, if codon i and j differ by exactly one nucleotide, then

qij={πj          if i≠j by a synonymous transversionκπj       if i≠j by a synonymous transitionγijωπj  if i≠j by a nonsynonymous transversion  γijωκπj     if i≠j by a nonsynonymous transition            where{γij =  <dig>  if i and j have the same physiochemical propertyγij = γ, if i and j have different physiochemical properties      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaajuggbuaabeqabiaaaqaabegcbaqclbyacqwgxbqckmaabaaaleaajuggbiabdmgapjabdqgaqbwcbeaajuggbiabg2da9owaaiqaaeaajuggbuaabaqaeeaaaagcbaacciqclbyacqwfapackmaabaaaleaajuggbiabdqgaqbwcbeaajuggbiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbmgapjabbagamjabbccagiabdmgapjabgcmi5kabdqgaqjabbccagiabbkgaijabbmha5jabbccagiabbggahjabbccagiabbohazjabbmha5jabb6gaujabb+gavjabb6gaujabbmha5jabb2gatjabb+gavjabbwha1jabbohazjabbccagiabbsha0jabbkhayjabbggahjabb6gaujabbohazjabbaha2jabbwgaljabbkhayjabbohazjabbmgapjabb+gavjabb6gaubgcbaqclbyacqwf6owacqwfapackmaabaaaleaajuggbiabdqgaqbwcbeaajuggbiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbccagiabbmgapjabbagamjabbccagiabdmgapjabgcmi5kabdqgaqjabbccagiabbkgaijabbmha5jabbccagiabbggahjabbccagiabbohazjabbmha5jabb6gaujabb+gavjabb6gaujabbmha5jabb2gatjabb+gavjabbwha1jabbohazjabbccagiabbsha0jabbkhayjabbggahjabb6gaujabbohazjabbmgapjabbsha0jabbmgapjabb+gavjabb6gaubgcbaqclbyacqwfzowzkmaabaaajuagbaqclbyacqwgpbqacqwgqbgaakqbagqaakqzaggae8xydcnae8hwdancdawgaawcbaqclbyacqwgqbgaasqabaqclbyacqqggaaicqqggaaicqqgpbqacqqgmbgzcqqggaaicqwgpbqacqghgjsucqwgqbgacqqggaaicqqgibgycqqg5bqecqqggaaicqqghbqycqqggaaicqqgubgbcqqgvbwbcqqgubgbcqqgzbwccqqg5bqecqqgubgbcqqgvbwbcqqgubgbcqqg5bqecqqgtbqbcqqgvbwbcqqg1bqdcqqgzbwccqqggaaicqqg0badcqqgybgccqqghbqycqqgubgbcqqgzbwccqqg2bgdcqqglbqzcqqgybgccqqgzbwccqqgpbqacqqgvbwbcqqgubgbcqqggaaicqqggaaiaoqaakqzaggae83sdcmcdawgaaqcfayaakqzaggaemyaakmaemoaaogajuagbeaajuggbiab=l8a3jab=p7arjab=b8awpwaasbaasqaakqzaggaemoaaogaleqaakqzaggaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeyaakmaeeozaymaeeiiaaiaemyaakmaeyiyikraemoaaomaeeiiaaiaeeoyaimaeeyeaknaeeiiaaiaeeyyaemaeeiiaaiaeeoba4maee4ba8maeeoba4maee4camnaeeyeaknaeeoba4maee4ba8maeeoba4maeeyeaknaeeyba0maee4ba8maeeydaunaee4camnaeeiiaaiaeeidaqnaeeocainaeeyyaemaeeoba4maee4camnaeeyaakmaeeidaqnaeeyaakmaee4ba8maeeoba4maeeiiaaiaeeiiaacaaagccagl7baajuggbiabbccagagcbaqclbyacqqggaaicqqggaaicqqggaaicqqggaaicqqggaaicqqggaaicqqggaaicqqggaaicqqggaaicqqg3bwdcqqgobaacqqglbqzcqqgybgccqqglbqzkmaaceaajuggbqaabeqcaauaakqzaggae83sdcmcdawgaaqcbauaakqzaggaemyaakmaemoaaogajeaqbeaakiabbccagkqzaggaeeypa0jaeeiiaaiaeeymaejaeeilawiaeeiiaaiaeeyaakmaeeozaymaeeiiaaiaemyaakmaeeiiaaiaeeyyaemaeeoba4maeeizaqmaeeiiaaiaemoaaomaeeiiaaiaeeiaagmaeeyyaemaeeodaynaeeyzaumaeeiiaaiaeeidaqnaeeiaagmaeeyzaumaeeiiaaiaee4camnaeeyyaemaeeyba0maeeyzaumaeeiiaaiaeeicaanaeeiaagmaeeyeaknaee4camnaeeyaakmaee4ba8maee4yammaeeiaagmaeeyzaumaeeyba0maeeyaakmaee4yammaeeyyaemaeeibawmaeeiiaaiaeeicaanaeeocainaee4ba8maeeicaanaeeyzaumaeeocainaeeidaqnaeeyeakhajaaqbaqclbyacqwfzowzkmaabaaaleaajuggbiabdmgapjabdqgaqbwcbeaakiabbccagkqzaggaeeypa0jaeeiiaaiae83sdcmaeeilawiaeeiiaaiaeeyaakmaeeozaymaeeiiaaiaemyaakmaeeiiaaiaeeyyaemaeeoba4maeeizaqmaeeiiaaiaemoaaomaeeiiaaiaeeiaagmaeeyyaemaeeodaynaeeyzaumaeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeiiaaiaeeicaanaeeiaagmaeeyeaknaee4camnaeeyaakmaee4ba8maee4yammaeeiaagmaeeyzaumaeeyba0maeeyaakmaee4yammaeeyyaemaeeibawmaeeiiaaiaeeicaanaeeocainaee4ba8maeeicaanaeeyzaumaeeocainaeeidaqnaeeyaakmaeeyzaumaee4camhaakaaajaawuhaakqzaggaeeiiaacaaoqaakqzaggaaczcaiaaxmaakmaabmaabaqclbyacqqgyagmaogaayjkaiaawmcaaaaaaaa@ea61@

in both models qij equals  <dig> if codon i and j differ in more than one position, and qii=−∑j≠iqij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbqcdawgaawcbagaemyaakmaemyaakgabeaakiabg2da9iabgkhitmaaqababagaemycae3aasbaasqaaiabdmgapjabdqgaqbqabaaabagaemoaaomaeyiyikraemyaakgabeqdcqghris5aaaa@3d9c@. the parameter κ is the transition/transversion rate ratio and codon bias is accounted for by incorporating the stationary distribution of codon j. notice that ω no longer can be interpreted directly as the nonsynonymous/synonymous  rate ratio, because this ratio also depends on γ.

although it is a gross simplification of the underlying biology to assume that amino acid mutations can be divided into two categories , models based on this simplification provide considerable computational efficiency while allowing the effect of various physicochemical properties to be explored. the original models by  <cit> , and the models by  <cit>  allow a more complex relationship between rate of substitution and physicochemical properties of the amino acids; they do not, however, simultaneously allow for site-specific variation of these properties in the way the models we propose do.

models a and b are similar in that the new parameter γ appears as a product in the rate of codon substitution when the two codons encode for amino acids of different physicochemical properties. in model a, γ measures the increase/decrease in the rate of nonsynonymous substitution between codons of different properties compared to the synonymous substitution rate. in this model, ω is the nonsynonymous to synonymous substitution rate ratio of codons encoding amino acids with similar physicochemical properties. it is worth noting that when ω = γ in model a, it is reduced to the original goldman and yang  <dig> model  <cit> . in model b, however, ω accounts for the background nonsynonymous codon substitution rate and hence γ is the nonsynonymous substitutions rate between codons encoding for different physicochemical properties compared to the rate of other nonsynonymous substitutions. once again, model b reduces to the goldman and yang  <dig> model  <cit>  when γ =  <dig> 

the two models can be used to address different biological questions. for instance, we can test the hypothesis that the nonsynonymous to synonymous rate ratio between codons encoding for amino acids with different properties is greater than  <dig>  with model a . on the other hand, model b can be used to determine if there is an elevated rate of substitution between codons encoding different physicochemical properties compared to the rate of generic nonsynonymous mutations . since our main interest here is to look for positive selection in the more conventional sense , we will analyze simulated and real data sets with model a.

we will construct models that allow site-specific variation by assuming that ω and γ can each have two rate classes: ω <dig> =  <dig>  ω1> <dig> and γ <dig> =  <dig>  γ <dig> > <dig> and therefore, there are  <dig> possible site classes to which each codon site can belong.

{  :ω0≤ <dig> γ0≤1 :ω0≤ <dig> γ1>1:ω1> <dig> γ0≤1:ω1> <dig> γ1>1     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagabaqaauaabeqaeeaaaaqaceaafrvaeeikagiaeeyaakmaeeykakiaeeiiaaiaeeiiaaiaeiooaodccigae8xydc3aasbaasqaaiabicdawaqabagccqghkjyocqaixaqmcqggsaalcqwfzowzdawgaawcbagaegimaadabeaakiabgsmijkabigdaxaqaaiabbicaoiabbmgapjabbmgapjabbmcapiabbccagiabcqda6iab=l8a3naabaaaleaacqaiwaamaeqaaogaeyizimqaegymaejaeiilawiae83sdc2aasbaasqaaiabigdaxaqabagccqgh+agpcqaixaqmaegaeawp7dws7dwv7dw=+labbicaoiabbmgapjabbmgapjabbmgapjabbmcapiabcqda6iab=l8a3naabaaaleaacqaixaqmaeqaaogaeyopa4jaegymaejaeiilawiae83sdc2aasbaasqaaiabicdawaqabagccqghkjyocqaixaqmaeaacqqgoaakcqqgpbqacqqg2bgdcqqgpaqkcqgg6agocqwfjpwddawgaawcbagaegymaedabeaakiabg6da+iabigdaxiabcycasiab=n7annaabaaaleaacqaixaqmaeqaaogaeyopa4jaegymaedaaagaay5eaagaaczcaiaaxmaadaqadaqaaiabiodazagaayjkaiaawmcaaaaa@7e00@

mixture models can then be constructed by allowing each codon site to be in each of these classes with a certain probability, that can be estimated from the data. likelihood ratio tests  can be constructed by comparing models with only a few site classes to models with more site classes. for example, we can test whether selection favors substitution that alter the specified physicochemical properties with the null mixture model a with only two site classes, namely  and   against the alternative mixture model a that allows for all four site classes. we refer to these models as model a <dig> and a <dig>  respectively . various likelihood ratio tests can also be constructed. for instance, we can obtain evidence for the presence of a significant number of sites in site class  ,  and  against the full model).

notice that model a <dig> allows positive selection both on the particular physicochemical property of interest  as well as on all other nonsynonymous substitutions that do not alter the physicochemical property of the encoded amino acids . in contrast, model a <dig> does not allow positive selection with respect to the physicochemical property of interest . we can set up a likelihood ratio test by comparing twice the log likelihood difference between model a <dig> and model a <dig> to a χ32
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfhpwydaqhaawcbaacbagae43mamdabagae4nmaidaaaaa@3072@-distribution. here we ask the question if there are some sites with γ> <dig>  i.e. whether there is a significant amount of positive selection acting on the physicochemical property of interest.

we make the standard assumptions of the codon-based likelihood framework ;  we assume the true topology of the tree is known and  each codon site in the sequence is independent of the others. then we calculate the log likelihood of the data given the topology of the tree and the model by summing up the log-likelihood of each site. the likelihood is optimized by the bfgs algorithm in numerical recipes in c  <cit> . after the maximum likelihood estimates  are obtained, we use the empirical bayes approach  <cit>  to assign sites to site classes. the source code of the c program which implements both of the models  has been deposited to sourceforge.net  <cit>  and is licensed under the gpl  <cit> .

data analysis
in order to investigate the performance of the model we analyze both simulated and real data sets. the simulated data sets were generated using a modified version of evolver in the paml  <dig> d package  <cit> . the parameters used for simulation were ω =  <dig>  and γ =  <dig> for data set  <dig>  ω =  <dig> and γ =  <dig> for data set  <dig>  ω = γ =  <dig>  for data set  <dig> and ω = γ =  <dig> for data set  <dig>  the transition/transversion ratio κ was set to  <dig> for all data sets. we used the volume partition for all four simulated data sets, by dividing amino acids into  <dig> groups: large volume , and small volume . a  <dig> taxa tree was used . we analyzed the data with both volume and hydrophobicity partitions under both models a <dig> and a <dig> using the previously described methods, and obtained maximum likelihood estimates of the branch lengths of the tree, ω <dig>  ω <dig>  γ <dig>  γ <dig>  κ, the proportions of each category, and the posterior probabilities of each site belonging to each site class. the results are summarized in table  <dig> 

we re-analyzed the mhc class i data set from  <cit>   with model a.  <cit>  found numerous positively selected sites and showed that most of them are antigen recognition sites . the same data set was also used in  <cit> , to examine if the new method identifies the same sites as the original method. we also analyzed the abalone sperm lysin data from  <cit> , with regard to the hydrophobicity, volume, polarity and charge physicochemical properties. we specified each of the four physicochemical properties: volume, hydrophobicity, charge, and polarity partitions with both model a <dig> and a <dig> in these analyses.

simulated data
the result of the simulation analysis is summarized in table  <dig> and figure  <dig>  when the correct partition was used, both the lrt and the posterior bayesian categorization were very accurate. when simulated data set  <dig>  was analyzed using the volume partition  and there was positive selection acting only on codon substitutions that altered the volume of the encoded amino acids, 99% of the sites were correctly identified as being in the ω≤ <dig>  γ> <dig> category. moreover, the lrts performed between model a <dig> versus model a <dig> on the  <dig> replicates were all significant. when the data was simulated with ω> <dig> and γ< <dig> , 97% of the sites were classified in the correct site class, and none of the lrts between models a <dig> and a <dig> were significant, as expected.

amino acids that differ in volume may also differ in other physicochemical properties. positive selection on another physicochemical property may then be inferred, even though selection may have truly targeted volume. to illustrate this concept and better understand its effect, we repeated the data analysis with other physicochemical properties. we partitioned the amino acids into those with high  and low  hydrophobicity. in each replicate, data was simulated assuming selection only targeted volume, but was analyzed under the hydrophobicity partition. in this case the resulting lrts were all significant for both data set  <dig> and data set  <dig> . the results were significant for data set  <dig> when the hydrophobicity physicochemical property was used due to some volume altering codon changes that are hydrophobicity altering as well . likewise, since there are some volume conserving nonsynonymous codon changes that are hydrophobicity altering , the lrts were significant for data set  <dig> as well. thus, the extent of overlap between two sets of distinct amino acid pairs, where each set contains pairs that differ with respect to one of the two given physicochemical properties, ultimately determines our ability to distinguish between the two properties, in terms of being exclusively targeted by positive selection. nonetheless, our method can reliably identify the true physicochemical property in addition to other properties that have considerable overlap with the true property.

data sets  <dig> and  <dig> were simulated with ω = γ, in which case our model reduces to the original goldman and yang  <dig> model  <cit> . our method classified = 99% of the sites correctly with respect to both volume and hydrophobicity partitions for both data set  <dig>  and data set  <dig> .

the mhc class  <dig> dataset
however, when we looked at the sites that were identified in the previous study  <cit>  with high posterior probabilities of being positively selected with respect to a particular physicochemical property; we found that some of these sites were positively selected regardless of the physicochemical property of the amino acids they code for . for instance, almost all the posterior probability mass of the  <dig> sites that were identified for positive selection with respect to the volume partition  were more likely to be in the categories with ω>1; and the posterior probabilities of being in the  category were almost  <dig>  the same was observed for the polarity partition. nevertheless, the posterior probabilities of being in the  category were relatively high at sites  <dig>  and  <dig> , although they were still more likely to be in the  category. the main reason for this discrepancy between our study and that of  <cit>  is due to the manner in which physicochemical selection is defined and measured.  <cit>  defined the parameter gamma to be the rate of nonsynonymous substitutions that alter the property of the encoded amino acids and scale it relative to the rate of all other codon substitutions pooled together, i.e. both synonymous substitutions and property-conserving nonsynonymous substitutions. however, we extended their model to allow for a separation of the pooled scaling rate into rates of nonsynonymous property-conserving substitutions and synonymous substitutions. this naturally implies that our parameter gamma is not equivalent to their gamma even if the underlying physicochemical property is the same. however, our parameterization is biologically more realistic since it allows a more sensible scaling with respect to the synonymous substitution rate.

the abalone sperm lysin dataset
the results of the analysis of the abalone sperm lysin data, when amino acids are categorized according to hydrophobicity, volume, polarity and charge are shown in table  <dig> 

1) the charge partition
our method identified sites belonging to all  <dig> classes with high posterior probabilities. we compared with the results obtained by  <cit>   using the paml software  <cit> . we found that all sites in the  site class were also classified as positively selected sites  by  <cit>  using model m <dig> of the standard framework. on the other hand, none of the sites in the ω< <dig> site classes  were classified as positively selected in their study. thus, our results identified additional categories of putatively positively selected sites in which selection seems to have favored substitutions that alter specific physiochemical properties of the amino acids.

2) the volume partition
there are a number of sites that are targeted for positive selection with respect to the volume property , however none of the positively selected sites are conserved under this partition. this may indicates that volume is an important property targeted by positive selection. it is worth mentioning that most of the sites in the  site class are adjacent in the 3d structure to a positively selected site previously identified by  <cit> . for instance, sites  <dig>   <dig>   <dig>   <dig> are adjacent to sites  <dig>   <dig>   <dig>   <dig> , and site  <dig> is adjacent to  <dig>  it is possible that, as  <cit>  pointed out earlier on the basis of the vast site-directed mutagenetic literature, substitutions involving volume change of the residues may slightly change the structure of the peptide which in turns improves the ability to incorporate new mutations.

discussion
a major limitation of the current approach is that the correct partition cannot be directly inferred from the data. the method cannot statistically identify which amino acid property is being targeted by positive selection without input from the user, however, the program can be used to explore pre-defined hypotheses regarding positive  selection. our simulation study showed that when the correct partition has been specified, the method can accurately detect positive selection acting on the associated amino acid property.

we note that the similarities between amino acids are probably better described by continuous functions. much work has been done on continuous models  in the context of codon-based likelihood models. however, in the framework of mixture models that allow variation across sites, these approaches are not computationally tractable and require a discrete approximation over many categories in multiple dimensions. our new method provides more information than previous methods and yet maintains computational efficiency.

we also want to note that the regularity conditions for the χ <dig> approximation are not satisfied with the lrt between a <dig> and a <dig>  this is because when either of the parameters p <dig> or p <dig> hit the boundary of the parameter space , either ω <dig> or both ω <dig> and γ <dig> is non-identifiable.

it is worth mentioning that a significant lrt does not necessarily imply that there is positive selection acting solely on the physicochemical property defining the partition examined. since the amino acids that differ with respect to physicochemical property may also differ with respect to other properties, it is not possible with the current method to exclude that selection has been targeting other properties over the one specified by the user.

positive selection inferred by the new method informs the user that there are more substitutions between amino acid in the chosen partition than expected under neutral evolution. a clear advantage of our method over methods that do not take physicochemical properties into account is that it can detect positive selection when selection is only acting on some particular subset of nonsynonymous substitutions, while conserving others. thus, positive and negative selection acting on the same protein residue can be inferred simultaneously for any specified physicochemical property in a site-specific manner.

this method can also be used to examine the pattern of negative selection in proteins that may not be under positive selection. in many cases, it would be interesting to explore which residues are conserved predominantly with respect to a particular physicochemical property. site specific models of physicochemical selection provide a more statistically rigorous framework for finding sites that are under selection than method that are based on calculating amino acid content in particular sites without taking the underlying phylogenetic tree into account.

CONCLUSIONS
we see this new method as a step forward in incorporating information regarding physicochemical properties into studies of positive selection, as well as a step towards methods that allow identification of selection acting on particular amino acid properties, without any prior specification by the user of which properties to examine. models that allow site-specific selection on different amino acid properties will be an important tool in studies of molecular evolution and should help bridge the gap between structural biology and molecular evolution.

availability and requirements
project name: evoradical

project website: 

operating system: tested on linux and mac os x.

programming language: ansi c

license: gpl

non-academic licensing: none

authors' contributions
wsww wrote the program evoradical, performed the analysis, drafted and finalized the manuscript. rn supervised the project and rn and rs contributed to the modeling and writing of the manuscript. all authors have read and approved the manuscript.

