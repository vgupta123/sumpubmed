BACKGROUND
with the increase in volume of gene expression data available from high throughput microarray experiments, much research interest has been directed at building mathematical models of the process of gene regulation. such models have primarily been used for the so called reverse engineering of regulatory networks: inferring possible regulatory interactions and modules directly from microarray data, see for example  <cit> . all of these techniques make the implicit assumption that the expression of the transcription factor  gene can be used as a proxy for the true transcription factor activity – the concentration of the protein in a form that is able to bind and induce/repress transcription. whilst for some tf-gene pairs, this is likely to be a reasonable assumption, there are many examples of regulatory interactions where this is not the case due to post-transcriptional and post-translational modifications of the tf and the combinatorial effects of multiple tfs regulating a particular gene. for example, in a recent study, newman et al  <cit>  monitored protein levels in yeast at single-cell resolution by using novel high-throughput technology . these authors examined how protein and mrna changes are related, in order to identify potential examples of post-transcriptional regulation. their study identified a significant number of cases  where protein changes are not mirrored by mrna changes.  <cit>  independently verified some of these examples of post-transcriptional regulation by other quantitative techniques, such as western blotting and quantitative polymerase chain reaction. clearly, these proteins are regulated post-transcriptionally and their changes cannot be captured on microarrays.

an example that we will use later in this paper is the tf sep from s. pompbe . the sep tf regulates  <dig> targets, all of which are periodically expressed over the course of the cell cycle  <cit> . however, the expression of sep itself is not periodically expressed as can be seen in figure  <dig> 

to overcome the problem of the lack of correlation between the tf gene and target genes, several approaches recently proposed treat the true transcription factor activities  as latent variables that are inferred from observed expression data of their gene-targets  <cit> . such techniques require some prior knowledge of the network topology and are thus rather different from approaches that attempt to infer regulatory networks from microarray data alone. in applications where no topology information is available this would be a disadvantage. however, in the majority of cases some topology has been elucidated via techniques such as gene knockouts and chromatin immunoprecipitation  assays. moreover, in-vitro measurements of the levels of tfs and the rate-constants of their binding and disassociation to the promoter regions of their target genes is very difficult suggesting that inferring such quantities from the more easily obtainable expression data is a realistic and principled way forward. in this paper, we extend a recent approach for tfa inference based on a plausible, non-linear model of transcription, from a frequentist to a bayesian framework and show the benefits of full bayesian inference in this area with examples from both synthetic data  and real microarray data.

approach
to date, several approaches have been proposed to infer tfa from expression data, the majority of which have concentrated on linear models of target-gene transcription. for example,  <cit>  use a linear model based on the technique of partial least squares  to infer tfa using regulatory topology given by chromatin immunoprecipitation  data. a similar, probabilistic model has also recently been proposed by  <cit> . as well as inferring the tfa, these models have the added benefit that to some extent they can de-noise the chip data by removing some of the false positives. a similar method  was previously proposed  <cit> . here the authors decompose the expression matrix into a set of tfas and weights where the decomposition is constrained to satisfy known topology. the linear assumptions simplify inference and make the algorithms useful for modeling very large data-sets. however, there are two main drawbacks to such an approach. firstly, a realistic model of transcription should relate the rate of production of mrna  to the tfa. secondly, the linear model of transcription cannot encapsulate the known non-linear effects present in transcription, particularly saturation, where the rate of mrna production reaches a natural limit due to physical constraints.

an alternative to these genome-wide approaches is to take a small subnetwork and create a more detailed, mechanistic model. such an approach is adopted in some recent work where the transcriptional model is described using ordinary differential equations . firstly,  <cit>  uses a linear ode to define the transcriptional model for several genes that are potential targets for p <dig> 

μ˙
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgagaaaaa@2e72@g = αg + βgη - δgμg,     

where μg is the expression of gene g at time t, μ˙
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgagaaaaa@2e72@g denotes the rate of change of μg at time t and η is the tfa. each gene is characterised by its own set of  <dig> kinetic parameters  and bayesian inference is performed via markov-chain monte-carlo. the three parameters all have biological interpretations; αg corresponds to a basal level of production, βg is sometimes referred to as the sensitivity and can be thought of as the level to which the production term for gene g is sensitive to the tfa and δgμg corresponds to linear mrna decay. additionally, the explicit dependence on time means that the model can rigorously handle experimental readings taken at variable spacings as is often the case. the model is elegantly enhanced in  <cit> , where it is shown that if a gaussian process  prior is placed on the tfa profile, it is possible to circumvent the need for expensive sampling-based inference and a tfa profile can be inferred over all time, rather than just at the discrete time-points at which expression was measured. these models are still limited by their linearity and the fact that they cannot properly handle repression – allowing β to become negative is not satisfactory as it suggests that the tf is decreasing the level of mrna directly rather than reducing the level of production . in  <cit> , the authors use a more realistic model of transcription based on the michaelis-menten  kinetic equation, given as

activationμ˙g=αg+βgηη+γg−δgμgrepressionμ˙g=αg+βg1η+γg−δgμg.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabegacaaabaacbagae8xqaekae83yammae8hdaqnae8xaakmae8ndaynae8xyaemae8hdaqnae8xaakmae83ba8mae8nba4gabaaccigaf4hvd0mbaiaadawgaawcbagaem4zacgabeaakiabcicaoiabdsha0jabcmcapiabg2da9iab+f7ahnaabaaaleaacqwgnbwzaeqaaogaey4kasiae4nsdi2aasbaasqaaiabdeganbqabagcdawcaaqaaiab+d7aojabcicaoiabdsha0jabcmcapaqaaiab+d7aojabcicaoiabdsha0jabcmcapiabgucariab+n7annaabaaaleaacqwgnbwzaeqaaaaakiabgkhitiab+r7aknaabaaaleaacqwgnbwzaeqaaogae4hvd02aasbaasqaaiabdeganbqabagccqggoaakcqwg0badcqggpaqkaeaacqwfsbgucqwflbqzcqwfwbaccqwfybgccqwflbqzcqwfzbwccqwfzbwccqwfpbqacqwfvbwbcqwfubgbaeaacugf8oqbgagaamaabaaaleaacqwgnbwzaeqaaogaeiikagiaemidaqnaeiykakiaeyypa0jae4xsde2aasbaasqaaiabdeganbqabagccqghrawkcqgfyogydawgaawcbagaem4zacgabeaakmaalaaabagaegymaedabagae43tdgmaeiikagiaemidaqnaeiykakiaey4kasiae43sdc2aasbaasqaaiabdeganbqabaaaaogaeyoei0iae4htdq2aasbaasqaaiabdeganbqabagccqgf8oqbdawgaawcbagaem4zacgabeaakiabcicaoiabdsha0jabcmcapiabc6cauaaacawljagaaczcamaabmaabagaegomaidacagloagaayzkaaaaaa@960b@

inference in  <cit>  is performed via maximising the likelihood of the observed expression data under a log-normal noise model. whilst the results presented look promising, there are several drawbacks in the maximum likelihood approach that are particularly acute in this application. in practice, due to the non-standard form of the model, maximising the likelihood is far from trivial. a conjugate gradient scheme is used, with multiple starting points. however, the need to calculate gradients with respect to all of the parameters being inferred imposes some constraints on the model. for example, the authors were forced to have gene-specific noise parameters, when one per dataset or replicate might be more sensible. such constraints also severely limit the ways in which the model can be extended.

in this paper, we will show how fully bayesian inference in the model of  <cit>  can be performed more effectively for the following reasons. firstly, as alluded to above, in this application it is far more straightforward to implement and much easier to extend. secondly, it provides a principled method for the incorporation of prior biological knowledge. this may be in the form of suitable ranges for kinetic parameters, known kinetic parameter values, suitable distributions on measurement noise or known initial tfa concentrations. thirdly, posterior distributions provide confidence in predictions – something that is particularly important when small amounts of data are available. finally, the bayesian approach could facilitate better experimental design. a good expression dataset could be considered to be one that provides the most information – a quantity that could be measured via the kl-divergence between the posterior and the prior. in addition, we will show how the model can be extended within bayesian framework by incorporating gene and replicate specific delays.

methods
the model of  <cit>  is summarised in the cartoon of figure  <dig>  the cartoon depicts the class of small regulatory subnetwork that we will be interested in here, known as a single input motif   <cit> . a sim consists of one transcription factor regulating a set of g =  <dig> ..g target genes. as given in equation  <dig>  the time derivative of the expression for a particular gene g, at time t is made up of three separate terms. a basal level of production , a production term  and a linear decay term . for notational convenience, we define θg = {αg, βg, γg, δg}. the general solution of equation  <dig> for the case of activation is

μg=e−δgt+αgδg+β∫0te−δηγg+ηdτ.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf8oqbdawgaawcbagaem4zacgabeaakiabcicaoiabdsha0jabcmcapiabg2da9iabcicaoiab=x7atnaabaaaleaacqwgnbwzcqaiwaamaeqaaogaeyoei0yaasaaaeaacqwfxoqydawgaawcbagaem4zacgabeaaaoqaaiab=r7aknaabaaaleaacqwgnbwzaeqaaaaakiabcmcapiabdwgalnaacaaaleqabagaeyoei0iae8htdq2aasbaawqaaiabdeganbqabawccqwg0badaagccqghrawkdawcaaqaaiab=f7ahnaabaaaleaacqwgnbwzaeqaaagcbagae8htdq2aasbaasqaaiabdeganbqabaaaaogaey4kasiae8nsdi2aa8qmaeaacqwglbqzdaahaawcbeqaaiabgkhitiab=r7akjabcicaoiabdsha0jabgkhitiab=r8a0jabcmcapaaaaeaacqaiwaamaeaacqwg0bada0gaey4kiipakmaalaaabagae83tdgmaeiikagiaemidaqnaeiykakcabagae83sdc2aasbaasqaaiabdeganbqabagccqghrawkcqwf3oaacqggoaakcqwg0badcqggpaqkaagaemizaqmae8hxdqnaeiola4iaaczcaiaaxmaadaqadaqaaiabiodazagaayjkaiaawmcaaaaa@75f8@

however, the expression data is observed at only a finite set of discrete timepoints, {t <dig> ...,ti,...,tt} and so, to simplify computation and limit the number of free parameters, we make the assumption that between these time points, the tfa is constant. hence, our inferred tfa profile will be piecewise constant.

to this end, we define η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@j as the constant value of tfa between tj and tj+ <dig>  with the piecewise assumption, the integral in equation  <dig> becomes a summation over the discrete timepoints and, defining μgi as the expression of gene g at discrete time-point ti,

μgi=e−δti+αgδg+βge−δgti1δg∑j=0i−1η¯jη¯j+γg,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaegadaaabaaccigae8hvd02aasbaasqaaiabdeganjabdmgapbqabaaakeaacqgh9aqpaeaacqggoaakcqwf8oqbdawgaawcbagaem4zacmaegimaadabeaakiabgkhitmaalaaabagae8xsde2aasbaasqaaiabdeganbqabaaakeaacqwf0oazdawgaawcbagaem4zacgabeaaaagccqggpaqkcqwglbqzdaahaawcbeqaaiabgkhitiab=r7akjabdsha0naabaaameaacqwgpbqaaeqaaaaakiabgucarmaalaaabagae8xsde2aasbaasqaaiabdeganbqabaaakeaacqwf0oazdawgaawcbagaem4zacgabeaaaaaakeaaaeaacqghrawkaeaacqwfyogydawgaawcbagaem4zacgabeaakiabdwgalnaacaaaleqabagaeyoei0iae8htdq2aasbaawqaaiabdeganbqabawccqwg0baddawgaaadbagaemyaakgabeaaaagcdawcaaqaaiabigdaxaqaaiab=r7aknaabaaaleaacqwgnbwzaeqaaaaakmaaqahabagaeiikagiaemyzau2aawbaasqabeaacqwf0oazdawgaaadbagaem4zacgabeaaliabdsha0naabaaameaacqwgqbgacqghrawkcqaixaqmaeqaaaaakiabgkhitiaaykw7asqaaiabdqgaqjabg2da9iabicdawaqaaiabdmgapjabgkhitiabigdaxaqdcqghris5aogaemyzau2aawbaasqabeaacqwf0oazdawgaaadbagaem4zacgabeaaliabdsha0naabaaameaacqwgqbgaaeqaaaaakiabcmcapmaalaaabagaf83tdgmbaebadawgaawcbagaemoaaogabeaaaoqaaiqb=d7aozaarawaasbaasqaaiabdqgaqbqabagccqghrawkcqwfzowzdawgaawcbagaem4zacgabeaaaagccqggsaalaagaaczcaiaaxmaadaqadaqaaiabisda0agaayjkaiaawmcaaaaa@8c66@

where μg <dig> is the initial expression of gene g and will be treated as another parameter to be inferred. we must now define a noise model that will relate the predicted profiles  to the observed expression data. following  <cit> , we assume that the observed expression data  is log-normally distributed. the variation of variance with magnitude is a property of the log-normal distribution that is particularly desirable here. the distribution is parameterised by a location parameter m and a scale parameter σ <dig>  equating the predicted expression value from the model for gene g at time ti  with the expected value of the log-normal distribution gives mgi = log μgi - 12
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaaiabikdayaaaaaa@2e9e@σ <dig>  assuming a-priori independence across genes, time and experimental replicates, and denoting by xgir the observed expression of gene g at time ti in replicate r , the likelihood of the complete expression dataset x follows as

p=∏i=0t∏r=1r∏g=1g12πσxgirexp⁡{−22σ2},     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqggoaakieqacqwfybawcqgg8bafiiwacqgf4oqccqggsaalcqgf3oaacqggsaaliigacqqfdpwcdaahaawcbeqaaiabikdayaaakiabcmcapiabg2da9maarahabawaaebcaeaadaqewbqaamaalaaabagaegymaedabawaaoaaaeaacqaiyagmcqqfapacasqabagccqqfdpwccqwg4baedawgaawcbagaem4zacmaemyaakmaemocaihabeaaaaaabagaem4zacmaeyypa0jaegymaedabagaem4raceaniabg+givdgccygglbqzcqgg4baecqggwbacdagadaqaaiabgkhitmaalaaabagaeiikagiagiibawmaei4ba8maei4zacmaemieag3aasbaasqaaiabdeganjabdmgapjabdkhaybqabagccqghsislcqwgtbqbdawgaawcbagaem4zacmaemyaakgabeaakiabcmcapmaacaaaleqabagaegomaidaaagcbagaegomaijae03wdm3aawbaasqabeaacqaiyagmaaaaaagccagl7bgaayzfaagaeiilawiaaczcaiaaxmaadaqadaqaaiabiwda1agaayjkaiaawmcaaawcbagaemocainaeyypa0jaegymaedabagaemouaifaniabg+givdaaleaacqwgpbqacqgh9aqpcqaiwaamaeaacqwgubava0gaey4diunaaaa@7cd0@

where we have added μg <dig> to the set of parameters θg for each gene and defined θ = {θ <dig> ...,θg} and η = {η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ <dig> ...,η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@t-1}. the scale parameter of the log-normal distribution, denoted σ <dig> is treated as an additional model parameter to be inferred. note that unlike in  <cit> , we are free to use one noise parameter for the whole dataset or index it with genes or replicates as desired.

to ensure all of the kinetic parameters remain positive, we will take the standard step of sampling in their log space, and place uniform priors  over their values to encapsulate our lack of prior information. additionally, we place a uniform prior  on η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ and a gamma prior on σ <dig> . finally, inspection of equation  <dig> shows that there is a coupling between η and γg. in the synthetic experiments, we are interested in comparing inferred parameter values with the known values and so we overcome this problem by fixing η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ <dig> to the true value. in experiments with real data, the problem of arbitrary re-scaling is effectively side-stepped by the restrictions imposed on η through its uniform prior.

using Δ to denote the set of hyper-parameters used to define the various priors, the full posterior over θ, η and σ <dig> is given by

p=pp∫ppdθdηdσ <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqggoaakiiwacqwf3oaacqggsaalcqwf4oqccqggsaaliigacqgfdpwcdaahaawcbeqaaiabikdayaaakiabcyha8hqabiab9hfayjabcycasggabiab8r5aejabcmcapiabg2da9maalaaabagaemicaanaeiikagiae0hwaglaeiifawnae8hudenaeiilawiae83tdgmaeiilawiae43wdm3aawbaasqabeaacqaiyagmaagccqggpaqkcqwgwbaccqggoaakcqwf4oqccqggsaalcqwf3oaacqggsaalcqgfdpwcdaahaawcbeqaaiabikdayaaakiabcyha8jab8r5aejabcmcapaqaamaapeaabagaemicaanaeiikagiae0hwaglaeiifawnae8hudenaeiilawiae83tdgmaeiilawiae43wdm3aawbaasqabeaacqaiyagmaagccqggpaqkcqwgwbaccqggoaakcqwf4oqccqggsaalcqwf3oaacqggsaalcqgfdpwcdaahaawcbeqaaiabikdayaaakiabcyha8jab8r5aejabcmcapiabdsgakjab=h7axjabdsgakjab=d7aojabdsgakjab+n8aznaacaaaleqabagaegomaidaaaqabeqaniabguiiydaaaogaeiola4iaaczcaiaaxmaadaqadaqaaiabiada2agaayjkaiaawmcaaaaa@8649@

to obtain samples from this posterior, we use the well-known metropolis algorithm . for each of our parameters, we use a gaussian proposal distribution. an initial number of samples is used to estimate the variance of the proposal distribution. this is then tuned during the burn-in period to try and achieve an efficient acceptance rate between 20–40% as suggested in  <cit> . convergence is assessed by running  <dig> separate chains and monitoring the within and between chain variance of each parameter . the sampler is assumed to have converged when the value of r^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgsbgugaqcaaaa@2de9@  for every parameter is below  <dig> .

RESULTS
synthetic data example
consider a sim consisting of  <dig> target genes all activated by the same tf. using the true η profile shown in figure 3a, three expression data-sets were synthesised according to mm kinetics  with σ <dig> =  <dig>  and three replicates. from figure 3a, it is clear that the inferred mean η profile closely corresponds to the true profile from which the data was produced. figure 3b shows the  <dig> replicates generated for one particular gene as well as the mean and percentiles of μ and the inferred density over σ <dig> is highly concentrated about the true value and shown in figure 3c. figures 3d to 3g show samples from the posteriors for the four kinetic parameters over the ten genes as box plots. we notice that in the majority of the genes, the posteriors for β, γ and δ are concentrated around the true values. the distributions for α however, are rather less convincing but given the scale of α relative to the other parameters , the deviations from the true values are relatively insignificant. two genes, numbers  <dig> and  <dig>  seem to have posterior β and γ distributions that have only very low mass at the true values. examining the posterior samples for β and γ for gene  <dig> shown in figure 4a, it is clear that the two parameters are dependent and the ratio of β to γ at the mode is very close to the ratio at the true value. the fit to the expression data is also very good . the ability to visualise the posteriors in this way is a clear advantage over the maximum likelihood framework where obtaining asymptotic approximations of the covariance from second derivatives of the likelihood is not at all straightforward and are also likely to be inaccurate with small amounts of data. the inferred μ profile for gene  <dig> on the other hand does not fit the observed expression data well  due to the large relative magnitude of the noise in the observations and in this case it is unsurprising that the inference is cautious – indicated by the width of the posteriors. despite these data problems, the inferred tfa profile in which we are ultimately interested is very close to the true profile.

fission yeast cell cycle data
the reconstruction approach is now applied to the cell-cycle microarray data of s. pombe or fission yeast  <cit> . this dataset contains two time-course experiments obtained using different cell-cycle synchronization methods. one method is centrifugal elutriation, which generates a homogeneous population of small cells early in their cell cycle. there are  <dig> independent biological replicates available, each contains  <dig> time-points, taken every  <dig> minutes and it is this data that we will use here. elsewhere  <cit> , we have shown how the mm framework can be extended to combine the data from elutration synchronisation with the data from the alternative synchronisation which has samples at different time points.

 <cit>  study three transcription factors that are involved in regulating three different groups of genes in the fission yeast cell-cycle  and we will restrict ourselves to one sim, regulated by a transcription factor complex, known to involve sep. the  <dig> targets are taken from experiments of rustici et al  . in addition, gene ace <dig>  which codes for ace2p, is known to be the target of sep1p  <cit> . it is included in the sim as another target. imputing of the missing values in the data has been done using impute.missing() function from smida  <cit> .

in a few cases, where more than 50% missing values for a particular gene replicate, those were substituted by the means of the remaining ones. additionally, there are rare cases where the complete data for a gene in one replicate is missing. in these cases, we replaced the data for the missing replicate with data from one of the other replicates . figure 5a shows the results of performing inference on this data. the inferred tfa profile can be seen in figure 5a. we can see from the percentiles that the profile is reasonably well defined. in figure 5b we can see the expression data for one particular gene along with the mean and 5th and 95th percentiles of μ defined by the model . finally, figure 5c shows the posterior for σ <dig>  note that the level of noise used to sample data in the previous section is similar to that found in this real data.

as one might expect, the tfa is periodic with two clear cycles. interestingly, in the second cycle, the tfa seems to rise much more slowly than it drops. such information may help to unravel the cause of the very low correlation between the sep gene and its targets. by way of comparison, in figure 5b we have also shown the inferred μ profile for the same gene when the tfa is fixed at the expression of the sep gene . it is clear that with the tfa fixed at the expression of sep, the model is unable to explain the observed data. if the model could explain the observed data, it might suggest that the mm model is too flexible. it also provides evidence to suggest that there are indeed unobservable modifications of sep and perhaps additional regulators in the complex.

incorporating delays
one major advantage of the fully bayesian framework in this application is that it is straightforward to extend the model. one example is the integration of different data-sets that we have presented elsewhere  <cit> . another example of this is the incorporation of time delays that inevitably occur between tf binding to the promoter and gene transcription. although the various genes are all regulated by the same tf, it is clear from the data that some react quicker than others, possibly due to different promoter binding efficiencies or faster transcription rates. due to the piecewise constant assumption on the tfa profile, we calculate effective η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ values as linear combinations of consecutive η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ values. denoting by τg the delay for gene g, a delay of  <dig>  time steps suggests that the effective tfa  should be  <dig> η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@i +  <dig> η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@i- <dig>  we must now also define the value of η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ before t =  <dig>  in the absence of any further information, we assume that η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@i = η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ <dig>  ∀i <  <dig>  in addition to gene specific delays, inspection of the expression data also suggests that there are replicate dependent shifts too, most likely due to the imperfect nature of the cell synchronisation procedure. such discrepencies beg the question of whether or not one can really use the replicates together in a straightforward manner or whether the replicates need to be intelligently calibrated in some manner prior to analysis. recently,  <cit>  presented a method for fusing together replicates based on linear regression. indeed, the ability to reliably combine several data-sets together is highly desirable as one large dataset is potentially more useful than several smaller ones. hence, we introduce two additional parameters for each replicate, ρr and a replicate specific noise parameter σr2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemocaihabagaegomaidaaaaa@3102@. in order to ensure that the gene delays and replicate shifts are identifiable it is necessary to fix at least one τg and one ρr and define all delays relative to them. finally, we must define a prior distribution over τ and ρ. for convenience, we will fix τg =  <dig> for the 'fastest' gene and ρr =  <dig> for the 'fastest' replicate thus constraining all other values to be positive. for all delays and replicate shifts we use a gamma prior with parameters a =  <dig> , b =  <dig> 

alternatively, varying delays could be due to the different functional roles of genes . in addition, many regulatory modules form cascades with genes regulated at one level also regulating their gene-targets. standard knock-out experiments will highlight all genes downstream of a particular tf but will not be able to distinguish between direct and indirect relationships. as genes further downstream will have larger delays, being able to accurately calculate these may help in uncovering the true network structure . additionally, taking into account such delays will also improve the accuracy of the inferred tfa profile. finally, it is interesting to look at the posteriors over the noise parameters, shown in figure 6c indicating a large variation in the level of noise across the three replicates.

is the non-linear model necessary?
in the previous section, we saw how the tfa inference procedure can be applied to a cell-cycle regulated motif from fission yeast. however, the problem appears rather straightforward and it could be argued that a linear model could perform the same analysis. consider the following linear ode,

μ˙
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgagaaaaa@2e72@g = βgη - δgμg     

where we have removed the saturation  and basal production parameters . results obtained with this model, are qualitatively similar to those obtained previously with mm. however, we can objectively compare the two models using approximate bayes' factors calculated from the following approximation of the marginal likelihood ns/∑s=1nsp−1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobgtdawgaawcbagaem4camhabeaakiabc+cavmaaqadabagaemicaanaeiikagccbegae8hwaglaeiifawhccigaf43tdgmbaebadawgaawcbagaem4camhabeaakiabcycasggadiab9h7axnaabaaaleaacqwgzbwcaeqaaogaeiilawiae43wdm3aa0baasqaaiabdohazbqaaiabikdayaaakiabcmcapmaacaaaleqabagaeyoei0iaegymaedaaaqaaiabdohazjabg2da9iabigdaxaqaaiabd6eaonaabaaameaacqwgzbwcaeqaaaqdcqghris5aaaa@4d42@ where ns is the number of samples drawn and η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@s, θs, σs2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4camhabagaegomaidaaaaa@3104@ are the parameter values of the sth draw from the posterior. the bayes' factor  is given by the ratio of the marginal likelihood under the two competing models . taking posterior samples for both the mm and linear models, we find that the  <dig> log b =  <dig> suggesting a great deal of evidence for the mm model . the approximation to the marginal likelihood that we have used is known to have its faults  and so we also adopt the ratio of likelihoods test that allows us to compare likelihoods whilst penalising the added complexity of the mm model. in figure 7a we show histograms of the log-likelihood values of the samples drawn from the posterior under the linear and mm models. using the ratio of likelihoods test with  <dig> degrees of freedom  the log likelihoods would have to differ by approximately  <dig>  to give a significant improvement at the 1% level. it is clear from the figure that this is easily the case. in a more general model comparison scenario , the difference between two models is unlikely to be so extreme and so investigating more reliable approximations to the marginal likelihood is an area of ongoing investigation. as a second example, we consider a dataset for e. coli  that highlights the need for a nonlinear model when the tf acts as a repressor. the linear model defined by equation  <dig> is used with β constrained to be negative. we have already discussed how this particular model is not very biologically interpretable, however it could be argued that this is not terribly important if it can adequately describe the data. one interesting characteristic of this data is that the expression profiles of the target genes are rather uncorrelated and appear to fall into two characteristic groups. figures 7b and 7c show examples of genes from both of these groups. in 7b we see that the expression profile rises gradually throughout the time course and whilst the mm model fits the data better, the linear model captures the general trend reasonably well. however, in 7c the expression profile rises rapidly to a steady value. in this case, the linear model fails to adequately model the observed data whilst the mm model is able to describe this behavior due to the inclusion of a saturation term. additionally, in this example,  <dig> log b =  <dig>  which again suggests strong evidence in favour of the mm model. this example highlights the necessity of a nonlinear model in this particular application as genes regulated by the same tf can have uncorrelated behavior that cannot be handled by linear models. this is a particularly acute issue when a tfa is used to suggest possible new target genes  as essentially only candidate genes that are correlated with current known targets will be suggested.

in addition, the low quantity of data in this example shows the advantage of the bayesian approach. the percentiles in figures 7b and 7c are rather wide, as are the posteriors for the kinetic parameters and the η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ profile  providing an objective indication of the certainty/uncertainty in our predictions. without such knowledge, it may not be clear whether the mm or linear models is more suited to the problem. however, the percentiles shown provide evidence that the nonlinear model is better supported. finally, the mm model is not the only nonlinear model that could be used. for example, replacing η¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf3oaagaqeaaaa@2e77@ in equation  <dig> with its reciprocal may also work adequately. however, inspection of the posteriors over γg  shows some variation, suggesting varying saturation effects between the genes. a comparison between different nonlinear models is an avenue for future work, although the diffuse nature of the posteriors over γ here suggest a larger dataset would be required to come to any definite conclusions.

CONCLUSIONS
in this paper, we have presented a fully bayesian approach for the inference of tfa from the expression of target genes. there are many known cases  where the expression of the gene coding for the tf is highly un-correlated with the expression of its targets. in such situations, the expression of the tf cannot be used to directly model the expression of the target genes and inference of the tfa from microarray data is less expensive and more straightforward than in-vitro measurements. previous approaches to tfa inference have generally assumed linear or log-linear models of transcription. however, the non-linear approach here is able to handle effects such as saturation that are known to be a part of transcription and can adequately handle both activation and repression. in addition, the mm kinetic model does not require evenly spaced expression data and modeling the rate of mrna production rather than the absolute magnitude is more biologically plausible. we have highlighted the drawbacks of the linear model with a repression example from e. coli. the linear model was unable to capture the diversity in expression profiles present in one sim. in addition, using the linear model in the repression case requires a negative production term that is not particularly biologically plausible. originally,  <cit>  proposed a maximum likelihood scheme for inferring the tfa profile. however, due to the form of the mm kinetic model, maximisation of the likelihood is not straightforward and hence here we have adopted a full bayesian sampling strategy. as well as being more amenable to this particular application, the fully bayesian scheme offers several other advantages, particularly that the full posterior distribution provides far more information than the maximum likelihood estimate. the shape of the posterior distributions provides information on the certainty that can be placed on subsequent inferences made.

in addition, as an example of how the model could be extended, we have shown how incorporation of delays – both biological delays specific to genes and replicate specific delays that appear as artifacts of the experimental procedure – can be accomodated within this framework. the results obtained from this analysis open some interesting questions. for example, is it sufficient to use replicates as they are provided or do they need some kind of alignment beforehand? our results suggested that there were lags between replicates of the order of half a time interval and hence assuming that all measurements were taken at the same point in the cell cycle could be rather misleading. values for replicate shifts inferred with this method could be used to align data for other genes that belong to areas of the regulatory network where topology is partly or totally unknown, making the data more reliable. the method also allows the disambiguation of observed time lags that are due to experimental artifacts such as shifts between replicates and genuine biological effects like different delays between genes. one area of future work that may improve the inference of delays is the investigation of richer, informative priors for η. a gaussian process prior  would allow the tfa to be defined at all time points and also provides a means for encoding a desirable a-priori preference for smooth functions.

authors' contributions
sr and rk contributed equally to this work. all authors worked on and have approved the final manuscript.

