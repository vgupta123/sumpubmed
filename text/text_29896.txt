BACKGROUND
the recent advancement of deoxyribonucleic acid  microarray technology allows the measurement of expression levels of tens of thousands of genes simultaneously  <cit> . a dna microarray experiment measures the abundance of messenger ribonucleic acid  present in a set of cells, and a high concentration of mrna for a given gene indicates a high expression level for that gene  <cit> . the solution of mrna is either radiolabelled or fluorescently labelled and then allowed to hybridize to spots on the array. further information about early dna microarray experiments can be found in  <cit> . there is a wide variety of arrays, but the two main kinds are short and long oligonucleotide arrays. in oligonucleotide arrays, there are approximately  <dig> probes pairs of a perfect match  and a mismatch  for each gene. the pm probe contains a match to a small subsequence of a gene's polynucleotide, about  <dig> bases long, while the mm probe acts as a control, being a copy of the pm probe with the central position flipped to its complement. the amount of mrna present in the target gene in a sample is estimated from a combination  of the pm-mm intensity differences over the  <dig> probe pairs  <cit> .

in a spotted complimentary dna  or long oligonucleotide arrays  thousands of spots of cdna from the genes are printed onto a glass slide or some other form of substrate. two different mrna samples are separately reverse-transcribed into cdna and labelled with different fluorescent dyes, green  or red . the mixture of labelled cdna is co-hybridized on the same microarray, and the labelled cdna molecule will bind to the complementary fragments of cdna sequence on the slide. a laser scanner is then used to measure both fluorescent signals emitted at each spot on the chip. the general idea assumed behind the technology is that if a particular gene is highly expressed in the sample, it produces many molecules of mrna  <cit> . these in turn will hybridize to the probes on the microarray and generate a very bright fluorescent area. genes that are less expressed produce less mrna, which results in dimmer fluorescent spots. if there is no fluorescence, no messenger molecules have hybridized to the probes, indicating that the gene is inactive. by comparing the intensity levels of the emitted fluorescent lights between the samples, it is hoped that one might be able to identify any differences in the gene expression profiles of the various samples.

in a typical cdna microarray experiment, we are looking to ascertain whether gene i displays differential expression between two samples t and c, labelled with differential colours red and green. for instance, these experiments include comparing tumor and normal tissue cells, treated and untreated cells, or cells from knockout and wild-type organisms. the samples can be compared on the same slide , resulting in a direct estimate of differences in expression levels since the measurements come from the same hybridization. an alternative is when expression levels ti and ci are estimated in two different hybridizations, with t together with reference sample r and c with another reference sample r'. this is an indirect estimate of the gene's differential expression since the t and c expression levels are from different hybridizations  <cit> . sometimes, common reference samples are hybridized with each mrna sample of interest , resulting in what are known as common reference designs. the common reference sample could be tissues from wild-type organisms or control tissue or a pool of all the samples of interest.

standard statistical analyses
the simplest way, used by many in the field, to ascertain a gene's differential expression, is on the basis of a fold-change criterion, defined by the log-ratio δi = log <dig>  under direct comparison or δi = log <dig> - log <dig> for indirect comparison. it is expected that the majority of genes will have a δi value close to  <dig>  <cit> . those genes with a large positive δi value  are generally concluded to be overexpressed or upregulated in the t sample, and those whose δi is negatively large  are concluded to be underexpressed or downregulated in the t sample. however, the use of fold change is of limited use, as the intensities are associated with some biological, experimental and measurement error, and unless these error distributions can be derived, it is difficult to assess whether a ratio of  <dig> , say, is worth noting or whether it has occurred by chance. furthermore, the boundaries accepted for thresholding these fold-changes seem to be rather arbitrary and very little documentation can be found to support these criteria.

in recent times, the identification of genes that are differentially expressed between two conditions has been based on a standardised fold-change, which is the fold-change divided by an estimate of its standard deviation. a t-test, with a correction for multiple testing, is then used to test for significance of the standardised fold-change. this allows for the assessment of significance of the observed differences in the presence of all the sources of variation, which are not necessarily equal from gene to gene. our contribution to the problem of identifying genuinely differentially expressed genes is on the estimation of reliable standard deviations of gene expression levels. modelling of gene expression variability ranges between two extreme cases: a constant variance, which is too stringent an assumption, to independent gene-specific variances. the latter option has low power as it is based on very few replications as a result of the relatively large cost of commercial microarray chips. this makes estimation of the sample standard deviation very unreliable and unstable. an ad-hoc solution to the problem includes discarding genes with a small fold-change and very small standard deviations  <cit> . a better method, called significance analysis of microarrays , developed in  <cit> , adds a constant a <dig> to each gene-specific standard deviation, thus preventing the denominator of the t-statistic from getting too small. this was expounded in  <cit> , using an empirical bayesian procedure, by taking a <dig> equal to the 90th percentile of the standard deviations of all the genes. shrinking the gene-specific standard deviations in this way helps to minimize the false discovery rates .

mixture models
an intuitive approach to modelling gene expression data is to assume two groups of genes, one group with genes that are differentially expressed and the other with genes that are not differentially expressed. this approach has been used in analyses involving mixture models for gene expression levels. formally, the basic assumption is that the distribution of the difference δi can be flexibly modelled as a mixture with two components: a subgroup of genes with δi around  <dig> and a subgroup of genes with non zero δi  <cit> . using this approach, lonnstedt and speed  <cit> , derived an empirical bayesian statistic b, which is the log posterior odds of differential expression. efron et al.  <cit>  and efron and tibshirani  <cit>  also consider a two component mixture model to model differential gene expression, the later using a rank-based nonparametric two-sample test statistic. a similar approach was followed-up in  <cit>  based on a fully bayesian hierarchical model, but with an unknown number of mixture components. the number of components was treated as a random variable and estimated with the other parameters based on the pioneering work of richardson and green  <cit> . other approaches using mixture models for gene expression data from microarray experiments can be found in  <cit> .

purpose of the paper
a number of methods, particularly based on full bayesian hierarchical models, have been used to provide better estimates of variance for gene differential data. these methods provide estimates of gene-specific variance, which are the weighted average of the empirical variance and a prior variance estimate  <cit> . in particular, lewin et al.  <cit>  provide a fully bayesian approach combining estimation of gene differential expression, biological variability and array effects with a hierarchical prior distribution on gene-specific variances. other than modelling the gene-specific variances with an exchangeable hierarchical prior, delmar et al.  <cit>  use a mixture model on the distribution of gene-specific variances. genes are grouped into latent classes based on homogeneity of their variances. a gene is assigned a variance based on its latent class membership and this variance is estimated with high power because of the large number of genes  in that latent class. all these methods produce what are called regularized t-tests.

our work is closely related to that proposed by delmar et al.  <cit> , who used the em-algorithm to fit a variance mixture model for gene expression data. we believe our bayesian approach has certain advantages and adds value in comparison to the em-algorithm approach. in using a bayesian hierarchical model, we are able to model various sources of variability in a common model, thus propagating uncertainty. within a bayesian hierarchical model framework, it is far easier to borrow and share data across all genes in order to obtain more reliable estimates of their variance and at the same time allowing for some variability. in this approach, variances are stabilized and shrunk towards the average variance within each component of the mixture, in particular some small and large variance estimates that are incompatible with the overall distribution are increased and decreased, respectively.

furthermore, in complex biological data exhibiting a lot of noise, traditional statistical methods, such as the em-algorithm, can struggle to cope with complex non-linear models when used to explore such data. in the bayesian paradigm, on the other hand, all the unknown quantities are treated together in a consistent manner, to give fully probabilistic information on all unobserved variables, even their functions. our method is based on a chi-squared -mixture model for the gene-specific variances, with the number of components ranging from  <dig> to  <dig>  in bioinformatics, as in many fields, mixture models have been fitted through the expectation-maximisation  algorithm with different values of the number of mixture components  <cit> . in this paper, we present a bayesian analysis of the variance mixture model, which we implement in the bayesian software package, winbugs  <cit> . the methodology is applied to a dataset on diffuse large b-cell lymphomas. the data contains expression levels of chronic lymphatic leukaemia  and diffuse large cell  malignancies for the  <dig> genes under study. the results of applying our model to the data-set are presented in the results from the mixture model section. a discussion of the model and the results are in the conclusions section.

it is hoped that the work presented in this paper will contribute to a large volume of current research work aimed at minimizing the risk of false positives in microarray experiments. the two extreme assumptions on the variance of gene expression data are presented in the standard models for gene variance section and a description of the variance mixture model is contained in a mixture model for gene variance section.

RESULTS
description of the data set
we analyse the data described in  <cit> , which investigates the classification of diffuse large b-cell lymphomas into distinct groups by gene expression profiling. diffuse large b-cell lymphoma is an aggressive malignancy of mature b lymphocytes. it is estimated that, with an annual incidence of over  <dig>  cases, it accounts for approximately 40% of all cases of non-hodgkin's lymphoma. currently, a combination of clinical parameters is used to provide an assessment of a patient's risk profile and to determine the most suitable clinical course of treatment. whilst most patients initially respond well to chemotherapy, patients receiving the same diagnosis can have very different final outcomes in terms of remission achieved and their overall survival. it is suspected that the prognostic variables used are in fact proxies for the underlying cellular and molecular variation within diffuse large b-cell lymphomas. their work considers whether gene expression profiling could subdivide this 'clinically heterogenous diagnostic category into molecularly distinct diseases that would possess more homogeneous clinical behaviours'  <cit> . the microarrays used in this experiment were specially designed complementary dna microarrays, called 'lymphochips', which included those genes with a known or suspected role in processes that are important in immunology or cancer, and those genes known to be preferentially expressed in lymphoid cells. the profiling of gene expression included the three most prevalent adult lymphoid malignancies, in addition to profiling the gene expression in purified normal lymphocyte subpopulations under a range of activation conditions, in normal human tonsil and lymph node, and in a variety of lymphoma and leukaemia cell lines. from each experimental mrna sample, a cdna sample was prepared and labelled with red cy <dig> dye. furthermore, a corresponding reference cdna sample, labelled with green cy <dig> dye, was prepared from a pool of mrnas isolated from nine different lymphoma cell lines. the labelled samples were combined and hybridized to the microarray.

approximately  <dig> -million measurements of gene expression were taken in all, across  <dig> normal and malignant lymphocyte samples, using  <dig> of the lymphochip microarrays. to demonstrate the method proposed in this paper, we use a small subset, containing only eight slides from two conditions. four slides quantify gene expression relating to chronic lymphatic leukaemia  malignancies and the other four to diffuse large cell lymphoma  malignancies. each slide contains measurements for  <dig> genes. the red-to-green intensity ratio can be quantified for each gene and this reflects the relative abundance of mrna in the experimental sample compared with the reference mrna pool. by using a common reference sample, these fluorescent ratios can be considered a comparable measurement of the relative expression level of each gene across all of the samples. we want to compare different gene expression levels between the cll and dlcl malignancy conditions.

results from the mixture model
we fitted the model:

 yicrc=μic+εicrc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedawgaawcbagaemyaakmaem4yammaemocai3aasbaawqaaiabdogajbqabaaaleqaaogaeyypa0dccigae8hvd02aasbaasqaaiabdmgapjabdogajbqabagccqghrawkcqwf1oqzdawgaawcbagaemyaakmaem4yammaemocai3aasbaawqaaiabdogajbqabaaaleqaaaaa@41ec@ 

where yicrc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedawgaawcbagaemyaakmaem4yammaemocai3aasbaawqaaiabdogajbqabaaaleqaaaaa@33f1@ is gene i's log-ratio of observed intensity for condition c to the reference mrna pool in replicate rc;  μic is the mean log-ratio; and εicrc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf1oqzdawgaawcbagaemyaakmaem4yammaemocai3aasbaawqaaiabdogajbqabaaaleqaaaaa@3424@ is normally distributed with mean  <dig> 

the mixture weights were estimated as part of the model, where they were assigned a dirichlet prior distribution,  ~ dirichlet, where k is the number of mixture components. the χ <dig> mixture scale parameters ψj were assigned independent gamma prior distributions. for each mixture model, three independent chains were run for  <dig>  iterations. we discarded the first  <dig>  iterations and used a combined sample of the remaining  <dig>  iterations for posterior summaries.

the determination of the number of components to include in a mixture is an important, yet unresolved key issue in finite mixture models. there are a number of approaches for assessing the adequate number of mixture components, and a review of the available approaches is given in oliveira-brochado and martins  <cit> . standard χ <dig> based goodness of fit and likelihood ratio tests are not reliable statistics for deciding the number of mixture components; in particular the likelihood has a tendency to select more complex models, having a higher number of parameters. the widely used selection statistics – bayesian information criterion  and akaike information criterion  – impose a penalty on the likelihood to account for the number of parameters estimated in the model. both bic and aic have been shown to be suitable in determining the number of latent classes in the normal-mixture model. however, in some non-normal mixture models, such as beta-mixture, bic and aic were shown to perform poorly, by selecting excessive numbers of components whilst an alternative criterion, the integrated completed likelihood -bic selected the right number of mixture components in simulation studies  <cit> . on the other hand, the icl-bic selected too few components in poisson-mixture models  <cit> , whereby the performance of bic and aic criteria were adequate, more so for the bic in large samples. for the purpose of this bayesian application, and considering that the underlying distribution of variance is continuous and sample size is relatively large, we chose to use the bic criterion for model selection. the bic is defined as: bic = - <dig> * log -likelihood + p log g, where p is the number of unknown parameters in the model  and g is the sample size. in the bayesian context, bic selects a model that is most probable after conditioning on the data  <cit> . the model with the smallest bic value is selected to be the model that best predicts the number of mixture components, bearing in mind that when a set of models estimated on the same data set yield the same log -likelihood value, bic favours parsimony by selecting the model with the fewer parameters. we present posterior mean and standard deviation  estimates of the model parameters from fitting the proposed model with corresponding values of bic . the results are shown only up to the four-component mixture model as the bic value changed by only about  <dig> when fitting a five-component mixture model. also provided are comparative results from fitting the em algorithm  <cit> . our bayesian mixture variance model gives very similar results to those obtained from the em algorithm. the results seem to imply that there is one small latent class consisting of genes with a large variance.

for each fitted variance mixture model, we assigned each gene i to group j according to the highest estimated posterior classification probability πij. in turn, gene i was assigned variance σ^i∗2=σ^j2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfdpwcgaqcamaadaaaleaacqwgpbqacqghxiikaeaacqaiyagmaagccqgh9aqpcuwfdpwcgaqcamaadaaaleaacqwgqbgaaeaacqaiyagmaaaaaa@3749@ where σ^j2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfdpwcgaqcamaadaaaleaacqwgqbgaaeaacqaiyagmaaaaaa@3102@ is the estimated variance of latent class j. thus, the derived t-statistic for gene i now becomes:

 ti∗=δ¯i/se=δ¯i/1/ <dig>  

where m <dig> and m <dig> are sample sizes  for condition  <dig> and  <dig>  respectively.

we compared the t-statistics using gene-specific and homogeneous standard errors to the four-component mixture estimated standard errors. it was evident that the majority of genes have t-statistics very close to  <dig>  indicating similar expression levels under the two conditions, cll and dlcl . all three have a similar shape; however, the mixture estimated t-statistic is more conservative than the gene-specific t-statistics  and not as naive as the homogeneous statistic, which is based on overly unrealistic gene variance assumptions. the mixture estimated t-statistic is more informative as it uses standard errors estimated from a larger number of genes based on their variance similarity. in the data set, some genes have larger variances than others and large variance genes that are not differentially expressed are more likely to have large log fold changes. however, when taking variance into account, these genes produce small t-statistics. on the other hand, with only four measurements per group, the estimate of the standard error is not stable and some genes have large t-statistics only because, by chance, the denominator was very small. this relative large disparity in t-statistics is demonstrated in histogram  and . the histogram is an improvement in that it does give high t-statistics to genes only because they have small sample variances. the statistic presented in histogram  is referred to as the modified t-statistic, which are based on borrowed strength across genes in order to obtain more stable estimates of gene variances.

this classification of genes under the bayesian mixture model was compared to that obtained under the em mixture model for the four component model . there is very good agreement between the two models, with only  <dig> out of  <dig> genes classified differently. the measure of agreement, kappa, was  <dig> . for all of the  <dig> genes that were classified differently, their two most likely classes, based on the posterior classification πij, were the same in both models. in this case, one can conclude that the two models resulted in agreement in classifying genes to the four mixture components.

we identified the top ten ranked genes according to the absolute t-statistic obtained from using various variance models . only two genes, coded  <dig> and  <dig> are consistently ranked in the top ten across all variance models. genes coded  <dig>   <dig>   <dig>   <dig> and  <dig> are ranked in the top ten in at least two variance models.

finally, other than setting σ^i∗2=σ^j2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfdpwcgaqcamaadaaaleaacqwgpbqacqghxiikaeaacqaiyagmaagccqgh9aqpcuwfdpwcgaqcamaadaaaleaacqwgqbgaaeaacqaiyagmaaaaaa@3749@, which is outright membership, we also considered a weighted variance estimate σ^iw2=∑πijσj2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfdpwcgaqcamaadaaaleaacqwgpbqacqwg3bwdaeaacqaiyagmaagccqgh9aqpdaaeabqaaiab=b8awnaabaaaleaacqwgpbqacqwgqbgaaeqaaogae83wdm3aa0baasqaaiabdqgaqbqaaiabikdayaaaaeqabeqdcqghris5aaaa@3e70@ based on a four-component variance mixture model. we ranked genes using this weighted variance estimate to compare the ranking obtained from the other variance estimates . eight genes coded  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> that appear in the top ten under the weighted variance model, also appear at least once in the top ten of the other variance models. these genes might be interesting, thus requiring further analysis and investigation.

we are aware that different assumptions for the prior distributions for both mixture weights and scales may give different results. we performed some limited sensitivity examination of the results to different specification of the priors. there were slight differences in the results, but the substantive conclusions were not affected.

CONCLUSIONS
we have presented a bayesian variance mixture model for differential gene expression data. this model is a compromise between two extreme models: the too stringent constant gene variance and the overparameterised gene-specific variance models, which are both unrealistic assumptions. our mixture variance model provides a more realistic and flexible estimate for the variance of gene expression data under limited replicates. we believe that in using the  latent class variances, estimated from a larger number of genes in each derived latent group, the p-values obtained are more accurate then either using a constant gene variance or gene-specific variance estimate.

in our example data, the results obtained from using our model are in close agreement to those obtained using em algorithm implementation  <cit> , which had been shown, using simulation studies, to be flexible and reliable in both true and false discovery rates. our results are based on the assumptions of normally distributed log-ratios and a constant gene-variance between the two conditions. we are working on relaxing these conditions, in particular in using a long-tailed t-distribution as a robust alternative to allow for the possibility of gene-intensity measurement outliers. by varying the degrees of freedom, the t-distribution can also be used to investigate the sensitivity of the posterior results to changes in the prior for the gene intensity measurements.

