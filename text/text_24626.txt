BACKGROUND
dna microarray technology can simultaneously measure the mrna levels of thousands of genes under certain experiments. it gives a global overview of gene expression profiles in particular cells or tissues, so it has become one of the most prominent tools in functional genomics research. the analysis of gene expression profiles is aim to discover a broad range of biological disciplines and predict a clinical state or other effects such as cancer classification and relevant genes identification, mechanism investigation and cancer prognosis  <cit> . though playing crucial roles in these studies, the existing multivariate analysis methods for expression profile data have been greatly negatively affected by the high percentage of missing values, e.g. hierarchical clustering and the support vector machine classifier  <cit> . moreover, many analysis methods such as principal component analysis , singular value decomposition  and generalized svd  cannot be applied to datasets with missing values  <cit> .

missing values often occurred due to various reasons, such as insufficient resolution, image corruption, dust or scratches on the slide and etc., however none dominated. generally, microarray datasets are estimated to have more than 5% missing values and up to 90% of genes are affected  <cit> . as a result, although often disregarded, the missing value imputation is essential to minimize the detrimental effect of missing values on the microarray data analysis.

certainly, one strategy to validate the analysis method of the microarray data with missing values is to repeat the experiments, and obviously it is very expensive and time consuming  <cit> . there are also several simple ways to handle missing values, e.g. removing the genes with missing values from further analysis, replacing missing values by zeros, or filling the missing values with the row or column averages available  <cit> . these approaches are not optimal because they did not consider the correlation of the data, which encouraged the development of more refined missing value procedures that tried to exploit the data relationships by using the information available in the whole dataset  <cit> .

therefore, many imputation methods have been proposed since  <dig>  such as k-nearest neighbour, singular value decomposition, local least square, bayesian principal component analysis, gaussian mixture clustering , collateral missing value estimation and weighted nearest neighbors method <cit> . however all of the above methods are solely based on the gene expression datasets themselves and utilize nothing of the external microarray datasets or biological related information.

integrative missing value estimation method  is the first to incorporate information of multiple reference microarray datasets to improve missing data imputation  <cit> . however, it is difficult to find various datasets and even more difficult to find a set of genes frequently show expression similarity to the target gene over multiple datasets. meanwhile, goimpute is the first algorithm that exploits the functional similarities embedded in the geneontology databases along with the expression similarities to facilitate the neighbor gene selection  <cit> . it outperformed knn at high missing percentages, while due to the limitation of the number and accuracy of the gene functions annotated in go databases, goimpute failed to improve the lls.

as summarized in table  <dig>  missing value is a common problem that has to be addressed even for more recent studies  <cit> . furthermore, there are many genes with high missing percentages. in this case, for genes with many missing values, few values are remained to determine how the gene is correlated with other genes in the dataset, which leads to less accurate estimates. it is well known that gene expressions in eukaryotic cells are concertedly regulated by transcription factors and chromatin structure  <cit> . the fundamental repeating unit of chromatin is nucleosome, which consists of approximately  <dig> base pairs of dna wrapped around an octamer of four core histones   <cit> . as mentioned in  <cit> , histone acetylation may alter chromatin structure and provide binding surfaces for transcription factors. therefore, the transcription factor activity is highly regulated by the histone acetylation states in chromatin. consequently, the gene expression profiles are regulated by the histone acetylation states  <cit> . intuitively, this means that one of the important prerequisites for gene co-expression is the similar acetylation state in their chromatin. with this idea in the mind, the use of available acetylation information will somehow contribute to the selection of neighbour genes especially for microarrays with high missing percentages.

n and l are the number of experimental conditions and genes in the original dataset respectively. n' and l' are the number of experimental conditions and genes in the dataset after removing the genes with missing values.

in this paper, we proposed an imputation framework called haiimpute to integrate histone acetylation information to improve the estimation accuracy of the missing values in gene expression datasets. we applied haiimpute to both lls and knn, namely, llshai and knnhai. the performance of haiimpute is compared with lls, knn and goimpute over various well characterized saccharomyces cerevisiae  datasets outlined in table  <dig>  these datasets include time-series datasets, non-time series dataset and mixed-type dataset . it seems that our approaches showed a significant and consistent improvement compared to knn and lls while goimpute did not achieve  <cit> . in addition, the application of an iterative process to haiimpute further improves the accuracy.

RESULTS
datasets
many studies about the gene expression and histone acetylation have been conducted extensively in the yeast, so it is chosen to be the model organism in the paper to test the imputation accuracies of the methods  <cit> . datasets analyzed in this study include those for gene expression and histone acetylation.

gene expression data
several cdna microarray datasets of yeast were downloaded from the publicly available website  <cit> . the datasets are chosen to represent diverse types of experimental conditions including time series, non-time series and mixed-type. at the same time, in order to evaluate the performance of the methods under various numbers of experimental conditions, datasets with small and large number of conditions are selected. so that results are likely to hold for cdna microarray datasets in general. the summary of the experimental details of the datasets is shown in table  <dig>  the first dataset  is a combined dataset from the experiment data of two studies <cit> . the study of  <cit>  is trying to indicate the critical role of histone variant h2a.z on protecting euchromatin and affecting gene expression, while the study of  <cit>  is about the deposition of histone variant h2a.z by a multi-subunit protein complex and the effects on global gene expression. the combined dataset contains  <dig> different non-time series experimental conditions. another non-time series dataset is the study of response to environmental changes in yeast from  <cit> . it contains  <dig> genes and  <dig> experimental conditions that have time-series of specific treatments. after removing all the experimental conditions with more than 8% missing entries, we select all genes without the missing values. among the resulting  <dig> genes,  <dig> experimental conditions are randomly selected and rearranged to construct a non-time series subset of the whole original dataset. the third dataset  is a temporal gene expression dataset studying metabolic shift from fermentation to respiration in yeast. it is a time-series dataset from  <cit>  and contains  <dig> sampling points for each genes. another two time-series datasets are the alpha part and the elutriation part of spellman datasets which focus on the identification of yeast cell cycle genes  <cit> . they have  <dig> and  <dig> sampling points respectively. these three time-series datasets are also chosen to evaluate the influence of different number of the sampling points on the performance of the methods. the last dataset is calcineurin dataset which focus on gene expression in calcineurin/crz1p signal pathway  <cit> . it contains  <dig> gene expression profiles and  <dig> experimental conditions with both time-series and non-time series.

histone acetylation data
since histone acetylation is one of the most important modifications of the histone proteins, it mainly affects gene transcription in the following two major pathways  <cit> . on one hand, histone acetylation may alter the folding properties of the chromatin fibre and influence the binding of transcription factors, thereby modulating the accessibility of target binding sites in the dna through structural properties changes  <cit> . on the other hand, histone acetylation will expose specific binding surfaces for the recruitment of transcription factors, so as to affect the gene activity and regulate the gene expression. therefore, such modifications can always be maintained through cell division and propagated to proximal nucleosomes by positive-feedback mechanisms. the activation of a transcription factor can also be temporally and spatially transmitted through chromatin  <cit> .

nowadays, the rapidly accumulated histone acetylation information in public databases have provided a genome-wide map of genomic regions that are enriched or depleted of histone acetylation  <cit> . also available are datasets measuring the relative association of the histone proteins themselves  with dna  <cit> . the sites of acetylation include at least four highly conserved lysines in histone h <dig>  five in histone h <dig>  as well as less conserved sites in histone h2a and h2b  <cit> . various histone acetylatransferases and deacetylases show distinct specificities for different acetylation sites, which generate unique histone acetylation patterns that involve combinations of differently acetylated sites  <cit> .

it is reported in  <cit>  that unique patterns of histone acetylation are each enriched for genes that have significant mrna expression coherence under a wide range of experimental conditions in addition to the same conditions in which acetylation data were obtained. furthermore, the genes that share common acetylation patterns are also enriched for specific transcription factor binding sites and common dna motifs. all these phenomena verified that acetylation patterns play fundamental roles in diverse chromatin-based processes to coordinate the regulation of related genes  <cit> . the histone acetylation data used in this paper were from the study of  <cit> , where genome wide histone acetylation levels at  <dig> sites for both intergenic regions  and open reading frames  were measured using chip-chip and the acetylated dna was hybridized against the genomic dna on microarrays.

models for missing values
in order to evaluate the performance of missing value imputation, genes that contain missing values are removed from the original expression datasets to construct the complete datasets. based on these datasets, two different missing value models are designed to introduce artificial missing values in percentage-based way from 1% to 20%.

random model of missing values
in this model, the datasets with missing values were constructed by removing a specific percentage of the values  from the datasets randomly and independently. each entry in the dataset has the equal probability to be a missing value.

burst model of missing values
from the observation of the actual datasets in table  <dig>  many datasets are enriched of genes with high percentages of missing values. furthermore, most of these missing values occur in a successive way. therefore, we design a burst model of missing values in order to simulate this realistic missing pattern caused by experimental systematic errors.

if denoting the microarray dataset to be a n × l matrix

  g =  ∈ ℜn×l 

where column gi ∈ ℜn×l denotes the expression of gene i  under n different experimental conditions.

in the burst model, some artificial missing values are generated in series, namely, a burst. a burst of missing value is defined as a length of b successive missing elements in a column of g. if the missing percentage is set to be p between 1% and 20%, the total number of the missing values is l × n × p, the number of genes with burst of missing values is ⌈l×n×pb⌉. therefore, if the dataset g, missing percentage p, as well as the value of b are given, we can randomly sample some genes from g and randomly assign burst of missing values to each of these genes.

evaluation measures
each method was applied to recover the introduced missing values for every dataset. the performance was evaluated by calculating the normalized root mean squared error   <cit> . assume g^ is the imputed microarray matrix, then the nrmse for the predictor was defined as:

  nrmse=meanmean 

where the mean is calculated over missing values in the whole matrix. g is known because missing values are artificial. from , nrmse approaches its minimum value  <dig>  if the imputation is accurate. otherwise, if the nrmse becomes much larger, the imputation is poor.

for more careful evaluation of imputation efficiency, pearson correlation coefficients were calculated in addition to nrmse between imputed dataset and complete dataset for each gene with missing values  <cit> . we take the mean value of these correlation coefficients as another evaluation measure. based on this measure, we could find how the data structure of each gene was preserved after imputation with different imputation methods. the larger the correlation coefficient is, the better the relationship is preserved between imputed gene expression and complete gene expression, which is a very important property for gene when doing some gene selection analysis.

parameters setting
the values of the neighbourhood size k for knn, lls, goimpute and haiimpute methods are important model parameters for obtaining high performances. in accordance with the study of kim  <dig>  there is no theoretical result to determine these parameters optimally  <cit> . therefore, heuristic procedures are used to estimate parameter k in this paper.

selection of the neighbourhood size k
it was reported in  <cit>  that the best results of knn-based method are obtained by setting k between  <dig> and  <dig>  while the best results of lls-based method are obtained by setting k more than  <dig>  therefore in order to reduce the complexity, we used knn imputation method to select the optimal values of k for knn, goknn and knnhai by evaluating the imputation accuracy of knn in the range of k =  <dig> ~  <dig>  similarly, we used lls imputation method to select the optimal values of k for lls, golls and llshai by evaluating the imputation accuracy of lls in the range of k =  <dig> ~  <dig>  we generated  <dig> random missing datasets for each test run at each missing percentage. the results are presented in additional files  <dig> and  <dig> for knn and lls respectively. we observed that  <dig> neighbours were enough in most cases of each dataset for knn, while  <dig> neighbours are enough in most cases for lls, which is consistent with the observations of  <cit> . thus the value of k =  <dig> and k =  <dig> were used in the following test runs.

selection of the parameter λ
for haiimpute methods, parameter λ is also an important factor . it is a positive weight between  <dig> and  <dig>  which determines the contribution of acetylation patterns to the final imputation for missing values. because acetylation patterns have different effects in various datasets, the value of λ was estimated by a training procedure for each dataset. firstly, genes in each dataset will be divided into two subsets randomly. one subset consists of 20% of the genes which is regarded as the training subset, while another subset consists of 80% of the genes which is regarded as the testing subset. so the training and testing procedure were done on totally separate and different subsets. then in the training procedure,  <dig> independent simulations were executed on the training subset genes to select the optimal λ value which produced the minimum nrmse at each miss percentage. finally, in the testing procedure, this optimal λ will be used for the actual missing value imputation for the testing subset with 80% of the genes in the corresponding dataset. in this case,  <dig> independent simulations were executed for various missing percentages. so only the information in training subset genes was allowed to be used in the training procedure and there is no information leakage from training to testing. the simulation results are shown in additional files  <dig> and  <dig> for knnhai and llshai respectively.

nrmse performance with respect to percentage of missing values
the nrmse performance of the haiimpute methods  are evaluated over six different datasets and compared with three other approaches, i.e., knn, lls and goimpute . the neighbourhood size k in knn, goknn and knnhai were preset as  <dig> in each test run according to the simulation results in additional file  <dig> 

similarly for lls, golls and llshai, k will be set at  <dig> without loss of generality. in order to obtain results unbiased with regard to the missing part of the datasets,  <dig> independent and random simulation rounds were executed for each dataset under various missing percentages. the missing values are generated by the two different models described above.

the source code of goimpute was kindly presented by the author  <cit> . it used an adaptive selective procedure to select the weight parameter that controls how much of the go information is used in the imputation process, so the weight parameter is optimized in each dataset and at each missing value rate automatically. as for conventional knn and lls, they have no such parameters to be tuned. therefore, the optimal results of each method are used in performance comparisons. in this case, both the optimization of λ on the training subset  and the testing of the imputation method on the remaining subset  were carried out under the same missing value model.

nrmse performance under random model of missing values
the missing values are equally distributed if they are introduced with a random model. figure  <dig> shows the nrmses of the methods for each dataset in the presence of different percentages of equally distributed missing values. from figure  <dig>  we observed that the haiimpute methods produce more accurate imputation results than knn, lls and goimpute methods in almost all the datasets, especially at higher missing percentages.

sp.elu, sp.alpha and diauxic are three time-series datasets with different number of sampling points. the performance of the knnhai is better than that of the conventional knn and goknn across all the missing percentages in these three datasets. for llshai, specifically, in the datasets of sp.elu and sp.alpha, if missing percentage is below 5%, the nrmse of the llshai is comparable with, if not better than those of lls and golls. if missing percentage is above 5%, llshai shows good performance and outperforms lls and golls. this indicates haiimpute methods can help to select more strongly correlated genes than other methods in these two datasets. while an interesting phenomenon in the dataset of diauxic is that the improvement of llshai is not obvious, which is similar to what was observed in the goimpute study by johannes  <cit> .

as claimed by  <cit> , gasch is the most challenging dataset, where clear expression patterns are often absent. gasch is a non-time series dataset. figure  <dig> shows that the llshai and knnhai consistently achieve better results over the whole range of test missing percentages in all the cases. one interesting observation is that knnhai yields smaller nrmse than llshai at higher missing percentages. in gasch dataset, experimental conditions are randomly selected from the original dataset, so the correlated relationships among the experimental conditions are not as strong as that in the original dataset. in order to obtain results unbiased with regard to the selection of the experimental conditions from the datasets, we have independently and randomly selected the experimental conditions for  <dig> times and the results are similar and consistent. since haiimpute methods can provide relative more accurate values for the missing values, more proper neighbour genes can be selected and benefit knn. while since lls is more sensitive on the local similarity structure of the dataset than knn, the performance of lls is not improved so much because of the loss of the similarity among the experimental conditions.

another non-time series dataset is histone dataset relevant to histone variant h2a.z and its role in gene expression, which involves much more complex regulatory mechanisms. therefore, this dataset is more difficult for missing value imputation. from the performances of the methods in this dataset shown in figure  <dig>  the accuracies of the haiimpute methods are superior over all test missing percentages. the calcineurin dataset studied in  <cit> , is a mixed-type expression dataset regulated by the calcineurin/crz1p signaling pathway in yeast. the comparison results in calcineurin dataset show that the haiimpute methods performed more robustly as the percentage of the missing values increase. particularly, when the missing value percentage is below 10%, the llshai method gets comparable estimating ability with the golls. when the missing value percentage exceeds 10%, the nrmse of lls and golls become large while llshai is more robust. for knnhai, it performs better than knn and goknn at all the missing percentages.

nrmse performance under burst model of missing values
if the missing values are introduced with a burst model, the missing values are distributed unequally. the comparisons of haiimpute methods with knn, lls and goimpute methods in this case are shown in figure  <dig> for each dataset under various missing percentages. we observed that the haiimpute methods still produce more accurate results than the conventional knn, lls and goimpute methods in the case of burst model of missing values.

comparing with the results in random model, it seems that the performances of haiimpute methods are more robust than those of conventional knn, lls and goimpute methods in the burst model of missing values. especially in the datasets of gasch, histone and calcineurin, the performance improvements of haiimpute methods over conventional methods are still significant, while the performances of goimpute are greatly degraded and even worse than those of the conventional knn and lls. as for three time-series datasets of sp.elu, sp.alpha and diauxic, knnhai can still performs much better than knn and goknn, while the improvement of llshai is not obvious as they have performed in the case of random missing model. in order to test the cases that the underlying missing value models are not known in practice, another experiment is done to test whether the missing value model has an impact on the imputation results. in this case, the random model is used in the training phase to optimize the parameter λ, while the burst model is used in the testing phase. while for goimpute, we used its optimal results for comparison. the results in additional file  <dig> are very similar with the results in figure  <dig>  which showed that the haiimpute method is robust even though we do not know the underlying missing value models.

pearson correlation between imputed dataset and original complete dataset
the pearson correlation coefficients between imputed dataset and original complete dataset are calculated for each gene with missing values. this is another evaluation method which is to measure the correlated relationship between the imputed dataset and the original complete dataset with different imputation methods. the performances of haiimpute methods are compared with conventional knn and lls in terms of this measure. the neighbourhood size k in knn and knnhai was set the same value as before. so is the k value for lls and llshai. we execute  <dig> independent and random simulation rounds for all six datasets under various missing percentages and the missing values are generated by the random model described above. the comparison results are shown in figure  <dig>  the results are consistent with the nrmse performances in figure  <dig> across the whole test missing percentages. specifically, the datasets imputed by llshai are most correlated with the original complete datasets while the datasets imputed by knnhai are more correlated with the original complete datasets than those imputed by knn.

influence of used histone acetylation patterns
another important factor that influences the performance of the haiimpute methods is how to use the histone acetylation patterns. for the accumulated histone acetylation data , the acetylation level of  <dig> acetylation sites for igrs and orfs are clustered to generate different acetylation patterns . according to the published results of  <cit> , there are  <dig> and  <dig> clusters which are identified to formulate the corresponding acetylation patterns for igrs and orfs respectively. for each dataset, genes which share the same acetylation patterns are selected and mean expressions of these genes are computed to form the corresponding pattern expressions . in the proposed haiimpute methods, these pattern expressions will be exploited to facilitate the imputation.

here we test the nrmse performances of haiimpute methods if using acetylation patterns on different genomic regions, i.e., igrs or orfs. meanwhile, in order to reduce the computational complexity, the methods select only part of the acetylation patterns for imputation. therefore the performances when using different quantity of acetylation patterns are given for comparison. these were investigated in sp.elu dataset under different missing percentages and the results are presented in additional file  <dig>  for each case, we simulated  <dig> times of independent and random selection of the acetylation patterns for imputation.

we were surprised to find that the overall performances of haiimpute methods using acetylation patterns on the orfs seemed to be somehow better than those on the igrs, especially for knnhai. another interesting observation is the behaviours of knnhai and llshai: the imputation accuracy of knnhai degrades markedly as the quantity of used acetylation patterns decreases. as for llshai, the influence is not so strong, but it does affect. in addition, when the quantity of used acetylation patterns is less than  <dig>  the imputation accuracy will be degraded quickly if decrease the quantity of the used acetylation patterns. while more than  <dig>  the imputation accuracy will be steady. this may caused by the fact that the regulation information associated with acetylation patterns may be redundant with the genomic sequence information, so that not all of the pattern expressions are significantly meaningful  <cit> . this observation may be partly explained by the results in  <cit> .

nrmse performance with respect to iterative process
an iterative process to refine missing value estimates was implemented in llshai and knnhai. the results in the time-series datasets  and mixed-type dataset  with respect to the number of iterations are shown in additional file  <dig>  in knnhai, the number of iterations until convergence was in general smaller than three, whereas in llshai, one or two times of iterations were sufficient to achieve the convergence criterion . from additional file  <dig> we can see that the use of iterations in haiimpute methods can refine the missing estimates in the presence of high missing percentages in these datasets because it minimises the bias introduced by the initial estimation step.

discussion
the paper proposed to incorporate the histone acetylation information into the conventional knn and lls methods, namely, knnhai and llshai. it is well known that conventional methods are based on the assumption that if genes are co-expressed in some experimental conditions, they are assumed to have similar expressions in other experimental conditions with missing values  <cit> . this assumption is true if the genes share the same regulatory mechanism under different experimental conditions  <cit> . when the missing percentage is low, it is reliable for genes with missing values to find the co-regulated genes only based on the non-missing part. while in the case of high missing percentage, few values are remained and it is impossible to determine which genes are co-regulated with the target gene in the dataset. the functional similarity utilized in  <cit>  may provide implicative information about gene expression in this case because co-expression genes are thought to have high probability to participate in the same biological functions. however, since histone acetylation provides a mechanism to straightforward coordinate the regulation of co-expressed genes, the integration of such regulatory information can provide more reliable evidence to assemble putative groups of co-expressed genes. the comparison results in figures  <dig> and  <dig> demonstrated the performance improvements for the use of such acetylation information, and this also suggests that the histone acetylation information may be more highly correlated with the gene expression than that of functional similarity  <cit> .

since the integration of acetylation information gives relatively more accurate initial estimation for the missing values, it facilitates the selection of the neighbour genes based on euclidean distance and contributes to the knn. while lls method is more dependent on the correlation between experimental conditions, the improvement of lls is not as significant as knn. although the type of used histone acetylation  has no remarkable difference on the prediction accuracies, experimental results in additional file  <dig> suggested that the incorporation of the acetylation information improves the imputation performance, especially at higher missing percentages. therefore, it is recommended to use the acetylation information for the imputation when at higher missing percentages . actually, haiimpute methods can be generalized to other imputation methods such as bayesian principal component analysis or gaussian mixture clustering that need more complete genes  <cit> . comprehensive comparisons of different prediction methods are to be discussed in the future work.

even though haiimpute methods show good performances in our experiments, the algorithms also have some limitations. first, the histone acetylation information for many species or experimental conditions is not comprehensive, even for yeast, not all genes have available acetylation data, which limited the application of the methods. nevertheless, we think that the haiimpute methods introduced here open up a new angle to impute the gene expression from the gene regulatory mechanism itself. as for gene expression research, the eventual goal is to reveal the interior gene regulatory mechanisms rather than just predict the missing values themselves. therefore, from gene regulation, various kinds of regulation factors, e.g., transcriptional factor binding sites, transcriptional factors and other histone modification data, could all be used in a concurrent way as long as the information to be integrated is well established and powerful. second, we incorporate an iterative procedure to refine the imputation and it has higher computation cost than conventional knn and lls. in our experiments, the imputation for each dataset can be completed in no more than  <dig> seconds on a computer with  <dig>  ghz cpu and  <dig> mb ram using matlab. so we think the time cost is still acceptable in most cases. furthermore, for some non-time series datasets, actually, we can do the imputation without iteration to save time since the improvement of iteration is not very significant. third, although one burst model of missing values has been proposed in the paper to simulate the unequally distributed missing values, more proper alternatives to better describe the realistic distributions of missing values are increasingly needed.

CONCLUSIONS
we have proposed an imputation framework, which can take advantage of the acetylation information to facilitate the imputation. the theoretical basis is that the acetylation states in chromatin provide a mechanism to straightforward coordinate the regulation of co-expressed genes. therefore, the proposed methods repeatedly exploit the gene expression and the acetylation information in a combined way for the missing values imputation. experimental results confirmed that haiimpute methods consistently outperform the conventional knn, lls and goimpute methods in various datasets, especially at higher missing percentages. since the final imputations are still based on gene expressions, the idea can be generalized to various other imputation methods to facilitate the performance. moreover, with more knowledge accumulated on gene regulatory mechanism, e.g., the mrna decay, in addition to transcriptional factors and histone acetylation, the performance of our approach can be further improved and verified.

