BACKGROUND
host cells targeted for entry by hiv- <dig> express the cellular cd <dig> receptor as well as a secondary cellular chemokine co-receptor, principally either ccr <dig>  or cxcr <dig> , all of which interact with the hiv- <dig> envelope glycoprotein gp <dig>  natural ligands for these receptors include il- <dig> ; rantes, mip-1α, and mip-1β ; and sdf-1α   <cit> . prior to being recognized that successful viral entry necessarily requires that gp <dig> also binds a co-receptor subsequent to cd <dig> attachment, hiv- <dig> strains were typically classified as nonsyncytium - or syncytium -inducing based solely on their ability to induce syncytia in cell cultures, which correlates with viral preference for infecting monocyte-derived macrophages  or t-lymphocytes , respectively  <cit> . m-tropic strains of hiv- <dig> often use the r <dig> co-receptor while t-tropic strains use x4; however, there also exist dual- or mixed-tropic  strains capable of using both co-receptors  <cit> .

the significance of viral categorization based on co-receptor usage is underscored by the observation that while a majority of newly infected patients harbor only r5-utilizing hiv- <dig> strains, x <dig> variants appear in approximately 50% of patients during later stages of the disease accompanied by an accelerated decline in cd4+ t-lymphocytes and progression towards an aids diagnosis  <cit> . co-receptors r <dig> and x <dig> interact to a great extent with the third hypervariable loop  of the hiv- <dig> envelope glycoprotein gp <dig>  <cit> , a peptide fragment distant from the gp <dig> core and comprised of  <dig> amino acids with a disulfide bridge formed by cysteine residues at the n- and c-termini . this interaction suggests that accumulation of amino acid replacements at multiple positions within the v <dig> loop is responsible for the eventual switch in co-receptor affinity; however, there are competing arguments as to whether v <dig> loop structural changes drive co-receptor selectivity, or if one predominant conformation exists for both r <dig> and x <dig> variants and that sequence changes alone account for the switch in co-receptor usage  <cit> . evidence suggesting a dual contribution was provided by a study in which knowledge-based potentials were used to assess the fitness of variant v <dig> loop sequences on candidate structures generated by markov chain monte carlo techniques applied to nmr data  <cit> .

widespread clinical success through hiv- <dig> combination drug therapy, targeting essential proteins at distinct stages of the viral life cycle, is tempered by the emergence of patient viral strains that are resistant to one or more of these medications. hence the identification of healthy individuals, homozygous for a nonfunctional r <dig> due to a 32-base pair deletion and highly resistant to hiv- <dig> infection  <cit> , motivated the search for viable co-receptor antagonists to include among the current arsenal of treatments. the us food and drug administration recently approved the r <dig> inhibitor maraviroc  <cit>  for use in treatment-experienced individuals in combination with other medications, and a number of additional co-receptor antagonists are in various stages of development  <cit> . evaluation of viral co-receptor tropism in patients is essential prior to and during clinical administration of such antagonists so that only the appropriate co-receptor is targeted, and in vitro experimental assays are available; however, these phenotype tests are costly and time-consuming, and their results are not standardized  <cit> . given these drawbacks, accurate in silico models for predicting co-receptor tropism have generated considerable interest. the vast majority of these methods rely on patient hiv- <dig> gp <dig> v <dig> loop sequences easily obtained through relatively rapid and inexpensive genotype tests, which are predicted to be either strictly r5-tropic or x4-capable , since there are relatively far fewer sequences that strictly use x <dig>  for the sake of notational simplicity, the dm acronym is modified in the remainder of this manuscript to refer to x4-capable virus, yielding two co-receptor usage categories: r <dig> and dm.

the 11/ <dig> charge rule refers to the earliest and simplest predictive method reported  <cit> , identifying hiv- <dig> with an si phenotype based on the presence of positively charged residues at v <dig> loop positions  <dig> and/or  <dig> with good specificity though relatively poor sensitivity with respect to dm strains, the majority of which induce syncytia  <cit> . a second approach utilized a sequence based multiple linear regression and identified four positive predictors of hiv- <dig> co-receptor tropism: the number of positively  and negatively  charged v <dig> sequence residues, the v <dig> net charge , and the presence of i at gp <dig> position  <dig> outside of the v <dig> loop   <cit> . next, predictions of hiv- <dig> phenotype and co-receptor usage have been obtained through position-specific scoring matrix  techniques  <cit> . finally, several models have been developed recently based on a variety of supervised classification machine learning algorithms utilizing v <dig> sequence and/or structure descriptors. these algorithms have included neural network   <cit> , decision tree   <cit> , support vector machine   <cit> , and random forest   <cit> . the addition of structural attributes to the sequence features of v <dig> loop variants was shown to significantly improve classifier prediction performance  <cit> .

in this article, we describe a computational mutagenesis methodology for characterizing hiv- <dig> gp <dig> v <dig> loop variants that involves threading of sequence  information onto a reference structural template and relies on a four-body, knowledge-based potential . for each v <dig> loop mutational pattern, the approach yields both a scalar measure of overall change in sequence-structure compatibility relative to the native peptide, as well as a 35-dimensional vector representing environmental perturbations at all v <dig> loop residue positions caused by the amino acid replacements. in particular, we demonstrate that sequence-structure compatibility is more adversely affected among dm-tropic strains relative to r <dig> variants in a non-redundant dataset of  <dig> v <dig> loop sequences with known co-receptor tropism. additionally, with each sequence represented as a perturbation vector, the dataset is used for training a variety of machine learning algorithms. this novel approach utilizing both sequence and structure, as well as combining machine learning with an energy function-based mutagenesis for mutant representation, was previously applied to develop accurate models for predicting susceptibility to hiv- <dig> protease inhibitors  <cit> . the classifiers developed here are shown to outperform other published models for v <dig> loop-based prediction of co-receptor usage, especially with regard to the sensitivity of dm strain classification, suggesting that signals inherent in these vectors are more effective for discrimination between r <dig> and dm viral strains. these models are also well suited to provide instantaneous predictions and require only v <dig> loop sequences as input.

methods
dataset
a search of the hiv sequence database at los alamos national laboratory  generated a total of  <dig> hiv- <dig> gp <dig> v <dig> loop sequences with annotated co-receptor phenotypes obtained from treatment naïve and experienced patients , spanning all hiv- <dig> subtypes and based on data obtained from clinical trial studies in  <dig> countries over sampling years 1983- <dig>  upon translation and elimination of duplicate sequences, the final dataset contained  <dig> distinct 35-residue long v <dig> loop sequences, consisting of  <dig> strictly r5-utilizing variants and  <dig> dm variants. in order to be consistent with all other methods to which we compare our results, and due to the paucity of strictly x <dig> variants in the dataset, by convention the dm category here more generally consists of x4-capable sequences .

computational mutagenesis methodology
our in silico mutagenesis procedure relies on a four-body, knowledge-based, statistical contact potential, which provides an interaction empirical energy for each of the  <dig> permutation-free quadruplets of amino acids that can be enumerated using a standard 20-letter protein alphabet  <cit> . we generated the four-body potential by analyzing a diverse dataset of  <dig> high-resolution  crystallographic protein structures with low sequence identity , culled from the protein data bank   <cit>  using the pisces server  <cit> . the cα atomic coordinates of the constituent amino acid residues were used to render each protein structure as a discrete collection of points in 3-dimensional  space. delaunay tessellation, a classical computational geometry technique, was used to model each protein, whereby cα atoms served as vertices to generate a 3d convex hull formed by a tiling of non-overlapping, irregular, tetrahedral simplices  <cit> . hundreds of simplices are generated by the tessellation of an average sized protein, and the four vertices of each simplex objectively identify a quadruplet of nearest neighbor amino acid residues in the protein structure. for each of the  <dig> amino acid quadruplets , a relative frequency of occurrence fijkl was calculated based on the proportion of simplices among the  <dig> protein structure tessellations whose vertices represent the four residues, and a rate of quadruplet occurrence expected by chance pijkl was obtained from a multinomial reference distribution  <cit> . energy of quadruplet interaction, modeled after the inverse boltzmann principle, was calculated as log  <cit> .

next, delaunay tessellation was applied to a v <dig> loop structure  containing an r5-tropic sequence , which is currently the only available structure of the unliganded peptide  <cit> . using the four-body potential and tessellated v <dig> loop   <cit> , each of the constituent simplices was scored according to the interaction energy of the amino acid quadruplet represented by its vertices. a total of  <dig> tetrahedral simplices were generated by the v <dig> loop tessellation, where all six edges for  <dig> simplices have lengths less than 12Å, and the longest edge among the remaining  <dig> simplices measures  <dig> Å. the global sum of the  <dig> simplex scores, referred to as the v <dig> loop total potential or topological score, provides an overall sequence-structure compatibility measure for the native peptide  <cit> . for each v <dig> loop amino acid, an individual residue potential or residue environment score was calculated as the local sum of all simplices that share the cα atom of the amino acid as a vertex  <cit> , and an ordered representation of these scores by primary sequence position number as a 35-dimensional vector forms a 3d-1d potential profile   <cit> .

for each particular v <dig> loop mutational pattern, the new sequence of amino acid letters was threaded onto the native tessellated v <dig> loop template structure by relabeling each of the  <dig> cα vertices. while the tessellation remains unaffected, simplices with one or more relabeled vertices are recast with altered scores due to new residue quadruplet compositions, and recalculations yield a topological score and 3d-1d potential profile for the v <dig> loop variant. the difference between variant and native v <dig> loop topological scores, referred to as the variant residual score, measures relative change in overall sequence-structure compatibility due to the residue substitutions  <cit> . finally, the variant residual profile is defined as the difference between the variant and native v <dig> loop 3d-1d potential profiles and consists of component values measuring environmental perturbations at all v <dig> loop positions   <cit> . conformational changes in the protein structure are effectively taken into account with this computational mutagenesis methodology, both implicity, through the four-body potential and variant residual scores and profiles, and explicitly, due to the use of only coarse-grained cα representations of protein structures and the fact that delaunay tessellation is robust to small shifts in the cα coordinates  <cit> .

machine learning tools for prediction and evaluation of performance
the dataset of  <dig> hiv- <dig> gp <dig> v <dig> loop variants was used to train and compare the performance of four well-known supervised learning algorithms, random forest , support vector machine , boosted decision tree , and neural network , all available as part of the weka software package  <cit> . residual profiles were utilized as input feature vectors for characterizing v <dig> loop variants, and variant co-receptor tropism  represented the output attribute for the classifiers. non-default values of the adjustable parameters used in the implementation of these algorithms include: one hundred bootstrapped datasets  for rf; radial basis function  kernel with γ =  <dig> , neither normalization nor standardization of the training data, and logistic models fit to the outputs for svm;  <dig> boosted iterations using the adaboost m <dig> method for bdt; and no attribute normalization for nn.

algorithm performance on the dataset was evaluated by using stratified 10-fold cross-validation , leave-one-out cross-validation , and stratified random split  testing procedures. prediction results reported with 10-fold cv and 66/ <dig> split are based on averages over ten independent iterations.

assuming p  refers to the dm class and n  refers to the r <dig> class, acc = accuracy = / provides a simple measure of the overall prediction success rate. here, tp and tn represent the number of correct dm and r <dig> predictions, respectively, and fp and fn are misclassifications. the balanced error  and balanced accuracy  rates, calculated as ber =  <dig>  ×  and bar =  <dig> - ber, matthew's correlation coefficient , given by

 mcc=tp×tn-fp×fn, 

and area  under the receiver operating characteristic  curve provide additional measures of classifier performance that are especially useful for unbalanced class distributions. the roc curve is a plot of the true positive rate  versus the false positive rate , where sensitivity = se = tp/ and specificity = sp = tn/. an auc value near  <dig>  is indicative of random guessing while a value of  <dig>  denotes a perfect classifier. finally, positive predictive value or precision is defined as ppv = tp/.

RESULTS
variant v <dig> loop dataset sequence analysis
for each co-receptor usage class, variant hiv- <dig> gp <dig> v <dig> loop sequences were aligned and sequence logos  <cit>  were generated to visualize relative amino acid frequencies at each position and to identify highly conserved positions . similarities  and differences  are clearly evident between both logos. additionally, histograms were produced for each co-receptor class based on the number of amino acid substitutions in the variant v <dig> loop sequences relative to the native sequence of the tessellated structure . the average number of v <dig> loop residue replacements was calculated as  <dig>  ±  <dig>  for the r <dig> class and  <dig>  ±  <dig>  for the dm class, and a t-test revealed a statistically significant difference between class mutation averages . these data suggest that a greater accumulation of mutations is associated with a switch in co-receptor affinity, which may be due to either v <dig> loop conformational changes or stochastic accumulation of minor mutations prior to co-receptor switch substitutions at sequence positions 11/ <dig> 

based on an analysis of variant v <dig> loop changes in sequence-structure compatibility relative to the native peptide , stark differences also exist between the r <dig> and dm co-receptor classes. the mean residual score was calculated to be  <dig>  for the  <dig> v <dig> loop variants comprising the r <dig> class and - <dig>  for the  <dig> dm-tropic variants, and a t-test revealed a statistically significant difference between class mean residual scores . these results strongly suggest that the continual accumulation of mutations in the dm class is ultimately detrimental to v <dig> loop sequence-structure compatibility.

finally, with each v <dig> loop variant represented by its respective 35-dimensional residual profile vector of environmental perturbation scores, an unsupervised clustering of the variants was performed using the expectation-maximization  algorithm available with the weka software package  <cit> . for each variant, the em algorithm calculates probabilities of membership in each of the available clusters, and the algorithm uses a cross-validation procedure to automatically determine the number of clusters. a total of  <dig> clusters were generated, each labeled as either r <dig> or dm based on majority class size . cluster purity, defined as

 purity=∑jnjn maxi{precision} 

where precision  refers to the relative frequency of class i in cluster j, nj is the number of sequences in cluster j, and n =  <dig> is the dataset size, is  <dig> %. the clustering can be associated with a guiding tree that reflects the distances between v <dig> loops in a sequence space and likely corresponds to the evolutionary history of the virus. thus, given a training set of v <dig> sequences collected from the same set of patients at multiple time points, starting from early stages of infection, it would be possible to build a model to correlate v <dig> sequence position in a tree and likelihood of a switch in co-receptor usage.

predictive performance of variant v <dig> loop residual profiles
four supervised classification algorithms  were utilized for assessing predictive performance of the environmental perturbation descriptors encoded by the variant v <dig> loop residual profile vectors, and results were reported based on application of 10-fold cv, loocv, and 66/ <dig> split testing procedures . the testing methods and algorithms all generated relatively consistent results with the exception of slightly lower values based on nn. in order to highlight the strength of signals embedded in the variant v <dig> loop residual profiles for accurately discriminating between r5-utilizing and dm  sequences, we compared the loocv results of table  <dig> using the original dataset with those obtained using a control dataset generated by a randomly shuffling of the r <dig> and dm class labels among the v <dig> loop variants so that the class sizes are unaltered. striking auc reductions to levels near  <dig>  were observed using the control dataset , suggesting that models developed with the control are not likely to perform better than random guessing, a conclusion further supported by mcc and ber measures: rf , svm , bdt , and nn . for a more systematic approach to assessing the statistical significance of our results in table  <dig>  we generated  <dig>  class label permutations  and calculated 10-fold cv performance in each case based on the svm algorithm. the distributions of mcc and bar accuracy measurements  are narrowly centered around zero and  <dig> , respectively , with no permutation accuracy approaching those obtained using the original arrangement of the class labels , so that the p-value for predictive power is less than  <dig> . results nearly identical to these were also obtained using the rf , bdt , and nn  algorithms, whereby 10-fold cv was applied to each of  <dig>  new random class label shuffles generated for each of the three methods, and these data can be compared to the 10-fold cv performance for each of the algorithms based on the original class label arrangement as provided in table  <dig> 

sander et al. 
prosperi et al. 
prosperi et al. 
sing et al. 
xu et al. 
pillai et al. 
resch et al. 
a average over  <dig> iterations; bsingle split - use of duplicates inflates performance; caverage over  <dig> iterations

our sequence-structure approach, combining machine learning with an energy-based computational mutagenesis for generating variant v <dig> loop sequence feature vectors, outperformed the structure-based approach of sander et al.  <cit>  and the sequence-based approaches of prosperi et al.  <cit> , sing et al.  <cit> , xu et al.  <cit> , pillai et al.  <cit> , and resch et al.  <cit>  . these studies all obtained datasets from the los alamos hiv sequence database in an approach similar to the one outlined in this manuscript. sander et al. and sing et al. utilized the svm algorithm along with a 10-fold cv testing procedure, prosperi et al. used the rf and svm algorithms with 10-fold cv, and the results of all three groups reflect an average over ten iterations. xu et al. applied the rf algorithm with only a single 56/ <dig> random split testing approach; moreover, the full dataset contained an abundance of duplicates that were not removed prior to the split. while duplicates within the test set were subsequently removed prior to evaluating performance, duplicates between the training and test sets were not addressed, which would artificially inflate the reported performance. pillai et al. utilized the svm algorithm and averaged the results over  <dig> iterations of 10-fold cv. lastly, resch et al. implemented an nn algorithm and reported results based on  <dig> iterations of 50/ <dig> random splits.

the practical value of these models is measured by their ability to reliably predict co-receptor usage classes for v <dig> sequences not appearing in the training dataset, therefore constituting an independent test set. yet obtaining and annotating additional testing samples in a timely way is often not feasible. alternatively, stratified random split of an annotated dataset of distinct v <dig> sequences into one subset for training and another for testing, such as those two-subset splits whose results are reported in table  <dig>  accurately reflect the performance expected by trained models on independent test sets. in a recent study, low et al.  <cit>  evaluated six algorithms with a test set of  <dig> v <dig> sequences whose co-receptor usage annotations are not available in the public databases. they reported se values in the  <dig>  -  <dig>  range, discounting utility of the models. however, these difficulties were likely encountered because over 50% of test sequences have ambiguous amino acids. low et al.  <cit>  subsequently proposed that reliable models should achieve se ≥  <dig>  on test sets, a level equivalent to the concordance of co-receptor phenotype assays. though our svm model does achieve this threshold, the overall methodology suffers from an important drawback that limits its applicability: all v <dig> sequences, which may be either from majority or minority hiv- <dig> viral species, must consist of exactly  <dig> amino acids  that are selected from the standard 20-letter protein alphabet, without ambiguities.

the pdb structure 1ce <dig> was determined using nmr techniques and consists of  <dig> models, with model  <dig> representing the best conformer . in order to assess the impact of the conformation on the results, we repeated our analysis by generating an analogous training set based on the use of model  <dig> and obtaining 10-fold cv performance values. the vast majority of the values obtained using both conformations were within two percentage points of each other, suggesting consistency across all conformers . in particular, se measures are identical using both models in the case of rf as well as svm, while for bdt and nn they differ by one  and two  percentage points, respectively. additionally, we evaluated contribution of structure information to performance by representing v <dig> loop sequences in the training set simply based on 4-mer consecutive string clusters. a sliding window of size four over the 35-residue v <dig> sequence generates  <dig> such overlapping 4-mer clusters, each of which is represented as a 20-dimensional vector of amino acid counts, and they are appended to form a 640-dimensional vector for each v <dig> sequence. this sequence-based training set yielded se values in the  <dig>  -  <dig>  range , and a paired t-test using this data confirmed a statistically significant improvement in performance due to the structural component .

next, learning curves were plotted in order to assess the influence of dataset size on performance, using the rf algorithm as an example . we generated ten stratified random samples each consisting of  <dig> variant v <dig> sequences, where each sample was selected from among the full dataset of  <dig> sequences, and mean 10-fold cv performance measures were calculated. subsequent iterations involved incrementing by  <dig> mutants the sizes of the ten sampled datasets. the curves clearly reflect that the availability of larger datasets for training leads to significant improvements in rf algorithm performance. with the current dataset size, the learning curves have not reached plateaus, which suggests that additional sequences will further improve performance. this increase in performance may be due to overcoming implicit confounding effects of clade and phylogenetic relatedness that may currently exist in the dataset.

finally, we attempted to rank the relative importance of the variant v <dig> loop feature vector components  based on their respective contributions to prediction performance. an svm classifier was used to rank the attributes by the square of the weights assigned by the svm, based on the results of a 10-fold cv attribute selection mode. the top ten positions are highlighted by red arrows in fig.  <dig> and include positions  <dig> and  <dig> 

CONCLUSIONS
variant v <dig> loop feature vectors generated by the combined sequence-structure in silico mutagenesis methodology described in this manuscript have been shown to encode signals that robustly discriminate between the r <dig> and dm classes, yielding universally reliable predictive models based on a variety of supervised classification machine learning algorithms. simplicity is a key ingredient to our approach that takes only variant v <dig> sequence as input and provides instantaneous predictions, whereas the technique of sander et al.  <cit>  involves the modeling of mutant structures, which is expensive, cumbersome, and cannot be completely automated. on the other hand, our methodology is restricted to only 35-residue v <dig> sequences and cannot accommodate indels or non-standard amino acids, which the sander et al. method is capable of processing. our models display a modest yet vital improvement in se values relative to other published methods. for the svm classifier in particular, se reaches the critical reliability threshold of  <dig>  ascertained by low et al.  <cit> ; hence, within the limitations imposed by our approach, this svm model is capable of correctly determining hiv- <dig> co-receptor tropism in a timely, inexpensive manner relative to phenotype assays.

authors' contributions
iv conceived of the project and supervised the work. mm collected the v <dig> sequences, generated the dataset, trained the models, performed the statistical analyses, and wrote the first draft of the manuscript. iv and mm participated in editing the text and approved the final manuscript.

