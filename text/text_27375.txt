BACKGROUND
gene regulatory networks  play a fundamental role in body plan formation and development  <cit> . in most cases the published gene regulatory networks are based on experimental studies. furthermore, various studies reveal that network dynamics depend on qualitative aspects  as well as the quantitative properties  <cit> . an additional option is to study gene regulatory networks in mathematical models and simulation studies. qualitative and quantitative models may provide insights in the causal relationships between components of a network as well as the mechanisms behind the network dynamics  <cit> . qualitative models mainly focus on the inference of the wiring diagram and the understanding of the connection between the dynamics of the systems and the network structure  <cit> . understanding how the gene regulation leads to pattern formation requires the usage of quantitative models that allows inferring the network structure, but also simulating the spatio-temporal gene expression dynamics  <cit> . many approaches have been used to model gene regulatory networks . in modelling processes from developmental biology especially the class of quantitative spatio-temporal, models of gene regulation is relevant. these type of models can potentially be linked with three-dimensional biomechanical models of morphogenesis and provide new insights into developmental biology.

although there is a large variety of formalisms used to describe quantitative model of grn, the most commonly used is based on differential equations. this deterministic modelling framework allows describing spatio-temporal continuous system, where protein products are continuously produced through the balance of activation or repression. models can be used in reverse engineering studies to infer the network structure and dynamics of the system. quantitative spatio-temporal models of gene regulation are typically characterized by a large set of unknown parameters. without a suitable method for reverse engineering the network and estimating the unknown parameter values these models have no practical use. because of incomplete data, imprecise information concerning the interaction mechanisms and the large set of unknown parameter values; reverse engineering of the gene regulatory network is by far a straightforward task  <cit> .

reverse engineering of grn capable of simulating spatio-temporal gene expression mainly consists in revealing the grn structure that leads to the observed pattern. optimization is therefore important  <cit>  and it is used to infer a gene network whether it is transcriptional or protein interaction. a system identification approach is used to select a model structure and by means of parameter estimation, the network topology is estimated from experimental data. the optimization problem consists in minimizing the difference between simulated expression profiles and available data in order to estimate the best circuit that predicts with very good accuracy the spatio-temporal gene expression. based on the resulting parameter-set, the network diagram is extracted and one tries to establish causal-relation of the dynamic mechanism that governs the pattern formation, using further analysis. the prediction is clearly linked to the quality and amount of the data; even with sufficient data, it is not guaranteed that the inferred network corresponds to the appropriate gene network that leads to the observed pattern  <cit> . from a theoretical point of view, this question is a matter of the structural identifiability of the model  <cit> . given a data set, is it possible to uniquely infer the network? although there exist some theoretical methods  <cit>  to investigate the identifiably before inferring the network, when confronted with a complex mechanism characterized by a multi-dimensional parameters space, the feasibility is still analytically complex. in many situations, one is confronted with an overfitting problem that leads to parameter-set with very different quantitative values and even worse, yielding different network topologies having similar good realistic patterns.

to draw conclusions, one has to differentiate between circuits that are more likely to be biologically realistic.

it was shown that for certain experimental data that it is not possible to confirm whether the inferred model is really valid  <cit> . as long as the model is not contradicted by the given data, it is necessary to extend the validation test further. especially when the model does not only predict a unique network, parameter-set discrimination can be addressed using diverse models validation approaches. the quality of the circuits can for example be quantified by measuring the parameter reliability and sensitivity, the uniqueness of the predicted network, the model robustness and the predictability of the model. in this paper we focus on the model robustness against perturbation. in another paper  we focus on the other aspects that can be used to quantify the quality of the circuits: methods for exploring the solution space, parameter correlation and asymptotical stability analysis.

by analyzing the robustness of the inferred network, we can test the quality of the circuits. the term robustness has various meanings, but in the current study, robustness is addressed as the ability of a system to maintain its mechanical and dynamical behaviour under perturbation. from a biological view, robustness is related to stability, homeostasis, canalization, redundancy, and plasticity  <cit> , and can also be applied to dynamical process in development  <cit> . in simulations of dynamical developmental processes such as pattern formation, one should also expect robust behaviour within a certain extent in the model  <cit> . in the current paper, model robustness is addressed in two different perspectives. first, we investigate the quantitative robustness of the model towards internal fluctuations in expression level. it is known that presence of noise in gene regulation can lead to phenotype variation  <cit> . there are some studies on the robustness of grns under the influence of molecular fluctuation  <cit>  and show the importance of noise and stochastic events  <cit> . in most cases, deterministic models are used to infer grns from noisy data. it has been shown in several studies that the robustness to noise mainly depends on the network structure instead of the parameter setting  <cit> . therefore, one way to discriminate between circuits having different gene network but exhibiting the same pattern is to analyze their behaviour under noisy conditions. model-solutions showing more robustness or stability can be considered for further analysis. second through simple parameter perturbation, we investigate how model-circuits behave distinctly. this analysis allows us to identify the parameters that have the most significant influence on the model and to distinguish circuits that are less sensitive to overall perturbation. the combination of these two analyses allows one to discriminate between sets of circuits that are more robust, although they are obtained from the same model description and quantitative data.

reverse-engineering the gap gene network
in the current paper, the case study early development along the anteroposterior  of gap gene network of the drosophila melanogaster is considered. in the gene regulatory network responsible for segmentation of the drosophila melanogaster embryo  <cit>  for most, if not all genes involved, experimental and bioinformatics studies are available. these studies not only give information about potential interactions between the different genes, but also provide spatio-temporal information about the gene expression patterns in the embryo. the segmentation genes leading to pattern formation, which occurs during the first stages of development after fertilization is controlled by a network of genetic interactions, with a cascade like modularity  <cit> . at the early stage, the maternal mrna, located at the extremes of the egg will define the anterior-posterior axis of the embryo. following fertilization, the process begins with the diffusion of maternal morphogen factors: bicoid , nanos , caudal  and maternal hunchback , and the activation of the torso receptor on the poles. at cycle  <dig> , the gradient of these maternal gene products in the embryo promotes the transcription of the first zygotic genes during cycle 14: zygotic hb, giant , krüppel , knirps  and tailless ; each forming expression domains in specific regions of the embryo  <cit> . this set of genes; the so-called gap genes-are defined in broad domains along the anterior-posterior axis. their transcription factors regulate the expression of another group of zygotic genes that comprises seven pair-rule genes, which form a pattern of narrow stripes along the anterior-posterior axis. finally, the pair rule genes regulate the formation of fourteen stripes by segment polarity genes. for review about the detailed mechanism, see  <cit> .

for modelling the segmentation mechanism of the early drosophila melanogaster embryo, two main formalisms have been proposed: logical formalism  proposed by sánchez and thieffry  <cit> , and continuous models proposed by mjolsness et al.  <cit>  used to obtain quantitative dynamics of a system. following this formalism, reinitz and co-workers formulated the problem as an inverse problem  <cit> . given a complete mathematical model and sufficient accurate quantitative data, the parameters in the model can be estimated by optimization techniques, i.e., by fitting the model to the data. except for box constraints, only little experimental information is used to constrain the parameter values in the model. this inverse modelling formulation of the problem leads to different gene circuits describing different aspect of the segmentation gene mechanism  <cit> .

using the gene circuit method proposed by reinitz et al  <cit> , jaeger et al.  <cit>  have inferred a network by means of reverse engineering that can reproduce the measured spatial and temporal gene expression patterns. the gap gene model involves seven different genes, bcd, cad, hb, gt, kr, kni and tll. the experimental data used to fit the model were obtained from the flyex database, where an extensive amount of accurate quantified spatio-temporal expression data for all genes is stored  <cit> . a connectionist description was used to model the gene regulatory network. the number of parameters in this framework mounts up to  <dig> different unknowns for a network of six genes. to estimate these parameters the model was fitted to detailed spatio-temporal data using parallel simulated annealing   <cit> , which is a technique that performs a global parameter search. ten different gene circuits were obtained using this reverse engineering approach. compared to the variance in the experimental data, all solutions fitted the dataset spatially and temporally accurately. furthermore, the model reproduced the experimentally observed dynamic shift of the expression profiles and it was shown that diffusion is not the cause of the shift. compared with experimental knowledge, for most interactions in the gene regulatory network the sign, i.e. activation, repression or no-interaction was reasonably well reproduced. analysis of the  <dig> circuits suggested asymmetric repression between the gap genes, which was hypothesized to be the cause of the observed domain shift. this result has also been obtained by perkins et al.  <cit>  where parameter estimation was performed using a three-step strategy. following  <cit> , fomekong-nanfack et al.  <cit>  employed a different optimization technique to find parameter sets that accurately fitted the experimental dataset and lead to the similar networks as proposed by jaeger et al.  <cit> . in search for a computational more efficient method, they developed a hybrid optimization algorithm  <cit> . typically this approach first performs a global search based on evolutionary strategy followed by a local search. with this method, another  <dig> circuits were obtained that fitted the experimental dataset accurately. recently, ashyraliyev et al.  <cit>  showed that the circuits obtained by fomekong-nanfack et al. can be further improved using levenberg-maquardt.

the gene circuit method previously used  <cit>  does not make any assumption about the network structure. all gene-to-gene interactions are assumed to be plausible and minimizing the difference between observation and simulation drives the inference. the criterion for selecting acceptable circuits was based on a low root mean square error  and visual inspection of the simulated gene expression profiles . in the current case, a large set of circuits can be used to simulate the a-p patterning of the drosophila melanogater. using a local sensitivity analysis, determinability of some parameters were studied in  <cit> , where it was suggested that one could confirm on the nature of some biological interactions for parameters that were shown to be identifiable. using a large set of parameters as base value, it is possible to examine the robustness of the model. zak et al.  <cit>  showed how input perturbations and stochastic gene expression influence the identifiability of a specific regulatory network given gene expression profiles and prior structural knowledge. using as starting point the parameters-set obtained in  <cit>  as base value, we discuss how does input perturbation and stochastic simulation allow a model-based robustness analysis of a model that leads to multiple circuits.

RESULTS
gap gene circuits
the analysis is based on  <dig> circuits each characterized by  <dig> parameters obtained from  <cit>  using different optimization techniques. all circuits with a rms value smaller than  <dig>  were labeled as good fits and were selected for further analysis. in fig.  <dig>  the simulated expression patterns at gastrulation time are shown. the profiles  and the average profile  for each gene are shown together with the real data . all circuits reproduce the gene expression patterns without any major defects . although the profiles are well defined, the circuit-parameters show a rather different picture. in fig.  <dig>  the distribution of the  <dig> parameters is shown. the grey line represents the different  <dig> values of each circuits and the blue line their average. from this figure, we see that the distributions vary from parameter to parameter. none of the non-regulatory parameters such as the production rate, the diffusion coefficient or the decay time constant seems to be very consistent from circuit to circuit. in many cases, the promoter rate and the diffusion hit the upper boundary. many parameters show a strong tendency to cluster at a specific value or location . in some cases, we see a very broad distribution around the mean, especially for the parameters describing strong repression. in other cases regulatory parameters show both positive and negative interactions , representing different network topologies.

robustness towards fluctuations
gene transcription, degradation and diffusion inherently are stochastic processes, which lead to fluctuations in gene expression levels. if expression levels are high, these fluctuations generally do not affect the time evolution of the system. in these cases the deterministic model and stochastic model will yield a similar result. however if the system is non-linear and the fluctuations occur at an early time in development, where levels are still low, fluctuations may lead to different patterns. from a biological point of view this may not be favorable because gene pattern defects can lead to aberrations in development, hence development should be robust towards modest transient disturbances  <cit> . here we investigate if the circuits obtained from the optimization, which are based on a deterministic model, are robust towards fluctuations.

analysis of fluctuations in the bicoid gradient  <cit>  suggests that the expression level of bicoid is about five fold higher than the fluorescence unit. in our analysis we assume that the expression level of all genes is five fold higher than the fluorescence unit. we have used the gillespie algorithm  <cit>  to introduce fluctuations in the gene expression levels.

for each circuit we performed  <dig> stochastic simulations  and analyzed the quality of the final expression pattern at t =  <dig>  min. in each run, by comparing the deterministic model with the stochastic model using a rms cut-off criterion, we counted how many of domains cad, hb-anterior , hb-posterior , kr, gt-anterior , gt-posterior , kni and tll were considered to be correct. for each circuit we also calculated an overall score by counting the runs where all expression domains formed correctly . on average the domains cad  and hb-anterior  show the best scores. the domains of kni , kr  and gt-posterior  have an intermediate score. the domains gt-anterior , hb-posterior  and particularly tll  have a low score. most circuits have a very low overall score; only the top 25% of the circuits have an overall score higher than 35%. most of the circuits have a score lower than 20%.

if all domains except one develop correctly the overall score is determined by that domain score, however if two or more independent domains have scores lower than 100%, the overall score will be lower than the individual domain scores. for example, if all domains would have a score of 99% and are independent the overall score would be  <dig>  * 100% = 92%. however we also observe interactions between domains, which leads to a higher overall score than would be expected if they behave independently. in these cases, if one domain yields a low score for a particular run, it is likely that another domain also yields a lower score for the same run. this is typically observed between adjacent domains. notable examples are kr with anterior gt, anterior hb with anterior gt, kni with posterior gt, and posterior gt with posterior hb and tll.

in fig.  <dig> the patterns of eight different circuits are shown. in these graphs the dashed lines represent the final profiles obtained from the deterministic model and the solid lines the average profiles obtained from the stochastic simulations calculated from the individual stochastic runs, which are shown in grey, . in fig.  <dig> the time-evolution of the expression level of different gene combinations at a particular nucleus position are shown for the same circuits as in fig.  <dig>  for comparison, the deterministic model is plotted using a solid red line and all stochastic runs  using light coloured lines. at the end of these lines a dot is shown, which represents the final concentration at t =  <dig>  min. the end points were used to extract two clusters , which are represented by the blue and green colour.

in fig. 3a, b the final pattern formed during the stochastic simulations are shown for circuit  <dig> and  <dig>  circuit  <dig> has an overall pattern score of 62% and nr  <dig> has an overall score of 34%. in circuit nr  <dig> all domains except kr  and anterior gt  score 100%. kr and anterior gt show a strong interaction, if anterior gt disappears then kr expands into the anterior gt domain. in circuit  <dig> this interaction between kr and gt at the anterior of the embryo is not present. in this circuit especially tll is not well defined. fig. 4a-b shows the trajectory of kr and gt at nucleus  <dig>  for circuit  <dig> in almost all runs gt and kr develop correctly, however in circuit  <dig> there are two possible outcomes of the stochastic run. here gt and kr can develop correctly, however gt may also disappear and completely repressed by kr. in this circuit there are two pathways for the system to evolve, which may lead to two stable points or a single stable point but two pathways. jaeger et al.  <cit>  suggested that non-overlapping gap gene are mutually exclusive and have mutual repression. this result was confirmed for gt and kr by ashyraliyev et al.  <cit> . circuit  <dig> and  <dig> both show this strong mutual repression but we believe that the bad stochastic score of anterior gt and kr might be caused by the weak repression of gt by tll.

in fig. 3c, d the final pattern formed during the stochastic simulations are shown for circuit  <dig> and  <dig>  both circuits have a very low overall score of 12% and 0% respectively. in circuit  <dig>  a very low score for hb-p, gt-p and tll mainly causes this and for circuit  <dig> all domains except cad are not well defined. in fig. 4c, d the trajectories at nucleus  <dig> of hb and gt are shown. for circuit  <dig> the pathway is well defined, in most runs both gt and hb evolve similar to the deterministic model. however in circuit  <dig> the pathways are not well defined at all and show variability. in circuit  <dig>  we see that hb represses gt while gt weakly activates hb, and inversely for circuit  <dig>  it is suggested that overlapping gap genes do not activate each other  <cit> . the poor robustness of these  <dig> circuits is therefore a consequence of the wrong connectivity of these  <dig> interactions.

in fig. 3e, f the final pattern formed during the stochastic simulations are shown for circuit  <dig> and  <dig>  circuit  <dig> has a very low score of 10% and circuit  <dig> a score of 40%. although circuit  <dig> has a low overall score both the kni and posterior gt domain score 100%, circuit  <dig> has a lower score for these domains. in fig. 4e, f the trajectories are shown for kni and gt at nucleus  <dig>  in circuit  <dig> the final points of the stochastic runs are very close to the final point of the deterministic run. although the final points are well defined, the pathway, which is a shift of both domains, to these points is quite variable. in circuit  <dig> the same phenomenon is observed, only here kni in some cases completely suppresses gt. both circuits show gt activation by kni , which seems to be a wrong interaction  <cit> . circuit  <dig> shows repression of hb by gt and weak activation of gt by hb while circuit  <dig> shows the inverse mechanism. based on the identifiability analysis obtained by ashyraliyev et al.  <cit> , it is suggested that gt does not repress hb and hb does not regulate gt. however, the determinability of these parameters has a very poor confidence and qualitative conclusion on these interactions is still ambiguous.

in fig. 3g, h the final pattern formed during the stochastic simulations are shown for circuit  <dig> and  <dig>  circuit  <dig> has an overall score of 50% and circuit  <dig> has a very low score of 2%. in circuit  <dig> all domains except kr and anterior gt are well defined. in circuit  <dig> all domains except cad are not well defined. in fig. 4g, h the trajectory of hb and tll at nucleus  <dig> are shown. in circuit  <dig> most final points are very close to the deterministic model, however in circuit  <dig> almost all points are far away from the deterministic model. in this circuit tll domain is repressed by hb and completely disappears and the hb domain continuous to grow. in some runs in circuit  <dig>  we see the same tendency of continuous tll repression combined wit hb increase. circuit  <dig> shows very inconsistent regulatory mechanism with respect to available literature  <cit> . gt and hb show mutual activation, and kni activates kr. these interactions seem to be the wrong regulatory mechanism, leading to stochastic instability and a very low pattern score.

correlation between robustness and parameters
in fig.  <dig> the correlation between the eight different expression domains scores and all parameters are shown. the correlation pattern reveals that circuits with higher promoter rates, diffusion coefficients and higher degradation rates are more robust towards fluctuations. this suggests that higher rates tend to increase robustness of the circuits. except for  all maternal inputs correlate negatively with pattern robustness. this suggests that strong maternal inputs tend to reduce the robustness of the circuit. all negative inputs on cad show a positive correlation, which suggests that strong cad input weights tend to reduce robustness. furthermore, the inputs of cad on all genes except tll show a strong negative correlation, hence strong weights reduce robustness .

robustness towards parameter perturbation
if a parameter in one of the circuits  is perturbed by a certain amount the formation of the gene expression pattern  will be perturbed as well. the amount by which a parameter can be increased and decreased before a certain pattern error  is reached can be used as a measure for pattern sensitivity with respect to that parameter. in order to get a better understanding of the model's sensitivity, for each circuit and each parameter in that circuit the sensitivity interval  was calculated . from a biological point view pattern formation should be robust towards small perturbations in the parameters  <cit> .

in fig. 6c si versus parameter value for dgt,  and  are plotted. for most circuits the lower value for the diffusion coefficient reaches the value zero, hence the lower bound of si is equal to the parameter value, meaning that without diffusion the pattern still forms correctly. this phenomenon is also observed for all other diffusion coefficients. furthermore, the upper bound of si does not scale with the parameter value; hence circuits with very similar diffusion coefficients can have very different sis. non-scaling behavior is observed for most parameters, another example is  shown in fig. 6b. for this parameter, both the upper and lower bound do not scale with parameter value, also here we observe that circuits with very similar parameter values can have very different sis; this was observed for most parameters. for some parameters the si does however scale with parameter value. for example all decay time constants show scaling, but also some weights. fig. 6a shows the plot of , here both the upper and lower bound of the si decreases with smaller absolute parameter values. hence the circuits become more sensitive towards perturbations when the parameter is smaller in magnitude .

in fig.  <dig> the correlation matrix, calculated on the basis of the sis is shown. the correlation pattern shows blocks on the diagonal, where circuit parameters that regulate one particular gene tend to cluster together. for example, in the case of cad, if in a particular circuit a parameter that regulates cad has a large si, it is likely that the other parameters that regulate cad also have a larger si. this suggests that sensitivity appears to behave in a modular fashion, where the genes represent modules. one exception is kr and gt, which both are found in the same cluster, suggesting these two genes have a strong correlation. this correlation is caused by their strong mutual repression  <cit> , forcing them to act in similar way to perturbation.

circuit sensitivity
to investigate which parameters and which circuits are more sensitive than others we have calculated the average sensitivity on a logarithmic scale for each parameter and each circuit . then the si of each parameter value in each circuit was plotted using an intensity plot, where the colour corresponds to:-log si. the parameters and circuits were ordered in fig.  <dig> according to their average sensitivity, showing the parameters with smallest si and most sensitive circuit at the top right corner. from fig.  <dig> it can be seen that the difference between the smallest and largest sis are  <dig> log units. the circuits are less sensitive with respect to diffusion coefficients, promoter rates, decay time constants and promoter threshold. circuits are most sensitive with respect to  weights followed by the auto-regulation weights . because the different parameter types  are not on the same scale we also calculated the average relative sensitivities of the circuit parameters . this approach can however be problematic, if the parameter values are close to zero, possibly yielding a very high relative sensitivity. therefore these outliers were removed from the analysis. using this measure, the least sensitive parameters are the diffusion coefficients with a relative sensitivity of about 100-200%. the thresholds are now more comparable with the weights and have a relative sensitivity of about 1%. furthermore the  weights are still amongst the most sensitive parameters with a relative sensitivity of about  <dig> -1%. from fig.  <dig> we see that the average sensitivity of the circuits varies from one to another. certain parameters in the least sensitive circuits, notably weights related to tll and cad tend to have lower sensitivities. by comparing the least sensitive circuits with the more sensitive circuits using a t-test several parameters where found that are significantly different in these groups. these are in fact the parameters that show scaling between sensitivity and parameter value , , , , , ,  and .

the standard deviation of the circuit parameters can be quite large compared to the average parameter value shown in fig.  <dig>  and furthermore, average parameter value and standard deviation strongly correlate . in fig.  <dig> the average -log sis versus standard deviation is plotted. amongst similar parameter types  no correlation is observed between si and standard deviation. this suggests that if a parameter is very variable across the circuits, i.e. it is not well-defined  <cit> , it is not necessary less sensitive. a notable example is  and , which both have a similar standard deviation but differ in sensitivity by  <dig> log units. furthermore, we also observe that the standard deviation on average is much higher than the sensitivity interval.

model sensitivity vs. pattern robustness
in fig.  <dig> we have plotted the average sensitivity versus the overall score of the circuit. in this figure the circuits with promoter threshold hhb,kr,gt,kni = - <dig>  are shown in blue and the circuits with hhb,kr,gt,kni = - <dig>  in red. the circuits with an average sensitivity higher than  <dig>  are significantly less robust towards fluctuations than the circuits with an average sensitivity lower than  <dig> . the circuits with h = - <dig>  are more sensitive than the circuits with h = - <dig> . furthermore the robust circuits have a better overall pattern score on average; however lower sensitivity does not necessarily yield a good pattern score. this suggests that the average sensitivity is not the only determinant for robustness towards fluctuations. in fig.  <dig> of additional file  <dig>  the correlations between parameter sis and stochastic simulation of individual gene domain robustness is shown separately for circuits with promoter threshold h = - <dig>  and h = - <dig> .

discussion
the  <dig> gap gene circuits were previously obtained with inverse modelling  <cit>  of a seven gene  connectionist model using detailed spatio-temporal gene expression data  <cit> . all circuits were selected only on the basis of a low rms value , and in all cases the circuits were able to reproduce the dynamics and the patterns accurately. however, the parameter values of the circuits appeared not to be well defined, for some parameters multiple clusters were found, which represented multiple circuit topologies. furthermore many parameters showed a single cluster with a high degree of scattering around the mean as shown in fig.  <dig>  before any further tests, this result insinuates that for some parameters such as the non-regulatory parameters , the notion of a global optimal parameter set makes no biological sense as suggest by von dassow et al.  <cit> . also, the scatterings of most of the regulatory parameters are almost in a precise region of the search space, describing a precise qualitative behavior that can be linked to a potential interaction . the model always performs well and leads to very good pattern suggesting that the model is robust to the network topology as well as variation in individual parameters. robustness to network topology is a behavior already observed by von dassow et al.  <cit>  in the case of the segment polarity of drosophila melanogaster.

to further analyze the properties of the model and to classify the quality of the circuits we conducted a perturbation analysis. we analyzed the robustness of  <dig> drosophila melanogaster gap gene circuits using two different approaches, first the robustness of pattern formation towards intrinsic fluctuations in gene expression levels was investigated using a stochastic model and secondly the sensitivity of the circuits with respect to the parameters in the model was investigated using a simple parameter perturbation technique.

robustness towards fluctuations
robustness of the regulatory network is expected to be a fundamental property of the network, pattern formation should therefore not be compromised by small intrinsic fluctuations in gene expression levels. therefore, the patterns obtained from stochastic simulations should statistically be similar to the pattern obtained from the deterministic simulation for robust circuits.

robustness of domain formation
introducing fluctuations in the model had a profound effect on the formation of the expression patterns. although some of the circuits showed robust formation for most domains, none of the circuits were sufficiently robust when looking at the formation of all the domains. we observe that fluctuations can lead to an increase or decrease of domain amplitudes . furthermore we also observe posterior and anterior boundary shifts, which leads to domain expansion, domain contraction or domain shifts. we also observe that domains completely disappear or that domains appear in other regions, where they repress other domains. especially in a significant number of circuits the anterior domains gt and kr did not form robustly during the simulations. the least robust was the tll domain at the posterior end, this domain interacted with gt and hb, which all showed defects in many circuits. we believe that tll weak robustness is caused by an incomplete model where gap gene are regulating tll which is inconsistent with experimental evidence  <cit> . however, we see that although the overall robustness to fluctuation is poor, the robustness tends to behave in a modular way, where, for a given circuit, all genes but one can have very good score. the gene with a bad stochastic simulation can be linked to a bad or wrong interaction, feature that cannot be seen from the deterministic simulation. this modular behavior shown in fig.  <dig> is strongly related to the network topology as well as the interaction weights.

looking at the evolution of the system in phase space, we found that the pathways in many cases were not well defined, which appeared to be linked to the existence of multiple attractors. the fluctuations allowed the system to jump from one attractor to another, causing the system to evolve into a pattern very different compared to the deterministic model. this suggests that by using the reverse engineering approach many circuits can be found, which are well defined for the deterministic case but not for the stochastic case. multiple attractors can easily occur in a non-linear model with many parameters, where overfitting may lead to many connections in the circuits. also the type of feedback loops may be crucial, e.g. cad has a negative auto-regulation, which reduces the effect of fluctuations, however all other genes have strong positive auto-activation  <cit> ; in these cases fluctuations are amplified if there are no negative feedback loops associated with the increase of the expression level.

the effect of certain parameters on robustness
the connectionist model contains a promoter threshold for each gene, which determines if gene production is on or off when there are no other inputs. in the current gap gene model the production of hb, kr, gt and kni can only be turned on by maternal inputs or by auto-activation, therefore the promoter threshold are set to a fixed negative value, which was either h - <dig>  or h = - <dig> . looking at the robustness of individual circuits, we find that circuits with promoter threshold set to h = - <dig>  are more robust towards fluctuations compared to circuits with promoter threshold set to h = - <dig> , and also their parameters are on average less sensitive. in general we find that weaker maternal inputs from bicoid and caudal increase the robustness with respect to fluctuations. furthermore higher promoter rates, decay rates and diffusion coefficients improve the robustness towards fluctuations.

we have seen that circuits are relatively less sensitive with respect to diffusion coefficients, and with some extent, to decay time constant. regarding the diffusion coefficient, this result confirms observations made elsewhere where it was suggested that the diffusion is not essential to explain precise gene expression pattern formation  <cit> , but the diffusion term does account for the boundary nuclei effect  <cit> . it was also shown by nusslein-volhard et al.  <cit>  that the effect of diffusion is reduced with the exponential increase of the number of nuclei. also, gregor et al.  <cit>  showed that diffusion coefficient does not scale with varying embryos length. the rest of the parameters have a mixed sensitivity behavior and do not fall into a specific category . some of the weights are very sensitive and some are not, idem for the production rate. although we do not have precise biological explanations regarding the difference of the sensitivity behavior of the parameters, it might be interested to experimentally investigate if such difference is a property of the connectionist model or a characteristic of the regulatory mechanism. the sensitivity information can then guide the selection of the optimal mutation targets and thereby reduce the experimental effort. this validation could be done for example by measuring mrna degradation rate of zygotic hb in embryos with over expressed maternal hb, or by measuring the binding affinity in mutants. also one could consider inducing genetic mutation to control kinetic parameters that can be measured  <cit> .

we also find that certain parameters that regulate posterior tll and also some parameters that regulate anterior gt and kr affect robustness of the corresponding domains. furthermore we find that robustness and parameter sensitivity are linked. especially for the group with a lower promoter threshold we find that circuits with a lower average sensitivity are more robust towards fluctuations. these results show that in the current gap gene model not just the network topology but to a large extent the precise value of the parameters determines robustness. we noticed that inputs of cad to other genes correlate negatively with robustness, these parameters are amongst the most sensitive in the model, with a - log si in the order of  <dig>  if we assume that fluctuations are proportional to the square root of the concentration level  the relative fluctuation level is about , where n is the number of molecules. for n =  <dig>  n =  <dig> and n =  <dig> the relative fluctuation level then is 10%,  <dig> % and 1%. the most sensitive parameters in the model have a relative sensitivity of about  <dig>  - 2% . this holds assuming that 20% of the circuit rms is a critical cut-off.

possible reasons for weak robustness
we conclude that the current connectionist model describing the gap gene segmentation obtained from reverse engineering techniques is not robust. although some circuits appear more robust than others, most of the circuits are extremely sensitive towards gene expression level fluctuations and also pattern formation is very sensitive with respect to perturbation of a large number of parameters. in most cases the parameters causing this are linked to: tll regulation, in some cases are linked to anterior gt and kr regulation and finally the promoter threshold . there may be a multiple reasons for weak robustness. first, the incompleteness of the model may be the cause. in the real system it is known that the terminal pathway with tll, huckebein  <cit>  and torso also regulate gap genes, the latter two are missing in the current model. furthermore, hb regulation is not only zygotic but also has a maternal component at the anterior end of the embryo that is also regulated by nanos, nanos and a maternal description hb mrna are missing in the model. furthermore, only a part of the embryo is considered, which may lead to boundary effects at the anterior end. secondly, the current reverse engineering approach using a simple rms optimization may lead to sensitive circuits, not only some time points are missing in the data also features in the data that are not represented in the model may be over fitted. finally, the rather phenomenological approach of the connectionist model may also be a source of sensitivity because promoter threshold has a profound effect on robustness.

how to improve the network inference
in modelling processes from developmental biology especially the class of quantitative spatio-temporal models of gene regulation is relevant. this type of models can potentially linked with three-dimensional biomechanical models of morphogenesis and provides new insights into developmental biology. especially the quantitative spatio-temporal models of gene regulation are characterized by a large number of unknown parameters and an  class of potential solutions. so far, very few model-based analysis method have been proposed to validate or invalidate models, especially for nonlinear and spatially distributed models  <cit> .

the analysis presented in this paper shows the effect of missing genes, suggesting that it might be necessary to include more genes known to be involved in gap gene segmentation. although data might not be available, one could consider combining synthetic data with observation. the hierarchical modular structure of the system should be considered within the model description  <cit> . phenomenological models such as the connectionist model can generate realistic pattern, but they still fail at establishing the clear role of genetic perturbation. these models can be improved by considering using hill type functions  <cit>  and/or more detailed rate equations  <cit> 

another improvement would be to infer the network using stochastic models that translate the fluctuations in the system. it is computationally expensive to numerically solve such systems and it will require efficient optimizations methods  <cit> .

to prevent overfitting, one might consider reducing the number of free parameters by adding more constraints known from previous experiments. in general the inverse problem that is only based on minimizing the rms leads to over-fitting, allowing for many solutions that all fit the dataset equally well but may not show correct behavior or properties beyond the dataset. it is therefore difficult to know, which solution is most similar to the real system. the different post-optimization analyses presented in this paper and in an accompanying manuscript  revealed some simple but efficient invalidation tests. ideally, we would like to funnel all circuits into a pipeline of tests where the circuits are filtered and those passing all the tests are the robust and stable solutions. it may however turn out that none of the solutions will pass all the tests. therefore we propose not only to minimize the rms but also to incorporate other objectives into the optimization strategy. by introducing multiple objectives the solutions obtained should possess better properties and also have better defined parameters. the possible additional objectives for gene regulatory networks are:

• sensitivity constraints should lead to networks that are robust towards parameter or input perturbation. this could simply be addressed by incorporating a sensitivity analysis within the optimization procedure. using the levenberg-marquardt method for parameter estimation, ashryalyev et al.  <cit>  have investigated simultaneously while estimating the parameters, their identifiability. rodriguez-fernandez et al.  <cit>  have presented a hybrid method that can handle the sensitivity analysis while optimization. using such method, we suggest attributing to each circuit a sensitivity value that determines the overall sensitivity of its parameter.

• noise robustness constraint is another improvement that should lead to circuits robust towards fluctuations . this improvement can be achieved by inferring the network using stochastic models that include the fluctuations in the system. it is computationally expensive to numerically solve such systems and it will require efficient optimizations methods  <cit> . furthermore, it is known that patterning is insensitive to external fluctuation such as maternal gene expression. consequently, an efficient model should also be able to simulate gap-gene expression given noisy external bcd expression. an efficient way to distinguish all the solutions obtained from the parameter estimation would then be to change the bcd dosage during the optimization it was shown by manu et al.  <cit>  that bcd variation is not the cause of the precise canalization of the gap genes but its a consequence of the cross regulation between zygotic gap genes  <cit> . in an optimization procedure, good circuits should be able to reproduce the patterns as well as the shift without showing any major fluctuation of the gap gene expression while varying the bcd concentration.

• reducing network connectivity in our accompanying manuscript  <cit> , we show that the long term dynamic revealed that in the presence of certain motifs, the circuits pattern converge to oscillatory attractors. this behavior is not desirable as we expect the patterns to converge to a stationary point being the steady state. therefore, we would ideally ignore or penalized the circuits having this behavior. also, we have shown that circuits with realistic topologies do not have these motifs and converge to the desired attractors. this could be obtained by either running the circuits beyond the data set to force asymptotic stability  <cit> , or by adding an entropy function to prioritize circuits with the minimal connectivity. it was shown by isalan et al.  <cit>  that circuits where reduced connectivity are more robust to parameter variation in comparison to circuits with less connected members.

these different additional objectives would be integrated in a multi-objective optimization framework, which is an extension of the classic optimization of a single-objective function . many multi-objective algorithms exist  <cit>  such as method where multi objectives are transformed into one single objective  <cit> , pareto  <cit>  and non-pareto dominance approaches. to our knowledge, very few have used multi-objective optimization for grn inference  <cit> . based on recent reviews  <cit> , stochastic ranking evolutionary strategy  is one of the best methods for parameter estimation of biological problems. this method has been used to obtain some of the circuits analyzed in this article and obtained elsewhere  <cit> . the implementation of the sres is suitable for multi-penalties where the weighted sum of penalties is used  <cit>  as a multi-objective constraints. the strength of the es is its intrinsic parallel nature  <cit> . one alternative would be to use an island based es where the number of island is determined by the different objectives. each island minimizes the multi-objectives, but the distribution of the weight is different from island to island. migration between islands will spread individuals with a particular strong property in the other islands. the main objective being the least square difference between the simulation and the data, it might be more practical to start with one population where the penalties have equal weights and later on, switch to islands once the lse is acceptable. this would guarantee that in all islands, the individuals have at least a good rms.

CONCLUSIONS
in this paper, we have provided a robust analysis of a model used to infer the gap gene regulatory network of drosophila melanogaster. the model has been extensively used elsewhere  <cit>  to simulate and provide some explanations concerning the regulatory mechanism that leads to precise pattern formation. unfortunately, many assumptions were based on a limited number of circuits obtained using simulated annealing and previous researchers assumed that the model was correct with a correct topology. in this article, we have shown that the mathematical model leads to different circuits all capable of reproducing the quantitative spatio-temporal gene expression pattern. consequently, it is difficult to decide based solely on the architecture which circuit is the correct one.

robustness towards fluctuation has revealed that the overall gap gene domain tends to be poorly resistant to perturbation and this weak property could be related to some particular interactions predicted by the circuits. furthermore, parameter perturbation analysis has shown that the circuits with lower sensitivity do not necessarily yield to robustness to fluctuation. the reason for these few exceptions is related to the promotor threshold and to local domain robustness, which can considerably affect the overall global robustness. overall, the analysis shows that the network possesses modular robustness and some local properties may affect the robustness of a gene expression locally as show in fig.  <dig>  this feature is strongly related to the network topology as well as the interaction weights.

from a biological point of view, this paper has shown that it is difficult to relate the connectionist model with biological evidence. the model ability to simulate the gene expression does not necessarily provide meaningful information since alternative networks are predicted. therefore, it would be interesting to test some of the different alternatives, especially when there is not yet any experimental evidence to invalidate. however, it was recently demonstrated that it is still possible to draw qualitative conclusions on the regulatory topology of the gap gene network  <cit> . the overall analysis has shown that based on the robustness toward gene expression fluctuations and parameter perturbations, it is possible to identify robust circuits as well as the parameters that are identifiable according to their sensitivity intervals. for a computational/system biologist, this shows that it is essential to further analyze a model prediction, when results are obtained from reverse engineering based on parameter estimation, since some of its properties may or may not invalidate the results. we have also provided some preliminary suggestions to efficiently improve the grn inference to avoid reverse engineering that leads to circuits with different topologies, by controlling the optimization by means of multi-objectives minimization.

