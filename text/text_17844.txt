BACKGROUND
tumor involves many pathways, distinct genes and exogenous factors, and is considered as systems biology diseases  <cit> . despite tremendous efforts in research, the mechanism of tumor genesis and development has not been thoroughly known yet. treatment of later stage cancers is often not therapeutically effective, and medical experts agree that early diagnosis of tumor is of great benefit to successful therapies. however, early tumor detection is extremely difficult using traditional tumor mass detection techniques such as x-ray imaging. furthermore, different subtypes of tumor show very different responses to therapy, indicating that they are molecularly distinct entities. thus, accurate classification of tumor samples based on molecular signatures is essential for efficient cancer treatment. since the first paper on the classification of leukemia subtype based on gene expression profiles  was published  <cit> , this research field has been studied extensively and become a research hotspot  <cit> . many datasets on different tumors have been published such as colon tumor  <cit> , small round blue cell tumor   <cit> , diffuse large b-cell lymphomas   <cit> , and prostate tumor  <cit> , etc. all of the published tumor datasets have very high dimensionality and small sample size mainly due to limited resources and the time required for collecting and genotyping specimens  <cit> . many supervised classification methods in pattern recognition, such as support vector machines   <cit> , artificial neural networks   <cit> , k-nearest neighbor   <cit> , and nearest shrunken centroids  <cit> , have been successfully applied to gep-based tumor classification over the last decade. all these studies have shown that gep-based tumor classification methods hold great promises for early diagnosis and clinical prognosis of tumor. however, due to the challenges from the curse of dimensionality that the number of genes far exceeds the size of sample set, dimensionality reduction including feature extraction such as total principal component regression  <cit>  and gene selection  <cit>  should be performed before constructing classification model  <cit> . compared to feature extraction, gene selection do not alter the original representation of genes, so it can not only improve the performance of tumor classification by removing redundant and irrelevant genes but also select informative gene subsets that may serve as cancer biomarkers and potential drug targets. more importantly, it may provide insight into the underlying molecular mechanism of tumor development. therefore gene selection plays a very important role in tumor classification  <cit> .

generally, gene selection can be classified into two categories: filters and wrappers  <cit> . filters are independent from the following classification stage. they evaluate the discriminability of genes by using only the intrinsic information of data themselves and subclass information, such as relative entropy  <cit> , information gain and t-test  <cit> , as well as minimum redundancy-maximum relevance   <cit> . because gene selection is not associated to any specific classifiers, the gene subsets selected by filters can avoid over-fitting phenomena. the advantage of filters is that they can be easily catered to very high-dimensional datasets, and are computationally simple and fast  <cit> . on the contrary, wrappers evaluate the discriminability of each gene subset using the evaluation function of learning algorithm, such as genetic algorithm /svm method  <cit>  and ga/knn method  <cit> . wrappers often deliver better performance than filters in gene selection  <cit>  because they utilize the feedback information of classification accuracy. however, their computational cost must be seriously taken into account  <cit>  due to the fact that hunting for the smallest feature sets in a high-dimensional space is an np-complete problem  <cit> . practically for all wrappers a good solution is to adopt heuristic method in a condensed search space to approximately find out the smallest feature sets. one example is to adopt ga to find the most informative gene subsets  <cit> . another example is to combine gene ranking with clustering analysis to select a small set of informative genes  <cit> .

three general modes are commonly adopted in gene selection strategies: increasing mode, decreasing mode, and hybrid mode, which are respectively introduced as follows. 1) increasing mode selects a gene subset starting from empty set until a gene subset with the highest classification accuracy is selected through appending potential genes into the gene subset, such as sequential forward search   <cit> . 2) decreasing mode starts from the whole gene set to remove irrelevant and redundant genes, and keeps the least gene subset among the subsets with the same classification accuracy, such as the well-known support vector machine-recursive feature elimination   <cit>  that selects informative genes in a sequential backward elimination manner by starting with the whole gene set and eliminating one or several redundant gene in each iteration, and the extension of svm-rfe  <cit>  that solves the multi-class gene selection problem by simultaneously considering all subclasses during the gene selection process. 3) hybrid mode, such as sequential forward floating search  algorithm  <cit>  and markov blanket-embedded genetic based gene selection algorithm  <cit> , combines increasing mode with decreasing mode by starting from an arbitrary gene set. however, reunanen  <cit>  proved that intensive search strategies such as sffs do not necessarily outperform a simpler and faster method like sfs, provided that the comparison is done properly.

in fact, due to the characteristics of gep, more complex methods are not obviously superior to the simpler ones and the loss of biomedical meaning derived from the over-complex methods may be not sufficiently compensated by the little improvement of predictive performance  <cit> . therefore, designing biologically interpretable methods that obtains minimum gene subsets with the highest or nearly highest classification accuracy is very important for robust tumor classification. furthermore, identifying minimum gene subsets means discarding most noise and redundancy in dataset to the utmost extent, which may not only improve classification accuracy but also decrease the tumor diagnosis cost by suggesting the fewest biomarkers in clinical application as suggested by  <cit> . however, the curse of dimensionality from gep implicates two problems in selecting a small gene subset with the highest or nearly highest accuracy from thousands of genes: over-fitting and selection bias, because it may be just by chance to find a small gene subset with perfect classification performance from such tremendous gene space even in random dataset  <cit> . so the over-fitting and selection bias problems must be avoided in order to obtain robust classification performance.

ambroise et al. <cit>  found that overoptimistic results incurred by selection bias could happen if test set is not thoroughly excluded from gene selection process. therefore, test set must be independent of the training process of classifier. wang l.p. et al. <cit>  further pointed out that many previous studies, such as  <cit>  and  <cit> , had gained overoptimistic performance according to this criterion, and they proposed a simple method with resultant accurate tumor classification by using a very few genes. this method combines gene ranking with exhaustive search method to find minimum gene subsets so as to achieve the unbiased accuracy. although their methods achieve good and unbiased classification results, the high computational cost makes it infeasible when the number of initially selected genes is very large . our previous work  <cit>  designed a gene selection approach that was used to find the minimum gene subsets with the highest classification accuracy, but seriously upward bias occurred because that initially selecting differentially expressed genes on whole dataset and over-fitting is performed in gene selection stage. in this study, based on the heuristic breadth-first search algorithm , we further construct a hbsa-based ensemble classifier and design a hbsa-based gene ranking method by counting its occurrence frequency on the basis of gene subsets selected only on training set so as to avoid over-fitting case and selection bias. our novel method manages to simultaneously achieve the two conflict goals  <cit> : 1) design a simple classifier to achieve nearly highest and unbiased prediction accuracy; and 2) mine as many important tumor-related genes as possible, which may provide insight into the mechanism of tumor genesis and help find diagnosis biomarkers and new therapeutic targets  <cit> .

in this following section, we firstly describe the classification problem and introduce the search strategy of hbsa. the implementation of hbsa is given, and its biomedical interpreter is also illustrated. then two methods including hbsa-based ensemble classification and hbsa-based gene ranking are designed to obtain unbiased prediction accuracy and find important tumor-related genes. the results obtained on nine actual tumor datasets including three pairs of cross-platform datasets demonstrate the feasibility and effectiveness of our method. comparison with other related methods also indicate the superiority of our method. the biomedical analysis of the selected genes in the context of individual gene function, pathway analysis and protein-protein interaction  network further justify our methods.

methods
problem description
let g = {g <dig>  ⋯, gn} be a set of genes and s = {s <dig>  ⋯, sm} be a set of samples. |g| = n denotes the number of genes, and |s| = m denotes the number of samples. the corresponding gep can be represented as matrix x = mn, 1 ≤ i ≤ m, 1 ≤ j ≤ n, where xi,j is the expression level of gene gj in sample si, and usually n ≫ m. each vector si in the gene expression matrix can be regarded as a point in n-dimensional space. and each of the m rows consists of an n-element expression vector for a single sample. let l = {c <dig>  ⋯, ck} denote the label set and |l| = k denote the number of subclasses. usually, the subclass of each sample is known, so s × l = {|si ∈ rn, li ∈ rn, li ∈ l, i =  <dig>   <dig>  ⋯, m} denotes the labeled sample space.

selecting an informative gene subset t with the highest classification accuracy from gene space p  is a crucial problem, but it is an np-complete problem  <cit> . moreover, which and how many genes are relevant to a specific tumor subtype are not clear for biomedical scientists so far. we therefore assume that the gene subsets with powerful classification ability are relevant to a specific tumor subtype. let acc denote the classification ability of a gene subset t on sample set, which is usually measured by the accuracy of a classifier. we hope that the selected informative gene subset t simultaneously satisfies the following two goals:

  minimizet∈p 

  miximizet∈p) 

where |t| denotes the cardinal number of gene subset t. the gene subset simultaneously satisfying  and  is called an optimal gene subset t*. note that usually more than one optimal gene subset t* may exist in that the genes belonging to the same pathway in a cell usually have similar expression pattern and function. optimal subsets a* comprise all of the optimal gene subsets t*, i.e., a* = {t*|t* ⊂ gt* simultaneously satisfies  and }. although finding only one gene subset t* is sufficient for tumor classification, finding as many optimal gene subsets as possible is very useful to gain an insight into tumor dataset structure and discover more important tumor-related genes.

due to a large |g| = n , it is impractical to apply an exhaustive search method to find out a* in the space of 2n gene subsets. a good solution is to adopt a heuristic method in a condensed search space to approximately find out a*. however, different gene subsets with different cardinal numbers may be selected by using different methods, so it is difficult to determine the minimum number of optimal gene subset for a specific tumor dataset by only designing methods. thus we must balance the minimum number and the classification accuracy. jain et al. <cit>  suggested a criterion  that the number of training samples per subclass is at least five times the number of features in designing a classifier to avoid the curse of dimensionality, i.e.

  /ns> <dig> 

where k is the number of subclasses, mt is the number of training samples, and ns denotes the number of the selected genes, and for more complex classifier the ratio of sample size to dimensionality should be larger. for example, we should consider at most eight informative genes for two-subclass tumor dataset with only  <dig> training samples to design a classifier with acceptable generalization performance  <cit> . considering that very high accuracy can always be obtained by selecting sufficient genes in a small size of sample set, we aim to find minimal gene subsets with nearly maximal accuracy rather than to obtain maximal accuracy with much more genes. therefore, those gene subsets approximately satisfying  and  are also included into our optimal gene subsets a*. based on these optimal gene subsets, how to obtain more reliable accuracy and find more important tumor-related genes are two key problems.

gene pre-selection
it is widely accepted that tumor-related genes are differentially expressed ones, so the filters-based gene ranking techniques are usually used to pre-select the differentially expressed genes from the original gene space even though those differentially expressed genes are not always tumor-related ones due to the noises in dataset. its main idea is to assign each gene a single score that denotes the significance of each gene according to a certain scoring criterion. many single variable methods such as t-test and bhattacharyya distance are extensively used as discrimination criterions. however, these methods require the dataset to follow gaussian distribution. otherwise, these methods may not achieve optimal experimental performance. deng et al. <cit>  reported that usually tumor datasets do not follow gaussian distribution and showed that wilcoxon rank sum test  is superior to t-test method in gene selection on three binary tumor datasets. however, wrst is only suitable for the binary classification problem. kruskal-wallis rank sum test  is suitable for multi-class problem. the wrst or kwrst-based gene selection method was reported to perform very well in gep-based tumor classification on the basis of the extensive comparison studies  <cit> . taking it into consideration that kwrst does not require a certain distribution of data and is also suitable for small dataset, in our experiments we use kwrst to pre-select an initial informative gene set g* = {g <dig>  ⋯gp}, which contains p candidate genes with good discriminating ability.

heuristic breadth-first search
search strategy
we aim at finding as many optimal gene subsets as possible. when p, the number of the informative genes pre-selected by kwrst, is small, breadth-first search algorithm can realize our goals  and . however, when p is very big , the required cpu time of such a search algorithm is intolerable. we therefore design a heuristic breadth-first search algorithm  with heuristic information measured by acc to find the optimal gene subsets a*, which can drastically reduce the search space.

usually, in the process of search an expanded tree is generated by hbsa from g* = {g <dig> .,gp}, which is the differentially expressed gene set pre-selected by kwrst, as shown in figure  <dig>  where nij denotes a node with i representing the layer of the node  and j the serial number of the node in layer i. the data structure of each node is defined as follows:

node = begin

 set;

 parent;

 path;

 c;

end

where nij.set denotes a set only containing single gene, nij.parent the parent node of the node nij, and nij.path a gene set containing all genes on the path from the root node n <dig> to the node nij itself. obviously the length of the gene set nij.path is i, i.e., nij.path = nij.parent.path ∪ nij.set. let nij.c = acc denote the classification accuracy of the gene subset nij.path, serving as the heuristic information to guide the node selection in layer i, evaluated by svm and knn classifiers here. for the root node n <dig>  n <dig> set = ∅ , n <dig> path = ∅, n <dig> parent = nil, and n <dig> c =  <dig>  the root node is expanded to p child nodes guided by the heuristic information kwrst, where we set nij.set = {gj} and n <dig> path = {gj}, gj ∈ g*, 1 ≤ j ≤ p. next all p nodes are expanded again in next layer. each node nij in layer  <dig> is expanded to p −  <dig> child nodes, thus there are p nodes in layer  <dig>  where n2j.set = {gi}, n2j.path = n2j.set ∪ n2j.parent.path, n2j.c = acc, gi ∈ g* ∧ gi∉ n2j.parent.path, where 1 ≤ j ≤ p, 0 ≤ i ≤ p. then we descendingly rank all nodes in layer  <dig> by their n2j.c, and examine whether accmax = max <dig> ≤ j ≤ p is greater than a given threshold acc_max or not, where accmax denotes the maximal accuracy in layer  <dig> if accmax ≥ acc_max, where acc_max is a given threshold, which indicates that at least one optimal gene subset is found, the searching process is stopped. otherwise in layer  <dig> we select the w top-ranked nodes as open nodes to be expanded in next layer, where the parameter w denotes the search breadth. in fact, whatever w is set to, w always takes p value in layer  <dig>  the rest may be deduced by analogy. note that some gene subsets on different paths are possibly the same regardless of gene order in these gene subsets. except nodes in layer  <dig> and  <dig>  if the classification accuracy of a node has been previously computed, the accuracy of this node is set to zero so as to avoid the unnecessary expansion and this node is called closed node that will not be expanded in next layer. finally, when the search process is stopped, all gene subsets in the w top-ranked nodes in last layer are selected into the optimal gene subsets a*. an example of hbsa is illustrated in additional file 1: figure s <dig> 

the goal of hbsa is to select as many optimal gene subsets as possible only on training set. for each gene subset in a* constructed from empty set, its classification accuracy monotonously increases with the increase of its size, so when the classification accuracy of the gene subset achieves acc_max threshold or the maximal value , the size of the gene subset obtained is minimal. it, therefore, is apparent that the optimal gene subsets in a* just approximately satisfy the two goals in  and . if the search breadth w is set appropriately, the error prone of searching process can be avoided to some extent so that as many optimal gene subsets as possible can be selected.

obviously, the search breadth of increase with the increase hbsa does not exponentially of search depth. thus our hbsa is a beam search algorithm, or an optimization of best-first search that searches a graph by ordering all partial solutions according to some heuristic information. as a result, only the best partial solutions of the predetermined number are kept as candidates. that is, only the most promising nodes are retained for further expanding at each layer of the search tree, while the remaining nodes are pruned off permanently  <cit> . generally speaking, in local view the hbsa-based gene selection belongs to the increasing mode, while in global view such gene selection belongs to hybrid mode in that most of the gene combinations with lower classification accuracy are discarded in the search process. the hbsa can be implemented more flexibly. for example, it is unnecessary to select fixed w top-ranked nodes to be expanded in each layer, that is, w can be set to different values in different layers. there are two modes to set w. 1) for each layer, w can be determined by the distribution of the classification accuracy of all nodes in the corresponding layer. 2) set different acc_max thresholds for different layers, and the given threshold of each layer must be less than that of its next layer, which leads to different numbers of the selected nodes in different layers. thus, one advantage of hbsa is its adaptability.

another advantage of hbsa is its biomedical interpretation. suppose ti = {g1′, ⋯, gi′} is a selected gene subset with high accuracy in the i-th layer, where gj′ ∈ g*, 1 ≤ j ≤ i. if g’i+1 ∈ g* could be appended into ti to make acc  increase maximally, g’i+ <dig> should be independent of or very weakly related to the genes in gene subset ti ideally. otherwise, if acc  increases only a little or even decreases, the subset ti+ <dig> will be discarded in layer i +  <dig>  therefore, ideally, all genes in the optimal set t* should be independent of each other, and each optimal gene subset t* selected should be an independent variable group. it implies that those genes in subset t* should be on the different regulatory pathways, but, due to much noise in gep, the gene latterly appended into the gene subset might be weakly tumor-related.

moreover, to distinguish which genes are more important ones, the significance of a gene is measured by its occurrence frequency counted in the optimal set a*. the bigger the occurrence frequency of a gene, the more important the gene. this definition also has its biomedical interpretation. for example, given two three-gene subsets g1 = {g1′, g2′, g3′} and g2 = {g1″, g2″, g3″}, where we assume that all genes in g <dig> are on pathway  <dig> and all genes in g <dig> are on pathway  <dig>  as shown in figure  <dig>  and that the tumor-related strengths of the genes in g <dig> and g <dig> decrease with their orders in g <dig> and g <dig>  respectively. generally, gene subsets such as {g1′, g2′} and {g1″, g2″} might not be selected by hbsa because both acc and acc might be lower than that of other irrelevant gene combinations such as {g1′, g2″} due to the expression similarity of genes on the same pathways. thus the potential gene combinations include nine gene subsets possibly selected: {g1′, g1″}, {g1′, g2″}, {g1′, g3″}, {g2′, g1″}, {g2′, g2″}, {g2′, g3″}, {g3′, g1″}, {g3′, g2″} and {g3′, g3″}. particularly, such gene subsets including g1′ and g1″ tend to be selected by hbsa, while those gene subsets including g3′ and g3″ incline to be discarded by hbsa, which results in high occurrence frequency of those important tumor-related genes such as g1′ and g1″ in gene set a*. thus, the resultant occurrence frequency of a gene is a reasonable measure of its importance from this point of view.

implementation
in practice, there is no need to construct searching tree to obtain the optimal gene subsets a*. it is enough to preserve the potential gene subsets and their classification accuracy in the searching process. to conveniently implement hbsa, a classification matrix cm = w×p is defined as follows:

  cm={g1}⋯{gp}t1a <dig> ⋯a <dig> p⋮⋮⋱⋮twaw,1⋯aw,p 

adopting row label vector row =  to label every row of cm in turn, where ti denotes the selected gene subsets. adopting column label vector column =  to label each column of cm in turn, where gj ∈ g*,and ai,j = acc, where row denote the gene subset of the i-th row in cm matrix and column denote the single gene set of the j-th column in cm matrix, 1 ≤ i ≤ w, 1 ≤ j ≤ p. the framework of hbsa is shown in algorithm  <dig>  where acc is defined as the classification accuracy of gene subset t. for example, if row <cit>  = {g <dig> g4} and column <cit>  = {g6}, a <dig>  = acc = acc, which is the prediction accuracy of the gene subset {g <dig> g <dig> g6}.

algorithm 1: hbsa

input:m denotes gene expression profiles, p the number of pre-selected genes, w the number of the selected gene subsets in each layer , acc_max a given maximal accuracy threshold, and depth the upper bound of searching depth.

output: a set of optimal gene subsets a*.

1: for each gene gj ∈ g do

2: b: = kwrst; //compute p-value for each gene by kruskal-wallisrank sum test.

3: end for

4: b: = sort; //rank b by ascending order.

5: g*: = selected; //select the p top-ranked genes as initial informative gene set g*from original gene set g according to b.

6: for each i ∈ { <dig> ,⋯, p}

7: column: = {gi};

8: row: = column;

9: end for

10: iter: = 1; //the times of iteration.

11: repeat //if cm is firstly computed, cm is a symmetric matrix, so only the lower triangle matrix of cm is computed.

12: construct the classification matrix cm, label each row of cm with each component of row vector, and label each column of cm with corresponding component column vector.

13: compute classification matrix cm, where ai,j = acc, 1 ≤ i ≤ w, 1 ≤ j ≤ p; //before ai,j is computed, the sample set labeled with row ∪ column must be normalized ; function acc is measured by svm with gaussian radial basis function  kernel or knn classifier. computing matrix cm is equivalent to doing the classification accuracy of all nodes in a layer shown in figure  <dig> 

14: convert cm to the vector v: = , and set v.subset: = row ∪ column, and v.c: = ai,j, 1 ≤ i ≤ w, 1 ≤ j ≤ p, then rank vector v by v.c in descending order. select w top-ranked components to reconstruct label vector row: = v.subset, 1 ≤ i ≤ w, where the row dimensionality of matrix cm can be dynamically changed according to the requirement.

15: accurancy: = max;

16: iter: = iter + 1;

17: until  or ; //when the maximal classification accuracy is obtained or the iteration times is equal to depth, the searching process ends.

18: select all gene subsets with the highest or nearly highest accuracy and append them into the optimal gene subsets a*.

19: return a*; //return the optimal gene subsets a*, |a*| is the number of the optimal gene subsets, and ∪ a* might be the tumor-related gene set.

algorithm end

three stopping criterions are predefined in hbsa:

1) when a gene subset whose accuracy on overall training set is no less than acc_max threshold is found, the algorithm ends.

2) if no gene subset with acc_max accuracy is found, the hbsa ends with the maximum iteration times depth, which can guarantee the end of this algorithm. usually, we do not know how to select an appropriate depth. if depth is set inappropriately, the selected gene subsets might not be optimal.

3) an alternative criterion is that the hbsa ends with the criterion |accuracyiter+1 − accuracyiter| < δ, where δ is set to a very small positive real number and accuracyiter denotes the maximum classification accuracy in the iter-th iteration.

the most time-consuming operation in the hbsa is to compute acc. if we assume that computing acc only costs one unit time, the time complexity of computing the classification matrix cm is o, and the time complexity for the whole algorithm is o. although hbsa is an algorithm of polynomial time complexity, it is still very time-consuming. however, since the task of finding optimal gene subset is mainly performed in laboratory phase and the clinical tumor diagnosis phase only uses the selected gene subsets, which takes only a little cpu time . thus, our hbsa-based gene selection method is feasible.

evaluation criterion
we adopt two machine learning methods, knn and svm, to measure the classification accuracy, acc, of a gene subset t in hbsa, respectively. knn is a common non-parametric method. to classify an unknown sample x, knn extracts the k closest vectors from training set by using similarity measures such as euclidean distance, and decides the label of the unknown sample x by using the majority subclass label of the k nearest neighbors. k is set to an odd number to avoid tied votes. in our experiments euclidean distance and five nearest neighbors are adopted to measure the similarity of samples and make decisions. the hbsa with knn is called hbsa-knn.

svm  <cit>  with gaussian radial basis function  k = exp  is also adopted to evaluate the classification performance of the selected gene subsets. libsvm  <cit>  is used in the study, where the combinations of penalized parameter c and gaussian kernel parameter γ need to be optimized when training svm classifier. parameter c is the penalty factor of the samples classified mistakenly, while parameter γ dominates the sensitivity to the change of input data. because of the large search space, the general grid-search method   <cit>  is time-consuming in finding the optimal parameter combinations . furthermore, we find that normalized tumor datasets are not sensitive to parameter c, and that search space can be reduced with parameter γ being set within the range of  <cit>  and c being set to  <dig> and  <dig> or even fixed to  <dig>  specifically, if γ takes the value in o, γ may take  <dig> ,  <dig> , ⋯,  <dig> , respectively; if γ takes the value in o, γ may take  <dig> ,  <dig> , ⋯,  <dig> , respectively. and the others are set similarly. the hbsa with svm is called hbsa-svm.

the k-fold cross-validation  is commonly used to evaluate classification model. here it is applied only on training set to measure acc. if k is set to trn , the k-fold cv is called leave-one-out cross-validation . if k is set to  <dig>  the k-fold cv is known as the holdout method. when k is set too low, the accuracy of k-fold cv tends to have high bias and low variance. on the contrary, when k is set too high , the accuracy of k-fold cv will have low bias but high variance  <cit> . breiman et al. <cit>  found that 10-fold cv method outperforms the loocv method to some extent. ambroise et al. <cit>  and asyali et al. <cit>  also recommended 10-fold cv methods in tumor classification, but whether 10-fold cv method outperforms loocv method depends on datasets. to balance the bias and variance, here we design a new method to evaluate the experimental results. let cv denote the accuracyof k-fold cv classification, where 2 ≤ k ≤ m and m is the total number of samples in training set. then the mean of the accuracy is defined as:

  mean=1m−1) 

the standard deviation is defined as:

  std=∑k=2m2/ 

this method is called full-fold cv method. the mean of the accuracy evaluated by this method is called full-fold cv accuracy. since the computational cost of hbsa would greatly increase by using full-fold cv to compute acc, 10-fold cv is still used to evaluate acc as the heuristic information of hbsa. while full-fold cv method is only used to evaluate the resultant gene subsets in a* with the highest or nearly highest 10-fold cv accuracy.

the implementation of hbsa-knn is similar, but different in some ways, to that of hbsa-svm. for hbsa-knn, we randomly divide training set into  <dig> parts when using 10-fold cv method, but different divisions can slightly affect the experimental results. to eliminate the effects of different divisions, hbsa-knn is performed five times with different divisions of training set, thus we could obtain five optimal sets a*. then the occurrence frequency of each gene is counted from the obtained five optimal sets a*. however, for hbsa-svm, the division of training set for 10-fold cv method, provided by libsvm, is definite in each run. it is sufficient to perform hbsa-svm only once.

usually, for hbsa-svm, final prediction accuracy is evaluated on independent test set by svm-rbf classifier constructed by optimizing parameter pair only on training set, which is called hbsa-svm . however, more than one parameter pairs can make the constructed classifiers obtain the highest 10-fold cv accuracy on training set, while the classifiers constructed with these different parameter pairs obtain different prediction accuracy on independent test set. so, in contrast with hbsa-svm , a biased hbsa-svm, selecting the parameter pair that makes the constructed classifier obtain the highest prediction accuracy on test set, is also used to evaluate the performance of the selected gene subsets, which is called hbsa-svm .

receiver operator characteristics  analysis is a visual method for evaluating the performance of binary classification model  <cit> .usually, a few performance measures can be derived from the number of true positives , true negatives , false positives  and false negatives  in test set to measure the performance of classification model, i.e., the true-positive rate or sensitivity , the false-positive rate, positive predictive value, and negative predictive value. here roc curve that is a tpr  versus fpr  plot is used, and the area under roc curve  is used to measure the performance of classification model.

  acc=accurancy=/ 

  sp=specificity=tn/ 

  tpr=sensitivity=tp/ 

  fpr==fp/ 

  ppv=tp/ 

  npv=tn/ 

analysis framework
flowchart of analysis
after hbsa is applied to gene selection from the differentially expressed genes initially selected by kwrst on training set, numerous optimal gene subsets are obtained. however, finding optimal gene subsets in such tremendous gene space tends to over-fit training set. some tumor-unrelated genes are very likely to be selected mistakenly into optimal gene subsets, which might introduce serious bias in the gene selection. the generalization performance of these gene subsets containing tumor-unrelated genes is possibly very poor in predicting unknown tumor samples. to address this problem, we design a hbsa-based ensemble classifier and a hbsa-based gene ranking method to obtain unbiased prediction accuracy and find as many important tumor-related genes as possible. the flowchart of our analysis method is shown in figure  <dig> 

hbsa-based ensemble classifier
the hbsa-based ensemble classifier consists of the individual classifiers constructed from the optimal gene subsets, and the corresponding prediction accuracies  are determined by the ensemble classifiers constructed by svm  and svm  on test set, respectively. final decisions are made by simple majority voting strategy in our experiments. to illustrate the results, the construction of an ensemble svm classifier with w individual svm classifiers is shown in figure  <dig>  where each individual svm classifier is constructed by each optimal gene subset t obtained by hbsa-svm.

to measure the reliability of the classification for each test sample by the ensemble classifier constructed with n individual classifiers, a confidence level is defined. assume that a dataset has k subclasses denoted by l = {c <dig>  ⋯, ck}, a test sample is assigned a voting vector , where each component mi denotes the number of the obtained votes for the corresponding subclasses ci in l = {c <dig>  ⋯, ck}, where ∑i=1kmi=n. let mmax and msec denote the maximum and next maximum number in voting vector , respectively. the confidence level conf of a test sample can be defined as conf = mmax/msec. if msec =  <dig>  conf is set to n, where 1 ≤ conf ≤ n. the bigger the conf is, the more reliably is the test sample correctly or mistakenly classified.

hbsa-based gene ranking method
the hbsa-based gene ranking method, which ranks genes according to the occurrence frequency count of each gene in the final optimal gene subsets a*, is designed to find important tumor-related genes. that is, the significance of a gene is measured by its occurrence frequency. the top-ranked genes with the highest occurrence frequency are considered to be the most important tumor-related ones and should have superior and robust generalization performance.

RESULTS
tumor datasets
nine publicly available tumor datasets are applied: small round blue cell tumor   <cit> , acute lymphoblastic leukemia   <cit> , colon tumor  <cit> , leukemia <dig>  <cit> , leukemia <dig>  <cit> , diffuse large b-cell lymphomas   <cit> , dlbcl <dig>   <cit> , prostate <dig>  <cit> , and prostate <dig>  <cit>  datasets. among these datasets, three pairs of cross-platform datasets are used to evaluate the generalization performance for our classification model. the division of training set and test set is shown in table  <dig>  more details about the datasets are available in the additional file 1: tables s1-s <dig>  

* m denotes the number of sample in dataset. n denotes the number of genes, and k denotes the number of subclasses.

**“tr” denotes this dataset will be used as training set, while “te” denotes this dataset will be used as test set.

hbsa-svm classification performance
the gene selection procedure of hbsa-svm is performed only on training set. considering the computational performance of our computer, we initially select  <dig> top-ranked genes by kwrst. then training sets and test sets are normalized by genes using z-score normalization method that makes dataset with mean zero and standard deviation one, respectively. other parameters in hbsa are set: p =  <dig>  w =  <dig>  acc_max =  <dig>  and depth =  <dig>  respectively. after the experiments are performed on six training sets, for each dataset  <dig> optimal gene subsets are selected according to 10-fold cv method. part of the optimal gene subsets selected are shown in table  <dig>  which shows that at least one gene subset with 100% training accuracy is always obtained for each tumor dataset. it is also found that the prediction accuracy of hbsa-svm  is always not greater than that of hbsa-svm . the experiments further indicate that searching optimal gene subsets costs high computationally. for example, for the all dataset, it costs about 11 days by using hbsa-svm at the worst case on our computational platform of core   <dig> duo  <dig>  ghz cpu and 2 g ram.

over-fitting occurs in selecting gene subsets on all six training sets as shown in additional file 1: table s <dig>  for example, for the leukemia dataset, 2-gene subset {x <dig>  y07604} with 100% training accuracy has only  <dig> % prediction accuracy on leukemia <dig>  for srbct, 3-gene subset { <dig>   <dig>  134748} with 100% training accuracy obtained only 60% prediction accuracy. some gene subsets may obtain very high prediction accuracy . it may be only by chance to find such gene subsets because the high training accuracy obtained by this gene subset cannot represent good generalization performance of the obtained classifier due to the biased gene selection procedure on whole training set. in fact, some gene subsets with nearly 100% training accuracy obtaining very high prediction accuracy on test set indicate that these gene subsets probably contain important tumor-related genes. for example, for the leukemia dataset, two genes {x <dig>  m63838} with only  <dig> % training accuracy can obtain  <dig> % prediction accuracy on leukemia <dig>  in which x <dig> is an important tumor-related gene. moreover, some redundant or noise genes may potentially degrade the classification performance by masking the contribution of the relevant genes. for example, for srbct, 2-gene subset { <dig>  769716} can obtain 70% prediction accuracy on the corresponding test set, but 3-gene subset { <dig>   <dig>  134748} only obtains 60% prediction accuracy. similarly, hbsa-knn can also lead to over-fitting phenomena.

the genes in the same gene subset usually come from different pathways. for instance, for the all dataset, the six genes in gene subset {blnk, ap1b <dig>  ptp4a <dig>  mpp <dig>  idi <dig>  parp1}with 100% training accuracy take part in different pathways. blnk takes part in base excision repair and b cell receptor signaling pathways. parp <dig> takes part in the primary immunodeficiency pathway. for the gene subset {dntt, lair <dig>  pttg1ip, idi <dig>  parp <dig>  cdkn1a}, although these genes are enriched in  <dig> important pathways, there are no two genes taking part in the same pathway. for the srbct dataset, the 3-gene subset {cd <dig> , rcvrn,erbb2}are involved in  <dig> major pathways, but all these three genes come from different pathways. the genes in subset {cdk <dig>  nf <dig> gna11} participate in  <dig> important pathways such as non-small cell lung cancer, p <dig> signaling pathway, etc., but there are no two genes in the gene subset on the same pathway. in addition, we find that the majority of the genes selected are involved in important tumor-related biological pathways. for example, the gene cdk <dig> is involved in non-small cell lung cancer, p <dig> signaling pathway, melanoma, etc., in total  <dig> pathways. thus, the results are generally consistent with our interpretation of hbsa.

ensemble classifier
hbsa-svm-based ensemble classification
to solve the above over-fitting problem, hbsa-svm-based ensemble schemes are constructed by using a simple majority voting strategy to integrate the individual classifiers. the number of the gene subsets used to construct an ensemble classifier is determined by experiments. the results of three different ensemble classifiers based on different modes are shown in table  <dig>  for example, for the leukemia dataset, the item top  <dig> gene subsets,  <dig> top-ranked gene subsets with the highest training accuracy are selected, but only  <dig> gene subsets among the  <dig> gene subsets share with the leukemia <dig> test set. thus the final ensemble classifier consists of the  <dig> individual classifiers respectively constructed from these  <dig> common gene subsets. the corresponding prediction accuracies  are obtained on the leukemia <dig> test set, respectively.

* the corresponding prediction accuracies  are obtained on the leukemia <dig> test set, respectively. the item 10-fold >  <dig> means that the gene subsets with 10-fold cv accuracy greater than 98% are selected from the  <dig> top-ranked gene subsets in which only  <dig> gene subsets are shared between the leukemia <dig> training set and leukemia <dig> test set. thus the final ensemble classifier consists of the  <dig> individual classifiers respectively constructed from these  <dig> gene subsets; the corresponding prediction accuracies  are obtained by the ensemble classifiers constructed by svm and svm on the leukemia <dig> test set, respectively.

** the individual classifiers are constructed from the gene subsets that are selected from all nodes in last layer, not limited to the  <dig> top-ranked nodes in last layer because more than  <dig> gene subsets can obtain 100% 10-fold cv accuracy on dlbcl.

to analyze the reliability of classification, the confidence level for each sample is calculated. taking the colon tumor dataset as an example, the confidence levels of  <dig> test samples are shown in table  <dig> by hbsa-svm, in which the 7th, 9th and 13thsamples are mistakenly classified with very high confidence levels,  <dig> ,  <dig>  and  <dig>  respectively. compared with the results in additional file 1: table s <dig> obtained by hbsa-svm, most of the samples mistakenly classified in table  <dig> are the ones mistakenly or correctly classified with low confidence levels in additional file 1: table s <dig> 

* the number in parentheses denotes the serial number of sample in original colon tumor dataset.

** “c” means the sample classified correctly and “e” means the sample classified mistakenly.

hbsa-knn-based ensemble classification
hbsa-knn-based ensemble classifier is also constructed by using majority voting strategy to combine  <dig> individual classifiers constructed by  <dig> optimal gene subsets selected by hbsa-knn. unlike hbsa-svm, for each dataset random division of 10-fold cv on training set are run for five times, and the average of the five accuracies is used as the final prediction accuracy. for the cross-platform datasets, only the gene subsets shared between the training set and the corresponding test set within the selected  <dig> gene subsets are used to construct an ensemble classifier. the prediction accuracies of the constructed ensemble knn classifier are listed in table  <dig>  compared with prediction accuracies obtained by the ensemble hbsa-svm classifier, shown in table  <dig>  the prediction accuracy of the ensemble knn classifier is no less than that of the ensemble svm classifier except the prostate dataset.

column first denotes the prediction accuracy of the constructed ensemble classifier obtained on the first run of the hbsa-knn, and the others are deduced by analogy. the average accuracy is the average prediction accuracy obtained by five runs of the hbsa-knn.

hbsa-based gene ranking
to prioritize genes so as to find important tumor-related genes, we simply count the occurrence frequency of each gene in all of the optimal gene subsets to measure the gene significance. the  <dig> top-ranked genes selected by hbsa-svm and hbsa-knn for each dataset are shown in additional file 1: tables s5-s <dig> and s17-s <dig>  respectively. it is shown that only few genes have relatively higher frequency, and that the respective top  <dig> genes selected by hbsa-svm and hbsa-knn are mostly shared on the same dataset. the result suggests that our hbsa-based gene ranking method is robust and valid.

we also find that the most frequently selected genes are not always the most differentially expressed ones. for dlbcl, mcm <dig> that is ranked the first by kwrst is ranked the third in the corresponding list of gene frequency by hbsa-svm. however, rhoh that is ranked the first in the frequency list by hbsa-svm is ranked the 258-th by kwrst. however, for srbct, most of the top  <dig> genes selected by hbsa-svm are included in the top  <dig> genes selected by kwrst, suggesting that the most differentially expressed genes in this dataset are the most important tumor-related genes. therefore the most important tumor-related genes are not necessarily the most differentially expressed ones.

*‘#tg’ denotes the number of top-ranked genes. note that the accuracy labeled by ‘h’ denotes the highest accuracy and the number of the corresponding top-ranked genes denotes the minimal number with the highest accuracy.

comparison of hbsa-knn and hbsa-svm
the ensemble hbsa-knn classifier slightly outperforms ensemble hbsa-svm classifier in prediction accuracy. further comparison of the prediction accuracies of hbsa-svm, hbsa-svm and hbsa-knn varying with different number of top-ranked genes is shown in figure  <dig>  the comparison indicates that hbsa-knn is slightly superior to hbsa-svm in prediction accuracy when the number of top-ranked genes selected is small enough. to further reveal how the biased svm affect classification results, the gene list obtained by hbsa-knn is further evaluated by svm-rbf classifier constructed by biased and unbiased methods again, respectively .the two methods are named hbsa-knn-svm and hbsa-knn-svm, respectively. additional file 1: figure s <dig> shows that hbsa-knn-svm can always obtain the prediction accuracy no greater than that of hbsa-knn-svm and that hbsa-knn is also slightly superior to hbsa-knn-svm in prediction accuracy when the number of top-ranked genes is small. to further evaluate the effectiveness of hbsa-knn in gene selection, the eight top-ranked genes are selected to construct hbsa-svm and hbsa-knn-svm classifiers on four binary datasets, respectively, which are evaluated by roc . it is clear that hbsa-knn-svm is slightly superior to hbsa-svm in auc, indicating that the classification ability of the gene subsets selected by hbsa-knn is slightly stronger than that obtained by hbsa-svm.

comparisons with other related methods
compared with the exhaustive search method, proposed by wang l.p. et al. <cit> , our methods are less computationally demanding. moreover, the ensemble strategy adopted is also superior to their average strategy which averages the prediction accuracy of all gene subsets selected from training set. coincidently, the 3-gene subsets {igf <dig>  af1q, cd99},selected by exhaustive search method  <cit> , with 95% prediction accuracy is identical to the first three genes selected by our hbsa-knn , which indicates that our hbsa is feasible and can achieve the same good results as the exhaustive search method. the prediction analysis of microarrays  proposed by tibshirani et al. <cit>  can identify a small subset of genes that best characterize each subclass by shrinking weak components of class-centroids with a shrinkage parameter for tumor subclass prediction. its experimental results on srbct and leukemia datasets demonstrated that their method is very efficient in finding informative genes with high classification accuracy. of the  <dig> genes selected by pam on srbct dataset,  <dig> genes are also found by our method on the same dataset . on the other hand, although one of their goals was to find the smallest gene subsets, the size of their selected gene subsets with satisfactory accuracy was still too large from the viewpoint of classification and clinical diagnosis.

in addition, dabney et al. <cit>  proposed a classification to nearest centroids  method for class-specific gene selection. to find the theoretically optimal gene subset, they further provided a theoretical result showing how to determine the gene subsets of a given size that maximizes the classification accuracy for high-dimensional nearest centroid classifiers. their results suggest that clanc outperforms pam in prediction accuracy. however, before gene selection, clanc requires a given number of genes, which is difficult to determine how many genes are appropriate.

our method is similar to pam and clanc methods in three aspects. 1) find minimum gene subsets with maximum accuracy. 2) consider the discriminative power of multiple genes when searching for gene subsets. 3) seek the simplest method with biomedical interpretability.

to achieve more objective comparison, the classification performance of pam, clanc and our method are obtained on the two cross-platform datasets  that are realigned by those shared genes between the training set and the corresponding test set, respectively. for the leukemia dataset,  <dig> genes are shared between leukemia <dig> and leukemia <dig>  for dlbcl,  <dig> genes are shared between dlbcl <dig> and dlbcl <dig> 

since hbsa-knn is slightly superior to hbsa-svm in gene selection, we just compare hbsa-knn with pam and clanc methods in prediction accuracy. the conclusion from the comparisons of the classification accuracy, shown in table  <dig>  is that although clanc outperforms pam in accuracy, the accuracy obtained by clanc is lower than ours on all six independent test sets when the number of the top-ranked genes selected is small enough, i.e., when the size of the selected gene subset approximately satisfies  as shown in table  <dig>  for example, for all , when the number of the top-ranked genes selected by hbsa-knn is five, 94% prediction accuracy can be obtained, while clanc obtains only 86% accuracy with six genes . for srbct , our method obtain 100% prediction accuracy with only five genes, while eight genes  are needed to obtain 95%prediction accuracy by clanc. for the prostate dataset , our method obtains  <dig> % accuracy with two genes, while only 74% accuracy is obtained by clanc with the same number of genes. obviously, our method can achieve higher accuracy with the same or fewer top-ranked genes. from table  <dig> we can see that the pam method does not performs well in the classification of some cross-platform datasets because the same accuracy is obtained when different number of genes for the dlbcl and prostate cross-platform datasets are used, which are possibly caused by the fact that the cross-platform training set and test set are not on the same measurement scale.

* k denotes the number of subclasses in each dataset, which ranges from two to six. for example, for all dataset, the size of the gene subset selected ranges from six  to sixty .

note that the prediction accuracy may be affected by different data normalization methods. the results in table  <dig> are obtained with the z-score normalization method on the tumor datasets. if we use another 0– <dig> normalization method that scales all data into the range of  <cit>  with the formula )/ − min), where x is a vector that denotes a set of expression values of a gene in different samples, the results may vary with the same gene subset as shown in table  <dig> and additional file 1: table s <dig>  for example, for the leukemia dataset, the first three genes obtain  <dig> % prediction accuracy on the leukemia <dig> test set with the former z-score method, but the same three genes can obtain  <dig> % prediction accuracy with the latter 0– <dig> normalization. the prediction accuracies of pam and clanc methods are obviously improved on the cross-platform prostate dataset normalized with 0– <dig> normalization method, but the prediction accuracy becomes worse on the leukemia dataset similarly normalized. the results with 0– <dig> normalization also indicate that our method is still superior to pam and clanc in prediction accuracy when the number of top-ranked genes is small enough.

we further compare hbsa-knn-based gene ranking method with the other two well-known gene ranking methods: kruskal-wallis rank sum test  and relief-f  <cit> . the results in figure  <dig> show that our method consistently outperforms kwrst and relief-f in prediction accuracy when the number of top-ranked genes is small enough. although for the prostate dataset only top two genes obtain high prediction accuracy  that is obviously greater than that of kwrst and relief-f with the same number of genes, our method is still effective because this case still conforms to our goal that the most important tumor-related gene is ranked first. however, our method aims at finding as many more important tumor-related genes as possible, even though the important genes might include redundant ones from the viewpoint of classification. thus the prediction accuracy might be worse as the number of top-ranked genes increases. for example, the prediction accuracy curves of leukemia and prostate in figure  <dig> appear the situation. 

moreover, better results can be achieved with more pre-selected genes by kwrst and with an acceptable search breadth increased in hbsa. for example, on the cross platform leukemia dataset, with the top  <dig> genes pre-selected by kwrst and the search breadth w of  <dig>  the top eight genes selected by hbsa-knn are {l <dig>  m <dig>  m <dig>  x <dig>  hg1612-ht <dig>  x <dig>  u <dig>  m31523} in which three genes l <dig>  hg1612-ht <dig> and x <dig> are not in the leukemia  <dig> test set. among these shared genes, the set of the top three genes {m <dig>  m <dig>  x95735} obtains  <dig> % prediction accuracy on the independent test set, and the top five genes {m <dig>  m <dig>  x <dig>  u <dig>  m31523} and the top  <dig> genes can result in  <dig> % and  <dig> % prediction accuracies, respectively. more importantly, these important genes selected with this search breadth are shared with those genes shown in additional file 1: table s <dig>  for the all dataset, the top eight genes selected by hbsa-knn are {36985_at, 38242_at, 32207_at, 1287_at, 37470_at, 35974_at, 34168_at, 38518_at} in which only the rank orders of a few genes are changed compared with the same genes in additional file 1: table s <dig>  the top seven,  <dig> and  <dig> genes can obtain 96%, 98% and 99% prediction accuracies, respectively, which are obviously improved compared with the corresponding results  with less preselected genes and narrower search breadth. in conclusion, if the number of the initially selected genes and the search breadth are more appropriate, the prediction accuracy by hbsa will be further improved, which further proves that our method is indeed robust.

biological validation of the top-ranked genes
the association of top-ranked genes with tumor is analyzed in the context of individual gene function, pathway analysis, and protein-protein interaction  network to validate the effectiveness of the results. we first validate the top-ranked genes as tumor-related genes by known cancer gene list. some unvalidated genes are validated by cancer linker degree  analysis and relevant biomedical literature. moreover, the selected genes are further validated by the fact that some pathways involving in the selected genes are closely related to tumor development. the following analysis is mainly based on the results obtained by hbsa-knn.

individual gene based literature validation
the top  <dig> genes selected by hsba-svm and hsba-knn are listed in additional file 1: tables s5-s <dig> and s17-s <dig>  respectively. the known cancer genes were downloaded from the website .  <dig> known cancer genes are collected by querying the website for “oncogene”, “tumor suppressor” and “stability”  <cit> . the top  <dig> genes selected are analyzed through relevant biomedical literature. here two case studies of the top-ranked genes on leukemia and prostate are presented as following. more analyses are available in the additional file 1: section  <dig> 

among the top  <dig> genes selected by hsba-knn on leukemia dataset,  <dig> genes  are known cancer genes as listed in additional file 1: table s <dig>  for other genes, by means of biomedical literature search and cld calculation validation only on those among top  <dig> ones, we have successfully validated all the ten genes. the evidence of their involvement in cancer and the number or pubmed ids of references documenting each gene-cancer association are shown in table  <dig>  cd <dig>  is expressed on the malignant blast cells in most cases of acute myeloid leukemia  but not on normal hematopoietic pluripotent stem cells  <cit> . in vivo ablation of cd33+ cells achieves good results when treating patients with acute myeloid leukemia  <cit> . marcksl <dig>  also named multidrug resistant associated protein , are found to be increasedly expressed in some vincristine-resistant cell lines  <cit> . sp <dig>  a nuclear protein identified in numerous different biochemical assays at translocation break points, is associated with a subtype of acute myeloid leukemia  <cit> . cd <dig>  belongs to a newly defined family of genes for membrane proteins including cd <dig> which was recognized by monoclonal antibodies inhibitory to human t cell leukemia virus type 1-induced syncytium formation  <cit> . tcf <dig>  is involved in 19p <dig> chromosome rearrangement and acts as a tumor suppressor gene in b-cell precursor acute lymphoblastic leukemia  <cit> . cst <dig>  also named cystatin c, was elevated in cancer patients than in controls. 

the genes are sorted according to their frequency. if a gene is validated in the literature, the corresponding reference is shown .

for the prostate dataset, among the top  <dig> genes ranked by hsba-knn,  <dig> genes  are known cancer genes . for other selected genes, we perform manual literature validation only on those among top  <dig> ones. we successfully validate nine of these ten genes .

the column is the same as described in table <dig> 

a major 11-locus haplotype of snps in the hepsin gene , is significantly associated with prostate cancer, which supports that hpn  is a potentially important candidate gene involved in prostate cancer susceptibility  <cit> . slc25a <dig>  also named ant <dig>  is selectively required for tnf-α and oxidative stress-induced cell death in mcf- <dig> cells  <cit> . kibra is involved in estrogen receptor transactivation in breast cancer cells. altered rbp <dig> expression and hypermethylation are common in prostate carcinoma. both prostate adenocarcinoma and intraepithelial neoplasia show frequent rbp <dig> overexpression. chd <dig> and nell <dig> have cld of four and two respectively as shown in the following network based analysis. the gene a2r6w <dig> was identified from aspergillus niger and is hypothesized as a nucleus protein binding zinc ion and dna for transcription regulation. its relation with cancer deserves investigation.

network-based analysis for top  <dig> genes
aragues et al. <cit>  demonstrated that cld of a protein, defined as the number of cancer genes to which it is connected, was a good indicator of the probability of being a cancer gene. we apply a protein-network-based method to analyze the neighborhood partners of the selected genes using all interactions in the human protein reference database   <cit> . the results are shown in additional file 1: figures s4-s <dig>  for the leukemia dataset, among the  <dig> top-ranked genes, two genes  are cancer ones, five  and one other genes  are directly or indirectly associated with cancer genes, respectively. the clds of aplp <dig>  cd <dig>  sp <dig>  cd <dig>  psme <dig>  which are ranked first, second, fifth, seventh and ninth, respectively, are  <dig>   <dig>   <dig>   <dig> and  <dig>  respectively. ttc <dig> and marcksl <dig> show no cancer gene linking, of which marcksl <dig> are increasedly expressed in some vincristine-resistant cell lines  <cit> .

for the prostate dataset, our results show that three genes, namely maf, abl <dig> and serpinb <dig>  are cancer ones and most other top-ranked genes have a direct interaction with known cancer genes. the cld of maf, hpn, abl <dig>  chd <dig>  wwc <dig>  nell <dig> and rbp <dig> is  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  respectively. we therefore infer that even if the remaining few genes not reported as cancer genes by previous studies are very possibly play a critical role in tumor genesis and cancer cell process as suggested by the fact that they interconnect directly with known cancer genes and ‘guilt of association’ rule.

validation based on pathway analysis
the top-ranked genes are analyzed in the context of biological pathways on the website http://vortex.cs.wayne.edu/projects.htm. the pathways that the genes selected are most likely involved in are listed in additional file 1: tables s11–s <dig> and tables s23–s <dig>  where p-values are calculated by  and only ten pathways with the lowest p-values are selected. this approach is based on the assumption that the numbers of genes participating in different pathways conform to hypergeometric distribution. given n genes in which m genes participate in a pathway f, we randomly select k genes which are considered to be significant. then the p-value of having x or fewer genes in f can be calculated by summing the probabilities of a random list of k genes having  <dig>   <dig>  ⋯, x genes of category f:

  p=∑i=0x 

when n is very large, the hypergeometric distribution tends to be binominal. in this case, the p-value could also be calculated as:

  p=1−∑i=0x−1kiik−i 

the top-ranked pathways in which the top  <dig> genes are involved include cell proliferation , genomic stability , angiogenesis  signaling pathway),cancer metastasis ,tumor suppressor pathway , immunity escape  or progression of one specific or more than one kinds of cancers, etc.

owing to a large number of top pathways involved, by means of biomedical literature we validate the tumor relevance of only four pathways supported by both hbsa-svm and hbsa-knn. for leukemia, b-cell antigen receptor  signal pathway is important for the survival of chronic lymphocytic leukemia cells which is regulated by overexpressed active protein kinase cβ  <cit> . heterogeneity in leukemia stem cell self-renewal potential supports the hypothesis that they derive from normal hematopoietic stem cells  <cit> . many transcription factors are either tumor suppressors or oncogenes, thus, mutations or aberrant regulation of them is associated with cancer  <cit> . dna excision repair profiles of normal and leukemic human lymphocytes are different  <cit> .

for the prostate dataset, osman et al. <cit>  hypothesized that a pathway of prostate cancer progression involves p <dig> inactivation by mdm <dig> overexpression and that p <dig> transactivation via an alternative signaling system, rather than through a p53-dependent mechanism. insulin signalling pathway is involved in the pathogenesis of various malignancies, increase cancer risk through its effect on cell proliferation, differentiation and apoptosis, and was reported to be involved in the tumorigenesis and neoplastic growth of the prostate  <cit> . the linkage of the morphological and functional changes of nucleolus and ribosome to cancer are reviewed in literature  <cit> . for cell cycle pathway, investigation has revealed that androgen acts as a master regulator of g1-s phase progression, able to induce signals that promote g <dig> cyclin-dependent kinase in prostate cancer cells  <cit> .

we can conclude from the above signal pathway analysis that most of the pathways involving the selected genes are associated to the tumorigenesis, neoplastic growth or metastasis of tumor. from the analysis in the context of the molecular basis, the ppi networks and the pathways, we infer that the top-ranked genes are useful for cancer diagnosis as important potential biomarkers and may also provide insights into the mechanism of tumor genesis, development and metastasis.

discussions
to find optimal gene subsets from tremendous gene space, a challenge is how to avoid the effects of the curse of dimensionality. usually, preliminary gene selection is often regarded as an indispensable step of classifier construction process. however, if it is performed only once on whole dataset and the performance is further evaluated by cv method, such gene selection may lead to an overoptimistic classification performance  <cit> . even though the optimal gene subsets are selected independently on training set without the feedback of the test set and evaluated on independent test set, gene selection may also lead to over-fit the training set even test set if done improperly. on the other hand, over-fitting can also be easily caused by too many potential genes to discriminate among a small number of samples  <cit> , which is evident by the fact that among the numerous gene subsets that can obtain 100% or nearly 100% k-fold cv accuracy on training set, only few can obtain very high prediction accuracy on independent test set. this is the reason why different methods usually find different optimal gene subsets and why many existing gene selection methods cannot consistently perform well on all tumor datasets. to address the over-fitting and selection bias problems, we adopt simple majority voting strategy to construct hbsa-based ensemble classifier with the optimal gene subsets. the results show that our ensemble classifier can efficiently avoid over-fitting and improve the stability of prediction performance.

intuitively, the construction of classification model with more genes would obtain better generalization performance, but in fact the classifier constructed in such way usually leads to the bias of results. more importantly, we do not determine which genes contribute more to the classifier if a complicate classifier is used. as stated by dabney  <cit> , “a complicated classification model may be rejected for a simpler alternative even if the simpler alternative does not perform as well.” we observed that although simpler classification model constructed with fewer genes may be a little worse in accuracy than that with more genes, the results obtained by the simpler model result in less bias. we conclude that only a few top-ranked genes are enough for obtaining good classification performance. particularly, when the number of the discriminate genes approximately equals to the number of subclasses in a dataset, high prediction accuracy is always obtained.

to prioritize genes for a specific tumor, the occurrence frequency of each gene in the selected gene subsets is counted and these genes are ranked according to the counted frequency to measure the importance of corresponding genes with respect to tumor. our analysis based on protein-protein interaction network, individual gene function through relevant literatures and biological pathway demonstrate: 1) most of the top-ranked genes are important cancer genes or linked with cancer genes; 2) they are involved in cancer genesis, development, invasion, metastasis or angiogenesis. thus these few top-ranked genes are useful for the screening of cancer genes and cancer biomarkers for tumor diagnosis, molecular treatment targets as a cancer-related gene pool and may also provide some insight into the mechanism of carcinogenesis and cancer development.

we also find that the occurrence frequency of a gene with respect to the number of those genes whose frequencies are greater than the corresponding frequency follows power-law distribution. as we know, power-law distribution is a universal phenomenon in nature. gene regulatory network is widely accepted as a complex scare-free one with the property of power-law degree distribution. in such network, nodes represent genes and a link between two genes represents interaction between the two genes, and some nodes are more highly connected  <cit> . no doubt that the nodes with high degree play a very important role in network because structure always affects function. there may be no or weak interaction  among the genes in the same optimal gene subset selected by hbsa, but the classification accuracy is the combined effect of the genes in an optimal gene subset. if we design a cooperation network in which nodes represent genes in an optimal gene subset and a link between each two genes in the gene subset represents cooperation between the two genes. there is no cooperation between two genes belonging to different optimal gene subsets. the node-degree distribution of the network constructed in such way by all gene subsets in a* obviously follows power-law degree distribution. in such virtual network the genes with high node-degree correspond to the ones with high frequency in the optimal gene subsets, and these genes should closely involved in an actual gene regulatory network related to tumor.

however, the ppi network based analyses suggest that tumor-related genes are not always highly linked or hub ones in biological processes as indicated by the node linking degree. the node linking degree is the number of proteins that a node  directly links and the nodes with higher degree are assumed as more important or hub proteins. for the prostate dataset, abl <dig>  a cytoplasmic and nuclear protein tyrosine kinase encoded by its proto-oncogene, ranked the third in additional file 1: table s <dig>  is implicated in cell processes of cell differentiation, cell division, cell adhesion, and stress response, has a node linking degree of  <dig>  with a cld of  <dig>  however, the protein maf encoded by the first ranked gene maf, another proto-oncogene, has a linking degree of only  <dig> degree in the ppi network, with a cld of seven. for the srbct dataset, the fourth gene cav <dig> in additional file 1: table s <dig>  a tumor suppressor gene candidate that encodes protein caveolin  <dig>  has a linking degree of  <dig> in the ppi network, while the three proteins encoded by the top three genes cd <dig>  mllt <dig> and igf <dig> in additional file 1: table s <dig> are  <dig>   <dig>  and  <dig>  respectively and have much lower cld. one reason is that the protein-protein interactions in hprd are most physical ones while our referred interactions of the selected genes are most functional. since protein-protein interactions are highly dynamic in different cell states or highly different in different types of cells, the divergence may also be explained by the fact that the biological pathways in cancer cells may be greatly different or changed from pathways in normal cells, where many abnormal protein-protein interactions may be opened and normal interactions are closed. however, the real position of the cancer-related genes in the cancer oncogenesis and development pathways needs further study.

our contribution in this paper is to propose two methods, namely the construction method of hbsa-based ensemble classifier and the hbsa-based gene ranking method, to obtain unbiased classification performance and find important tumor-related genes more biologically meaning in molecular tumor diagnosis. unlike other search-based gene selection methods, such as ga/svm  <cit>  and sequential forward search   <cit>  that find only one optimal gene subsets, our hbsa can find as many optimal gene subsets as possible on training set and obtain determined results in each run. more importantly, these gene subsets by hbsa have the same minimum cardinal number which can ensure that it is reasonable to measure the significance of gene by using its occurrence frequency. generally, hbsa-based gene ranking method is also different from many traditional gene ranking methods because our method simultaneously takes into account the discrimilability of individual gene and the relationship among multiple genes , while many traditional univariate filters-based gene selection methods often select the top-ranked genes only according to their individual discriminative power and a few multivariate filters-based methods only consider gene dependencies to improve classification performance. however, our method does not remove the redundant genes from the top-ranked genes because these redundant genes might be very important tumor-related genes  <cit> . on the other hand, our ensemble classifier is constructed by simplest but optimum individual classifiers on training set, which is different from other ensemble classifiers such as bagging  <cit> , boosting  <cit>  and random subspace method  <cit> , in which individual classifiers are constructed by randomly resampling in sample set or feature set.

CONCLUSIONS
many machine learning and statistical algorithms for gep-based tumor classification are available, but many of these methods might suffer from the problems of over-fitting and gene selection bias because the number of genes far exceeds the number of tumor tissue samples. thus, we proposed two novel and robust methods  to obtain high but unbiased prediction accuracy on independent test set and to find the most important tumor-related genes. hbsa-based ensemble classifier is constructed by using majority voting strategy on the basis of the selected optimum gene subsets selected by hbsa to improve the stability of the classification performance. hbsa-based gene ranking method is to prioritize the genes by using their occurrence frequencies counted in all of the selected gene subsets so that a set of significant genes can be found, which can be used as the biomarker of clinical tumor diagnosis and prognosis. although hbsa implicates two problems: over-fitting and selection bias, both the proposed hbsa-based ensemble classifier and hbsa-based gene ranking method can successfully avoid the two problems. moreover, the two methods are robust, stable and global optimum when such gene subsets selected are enough because the two methods are statistically established on the basis of the optimal gene subsets. particularly, our methods not only are simple but also have rich biomedical interpretability. the experimental results indicate that our method can obtain high prediction accuracy with approximately minimum gene subset, and it overcomes the problem that too many genes can also lead to over-fitting phenomenon  <cit> .

by comparing hbsa-svm and hbsa-knn, we find that hbsa-knn-based gene ranking method is slightly superior to hbsa-svm-based one in gene selection. and the comparison of hbsa-svm and hbsademonstrates the bias degree of results. most importantly, the analyses on the top-ranked genes in the context of individual gene function, pathway and ppi network biomedically justify our method. we also find that the occurrence frequency of gene in the optimal gene subsets with respect to the number of gene whose frequency is greater than the corresponding frequency follows power-law distribution, so we further infer that the important or hub genes related to tumor might be few. it may partly explain our finding that the number of informative genes that approximately equals to the number of subclasses in dataset is enough for obtaining good generalization performance. lastly, we find that the genes with maximum differential expression among subclasses are not always the most important tumor-related genes, and some most important tumor-related genes are possibly those less differentially expressed ones.

our future work will be mainly focused on utilizing the prior biomedical knowledge and exploring new heuristic search algorithms to reduce the time complexity of our current method. we are currently designing a novel time-saving method based on neighborhood rough set model to implement the same idea as this paper.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
shu-lin wang designed the hbsa algorithm and developed the computer programs in matlab, performed the experiments, and drafted the manuscript. xue-ling li and jianwen fang helped shu-lin wang to analyze the numerical results with relevant biomedical literatures and revised the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file  <dig> 
supplementary tables and figures 

click here for file

 acknowledgments
we sincerely thank gustavo a. stolovitzky  for providing us the dlbcl <dig> dataset. and we also cordially thank prof. ji wang  for his inspiring suggestion. we also thank chungui xu, junfeng xia and meiling hou for their contribution to the analysis of part of genes. this work was supported by the national science foundation of china , the china postdoctoral science foundation , and anhui provincial natural science foundation .
