BACKGROUND
often the first step in characterizing a group of related non-homologous proteins  is to identify statistically significant patterns of amino acid enrichment or depletion. here we introduce composition profiler, a web-based software that automates this task and graphically summarizes the results. composition profiler is also available as a stand-alone command line application that can be used for task automation or analysis of large samples. the following sections will introduce the methodology and discuss several examples of composition profiles in greater depth.

methods
fractional differences
let p denote the protein sample under study, q the background sample, and let pk and qk denote the probabilities of observing amino acid k in the two samples. let us assume that the amino acid compositions of the two samples p and q are independent and identically distributed, each generated by a separate stochastic process according to probability distributions p =  and q = . the probability distributions p and q are estimated by computing the means and confidence intervals of the relative frequencies of residues observed over a set of pseudo-replicate datasets obtained by bootstrap sampling of whole proteins from the original samples p and q. we define the fractional difference h between distributions p and q as

 hk=pk−qkqk,where k=ala,arg, ...
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemiaag2aasbaasqaaiabdugarbqabagccqgh9aqpdawcaaqaaiabdchawnaabaaaleaacqwgrbwaaeqaaogaeyoei0iaemycae3aasbaasqaaiabdugarbqabaaakeaacqwgxbqcdawgaawcbagaem4aasgabeaaaagccqggsaalaeaacqqg3bwdcqqgobaacqqglbqzcqqgybgccqqglbqzcqqggaaicqwgrbwacqgh9aqpcqqgbbqqcqqgsbabcqqghbqycqggsaalcqqgbbqqcqqgybgccqqgnbwzcqggsaalcqqggaaicqgguaglcqgguaglcqgguaglaaaaaa@523a@ 

figures  <dig> and  <dig> show several examples of compositional difference plots produced by composition profiler. the values for hk are displayed as bar heights, and the error bars ek represent fractional differences of the standard deviations of observed relative frequencies of the bootstrap samples. more precisely

 ek=−qk+σq,k−hk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaem4aasgabeaakiabg2da9maalaaabagaeiikagiaemicaa3aasbaasqaaiabdugarbqabagccqghrawkiigacqwfdpwcdawgaawcbagaemicaanaeiilawiaem4aasgabeaakiabcmcapiabgkhitiabcicaoiabdghaxnaabaaaleaacqwgrbwaaeqaaogaey4kasiae83wdm3aasbaasqaaiabdghaxjabcycasiabdugarbqabagccqggpaqkaeaacqwgxbqcdawgaawcbagaem4aasgabeaakiabgucariab=n8aznaabaaaleaacqwgxbqccqggsaalcqwgrbwaaeqaaaaakiabgkhitiabdigaonaabaaaleaacqwgrbwaaeqaaaaa@5554@ 

where σ p,k and σ q,k are standard deviations of frequencies of amino acid k in bootstrap samples based on p and q, respectively.

statistical significance associated with a specific value of hk is estimated using the two-sample t-test between two sequences of binary indicator variables, one sequence for each of the samples p and q. a particular hk is statistically significant when the lowest value at which the null hypothesis that the same underlying gaussian distribution generated both p and q can be rejected, is smaller than a user-specified statistical significance  value. to avoid spurious significance which may appear by chance alone due to the number of statistical tests performed, the conservative bonferroni correction can be optionally used to adjust the test-wise significance cut-off by dividing the α-value by the number of individual significance tests performed.

relative entropy
fractional differences provide a detailed, per amino acid, characterization of the dissimilarity between two samples. however, there are situations when it is useful to summarize the degree of dissimilarity into a single value, for example, when a large number of samples need to be compared against each other to determine pairwise similarities. relative entropy  is an information theoretical measure that quantifies the distance between two probability distributions. using the frequencies of residues in samples p and q as the maximum likelihood estimate for the underlying probability distributions p and q, the relative entropy of the sample p with respect to the sample q is defined as

 h=∑kpklog⁡,where k=ala,arg, ...
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemisagkaeiikagiaemicaanaeiifawnaeiifawnaemycaenaeiykakiaeyypa0zaaabeaeaacqwgwbacdawgaawcbagaem4aasgabeaakigbcygasjabc+gavjabcegannaabmaabawaasaaaeaacqwgwbacdawgaawcbagaem4aasgabeaaaoqaaiabdghaxnaabaaaleaacqwgrbwaaeqaaaaaaogaayjkaiaawmcaaawcbagaem4aasgabeqdcqghris5aogaeiilawcabagaee4dacnaeeiaagmaeeyzaumaeeocainaeeyzaumaeeiiaaiaem4aasmaeyypa0jaeeyqaekaeeibawmaeeyyaemaeiilawiaeeyqaekaeeocainaee4zacmaeiilawiaeeiiaaiaeiola4iaeiola4iaeiola4caaaaa@5fef@ 

relative entropy is always non-negative, and its value reaches zero only when two amino acid distributions are identical. it is not symmetric, that is, h  is not necessarily equal to h .

statistical significance of the observed relative entropy value between p and q was evaluated using relative entropy as the test statistic. under the null hypothesis that amino acid compositions of the two samples came from the same underlying distribution, the p-value is estimated as

 p−value=∑i=1ni≥h)n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgwbaccqghsislcqqg2bgdcqqghbqycqqgsbabcqqg1bqdcqqglbqzcqgh9aqpdawcaaqaamaaqadabagaemysak0aaewaaeaacqwgibascqggoaakcuwgwbacgaqcamaabaaaleaacqwgpbqaaeqaaogaeiifawnaeiifawnafmycaenbakaadawgaawcbagaemyaakgabeaakiabcmcapiabgwmizkabdieaijabcicaoiabdchawjabcyha8jabcyha8jabdghaxjabcmcapagaayjkaiaawmcaaawcbagaemyaakmaeyypa0jaegymaedabagaemoba4ganiabgghildaakeaacqwgubgbaaaaaa@5804@ 

where p^i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgwbacgaqcamaabaaaleaacqwgpbqaaeqaaaaa@2fac@ and q^i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgxbqcgaqcamaabaaaleaacqwgpbqaaeqaaaaa@2fae@ are amino acid compositions of pseudo-replicate datasets obtained by bootstrap sampling of whole proteins from the original samples p and q, i is the indicator variable which takes the value  <dig> if the condition t is true, and  <dig> otherwise, and n is the total number of bootstrap iterations.

background distributions
composition profiler provides composition statistics for four standard amino acid datasets, computed as means and standard deviations over  <dig>  bootstrap iterations, to be used as background distributions . these datasets are:  swissprot  <dig>  <cit> , most similar to the distribution of amino acids in nature out of the four;  pdb select  <dig>  a subset of structures from the protein data bank  <cit>  with less than 25% sequence identity, biased towards the composition of proteins amenable to crystallization studies;  surface residues determined by the molecular surface package  <cit>  over a sample of pdb structures of monomeric proteins, suitable for analyzing phenomena on protein surfaces, such as binding; and  disprot  <dig> , is a set of consensus sequences of experimentally determined disordered regions  <cit> .

depending on the nature of the query sample, other suitable background distributions might be representative samples of proteins from the organisms under study, or samples of proteins with contrasting functional annotation.

physico-chemical and structural properties
in addition to the ability to determine enrichment or depletion patterns of individual amino acids, composition profiler can also detect enrichment or depletion of groups of amino acids classified by aromaticity, charge, polarity , hydrophobicity , flexibility , surface exposure , solvation potential  <cit> , interface propensity  <cit> , normalized frequency of occurrence in α helices, β structures, and coils  <cit> , linker  <cit>  and disorder  <cit>  propensities, size  <cit>  and bulkiness  <cit> .

RESULTS
the graphical output of composition profiler is a bar chart composed of twenty data points, one for each amino acid , where bar heights indicate enrichment or depletion and error bars correspond to one standard deviation, as described in equations  <dig> and  <dig>  the output is designed to assist the discovery of statistically significant composition anomalies by color-coding and sorting residues according to their physico-chemical or structural properties. for example, if the property being tested is flexibility, the tool will group rigid amino acids on the left hand side of the plot and flexible amino acids on the right hand side of the plot.

when run in discovery mode, composition profiler will test all groupings of amino acids according to the listed properties for statistically significant differences between the two samples. the discovery mode uses a two-sample t-test between two sequences of binary indicator variables .

in the following sections we examine composition profiles of several groups of proteins and discuss general trends observed.

heterodimer interfaces
protein-protein interaction sites have been intensively studied in an attempt to understand the molecular determinants of protein recognition and to identify specific characteristics of the interactions, such as residue propensities, residue pairing preferences, hydrophobicity, size, shape, solvent accessibility, and hydrogen bond protection. homocomplexes, for example, are often permanent and optimized, whereas many heterocomplexes are nonobligatory, associating and disassociating according to the environmental or external factors and involve proteins that must also exist independently  <cit> . figures 1a and 1b give composition profiles of interface residues of homodimers and heterodimers in comparison to the amino acid composition of surfaces of monomeric proteins. both kinds of interfaces are generally enriched in hydrophobic residues , which in part explains their propensity towards complexation. interfaces of heterodimers are enriched in polar histidine and tyrosine, which is consistent with the finding that transient protein-protein complex interfaces are more polar than those of stable oligomeric proteins  <cit> . heterocomplex interfaces are enriched in all three major aromatics , as these three residues are bulky, planar and rigid which enhances the prospects for binding.

hub proteins of c. elegans ppi network
a potential association between protein connectivity and protein intrinsic disorder was studied for proteins with various numbers of interacting partners from four eukaryotic organisms   <cit> . a more detailed analysis revealed that hub proteins, defined as proteins interacting with at least  <dig> partners, are significantly more disordered than end proteins, defined as those that interact with just one partner. to test the compositional bias of hubs and ends, the fractional difference between hubs and ends compositions and pdbs <dig> compositions was calculated. this analysis revealed that that hubs are enriched in many of the disorder-promoting amino acids, whereas compositions of ends were shown to be relatively close to that of ordered proteins. this study demonstrated that intrinsic disorder is a distinctive and common characteristic of eukaryotic hub proteins, and that disorder may serve as a determinant of protein interactivity. this particular example  shows the composition profile of hub proteins from c. elegans. the red-colored bars on the right hand side of the graph represent disorder-promoting residues.

discussion
the need for analyzing sequences against an appropriate background can best be illustrated by running composition profiler on any of the four standard distributions against the remaining three and observing the differences in composition. surface residues from monomeric proteins  and regions of protein disorder  generally show depletion in low flexibility  and enrichment in high flexibility residues. unlike the disordered region dataset, surface residues are enriched in tryptophan, tyrosine  and histidine . one of possible explanations for this is the preference for their presence in the active sites, where those bulky and planar residues may provide geometric restrictions and help in establishing appropriate contacts with substrates or ligands. in comparison with swiss-prot, proteins from pdb select  <dig>  are enriched in the major order-promoting residues  and depleted in disorder-promoting residues . it is of interest to observe the enrichment of disorder-promoting residues such as asparagine, aspartic acid, and lysine in pdb select  <dig> proteins.

CONCLUSIONS
the notion of fractional difference as a measurement of the relative variation between the two samples was first employed by romero et al.  <cit> . it has since been used in studies of cell-signalling and cancer-associated proteins  <cit> , serine/arginine-rich splicing factors  <cit>  and hub proteins of ppi networks  <cit> , among others.

as an exploratory data mining tool, our software can be used to guide feature selection for protein function or structure predictors – good features are ones that discriminate well between the two samples. for classes of proteins which show enrichment in amino acids having particular physico-chemical properties, composition profiler can be thought of as a rough, light-weight visual classifier. for example, composition profiles with fractional differences which show enrichment in disorder-promoting residues constitute strong indications of intrinsic disorder  <cit> .

availability and requirements
project name: composition profiler

project home page: 

operating system: linux, mac os x

programming language: ruby, c, c++

other requirements: ghostscript, imagemagick, gnuplot  <dig> , apache web server

license: mit open source license

any restrictions to use by non-academics: none

authors' contributions
akd originated the fractional difference method. vv wrote the application and drafted the manuscript. vnu provided relevant biological examples. sl, vnu, and akd helped in drafting the manuscript. all authors read and approved the final manuscript.

