BACKGROUND
structure-based virtual ligand screening  allows to investigate thousands or millions of molecules against a biomolecular target  <cit> , and as such it plays an increasingly important role in modern drug discovery programs. for example, numerous sbvls methods employing docking and scoring have been developed to assist the discovery of hit compounds and their optimization to leads  <cit> . these methods orient and score small molecules in a protein-binding site, searching for shape and chemical complementarities. many novel active compounds acting on key therapeutic targets have been found through combining sbvls and in vitro screening experiments  <cit> . despite the considerable progresses achieved these recent years, several problems are still present in most of the currently available sbvls packages. among the most critical is the flexibility of the receptors that frequently change their conformations upon ligand binding. several methods have been developed to attempt to take into consideration receptor flexibility during docking/scoring  <cit> , however, this is still very challenging because the number of conformations rises exponentially with the number of rotatable bonds and the full sampling of all possible conformations is not feasible for a large number of protein-ligand complexes.

further the correct prediction of receptor-ligand binding energies  <cit>  and accurate ranking of the compounds with respect to their estimated affinities to a target remains highly challenging. thus it is still difficult to discriminate bioactive compounds from false positives  <cit>  despite recent efforts to improve enrichment via, for instance, docking on different protein targets  <cit>  or through optimized or new scoring functions  <cit> . in addition, and among the many players that are important in sbvls computations, the quality of the screened chemical libraries has also been shown to be important in order to correctly predict the bound ligand-conformations and for ranking  <cit> . within this context, further refinements and optimization of vls docking-scoring methods are needed.

recently it has been suggested that post-docking optimization, either after conventional docking-scoring procedures or after hierarchical vls protocols  <cit>  may help to further improve both, the docking pose and the scoring, and as such the overall efficiency of sbvls experiments. recent examples of docked poses and enrichment improvements after post-docking energy minimization support this view  <cit> .

in the present study, we propose a new open source program, named ammos, which addresses some of the pre- and post-processing problems associated with sbvls computations, through molecular mechanics  modeling. ammos executes an automatic procedure for:  energy minimization of pre-docked protein-ligand complexes allowing partial or full atom flexibility from both, the ligand and the receptor sides and  structural optimization of chemical compounds present in the screening libraries prior to docking experiments. mm is currently a very reliable approach to model protein-receptor interactions in a physically realistic manner  <cit>  since it can account for local flexibility adjustments from both, the protein and the ligand although conformational exploration is not possible if large conformational changes occur. it is indeed reasonable to apply such framework instead of more computer demanding simulations  in large-scale applications involving the handling of thousands of compounds. in conventional mm studies, the bonded interactions include the bonds, bond angles and dihedral terms while the non-bonded interactions involve the van der waals term represented by the lennard-jones  6– <dig> potential, and electrostatic interactions, often treated by coulombic potential computed between point charges centered on relevant atoms. ammos proposes relatively fast energy minimization by making use of the full-featured molecular mechanics program ammp  <cit> . ammp is available upon gnu license and has been recently implemented in the well-known opengl molecular modeling package vega  <cit> . in particular, vega implements ammp for energy minimization with all the available optimization methods. however, to the best of our knowledge, vega can not minimize chemical libraries nor a large number of pre-docked protein-ligand complexes. ammp has several advantages that make it relevant for the present applications such as: a fast multipole method for including all atoms in the calculation of long-range potentials and robust structural optimizers. ammp has a flexible choice of several bonded and non-bonded potentials and permits analysis of individual energy terms. an additional advantage of ammp is that it allows straightforward introduction of non-standard polymer linkages and non-standard amino-acid residues as well as manipulation of both small molecules and macromolecules including proteins, nucleic acids and other polymers. furthermore, extensive benchmarking of ammp has been performed highlighting its accuracy in term of energy minimization of proteins . up to now, ammp has been successfully applied in numerous modeling studies of proteins and protein-ligand complexes  <cit>  but it has not been used thus far for sbvls computations as numerous implementations would be necessary to apply it automatically on thousands of small molecules, either present in a database or docked in a receptor binding site.

in this article we describe the development, implementation and evaluation of the ammos approach for automatic energy minimization of protein-ligand complexes or of small organic molecules. first energy minimization with ammos was validated by refinement of a large chemical library and by comparison of small molecule optimizations with two well established force fields available in the package sybyl  <cit> . the efficiency of ammos for optimization of pre-docked protein-ligand complexes was then examined through performing calculations on two protein targets, namely estrogen receptor  and neuraminidase . these two proteins were selected because they are often used in sbvls studies and because their binding pockets display rather different physicochemical properties and geometries. we used a multi-step sbvls protocol to generate protein-ligand complexes. our first vls stage employed a search for satisfactory shape complementarity allowing rational reduction of the size of the initial chemical library. the pre-docked complexes subjected to ammos minimization were generated via the second step involving flexible-ligand docking. finally we tested ammos as a final re-scoring engine on the selected pre-docked protein-ligand complexes for both, er and na. the obtained results are promising and suggest that ammos can be successfully applied as a post-processing tool to improve enrichment.

methods
ammp molecular mechanics
ammos makes use of the molecular simulation package ammp  <cit> , a program that can easily be embedded in other packages. ammp allows to introduce standard or non-standard polymer linkages , unusual ligands or non-standard residues, as well as to complete partial protein structures. ammp incorporates a fast multipole algorithm for the efficient calculation of long-range forces thereby allowing evaluation of non-bonded terms without the use of a cutoff radius and increasing the speed, making calculations comparable to a standard treatment with a 8– <dig> Å radius cutoff  <cit> . the ammp force field  <cit>  is developed on the basis of the uff potential set  <cit>  and the amber partial charges  <cit> . the initial uff set has been optimized for biological molecules  <cit>  in order to improve the agreement with experimental geometry and spectral data. the first developed ammp force field was the set sp <dig>  <cit> . lately, bagossi and co-authors  <cit>  proposed the modified parameter set for ammp  with improved generation of partial charges for a wider range of compounds especially adapted for modeling of macromolecules, where the electrostatic parameters have been modified to achieve better correlation with experimental dipole moments. mopsa parameter set has been merged with the ammp parameter set sp <dig> to generate the new standard force field set sp <dig>  <cit> .

we tested several minimization methods as implemented in ammp. the steepest descent method  <cit>   that uses the first derivatives of the energy function to find a local minimum, is available in ammp, but this does not necessarily produce the fastest convergence. the poliak-ribeire conjugate gradient method   <cit> , performing a search along conjugate directions, can produce generally faster convergence, is also implemented in ammp. for the second-order minimization methods, the broyden-fletcher-goldfarb-shanno  approach  <cit>  that belongs to the quasi-newton methods  <cit> , is available in ammp. the non-derivative polytope simplex method  <cit> , as well as a genetic algorithm   <cit>   are also implemented in ammp.

energy minimization protocols
energy minimization of small organic molecules using ammos
we explored both ammp force fields, sp <dig> and sp <dig>  on a set of four small molecules structures generated by omega  <dig>   <cit>  . to speed-up ligand parameterization, partial charges on ligand atoms were assigned with the gasteiger-marsili method  <cit>  using the openbabel package  <cit> . the maximum number of iterations was set to  <dig>  all calculations were performed with a convergence value set to  <dig>  or  <dig>  kcal.mol- <dig> Å- <dig>  and no essential differences were observed. thus, we chose  <dig>  kcal.mol- <dig> Å- <dig> as convergence criterion to reduce the computational time. the number of iterations required to reach convergence with the conjugate gradient method  varied between  <dig> and  <dig> for different small compounds. therefore for further analysis, two protocols were assessed: one protocol employing two subsequent steps of  <dig> iterations and one with  <dig> iterations. the minimized and initial structures were compared based on the rmsd values between the non-hydrogen atoms using the superimpose option of the insightii molecular modeling package  <cit> . we should notice that small molecule minimization results depend on initial conformations and this holds for any mm minimization engine. problems with possible biases due to the starting conformation and exploration of other conformers can be circumvented by the use of our multiconformer generator multiconf-dock  <cit>  or of omega prior to minimizing small molecules.

energy minimization of small organic molecules using other force fields
two mm minimization methods implemented in the program sybyl were applied on the same set of small molecules in order to compare the minimization results obtained with ammos. the initial structures of the four small compounds, generated by omega , were optimized by two force fields: the tripos force field   <cit>  and mmff94s  <cit> . tff minimization was performed with gasteiger-huckel charges, and mmff94s, with mmff charges. for both force fields, the following settings were used: distance-dependent dielectric function; non-bonded cutoff  <dig>  Å;  <dig>  kcal.mol- <dig> Å- <dig> energy gradient convergence criterion; simplex initial optimization. for comparison, several runs were performed with  <dig>  kcal.mol- <dig> Å- <dig> convergence and no essential differences in the resulting geometries were recorded. two gradient methods were experimented: powell and conjugate gradient. powell method  <cit>  belongs to the conjugate gradient family of minimization methods. it is also more tolerant to inexact line searches. as a result, it is faster than the conjugate gradient method and is well-suited for a wide variety of problems  <cit> . the number of iterations was set to  <dig> for both methods, in all cases however, the convergence was reached well below this number. because the powell and conjugate gradient results were quite similar, we report here only the data obtained with the powell method. the minimized and initial structures were compared based on the rmsd values between the non-hydrogen atoms using the match option in sybyl. the calculations with sybyl were performed on a silicon graphics octane  <dig>  running under irix  <dig> .

docking and scoring protocol
the pre-docked protein-ligand complexes subjected to energy minimization with ammos were generated via a multi-step docking-scoring protocol with dock <dig>  <cit> . dock <dig> accomplishes a sphere-matching algorithm to fit ligand atoms to spheres representing a negative image of the receptor-binding site. we used the program dms  <cit>  to compute the molecular surface of the receptor. the overlapping spheres within a radius of  <dig> Å were generated on the protein binding site surface using the program sphgen  <cit> . sphere clusters within  <dig> Å to a reference ligand were retained for er and  <dig> Å for na . the first docking step was carried out using rigid body-docking with dock <dig> applying the ms-dock protocol  <cit>  over a compound collection of  <dig> molecules  present in a multi-conformer state without initial minimization with ammos . this stage assesses only shape complementarity and therefore, multi-conformer structures for the small compounds are needed in order to perform this fast "geometric" filtering step. for the positioning of the ligand in the binding site, we applied the faster manual match . as mentioned above, in our calculations, the scores measured only the steric complementarity by use of the contact scoring function that counts the number of receptor-ligand contacts within a  <dig>  Å distance from the ligand atoms. each clash penalized the score by  <dig>  the allowed bump overlaps were chosen to be  <dig>  for na and  <dig>  for er. these values were selected according to our previous observations  <cit> . we have seen that for large and flat cavities binding relatively small ligands like in the case of na, a bump overlap of  <dig>  improves the enrichment after a rigid docking procedure. on the contrary, when large ligands fill well the binding site, a bump overlap of  <dig>  is preferable, a situation encountered with er .

secondly, the retrieved non-minimized top ranked compounds  were directly re-docked using a flexible docking mode  implemented in dock <dig> and employing the incremental built algorithm "anchor-first"  <cit>  with our optimized parameters to better handle ligand flexibility  <cit> . we used a maximum of  <dig> orientations for the anchor fragment. to speed-up the calculations, we set  <dig> configurations per cycle for the growth of the ligands. we applied  <dig> simplex minimization steps to each growth step. all docked molecules were ranked using the standard dock score involving soft van der waals and distance-dependent electrostatic potentials. finally for each ligand we saved up to  <dig> best scored conformers with a rmsd of  <dig>  Å for subsequent minimization with ammos.

dataset preparation
compound collections
energy minimization with ammos and the tff and mmff94s force fields was carried out initially on  <dig> small molecules, taken from several x-ray protein-ligand complexes in the protein data bank   <cit> , namely: raloxifene ; 4--3- benzoic acid  ; thymidine ; thieno pyridine-2-sulfonic acid -amide  .

to test the performance of ammos on a large number of small organic molecules we used the chembridge diversity set  <cit> . our decoy library contained  <dig> molecules after adme/tox filtering with the program filter  <dig> . <dig>  <cit> . we merged  <dig> known active compounds for er and na  and a number of rotatable bonds ranging from  <dig> to15) to the decoy collection. some of the active compounds were taken from the pdb protein-ligand structures:  <dig> for er  and  <dig> for na . when a ligand could not be extracted from the pdb, it was rebuilt from the literature  <cit> . all these active inhibitors were added to the decoy library, all in smiles format. the resulting chemical library was transformed in single 3d conformer and saved in mol <dig> format using the program omega  <dig>   <cit> . the multiconformer states were then generated by our program multiconf-dock  <cit>  applying an energy window of  <dig> kcal.mol- <dig> and a diversity threshold of  <dig> Å rmsd. a maximum of  <dig> conformers were generated for each molecule. these values represent an appropriate balance between speed and accuracy according to the recent studies  <cit> .

protein targets
the performance of ammos for post-processing of the pre-docked protein-ligand complexes was validated on two protein targets. we selected er with a closed and hydrophobic pocket and na with an open and highly polar binding site. these two proteins present a binding site with very different degrees of burial  and polarity  . we took the co-crystallized structures with best resolution among all retrieved protein-ligand complexes . all bound water molecules and crystallized ligands were removed from the binding sites. hydrogens were assigned using the program insightii  <cit> .

RESULTS
algorithm of ammos
ammos drives a fully automatic procedure for minimization of protein-ligand complexes in a situation where the compounds are pre-docked in the binding site by any docking engine. ammos parameters are optimized such as to handle relatively large docked compound collections. figure  <dig> illustrates all the different steps and required inputs, preparation, minimization of protein-ligand complexes with different degrees of protein flexibility, as well as final ranking of the ligands according to the minimized interaction energy between the ligands and the receptor. firstly, ammos employs the program preammp to convert the input protein and ligand files to ammp format. next, ammp autolink is run to search for incomplete amino-acid residues and to finally link all the residues after corrections. ammos allows users to select one among five different solutions to handle protein-ligand complexes: from fully flexible minimization of the whole protein-ligand complex  to a flexible ligand in a rigid receptor  . in all situations, the ligand atoms are free to move. our minimization step with ammp applied on the protein-ligand complexes for the selected protein flexibility case involves 2× <dig> iterations with conjugate gradient optimization. the advances user can select any minimization method available in ammp and specify the minimization parameters . finally, all the minimized conformers are scored by the ammp minimized interaction protein-ligand energy  <cit>  and re-ranked.

implementation of ammos
the package ammos consists of several programs developed in c and python, and makes use of the open source programs ammp and preammp. one ammos routine  ensures the transformation of the input files  to a specific ammp format required by ammp and at the end of the process generate reversely, the protein in pdb format and the small molecules in mol <dig> format. the automatization of the procedure described in figure  <dig> for a large number of ligands in a single or multiple conformer state is accomplished via a python script. five different cases  have been elaborated for the selection of the active/inactive atoms in the protein, while, in all situations, the ligand atoms are flexible: case 1: all atoms of the protein are active ; case 2: all atoms of the protein side chains are active; case 3: all atoms of the protein inside a sphere around the ligand are active; case 4: all atoms of the protein side chains inside a sphere around the ligand are active; case 5: the whole protein is rigid. after processing of the whole pre-docked compound collection, the following results are saved in a subdirectory named output:  the coordinates of all conformers after minimization,  the coordinates of the flexible part of the protein after minimization,  a file with warnings , and  the interaction energy between the protein and the ligands , the internal energies of the ligands or the protein, and total energy  before and after minimization. finally a re-ranking step takes place based on the computed external energies of all minimized ligands. the method selects the best conformer among the multiple ligand conformers. the complete automatic procedure could be run for either sp <dig> or sp <dig> force field. because sp <dig> was not explicitly available in ammp, we created it using the extended and parameterized list of atom types and electronegativity values available in reference  <cit> .

another application of ammos is for the minimization of a large databank of chemical compounds in the absence of a protein. the procedure follows the scheme presented in figure  <dig>  and involves only the steps related to the small molecules, namely preparation and minimization of small molecules and final re-conversion to mol <dig> format.

all vls and ammos calculations were carried out on one mac pro quad-core xeon  <dig>  ghz, 4go ram and on one xeon  <dig>  ghz linux workstation,  <dig>  gb ram. the average time for the minimization on an apple workstation was  <dig>  sec for one small molecule and for one ligand pose in a protein was  <dig> sec for case  <dig> ,  <dig> sec for case  <dig> , and  <dig> min for case  <dig> . thus, execution times when a large number of ligands should be minimized with ammos can be very long. to speed-up the calculations, ammos allows jobs to be ran in parallel mode. the input mol <dig> file containing ligand molecules is divided into chunks of smaller numbers of molecules. during a parallel ammos run, each processor is assigned one chunk of molecules at a time. final ranking of the complete databank containing the energy-minimized ligands is then accomplished after merging of the different chunks.

testing of ammos
i. energy minimization of small organic molecules
prior to test the automatic procedure for minimization of protein-ligand complexes, we first explored the ability of ammos to minimize small organic molecules starting from 3d structures generated by omega. we compared several minimization methods available in ammp  and further compared the results obtained with ammp with two other widely used force fields mmff94s and tff available in the sybyl software.

energy minimization of small molecules with ammos
the initial 3d structures of the four small molecules, raloxifene, fdi, thymidine and pr <dig>  generated by omega were optimized using ammos with the force fields sp <dig> and sp <dig>  table  <dig> and additional file  <dig> present the results for the four molecules and the five different applied optimization methods. for each method, the number of iterations needed to find the local minimum and the energy of the minimized structures are reported. as seen from table  <dig>  sp <dig> and sp <dig> provided very similar results in terms of optimized structural geometries. for pr <dig> and thymidine, lowest energies of the minimized structures with both sp <dig> and sp <dig> were achieved using the conjugate gradient method, followed by bfgs and ga. conjugate gradient and ga gave the best results for raloxifene and fdi. for all tested molecules, steepest descent and simplex search led to minimized structures with higher energies. the above comparison suggests that conjugate gradient and ga produced lowest energies, however ga was much slower due to its stochastic nature. we also minimized structures containing important internal clashes in order to assess the robustness of the approach. after application of steepest descent the minimized structures remained insufficiently optimized, while conjugate gradient succeeded to overcome the clashes . although sp <dig> has been reported to be an improved version of sp <dig>  <cit> , in our work sp <dig> minimized slightly better than sp <dig> in terms of energy differences between the initial and minimized structure, in particular for thymidine and raloxifene. following the above observations, we chose conjugate gradient and sp <dig> as the minimization protocol for subsequent assessment of ammos.

the number of iterations needed to reach convergence  and the minimized energy  and the rmsd values  between the optimized structures with sp <dig> and sp <dig> force fields are given.

as seen from table  <dig>  the required number of iterations for convergence  with conjugate gradient varies between  <dig> and  <dig> for different molecules. the four molecules show different structural properties with various numbers of rotatable bonds:  <dig> ,  <dig> ,  <dig>  and  <dig> . raloxifene and pr <dig> are larger than the other two molecules with molecular weights of  <dig> and  <dig>  respectively. one can see from the figure reported in the additional file  <dig> that after  <dig> iterations with conjugate gradient the energy gradients of all molecules are very close to the convergence criterion. our additional tests confirmed that using  <dig> or 2×  <dig> iterations are an acceptable compromise between geometric optimization and speed. thus, we accepted 2× <dig> iterations as an appropriate number of steps for the automatic ammos procedure aiming at minimizing thousands of small organic molecules or of protein-ligand complexes .

further, we examined  <dig> different potential functions for non-bonded interactions as implemented and named in ammp: 1) nonbon – involving point atom electrostatics; 2) screen – 1s distributed charge electrostatics; 3) debye – debye screened potentials and 4) shadow – 4-d non-bonded for embedding. because compared to the nonbon potential, no significant differences were found with the debye, screen and shadow modes and since they considerably increase the lengths of the calculations, we selected the nonbon potential for further evaluation of ammos .

energy minimization of small molecules with other force fields
the results achieved after application of ammos minimization with conjugate gradient with 2×  <dig> iterations and sp <dig>  were compared with two other force fields – mmff94s and tff applied on the same four small molecules starting from 3d initial structures generated by omega. similar results in terms of energies and structural geometries were obtained with powell and conjugate gradient methods when one of the mmff94s and tff force fields were used. therefore only the results with the method of powell for both force fields mmff94s and tff are reported here. table  <dig> shows the energies of the initial  and minimized  structures, obtained with ammos, mmff94s and tff, as well as the energy differences  between the initial and minimized structures. although energy values obtained by different force fields are not directly comparable, the differences between the energies of the initial and minimized conformations can be indicative of the optimization performance to search for the local minimum. as seen from table  <dig>  generally there is a correlation between Δe values in ammos and the other force fields, thus confirming that ammos is able to remove ligand energy strains.

energies of the initial  and optimized  structures are given in kcal/mol.

the minimization with ammos is performed with 2× <dig> iterations and sp <dig> force field.

energy minimizations of a large chemical library with ammos
the ammos procedure for minimization of small compounds was applied to a chemical library of  <dig> single conformer molecules . figure 3a shows that the differences  between the energies of the ammos minimized and initial structures generated by omega can be up to around  <dig> kcal.mol- <dig>  figure 3b shows in a more illustrative way the Δe distribution in the compounds databank: for 76% of the molecules Δe is below  <dig> kcal/mol, and only 4% of the compounds show Δe values >  <dig> kcal/mol. it should be noted, that ammos succeeded to minimize molecules with very high initial energies. the ammos minimization improves the geometries thus making the optimized structures more appropriate for subsequent docking and scoring. it is interesting to note that we did not succeed to optimize several structures presenting severe internal clashes and thus very high energies with the other minimization protocols like, for instance, steepest descend, at least as implemented in the ammp package. this is of interest since, when the derivatives of the energy function are high, it is usually accepted that steepest descents is the most appropriate minimizer. overall, these results and tests demonstrate the efficiency of ammos in the structural refinement of a compound collection.

ii. energy minimization of protein-ligand complexes with ammos
generation of docked protein-ligand complexes
prior to the minimization step carried out with the ammos procedure, the protein-ligand complexes were generated using a two-step docking protocol . the decoy library contains  <dig>  drug-like molecules and two protein targets were used for the vls experiments. the  <dig>  compounds were docked/scored on each protein target, na and er, employing first rigid body docking performed with our ms-dock protocol  <cit>  and next flexible docking  with dock <dig>  the top ~30% best scored molecules were selected after the rigid docking step and  <dig> known actives for er out of  <dig> were found. in the case of na, we decided to select about 50% of the best-scored molecules after the rigid docking, and among these,  <dig> actives out of  <dig> were present. in our previous study  <cit> , we demonstrated that for large ligands filling well the binding pocket  selecting the top 30% of the database after shape-complementarity filtering by rigid docking gives a sufficient enrichment for a subsequent flexible docking step. when relatively small ligands bind to a very open and flat pocket , 50% of the top ranked ligands after the first rigid docking step should be selected for the subsequent flexible docking step. after flexible docking, we disposed of two target-specific compound libraries, each containing  <dig>  compounds  for er and  <dig>  compounds  for na. these two collections containing pre-docked ligands in a multi-conformer state were subsequently subjected to the ammos minimization protocol.

enrichment studies using ammos
we next investigated the impact of the minimization protocol and rescoring with ammos on enrichment. the ammos runs were performed on er and na for the five developed cases . case  <dig> and  <dig>  were carried out only for the real actives to reduce the calculation time. calculations within the framework of cases  <dig>   <dig> and  <dig>  with a partial flexibility of the protein within a 6Å sphere around the ligand , were performed for the entire pre-docked chemical library. as mentioned above, we used conjugate gradient with the sp <dig> force field. we decided to apply two cycles of  <dig> iterations in order to have an acceptable compromise between level of minimization and calculation time.

further we validated the importance of using ammos as a final step of a hierarchical vls protocol. we used a two-stage vls protocol and a compound collection of  <dig>  compounds to generate and select protein-ligand complexes with satisfactory shape complementarity, thus reducing the number of protein-ligand complexes to be minimized. the final selected pre-docked protein-ligand complexes for both protein targets containing 60% of the real active compounds were subjected to energy minimization with ammos. figure  <dig> shows the enrichment graphs for the two targets before and after application of the ammos minimization protocol. enrichments for the er inhibitors  when employing cases  <dig>  and  <dig>  are better than with the case  <dig> . in both cases  <dig> and  <dig>  ammos retrieved 50% of the inhibitors in the top 3%  of the entire database.

na is known as a "difficult" protein target because its binding pocket is open and flat and thus challenging for docking-scoring methods. despite these difficulties, results obtained after the three-minimization cases with ammos  are reasonable. again, 50% of the inhibitors are found in less than 10% of the proceeded database. it is interesting to note that when the protein was kept rigid , slightly better results for na were achieved after ammos minimization. the above results suggest that ammos performs well and its use can help to improve enrichment in multi-step sbvls protocols.

discussion
optimization of existing sbvls tools and development of open source packages are of crucial importance to assist drug discovery projects. in this work, we developed a new software tool named ammos that refines the 3d structure of compounds present in a compound collection, optimizes the binding poses of docked ligands through mm minimization, and rescores these protein-ligand complexes. the open source package ammos wraps and enhances the functionality of the mm simulation program ammp, facilitating its use for in silico screening. numerous algorithms and protocols can be used to perform sbvls experiments but in most cases, the receptor structure remains rigid during the docking/scoring procedure. similarly, compounds obtained from chemical vendors are in 2d and their 3d structures have to be generated. several tools can perform this task but rarely the compound 3d structures are refined prior to docking while it is known that this can be critical for positioning and obviously scoring  <cit> . further and in order to speed-up the sbvls process, hierarchical protocols have been developed. these ones can include a relatively crude initial shape complementarity filtering step  followed by flexible docking with flexibility allowed only for the ligands. in several situations, it could be beneficial for users to have a tool allowing for partial to fully flexible energy minimization of the protein-ligand complexes, either to help ranking or to optimize the docked poses prior to selecting a list of molecules for experimental assay. ammos can be applied in these situations as illustrated below.

structural refinement of the compound collections with ammos
some recent reports suggest that it could be beneficial to minimize the 3d structure of the small molecules before performing docking/scoring computation  <cit> . the question is indeed complex because it is widely accepted that ligands do not necessarily adopt their lowest potential energy conformations when bound to a protein. in fact, ligand energies of bioactive conformations have been estimated to be around  <dig> kcal/mol above the lowest conformation energy of the same compound in solution  <cit> . further, a recent study carried out on  <dig> protein-bound ligand crystal structures shows that the ligand conformations are nearly identical to their local minimum conformations obtained from normal mode analysis-monitored energy minimization  <cit> . all these studies demonstrate that the ligands bind to proteins in a relatively low energy state, suggesting that highly strained energy input ligand conformations should not be appropriate for docking procedure, keeping in mind that many docking algorithms alter the pose of their input ligands only through translation, rotation, and some dihedral angle variations at rotatable bonds. minimizing compound collections prior docking experiments was demonstrated to improve both docking and scoring with surflex  <cit> . our preliminary tests involving docking  of er inhibitors initially minimized with ammos  indeed suggest that minimizing small molecules prior to docking can improve at least the docking accuracy. thus, as seen in the result section, ammos is able to automatically energy minimize a large compound collection. the resulting compounds have less strain energy but remain close from experimental structures and display similar structural features as compounds energy minimized with two other well-known force fields.

refinement of protein-ligand complexes and re-scoring with ammos
it is important to note that, at present, it is generally accepted that mm methods are not well-suited for a large scale vls computations because they are slowing down the calculations and since it is unclear whether or not energy minimization with current force fields could help in the ranking process  <cit>  . some of these questions start to be addressed as for instance several recent studies suggest that post-docking energy minimization can significantly improve enrichment for some protein targets  <cit> . it is expected that rescoring after mm minimization cannot help when the ligand is wrongly positioned in the binding cavity, however, when the pose generated by a docking engine is near the experimental conformation, energy minimization seems to be able to optimize locally the structure of the complexes, and in this case, the computed energy values  of the minimized structures can be effective at improving ranking and enrichment  <cit> .

in the present study, we provide users with the ammos package that refines the structure of pre-docked ligand-protein complexes. to illustrate our method, we applied a two-step docking-scoring vls protocol  on two protein targets, er and na. then, we minimized the  <dig> best poses obtained with dock <dig> with ammos and re-scored each pose. enrichment curves were obtained with different levels of allowed receptor energy minimization . as seen, employing fully flexible minimization in the binding site can considerably improve enrichment as it was observed in the case of er with 50% of the inhibitors retrieved in the top 3% of the entire database. thus, users can select different protocols depending on the projects and needs . in terms of efficiency, enrichments obtained by ammos are similar to those seen by other tools such as plop  <cit> . indeed, after ammos rescoring, we found 40% of the na inhibitors and 60% of the er active compounds in the top 5% of the compound libraries .

although the post-docking mm minimization of docked poses can improve the binding modes and the scoring in vls, it has been also observed that relaxing the protein-ligand complexes for some proteins can worsen the final enrichment although the binding modes are improved. for instance the mm scoring method plop  <cit>  involving a generalized born solvent model has been shown to improve the overall enrichment only for five out of ten tested protein targets. in average, for these ten targets, better enrichment factors were obtained in the top  <dig> % of the proceeded database, however only 10–30% of the inhibitors were retrieved in this limited range. further similar rescoring via the molecular mechanics-generalized born surface area  method  <cit>  with relaxation of the protein-ligand complexes by mm minimization with plos or short molecular dynamics  with amber-dock on three simple ligand binding cavities helped to discriminate between several active inhibitors and experimentally proven decoy molecules. here again, the obtained enrichment factors were lower than those found by docking alone before relaxation and rescoring with mm-gbsa. in that study the authors proposed that ligands too large to be accommodated after docking could indeed fit after relaxation of the binding site. in addition, some imperfections in the balance between polar interactions and solvation penalties can be present in the mm-gbsa methodology.

along the same line of reasoning, in our study and in the case of er where large ligands fill well the binding site  allowing receptor relaxation with ammos  led to considerable improvement of the enrichment factors . on the other hand, we did not obtain better enrichment after ammos in the case of na . also, our additional tests with ammos applied on a third protein target, thymidine kinase, did not improve the final enrichment, particularly with cases  <dig> and  <dig> when local receptor flexibility was allowed . it seems, that for some binding pockets and ligands, allowing post-docking relaxation of the protein-ligand complexes may worsen the enrichment, thereby increasing the number of false positives, as we observed not only in our investigation of na and thymidine kinase but also in other studies  <cit> . for na and thymidine kinase, the ligands do not fill well the binding sites . thus, it can be speculated that for large pockets accepting relatively small ligands, authorizing flexibility around the binding site could damage the final enrichment.

in terms of speed, ammos can perform full atom minimization of the binding site area in about ~30– <dig> sec/ligand conformer with the default parameters. the protocol provided offer a reasonable compromise between speed and accuracy but the users can reduce the number of iterations and speed-up the calculations, depending on the aims of the projects. in addition, multiple poses optimized with ammos can be subsequently re-ranked by employing other scoring functions or consensus scoring  <cit> .

CONCLUSIONS
an efficient mm minimization engine called ammos that makes use of the ammp simulation package has been presented. the fully automatic open-source package ammos can perform energy minimization of a large compound collection prior to docking and can also refine pre-docked ligands in the context of a protein structure. ammos executes efficient and fast minimization procedures and can thus be employed over a large number of protein-ligand complexes. the users can select the energy minimization protocol depending on the projects and, for instance, fix the protein atoms or allow full flexible minimization of both, the ligand and the receptor. several initial tests were carried out in order to assess ammos. we applied our package on two protein targets, er and na, which have very different binding site properties. results shows that ammos performs well on large pre-docked compound collections, retrieving most of the active compounds in the top 3% to 5% of the entire database. although ms-dock and dock <dig> were used in this work, users can apply other docking programs to dock a compound library.

the present version of ammos does not take into consideration possible solvation effects, yet, a few water molecules could be treated by the minimization procedure. however, in such a situation, we do not provide a fully automatic procedure and the users should prepare the proper input files. automated protocol will be implemented in a future release of ammos to treat solvation and water molecules. the full ammos package is freely available and should be valuable to research groups involved in drug discovery and chemical biology projects.

availability and requirements
ammos is written in c and python and runs on linux platforms. it is also operational on macosx system. detailed installation instructions are provided in the software package. the source code of ammos is freely available under the terms and conditions of the gnu public license from .

authors' contributions
tp wrote the code in c for the ammos project, tested the program and drafted the first version of the manuscript. dl wrote and tested the python code for the automated procedure. ip ran the molecular mechanics computations with the sybyl software. bov and mam conceived the ammos tool. mam designed and managed the project. ip, bov and mam took an active part in manuscript writing. all authors read and approved the final manuscript.

supplementary material
additional file 1
energy minimization of small molecules with sp <dig> force field and different ammp optimization methods. the minimized energies by the steepest descent, conjugate gradient, bfgs, simplex and a genetic algorithms are plotted against the number of iterations.

click here for file

 additional file 2
docking poses of estrogen receptor inhibitors after flexible docking with dock <dig>  the docking poses of six inhibitors minimized with ammos prior to docking as well as the docking poses of the inhibitors not minimized prior to docking are shown.

click here for file

 acknowledgements
tp appreciates a grant from the city hall of paris. ip thanks prof. m. wiese for making available the sybyl software during her research stay in the institute of pharmacy, university of bonn, germany. we acknowledge the inserm institute and the university paris descartes and paris diderot for financial supports.
