BACKGROUND
the accumulation of large-scale interaction data on multiple organisms, such as protein-protein and protein-dna interactions, requires novel computational techniques that will be able to analyze these data together with information collected through other means. such methods should enable thorough dissection of the data, whose dimensions have already extended far beyond the scope that is amenable to traditional analysis and manual interpretation. an important class of such biological information can be represented in the form of similarity relations. quantitative molecular data, such as mrna expression profiles, are often analyzed in this context through clustering algorithms. similarity between genes can also be defined on other levels, such as function  <cit>  or transcription factor binding patterns  <cit> .

although many fruitful algorithmic approaches have been developed for dissection of network and similarity data separately, methods analyzing together both information sources hold much promise. several works have established the interconnection between expression profile similarity and protein interactions  <cit> . to exploit this interconnection, pairwise gene expression similarities have been used together with other data sources for predicting pairwise protein interactions . topological properties of interaction networks induced by genes active in different conditions were studied  <cit> . several software tools allow the visual inspection of the clustering results in a network context  <cit> . however, ignoring the network information in the clustering process and using the rich and constantly growing network information solely for cluster evaluation seems suboptimal, as the network information can improve the cluster identification process. the prevalence of modularity in molecular cell biology has been widely recognized in the last decade. by functional module one typically means a group of cellular components and their interactions that can be attributed a specific biological function  <cit> . several approaches sought modules by jointly analyzing network information with gene expression data. initial works  <cit>  proposed measures for scoring expression activity in metabolic pathways  and complexes  <cit> . vert and kanehisa  <cit>  used kernel methods to identify expression patterns that characterize gene sets matching pathways in a given network.

the co-clustering methodology  <cit>  uses a distance function that combines similarity of gene expression profiles with network topology. the network distance between two nodes is an edge-weighted version of their topological distance in the network. the expression distance is one minus the pearson correlation between the expression patterns. the two distances are combined into a similarity score, and standard hierarchical algorithms  <cit>  are used for clustering. while generally successful, this approach sometimes produces clusters corresponding to highly disconnected subnetworks, since the network is only used as one of the sources of distance information, without requiring connectivity.

ideker et al.  <cit>  introduced a successful algorithm for identification of active subnetworks, i.e., connected regions of the network that show significant changes in expression over a particular subset of the conditions. unfortunately, this method can be used only when one has an activity p-value for every measurement, a situation which is rather uncommon. in addition, the method cannot handle pairwise gene similarity input. the same methodology was recently used in  <cit> , utilizing shortest-path algorithms for module finding. segal et al.  <cit>  provided another interesting formulation of the integration problem, in which a module is expected to contain a significant portion of the possible interactions. a probabilistic graphical model was used to extract a prespecified number of modules from gene expression measurements combined with a protein interaction dataset.

in this study we seek functional modules by identifying connected subnetworks in the interaction data that exhibit high average internal similarity. we call such a module a jointly active connected subnetwork . by imposing network topology constraints on clusters of expression data, the biological interpretation of the clusters becomes easier, and, as we shall see, one can detect weaker signals that were indistinguishable by extant methods.

we develop a novel computational method for efficient detection and analysis of jacss, implemented in a program called matisse . the proposed methodology has a statistical basis, which allows confidence estimation of the results. the algorithm assumes no prior knowledge on the number of jacss, and allows imposing constraints on their size. we do not require precalculation of the statistical significance of expression values. the methodology is general enough to suit any type of network data overlaid with pairwise similarities.

our algorithm detects jacss by identifying heavy subgraphs in an edge-weighted similarity graph while maintaining connectivity in the interaction network. by transforming edge weights to attain probabilistic meaning, we are actually seeking subnetworks of maximum likelihood. we show that this problem is computationally hard, devise several heuristic methods and analyze their practical performance.

when using gene expression similarity, analysis of known pathways in yeast has shown that only a fraction of the genes in a pathway are usually coherently regulated at the transcription level   <cit> . our method allows assignment of different priors to different genes, reflecting their probability to be regulated at the transcription level. we believe this is the first study to allow such flexibility. in addition, the goal of our approach is to detect non-overlapping jacss rather than to partition all the genes into clusters.

we first evaluate the performance of our algorithm on synthetic data with planted modules, and verify its ability to recover planted modules with high accuracy. then, we analyze two real systems for which large datasets are available: the osmotic shock response of s. cerevisiae, and the cell cycle in human hela cells. for s. cerevisiae, we compiled and carefully annotated from diverse sources a protein-protein and protein-dna interaction network consisting of  <dig>  nodes and  <dig>  interactions. the performance of matisse is shown to exceed that of extant analysis schemes in terms of the ability to retrieve biologically relevant groups, as analyzed by four different annotation datasets. we identify specific subnetworks relevant to different processes that are known to be activated and repressed by the mapk cascades following osmotic shock, such as ergosterol biosynthesis and pheromone response. in addition, we identify novel pathways, such as pyridoxine metabolism, as differentially expressed during osmotic shock. detailed analysis shows that some of the involved processes can not be detected based on the expression data alone. the human network contains  <dig>  nodes and  <dig>  protein-protein interactions collected from several sources, including recently published studies  <cit> . our analysis identifies subnetworks active in specific phases of the human cell cycle. these results underly the ability of our approach to provide novel, previously undetected biological insights. the inspection of "hubs" in the subnetworks delineated by matisse reveals key regulators of the cell cycle.

RESULTS
a framework for detection of jointly active subnetworks
let us first state our problem abstractly. we are given an undirected constraint graph gc = , a subset vsim ⊆ v and a symmetric matrix s where sij is the similarity between vi, vj ∈ vsim. the goal is to find disjoint subsets u <dig>  u <dig> ..., um ⊆ v called jacss, so that each jacs induces a connected subgraph in gc and contains elements that share high similarity values. we call the nodes in vsim front nodes and nodes in v\vsim back nodes.

in the biological context, v represents genes or gene products , and e represents interactions between them. these can be known protein-protein or protein-dna interactions or alternatively can originate from a known regulatory network where arc orientations are ignored. sij measures the similarity between genes i and j, e.g., the pearson correlation between their gene expression patterns. the set vsim may be smaller than v as some of the genes may be absent from the array, and others may show insignificant expression patterns across the tested conditions and thus excluded. hence, a jacs aims to capture a set of genes that have highly similar behavior, and are also topologically connected, and thus may share a common function, e.g., belong to a single complex or pathway. as elaborated in methods, we formulate the problem of jacs identification as a hypothesis testing question. in this approach statistically significant jacss correspond to heavy subnetworks in a similarity graph, with nodes inducing a connected subgraph in gc . the probabilistic model we propose also accommodates the use of gene-specific priors, reflecting our confidence that they are transcriptionally regulated in the studied conditions.

as exact optimization is intractable, we designed and tested several heuristics for solving the problem . the version that performed best on real biological data had the following three phases:  detection of relatively small, high-scoring gene sets, or seeds; for each node, the set consisting of it along with the neighboring nodes that are connected to it via positive-weighted edges was a candidate seed;  seed improvement, and  significance-based filtering . this version, which we call matisse, was used in subsequent analysis.

analysis of performance using simulated similarity values
in order to evaluate the ability of our method to detect subnetworks of high pairwise similarity, we first tested its performance on simulated similarity data. the simulation used a connected subnetwork of  <dig>  nodes from the s. cerevisiae interaction network  as the constraint graph. the similarity data were generated by "planting" a collection of jacss with several defining parameters in the network, using two similarity value distributions, where members of the same jacs tend to have higher similarity, as described in methods.

in order to test the effect of each parameter on the performance of the different module finding algorithms, we carried out simulations in which one parameter was varied while keeping the rest at their default values. we also tested simple clustering of the similarity data with the k-means algorithm and with the co-clustering approach of hanisch et al.  <cit> , which proposes a distance measure based on topology and expression. since the latter method does not readily provide clusters, we used that measure with a k-means-like algorithm . other methods  were not readily available for comparison.

we evaluated the ability of the methods to recover the planted components using jaccard coefficient. the coefficient ranges between  <dig> and  <dig> with  <dig> indicating perfect recovery . the results are presented in figure  <dig>  matisse is able to retrieve the planted components with good precision when there is a plausible separation between the two similarity value distributions  and the fraction of the front nodes exceeds  <dig> . the performance of matisse exceeds that of other methods for most of the parameter range.

response to osmotic stress in s. cerevisiae
we generated a comprehensive s. cerevisiae protein-protein and protein-dna interaction network by combining information from the interaction databases sgd, biogrid and bind and recent high-throughput studies . this resulted in a network containing  <dig>  nodes and  <dig>  interactions. we also used  <dig> expression profiles of s. cerevisiae under different perturbations and different environmental conditions focused on the osmotic stress response  <cit> . the  <dig>  genes whose patterns exhibit the highest variation in the data were designated as front nodes. we used pearson correlation for scoring similarities between expression patterns. the parameters of the probabilistic model were assigned as described in methods. maps of the subnetworks produced by matisse are provided on our website and in the supplement .

comparison of the modules produced by each method
we compared the performance of matisse to co-clustering and to clustering based solely on the gene expression data. we used the click algorithm  <cit>  for clustering, as it was shown to outperform several extant gene expression clustering algorithms, and since it can determine the number of clusters and also leave some vertices unclustered. the ideker et al. method  <cit>  could not be tested in this setting, since measurement p-values could not be computed.

expression homogeneity
as expected, the most homogeneous clusters in terms of expression similarity are obtained by click, which optimized this type of similarity. the homogeneity of the matisse jacss is higher than that of co-clusters. as previously reported  <cit> , the expression homogeneity of a random connected set is higher than that of a random arbitrary set .

topological descriptors
matisse is designed to produce connected subnetworks. the significance of this criterion is evident from the comparison to the other algorithms. in contrast to matisse, both click and co-clustering produce modules that are highly disconnected . interestingly, the subnetworks produced by matisse are not denser than random connected components in the network. this observation can be explained by the fact that the network contains several dense complexes that do not participate in the solutions, as their components are not homogeneously expressed under the examined conditions.

functional enrichment
in order to compare the functional relevance of the modules found by the different methods we used four annotation databases:  go "biological process" ontology   <cit> ;  go complexes annotation ;  mips deletion phenotype annotations  <cit>  ;  kegg molecular pathways   <cit> . a relatively wide selection of annotations was used to encompass diverse biological functions. note that the go "molecular function" categories are not relevant here, as the identified sets of genes are not expected to have similar molecular mechanisms.

for each annotation and for each group of genes produced by every method, the hypergeometric p-value was computed . we analyzed the percentage of the modules  and of the categories  enriched with p-value ≤ 10- <dig> in each solution. matisse exhibits high performance in functional terms and in most cases the produced jacss show higher enrichment than expression clusters and co-clusters. co-clustering and click perform slightly better than matisse in covering kegg categories. this is probably due to the overrepresentation of metabolic pathways in kegg. metabolic pathways are generally poor in direct protein-protein and protein-dna interactions, and thus less likely to be recognized by matisse, which relies also on direct interactions, than by a clustering algorithm based on expression alone.

as an additional comparison between matisse and co-clustering, we compared the p-values obtained by each solution on each go biological process  class attaining enrichment of p ≤  <dig>  in at least one of the solutions. the matisse modules gave better significance to  <dig> functions, while only  <dig> functions had higher significance in the co-clustering solution.

in order to check the added value of incorporating network constraints over using only expression profiles, we compared the results to clustering of the expression profiles with click. in the same pairwise comparison,  <dig> matisse functions exhibited a higher enrichment, compared to  <dig> in click. several relevant functions, such as pyridoxine metabolism, cellular response to phosphate starvation, protein ubiquitination and post-golgi transport, were enriched with p < 10- <dig> in matisse, but were not significantly enriched in any click cluster. when seeking functions enriched by the other clustering methods, the only function enriched was "nad biosynthesis"  discovered by click. the six genes in our dataset that are annotated with this category do not contain any interactions between them and the average length of the shortest path between them is  <dig> 

functional subnetworks identified by matisse
in the previous analysis we did not correct for multiple testing since our goal was the comparison of the different methods. to address the multiple testing problem, we performed a go functional enrichment analysis using the tango algorithm  <cit> . the algorithm considers all levels of the go hierarchy and provides p-values corrected for multiple testing and for category dependency using resampling .

 <dig> distinct functional terms were found to be enriched  in  <dig> distinct modules. the complete list of the enriched functions and their respective jacss is shown in table  <dig>  interactive maps of these jacss can be found at our website along with the corresponding expression data. note that jacss were artificially limited to contain no more than  <dig> nodes in order to provide a better separation between pathways with slightly similar expression patterns. nevertheless, it appears that this bound does not cause substantial fragmentation of the true clusters, as almost all the jacss were enriched with distinct functions. reassuringly, most of the enriched functions are highly relevant to the conditions and the perturbations in the data  <cit> . these include stress responses, such as repression of the translational machinery  as well as general stress response genes . in addition, a specific subnetwork relevant to the activation of the pheromone response pathway following osmotic shock in hog <dig> strain  <cit>  was identified . indeed, since the hog pathway shares protein kinases and phosphatases with other mapk pathways, it was demonstrated that perturbations in pbs <dig> or hog <dig> lead to osmostress-induced stimulation of the pheromone response pathway  <cit> .

jacs  <dig> contains seven genes from the yeast membrane ergosterol biosynthesis pathway which is strongly repressed following osmotic shock in the wt strain but not in hog <dig> strains. lower levels of ergosterol make the membrane more compact and less flexible and hence lead to diminished transmembrane flux of glycerol, which is important for recovery from both hyper-osmotic and hypo-osmotic shock  <cit> .

jacs  <dig> contains  <dig> genes members of the proteosome complex.  <dig> of these are back nodes, underlying the ability of matisse to use the network for linking co-activated genes with biologically relevant partners. inspection of the expression data reveals a slight induction of the proteolysis genes following osmotic shock. this subtle response is missed when clustering solely the expression data, as no more than seven proteolysis genes are clustered together in the click solution. ubiquitin-dependent proteolytic mechanisms were linked to osmotic responses before  <cit> , and our findings support this hypothesis.

for several pathways, such as pyridoxine biosynthesis, intracellular transport and chromatin-related complexes  that were linked by matisse to osmotic shock in s. cerevisiae, this linking is novel. pyridoxine was recently linked to osmotic shock response in a. thaliana  <cit> . these findings underlie the ability of matisse to produce testable hypotheses and novel insights.

promoter analysis
based on the assumption that genes that exhibit similar expression pattern over multiple conditions are likely to be co-regulated and to share common cis-regulatory elements in their promoters, we searched for over-representation of known transcription factor binding site motifs in the promoters of the genes in each jacs. when using the prima motif finding tool  <cit> , six subnetworks showed significant enrichment  for at least one tf . all the tfs corresponded to known regulators of the processes enriched in the subnetworks. for example, jacs  <dig>  enriched for pheromone response pathway genes, was enriched with putative targets of dig <dig> and ste <dig>  known regulators of these pathways  <cit> . subnetwork  <dig>  associated with general stress response, contained multiple targets of the msn <dig> and msn <dig> stress tfs  <cit> . we validated that these motif enrichments are not a byproduct of the functional enrichment in the jacss . this analysis suggests that the jacs we obtained indeed correspond to gene modules with a common transcriptional regulation.

cell cycle in human
we constructed a human protein-protein interaction network by combining information from the bind and hprd databases and from two recent large-scale yeast two-hybrid studies on human cells  <cit> . the resulting network contains  <dig>  nodes and  <dig>  interactions. expression profiles of the synchronized hela cell lines from  <cit>  were used. only the  <dig> point time series obtained for synchronization by thymidine-nocodazole block was selected for the analysis, as it contains the fewest missing values. genes for which the maximal fold change across the conditions was below  <dig> were filtered, leaving  <dig>  genes .

we performed matisse analysis using the all-neighbors heuristic, and the same parameters as in the previous section, and obtained  <dig> significant jacss. maps of these subnetworks are provided on our website and in the supplement . to check the ability to discover subnetworks active at different cell cycle phases, we analyzed the overlap between the jacss and annotations of specific cell-cycle phases as provided in  <cit> . indeed, seven modules were enriched for specific phases of the cell cycle with p <  <dig>  after bonferroni correction. the module with the highest cell cycle enrichment  is shown in figure 5a.

the advantage of matisse is evident when comparing the modules most enriched for the go "cell cycle" category in the matisse and the co-clustering solutions. while the matisse module is a single connected component of  <dig> genes, the corresponding co-cluster contains  <dig> connected components and  <dig> genes, and thus is much less amenable to interpretation in terms of the functional connections between its genes.

subnetwork hub analysis
we hypothesized that the topology of the jacss obtained by matisse can provide clues to the key players in the regulation of the cell cycle machinery. to test this, we looked for "subnetwork hubs" in the jacss, i.e., genes whose degrees in a jacs were high both absolutely and relatively to their network degree . this analysis on the  <dig> jacss identified  <dig> hubs,  <dig> of them with "cell cycle" annotation . this set contained many cell cycle master regulators such as p <dig>  atm, e2f <dig>  tgfβr, cdk <dig> and cdc <dig>  remarkably,  <dig> out of  <dig> hubs form a single connected subnetwork, displayed in figure 5b. this demonstrates that subnetwork hubs represent key regulators relevant to the experimental conditions tested. the interactions between the subnetwork hubs are putative regulatory interactions governing the progression of the cell cycle. as only  <dig> of the  <dig> hubs are front nodes in their respective jacs, this set could not be identified using expression data alone.

CONCLUSIONS
we have developed a novel computational technique for the integrated analysis of network and similarity data. the method is aimed to dissect together topological properties of gene or protein networks and other high-throughput data. we used the method to analyze large-scale protein interaction networks and genome-wide transcription profiles in yeast and human. the method was shown to identify functionally sound modules, i.e., connected subnetworks with highly coherent expression showing significant functional enrichment. in comparison to the extant co-clustering method, which aims to integrate similar data, our method demonstrated substantial improvement in solution quality. comparison to solutions produced by clustering highlights the advantage of utilizing topological connectivity in the hunt for functionally sound modules. by construction, our method is specifically powerful in detection of regulatory modules, and less fit for detection of metabolic modules. our technique, implemented in the program matisse, is efficient and can analyze genome-scale interaction and expression data within minutes.

the proposed algorithm is very flexible and – unlike co-clustering – can handle situations where not all genes in the network have similarity information or expression patterns. in particular, matisse can determine the subset on which similarity is computed using various criteria, e.g., initial probe filtering, differential expression confidence values, etc. as we demonstrate, even when only a modest fraction of the overall network genes have expression/similarity information, the method finds meaningful modules successfully.

the requirement for network connectivity as proposed in our method can be viewed as problematic due to high rate of false negative interactions. a natural extension of matisse which we intend to pursue is to take into account the interaction confidence. as a first step towards this goal, we assessed the composition of the interactions in the reported subnetworks as follows: we compared the observed and expected number of interactions within the subnetworks, from each of the publications used as interaction sources in the s. cerevisiae interactions network. we found a clear enrichment for interactions from recent experiments, such as  <cit>  and  <cit> , opposed to an under-representation of interactions from older works, such as  <cit>  and  <cit>  . as currently the coverage of the protein interaction network is limited, we suggest performing matisse analysis in addition to standard clustering analysis.

the framework described in this work is directly applicable to any kind of pairwise similarity data where the probabilistic assumptions hold. while this study focused on protein interaction networks and gene expression, the approach is general enough to treat many other data types. these include other types of interactions, such as genetic interactions, regulation and protein-dna binding patterns, and other similarity measures, such as functional similarity or similarity in protein-dna binding profiles  <cit> . we intend to extend matisse to these types of data as well.

while the rapidly expanding resource of microarray data is currently analyzed primarily using diverse clustering techniques, methods for the analysis of network-type data describing interrelations of genes and proteins are less mature, and methods for joint analysis of the two data types are in nascent stage. we expect the proposed method to become widely used for dissecting expression data in light of the interaction knowledge. our initial results show that despite the high complexity and the relatively low coverage of the human interactome, biologically relevant modules can be found in the human protein interaction network through integrative analysis.

