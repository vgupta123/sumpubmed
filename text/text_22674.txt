BACKGROUND
epigenetics is a rapidly expanding biological field recently. aberrant epigenetic modifications are associated with many different diseases including cancers and neurodevelopmental disorders  <cit> . much work has demonstrated that epigenetic regulation plays an important role in gene expression, among other mechanisms such as transcription factor regulation. advances in high throughput methods such as methylation arrays, chip-sequencing, gene expression microarray and rna-sequencing have enabled researchers to better understand the relationship between epigenetic modification and gene expression at the genome scale. coupling with the progress in experimental methodology, we have witnessed a wealthy growth of bioinformatics tools to analyze the epigenetics patterns  <cit> .

dna methylation and histone modification are two major mechanisms of epigenetic regulation. the most widely researched type of dna methylation in human is the cytosine methylation of cpg islands and their associated regions, such as cpg shores  <cit> . cpg methylation occurs genome-wide in regions related to protein coding genes  as well as in certain intergenic regions. it has been shown that cpg methylation tends to occur in promoters located upstream of the transcription starting site  <cit> , and increased methylation  in the promoter is negatively associated with the gene expression level <cit> . on the other hand, cpg methylation in gene bodies seems to be positively associated with gene expression  <cit> . in cancers cells, massive global loss of dna methylation  has been observed, and such hypomethylation in promoters can activate aberrant expression of oncogenes  <cit> . much new information has been gained through the recently developed methods, such as illumina infinium humanmethylation <dig> arrays that enable the detection of cpg methylation throughout the different locations associated with over 99% of protein coding genes.

histone modification is another type of important epigenetic modification  <cit> . histones are the core of nucleosomes that dna sequences wrap around. all histones are subject to some level of methylation or acetylation, which would either open up or close the local chromatin structures to enable or repress gene expression. among them, histones  <dig>  has various kinds of methylation and they serve as well-studied markers for gene expression status. for example, histone  <dig> lysine  <dig> tri-methylation  in the promoter region is an indicator of active gene transcription, and histone  <dig> lysine  <dig> tri-methylation  is associated with transcription elongation. oppositely, histone  <dig> lysine  <dig> tri-methylation  may repress gene expression. even more complicated, histone modification markers interact with dna methylation, and the consequent patterns of gene expression are the combined effects of their interactions. the genomic assays such as chip-sequencing have enabled the generation of large amount of histone modification data.

although integrative analyses on gene expression and epigenetics regulation abound throughout the literature  <cit> , it is our observation that quantitative models which use epigenetic information to accurately predict the up or down regulation of gene expression are currently lacking. a frequent question that a biologist would ask, when methylation data are available but the gene expression data are missing, is how the epigenetic changes of a gene may affect the expression of this gene to be either up or down regulated. this report is aimed to fill in this gap, and provide the users with a model that allows them to estimate the consequence of epigenetic modification on gene expression, when the data for the latter are not available. towards this goal, we have built a classification predictor for gene expression using the machine learning approach. this model examines a large set of cpg methylation data, histone modification data and genome data, and accurately predicts differential expression of rna-seq transcriptome by taking advantage of the publicly available data from the tcga project  and the encode project.

methods
data sets
several types of high throughput data were used to extract features or classification responses. these include the cpg methylation array data from  <dig> paired cancer and adjacent normal tissues, three types of histone marker chip-seq data from cancer and normal cell lines, genomic nucleotide sequence and conservation data, and rna-seq expression data from samples that have coupled methylation data.

data processing
methylation data
the cancer genome atlas  methylation data from illumina's infinium humanmethylation <dig> beadchip  were used to extract cpg methylation related features, according to their annotation file. the genomic coordinates of cpg, their exons and coding regions were obtained from the illumina annotation file. since the annotation file only provided information of transcripts, exons, and coding dna sequences , we re-annotated the protein coding genes using the illumina igenomes hg <dig> refseq annotation in order to extract more comprehensive information from other regions of the transcripts: all introns , as well as first and last exons, untranslated regions in the 5' and 3' direction , and a "single exon" or "single intron" designation for transcripts that only had a single exon or single intron.

histone data
three sets of histone marker chip-seq data, h3k4me <dig>  h3k27me <dig>  and h3k36me <dig>  were considered from two cell lines: a <dig> cell line  from the lung carcinoma tissue, and saec normal lung epithelial cell line . raw chip-seq data were downloaded from the broad institute/bernstein lab at the massachusetts general hospital/harvard medical school and the university of washington in collaboration with the encode project via the ucsc genome browser at http://genome.ucsc.edu.  <cit> . the raw reads were processed in-house to ensure consistency of all normalization procedures. raw data were first aligned to hg <dig> using bowtie <dig>  <cit> , followed by removal of duplicated reads using the samtools toolkit   <cit> . the aligned reads were intersected with the relevant segments of the transcript as annotated in the previous section, using the bedtools toolkit   <cit> . a custom r script was used to normalize the data over total number of reads after removing pcr duplicates.

human genome data
nucleotide composition data were extracted from hg <dig> genome fasta files downloaded from the ucsc genome browser. conservation scores across three classes of species: vertebrates, primates, and placental animals, were also considered. phastcons46way scores were downloaded from the ucsc genome browser  <cit> . conservation scores were then intersected with the relevant segments of the transcripts using a custom perl script, in order to extract conservation features.

rna-seq data
rna-seq gene expression data from lung cancer samples with coupled cpg methylation data were downloaded from tcga research network: http://cancergenome.nih.gov. lung adenocarcinoma and lung squamous cell carcinoma data were combined for this project, as they are two subtypes of non-small cell lung cancer. differential expression analysis was done with the deseq <dig> package in r  <cit> . in cases where multiple transcripts are mapped to the same refseq id, the geometric mean of the differential expression results was used to represent the gene level expression. in the case that any of these read counts was zero, the counts from all transcripts were artificially increased by one in order to calculate the geometric mean, followed by final subtraction of one. the expression of a gene was then classified as binary outcomes: either up-regulated or down-regulated, once it passed two thresholds: 1) having an adjusted p value < . <dig> after holm's multiple hypothesis test  <cit>  and 2) having an absolute value of log <dig> fold change greater than  <dig>  as a result,  <dig> genes were selected as "differentially expressed" genes.

feature extraction
the extracted features are categorized into four major sub-groups. all features were considered on a segment-wise basis , unless noted otherwise.

cpg methylation features
differential expression of the methylated cpg sites was processed using the limma library in r. specifically, the function toptable was used to determine the log fold change  between the cancer and normal tissues as well as the average methylation  of each cpg site across the two types of tissue  <cit> . a positive logfc indicates hypermethylation whereas a negative logfc indicates hypomethylation. additional segment-based features were also considered. these include the number of hypermethylated  and hypomethylated probes  on a segment of a given transcript. for example, first_exon_numhyper refers to the number of hypermethylated probes on the first exon. two other types of features are the average of logfc and avgmval of all cpg probes on a segment of the transcript, e.g. the average logfc of all probes on the first exon of a given transcript .

special effort was paid to compute distances of cpg probes to exon-exon junctions. given that one or more cpg sites may exist on the individual exon segments of a transcript , transcript-level maximum, minimum and average distances of any hyper/hypo-methylated probe to the nearest 5' or 3' exon-exon junction were computed .

histone marker modification features
after the alignment of raw histone marker data , the aligned histone marker reads were intersected with the segments of each transcript using the multicov function from the bedtools package  <cit> . the histone reads were then normalized per  <dig> bp length of each segment per  <dig> million aligned read library. similar to the cpg methylation features, the histone marker modification features were extracted on a segment-by-segment basis. initials are used to represent the individual cell lines where the features come from: a for the a <dig> cell line and s for the saec cell line. following the initial is a number representing the specific histone h <dig> methylation marker:  <dig> for h3k4me <dig>   <dig> for h3k27me <dig>  and  <dig> for h3k36me <dig>  as a result, features are named as segment_cell type and histone modification type . in order to compare histone modification between the cancer and non-cancer cell types, the differences of the reads between them were divided by the average of the two .

nucleotide features
in each segment of the transcript, four different types of nucleotide features were extracted: single nucleotide composition, dinucleotide composition, trinucleotide composition, and the length of each segment. nucleotide sequences of hg <dig> reference genome were processed using the biostrings library in r  <cit> .

conservation features
conservation score per segment was calculated as the arithmetic mean of the conservation score per nucleotide in that segment. three separate sets of conservation scores with different comparative species were extracted from ucsc genome browser - vertebrate, primate, or placental. thus, features such as first_exon_vertebrate emerge from this set.

feature selection
three feature selection methods were considered: correlation feature selection   <cit> , gain ratio  <cit>  and relieff  <cit> .

cfs is based on mutual information, a non-linear measure of correlation. cfs selects an approximately optimal set of features to maximize the relevance and minimize redundancy. relevance is the correlation of a feature to the class  measured by mutual information, whereas redundancy is the correlation between two features. redundancy between selected features is minimized to keep the number of selected feature small.

the gain ratio is an improved method of information gain . both feature selection methods employ a decision tree in their respective algorithms. the gain ratio, by name, is a ratio of ig, but it overcomes the bias of ig which favors features with more data.

relieff is an improved feature selection method from relief. relief uses the manhattan distance of its nearest hit and miss from a random instance to continuously update a weight vector, which is then used to calculate a relevance score. features above a certain relevance threshold are considered "selected"  <cit> . relieff improves on relief in several ways, including two improvements particularly important for this report. first, relieff extends relief to be able to handle incomplete or partial data. second, relieff searches for k near-hits and near-misses and takes their averages, as opposed to one nearest hit or miss from relief. k = <dig> was sufficient to obtain satisfactory results  <cit> .

cfs is the only method that has a built-in system for selecting the number of features. gain ratio and relieff both work as ranker systems, meaning every input has a matching respective ranked output. in order to ensure fairness between feature selection methods, we matched the numbers of selected features from gain ratio and relieff to be the same as determined by cfs.

model evaluation
the data were split into training and testing sets. the training set constituted 80% of the up-regulated and down-regulated genes, and the testing set constituted the remaining 20% genes. the training data set underwent 10-fold cross validation on various combinations of feature selection and classification methods, in order to obtain the best model.

after determining the best model, two sets of drop-off tests were conducted. the first set of tests considered the effect of data types, including nucleotide composition, histone markers and methylation data, on the performances of sub-models. the second set of drop-off tests considered the effects of different segments on transcripts, including gene body, exons, introns, utrs, tss <dig> and tss <dig>  on the methylation cpg methylation data based sub-models. for each drop-off test, a set of features was removed from the original input features prior to the feature selection and classification. subsequently the same relieff feature selection and rf classification for the drop-off tests were performed as described in the previous feature selection section.

software
weka  <dig> data mining software  <cit>  was used for feature selection, classifier training and evaluation. various r packages were used, including corrplot for generation of the correlation matrix  <cit> , and rocr for roc curves  <cit> . the classification model is available at: https://github.com/lanagarmire/epipredictor

RESULTS
summary of input data and features
four types of input data were used to extract the features including the illumina 450k cpg methylation array data from cancer and normal tissues, three types of histone h <dig> marker chip-seq data from cancer and normal cell lines, genomic nucleotide sequence and conservation data, and rna-seq gene expression data from samples with coupled cpg methylation data. in total, we calculated  <dig> features and summarized the features by column. these features can be divided into two categories :  data type based features, including average cpg methylation, average methylation log fold change, number of hyper/hypo-methylated probes, mono-nucleotide, di-nucleotide and tri-nucleotide composition, histone h <dig> methylation chip-seq reads, and phastcon conservation scores;  segment based cpg methylation features from illumina 450k beadchip annotations: upstream of the transcription start site   <dig>  tss <dig>  5' and 3' utrs, exon/intron body, first and last exon/intron, single exon/intron and full transcript .

model selection and evaluation
the model uses  <dig> gene data points in the training set, with an additional  <dig> genes kept in the testing set. three different feature selection methods were evaluated in combination with five classification methods, using 10-fold cross-validation on the training data set . the three feature selection methods are: correlation-based feature selection , relieff, and gain ratio. in most cases with combined classification methods, except for gaussian svm, relieff gives the best aucs among the three feature selection methods. among the five classification methods that we considered, namely gaussian svm, linear svm, logistic regression, na√Øve bayes and random forest, the two non-linear methods  show superior performances to the other linear classifiers . this indicates that interactions exist among the selected features. however, the differences are not very big, suggesting that the decision boundary is close to linear. given that the model based on relieff feature selection and random forest classification gives the best auc of  <dig> , it is selected as the best model for the rest of the project. similarly, a relieff and random forest based model has the best predictive performance on the 20% holdout data set, with an auc of  <dig> .

analysis of selected features
a total of  <dig> features are selected by the best model, spanning all four types of genomic and epigenomic data. we first explored the relationship among the selected features. using hierarchical clustering on absolute correlation values between features , we found that the selected features tend to cluster by the data type, as expected. for example, the conservation features in the coding regions  are grouped together, and so are most methylation features. as expected, the cpg islands within the promoter are very important for the prediction of gene expression, as demonstrated by the three selected and highly correlated features cg composition features, tss200_gc, tss200_cg and tss200_cgg.

the largest group of selected features is the histone modification features , followed by the methylation features  . the selected features underscore the importance of histone epigenetic modification in the regulation of gene expression. likewise, the importance of methylation features is evident, especially for the featured arising from tss, 5' utr and first exons. interestingly, several methylation features  are clustered with histone modification features, suggesting collinearity between these two types of features, as shown by others  <cit> .

on the other hand, when features are categorized by location relative to the transcripts , the tss <dig> has the most number of features , and tss <dig> has  <dig> features selected for this region. together, the promoter comprises 28% of all the selected features. this confirms the previously well-known importance of the promoter region for the epigenetic regulation of gene expression  <cit> . additionally, cds has the second highest number of features being selected, highlighting its significance in regulating gene expression  <cit> .

we also calculated the correlation of each feature to gene expression and plotted the top  <dig> features most relevant to gene expression prediction . none of the features have correlations higher than  <dig> , suggesting that no single feature is a dominant predictor for gene expression. these features are either histone modification  or methylation features , consistent with the previous observation on the significance of these two types of features.

evaluation of features by data type
to determine the contribution of different types of features to gene expression, we tested the performance of models when a subset of features from the same data type were dropped. we present the results of four measures of model performance: auc, accuracy, f-measure and matthew's correlation coefficient  . dropping any individual feature set of nucleotide composition, histone modification or cpg methylation, did not seem to have a large effect on the model performance, indicating that there is redundancy between feature sets. the sub-model performance for the dropping-off of a single feature set from the full model is in the following order: nucleotide composition removal > histone modification removal > cpg methylation removal. thus dropping methylation features had the largest effect among individual feature set, as the auc decreases from  <dig>  in the full model to  <dig>  in the training set, as well as from  <dig>  to  <dig>  in the testing set. likewise, mcc, upon single feature set drop-off, shows the largest proportional change among the four performance measures, and decreases from  <dig>  to  <dig>  on the training set and  <dig>  to  <dig>  on the testing set.

we also compared the effect of removing both nucleotide and histone features on model performance, as compared to removing either of them alone. as expected, removing both nucleotide and histone features gives the lowest aucs, lowest accuracies and lowest f-measures in both training and testing sets. however, it leads to higher mcc than removing just histones does in the testing set. this suggests that there might be some overfitting with regards to the nucleotide feature set, which accounts for the majority  of features prior to feature selection.

evaluation of cpg methylation features by locations relative to transcripts
given that removing methylation features causes the most reduction of model performance among the single feature set drop-off , we next asked the question of the relative importance of each methylation feature categorized by genomic location. we performed drop-off tests by sequentially removing features in each genomic location category. we first removed the features from the first exons and first introns , then from gene bodies including exons, introns, and utrs, and lastly from tss <dig> region such that only tss <dig> features were kept. at each step, we re-performed feature selection and model construction, using the remaining methylation features.

all categories of genomic locations provide relevant useful information that contributes to better prediction of gene expression, as each of the sequential feature set drop-off decreased the performance of the model in both training and testing sets. compared to the removal of first exon and intron regions, and removal of the utrs and the rest of the gene body, removal of tss <dig> leads to the largest reduction in all four metrics, confirming the importance of the promoter region in regulating gene expression. even when only tss <dig> features are considered, an auc of  <dig>  and  <dig>  are obtained in the testing and training sets respectively, suggesting that cpg methylation status in tss <dig> is still somewhat predictive of gene expression. however, a more accurate prediction using methylation features should arise from all locations associated with the transcripts.

discussion
the need to build predictive models of gene expression from epigenomics data
although currently integrative analyses between gene expression and epigenetic modification exist, we have found that quantitative models using epigenetic information to accurately predict the up or down regulation of gene expression are currently lacking. there are often cases where researchers can only obtain reliable epigenetics data, but not gene expression data. for example, if the samples are archived and processed by ffpe , one can still perform epigenomics measurements, but not the gene expression experiments due to the degradation of mrna in the samples. more importantly, a predictive method such as ours can efficiently facilitate the bench scientists to narrow down the candidate lists and conduct gene expression validation, especially when the epigenetics information is the only data handy.

selected features and their relevance to gene expression
all four types of data  exist in the  <dig> features that are selected by the best model, indicating that all of them contribute to the accurate prediction of gene expression. moreover, selected features of the same data type tend to cluster together on the correlation matrix among the features, suggesting that the relationship within the same data type is closer than the relationship between different data types. as expected, histone modification and cpg methylation features are the largest two groups among the four types of data, signifying their importance to predict gene expression. since nonlinear classification methods perform slightly better than linear classification methods, it suggests that interactions do exist between different types of data. this is supported by numerous literatures that enzymes responsible for cpg methylation also interact with histone modification events  <cit> .

besides the value of predicting gene expression, our models also provide insights into the relative importance of different epigenomics/genome data, as well as the genomic locations. we found that cpg methylation features have more predictive values for differential gene expression, compared to the three types of histone h <dig> modification data. although other kinds of histone modification data can also be obtained to increase the predictive values of histone modification data, it is much more costly to obtain them relative to the cpg methylation data . therefore, practically speaking, when the budget is a constraining factor, we suggest that assays on cpg methylation should be considered with priority in predicting differential gene expression. moreover, the results of our models demonstrate that all genomic locations relative to each transcript, including promoters, exons and gene bodies, provide useful information to predict gene expression alternation. although the cpg methylation signals from the promoters region are more important, the methylation signals from other regions, such as exons, introns and utrs are indicative of changes in the gene expression as well.

worth noticing, a lot of features that are extracted on methylation and histone modification are naturally based on the annotations from illumina 450k array platform for dna methylation. there may be bias on the number of features that are hand coded in the model. to address potential issue, we changed tss200_gc to tss150_gc in our model and obtained an auc = . <dig>  for cross fold validation on the training set and an auc = . <dig>  for the testing set. therefore, we think the bias due to relying on the nomenclatures from illumina's annotation is small.

limitations and future directions
we should point out that our current model does not include all histone modification data, but only three widely used methylation markers on histone h <dig> . moreover, the histone h <dig> data are drawn from encode cell lines, since the tcga samples do not have such data. the heterogeneity of the sample resources could affect the accuracy of the model. when more histone marker data coupled with dna methylation and rna-seq data become publicly available for lung cancer, we can include them to achieve a better model. in the ideal setting, we would like to build a predictive model that has multiple types of epigenomics data obtained from the same samples. another potential concern is overfitting in the classification model. however, we split the dataset into training and independent testing subsets and show the model performs comparably well on the holdout testing subset. we believe that the model can be replicated if we can identify paired rna-seq and methylation data. in fact, we had originally built this model on a private data set, which also achieved an auc of more than  <dig> . additionally, figure  <dig> and  <dig> both indicate that our approach does not suffer a significant over-fitting problem using the tcga data, and show the dominant efforts of histone modification and cpg methylation, which yield an up/down gene expression prediction with an auc> <dig> . currently the model uses lung cancer data, and it will be interesting find out more general epigenetic predictors for differential gene expression in other cancers as well. lastly, we should point out that regulation of gene expression is complex, including other mechanisms mediated by transcription factors, microrna, non-coding rnas etc. the fact that aucs hover between  <dig> - <dig>  ranges could be well due to the fact that features from these other mechanisms are not considered in the current epigenetics model. to increase the accuracy, a more complex model that takes into account of all these events should be constructed.

CONCLUSIONS
a new model based on epigenomics data is proposed to predict transcriptome-level differential gene expression in lung cancers. dropping-off feature sets by data type shows that cpg methylation features are most important for the prediction. furthermore, methylation features on all genomic regions relative to protein coding genes contribute to the differential gene expression, within which promoter regions are most important.

competing interests
the authors declare that they have no competing interests.

authors' contributions
lxg envisioned the project and supervised the work. tc initiated the project. jl and tc designed and implemented the project. sj assisted the project. jl, tc and lxg wrote the manuscript. all authors have read, revised and approved the final manuscript.

supplementary material
additional file 1
table s <dig>  selected  <dig> features in the best model sorted by category and their frequency

click here for file

 acknowledgements
the authors would like to thank dr. jayson masaki for reviewing the manuscript.

declarations
publication charges for this article were funded by nih/nigms p <dig> cobre gm <dig>  nih/niehs k <dig> es025434- <dig> and hawaii community foundation.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2015: selected articles from the 10th international symposium on bioinformatics research and applications : bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/16/s <dig> 
