BACKGROUND
at present, the dna microarray technology allows simultaneous monitoring of the expression levels of thousands of genes. the technique produces large and complex datasets that are relatively easy to generate but non-trivial to analyze and extract information from. so far, much of the data mining efforts have been focused on the statistical analysis  and less on acquiring high quality data from the image analysis. image analysis is the process of extracting information from the scanned microarray images, which is an important step due to the sequential nature of the microarray analysis  <cit> . consequently, problems in the initial steps have large impact on the interpretation of the final results from the experiment.

a number of technical issues during microarray preparation potentially affect the spot quality.

• low signal intensity is perhaps the most generally acknowledged property that affects spot quality due to the subsequent problems in distinguishing signal from noise for spots with weak signals. weak signal intensities should result from physiologically low expression levels but might also be related to surface properties of the slide, signal bleaching, scanner problems or incomplete or irregular hybridization.

• intensity distribution issues appear as regions of pixels containing signals that clearly deviate from the average signal, typically as distinct sub-areas within the foreground region. as the signal of any given spot on a microarray slide is expected to be uniform over the entire spot foreground area, intensity distribution issues are usually a consequence of non-specific binding or irregular distribution of the printed dna on the slide.

• morphological issues refer to unexpected shape-related variations of the spot foreground region. this includes very small or very large spot sizes, low spot circularities or spot mixing. size aberrations might be a consequence of precipitates or impurities in the printing solution or needle clogging during printing. spots are expected to be roughly circular in shape, but manufacturing issues might result in deviation from the circularity norm. furthermore, imperfections on the slide or washing problems might cause the dye from several spots to mix, referred to as bleeding, making the separation of these signals difficult or even impossible.

• background issues appear as intensity fluctuations in the local background region immediately surrounding the foreground region. an increase in local background intensity or variance compared to the global slide background typically result from dye contaminants due to non-specific binding or incomplete washing.

microarray spot quality control is essentially the identification and removal of spots with properties that cause the subsequent interpretation of the signal from these spots to be unreliable or misleading. analogously, it is the recognition of characteristics that enable dependable interpretations and conclusions from the generated data. the field of microarray spot quality control has been largely neglected in the past but has recently become an area of interest. existing documented semi-automatic methodologies include bayesian networks  <cit>  as well as linear combinations of quality parameters allegedly related to the quality of the spot  <cit> . interestingly, manual evaluation is still a common quality assessment procedure, despite the labor-intensive nature of visually inspecting spots in the order of hundreds of thousands. increasing availability and usage of microarrays in the field of transcriptomics has caused experiments to involve an escalating number of slides, which in turn has highlighted the primary bottleneck of manual quality assessment.

partial least squares  is a generalized regression method which aims to maximize the covariance between the x  and y  matrices. pls can handle large data sets of multi-collinear and noisy data with moderate amounts of missing data in both x and y. pls-da can be seen as a special case of pls where the response matrix y is categorical  and determines class belonging of observations. pls-da has been widely applied in microarray analysis  as well as other areas of life science . for a more detailed description of the properties of pls, please consult  <cit>  and references therein.

here, we propose the microarray spot quality control  methodology for assessment of cdna microarray spot quality, outlined in figure  <dig>  a set of existing and novel spot descriptors were identified that aimed to characterize spot quality in terms of physical attributes of the spot. prior to the extraction of descriptors, manual assessment of the spot quality was performed independently by three experienced microarray users on roughly eighty thousand spots in order to provide a sufficiently large data set of known quality.

spot descriptors were subsequently subjected to multivariate discriminant analysis by means of pls-da with the aim to categorize spots of low quality and spots of high quality by treating these spots as separate classes. the utilized descriptors aimed to describe foreground and background irregularity measures, spot morphology and foreground density attributes that were potentially useful for discriminating between the reliable  and unreliable  spots. for instance, the circularity measure is a descriptor ranging from 0% to 100%. if the circularity descriptor approaches its minimum value, the predicted class belonging should typically be higher  for the bad class compared to the not bad class. the coefficient of variation for the foreground and background regions is an example of an employed descriptor that illustrates reverse characteristics; higher values should typically provide greater class conformity with the bad class compared to the not bad class. however, all employed descriptors together contribute to the regression model and consequently to the final class determination at varying degrees depending on the properties of the spot.

the masqot approach aims to provide a consistent assessment of spot quality, applicable to various types of microarray data, thus avoiding the labor-intensive manual quality assessment process. the methodology generates continuous values of spot quality which can be utilized to discard spots of undesired quality or used as weights in subsequent analysis procedures.

RESULTS
five cdna microarray slides using the populus second generation microarray slide layout  where the samples originate from a previous investigation of leaf development  were used for classification training. five additional pop <dig> slides, not included in the training set, were employed for external validation. segmentation of raw images was performed using an implementation of the seeded region growing  algorithm  <cit> . the properties of each spot were subsequently characterized using a large set of descriptors allegedly linked to spot quality. these properties include foreground and background variability measures, spot morphology and foreground intensity distribution measures. please consult additional file  <dig> for a complete list of all the utilized descriptors.

following segmentation, spots were inspected by three experienced microarray users and independently assigned to the two quality categories {bad, not bad}. spots in the bad category consisted of all the spots that were classified as bad by at least one of the experienced users while the remaining spots were categorized as not bad. for classification and evaluation purposes, the spots in the bad category were subsequently partitioned into different sub-classes based on visual properties as described in table  <dig>  this can be seen as characterizing each spot as exhibiting

 <dig>  no issues ; or

 <dig>  foreground issues ; or

 <dig>  background issues ; or

 <dig>  any combination of  <dig> and 3

to avoid confounding of properties, only spots displaying pure issues  were used in the classification training, although all spots were used in the model evaluation. the three-class problem was subjected to multivariate analysis by means of pls  <cit>  regression coupled with discriminant analysis  with the aim to discriminate not bad spots from fi spots and bi spots. the result from the pls-da regression model is a predicted class conformity  value for each of the classes: not bad , foreground issues  and background issues  with the added restriction that ccnb =  <dig> - . due to this restriction, only the conformity value of the not bad spots  will be interpreted in the upcoming sections. a ccnb value approaching  <dig> denotes high compliance with the not bad class, which can be interpreted as a quality measure of the spot. spots visually categorized as bad should thus exhibit a value of ccnb close to  <dig> whereas spots categorized as not bad should exhibit a value of ccnb close to  <dig> 

receiver operating characteristics  plot of the classifications of the pop <dig> training set and pop <dig> test set, respectively, is available in figure  <dig>  a density plot of the ccnb value for the bad and not bad spots in the pop <dig> training set is shown in figure  <dig>  showing a partial overlap between the discrimination of the two classes. due to this overlap, discrimination accuracy was dependent on a threshold value t denoting the separation point between the two classes.

spots with a predicted ccnb value below t were classified as bad whereas the remaining spots were classified as not bad. the threshold value can be set more or less stringently depending on the quality filtering requirements. this is illustrated in figures 4a–b, depicting different views of interpreting the classification accuracy of the pop <dig> training set and the pop <dig> test set. the threshold values were set either to maximize the overall classification accuracy or to maximize the class-wise classification accuracy. the overall classification accuracies for the pop <dig> training set  and pop <dig> test set  were calculated using equation  <dig> for all t in the interval  using ccnb values for the {bad, not bad} spots. the classification accuracy peak at a level of approximately 98% where t =  <dig>  . predicted class-wise accuracies were calculated using equation  <dig> employing ccnb values for the bad spots and ccnb values for the not bad spots separately. the predicted class-wise accuracies intersect at a level of 95%  for t =  <dig> . exact classification accuracies per sub-class, based on the intersection threshold value t =  <dig>  as illustrated in figure 4b, are available in table  <dig> 

the presented masqot approach was compared to three existing quality control methods: the composite quality score qcom proposed by wang et al  <cit> , the mean-median correlation factor mmcorr evaluated by tran et al  <cit>  and the coefficient of variation  parameter cvspot evaluated by sauer et al  <cit> . threshold values for all quality control parameters were set to achieve maximum overall classification accuracy. the result, shown in table  <dig>  demonstrates that the masqot approach provides a greater level of class discrimination for the pop <dig> test set compared to the remaining evaluated quality control methods.

discussion
cdna microarray spot quality control is, in many aspects, a complex problem. naturally, the automatic assessment of quality of each spot is highly reliant on the characterization of the spot. incorrect approximations of the spatial location will affect the properties of the segmented foreground region, which in turn will influence the values of the quality control descriptors. in such a sequential process, where each step is dependent on the preceding steps, errors will propagate down-stream at a high rate. however, the most striking intricacy is perhaps the visual assessment, which is the foundation of this computer-based classification, where even experienced microarray users tend to disagree. as shown from the results presented here, it is the spots with unanimous visual quality assessment that are the most complicated to reproduce accurately. this disagreement stems from the more fundamental issue of defining 'quality' and in understanding the basal aspects that affect this quality.

the approach described here aims to assess the technical precision of each spot, which is believed to be linked to the biological accuracy . it should thus be stated, in this context, that lack of precision in a microarray spot measurement does not necessarily infer lack of accuracy. however, it is arguably reasonable to handle spots of questionable precision with specific care during the analysis procedure to aid the concluding biological interpretations.

the spot quality control assessment is commonly treated as a discrete problem  but the spot quality varies on a continuous scale, ranging from very bad to very good. instead of discarding spots, one might weight the spots according to the quality assessment. the concept of relative spot weights has previously been acknowledged in microarray normalization techniques  but might also prove to be valuable in additional analysis steps. however, evaluation of the usage and validity of spot weights based on the quality assessments provided here remains the scope of a future paper.

the rate of accuracy in prediction of the true positives  and the true negatives  are illustrated separately since these accuracies are not consistently of equal importance. for instance, depending on the user and the question at hand, it might be more important to avoid the risk of removing spots of decent quality than to eliminate all of the bad spots from the data set. simply using the overall classification accuracy could be rather illusive, merely since the number of bad spots is much lower than the number of not bad spots in a typical data set.

the methodology presented here is based on the scaled sum of the intensities from both channels but can, with minor adjustments, also be based on single channel intensities. by using the scaled channel intensity levels, one avoids the risk of drowning information, in particular when there is a great difference in intensity level between the channels. in addition, the presented approach greatly resembles the visual illustrations of the spots which, by design, will provide an advantage in finding correlation between the visual quality assessment and the spot descriptors. furthermore, it is more feasible for the average user to achieve a per-spot quality measure than a per-channel quality measure since this avoids raising questions with regard to what to do when only one channel is of low or moderate quality.

the recent advances in spot quality control have clearly shown that a good explanation of training data is possible using several different methodologies of varying complexity. however, very few efforts have been made to evaluate further aspects of the quality  and, most importantly, the reproducibility of the classification on external data. external reproducibility has been the major aim here, partly overshadowing the aim of internal reproducibility on the training data, which is shown by the clear agreement in accuracy between the independent pop <dig> training set and the pop <dig> test set.

CONCLUSIONS
the presented masqot technique provides a robust methodology for semi-automated cdna microarray spot quality control with high accuracy of training data as well as external data compared to other evaluated methods. the masqot methodology generates non-discrete values of spot quality which can be utilized as weights in subsequent analysis procedures as well as to discard spots of undesired quality using the proposed threshold values.

