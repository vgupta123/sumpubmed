BACKGROUND
some microarray-based gene expression analyses such as significance analysis of microarray   <cit>  aim to discover individual genes whose expression levels are associated with a phenotype of interest. such individual-gene analyses can be enhanced by utilizing existing knowledge of biological pathways, or sets of individual genes , that are linked via. related biological functions. gene-set analyses aim to discover gene sets the expression of which is associated with a phenotype of interest.

many gene-set analysis methods have been proposed previously. for example, mootha et al.  <cit>  proposed gene set enrichment analysis , which uses the kolmogorov-smirnov statistic to measure the degree of differential gene expression in a gene set by a binary phenotype . goeman et al.  <cit>  presented global test, modeling differential gene expression by means of random-effects logistic regression models. goeman et al.  <cit>  also extended their methods to continuous and survival outcomes. mansmann and meister  <cit>  proposed ancova global test, which is similar to global test but having the roles of phenotype and genes exchanged in regression models. mansmann and meister  <cit>  pointed out that their ancova global test outperformed global test, especially in cases where the asymptotic distribution of global test cannot be used. dinu et al.  <cit>  discussed some critical problems of gsea as a method for gene-set analysis and proposed an alternative method called sam-gs, an extension of sam to gene-set analysis. goeman and bühlmann  <cit>  provided an excellent review of the methods, discussing important methodological questions of gene-set analysis, and summarized the methodological principles behind the existing methods. an important contribution of their review was the distinction between testing "self-contained null hypotheses" via. subject sampling and testing "competitive null hypotheses" via. gene sampling. they argue, and we agree, that the framework of the competitive hypothesis testing via. gene sampling is subject to serious errors in calculating and interpreting statistical significance of gene sets, because of its implicit or explicit untenable assumption of probabilistic independence across genes.

although global test, ancova global test, and sam-gs each test a self-contained hypothesis on the association of expression patterns across a gene set with a phenotype of interest in a statistically appropriate manner, it is unclear how the three methods compare on performance in detecting underlying associations. in this paper, we compare the performance of the three methods via. simulation and real-world microarray data analyses, both statistically and biologically.

RESULTS
simulation experiment
our first evaluation of the three methods used a simulation study, similar to that of mansmann and meister  <cit>  with some modifications that make the simulated data more realistic, and evaluated the size and power of the three hypothesis tests. gene-set analysis was performed for both the original and "z-score standardized" simulated datasets so that the effects of standardization on the three tests' performance can be assessed. the z-score standardization was motivated by that fact that gene-expression variances can vary greatly across genes, even after a normalization, which could influence gene-set analysis. in the z-score standardized datasets, gene expression was standardized using the following equation:

 xjk'=xjk−x¯jsj 

where xjk is the gene expression for gene j in sample k, x¯j and sj are the sample mean and standard deviation of gene j expression using all samples, respectively. all simulation analyses compared the mean expression of a gene-set of interest between two groups, each with a sample of  <dig> observations.

first, we checked the size of the three tests, before and after the standardization, according to the following three scenarios of no differential expression between two groups:  randomly generate expression of  <dig> genes for the two groups from a multivariate normal distribution  with a mean vector μ and a diagonal variance-covariance matrix Σ, where the  <dig> elements of μ and the  <dig> diagonal elements of Σ were randomly generated as  <dig> independently-and-identically-distributed  uniform random variables in  and  <dig> i.i.d. uniform random variables in , respectively ;  exactly same as  except the variance-covariance matrix Σ of the mvn being changed to have a correlation of  <dig>  between all pairs of the first  <dig> genes and also between all pairs of the second  <dig> genes;  exactly same as  with the correlation value changed from  <dig>  to  <dig> .

second, we estimated the power of the three tests, before and after the standardization, by randomly generating a gene set of size  <dig>  using the exactly same simulation set-up of the size-evaluation  above, but allowing the first  <dig> genes being differentially expressed. the mean expression of the  <dig> differentially expressed genes was randomly generated from uniform as in the size-evaluation , but was subsequently modified by an addition and a subtraction of a constant γ, as in mansmann and meister  <cit> , such that mean vectors μi's for the two groups  differ by 2γ, μ1j−μ2j=ij>202γ, for j =  <dig> ...,  <dig>  we considered a range of γ from  <dig> to  <dig> with an increment of  <dig> . the  <dig> differentially expressed genes were set to have a correlation of  <dig> , as in the size-evaluation , but no correlation and a correlation of  <dig>  were also considered.

in the comparison of size across the three tests, the size was estimated by the observed proportion of replications with a p-value smaller than the correct size α. by definition, under the null hypothesis, a proportion α of the replications of an experiment is expected to yield a p-value smaller than α. in order to assess the size, we ran  <dig> replications and used α =  <dig> . for each permutation-based p-value,  <dig> random permutations were carried out.

in the comparison of power across the three tests, the power was estimated by the observed proportion of the replications of an experiment in which the null hypothesis was correctly rejected. given the fixed numbers of samples and genes with the fixed correlation structure in the simulation experiment, a larger effect size γ leads to higher power for a given α-level. in estimating the power, we ran  <dig> replications of an experiment for each γ value. we considered α at  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig> . for obtaining a permutation-based p-value,  <dig> random permutations were carried out.

the empirical type i error rates of sam-gs and the two global tests with permutations were almost right on the target of the nominal value of  <dig> , before and after the standardization, for all three scenarios considered for the evaluation of size . type i error rates of global test with the scaled χ <dig> null distribution and global test with the asymptotic null distribution with a quadratic form deviated noticeably from the nominal size, being too liberal with the scaled χ <dig> and too conservative with the asymptotic distribution  as shown in table  <dig>  as the correlation among the  <dig> genes increased, the type i error rates of global test with the scaled χ <dig> null distribution and the global test with the asymptotic null distribution with a quadratic form generally moved towards the nominal size of  <dig> . type i error rates of ancova global test with the asymptotic distribution also deviated noticeably from the nominal size:  <dig> ,  <dig>  and  <dig>  before the standardization and  <dig> ,  <dig>  and  <dig>  after the standardization, for r =  <dig>   <dig> , and  <dig> , respectively. hereafter, therefore, the p-values for global test and ancova global test are calculated based on permutations. we also estimated the size of the three tests using  <dig> samples, instead of  <dig> samples, in each group, and observed similar patterns. as the sample size increased, the type i error rates of the two global tests by using the asymptotic distributions moved towards to the nominal level of  <dig> .

the second step of the simulation was to assess power, the results of which are shown in figure  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  before the standardization, sam-gs showed higher power than the global tests at α =  <dig> , with increasing power differences with decreasing α levels. this pattern was observed regardless of the correlation level in the  <dig> differentially-expressed genes . after the standardization, the performances of these three methods became closer: sam-gs showed slightly higher power than the global tests with increasing power difference with decreasing α levels.

real-world data analyses
our next evaluation of the performance of the three methods used biologically, a priori defined gene sets and three microarray datasets considered in subramanian et al.  <cit> , download from gsea web-page,  <cit> :  <dig> p <dig> wild-type vs.  <dig> p <dig> mutant cancer cell lines;  <dig> male vs.  <dig> female lymphoblastoid cells;  <dig> acute lymphoid leukemia  vs.  <dig> acute myeloid leukemia  cells. for pathways/gene sets, we used subramanian et al.'s gene-set subcatalogs c <dig> and c <dig> from the same web-address above on "molecular signature database." the c <dig> catalog includes gene sets corresponding to human chromosomes and cytogenetic bands, while the c <dig> catalog includes gene sets that are involved in specific metabolic signaling pathways  <cit> . in subramanian et al., catalog c <dig> included  <dig> sets, one for each of the  <dig> human chromosomes, and  <dig> sets corresponding to the cytogenetic bands; catalog c <dig> consisted of  <dig> sets containing gene sets reported in manually curated databases and  <dig> sets containing genes reported in various experimental papers. following subramanian et al.  <cit> , we restricted the set size to be between  <dig> and  <dig>  resulting in  <dig> pathways to be examined.

we compared the performance of the three methods before and after the standardization by listing the gene sets which had a p-value ≤  <dig>  by any of the three methods.

* pathway member

** apoptosis

$ p53-induced proline oxidase mediates apoptosis via a calcineurin-dependent pathway

† cell cycle

‡ integrated negative feedback loop between akt and p53

we then compared the three methods incorporating the z-score standardization. for sam-gs, the p-values before and after the standardization were highly consistent, and, therefore, we used the results of sam-gs before the standardization for the comparisons with the other two methods. for global test and ancova global test, p-values changed appreciably. notably, p-values of global test and ancova global test after the standardization agreed closely with those of sam-gs . for example, the p-values of p53hypoxia pathway changed from  <dig>  to < <dig>  for global test and from  <dig>  to < <dig>  for ancova global test. although the p-values of the three methods agreed with each other after the standardization, the p-values from sam-gs tended to be smaller than those from global test and ancova global test, in the lower range of p-values  : this is consistent with the power-comparison simulation in which sam-gs showed slightly higher power than the global tests at small α levels, even after the standardization.

the same pattern was found in the analyses of the male-vs.-female lymphoblastoid dataset and the all-vs.-aml dataset . before the standardization, p-values from global test and ancova global test differed greatly from p-values from sam-gs. the p-values of global test and ancova global test changed markedly after the standardization and were very close to those of sam-gs. after the standardization, in the male-vs.-female analysis,  <dig> gene sets had a p-value <  <dig>  by one or more of the methods;  <dig> of these had a sam-gs p-value smaller than, or equal to, those of global test and ancova global test. in the all-vs.-aml analysis, all sets were statistically significant with p-values <  <dig>  by all three tests: which is unlikely to be of any biological significance.

in the user guides for global test and ancova global test, variance stabilization  was used to normalize the data  <cit> . we also assessed the performance of the three methods on the p <dig> dataset, male vs. female dataset, and the all/aml dataset using vsn. the results for the p <dig> dataset are shown in table  <dig> and figure  <dig>  when vsn was used for the normalization of the data, we observed:  p-values of global test and ancova global test became similar to those of sam-gs, but not as close as the p-values after the z-score standardization; and  in the lower range of p-values, the p-values for sam-gs tended to be smaller than those of global test and ancova global test, .

discussion
from the simulation results, we suggest that, when global test and ancova global test are used for the analysis of microarray data, permutations should always be used for the calculation of statistical significance. in the documentation included with the global test r package, goeman et al. noted that the asymptotic distribution with a quadratic form is the recommended method for large sample sizes and it can be slightly conservative for small samples. in our simulation study, we used  <dig> and  <dig> samples for each of the two groups. in each situation, the asymptotic method with a quadratic form gave conservative p-values, although the difference between asymptotic and permutation-based methods did decrease when the sample size increased. goeman et al. also noted that the scaled χ <dig> method can be slightly anti-conservative, especially for large gene sets. our simulation study showed that the scaled χ <dig> method can be markedly anti-conservative. this is in accord with the manual of global test, which recommends against using the scaled χ <dig> approximation.

we found that performance of the two global tests changed greatly before and after standardization, but sam-gs performance remained unchanged. this can be explained by:  the invariance of t-test statistics under shifting and rescaling of data, that is relevant to sam-gs;  ancova's explicit assumption that all genes in the set to have an equal variance, a violation of which would clearly affect the performance of ancova global test; and  global test's assumption that the regression coefficients come from the same normal distribution, an assumption that is met by the standardization of gene expression. therefore, some sort of standardization that makes the variances of gene expression similar across genes is needed before using global test and ancova global test. sam-gs employs a constant in the denominator of its t-like test statistic to address the small variability in some of the gene expression measurements and, thus, effectively standardizes expression across genes; neither global test nor the ancova global test addresses this characteristic of microarray data. both goeman et al.  <cit>  and mansmann and meister  <cit>  have stated that an appropriate normalization is important. note that not many normalization methods would standardize the expression across genes. it is only after applying z-score standardization  or the vsn normalization, that the results of the three methods became congruent. the similarity between global test and global ancova test has already been commented upon in  <cit> . the similarity between sam-gs and global test may be inferred from the construction of the latter as a weighted sum of squared transformed t-statistics  <cit> , which is similar to the sam-gs test statistic.

it should be noted that global test allows four different types of phenotype variables: binary; multi-class; continuous; and survival. ancova global test allows binary, multi-class, and continuous phenotypes. the ability to handle different classes of phenotypes is a very important advantage of global test and ancova global test over sam-gs. it is also possible to use global test and ancova global test while adjusting for covariates . if covariates are incorporated, the two tests assess whether the gene-expression profile has an independent association with the phenotype that is above and beyond what is explained by the covariates. the ability to adjust for covariates is another important advantage of global test and ancova global test over sam-gs.

we focused on p-values in this paper because we were comparing the three methods that test "self-contained null hypotheses" via. subject sampling. to account for multiple comparisons when multiple gene sets are tested, one might consider false discovery rate  instead of type i error probability. for example, sam uses a q-value, an upper limit of the fdr, for each gene, which could be extended here to each gene-set using the method of storey  <cit> . the q-values of the  <dig> gene sets listed in table  <dig> are displayed in additional file  <dig> 

we have considered, but did not report detailed comparison results of two other methods, tian et al.  <cit>  and tomfohr et al.  <cit> , that test self-contained hypotheses via. subject sampling, in addition to the three methods we highlighted above. tian et al.  <cit>  tests the significance of a gene set by taking the mean of t-values of genes in the gene set as a test statistic and evaluating its significance by a permutation test. tomfohr et al.  <cit>  reduces the gene set's expression into a single summary value by taking the first principal component of expressions of genes in the gene set and performs a permutation-based t-test of the single summary. the two methods gave appreciably different results when compared to global test and ancova global test, and sam-gs. of the  <dig> gene sets in table  <dig> for the p <dig> analysis, for instance, tian et al. and tomfohr et al. identified only eight and one gene sets, respectively, with p-value <  <dig> : the atm pathway, for example, was identified by global test, ancova global test, and sam-gs with p-value ≤  <dig> , while the methods of tian et al. and tomfohr et al. gave p-value =  <dig>  and  <dig> , respectively. the main reasons for their large discrepancies from the results of the three highlighted methods are as follows. tian et al. sums up the t-values for all the genes in a gene set, which will result in cancellation of large positive t-values and large negative t-values. among the  <dig> up-regulated and  <dig> down-regulated genes in the atm pathway, for example, two up-regulated genes had large positive t-values  and three down-regulated genes had large negative t-values : these large positive and negative t-values cancel each other when summing up all t-values in the tian et al. test statistic, leading to reduced power for detecting gene sets that contain both significantly up-regulated genes and significantly down-regulated genes. the method of tomfohr et al. summarizes the |s|-dimension gene-expression vector of genes in the gene set s by the first principal component without considering the phenotype: if the direction of the first principal component does not correspond to the direction that separates the two phenotypes, their method does not capture the differential expressions even when they exist, leading to markedly reduced power.

although we focused on the comparison of the "self-contained null hypothesis" approaches, it is also of methodological interest to see how "competitive null hypothesis" approaches compare. we, therefore, applied three "competitive null hypothesis" approaches to the analysis of the p <dig> dataset: gene set enrichment analysis   <cit> ; the significance analysis of function and expression   <cit> ; and fisher's exact test  <cit> . the results are shown in additional file  <dig>  the results from the three "competitive null hypothesis" approaches were greatly different from those of sam-gs and the global tests. most of the gene sets identified as being significantly associated with the p <dig> mutation by sam-gs and global tests were not identified as such by the three "competitive null hypothesis" approaches. the only gene set additionally identified as being significantly associated with the p <dig> mutation  was human_cd34_enriched_tf_jp: for this gene set, the fisher's exact test p-value was <  <dig> , but all the other five methods gave p-values >  <dig> . known biological functions of p <dig> are clearly more consistent with the results of the "self-contained null hypothesis" approaches. the differences observed between "self-contained null hypothesis" and "competitive null hypothesis" approaches can be attributable, at least partly, to the fact that the significance of a gene set depends only on the genes in the set under the "self-contained null hypothesis" testing, while, under the "competitive null hypothesis" testing, the significance of a gene set depends not only on the genes in the set but also on all the other genes in the array.

in summary, the primary advantage of sam-gs may be the slightly higher power in the low α-level region that is of highest scientific interest, whereas, despite the need for appropriate standardization, global test and the ancova global test can be used for a variety of phenotypes and incorporate covariates in the analysis.

CONCLUSIONS
in conclusion, global test and ancova global test require appropriate standardization of gene expression measurements across genes for proper performance. standardization of these two methods and the use of permutation inference make the performance of all three methods similar, with a slight power advantage in sam-gs. global test and the ancova global test can be used for a variety of phenotypes and incorporate covariates in the analysis.

