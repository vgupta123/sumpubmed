BACKGROUND
based upon high throughput data, to reliably and accurately explore the network structure of elements  is one of the most important issues in computational biology  <cit> . currently, there are two main approaches which are often used to infer causal relationships  <cit>  or interactions among a set of elements  <cit> . one is the granger causality approach  <cit> , and the other is the bayesian network inference approach  <cit> . the latter is often applied to static data. however, one can employ the dynamic bayesian networks to deal with time series data for which the granger causality has been solely developed. the granger causality has the advantage of having a corresponding frequency domain decomposition so that one can clearly find at which frequencies two elements interact with each other.

giving a multi-variable time series dataset, the granger causality and dynamic bayesian networks  <cit>  can both be applied. the granger causality notation, which was firstly introduced by wiener and granger  <cit> , proposed that we can determine a causal influence of one time series on another: the prediction of one time series can be improved by incorporating the knowledge of the second one. on the other hand, the bayesian network  <cit>  is a special case of a diagrammatic representation of probability distributions, called probabilistic graphical models  <cit> . the bayesian network graph model comprises nodes  connected by directed links  and there is no cycle in the graph. to learn the structure and the parameters for the bayesian networks from a set of data, we should search the space of all possible graph representations, and find out which structure is most likely to produce our data. if we have a scoring function  which can determine the structure and parameter likelihood from the data, then the problem is to find the highest score  structure among all the possible representations.

the causal relationship derived from these two approaches could be different, in particular when we face the data obtained from experiments. therefore it is of vital importance to compare these two causal inferring approaches before we could confidently apply them to biological data. by doing the comparison, one expects to find the advantages, performances and stabilities for each technique.

adopting the most common existing methods to find the coefficients of the time series in both approaches in the literature, we compare the dynamic bayesian network with the granger causality both in the linear and nonlinear model. interestingly, a critical point of the data length is found. when the data length is shorter than the critical point, the dynamic bayesian network approach outperforms the granger causality approach. but when the data length is longer, the granger causality is more reliable. the conclusion is obtained via intensive computations . a biological data set of gene microarray is analyzed using both approaches, which indicates that for a data set with a short sampling length the dynamic bayesian network produces more reliable results. in summary, we would argue that the dynamic bayesian network is more suitable for dealing with experimental data.

RESULTS
to illustrate and compare the differences between the dynamic bayesian network inference and the conditional granger causality, a simple multivariate model with fixed coefficients, which has been discussed in many papers to test the granger causality, is tested first. we then extend our comparisons to the more general case of the model with random coefficients, which requires considerable computational resources. more than  <dig> networked computers are used to perform the comparisons for more than a week. both the granger causality and the dynamic bayesian network are applied to nonlinear models. finally, we test our approach on a set of microarray data recently acquired from a comparison of mock and infected arabidopsis leaf.

synthesized data: linear case
example  <dig> suppose we have  <dig> simultaneously recorded time series generated according to the equations:

   

where n is the time, and  are independent gaussian white noise processes with zero means and unit variances. from the equations, we see that x <dig> is a cause of x <dig>  x <dig> and x <dig>  and x <dig> and x <dig> share a feedback loop with each other, as depicted in figure 1b. figure 1a shows an example of the time trace of  <dig> time series. for the granger causality approach, we simulated the fitted vector autoregressive  model to generate a data set of  <dig> realizations of  <dig> time points, and applied the bootstrap approach to construct the 95% confidence intervals . for granger causality, we assume the causality value is gaussian distributed. then the confidence intervals can be obtained by calculating the mean and standard derivation values  <cit> . according to the confidence intervals, one can derive the network structure as shown in figure 1b which correctly recovers the pattern of the connectivity in our toy model. for the dynamic bayesian network inference approach, we can infer a network structure  for each realization of  <dig> time points. the final resulting causal network model was inferred with high-confidence causal arcs  between various variables  <cit> . this complex network contains the information of different time-lags for each variable. it fits exactly the pattern of connectivity in our var model. in order to compare it with the granger causality approach, we can further simplify the network by hiding the information of time-lags, and then we infer the exactly same structure as the granger causality approach . from this simple example, we can find that both approaches can reveal correct network structures for the data with a large sample size .

most, if not all, experimental data has a very limited time step due to various experimental restrictions. hence one of the key quantities to test the reliability of an approach is the data length . in the next setup, we reduce the sample size to a smaller value and check its impact. figure 2a shows the case of the sample size of 80: we find both approaches start failing to detect some interactions . by reducing the sample size to  <dig>  we can see that the bayesian network inference can derive more true positive connections than the granger causality. this is certainly an interesting phenomenon and we intend to explore whether it is true for a more general case.

example  <dig> we considered a more general toy model; the coefficients in the equations  of example  <dig> are randomly generated. this toy model aims to test the causality sensitivity for the two approaches. suppose  <dig> simultaneously generated time series according to the equations:

   

where w <dig>  w <dig>  â‹¯, w <dig> are uniformly distributed random variables in the interval . the randomly generated coefficients are also required to make the system stable. the stability can be tested by using the z-plane pole-zero method, which states if the outermost poles of the z-transfer function describing the time series are inside the unit circle on the z-plane pole-zero plot, then the system is stable.

the above toy model is then used to test the two different causality approaches: bayesian network inference and granger causality. they are applied with different sample sizes. for each sample size, we randomly generated  <dig> different coefficient vectors , which corresponds to <dig> different toy models in example  <dig>  for each different coefficient vectors model, we applied the same approach as in example  <dig>  using monte carlos method to construct 95% confidence interval for the granger causality approach and chose high-confidence arcs  for the bayesian network inference approach. the total number of arcs  is  <dig>  for each sample size. however we cannot expect to detect the maximum number of arcs in our system, since the coefficients are randomly generated, which could be significantly small.

now we are in the position to find out why the dynamic bayesian network is better than the granger causality when the data length is short, and vise verse. in figure 3b, we compare the performances on different coefficients  for a fixed sample size of  <dig> . the x-axis shows the absolute value of coefficients, and y shows the corresponding causality . for visualization purposes, the figure for the granger causality is shifted upward. from the five graphs, we can see that there is no difference between these two approaches if the coefficients are significant large : both approaches can infer the correct connections. for most cases, the granger causality approach performs with more stability when the coefficients are larger than  <dig> , and the bayesian network inference approach shows slightly more oscillations around this point. hence we conclude that the granger causality is less sensitive to the small value of the connection when the data length is large .

we now compare the fitting accuracy of the two approaches, as shown in figure 3c. we use the average mean-square error as a measurement of the fitting. not surprisingly, the dynamic bayesian network approach considerably outperforms the simple fitting algorithm in the granger approach  <cit> , in particular when the data length is short.

in conclusion, when the data is a reasonable fit to the original model, the granger causality works better. this is due to the fact that the granger causality approach is more sensitive to a small value of the interactions. when the data length is short, the bayesian approach can fit the data much more reliably and it outperforms the granger approach.

synthesized data: non-linear case
in real situations, all data should be nonlinear and a linear relationship as described above is only an approximation. to address the nonlinear issue, we turn our attention to kernel models. as we all know, any nonlinear relationship can be approximated by a series of kernel functions.

example  <dig> we modify the model in example  <dig> to a series of nonlinear equations as follows:

   

in this example, the center and variance of each time series is chosen as the center and variance in the kernel function. we use the fuzzy c-mean method to find the center of each time series and then applied the same approach as in example  <dig>  for the granger causality approach, we simulated the fitted var model to generate a data set of  <dig> realizations of  <dig> time points, and applied the bootstrap approach to construct the 95% confidence intervals . according to the confidence interval, one can derive the network structure  which correctly recovers the pattern of connectivity in our non-linear model. for the bayesian network inference approach, we can infer a network structure  for each realization of  <dig> time points. we can then obtain a simplified network structure .

for a small sample size , worse results are obtained for both approaches comparing to the previous linear model. both approaches start to miss interactions when the sample size is smaller than  <dig>  when the sample size is  <dig>  the bayesian network inference approach can detect one more true positive interaction than the granger causality. however, when the sample size is  <dig>  both approaches fail to detect all the interactions.

in the next step, we extend our non-linear model to a more general setting in which the coefficients in the equations are randomly generated. figure 6aa shows the comparison result of the percentage of true positive connections derived from these two methods. it is very interesting to see that a critical point around  <dig> exists in the non-linear model, similar to the linear model before. from figure 6ab, the computing time required for the bayesian network inference is still much larger than the granger causality. in figure 6b, we compare the performances on different coefficients  for a fixed sample size of  <dig>  from the five graphs, we can see that in general the granger approach is more sensitive to a small value of the coefficients .

therefore, all conclusions in the linear case are confirmed in the nonlinear model. in the literature  <cit> , the result they obtained shows the same direction as we did here, which finds that the granger causality performs better than the dynamic bayesian network inference concerning a nonlinear kernel model of genetic regulatory pathways and for a sufficiently large sample size .

experimental data
finally we carry out a study on experimental data of microarray experiments. the gene data were collected from two cases of arabidopsis leaf: the mock  case and the infected case with the plant pathogen botrytis cinerea. a total of  <dig>  genes were measured with a time interval of two hours, with a total of  <dig> sampling points  and four replicates. we test the granger causality approach and dynamic bayesian network inference approach on a well-known circadian circuit. this circuit contains  <dig> genes: prr <dig>  gi, prr <dig>  elf <dig>  lhy, cca <dig> and toc <dig>  figure 7a shows the time traces of the  <dig> genes. from the time traces figure, it is clearly to see that they exhibit a  <dig> hour rhythm. note that the total number of time points is only  <dig>  compared to our previous toy model case, this sample size is quite small. we therefore expect the bayesian network inference to be more reliable.

we first apply the dynamic bayesian network inference approach on these two data sets. the two network structures for two cases are shown in figure 7b. in the next step, the conditional granger causality approach is applied. by using the bootstrapping method, we construct 95% confidence intervals as shown in figure 7cc. finally, we can also obtain two network structures for two different cases shown in figure 7ca and figure 7cb. it is clearly seen that the globe patterns for the mock case and the infected case are different.

from the literature, there are three well known connections among the whole structure for the mock case.  it is known that gi alone is independent of the remaining six genes in the circuit. there should be no connection to and from the gi node  in our derived network. from figure 7ba and figure 7ca, we find that the dynamic bayesian network inference method clearly picks this up, but the conditional granger causality approach fails to detect this property. the granger causality approach derived two false positive arcs which were connected to a gi node as shown in figure 7ca.  it is known that prr <dig> and lhy share a feedback loop. in other words, there should be two directed arcs connected from node  <dig>  to node  <dig>  and from node  <dig> to node  <dig>  the network structures derived from both approaches are in agreement with this known relationship.  it is known that elf <dig> has some interactions with both lhy and cca <dig>  there should be some connections between node  <dig>  to node  <dig> , and between node  <dig>  and node  <dig> . from our derived structures, both approaches can detect these connections, which are in agreement with the known structure in the literature  <cit> .

according these three known relationships in the structure, we can find that the bayesian network structure is in agreement with all three rules, but the network structure derived from the conditional granger causality is not: two more false positive interactions are found. again for a small sample size, the bayesian network inference approach could be more reliable than the conditional granger causality approach.

discussion
a fair comparison
in our results presented here, one of the key issues which is the cause of the critical point of the sampling size between the dynamic bayesian approach and the granger causality lies in the fact that a batch fitting approach is used in the granger causality approach. one might argue that we could use the sequential fitting approach as in the bayesian network to improve the performance of the granger causality approach. this is certainly the case. however, due to the thousand publications in both topics  <cit> , we simply adopted the most common approaches in the dynamic bayesian network approach and the granger causality. developing one of the approaches, for example the granger causality, so that it could always outperform the other is an interesting future research topic.

how long is long enough?
although we have found the critical point of the two approaches, in practical applications, we have no certain idea where the critical point is. hence, we still have to choose one of them to tackle the data. in molecular biology, we have to deal with a very limited data size; but in physiology, for example, neurophysiology, the data we record is usually very long. hence one could argue that we use the dynamic bayesian network in gene, protein or metabolite data, and apply the granger causality to physiology data. the dynamic bayesian network is more often reported in molecular biology, but the granger causality has been very successfully applied in neurophysiological data  <cit>  and fmri. the result we chose to use was always chosen through experimental validation, as we did here for the plant data.

frequency decomposition
as we emphasized at the beginning, the advantage of the granger causality over the dynamic bayesian network is the frequency decomposition, which is usually informative when we deal with temporal data. for example, in neurophysiology data, we know the brain employs different frequency bands to communicate between neurons and brain areas  <cit> . we would expect a similar situation to arise in genes, proteins and metabolites, although we lack a detailed analysis due to the limited data length. to this end, we have also presented frequency decomposition results in appendix  <dig>  for the dynamic bayesian network.

false positive
in our synthesized data, for both approaches, we did not find any false positive links in our experiments. however, there were a few false positive links found when we applied the conditional granger causality and also partial granger causality  on the gene data. one might ask why this is the case; there are several different reasons. firstly, the experimental data is not strictly stationary: it is a natural process and evolves with time. as a first approximation, we treat it as stationary. of course, we could use arima rather than arma model to fit the data in the granger causality. secondly, the seven gene network is only a small network embedded in complete and large network, so there are latent variables. using the partial granger causality  <cit>  which was originally developed for eliminating latent variables, gi still has links with the other six genes. whether the dynamic bayesian network could do a better job in the presence of latent variables is another research topic.

the meaning of the found motifs
two circuits are found: one with the mock plant and one with the infected plant. the plant rewires its circadian circuit after infection. ignoring the issue of identifying the molecular mechanisms which control circuit rewiring, which is itself an interesting and challenging problem, we intend to discuss the functional meaning of the two circuits. to this end, we could assign a dynamics to the network and try to decipher the implications of the rewiring. interestingly, we found that gi is recruited to save the network: if we leave gi as it is in the mock case, the whole network will rapidly converge to a fixed point state . we will publish the results elsewhere.

reasons for short size data
in our synthesized data, we test both short and long data samples and come to the conclusion that there is a critical size, at which the two approaches behave differently. in our experimental data, we only tested it for the short data set. of course, as we mentioned above, in neurophysiological data, we have recordings of long time traces and the granger causality is widely used there. however, we have to realize that all in vivo recordings are very dynamic and stationary of data will become a key issue once we apply both approaches to a long dataset. furthermore, when the dataset is long, both approaches could do well and it is more difficult to find the difference between the two. hence we have only compared the results for short data length in the experimental setup.

reasons for small size of variables
in our synthesized data, we only used  <dig> variables to simulate a small interacting network; the number of variables could affect the result we derived. as expected, see also  <cit> , the estimation of the granger causality becomes unfeasible when the number of variables is large and the amount of the data sets is small. hence, all results in the literature on estimating granger causality are exclusive for small networks , as we considered here. this is more or less true for dynamic bayesian network inference as well. extending the granger causality and the dynamic bayesian network inference to large networks is a challenging problem, even before we carry out the same comparison study on these two approaches as we did here.

CONCLUSIONS
in this paper, we carried out a systematic and computationally intensive comparison between the two network structures derived from two common approaches: the dynamic bayesian network inference and the granger causality. these two approaches are applied on both synthesized and experimental data. for synthesized data , a critical point of the data length is found, and the result is further confirmed in experimental data. the dynamic bayesian network inference performs better than the granger causality approach, when the data length is short, and vice versa.

