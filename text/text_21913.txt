BACKGROUND
the arms race between pathogens and hosts is a major force in evolution that is likely to have played key roles in the origins of multicellularity and sexual reproduction, among other biological phenomena  <cit> . in this race, hosts  have evolved a broad repertoire of defense strategies, sometimes at the expense of allocating substantial resources and genomic space for defense functions  <cit> . although a vast diversity of defense mechanisms exists across different life forms, the defense strategies can be generally classified into three groups  <cit> :  innate immunity systems that are based on recognition of conserved features of pathogens;  adaptive  immunity systems that provide enhanced efficiency through pathogen-specific  adaptive evolution  <cit> ; and  suicidal systems that cause programmed cell death  preventing further spread of the infection  <cit> . in principle, the pcd strategy can be considered a form of innate immunity given the apparent lack of specificity to particular pathogens in this form of defense  <cit> . however, given the substantial differences between the outcomes of immune response and programmed cell death for host, we adhere to the threefold classification of defense strategies for the purpose of the present analysis.

in prokaryotes, innate immunity involves, among other forms, receptor masking, restriction-modification , argonaute-based rnai-like machinery and dna phosphorothioation systems  <cit> . adaptive immunity that until recently had been considered a distinctive innovation in animals, is represented in prokaryotes by the crispr-cas systems that are found in nearly all archaea and many bacteria  <cit> . suicide  mechanisms comprise toxin-antitoxin  and abortive infection  systems  <cit> . although most of these defense mechanisms are widely distributed across the prokaryotic world, the prevalence of each class greatly varies among taxa  <cit> . moreover, genes encoding different defense systems are often clustered in genomic islands, suggesting that some of them might function in association  <cit> . in particular, most crispr-cas loci as well as many r-m loci contain genes encoding predicted toxins, leading to the hypothesis of a functional coupling between immunity and suicide or dormancy  <cit> . the diversity, intricacy and patchy distribution of anti-pathogen resistance mechanisms imply a highly complex evolutionary history so that unraveling the causes for the presence or absence of particular defense systems in individual taxa becomes a difficult task.

the fate of defense systems in a host population depends on multiple factors and trade-offs that contribute to the cost-benefit balance  <cit> . on the one hand, the benefits of having such systems depend on their efficacy and the frequency of infections. efficacy itself is the outcome of the evolutionary arms race with pathogens, and in the case of crispr-cas, mathematical modeling suggests that the efficacy of protection negatively correlates with virus diversity and host and virus effective population sizes  <cit> . on the other hand, fitness costs can vary for different systems and depend on physical and ecological variables, such as temperature, the identity of the pathogens targeted by the resistance mechanisms and the relevance of horizontal transfer for the acquisition of beneficial genes  <cit> . population structure also likely plays a role in the evolution of defense systems, not only through the repercussions for the ecological pathogen-host dynamics  <cit> , but also via direct and indirect effects on the efficacies of different forms of defense  <cit> . such effects are well illustrated by experiments with a genetically engineered suicidal system in escherichia coli which proved to be a successful phage defense mechanism in soft agar culture but not in liquid medium  <cit> . fully compatible conclusions on the essential, general role of population structure for the evolution and maintenance of programmed cell death have been reached by mathematical modeling  <cit> . finally, pre-existing resistance could affect the evolution of additional defense systems  <cit> . specifically, the question ‘why evolving two costly systems for a single task?’ applies to the evolution of suicide in the presence of immunity, especially because suicide can be interpreted as a defense system with an infinite individual fitness cost.

here we develop and analyze a computational model aimed at understanding which types of defense mechanisms evolve under distinct ecological conditions. we examine a scenario where hosts already possess some degree of resistance to pathogens via innate immunity and can evolve additional, costly immunity and/or suicide mechanisms. by exploring a broad range of immune and suicide efficacies in combination with variable degrees of population structure , simulations reveal a spectrum of evolutionary behaviors characterized by the acquisition of one, two or all three classes of defense mechanisms. while population structure proves critical for the evolution of cell suicide, acquisition of immunity mostly depends on its efficacy. we also extended the model to investigate possible causes and consequences of coupling between adaptive immunity and suicide. taken as a whole, these results provide context to the co-occurrence of defense mechanisms in nature.

methods
the computational model of pathogen-host coevolution
we set out to model a population of hosts and pathogens embedded in an interaction network. such a network determines not only the local dispersion of the pathogen but also the possible locations of a host’s offspring. in addition, long-range dispersion of hosts and pathogens to random locations on the network is allowed at certain mixing rates. as the long-range dispersion rates increase, the structured system gradually gives way to a well-mixed one. two types of interaction networks were implemented:  a square grid resembling a 2-dimensional spatial structure, and  a community network in which hosts are structured in a number of tightly connected clusters  of a given size. in the latter case, clusters other than self can only be accessed through long-range dispersion of host and pathogen. only one host per site is allowed. for computational purposes, the number of pathogens per site is limited to  <dig> . in the community network, group sizes ranging from  <dig> to  <dig> totally connected sites per group were explored through separate simulations. the network size, which determines the carrying capacity for hosts in the simulations, is equal to  <dig> 

ecological and evolutionary dynamics come into play through the following processes: host reproduction at a rate g, which succeeds if a randomly chosen neighbor site in the network is empty. in such a case, a copy of the parent host is placed in that site.

 host death at a rate dhost

 infection at a rate b * npath where npath is the number of pathogens sharing the site with the host. infection immediately leads to three possible outcomes:

 host survives and no pathogen is produced .

 host dies and no pathogen is produced .

 host dies and m pathogens are produced .



the outcome of the infection depends on the immune efficacies  and it is decided a sequential way: first, an innate immune response is tried. if it fails , adaptive immunity comes into play. suicide can be attempted before or after immunity; the differences between the two regimes are addressed when relevant. because either immunity, suicide or pathogen release occurs right after the infection there is no reproduction or dispersion of infected hosts. pathogen degradation at a rate dpath.

 pathogen diffusion to neighbor sites at a rate d.

 population mixing: the contents of two randomly chosen sites are swapped at rates rmixhost  and rmixpath . a fully structured scenario is set by making both rates equal to zero in the square grid network and to  <dig>  in the community network. notice that the latter requires a  value greater than zero in order to avoid total isolation of groups, which would lead to a population dynamics entirely driven by small-size effects, with fast and permanent extinction of parasites and/or hosts in separate groups.



the model is implemented through a simplified version of the tau-leaping algorithm. first, a time step dt is set by taking the inverse of the largest event rate and multiplying it by  <dig> ; then per individual/per site probabilities for host reproduction, host death, infection, pathogen degradation and mixing events are calculated as pevent = 1 − e− rate × dt. notice that, given our choice of dt and the parameter values, the probability of the same event affecting the same individual  more than once per time step is negligible. in the case of diffusion the probability that a pathogen drifts a given distance is taken from a poisson distribution with mean equal to d × dt. after calculating event probabilities, we proceed through every site in the network in a random order. at each site, host replication and death are tried first, sequentially followed by infection, pathogen degradation and pathogen diffusion. the number of pathogens that are degraded is chosen from a poisson distribution with mean pdegr × npath, where npath is the number of pathogens in the site after the outcome of a possible infection. the number of pathogens diffusing a given distance is chosen in a similar way and their final locations are independently decided. once all sites have been updated, a number of mixing events for hosts and pathogens is drawn from a poisson distribution with mean pmix times the number of sites in the network. each mixing event is performed by randomly choosing two sites and exchanging their  contents. this completes a cycle of the algorithm, which continues by setting a new time step and iterating the previous actions.

the population is initialized with suicide propensity equal to zero. each time a host replicates, mutations leading to small changes in the suicide propensity of the daughter cell can take place with probability μ. mutations are implemented by randomly choosing a value from a uniform distribution in the interval  and adding that to the suicide propensity pcd. suicide propensity is kept bounded between  <dig> and  <dig>  the probability of successful suicide is the product of the suicide propensity and a parameter cdmax, which represents the maximum possible efficacy for suicide. in the simulations, parameters μ and ε take values  <dig>  and  <dig> , respectively; the outcome of the simulation was shown to be highly robust to changes in the values of these parameters.

with respect to immunity, two or more classes of hosts with constant values of pii and pai compete for fixation. adaptive immunity  is envisioned as a trait that provides the host with enhanced immunity at an additional cost. under the assumption that there are different timescales for immune adaptation  and gain/loss of ai-associated genes , it is possible to assign a time-averaged efficacy to the adaptive immunity system and therefore circumvent explicit modelling of its “lamarckian” adaptive dynamics. the immune efficacies pii and pai should be interpreted as effective parameters, i.e. averages along an ecologically meaningful timespan which is long enough to allow for a large number of host-pathogen encounters but short compared to the evolutionary timescales involved in the acquisition and loss of innate and adaptive immunity systems. mutations leading to ai acquisition or loss are set to occur with probability λ =  <dig> . the fitness cost of adaptive immunity, c, is modeled as a death rate increase. this fitness cost is paid even if adaptive immunity is not activated .

simulations run for  <dig> host generations or until hosts or pathogens become extinct. as a preliminary step, an extensive exploration of the parameter space was carried out in order to determine which parameter combinations allow for long-term coexistence of pathogens and hosts. among those, the following base parameter values were selected: g =  <dig> , dhost =  <dig> , m =  <dig>  b =  <dig>  dpath =  <dig>  c =  <dig> , d =  <dig>  to test the robustness of the results, several other parameter combinations within the coexistence space were also tried, with no qualitative changes. also, ncreasing λ to  <dig>   or ε to  <dig>   produced neither qualitative nor significant quantitative differences in the stationary state. multiple combinations for parameters pii, pai, pcd and cdmax were explored; the dependency of the results on their values is discussed along the text and the actual values used to produce the figures are specified in the figure captions. all simulations were performed using a c++ implementation of the model and the results were processed and analyzed with matlab .

RESULTS
evolution of suicide in the absence of adaptive immunity
in order to simplify analysis of the model, evolution of suicide is considered first in the absence of adaptive immunity. to this end, all hosts are deprived of adaptive immunity  from the beginning of the simulation and are not allowed to recover it. in these conditions, altruistic suicide evolves if  the efficacy of innate immunity is low or moderate, and  the population is spatially structured . the first of these conditions is relaxed if suicide is only triggered once immunity has failed. in such a case, suicide becomes a non-costly trait . this arguably unrealistic behavior disappears if an explicit fitness cost is considered for suicide . other parameters of the model, such as the infection rate  or the pathogen offspring number m, are relevant to determine the regions of the parameter space where hosts and pathogens can coexist but their relevance for the evolution of suicide is minor. similar results were obtained with both the two-dimensional model and the community model. the case of different mixing rates for hosts and pathogens was also explored, with the result that evolution of suicide is much more sensitive to the long-range dispersion of hosts. as an example, for an immune efficacy of  <dig> , suicide does not evolve if the host mixing rate is above  <dig>  whereas the pathogen mixing rate can increase up to  <dig>  without precluding suicide.figure  <dig> 
evolution of altruistic suicide in the absence of adaptive immunity. a, b, c: average suicide propensity of a population after the evolutionary process as a function on the efficacy of innate immunity and the population mixing rate. the color code in a indicates the mean suicide propensity. b shows results for varying immune efficacy in a fully structured population . c shows the effect of weakening the population structure at a fixed immune efficacy equal to  <dig> . d: snapshots of the evolutionary process for an immune efficacy of  <dig>  and no mixing. grey to red colors indicate the suicide propensity of a host , white denotes empty sites and black infected hosts. in this setting, the decision to commit suicide occurs before immunity. maximum suicide efficacy cd
max =  <dig> 



figure 1d shows that evolution of altruistic suicide is concomitant with the formation of persistent islands of interacting individuals. the two-dimensional setting reveals that hosts self-organize in spatial islands that survive the longer the greater their suicide propensity. in the absence of suicide, waves of pathogen periodically clear out groups of hosts which cannot persist for a long time. however, as the suicide propensity evolves to higher values, host islands become more and more “impermeable” to the pathogen  which promotes persistence of such islands. in the two-dimensional setting, this effect is accompanied by a tendency of islands with high suicide propensity to grow and invade the available space.

complementary to the spatially extended setting, the community model provides for exploration of the effect of host group size on the evolution of altruistic suicide. under this model, hosts are placed in semi-isolated groups of limited size that locally behave as well-mixed populations, migration across groups taking place at a low rate. for small groups , we did not find any relevant differences with respect to suicide evolution, the results being similar to those obtained in the two-dimensional grid. in contrast, simulations show that suicide does not evolve if groups contain about  <dig> hosts or more. for such large groups, the adverse effect of within-group well-mixing is stronger than the positive effect of the meta-population structure. as a result, large groups with high degree of phenotypic heterogeneity require internal structure to prevent exploitation by ‘selfish’ hosts and maintain altruistic suicide as an efficient defense mechanism.

finally, we explored a scenario where the choice between suicide and immunity is a selectable trait. suicide before and suicide after immunity were treated as two alternative strategies that evolve independently and are equally accessible to the host. under conditions that are favorable to the evolution of suicide, suicide after immunity always outcompetes suicide before immunity so that the final state of the population fully consists of hosts in which suicide is triggered only when immunity fails .figure  <dig> 
suicide after immunity failure is favored compared to suicide before immunity. the color code, from red to blue, indicates the relative contribution of suicide before and after immunity to the total suicide propensity, provided that both strategies are equally accessible to the host. horizontal and vertical axes correspond to different values of the immune efficacy and the cost of maintaining suicide, respectively. cases of ‘no suicide’ correspond to final suicide propensities below  <dig> . fully structured population with maximum suicide efficacy cd
max =  <dig> 



evolution of adaptive immunity in the absence of suicide
we further explored evolution of adaptive immunity in hosts with no suicide. in this setting, suicide propensity is set to zero, and two classes of hosts, with and without adaptive immunity, compete for the limited spatial resources. both classes of hosts have the same level of innate immunity and only differ by the presence or absence of adaptive immunity the efficacy of which is kept constant during the simulations. figure  <dig>  shows the final composition of the population as a function of the immune efficacies of the competing hosts. three regimes can be observed: i) fixation of adaptive immunity, ii) coexistence of hosts with and without adaptive immunity, and iii) loss of adaptive immunity. fixation of adaptive immunity is only possible at moderate efficacies of both innate and adaptive immunity. as intuitively expected, poorly performing adaptive immunity is lost because its benefits do not compensate for the associated fitness cost. in the other extreme, less intuitively, adaptive immunity cannot be fixed if its efficacy is too high. in this case, the concentration of pathogens becomes so low that hosts lacking adaptive immunity can survive by taking advantage of their higher fitness compared to the hosts possessing adaptive immunity.figure  <dig> 
fixation of adaptive immunity only takes place for a certain range of immune efficacies. the evolutionary process takes place at fixed values of innate and adaptive immune efficacies and the fraction of hosts with adaptive immunity is recorded in the stationary state. the. x-axis corresponds to the  efficacy of the innate immunity; the y-axis to the  efficacy of adaptive immunity; the color code indicates the fraction of hosts with adaptive immunity. regions in red indicate fixation of adaptive immunity, while those in blue denote its loss. coexistence of hosts with and without adaptive immunity takes place in regions with lighter colors. the evolutionary process takes place in  a well-mixed scenario,  a structured population without possibility of suicide, and  a structured population with the possibility of evolving suicide, with a maximum suicide efficacies of cd
max =  <dig>   or cd
max =  <dig> .



the effects of population structure and fitness cost on the evolution of adaptive immunity are merely quantitative. in particular, population structure favors adaptive immunity and reduces the minimum efficacy that is required for it to reach fixation . the likely causes of this effect are discussed below. not surprisingly, the associated fitness cost has a direct effect on the maintenance of adaptive immunity, with higher costs requiring higher efficacy . this effect is especially pronounced in a well-mixed population; in a structured population, however, adaptive immunity can be fixed even at higher costs.

combined evolution of suicide and adaptive immunity
in the well-mixed system, suicide does not evolve and the results are the same as those described in the previous section for the case without suicide. in structured populations, the interaction of suicide and immunity results in a complex behavior that yields different combinations of the three defense mechanisms.

as schematically shown in figure  <dig>  different efficacies of the innate and adaptive immunities, as well as different values of the maximum suicide efficacy, give rise to distinct evolutionary outcomes which can be organized in a phase diagram with  <dig> regions . suicide and adaptive immunity coevolve in a region  that typically corresponds to small and moderate efficacies of the innate immunity and moderate efficacy of the adaptive immunity, and only if there is also a limit on the efficacy of suicide. when the efficacy of adaptive immunity exceeds a certain threshold, suicide no longer evolves . for even higher efficacies of adaptive immunity , the evolutionary process gives rise to two divergent classes: hosts with adaptive immunity coexist with hosts that lack it, both exhibiting negligible suicide propensities. notably, in the narrow coexistence region , both classes of hosts, those with and without adaptive immunity, evolve high suicide propensities. in this region, the efficacy of adaptive immunity systems lies just below the threshold of fixation. in the long term, however, populations within this region might end up losing adaptive immunity . finally, adaptive immunity is lost if either its efficacy is too low or the efficacy of innate immunity is too high. in the former case , hosts evolve suicide as an additional defense mechanism; in the latter , innate immunity is the only defense mechanism of the population. temporal dynamics for representatives of each region are shown in figure  <dig> figure  <dig> 
coevolution of adaptive immunity and suicide in a structured population depends on the immune and suicide efficacies. : fraction of hosts with adaptive immunity in the stationary state of the evolutionary process, as a function of the ai efficacy  and the maximum suicide efficacy attainable . red accounts for ai fixation, blue for ai loss. the ii efficacy has been fixed to pii =  <dig> . : suicide propensity evolved by majority hosts, in the same conditions as in a. red accounts for high suicide propensities, blue for low or no suicide. the double white line separates two regions for which the majority hosts differ, in accordance to panel a. notice that the actual suicide probability, pcd, is the product of the suicide propensity and the maximum suicide efficacy attainable, cd
max. : phase diagrams for the combined evolution of suicide and adaptive immunity in a structured population. i: innate immunity; a: adaptive immunity; d: suicide; brackets indicate coevolution of traits within the same host; regions with a striped shading pattern present coexistence of hosts with different sets of defense mechanisms.
evolutionary dynamics of defense mechanisms, representatives of each of the six regions of the phase diagram. black: fraction of hosts with adaptive immunity; red: average suicide propensity in hosts with adaptive immunity; blue: average suicide propensity in hosts without adaptive immunity. maximum suicide efficacy has been fixed to cd
max =  <dig> , values of pii and pai have been chosen from the phase diagram in figure 4c to represent each possible evolutionary outcome. population structured in a square grid with no mixing.



a comparison of the panels b, c, and d from figure  <dig> makes it clear that evolution of suicide can preclude fixation of adaptive immunity. specifically, as suicide evolves to higher efficacies , fixation of adaptive immunity becomes restricted to an increasingly narrow region of the parameter space. figure 4a, b shows how increasing cdmax results in higher ai efficacies being required for ai fixation and a concomitant shrinkage of the region in which ai and suicide coevolve. a detailed analysis of such instances reveals a transient two-stage dynamics : first, adaptive immunity spreads in the population getting relatively close to fixation; subsequently, altruistic suicide evolves in a minority of hosts that lack adaptive immunity. eventually, these individuals pervade the population and adaptive immunity is lost.

we further tested whether adaptive immunity interferes with the evolution of suicide. to this end, combined immunity was defined as a measure of the combined efficacy of innate and adaptive immunity. because both forms of immunity act sequentially and independently, the combined immune efficacy pitot equals to 1 − . figure  <dig> shows the average suicide propensity versus the combined immunity for a set of simulations performed with different innate and adaptive immune efficacies. when adaptive immunity is lost, the results coincide with those obtained in the absence of adaptive immunity. likewise, hosts with adaptive immunity  show suicide propensities similar to those expected for equivalent immune efficacies in the absence of adaptive immunity. therefore, it can be concluded that adaptive immunity does not specifically affect evolution of suicide as a defense mechanism.figure  <dig> 
adaptive immunity does not affect the evolution of suicide. the effective immune efficacy combines the efficacies of innate and adaptive immunities in a single parameter, so that results can be compared to the case with no adaptive immunity . black circles correspond to instances that lead to the loss of adaptive immunity; solid red circles are used for instances with fixation of adaptive immunity; open red circles for hosts with adaptive immunity in instances without fixation. data collapsed for structured populations with multiple values of pii and pai; cd
max =  <dig> .



the results presented in this section remain qualitatively the same regardless of whether suicide is activated before or after immunity, provided that a fitness cost for maintaining suicide is included . the average suicide propensities might be slightly higher in the latter case but the regions of the phase diagrams  remain similar.

programmed cell death dependent on immunity
prokaryotic adaptive immunity systems, in particular crispr-cas, encompass genes that are otherwise implicated in cell suicide such as toxin nucleases. in an attempt to shed light on the evolutionary factors behind such a tight co-occurrence of immunity and suicide, we examined a scenario where activation of adaptive immunity can lead to cell death and no pathogen production with probability q. this regime is equivalent to adding a new contribution to the suicide propensity of the form q * pai. two alternative formulations of the total suicide probability can be considered: on the one hand, if ai-dependent cell death is not affected by the maximum suicide efficacy, then pcdtotal = pcd + q * pai * ; on the other hand, if the maximum suicide efficacy cdmax also limits ai-dependent cell death, then pcdtotal = pcd + q * pai * . in both cases, relatively large values of q are required to obtain significant contributions of adaptive immunity to cell death. we studied the possible outcomes of an evolutionary process where hosts can possess either an adaptive immunity system which does not induce suicide , or an adaptive immunity system which does induce suicide , or no adaptive immunity. the ai-independent suicide can evolve as described in the preceding sections; the probability of mutations leading to gain/loss of ai-dependent suicide was set at  <dig> . the results shown in figure  <dig> indicate that suicide-inducing immunity can be preferentially selected for in structured populations under conditions such that  coevolution of adaptive immunity and suicide is the expected evolutionary outcome and  death induced by adaptive immunity is not limited by cdmax. if ai-dependent death is limited by cdmax, suicide-inducing adaptive immunity is transiently favored early in the evolutionary process but becomes a neutral trait compared to “simple” ai as soon as the probability of ai-independent suicide reaches values close to cdmax. finally, an adaptive immunity system that does not induce cell death is selected for in regions that are unfavorable to suicide evolution .figure  <dig> 
alternative models for the evolution of coupled suicide and immunity. two types of ai systems are considered: one whose activation can lead to cell death  with the probability q =  <dig> , and another that only works as a standard immune mechanism . mutations between both types occur with a small probability. the figure shows the relative fraction of hosts with suicide-inducer ai in the stationary state . the evolutionary process was simulated in a structured population with different values of the innate and adaptive immune efficacies , and a fixed value of the maximum suicide efficacy cd
max =  <dig> . in a, the maximum suicide efficacy only affects ai-independent suicide; in b, the maximum suicide efficacy limits all kinds of suicide, included suicide induced by ai. panels c and d correspond to a modified scenario where the efficacy of ai depends on the total degree of suicide according to a logistic formula; in c there is no limitation on ai-induced suicide, whereas in d it is limited by cd
max. the red region in panel d  is also characterized by the absence of ai-independent suicide.



immunity dependent on cell death mechanisms
a distinct cause of the coupling between immunity and suicide could be that some of the functions performed by suicide genes are required for the immunity system to function as suggested, in particular, by the essentiality of cas <dig>  a homolog of toxin nucleases, for the crispr-cas function  <cit> , and presence of a number of other putative toxins in the crispr-cas loci  <cit> . functional coupling between suicide and adaptive immunity can be introduced into the model by making the efficacy of adaptive immunity dependent on the suicide propensity. a simple logistic relation was chosen for this dependence paieff = aimax * pcd/. in this model kai is a parameter that determines the shape of the dependence between suicide and adaptive immunity, and aimax is the maximum possible value of pai. for small suicide propensities, the effective pai is equal to aimax * pcd/kai. if pcd ≫ kai, the effective pai tends to aimax. given that pcd only takes values smaller or equal to unity, the maximum value that paieff can take is aimax/.

functional coupling of adaptive immunity with suicide could result in the evolution of suicide under conditions where it would not normally evolve, e.g. in well-mixed populations or at high effective immunity levels. moreover, relatively weak coupling  is sufficient to observe these effects. to test whether functional coupling can explain the tight genomic co-occurrence of immunity and suicide genes, we use the logistic dependence of paieff on pcdtotal with the possibility that adaptive immunity contributes to pcdtotal, as in the previous section. here we assume logistic dependence  and allow the adaptive immunity system to mutate between variants that do or do not induce additional death . the same two cases as before, with cdmax limiting total suicide or ai-independent suicide only, were explored. simulations for different values of aimax and pii  show that an adaptive immunity system that also induces death is strongly promoted if the suicide induced by ai is not limited by cdmax. conversely, if such a limit is in place, adaptive immunity systems that do not induce suicide tend to be selected for, provided that there is some degree of ai-independent suicide.

discussion
general considerations on the modeling approach
in real biological communities, the efficacy of innate and adaptive immune systems is constrained by ecological factors such as population size, structure and diversity. the never-stopping arms race between hosts and pathogens sets a limit on the performance of defense strategies, which is determined by the ability of the host to keep the pace with pathogen escape mutations. in that regard, studies on host-parasite local adaptation suggest that parasites are usually ahead of hosts in this coevolutionary arms race  <cit> . accordingly, evolution of immune systems is modeled here under the assumption that they have a constant efficacy that is extrinsically determined by a multiplicity of factors that go beyond the control of the host. in this simple model, the evolutionary process only determines the relative abundance of hosts with and without a given type of immune systems in the population. nevertheless, even in this simple setting, the combination of different immune efficacies, population structure and long range dispersal leads to a complex interplay between different evolutionary outcomes which we aimed to explore here.

the notion of effective immune efficacies is valid under the assumption that there are two well differentiated timescales:  a relatively fast timescale for the processes of pathogen escape and host immune adaptation;  a significantly slower timescale for the evolution  of defense mechanisms. under this timescale separation, variations in immune efficacy due to the former processes can be considered transient perturbations around a time-averaged efficacy, which is the relevant value at longer evolutionary timescales. for the crispr-cas system, this assumption implies that the characteristic timescales of viral proto-spacer mutation and host spacer incorporation are substantially faster than the timescale of crisrpr-cas loci gain/loss, an assumption that seems to be borne by the available observations  <cit> . we note that, because of timescale separation, the long term evolutionary dynamics of adaptive immunity can be studied by modeling adaptive immunity as a sort of stronger “innate immunity” with a higher cost. the same approximation would not be valid, though, to study short term, fine grained coevolution of hosts and parasites. a further limitation of our model concerns the immediate resolution of the infection event towards immunity, suicide or pathogen release. while this approach is especially suitable for modeling lytic infections, it does not account for the effects of persistent infections or milder parasites. in such cases, migration and/or reproduction of infected hosts should be taken into account, as well as possible differences in timing between different defense mechanisms. indeed, theoretical studies in the former direction suggest that evolution of altruistic defense traits is hindered when infected hosts conserve some degree of reproductive ability  <cit> .

the binary nature of the adaptive immunity trait in our model captures the qualitative difference between having and not having a functional crispr-cas system. in contrast, pathogen-induced cell death  is modeled as a continuous trait such that, for a given host, the suicide propensity is the probability that a host attempts suicide when it becomes infected. successful suicide leads to the death of the host and no pathogen release. mutations affecting the suicide propensity can be interpreted as the result of variations in the copy number of toxin-antitoxins or other systems that contribute to cell death. because a genome may contain a large number of loci involved in suicide  <cit> , the relative effect of single mutations on the net suicide propensity are presumably small. by modeling programmed cell death as a quantitative trait, we capture this gradual nature of suicide evolution. simulations explore the possibility that suicide gradually evolves starting from a population with zero suicide propensity. provided that pathogens can also counter suicide mechanisms by inhibiting them or delaying their effect  <cit> , it seems appropriate to include a maximum efficacy for suicide which limits the probability of successful suicide even if the suicide propensity is equal to one.

throughout this analysis, we observed that population structure substantially affected the outcomes of pathogen-host interaction and evolution of defense mechanisms. in a structured population, hosts and pathogens are not randomly mixed in a homogeneous environment. population structure can result from purely physical constraints  or from the way individuals interact with each other . in order to account for both possibilities, the model was tested in two structured settings: a 2-dimensional grid with limited diffusion and a community network in which small groups of hosts closely interact with each other. the results were closely similar in both settings, confirming that population structure itself, regardless of its particular origin and implementation, is the cause of the observed behaviors.

evolution of different types of immunity and suicide
as shown in the preceding sections, suicide only evolves in structured populations for which long range dispersal remains under a threshold rate. why is population structure required for the evolution of suicide? as with other altruistic traits, a host does not benefit from its own suicide. instead, it provides a benefit to its neighbors by preventing the local spread of the infection. therefore, suicide can evolve only when there is phenotypic relatedness among neighbors  <cit> . in a structured population, hosts with a high suicide propensity will be likely surrounded by other suicide-prone hosts and accordingly receive indirect benefit from the suicide of their neighbors  <cit> . long-range dispersion, as well as population mixing, would bring together hosts with large and small suicide propensities. in a well-mixed population, the latter take advantage of the former so that suicide propensity becomes a disadvantage. from a game theory perspective, this dynamics defines a social dilemma where population structure allows altruistic hosts  to beat selfish ones   <cit> . high rates of long-range pathogen dispersal can also preclude the evolution of suicide if local pathogen spread becomes irrelevant compared to the constant arrival of pathogens from the outside. multiple experimental studies in bacteria have shown that population structure  is indeed essential for the evolution of cooperative traits  <cit>  and in particular altruistic suicide  <cit> . it should be noted that, although not considered in our model, horizontal gene transfer could also promote evolution of altruistic suicide by increasing phenotypic relatedness between neighboring hosts  <cit> .

the results of the present model of suicide evolution reveal an antagonism between the ‘interests’ of hosts and pathogens in structured populations whereby, while hosts tend to evolve suicide, prevention of host death is the preferred strategy for the pathogen. indeed, it has been shown that experimental evolution of phages under conditions of local dispersion leads to ‘prudent’  variants of the virus, in contrast to the virulent forms evolved in a well-mixed environment  <cit> . theoretical work also suggests that reduced virulence is the most likely evolutionary outcome under conditions of low pathogen dispersal, whereas intermediate dispersal rates can lead to high virulence  <cit> . it is therefore plausible that, in structured populations, the host-pathogen arms race has a major effect on the genes involved in cell death and its inhibition. numerous viruses indeed have evolved mechanisms preventing host cell death, often by recruiting genes involved in host suicide and turning them into competitive inhibitors of cell death  <cit>  or else via repair of the damage involved in cell death  <cit> .

adaptive immunity provides a direct benefit to the host organism that possesses the immune mechanism and thus does not require population structure to evolve. there are, however, instances when population structure favors fixation of adaptive immunity through a mechanism analogous to the one observed for altruistic suicide. due to limited pathogen dispersion, hosts can benefit from the local decrease in pathogen abundance produced by their neighbors’ adaptive immunity. in a structured population, neighboring hosts are phenotypically correlated, reinforcing the advantage of adaptive immunity and contributing to its fixation. this effect could allow fixation of adaptive immunity even under conditions where the cost-benefit balance is not in its favor. on the other hand, if the immune efficacy is too high, hosts with and without adaptive immunity tend to coexist as the former generate environments with low pathogen pressure. this result resembles those obtained by previous theoretical studies on well-mixed populations, which predict lack of fixation for highly effective immunity systems and possible polymorphisms on the degree of immunity evolved by hosts  <cit> .

joint modeling of suicide and adaptive immunity gives rise to a distribution of evolutionary outcomes  that cannot be simply explained through separate analysis of each of these defense mechanisms. for instance, high suicide efficacies prevent fixation of adaptive immunity not only in those regions where the cost-benefit balance for adaptive immunity is slightly unfavorable , but also in some regions where this balance is favorable to adaptive immunity. there seems to be a rule of thumb whereby hosts do not evolve an additional, costly defense mechanism when one such mechanism is sufficient for effective defense. the most obvious manifestation of this simple principle is that, when innate immunity is highly effective, no other defense mechanisms evolve. similarly, hosts with large suicide efficacy overtake those with adaptive immunity provided that the suicide propensity is greater than a threshold that grows with the efficacy of adaptive immunity. notwithstanding this general trend, innate and adaptive immunity systems appear to coexist in other regions of the phase space. such a coexistence is compatible with the recent explicit experimental demonstration of the synergy between r-m and crispr-cas in bacterial resistance to bacteriophages  <cit> . finally, there is a region of moderate immune and suicide efficacies where hosts take advantage of a combination of all three defense mechanisms: innate immunity, adaptive immunity, and suicide.

in an attempt to explain the tight connection between the crispr-cas systems and  toxin genes  <cit> , we explored the possible evolutionary advantage of an ai system which also induces suicide with a given probability. such a coupled system can be advantageous if  suicide itself is advantageous in those particular evolutionary conditions and  the efficacy of ai-associated suicide exceeds that of other suicide mechanisms. the same two conditions for the evolution of a coupled ai-suicide system were identified in a modified model that considers a small suicide propensity as a pre-requisite for the evolution of effective adaptive immunity .

host suicide can potentially evolve either as an immediate response to infection or as a means of last resort after immunity mechanisms fail to stop pathogen reproduction  <cit> . intuitively, the second strategy would appear advantageous, and indeed in our model, when the two strategies evolve independently and then are allowed to compete, “suicide after immunity failure wins”. however, under a non-negligible cost of suicide, the probabilities of it evolving before and after immunity is tried are comparable. it is worth mentioning that, at cost zero, the conditions for the evolution of suicide after immunity become greatly relaxed. thus, the cost of suicide appears to be a key determinant of the evolutionary regime. recent experiments with suicide-prone e. coli have shown that at least when defense against highly virulent phages is involved, the cost of suicide could be quite low because the infected bacteria are moribund in any case and have virtually no chance to propagate  <cit> . conceivably, these experiments reflect the regime with failing immunity and subsequent low-cost suicide.

implications for coevolution of prokaryotic defense mechanisms
together with innate immunity systems, cell suicide  and adaptive immunity are widespread defense mechanisms in prokaryotes although adaptive immunity is far from being universal. two interpretations, not mutually exclusive, appear plausible: the efficacies of innate and adaptive immunity systems in prokaryotes lie in the appropriate region that allows for combined evolution of suicide and adaptive immunity. this view is compatible with the fact that adaptive immunity is not universal in prokaryotes and its presence or absence seems to be related to ecological variables . such a patchy distribution suggests that the mean efficacy of adaptive immunity is close to the boundary of the fixation region, with variation among ecosystems determining whether a particular host population maintains adaptive immunity or loses it.

 different defense mechanisms are geared to fight different threats. immunity systems might be highly effective against certain threats but less proficient against others. suicide can serve as a defense mechanism that acts on those threats against which the immunity systems are less effective. this scenario accounts for the pre-requisite of the evolution of suicide revealed by the analysis of the models, namely that immune efficacy has to be low or moderate for suicide to evolve and vice versa.



under both scenarios, population structure is required for the evolution of suicide. this pre-requisite had been previously proposed on the basis of experimental studies with a genetically engineered, suicidal strain of e. coli grown on agar plates  <cit>  and is theoretically extended here to a broader spectrum of population structures, suicide efficacies and co-occurring immune mechanisms.

the presence of programmed cell death systems in the great majority of prokaryotes strongly suggests that structured populations are the rule in microbial ecosystems  <cit> . indeed, some kind of social interaction, such as biofilm formation, is found on almost every bacterial group, and more advanced forms of sociality, such as quorum sensing, are often present in proteobacteria and firmicutes  <cit> . however, the link between pcd and sociality is complicated by the fact that toxin-antitoxin and abi are addictive selfish elements, so that their abundance in bacteria and archaea is likely to be in part dictated by this property rather than by any utility to the host  <cit> .

with respect to the presence of genes encoding  toxins in most if not all crispr-cas loci, at least two, not necessarily mutually exclusive interpretations seem possible: the crispr-associated toxin genes contribute to the suicide propensity of the cell, in such a way that cells with crispr-cas-toxin systems are more effective in orchestrating suicidal responses than those with “regular” suicide systems only.

 suicide and adaptive immunity are functionally coupled, so that it is impossible to maintain an adaptive immunity system without previously developing other functionalities that involve suicide propensity. although, under our model, coupled ai-suicide systems are not a necessary evolutionary outcome arising from this requirement alone, this could be the case if “regular”, non-ai-associated suicide systems were unable to provide the cells with the functionalities required to maintain a working adaptive immunity system. this possibility appears realistic given that evidence that cas <dig> protein, a homolog of toxin nucleases, is essential for the adaptation stage of the crispr response although the nuclease activity of this protein apparently is not required. further investigation of the molecular mechanisms that are responsible for the adaptation step of the crispr-cas adaptive immunity is expected to clarify the nature of coupling between adaptive immunity and pcd.



CONCLUSIONS
evolution of suicide as a defense mechanism is only possible if  the host population is structured and  the degree of immunity that the hosts can achieve by other means is limited. the widespread nature of suicide systems in prokaryotic genomes calls for a reconsideration of the relative importance of population structure for genome evolution.

perhaps somewhat paradoxically, fixation of a costly adaptive immunity system is precluded not only when the innate immunity and suicide systems are highly effective but also when adaptive immunity itself performs at a high level. in such a case, hosts with and without adaptive immunity coexist in an environment where the pathogen is scarce .

under the present model, the evolutionary interplay of suicide, innate immunity and adaptive immunity leads to an equilibrium state where the combination of all three defense mechanisms is limited to a distinct region of the parameter space. such a region is smaller than it could be expected from studying suicide and adaptive immunity independently. this finding is consistent with the general principle that hosts do not usually evolve two costly defense mechanisms when one is sufficient.

there is, however, a range in the efficacies of suicide, innate and adaptive immunity systems that leads to combined evolution of suicide and adaptive immunity. this outcome is possible only when none of these defense systems is highly effective and requires some degree of structure in the host population. therefore, it can be predicted that certain ecological factors such as pathogen diversity and effective population sizes may indirectly promote the evolution of alternative defense systems through limiting the effectiveness of prevailing ones.

finally, coupled adaptive immunity-suicide systems can arise under two distinct scenarios: first, if the ai-associated suicide shows a better performance than other suicide systems; second, if the adaptive immunity component functionally depends on its associated suicide component and such functionality cannot be provided by independent suicide systems. further research on the molecular biology of crispr-cas systems and their associated toxin genes will be necessary in order to assess the feasibility and contribution of each of these scenarios.

the results of the present analysis most directly apply to the mechanisms of anti-pathogen defense in bacteria and archaea. however, the conclusions on the coevolution of different defense strategies suggest that the combination of immunity and/or suicide systems of multiple kinds is a general feature of evolving organisms. the patterns of co-occurrence of these mechanisms depend on ecological factors such as host and pathogen diversities and habitat structure.

abbreviations
abiabortive infection

aiadaptive immunity

iiinnate immunity

pcdprogrammed cell death

r-mrestriction-modification

tatoxin-antitoxin

competing interests

the authors declare that they have no competing interests.

authors’ contributions

ji performed research; ji, ael, yiw and evk analyzed the results; ji and evk wrote the manuscript that was edited and approved by all authors.

we thank michael galperin for helpful discussions on prokaryotic sociality. the authors are supported by intramural funds of the us department of health and human services .
