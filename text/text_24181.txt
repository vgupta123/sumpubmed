BACKGROUND
the effects of climate change and ensuring food security in a world with an increasing population is becoming ever more pertinent . the exploitation of pedigrees in plant breeding allows breeders to target specific plant crosses to maximise the potential of achieving desirable agriculturally important characteristics such as yield, drought/water tolerance and disease resistance which will be required if new varieties are to be bred to cope with increased demand in a changing environment.

the ability to predict and visualize the inheritance of alleles that facilitate resistance to pathogens or any other commercially important characteristic is crucially important to experimental plant genetics and commercial plant breeding programmes. derivation of the inheritance of such traits by traditional molecular techniques is expensive and time consuming, even with recent developments in high-throughput technologies. this is especially true in industrial settings where, due to time constraints relating to growing seasons, many thousands of plant lines may need to be screened quickly, efficiently and economically every year.

due to their complexity, there is a cognitive limitation in conceptualising large pedigree structures.

while it may not be achievable or indeed necessary to understand every mating relationship between related individuals, an overall picture can lead to insight into the data and any patterns it may contain. this can also aid in the identification of problems  within datasets when coupled with expert domain knowledge.

this is particularly important when looking at pedigree data as the context in which each line sits may hold additional and important information . it is because of this that a combination of visual and statistical analytics would allow geneticists and commercial breeders to gain a deeper understanding of the transmission of genetic elements within a pedigree based framework but there is currently a lack of suitable tools to analyse these data types.

software tools that offered improvements in the speed at which this analysis can be carried out, and increase users’ ability to conceptualise large pedigrees would bring both time and cost gains to breeding companies.

using a unique and extensive barley dataset covering pedigree, genotypic and phenotypic data for uk elite germplasm which has been through the uk national list testing procedures  <cit> , we discuss the challenges of visualizing the transmission of alleles encoding traits and characteristics of agricultural importance in a pedigree-based framework. we then describe the subsequent development of a pedigree visualization tool that was implemented in close collaboration with domain experts.

plant pedigrees
a pedigree  is a representation of how genetically discrete individuals are related  in time to one another. it is therefore a representation of the genetic relationship between individual plant lines, their parents and progeny . pedigrees are often used in human contexts to show the transmission of alleles responsible for genetic conditions of medical importance. in plants they are used as a framework along with environmental data, on which statistical analysis can be used to determine factors such as mode of inheritance . additionally, they are often used to check for potential genotyping errors, since these errors, by the very nature of mendelian inheritance, are constrained by the pedigree structure in which they exist  <cit> . the accurate representation of pedigrees is therefore becoming increasingly important in plant breeding and genetics.figure  <dig> 
traditional barley pedigree. common representation of a barley pedigree showing elite cultivars  <cit> . these representations cover only a limited number of lines, are commonly seen in humans and animals and are therefore easy to read.



while there are defined standard nomenclatures for human pedigrees  <cit>  there is no single formal system for plant pedigrees, however, there are moves towards defining standards. there are valid biological reasons for this including: the hermaphrodite nature of most plant species, the complexity of mating designs possible in plant genetics and, finally, the absence of any overseeing coordinating organisation.

while plant and animal breeding share routine breeding techniques such as standard crossing and back-crossing, pedigrees used in plant breeding display some subtle but important differences, often involving key shorthand conventions that are unique to plant mating designs leading to complex textual based records which can be difficult to read . firstly, the named entities in plant pedigrees may, but not always, represent a population of genetically identical individuals, not a single plant. while it is relatively simple to grow many plants from seed, potentially many decades after production, in humans and animals this is understandably not the norm. the generation of these genetically identical  varieties is possible through doubled haploidy, inbreeding, or crossing of pairs of inbred lines to achieve what is termed an f <dig> hybrid. successive inbreeding by self-pollination of these f <dig> generation plants leads to individual plants that are close to homozygous across all alleles. the exploitation of homozygous lines in crop species such as barley is a powerful tool in genetic analysis, removing some of the genetic complexities associated with species  where there is a high level of heterozygosity.

pedigree formats
a/b//c//d

 *c) *d

 × e] *  × c



genetic transmission
pedigree formats can be complex with no standard nomenclature; a. purdy notation system  <cit>  was put forward by purdy as a common format for representing small grain cereal pedigrees. forward slashes ‘/’ are used to delimit lines. in this case a is crossed with b which is then crossed with c whose progeny is crossed with d. b. lamacraft and finlay notation  <cit>  which was put forward as a format which could be more easily parsed by computers. the example here is the same as in the purdy notation above. c. a typical pedigree that can be found in old records where a mixture of notations are used. these mixed notation systems are common and most breeders will use shorthand that is unique to them. these records are sometimes difficult to read and would benefit from being represented in a more user friendly way.

data sets
there are a number of different data types used in this work. our primary data set is composed of a large barley pedigree data set for  <dig> uk elite cultivars as well as single nucleotide polymorphism  genotypic data for  <dig> of these lines across  <dig>  genetic markers. in addition, phenotypic data for these lines for  <dig> distinctiveness, uniformity and stability  characters  <cit>  across multiple years and sites was used . datasets covering uk wheat  and asian rice  were also used in this work although these are more limited in size. data are stored in the germinate  <dig> database system.  <cit> . the ability to connect to germinate was an important design decision as allowing users to access all background information on plant lines that we had available was important.

pedigree definitions
the nucleus of pedigree data are a series of parent/child relationships defined as encoded strings   <cit> . data was atomised into simple parent/child definitions which were used to dynamically reconstruct the pedigree. in addition there may also be information identifying whether the parent was male or female and the type of genetic cross performed. something unique in plant breeding is where a plant can be both male and female parents in the same cross.

complications may arise from either older pedigree data which is error prone and may be difficult to verify without expert guidance and from the re-use of names to describe varieties creating false relationship joins. it is not uncommon for a breeder’s favourite name to be used multiple times until a line is adequately different, and has sufficient performance to be accepted for wider distribution into the uk recommended list programme.

genotypic data
the genotypic data set for our study is based on a set of snp markers which are mapped to known chromosome positions in the barley genome. each plant line within the test set has been genotyped for a set of  <dig>  of these markers.

a given plant variety will have an allele call for each of a series of loci represented as a pair of nucleotide bases e.g. aa, gg  or ag , for a locus. due to the inbred nature of our barley germplasm there are low levels  of residual heterozygosity present.

phenotypic data
the phenotypic data in our study has been either collected in field experiments or by molecular testing. though many of the agriculturally important traits are controlled by many genes of small effect  for simplicity we concentrated on traits under simple genetic control. examples of such traits include dus characteristics which are used in the varietal registration and seed certification process and allele data on disease resistance genes such as mlo and mla.

previous work
the ability to visualise data is imperative in modern experimental plant genetics, with volumes of data being routinely produced far exceeding the ability for humans to digest and identify underlying phenomena. until now, pedigree visualization, with few exceptions  <cit>  has primarily been focussed on work carried out in the human genetics domain. because plant breeding programmes involve phenomena not normally seen in human populations, such as routine inbreeding, there are additional visualization challenges that need to be overcome. there are often large numbers of plant lines involved in any pedigree, many more so than in an average human pedigree due to factors such as generation time/time to sexual maturity which is far lower in most plant species than that of their mammalian counterparts. this section will look at the various visualization techniques used to represent pedigree based data and highlight the problems and strengths that these techniques exhibit.

table-based approaches
table-based visualization tools such as flapjack  <cit>  address some of the problems associated with visualizing large datasets and are optimized for efficient sorting and querying of genotypic and phenotypic data, but currently lack the ability to display data on a pedigree-based scaffold.

while other tools such as pedstats  <cit>  offer statistical validation of users’ pedigree data without visualization of the actual pedigree structure, it is difficult if not impossible to conceptualize pedigree structure for complex data sets without some visual representation.

matrix-based visualizations to represent pedigrees use the intersection of the x and y edge to define relationships. matrix-based visualizations have advantages over node-link or graph-centred layout approaches including the ability to create compact graph representations and the ability to remove edge overlapping. however, tests generating matrix visualizations using our pedigree data have shown that the data density is so low the resulting representations are not particularly insightful. the ability to easily track flow and identify paths is also removed.

tools such as geneaquilts  <cit> , offer a new visualization technique suitable for use with thousands of individuals but offer limited scope for addition of complex genotypic and phenotypic data and discussions with our users showed that they found it difficult to easily interpret such representations.

finally, tools such as viper  <cit>  offer novel pedigree visualization and genotypic error checking capabilities. viper is essentially a stack of nested table representations of generations where rows represent sires, dams or children and columns represent individuals which can span multiple columns where they are parents. viper’s primary use is in identification of genotyping problems in farmed animals and would be unsuitable for visualizing the complex crossing relationships that exist between crops where selfing is not uncommon. viper requires both separate male and female parents which is the norm in any applications handling animal or human data, but not always the case in plant breeding.

graph-based
unlike trees, graphs allow for the precise modelling of the complexity of a plant breeding programme. techniques such as node link diagrams have long been used as a way of representing graph-based data and recent work has examined how effective the node-link model performs representing graph data when compared to matrix-based visualizations  <cit> . work carried out by purchase  <cit>  and bennett  <cit>  also indicated that while graph layout played an important part in a user’s understanding, it was not the major focus; this focus perhaps being the use of other aesthetics relating to node colour and shape.

most of the current tools have been developed for human pedigrees where consanguineous mating events are negligible. this is not the case in plant and animal breeding which cannot be properly modelled using tools that use node-link or tree hierarchies such as pedfiddler and madeline  <cit> .

cranefoot  <cit>  reports the use of mathematical graph structures to deal with between-relative mating but the approach is limited in its current form in the amount of information that can be attached to a node. finally, haplopainter  <cit>  allows the drawing of genetic haplotypes, but suffers from being restricted in the number of individuals it is able to display.

a commonly used two-dimensional pedigree visualization tool is peditree  <cit>  which offers a tree-based view of data in a pedigree but this is not suited to our requirements as plant pedigrees are not trees . other tools such as the pedigree visualizer by wong  <cit>  offer new layout algorithms. wong suggests introducing duplicate “alias” lines in representations with multiple matings from the same individuals, phenomena that are commonplace in plant data. pypedal  <cit>  not only offers rudimentary graph drawing tools, restricted to changing node shape to represent male and females, but also error checking algorithms to try and identify potential pedigree errors where appropriate genotypic data exists.

visualization techniques such as sunbursts  <cit>  which are space filling versions of a node-link diagram have the advantage that a node’s position in a hierarchy is maintained. additionally, fan charts  <cit>  and h-trees  <cit>  have also been described as a means for recounting human genealogy; these techniques however assume no inbreeding  and thus rule themselves out for use with plant pedigrees.

while the main problems with these additional techniques are that they are not appropriate for observing a pedigree in its entirety , they may be useful when trying to visualize a sub-section of data such as a sub-pedigree for specific lines.

layout algorithms
plant pedigrees often form what we describe as a pedigree net, whereby there is structure to the graph but it’s not as simple as traditional top-down pedigree representation that is seen in humans and to a lesser extent in farmed animals .

this abstract representation does include a time component in the form of generations, but due to the viability of seed, and the existence of varieties and landraces that may be many hundreds of years old, there is the potential to use these older varieties in modern crosses. this situation leads to nodes at the top of the graph having edges connecting to nodes at the bottom - this is not common in animals and would be extremely unlikely in humans. the existence of a time component means that the use of a layout algorithm that preserves topology  is nonetheless important as most  crossing will be between newer varieties. because of this, layout methodologies such as force-directed algorithms  would not offer the ability for us to arrange our pedigree based on time. force directed layouts are not well suited to our requirements. the lack of a visually identifiable pedigree structure is strikingly apparent.figure  <dig> 
difference between plant a and animal b pedigree structure and shape. the plant pedigree in a shows what we have called a pedigree net structure and is more random in shape to a typical human or mammalian pedigree as shown in b where a typical pig pedigree shows a structured pyramidal topology. sires are coloured blue and dams red with generations running top to bottom. both diagrams were created using our initial paper-based prototype tool; see “paper-based pedigree visualization” for more information.
layout types. barley pedigree for quench which is a commonly used high yielding spring malting variety from syngenta. it is a cross between sebastian and drum. a. shows the standard sugiyama-style layered layout using dot and b. the same data using the fdp force-directed layout. both layout tools are from graphviz. the traditional pedigree top to bottom topology is lost using force-directed layout algorithms.



the problem of very large pedigrees in humans has been identified and solutions proposed in tools such as pvin  <cit>  which looks at windows on large datasets but only offers pedigree drawing with no scope for addition of other information onto the visualization. in addition, its traditional human family tree output is not the most efficient use of space for plant pedigrees which form a more dense net due to the nature of reproduction which is not seen in humans or animals 

although there are problems associated with 2d node-link layouts such as a lack of horizontal space and problems with crossing of edges  <cit>  they are still well suited to displaying data of this type. 3d tools also have their problems, including visual occlusion and that they tend to visualise high-level features and not specifics, so while some trends are easy to spot, the actual detail is hidden from the user. from this point of view they are limited in use for our purposes and offer no advantages over their 2d counterparts. notable examples of such tools are walrus  <cit>  and celestial3d  <cit>  but their success lies in alternate problem domains.

discussion
it is clear that these techniques and tools contain many features that are useful, but none meet the exact requirements  of our problem to be able to overlay genotypic and phenotypic data onto a complex pedigree structure.

there is a need for the development of tools that are tailored for the unique needs of plant breeding with the ability to explore pedigree structure, and paint additional genotypic and phenotypic data on top, to allow breeders to make informed decisions and visualize the way in which alleles for agriculturally important traits are transmitted through previous and subsequent generations. such tools do not currently exist.

through the examination of methodologies to display pedigree data we suggest that the best method to visualize plant pedigree data is a layered layout  based approach . not only does this allow us to accurately map the exact specifics of how breeding programmes run  but also provides a well-established framework onto which a visualization can be built. the use of graphs as our data structure means that features such as standard graph-traversal algorithms can be used to bring greater functionality to our pedigree structure in locating ancestors and descendants and as a logical framework which can be used to look for problems with underlying datasets. the layered layout representation also brings a coherent structure to sparse relationships and generations and topological layout are clearer compared to matrix style layouts. this is not the case with animal  and human pedigrees whose top-down fan type shape is not well suited to a layered layout as they quickly become very large, consuming large volumes of horizontal space  <cit> .

tools that allow exploration of data to try and bring a greater understanding of complex relationships between individuals should bring greater insight into how plant breeding programmes operate at the genetic level and how to bring maximum potential benefit from them. the ability to detect patterns and associations  within these datasets such as; the identification of problems with inheritance of alleles, the identification of lines from which additional information would allow inference of data on large parts of the pedigree, simple typos and errors, or looking for lines which are similar to unknown lines, will lead to increased depth of domain knowledge for plant breeders and geneticists.

methods
paper-based visualization
we wanted to test if our use of a dag based data structure and layered layout approach would work with our barley pedigree data and would be accepted by our users. in order to do this a paper-based layout was implemented, overlaying basic character data on to the graph nodes represented by colour and sizing nodes based on the number of times they had been used in crosses in our data. in this prototype  our pedigree was modelled as graph nodes to represent plant lines and edges to show mating/parentage. while graphviz has been used before in pedigree drawing  <cit> , examples focus on a small number of individuals.

while initially this prototype was run by users as a command-line computer program which generated images based on input _les and generated an image which could be viewed on their computer monitors it was decided that printing this static representation  would allow domain experts to better interact with the visualization. we overlaid, by means of colouring nodes, the winter/spring ecotype category on this dataset as  it is the most commonly used physiological means of differentiating barley varieties, and one that all of our test users were familiar with. this tool was also implemented as a web-service which allowed us to include static  pedigree representations within our internal barley information portal.figure  <dig> 
helium static prototype. users interacting with the large static prototype implementation of our pedigree visualization. in this example  <dig> and  <dig> row ecotypes are coloured green and blue respectively and varieties  are sized based on their contribution to the overall pedigree in terms of the number of lines that are derived from them. this shows which lines are most commonly used in barley breeding in the uk. the 2/ <dig> row division is one of the important characteristics used to differentiate barley worldwide.  <dig> row barley is primarily of spring type and used in brewing and distilling while  <dig> row varieties are used in feed due to decreased quality characteristics for the brewing and distilling industry. consent was obtained from both participants for publication of their images.



feedback on paper-based prototype
through observation and talking to twelve geneticists and plant breeders while they interacted with our wall-mounted visualization it was clear that there were a number of issues associated with this implementation. firstly, it was almost impossible to trace edges between nodes when the data was dense  so we found ourselves falling back on examining text based records to confirm lineage. secondly, it is incredibly challenging to quickly locate specific plant lines with this density of data. commonly used lines are immediately identifiable due to the use of size to represent the number of uses in breeding crosses but these are not always what users are most interested in. users used these larger nodes as reference points, almost as if they were notable points on a map  <cit>  and attempts at using slightly different layouts or orientations were not well received.

it was also clear that users were beginning to quickly spot pedigree problems. these problems related to the parentage of lines and in some cases the assignation of ecotype. these types of errors would be extremely difficult for a user without extensive experience to pick up on and this has not only shown that it is an effective technique for visualization but also an effective way of identifying errors with underlying datasets.

users liked this representation of large pedigrees. not only is it visually attractive, but geneticists were using it to identify problems with the underlying pedigree and phenotypic data in a way that is more interactive, social, and tactile compared to the examination of records.

when presented with our results, plant breeders told us that it gave them an overview of their data that was not currently available to them; indeed these representations uncovered interesting information relating to the relative frequency of use of particular \key” lines in the uk elite barley germplasm that would have been difficult to see from textual records in the format seen in ‘pedigree formats’ subsection, such records have not been collated like this before. missing data was also easily spotted thus allowing us to update our underlying datasets.

problems do however exist, especially in the inability to search for particular plant varieties and tracing of edges to establish lineage. in order to try and address these, it was quickly realised that we would need to move towards the development of a more interactive software tool - helium - named after the balloon type appearance of our static prototype.

the helium prototype
taking the feedback obtained from our initial informal user testing, an interactive detail and overview  <cit>  prototype pedigree visualization system using java and the yfiles library from yworks  <cit>   was implemented. this prototype maintained the same visual metaphors  to describe pedigree structure but now could add features to allow users to search and explore the data and link in plant passport, phenotype and background data from our germinate database. one of the design decisions to use germinate was that we can ensure that researchers working on our barley data will all be using the same data from the same source.

while our paper prototype included a single static image it was clear that when users were viewing our visualization on computer monitors there would be a limitation on the number of nodes that could be displayed while still retaining legibility of line names. to address this our main visualization panel  can be zoomed and panned to allow users to explore data. an overview panel was added  which would allow users to track where they were in the main visualization window and give a high-level overview of the pedigree structure. the overview would act as a common reference point for our users that would not change as the main visualization window was manipulated. feedback from our paper implementation also showed that users would want to get as much background information as possible on lines and so a detail panel was added  which displays passport and general background information. data from germinate is displayed in the detail panel and is pulled on demand based on a user’s selection in the main visualization window.figure  <dig> 
first java implementation of helium showing node sizing and colouring and basic connection to our in-house germinate barley database. users can pan and zoom around the display and perform basic searches as well as overlay simple nominal and ordinal data which is loaded from the database backend. this version of helium was used in subsequent user testing to steer the development of our more advanced system. the colouring in this figure shows predecessors  in green, the line of interest in blue and descendants  in purple. figure 5a shows the main visualization window. figure 5b shows the overview panel and figure 5c the details panel for this interface.



germinate also includes phenotypic data of both nominal and ordinal types which were colour-coded in helium using colorbrewer <dig> palettes  <cit> . hue was used to differentiate nominal data and saturation to distinguish ordinal data classes for phenotypes and genetic similarity metrics within our visualization  <cit>  .figure  <dig> 
the helium interface. our visualization tool has been split into a number of distinct areas which are shown here. our choice in using these coordinated multiple views is a common design choice in visualization interfaces  <cit> . the use of a high-level overview window  and main view  helps users maintain orientation and provides a filtering mechanism for a detailed local view . this allows easier tracing of lineage whilst maintaining greater context with the main visualization window. a) data selection and overview panel. this contains a high level overview of the entire pedigree and does not change  during a user’s interaction with the application. this is intended to be used as a reference point for large pedigrees. this panel also contains a set of tabbed panes that let a user select phenotypic or genotypic data to overlay as well as further information from our germinate database. b) the main pedigree visualization panel is where most manipulation happens. users can pan and zoom across this window. the nodes are hotspots both for selection using the mouse or by hovering additional information is displayed about both nodes and edges. c) the local view panel contains our local view of a selected line and offers tools to allow a user to define how many generations  they want to view. the local view removes much of the visual clutter associated with the main pedigree visualization and allows edges to be more easily tracked. d) the detail panel contains search functionality and overview statistics. this example shows colouring for the ordinal data type “anthocyanin colour” which is a dus character.



user testing of the helium prototype
user testing is an important aspect of the development lifecycle of visualization . both munzner and lam lay out the requirements for testing, specifically relating to visualization studies in both contemplation and reflection of user studies. a subjective evaluation was performed to establish user perception/acceptance and understanding of the visualization methods within helium. this was to establish empirically if users were happy with representing data as graphs, moving away from the traditional family-tree type methods, and whether the use of graphs fits in with a user’s perception of pedigree structure and function. could our users perform basic pedigree operations such as accurately tracking back through generations and find information they require using our visualization? we also wanted to ensure that users were able to interact well with our methods which allow much greater data density and increased plant line density.

the testing data was obtained through a questionnaire and comment-based feedback based on how intuitive our users found the main features of the prototype to be. we also asked how our tool could be improved relating to general usage or new features. this is important as while initial user-requirements were gathered, when our users actually started using our software we had expected them to come up with new ideas on features or utility that would benefit their research.

this feedback allowed us to improve our interface and visualization to help increase our users understanding of the system and underlying biological concepts.

user testing methodology
a pre-screening questionnaire, user tasks, and a follow up questionnaire centred on predefined tasks that users would be asked to perform was developed. the initial questions were to gain an overall impression of the length of experience the user has had in this field, and to classify their job title. there are two distinct groups of potential users: bioinformaticians/computational biologists and plant geneticists /breeders . user tasks were developed using our initial application requirements and were designed to force the users conducting the test to explore our experimental test datasets. the follow up questionnaire was clearly split into two sections; the first taking the form of attitude-scale questions on the user’s opinion on the software and visualization in terms of both their use of it , and follow up subjective open-ended questions to get additional information that could be used to drive development of this software tool.

the questions assume that a comparison is being made to other methods that test subjects are, or have been using to obtain the same information, and we can use these to signify if our visualization and user interface brings significant improvements in visual representation and understanding of pedigree structure. throughout the study, notes were taken and screen and audio capture was used to further examine a user’s interaction with the interface and to aid in recount of the tests.

each test was scheduled to take around 45 minutes;

 5 minutes - pre-questionnaire

 5 minutes - familiarisation

 25 minutes - test

 10 minutes - post-test questionnaire



after completion of the main interaction study our users completed an attitude scale where they indicated their preference on a  <dig> point scale between “very difficult”  to “very easy”  relating to a number of statements about their use of this software.

the questionnaire asked users to detail features or concepts that they found to be confusing, those they found to be clear, and features that they feel would add value to their research. finally users were asked to provide general comments about their use of our software; this would be used to allow us to tweak and fine-tune the helium interface to aid our users with their research.

RESULTS
general background profiling
the  <dig> expert users that undertook this study break down as follows;  <dig> bioinformaticians,  <dig> plant geneticists and breeders and  <dig> statistician. out of the users 94% were educated to phd/msc level and the average length of time working in their areas was 17 years. the minimum experience was 1 year, maximum 36 years giving a median length of experience of  <dig>  years.

while all users were familiar with pedigree data, 69% used it on a day-to-day basis as part of their research and 38% regularly used alternative tools.

it should be noted that through verbal feedback it was established that the researchers who were using pedigree data were using paper records and spreadsheets to curate and maintain pedigree data used in their work and not a specific pedigree tool.

main user interaction study
there were eight questions that users were asked to answer in using our pedigree interface. the questions were assigned an overall category and can be seen in table  <dig> where we show the question classification along with the number of correct and incorrect responses.table  <dig> 
interaction study correct answers




our user testing uncovered some interesting problems with our visualization. for example, the category “identifying children” from table  <dig> asked our participants to identify the progeny of a specific barley variety. in 44% of completed questionnaires this answer was incorrectly given. however, when examining “tracing lineage” from table  <dig> which related to this question, users thought that it was easy to trace lineage by following graph edges. our test users were continually missing the same progeny  of the line; the one whose complete edge was not immediately visible, and disappeared off the right-hand side of their computer display. when talking to a selection of users after the test had been carried out and asking them to perform the same question they did so without error .table  <dig> 
post study questions 




post-study questionnaires 
after carrying out our main interaction study the users were asked to fill in a series of questions that asked them to compare helium to pedigree tools, or methods of handling pedigree data that they are familiar with using, and to get feedback on what they found easy and difficult to understand or perform with helium. these results are presented in table  <dig> 

test results discussion
the most common responses have been detailed by dividing them into features users liked and disliked. these were obtained from feedback gained in our post-study questionnaire.

features users liked
 <dig>  layout was easy to understand and made scientific sense to users.  <dig>  it was easy to follow edges.  <dig>  searching for plant lines was simple.  <dig>  bringing together additional data sources was extremely helpful.

features users disliked or found confusing
 <dig>  sometimes difficult to differentiate colour coding.  <dig>  long edges are disorientating.  <dig>  no auto-selection of lines when performing a search.  <dig>  clearer explanations of ordinal data categories.

our test users liked the speed at which they could find data, the ease of tracing lineage through complex graphs  and the intuitive layout of our visualization and supporting application. our testing did highlight some issues, mainly around the use of colour gradients used in ordinal lists which are ineffective and difficult for our users to distinguish when there are more than eight phenotype classes.

development of helium
feedback from the user evaluation allowed us to address issues that our users had with our prototype in order to develop a more refined and useful visualization application. we needed to work to increase understanding of concepts, representations and visual metaphors that our users found difficult to understand during testing.

the main feedback gained from our initial prototype was that it was difficult to track lineage with overlapping edges and that the ability to interactively overlay, query and retrieve various data types from our internal barley database would be important. our users also had problems with identifying phenotype classes. other issues were with the complexity of the graphs and problems identifying children.

any subsequent development would need to address these points if it was going to offer a usable and effective tool for users.

the interface was re-designed to show  <dig> main areas: a) the overview panel and data selection panel, b) the main pedigree visualization panel, c) the local view panel and finally d) the details panel. these are described below.

overview and data selection panel
this panel  also includes selection mechanisms for choosing ordinal and nominal categorical phenotypic classes as well as tools for visualizing genetic similarity data . users can use the overview to navigate to a particular region within the main visualization window if required.

interactive sliders allow users, in the case of similarity data, to set a percentage similarity value and in real time highlight lines which match the search criteria . in this way it is possible to see lines which should not be closely related appearing on the peripheries of our visualization as the slider is moved, which may indicate problems with pedigree definition or genotyping. histograms have also been included, where appropriate, to show data distribution which can be an aid in the identification of problem markers. while the number of markers that have this problem is limited, it is nonetheless important to address.figure  <dig> 
helium showing genetic similarity data. genetic similarity data is stored in our germinate database  which is displayed to the user by selecting a base node then showing similarity of lines in relation to this node. when the user selects another node the new data is retrieved and displayed. a) a slider allows users to select a cut-off or the similarity values  and the results are shows in a sortable table below. the histogram shows the data distribution for the selected line which is one of many indications on the quality of the data. selecting a row from the table jumps to that line, then updates the visualization accordingly. b) coloured nodes to show similarity to the base line, and node sizing to show the number of times a line has been used in subsequent crosses . c) when a line is selected from the main display only edges joining the selected edge with predecessors or ancestors are shown which reduces display clutter.



other features included in this panel are the ability to select more than one phenotype then recolour nodes based on the merged phenotype classes. while originally it had been intended to show each phenotype as a different section on a node it was decided, through speaking to users, that they would be interested in finding exact combinations and so it was decided to go with the single node colour to reduce clutter and keep the visualization clearer. there are however problems as the number of colours that may have to be used can be around  <dig>  such a high number has been shown to be ineffectual at differentiating between classes  <cit> .

main visualization panel
the main visualization window  was modified in a number of ways from our prototype. firstly, we have moved away from bundled orthogonal edge routing  which will make the tracing of lineage easier. slightly modified colour palettes were used to account for the situation where there are more than eight categorical classes. the new colour palette will help with the problem our testing showed where adjacent classes were too similar in colour for users to accurately distinguish. in table  <dig> the incorrect responses to “identifying children” were high at  <dig> %. in order to address this visual prompts when hovering over a node were added which display the number of ingoing and outgoing edges from a node and the names of the line’s progeny . this makes the number of progeny immediately obvious, which will help prevent some of the problems seen in testing. when a user selects a node the edges connecting nodes of interest are made more prominent by both removing edges which are not associated with the selected node, its ancestors, or successor, and by darkening the edges which are left. hovering over a graph edge will show the names of the two nodes that it connects, in this way with long edges, while using the main visualization window, it is easier to track their origin and destination.

local view panel
our testing also showed that while users reported they found it easy to identify lineage there were some issues. these problems could be addressed by including a “local” implementation of our graph showing only the line of interest and its lineage . this would be shown when a user selects a node in our visualization. this view was implemented below the main visualization window. the local view can be panned and zoomed in the same way as the main visualization window. within the local view the user has control of how many generations, forwards and backwards, they want to go. this addresses the problems highlighted in table  <dig> where there were 50% and  <dig> % of users incorrectly answering the “complex grandparent tracking” and “great-grandparent tracking” questions respectively. with appropriate selection of generation level, grandparents, or indeed any other generation, are now immediately obvious in the simplified pedigree. additionally, the ability to layout the graph using a number of edge routing algorithms was added. any changes made to the main pedigree visualization are propagated to the local view. while the local view includes another copy of a portion of the main visualization, it will increase the accuracy of tracing lineage when unnecessary lines are removed and edges between nodes shortened, thus addressing the problems highlighted in testing and reducing the need to “chase edges”.

detail panel
the details panel  shows information about either the current selected phenotype or information from germinate about specific selected plant lines. this example shows the distribution of the dus character “anthocyanin colour”. the histogram has been coloured in the same way as the phenotype classes in the main visualization window.

the details panel also houses a search functionality which allows searching for lines with usual search features such as wild-card matching and an option which we have called the “follow me” mode which jumps to a search hit, selects it and subsequently updates the detail panel and main visualization window.

during discussions with users it was also apparent that the ability to export line names would be a useful feature to allow scientists to make up lists for sending samples off for genotyping based on phenotypic or genotypic characteristics so the ability to allow users to export lists has been implemented. users can select nodes then add them to an export list which can be saved to a text file.

finally, a user history panel has been included which records the lines and phenotypes that have been selected over a session so that if required, users can go back and see what they had been doing previously. this is important as with large quantities of data it is easy for users to forget what they have been doing over time.

examples of the layout and features offered by helium can be seen in additional file  <dig> 

discussion
an interesting outcome of the development of helium is trying to quantify if this tool actually make a user's decision making better and does the software influence users into making more informed decisions about their data. one of the outcomes from our testing was to assure ourselves that the decisions that had been made around the design of the tool were actually good foundations that our target users can build knowledge on and to that end we seem to have made an impact. while we have used standard approaches to the visualization tool we have developed we have applied it directly to a specific domain, and tailored our application appropriately.

while users requested as much information as possible in the interface we need to be careful that we only include necessary information and do not turn helium into a tool that presents so much unnecessary information to users it in itself becomes unusable or difficult to comprehend; we need to avoid a situation where we overload users with information. while this may seem like a problem that scientists would love to have it could have detrimental effects; do we need to actually present raw data or are overviews enough? would a user’s understanding be affected by what we present them with?

users have told us that the overlaying of data onto the pedigree structure has in some ways more impact than showing the division of data in a bar chart or as a table. having areas of colour in your face brings insight both into the location of clusters of similar data and visual impact of nodes changing from one colour to another, it brings the representation of data to life and in logical an understandable ways.

examples of the sorts of things that users wanted to be able to do with our tool include a) given genotype data for a line identify possible matches and b) basic error checking based on genotypic or phenotypic data. these are detailed below.

given genotype data for a line identify possible matches
helium will take a string of genotypic data and identify possible matches from data held in our germinate database then display the possible hits on the pedigree display. this is useful as it is not uncommon for errors to be introduced through mislabelling or handling errors in the lab when genetic material is sent for genotyping. using the pedigree framework may give users other ways of trying to identify what unknown or problem lines are, or they may point geneticists and breeders in the right direction as to their source, if for example two similar lines are mislabelled we may be able to deduce the correct naming through examination of pedigree records. further investigation would be required to correctly identify the correct source of this germplasm as there is a possibility either it, or the genotyping is wrong. these types of error are not uncommon.

basic error checking based on genotypic or phenotypic data
we can use the interface to look for potential errors with a given line. we know that the alleles of a line must be from either parent, so we can use this in basic error checking. for example, if two lines have been genotyped for allele a at given locus but the progeny has allele b then we know there is a problem. additionally, we can expand this type of search to look at multiple loci within a dataset. taking this a step further we can use genotypic data to highlight potential parents of a line and if one parent is known, make a guess at possible candidates for the second parent.

CONCLUSIONS
we have shown through the development of helium that visualization of our example pedigrees along with genotypic and phenotypic data provides users with new insights into crop breeding.

the representation of our unique barley test dataset shows that the pedigree structure takes the form of what we have coined a pedigree net. our visualization has shown that there are three main classes of plant lines seen when viewed in helium which we have named; a) principal lines which are commonly used to generate new cultivars due to their possession of desirable characteristics b) flanking cultivars brought in to increase the genetic diversity of subsequent lines and less commonly used in crosses and finally c) terminal varieties that are released, but have had little subsequent use.

one of the more hard-hitting measures of success of our first paper-based prototype came from the presentation of data to a meeting of uk plant breeders. while the pedigree data that we demonstrated was available to all in the room as written records, , the representation that we showed  had a major impact through the provision of new insights as to how germplasm was very closely related. when written as a text string it is difficult to construct the bigger picture, but when displayed in our tool, the relationships between competing breeders lines was much more striking. while this was privately known to the individual breeders, having it presented to them when they were all in the same room was very enlightening. this not only highlights the value of visualization but that we have implemented a visualization tool with real-world impact.figure  <dig> 
pedigree visualization static prototype. this was one of our first attempts at visualizing our entire barley pedigree. the colours of nodes were used to distinguish between the winter/spring ecotype  and node size to show the number of times the line has been used in crosses that have given rise to progeny that have been successful in national list trialling in the uk - quantitative data type. to the best of our knowledge this is the first time that a pedigree involving this number of commercially released lines has been brought together in one place and sparked interest with commercial plant breeders when they were presented with it.



while helium has been tailored to specific data types  it is intended to be a framework on to which, over time, additional data types can be added and we are working with worldwide plant scientists and breeders to develop the helium platform further.

for more information on helium please visit our website http://ics.hutton.ac.uk/helium.

electronic supplementary material
additional file 1:
helium features movie. this movie shows the main layout and features of the helium system along with basic interface interaction. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

pds wrote this paper, developed the pedigree visualizations and database infrastructure, and designed and conducted the user study. im gave advice on programming. mg, jk and dfm contributed towards the writing and editing of the manuscript and provided constant advice over the course of this work. all authors read and approved the final manuscript.

