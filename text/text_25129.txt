BACKGROUND
reliable segmentation of cell nuclei from three dimensional  microscopic images is an important task in many biological studies as it is required for any subsequent comparison or classification of the nuclei. for example, zebrafish somitogenesis is governed by a clock that generates oscillations in gene expression within the presomitic mesoderm  <cit> . the subcellular localization of oscillating mrna in each nucleus, imaged through multi-channel microscopy, can be used to identify different phases within the oscillation. to automate the classification of the phase of an individual nucleus, each nucleus within the presomitic mesoderm first needs to be accurately segmented.

in recent years, there has been significant effort towards the development of automated methods for 3d cell or cell nuclei image segmentation  <cit> . thresholding, watershed and active surface based methods are among the most commonly used techniques for 3d cell or cell nuclei segmentation. unfortunately, thresholding-based methods often have difficulties in dealing with images that do not have a well-defined constant contrast between the objects and the background. given this characteristic of the thresholding-based methods, they often have difficulties in segmenting images with clustered or juxtaposed nuclei. watershed-based methods are also very popular for segmentation of clustered cell nuclei  <cit> . however, these methods often result in the over-segmentation of clustered cell nuclei. in order to deal with this issue, heuristic rules have been developed for region merging  <cit>  as a post-processing step. segmentation problems have also been targeted through the use of active surface-based methods  <cit>  in the literature. however, such algorithms suffer from an inherent dependency on the initial guess. if the initial guess is wrong, these methods have difficulties in dealing with clustered cell nuclei.

despite active research and progress in the literature, development of a fully automated and robust computational algorithm for 3d cell nuclei segmentation still remains a challenge when dealing with significant inherent nuclei shape and size variations in image data. examples include cases where the contrast between nuclei and background is low, where there are differences in shapes and sizes of nuclei, and where we are dealing with 3d images of low quality  <cit> . complications also arise when nuclei are juxtaposed or connected to one another, increasing the rate of over-segmentation or under-segmentation.

in this paper, we present a novel automated method that aims to tackle the aforementioned challenges of segmentation of clustered or connected 3d cell nuclei. we approach the segmentation problem by first generating the gradient vector field corresponding to the 3d volume image, and then diffusing the gradient vector field with an elastic deformable transform. after the elastic deformable transform is completed, the noisy gradient vector field is smoothed and the gradient vectors with large magnitude are propagated to the areas with weak gradient vectors. this gradient diffusion procedure results in a gradient flow field, in which the gradient vectors are smoothly flowing towards or outwards from the centers of the nuclei. subsequently, a gradient flow tracking procedure is performed from each vector point to find the corresponding center to which the points flow. we group all points that flow to the same center into a region, and refer to this region as the attraction basin of the center. once we have completed the process of tracking the gradient flow, the boundaries of juxtaposed nuclei are formed naturally and hence these juxtaposed nuclei are divided. the final step includes performing local thresholding in each attraction basin in order to extract the nuclei from their corresponding background. we have evaluated and validated this algorithm and have presented results attesting its validity.

RESULTS
in this section, a series of experiments are designed to evaluate and validate the gradient flow tracking method for segmentation of 3d images with juxtaposed nuclei. both qualitative and quantitative results on synthesized and original 3d images are provided to demonstrate the performance and general applicability of the proposed method.

validation using synthesized 3d image
we present an example of the results obtained from applying our proposed nuclei segmentation method on a synthesized image. despite the fact that objects are touching each other and the presence of additive noise, the proposed segmentation method has segmented the touching objects perfectly, as shown in figure  <dig> 

we employ volume overlap measurement methods in order to quantitatively validate our segmentation results. since there is no ground truth information available for real data and it is very time consuming to manually segment juxtaposed nuclei, instead of using real data, we take advantage of synthesized 3d images. the volume overlap between the automated results and the ground truth is defined as:

 o=s+s)/ <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgpbwtcqggoaakcqwgsbgudawgaawcbagaemyyaegabeaakiabcycasiabdkfasnaabaaaleaacqwgnbwzaeqaaogaeiykakiaeyypa0zaasaaaeaacqwgtbwucqggoaakcqwgsbgudawgaawcbagaemyyaegabeaakiablmiijjabdkfasnaabaaaleaacqwgnbwzaeqaaogaeiykakcabagaeiikagiaem4uamlaeiikagiaemouai1aasbaasqaaiabdggahbqabagccqggpaqkcqghrawkcqwgtbwucqggoaakcqwgsbgudawgaawcbagaem4zacgabeaakiabcmcapiabcmcapiabc+caviabikdayaaacqggsaalaaa@50c7@ 

where ra is the automated extracted region and rg is the ground truth region. the â‹‚ operator takes the intersection of two regions. s is the volume of the region.

the synthesized 3d touching cell nuclei image is generated as follows: 1) randomly select a voxel as seed point, and construct a mask of a sphere with a radius  <dig> mm centered at that point. 2) generate  <dig> masks of spheres, which are tangent to the central sphere, with their corresponding radii ranging from  <dig> mm to  <dig> mm. this is done to simulate the variations between radii of real nuclei. 3) blur the mask images by convolving with a 3d gaussian kernel, and corrupting it with additive gaussian noise. for the convenience of visual inspection of the segmentation results, we provide the volume rendering of the original 3d image and surface rendering of the segmentation results. figure 6a shows the synthesized 3d cell nuclei image, in which the six nuclei are closely touching the central nucleus. the segmentation results with the proposed method are illustrated in figure 6b. figure 6c shows the segmenation results obtained by global otsu thresholding method. as we can see, the touching objects are not divided correctly in figure 6c.

we have synthesized seven 3d nuclei images. in order to present a quantitative measure for the validation of our results, the average value of volume overlap measurement for the seven cases is around  <dig> , and the standard deviation is  <dig> . as it is clear from these results, our proposed segmentation method achieves significant volume overlap with the ground truth, indicating the accurate performance of the gradient flow tracking method.

validation using 3d c. elegans embryo images
in order to further quantitatively evaluate the segmentation method, we applied the method to c. elegans embryo images. dr. sean megason of california institute of technology provided us the c. elegans embryo images. the nuclei are labelled with histone-egfp. the scope used for the c. elegans image set is a zeiss lsm <dig> with a 40x c-apochromat objective and a  <dig> nm laser. the original voxel size is  <dig> * <dig> * <dig>  micron in x, y and z directions. in our experiment, the voxel size is re-sampled to isotropic in all directions. the details of the experimental and imaging settings are provided at . two metrics of over-segmentation and under-segmentation were utilized for evaluation of the segmentation method. the over-segmentation metric indicates that a nucleus has been separated into more than one object, or an extracted object has not been labeled as nucleus. this is done in comparison to visual inspection of an expert. the under-segmentation indicates that clusters of nuclei have not been appropriately divided or a nucleus marked by visual inspection was not at all extracted. four 3d images of c. elegans embryos were used to evaluate the proposed segmentation method based on the above two metrics. table  <dig> shows the performance of the proposed segmentation method. on average, the over-segmentation and under-segmentation rates are  <dig> % and  <dig> % respectively, indicating a desirable performance by our segmentation method. the errors are probably caused by the interpolation and re-sampling and inherent noise in the images. for the convenience of visual inspection of the segmentation results, we provide the volume rendering of the original 3d image and surface rendering of the segmentation results. as an example, figure 7a provides the volume rendering of the original juxtaposed 3d nuclei. the segmentation results represented by surface boundaries are shown in figure 7b. to validate the segmentation results, two experts manually segmented the nuclei respectively, and then we computed the volume overlap between the automated result and that of each of the two experts. we also calculated the volume overlap between the two experts. the mean value of volume overlap is over 95% for both expert  <dig> and expert  <dig>  and the standard deviation is around  <dig>  for both experts, indicating that the automated 3d cell nuclei segmentation results are comparable to manual segmentation results.

validation using 3d zebrafish nuclei images
to further evaluate the proposed segmentation method, we have applied the method to ten 3d zebrafish images in which nuclei are labeled. the 3d zebrafish image datasets are from the holley lab at yale university. these are fluorescent confocal images of fixed  <dig> somite stage zebrafish embryos stained with propidium iodide. all images were collected on a biorad  <dig> confocal microscope using a 25x zeiss neofluor objective. for the convenience of visual inspection of the segmentation results, we provide the volume rendering of the original 3d image and surface rendering of the segmentation results. an example of the original 3d image and nuclei segmentation results are shown in figure  <dig>  in which it is evident that most of the nuclei are segmented correctly, in spite of the fact that many of the nuclei are touching and have irregular shapes. figure  <dig> shows a 2d slice of the original image and the segmentation result as shown in figure  <dig>  the two metrics of over-segmentation and under-segmentation are used to evaluate the segmentation result. table  <dig> provides the details of the performance of the segmentation method. on average, there exist  <dig> cell nuclei for each image, and the over-segmentation and under-segmentation rates are  <dig> % and  <dig> % respectively. furthermore, the average volume overlap is over 90% for both expert  <dig> and expert  <dig>  and the standard deviation is less than  <dig>  for both experts, indicating a desirable performance by our segmentation method

discussion
our method has several advantages over previous approaches. the major advantage of the method is the ability to robustly segment densely packed, touching, or connected nuclei. additionally, no sophisticated rules are used. the only assumption is that the centers of nuclei are brighter or darker than a nearby region. the fundamental difference between our method and existing methods lies in the diffused gradient vector information. in existing methods such as the threshold or watershed methods, intensity is the only adopted information, hence those methods are sensitive to the noise in the image, which usually results in over-segmentation. in contrast, in our method the gradient vector diffusion procedure propagates gradient vectors with large magnitudes to the areas with weak gradient vectors and smoothes the noisy gradient vector field. meanwhile, it preserves the potential structural information of the gradient vector field. for example when two nuclei are touching each other, the diffused gradient vectors point toward the corresponding centers of the nuclei. this step greatly contributes to the success of touching nuclei segmentation. the disadvantage of this method is that it may have difficulty in processing the images of textured blob objects, since in that situation the gradient vector at the centers of nuclei are cluttered and the condition is violated. currently the method is implemented using the c/c++ language, without using any other common library. without any optimization, it takes less than  <dig> seconds on an intel pentium <dig>  <dig>  ghz machine with  <dig> gb memory to segment a volume image with a size of 230*162* <dig>  the running time can be reduced further with multi-resolution implementation and code optimisation. after evaluating this method on larger and more diverse image datasets, we intend to release the algorithm to the cell biology community.

CONCLUSIONS
we presented a novel, automated algorithm for 3d cell nuclei segmentation based on gradient flow tracking. to validate the efficacy and performance of the proposed segmentation algorithm, we evaluated it by using synthesized and real biological images. the results show that the algorithm is able to segment juxtaposed nuclei correctly, a persistent problem in the field of cellular image analysis.

