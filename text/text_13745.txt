BACKGROUND
understanding the processes that shape geographical and ecological distribution of biodiversity is one of the most challenging questions in evolutionary biology and ecology. this is particularly true for regions that have experienced rapid habitat changes and harbor high species diversity. these characteristics are present in many mountainous areas and historical orogenesis has been proposed to play an important role in shaping their current biodiversity . the alteration of topography and climatic changes associated with mountain uplifts can cause fragmentation of species distributions, thus limiting gene flow between isolated populations and initiating allopatric divergence and speciation . however, extreme environmental changes and fragmented distributions can also lead to the extinction of lineages and species . the processes occurring during mountain uplifts are therefore complex and we need to better understand the mechanisms that are at play during these events.

the fragmentation of species distributions can be due to the presence of limits on dispersal due, for example, to geographical barriers. such limitations can induce a reduction in the movement of individuals into new locations and will result in distinct biogeographic patterns in the extant species  <cit> . however, fragmentation can also occur because of a lower success of establishment of individuals in some areas, which will limit the range of species  <cit> . this process is primarily set by ecological factors, potentially including both abiotic and biotic variables . the dynamics of species range evolution will be constrained by phylogenetic niche conservatism, which is defined as the tendency of species to retain their ancestral ecological niche, thus shaping the geographic ranges of species over time . however, evidence for rapid shifts in climatic preferences among species also exists  <cit>  and macro-evolutionary modeling should be used to characterize the processes driving the evolution of ecological niches  <cit> . a complete assessment of these processes, coupled with detailed analyses of biogeographic patterns of species distribution, should then be used to help understand the distribution of species diversity  <cit> .

one region that experienced drastic habitat changes and harbors extremely rich species diversity and endemism is the qinghai-tibet plateau . while the start of its uplift dates from approximately  <dig> million years ago , the extensive uplifts of the qtp occurred in at least four periods since the early miocene, specifically between 25–17 ma, 15–13 ma, 8–7 ma, and  <dig> - <dig>  ma . at present, the qtp, with an average altitude of more than 4000 m , is the highest and one of the most extensive plateaus on earth  <cit> . about  <dig> – <dig>  species of vascular plants in ca.  <dig>  genera are present in this plateau, and at least 20 % of these species and ca.  <dig> genera are endemic  <cit> . the historical sequence of uplifts of the qtp has been suggested to partly account for the occurrence of high levels of biodiversity and endemism in the region  <cit> . however, the potential effects of climatic changes during the quaternary on the diversification and distribution of many groups of plant species in the qtp are not very well known .

primula l.  is one of the genera that exhibit high levels of species diversity in the qtp. the group, with a predominantly northern hemisphere distribution, contains ca.  <dig> species. about 60 % of the species are present in the qtp and its adjacent regions  <cit> . although this genus represents an important floristic element of alpine meadows in the region, it remains unclear whether the uplift of the qtp and the following climatic changes affected its diversification and distribution. in this context, a better understanding of the historical biogeography of key floristic elements of the region is an important way to illuminate the evolutionary history of these organisms in space and time. available studies mainly utilize genus- or family-level phylogenies to elucidate the biogeographic connections between the qtp and neighboring regions . however, the presence of a single sample per species hardly provides insights into the biogeographic patterns of species distributions within the qtp. therefore, sampling multiple individuals per species and focusing on endemic species may help to better understand the mechanisms that were responsible for biogeographic patterns within the qtp.

in this study, we include several samples per species to investigate the historical biogeography of primula sect. armerina lindley , which exhibits a typical sino-himalayas distribution. according to the most recent global monographic treatment of the genus, primula sect. armerina comprises  <dig> species  <cit> . eight species  are endemic to the qtp, with different geographic distributions  <cit> . among them, there has been some confusion between p. tibetica and p. fasciculata because of their morphological similarities at high altitude . the two species can be easily distinguished when bracts are present. primula tibetica has oblong and pouched bracts, while the bracts of p. fasciculata are linear and non-pouched . however, at high altitude, bracts are usually missing in p. fasciculata , while in p. tibetica, they can also be absent in small individuals with single flower . both species have wide altitude distributions, ranging from 2900 m to 5000 m  <cit>  and the use of molecular data combined with macro-evolutionary modeling may provide useful insights into the dynamics of their range evolution. the four remaining species of this section  have very restricted areas in regions adjacent to the qtp. primula nutans has the most widespread distribution in the section, including n europe, w & e siberia, nw america to n mongolia, nw china and nw qtp. all species from sect. armerina are considered to be diploid   <cit> , except p. egaliksensis, which is the only tetraploid species  and occurs mainly in north america. it was assigned to sect. armerina based on morphological features  <cit> , and might be of hybrid origin between p. mistassinica  and p. nutans .fig.  <dig> the five species of sect. armerina which showed mainly incongruence between the two trees.  p. fasciculata with linear and non-pouched bracts,  p. fasciculata without bracts,  one photo of p. fasciculata collected from populations of clade f <dig> ,  p. tibetica with oblong and pouched bracts at low altitude,  and  p. tibetica with and without bracts at high altitude, respectively,  p. nutans,  p. gemmifera,  p. conspersa. bracts for p. fasciculata and p. tibetica are indicated by red arrows. all photos were taken by the first author in the field



most species of the armerina section are thus prominent floristic elements of alpine meadows at high altitudes in the qtp and most are endemic to the qtp and its adjacent regions  <cit> . this section of primula hence represents a good candidate to assess the biogeographic history of the qtp and to understand the effects of its uplift and associated climatic changes on the geographical distribution of biodiversity. we analyzed both nuclear and chloroplast dna sequences of multiple samples per species in the armerina section to reconstruct a comprehensive phylogenetic tree of this group. the aims of our study are to: i) test the inter-specific relationships of sect. armerina to obtain a detailed and resolved phylogenetic tree for the section; ii) assess whether the diversification of this section was influenced by the uplifts of the qtp; iii) combine biogeographic analyses with macro-evolutionary modeling of ecological niches to better understand the role of dispersal and ecological constraints during the diversification of the three main species in the section .

RESULTS
sequence characteristics
five chloroplast  and one nuclear  markers were sequenced in this study for phylogenetic analyses. the matk dataset comprised  <dig> characters,  <dig> of which were constant,  <dig> variable but parsimony-uninformative,  <dig> variable and parsimony-informative. the rpl <dig> dataset comprised  <dig> characters,  <dig> of which were constant,  <dig> variable but parsimony-uninformative,  <dig> variable and parsimony-informative. the rps <dig> dataset comprised  <dig> characters,  <dig> of which were constant,  <dig> variable but parsimony-uninformative,  <dig> variable and parsimony-informative. the trnlf dataset comprised  <dig> characters,  <dig> of which were constant,  <dig> variable but parsimony-uninformative,  <dig> variable and parsimony-informative. the trnh-psba dataset comprised  <dig> characters,  <dig> of which were constant,  <dig> variable but parsimony-uninformative,  <dig> variable and parsimony-informative. we combined the five plastid regions for all subsequent analyses, modeling them as five partitions. it was not possible to obtain these sequences for p. watsonii and four chloroplast sequences  were downloaded from genbank for this species.

the aligned nuclear dataset comprised  <dig> characters,  <dig> of which were constant,  <dig> variable but parsimony-uninformative, and  <dig> variable and parsimony-informative. despite repeated attempts, the tfp sequences for three samples of p. tibetica, as well as the sample of p. pamirica, p. pumilio and two outgroup species  failed to amplify. two copies were identified in the samples of p. fasciculata, p. conspersa and p. egaliksensis and these clones were added to the sequences obtained directly from pcr in subsequent phylogenetic analyses.

phylogenetic analyses and molecular dating
the maximum likelihood  and bayesian analyses done on each data set resulted in congruent topologies, but discrepancies were obtained between the two types of markers. the only tetraploid species, p. egaliksensis, was included in a well-supported clade with p. mistassinica and p. farinosa in the chloroplast tree. this result is in agreement with previous studies  <cit> . the node subtending the rest of the samples of primula sect. armerina received very low support  in the choloroplast phylogenetic tree and the relationships between species remained partly unresolved . three main clades were inferred in the chloroplast tree. the clade involucrata  and the clade conspersa  were strongly supported in both ml and bayesian analyses, while the clade pumilio  was not well-supported by ml , but received very high posterior probabilities in the bayesian analyses . overall, well-supported clades  in the chloroplast tree grouped sequences from the same species, except for p. fasciculata, which was separated into two groups .fig.  <dig> the maximum clade credibility  tree derived from beast analyses of five chloroplast genes. maximum likelihood  bootstrap values and bayesian posterior probabilities  are indicated at major nodes. bootstrap values ≥  <dig> and pp ≥  <dig>  are indicated with thicker branches. outgroup species are shown in bold



in contrast to the plastid dataset, primula sect. armerina and two nested outgroup species received very high node support  in the nrdna phylogenetic tree, but the relationships between species were less well supported . three main clades within the section identified in the chloroplast tree were also inferred in the nuclear tree . the clade involucrata was well-supported , while the clades conspersa  and pumilio received very weak nodal support in both types of analyses. the relationships within each clade were further incongruent between the trees obtained by the two datasets. primula fasciculata was divided into three clades in the nrdna tree . one clade included samples from p. fasciculata that cluster with a moderately supported clade representing p. involucrata. a second clade included all samples of p. tibetica and p. fasciculata and one copy of p. fasciculata. finally, the third clade included all samples of p. nutans and p. pamirica, one copy of p. egaliksensis and the remaining samples of p. fasciculata . similarly, p. gemmifera separated into two groups, either with p. zambalensis or in a clade including all samples of p. conspersa . two copies of p. egaliksensis were clustered with either p. nutans or p. mistassinica, corroborating the hypothesis of the allopolyploid origin of this species .fig.  <dig> the maximum clade credibility  tree derived from mrbayes analyses of the nuclear dataset. maximum likelihood  bootstrap values and bayesian posterior probabilities  are indicated at major nodes. bootstrap values ≥  <dig> and pp ≥  <dig>  are indicated with thicker branches. outgroup species are shown in bold. two nuclear gene copies for some samples are indicated with “-1” or “-2”



previous dating analyses at the level of the family used low intra-sectional sampling and suggested that sect. armerina diverged from its relatives about 5 ma  <cit> . this date is generally congruent with the results of our dating analysis, which indicated that the section  diverged from its two relatives, p. watsonii and p. pinnatifida,  <dig>  ma . most cladogenetic events in this section occurred during the past  <dig>  million years . the crown age of the three closely related species, p. nutans, p. fasciculata and p. tibetica, was about  <dig>  ma .fig.  <dig> dispersal–vicariance scenarios for sect. armerina and the outgroup speices based on the chloroplast dataset reconstructed by statistical dispersal–vicariance analysis  optimization with the maximum number of area units set to two. triangle: dispersal event; diamond: vicariance event. letters denoting area units are indicated on the map. pie charts at internal nodes represent the marginal probabilities for each alternative ancestral area. alternative ancestral areas  are indicated for the major nodes. the grey bars on the nodes represent the 95 % highest posterior density intervals of the dates obtained from beast analyses. time scale is shown at the bottom. three groups  are used for the evolutionary niche models: groups f <dig> and f <dig> are two clades of p. fasciculata in the chloroplast tree; group nt includes all samples of p. tibetica and samples of p. nutans that were only collected from the qtp



biogeographic inference
biogeographic analysis based on the chloroplast dataset was reconstructed by statistical dispersal–vicariance analysis . fourteen dispersal and  <dig> vicariance events for the section were identified in this analysis . the origin of this section was inferred with high confidence in the himalayan mountains . we found that one clade  colonized the northeast qtp  and subsequently diversified and dispersed to the hengduan mountains , while p. pamirica colonized the mountains of central asia . the common ancestral area of p. fasciculata, p. tibetica and p. nutans was inferred to be in the himalayan mountains .

evolution of ecological preferences
we fitted a series of macro-evolutionary models based on  <dig> bioclimatic variables  to better understand the biogeographic patterns of three closely related species, p. fasciculata, p. tibetica and p. nutans. we extracted the  <dig> bioclimatic variables from the sampled localities of the three species . for p. nutans, we used only the samples that were collected in the qtp. the first two axes of the principal component  analysis based on this dataset explained  <dig>  % and  <dig>  % of variance, respectively. the first axis  was strongly and positively correlated with temperature seasonality  and negatively correlated with temperature in coldest and driest quarter . the second axis  was correlated strongly and positively with precipitation in coldest and driest quarter , and strongly and negatively with precipitation seasonality and mean diurnal range .

we used the values obtained for pc <dig> and pc <dig>  to test for the evolution of the ecological niche in p. fasciculata, p. tibetica and p. nutans. the brownian motion model was rejected for both pc <dig> and pc <dig> in all species sets tested . for pc <dig>  the best-performing models were ou <dig> for set <dig>  set <dig> and set <dig>  and oumv for set <dig>  average aicc weights were  <dig> ,  <dig> ,  <dig>  and  <dig> , respectively . the oum was the second-best model for set <dig> . the oumv, ouma and oum models that allow different niche optima for set <dig> also received non-negligible aicc weights . for pc <dig>  all four sets were best modeled under oumv .

the parameters  estimated for the three species groups  from all supported models based on the four group sets were congruent  and we showed the parameters estimated based on set <dig> . we used model averaging to estimate the parameter values for pc <dig> over the supported models oumv, ouma and oum. the averaged niche optima  across models for group f <dig>  f <dig> and nt were − <dig> , − <dig>  and  <dig> , respectively . the averaged rate parameter  across models for group f <dig> was two times slower than that for the groups f <dig> and nt . finally, the averaged strength of selection estimated across models for the three groups was similar . for pc <dig>  model oumv, which allows for different niche optima and rates of niche evolution among groups, was the only supported model. the optimum values estimated based on this model for the three groups were also different from each other . the group f <dig> still exhibited the slowest rate of niche evolution .fig.  <dig> parameter estimates of models of niche evolution for the three groups . for pc <dig>  averaged parameters are obtained based on three supported models . the averaged strength of selection  estimated across models for the three groups is similar and not shown. for pc <dig>  parameter estimates are from the only supported oumv model 



discussion
non-monophyly of primula sect. armerina
the phylogenetic analyses of primula sect. armerina presented here contain samples of several individuals per species and cover most of the geographic distributions of the species. neither the chloroplast tree nor the nuclear tree supports the monophyly of sect. armerina. the section and the two outgroup species, p. watsonii and p. pinnatifida  form a well-supported clade in the chloroplast tree, despite the fact that these two outgroup species are distinguished from sect. armerina by clear morphological traits . similarly, the two outgroup species, p. farinosa and p. mistassinica , are grouped with the section and form a well-supported clade in the nrdna tree. the non-monophyly of sect. armerina is in agreement with previous family-wide analyses  <cit> . moreover, non-monophyly of sections in genus primula seems pervasive in phylogenetic trees  <cit> .

phylogenetic relationships within the section
the relationships among some of the basal nodes of the section in the nuclear tree are uncertain , which may result from low sequence divergence within the section. the use of a single nuclear gene is thus clearly not sufficient to resolve the relationships within the group, which is a pattern often found also in other lineages . multiple nuclear genes or genomic data are therefore needed to resolve the precise relationships between the main clades in this group. however, both phylogenetic trees show three main clades within sect. armerina, which is in agreement with previous phylogenetic studies  <cit>  as well as morphological based taxonomy  <cit> .

phylogenetic relationships inferred from the nuclear and chloroplast datasets were incongruent . the tree obtained from the latter is in agreement with morphology-based taxonomy, which contrasts with other studies that showed a better congruence of taxonomy with the trees inferred from nuclear datasets . incongruence between different plant genomic markers is found in numerous studies and can be explained by incomplete lineage sorting, hybridization and introgression . introgression represents the transfer of genes between species mediated primarily by backcrossing  <cit> , but it does not seem a likely explanation for the incongruence that we observed. maternally inherited chloroplast loci with relatively low rates of intraspecific gene flow should be more frequently introgressed  <cit> . in contrast, biparentally inherited nuclear loci that experience high rates of intraspecific gene flow should enhance species delimitation  <cit> . we find the opposite pattern in our results . the chloroplast tree has much clearer species delimitation than the nuclear tree and this pattern seems incompatible with the assumption that the incongruence results from introgression.

although introgression cannot occur without hybridization, hybridization followed by no backcrossing and introgression could still occur and such phenomenon has been detected in numerous studies . natural hybridization in primula is common and has been confirmed by several studies , although, it is currently unclear to what degree species within sect. armerina hybridize with each other. the incongruent placement of p. egaliksensis between chloroplast and nuclear gene trees can be explained by hybridization . moreover, our results provide further evidence in support of the hypothesis that p. egaliksensis originated from an intersectional allopolyploidization event, which places the two tfp copies of p. egaliksensis with either p. nutans or p. mistassinica , confirming previous results by guggisberg et al. . from this perspective, similar incongruence detected for sample number  <dig> of p. fasciculata  may also result from hybridization. beside hybridization, incomplete lineage sorting is another important explanation for the incongruence between data sets, but the two processes are often difficult to distinguish from each other . although incomplete lineage sorting could also be involved in the incongruences found in our results, the occurrence of such a process would imply that the origin of the haplotypes of p. pamirica preceded the speciation events of the whole clade  <cit> . such extensive levels of incomplete lineage sorting may yield gene trees with random patterns of relationships among taxa  <cit> . the patterns of relationships are, however, non-random in the nuclear tree. the major incongruences result mainly from the division of p. fasciculata and p. gemmifera in different lineages. we thus consider hybridization as the most likely explanation for the major incongruences between chloroplast and nuclear trees.

however, it should be noted that using a single nuclear gene that provides low resolution of the phylogenetic relationships might not be sufficient to elucidate the reasons of the genealogical incongruences between different genomic markers. although our results tend to suggest a more probable role of hybridization as the most likely explanation for the major incongruence between two trees, incomplete lineage sorting and introgression cannot be completely excluded. we therefore recognize that gene trees/species trees analyses involving multiple nuclear loci or population genomic approaches would be necessary to clearly discriminate among these possible scenarios.

biogeographic history
the biogeographic reconstruction based on the chloroplast dataset showed that sect. armerina originated in the himalayas and subsequently dispersed to the hengduan mountains, northeastern qtp and western qtp . the lineages involved in these dispersal events further diversified in the hengduan mountains, northeastern qtp and western qtp, respectively, and gave rise to several of the extant species. our dating analysis estimates that this section diverged from its closest relatives in the pliocene about  <dig>  ma . the timeframe of this event coincides with the recent uplift of the qtp, which occurred between  <dig>  and  <dig>  ma  <cit> . a similar time of divergence was also observed in other groups of plants distributed in the qtp . it has been suggested that the uplifts of the qtp might have limited the spread of many species, but accelerated speciation via vicariance  <cit> . the timeframe of the uplift also coincides with a period of high climatic oscillations that could have reinforced the processes initiated by the uplifts  <cit> .

vicariance and dispersal triggered by the uplift of the qtp and associated climatic changes are common mechanisms in the diversification of plants in the qtp , and also in other mountain areas . based on the s-diva analysis, five of the  <dig> vicariance and seven of the  <dig> dispersal events account for cladogenetic events, and both events occurred during and after the pliocene uplift of the qtp . vicariance and dispersal triggered by the uplift of the qtp and quaternary climatic oscillations may accelerate the early diversification of sect. armerina, and further shape the biogeographic patterns  <cit> . furthermore, ten “vicariance”  and seven dispersal events are identified within species-specific clades, which might play a role in promoting intraspecific divergence. extensive inter- and intra-specific divergence took place in the qtp within the pliocene and quaternary climatic changes in many groups of plants . our analyses together with previous studies thus highlight the importance of the pliocene uplift of the qtp and quaternary climatic changes in promoting the diversification of plants in this mountain area.

niche evolution of p. fasciculata
the s-diva analysis shows different biogeographic patterns for the two p. fasciculata clades. one clade  occupies only northern tibet, while samples from the other clade  can be found in the hengduan mountains, eastern tibet and northeastern qtp. wiens & donoghue  <cit>  argued that phylogenetic niche conservatism and niche evolution might be critical in the biogeographic history of many groups. in contrast to most previous studies that have suggested the importance of niche conservatism in setting range limits and creating biogeographic patterns , niche evolution under climatic changes seems to be the major factor explaining the biogeographic patterns detected here. although the ou <dig> model that allows a single niche optimum is the best model along the temperature gradient , models that allow different niche optima received together higher aicc weights . this result suggests that ecological differentiation  is occurring in this group.

the two p. fasciculata clades and their two closely related species are estimated to diverge from each other during the quaternary after the uplift of the qtp . climatic oscillations during the quaternary had a dramatic effect on species distribution ranges  <cit> . many species have repeatedly retreated and expanded their distributions following these climatic oscillations . these events are associated with relatively relaxed niches  and fast niche evolution  and these characteristics might have allowed these populations to adapt to the changing environmental conditions  <cit> . in contrast, populations of clade f <dig> occur at higher altitudes  compared to those of clade f <dig> . these populations of clade f <dig> might have been adapted to a colder climate characterized by lower temperature seasonality  and less precipitation in the coldest quarter . clade f <dig> displays a lower rate of niche evolution than f <dig> populations and this lower rate could have limited its dispersal into lower and warmer places. a similar pattern was observed in tropical treefrogs  <cit> , which were unable to extend their ranges further north into temperate regions. furthermore, recent climatic changes are involved in a shift toward higher elevations in the climatic envelopes of two closely related monkey-flower species in the direction of higher elevations  <cit> . however, given the harsh environmental conditions, it is plausible that climatic warming in the future might adversely affect the populations of the clade f <dig> and cause their distributions to shrink  <cit> . our results also indicate that contrasting evolutionary processes can occur within closely related lineages, reinforcing the idea that phylogenetic niche conservatism is unlikely to hold at lower spatial scales  <cit> .

while we focus on climatic variables  to explain the biogeographic patterns detected here, additional ecological factors such as edaphic variables, competition, seed bank and seed number could be involved in creating biogeographic patterns  <cit> . as argued by hoskin et al.  <cit> , geographic isolation of populations within species and variation in ecological factors are major precursors to cryptic speciation. the ecological differences and biogeographic patterns found between the two p. fasciculata clades may have given rise to some degree of differential adaptation to their respective environmental conditions, as also suggested in taxus wallochiana  <cit> . however, our data is not appropriate to gain a detailed knowledge of the processes at play here and further studies involving a finer sampling of populations associated with large scale genomic data should be employed to better understand the mechanisms involved in the separation of the p. fasciculata clades.

CONCLUSIONS
our phylogenetic analyses, based on both chloroplast and nuclear datasets, show non-monophyly of primula sect. armerina, corroborating the results of previous family-level studies  <cit> . the topologies inferred from nuclear gene and concatenated chloroplast datasets are incongruent, which may mainly result from hybridization. this section was suggested to originate in the himalayas during the pliocene uplift of the qtp. subsequent dispersals to the hengduan mountains, northeastern qtp and western qtp were considered as the consequence of the pliocene uplift of the qtp and following climatic changes. we further provide a practicable framework for the first time to test the relationship between biogeographic patterns and ecological factors in the qtp area. our evolutionary models suggest that niche evolution, rather than niche conservatism, seems to explain the biogeographic patterns of the two p. fasciculata clades.

