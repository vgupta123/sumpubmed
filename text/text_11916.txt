BACKGROUND
tuberculosis  continues to be a major health threat, with  <dig>  million new cases and  <dig>  million deaths reported worldwide in  <dig>  <cit> . it has been estimated that one-third of the human population is infected with mycobacterium tuberculosis, the causative agent of tb  <cit> . worldwide efforts to treat and eliminate tb are confronting many obstacles, including drug-resistant bacterial strains, lack of compliance with the complicated drug regimens, and an increased patient population with compromised immune systems associated with acquired immunodeficiency syndrome  <cit> .

in general, bacterial metabolism is an attractive drug target for two main reasons: 1) metabolism is required for the bacterium to sustain itself and 2) many bacterial metabolic targets are absent in humans. novel efforts in developing drugs that target the intracellular metabolism of m. tuberculosis often focus on metabolic pathways that are specific to m. tuberculosis  <cit> . however, tb is a complex disease caused by bacterial populations located in discrete microenvironments of the host with access to a varying availability of nutrients  <cit> . this, coupled with the differences in bacterial metabolism under in vivo and in vitro conditions  <cit> , creates a challenge in modeling and understanding the metabolic requirements of m. tuberculosis inside a host.

recently, genome-scale metabolic network reconstructions for different organisms have enabled systematic analyses of metabolic functions and predictions of metabolism-related phenotypes  <cit> . by collecting all possible biochemical reactions for specific organisms, different groups have reconstructed metabolic networks for bacteria , eukaryotic microorganisms  <cit> , mice  <cit> , and even humans  <cit> . the web site of the systems biology research group at the university of california, san diego, provides a continuously updated list of genome-scale metabolic network reconstructions  <cit> . analysis of metabolic networks can provide insights into an organism's ability to grow under specific conditions. for example, given a specific set of nutrient conditions, flux balance analysis  of metabolic networks can accurately predict microbial cellular growth rates  <cit> . in a recent work, raghunathan et al.  <cit>  used an approximate representation of in-host nutrient availability inferred from the literature to simulate the in-host metabolism of salmonella typhimurium. moreover, metabolic network analyses can then be used to identify organism-specific essential genes by predicting the attenuation of microbial growth of specific deletion mutants  <cit> . metabolic genes that are essential for pathogen growth but are not present in humans constitute actual and potential drug targets  <cit> .

using the sequenced genome of m. tuberculosis  <cit>  together with literature data on known metabolic reactions, extensive metabolic network reconstructions have been carried out for this organism  <cit> . analyses of these networks based on fba revealed that they contain sufficient information to predict growth rates and identify genes that are essential for the growth of m. tuberculosis in select media  <cit> . we have also used the in vitro network to model the drug-induced growth inhibition of m. tuberculosis when grown on defined media  <cit> . however, simulation of m. tuberculosis growth in an in vivo host environment based on an in vitro model is hindered by a lack of understanding of the pathogen's metabolism in the often poorly defined in vivo environment  <cit> . to experimentally explore the cellular activities of this pathogen in hosts, several methodologies have been developed. high-throughput gene expression experiments have been performed for m. tuberculosis in murine macrophage cells  <cit>  and cells from mouse lung tissue  <cit> . gene expression data have been interpreted, using the metabolic network of m. tuberculosis, to predict the production of mycolic acid  <cit> . gene deletion experiments on m. tuberculosis, including individual  <cit>  and high-throughput gene deletion studies  <cit> , have identified genes that are essential in the murine host environment. in particular, sassetti et al. developed the transposon site hybridization  technique to identify genes required for m. tuberculosis growth in an in vitro medium  <cit>  and genes specifically required for survival during in vivo infection  <cit> . this assay tested  <dig>  genes, including a large fraction of genes known to be involved in metabolism.

for modeling, gene essentiality data per se are typically used to verify that a genome-scale metabolic network reconstruction is accurate; however, these data can also be used in the refinement process itself, either for specific pathways  <cit>  or for the entire network  <cit> , in which gene annotations, reactions, and biomass objective functions are adjusted based on gene essentiality data  <cit> . moving away from these more or less ad hoc corrections, kumar and maranas  <cit>  explored an automated and systematic way of reconciling in silico/in vivo growth predictions in large-scale metabolic networks. here, we build on and extend these refinement methodologies to develop an enhanced set of systematic procedures to modify the in vitro metabolic network model of m. tuberculosis inj <dig>  <cit>  and develop a network model that is more consistent with in vivo metabolism during the initial eight-week post-infection period. importantly, the resultant network modifications provide indirect insights into the nutrient availability and metabolic states of m. tuberculosis in the mouse host environment. furthermore, we used the newly developed in vivo network to predict the growth of double-deletion mutants to identify drug targets that are either specific for the host environment or common to both in vivo and in vitro conditions.

methods
to develop a m. tuberculosis metabolic network model commensurate with an in vivo cellular environment, we modified an existing network in two separate steps. first, we corrected an existing in vitro network model to account for missing or inconsistent chemical reactions and metabolites, and then, through a systematic set of procedures, we modified this network to be compatible with gene essentiality data generated under in vivo conditions.

modified in vitro network inj661m
we used the inj <dig> metabolic network model of m. tuberculosis h37rv  <cit> , which reproduces in vitro experimentally observed growth rates in different media, as the starting point for our work. our modified in vitro network, inj <dig> m, models cellular growth in middlebrook 7h <dig> medium supplemented with glucose and glycerol. we then used the gsmn-tb metabolic network of m. tuberculosis  <cit>  to supplement reactions and metabolites in the modified network. we corrected the network with respect to biotin synthesis, fumarate and succinate synthesis, added the methylcitrate cycle, added a redundant annotation for the β-hydroxybutyryl-coa dehydrogenase enzyme, and made minor changes to the biomass function . these modifications did not change the previously reported growth rates  <cit> . the resulting inj661m network model contained  <dig> genes,  <dig> metabolites, and  <dig>  reactions. the developed network is provided in the additional files in both systems biology markup language  and excel formats .

prediction of essentiality of single genes and gene pairs
we used fba of the metabolic networks to predict the essentiality of single genes. using linear programming, fba can maximize the cellular growth rate subject to the steady-state mass balance of all the intracellular metabolites and the stoichiometric constraints defined by the reactions  <cit> . for the metabolic network models, we performed fba to calculate the growth rate of wild-type m. tuberculosis and the growth rates of all single-gene deletion mutants. if the ratio of a single-gene deletion mutant growth rate to wild-type growth rate was less than a threshold , we labeled the gene as essential; otherwise, it was deemed as non-essential. since the growth rate ratios obtained from fba were either <10- <dig> or > <dig> , the chosen threshold value of  <dig>  differentiated growth rate ratios close to zero from those significantly higher than zero.

we compared the predicted gene essentiality with experimentally determined in vivo essentiality in mice  <cit>  and defined four categories of predictions: true positives , denoting genes that were predicted to be essential and were also essential in the experiment; true negatives , denoting genes that were both predicted and experimentally determined to be non-essential; false negatives , representing genes that were predicted to be non-essential but were experimentally essential; and false positives , denoting genes that were predicted to be essential but were experimentally non-essential.

we predicted the synthetic essentiality of gene pairs in m. tuberculosis by calculating the growth rates of all possible double-gene deletion mutants in the metabolic network models. two genes were classified as synthetically essential if each single individual gene deletion did not affect the growth of the organism, whereas the double-gene deletion impaired growth. similar to the predictions for single-gene deletion mutants, we classified a deleted gene pair as synthetically essential if the ratio of the growth rate of the double-gene deletion mutant to that of the wild-type bacterium was smaller than the threshold  and the ratios for the two single-gene deletions were greater than the threshold.

modifications used to construct the in vivo network inj661v
we developed a systematic set of procedures to optimally modify an existing metabolic network based on discrepancies in gene essentiality between computational predictions and experimental data. we applied the procedures to modify the original in vitro network, inj <dig> m, to optimally reproduce gene essentiality under an in vivo condition and create an in vivo network, inj661v. figure  <dig> shows an overview of the five main steps of the procedure set, each of which is discussed in detail below. in step i, we compared the gene essentiality of inj661m with experimental in vivo data and identified the set of fp and fn predictions. in step ii, for each incorrect prediction, we attempted to obtain a set of possible modifications to correct the predictions, commensurate with a minimum number of adjustments to inj <dig> m. in step iii, we combined all obtained modifications for each of the incorrect predictions and screened the sets of combined modifications to identify rational and consistent sets of metabolic modifications. in step iv, we analyzed the availability and blockage of nutrient uptakes based on the original inj661m network and attempted to use small, chemically uncomplicated molecules as nutrient sources and to reduce the number of uptakes. finally, in step v, we reviewed the relevant literature to verify the biochemical and biological veracity of the introduced modifications. this set of procedure generated a number of different resultant networks, each representing a "minimal" adjustment that can optimally reproduce the given gene essentiality data. because it is desirable to create a single unique network representation suitable for modeling and computational analysis, and because we do not have enough information to a priori discriminate against any particular network representation, we combined all networks as long as the combination did not generate any new incorrect predictions. thus, the resultant network description inj661v corresponds to an unbiased assembly of minimal adjustments compatible with the experimental data.

step i: collation of the fp and fn predictions
the wrongly predicted fp and fn genes were collated as identified from the gene essentiality predictions described above.

step ii: fp correction procedure
step ii: fn correction procedure
note that, to correct for fp and fn predictions in the step ii procedures, we needed to assess whether a modification was adequate. figure  <dig> shows the criteria we used to determine this. a modification was adequate if, after applying the modification to inj <dig> m, the following three criteria were satisfied: 1) the calculated wild-type growth rate was greater than the minimal rate , 2) the fp or fn prediction was corrected, and 3) no tp prediction became fn.

step iii: analysis of combined modifications
after the completion of step ii, there might be more than one modification used to correct for each of the fp or fn predictions, and we needed to analyze the consequences of combining these modifications into a single network description. figure  <dig> summarizes these analyses. we first listed all possible network realizations, where each realization represented a set of combined modifications. thus, if there were two possible modifications that correct for the prediction of gene a, three possible modifications that correct for the prediction of gene b, etc., then there would be 2*3*... possible network realizations, where each realization includes one modification for each incorrect prediction. next, for each network realization, we checked whether the network contained contradictory modifications, e.g., one modification in the network blocked a reaction flux, whereas another modification allowed for the same reaction flux, or one modification added a metabolite to the biomass objective function, whereas another modification removed it. if contradictory modifications were not detected, then we applied the modifications to inj661m and verified that 1) the wild-type growth rate  was greater than the minimal rate, 2) incorrect predictions were corrected, and 3) correct predictions  were still correct. if true, we recorded the network as plausible. finally, from all plausible networks, we selected the ones that were associated with the smallest number of adjustments .

step iv: nutrient uptake analysis
in step ii, we allowed for the addition and removal of a fixed set of nutrient uptakes, leaving other nutrient uptakes  of inj661m unexamined. here, we re-examined these uptakes in light of the altered nutritional environment under in vivo conditions. the harsh nutritional environment that m. tuberculosis confronts when the bacterium infects a mouse suggests that nutrient uptake is limited and restricted to generally available small molecules as possible metabolite sources. thus, we implemented a nutrient uptake-based analysis procedure to eliminate uptakes of complex nutrients as much as possible while minimizing the number of additional small-molecule uptakes and maintaining the compatibility with the in vivo gene essentiality data. the primary location of m. tuberculosis in a recently infected animal is the phagosomal compartments of macrophages. in this environment, large molecules are typically broken down into smaller ones. for example, macrophages decompose proteins into amino acids  <cit> , which in turn are decomposed into smaller molecules, such as nitrite and nitrate  <cit> . therefore, we assumed that the in vivo nutrient environment did not contain a significant abundance of all large molecules, such as amino acids, but rather was primarily composed of small molecules, such as nitrite, nitrate, ammonia, phosphate, and so on. however, as some large molecules may not be broken down, we still kept the uptakes for these molecules in two cases: 1) if their uptakes was added during the correction of a false gene essentiality prediction ; and 2) if deletions of these uptakes caused a growth rate lower than the defined threshold or generated new false gene essentiality predictions.

before doing any calculation, we first assembled a set of available small-molecular-weight metabolites that 1) contained the necessary atomic elements found among the biomass molecules, i.e., carbon, nitrogen, oxygen, phosphorus, sulphur, iron, potassium, and sodium; 2) had a recorded uptake reaction in inj661m; and 3) contained a minimum number of other elements. based on the elements, these small-molecule metabolites were then grouped accordingly: carbon monoxide  and carbon dioxide  for carbon; ammonium , nitrite , and nitrate  for nitrogen; o <dig> for oxygen; phosphate  for phosphorus; sulphate  for sulphur; ferrous  and ferric  ions for iron; k+ for potassium; and na+ for sodium. note that nitric oxide  is a small nitrogen-containing molecule that was not included in the analysis as it is generated as part of the host defense system rather than acting as a nitrogen source  <cit> . commensurately, we also blocked the reaction catalyzed by cytochrome c oxidase because experiments have suggested that no prevents the function of this enzyme  <cit> . note that this is the only literature source we used before proceeding to the literature analysis and verification in step v.

for each network realization from step iii, we divided all uptake reactions into the following two sets: 1) a "minimal" uptake set comprising the uptakes of h2o and h+, all uptakes added in step ii, and the uptakes of the small molecules defined above ; and 2) an "extended" uptake set comprising all other defined uptake reactions in inj661m . initially, we allowed uptake reactions from the minimal set and blocked all reactions from the extended set. as expected, this resulted in a non-biological network displaying an overall growth rate of zero. we then used the minimization procedure adopted from kumar and maranas  <cit>  to determine the smallest set of uptake reactions in the extended set that restored a minimal growth rate and introduced no new fp or fn predictions.

next, we fixed this set of uptake reactions and investigated which small-molecule uptake reactions from the minimal set were dispensable, i.e., we tried to find a minimal set of uptakes that was still compatible with growth. to do this, we allowed metabolite uptakes for all members of the small-molecule set and investigated removal of specific uptakes based on each element group as defined above. we did this by systematically removing, for each element group, all combinations of small-molecule uptakes and recording which combinations resulted in a wild-type growth rate that was greater than the minimal rate and where each of the tp and tn predictions were preserved. for example, for the carbon group, we investigated the possibilities of 1) removing both the co and co <dig> uptakes, 2) removing only the co uptake, and 3) removing only the co <dig> uptake. when investigating the next element group, all other small-molecule metabolite uptakes were restored. finally, we selected the minimal number of small-molecule uptakes for each element that was compatible with maintaining wild-type growth and preserving the true gene essentiality predictions.

all the computational correction procedures above  were fully automated and attempted to capture all feasible minimal modifications to the network that optimized compatibility with the gene essentiality data. supplemental section s <dig> in additional file  <dig> shows a more detailed description of these procedures. since all feasible corrections for each false prediction were collected, it was possible to obtain more than one resultant network. to generate the single in vivo network inj661v, we included all feasible modifications, as long as no new incorrect predictions or contradictory nutrient uptakes were generated.

step v: literature analysis and verification
we reviewed the available literature on m. tuberculosis to examine the biological rationale of our modifications. the presence of supporting data from the literature suggested that our systematic procedures could provide insights into in vivo metabolism. the absence of literature citations for specific modifications indicated the need for possible future experimental work to link metabolism and gene essentiality data.

statistic analyses of metabolic networks
we used statistical methods to compare the ability of the three metabolic network models  to predict experimental in vivo gene essentiality  <cit> . for each of the three networks, we obtained the total numbers of tp, tn, fn, and fp genes and compared the corresponding sensitivity and specificity. we also calculated matthews correlation coefficients  to evaluate the ability of the networks to predict and classify gene essentiality  <cit> . the mcc measures the correlation between observed and predicted binary classifications and ranges in values from + <dig> to - <dig>  with + <dig> indicating a perfect prediction,  <dig> indicating a random prediction, and - <dig> indicating an inverse prediction. the calculated sensitivity, specificity, and mccs depend on the value chosen for the growth rate ratio threshold to determine gene essentiality. to gauge the overall performance of the designed metabolic network model, we calculated receiver operating characteristic  curves for the studied networks. the roc curve provides sensitivity as a function of  <dig> minus specificity across all possible thresholds  <cit> , and, by estimating the 95% confidence interval of the area under the roc curve , we can quantitatively assess and compare the global performance of each metabolic network model  <cit> .

RESULTS
development of the modified in vivo network inj661v
sassetti et al.  <cit>  experimentally identified the genes essential for m. tuberculosis growth within an in vitro medium. we used the data from this in vitro experiment to verify the ability of inj <dig> and inj661m to predict in vitro gene essentiality. in addition, sassetti and rubin  <cit>  adapted the trash technique to test for genes specifically required for the survival of m. tuberculosis during infection of the pathogen in mice  <cit> . although this technique cannot positively identify in vivo essential genes whose deletion mutants are highly attenuated within the in vitro medium, the differentially identified set provides unique insights into the changed metabolic state of the pathogen  <cit> . in addition, murphy et al.  <cit>  showed that the otsb <dig> gene is essential for m. tuberculosis under in vivo conditions. we used the data from these two in vivo experiments  <cit>  as the basis for our manipulations of metabolic reactions and metabolites to obtain a metabolic network  that was compatible with pathogen growth under in vivo conditions.

a true positive  prediction refers to a gene correctly predicted to be essential, whereas a false negative  prediction refers to a gene incorrectly predicted to be non-essential. a false positive  prediction refers to a gene incorrectly predicted to be essential, whereas a true negative  prediction refers to a gene correctly predicted to be non-essential. sensitivity = tp/. specificity = tn/. matthews correlation coefficient = /1/ <dig>  gsmn-tbv indicates the gsmn-tb network with its in vivo biomass objective function.

in contrast to the in vitro results, the in vivo-predicted essentiality of inj <dig>  inj <dig> m, and gsmn-tb was less satisfactory. using the designated in vivo biomass composition formulation in the gsmn-tb network  provided a slightly larger sensitivity in the essentiality prediction, but the improvement was only modest. the sensitivity for the predicted essentiality of these networks ranged from  <dig>  to  <dig>  depending on the threshold used. mcc values also decreased to  <dig> - <dig>  when we used these networks to predict in vivo essentiality. the relatively poor match between these predictions and the in vivo experimental data suggests that inj <dig>  inj <dig> m, and gsmn-tb are inappropriate to describe the metabolic activity of m. tuberculosis under in vivo conditions.

therefore, we attempted to obtain the new network by modifying an existing metabolic network of m. tuberculosis. among the two available networks  <cit> , we selected inj <dig> as the starting point because it is based on the h37rv strain of m. tuberculosis used in the in vivo gene essentiality experiments  <cit> . in contrast, the gsmn-tb construct is meant to be a general, non-strain specific model of m. tuberculosis metabolism. inj <dig> also successfully predicts the growth rate of m. tuberculosis h37rv in two different media: youmans and the "chemically defined rich culture media," while the growth rates predicted from gsmn-tb are only compared with experimental data for m. bovis bcg. since the key aim of our work is to mimic as faithfully as possible the h37rv strain, we choose not to use the gsmn-tb network as our starting point, although we used reactions relevant to the h37rv strain from the gsmn-tb network to augment our construction.

we used inj <dig> m, the slightly improved version of inj <dig>  as a starting point and performed the systematic procedures shown in figure  <dig> to develop a modified metabolic network  to better describe the in vivo metabolic activity of m. tuberculosis. table  <dig> shows that the comparison between the in vivo experimental essentiality and the predicted essentiality of inj661m at the end of step i yielded  <dig> fp and  <dig> fn predictions with a threshold of ≤ <dig> . all  <dig> fn and  <dig> fp genes were taken as input to step ii. the automated fp and fn correction procedures shown in figures  <dig> and  <dig> were able to correct  <dig> of the  <dig> fp predictions and  <dig> of the  <dig> fn predictions, respectively. additional file  <dig>  table s <dig> shows all the possible minimal corrective modifications for each of  <dig>  predictions.

since there were multiple ways in which we could combine the different modifications, it became necessary to try to reduce the number of possible network realizations, as outlined in step iii. as shown in additional file  <dig>  table s <dig>  we had  <dig> groups of genes whose products each catalyze the same reaction and whose predictions can be corrected by creating the necessary conditions that makes the reaction essential for fn predictions or non-essential for fp predictions. for  <dig> groups there is only one possible modification, for two groups there are five possible modifications each, and for three groups there are two possible modifications each, resulting in a total of  <dig> ×  <dig> ×  <dig> =  <dig> possible network realizations. next, we examined each one of these using the criteria shown in figure  <dig> to weed out inadequate networks. table  <dig> shows the modifications that survived this analysis, resulting in  <dig> groups with only one possible modification and four groups with two possible modifications each, resulting in a total of  <dig> ×  <dig> =  <dig> plausible network realizations.

4
rv1483
inha
fp
25
26
rv1878
rv2222c
glna3
glna2
fp
fp
33
rv1237
sugb
of the  <dig> genes that were incorrectly predicted to be non-essential  under in vivo conditions,  <dig> genes were corrected and became essential in the inj661v network. of the  <dig> genes that were incorrectly predicted to be essential  under in vivo conditions,  <dig> genes were corrected and became non-essential in the inj661v network. we classified the overall  <dig>  genes into  <dig> gene groups, defined as a group of genes whose products catalyze the same reaction.

in step iv, we re-examined the assigned nutrient uptakes in the networks as outlined in the methods section. this analysis was performed for each of the  <dig> network realizations from step iii, each yielding the same set of uptakes. table  <dig> shows that this set of uptakes comprises the default uptakes of h2o and h+ , a minimum number of uptakes of small molecules, uptakes added based on the step ii analysis, and glycerol. we further decreased the upper limit of glycerol input to  <dig>  mmol·h-1·gram dry weight- <dig> until lower values of the glycerol input caused the fum gene to be incorrectly predicted as essential under in vivo conditions. each of the resultant  <dig> networks contained the same set of uptakes and yielded the same number of correct predictions. since we had no prior information to discriminate among these networks, we applied all modifications to inj <dig> m. because this combination did not generate any new incorrect gene essentiality predictions, we designated this network as the "optimal" unbiased construction of the in vivo network inj661v.

octadecanoate,
octanoate,
dodecanoate,
arachidic acid, and
the inj661v network contained  <dig> genes,  <dig> metabolites, and  <dig>  reactions and is provided in the additional files in both systems biology markup language  and excel formats . based on this network, we re-calculated gene essentiality through fba and compared the predictions with the experimental essentiality data in mice  <cit> . table  <dig> shows the results from the comparison of the in vivo gene essentiality predictions of inj661v with those obtained using the in vitro networks. the sensitivity and specificity of the inj661v network model were substantially larger than those of the other two networks regardless of the threshold used to determine essentiality. when inj661v was used to predict in vivo essentiality, we gained in our ability to classify essentiality  compared with using the in vitro networks . thus, a significant correlation between experimental gene essentiality in mice and calculated mutant growth rates was only present in inj661v.

we further applied threshold-independent statistical tests to compare the abilities of inj <dig>  inj <dig> m, and inj661v to predict experimental gene essentiality under in vivo conditions. figure  <dig> shows the roc curves of the three networks. for each curve, we obtained the 95% confidence interval of the auc . the aucs of the in vitro models inj661m and inj <dig> were not significantly larger than those of random predictions , indicating the inability of these networks to predict in vivo essentiality. conversely, the auc of inj661v was significantly larger than those of the other two networks, demonstrating that inj661v was better able to predict experimental gene essentiality in mice.

after step iv, the inj661v network still contained several incorrect gene essentiality predictions. table  <dig> shows the seven fn predictions that we were unable to correct. we failed to correct the predictions for the atpb, nira, prov, accd <dig>  and cobl genes because each one of them is required together with one or more tn genes. for example, the fn gene prov is required together with the tn genes prow, prox, and proz for the transport of choline, carnitine, glycine betaine, and proline into the cell  <cit> . any "correction" of prov would change the tn predictions for prow, prox, and proz into fp. it is likely that the gene products of prov have other essential functions that may or may not be related to metabolic functions and were not accounted for in the current network description. conversely, we failed to correct the prediction for the rv3534c gene because it belongs to a pathway containing a metabolite without a source. thus, further studies are necessary to discover how this metabolite is synthesized and how this information can be incorporated into the network.

a false negative  prediction refers to a gene incorrectly predicted to be non-essential.

literature analysis and verification
by design, our automated and systematic analysis of the in silico/in vivo growth inconsistencies generated by the original inj661m metabolic network created a network  that was more compatible with in vivo growth. the metabolic modifications reflected how the pathogen adjusts its metabolism to adapt to the environment that m. tuberculosis confronts during infection in the mouse. here, we discuss the performed modifications vis-a-vis the available relevant literature within the context of the affected metabolic pathways. table  <dig> shows the reviewed literature associated with each of the performed modifications ordered by the affected pathway.

in the "glycolysis/gluconeogenesis" pathways, we deleted the uptake of glucose from the environment and blocked the synthesis of glucose from maltose and trehalose to correct the fn predictions of the rv1099c and ppgk genes. this modification suggested that the host environment may lack glucose and, thus, forces m. tuberculosis to generate glucose through gluconeogenesis . in the "fatty acid metabolism" pathways, to correct the fp prediction of the fabg <dig>  inha, and pks <dig> genes and the fn prediction of the desa <dig> gene, we added the uptakes of several fatty acids from the host environment and blocked the synthesis of a fatty acid, hexadecenoate. this modification suggested that fatty acids were available in the host environment and that m. tuberculosis stopped synthesizing them under in vivo conditions. in summary, the modifications in these two groups of pathways, along with the retention of glycerol uptake , suggested that the survival of m. tuberculosis during infection in the mouse required lipids  instead of glucose as its primary source of carbon. the important role of lipids as carbon sources is evident from the observed up-regulation of genes involved in fatty acid catabolism during m. tuberculosis in vivo growth  <cit> , m. tuberculosis growth in dipalmitoyl phosphatidylcholine  medium  <cit> , the ability of the bacterium to hydrolyze lecithin into fatty acids  <cit> , and the potential role of human serum as a highly effective fatty acid source  <cit> .

in the pathways associated with "vitamin and cofactor metabolism," we removed riboflavin from the biomass objective function to correct the fp prediction of the ribh, ribc, and ribd genes. the removal suggested that riboflavin was not required for the survival of m. tuberculosis under in vivo conditions, which is supported by the observation that riboflavin is used for glycolysis  in m. tuberculosis  <cit>  and that glucose is not a carbon source for the pathogen in the host environment  <cit> . in the same pathways, we also corrected the fn predictions associated with the bioa, biof, and biob genes by adapting the biomass objective function to include biotinyl-5'-adenosine monophosphate  and blocked the ability of the gene product of the biof <dig> gene to catalyze the synthesis of the precursor of biotin. because biotinyl-5'-amp is the activated form of biotin  <cit> , the inclusion of biotinyl-5'-amp suggests that biotin is required for the survival of m. tuberculosis under in vivo conditions. this observation is compatible with biotin playing a role in gluconeogenesis  <cit>  and that m. tuberculosis obtains glucose through gluconeogenesis under in vivo conditions  <cit> . the blockade of biof <dig> indicated that the enzyme may be inhibited under in vivo conditions, which is commensurate with the observed down-regulation of biof <dig> in the presence of hydrogen peroxide   <cit> , a reactive oxygen species that would be encountered in an intra-phagosomal environment.

in the "amino acid metabolism" pathways, we added uptakes of isoleucine and valine to correct the fp predictions of the ilvc and ilvn genes, suggesting that m. tuberculosis might be able to absorb these amino acids from the host environment. although we could not directly verify these uptakes in m. tuberculosis, experiments have shown that a m. tuberculosis strain that lacks the ability to synthesize three amino acids  could persist in mice for four weeks  <cit> . this suggests that these amino acids might be available, although in limited amounts, in the host environment to compensate for the organism's inability to synthesize these amino acids.

we also examined the modifications with respect to genes and reactions involved in "transport pathways." in this group of pathways, we added two extracellular lipids, phthiocerol dimycocerosate a and phenol phthiocerol dimycocerosate, to the biomass objective function to correct the fn prediction of the lppx gene. the biomass objective function of inj <dig> and the in vivo biomass objective function of gsmn-tb include intracellular phthiocerol dimycocerosate a. in fact, these lipids are known to be secreted by m. tuberculosis into the environment and subsequently are associated with the pathogen envelope, where they aid in avoiding host immune attacks  <cit> . it is somewhat unusual to add extracellular metabolites to the biomass objective function; however, given the localization of the two lipids to the pathogen's envelope, they can be considered as integral to the pathogen and, hence, to the biomass. moreover, our additions of the uptakes of no3-, o <dig>  and fe3+  were supported by the existence of no3- in infected tissue  <cit> , the detection of o <dig> in mouse lung granulomas  <cit> , and the ability of m. tuberculosis to synthesize mycobactin, a chemical with a very high affinity for iron, to obtain iron from the host environment  <cit> .

the lack of detailed experimental evidence for many modifications, as shown in table  <dig>  indicates that there are currently gaps of knowledge associated with m. tuberculosis metabolism. for example, in the transport pathways, we corrected the fn predictions of the suga, sugb, and sugc genes by adding xylose uptake and including xylose in the biomass objective function. these modifications suggest that m. tuberculosis should have a xylose utilization pathway, although this is absent in current metabolic network descriptions of m. tuberculosis. the existence of such a pathway is indicated by the experimental observation that m. tuberculosis is able to use xylose under the presence of glycerol  <cit> . conversely, although sequence analysis has suggested that the sugabc operon encodes a sugar-transporting system, it is unclear what sugar molecules the system transports  <cit> , suggesting that there might be other possible reasons for the sugabc transport system to be essential.

growth prediction of double-deletion mutants
double-gene deletion experiments provide insights into redundant pathways, non-obvious coupling of metabolite flows, and potential new drug targets. for example, although neither the erg11a gene nor the erg11b gene in aspergillus fumigatus is individually essential, the deletion mutant of these two genes is not viable in immune-compromised mice, suggesting the pair of genes as a combined drug target  <cit> . large-scale experimental double-gene deletion requires substantial efforts, whereas the corresponding in silico simulations of deleted gene pairs are readily available. comparative studies for yeast  have shown that 49% of the predicted synthetically lethal double-deletion mutants are correct  <cit> . in silico studies of the growth of double-deletion mutants of metabolic genes have also been performed for e. coli  <cit> , helicobacter pylori  <cit> , and leishmania major  <cit> , although the bulk of these predictions could not be verified due to the paucity of experimental data.

we initially examined the capability of inj661m and inj661v to model the growth of two experimentally examined double-gene deletion mutants. in the first case, experimental work showed that the growth of the Δpancd mutant  is highly attenuated in mice  <cit> . fba of both inj661m and inj661v predicted that Δpancd mutants have a growth rate of zero, consistent with the experimental observation. although not confirmed experimentally, our analysis of inj661m indicated that the growth attenuation may also take place within an in vitro medium. in the second case, experimental work has indicated that the mutant Δicl1Δicl <dig>  of m. tuberculosis cannot survive in mice but can grow under certain in vitro conditions  <cit> . fba of inj661m predicted that the growth rate of Δicl1Δicl <dig> was equal to that of wild-type m. tuberculosis, whereas analysis of inj661v predicted that the growth rate of Δicl1Δicl <dig> was only 26% of the wild-type rate, suggesting that inj661v was a better predictor for in vivo growth.

we then performed a comprehensive fba of inj661m and inj661v to simulate the growth of m. tuberculosis double-gene deletion mutants under an in vitro condition and an in vivo condition, respectively, and predicted synthetic lethality. additional file  <dig>  table s <dig> shows the complete results of these calculations, and additional file  <dig>  figure s <dig> shows the mapping of synthetic essential gene pairs in inj661v to carbon metabolism-related pathways. figure  <dig> shows the number of essential gene pairs that were uniquely and commonly predicted by these two networks . the inj661v network predicted a substantially larger number of synthetically lethal genes under in vivo conditions than the inj661m network under in vitro conditions. this was partly due to the more constrained nutritional environment faced by inj661v with respect to carbon metabolism. although drugs effective under in vitro conditions may not be effective under in vivo conditions, the converse may also be true  <cit> . the additional  <dig> gene pairs identified in inj661v indicate novel potential drug targets under in vivo conditions. likewise, the  <dig> gene pairs that were predicted to be essential under both conditions may represent more robust drug targets based on their insensitivity to environmental conditions.

the bulk of the  <dig> gene pairs uniquely predicted to be essential for bacterial growth using inj661v were related to carbon and energy metabolism. this reflects the modifications that we implemented in inj661v to reproduce the in vivo gene essentiality data in these parts of the metabolic network. synthetic lethality in carbon metabolism was primarily located in the two different pathways that can be used to synthesize glucose precursors from glycerol and fatty acids . other enzyme pairs that exhibited synthetic essentiality in inj661v were those who catalyzed the same reaction, i.e., each enzyme by itself was not essential, but if they were both deleted at the same time, the reaction could not proceed and the organism would stop growing. additional file  <dig>  table s <dig> shows that this group includes rv2476c, gltb, and gltd, whose gene products were necessary for converting α-ketoglutarate into glutamate. an additional  <dig> synthetically essential gene pairs were involved in energy metabolism. we also analyzed the  <dig> synthetically essential gene pairs that were common to both inj661m and inj661v. this set was enriched in gene pairs that were involved in amino acid and nucleotide metabolism, supporting the suggestion that these metabolic processes could be common drug targets under both in vitro and in vivo conditions  <cit> .

exploration of the metabolism of m. tuberculosis using the in vivo inj661v network
the gene essentiality data used to help construct the in vivo network produced non-obvious changes in the flow of metabolites and uptakes of nutrients from the environment. analyses of this in vivo-compatible metabolic network of m. tuberculosis allow us to probe the metabolic state and metabolic adaptation of the pathogen to the host environment, opening-up new avenues for targeting specific enzymes or pathways that cannot be observed under in vitro conditions. here, we briefly explored the m. tuberculosis metabolism as related to its adaptation to living in an acidic environment, the importance of the tricarboxylic acid -cycle under different limiting nutrient conditions, the effects of inhibiting multiple reactions, and the modes of cellular respiration during infection.

the macrophage phagosome presents a generally hostile environment with an acidic ph ranging from  <dig>  to  <dig>   <cit> . the specific mechanism by which m. tuberculosis adapts to this acidic condition has not been fully elucidated  <cit> . one well-known protective feature is the waxy  cell envelope that forms a barrier against unwanted h+ entry  <cit> . in the context of metabolism, it is speculated that the urease reaction presents another acid adaptation mechanism by converting h+ and urea into nh4+ and co <dig>  <cit> . the produced nh4+ also contributes to the m. tuberculosis survival by preventing the maturation of the phagosome  <cit> . we used the inj661v network to explore additional acid adaptation mechanisms based on the metabolic flow of h+. we used flux variability analysis  to estimate the ranges of reaction fluxes in the metabolic network at the optimal growth rate. this allowed us to estimate the range of the overall h+ exchange between the environment and the m. tuberculosis cells at the optimal growth rate for wild type inj661v. the protonation state of the metabolites is chosen to correspond to ph  <dig>   <cit> . because we only considered the steady state h+ flux in both in vitro and in vivo metabolic network models, the protonation states of the metabolites were not changed in this calculation. table  <dig> shows that the overall h+ exchange was within a narrow range of negative values, suggesting that the in vivo metabolism consumed h+ as a whole, contributing to the relief of acidic stress. the primary reaction important for this h+ consumption was the nitrite reductase  reaction that uses h+ and reduces no2- into nh4+. table  <dig> shows that the fluxes through nr of wild type inj661v were positive but did not vary, suggesting that there must be flux through this reaction at the optimal growth of wild type cells. conversely, for mutants whose nr was removed , the overall h+ exchange could only be positive. given the neutralization as well as the protective effect of creating nh4+  <cit> , nr is a strong candidate for playing an important function in the in vivo adaptation of m. tuberculosis in acidic environments.

                              + 
                           exchange
with
with
overall hydrogen ion  exchange indicates the total h+ exchange between the environment and the mycobacterium tuberculosis cells. a negative value of the exchange indicates that m. tuberculosis consumes h+ as a whole, while a positive value indicates that the metabolism generate a h+ surplus, i.e., increases acidification of the environment. the minimum  and maximum  fluxes reflected the ranges of the fluxes at the optimal growth and were obtained through flux variability analyses of inj661v and inj <dig> m. Δnr represents the strain in which nitrite reductase  was blocked. the unit of mmol/h/gdw represents mmol per hour per gram dry weight of m. tuberculosis.

in order to more comprehensively study acid adaptation/resistance we examined the role of nr in the presence of urease  <cit> . because the inj <dig>  network does not include a complete urea synthesis pathway, we added a urea uptake in order to create a flux through the urease reaction. table  <dig> shows the estimated ranges of the h+ exchange and the reaction fluxes for inj661v with urea uptake. overall, h+ is consumed to relieve acid stress. in the wild type strain, the flux through the nr reaction was greater than zero, suggesting that nr still contributes to h+ consumption in the presence of urease. removal of the nr reaction  diminished h+ consumption, but did not abolish the overall h+ exchange. importantly, we performed the same analysis for the in vitro inj661m network and found that the nr reaction was always inactive, suggesting that nr does not play a role in acid adaptation in the in vitro medium . in conclusion, nr contributes to the acid adaptation under in vivo conditions even in the presence of other acid adaptation mechanisms. the importance of nr in acid resistance might be experimentally tested by inactivating the nr reaction and examining cellular growth under in vivo conditions or in vitro low-ph environments with freely available nitrite or nitrate.

persistence and slow growth are clinically important states of the m. tuberculosis pathogen. metabolic network models can be used to study the metabolic states associated with these conditions under a variety of conditions that mimic slow growth. in the development of the gsmn-tb model, beste and co-workers induced slow growth by limiting the uptake of glycerol and high-lighted the corresponding changes in reaction fluxes in the glyoxylate shunt pathway  <cit> . considering that fatty acids are the major carbon sources for in-host m. tuberculosis  <cit> , here we simulated nutrient limitation to probe slow in vivo growth by reducing fatty acid uptake. we performed fva to estimate the ranges of the fluxes through the reactions in the tca cycle and the glyoxylate shunt pathway under slow  and fast  growth. we simulated the slow in vivo growth by constraining fatty acid uptake of inj661v until the growth rate was one third of its original value  <cit> , and fast growth by keeping the constraints unchanged. for each reaction we calculated the ratio of the midpoint of the flux range for slow growth to that for fast growth, where each flux was normalized to the corresponding total growth rate. this ratio represents a relative value of the fluxes and can be used to compare the relative importance of specific reactions.

given the ability of the metabolic network to provide different reaction fluxes under different metabolic conditions, we can explore combinations of mechanisms to inhibit multiple reactions to derive optimal in vivo growth-reduction strategies. drug combinations that achieve optimal therapeutic response and avoid side effects caused by high doses of single drugs  <cit>  can rapidly be examined using these modeling techniques. to illustrate this concept, we constructed an example to investigate double-reaction inhibition using metabolic network modeling. given that the primary in vivo nutrients are lipids, we focused on two reactions that are required to process these metabolites, i.e., the glycerol-3-phosphate dehydrogenase  reaction, which is necessary for the utilization of glycerol, and the icl reaction, which is a known potential drug target and is required for the conversion of fatty acids into other metabolites, such as pyruvate  <cit> . to study the effect of this combined inhibition, we calculated growth rates under a set of upper limits of the fluxes through the icl and g3pd reactions. figure  <dig> shows the calculated growth rates under different upper limits for the two reactions for both the in vivo inj661v  and in vitro inj661m  networks.

in these graphs, the lower left hand corner corresponds to the most stringent blockage of both reactions, i.e., where the fluxes for each reaction was constrained to be ≤10- <dig> mmol/h/gdw. figure 9a, illustrating the in vivo results, shows that these flux limits effectively blocked growth of the organism as indicated by the blue color designating strongly retarded growth rates. one can also see that whereas the icl reaction is essential, i.e., the organism cannot effectively grow if this reaction is sufficiently inhibited, single blockage of the g3pd reaction would not prevent growth if the icl reaction was left unconstrained . it was also clear that limiting the g3pd flux  further decreased the growth rate at virtually all icl flux values. this indicates that for a given desired growth-rate reduction, one could use a combination of icl and g3pd inhibitions to achieve the same effect as those possible with a stringent single icl inhibition. if these fluxes can be inhibited by drugs, reducing the dose of the most toxic drug to achieve the same therapeutic response would decrease risk of potential side effects. moreover, we performed the same calculation for inj661m and observed no combinatorial effect of the inhibition. figure 9b shows that when we constrained the fluxes through the icl and g3pd reactions to zero, the growth rate was still close to that of unconstraint growth. it is clear that the inj661v network is instrumental in delineating combinatory inhibition strategies while the in vitro inj661m network is not.

finally, we examined the results of the inj661v double deletion mutants with respect to cellular respiration during infection. additional file  <dig>  table s <dig> shows that the genes corresponding to the cytochrome bd oxidase  and the nitrate reductase  enzymes were synthetically essential. because these two enzymatic groups are associated with aerobic and anaerobic respiration, respectively, synthetic essentiality indicates that therapy targeting cellular respiration needs to simultaneously inhibit both aerobic and anaerobic respiration. this conclusion is not evident from gene expression data, which instead indicates that seven weeks post-infection the pathogen only employs nitrate reductase enzymes for anaerobic respiration  <cit> . however, gene essentiality data indicate that all genes corresponding to these enzymes  are non-essential in mice, even after seven weeks  <cit> , indicating that anaerobic respiration is not the only available option to the pathogen and that o <dig> is available to the bacterium in the host environment  <cit> . therefore, dual inhibition of aerobic and anaerobic is necessary to fully arrest bacterial respiration. this hypothesis can be experimentally tested by simultaneously deleting both gene groups and testing for differential growth of m. tuberculosis under in vivo and in vivo conditions.

in summary, we used the developed inj661v network to explore metabolism-based m. tuberculosis acid adaptation mechanisms, study metabolic responses to in vivo slow growth, estimate the effects of different levels of inhibitions of multiple reactions, and gain insights into respiration-targeting therapy.

discussion
although the existing metabolic network of m. tuberculosis inj <dig>  <cit>  reproduces experimentally observed growth rates in different media and predicts gene essentiality under in vitro conditions, it lacks predictive power for in vivo gene essentiality. we developed a set of automated procedures that systematically examined possible metabolic modifications to the original inj <dig> network and optimized predictions of experimental in vivo essentiality. by design, the newly developed in vivo network inj661v provided significantly better agreement  between predicted and experimental in vivo gene essentiality.

indirectly, the systematic reconstruction of inj661v also provided a means to use high-throughput in vivo gene essentiality data to gain insights into the in vivo metabolism of m. tuberculosis. for example, we added fatty acids as inputs from the host environment and removed the ability of the network to take up glucose, indicating that m. tuberculosis uses lipids as the major carbon source for metabolism. this is compatible with the experimentally observed upregulation of genes involved in fatty acid catabolism  <cit> . commensurate with the aerobic nature of the organism, our calculations indicated that o <dig> uptake must be retained under in vivo conditions  <cit> . another example is our inclusion of two extracellular lipids, phthiocerol dimycocerosate a and phenol phthiocerol dimycocerosate, in the biomass objective function. this is appropriate since the two secreted lipids actually associate with the pathogen envelope to help the organism avoid host immune attacks  <cit>  and are thus intimately associated with the organism/cell itself. in addition to providing experimentally confirmed insights, the inj661v network allowed us to predict a different and putative much larger set of synthetic double-gene deletion mutants than those obtained under in vitro conditions. furthermore, using inj661v as a model for in vivo metabolism, we proposed that nitrite reductase might play an important role in the metabolic adaptation of m. tuberculosis to an acidic environment, we found specific enzymes in the tca-cycle that might be important under the fatty-acid-limiting slow-growth condition prevailing in macrophages, we investigated combinatory inhibition of the icl and g3pd reactions as an effective drug-combination strategy under in vivo nutrient conditions, and found that inhibition of both aerobic and anaerobic respiration were required to fully arrest cellular respiration of m. tuberculosis during infection.

the developed methodology can provide systematic corrections based primarily on discrepancies between predicted and experimental gene essentiality data, which can be used to fine-tune initial metabolic network reconstructions. here, we built on and expanded the previously developed "growmatch" techniques of kumar and maranas  <cit>  by extending and enhancing the possible correction steps. this was partly necessitated by the more incomplete state of the m. tuberculosis network compared with that of e. coli, as used by kumar and maranas, and the more extensive nature of the required corrections to switch from an in vitro to an in vivo metabolic environment. one major difference was that our procedures included an analysis of the combined modifications  to systematically eliminate undesirable effects, e.g., very small growth rates or new incorrect predictions of gene essentiality.

although the gene deletion mutant growth measurements used by sassetti and rubin  <cit>  to experimentally determine gene essentiality provide time-specific information, the developed inj661v network did not include a time-dependent component. in the development of our network, a gene was considered experimentally essential as long as it was deemed to be essential at any time point during the entire eight-week time course spanned by the experiments  <cit> . we examined this approximation by comparing gene essentiality predictions at the reported time points of one, two, four, and eight weeks post-infection. additional file  <dig>  table s <dig> shows a comparison of the predicted and experimental gene essentiality at different time points, basically showing that there was an overall small, non-time-specific difference between the mcc values for the individual time points and the time-independent value  shown in table  <dig>  the sparse nature of the experimental data did not warrant the additional complexity of constructing time-dependent in vivo metabolic networks. however, as both the pathogen and host dynamically change their responses during infection, future work using additional datasets and modeling methodologies will be required to adequately capture this aspect of the in vivo metabolism of m. tuberculosis.

the existence of inaccurate essentiality predictions based on inj661v  indicate that there is room for further additions and corrections to the network to better capture in vivo metabolism. the modifications that we made to the original in vitro inj <dig> network were relatively minor, as inj661v only shows a slightly diminished capability to predict in vitro essentiality data compared with inj <dig> m. the development of the modified in vivo network inj661v was ultimately based on the growth of the bacterium under different in vitro conditions  and modifications to better model experimental in vivo gene essentiality. these conditions capture part of the pathogen's metabolic processes, but large knowledge gaps still exist. an analysis of the m. tuberculosis genome indicated that while  <dig>  genes are directly associated with metabolic processes , only  <dig> genes were explicitly included in the developed network. this highlights the need for further systematic theoretical analyses to improve the network description and, more importantly, the need for experimental data under a variety of different in vivo and in vitro growth conditions that could be used to guide and validate model development.

higher fidelity in silico modeling of organisms provides the foundation for the eventual integration of metabolic information with gene regulation and signaling networks to model biological phenomena. ultimately, the model development presented here can be extended to answer additional questions as they relate to the metabolic status of the pathogen population before, during, and after infection: what nutrients are present in different in vivo compartments, how do they change as infection progresses, and how do they relate to cellular growth rates and population sizes? what is the appropriate objective function to use for the persistent dormant phase of m. tuberculosis infection? what processes does m. tuberculosis use to handle nutrient deficiencies and antagonistic conditions found in macrophages? these are the questions that we can now begin to address using the developed inj661v as a more sophisticated in vivo representation of the metabolic network for m. tuberculosis.

CONCLUSIONS
m. tuberculosis, the causative agent of tb, continues to pose a major health threat worldwide, with nearly two million deaths annually. modeling of and accounting for the varying metabolic requirements of m. tuberculosis during host infection can help identify the metabolic enzymes suitable for therapeutic intervention. to this end, we developed procedures to construct an in vivo metabolic network model of m. tuberculosis that maximizes the agreement between predicted and measured gene essentiality determined from infection experiments in the mouse. we verified the modifications obtained computationally by reviewing the available relevant literature. for example, lipids are major carbon sources for m. tuberculosis in the host environment. the network provided a metabolic description of the pathogen consistent with the generally hostile and nutrient-poor in vivo conditions in the host that can be exploited in evaluation, selection, and modeling of novel potential drug targets.

authors' contributions
all authors contributed to the design and coordination of the study. xf performed the computational implementations, and xf and aw prepared the original draft, which was revised by jr. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary materials. it provides the detailed steps for constructing the inj661m and inj661v networks, and all supplemental tables and figure.

click here for file

 additional file 2
the inj661m metabolic network. it describes the inj661m metabolic network, using the systems biology markup language format.

click here for file

 additional file 3
the inj661m metabolic network. it describes the inj661m metabolic network, using microsoft excel  <dig> 

click here for file

 additional file 4
the inj661v metabolic network. it describes the inj661v metabolic network, using the systems biology markup language format.

click here for file

 additional file 5
the inj661v metabolic network. it describes the inj661v metabolic network, using microsoft excel  <dig> 

click here for file

 acknowledgements
we thank dr. chenggang yu for his providing comprehensive analysis on gene annotation of m. tuberculosis to obtain genes directly associated with metabolic processes. this project was funded in part by a competitive in-house laboratory independent research  grant by the u.s. army assistant secretary of the army for acquisition, logistics, and technology . the opinions and assertions contained herein are the private views of the authors and are not to be construed as official or as reflecting the views of the u.s. army or the u.s. department of defense. this paper has been approved for public release with unlimited distribution.
