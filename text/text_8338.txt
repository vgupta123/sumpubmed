BACKGROUND
assignment of function to gene products in the absence of direct experimental information is an important challenge of computational molecular biology  <cit> . in annotating proteins from newly-sequenced genomes, it is a common practice to transfer functional annotation from a homologous protein  <cit> . this approach depends on the assumptions that:  because homologous proteins have similar sequences and structures, they have similar functions, and  the annotation of the source homologue is correct. often, but certainly not always, these assumptions are valid.

in this study we quantitatively assess the relationship between the divergence of protein function and the divergence of amino acid sequence in families of homologous proteins. in addition to illuminating the process by which proteins evolve altered and novel functions, the results provide guidance about the expected accuracy of transfer of functional annotation among homologous proteins in databases.

the most general evidence for protein homology, and inference of shared function, depends on comparative analysis of sequences and structures. psi-blast  <cit>  and hidden markov models  <cit>  identify distant homologs from multiple sequence alignments. other techniques include the training of support vector machines  <cit>  and neural networks  <cit>  on protein features such as charge distribution and hydrophobicity to predict protein function. structure comparisons improve the accuracy of inference of function in the absence of direct experimental evidence. these include the use of information from domains  <cit>  and motifs  <cit> . fleming et al.  <cit>  combined structural and sequence alignments of proteins in an annotation tool named phunctioner.

despite the sensitivity of these tools for detecting homologs and predicting function, many authors have pointed out that because closely-related proteins can change function, either through divergence to a related function or by recruitment for a very different function, annotations based only on homology can be incorrect  <cit> .

two problems that have arisen in studying the evolution of protein function and evaluating the expected accuracy of functional annotation transfer have been  standardization of terminology in describing function, and  defining a measure of the "distance" between functions. the enzyme commission classification has been very valuable but deals with only one class of protein functions  <cit> . in  <dig>  the gene ontology  consortium formulated a newer and more general classification of protein functions and the relationships among them  <cit> . unlike the ec classification, which was a strict hierarchy, the go scheme has the form of directed acyclic graphs , specialized to three domains: molecular function, biological process, and cellular component.

enzyme commission identifiers form a strict four-level hierarchy, or tree. for example, isopentenyl-diphosphate Δ-isomerase is assigned ec number  <dig> . <dig> , where the initial  <dig> specifies the most general category,  <dig> = isomerases;  <dig>  comprises intramolecular isomerases;  <dig> . <dig> those enzymes that transpose c = c bonds; and the full identifier  <dig> . <dig>  specifies a particular reaction. note that the ec classified reactions, not enzymes. to compare functional assignments of two proteins according to the ec classification, it is conventional to ask at how many levels of the hierarchy the ec numbers agree.

in contrast, the go classification is not a tree, but a more general type of graph. each node is labeled by a general or specific protein function. edges in the graph correspond to relationships between more general and more specific functions, that is, child-parent relationships. for example, the node "protein binding" is a child of the node containing the more general function "binding". the number of levels – the length of the path from any leaf to the root – is not constant. the structure of the go dag induces a measure of distances between functions, which will be used to quantify sequence-function relationships in proteins .

go assigns the identifier  <dig> to isopentenyl-diphosphate Δ-isomerase.  figure  <dig> shows a minimal-length path from go: <dig> to the root node of the molecular function dag, go: <dig>  in this case there are four intervening nodes, progressively more general categories as we move up the figure. note that the go description of this enzyme as an oxidoreductase is inconsistent with the ec classification, in which a committed choice between oxidoreductase and isomerase must be made at the highest level of the ec hierarchy.

our current work treats the molecular function component of the go classification. the go molecular function graph forms a network that has characteristics in common with other biological networks. in the gene ontology dags, the average in-degree is  <dig>   the in-degree distribution is intermediate between an exponential and a power function. there is a wide range in out-degree, ranging from  <dig> to  <dig>  three nodes had very high out-degree with  <dig>   <dig> and  <dig> children. the out-degree distribution followed a power law, showing that there are hubs, or highly connected nodes. the total degree  distribution for the molecular function ontology has a mean of  <dig> , and follows a power law.

 <dig>  assignment of functions to proteins
neither the enzyme commission nor the go classifications of protein function constitutes an assignment of function to any particular protein. both provide only a framework for making such assignments. the pir database at georgetown university  <cit>  associates gene ontology identifiers  with individual proteins. the annotation of each protein may include several go ids. indeed, annotation with any function logically implies annotation with all more-inclusive functions, all the way up to the root of the graph.  therefore for each protein we extracted the distal  go ids to represent the function of the protein .

 <dig>  the relationship between sequence divergence and function divergence
many proteins with similar sequences have similar functions; for example, mammalian hemoglobins transport oxygen and carbon dioxide. for mammalian hemoglobins, transfer of annotation among homologs gives correct results. however, other families of homologs contain proteins with different functions. for example, hen egg white lysozyme and baboon α-lactalbumin have 37% identical residues in optimal sequence alignment, and retain very similar mainchain structures, but have unrelated functions. contrasting mammalian hemoglobins with lysozyme/α-lactalbumin, there is a general correlation between divergence of sequence and divergence of function. that is, mammalian hemoglobins have similar sequences and similar functions; lysozyme and α-lactalbumin have more distantly related sequences and dissimilar functions.

however, there are many exceptions to this correlation. in the duck, eye lens crystallins are identical in sequence to liver enolase and lactate dehydrogenase  <cit> . this is an example of "recruitment" – unrelated function with little or even no sequence change. this threatens to produce incomplete or even erroneous annotations, if annotation is passed freely among homologs. conversely, some proteins very distantly related in sequence nevertheless retain similar function.

several groups have studied the relationship between sequence similarity and functional similarity based on the enzyme commission classification. those studies were necessarily limited to proteins with enzymatic functions:

in studying the relationship between sequences and ec classifications of proteins, wilson, kreychman & gerstein  <cit> , todd, orengo & thornton  <cit> , and devos & valencia  <cit>  reached similar  optimistic conclusions. wilson, kreychman & gerstein  <cit>  concluded that for pairs of single-domain proteins, at levels of sequence identity > 40%, precise function is conserved, and for levels of sequence identity > 25%, broad functional class is conserved  the study of todd, orengo & thornton  <cit>  analyzed only the homologous pairs of enzymes and reported that approximately 90% of pairs of proteins with sequence identity > 40% conserve all four ec numbers. even at 30% sequence identity, todd, orengo & thornton found conservation of three levels of the ec hierarchy for 70% of homologous pairs of enzymes. devos & valencia  <cit>  reached very similar conclusions; they also reported the ability to predict correctly the agreement of fssp categories  <cit>  and swiss-prot  <cit>  keywords, as a function of the level of sequence similarity.

our work pursues the question of the relationship between divergence of sequence and function in homologous proteins, using the molecular function dag of gene ontology for the classification of function. use of the go classification allows extension of the earlier work to proteins with non-enzymatic functions, permitting a comprehensive study of functions of proteins.

the steps of our analyses were as follows: for each pair of homologous proteins from a pfam family, we recorded the % identical residues in the optimal alignment as a measure of sequence divergence, and we measured the functional distance between the sets of distal go ids associated with the two proteins. we based our definition of the distance between sets of annotations on a generalization of the simple minimum-path-length measure of the distance between two single go id's .

from these data, we mapped the relationship between sequence divergence and function divergence. we distinguished divergence of functions within the same "branch" of the dag  and those in different "branches" of the dag. we call these similar and dissimilar functions, respectively . we observed that, despite counterexamples of recruitment, there is a general correlation between divergence of sequence and appearance of dissimilar functions within each family. this relationship is made precise by our calculations. our results also show that there is some variation among different pfam families, especially for more highly-diverged sequences.

 <dig>  
RESULTS
we analyzed  <dig> pfam families . the families ranged widely in size, from  <dig> to >  <dig> proteins. most families were relatively small; 85% of those studied had between  <dig> and  <dig> members.

for each pair of proteins within each family we determined the sequence similarity and the set of minimum distances between distal go ids . for the functional distances, we distinguished, and analyzed separately, divergent functions within the same branch of the go dag ; and entirely different functions, for which the root of dag was the lowest common ancestor .

a primary goal is to describe the relationship between sequence divergence and functional divergence.

 <dig>  the ef-hand family
the ef-hand family is typical and provides illustrative results. this family contains  <dig> proteins comprising two classes of functions: signaling and buffering/transport. ef-hand proteins involved in signaling include the best-known members of the family such as calmodulin, troponin c and s100b. these proteins typically undergo a calcium-dependent conformational change which opens a target binding site. ef-hand proteins involved in buffering/transport include calbindin d9k. these do not undergo calcium-dependent conformational changes  <cit> .

figures  <dig>   <dig>   <dig> show normalized distributions of functional divergence of pairs of proteins in the ef-hand family, as a function of sequence divergence. the % identical residues in aligned pairs of sequences ranged from 0% to 100%. pairs of sequences were divided into bins of width 10% sequence identity. the functional distances range between  <dig> and  <dig> 

similar and dissimilar functions have different distributions
similar functions  show a dominant peak at distance =  <dig> , and a subsidiary peak at  <dig>  it is interesting that the different bins of sequence identity show distributions of similar shape. what distinguishes the distribution of pairs of closely-related proteins from pairs of distantly-related proteins is not so much a progressive increase in the set of functional distances represented, but a decrease in the number of pairs with identical function. the distribution  of dissimilar functions of course excludes the peaks at functional distance zero or one, and shows an uneven distribution with peaks between  <dig> and  <dig>  with a very few pairs at a go distance of  <dig>  the high spikes are the artifacts of the normalization, in cases where there are very few data. there is a high peak at functional distance  <dig> for pairs of proteins with 80–100% sequence identity, signifying either recruitment or incomplete annotation .

the graph combining all similar and dissimilar functions  showed three distinct peaks, at  <dig>   <dig>  and 10; the peaks at  <dig> and  <dig> reflecting dissimilar functions. two factors contribute to the non-smoothness of the distribution:  proteins in the ef-hand family are annotated by a relatively small set of distal go ids, and  there is an uneven distribution of pairs of proteins with different degrees of sequence similarity. the high peaks at  <dig> and  <dig> in figure  <dig> arise from pairs of protein with 0–10% sequence identity. 

the results show several regularities:

 as the sequences progressively diverge, there is a systematic decrease in the number of pairs with distance  <dig>  . the % of pairs with  <dig> distance is approximately constant  for bins of sequence similarity < 40%, and then increases sharply. the distribution of similar functions in pairs of proteins with 80–100% sequence identity has a unique peak at  <dig> 

> 70% data not available.

 the data suggest the interesting result that there is a threshold at about 40% sequence identity, at which the observed behavior changes. for pairs of proteins with 0–40% residue identity, the distribution is largely independent of sequence identity. above 40% sequence identity, there is a significant increase in similar functions over dissimilar ones. these results, shown in figure  <dig> for the ef-hand family, were also observed when all the pfam data were combined and the contribution of dissimilar functions to each range of sequence identity calculated.

 <dig>  combined pfam data
the number of proteins/pfam family varied from  <dig> to  <dig> for the collected data . because of the effects of different sample sizes on the statistics of the distributions, we divided the pfam families into five categories according to size: 2– <dig> members , 31– <dig> members , 61– <dig> members , 271– <dig> members , and >  <dig> members . figure  <dig> shows the relationships between sequence divergence and functional difference for these classes separately, in each case separating ranges of sequence identity into bins of width 20% sequence identity.

the data shown in figure  <dig> confirm an "action zone" between 40% sequence identity and 60% sequence identity. this range of sequence identities shows the highest change in the identical functions . this suggests a threshold in the behavior: sequence divergence below 50–60% residue identity "releases" function to diverge, or alternatively, functional divergence by mechanisms other than recruitment generally requires > 40% amino acid substitution. pairs of proteins with all values of sequence identity > 60% had nearly the same contribution from dissimilar functions. this means that for pairs of proteins with > 60% residue identity the fraction of dissimilar functions did not vary strongly with sequence divergence. a similar threshold behavior appears in the relationship between percentage of dissimilar functions and sequence identity. there is a steep increase in the percentage of dissimilar functions as the sequence identity fell below 40%.

to study the variation between different pfam families, we did separate calculations for each pfam family and compared results. we calculated the percentage of dissimilar functions within each pfam family and divided the pairs of proteins into bins of width 10% sequence identity. the results are shown in figure  <dig>  the data show a very wide overall divergence among different pfam families in all ranges of sequence similarity. each column contains data in the full range from  <dig> to  <dig> of fraction of dissimilar functions with in a family. however, it is also clear that there is a sharpening of the distribution, a decrease in the mean  and fewer outliers, as sequence similarity increases.

 <dig>  comparison with sequence-function correlation based on the enzyme commission classification
other investigators have studied the relation of divergence of function based on the ec classification. of course, these studies were limited to proteins with enzymatic functions. in a result typical of these studies, wilson et al. reported a threshold at  <dig> – 40% sequence identity for onset of more prevalent function divergence in their comparison of sequence and function conservation using enzyme commission classification .

 <dig>  comparison of experimental and non-experimental annotations
it could be argued that for purposes of judging the reliability of transfer of annotation among homologous proteins, the comparisons of annotations described in the previous sections are flawed, because the data contain annotations produced by transfer. in order to explore this, we did separate calculations limited to experimentally-based annotations.

go provides for recording the source of functional assignments, which may be experimental or inferred. the go consortium classified possible sources of annotation, and ranked them according to suggested reliability. the most direct evidence is experimental: evidence codes tas , ida , imp , igi  and ipi . less direct sources of annotation are iss , iea  and nas . we used these evidence codes to compare sequence-function relationships for experimental and non-experimental annotations of proteins.

we extracted proteins of the ef-hand family for which all annotations had experimental support only. this reduced the number of proteins from  <dig> to  <dig> . we formed two mutually exclusive sets:  proteins with only experimentally verified annotations, and  proteins with no experimentally verified annotations. we collected all the go ids for the proteins from both sets and determined the common and different terms. the experimental-based set had  <dig> unique annotations and the non-experimental set had  <dig> unique annotations. both sets of annotations varied from very specific to quite general functions.

some of the results that emerged from studying the relationships between the annotation sets were anticipated. all the experimental go ids appeared in the non-experimental set, as would be expected if the experimental information "seeded" the annotation of other proteins via transfer of annotations. the comparison of experimental and non-experimental sets also revealed that the percentage of dissimilar functions was higher in the experimental set  than in the non-experimental set  for the entire range of sequence similarity. when we compared the normalized data , we observed that  a smaller percentage of protein pairs in the experimental set had identical functions  and  comparison of the distributions of functional difference for different ranges of sequence divergence were more similar for the annotations based on non-experimental data than for the annotations based on experimental data.

however, we also observed, to our surprise, that:

 <dig>  many go ids in the non-experimental set did not appear in the experimental set. this raises the question of what these annotations were based on.

 <dig>  the set of non-experimentally-based annotations included more precise functions than the experimental set.

for instance, there is solid experimental evidence that proteins of the ef-hand families bind calcium and zinc; however, some proteins of the ef-hand family are annotated as binding magnesium and iron. the magnesium and iron binding annotations are given the evidence code iea . although the non-experimental and experimental annotations share the idea of cation binding, the details – the identity of the metals – are different. moreover, the non-experimental annotations include specific ligands for which experimental evidence has not been attributed to homologues.

for another example, the non-experimental set contained a go id which did not appear with experimental support as the annotation of any homologue: peptidyl-prolyl cis-trans isomerase activity . the protein fkbp9_mouse is annotated with this function with the evidence code iea. however, a literature search revealed that shadidy et al. reported in  <dig> that fkbp9_mouse contains an ef-hand domain and showed experimentally-measured peptidyl-prolyl cis-trans isomerase activity  <cit> . the annotation correctly assigned the function but did not report that the assignment was grounded in experimental evidence.

such observations persuaded us to leave the experimental/non-experimental comparison at the qualitative level. we conclude that the results of figure  <dig> based on a mixture of experimental and non-experimental annotations:  probably underestimate, to some extent, the extent of divergence of protein function as a function of amino acid sequence divergence, and  probably overestimate, to some extent, the danger of introduction of error in annotation transfer.

 <dig>  
CONCLUSIONS
 available data permit a quantitative study of the relation between divergence of sequence and divergence of function in proteins, based on the gene ontology functional classification.

 sequence divergence is generally accompanied by higher likelihood of divergence in function, although the phenomenon of recruitment provides exceptions in which proteins of similar sequence can perform very different functions.

 there is a threshold at about 50% sequence similarity below which function divergence is enhanced. this is consistent with the conclusions of the previous authors, who used the ec functional classification.

 if we were given only the amino acid sequence of a protein of unknown function, and asked to estimate the probability that transferring annotation from the closest homologue in the databanks would not lead to annotation errors, we would base the answer on the distribution of similar and dissimilar functions in homologous proteins only. the variation among different families suggests that it is worth looking at the families individually. this is consistent with the conclusions of ranea et al.  <cit> , who also observed that families evolve at different rates depending on their functional class.

 databases are prone to error, because the recording of experimental sources of functional annotation is a labor-intensive human activity, and because once introduced, errors tend to propagate. given the very crucial importance of annotation in biomedical research, the development of objective methods for quality control and correction of annotations in databases have been recognized as essential  <cit> .

 <dig>  methods
sources of data
we downloaded the gene ontology network file from the go consortium website  <cit>  and pfam domains from the washington university, st louis, pfam server. the march  <dig> release of pfam contained  <dig> protein families. pfam contains seed and full alignments of proteins in each family. we used the seed alignments, which are high-quality alignments that do not change substantially between releases. pfam uses these alignments as the basis for doing full alignments for the respective pfam families  <cit> .

the pir database at georgetown university provided the go ids for each protein. pir presents go ids in molecular function, biological process and cellular component categories. we used only the molecular function assignments.

preprocessing
for each protein we identified the distal go id in its annotation set. a distal go id is the go id included in the annotation of the protein, for which no more specific  go id is part of the annotation of the same protein. for example, suppose that in some data base a protein is given as its functional annotation three go ids:  <dig> ,  <dig> , and  <dig>  . go id  <dig> is a descendant of  <dig>  in this chain of descent in the go graph,  <dig> is the more precise annotation, distal to  <dig>  however,  <dig> is not in the same chain of descent. from these annotations we would retain only go:  <dig> and go: <dig> as distal go ids.

as working data then, for every protein domain we had an amino acid sequence , and the distal go id . for each pair of proteins in each family, we measured the similarity of the sequence and function.

calculation of sequence similarity
we aligned amino acid sequences by the standard dynamic programming algorithm using the blosum  <dig> matrix  <cit> . we used the alignment program muscle  <cit> , with default gap weighting. a comparison of sequence similarities computed from muscle pairwise alignments with values computed from the alignments inherent in pfam showed that the differences were generally so small as to make no significant differences in the results presented . we note that the pairwise sequence alignment approach provides a measure of sequence similarity that is stable and independent of any realignment or reclassification that pfam may adopt.

calculation of functional similarity
we represented the functional divergence of the two proteins by the distance between their sets of annotations; that is, between the sets of distal go ids assigned to each protein. the measure of the distance between sets of annotations was based on a measure of the distance between individual go ids. we defined the distance between two individual go ids as the number of edges in a minimal-length path between the two nodes in the go dag that passes through the lowest common ancestor of the two nodes. based on this, we needed to define a measure of distance between sets of distal go ids, as might appear in the annotation of a protein with multiple functions.

there are several possible ways to assign a metric to the go dag. because there is no natural metric, we have chosen one that appeared suitable after being guided by consideration of specific simple cases . in each case we are comparing one protein, with one or more annotations labeled x, to another protein with one or more annotations labeled o.

case  is the simplest: each protein has one annotation and the minimum path length between them has length  <dig>  the distance function should report this value.

in case , each protein has two annotated functions, appearing on two branches of the graph. however, the two proteins show similarity of both functions: for each x there is an o at distance  <dig>  although the distance between the leftmost x and the rightmost o is  <dig>  it does not seem reasonable to report a functional distance of  <dig> between these two proteins. therefore it would not be suitable to define a distance function as the set of minimal path lengths between every x, o pair.

in case , one protein has two annotated functions but the other has only one. the proteins share a similar function: the rightmost x and the o have distance  <dig>  however, in this case, compared to , it is relevant that the distance from the leftmost node labeled x to the closest node labeled o is  <dig>  this is a genuine difference between the annotated functions of the two proteins. it may be that protein x was recruited for a novel function not similar to the function of protein o. it is also possible that protein o shares the other function with protein x but is not so annotated. in any event, the distance function should report both  <dig> and  <dig>  this implies that it would not be suitable to define a distance function as the minimum x-o distance for all x-o pairs.

we therefore adopted the following definition of the difference in functional annotations between two proteins, x and o. for each distal go id x, we determine the minimum distance to all the distal go ids o, and for each distal go id o, we determine the minimum distance to all the distal go ids x. this set of values represents the distance between the annotation sets x and o. in the cases shown in figure  <dig>  the distances reported would be:   <dig>    <dig>   <dig>    <dig>   <dig>   <dig> 

any classification scheme may vary in the fineness with which it distinguishes different regions of its domain. because for protein function  there is no natural metric, there is no direct way to calibrate distances between nodes in either the ec or go classifications. the problem is somewhat more acute for the go classification because of the variable depths of the dag. we explored the possibility of "normalizing" the go distances according to the local depth of the dag, but were unable to do this in a consistent way, largely because of the non-uniqueness of the lengths of the paths from any node up to the root.

in order to demonstrate that the problem will not seriously affect the results in at least most cases, we did the following calculation: for all distal nodes in the go dag  we determined the minimal-length path from the root to the distal node. the result was that for 85% of the distal nodes, the minimal path lengths to the root were between  <dig> and  <dig>  for these cases any reasonable "normalization factor" will vary only between  <dig>  and  <dig> . nevertheless, for the particular application: "given a novel sequence, what is the likelihood of error in transferring annotation between homologues?" we explicitly recommend a homologous-family-by-homologous family approach, in which one would in most cases be comparing functions in similar sections of the go dag. for these, the fineness of the distinctions between related functions would be comparable, and the differences in overall depths of different nodes would be a controlled quantity.

authors' contributions
all authors together conceived and designed the experiments, analyzed the data, and wrote the paper, with vs taking the leading role. vs and aml wrote required software and ran the computations.

supplementary material
additional file 1
comparison of sequence identity between the pair-wise 'muscle' alignments and the multiple sequence alignments provided by pfam. the data provides a comparison of sequence identity between the pair-wise 'muscle' alignments and pfam alignments.

click here for file
