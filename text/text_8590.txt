BACKGROUND
single nucleotide polymorphisms  are fast becoming the markers of choice for genome-wide linkage scans, loss of heterozygosity , comparative genomic hybridization  and whole-genome association studies  <cit> . this is due to the existence of high throughput technologies like the genechip® human mapping array from affymetrix coupled with the abundant and uniform distribution of snps throughout the human genome  <cit> . the genechip® mapping array relies on the hybridization of biotin-tagged fragments of snp-containing dna to complementary dna oligomers chemically tiled on a silicon wafer in order to genotype  <dig>  snps with a mean inter-marker spacing of  <dig> kb  <cit> . the assay utilizes a relatively minor amount of genomic dna  and a series of reactions called fragment selection by pcr . the fsp reactions involve an xba i restriction enzyme digest of genomic dna followed by a universal adaptor ligation step and then pcr using parameters designed to selectively amplify dna less than  <dig> kb in size. after purification, the pcr products are digested to a size of ~ <dig> bp with dnase i, end-labeled with biotin, and hybridized to the microarray wafer.

successful hybridizations are detected fluorescently using a streptavidin-phycoerythrin conjugated molecule and an antibody-mediated signal amplification technique. each snp is interrogated in both the sense and antisense direction by multiple "quartets" of 25-mer oligonucleotide probes. these probe quartets consist of both perfect match  and mismatch  conformations for the major  and minor  snp alleles being investigated. snp genotype calls are ultimately made using the integration of fluorescent signal intensities at each location across the quartets.

to make each individual snp genotype call the affymetrix software employs a key mathematical filter, a feature extraction calculation, and finally fits each snp into a trained statistical model. we will briefly review the affymetrix calling approach on affymetrix 10k mapping array. a more detailed description is available through affymetrix or through previous publications  <cit> . the mathematical filter is termed the detection filter, which essentially determines if the mm fluorescence signal is greater than the pm signal. such a result indicates a general inability of the tiled oligonucleotides to resolve the snp from the background of mismatches whose sequences are nearly identical. snps that pass the detection filter are further utilized for feature extraction. it is during this calculation that the fluorescent signal intensities at each location on the microarray are indexed to calculate relative allele signal  values. two ras values are calculated for each snp, one using the sense  probes and a second using the antisense  probes. the basic equation for ras is as follows: ras = a/, in which a represents the relative fluorescence intensities at the pm spots for the major snp allele subtracted from the mm spots while b represents the same values for the minor allele. when plotted, the ras <dig> and ras <dig> values are used to infer a genotype call. for example, if a snp has ras <dig> and ras <dig> values near  <dig>  then the genotype call should be bb. if the ras values are near  <dig>  the genotype is aa. unfortunately, the ras values and the acceptable variance in each must be determined empirically for each snp. affymetrix genotyped  <dig> ethnically diverse dna samples and utilized the corresponding ras scores in a modified partitioning around medoids  classification algorithm to delimit the boundaries of call silhouettes or zones for each snp  <cit> . these call silhouettes are essentially statistical models for each snp genotype based on the classification results of the training data set. they are used to make future experimental genotype calls. for further in-depth description of how calls are made on the 10k genechip® array, see the manuscript by liu et al.  <cit> . if a snp's probe intensity values do not pass the detection filter score  or the ras scores fall outside the boundaries of the statistical model then the snp is assigned a "nocall" value. the overall call rate of a sample is equal to the number of snps receiving an aa, ab, or bb genotype call divided by the total number of snps on the chip.

after completing thousands of 10k genechip® assays it is clear that even in samples with the highest overall call rates there are some snps consistently called less than other snps. in this article we report that infrequently called snps on the genechip® mapping 10k  <dig>  array are primarily due to problems associated with the boundaries of the statistical model call zone and therefore are related to suboptimal training of the mpam algorithm for those particular snps. we detail the creation of an application, sniper, which utilizes two training-based clustering algorithms to increase overall call rates thereby increasing the amount of usable genotype data on each chip.

RESULTS
identification and characterization of poorly behaving snps on the 10k genechip®
in order to identify those snps that frequently result in a "nocall" on the 10k genechip® we compiled a database of  <dig> individuals that were genotyped in the last two months in our laboratory. the call rate of these samples was required to be greater than 90%. the frequency at which each snp was not called – the "nocall" rate – was calculated . snp identifiers and their observed "nocall" rates are included as additional file  <dig> and can be downloaded directly from our supplementary data site  <cit> . an arbitrary "nocall" rate of 25% across the entire sample set was used to identify snps considered to be poor performers. the percentage of poorly performing snps on each chromosome as determined by the affymetrix mpam algorithm and the sniper algorithm are detailed in figure  <dig> 

to investigate why certain snps behave poorly we examined four parameters: detection filter scores , g-c content of the tiled probe, pcr amplicon size, and the distribution of calls for each snp in relation to the statistical model call zone. comparison of the ds values clearly indicated that when well-performing snps  fail to be called they do so primarily because of the detection filter, while the majority of poorly performing snps fail for other reasons. for snps with "nocall" rates less than 25%, the average "nocall" rate was determined to be  <dig> % ±  <dig> % and the detection filter failure rate  was  <dig> % ±  <dig> %. alternatively, for snps with "nocall" rates greater than 25%, the average nocall rate was  <dig> % ±  <dig> % and the detection filter failure rate was only  <dig> % ±  <dig> %. failure of the detection filter causes ~50% of the total failures for the top performing snps but only ~25% of the total failures for the worst performing snps. probe g-c content was not found to impact call rate. interestingly, pcr amplicon size does play a role in the frequency at which a snp is called. the affymetrix specified pcr cycling parameters favor the production of amplicons less than  <dig> kb. the average amplicon size for the top  <dig> worst performing snps was  <dig> bp ±  <dig> bp while the  <dig> best performing snps were found on amplicons of  <dig> bp ±  <dig> bp . this finding underscores the fact that degraded sample dna will result in lowered call rates, especially for those snps residing on larger sized amplicons. however, the samples used in our study consisted primarily of genomic dna of high quality as determined by agarose gel electrophoresis. therefore, while amplicon size can be linked to call rate, further investigation yielded that the more critical factor is the location of the mpam model silhouette for each snp. as indicated above, snp failure of the detection filter is not the primary reason that the worst performing snps are not called. as an example one can look at the twenty worst performers. only six of these snps fail the affymetrix detection filter in at least one-third of the samples. visual inspection of the gdas call zones for the remaining snps suggests that the majority of the other poor performers are due to inadequate localization of the particular snp model silhouette, a probable result of inadequate training of the affymetrix mpam algorithm for these snps. in other words, the ras1/ras <dig> intersection point was closely clustered for the snp allele but still resulted in a "nocall" because this cluster was primarily located outside the boundary of the silhouette. we were also able to find examples of widely varying ras <dig> values in conjunction with tightly clustered ras <dig> values and the opposite case as well. these findings are illustrated in figure  <dig> 

sniper as a tool to call poorly performing snps
the ability to call these poorly performing snps was investigated using the algorithms discussed in the methods section. through the use of real-time clustering we were able to decrease the average overall "nocall" rate from  <dig> % ±  <dig> % to  <dig> % ±  <dig> % . this was achieved by maintaining a  <dig> % ±  <dig> % genotype concordance compared to the affymetrix genotypes . mendelian inheritance error was assessed using individually genotyped trios and was found to be comparable to the mpam accuracy .

discussion
in this article we identified  <dig> snps with "nocall" rates of 25% or greater on the genechip® 10k mapping array. additionally, we report the application of clustering algorithms to call these poorly performing snps at an increased rate without significantly compromising the concordance.

in regard to linkage studies on the 10k genechip®, the consequences of accurately adding 10% of snps which were previously not calculated include improved information content and filling gaps in the genetic map. as figure  <dig> illustrates, the mpam algorithm poorly calls over 18% of snps on chromosome  <dig>  in fact, there are two stretches of snps on chromosome  <dig> where  <dig> out of  <dig> adjacent snps are poor performers. additionally, chromosome  <dig> has the highest gene density of all human chromosomes, more than double the average for all other chromosomes  <cit> . it is unfortunate that this chromosome contains the lowest density of snps of all the autosomes on the 10k genechip® platform. importantly, only 2% of the snps on chromosome  <dig> exhibit "nocall" rates greater than 25% after running the samples through the sniper algorithm.

there are  <dig> regions in the genome where three consecutive snps exhibit "nocall" rates greater than 25% of the time, three of these regions occurring on chromosome  <dig>  processing of samples using the sniper algorithm resolves this issue. after running sniper the highest number of poorly performing neighboring snps is  <dig> in a window size of  <dig> and there now exists no regions in the genome with consecutive snps with "nocall" rates greater than 25%.

interestingly, it appears that snps can fail the mpam calling algorithm in four different ways. a widely dispersed ras <dig>  or ras <dig>  value can lead to a poorly performing snp. tightly clustered ras <dig> and ras <dig> values complemented with an inadequately trained call zone  are the more frequent reason a snp performs poorly. also, a small percentage of snps fail to elicit clustered ras scores for no clear systematic reason .

even though the genomics community is moving towards denser snp genotyping platforms for both linkage and association analysis there are still a large number of funded studies currently being performed using the 10k genechip. for this reason it still remains important to improve upon the performance of the assay whenever possible. additionally, even though the sniper algorithms detailed in this manuscript were designed for use on the 10k genechip® it could be applied to the denser genotype platforms from affymetrix with little modification. one future direction of study may include the comparison of the sniper algorithm with the dynamic modeling algorithm currently in use on the 100k and 500k genechips.

CONCLUSIONS
snps called less than 75% of the time occur at a frequency of 8% on the genechip® 10k mapping array. while there is a relationship between frequency of calling and pcr amplicon size we have concluded that the primary reason for a high "nocall" rate is inadequate training of the calling algorithm. these poorly performing snps could play a confounding role in linkage analysis studies especially on chromosomes  <dig>   <dig>  and x, where the proportion of poorly performing snps is greater than 10% of the total interrogated snps on the entire chromosome. the sniper algorithms now successfully call these poorly performing snps, resulting in increased performance of the 10k genechip.

