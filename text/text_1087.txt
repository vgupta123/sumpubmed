BACKGROUND
in order to understand how a protein network gives rise to a cellular function it is essential to quantify the states of the involved proteins and their causal relations. however, it is actually not possible to strictly define out of the proteome the subset of all proteins which are involved in a certain cellular process since these will always have interactions with proteins not included in this subset. in spite of major advances in proteomic  <cit>  and cytometric  methods, quantification of the levels and post-translational modifications of all proteins of the proteome in the same cell is still beyond reach. therefore, we fundamentally cannot observe the whole system at once  but only a small part of it   <cit> . this limit, by itself, could have been overcome by looking at different parts of the system in different cells and building a model of the whole system step by step. however, such a strategy is fundamentally hampered by natural cell-to-cell variability which makes the integration of information highly challenging. several studies have addressed the challenge of network reconstruction in the presence of intrinsic and extrinsic noise  <cit>  around one prototypic network structure . however, in many physiological cases the cell-to-cell variance is not only due to noise around one cellular state but also due to subpopulations which are in qualitatively distinct types of states. such qualitative variabilities within the same cell population are generated by epigenetic commitment of cells to different fates  as well as by genetic alterations  as in cancer  <cit> . in many cases the distinct cell subpopulations are spatially intermixed and therefore are harvested together and co-measured within the same sample . in such cases, causal relations and correlations between measured proteins can be qualitatively different in different cells if they are mediated by non-measured proteins which have different states at each subpopulation. therefore, integration of observations over the cell population toward one model would be invalid and will yield uninformative average relations . ultimately, in order to solve this fundamental problem one should identify the number of qualitatively different subpopulations in the data, thus unmix the cells in-silico and resolve separately for each subpopulation the relations between the measured proteins. a recent work suggested to use a mixture model to unravel subpopulations in biochemical systems based on ordinary differential equations and prior knowledge about the number of subpopulations as well as about kinetic constants underlying the differences between them  <cit> . in this work we developed a bayesian method for achieving this goal without such prior knowledge.
fig.  <dig> unpbn addresses the challenge of studying intracellular protein networks caused by unmeasured proteins and inter-cellular heterogeneity. a a biochemical system for which three proteins  are being measured in the same cell while the other proteins are unmeasured. note that the effects of z on x are mediated by unmeasured proteins . b depending on the level and state of these unmeasured proteins, the measured causality between x and z can differ qualitatively between cells. for example, normal and cancer cells have different activity levels of oncogenes and tumor suppressors which here lead to a negative or a positive causal effect of z on x, respectively, thereby to a controlled growth or a constitutive growth. c left, multiparametric high-throughput single-cell measurements  of a heterogenous sample of cells . middle, attempts to statistically infer a single set of relations  between the measured proteins fail because there are two distinct subpopulations having two distinct sets of relations. at the same time, it is also impossible to identify the two distinct subpopulations as two distinct proximity-based clusters. right, unpbn performs unmixing and inference of statistical relations as one process, thus finds the set of sets-of-relations  that explains best the observations



to unmix observations of cells from different subpopulations, we are taking advantage of the high-dimensionality of the observations, as typically obtained from cell-based high-content measurements such as flow-cytometry  <cit> , mass-cytometry  <cit>  and toponome imaging  <cit> . within each subpopulation, stochastic cell-to-cell variability in protein expression levels gives rise to high-dimensional probability distributions with the same dimensionality as the number of biochemical species  measured in each cell. to this extent, network inference approaches, like gaussian bayesian networks  , to resolve a single statistical model that fits best the data, have been already developed . in this work we use as a basis our previously described nonparametric bayesian network analysis  and expand it to allow for different network structures in a mixture of different cell subpopulations . in this method, termed hereafter unmixing-via-npbn , a flexible number of gaussian bayesian networks is being fitted to the data and thereby iteratively identifying the number of distinct subpopulations, unmixing the observations and resolving the statistical model for each subpopulation. as a model system to assess and demonstrate our method we simulated the canonical mapk raf-mek-erk kinases cascade in the context of pc <dig> cells stimulated by either epidermal growth factor  or nerve growth factor   <cit> . we show that our method identifies better than common clustering approaches the presence of two subpopulations within a mixture of egf and ngf stimulated pc <dig> cells based on the levels of active raf, mek and erk in each cell. this enabled to resolve correctly the statistical relations between raf, mek and erk in each subpopulation.

methods
simulation
the egf and ngf signaling network was simulated based on a previously described model  <cit> . the sbml format of this model  was imported into the matlab symbiology platform to simulate the dynamics of the signaling network using ode15s  solver. to introduce intra-subpopulation cell-to-cell variability , for each run of the simulation we sampled the values for the total raf, mek and erk levels from a normal distribution n around the respective initial concentration for a given set of fractional deviation from the mean . the values of fd represent here the degree of stochastic variance in the expression levels of raf, mek and erk. simulations were repeated  <dig> times with random sampling of total raf, mek and erk levels to generate the data for each cell subpopulation. in each individual simulation repeat, the response of the network to egf or ngf was simulated for  <dig> seconds after stimulation and the levels of c-raf-ras-gtp , ppmek and pperk  were sampled every  <dig> minute as the observed parameters for the unmixing analysis. mixtures containing two distinct cell subpopoulations were generated by mixing an equal number, unless indicated otherwise, of simulated observations obtained upon egf and ngf stimulations. mixtures containing four distinct cell subpopoulations were generated by altering the parameter in the sbml model corresponding to the catalytic activity  of mek  from its wild-type  value  to a value depicting a mutant mek  with a lower activity . thus, by having two different stimulations and two different levels of mek activity, observations of four distinct cell subpopulations were generated: egf-mek wt, egf-mek mut, ngf-mek wt and ngf-mek mut .

unpbn
methodologically, unpbn is based on the nonparametric bayesian networks  approach  <cit> . it allows to avoid the assumption of underlying gaussian distributions for the data and to find networks with nonlinear relations between the nodes. the unpbn method combines a nonparametric mixture model incorporating the dirichlet process  <cit>  and an allocation sampler  <cit> . prior to the description of the unpbn approach a short introduction of gbns  <cit>  is provided here, as they are a basis of the presented method. we define the data x, consisting of n observations of a system/network with d species/nodes , such that xj represents an n-dimensional vector containing the observed concentrations of the j species . in the bayesian networks approach the relations between the nodes in a graph g are modeled as conditional probability distributions  p. if the cpds for all nodes in g are given by normal distributions of the form xj|pag∼n,σj2), where pag denotes the parents of node xj, kj={k|xk∈pag}, the μj and σj <dig> are the unconditional means and variances of xj, and βj,k are real-valued coefficients determining the influence of xk on xj, and, if in addition, g is a directed acyclic graph  then the pair  is called a gbn. the network structure is inferred using gaussian distributions with a normal-wishart prior  <cit> . the estimation of g is embedded in a markov chain monte carlo  framework, conducted by maximizing the sampling distribution of the sampled graph 
 lg|x=∏j=1d∫lσj <dig> βj|x{j}∪kjpσj <dig> βjdσjdβj, 

with βj=,=b and x denotes the columns of x with indices in j. the mcmc algorithm uses so called single edge operations  <cit> .

unpbn generalizes the gbn approach as it is based on flexible nonparametric bayesian mixture models for networks  <cit>  which in turn combine different gbns for different subsets of the data. the mixture is taken with respect to all parameters . the model for the data can be written as p=∫pdp with μ and σ vectors of the unconditional means μj and variances σj <dig>  respectively. the discrete mixing measure p is distributed according to ℙ, a random probability measure, and p is a multivariate normal distribution with a conditional independence structure compatible with g. according to the discrete nature of p, support points μh,σh,bh,gh and probabilities wh, the mixture can be written as 
 p=∑h=1nwhp. 

the prior distribution of the mixing weights wh is assigned by p and the prior for μh,σh,bh,gh is given by the base measure p <dig> of ℙ for all h. the n different mixture components h can be interpreted as subpopulations in the data set. accordingly, here such subpopulations are referred to as components. the assignment of each data point to its corresponding component is described by the allocation vector l=′  <cit> .

the network structure g and the allocation vector l are the main focus of our unpbn procedure. the remaining parameters μh, σh and bh are integrated out and the mcmc algorithm iterates by updating the dag g, the number of components n and the latent allocation vector l, leading to the posterior distribution 
 p=∏h=1nl)pnpp, 

where l=∫lpdσdb is the marginal sampling distribution for g, pn is a probability distribution on the space of allocation vectors, p is the distribution of the number of components and ih={i∈{ <dig> …,n}|li=h} and x denotes the rows of x with indices in i.

in our unpbn analysis a prior is needed for θh= and for w <dig> …,wn. for gh the prior which was used is uniform over the cardinality of the parent sets  <cit> , for σh and bh we employed the normal-wishart prior distribution with the identity matrix as the precision matrix and d+ <dig> degrees of freedom. the mean vector of the multivariate normal distribution  was chosen as a vector of zeros. for n we used a poisson distribution with parameter λ= <dig> and the wh were obtained from a dirichlet distribution with parameter vector  with α= <dig>  further details for the sampling distribution, posterior distribution and the mcmc sampling scheme were discussed in previous publications  <cit> . the approach is implemented in matlab . the presented results are obtained from mcmc runs with  <dig> · <dig> iterations with a thinning of  <dig> and a burn in of  <dig> · <dig> iterations for networks with two subpopulations and from runs with 5· <dig> iterations with a thinning of  <dig> and a burn in of 2· <dig> iterations for networks with four subpopulations.

postprocessing of graphs
although it is possible to use the output from the unpbn analysis directly, for example to choose the most frequent dag or allocation vector as a representative, it is preferable to perform an additional postprocessing step that takes into account all mcmc samples and improves the results considerably. the inferred graphs in the iterations of the mcmc simulation are stored in the form of adjacency matrices. such a matrix a consists of the elements aij, aij= <dig> if nodes i and j are conditionally dependent  and aij= <dig> if nodes i and j are conditionally independent  or if i=j. for each pair of nodes the mcmc output of the unpbn analysis can be summarized by the posterior edge probability pepij=∑s=1raijs/r where s is the index of the r iteration steps in the mcmc simulation. the resulting pep number ranges from  <dig>  to  <dig> . these pep values are used in fig.  <dig> for the presentation of the obtained results.
fig.  <dig> simulations of the egf and ngf signaling network in pc <dig> cells. a the simulated protein network, as previously described  <cit> . the elements  that are unique to either egf or ngf are colored red and green, respectively. the components that we later consider as the measured components of that system  are colored grey. b a 3-dimensional scatter plot showing the normalized levels of active  raf , mek  and erk  versus each other at  <dig> minutes after ngf  or egf  stimulation with noise level of  <dig> . c the same as b but for  <dig> minutes after stimulation. d time profiles of praf, ppmek and pperk levels as a function of time after ngf  or egf  stimulations, without noise  or with  <dig>  noise level 

fig.  <dig> unmixing observations of a mixed cell population by unpbn in comparison to clustering approaches. a mixtures of observations of egf and ngf stimulated cells with different noise levels were generated as described. observations were sampled at one-minute intervals for  <dig> minutes after stimulation. for each noise level and sampled time point, observations were unmixed using unpbn, k-means clustering  and hierarchical clustering . the percentages of correctly allocated observations, averaged over all time points, are indicated by boxplots for the different methods as a function of the noise level . b comparison of the unmixing accuracy with noise level  <dig>  along the different sampled time points, as achieved by unpbn, post-processed unpbn limited to two components, k-means  and hierarchical clustering 

fig.  <dig> the success in identifying the correct number of distinct cell subpopoulations  in a mixture by unbpn in comparison to clustering approaches. a a boxplot showing the asw versus the tested number of components obtained by unbpn analysis  of a mixture of two subpopulations . the boxplot indicates the median , the  <dig>  and  <dig>  quartiles , margined by the largest and smallest data points which are still within the interval of  <dig>  times the interquartile range from the box , and the outliers  obtained from pooled values over all time points with noise level of  <dig> . b and c, the same as in a but for asw obtained following k-means clustering and hierarchical clustering, respectively. d, e and f, the same as the corresponding a, b and c, but for a mixture of  <dig> subpopulations: egf-mek wt, egf-mek mut, ngf-mek wt and ngf-mek mut . it should be noted that silhouette widths are incomparable between different clustering approaches. however, silhouette widths are comparable between different parameters of the same clustering approach and thereby indicate the identified number of distinct subpopoulations as the one providing the largest asw

fig.  <dig> recovering correctly the edge probabilities network between praf, ppmek and pperk for each cell subpopulation in a mixture by unpbn. the triangles show, color encoded, the posterior edge probabilities between praf, ppmek and pperk at different time points after stimulation as derived by unpbn analysis of pure ngf-stimulated or egf-stimulated cell populations  with noise level of  <dig>  and of a mixture of these populations by gbn versus unpbn . note, for the pure subpopulations, the changes in the edge probabilities between the same components at different time points and upon the different stimulations. analyzing a mixture of ngf-stimulated or egf-stimulated cells without unmixing yields uninformative average edge probabilities, not representing any of the distinct two subpopulations. employing unpbn recovers precisely the pure edge probabilities for each of the two subpopulations. for clarity, we show here the edge probabilities for  <dig> time points after stimulation that illustrate the need for unmixing



postprocessing of allocations
for the allocation vector, however, it is not possible to summarize the sampled vectors in the same way as for the edges, because of the so called label switching problem. during the sampling procedure the labels of the components change randomly, so that if two allocation vectors are compared it is not clear if a particular observation has been allocated to a different component or if the label of the component has changed. we employed a method based on maximizing the adjusted rand index that bypasses this obstacle and that combines the allocation vectors of each mcmc iteration into one single vector  <cit> . this method is implemented in r  <cit>  in the package ’mcclust’ and was used in cases where it was necessary to fix the number of components to a particular value . in cases where the analysis is focused on the unmixing performance of unpbn , the sampled allocation vectors are evaluated regarding the homogeneity of the resulting components. for each entry lis,h in the allocation vector sampled in iteration s, in each component h, the true component is determined by comparison with the simulation setting. based on this, componentwise, observations originating from the same true component are considered as allocated correctly,  while the remaining observations in that component are considered as wrongly allocated . the percentage of correctly allocated observations  for a particular unpbn outcome is derived by 
 pco=1r∑s=1r1ns∑h=1ns1nhs∑i=1nhsilis,h· <dig> 

with r considered mcmc iterations, size nhs of component h in iteration s and ns number of components in the allocation vector in iteration s.

cluster analyses
in order to compare unpbn with clustering methods, k-means and hierarchical clustering were used in this work. the k-means clustering method finds the partition that divides the data to n clusters  such that the sum distances of all observations to the corresponding cluster mean is minimized  <cit> . the k-means cluster analysis was performed in matlab, using the function “kmeans” with the distance parameter being set to squared euclidean distance. to obtain stable results, the clustering was repeated  <dig> times with randomly chosen different starting points. hierarchical clustering is an agglomerative procedure which merges in each step the two closest objects, repeatedly till the whole data set is in one single cluster. the hierarchical clustering was performed in matlab using the functions “pdist”, with the distance parameter being set to euclidean, followed by “linkage”, with the method parameter being set to inner squared distance .

silhouette analysis
we used the average silhouette width   <cit> , to assess the quality of a given clustering and to compare the results of clusterings with different parameter settings. for a given clustering result, the silhouette value is calculated as 
 sil=b−amax{a,b}. 

for each observation, xi, a is the average dissimilarity between xi and all other data points within the same cluster, and b is the smallest average dissimilarity between xi and the data points in the remaining clusters, calculated for each cluster separately. any measure of dissimilarity can be used, but distance measures are the most common. in this work the euclidean distance was employed. the silhouette value is ranging between - <dig> and  <dig>  negative values indicate that a particular observation will fit better in another cluster, so it has been matched wrongly and the quality of the clustering result can be improved. high positive values indicate a good clustering result. the asw is computed by averaging all sil values, thus it provides an overall evaluation of the regarded clustering. while asw enables to compare clustering performed with the same method with different parameters, asw values are not comparable between different clustering methods.

RESULTS
simulation of inter and intra cell-population variabilities
in order to evaluate the performance of the method we simulated the mapk module in pc <dig> cells using a previously described model  <cit> . this model captures the different temporal profiles of erk activation upon egf and ngf stimulation, attributing it to the differential activation and dynamics of ras and rap   <cit> . both stimulations activate via sos and ras the upstream kinase, raf and thereby the whole mapk cascade. however, each stimulation has a different effect on other proteins which affect the mapk module and its dynamics. in egf stimulation, erk inhibits sos and thereby forms a negative feedback loop leading to a transient erk activation which encodes a proliferation signal. in ngf stimulation this negative feedback is overcome by a nested positive feedback loop  <cit>  formed due to the activation of pkc δ which phosphorylates rkip and thus leads to its release from raf and thereby enabling raf activation by erk. the model used here considers another difference attributed to a sustained activation of another activator of the mapk cascade, rap <dig>  by ngf but not by egf  <cit> . thus, ngf leads to a sustained erk activation, encoding a signal for differentiation. as a source for inter-population variability, we simulated the dynamics of the complete network upon either egf or ngf stimulation. for the aim of this work, we based our analyses on snapshots of the simulation, and, in turn, analyzed each time point independently. as a source of intra-population variability , we added stochastic noise in total protein levels mimicking natural cell-to-cell variance in protein expression . however, unlike instrumental noise that only affects the readout, noise in expression levels affects the system itself. thus, although the introduced noise was generated as gaussian, its propagation through the system generates asymmetric high-order patterns shaped by the topology of the network .


in the absence of noise, the levels of phosphorylated  raf, mek and erk follow the expected profiles, exhibiting a clear difference between egf or ngf stimulations . with intra-population variance, the profiles get broader and overlap between the two stimulations , making it difficult to allocate individual observations to the corresponding stimulation . to impose the fundamental experimental limit of observing only part of the system, for the subsequent analysis we considered an observation to be the triplet formed by the concentrations of phosphorylated species of raf, mek and erk per cell, ignoring all other information. finally, to generate heterogeneous cell-populations, we mixed observations randomly selected in equal amounts from the egf and ngf datasets.

unpbn unmixes observations of distinct subpopulations
we first wanted to test whether unpbn can classify correctly observations coming from distinct cell subpopulations. we applied unpbn on mixed cell populations having different levels of noise and counted the observations correctly allocated to the egf and ngf stimulated subpopulations . for noise levels of  <dig> ,  <dig>  and  <dig> , around  <dig> %,  <dig> % and  <dig> % of the observations are correctly allocated, respectively . to assess the accuracies of unpbn, we compared them to those achieved by two widely used clustering approaches - hierarchical clustering and k-means clustering. when the noise is low , the two subpopulations are well separated by all methods . as expected, the performance of all three methods is negatively affected when the noise level is increased. however, the unpbn considerably outperforms the other reference methods for all noise levels above  <dig>  . if the relative abundance of the two subpopulations is 1: <dig>  all methods classify about equally well for a low noise level , while for a high noise level  unpbn classifies as good as k-means but better than hierarchical clustering .

we next focused on the high noise level of  <dig>  and compared the performance of the methods as a function of time after stimulation . along the different time points the performance of all methods varies, reflecting a changing difficulty to identify the two subpopulations based on the levels of praf, ppmek and pperk. unpbn constantly outperforms the clustering methods in all the time points and is more robust with its performance level . furthermore, the performances of the two clustering methods along the time points have a similar profile, which differs from the profile of unpbn . these results are consistent with the fact that, unlike the clustering approaches, unpbn uses high-order patterns, rather than merely distances between observations. this additional information is shown here to be indeed valuable for the ability to unmix subpopulations based on high-dimensional observations.

unpbn identifies the number of subpopulations in a mixture
in many cases, when a sample of cells is derived it is unknown a priori how many distinct subpopulations it contains. therefore, a comprehensive unmixing approach should also be able to identify the number of subpopulations without such a priori knowledge. indeed, while the clustering approaches were guided to search for two subpopulations, unpbn was not given this information but found it independently . moreover, the performance of unpbn does not change significantly if it is forced to identify exactly two subpopulations, indicating the ability of unpbn to correctly determine by itself the number of distinct subpopulations in a mixture .

in order to compare the capability of the different methods to identify the number of subpopulations we used the asw to determine the quality of the clusters and thereby the number of clusters  in the data as could be inferred by each method  <cit> . the asw of a cluster is a measure of how tightly grouped are the data points in the cluster, such that larger asw values denote tighter clusters. for a cell population containing two subpopulations  we calculated the asw as a function of the number of clusters derived by unpbn , k-means and hierarchical clustering . for unpbn and k-means clustering, the maximal asw is found when the number of clusters is  <dig>  the actual number of subpopulations in the data . however only in unpbn there is a significant and robust difference with the other cluster sizes, while with k-means clustering the asws obtained for  <dig> and  <dig> clusters are not robustly separable. with hierarchical clustering the performance is further worse since asws obtained for  <dig> and  <dig> clusters are comparable, or even higher than those obtained for  <dig> clusters . unpbn successfully identified the number of subpopulations also if their relative abundance was significantly different .

we next tested the performance of the method with a more complex mixture of cells containing four distinct subpopulations. to simulate these subpopulations, the catalytic rate constant, kcat, of mek in the model was changed, mimicking a wild-type mek  and a mutant mek  that phosphorylate erk at different rates. thus, together with the two different stimulations, egf and ngf, four distinct subpopulations were generated, denoted by egf-mek wt, egf-mek mut, ngf-mek wt and ngf-mek mut . unpbn correctly identified that the data contains four distinct subpopulations, in contrast to k-means and hierarchical clustering .

unpbn uncovers distinct topologies for distinct subpopulations
the causal relations between the components of a system are constant, since the set of biochemical reactions and constants that describe the whole system remains constant. however, in practice, only part of the components of a system can be co-measured and therefore the reaction constants become apparent constants that depend on the unmeasured components. here we intentionally simulated the fundamental limit of looking on only a small part of a system. therefore we expected the apparent strength of the causal connection between praf, ppmek and pperk, as reflected by the undirected posterior edge probabilities among them, to change as a function of the stimulation and time. indeed, when we analyzed separately egf and ngf stimulated cells we observed different posterior edge probabilities between the two treatments, as well as within each treatment at the different time points . when analyzing the mixed population with a standard gbn approach   <cit> , we obtained posterior edge probabilities exhibiting, in general, an average behavior of the two subpopulations. naturally, these average values become meaningless when the two subpopulations exhibit very different posterior edge probabilities . in contrast, when analyzing the mixed population with unpbn , the unmixing step enabled to uncover the true network of posterior edge probabilities for each stimulation and at each time point . this also demonstrates that the performance of the unmixing process  was sufficiently good to enable correct inference of protein-protein relations in each subpopulation. since more than one dag may represent exactly the same set of conditional independence relationships  <cit> , given static data without perturbations it is more reliable to infer the causal strengths between proteins, regardless of the direction of these causalities. extending the unpbn approach to dynamic data, or using perturbation data or adding prior information, will further facilitate the inference of directionality in the causal relations for each cell subpopulation.

discussion
in the era of systems biology, single-cell measurement techniques are rapidly expanding with respect to the number of cells that can be analyzed and the number of biochemical species that can be co-measured per cell. the approaches to explore these data have focused so far either on identifying different subpopulations of cells based on multiparametric proximities or on inferring the topology of statistical relations between the parameters for the population as a whole. however, the aim to reach each of these two goals in separate has fundamental problems. in one direction, ignoring the heterogeneity between cell subpopulations will lead to inferring a meaningless average topology of statistical relations of the population as a whole. in the other direction, since statistical relations are inferred from the correlation between the measured parameters, the identification of cell subpopulations based on multiparametric proximities inherently conflicts with the capability to resolve the topology of relations within each subpopulation. furthermore, protein networks with distinct topologies can be at the same state  and protein networks with the same topology can be at different states . therefore, attempts to identify cell subpopulations based on multiparametric proximities may actually identify different cellular states but not different types of cells. the method presented here pioneers a comprehensive solution to these fundamental problems by performing the identification of cell subpopulations  and the inference of statistical relations between the measured parameters in one joint analysis.

intentionally, we used snapshot data of a dynamic process  and, respectively, the method we developed does not rely on temporal information nor intends to give a model description of the dynamic itself. due to that, this method can be applied on the type of single-cell multiparametric measurements currently available such as multicolor flow-cytometry  <cit> , multiplexed mass cytometry  <cit>  and toponome imaging  <cit> . the classification of the distinct subpopulations in cell populations sampled at different time points along an experiment can hint toward the dynamic behavior of each subpopulation. however, such traceability of subpopulations along the time points depends on how different is their relative abundance within the whole population and on the sampling rate in comparison to the timescale of the biological process. advances in multicolor live cell imaging in combination with high-throughput automated microscopy gradually facilitate monitoring increasing numbers of parameters in individual live cells over many cells. the data obtained from such measurements will enable not only tracking the dynamics of the measured parameters in each cell subpopulation but also tracking them in individual cells. this kind of temporal information will help to further improve the identification of the distinct cell subpopulations and the inference of statistical relations between measured parameters in each subpoulation. as indicated by this work, it would be important also for the analysis of such live cell measurement data that unmixing and inference of protein-protein relations will be performed as one process.

the importance to recover single-cell phenotypes out of an uninformative average cell population behavior has been established and exemplified in many systems. notably, in these examples there was only one measured parameter per cell, often the output of the system, and, therefore, the unmixing was straightforward. however, in order to obtain mechanistic insight into how a biochemical system works it is required to examine the protein network itself, and not only its output. for this, multiple parameters should be co-measured per cell to overcome uncorrelated cell-to-cell variability between these parameters . we demonstrated here that in such a case unmixing cannot be achieved anymore using the proximity between the values of these parameters, while it can be successfully achieved using the high-order relations between them as captured by unpbn. importantly, unpbn can be straightforwardly extended to incorporate prior knowledge about parts of the network in the individual subpopulations.

CONCLUSIONS
our results show that the coupling between unmixing of observations and inference of statistical relations is essential and effective. with respect to the unmixing, our method was capable to identify the number of qualitatively distinct subpopulations considerably better than multiparametric proximity based approaches . consequently, the statistical relations in each unmixed subpopulation were also correctly recovered, while, without unmixing, uninformative average relations were inferred. as systems biology and personalized medicine are aiming toward reverse-engineering and re-engineering signaling networks, they are increasingly challenged by the inter-cellular variability and the large size of the relevant biochemical system. the work presented here offers a conceptual solution as well as an applicable statistical method to address this challenge.

additional files
additional file  <dig> 
the four distinct simulated topologies of the egf and ngf signaling network used in fig. 
 <dig>   ngf-mek wt: the wild-type network  with ngf stimulation.  egf-mek wt: as in  but with egf stimulation.  ngf-mek mut: the wild-type network with ngf stimulation, beside that here the sbml model parameter corresponding to the k
cat of mek  is altered from its wild-type value  to a value depicting a mutant mek with a lower activity , as indicates the thinner arrow from mek to erk.  egf-mek mut: as in  but with egf stimulation.



additional file  <dig> 
unmixing observations of cell subpopulations, mixed in a 1: <dig> ratio, by unpbn in comparison to clustering approaches. mixtures of observations of egf stimulated cells  and ngf stimulated cells  were generated with noise levels of  <dig>  and  <dig> . observations were sampled at one-minute intervals for  <dig> minutes after stimulation. for each noise level and sampled time point, observations were unmixed using unpbn, k-means clustering  and hierarchical clustering . the percentages of correctly allocated observations, averaged over all time points, are indicated by boxplots for the different methods for both noise levels .  the percentages of correctly allocated observations of the egf-stimulated subpopulation.  the percentages of correctly allocated observations of the ngf-stimulated subpopulation.



additional file  <dig> 
the success of unpbn in identifying the correct number of cell subpopulations  mixed in a 1: <dig> ratio. mixtures of observations of egf stimulated cells  and ngf stimulated cells  were generated with noise levels of  <dig>  and  <dig> . observations were sampled at one-minute intervals for  <dig> minutes after stimulation.  a boxplot showing the asw versus the tested number of components obtained by unbpn analysis . each boxplot indicates the median , the  <dig>  and  <dig>  quartiles , margined by the largest and smallest data points which are still within the interval of  <dig>  times the interquartile range from the box , and the outliers  obtained from pooled values over all time points with a noise level of  <dig> .  the same as  but with a noise level of  <dig> .



abbreviations
aswaverage silhouette width

dagdirected acyclic graph

egfepidermal growth factor

erkextracellular signal regulated kinase

gbngaussian bayesian network

mapkmitogen-activated protein kinase

mcmcmarkov chain monte carlo

mekmapk/erk kinase

ngfnerve growth factor

npbnnonparametric bayesian network analysis

pkcprotein kinase c

unpbnunmixing via npbn

competing interests

the authors declare that they have no competing interests.

authors’ contributions

jw, rsm-s, heg, ez and ki conceived the project, jw and ki developed the unpbn algorithm, rsm-s, heg and ez generated the simulated data, jw, rsm-s, yf, heg, ez and ki analyzed the data, jw, rsm-s, heg, ez and ki wrote the paper. all authors read and approved the final manuscript.

this work was supported by bmbf grant no.  <dig>  yf was supported by a german academic exchange service  fellowship.
