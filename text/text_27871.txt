BACKGROUND
in  <dig>  the first next-generation sequencing  technology was released by  <dig> life sciences   <cit> . within the past ten years, different sequencing technologies and platforms, including illumina, solid, ion torrent, complete genomics, were released to the public. the much faster sequencing speed, high-throughput capacity and now up to several hundred bases read length, together with a greatly reduced cost, revolutionized the scope and efficiency of biomedical related field researches  <cit> . paired with the increasingly diverse range of biological application of ngs technologies, numerous computational and informatics tools, frameworks and pipelines emerged to enable researchers to harness the power of ngs technologies. statistical models suitable for count data modeling gained much attention in ngs data analysis due to the discrete count nature of the data generated by ngs sequencers. such models were broadly applied in dna sequencing  based variants identification such as samtools  <cit> , varscan <dig>  <cit> , and snvmix  <cit> . for dna sequencing based single nucleotide variant  identification, emerging new applications bring challenges to refine the statistical modeling methods and pushing the limit of ngs technologies.

in cancer genetics research, low frequency tumor somatic snv identification is crucial due to the inevitable normal tissue contamination  <cit>  and the highly heterogeneous, constantly evolving nature of tumors  <cit> . accurate and sensitive identification of low frequency snvs also carries clinical significance, since it enables the early diagnosis, cancer progression monitor and relapse identification. the recent discovery of circulating tumor dna  also gained much attention. contrast to traditional tumor biopsies, which is invasive and can only offer a snapshot of the tumor genetics landscape at certain checkpoints, ctdna based ‘liquid biopsy’  <cit>  is non-invasive and can be done repeatedly for close monitoring of early sign of relapse or metastasis. however, ctdna only takes a small percentage of all blood sample dna, a previous research  <cit>  reported for some advanced cancers, ctdna is about 1 ~ 10 % of blood dna.

the difficulty for low-frequency snv identification using ngs technologies is due to the relatively high sequencing artifacts or error rates, which is around  <dig>  ~ 1 % for most platforms. further, such error rates differ significantly under various genome contexts. for example, illumina sequencing data are prone to have mismatches while ion torren and ion proton data contain more homopolymer related indels and consequently, mismatches near homopolymer loci . for somatic snv identification paired tumor-normal design, some existing methods derive the sequencing error probability from base qualities followed by error likelihood ratio test of tumor and normal sample at the same location, for example in mutect  <cit> , strelka  <cit> . while varscan <dig> applies a fisher’s exact test on the paired samples, treating non-reference read counts from the normal sample as background error rate. the former failed to consider differential error rates for substitution types while the latter only utilized information in one location thus the background error rate estimation is off. for one sample low-frequency snv calling, udt-seq  <cit>  tabulated the error rate based on substitution types, strand and location on the read to derive an empirical background error rate, then use binomial model to distinguish signal from error, and the candidate snvs are further refined by  <dig> filters. this method is context-aware but also ad-hoc, thus the ability to adapt to different sequencing technologies is limited. a brief summary of the tools mentioned above is included in additional file  <dig> 

by analyzing previous efforts, our group proposed a framework  to first generated position specific error model  using genome sequence contexts for candidate snv identification and then apply a machine-learning model to refine the candidates. testing on an ion proton benchmark dataset, our framework outperforms existing methods, especially at  <dig>  % to 3 % frequencies. however, the potential to improve psem performances on snvs with close to sequencing error rates by implementing more sophisticated statistical modeling and the generalizability and adaptiveness of psem remain untested. in this research, we explored what distributions fit the dna-seq data error rates modeling as well as the possibility of improved position specific error rate prediction for higher precision and recall on snvs down to  <dig>  % frequency. further, we evaluated how different sequencing technologies affect the behavior of psem and the generalizability and adaptiveness of the psem framework.

RESULTS
in the result section, we first briefly summarized the benchmark datasets used for psem. then we compared the testing benchmark dataset from ion proton with illumina miseq sequencing data in terms of allele frequency composition and depth distribution. utilizing count data visualization plots and tabulation, we selected the candidate distributions that may fit the data. since the ion proton dataset contains  <dig> times of the number of benchmark snvs from illumina miseq and also is enriched with snvs of ≤ 1 % allele frequency, we mainly focused on ion proton data set for model development and evaluation. to test the generalizability of the psem, we further trained and evaluated it on illumina miseq dataset.

benchmarks overview and comparison
two sets of designed benchmarks targeting low-frequency snvs from both ion proton and illumina miseq  <cit>  sequencing technologies were included. the details of these  <dig> datasets are described in methods section and additional files  <dig> and  <dig>  briefly, the ion proton training benchmark is the sequencing data from a single individual with known genotypes, while the test benchmark was designed to mimic the paired normal-tumor design for somatic snvs identification applications. the illumina miseq benchmark data were generated by mixing  <dig> individuals at  <dig> different percentages and then permuted the mixing percentage assignment  <dig> times to generate  <dig> calibration datasets – cal_a, cal_b, cal_c and cal_d. since the  <dig> calibration data sets were generated with the same procedures, without loss of generality, we used cal_a as training benchmark and treated the others as testing benchmark.

comparing the two testing benchmarks, ion proton contains a total of  <dig> somatic snvs while illumina miseq contains  <dig> snv – mixed allele frequency pairs, with  <dig> unique snvs. more importantly, ion proton benchmark was designed to comprehensively characterize the snv caller performance on close to sequencing error allele frequencies, thus it is enriched with snvs of < = 3 % allele frequencies, with  <dig>  % as the lowest targeted frequency. plotting the cumulative percentages of snv numbers at different allele frequencies  from the two test benchmarks, it is clear the major components of ion proton benchmark snv allele frequencies are at  <dig>  %, 1 %, 2 % to 5 %, followed by continuous frequencies until 46 %, the maximum somatic snv frequency designed in the dataset. whereas miseq data set includes roughly equal percentages of snvs at  <dig> discrete allele frequency levels.fig.  <dig> allele frequency composition of ion proton and illumina miseq testing benchmark snvs



except for allele frequency composition, sequencing depth is also a crucial factor affecting the performances of the snv callers, especially at the low-frequency ranges. the average depth for ion proton sequencing testing benchmark is about 4000x and about 1500x for miseq. in addition, despite the amplicon-based capture assay was applied on benchmark datasets from both technologies, the evenness of the depth across the targeted regions is different. when comparing the depth on known testing benchmark snv loci of two technologies , the depth distribution for ion proton is skewed while the distribution profile for illumina miseq data displays a bell shape. further, the average depth at snv loci from both benchmarks are around 3000x, despite the much higher overall depth for ion proton. thus, we speculate lowered recall for some ion proton benchmark snvs, particularly for the ≤ 1 % ones, the identifiable power of which are more sensitive to the depth and read count number sampling variances.fig.  <dig> snv loci depth distribution by allele frequency for ion proton and illumina miseq. the dashed lines show the 3000x depth



candidate distributions selection
to model error rate based on count data,  <dig> most common distribution choices are binomial, poisson and negative binomial  distributions. we applied a graphical exploratory plot – distplot  on the model response – number of reads containing non-reference bases – to get visual intuition about the overall fit of response data on different distributions. intuitively, if an assumed distribution fits the data well, the data points should follow a straight line determined by the distribution metameters. as shown in fig.  <dig>  the obvious curve for binomial distribution plot suggests binomial distribution is not appropriate. the poisson and nb plots show better agreement with the straight line although both curves deviate more from the straight line when the x-axis approaches  <dig>  tabulating the percentages of zero in the model responses show for ion proton training dataset, 85 % is  <dig> while 80 % for miseq training data. thus zero-inflated models should be considered. in the modeling step, we included poisson, nb and their zero-inflated counterparts  as the candidate distributions under generalized linear model  framework.fig.  <dig> distplot on binomial, poisson and negative binomial distributions. the y-axis is the distribution metameter calculated by the method distplot used. the open points show the observed count metameters; the filled points show the confidence interval centers and the dashed lines show the confidence intervals for each point. 95 % confidence interval is used



comparing the goodness-of-fit of different distributions
 <dig> genomic sequence context covariates, totaling  <dig> degrees of freedom, were included in the glm models . since zip and zinb glm require covariates for both the ‘zero’ and ‘count’ parts, the same covariates were provided for both, resulting in doubled degrees of freedom of those included in poisson and nb glm.

to compare the goodness-of-fit of models based on different distributions, we used vuong’s non-nested hypothesis test  <cit> . bic-corrected vuong z-statistic was used to impose stronger penalty on additional parameters. the pairwise comparison results are summarized in table  <dig>  poisson distribution glm is treated as the reference distribution to compare to, given its simple configuration. as expected, nb glm is superior to poisson glm, since nb models dispersion of the data, and this is also supported by dispersion test  <cit>  . the necessity of modeling zero-inflation is supported by the vuong’s test comparing zip with poisson glm. when comparing zip with nb, nb fits the data better. however, it is worth noting the evidence of superiority – the absolute value of bic-corrected vuong z-statistic – is much smaller than the other tests. the merit of considering both dispersion and zero-inflation is further emphasized by the comparisons of zip with zinb and nb with zinb. in conclusion, based on vuong’s test, for ion proton sequencing dataset, the most appropriate distribution is zinb, followed by nb, zip and poisson.table  <dig> vuong’s non-nested tests on  <dig> distributions applied to ion proton training data



performance evaluation on ion proton testing benchmark
we first evaluated the overall precision and recall values of all models on the test benchmark. from table  <dig>  it is observed the poisson glm achieves the highest recall while zinb glm has the highest precision. f <dig> score, the harmonic mean of precision and recall, is used to evaluate the overall performance. the conclusion from f <dig> score is consistent with that of vuong’s test, with zinb performs the best, followed by nb, zip and poisson glm. however, the precision values listed in table  <dig> are lower than the ones reported previously  <cit> . there are  <dig> major reasons:  <dig>  the ion proton test benchmark dataset is designed to enrich with low-frequency snvs, with  <dig>  % of all snvs of allele frequency < = 3 %, in which  <dig>  % at  <dig>  % frequency and  <dig>  % at 1 % frequency, whereas the majority of previous studies focused on snvs of > = 5 % allele frequency;  <dig>  one popular paradigm of snv calling is a two-step procedure, first generating snv candidates and then applying multiple sequencing quality filters to refine the snv call. the psem aims to efficiently recover high quality snv candidates to facilitate the filtering step, thus it is only fair to compare the performance of psem with other candidate generating methods. the result from varscan <dig> before applying sequencing quality filters was included in table  <dig>  it is evident that except for poisson glm, the other methods outperformed varscan <dig> in both recall and precision. therefore, choosing appropriate statistical modeling method enables us to recover more true snvs without any loss of precision in candidate generating step.table  <dig> overall performance comparison for ion proton testing benchmark



next, for all distributions, we explored the performance profiles on different allele frequencies. as shown in fig.  <dig>  the well-separated f <dig> score levels clearly show that snvs of lower allele frequencies are more difficult to identify, no matter what distributions were used. in addition, the significant separation of  <dig>  % from the other allele frequencies indicate the detection limit is around  <dig>  % under current sequencing platform and depth. meanwhile, the power of appropriate modeling is evident when comparing the performances of all distributions on snvs of  <dig>  % allele frequency. relative to poisson glm, considering either zero-inflation or dispersion boosted the f <dig> score by about  <dig>  at  <dig>  %, while considering both by zinb further increased f <dig> score by about  <dig> . interestingly, compared with the second best model – nb glm, both precision and recall increased in zinb glm, which pinpoints the necessity of modeling zero-inflation to derive more accurate error rates estimation. furthermore, for snvs with allele frequency greater than 1 %, the average recall is  <dig>  % with  <dig>  % average precision for zinb glm. to summarize, the performance evaluation results on low-frequency snv identification also support the conclusion from vuong’s non-nested test, with zinb being the most appropriate model. further, the necessity of modeling both dispersion and zero-inflation is exemplified by the much-elevated performance at close to sequencing error rate allele frequency, which is important for pushing down the detection limit of low-frequency snv callers.fig.  <dig> performance by allele frequency summary on ion proton testing benchmark



application of zinb psem on illumina miseq data
to evaluate the generalizability and adaptiveness of the glm based psem, the same modeling strategies were applied to the illumina miseq sequencing data sets. the same genomic sequence context features from ion proton modeling were applied to the illumina miseq cal_a dataset. similar to the analysis on ion proton data set, paired vuong’s non-nested hypothesis tests were conducted on the  <dig> candidate distributions, with details summarized in additional file  <dig>  the test conclusions remained the same except for the nb  and zip  comparison, where the bic-corrected vuong z-statistic is − <dig>  resulting in p value =  <dig> . therefore the goodness-of-fit for these two distributions on miseq dataset are not significantly different.

despite similar statistical modeling schema can be readily generalized to illumina miseq data set, illumina miseq and ion proton sequencers differ significantly in terms of sequencing chemistry. the former is based on sequencing-by-synthesis  that relies on high-resolution optic systems, whereas the latter is based on ion semiconductor sequencing where no modified nucleotides or optics are required. the differences in sequencing mechanisms make ion proton sequencers run faster but are prone to homopolymer related errors. comparing the nb glm regression coefficients on both datasets , homopolymer related features significant in ion proton data set regression are either insignificant  or show opposite effect  on the error rate. the same trend was also observed in zip and zinb models comparing ion proton with illumina miseq .

to evaluate whether the differences in glm coefficients affect the performance profiles on various allele frequencies, we applied the  <dig> glm models trained on cal_a to the other  <dig> calibration datasets and conducted the recall, precision and f <dig> score analyses by allele frequency on the combined dataset. as shown in fig.  <dig>  similar to the ion proton data set, snvs of lower allele frequencies are more difficult to identify. however, when comparing the performances of zip with nb glm on  <dig>  % ~ 1 % allele frequency, different from ion proton dataset, nb demonstrated a much higher f <dig> score compared with zip. a closer look at the performance profiles shows the noticeable drop in recall comparing nb with zip in ion proton is absent in miseq data. examination on the benchmark snvs missed by nb but recovered by zip showed lower depth for the missed ones. while the absent of recall drop in miseq is due to its relatively even depth contrast to the ion proton dataset . for snvs with > 1 % allele frequency, the f <dig> scores are all greater than  <dig>  and clustered together for all distributions.fig.  <dig> performance by allele frequency summary on illumina miseq testing benchmark



comparing with the results from udt-seq  <cit> , which reported approximately 90 % recall and >95 % precision , zinb glm demonstrates higher overall recall  and high precision .

discussion
the psem model aims to predict the position specific error rates associated with various genomic sequence contexts, under which the specific sequencing technology is prone to error. based on publications evaluating features associated with sequencing errors and experiences from our previous effort,  <dig> types of significant features are considered. with the features fixed, using glm, we evaluated the appropriateness of distributions with different mean – variance relationships and the ability to consider zero-inflation. consistent with the computational tool edger  <cit>  for rna-seq data, we found the ability to model over-dispersion by nb distribution necessary for dna-seq data as well. additionally, for dna-seq erroneous read counts modeling, zero-inflation is also a key factor for accurate prediction and inference. the much-elevated f <dig> score for  <dig>  % allele frequency snvs as well as the highest overall performance by zinb glm highlighted the importance of choosing suitable statistical models. moreover, comparing with varscan <dig>  which conducts the fisher’s exact test for each targeted location on paired normal-tumor sequencing data, the significance of applying the correct reference error model is exemplified by higher recalls as well as precisions for  <dig>  % and 1 % frequency snvs. in theory, for low frequency snv loci, varscan <dig> treated the sequencing reads with non-reference bases from normal as the background error, which is essentially point estimation based on one location. whereas psem collectively considers all loci with similar context features and thus is able to generate more accurate error estimation.

the evaluation of psem modeling on illumina miseq dataset and the performance comparison with ion proton dataset show the generality of the psem framework as well as its adaptiveness to different technologies. moreover, except for the established importance of choosing appropriate statistical model, the sequencing depth evenness is also an important factor affecting low-frequency snvs calling performances.

the current glm-based psem framework only considers  <dig> types of genome sequence context features. to further improve the performances, more informative features associated with sequencing errors should be included and tested. in addition, from the modeling aspect, exploration of the potential to further increase the performances by applying more sophisticated computational models are desired. to better understand its generalizability and adaptiveness, tests on other sequencing technologies, such us solid and complete genomics, are necessary. besides, since the capture assay for the two benchmarks is amplicon-based, hybridization-based approach should be tested to compare the performance profiles.

differentiating low frequency snvs from sequencing artifacts is the key for identifying snvs at frequencies close to sequencing error rates. our psem approach tried to push the limit toward the sequencing error rates. based on the analyses on benchmarks from standard sequencing protocols and the given sequencing depth, we speculate the detection limit is around  <dig>  % on the regions covering all exons of hundred of genes, with a total size up to millions of bases. however, with high accuracy sequencing protocols, such as duplex sequencing  <cit>  and ultra-deep target enrichment assay  <cit> , the researchers reported identification of snvs around  <dig>  % on a single gene scale. despite the promising results, more efforts to make such protocols applicable on larger regions are required for broader applications.

CONCLUSIONS
our method enables sensitive detection of low-frequency single nucleotide variants across different sequencing platforms down to  <dig>  % frequency. thus will facilitate research and clinical applications such as pooled sequencing, cancer early detection, prognostic assessment, metastatic monitoring, and relapses or acquired resistance identification.

