BACKGROUND
understanding the molecular networks which give rise to pluripotency in embryonic stem  cells is crucial for among other things developing reprogramming strategies. recent work has shed light on several key aspects of the underlying network and its interaction with external factors, in particular the chemical media which maintain the cells  <cit> . the current understanding is that escs occupy a multiplicity of sub-states, with stochastic transitions between them. one aim is to understand the molecular interactions that maintain cells in a pluripotent state, destabilize this state leading to commitment, as well as allow a return to the pluripotent state from a committed state. given the substantial experimental efforts currently underway to understand these mechanisms, a computational systems biology approach seems like a way forward within which such questions could be formulated  <cit> . as in many other biomedical problem areas, a computational approach would here allow diverse experimental results to be absorbed into the formulation of the model, but more importantly, could serve as a hypothesis generator to test mechanisms through further experimentation. the recognition that states of a es cell are read out by the gene expression of key regulators, has lead to a simple hypothesis regarding the pluripotent nature of the esc  <cit> . an es cell can be in a “ground state”, in which it is neutral to any developmental specification. however, it is possible for the cell to transition to a differentiated state. here we explore the dynamics of a simplified network model representing key elements of esc transcription factor and signaling regulators to suggest mechanisms for such a transition state picture.

at the heart of the pluripotency network lies the triad oct <dig>  sox <dig> and nanog  <cit> , where oct <dig> and sox <dig> act together as a heterodimer regulating several genes including nanog, oct <dig> and sox <dig>  <cit> . there are additional tfs that also impact pluripotency. the exact regulatory mechanisms in the network with impact on pluripotency remain to be fully understood. however, it appears that self-reinforcing mechanisms through feedback of these key regulators upon themselves seem to be instrumental. interacting with these key components in mice are external factors like leukemia inhibiting factor , which can substitute for feeders by activating the transcription factor stat <dig> that inhibits es differentiation  <cit> . another factor, bone morphogenetic protein , has been shown to inhibit the differentiation proteins and thus can be used as a replacement for serum  <cit> . there are corresponding factors active in humans. the common media for maintaining stem cells in cultures is lif plus serum or bmp <dig>  it has been shown that serum/bmp <dig> can be replaced by small molecules which inhibit fgf <dig> receptor tyrosine kinases and the erk cascade   <cit> . the 2i/3i  medium is used successfully to maintain stem cells in vitro in combination with or without lif.

biochemical systems naturally exhibit stochastic fluctuations due to random interaction processes, gene transcription and translation as well as degradation. recent studies have explored the role of stochastic fluctuations in a variety of organisms ranging from bacteria to mammalian cells  <cit> . in escs, it was shown that the expression of some transcription factors important for pluripotency are heterogeneous when cells are maintained in the “classical” environment i.e. lif plus bmp <dig> or serum. stochasticity or heterogeneity has been observed in key stem cell tfs such as nanog  <cit> , rex <dig>  <cit> , stella  <cit> . based upon these observations, it appears that stem cells exist in a multitude of sub-states, where each sub-state represents a certain multi-distribution of tf concentrations. in particular, nanog shows more heterogeneity than oct <dig> and sox <dig>  <cit> . cells expressing lower levels of nanog are more prone to differentiate  <cit> , thereby conferring a stochastic component to the ability of the cell to self-renew. hence, the state space of escs is intricately woven into the heterogeneous gene expression of some of the key regulators of the network.

underlying the ability of nanog to act as a “gatekeeper” of pluripotency  <cit> , is the fact that oct4-sox <dig> also induces fgf <dig>  a differentiation promoting growth factor  <cit> . the es cell requires oct <dig> and sox <dig> to maintain it in a pluripotent state, while at the same time pushing it towards differentiation. nanog is thought to prevent differentiation, and hence when it reaches low levels, the probability to commit increases. how fgf <dig> fits into this network has so far not been computationally explored. mouse escs can be maintained in a pluripotent state, through introduction of small molecule inhibitors. ying et al.  <cit>  discovered two different sets of small molecule inhibitors; 3i – fgf receptor inhibitor, mitigen activated protein  kinase/erk kinase - mek inhibitor and gsk <dig> inhibitor, 2i – mek inhibitor and a gsk <dig> inhibitor. wray et al.  <cit>  established that the expressions of nanog and rex <dig> within the mouse es cultures under 2i conditions were not heterogeneous i.e. only nanog high or rex high are present, suggesting the existence of cells in a state that is intrinsically less fluctuating. this could be denoted a true “ground” state, which they suggested is an inherent stable pluripotency network governed by oct <dig>  sox <dig> and nanog, but, which is perturbed by erk signaling acting through the fgf receptors.

it follows that a quantitative analysis of network dynamics could improve our understanding of the multiple states of the esc. previous purely deterministic studies have explored the dynamics of the oct4-sox2-nanog regulatory network, as well as its role in determining the cell fate, i.e the final lineage: epiblast, trophectoderm and endoderm  <cit> . however, neither of these computational studies analyzed heterogeneity in nanog expression. kalmar et al.  <cit>  suggested by stochastic modeling of a simplified stem cell network based upon observations, how nanog fluctuations could make the stem cell state transition between multiple states. their model involved feedbacks, both positive and negative between oct <dig> and nanog which lead to nanog levels cycling between high and low levels as an excitable system. subsequently glauche et al.  <cit>  further studied the nature of such stochastic transitions with two different model scenarios. in one model nanog, which is induced by oct4-sox <dig> can act as a bistable switch, and can transition between high and low levels. in the other model, which is based upon an activator-repressor mechanism, nanog can oscillate on a fixed limit cycle, and can recapitulate the observed heterogeneity in nanog levels. hence, several types of mechanisms could lead to nanog heterogeneity. it is also suggested how nanog can act as a gatekeeper by suppressing any differentiation signals which would ultimately make the cell transition into a differentiated cell. however, in  <cit> , the signal to differentiate is external, and cells therefore cannot differentiate spontaneously as observed.

in this work we build upon these ideas by further analyzing how fluctuations in nanog play a role in both allowing cells to transition between es sub-states and then to finally exit irreversibly into a differentiated state. however, this occurs in a spontaneous fashion. key to our approach, which is different from that of refs.  <cit> , is the development of a self-organized network, in which the pluripotent network governed primarily by oct4-sox2-nanog interacts with a differentiation pathway gene denoted by “g”. candidates for g are for example gata <dig> and sox <dig>  it is the stochastic dynamics of this network in which several types of feedbacks give rise to the observed stochastic stem cell fate. the noise therefore is internal to the network, with external stimuli controlling the strength of the fluctuations. hence, stem cells can spontaneously change fate in accordance with observations. this also allows us to answer the second question as to how reprogramming can be simulated in our model. in  <cit>  it has been shown that over-expression of oct <dig> can lead to reprogramming a somatic cell to an esc. however, the efficiency is maximal for the levels of oct <dig> within a certain window  <cit> . our model can reproduce this result, and we show how the interaction between oct <dig>  nanog and the differentiation pathway gene g lead to this result.

RESULTS
a simplified computational model of the esc
our simplified esc network model considers a combination of positive and negative feedbacks between oct4-sox <dig> and nanog and g. with stochastic simulations we demonstrate the permissive nature of this self-contained network – most cells retain pluripotency except for a fraction that get pushed towards differentiation. this model, is based upon an epigenetic effect by which oct <dig> regulates nanog, is also employed for reprogramming somatic cells into esc.

the heterodimer oct4-sox <dig> is known to serve as an activator of oct <dig>  sox <dig> and nanog  <cit> . as in  <cit> , we simplify the interaction of oct <dig> and sox <dig> with nanog as shown in figure  <dig>  the feedback between nanog and oct4-sox <dig> must be weak. otherwise it would be inconsistent with low levels of nanog and high levels of oct <dig> and sox <dig> as pointed out in  <cit> . hence, we do not explicitly have nanog inducing oct <dig> and sox <dig> in contrast to refs.  <cit> . to describe both the embryonic as well as the differentiated state, we include g in the circuit. one candidate for g is sox <dig>  which was shown to play a role in the control of differentiation of escs into extra embryonic endoderm  <cit> . sox <dig> interferes with the self-renewal program by inhibiting sox <dig>  oct <dig> and nanog  <cit> . another candidate for g is gata <dig>  which is responsible for endoderm formation and also mutually antagonizes nanog  <cit> . in  <cit> , the authors assumed an external signal promoting differentiation. however, in our approach the gene g is regulated by the esc circuit itself, and hence is part of the network which determines the cell fate. our circuit also includes the differentiation promoting autocrine growth factor fgf <dig>  which is shown schematically in figure  <dig> to repress nanog  <cit> . it has been suggested that fgf <dig> acts upstream in the induction of differentiation  <cit> . the fgf <dig> gene is expressed in mouse embryonic stem cells and only oct-sox complexes are able to promote its transcriptional activation  <cit> . inhibition of fgf <dig> along with gsk <dig> consolidates the esc self-renewal and pluripotency  <cit> . as in  <cit> , we have assume mutual antagonism between nanog and the differentiation gene g, as well as activation of g by oct4-sox <dig>  as shown in  <cit> , over-expression of oct <dig> could either lead to the establishment or loss of the stem cell fate, depending on the level of oct <dig>  we have also considered epigenetic regulation of nanog as it has been suggested that oct <dig> activates the histone demethylases jmjd2c, which in turn exposes key pluripotent genes to regulation, among them nanog  <cit> . including this mechanism in the model results in sharpening the non-linearity of the oct4-nanog interaction.

exploring the ground state of the esc
commitment – transition from the stem cell state to a differentiated state
we first compute the steady states of the system for different values of lif using the deterministic rate equations  for the circuit in figure  <dig> with the parameters given in table  <dig> 

with dynamics resulting from the interactions between g, nanog and oct4-sox <dig>  there are basically two states of the system:  the stem cell state, when oct4-sox <dig> and nanog are on and g is off, and  vice versa for the somatic state.

in the somatic state g is high and both oct4-sox <dig> and nanog are suppressed and hence off. this state remains even when increasing lif since the model for the nanog gene regulatory function is based upon a simplified epigenetic mechanism. for nanog to be activated, the nanog promoter must be bound by oct <dig> along with any of its activators oct <dig>  nanog , lif. to be repressed, nanog must be bound by oct <dig> along with its repressors fgf <dig> and g.

adding lif, has no effect on nanog if oct <dig> is off, since lif cannot access nanog. however, if initially the cell is in a stem cell state with high oct4-sox <dig>  then oct4-sox <dig> exposes nanog, which allows lif to induce nanog. this in turn leads to suppression of g, which finally relieves the suppression on oct4-sox <dig>  these sequential negative interactions implement a positive feedback loop between nanog and oct4-sox <dig> . additional file 1: figure s1a displays the two states of the cell. the regulation of nanog occurs through a feed-forward loop  <cit> , in which oct <dig> directly activates nanog and indirectly represses nanog through fgf <dig>  additional file 1: figure s1b shows that adding 2i/3i to the media leads to suppression of fgf <dig> , and hence relieves nanog from repression.

so far we have described a deterministic approach. however, chemical reactions are necessarily stochastic, and hence protein levels fluctuate in time  <cit> . we assume that all of the stochasticity originates from within the network, i.e internal noise, as it is entirely due to random events of protein production and degradation for each of the molecular components with no external noise  <cit> . since this noise is generated by the network itself, it could be regarded as “permissive”, which has been conjectured to be the source of hematopoietic commitment  <cit> . to study the effects of stochasticity, we used a gillespie approach where the deterministic equations  provide transition rates for a master equation. the latter is simulated by a monte carlo procedure to provide the time evolution of the concentration levels  <cit> .

stochastic dynamics under lif conditions
in figure 2a, we show the time series of oct4-sox <dig> and nanog concentrations for a stochastic simulation of equation  <dig> with lif= <dig> for the parameters in table  <dig>  not shown are the g and fgf <dig> time series; g fluctuates around extremely low levels and fgf <dig> is similar to oct4-sox <dig>  although oct4-sox <dig> remains at a fairly high level, nanog displays a larger fluctuation. the corresponding distributions obtained from several monte-carlo runs , show a tail for low nanog levels with a peak at higher levels. oct4-sox <dig> displays less heterogeneity. this recapitulates the observed nanog heterogeneity  <cit> . nanog regulation occurs due to the competition between oct4-sox <dig>  which directly induces nanog, and suppression by fgf <dig>  which itself is induced by oct4-sox <dig>  this type of regulation implements an incoherent feed-forward loop  <cit> . it is the delay between the noisy oct4-sox <dig> induction of nanog and its subsequent suppression through induction of fgf <dig>  which itself is fluctuating, that creates the excess fluctuations observed for nanog.

it has been shown that nanog expression fluctuations reaching very low levels lead to irreversible commitment  <cit> . hence we have built into our model the possibility of leaving the stem cell state by nanog interactions with the differentiation gene g. figure 2e shows nanog fluctuations from a typical simulation. should the nanog expression hit a low level, g is relieved from the suppressive effects of nanog, and is turned on. then g shuts off oct4-sox <dig> and hence the pluripotent state is transformed into differentiated one. before this transition occurs, oct4-sox <dig> is at high levels but nanog could be either high or low. it is only when nanog reaches a very low level, through several consecutive degrading events in nanog or oct4-sox <dig>  and/or coupled with increase in fgf <dig> or g, that the switch to a differentiated state occurs. the above results which suggest the role of increased heterogeneity in nanog as responsible for the fate of the stem cell, were obtained for the parameter set displayed in table  <dig>  to show that these results are robust to changes in parameter values we computed the fluctuations in nanog and compared them with the fluctuations in oct <dig>  using the linear noise approximation   <cit>  for a wide range of parameter sets . in figure  <dig>  in each panel, we see the distribution of nanog and oct <dig> fluctuations for random parameter sets, for changes in parameters in increasing order . for each distribution in parameter space, in the majority of the cases, we see that the highest fluctuations occur in nanog expression. however, there are cases marked by the oval a, in the middle and last subplots, where nanog and oct <dig> fluctuations are extremely low. these represent those cases where the state of the cell is in the differentiated state, and hence the fluctuations in g would be highest. in the last subplot, the oval b represents those cases where the parameter sets corresponded to: weak nanog auto-regulation, strong suppression of nanog by fgf <dig>  g and weak suppression of oct <dig> by g. this therefore resulted in higher noise in oct <dig> than nanog, since the latter was strongly suppressed, at the same time g was unable to fully turn oct <dig> off. however, the above results indicate that nanog in most cases experiences the highest fluctuations for a wide range of parameters, thereby supporting its role as the “gatekeeper” of the stem cell state.

the pluripotent state has high levels of oct4-sox <dig> which are less heterogeneous than those of nanog. the continuum of nanog values spans both, high and low nanog values. in  <cit>  the nanog distribution resulted in a bimodal one, due to a bistable switch-like mechanism. a critical point is that nanog functions as a gatekeeper regardless of its exact distribution – at low values it is unable to repress g and hence causes a transition. our simulations are consistent with the experimental observation that although lif-bmp <dig> maintains escs, a low amount of differentiated cells are nevertheless produced. simulations also show that increasing lif improves the maintenance of stem cell cultures, i.e. the mean time that a cell, which is initialized as a stem cell, remains a stem cell increases with lif value .

stochastic dynamics under 2i/3i conditions
recently, it was shown that escs can be maintained in 2i/3i  <cit>  media, with the interesting result that heterogeneity in nanog is lost. our model assumes that the effect of small molecules in the 2i/3i medium is to suppress fgf <dig>  this would relieve the suppression on nanog. as it is shown in additional file 1: figure s1b, the system now exhibits a higher level of nanog.

reprogramming – transition from somatic to ips cells
ectopic expression of the pluripotency transcription factors oct <dig>  sox <dig>  klf <dig> enables the transition from somatic cells to ips cells   <cit> . one notes that nanog is not required for reprogramming despite its hub role in the architecture. reprogramming with only these three factors is inefficient. hence, substantial efforts are made to overcome this drawback. initially, over-expression of c-myc was used but the addition of this factor increased not only the efficiency of reprogramming but also the tumorigenicity of the cells  <cit> . recently, it has been shown that c-myc can be replaced by glis <dig>  which does not have the same tumorigenic effect  <cit> . however, the reprogramming process still remains inefficient and more understanding of the process on the molecular level is needed.

our minimal dynamical model elucidates the reprogramming process when only oct <dig>  sox <dig> and klf <dig> are over-expressed and identifies the obstacles to overcome: the differentiation gene g antagonizes oct <dig> and nanog, and since it feeds back positively upon itself, once on, it ensures that oct4-sox <dig> and nanog are off. when oct4-sox <dig> is off, nanog cannot be induced since oct <dig> is unable to fulfill its epigenetic role of exposing the nanog promoter for transcription. hence, nanog stays off. nanog is also repressed by fgf <dig>  which in this case would be low, since its inducer oct4-sox <dig> is off. hence, over-expression of oct <dig> is the key.

deterministic analysis
the parameter αin equation  <dig> governs the oct <dig> over-expression. in figure 4a, the bifurcation diagram shows how the network components change with increasing αkeeping the other parameters fixed. three regions can be identified, approximately given by:

 α<  <dig> ,   <dig>  <α>  <dig> ,  α>  <dig> . when going from  to  oct <dig> exposes nanog and the high value of lif  induces nanog, raising its expression to a sufficiently high level. the antagonism between nanog and g, reduces g to low levels. this removes the g repression of oct4-sox <dig>  which further induces nanog. this implements the positive feedback loop, which makes the transition from the somatic state to the stem cell state. we note that with oct4-sox <dig> at high levels, fgf <dig> is induced, which does repress nanog. however, this suppression is not strong enough to counter the induction from lif, to switch it off. in addition, with 2i/3i media present, this effect can be significantly reduced.

as oct4-sox <dig> over-expression is further increased and reaches α≃ <dig>   another bifurcation occurs. now, a new state emerges – a differentiated state in which nanog can be at low levels while g is high. this new state is possible because over-expression of oct <dig> leads to a relatively slow increase in g, as it can also be induced by oct <dig> in the model . once oct <dig> crosses a certain threshold, g can overcome nanog, leading to a differentiated state.

our deterministic model analysis indicates that the stem cell circuit activation must be conditioned by oct4-sox <dig> over-expression. it is known that over-expression of oct <dig> is mandatory for obtaining ips cells in the laboratory  <cit> . however, too large an over-expression leads to a differentiated state  <cit> . hence oct <dig> has to be within a set of thresholds to achieve reprogramming  <cit> . it should be pointed out though that the latter result was obtained for human esc.

stochastic simulations
in figure 4b we present the results of a corresponding stochastic simulation when the reprogramming was successful. initially, the differentiation gene g has high expression whereas nanog and oct4-sox <dig> have low expression values – the circuit is in the somatic state. over-expression of oct4-sox <dig> with an optimal dosage α≃ <dig>  ensures that nanog is strongly activated by oct <dig> and hence the stem cell circuit switches to a stem cell state.

a major challenge is to increase the efficiency of the reprogramming process. we used our model to study the variation of reprogramming efficiency when the value of oct4-sox <dig> over-expression  is varied. figure 4c shows the success rates obtained from multiple monte carlo simulations where the value of α was varied in the  range. our results suggest that the dosage of reprogramming transcription factors has an important impact on reprogramming efficiency. this has been experimentally shown in a study on optimization of ips cells generation  <cit> . we identified an optimal range for oct <dig> added expression value  to be . such a success interval should be considered when reprogramming is conducted under lif and bmp <dig> medium conditions. if the values of reprogramming factor expression is lower than the values in the reprogramming success range then reprogramming does not take place as oct <dig> is not significantly expressed and it does not strongly induce nanog. if the values of oct <dig> are too high then they would correspond to values that lead to endoderm differentiation and reprogramming is not successful. figure 4c shows a 10-fold decrease of the percentage of obtained ips cells for values of αoutside success intervals.

our results show that the stem cell medium where the somatic cells are maintained after transduction also plays an important role in reprogramming efficiency. when reprogramming is successful, the differentiation gene g is off while nanog and oct4-sox <dig> are at high values. the latter induces fgf <dig> which represses nanog. the nanog suppression by fgf <dig> influences negatively the reprogramming outcome. thus, repression of fgf <dig> should have a positive impact on reprogramming efficiency. indeed, when increasing 2i/3i concentration, an increase in ips cell generation efficiency is observed . the percentage of ips cells in this study represents the outcome from a minimalistic model and there must be additional factors not considered here which might modify the percentages. however, such factors would equally influence every scenario under consideration.

nevertheless, our results demonstrate that setting the degrees of over-expression and choosing the ips cell medium should be considered for optimizing reprogramming efficiency.

for completeness we performed similar analyses for a modified network topology without the differentiation gene g .

CONCLUSIONS
our computational model of the transcriptional dynamics of the embryonic stem cell suggests mechanisms in the simplified network feedback structure which allow cells to make a stochastic decision to exit from a stem cell state to a differentiated one. such an event is random and occurs due to the internal noise of network components. in particular, we explicitly showed how nanog heterogeneity enables such transitions. nanog integrates several noisy signals. oct <dig> both directly activates nanog, as well as suppresses it through fgf <dig>  when nanog falls below a certain threshold, g gets activated, leading to shutdown of nanog and oct <dig>  fgf <dig> can be suppressed by the 2i/3i media which leads to reduction of nanog heterogeneity  and hence to stability of the stem cell state, i.e the “ground state”. our model could explain how the absence of the 2i/3i media, can result in the experimentally observed “leakage” to differentiated cells even under ideal culture conditions, since stochastic transitions of nanog to relatively low levels can occur, in this case. the spontaneous commitment picture emerging from our model studies is consistent with the “permissive” scenarios suggested in the context of hematopoiesis  <cit> . one might speculate that this esc property allows cells to form tissues in the natural environment of the embryo through a low rate of regulated differentiation events. finally we studied the reprogramming scenario of somatic cells due to oct <dig> over-expression. our model was able to explain why reprogramming efficiency is biphasic with respect to oct <dig> levels. once reprogramming occurs, the external stimuli provide optimal conditions to maintain for the stem cell state.

our simplified model could be expanded as more links in this network are explored. for example, recent work  <cit>  suggests that nanog is epigenetically modified by ezh <dig>  and as discussed in  <cit> , this could have interesting consequences for a model seeking to describe nanog fluctuations. it is expected that future experiments will discover additional network componentsand external media implicated to govern stem cell fate and reprogramming, which could be included into our current model. we have not explored the consequences of external noise due to the environmental signals: lif and 2i/3i, which will be explored in another work. one area of immediate interest is to immerse our single cell stochastic dynamics in a spatial context of growing and dividing cells  <cit>  with the aim to understand how noise in gene expression couples with mechanics and cell fate in the living embryo.

