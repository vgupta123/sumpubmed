BACKGROUND
comparison of two completely sequenced genomes sheds lights on the genetic basis of differences in biological traits between species. of particular interest is the comparison of complete sets of genes and gene products encoded in two genomes. manual comparison is important but time-consuming and labor-intensive at the whole-genome scale and thus must be aided by automated approaches.

unambiguous automated comparison requires that both genomes be annotated with the same structured, controlled vocabulary. currently, the most common choice for such a vocabulary is gene ontology   <cit> . the november  <dig>   <dig> version of go contained  <dig>  terms in three hierarchical structures—as directed acyclic graphs —termed biological processes, cellular components, and molecular functions. every branch in the graph represents a biological concept progressing from general to specialized with increasing graph depth. the depth of the branches in the graphs varies, with levels ranging from  <dig> to  <dig> 

the go web site currently lists  <dig> genomes that have been annotated with go  <cit> . the annotations that are of the highest quality and updated most frequently are usually carried out by researchers who sequence and study a particular species; these annotations are primarily stored in species-specific databases such as sgd  <cit>  for saccharomyces cerevisiae, flybase  <cit>  for drosophila melanogaster, wormbase  <cit>  for caenorhabditis elegans, mgi  <cit>  for mus musculus, and tair  <cit>  for arabidopsis thaliana. since these species-specific databases are located in different sites on the web, there is need for integrated, searchable databases that contain annotations for multiple species. the go consortium has developed such a resource, called amigo  <cit> , that allows users to search and browse go annotations integrated from many species-specific databases. additionally, the european bioinformatics institute  has developed the gene ontology annotation  database  <cit>  that provides go annotations for non-redundant proteins from many species in uniprot  <cit> . we compare these two resources in the methods section. in addition to sequences annotated with go,  <dig>  functional domains in the interpro domain database  <cit>  have been linked to  <dig>  go terms  <cit> .

using the above-mentioned resources, there are two main types of methods developed to automatically annotate new gene products with go terms: sequence similarity-based methods such as gofigure  <cit> , goblet  <cit> , ontoblast  <cit> , gotcha  <cit> , and blast2go  <cit> , and sequence domain-based methods such as interproscan  <cit>  and gotrees  <cit> . for genome-scale go annotations the similarity-based, in particular blast-based methods have been the preferred choice  <cit> . blast is significantly faster than interproscan and can annotate many more go terms than interproscan can. a recent evaluation showed that assigning go terms of the top blast hit gave satisfactory results when compared with several more complex methods  <cit> . thus we chose the blast approach in our work.

after the sets of genes encoded in the two genomes are annotated with go, they can then be compared. the goal is to find functional categories that differ between the two genomes, which may explain differences in biological traits or suggest interesting families for further detailed investigation. the most common practice is to use tools such as goslim  <cit>  to tally the number of genes that fall within each functional category at the first level under biological processes, cellular components, and molecular functions, and then to compare between the two genomes. because the two genomes usually differ in size, the absolute numbers of genes in each functional category need to be weighted before they are compared; they are often divided by the total number of genes in the respective genomes  <cit> . the results of the unweighted and weighted comparisons are usually presented as bar charts or fold changes.

the unweighted and weighted go-based genome comparisons, although useful, have two drawbacks. first, focusing only on the high-level functional categories may miss differences that are detectable only at more refined levels. second, bar charts or fold changes alone are not sufficient to separate true functional differences from those occurring by chance; thus, statistical testing of significance is necessary. lessons can be learned from another, more extensively researched application of go—the detection of significantly enriched go categories in a set of co-expressed or differentially expressed genes in microarray experiments. several tools have been developed to search complete go trees  and apply statistical testing of significance .

contrary to the situation in microarray analysis, there is a surprising lack of statistical approaches for go-based comparison of two genomes. here we propose such a statistical approach to find reliable differences between the complete sets of genes encoded in two genomes at all levels of go. for each go term the abundance of genes in the two genomes is compared using chi-squared test followed by false discovery rate  correction. furthermore, to analyze the reliability of the differences detected, we studied two important issues. first, when new sequences are assigned go terms by similarity  to other sequences having known go assignments, the choice of blast cutoff may affect the results. we therefore analyzed the effects of employing a wide range of blast cutoffs. second, we studied how the results vary when only subsets of the genes were used. to our knowledge, our work is the first to address all the aforementioned issues.

we used this statistical approach to compare two cyanobacterial genomes, synechocystis sp. pcc <dig> and anabaena sp. pcc <dig>  cyanobacteria  are important model organisms for the study of photosynthesis, nitrogen fixation, evolution of plant plastids, and survival in diverse environments  <cit> . two of the most widely studied cyanobateria species are synechocystis sp. pcc <dig> and anabaena sp. pcc <dig>  pcc <dig> is a fresh water unicellular cyanobacterium incapable of nitrogen fixation  <cit> ; pcc <dig> is a filamentous, heterocyst-forming cyanobacterium that has long been used to study the genetics and physiology of cellular differentiation, pattern formation, and nitrogen fixation  <cit> . these interesting biological differences as well as the appropriate evolutionary distance between pcc <dig> and pcc <dig> make them a popular pair of species to compare and contrast <cit> . we compared pcc <dig> and pcc <dig> genomes using our statistical method and evaluated the detected statistically significant differences against known biological differences. to analyze how results change when only subsets of the genes are used, a larger set of statistically significant differences is desirable and we used the comparison of human vs. mouse and that of saccharomyces cerevisiae vs. schizosaccharomyces pombe genomes.

RESULTS
whole-genome go annotation
to annotate a new sequence, we used blast to compare it against a database of sequences with known go annotations. such a database should contain as many annotated sequences as possible from as many species as possible. amigo and goa are two primary choices for such a database. we compared amigo and goa, as shown in table  <dig>  both databases have unique merit. amigo has been integrated to a greater extent with other databases and provides a better browsing function on the web, whereas goa contains more sequences. for our purpose, it was attractive to have a larger collection of sequences for comparisons using blast, and thus we chose the goa database. we set the default blast cutoff e-value to be 1e- <dig>  with this method, a gene is assigned the go terms of its top blast hit in goa; it is also linked to all parent go terms by propagating the dag structures. finally, the number of genes assigned to each go term is tallied, representing the abundance of genes in each go function within the genome.

we were able to annotate  <dig>  genes in the pcc <dig> genome to  <dig>  go terms, and  <dig>  genes in the pcc <dig> genome to  <dig>  go terms.

testing the statistical significance of detected differences between genomes
for each go category, we used the chi-squared test to determine whether the numbers of genes from the two genomes were statistically significantly different  <cit> . since the total number of go categories is large, a large number of tests is required. we adopted the widely used fdr correction  to control the overall false positive rate  <cit> . we chose rather strict criteria to ensure reliability of the results; they can be set differently by other users.

we found seven terms in the go biological process category that were statistically significantly different between the two genomes, including "transition metal ion transport" , "di-, trivalent inorganic cation transport" , "cobalt ion transport" , "metal ion transport" , "protein amino acid phosphorylation" , "cellular biosynthesis"  and "nitrogen fixation" . these differences are shown in figure  <dig> and discussed below. 

the pcc <dig> genome contains significantly more genes in "cobalt ion transport"  compared with pcc <dig>  likely a consequence of the multicellular nature of pcc <dig>  close inspection showed that the statistically significant difference in parent nodes "transition metal ion transport" , "di-, trivalent inorganic cation transport" , and "metal ion transport"  is a consequence of the difference in the subfamily "cobalt ion transport"  rather than a cumulative effect of any other subfamilies. pcc <dig> contains significantly more genes than pcc <dig> in "protein amino acid phosphorylation" . these genes are responsible for critical protein kinase functions in the multicellular pcc <dig>  <cit> . the significantly greater number of genes in "nitrogen fixation"  in pcc <dig> is consistent with its ability to fix nitrogen, a function the simpler organism pcc <dig> does not have. the "cellular biosynthesis"  family differs from those above in that it is significantly more abundant in pcc <dig> than in pcc <dig>  this result may be a consequence of pcc6803's rapid growth capability.

we compared the two genomes with regard to the go molecular function category and obtained similar results. we then compared them with regard to the go cellular component category and found three statistically significant differences: "cytoplasm" , "integral to membrane" , and "intrinsic to membrane" , all of which are more abundant in pcc <dig> than in pcc <dig> 

we compared our results with results from traditional go-slim-based, weighted comparison. as shown in figure  <dig>  the fold difference in the go-slim-based comparison ranged from  <dig>  to  <dig> . the fold difference gave only a rough indication of how much pcc <dig> and pcc <dig> differ in each high-level functional category. in addition, go-slim-based approach compares two genomes at only the high level, as opposed to our approach that compares at every level and every node. many important functional differences between two genomes may be detectable only at a finer level. for instance, go-slim-based approach found little difference between the two cyanobacteria for goslim term "metabolism, go:0008152" in the biological process category , whereas our approach found that the two species differ significantly in the sub-term "nitrogen fixation, go:0009399", one of the most important known functional differences.

effect of different blast cutoffs
we varied the blast e-value cutoff to study its effect on the number of statistically significant terms detected as well as the number of common terms between adjacent cutoffs. as shown in figure  <dig>  when the e-value cutoff is high , the result is sensitive to the change in cutoff. the results stabilize around cutoff values of 1e- <dig> to 1e- <dig>  we chose a default cutoff of 1e- <dig>  which coincides with that chosen by goblet  <cit> .

effect of partial data
using the go-based comparison method, we compared the human and mouse genomes and found  <dig> statistically significantly different go terms. we randomly sampled 90% from each of the input gene sets for  <dig>  times and compared the statistically significantly different go terms from each sampling with those from the whole data. as shown in figure  <dig> , most of the go terms occurred in the majority of the samplings;  <dig> of the  <dig> go terms occurred  <dig>  times in all sampling results, whereas at the lower extreme three go terms occurred only  <dig> times. this analysis offers an additional measure of reliability of the significant terms detected. the more times a term occurs in the samples, the more reliable it may be. we plotted the distribution of the "unique go terms"—significant terms detected in one or more of the samples but not in the whole data set—and found that they occurred in as few as one and as many as  <dig> samples . as shown in figure  <dig>  the histogram distributions of the common and unique go terms overlap slightly. we sampled 60%, 70%, and 80% of the input genes, respectively, and observed similar patterns . we performed analysis of the comparison of the two yeast genomes of saccharomyces cerevisiae and schizosaccharomyces pombe and also observed similar patterns .

discussion
blast and interproscan are two most widely used automated go annotation methods. blast is the preferred choice for genome-scale annotation because it runs much faster and, perhaps more importantly, can annotate many more go terms than interproscan can. we had used interproscan to annotate and compare pcc <dig> and pcc <dig>  and found that it missed some important differences including "nitrogen fixation, go:0009399". however, blast has its own limitations. accurate functional assignment is difficult in cases where the match is less well defined due to lower sequence similarity  <cit> . in future research we will investigate how to combine results from blast and interproscan to improve annotation quality and use grid computing to reduce computation time.

we used blast e-value cutoff as the criteria in assigning go terms. local sequence alignment programs such as blast may prefer short strong matches to long weak matches and may cause inaccurate go assignment. the strict e-value cutoff we chose in our analysis ensured the relatively high quality of the results. it was reported that a match between two sequences is most likely reliable if the alignment is at least  <dig> residues in length with at least 40% sequence identity  <cit> . we investigated the quality of the hsp  in our blast results . with e-value cutoff 1e- <dig>  the minimum length of hsp was  <dig> and the minimum sequence identity was 68%. thus the assignments in our results were reliable. it is possible that false negatives may occur with a strict cutoff. in our analysis we prefer accuracy to coverage. others can use different criteria depending on their individual goals. the statistical testing we proposed in this paper is independent of the go assignment method. we suggest doing the comparison and comparing the results using different e-value cutoffs and different subsets of the input gene sets to identify the most reliable differences between two genomes.

in any go analysis, the quality of the original go annotation is critical. the go annotation data are continuously expanded; however, the present data are incomplete and noisy  <cit> , and the annotation quality is uneven, with a mix of literature-supported annotations and those inferred automatically. we did not modify the go annotation data for our present study, but further research will consider the quality of the original go annotations when assessing the reliability of the results. one limitation of our approach is that it only compared the number of genes in each functional category. it cannot capture differences in the level of gene expression. another inherent limitation of go is that it does not map directly to pathways. as a result go-based comparison cannot detect differences at the pathway level. we have recently used the kegg orthology  as an alternative controlled vocabulary in a ko-based annotation system  and demonstrated that kobas is effective in automated annotation and pathway identification  <cit> . in future research we will investigate ko-based comparison to compare two genomes at the pathway level.

our goal is to achieve higher confidence in the differences detected between two genomes. towards this end, we applied rigorous statistical testing followed by fdr correction instead of simply relying on fold changes. we also tested a wide range of blast cutoff values and different subsets of the input genes to provide additional measures of confidence in the results. if results beyond those having the highest confidence are required, then the cutoff values can be relaxed. the advantage of the statistical approach presented here is that, no matter what cutoff values are chosen, the resulting p-values, q-values, and sampling analysis can be used to assess the confidence in the results.

there are other procedures available to correct false positive rates resulting from multiple testing, including the bonferroni correction, sidak stepwise correction, holm stepwise correction, hochberg's stepwise correction, and others  <cit> . we chose the fdr correction because of its overall high quality and computational speed  <cit> . it is also the most common procedure used in go-related and microarray analyses  <cit> .

CONCLUSIONS
contrary to the situation in microarray analysis, there is a surprising lack of statistical approaches used in go-based comparison of two complete genomes. our work is the first to propose and test a statistical approach to comparing the complete sets of genes in two whole genomes at all levels of go and study the effect of varying blast cutoffs and using subset of the input gene sets. we believe that such an approach can provide a measure of confidence in the identified differences and help ensure the reliability of the results.

