BACKGROUND
identifying the genetic factors that influence the pathogenic potential of microorganisms is of the greatest importance in trying to gain better control of infectious diseases. legionella pneumophila, the causative micro-organism of legionnaires' disease , is an aquatic bacterium that can be found in numerous water sources. several aerosol-producing systems have become associated with ld outbreaks . the financial, economic and social impacts of these outbreaks can be enormous and many countries have implemented governmental laws or guidelines to prevent the growth of legionella bacteria in potential sources. in most regulations, disinfection strategies are used independent of the isolated legionella strains, as there is no reliable method for differentiating between clinical and environmental strains. in the netherlands, this has led to a confounding situation in which, despite an estimated expenditure of several billion euros since  <dig>  the incidence of ld has steadily increased  <cit> . one explanation for this might be the lack of focus in combating legionella risks: all legionella species are considered equally dangerous, with no attention being given to clinical data on ld, even though over 95% of ld cases are caused by l. pneumophila. furthermore, within the species l. pneumophila, serogroup  <dig> is involved in over 80% of cases  <cit> . as has already been demonstrated with guinea pig models in the 1980s, some serogroup  <dig> subtypes are more virulent than others  <cit> . this difference in virulence across serogroups and subtypes appears to be due mainly to the better-developed replicating and apoptosis skills of l. pneumophila strains, especially in serogroup  <dig>  <cit> . epidemiological studies have also provided some clues on virulence. a particular lipopolysaccharide epitope, recognized as mab  <dig> by typing with a panel of monoclonal antibodies obtained from a range of geographical locations, is more frequently expressed on patient derived isolates than on environmental isolates of serogroup  <dig> strains. furthermore, fingerprinting of l. pneumophila strains has shown that the genotypes of isolates from patients and from the environment differ markedly  <cit>  indicating that a genetic base for differences in virulence does exist. however, the nature of this genetic base has been fully unclear until now. also genomic analysis of  <dig> l. pneumophila strains collected world-wide could not identify specific hybridization profiles differentiating clinical and environmental strains  <cit> . to identify molecular markers related to virulent behavior, we have combined two different worlds. we used comparative genome hybridization  based on a mixed-strain microarray containing genetic information from both clinical and environmental isolates. this molecular analysis was performed with a large collection of well-described bacterial isolates derived from a large surveillance study in the netherlands in which both patient-derived strains and environmental strains were collected. we investigated whether the application of such a molecular analysis on a well-defined strain collection was capable of identifying dna markers that would allow for discrimination between clinical and environmental isolates. in this way we have identified five markers that together constitute a model highly predictive for clinical strains.

RESULTS
strain collection
the basis of this study is formed by the strain collection from the dutch legionella surveillance program. this collection encompasses all patient-derived strains from notified cases in the netherlands in the period from 2002- <dig> and all environmental strains that were collected in an attempt to identify the source of infection for those patients. the l. pneumophila isolates from the patients' environments were genotypically compared with the patient strain. non-matching isolates from the environment were defined as environmental. patient strains and matching isolates from the environment were defined as clinical. the collection of environmental strains was completed with isolates from sources located in surroundings geographically free of ld patients according to the registration history of notified cases. all l. pneumophila strains were serotyped, and the serogroup  <dig> isolates were analyzed by amplified fragment length polymorphism  analysis according to the european working group on legionella infections  format  <cit> . in total,  <dig> strains from this collection of clinical and environmental l. pneumophila isolates were selected for further analysis in this study . a representative part of this selection  was analyzed by aflp . a broad variety of patterns is present, indicating the genomic diversity within this species and the random selection of the isolates from the natural genomic diversity of l. pneumophila strains.

microarray construction and unsupervised analysis
comparative genome hybridization experiments were performed with a mixed-genome l. pneumophila microarray. for the construction of this microarray, eight l. pneumophila strains were selected based on their diversity . this microarray consisting of  <dig> genomic fragments was used to analyze the genome composition of the collection of  <dig> unique l. pneumophila strains by comparing labeled dna from each strain with a reference containing labeled dna from the mixture of strains used for array construction. in total,  <dig> datasets were generated each representing a fingerprint encompassing over  <dig> different markers. the data for all spots on all microarrays were calculated as ratios between the tester strain and the reference with normalization for experimental differences . these data were used for unsupervised statistical analysis of the relationships between all strains with respect to genomic composition. principal component analysis of all  <dig> cgh-data sets resulted in a good overview and allowed us to draw a number of conclusions important for follow-up work. first, results from repeat experiments  showed the high reproducibility of this approach . next, this analysis also showed that the overall genomic patterns  of the environmental l. pneumophila isolates were found throughout the distribution of the patterns obtained from the patient-derived strains , indicating that no genome wide differences between the two groups exist. furthermore, no small outlier populations or single outlier strains were observed with the exception of a small number of datasets obtained from legionella species other than l. pneumophila. these strains were not present in the  <dig> strain dataset and were excluded from all further analyses. this result indicated to us that the genomic diversity of the species was well covered by the  <dig> selected strains and that there was no need for analyzing additional strains.

marker reduction and binarization
unsupervised statistical analysis of the data obtained for the  <dig> strains did not allow for discrimination between clinical and environmental strains. since these analyses are based on overall trends in data this inability to discriminate is not surprising. it is much more likely that a small part of the genome is involved in a specific genetic trait such as pathogenic potential. therefore, supervised multivariate statistical analysis of the complete data set was also used in order to find support for the hypothesis that discrimination between clinical and environmental strains is feasible. although this analysis indicated that discrimination was possible the method used for this analysis  was not optimally suited for reliable statistical significance analysis, nor for selecting a minimal set of predictive markers. therefore, a different data analysis approach was taken. first, the number of markers was reduced based on the observation that approximately 80% of the  <dig>  markers were present in all strains and therefore encompassed the l. pneumophila core genome. the remaining 20% of the markers showed clear variation in presence between individual strains and encompassed the variable part of the genome. further reduction of the number of markers was achieved by taking only a few representatives in those cases where multiple markers showed nearly identical patterns over the complete data set . in total,  <dig> markers were selected in this way and this selection was used for all further analyses .

next to reducing the number of markers another preprocessing step was included. closer examination of the selected markers in most cases suggested a binary distribution of values, most likely representing either the apparent presence or absence  of specific genetic elements. since this binary distribution probably represents the real-world situation among strains and also favors the practical applicability of analyzing selected markers, we decided to continue our analyses by converting our linearly distributed data into binary values representing the presence or absence of each marker. a number of methods have been described in recent years to perform binarization of markers, but none of these performed sufficiently well. some of these methods are rather simple, being based on a preset cut-off  or a standard deviation-based classification. we tried the more advanced gack approach  <cit>  based on the shape of signal ratio distributions; although this method worked reasonably well in general, we were not satisfied by its overall performance. one possible explanation for this is the fact that this method was developed for single strain  microarrays whereas the microarray used in this study is based on multiple genomes. another explanation is the fact that the generalization of cut-off selection, which is also part of this method, leads to unsatisfactory results for part of the data. we therefore had a closer look at our data and found an alternative solution which is based on the distribution of all ratios for each individual marker to determine an individual marker-dependent cut-off value. in cases where no clear cut-off could be determined all data points were classified as being present. in cases where multiple cut-offs were possible we decided to apply multiple cut-offs by splitting up these markers and using these multiple variants of the same marker for further data analysis. other available binarization methods tend to ignore this last category in particular. some examples of this binarization approach are shown in additional file  <dig>  binarized data are given in additional files  <dig> and  <dig>  hierarchical clustering of the binarized data shows the enormous amount of variation still present in this data set . a number of conclusions can be drawn from this analysis. first, although some clustering can be observed for the strains for which aflp data were generated this clustering does not indicate segregation into specific groups . next, the absence of clear discrimination between environmental strains and patient-derived strains is visualized . finally, the distribution of strains used as training and test set  shows a fair amount of random variation . no single markers were detected which enabled clear discrimination between patient-derived and environmental strains based on the overall datasets. since no clear discrimination between environmental and patient-derived strains was obtained with these unsupervised analyses attention was shifted towards the application of supervised analyses. the binary data were used as input data for these analyses.

selection of discriminating markers
many supervised statistical analysis methods have been described for analyzing microarray data  <cit> . a limitation of many of these methods is the fact that they use a data reduction approach which makes it difficult to select a minimal set of markers. we have chosen as a method for selecting a minimal set of predictive markers a machine learning technique called genetic programming  <cit> . genetic programming  is a machine learning approach that provides a collection of solutions to biodiagnostic problems by creating classifier programs using a subset of the available input. a "genetic pool" of candidate classification programs was created by randomly choosing inputs and arithmetic and boolean operators that work with the inputs selected, and evolving successive generations of programs were through selection and recombination. the accuracy of a program in correctly classifying the samples according to pre-specified classes is used to calculate a fitness measure for each program. fitness was determined by calculating the area under the curve  for the receiver operating characteristic  of a program generated by the gp system  <cit> . evolution was driven by improving the auc  so as to yield rules with high sensitivity and specificity. the complexity of the rules generated was also restricted to prevent overfitting of the training data. the programs were evolved over many generations resulting in progressively better and more accurate programs. the stopping criterion was either a perfect classifier within the limits of program size and complexity, or the generation limit was reached. table  <dig> shows a list of the inputs, operators, and gp parameters such as fitness function, population size, crossover and mutation frequencies, etc.

the genetic programming system used is a patented system  <cit>  and adapted for use in bio-classifier problems such as that described here. the source code for this implementation has not been published, but other than the representation of programs, it is a fairly standard implementation of steady-state genetic programming using both crossover and mutational operators on tree-like structures. this system was adapted to evolve classifier programs by creating mathematical models and assigning a slice point based on maximizing the auc for the model  <cit> .

reducing the dimensionality of the data is of foremost importance in most analysis programs. here we have used gene frequency , to identify the markers that provide the most value for developing an accurate classifier, an approach that borrows from the "symbolic discriminant analysis" method  <cit> . cross-validation-based resampling  <cit>  was used to estimate the ability of the classifier to generalize to unseen samples, giving an approximation of its robustness. classifier sets  are composed from the best rules from each fold. the ensemble is then "polled" with each rule in the ensemble voting on whether a sample belongs to a target class. if the majority of the rules  agree that the sample belongs to the target class , the ensemble predicts the sample belongs to the target class. aggregate performance of these ensembles on the test folds was taken as the predictor of the classification error, and the selected ensemble was the one with the smallest test error.

the approach used for the legionella strain data was as follows:

first, the data set was split in two: a learning set of  <dig> samples was used for creating a predictive model and a reserved validation set consisting of  <dig> samples was kept apart for testing of the model. using the  <dig> samples  from the learning set, which was classified as approximately 50% clinical and 50% environmental, a predictive rule was developed that identified clinical strains. the goal was to identify 100% of the clinical strains correctly while keeping the number of misclassified environmental strains as low as possible . to do this, the control parameters of the genetic programming system were modified to give a larger bias towards achieving higher sensitivity compared to the specificity. a sevenfold cross-validation-based resampling of the  <dig> samples was used, as this provided a large enough training set while leaving a reasonable test set in each fold  <cit> . from the results of the first set of analytical runs, the  <dig> most frequently used markers were selected based on the frequency of the genes appearing in the best rules of  <dig> runs using the average length of the rules created in each run. the genetic programming system was then run again with only these  <dig> markers to develop an ensemble of classifiers that show good performance  <cit> . this analysis resulted in the selection of an optimal model out of the various solutions on offer; this model consisted of  <dig> markers and resulted in a sensitivity of 100% and a specificity of 62% . the  <dig> marker model consists of  <dig> rules containing all relevant interrelationships between the  <dig> selected markers. the majority vote of these  <dig> rules determines the final prediction .

the  <dig> rules of the predictive model describing all relevant relationships between the  <dig> selected markers. each rule "votes" for a sample as being a clinical sample if the result of the rule evaluates to 'true' when the boolean value for each probe is entered. if  <dig> or more rules in the table agree that a given sample is clinical, then the "meta-rule" of these  <dig> rules predicts that the sample is clinical.

validation of the model
since the model obtained was based on a learning set of  <dig> data sets  we were able to use an additional  <dig> data sets  not employed for building the model as a reserved validation set. application of the model to these additional data sets confirmed the results from the learning set: a sensitivity of 100% and a specificity of 69% were obtained with this validation set . although this is not an external validation in a formal sense  these results clearly support the validity of the predictive model.

identity of selected markers
sequence analysis of the  <dig> selected markers enabled comparison with known legionella sequences. three out of the  <dig> markers showed variable presence in the  <dig> completely sequenced clinical isolates of l. pneumophila  whereas two other markers were present in all  <dig> sequenced genomes. since these markers showed differential presence in the strain population we have analyzed, this indicated that the sequenced genomes do not completely cover genomic variation in l. pneumophila. one marker  represents part of l. pneumophila plasmid plpp; it cannot be concluded based on the current data whether the plasmid is freely present in the bacterial cell or whether  the plasmid dna is inserted in the genome. the other  <dig> markers represent chromosomally derived fragments probably related to cell wall synthesis , conjugative coupling factor  and hypothetical . details on these markers will be presented elsewhere.

absence of homologues indicates that no high similarity homologue is present. the sequences are accessible through genbank accession numbers hm584933-hm584937).

discussion
to study the genomic diversity within l. pneumophila in more detail a mixed-genome microarray was developed for this species. this approach has shown to be very useful for studying genome diversity in other bacterial species such as streptococcus pyogenes and enterococcus faecium  <cit> . by selecting clinical as well as environmental strains for microarray construction gene loss and acquisition in both groups of strains can be identified. this is a clear advantage over the more commonly used genome-sequencing approach which mostly focuses on clinical strains, thereby dismissing the ability to identify differences between environmental and clinical strains. here we show the feasibility of this discrimination for l. pneumophila, the causative microorganism for legionnaires' disease. clinical isolates of this bacterial species could be identified in 100% of the cases based on a model consisting of  <dig> dna markers. this result will enable a more detailed analysis of legionella-contaminated water sources and help to recognize potential public health dangers before the onset of new ld outbreaks.

to achieve this result, two factors are of utmost importance: the use of an unbiased genomics approach and the availability of a well-defined and well-characterized bacterial strain collection. when studying pathogenicity, the availability of clinical strains is relatively straightforward, especially if a surveillance program is ongoing, as is the case in the netherlands for l. pneumophila. collecting reliable environmental strains, however, is far more difficult. probably the biggest issue in considering a strain as non-pathogenic is the question of whether the specific isolate lacks the potential to be pathogenic or just did not have a chance to exhibit pathogenic behavior. in the case of the dutch legionella surveillance program, not only were patient isolates collected, but also attempts were made to track the infectious source by analyzing the environment in which a patient lived. this was done by analyzing hot water systems in homes and water systems in caravans used by patients, and analyzing swimming pools, saunas and other potential sources visited by patients shortly before getting ill. in a number of cases a match could be made between an environmental isolate and the patient isolate but, in most cases, isolates identified in a patient's environment were shown to be different from the patient strain. it seems very likely that the patient in these cases had been in contact with the specific environmental isolate and did not become ill, but did become ill from another isolate; this, in combination with the registration history of notified cases for those potential sources, leads us to conclude that this is the safest definition currently possible for non-pathogenic strains. therefore, we have used this strain collection for a genomic analysis of differences between clinical and environmental strains, while understanding that it is still possible for an environmental strain to be pathogenic.

we have generated genomic fingerprints for  <dig> unique l. pneumophila strains and used these to select dna markers enabling discrimination between clinical and environmental l. pneumophila strains. the rationale behind this approach is the hypothesis that bacterial species are not a homogeneous group of organisms but contain significant individual variation at the nucleotide level  and at the genome composition level . in order to analyze genome composition variation, we have developed our genomotyping platform. when applied to pathogenic micro-organisms this type of analysis might lead to more detailed discrimination between the real pathogenic strains within such a species and the non-  pathogenic strains. since genomic differences between bacterial strains probably lead to physiological differences, better ability to discriminate between strains may lead to better understanding of the pathogenicity process itself and to more focused diagnosis, treatment or therapy. in many cases, the major hurdle for applying this approach is the lack of well-characterized bacterial strain collections. in the case of l. pneumophila, we were fortunate to have access to a very well-characterized strain collection with respect to clinical as well as non-clinical  isolates. the use of this strain collection combined with our genomotyping platform and novel way of analyzing genomic data has led to the selection of five dna markers that together can discriminate between clinical and environmental l. pneumophila strains with high reliability. genetic programming was instrumental in the selection of this minimal set of predictive markers and in the definition of the relationships between the individual markers. the inclusion of these relationships is an essential step since a univariate approach looking at each marker individually would never have selected some of our five markers. in addition, some markers are important because they are nearly always absent in clinical strains and would never have been identified if environmental strains had not been included during array construction. these aspects are often ignored when identifying predictive markers, but they fit perfectly with the kind of relationships that play a central role in biology.

attempts have been made previously to identify pathogenicity markers by, e.g., comparing the complete genome sequences of clinical and environmental strains. the disadvantage of such an approach is the fact that there are usually dozens to hundreds of differences detected, only a few of which may be important with regard to the property under study. furthermore, in most cases there is an emphasis on the clinical strains  have only a limited resolution, or they have a high resolution but focus on genes not involved in pathogenicity  of core genome/house-keeping genes  <cit> . cazalet et al  <cit>  described a multigenomic analysis of a large number of legionella strains, but their aim was not to select a minimal set of predictive markers. furthermore, their analysis was based on a microarray derived from genomic sequences of clinical strains only. in the work presented here, a combination of two different approaches was used, combining a population-based view with a detailed molecular analysis. when performed as described here, this is a technically feasible and relatively inexpensive way to identify predictive markers. there are multiple ways to translate these markers into practical applications which, in this case, can have a significant impact on control of ld. dutch regulations are focused on finding legionellae in water systems, especially in relation to vulnerable populations in care facilities, but also in relation to hotels and public buildings. positive cultures of water samples call for immediate action, including implementation of costly measures and potential closing of wards or buildings. the ability to differentiate between clinical and environmental strains can be used as a tool to fine-tune control procedures. furthermore, in the case of l. pneumophila as well as other micro-organisms, the described technique may act as a starting point for the development of new diagnostics and therapeutics.

CONCLUSIONS
in conclusion, a novel way of studying the genome composition of l. pneumophila combined with the availability of a l. pneumophila strain collection derived from a surveillance program allowed us to search for genomic differences between patient-derived and environmental strains of this bacterium. by using genetic programming  <dig> markers could be selected which together enable a reliable identification of clinical strains. this opens up the way for novel diagnostic approaches better suited to recognize clinical l. pneumophila strains. this may also help to improve the confounding situation that despite increased awareness and preventive measures the incidence of ld is still increasing in the netherlands. furthermore, detailed analysis of the identified markers may lead to better understanding of l. pneumophila virulence and to improved protective measures.

