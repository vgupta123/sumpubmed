BACKGROUND
some dna microarray studies may target discovery of individual genes whose expressions are associated with a phenotype. useful statistical approaches have been proposed for such individual-gene analyses, for example, significance analysis of microarray  in  <cit> . in many instances, however, the goal of studies is in the assessment of biologic pathways, or a priori defined gene sets, in association with a phenotype, i.e., gene-set analyses. computationally, gene-set analyses require an additional consideration over individual-gene analyses, namely, the incorporation of gene sets into an association measure. mootha et al.  <cit>  proposed gene set enrichment analysis  for gene-set analysis, utilizing the kolmogorov-smirnov statistic to measure the degree of differential gene expression in a gene set across binary phenotypes. gsea was revised in  <dig> by the same research team, replacing the kolmogorov-smirnov statistic with its weighted version to avoid certain deficiencies in the original gsea method  <cit> . many methods have been proposed since for gene-set analyses: see a recent excellent review by goeman and bühlmann  <cit>  and their criticisms on the majority of the existing methods. among the work not covered by the review by goeman and bühlmann, tian et al.  <cit> , in particular, made an important contribution by distinguishing different types of hypotheses in gene-set analysis, and proposed a permutation-based inference using the sum of t-statistic across genes in the gene set as a test statistic. in spite of the large number of gene-set analysis methods, however, gsea remains by far the most widely used gene-set analysis method to date.

we propose here an alternative, an extension of sam, to gene-set analysis, called hereafter sam-gs. this is motivated by our observation that gsea, in both the original and revised versions, fails to satisfy certain required properties that a gene-set analysis method should satisfy: for example, a gene-set analysis should not indicate an association for a gene set in which no gene is associated with the phenotype. in this paper, we first illustrate the behavior of gsea in relation to a few simple, required properties of a gene-set analysis method and compare it with the behavior of sam-gs, using a mouse-microarray kidney-transplant dataset. we then re-analyze, by sam-gs, three dna microarray datasets with which the application of gsea was illustrated in  <cit> , showing appreciable differences in the analysis results. the differences of the results are discussed from both biologic and statistical points of view, pointing out clear advantages of sam-gs over gsea.

RESULTS
gene-set simulation experiment
using a mouse-microarray kidney-transplant dataset, we assessed if gsea and sam-gs satisfy the following simple requisite properties for any methods designed to perform a gene-set analysis:

 if the gene set s consists of genes whose expressions are consistently not associated with the phenotype d, the method should not indicate that s is associated with d.

 if the gene set s consists of a mix of genes with moderate to strong and weak associations of expressions with the phenotype d, such that an appreciable subset of the genes in s are moderately or strongly associated with the phenotype d, the method should indicate that s is associated with d.

 the size of the gene set s should not greatly alter the statistical significance in  and .

we performed two tests using the mouse-microarray kidney-transplant dataset with simulated gene sets. for test  <dig> intended to assess property , the gene sets were randomly generated from the null hypothesis region: the expression of genes in these null gene sets were not associated with the phenotype. a sensible gene-set analysis method should not identify these gene sets as statistically significant. for test  <dig> intended to assess property , the gene sets were generated randomly from an alternative hypothesis region: the expressions of 50% of genes in each gene set were associated with the phenotype either moderately or strongly. a sensible gene-set analysis method should identify these gene sets as statistically significant.

tables  <dig> and  <dig> show the percentages of  <dig> randomly-generated gene sets whose expressions were found to be associated with the phenotype with a p-value ≤  <dig> , by the gene-set analysis method of interest , under each gene-set sampling region considered. in test  <dig>  null gene sets were generated by randomly sampling genes from genes with |r| <c, where r denotes the pearson correlation coefficient of the gene expression with the phenotype and c was  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , or  <dig> . the results in table  <dig> indicate that gsea does not satisfy requisite property , because it identified many of these null gene sets to be associated with the phenotype with a p-value ≤  <dig> . in test  <dig>  truly-associated gene sets were generated by randomly sampling half of the gene set's genes from genes with |r| = c and remaining half from genes with |r| <c, where c was  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , or  <dig> . the results in table  <dig> indicate that gsea does not satisfy requisite property , because it did not identify many of these truly-associated gene sets as statistically significant with a p-value ≤  <dig> . moreover, gsea does not satisfy property , as the performance of the method varies greatly with gene-set size.

the results of these tests illustrate two situations where gsea fails. one is where genes in a gene set cluster somewhere other than in the strong-association region  and gsea identifies the gene set to be statistically significantly associated with the phenotype. figure  <dig> illustrates this situation with one of the null gene sets of test  <dig>  where the gene set's genes clustered in the region of no or weak association with the phenotype, and yet gsea p-value of this gene set was <  <dig> . in short, gsea will indicate that gene sets with any clear clustering are statistically significant, regardless of where the clustering occurs. the other situation is where a gene set has a mixture of moderately or strongly associated genes and weakly associated genes. this mixture within a gene set seems biologically plausible: not all genes in a phenotype-associated pathway will show changes in relation to the phenotype. gsea has very poor power for detecting a differentially-expressed gene set under such mixed situations , unless the clustering of some of the gene-set members occur at the moderate-strong association region 

to check whether sam-gs satisfies the three requisite properties of a gene-set analysis, the same tests were applied as for gsea, using the same randomly-sampled simulated gene sets. the results of tests  <dig> and  <dig> displayed in tables  <dig> and  <dig> indicate that sam-gs satisfies properties  and . moreover, sam-gs satisfies property , as its performance did not vary with the size of the gene set.

gene-set analyses of the three datasets with biologically defined gene sets
we compared the performance of the two methods, gsea and sam-gs, on the analyses of biologically defined gene sets using three microarray datasets considered in  <cit> : the sex, p <dig>  and leukemia datasets. the sex dataset consists of mrna expression profiles from lymphoblastoid cell lines derived from  <dig> males and  <dig> females . the p <dig> dataset consists of expressions for  <dig> cell lines from the nci- <dig> collection of cancer cell lines, for which mutational status of the p <dig> gene has been reported, with  <dig> being classified as wild-type, and  <dig> as carrying mutations in the gene . the leukemia dataset consists of gene expression profiles of cells from  <dig> acute lymphoid leukemia  patients and  <dig> acute myeloid leukemia  patients . the pathways are organized in two catalogs, c <dig> and c <dig>  the c <dig> catalog includes gene sets corresponding to human chromosomes and cytogenetic bands, while the c <dig> catalog includes gene sets that are involved in specific metabolic signaling pathways  <cit> . the results by gsea and sam-gs are summarized in table  <dig>  in the sex-comparison analysis, the two methods agreed on the associations  with the three y associated gene sets, the testis-expressed gene set , and the gene set with genes that escape x inactivation. in addition, sam-gs established an association with the chrxp <dig> gene set . in the p53-comparison analysis, sam-gs and gsea agreed on a subset of gene sets with an fdr ≤  <dig>  that included the gene sets of hsp <dig>  p53_up , p <dig> hypoxia, radiation sensitivity , and p <dig> . however, sam-gs identified additional  <dig> gene sets with an fdr ≤  <dig> , all of which had an fdr ≥  <dig>  for gsea. these gene sets are shown in table  <dig>  in the leukemia-comparison dataset, the two methods gave even more discrepant results than the p53-comparison analysis. gsea identified only five gene sets with an fdr ≤  <dig>  , whereas all of the  <dig> gene sets were statistically significant  by sam-gs. note that the individual-gene analysis showed that 80% of the individual genes in this comparison had an fdr ≤  <dig> , which is in line with the gene-set analysis results of sam-gs.

* fdr = false discovery rate estimate

† auc = area under the roc curve

‡ taking sam-gs p ≤  <dig>  as the target to be predicted

§ all gene sets in the leukemia dataset had sam-gs p ≥  <dig> 

these discrepancies between the two methods are summarized along with the sensitivity and specificity of the gsea p-value ≤  <dig>  and the area under the receiver operating characteristic curve of gsea p-value in predicting the sam-gs p-value ≤  <dig>  . specifically, sensitivity was calculated as the proportion of gene sets with gsea p-values ≤  <dig> , out of all gene sets with sam-gs p-values ≤  <dig> . specificity was calculated as the proportion of gene sets with gsea p-values >  <dig> , out of all gene sets with sam-gs p-values >  <dig> .

gsea
our tests  <dig> and  <dig> suggest that gsea does not meet some simple requisite criteria for a gene-set analysis method. in particular, test  <dig> results suggest that, in a typical microarray experiment involving genes with different degrees of association with the phenotype, gsea would frequently identify gene sets as statistically significant when all of its genes have observed expressions completely uncorrelated with the phenotype . this is not a logical behavior for a gene-set analysis method. biologically, if a gene set is identified as having expressions that are significantly associated with a phenotype, the gene set should contain at least some genes whose observed expressions are associated with the phenotype. statistically, the false discovery rate of gsea for a truly null gene set, tested among truly non-null gene sets, would be appreciably elevated because the observed correlations of the null-gene-set genes with the phenotype would tend to cluster near zero. although the gene sets in tests  <dig> and  <dig> are randomly-sampled simulated sets, they are not unrealistic gene sets. for example, a test  <dig> situation was encountered in the analysis of the sex dataset, where gsea gave the "cell-cycle arrest genes" a p-value of  <dig>  in association with sex . no gene in this gene set has an absolute value of the pearson correlation of  <dig>  or greater, or the sam p-value <  <dig> : this clustering is thus identified incorrectly by gsea as showing a significant association, failing test  <dig>  a test  <dig> situation was encountered, for example, in the analysis of the leukemia dataset, where gsea failed to identify the gene set "chr10q24", even though  <dig> of the  <dig> genes in the gene set had absolute values of the pearson correlation of  <dig>  or greater  and the chromosomal location of the gene set is biologically relevant given the role of hox <dig> in t-cell all. the use of gsea is subject to appreciable false positive and negative findings, as illustrated by the two tests and the results shown in table  <dig> 

another critical problem of gsea is its relative ranking of genes in a gene set in relation to the other genes outside of the gene set. the use of a relative measure in gsea, rather than an absolute measure, means that important information on the degree of association between each gene and the binary phenotype is discarded. for example, the leukemia dataset had 80% of its  <dig>  individual genes with an fdr ≤  <dig> . regardless of whether such clear differences in gene expression across the binary phenotype are determined by biology, or by more mundane  differences in sample collection or handling, a gene-set analysis of this dataset should find that many gene sets are associated with the phenotype. gsea, however, found only five gene sets with an fdr ≤  <dig>  in the leukemia-comparison analysis, inconsistent with the individual-gene analysis results. the cause of the inconsistency is the use of the relative ranking in gsea. in contrast, sam-gs found all gene sets in the leukemia dataset to have an fdr ≤  <dig> .

a related, perhaps less serious, issue with gsea is that, when an individual gene set is of biologic interest, the sam-gs analysis requires measurement only of the expression of the genes in the gene set to construct the test statistic , whereas gsea requires measurement of the expression of all genes to provide a relative ranking of all genes. the expression levels of the other genes should not affect the inference on an individual gene set of interest, if the individual set is, indeed, the only biologically relevant variable.

another problematic aspect of gsea is that its enrichment score considers genes with positive and negative associations with the phenotype separately, even when they have the same degree of associations with the phenotype. thus, a gene set with a mix of genes with positive and negative associations with the phenotype, although biologically plausible , is not appropriately evaluated for association with the phenotype by the enrichment score and, therefore, has an improperly low probability of being detected as a phenotype-associated gene set by gsea.

a gene-set analysis utilizes existing biologic knowledge that maps individual genes into gene sets or pathways. because of the utilization of existing knowledge in the analysis, a well conducted gene-set analysis can be remarkably powerful. the p <dig> analysis illustrates this point. although a very small proportion of individual genes had low p-values in the p <dig> dataset, sam-gs indicated larger proportions of gene sets with low p-values. this is because a valid gene-set analysis would take into account a tendency among multiple genes in a gene set. thus, even if the association of each gene with the phenotype is only moderate, a collection of such genes can be indicated as a phenotype-associated gene set; genes in a gene set need not have the same degree and direction of association with the phenotype for the gene set to be identified as statistically significant by sam-gs.

in addition to the leukemia-comparison analysis discussed above, which showed an advantage of sam-gs over gsea empirically through the consistency of the gene-set analysis results with the individual-gene analysis results, the other two dna-microarray analyses  provided empirical biologic evidence supporting the advantage of sam-gs over gsea. regarding the sex-comparison analysis, subramanian et al.  <cit>  specifically argue that they would not expect to find enrichment for bands on the x chromosome because most x-linked genes are randomly silenced in females and, therefore, are unlikely to show a male-female  difference. this argument has general merit; however, in the specific case of the chrxp <dig> gene set, it does not hold because, on the distal portion of the short arm of x, there is a cluster of genes that escape x-inactivation. indeed, the top five genes of the chrxp <dig> gene set escape inactivation: two of the five are members of the x-inactivation-escape gene set whose fdr was ≤  <dig>  by both methods; and the other three have been reported to escape x-inactivation  <cit> .

the differences in the results of the p53-comparison analysis illuminate biologically relevant performance differences between the two methods. it is appropriate to ask whether the  <dig> additional pathways identified by sam-gs over gsea are plausibly associated with the presence vs. absence of p <dig>  of the  <dig> gene sets,  <dig> actually involve p <dig> directly as a member. a further  <dig> gene sets directly involve the extrinsic and intrinsic apoptosis pathways  <cit> ,  <dig> involve the cell-cycle machinery, and  <dig> involve cytokines and/or jak/stat signaling  <cit> . each of these  <dig> gene sets, then, is in a direct, well-established relationship with aspects of p <dig> signaling. of the remaining  <dig> gene sets,  <dig> have plausible, if less well established, links with p <dig>  in the ck <dig> pathway, cdk <dig> phosphorylates p <dig> so the presence vs. absence of p <dig> is likely to modify profoundly the effectiveness of this pathway  <cit> . ets <dig>  has been shown to be essential, in mouse embryonic stem cells, to maintain the ability to undergo uv-induced, p53-dependent apoptosis. ets <dig>  more broadly, may be necessary for p53-dependent gene transactivation  <cit> . akt and p <dig> are, respectively, essential to the transduction of anti-apoptotic and pro-apoptotic pathways. there is an integrated negative feedback loop whereby p53-dependent down regulation of akt promotes cell death but cell survival signals will recruit akt, leading to activation of mdm <dig> and the inhibition of p53-dependent apoptosis  <cit> . this may account, in part, for the association between the presence vs. absence of p <dig> and differences in the sa-trka receptor pathway. proline oxidase is induced by p <dig> and mediates apoptosis via a calcineurin-dependent pathway  <cit> . coproporphyrinogen oxidase  is a key compound of the map  <dig> porphyrin/chlorophyll metabolism gene set. it catalyzes a rate-limiting step in heme biosynthesis and may contribute to mitochondrial redox balance. it has recently been shown to be regulated by p <dig>  <cit> . finally, the wnt and p <dig> pathways have also been shown to be linked via pro-apoptotic dkk <dig>  a wnt antagonist  <cit> .

sam-gs
regarding the form of samgs test statistic, ∑i=1|s|di2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaiabdsgaknaadaaaleaacqwgpbqaaeaacqaiyagmaaaabagaemyaakmaeyypa0jaegymaedabagaeiifawnaem4uamlaeiifawhaniabgghildaaaa@3a2e@ is simply the l2-norm of the t-like-statistic vector d = , the length of the line segment joining the two phenotypes' mean gene-expression vectors of a gene set s. our null hypothesis is that the mean vectors of expressions of genes in a gene set s do not differ by the phenotype of interest , a two-sample multivariate mean test in statistics. the classical multivariate statistics method for a two-sample mean test, hotelling's t <dig>  addresses this question, but it cannot be applied when |s| > n <dig> + n <dig> -  <dig>  where n <dig> and n <dig> are the sample sizes in the two groups defining the phenotype d. we would like to emphasize that this condition is often unmet in gene-set analyses of dna microarray data. dempster  <cit>  introduced a test statistic for comparing highly multivariate samples of two groups, an alternative for hotelling's t <dig>  when the number of multivariate measurements is large, relative to the sample sizes. using dempster's test in the context of microarray data, a potential candidate for a test statistic to be used in step  <dig> of sam-gs, would be the weighted dempster's  statistic:

 wd=∑i=1|s|di2/e^,
 mathtype@mtef@5@5@+=feaafiart1ev1aqatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbwvcqwgebarcqgh9aqpdaaewbqaaiabdsgaknaadaaaleaacqwgpbqaaeaacqaiyagmaaaabagaemyaakmaeyypa0jaegymaedabagaeiifawnaem4uamlaeiifawhaniabgghildgccqggvawldaqiaaqaaiabdweafbgaaypadagaei4was1aaabcaeaacqwgkbazdaqhaawcbagaemyaakgabagaegomaidaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabcyha8jabdofatjabcyha8bqdcqghris5aogaeiyxa0laeiilawcaaa@512e@ 

where e^
 mathtype@mtef@5@5@+=feaafiart1ev1aqatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaiabdweafbgaaypadagaei4was1aaabcaeaacqwgkbazdaqhaawcbagaemyaakgabagaegomaidaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabcyha8jabdofatjabcyha8bqdcqghris5aogaeiyxa0faaa@3e8e@ in the denominator is the average of  statistically-independent quantities that have the same mean and variance as the numerator ∑i=1|s|di2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaiabdsgaknaadaaaleaacqwgpbqaaeaacqaiyagmaaaabagaemyaakmaeyypa0jaegymaedabagaeiifawnaem4uamlaeiifawhaniabgghildaaaa@3a2e@ under the null hypothesis, created by an orthonormal transformation of multivariate gene expressions in the set s. this test statistic seems to have the advantage of taking into account the multivariate structure of the gene expression measurements in a gene set by dividing the numerator, the l2-norm of the mean-vector difference, by its approximate expectation. however, since a permutation-based test is used, the denominator of wd statistic is unnecessary: as dempster  <cit>  stated, a permutation test based on the numerator only is equivalent to using the quotient. given the computational simplicity and the use of permutation in sam-gs, the l2-norm used in samgs is preferred over wd.

the l1-norm of d = , ∑i=1|s||di|
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaiabcyha8jabdsgaknaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaamaaemaabagaem4uamfacaglhwuaayjcsdaaniabgghildgccqgg8bafaaa@3c67@ can be considered, similar to chung and fraser  <cit>  who proposed the l1-norm as an alternative to dempster's use of the l2-norm. while one might expect the two norms to give similar performances overall, since the l1-norm would be less sensitive to extreme values than the l2-norm, the l1-norm may be less powerful in detecting a gene-set with a small number of genes being strongly associated with the phenotype. test  <dig> simulation above confirmed this point: as the proportion of genes in a gene set that are correlated with the phenotype  becomes smaller than approximately 30%, the two norms performs differently and the l1-norm is less powerful in detecting the gene set being associated with the phenotype .

to account for multiple comparisons  when multiple gene sets are to be tested, sam-gs takes the same approach as sam, estimating a q-value, an upper limit for the fdr, for each gene set. the q-value of a gene set can be determined solely from the p-values of all gene sets tested  <cit> . the collection of p-values of all gene sets contains information, not only on the statistical significance of each gene for its association with the phenotype, but also on the proportion of gene sets that are not associated with the phenotype, the "null gene-set proportion." note that the null gene-set proportion is determined by biology: the phenotype is either biologically associated or not associated with each gene set. however, the p-value is a function of sample sizes and noise levels in gene-expression measurements as well as the degree of underlying biological associations. thus, even if a strong biologic association between a gene set and the phenotype exists, because of small sample sizes and/or high measurement noise levels , the p-value of the gene set can be large. this is another aspect of the p <dig> analysis discussed above, where many gene sets have low fdr estimates in spite of the fact that the p-values are not correspondingly low: this is due to an estimated small null gene-set proportion which lowers fdr estimates.

CONCLUSIONS
in conclusion, gsea is subject to some serious problems as a method for gene-set analysis, potentially leading to unnecessarily high false-positive and false-negative discovery rates. sam-gs, based on the sam t-like statistic, is proposed as an alternative gene-set analysis method that is statistically sound and has advantages, as illustrated in this paper, from both statistical and empirical biologic perspectives.

