BACKGROUND
gene co-expression network analysis  is widely adopted in bioinformatics and biomedical research. it has many biomedical applications such as gene function prediction , protein-protein interaction inference , disease markers identification  <cit> , and copy number variance discovery  <cit> . many gcna algorithms have been developed to identify gene modules of strongly co-expressed genes . these gene modules can be used to further infer co-regulation mechanisms such as common transcription factors as well as genetic mutations such as copy number alterations in specific chromatin regions.

mathematically, the co-expression of the genes is often measured using correlation metrics with pearson correlation coefficient being the most widely used one  <cit> . however, there has been a lack of rigorous analysis on the mathematical condition for which the co-expressed gene module should satisfy. as to be shown in this paper, the mathematical condition is a rather straightforward linear algebra based condition. and the condition can lead to an effective metric for characterizing the concordance of the gene expression profiles in the module. with the rigorous treatment and the effective metric, we can evaluate each module as well as the algorithm.

in addition, this metric can be used to detect condition specific co-expressed gene modules. condition specific gene co-expression is an interesting problem and many methods have been developed to detect it . however, most of the methods are based on first detecting differential correlation at gene-pair level such as the fisher’s transformation and the expected conditional f-statistic  developed in  <cit> . instead, using the new metric we developed here and the randomized test for this metric, we can detect condition specific gene co-expression holistically at the gene module level instead of just gene pairs. as demonstrated in our example on lung cancer data, this can lead to new candidates on different mechanisms for co-expression and discovery of potential new genetic variants associated with diseases such as cancers. our preliminary results suggest that there is rich biological information contained in the co-expression relationships and the condition specificity that needs to be uncovered by deeper analysis and biological validations.

methods
rank condition of the expression profile data matrix for co-expressed genes
given a set of n  genes and their expression levels over n  samples, the expression profiles can be expressed using a matrix  <dig> g=g11⋯g1n⋮⋱⋮gn1⋯gnn=g1⋮gn∈ℜn×n, 

with n-dimensional row vector gi =  be the expression profile for the i-th gene across the samples . if two genes i and j are perfectly co-expressed, ie, |ρ| =  <dig> where ρ is the pearson correlation coefficient between two vectors, then given the linear relationship between the two vectors, we have  <dig> gik=αij⋅gjk+βijk= <dig> ,…,n 

for some constants αij and βij and  <dig> gi=αij⋅gj+βij⋅1nt, 

where 1n = t ∈ ℜn is n-dimensional. therefore the matrix g can be re-written as  <dig> g=g1g2⋮gn=g1α12g1+β12⋅1nt⋮α1ng1+β1n⋅1nt=g1α12g1⋮α1ng1+0β12⋅1nt⋮β1n⋅1nt=1α12⋮α1n⋅g1+0β12⋮β1n⋅1nt. 

thus the matrix g can be decomposed as the sum of two matrices each has rank  <dig>  since it has been well established in linear algebra that given two matrices a and b of the same size, rank ≤ rank + rank  <cit> , we have the following proposition:

proposition 1
if the absolute value of the pearson correlation coefficient  between every pair of rows of a matrix g  is  <dig>  then rank ≤  <dig> 

furthermore, if any of the rows of g is shifted or scaled , the pcc value between them will still have absolute value  <dig> and thus the proposition  <dig> still holds.

svd based methods for estimating the rank of g
given the matrix g, its singular value decomposition  is g = usvt where u ∈ ℜn × n, v ∈ ℜn × n are both orthonormal matrices and s is a diagonal matrix with all the elements being zero except for the ones on the diagonal line which are non-negative and sorted in descending order ). in addition, let ‖g‖ be the frobenius norm of g such that g2=∑i=1n∑j=1ngij <dig>  then it is well known that  <dig> g2=∑i=1n∑j=1ngij2=∑i=1kskk <dig> k=minn,n. 

if g satisfies the condition of proposition  <dig>  then the rank of g is  <dig> which implies s33 = s44 = … = skk =  <dig>  thus  <dig> r12=s112+s222g2= <dig>  

in reality, given the expression profile matrix of a set of co-expressed genes, the perfect pcc value can never be reached and thus g is never really rank  <dig>  but instead it can be approximated with a rank  <dig> matrix. thus in theory, given an expression profile matrix g, we can examine if the genes  are co-expressed by testing if the ratio r <dig> defined in  is close to  <dig>  we refer r <dig> as the concordance index.

data transformation and centralized concordance index
while the concordance index r <dig> can be used as a potential indicator for the concordance of the rows of g and thus for evaluating co-expressed modules, it is difficult to set a hard threshold for it. this is even more challenging for real data due to noise, batch effects, and background signals that may skew the pcc values. in addition, since svd is based on the l <dig> -norm, it can be biased by any specifically large outlier or just a few genes with high expression levels. thus the data needs to be transformed before processing. the transformation of the data we proposed involves two steps: centralization and standardization. first, each row of g needs to be centralized by subtracting its average such that  <dig> g¯=g11−g1¯⋯g1n−g1¯⋮⋱⋮gn1−gn¯⋯gnn−gn¯=g1c⋮gnc,wheregi¯=∑k=1ngiknfori= <dig> ,…,n. 

next, each row of g¯ is standardized to have norm  <dig>  ie  <dig> g^=g1cg1c⋮gncgnc=g^1⋮g^n,whereg^k=gkcgkc,k= <dig> ,…,n. 

the centralization step aims to mitigate the background signal while the standardization step avoids bias towards any particularly highly expressed genes. interestingly, since the pearson correlation coefficient between gi and gj is defined as  <dig> ρgi,gj=∑k=1ngik−g¯i⋅gjk−g¯j∑k=1ngik−g¯i2⋅∑k=1ngjk−g¯i2=gic⋅gjctgic⋅gjc=g^i⋅g^jt 

and ‖ĝk‖ = 1 , therefore |ρ| =  <dig> implies ĝk = ĝ <dig> or ĝk = − ĝ <dig>  in other words, g^=α1⋮αnĝ <dig> whereαi∈+ <dig> −1fori= <dig> ,…,n. 

therefore we have the following proposition:

proposition 2
if the absolute value of the pearson correlation coefficient  between every pair of rows of a matrix g  is  <dig> and Ĝ is the centralized matrix of g with each row standardized as in , then rank =  <dig>  in addition, the inner product between every pair of rows equals the pearson correlation coefficient of the two rows.

thus the singular value decomposition  for Ĝ is g^=u^s^v^t where u^∈ℜn×n,v^∈ℜn×n are both orthonormal matrices and Ŝ is a diagonal matrix with all the elements being zero except for the ones on the diagonal line which are non-negative and sorted in descending order ). in fact, given that Ĝ is rank  <dig> and Ĝ = n, we have  <dig> s^112=nands^22=…=s^kk= <dig>  

we therefore define a centralized concordance index  as cci=s^112n. 

estimate the significance of the cci
we examine two approaches for determining if the observed cci is significantly large to reflect co-expression relationship among the n genes over the entire whole genome dataset. first, we randomly permute the entries of every row of Ĝ and calculate ccip. this process is repeated m times . then we set ppermute=#ccip≥cci/m. 

conceptually this gives a measurement on how significant is the observed concordance index in the background of the same data distribution.

next, we randomly choose n genes from the whole genome gene expression data and calculate the ccir. this process is repeated m times. we then calculate the z-score zcci for the cci based on the random sampling such that zcci=cci−meanccirstdccir. the significance is then estimated from the z-score. this gives a measurement on how significant is the observed cci for the tested gene module in the entire genome. we choose z-score instead of the percentile of the cci due to three reasons: 1) simulation and tests on real data shows that ccir follow a bell-shaped distribution which can be reasonably approximated by a gaussian distribution as shown in figs.  <dig> and 2) even with  <dig> times sampling, it is still relatively small comparing to all the possible combinations, thus sometimes although cci is larger than all ccir, it is not reasonable to assume that the p-value  is extremely small, instead z-score gives a reasonable estimate on the deviation of the observed cci from the random samples; and 3) last but not the least, one of our goals is to use the metric to compare results from different conditions, z-scores are standardized with the same distribution and thus allows us to compare with different conditions.fig.  <dig> simulation on the distribution of cci and its relationship with noise in the data. top: relationship between cci and noise level. the x-axis reflects the effects of the noise on the centralized matrix. middle: the distribution of cci calculated from  <dig> randomly selected gene lists  in the  <dig> lung cancer tumor samples . bottom: the distribution of cci calculated from  <dig> random permutation of the data from the correlated gene module

fig.  <dig> comparison between cci and density metrics. a the cci versus density metrics with the increases of number of outliers under two different noise levels. b the boxplots for the two metrics with different number of outliers and noise levels. the values are normalized to the values with zero outlier. c the cci versus density metrics with the increasing size of the interfering module. d the boxplots for the two metrics with different number of outliers and noise levels with the values normalized to the values without interfering module



simulation
to evaluate the performance of the concordance index, we generate a matrix of 50 ×  <dig> with absolute value of pcc between every pair of rows being  <dig>  the base vector is generated as a 100-dimensional row vector using uniform distribution from  <dig> to  <dig>  the scaling factors  and shifts  are also generated using uniform distribution from  <dig> to  <dig>  the matrix g is calculated using eq.. then gaussian noises with zero mean at different levels  are added to the matrix and corresponding concordance indices are calculated. this process is repeated  <dig> times for each noise level. in addition, for each test the centralized matrix Ĝr was compared with the original Ĝ using ratio rf=g^r−g^fg^f, where ‖ ⋅ ‖f is the frobenius norm of the matrix.

comparison with density metric
since a focus of mining co-expression network is to identify densely connected gene modules, the metric density defined for network mining is often used. for a module with n in weighted network, its density is defined as d=∑i=1n−1∑j=i+1nwijnn−1/ <dig>  

for co-expression networks, the weight wij is often defined as the correlation coefficient |ρ| or its transformation. in order to examine the relationship between cci and density, we compare cci with the density defined using |ρ| as weights. specifically, we consider two scenarios. the first is to test the responses of the metrics to outliers. we first generate the simulated matrix g as described above. then outlier  will be added. we calculate both metrics under different number of outliers and different noise levels for g. the second scenario is to consider the possibility that two modules sometimes can be erroneously linked together. to test this, we generate two gene modules and test the responses of the two metrics with respect to different sizes and noise levels of the modules. each test is repeated  <dig> times.

datasets
we test the concordance index and its significance using a large gene expression dataset. the dataset was downloaded from ncbi gene expression omnibus . the dataset is gse <dig> containing gene expression microarray data from  <dig> non-small cell lung cancer  tumor samples and  <dig> non-cancer control tissue samples  <cit> . the gse <dig> dataset was generated using affymetrix hu <dig>  <dig> plus genechip. the normalization of the dataset was verified by inspecting the boxplot and data distributions. we also tested some of the findings using tcga non-small cell lung cancer adenocarcinoma  <cit>  and squamous cell tumor data  <cit>  from cbioportal .

weighted co-expression network analysis
while the r package wgcna developed by the horvath’s group is a widely adopted co-expression gene module discovery tool, it has some limitation as it is based on hierarchical clustering algorithm that does not allow overlap between modules and does not control the density of the detected modules  <cit> . in this paper, we apply a recently developed algorithm called normalized lmqcm  <cit> . this algorithm takes a network mining approach allowing overlaps between modules and also is guaranteed to have a lower bound on the density of the detected modules.

using cci to detect condition specific modules
the concordance index and its significance evaluation provide us a means to evaluate if a co-expressed gene module  in one condition is also strongly co-expressed in another condition. we first apply the normalized lmqcm to each conditions  in both datasets using selected parameters . for each gene module, we then calculated two ccis, one using the data from the condition it was generated and one using the data from the opposite condition. for instance, if the module was generated from the parkinson’s disease patients, ccis for the same gene module is calculated for both parkinson’s disease samples and the control sample. then the ppermute and zcci are calculated for both conditions too. gene modules that are significant  in one condition but not significant  in the other condition are reported for further analysis. the threshold τ is determined based on the significance requirement. for instance, τ is often chosen such that the one-tail p-value for the zcci is less than  <dig>  for single gene module or  <dig> /m if m gene modules are being tested .

enrichment analysis for gene modules
for the reported modules, we carry out enrichment analysis using toppgene . we specifically pay attention to significantly enriched gene ontology  terms, cytobands, transcription factor binding sites, and human/mouse phenotypes.

RESULTS
simulation on the relationship between cci
as described in the methods section, we generated the matrix with correlated rows. the matrix g was then calculated using eq. . then gaussian noises with zero mean at different levels  were added to the matrix and corresponding concordance indices were calculated. this process is repeated  <dig> times for each noise level. in addition, for each test the centralized matrix Ĝr was compared with the original Ĝ using ratio rf=g^r−g^fg^f, where ‖ ⋅ ‖f is the frobenius norm of the matrix. the relationship between the cci and the difference between the noisy matrix with the original matrix is plotted in fig.  <dig> top.

we then tested the distribution of the cci in random gene lists using real data. as shown in fig.  <dig> middle,  <dig> randomly selected gene lists with  <dig> genes  in  <dig> lung cancer tumor samples from gse <dig> were generated and the distribution of the cci follow a bell shaped curve with a mean of  <dig>  and standard deviation of  <dig> . thus zcci is  <dig> . in addition we carried out  <dig> times of random permutation of the data from the co-expressed gene module with  <dig> genes and the distribution is shown in fig.  <dig> bottom. the permutation results follow a tight distribution with mean of  <dig>  and standard deviation of  <dig> . while this clearly shows that the observed cci  is not associated with the data distribution, the fact that these permutation results are much lower than randomly picked gene sets from the original dataset  suggests the permutation test practically cannot provide new information regarding the significance of the modules. therefore in the rest of the paper we focus on the z-score based approach from random gene list to evaluate the modules. similar distributions were observed in multiple datasets with different number of genes or sample sizes .

comparison with density metric
as described in the methods section, we first consider the scenario when the different numbers of “outlier vectors” were added to the correlated matrix g with  <dig> rows and  <dig> columns. figure 2a shows two instances of the simulation for different choices of the noise level. in both cases, the metrics  decrease as the number of outliers increases. however, it can be seen that the curve for the cci is smoother than the curve for the density, suggesting that cci is more robust in response to outliers. this is further confirmed in fig. 2b when the ranges of the values for both metrics over the  <dig> times simulation are plotted. in fig. 2b, the values of the metrics are normalized according to the value of zero outlier. it is clear that the ranges for cci are always tight when the density values span a wide range. similar results are observed for the two-module scenario as shown in fig. 2c and d. in addition, it is clear that with the increase of size of the interfering module, the density is no long sensitive when the size of the interfering module is more than half of the original module while the cci consistently decreases.

identify tissue specific co-expressed modules in lung tumor
we first carried out weighted gene co-expression network mining using the normalized lmqcm algorithm on the lung tumor data  using parameter γ =  <dig> . γ is a major parameter for the normalized lmqcm algorithm. the larger its value, the higher is the density of the identified gene modules. our previous study suggested γ =  <dig>  is a reasonable values for such dataset.

the algorithm yielded  <dig> gene modules with at least five genes . we then calculated the cci and z-score based on  <dig> randomly selected gene lists of the same size for every module. then we calculated the cci and z-score for the same set of gene lists in the control samples. we selected the threshold for z-score to be  <dig>  such that the one-tail p-value is less than  <dig> /168 =  <dig> . among the  <dig> gene modules, all the z-scores derived from the tumor samples are higher than the threshold while  <dig> of the gene modules have z-scores lower than the threshold in control samples. figure  <dig> shows the heatmaps of three examples of the gene modules. two  have high z-scores in tumor samples but lower than threshold z-scores in control samples. this is also reflected in the heatmap. in the tumor samples , the expression levels of the samples show clear consistent patterns across the samples while there is no clear pattern in the control samples. the last module in fig.  <dig>  has high ccis and z-scores in both tumor and control samples and it is clear the expression levels of the genes show consistent patterns in both cohorts.fig.  <dig> examples of the gene modules in tumor samples  and control samples . the top two modules show significant difference in co-expression between control and tumor samples with high ccis and z-scores in tumor and low ccis as well as low z-scores in control samples. the bottom module has high ccis and z-scores in both tumor and control samples



these  <dig> gene modules are further analyzed for enriched biological processes, cytobands and transcription factor binding sites. table  <dig> summarizes the findings from these  <dig> gene modules.table  <dig> enrichment analysis of the  <dig> gene modules that are specific to tumor samples in lung cancer



discussion
one important issue is the biological mechanism leading to the differences in co-expression structures between the tumor and the control samples. as shown in table  <dig>  it is clear that there are multiple possible mechanisms. from the functional point of view, the first gene module  is highly enriched in epidermis development function. this is consistent with the fact that lung cancer is an epithelial cancer. however the molecular mechanism for such difference is still not clear. while it is often expected that such difference may be due to difference in transcription factors  which co-regulate the co-expressed genes, our analysis  on the enriched tfs shown in table  <dig> did not reveal any statistically significant increase in level of the tfs in tumor samples.

another possible mechanism of co-expression is that the genes may lie on the same cytoband with copy number variations  among the tumor samples. we have indeed observed a few such gene modules including modules  <dig> ,  <dig> , and  <dig> . the difference between the tumor and control samples implies that the potential cnv may be specific to the tumor. we tested the module  <dig> on tcga lung cancer data using cbioportal. in addition to the lung adenocarcinoma data with  <dig> patients, we also tested on the lung squamous cell data with  <dig> patients. figure  <dig> shows the oncoprint plots for the distribution of different types of mutations on the genes in module  <dig> in the patients.fig.  <dig> the oncoprint plots for different types of mutations on the genes in module  <dig> in the lung adenocarcinoma patients. top: oncoprint for genes in module  <dig>  in the lung adenocarcinoma study in tcga generated generated by cbioportal. bottom: oncoprint for the same gene module in lung squamous cell tumors in tcga. the genes circled in red are all on cytobands 4p13- <dig> and the ones circled in blue are on cytoband 8p <dig> 



as shown in fig.  <dig>  the majority of the genes identified in module  <dig> on cytobands 4p13- <dig> showed consistent cnv in lung cancer patients of both types. however, they are all amplifications in adenocarcinoma while mostly deletion in squamous cell tumors. to verify the relationship between the cnv and gene expression levels, we examined the correlations between the copy number measurements and the gene expression levels  of these genes and they all show positive correlations with an example  showing fig.  <dig> fig.  <dig> correlations between the copy number measurements and the gene expression levels  of gene mrfap <dig>  top: the box plot for the expression levels of gene mrfap <dig> with respect to inferred copy number variation. bottom: the correlation between the expression levels of mrfap <dig> with the measurement for copy number values is  <dig>  



in addition, the genes which are on close cytobands with similar cnv distribution in patients show strong co-expression as shown in fig.  <dig> while the ones not on the same cytobands do not . these observations suggest that the expression levels and co-expression of the genes on these cytobands are strongly associated with the cnv status of these bands. however, we also observed difference in correlation in the original dataset gse <dig> and the testing tcga dataset. this could be partially due to difference in sample selections and measurement methods .fig.  <dig> examples of co-expressed genes on the same cytobands from the same gene module. top: the correlation between expression levels of mrfap <dig> and grpl <dig> is  <dig>  . bottom: the correlation between the expression levels of slbp and grpl <dig> is  <dig>  



an additional interesting observation is that in both lung adenocarcinoma and squamous cell tumor samples, two genes from cytoband 8p <dig>  show consistent copy number aberrations in the patients. while the mechanism for their co-expression with the ones on cytoband 4p <dig> is not clear, literature review shows that the gene tacc <dig> in module  <dig> on cytoband 4p <dig> is known to have a gene fusion with fgfr <dig> gene in  <dig> % of glioblastoma multiforme patients  <cit> . fgfr <dig> gene happens to locate on 8p <dig> - <dig>  it is of great interest for future research to investigate if the relationship between the 4p <dig> and 8p <dig>  is partially due to a gene fusion event.

CONCLUSIONS
in summary, we have developed a linear algebraic based index cci for evaluating the concordance of co-expressed gene modules from gene co-expression network analysis. the cci can be used to evaluate the performance for co-expression network analysis algorithms as well as for detecting condition specific co-expression modules. it is shown to be more robust to outliers and interfering modules than density based on pearson correlation coefficients. we applied cci in detecting lung tumor specific gene modules. the application revealed interesting potential tumor specific genetic alterations including cnvs and even hints for gene-fusion. deeper analysis required for understanding the molecular mechanisms of all such condition specific co-expression relationships.

