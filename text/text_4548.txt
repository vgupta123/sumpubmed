BACKGROUND
structural genomics, and the increased pace of structure determination by x-ray and nmr approaches makes methods to predict protein function from 3d structure of continuing importance. proteins of known structure and unknown function are normally subjected to a battery of comparisons to find proteins adopting similar folds  or containing recurring active-site residue constellations . proteins of similar structure can provide functional hints, since it is very often the case that proteins share structural and functional similarities in the absence of sequence similarity. active site-only similarities  are typically less revealing, but can sometimes suggest the presence of a convergently evolved catalytic machinery  or binding sites for particular metals or ligands  <cit> .

when comparative approaches fail to identify a clear similarity, or if such similarities are ambiguous – for instance, suggesting a possible weak functional similarity requiring confirmation – additional functional hints can come from analyses of the protein structure, similar structures, and what is typically a large collection of homologous sequences from the set of genomes now available. there are now several methods that exploit sequence conservation to identify putative functional sites in proteins, including consurf  <cit> , approaches based on identification of 3d clusters of conserved residues  <cit> , the evolutionary trace  approach  <cit> , correlated mutations  <cit> , prediction of 3d motifs correlated with function  <cit> , jensen-shannon entropy approach  <cit> , algorithm based on contrasting global and local similarity matrices that interpret locality in terms of sequence  <cit>  or structure  <cit> . the approaches differ in design, but share a unifying theme of using conserved amino acids, together with structural constraints such as location on the protein surface, as indicators of likely functional importance.

some of the presented techniques make a special emphasis on using a protein structure for prediction. a number of methods identify interaction hot spots on different kinds of interaction interfaces  <cit> . other methods concentrate on predicting pockets in protein structures, as they are possible ligand-binding sites  <cit> , sometimes supplementing them with annotation derived from other available sources  <cit> .

in contrast to those, several approaches, including our own  <cit> , have attempted to exploit protein sequence alignments to determine those residues likely to confer specificity for a particular sub-function in a protein family  <cit> . although they differ in algorithmic details, all approaches aim to use the statistics of a multiple sequence alignment to identify positions that correlate well with sub-families that account for a certain specific function. sub-families are either explicitly given in advance  or are predicted by the algorithm.

here, we extend our previously derived approach for identifying specificity determining residues  <cit>  to the problem of predicting protein functional sites . we combine routine predictions of conserved residues with those for specificity determinants, and use structural information to identify spatial clusters of the predicted important residues. sdpsite differs from structure-based methods in that the major part of the prediction is derived from the protein sequences. so, in theory, the method can also be applied in absence of structural information. the structure-based step filters out part of the predicted positions, thus leaving only the most reliable predictions, which can be useful in the design of experimental studies.

to test our method on a large scale, we developed two benchmark datasets of diverse enzyme families, using the enzyme classification  system. enzymes are the simplest class of proteins to benchmark as their functional annotations are well specified in databases. however, they are not necessarily representative of other protein functions that are less discretely characterized by precise catalytic machinery . in the absence of a reliable source of functional annotations for non-enzymes, we previously tested the presented approach on two examples, for which reasonable experimental data are available, the laci family of the bacterial transcription factors and subtilisin-like proteases  <cit> . on these examples, sdpsite results have a sensitivity between  <dig>  and  <dig> , specificity between  <dig>  and  <dig>  and false positive rate between  <dig>  and  <dig> . thus, in these anecdotal cases, sdpsite seems to miss a lot of truly functional amino acids, but still provides reliable predictions.

we also predicted the functional sites in  <dig> unannotated structures derived from structural genomics efforts. for the benchmark datasets, the success rate of our method  was 96–100%. we were then able to make confident functional site predictions for ~76% of a set of families lacking functional annotation.

RESULTS
 <dig>  testing sdpsite on a benchmark set of enzymes with bound cognate ligands
we previously tested sdpsite on a number of protein families with known sites and compared the performance with several other approaches  <cit> . the results encouraged us to predict functionally important sites in poorly characterized protein families. structural genomics projects now provide up to 20% of annual growth of the protein data bank  and a greater coverage than ever before of the space of protein structures  <cit> . this has led to the current situation where hundreds of protein families include a protein with a known 3d structure, but no available functional information. these families are a perfect target for functional site prediction methods that use both sequence and structural information.

however, before applying our approach to families lacking functional information, we needed to benchmark the approach on a set of protein families that are well-characterised in terms of function. to do this we considered enzyme protein families from the pfam database, for which there is a functional characterization scheme in the enzyme classification  number system. this classification consists of four numbers denoting a hierarchical system that delineates enzyme function. we focused on families containing ec numbers differing in the last number, which normally accounts for the substrate specificity. since protein families generally correspond to a single functional or structural domain, complications can arise for multi-domain proteins that correspond to a single ec number. we inspected the families manually to ensure that the catalytic operation for each ec number did indeed correspond to the domain considered. thus each considered protein domain corresponds to a single ec number, thus catalyzing only one reaction , and presumably have only one active site.

to assess performance of sdpsite on these pfam enzyme families, we generated two benchmark datasets. the first consisted of families containing proteins with at least two ec numbers differing in the last position; the second consisted of families containing only a single ec number. we refer to these datasets as diverse and homogeneous in the sections that follow. the rationale is that when one is predicting function and/or specificity, one does not known in advance whether or not there are multiple specificities in the family. these two datasets mimic both of these situations.

for all families we computed both specificity determining positions  and conserved positions , then mapped them onto a 3d structure of one of the proteins of the family and extracted a portion of the two sets that forms a compact spatial cluster, as described previously  <cit>  and in the methods section. we designed several distance measures to assess the quality of the predictions. these were: 1) the minimal distance from the residues of each of the predicted sets  to a bound ligand; 2) the average distance to the ligand; 3) the diameter of the set; and 4) the average distance between residues of the set. we performed a mann-whitney test to assess the statistical significance of the best derived cluster, i.e. we tested if the set of the amino acid residues in the best cluster is significantly closer to the ligand than all residues in the protein. these data are given in additional file  <dig> 

we considered predictions to be successful if minimal distances were smaller than  <dig> Å and average distances smaller than  <dig> Å. we selected these thresholds based on inspection of known binding sites, and found that they capture characteristics of typical binding sites, which are normally 15– <dig> Å in diameter and typically some of the amino acids of the cluster contact the ligand directly. a small minimal distance and a large average distance means that the cluster is too sparse and does not define the active site well enough, but still a part of it is close to ligand and might be functional. generally there is no correlation between either diameter or average distance within a predicted set of residues and the set's proximity to the active site.

as might be expected, predicted sdps tend to be more sparsely distributed in the structure, compared to the more compact distribution of cps. the best clusters are tightest, which is natural from their construction procedure, though the minimal distance suggests they are sometimes further away from the active site . we discuss these observations in more detail below.

a. the diverse dataset: protein families with at least two distinct ec numbers
application of all the filters described in the methods section yielded  <dig> pfam families . sdpsite was applied in different ways, either ignoring sdps thus mimicking the standard, conservation-based approaches, or including them when constructing the best cluster. for the inclusion of sdps, we either gave them twice the weight as the cps  or same weight . . for details on the choice of the λ parameter, see methods. in all but one of the considered families  at least one predictor performs well, and in the asparaginase_ <dig> family the average distance is slightly higher than  <dig> Å. this means that the best clusters are located in enzyme catalytic sites, and some of residues are in direct contact with the ligand. this result is significant  for all but four, one of which is the carboxylesterase family; for the other three the best cluster contains positions accounting for intersubunit contacts. the resulting implications for quaternary structure are discussed below.

 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
 <dig> . <dig> 
average values for all the above measures are given in tables  <dig> and  <dig>  note that sdps contribute to identification of the active site, although leading to prediction of a more disperse cluster. when no sdps are predicted , the average distance is smaller, because cps form a more compact cluster in the active pocket. unlike other methods that attempt to predict functional sites solely using the conservation of surface residues, sdpsite predicts a number of additional positions of potential importance. in  <dig> out of  <dig> families the best cluster is significantly  closer to the ligand in both λ =  <dig>  and λ =  <dig> scenarios, and in  <dig> out of  <dig> in at least one of them, whereas the cps-only based prediction succeeded in only  <dig> families . this indicates that the inclusion of sdps in the prediction often leads to a significant improvement.

'+': successful prediction , '-*': moderately successful prediction , '-' otherwise.

for instance, in the protein-l-isoaspartate o-methyltransferase  and thioesterase  families, the cp-based cluster is located distant from the active site, whereas addition of sdps rescues the prediction leading to the correct site. in the c-terminal domain of pyridoxal-dependent decarboxylases , bacterial transferase hexapeptide  and asparaginase  families, sdps rescue the cluster for λ =  <dig> . in contrast, for the shikimate kinase family  a heavier reliance on sdps skews the prediction, whereas more equal considerations of sdps and cps, or of cps only, perform considerably better.

the carboxylesterase  family is the only clear failure of the method, i.e. its active site is not identified by either variant of the method. even the catalytic triad, ser <dig>  his <dig> and glu <dig> , is not among either sdps or cps. the fact that the catalytic residues are not conserved in the alignment is puzzling. this could be because the alignment from pfam contains many uncharacterized paralogs from c. elegans and d. melanogaster, which could perform a different function or be non-functional. indeed, catalytic residues are often substituted in these proteins: ser <dig> to alanine, asparagine, glycine or valine, his <dig> to asparagine, glutamic acid, leucine, lysine, tyrosine or valine, and glu <dig> to asparagine, glutamic acid, glutamine, histidine, isoleucine, proline, threonine, tryptophane or tyrosine. such changes mean that these residues are ignored in the prediction procedure, and highlights the need for some caution when building alignments to predict function.

we overlook details of quaternary structure when making predictions, and this can have interesting consequences, as discussed previously . for instance, for the thiolase n-terminal domain  family, we found the minimal and the average distance to be rather large. from the structure of a protein from this family , it is evident that the best cluster is located on the contact interface between two subunits of a dimer. indeed, the minimal and the average distance to the second subunit are  <dig>  Å and  <dig>  Å, respectively. the second best cluster is, however, in the active pocket with the distances below the threshold. the family of gcn5-related acetyltransferases  is a similar case: for λ =  <dig>  the best cluster is located on subunit contact interface and the second best in the active site, for λ =  <dig> vice versa. this highlights the need to consider quaternary structure explicitly when making and interpreting predictions using this or similar approaches.

a natural question is how well the predicted grouping of the sequences agrees with the ec numbers of the proteins considered. for most families there was a good agreement, with ec numbers segregating into discrete branches of the trees derived from the alignments. there were two families where proteins with one ec number would split between two groups that contain proteins with other ec numbers . for both, the same enzymatic activity seems to evolve independently on two separate branches of the phylogenetic tree.

b. the homogeneous dataset: protein families with a single ec number
the  <dig> families with a single ec number are listed in table  <dig>  again, we applied sdpsite with λ =  <dig> , λ =  <dig> and without prediction of sdps . for all studies families, except eukaryotic phosphomannomutases , at least one of these variants puts the best cluster to the active site of the enzyme according to the described criteria. for  <dig> out of  <dig>  the best cluster identified by either procedure is located in the active site. these results are significant  for all families, except adenylylsulphate kinases .

the remaining nine families, for which active sites were not identified by all variants of sdpsite, can be split into four categories:  λ =  <dig>  fails ;  both λ =  <dig>  and λ =  <dig> fail ;  cp-only prediction fails ; and  at least two of the three fail .

sdps are expected to perform worse for this dataset, because in theory there are no specificity differences within each family as defined by the ec system. however, cp-based clusters significantly skew the predictions in two cases out of eighteen. one explanation of this observation could be inaccuracy or ambiguity in the assignment of the ec numbers, which would mean that we have identified some real differences the specificity. it might also be that a substitution to an amino acid with similar properties  occurred, which can perform an equivalent enzymatic role. another possibility is the functional convergence to a single specificity at the molecular level: sdps indicate different residues that distant species or distant paralogs evolved to perform the same function . alternatively, as discussed below, sdps may indicate differences specific to certain phylogenetic clades.

similarly to the diverse dataset, there are two families for which the best cluster is located on the subunit contact interface: thymidylate synthases and adenylylsulphate kinases. the minimal and average distances to the second subunit of the dimer are  <dig>  Å and  <dig>  Å for thymidylate synthases and  <dig>  Å and  <dig>  Å for adenylylsulphate kinases. for both, the second best cluster is in the active site.

for two families, all three versions of sdpsite produce poor results. for the oxygenase domain of nitric oxide synthases the average distance of the residues from the best cluster to the ligand is between  <dig> and  <dig> Å for all three versions, and for eukaryotic phosphomannomutases it even exceed  <dig> Å in two out of three versions. however, for both families, the second best cluster is located in the active site. in the case of the oxygenase domain of nitric oxide synthases the alignment contains only  <dig> sequences, which split into phylogenetic groups of insects and vertebrates. these groups are too distant, and it seems that the method cannot remove the phylogenetic trace completely, thus producing many sdps that are probably not functionally important. a more representative set of sequences may improve the predictions and probably place the best cluster in the right position. for the eukaryotic phosphomannomutases, the best cluster is located in the core domain close to the magnesium ion, which is a part of the active site, but distant from the substrate in the open conformation of the protein.

the means of the minimal and the average distances to the ligand and the significance of the average distance are summarized in table  <dig>  it is not surprising that giving sdps and cps equal weight  leads to better results than λ =  <dig>  for this dataset: since all the proteins have the same ec number, one might not expect to find anything accounting for differences in specificity among these proteins. as discussed above, the identified sdps could, instead, reflect different ways that different groups of proteins evolved to perform the same function. again, building the best cluster from only cps does not improve the prediction quality, and all the distances used as the performance measures are larger than for λ =  <dig>  this is another indication that proteins, even though they have the same function and specificity, have evolved quite different ways to perform it, and this must be taken into account when predicting functional sites.

in contrast to the diverse dataset, the success rate is similar for different versions of sdpsite . in  <dig> out of  <dig> families the best cluster identified by taking into account both cps and sdps is significantly closer to the ligand , which indicates that specificity determinants predicted for homogeneous families, even when they do not illuminate the binding of a specific ligand, play some other important role in their function. in this regard, it is important to stress that this dataset is only homogenous as defined by ec numbers, and it is well established that these do not always uniquely define molecular function  <cit> . in other words, substantial sequence and structure diversity is possible even among sets of protein sharing the same ec number.

'+': successful prediction , '-' otherwise.

for example, the alignment of the queuine trna-ribosyltransferase family contains  <dig> bacterial and  <dig> archaeal proteins. when predicting sdps, sdpsite clearly divides the family into these two groups. a closer analysis of the predicted sdps reveals that some positions that are conserved within the two groups but differ between them bind substrate or trna in the bacterial enzyme from zymomonas mobilis  <cit> . for example cys  <dig> binds queuine precursor , and arg  <dig> binds trna .

c. overall performance in the benchmark and guidelines for predictions
we analyzed the performance of sdpsite by calculating, for the diverse, homogenous and combined datasets, sensitivity  and false positive rate  . for a perfect prediction, sensitivity should be close to  <dig> and the false positive rate close to  <dig>  as a gold standard set of residues in active sites, we considered all amino acids located within a distance of  <dig> Å from the bound ligand. note that not all these residues are functionally important, which makes the reported false positive rate lower than it would be if we had perfect information on real functional importance of all residues in the proteins considered.

in all datasets the inclusion of sdps in the predictions leads to a higher sensitivity. there is no significant difference between the diverse and homogeneous datasets, though this is probably due to the diverse nature of the underlying ec and sequence data as mentioned above: functional diversity is also likely present in the homogeneous dataset making sdps beneficial to the prediction of functional sites.

as discussed above for the phosphomannomutase family, proteins often undergo conformational changes upon binding ligands, which means that any method tested on structures in complex with a ligand might unfairly profit from the use of a bound structure, which will differ from the unbound or apo form of the protein. to test for this effect, we identified  <dig> apo protein structures  from the diverse dataset and  <dig>  from the homogeneous dataset and found no significant difference in the predicted residues. this effectively means that the method is relatively insensitive to minor conformational changes that occur upon binding. it is worth noting, however, that the enzyme sites considered here might not be representative of other types of interactions that can lead to more substantial conformational re-arrangements , or contain much larger functional sites than the tight constellations of functional residues normally found in enzymes.

the results from the above benchmark provides a guide for how to interpret predictions, which we used for the unannotated families below. based on inspection of the results, we found the ratio of the total number of predicted sdps and cps to the length /length) of alignment to be a useful measure of performance. for  <dig> of  <dig> families this ratio was below  <dig> . for  <dig> of these  <dig> families all three versions of sdpsite predict the best cluster with an average distance to ligand less than  <dig> Å, and for  <dig> of these the p-value is <  <dig>  in all three versions of the method. however, the set of families with successful predictions is not enriched with those with low /length ratio compared to all predictions. we also calculated the ratio of the number of residues in the best cluster to the length  of alignment and applied the cutoff of  <dig> . for  <dig> of total  <dig>  families the best cluster/length ratio is below  <dig> , whereas among families, for which average distance is < <dig> Å, and p-value <  <dig>  for all three versions of sdpsite, this fraction is  <dig> out of  <dig> . thus it is practical first to consider predictions with a low best cluster/length. still, as we discuss below, even more disperse predictions can lead to interesting insights.

as noted above, sometimes the best cluster can be situated on the inter-subunit contact interface, and the second best cluster in the active site. no clear strategy can be suggested to distinguish these situations in the absence of prior knowledge. in practice one should analyze the composition of the best cluster for the presence of amino acids typical for enzyme active sites  or for protein-protein contact interface . these considerations, however, tend to be family-specific and thus cannot be included into a prediction algorithm intended for a general use.

it is worth noting that sdpsite performs best when the alignment is sufficiently long, the sequences are sufficiently diverse in terms of sequence identity and the phylogenetic tree is biologically sound. as a guideline, it performs best with alignments of at least  <dig> positions, and at least  <dig> proteins with identities between  <dig> and 90%. the diversity of possible sequences sets and functions for which sdpsite is applicable is great. from our benchmark, we were unable to distinguish between a single-ec and a multiple-ec family in a blind test. this is probably the major drawback of the method: in absence of additional information, one cannot conclude whether the identified sdps pinpoint the real functional diversity within the family, or simply reflect the phylogenetic trace. it is impossible to say which of the three functional site prediction approaches is generally best. in practice, one should always run all three approaches, and then interpret based on what, if anything, is known about the function, and how the functional sites look on the structure.

 <dig>  application to protein families lacking functional annotation
we focused on  <dig> pfam families that included at least one protein with resolved 3d structure, and where all structures come from structural genomics projects. after removing families with fewer than  <dig> sequences in the pfam seed alignment, we were left with  <dig> , for which potential functionally important sites could be identified. of these,  <dig> families include potential or proven enzymes;  <dig> are transcription factors;  <dig> are involved in translation;  <dig> participate in various cellular processes in a fashion that is not completely understood; and the functional role for  <dig> is unknown. the full description of the predictions is available from the sdpsite web-site. we calculated sdp+cp/length and best cluster/length ratios for these families. for  <dig> of  <dig> families sdp+cp/length ratio was below  <dig>  and the predicted cluster lies on the surface or in a pocket of the protein structure. for another  <dig> families predictions were weaker, but acceptable: sdp+cp/length ratio exceeds  <dig> , but the cluster still lies in a pocket or on the surface. for the remaining  <dig>  no reasonable predictions were made. taken together, 76% of the predictions seem to provide a reasonable hint about the location of the actual functional site of the protein. the best cluster/length ratio is below  <dig>  in  <dig> of  <dig>  families. this fraction is lower than for the benchmark dataset, which can be due to the fact that the considered dataset includes proteins of various functions as opposed to the benchmark that consists solely of enzymes. the predictions made for these  <dig> families are the most promising candidates for experimental validation. five promising examples are discussed below. these examples were chosen according to the criteria above, and our own visual inspection of the results.

a. ycii-related domain 
this family was first identified during an analysis of the streptomyces coelicolor genome by a domain hunting process  <cit> . the authors confined the annotation to a remark that it is "probably enzymatic". the study of this domain continued, when the first  structure of a protein from this family, hi <dig> from haemophilus influenzae, was solved . the protein was shown to adopt a ferrodoxin-like α/β-fold, and a catalytic mechanism involving a histidine-aspartate pair was proposed. however, biochemical assays have to-date failed to suggest a substrate for the enzyme.

sdpsite identifies a small cluster of potentially important residues , located in a pocket, which contains a coordinated zncl <dig>  a ligand supposed to play a role in the catalysis. the method splits the family into three specificity groups . as the family includes a number of paralogues from the same species, which fall into different specificity groups, the identified sub-groups might reflect the real specificity differences within the family. the predicted sdps might thus account for binding of different substrates in the active pocket.

b. cobw/hypb/ureg, nucleotide-binding domain , and cobalamin synthesis protein cobw c-terminal domain 
these two protein families represent the two domains of cobw protein, a hypothetical protein, involved in cobalamin biosynthesis and possibly required to store cobalt ions as an intermediary between the cobalt transport and chelation systems  <cit> . the n-terminal part of cobw is a member of pf <dig>  which also contains nucleotide-binding domains of hypb and ureg, gtpases involved in binding of nickel to apoenzymes  <cit> . the only known 3d structure in both families belongs to a hypothetical protein yjia from e.coli  <cit>  . yija is a homolog of cobw and has the same domain structure, but a much shorter linker between the domains, and also lacks the histidines required for metal binding, and thus cannot serve as a metal repository. yija is believed to be a gtp-dependent regulator, however its biological role is unclear  <cit> . the n-terminal domain of yjia  has a fold typical to p-loop ntp-binding proteins, and a number of motifs responsible for gtp binding can be found in it. the c-terminal domain has a ferrodoxin-like fold.

sdpsite identified two potential functionally important sites, one for each domain . both clusters are exposed to solvent and the cluster in the n-terminal domain is located close to the possible nucleotide-binding pocket, identified by walker a and b motifs, as discussed in ref.  <cit>  . the arrangement of the clusters suggests their possible role in communication between the two domains. indeed, in the structure used the minimal distance between residues of the n-terminal and the c-terminal domain cluster is  <dig>  Å. as the domains are rather mobile relative to each other due to the flexible linker, under certain conditions the two clusters could potentially interact directly.

c. php domain 
this family corresponds to a catalytic domain with a phosphoesterase activity found both as a stand-alone protein and fused to dna polymerase domains. php domains are often found in the n-terminal part of bacterial dna polymerase iii α subunit and in the c-terminal part of dna polymerase of the x family in some archaea. in this role, the php domain is proposed to hydrolyze pyrophosphate, shifting reaction equilibrium to polymerization  <cit> . the family also includes a number of tyrosine-protein phosphotases and histidinol phosphatases and many uncharacterized proteins. 3d structures are available for two proteins of the family, both with unknown function: ycdx from e.coli and tm <dig> from thermotoga maritima.

we mapped the predicted positions on the structure of ycdx from e.coli  <cit>   , since the predicted clusters in all available structures are formed by equivalent residues . ycdx is usually present as a trimer in solution, each monomer possessing its own catalytic site  <cit>  . a cluster of three zinc ions is located in a cleft of the structure, indicating a possible location of the active site . the predicted cluster of functionally important residues lies close to the zinc cluster and has a layered form: a more compact layer of cps and a fuzzier layer of sdps. cps might represent the catalytic core of the active site and sdps, a less spatially defined recognition periphery. some sdps even protrude to the back of the monomer, where they can participate in the ligand recognition in another active site.

it was previously noted  <cit>  that proteins of the php family appear as single domain proteins or as domains in multi-domain proteins involved in a variety of cellular processes, possibly exhibiting diverse specificity. indeed, one can find proteins annotated as "dna polymerase iii subunit alpha", "dna-dependent dna polymerase family x", "histidinol-phosphatase", "tyrosine-protein phosphatase" and "protein trph" in this family. many of the family members are still uncharacterized. along with the identification of a cluster of possible functionally important residues, sdpsite extracts a number of specificity groups, which are shown on the phylogenetic tree on the family in fig.  <dig>  proteins with similar annotation always fall into same group, and, with a certain degree of caution, this annotation can be transferred onto other proteins of the same group. for example, ycdx falls into the same group with a sequence from methanobacterium thermoautotrophicum , which is annotated as a dna-dependent dna polymerase family x, known to be involved in dna repair. analysis of gene expression level in stress conditions indicates that ycdx might also be involved in dna repair  <cit> .

d. possible lysine decarboxilase 
according to pfam, this family includes proteins annotated as lysine decarboxylases, but the evidence for this annotation is not clear. three structures from this family are available , none of them with clear functional annotation. one can clearly see a cleft lined with cps with sdps on its periphery , which could form an active pocket. it is also possible that there is one active pocket per every two subunits .

e. yqey-like proteins 
yqey-like proteins are widespread, but the largest portion of the family comes from bacteria . predominantly, there is only one copy per genome. despite the great number of proteins in the family, their function remains unclear. a number of sdps and cps were identified in this protein . the best cluster is a tight cluster of four sdps at the c-terminal end of the second α-helix, and exposed to solvent. this positioning might suggest its involvement in some protein-protein interactions. the functional role of these residues, if any, remains to be tested.

 <dig>  comparison to other functional site prediction methods
we compared the performance of sdpsite to several other techniques which also aim to predict functionally important residues from protein sequence and structure information: 1) the evolutionary trace  method  <cit> , 2) the consurf method  <cit> , and 3) the three methods from the treedet package  <cit> . to produce predictions with the et method, we used the tracesuite ii server . for consurf we used the rate4site implementation  <cit> , which assigns an evolutionary rate to each position of the alignment. the more a position is conserved, the more important for the function it is considered to be. as the algorithm produces a rating, rather than a set of functionally important positions, we considered the two most conserved of the nine output categories as the prediction.

we used the two benchmark datasets and the assessment procedure described in the above to assess the predictions of different methods. the minimal distance to the ligand, the average distance and the significance of the average distance are presented in additional file  <dig>  the predictions of the et method usually show low minimal distance to the ligand, but due to the fact that et renders too many positions as potentially important , which is impractical in experimental studies. we performed mann-whitney tests comparing the distribution of distances for the predictions produced by sdpsite to various other methods . in  <dig> and  <dig> of  <dig> cases at least one of the three versions of the method  performed significantly better  than et. and rate4site, respectively. fass, mb and s methods perform well, but frequently identify too few amino acids to make the test reliable, or are not applicable at all due to the methods' limitations. sdpsite thus achieves a good balance between the quality and quantity of the predicted residues and the general applicability of the method to further investigations.

et: evolutionary trace method  <cit> ; consurf: consurf method  <cit> ; fass, mb, s: three methods from the treedet package  <cit> . '++': sdpsite with both λ =  <dig>  and λ =  <dig> performs significantly better , '+': sdpsite with either λ =  <dig>  or λ =  <dig> performs significantly better, 'c': sdpsite with cps only performs significantly better; 'n/a' method is not applicable, 'no mw': mann-whitney test is unreliable , 0: method applicable, but no positions predicted, prediction considered not successful.

discussion
we have presented a new approach for automated identification of functional sites in protein structures, sdpsite. its main advantage is that it considers not only conservation, but also specific differences among proteins from a protein family. a number of approaches aim to predict specificity determinants  <cit>  and/or conserved functionally important sites  <cit> , but they almost never combine structural and sequence information. the closest attempt to apply this kind of analysis to prediction of functional sites was the evolutionary trace  method  <cit> . however, the et approach takes into account all positions conserved within groups that arise when cutting the phylogenetic tree of the family at a certain distance from the root, thus often leading to too many predicted positions. sdpsite also extracts all possible groups of proteins corresponding to different identity cutoffs, but, unlike et, it selects the least probable to arise by chance, i.e. the most probable functional grouping.

we tested sdpsite on two benchmark datasets of enzyme families, for which details of function and binding mode of ligands were known, and specificity of proteins was, in one case, differing within the family, and in the other case, same for all proteins of the family. the tests show that for almost all cases sdpsite succeeds to predict the functional site  with a good accuracy. the average values of the minimal and average distances from the best cluster to the ligand over all families  demonstrate that the predicted best cluster is compactly situated in the active site of the enzymes in most families. as noted above, the prediction of specificity determinants is the main novel feature of our method, but ignoring them and using only conserved positions to build the best cluster can lead to a decrease of the sensitivity of the method . using this strategy some residues crucial for the function are missed . thus clusters that include sdps often define a more practically useful set of functional residues. comparisons to other methods for functional site predictions show that sdpsite is marginally or substantially better than the previous approaches, supporting the notion that the inclusion of specificity determining residues generally augments predictions of functional sites.

we provide predictions of functional sites for a large number of proteins, whose structures were solved in a high-throughput manner and lack functional annotation. in some cases  we provide evidence that a family of homologous proteins includes proteins of different specificity and suggest composition of specificity groups. when specificity of some members of these groups is known, one can transfer it, with caution, to uncharacterized proteins, assisting their annotation .

CONCLUSIONS
we have introduced a novel approach to identification of functionally important sites in protein structures. it bridges the gap between two existing categories of methods dealing with the same problem: sequence-centric comparative techniques and the structure-centric techniques that incorporate some physico-chemical considerations. sequence data are already overwhelming, and structures lacking functional annotation are likely to increase in number for many years to come. thus practical tools like that described will be of great benefit for those interested in inferring function directly from structure.

