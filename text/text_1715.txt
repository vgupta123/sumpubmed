BACKGROUND
snps are the most abundant markers across the genome. their relatively uniform distribution and high density make them ideal markers in genome wide association studies , comparative or evolutionary genomics study and marker-assisted molecular breeding research. due to the outcome of hapmap project  <cit>  and the proceeding of 1000-genomes project  <cit> , over  <dig> m snps in human genome have been genotyped and reported in the dbsnp database  <cit> .

several genome-wide genotyping technologies have been developed and commercialized, aiming at detecting common snps or tagsnps in parallel  <cit>  . although these technologies have obvious advantages such as low costs, whole genome sequencing  is the most straightforward method for genome-wide identification of snps and other types of variants. so far genotyping hundreds to thousands of individuals by wgs is still not affordable for many investigators even considering the dramatic cost decrease due to innovation and update of the technology. therefore, to fill the gap between current methods, considerable efforts have been made to develop the rrl methods, which have great advantage of reducing the complexity of a genome by orders of magnitude. recently, lots of rrl strategies have been proposed and proved, such as target enrichment technologies including multiplex pcr, restriction enzyme digestion, selective sequence capture on array  <cit>  or in solution  <cit> , and others .

compared with other methods, rrl based on restriction enzyme digestion is relatively feasible and flexible, especially for those species without the reference genome  <cit> . the first rrl using restriction enzyme was described over ten years ago, subsequently many successful cases have been performed in human  <cit> , soybean  <cit> , cattle  <cit> , swine  <cit>  and other species  <cit> . recently reported restriction-site associated dna  tag method is able to identify and score thousands of genetic markers in the flank region of enzyme recognition sites which randomly distribute across the target genome. rad method can be widely used in large population studies, enabling not only genotyping and snp discovery, but also more complex analysis such as quantitative genetic and phylogeographic studies  <cit> . however, rad method involving multiple steps was labour intensive and typically requires a large volume of starting genomic dna, moreover, the validation rate was only 85% under high stringency of snp calling condition in some species like soybean  <cit> . in a recent study, the researchers utilized rrl of enzyme hae iii to identify up to  <dig> k snps with validation rate of 48% in a rainbow trout genome  <cit> . although the low validation rate of rad in soybean and rainbow trout were conferred by polyploidy and a whole genome duplication event related to target genome, the main cause was due to the poor accuracy of the method, indicating the potential possibility of improvement by further optimizing the library building or snp calling in human beings. consequently, the low validation rate of rrl method greatly hinders its widespread application. until now comprehensive evaluation  is still unavailable, the comprehensive evaluation should be carried out in target genomes with detailed genomic coordinates and available genotyping information. here we proposed restriction enzyme based rrl construction method and performed comprehensive evaluation for this method, especially for the accuracy of snps discovery.

methods
in silico digestion and enzyme selection
in silico digestion of the human reference genome  was performed with nine commercially available and methylation-insensitive restriction enzymes. these enzymes were selected upon following criterions:  predicted fragments length ranged from  <dig> to  <dig> base pairs ;  proportion of target region overlapped with the repetitive elements;  number of putative snps in dbsnp database v <dig>  covered by target region. the repetitive elements were determined using repeatmasker software v <dig> . <dig>   <cit> .

library construction and dna sequencing
tsp 45i rrl was prepared following the main workflow shown in figure 1a,  <dig> μg genomic dna was extracted from peripheral venous blood using qiaamp dna blood mini kit , then completely digested by tsp 45i in  <dig> μl reaction mixer at 65°c for  <dig> hour . the digested dna was separated on a 2% agarose gel and the fragments in the range of  <dig> bp to  <dig> bp were excised from gel and purified using qiaquick gel extraction kit . the sticky ends of fragments generated by tsp 45i digestion were polished with t <dig> dna polymerase and klenow polymerase, after 'a' base tailing using klenow exo-. then pcr-free adaptors with a single 't' base overhang at the 3' end were ligated to the above products. the concentration of the libraries was determined by q-pcr. the libraries were performed 90-cycles paired-end multiplex sequencing on illumina hiseq  <dig> platform .

snps calling and validation
the raw sequencing data were masked from adapter using our own software application mlinker. parameters were set up for mlinker as following:  overlapped length between read and adapter was at least  <dig> bp;  minimum of 90% sequence identity between read and adapter;  length of reads after adapter-masked was at least  <dig> bases. the clean reads were mapped to the human reference  using soapaligner v <dig>  with at most  <dig> mismatches and at least  <dig> perfectly matched bases.

soapsnp v <dig>  <cit>  based on bayesian model was used to call snps on target regions. five filter steps were used to remove unreliable part of the consensus sequences:  both the major and minor alleles should be detected at least twice;  the overall sequencing depth, including randomly placed repetitive hits, was less than 200-fold;  the copy number of flanking sequences should be less than 2;  the genotype quality and average quality score of best nucleotide were at least  <dig>  and average quality score of second best nucleotide was at least  <dig> if the genotype was heterozygous;  snps ought to be at least  <dig> bp away from each other. after filtering, the number of yh consensus sequence was calculated, and discrepancies between the yh genome and hg <dig> reference genome were considered snps.

snp validation was processed in two aspects including detection of snp calling accuracy and genotyping accuracy. we used high confident snps set previously generated by whole genome sequencing  to evaluate our snps calling results. novel snps identified in our results were defined as false discovery loci, and missing snps in our results were defined as false negative. the fdr and fnr indicated the accuracy of snp calling. to evaluate the genotyping accuracy, we calculated the concordance of these snps genotyped by rrl method and illumina  <dig> m duo_v <dig> b beadarray.

genome coverage and minor allele frequency  distribution
to compare with commercially available genotyping platform, we set some parameters including genomic coverage , maf , and spacing  between markers. allele frequency and linkage disequilibrium  data for the four hapmap populations were obtained from hapmap database . the value of genomic coverage was calculated according to the method previously described  <cit> , in brief, we performed the naive estimation of coverage using hapmap release <dig> as reference set of snps, which was defined as r. the sets of snps covered by illumina genotyping beadchip or rrl were represented by t. the sets of snps located in same ld blocks with t sets of snps with r <dig> ≥  <dig>  were represented by l. then the value of genome coverage was calculated as /r. human  <dig> m duo_v <dig> b beadchip from illumina which cover about  <dig>  m snps was selected to perform the comparison.

RESULTS
enzyme selection, rrl construction and sequencing
in this study we screened nine restriction enzymes with human genome hg <dig> as reference, we fragmented the whole genome in silico according to the enzyme restriction-site sequence, considering to the fragment size of sequencing platform the target fragments ranging from  <dig> bp to  <dig> bp were selected, as large variety of fragment length was not recommended for the cluster generation of the illumina sequencing platform. to minimize the repetitive content, we calculated the frequency of target region overlapped with repetitive elements, the frequency for all enzymes was about 40% to 50%, which was close to that of whole human genome. therefore, it is difficult to remove the repeat sequences from the rrl for human being . based on the simulation results, tsp 45i that specifically recognize a 5-bp site  with a degeneration base in the middle, in principle could call around  <dig> m putative snps. since we planned to evaluate the snp calling efficiency by comparing our rrl method and  <dig> m duo_v <dig> b chip, we selected tsp 45i to obtain rrl. tsp 45i rrl produced approximately  <dig>  million fragments ranging from  <dig> bp to  <dig> bp, paired end sequences from the sequenced fragments covered  <dig> mb region  flanking enzyme recognition sites.

the in silico digestion results of nine restriction enzymes using hg <dig> genome as reference were shown. a regions sequenced in the final corresponding library and calculated according to pair-end sequencing with average read length of  <dig> bp. b the number of putative snps are calculated based on dbsnp v <dig> data.

the workflow of tsp 45i rrl construction was depicted in figure 1a, which was compatible to illumina sequencing platform. the genomic dna was digested with tsp 45i entirely and separated by agarose gel electrophoresis . a total of about  <dig>  million reads with an average length of  <dig> bp were generated in half a lane of illumina hiseq  <dig> platform,  <dig>  g bases were produced . using soap software package, about  <dig> % of total past filter  reads could be mapped to reference genome with unique map rate of  <dig> %, and  <dig> % mapped reads were located on target region. of the  <dig> m target region in simulation results,  <dig> m  was covered by at least one reads with 20-fold mean depth. the total depth distribution of target regions approximately formed a poisson distribution .

to assess the quality of rrl construction and sequencing, we compared the actual insert size distribution calculated according to the paired end information of sequence reads to that of simulation result. figure 2b indicated that the length distribution of inserted fragments in tsp 45i rrl was approximately from  <dig> to  <dig> bp. compared with the simulative curve, the small fragments were over-presented in the final sequencing results, probably indicating the bias in the process of library construction and cluster generation. furthermore these peaks in the distribution with consistent patterns were contributed by the accumulation of repetitive elements.

snp identification and validation
for snp calling, highly stringent filter criteria  were used. to evaluate the accuracy of snp calling, we compared the identified snps to yh snps data generated by wgs  <cit>  and dbsnp database . of  <dig>  snps identified by rrl sequencing,  <dig>  loci were previously detected by wgs and the validation rate was  <dig> %, the remaining  <dig>  loci were not involved in wgs result. of  <dig>  snps from wgs results which located on the target regions of rrl,  <dig>  snps were missed in the rrl results. based on statistic analysis, the false discovery rate  and false negative rate  of tsp 45i rrl method were  <dig> % and  <dig> %, respectively.

snp calling results generated by rrl sequencing and wgs were compared by calculating the number of loci identified as snps by two methods equally or differently regardless of the concordance of genotyping. from the results the false discovery rate of rrl method was about  <dig> % ) and false negative rate was  <dig> % ).

to figure out the main causes, false discovery and false negative loci were selected and calculated for their identification or missing. from table  <dig>  several evidences were brought forward: first, low depth coverage contributed to about  <dig> % of fnr but less of fdr; second, up to  <dig> % of false negative loci and  <dig> % of false discovery loci were filtered out due to low quality score, indicating great impact of sequence quality on snp calling; third, the copy number parameter was used for eliminating the effect of repeat sequences on accuracy of snp calling. contrary to quality score, up to  <dig> % of fdr and  <dig> % of fnr were due to copy number filter, suggesting that repeat elements had larger effect on fdr. we calculated the proportion of false discovery and false negative snps on repeat regions, the results showed that  <dig> % of fdr and  <dig> % of fnr were caused by repeat regions, which was consistent with the previous results; finally, the influence of high depth filter could be ignored. upon the statistics, the major contributors to fdr and fnr were base quality and repeat sequences, this part of fdr and fnr could be optimized by increasing sequencing depth and quality, or masking repeat sequences before snp calling. in addition, about  <dig> % of false discovery snps were present in dbsnp database, implicating that they might be novel identification. however, further experimental validation in common populations were necessary to figure out whether this part of false discovery snps was novel. except the above explanation of snps with appropriate interpretations, the remainder made up most of veritable fdr and fnr. the estimated fdr and fnr in our tsp 45i rrl should be as low as  <dig> % and  <dig> %, respectively.

to further evaluate the snp typing accuracy, we used the genotyping data generated by illumina  <dig> m beadarray to determine the concordance . of  <dig>  snps which should be on target regions of rrl,  <dig> %  were genotyped with high confidence. in total,  <dig> % of genotyping alleles were consistent with each other. the concordance rate of homozygote loci was over  <dig> %, and that of heterozygote was only  <dig> %. among  <dig>  inconsistent heterozygotes, over  <dig> % loci were scored as homozygotes because of under calling. the low concordance rate was mainly due to low depth and uneven depth distribution of sequencing reads. as we performed in silico digestion and snp calling using hg <dig> as reference, some bases in the enzyme recognition sites may be candidate snps in yh genome. if these loci were homozygous which were different from the reference, the corresponding target region could be excluded from the final rrl and the corresponding loci were accordingly undetectable, so that it may contribute to fnr . in the same way, these heterozygous snps will lead to one corresponding allele missed and wrong genotyping results, according to statistical analysis,  <dig>  loci were due to these snps located in enzyme recognition sites.

the alleles genotyped by illumina platform and rrl sequencing were classified into four categories: hom ref. , hom mut. , het ref. , and het mut. .

genome coverage and maf distribution
although a number of snps can be identified by rrl method, they are different from the other high throughput genotyping platforms such as illumina human  <dig> m duo_v <dig> b chip which can genotype about one million snps selected preferentially with the purpose of providing good coverage and distribution. to evaluate the genome coverage of rrl method, we performed comparison between rrl and illumina  <dig> m chip, our results indicated that rrl provided overall lower coverage in all three populations. among nine enzymes, the coverage provided by tsp 45i was 60% in chb+jpt populations at r <dig> >  <dig> , 78% by mbo ii with the demand to cover  <dig>  m snps which would double the cost for detection. the best coverage provided by human  <dig> m chip in ceu and chb+jpt hapmap populations was 95% and 93%, respectively, and 76% in yri population . we also investigated the distribution of snps across the whole genome by tsp 45i rrl , the density of snps in each chromosome was totally even except for chromosome  <dig>  chromosome  <dig> and some regions near telomere. the commercial products provided better coverage owing to the preferential selection of tag snps, but preferential selection made maf distribution skew to the common snps . the maf distribution in rrl method, illumina  <dig> m chip and hapmap populations were plotted, demonstrating the real maf distribution of rrl method in populations without any bias .

discussion
snps are the most abundant markers that are evenly distributed throughout genome. in human genome over  <dig> m snps are identified by hapmap project  <cit>  and 1000-genomes project  <cit> . in this study we comprehensively accessed restriction enzyme-based rrl method with yh genome, which was the first complete asian genome, including over  <dig> × whole genome sequencing data.

compared with yh genome we observed high fdr and fnr of snp calling, however, our further analysis found that  <dig> % snps were already present in the dbsnp database, implying that these loci were possibly newly identified by rrl method. repeat sequences and base quality contributed a great portion:  <dig> % of fdr loci were confirmed to locate on repeat regions. we assumed to some extent that it was due to the different sequencing platform and sequencing strategy, yh wgs was performed on the illumina genome analyzer that generated average  <dig> bp length reads obviously shorter than rrl sequencing performed on illumina hiseq  <dig> with average read length of  <dig> bp. it was consistent with the fact that longer read length could improve the accuracy of mapping into reference and consequent lower fdr; meanwhile, longer read length also leaded to lower quality score and consequent higher fdr, therefore we set up highly stringent filter parameter to reduce the fdr. we concluded that stringent filter criteria and repeat masking were necessary for increasing the accuracy of snp calling.

fnr is another important parameter to access the power of this method, and due to lack of large-scale validation approach, published reports seldom include the evaluation of fnr. the error ratio of sequencing increases with read length, which may be one of the contributors for high fnr. generally speaking, poor quality score of sequencing would not increase fnr, but fdr; however the major cause of the fnr in our study was due to the low quality score of sequencing. we consider false discovery worse than false negative in our rrl method, to confine the fdr well, we set relatively stringent parameters of snp calling, which leaded to the lost of snps with low quality score as a consequence. given restriction enzyme-based rrl methods always generate the fragments from the same start and end position, it formed low quality blocks at the 3'-end of enzyme fragments. the density distribution of fnr loci from six to ninety base along read indicated the number of fnr loci increased with position nearer to the end of reads  and significant increment of fnr was observed after  <dig> sequencing cycles. moreover, part of false negative loci occurred in first five positions corresponding to enzyme recognition site because all of these candidate snps located in recognition site would be missed by re digestion-based methods. from the comparison with genotyping results from illumina  <dig> m beadchip, the concordance rate of heterozygotes loci was only 92%, extremely lower than that of homozygotes. over  <dig> % of inconsistent heterozygotes were under-called to homozygotes partially because of low quality and inadequate depth. moreover,  <dig> % of these under-called loci were due to the disruption of recognition site by snps incorporation mentioned above. the discordance rate indicated the actual impact of disruption of recognition site. the disruption of the restriction site by a snp can never totally be ruled out and merited careful attentions.

given restriction enzyme-based rrl method identified snps around the restriction enzyme recognition site, only part of them was tag snps to represent a region of the genome with high ld. a strong correlation between the number of snps and coverage was observed in our simulative results. clearly, there was a trade-off between snps density and genome coverage.

CONCLUSIONS
rrl method combined with high-throughput sequencing is demonstrated to be an effective way for snp discovery in individuals or populations. our yh rrl data displayed high coverage and specificity of target region and identified over  <dig> k snps with about 8g sequencing data. comprehensive evaluation with this method clarified the factors contributing to fdr and fnr of snp identification and also presented the potential solution to improve the snp calling accuracy. our study extended the scope of this method and highlighted its application in the future.

authors' contributions
yd, hj and cl designed and performed this study and drafted the manuscript. yc and ql performed the data analysis and helped to draft the manuscript. jw and yq performed the library construction and sequencing. mz participated in its design and coordination. xz conceived, designed, and supervised the study. all authors read and approved the final manuscript.

supplementary material
additional file 1
summary of genomic coverage and maf distribution of different enzymes. this file shows statistics including number of markers, genomic coverage, maf distribution and spacing when performing in silico digestion by nine restriction enzymes. compared to the human  <dig> m duo_v <dig> b, tsp 45i is the most suitable enzyme considering both marker density and the other parameters. ceu: the hapmap data on individuals of european ancestry ; chb: the hapmap data on individuals of chinese ancestry ; jpt: the hapmap data on individuals of japanese ancestry ; yri: the hapmap data on individuals of yoruba ancestry .

click here for file

 additional file 2
maf distribution of putative snps in tsp 45i rrl and illumina  <dig> m beadchip. the maf distribution of putative snps in tsp 45i rrl was coincided with the curve of hapmap release <dig> data, but the distribution of snps on illumina  <dig> m chip was distinctly biased toward common snps.

click here for file

 acknowledgements
this study was supported in part by grants from the national high technology research and development program of china , and a national natural science foundation grant of china .
