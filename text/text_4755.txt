BACKGROUND
major depressive disorder is the most common mental illness, affecting an estimated  <dig> million people worldwide  <cit> . for many, mdd is a lifelong illness consisting of recurrent episode, each of which may cause disability and severely interfere with an individual’s everyday life, and greatly increase the risk of suicidal behavior  <cit> . current antidepressants are fully effective in only about a third of patients, with another third partially responding. thus there is a tremendous need to identify novel therapies to help those not served well by today’s treatment strategies. this can only come with a deeper understanding of the biology and the biological heterogeneity of mdd.

the identification of replicable biomarkers differentiating patients with mdd from healthy controls has lagged behind other diseases. this is reflected in a mega-analysis of gwas data performed by the major depressive disorder working group of the psychiatric gwas consortium on  <dig> mdd cases and  <dig> controls which identified no replicable markers, despite the detection of significant markers in 94 % of other disease tested in populations of the same size  <cit> . a key factor likely hindering the discovery of biomarkers for or prediction of mdd compared with other diseases is high degree of clinical and biological heterogeneity . in the dsm v diagnostic manual, mdd is defined by patients having at least one of the two core depressive symptoms, ‘depressed mood’ and ‘anhedonia’, and at least  <dig> of  <dig> overall symptoms. this definition alone leads to heterogeneity based on the combination of symptoms endorsed by any given patient. even within individual symptom items there is heterogeneity with criteria such as “gaining weight or losing weight”, “hypersomnia or insomnia”, “psychomotor agitation or retardation”. it would be surprising if such clinical heterogeneity were not also reflected in the biology of mdd.

two patient groups easily separable based on clinical features are those with melancholic depression and those with anxious depression. melancholic depression is characterized by pervasive anhedonia, lack of reactivity to circumstances, depressed mood of a distinct quality, and typical vegetative symptoms such as appetite or weight loss, early morning awakening, worse mood in the morning  <cit> . the prevalence of melancholic depression among depression population is around 25-30 %  <cit> . melancholic depression is found to exhibit stronger response to physical treatments but weaker response to psychotherapy or placebos compared to other subtypes of depression . anxious depression is characterized by the co-occurrence of mdd with anxious symptoms, possibly subthreshold for diagnosis of an anxiety disorder. anxiety during an mdd episode has been widely studied as a predictor of a more severe course of illness, and poorer patient outcomes .

here we report results on the janssen-brc metabolomics data set, consisting of  <dig> healthy control and  <dig> mdd subjects, of which  <dig> suffer melancholic depression and  <dig> from anxious depression. in this work, our goals are three-fold. first, we test the hypothesis that more clinically homogeneous groups of mdd patients are easier to predict from healthy controls than the entire mdd group using blood metabolomics data. second, we develop a novel method for building maximally predictive and robust machine-learning classifiers that retain information on the correlation structure of the metabolomics data to ease biological interpretation. third, we use this framework to describe the metabolomics biosignature of melancholic depression.

methods
data description
the janssen-brc metabolomic data set was part of a case-control study of mdd designed to detect biomarkers of depression and subtypes of depression by investigating various data sources, such as patients’ demographic information, psychophysiological and neuropsychological indices, and molecular profiling. volunteers were recruited nationwide by brain resource company  in australia. patients were designated as mdd if they scored > =  <dig> on the hamilton depression rating scale- <dig> . within mdd subjects, patients were designated as melancholic depressed if they additionally scored > = <dig> on the core scale . the core scale for melancholic depression consists of a 18-item scale with each item rated on a 4-point scale  by clinicians  <cit> . patients were designated as anxious depressed the number of comorbid anxiety disorders on the m.i.n.i. international neuropsychiatric interview >  <dig>  based on these diagnostic criteria, the data set consists of  <dig> healthy control and  <dig> mdd subjects, of which  <dig> suffer melancholic depression and  <dig> from anxious depression. one healthy control subject was not evaluated for anxiety, was therefore not included in the analysis of healthy control vs. anxious depressed out of caution. for detailed statistics of the samples used in our study, readers may refer to table  <dig> table  <dig> sample statistics of metabolite data for the classification of melancholic depression. mean statistics are reported with standard deviation, minimum value, and maximum value in the parenthesis



this study was approved by institutional review board /independent ethics committee  including the protocol and written informed consent form at each trial site. written consent was obtained from participants prior to enrollment in the study.

metabolomics sample
a 20 ml sample of plasma was collected into edta-containing tubes from  <dig> depressed subjects and  <dig> healthy controls  collected from four recruitment sites at brc, australia. samples were stored at brc at -20 °c prior to shipment after which they were shipped on dry ice and stored at -80 °c. plasma samples were profiled by metanomics health gmbh. plasma samples were extracted by a proprietary method and separated into four fractions  prepared for gas chromatography–mass spectrometry  and liquid chromatography–mass spectrometry . for gc-ms analytics the samples were sequentially derivatized before measurement. in lc-ms/ms analysis a metanomics proprietary technology was applied which allows target and high sensitivity mrm  profiling in parallel to full screen analyses.

data were acquired on  <dig> peaks:  <dig> peaks mapped to known metabolites and the remaining  <dig> unknown. data were centered to the median of healthy control samples, and log-transformed to assure normal distribution of the data.

correction of storage time effects
the concentration of many metabolites is known to change as a function of storage time. we removed  <dig> metabolites reported by metanomics health as having sensitivity to storage time in the same direction as the change observed in our data set, leaving us with  <dig> metabolites. those not deemed sensitive to storage may still have residual storage time effects. to assess this, we calculate the p-values of bivariate correlations between metabolites and the storage time, and assess their deviation from the null distribution  in a quantile-quantile  plot ). the calculated p-values  for metabolites are sorted in descending order and plotted against the values sampled from the expected uniform distribution of p-values. the strong deviations from the straight line suggest that either the null distribution is incorrect or that there exists a true association. in our study, we observe that the linear relationship with the storage time at -20° continues up to 200 days, while the effects of the storage time are skewed after day  <dig>  we thus remove samples stored for more than or equal to 200 days.

to control for this effect, we correct the metabolite data by taking the residuals of linear regression models on storage time at -20°  <cit> . we build the regression model on healthy controls only, and then apply the model to all subjects in order to avoid the removal of some disease-related effects as suggesied in  <cit> .

specifically, let x be one column of the metabolite feature vector  to be corrected, and t be the column vector of the storage time at -20°. the lengths of x and t equal the sample size. let xh and th denote the feature and storage time vectors of healthy controls respectively. then, we correct the metabolite features as follows.we build the following linear regression model on the  <dig> healthy control samples

 xh=β0+thβ <dig>  where β <dig> and β <dig> stand for the effect of storage time t on x, and the bias, respectively. we can estimate the parameters as follows: β0β1=sts−1stx, where s is a two-column matrix with the first column being a vector of ones and the second column being t. once β <dig> is determined, the corrected metabolite feature xc will be xc=x−tβ1⋅ 2) we apply the above storage time correction on all subjects, and repeat this procedure for all metabolite features.



after correction, the strong deviation is removed from the qq plot ) of the p-values of bivariate correlation between metabolite features and storage time, which indicates the effectiveness of the correction approach.

imputation of missing values
among the  <dig> samples used in our study,  <dig>  % of the feature values are missing. we impute the missing values by several different approaches:halfmin: impute the missing values by half of the minimum value in the corresponding feature. the assumption behind this method is that most of the missing values are too small to be detected, and therefore a simple approach is to replace the missing entries with reasonably small values. for methods such as gc/ms and lc/ms where nonlinear maps must be aligned to match peaks across samples, it may be a poor assumption that a missing value corresponds to a value below the limit of quantification, because in some instances a missing value may be the result of a misaligned, though possibly large, peak which does not get counted.

knn3: impute the missing values by the k-nearest neighbor method . knn imputes a missing value with a weighted average of the top k nearest-neighbor columns . the weights used in knn are inversely proportional to the distances from the neighbor columns.

em: impute the missing values by the expectation-maximization  method  <cit> . under the assumption that the data matrix is gaussian distributed, em algorithm imputes the missing values with conditional expectation values by iteratively estimating the mean and covariance matrix from incomplete data and maximizing the likelihood of the available data.

svd: impute the missing values by the singular value decomposition  method. the svd method, assuming the data matrix is low-rank, imputes the missing values by iteratively updating the data matrix with low-rank approximations.



in our study, all the input data matrices are normalized with zero mean and unit standard deviation before feature selection or classification. the distributions of original and imputed values of four metabolite features  are shown in additional file 1: figure s <dig>  the distribution of the values imputed by knn <dig>  em and svd are very similar to that of original data while the halfmin method yields an imputed data with more small values as it assumes that the missing values are too weak to be observed. for our primary results reported we use knn <dig> and contrast with halfmin to compare the effect on classifier performance.

cluster representation
recent studies on statistical learning show that advanced feature learning algorithms like lasso may fail to select important but highly correlated features simultaneously, and show that the clustered lasso may lead to improved prediction and feature selection  <cit> . in clustered lasso, we first apply clustering on the features to identify a set of feature groups. then, we construct a reduced dataset consisting of cluster-representatives, which refer to the averages of the features from the same cluster. in our experiments, we first cluster the features into  <dig> groups by two clustering algorithms, k-means and hierarchical clustering, and then generate a 100-dimensional dataset with each feature being the centroid of each cluster. the distance used in k-means was euclidean distance while the inter-cluster distance used in hierarchical clustering was the maximum correlation between points in two different clusters. for each cluster, the cluster centroid is calculated, and this is the new feature which is then used for classification.

we show the qq plots of the p-values in the two-sample t-test are improved through feature clustering . although all the p-values obtained on raw features seem to be non-significant except for the minimum one, there exist strong signals for the clustering representatives . this is because qq plot assumes that the p-values are independent to each other while the raw metabolite features are correlated to each other and the clustering on features can effectively mitigate the correlation.

an ensemble feature selection framework 
figure 2c illustrates the feature selection + ensemble framework used in our study and we name the process the ensemble feature selection framework 

ensemble learning is a general and powerful framework in machine learning. the underlying philosophy of ensemble learning is to build a learner by combining a collection of base learners  <cit> . ensemble learning can be divided into two tasks: 1) building a set of base learners from the training data; 2) combining the base learners to produce the predictor. the majority voting scheme in our study is one type of the ensemble learning methods. the base learners  are first trained from each undersample, and their predictions on testing data are then combined to form the final prediction which decides the output that has the majority .

undersampling
in our study, the ratio between the number of melancholic depressive patients and the number of the healthy controls is around 1: <dig>  which is shown in table  <dig>  traditional machine learning methods are less effective for such severely imbalanced data set as the classifier trained in such case will be biased towards the majority class. we adopt a very effective and commonly used approach, called “undersampling”, to deal with the imbalance problem . in our case, we have a relatively large number of negative samples  and a relatively small number of positive samples . during the training stage, we randomly select a subset of negative samples with size equal to the total number of positive samples, and build a classifier on the combination of the positive samples and the undersampled negative samples. for instance, if there are  <dig> negative samples and  <dig> positive samples available in the training set, then  <dig> out of  <dig> negative samples will be randomly selected, which is combined with the  <dig> positive samples to form a training set to build a classifier. to reduce the variability of random undersampling and further enhance the performance, we repeat the undersampling procedure  <dig> times in the experiment and thus build  <dig> classifiers during the training process. finally, we combine all the k classifiers via majority vote as the final prediction.

feature selection
to identify the most predictive features, we apply feature selection. since we adopt the undersampling strategy in the training process, we do feature selection on each undersampled data set and combine feature selection results to generate a final ranking of features. we employ both univariate and multivariate feature selection methods in this study including t-test  <cit> , fisher’s score  <cit> , gini index  <cit>  and stability selection  <cit> .

classification
two different widely used classifiers were tested in this study: support vector machines  and random forest . svms were first introduced in  <dig>  <cit> . in the task of binary classification, svm separates the two classes of data points by determining a boundary with a hyperplane which maximizes the margin of the boundary. the margin is defined as the width that a boundary could be increased by before hitting a data point. svms can easily build non-linear classifiers by adopting the kernel tricks  <cit>  to implicitly map the input data into high-dimensional non-linear feature space where the data are more easily separable. in rf, the learning approach models a predictor that averages a collection of de-correlated decision / regression trees  <cit> . in random forest, the algorithm makes a large set of bootstrap samples and builds decision / regression trees on them by selecting the best split point among a random subset of features. the final model of the random forest is the ensemble  of the trees grown in the bootstrap samples. random forest takes advantage of the bootstrap aggregation to effectively reduce the high-variance made by the trees and shown success in a wide range of applications  <cit> .

in our experiments, we report the classification performances obtained from 10-fold cross validation. we randomly divide the data into  <dig> sets of equal size, and, holding out one set for testing, use the remaining  <dig> sets for training. the efsf is applied on the training data and the learned models are used for prediction. each set is used for testing once and thus the training and testing procedure is repeated  <dig> times.

classification performance measures
in our experiment, we treat melancholic depressed patients as positive samples and healthy controls as negative samples. because the dataset is highly imbalanced, the commonly used performance measure, i.e., classification accuracy, is not sufficient. in addition to accuracy, we also reported both sensitivity and specificity which measure the proportions of positive and negative samples classified correctly. specifically, sensitivity=numberoftruepositivesnumberoftruepositives+numberoffalsepositives 

and specificity=numberoftruenegativesnumberoftruenegatives+numberoffalsenegatives. 

in our experiment, the classification performance measures  are obtained from 10-fold cross-validation, described above.

permutation testing
in order to demonstrate the strength of the signals discovered in our study, we propose to use the framework of permutation testing  <cit>  to validate the learning results. in the permutation test  <cit> , sample labels  are randomly permuted and the trained classifiers are tested on the permuted data set. the permutation-based p-value is defined as the fraction of randomized samples where the classifier performs better in the original data than in the permuted data, and is computed as: p=d'∈d^:ef,d'≤ef,d+1k+ <dig>  where d^ is a set of k randomized  data sets d ' of the original data d, f is the trained classifier, and e represents the error function.

network visualization
metabolites from the top  <dig> ranked clusters in the k-means clustering were analyzed using ipa  for visualization and metabolite annotation. metabolites were mapped to kegg identifiers using the human metabolome database ; kegg id’s were used as input in ipa. in some cases, the identity of metabolites was too specific for mapping to the kegg database. where possible, metabolites were assigned a kegg id, which encompasses a class of molecules, e.g. triacylglycerides. a union of  <dig> metabolites from the  <dig> feature selection methods was used as input. of the  <dig> metabolites,  <dig> were mapped to kegg.

RESULTS
classification performance on mdd subtypes
we first compared the performance of the random forest classifier using knn <dig> imputation using individual metabolites  on three different classification tasks illustrated in fig.  <dig> :  mdd vs. healthy control,  anxious depressed vs. healthy control,  melancholic depressed vs. healthy control. the classifier performance was higher for melancholic depressed patients than for the other two subgroups , suggesting that melancholic depressed patients may be more homogenous at the biological level  and easer to predict using a metabolomics biosignature. that anxious depressed subjects were not predicted with as high a degree of accuracy could mean that either there is less of a signal in the blood metabolome associated with symptoms of anxious depression, or alternatively that within that designation, there is still a considerable degree of biological heterogeneity. for the remainder of this work we focus on building a robust classifier for melancholic depression, and to describe the biology underlying the biosignature.fig.  <dig> metabolites classify melancholic depression from healthy controls with greater accuracy mdd as a whole or anxious depression. a classifiers for  <dig> mdd,  <dig> anxious depressed, and  <dig> melancholic depressed subjects were trained against  <dig> hc subjects . b the table includes results using knn imputation, random forest classification using individual metabolites as features, and the feature selection method which resulted in highest accuracy  for each comparison



a robust classifier for melancholic depression
we next focused on optimizing the classification of the melancholic depressed subjects from healthy controls. classifiers were built using either individual metabolites , or deriving features by first clustering metabolites using k-means or hierarchical clustering into  <dig> cluster. the  <dig> cluster centroids were used as features in the predictive models .fig.  <dig> analytic workflow aimed at maximizing both predictive power and biological interpretability. a metabolite preprocessing includes  correction of each individual metabolite for storage time effects,  imputation of missing data,  feature clustering,  classification using ensemble learning framework,  selection of top clusters/features,  pathway analysis and biological interpretation. b example of cluster containing  <dig> metabolites. highly correlated features are grouped into clusters using k-means or heirarchical clustering. for each cluster, the cluster centroid is computed and used as a feature for ensebml learning. subsequent pathway analysis includes all members of top clusters. c illustration of the ensemble learning framework. given the imbalanced training data, we randomly undersample the training data k times, and then we perform feature selection and classification on each undersampled dataset. finally, we combine all k classifiers to make the final prediction, and report out top cluster-features



the ensemble feature selection framework  was run testing four imputation methods , and four feature selection methods . tables  <dig> and  <dig> show the classification results by random forest and svm, respectively, across all imputation, feature selection and classification methods. we observed that random forest achieved higher classification performance than svm in most cases.table  <dig> comparison of the classification performance obtained by random forest. for three clustering strategies, we compare  <dig> different imputation methods: halfmin, knn <dig>  em, and svd. and four feature selection methods: fisher, gini, t-test and stability. these are described in the methods. the method used for subsequent pathway analysis is in bold

 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %



imputing missing values with half of the minimum feature value achieved better performance than other methods on individual metabolite features, while k-nearest neighbor imputation outperforms others on cluster-representatives . the performance obtained by the em imputation is slightly worse. however, overall all imputation methods achieve fairly comparable classification performance, a robustness that may be conferred by the small amount of missingness in the data set.

stability selection, which penalizes highly correlated features that are less likely to be selected together in a model, performed consistently better on the individual features . in contrast, gini index performed better when learning was performed on cluster-centroids.

classification performance  overall was higher on k-means-clustered features than when using individual metabolite features; this indicates that highly correlated features with high predictive power can be effectively grouped by clustering approaches.

we also compare the efsf framework with the standard undersampling method using exactly the same training-testing data splitting. the result of the standard undersampling method depends on which majority samples are selected. to get a good estimate of the performance of the standard undersampling method, we simply use the k classifiers from the k undersampled  data constructed in the efsf and report the average performance of these k classifiers. the results are shown in additional file 1: tables s <dig> and s <dig> for random forest and support vector machines, respectively. we observe that, the highest performance  achieved is around 73 %, which is significantly lower than that obtained by the efsf.

to further validate strength of the signals discovered in the study, we permutations tests  and find that, for all cases, the classifier consistently performs better in the original data than in the permuted data and the permutation-based p-value is 1/ <dig>  which indicates that the performances achieved in the original study is significantly high with significant level α =  <dig>  . this suggests our classification performance is not the simple result of over-fitting to a small number of samples.fig.  <dig> classification accuracy obtained by random forest and svm in permutation tests. the missing values in the data set are imputed via knn <dig> method. the performance obtained in the original experiment is shown for reference



the blood metabolomic biosignature of melancholic depression
we selected k-means clustering, knn <dig> imputation with random forest classification as the combination method with highest overall classification performance on which to perform pathway analysis. each feature selection method resulted in similar classification accuracy , although cluster representatives selected by each method did not overlap completely. the number of cluster representatives required for optimal performance also varied;  <dig>   <dig>   <dig>  and  <dig> for gini, stability, fisher, and t-test, respectively. features comprising the top  <dig> clusters ranked by score were selected from each method for evaluation of the biosignature. the union metabolites from the  <dig> methods was used, as each feature selection method resulted in similar classification accuracy and was, therefore, hypothesized to contribute biological information of interest. this yielded  <dig> metabolites,  <dig> of which were selected by at least  <dig> of the  <dig> methods. stability selection exhibited the least overlap with other methods, identifying  <dig> unique metabolites.

fifty-six of the  <dig> metabolites were mapped to kegg identifiers and analyzed. table  <dig> lists the unique metabolites with their ontology class and the cluster ranking by each feature selection method. top ranked features selected by other combinations of the ensemble framework parameters are included in additional file 1: tables s3-s <dig>  a high degree of robustness among the top features is observed.

many of the clusters were comprised of metabolites falling within the same ontology class , suggesting that expression of classes of metabolites often co-vary with each other. as expected, performing classification with cluster representatives retained metabolites which could be biologically relevant, but which would have been excluded as redundant information using other classification methods.table  <dig> unique metabolites included in pathway analysis. metabolites from the knn <dig> imputed, k-means clustering, were analyzed using ipa. standardized kegg nomenclature is included together with metabolite class and ranking of cluster representatives in the four feature selection methods. metabolites were selected for pathway analysis if they were members of a cluster that was among the top  <dig> cluster-centroids selected by gini, stability, fisher, or t-test. of  <dig> selected metabolites,  <dig> were selected by  <dig> of the  <dig> methods.  <dig> of the remainder were selected only by stability



overall, the majority of the selected metabolites were increased in melancholic depressed vs. healthy control subjects . some metabolite classes contribute greatly to the classification of melancholic depressed subjects from healthy controls . eleven of the  <dig> metabolites analyzed were amino acids , and several others  are products of amino acid degradation or related. fourteen of the metabolites are related to lipids  and most are increased in melancholic depressed subjects. while these changes suggest differences related to overall metabolism, there was no obvious mechanism revealed by canonical pathway analysis for these classes of metabolites.fig.  <dig> network analysis of metabolites. ipa network analysis was used to view connections between selected metabolites. several classes and biological functions were observed and are highlighted in the diagram. red-filled metabolites are increased comparing melancholic depressed subjects to healthy controls, while green-filled metabolites are decreased. higher intensity color indicated larger changes. increases range from  <dig>  to  <dig>  fold change, while decreases range from - <dig>  to - <dig> 



some of the metabolites suggested functional pathways of interest. several are involved in catecholamine synthesis and degradation , which have been studied for the treatment of depression. three metabolites related to stress hormone signaling  were also identified as increased in melancholic depression vs. healthy controls. there are also  <dig> immune-related molecules  that are decreased in melancholic depressed subjects.

discussion
several studies have sought to understand symptomatic differences between mdd subtypes with inconsistent conclusions. a recent nesda study  <cit>  identified  <dig> main symptomatic groups which seemed to approximate melancholic, atypical, and undifferentiated/mixed subtypes. another meta-analysis concluded that there is too much heterogeneity in studies and not enough detailed symptomatic information available to classify subtypes of mdd  <cit> . a third group found that response to antidepressants could not be predicted based on depression subtypes  <cit> . the variability of these studies suggests that symptomatic classification of mdd may not always reflect a shared etiology in depression subtypes. several studies, however, point to factors such as severity of mdd, heritability, chronicity, and traumatic childhood events as being characteristic and predictive of melancholic depression  <cit> . the fact that melancholia has a strong heritable component suggests that there is an underlying biological dysfunction which could be represented by molecular features and which could also be used to classify melancholic depressed subjects from other mdd subtypes or healthy controls. in our study, we have identified blood metabolite markers which are able to distinguish melancholic subjects from healthy controls with 80 % accuracy.

in our empirical study, the ensemble feature selection framework has shown great effectiveness in both feature selection and classification on imbalanced metabolite data. we thus expect it to be a promising framework capable of achieving robust classification results for the analysis of other biomedical data where the sample distribution is severely imbalanced. based on the efsf framework, we identified discriminative metabolite features related to melancholic depression, which are biologically relevant to the disease state.

we found that different methods of data imputation and feature selection had only minor effects on the accuracy of classification, suggesting that there are robust metabolite changes that can classify melancholic depressed subjects from healthy controls. interestingly, although the overall accuracy of classification was similar, stability feature selection identified several different metabolites than other methods. different from other feature selection methods, stability selection identifies features which are stable under data perturbation . because all of the methods resulted in similar accuracy, we hypothesized that all of the metabolites were important contributors to melancholia and applied pathway analysis to understand biological functions that can contribute to the disease.

despite characteristics of slowed motor movement, melancholic depression is described as a physiological state of hyperarousal, which includes a chronic activation of the hypothalamic–pituitary–adrenal axis. this stress pathway has been studied extensively in melancholia and in animal models of chronic stress . elevated levels of the glucocorticoid, cortisol , is an important signaling molecule in this pathway and is increased in numerous studies of melancholia. although cortisol changes are present in multiple subtypes of mdd, a recent meta-analysis of  <dig> studies found that the effect size for cortisol was larger when restricted to just melancholic depressed subjects  <cit> . consistent with other studies, we identified an increase in cortisol in melancholia vs healthy controls. however, because we took a metabolomic approach, we also identified increases in other metabolites in the hormone biosynthesis pathway . together these data might suggest a dysregulation promoting steroidogenesis in the upstream pathway. glucocorticoids are also important anti-inflammatory molecules. there is renewed interest in the involvement of inflammation in the development of mdd, and it has been hypothesized that there is immune repression in melancholia mediated by chronic cortisol levels and activated inflammation in atypical depression  <cit> . our results are consistent with immune repression, evidenced by lower levels of histamine and arachidonic acid in melancholic depressed compared to healthy control subjects.

we also saw increases in catecholamine pathways, which are inherently linked to glucocorticoids through a complex feedback system. lamers et al.  have postulated that melancholic depression is a state of chronic stress, which activates corticotropin releasing hormone , cortisol, and norepinephrine  pathways in the absence of inhibitory feedback. several metabolites in this pathway were removed from our dataset due to instability over long storage times, including ne itself. however, ne’s precursor, dopamine, and metabolites of ne  were increased in melancholic depressed subjects, which could suggest that ne may also be elevated. another member of the catecholamine pathway is serotonin, which is decreased in our dataset. an important class of antidepressants, selective serotonin reuptake inhibitors , is aimed at increasing extracellular levels of serotonin to treat depression. a decrease in plasma serotonin, as seen in these melancholic subjects, would be hypothesized to contribute to a depressive state.

heart disease and type ii diabetes  have been cited as comorbidities of depression, which increases the mortality rate in depressed subjects independent of suicide. one shared mechanism for heart disease and t2dm is dyslipidemia characterized by increased triglycerides and fatty acids. metabolic factors have been hypothesized to be associated with atypical depression, because of an increase in appetite and body mass index   <cit> . the power study  <cit> , however, found significant increases in triglycerides, acth, and leptin in a melancholic, but not atypical depression, cohort. conversely, at least one study found no differences in triglycerides between melancholic and healthy subjects  <cit> . we found that both triglycerides and fatty acids were increased in melancholic depressed subjects compared to healthy controls, even though there was no difference in bmi between the groups . clusters containing triglycerides were consistently ranked highly by  <dig> of the  <dig> feature selection methods, indicating that they were important in classification of melancholia. although not measured in this study, inflammatory factors such as cytokines may also play a role in development of insulin resistance in these subjects.

two modified triglycerides  are particularly interesting as they were highly ranked in each of the feature selection methods. there is little literature about lipid hydroperoxides, although a recent study correlated an increase in lipid hydroperoxides and an inflammatory marker, c-reactive protein , in depressed smokers  <cit> . lipid hydroperoxides are hypothesized to occur physiologically in plasma under conditions of oxidative stress and may also play a role in the development of heart disease  <cit> . in the nesda dataset, the melancholic group contained a statistically significant increase in smokers over other types of depression  <cit> . we were unable to explore this correlation as our study did not record smoking status.

amino acids are another class of metabolites that is consistently increased in this study of melancholic depression. while a mechanism for elevated amino acids cannot be determined from this dataset, there is evidence that this class of metabolites can differentiate mdd from healthy subjects. branched chain amino acids were decreased following treatment with the selective serotonin reuptake inhibitor antidepressant sertraline  <cit> . another recent study concludes that a combination of tryptophan, cysteine, and glutamine are capable of differentiating mdd from controls, although their results, unlike ours, identify a decrease in these plasma amino acids  <cit> . the inconsistency in directionality of amino acid changes potentially arises from the difference in study populations, where xu et al.  <cit>  examined mdd, and our results are determined from the melancholic subtype, which comprises only ~20 % of mdd patients in our study.

CONCLUSIONS
this paper explores the metabolic biomarkers for melancholic depression, a major subtype of mdd. a comprehensive multivariate study on the identification of metabolic biomarkers that are strongly related to melancholic depression is of great importance and necessity for understanding the illness and the development of pharmaceuticals and therapies. to address the problems of confounding effects, incomplete data, feature correlation, and imbalanced sample distributions, we explored different data correction, imputation, and feature grouping methods with an ensemble feature selection framework for identifying biomarkers and building prediction model. our extensive experiments on the metabolite data show that strong signals exist in metabolite data that can differentiate melancholic depressive patients from healthy controls. our pathway analysis on differentiating metabolites elucidates underlying molecular mechanisms that could contribute to melancholic depression. we expect that the proposed computational system can be adapted to analyze other biomedical data with similar characteristics, which are common in many biomedical applications.

abbreviations
bmi, body mass index; brc, brain resource company; crh, corticotropin releasing hormone; efsf, ensemble feature selection framework; em, expectation-maximization; halfmin, half of the minimum value; hc, healthy control; jrd, janssen research & development, l.l.c; knn, k nearest neighbor method; mdd, major depressive disorder; ne, norepinephrine; pmd, psychomotor disturbance; svd, singular value decomposition; t2dm, type ii diabetes

additional file
additional file 1: figure s <dig>  effect of storage time correction. figure s <dig>  the distributions of original and imputed metabolite features: glyoxylate ratio, caffeine ratio, elaidicacid ratio and indole  <dig> propionic acid ratio. figure s <dig>  qq plots of the p-values of the two-sample t-tests on raw features, k-means and hierarchical clustering representatives. table s <dig>  classification performance obtained by random forest on metabolite data using the standard undersampling technique. table s <dig>  classification performance obtained by support vector machines on metabolite data using the standard undersampling technique. table s <dig>  top  <dig> individual metabolic features selected by different feature selection methods. table s <dig>  top  <dig> individual metabolic features selected by different feature selection methods. table s <dig>  top cluster-representatives  selected by different feature selection methods. table s <dig>  top cluster-representatives  selected by different feature selection methods. table s <dig>  top cluster-representatives  selected by different feature selection methods. 



