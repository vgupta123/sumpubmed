BACKGROUND
dna barcoding, i.e., the identification of biological diversity using standardized dna regions, has been demonstrated as a new, very useful approach to identify species  <cit> . originally, dna barcoding was proposed to assign an unambiguous tag to each species, giving to taxonomists a standard method for identification of specimens. in this context, it was also proposed that dna barcoding is an opportunity to accelerate the discovery of new species  <cit> . today, the fields of applications of this approach are broader. as example, dna barcoding has been already used in biodiversity assessment, forensics, diet analysis and paleoecological studies  <cit> .

in the former context, a portion of mitochondrial cytochrome c oxidase  has been proposed as the standard barcode for animal identification  <cit> . since then, other portions of dna have been proposed as barcodes, because different dna regions have different performances in some taxa . if we consider the other applications of barcoding , the necessity to limit the number of usable barcode loci for conserving the standard aspect of this method can be relaxed. in such a new context, multiple barcodes in different regions of the genome could be combined to improve identification, according to the taxon studied and to the aims of the research  <cit> . therefore, the first step of a sensu lato barcoding study should be the selection of the best dna region to be used as barcode considering the aims of the study. the availability of large public sequence databases may allow comparing multiple potential barcodes and their properties before performing studies.

among the properties of an ideal dna barcode, high taxonomic coverage and high resolution are essential  <cit> . a high taxonomic coverage  would allow the application of barcodes to a number of taxa as large as possible, including undescribed species. this constraints the dna barcode region to have sufficiently conserved flanking regions enabling the design of universal primers. this is especially important for describing unknown biodiversity or diversity within environmental samples such as soils or faeces  <cit> . however, universality can be extremely difficult to achieve, because of the incomplete knowledge of genetic variation in poorly studied taxa  <cit> . the resolution capacity of a barcode is its ability to differentiate and identify species that relies on interspecific differences among dna sequences  <cit> . thus, the challenge for defining a barcode of good quality consists in finding a quite short and enough variable dna sequence flanked by highly conserved regions. depending of the application, the size, the taxonomic coverage or the resolution of the dna barcode could be the most important characteristic to optimise  <cit> .

this study proposes an explicit approach for comparing the performance of potential barcoding regions, which is based on 'in silico pcrs' performed over extensive databases, and on two indices that estimate the resolution capacity of the barcodes and the taxonomic coverage of the primers used for their amplification. as an example, we analysed several primers available from the literature that have been used in sensu lato barcoding studies  <cit>  for the identification of vertebrates species. first, we assessed the taxonomic coverage of several primer pairs by evaluating the proportion of species amplified in silico in a purposely designed database. subsequently, we analyzed the genbank sequences amplified by each primer pair, in order to evaluate the proportion of species correctly identified on the basis of their barcodes. we also used an in vitro analysis to validate the correspondence between in silico and real world pcr.

methods
general strategy
first, we created a reference database representative of the mitochondrial genomes of all vertebrates, by retrieving from genbank all the complete mitochondrial genomes of vertebrates available . subsequently, we randomly selected one sequence per species, to reduce the overrepresentation of a few species . we obtained a set of  <dig> mitochondrial genomes representative of the five major monophyletic clades of vertebrates . most of species were the unique representative of their genus and the database corresponded to  <dig> genera.

to analyze the performance of each primer pair studied, we first performed an in silico pcr on the reference database and we evaluated the taxonomic coverage of each primer pair as the proportion of amplified taxa. then, we performed an in silico pcr on the whole genbank, to evaluate the resolution of the amplified fragments that represents the proportion of unambiguously identified taxa. these properties were evaluated for the whole vertebrates and for each of the five clades which compose it.

in silico pcr
an in silico pcr consists in selecting in a database the sequences that match  two pcr primers. the regions matching the two primers should be localised on the selected sequence in a way allowing pcr amplification, which forces the relative orientation of the matches and the distance between them. in order to simulate real pcr conditions, the in silico pcr algorithm should allow some mismatches between the primers and the target sequences. standard sequence similarity assessment programs such as blast  <cit>  are not suitable for such kind of analysis because the heuristic search they use is not efficient on short sequences. moreover, a post processing of blast output should be performed to verify previously stated constraints. we have developed a program named ecopcr that is based on the very efficient pattern matching algorithm agrep  <cit> . this algorithm allows specifying the maximum count of mismatched positions between each primer and the target sequence, and to use the full iupac code . it also allows specifying on which primer's specific positions mismatches are not tolerated, what is useful to force exact match on the 3' end of primers for simulating real pcr conditions. moreover, to facilitate further analysis, ecopcr output contains the taxonomic information for each sequence selected from the database. for the analyses presented in this article, we allowed two mismatches between each primer and the template, except on the last  <dig> bases of the 3' end of the primer. analyses performed with  <dig>   <dig> or  <dig> mismatches led to similar conclusions , even if the results were sometimes different . this software was developed for unix platforms and is freely available at http://www.grenoble.prabi.fr/trac/ecopcr.

measuring taxonomic coverage
to measure the taxonomic coverage of a primer pair, we defined a coverage index bc as the ratio between the number of amplified taxa for a specified taxonomic rank  and the total number of taxa of the same level representing the studied clade in the reference sequence database. bc can be computed from ecopcr output file using the ecotaxstat script.

measuring resolution capacity
the resolution capacity of a barcode was estimated by an index measuring the ratio of unambiguously identified taxa for a given taxonomic level over the total number of tested taxa. a taxon unambiguously identified by a primer pair owns a barcode sequence associated to this pair that is not shared by any other taxa of the same taxonomic rank. to be computed, this definition can be formalized considering the mapping e, img and e' between four concept sets: taxon , individual , barcode  and region  . considering the a taxon t ∈ t and a primer pair  r ∈ r and using the mapping e, img and e' we define the Ω set of all barcodes belonging to a taxon for a region:

 Ω =img) ∩e' 

from the above description, we note the set of all individuals owning a barcode corresponding to a taxon as:

 img−1≡∪iimg− <dig> 

this allows defining an unambiguously identified taxon t by a barcode region r if and only if:

 img−1) =e) 

this defines a mapping ε of t to r and allows to define the specificity index bs as:

 bs=|{t/tε r}||t| 

bs can be computed from an ecopcr output file using the ecotaxspecificity script. ecotaxspecificity and ecotaxstat scripts are parts of the obitools python package freely available at http://www.grenoble.prabi.fr/trac/obitools.

in a few cases, especially for chondrichthyes, ecopcr ran over the entire genbank yielded only a small number of sequences. thus, we calculated the resolution capacity of a barcode only when the primer pair amplified more than  <dig> species.

correspondance between in vitro and in silico pcrs
strict experimental validation of the electronic pcr realized over large databases would be extremely difficult, as it would require obtaining tissues from hundreds of species. alternatively, specific primer pairs designed to amplify only one species can be used to confirm the correspondence between the results of ecopcr and in vitro pcr. therefore, we designed specific primers to amplify mitochondrial dna of three species, using ecopcr to test their specificity. then, we cross-amplified the three species with each primer pairs with in vitro pcr to verify the ecopcr predictions.

we considered three species of asiatic felidae: the leopard ; the snow leopard  and the leopard cat . we designed specific primers for amplifying short sequences of mitochondrial 12s; this kind of primer pairs can be used to identify species from degraded dna and remains, such as faeces. the three primer pairs were:  pantf, 5'-gtcatacgattaacccgg-3'; pantr, 5'-tgccatatttttatattaactgc-3', designed to amplify the leopard ; , uncif, 5'-ctaaacctagatagttagct-3', uncir, 5'-ctcctctagaggggtg-3', designed to amplify the snow leopard ;  priof, 5'-cctaaacttagatagttaatttt-3', prior, 5'-ggatgtaaagcaccgcc-3', designed to amplify the cat leopard . dna was extracted from faeces using qiaamp dna stool kit . the pcrs were conducted in a  <dig> μl total volume with  <dig> mm tris-hcl ,  <dig> mm kcl,  <dig> mm mgcl <dig>   <dig>  μm of each primer, bsa ,  <dig>  u of amplitaq gold dna polymerase  and  <dig> ml of dna extract. for all primers, the pcr programme included an initial  <dig> min denaturation step at 95°c,  <dig> cycles of denaturation at 95°c for  <dig> s and annealing at 53°c for  <dig> s. samples of each of the three species were amplified with the three primer pairs, to verify in vitro the possibility of cross-amplification. we also tested cross-amplification ability of these primer pairs using ecopcr, allowing two mismatches between each primer and the template, except on the last  <dig> bases of the 3' end of the primer; subsequently, we simulated more relaxed pcr conditions  <cit>  by allowing a larger number of mismatches.

vertebrate primer pairs tested
the vertebrate primers tested  were selected in the bibliography as representative of the diversity of the strategies used for defining barcodes. some of them  were highly degenerated, in order to maximise the number of taxa amplified   <cit> . most of primers chosen amplified long sequences  to maximize resolution, while some  have been designed to amplify short sequences, to maximize the possibility of retrieving sequences from damaged/ancient dna  <cit> .

* as reported on the original paper.

RESULTS
validation of in silico pcr
with in vitro pcr, each pair of specific primers amplified only the species for which it was designed: pant primers amplified common leopard only; unci primers amplified snow leopard only, and prio primers amplified cat leopard only . crossamplification through ecopcr yielded identical results when allowing two mismatches. a more extensive analysis using ecopcr, and allowing a larger number of mismatches , shows that pant primers require at least  <dig> mismatches for cross-amplifying uncia uncia. similarly, unci and prio primers require at least  <dig> mismatches for cross amplifying other species.

evaluation of vertebrate primer pairs: taxonomic coverage
the primer pairs tested showed very different taxonomic coverage. overall, coi- <dig>  16sr and 16sr <dig> were the primers with the highest percentages of species amplified . following our in silico pcrs, the primers with the lowest coverage corresponded to uni-minibar, coi- <dig>  coi-2h, mcb and cytm. the primers also differed in their performance in amplifying the major clades of vertebrates. for example, coi- <dig> had the highest amplification rate in chondrichthyes, while it amplified only 32% of the mammals. conversely, 16smam amplified most of the mammals, but failed in the amplification of chondrichthyes . nevertheless, in a similar way to how modifying the annealing temperature influences in vitro pcr  <cit> , the number of electronically amplified species can be quickly increased by allowing a larger number of mismatches . for example, with primers uni-minibar, the proportion of amplified species reached 98% with eight tolerated mismatches .

in the analysis of resolutions, only primers amplifying more than  <dig> species per taxon are considered.

n: number of sequences amplified from genbank.

* the resolution was not calculated as the primer pairs amplified  <dig> or less different species for this taxon.

resolution capacity of barcode regions
when tested over the entire genbank, most of the primer pairs had a very high resolution capacity, indicated by a high bs index . we did not calculate bs for primers uni-minibar and coi-2h because of the low number of species amplified with the settings used for this analysis . only the 16smam primer pair, which amplifies a very short sequence , had bs < 85%. bs was ≥ 90% for all other primer pairs and even > 97% for 16sr and 16sr <dig> whatever the vertebrate clade analysed . apart from a few cases , the resolution capacity of all primer pairs was consistently high across all taxa tested. these bs differences are not correlated with the number of genbank sequences amplified .

the in silico pcrs performed over the entire genbank always yielded sequences from the target mitochondrial region. none of the primers amplified sequences recorded as nuclear sequences in genbank.

discussion
the identification of universal primer pairs amplifying fragments with high resolution capacity is a major task of dna barcoding, and can help the broad scale analysis of life on earth. however, some authors argued that it is impossible that a single short sequence will be enough to distinguish all members of all species  <cit> . in this context, explicit in silico approaches like the one presented in this study allow analysing the properties of different sets of primers, and identifying the most appropriate ones a priori.

in silico vs. real pcr
the real in vitro amplification pattern depends on pcr conditions. controlling the pcr conditions can alter amplification results, and thus the taxonomic coverage of primers. for example, low annealing temperature and high concentration of mgcl <dig> reduce the specificity of primers in real-world pcr, and can thus allow amplification of target sequences with a larger number of mismatches in the primer regions  <cit> . our in silico analyses have been performed allowing two mismatches. these parameters correspond well to actual amplification at rather high annealing temperatures , in accordance with previously published environmental genetics studies  <cit> . nevertheless, these stringent conditions probably lead us to predict more false negative results  than false positive ones . increasing the authorized mismatches can simulate more relaxed conditions, but the strict relationship between electronic and experimental conditions cannot be formally described. on the other hand, stringent pcr conditions reduce the risk of amplifying unwanted regions of the genome , particularly when using degenerate primers. furthermore, our study focused on sensu lato barcode primer pairs. these studies often amplify dna extracted from environmental samples, which may represent a mix of the dna of several taxa  <cit> . considering this, primers and pcr conditions must be as specific as possible, because the rare species with a low number of mismatches in the primer region  are expected to be overamplified and overrepresented in the pcr products, while species that are present, but with a higher number of mismatches, may not be amplified enough to yield sequences. therefore, "ideal" primers would have a constantly low number of mismatches, leading to a less biased estimate of species presence.

ecopcr can also be used to simulate less stringent pcr conditions, allowing more mismatches. with this approach, primers can amplify a much larger number of species . for example, in our stringent in silico analysis the primers uni-minibar showed limited taxonomic coverage, and amplified very few vertebrates . conversely, the pcrs performed by meusnier et al.  <cit>  showed that these primers can amplify nearly 100% of fish and amphibians, at an annealing temperature of 46°c. results coherent with meusnier et al.  <cit>  can be obtained using ecopcr by allowing a large number of mismatches  . taking into account all these considerations, we have to assume that the taxonomic coverage bc estimated from ecopcr is not an exact value, but it reflects the relative capacity of primer pairs to amplify a broad variety of taxa. for example, the fact that 16sr amplifies a much larger number of species of amphibians than coi-2h  was correctly predicted by in silico analyses .

pseudogenes are a further potential issue in barcoding analysis; our approach may be affected by this trap. for instance, in our analyses none of the primers amplified nuclear sequences. however, nuclear sequences are underrepresented in genbank; furthermore, the in silico amplification of pseudogenes would require the presence of a target nuclear sequence and both the corresponding primer regions, i.e., a good coverage of nuclear genome. therefore it is difficult that ecopcr hits nuclear pseudogenes, which can nevertheless be amplified by in vitro pcr, particularly under relaxed  conditions. another potential issue of our approach is that the adjoining primer regions of sequences submitted to the databases are not a query-able portion of the database, therefore limiting the number of sequences obtained when ecopcr is run over the entire genbank. to partially address this issue, the assessment of taxonomic coverage was performed on species for which the whole mitochondrial genome was available, and therefore both target sequences and flanking regions are present. the increasing availability of whole mitochondrial genomes due the improvement sequencing technologies, and the rising of phylogenomics may reduce this limitation in the next future.

the correspondence between in silico and real pcr is certainly more accurate for the resolution capacity, still potential sources of bias remain. our approach is based on the analysis of all the sequences deposited in genbank, i.e., including thousands of vertebrate species in the example developed here. assuming that all genbank sequences are assigned to the correct species in the database, such approach uses the same kind of information than large scale barcoding studies. clearly, the availability of sequences in different clades depends on the previous use of markers. for example, genbank includes a very large number of coi sequences for actinopterigii, while most of the mitochondrial sequences of mammals and amphibians are 16s. furthermore, annotation errors are present in genbank  <cit> , and the error rate might be clade dependent. the bs index is sensible to these errors, leading to an underestimation of bs; therefore, as for bc previously, bs should be considered as a relative measure of primer performance.

comparison of vertebrate barcodes
universality is a key feature of barcodes, and several strategies exist that can increase the taxonomic coverage of primer pairs. one strategy consists in making cocktails of degenerate primers. for example, the coi- <dig> primer pair  <cit>  had one of the highest taxonomic coverages . a predictable drawback of degenerate primers is a limited specificity with regards to the target dna sequence amplified. however, our in silico pcrs performed on the whole genbank did not amplify incorrect regions. all sequences amplified by the coi- <dig> primer pair were labelled in genbank as mitochondrial coi, suggesting that these primers maintained enough specificity.

an alternative strategy consists in designing universal primers on highly conserved regions. this strategy has been used for example on the 16s, that exhibits some highly conserved regions in vertebrates  <cit> . the primers amplifying the 16s  were very powerful, and had the highest taxonomic coverage and resolution capacity in vertebrates . the 16s region has been investigated as an alternate barcode locus for amphibians  <cit>  but coi has not been rejected  <cit> . some studies advocated that 16s has a too low rate of molecular evolution, and thus does not hold enough interspecific variation for a correct species identification  <cit> . our analysis suggests that, at least in vertebrates, 16s has the same resolution capacity as coi, when using sequences with comparable length , and therefore can be a good candidate site for barcoding. nevertheless, the good performance of 16s observed in vertebrates may not be valid in other taxa; our in silico approach can be a key tool to analyse this possibility.

long barcodes  like the standard coi and 16s barcodes have a high resolution capacity, and are ideal candidates, for example, to unambiguously identify taxa in the context of the original dna barcoding usage. however, studies analysing environmental samples or degraded dna require the use of shorter dna fragments  <cit>  even though those smaller regions include less information. we have included in our analysis two primer pairs amplifying short sequences that can be used for such analyses: uni-minibar  <cit>  and 16smam  <cit> , which amplify sequences of 130- <dig> bp. our analysis did not amplify enough sequences to evaluate the overall performance of uni-minibar, but allowed estimating the taxonomic coverage of 16smam, which was very high for mammals , and lower for the other clades . this short barcode had the lowest resolution capacity for identification at the species level . however, in many cases species identification is not needed in ecological barcoding, as information on the genus or family can be already valuable  <cit> . indeed, the resolution of 16smam was much higher if the aim was the identification at the genus or family level .

our analysis focused on vertebrates, because several primers have been proposed for their sensu lato barcoding. furthermore, the in silico assessment of primers strongly depends on the sequences in online databases; vertebrates are the phylum best covered by available sequences, therefore they are the ideal focus of a methodological analysis. nevertheless, biodiversity on earth is dominated by other phyla, such as arthropods and molluscs: the evaluation method describe here can be applied to these taxa and to any other ones, considering that the precision of the estimated bs and bc indices is directly linked to the amount and the quality of available sequences in public database corresponding to the studied clade.

CONCLUSIONS
based on our in silico analyses, the different barcodes tested showed dissimilar adequacy to be used according to the five clades of vertebrates studied. if we consider all possible applications of sensu lato barcoding, no single barcode could be identified as the best for all vertebrates. the primers amplifying coi- <dig> showed the highest taxonomic coverage in actinopterigii and sauropsida, while those amplifying 16sr/16sr <dig> showed the highest coverage of amphibians and mammals . furthermore, the barcodes with the highest taxonomic coverage and resolution capacity  amplified long fragments, which can make their application problematic for describing biodiversity within environmental samples. in such a context, it is useful to select a priori the barcode that best suited the research topic. our in silico method can help identifying the most appropriate barcode according to different aims. such formal approach, which is possible thanks to the availability of bioinformatics tools and large public databases, can focus on target taxa or dna regions and would make easier the validation of new barcodes by reducing the number of candidate primer pairs to be tested in vitro.

authors' contributions
gff, ec, pt and fp participated to the design of the study; jb and ec developed ecopcr; tr and ec developed bs and bc indices, ws performed in vitro experiments; gff and sz performed the analyses; gff, ec, pt and fp wrote the paper. all authors read and approved the final manuscript.

