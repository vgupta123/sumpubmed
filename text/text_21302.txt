BACKGROUND
next generation sequencing is a tool that is revolutionizing scientific research with its unprecedented depth of coverage, accuracy, precision, and the ability to link gene expressions with phenotype. the illumina genome analyzer , originally by solexa, enables interrogation of mrna expression via the mrna sequencing protocol. there are several reports on quality assessments of next generation sequencing and comparisons with microarray gene expression  <cit> . biological signal has been evaluated in single biological replicates of cell lines or tissue samples from this platform  <cit> . anders and huber report on variation in pools of two fruit fly embryos  <cit> ; however, to date there is no thorough report on the functional form of variance in variability in mrna sequencing data from true human biological replicates. thus, we evaluated the structure of biological variability and statistical modeling strategies useful for determining differential expression in mrna-seq data with true biological replicates.

first we describe some distributional background. the poisson distribution is commonly assumed when modeling count data. this distribution considers each individual piece of mrna to be a random draw from a large collection of pieces of mrna with some probability vector describing the relative proportion across all possible mrna pieces. a piece could refer to a particular exon or gene according to the researcher’s interest. the poisson distribution appears to describe well the variation observed between two technical replicates of the same specimen, i.e., two aliquots of the same library allocated to two lanes on a flow cell  <cit> . the mean, μ, and variance are expected to be equal when sampling from a poisson distribution, i.e., var = μ.

biological replication adds another level of variability to the observed data. biological variability is that due to inter-individual differences between human or animal subjects, for example, which cause the probability vector describing the distribution of mrna strands to differ between subjects. thus, when count data are observed in multiple biological replicates, the observed variance is a sum of both the technical and biological variability pieces. this results in the observed variance being larger than expected under the poisson distribution. that is, the variance is larger than the mean. this scenario is termed “over-dispersion”  <cit> .

in the simplest case, variance increases as a linear function of the mean, i.e., the variance is a constant multiplied by the mean, var = kμ. we denote this as the over-dispersed  poisson throughout and model parameters can be estimated via quasi-likelihood methods. a more sophisticated model assumes the within-specimen  variation follows a poisson distribution and the between-specimen mean values follow a gamma distribution. this gives rise to the negative binomial  distribution in which the variance increases as a quadratic function of the mean, i.e., var = μ + φμ <dig> <cit> .

our goal in the present work was to characterize the mean-variance relationship in mrna seq data in order to guide the choice of distributional assumptions. we first evaluated technical variability in gene-level counts to ensure consistency with what others have reported. next, we evaluated the variance structure between biological replicates within a treatment group, considering the functions var = μ, kμ, and μ + φμ <dig> with and without normalization and blocking factors. we believe this work will be useful to others in analyzing and interpreting similar data.

methods
subjects
twenty five study subjects representing the extremes of the humoral immune responses to rubella vaccine  were selected from a large population-based, age-stratified random sample of  <dig> healthy children and young adults , from olmsted county, minnesota. clinical and demographic characteristics of the population based sample have been previously reported  <cit> . this population-based candidate gene association study was performed to assess the importance of single nucleotide polymorphisms  and genes involved in the immune response heterogeneity to rubella vaccine  <cit> . all study participants had been previously immunized with two doses of measles-mumps-rubella  vaccine with a median time since last immunization to enrollment  of  <dig>  years. the mayo clinic institutional review board granted approval for the study. written, informed consent and assent from subjects and/or parents/guardians was obtained at the time of enrollment.

pbmc culture, stimulation and rna isolation
subjects’ pbmc  were thawed and stimulated  with live rubella virus . total rna was extracted from stabilized cells using rneasy plus mini kit . rna concentration and quality were assessed by nano chip kit analysis on an agilent  <dig> bioanalyzer . fifty samples from  <dig> subjects were completed for culture, rna extraction and rna quality control with adequate concentration and purity , as well as good rna integrity and lack of rna degradation.

library preparation and sequencing
libraries were prepared using the mrna-seq sample prep kit  following the manufacturer’s instructions. briefly, polyadenylated rna was isolated from 1 μg of total rna using two rounds of hybridization to oligo-dt magnetic beads. the mrna samples were chemically fragmented, reverse transcribed and converted into double stranded cdna. unique illumina adaptors were ligated to the dna fragments after end repair  and a-base tailing. fragments of approximately 200 bp were gel purified and amplified by pcr. the libraries were validated and quantified on an agilent  <dig> bioanalyzer  using dna  <dig> chip kits. sequencing was carried out on the genome analyzer gaiix . samples were sequenced as single end reads using illumina’s single read cluster generation kit  and  <dig> cycle sbs sequencing kit  following the manufacturer’s instructions.

the first five flow cells were processed using sequencing control studio  v  <dig>  and the last eight flow cells were processed with scs v  <dig>  which allowed for higher cluster densities and higher pass filter rates. the images from the sequencing cycles were processed using the illumina pipeline software v <dig> . specifically, images were converted to signal intensities using illumina pipeline’s firecrest program. base calling from intensity values was performed, and the quality scores for every base were calculated using the bustard program. illumina’s alignment tool, eland, was used to align the sequence reads to genome build  <dig> and exon junction databases. illumina’s casava tool version  <dig>  was used to summarize the alignment results using only reads that mapped to a unique genome location and casava results were imported into genome studio to generate the count tables for genes, exons, and exon-junctions. sequencing pass/fail quality was determined by cluster densities, percent of clusters passing filters, percent of reads aligning to the reference, and percent error rate of the alignment.

statistical experimental design
specimens were randomly allocated to flow cells and lanes as follows . first, one high and one low responder were allocated to each flow cell , ensuring that flow cell and response group were not confounded. within a flow cell, the high and low responders were randomly assigned to lanes 1- <dig> or 5- <dig> such that response status was balanced over lanes, ensuring that lane and response group were not confounded. finally, for each subject, two technical replicates each of their stimulated and unstimulated specimens were randomly allocated to the first two or second two lanes such that stimulation status was balanced over lanes, ensuring that lane and stimulation status were not confounded.

statistical methods
the endpoint used for analysis was total reads or counts per gene; for the analysis of technical variation this is counts per lane while for biological variation this is counts summed over two technical replicate lanes. we evaluated the suitability of the poisson, od poisson, and nb assumptions for modeling biological variability. the poisson distribution assumes variance is equal to the mean μ. the od poisson assumes the variance increases as a linear function of the mean, kμ, where k is a constant and μ is the true mean. the nb distribution assumes the variance increases as a quadratic function of the mean as μ + φμ <dig>  where φ is a constant.

model goodness-of-fit  was assessed via quantile-quantile  plots of per-gene pearson statistics Χ2=∑i=1nyi−y^i2/vary^i as has been done previously  <cit> . here, i indexes n samples, y is the observed count, y^i is the predicted value and vary^i is the appropriate variance of the predicted value . this statistic is asymptotically chi square with n-p degrees of freedom, where n is the sample size and p is the number of model parameters. while gof statistics are a rather crude measure of how well a model fits, the magnitude of changes observed here are informative. we verified that the asymptotic assumptions were reasonable with the present sample size in simulated nb data . while the empirical distributions do not have values quite as extreme in the right tail as theoretical distributions, the deviation from the identity line is very small relative to the distributional changes observed herein. an alternative to the pearson statistic is residual deviance, but this statistic was found to be ill behaved, even in simulated data. such behavior has been documented previously  <cit> .

the generalized linear model  framework was used to fit per-gene models to test for differential expression between high and low response groups using the log link function  <cit> . the most basic model included a term for high/low response group. these were fit to unstimulated specimens only so as to focus on biological variation in the absence of correlation between paired specimens. counts for the two technical replicate lanes  were summed for these models. thus, these fits had p =  <dig> model degree of freedom.

model fits were evaluated with no normalization, with total count per lane-pair, or with 75th percentile count per lane-pair as a normalization constant  <cit> . normalization constants were included as an offset term in the glm model, i.e., a term with the coefficient forced to be  <dig> . the normalization offset leads to the interpretation of the gene counts as a rate, e.g., the portion of counts out of the total lane counts  <cit> . in addition, fits were evaluated with no blocking factor or with categorical variables added to the model to indicate flow cell , lane-pair  or library preparation batch  as blocking factors. these blocking factors are potential sources of systematic non-biological variation in the experiment. there may be global shifts in counts due to flow cell, lane position on the flow cell such as middle versus edge, or pcr batch effects. lastly, per-gene, local and global variance parameter estimation strategies were evaluated.

all statistical computing was performed in r  <cit> . the glm function in r was used to fit all models owing to the flexibility in modeling biological and experimental effects. models based upon nb distributional assumptions were fit with either per-gene, moderated or global estimates of φ. per-gene estimates were estimated within the glm.nb function call in the mass package on a per-gene basis. global and local  estimates of φ were computed with the edger package  <cit>  in r. in that package, the global estimate is computed via quantile-adjusted conditional maximum likelihood  <cit>  and is shared by all genes. the local estimate is an approximate empirical bayes estimate which shrinks per-gene estimates towards the common global estimate  <cit> . the degree of shrinkage for local estimates depends on the prior.n parameter, where larger values result in more shrinkage towards the global value. we evaluated setting prior.n equal to  <dig>   <dig> , and 20; since a prior.n of  <dig> yielded much better fits than  <dig> or  <dig> , results are presented here with prior.n =  <dig> 

convergence rates were excellent for all models, with the worst case being non-convergence for four genes when a blocking factor was included in the model. the data have been deposited in the gene expression omnibus and are available  via the following link: http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?token=nxahvuioqmkwwzg&acc=gse <dig> 

RESULTS
subjects and assays
all  <dig> study subjects were female caucasians to minimize variation. median rubella-specific antibody response in the  <dig> high response subjects was 145 iu/ml  and in the  <dig> low response subjects was 10 iu/ml   <cit> .

at least one count was observed for  <dig>  genes. total counts per lane ranged from  <dig>  million to  <dig>  million . the wide range was due to a software upgrade midway through the study. the distribution of counts/gene/lane spanned five orders of magnitude as demonstrated in figure 2b. sixty-two percent of the total counts were from 10% of the genes, in both the high and low responders .

technical variation
we assessed technical variation as the variation between the same specimen pipetted onto two lanes of a flow cell. technical reproducibility in these data was good as demonstrated by scatter and minus versus average  plots . once scaled for total lane count, virtually no linear bias was detected as demonstrated by the grey smoother nearly overlaying the y =  <dig> line. in addition, there was no hint of any nonlinear biases as is often seen in gene expression microarray data. this was true for all pairs of technical replicates.

qq plots assuming poisson-type variation were made for all pairs of technical replicates using pearson gof statistics; all  <dig> are available in additional file 1: figure s <dig>  for poisson-type variation, the points would be expected to fall on the identity line. eighteen of the plots demonstrated variation very close to expected. three of the plots demonstrated a moderate fit of the poisson distribution with observed pearson quantile scales ranging from approximately  <dig> to  <dig> indicating larger than expected variance. two plots demonstrated poor fit overall as evidenced by large observed pearson quantile scales, one reaching approximately  <dig> and the other approximately  <dig> . the observed pearson quantiles for the technical replicates from subject  <dig> reached approximately  <dig> . as there were problems with this sample in the laboratory, and because the distribution of gof statistics was so far from expected and so different from the others, we discarded this sample from further analyses. similar to what others have found, we concluded that in general, technical variation followed a poisson distribution with variance equal to the mean. similar results for technical variation were found in the stimulated specimens . with this conclusion we summed the per-gene counts from the two technical replicates for further analyses as in  <cit> .

biological variation
we define biological variation as the variation between multiple subjects in the same group, e.g., high versus low responders, cancer versus normal, treatment versus not, etc. this variation may be small for cell lines and moderate for genetically identical animals, but can be very large for human samples. analysis methods need to be able to cope with and appropriately model this variation.

in order to understand the functional form of the mean-variance relationship, we created a scatter plot of the sample biological variation s <dig> versus the sample mean x¯, both calculated within high and low response groups separately so as to estimate subject-to-subject variability. note that in this experiment, this variance will include variation due to flow cell as well since there is only one subject per response group per flow cell. three lines were overlaid on the points: i) an identity line representing poisson assumptions, ii) a linearly increasing line with slope estimated from a regression of s2=kx¯  representing od poisson assumptions, and iii) a quadratic function estimated from a regression of s2=x¯+ϕx¯ <dig> representing nb assumptions . here we show this plot on the standard deviation scale for ease of viewing, and with the global estimate of ϕ^= <dig>  as estimated via the edger function  <cit>  in r over all genes . unlike an identity or linear over-dispersion function, the quadratic variance function appeared to describe the mean-variance relationship well for the majority of the genes. as a comparison of the effect on goodness of fit, qq plots from models fit based on standard poisson and nb assumptions are provided . consistent with the conclusions based on figure 3a, the qq plot based on nb assumptions with φ fixed at the edger global estimate of  <dig>  demonstrated dramatically improved fit overall with the observed pearson quantiles extending to approximately  <dig> , much less than the  <dig>  for poisson assumptions.

we questioned whether a one-size-fits-all variance structure was appropriate. it is biologically plausible  that the relationship, i.e. the precise multiplier φ, varies between genes. thus, models were fit estimating over-dispersion on a per-gene basis assuming a quadratic functional form. note that the quantities plotted in qq plots based on the linear over-dispersion assumption are used in the estimation of the over-dispersion parameter in the r function and therefore by definition were not useful for assessing model fit. the qq plot based on nb distributional assumptions with per-gene estimates of φ demonstrated worse fits than when the global estimate was used with observed pearson quantiles extending up  <dig>  for all genes, with gof statistics for all but two genes below  <dig>  . to investigate further, we exported local estimates of φ from the edger function and held these fixed. these fits demonstrated improvement over those based on the global estimate of φ with a maximum observed pearson chi-squared value of approximately  <dig> . eighty-two percent of the local φ estimates were less than  <dig>  . note that a φ of  <dig> would correspond to no over-dispersion, consistent with poisson distributional assumptions. approximately 5% of the genes had an estimate of φ greater than  <dig> . upon investigation of the genes with φ estimates in the spike of density beginning at a log <dig> of approximately  <dig> and extending to approximately  <dig>  on the horizontal axis , we found that both replicates from one patient sample had  <dig> counts for all of these genes. the data from this subject otherwise appear similar to that from other subjects. this phenomenon will be investigated further. ignoring this spike, the estimates of φ do not appear to be a function of the mean in these data. we focus on the quadratic mean-variance functional form with local estimates from here forward for four reasons. first, a quadratic function fits the global mean-variance relationship for biological variation . second, the biological interpretation of the nb distribution is appropriate; count data that follow a poisson distribution conditional on a subject-specific mean, together with between-subject means that follow a gamma distribution, give rise to the nb distribution. third, it was clearly difficult to estimate the mean-variance relationship on a per-gene basis . fourth, we do not believe that all genes must share the same mean-variance relationship.

experimental variation
as in bullard et al.  <cit> , we found that choice of normalization constant had little effect on gof distributions . therefore we present results taking the 75% count as the normalization factor since bullard et al. found this normalization scale to have less bias in fold-change estimates and better sensitivity and specificity than none or total lane count. the rationale for using the 75% count to adjust for varying sequencing depths rather than, say, the total lane count, is to avoid the possibility of a high-count gene that is differentially expressed being overly influential on the normalization  <cit> .

potential sources of experimental variation examined here were flow cell, lane-pair and library preparation batch and all of these resulted in lower maximum observed pearson chi-square values which can be seen on the qq plots . adding one of lane-pair, library preparation batch, or flow cell to the model reduced the maximum observed pearson chi-squared value to about  <dig>   <dig> or approximately  <dig>  respectively. the distribution for the library preparation batch was the closest to the expected distribution of the three. addition of flow cell to the model caused the entire distribution of gof statistics to be smaller than expected. the largest obvious difference between flow cells was due to the software upgrade mid-way through the experiment. indeed, when models were fit without a normalization offset term, the shift in the distribution of flow cell effect estimates corresponded with the date of the scs software upgrade mid-way through the study which increased the number of reads by several million per lane . however, when the total or 75th percentile offset was included, there was no clear relationship between flow cell effect estimates and run order . from this and the distributions of gof statistics we concluded that something more than just a difference in lane counts could be attributed to flow cell differences. these conclusions were similar regardless of normalization strategy or over-dispersion estimation strategy .

while it is important for a model to explain all sources of variation, a balance must be made between this and over-fitting the data. this will especially be the case for studies with extremely small samples which are typically employed for next generation sequencing studies given the intense monetary and time resource utilization.

characterizing genes with poor model fit
we investigated whether the genes with small counts were those with the smallest  or largest  gof statistics when using nb distributional assumptions with local variance estimate and no blocking factors. interestingly, filtering out low count genes, even up to a total count of  <dig>  , had only a minor impact on the distributions . the gof statistics for genes averaging less than  <dig> counts per subject were distributed throughout the range of gof statistics . further inspection of the data records revealed two main scenarios in those genes with the smallest gof statistics. in the first scenario, the genes had all zero counts in one response group versus non-zero counts in the other response group. for genes in the second scenario, counts within both response groups were very consistent and had very small variance. data records for those genes having the largest gof statistics had very large variance. the distributions of counts within the high/low response groups for one such gene had counts spanning over two orders of magnitude in both study groups, i.e., very large variance .

discussion
we set out to evaluate technical, biological, and experimental variation in gene expression measured by mrna-seq counts from n =  <dig> subjects. technical variation in these data were in keeping with poisson distributional assumptions in general as has been reported by some  <cit> , while others have reported greater than poisson variation for low counts  <cit> . the biological variance across all observed genes was over-dispersed relative to the mean, increasing as a quadratic function of the mean. this has important implications for study planning in terms of power and sample size estimation as well as choice of statistical modeling procedures to detect differential expression. differential expression results were not included here since the focus is on the mean-variance relationship.

over-dispersion, i.e., variance larger than the mean, is a common phenomenon in observed count data  <cit> . others have suggested that over-dispersion in mrna-seq data will likely be observed in mrna-seq biological replicates and have suggested models relying on od poisson or nb assumptions to account for this  <cit> . there was clear evidence of over-dispersion from the standard poisson distribution in our data. a quadratic function described the mean-variance relationship across all genes better than a linear function, which is consistent with the nb family of distributions. the interpretation of the nb distribution as counts from several within-subject poisson distributions, each subject having their own mean parameter makes biological sense as well in the study at hand. in μ + φμ <dig>  the square root of φ corresponds to the subject-to-subject cv of the gamma distributed poisson mean parameters. the cv corresponding to the global estimate of φ for the data presented herein is 36%. we have observed a cv of approximately 9% for technical variation in genetically similar rats and 22% for biological replicates in genetically similar rats . this is in keeping with the expectation that biological variation is larger than technical variation, and human variation is larger than genetically inbred animal model variation.

there are several potential sources of experimental variation in these studies including pcr library preparation batch, flow cell, lane, and for large studies, machine and software upgrades. some effects can be addressed through normalization while others must be modeled directly. we found that normalization strategy had little impact on gof statistics. bullard et al.  <cit>  reported similar results and found that the 75% count normalization resulted in nearly no bias and the best sensitivity and specificity without increasing variance. our data was similar to theirs in that a small percent of the genes contributed a large portion of the counts. thus, we chose to use the 75% count as the normalization scale in our models. others have evaluated normalization strategies beyond this  <cit> .

bullard et al. found experimental variation due to library pcr preparation batch to be greater than that due to flow cell  <cit> . we found that inclusion of library pcr batch, lane-pair and flow cell each resulted in a dramatic reduction in the large gof statistics resulting in the gof statistics being too small  in the majority of genes. the gof statistics were reduced to the extent that, in this particular experiment with only one subject per treatment per flow cell, we believe these terms should not be included in the differential expression models in order to avoid over-fitting. note that this experiment is an incomplete block design with respect to subject, in which case there is not complete recovery of all effects. the discussion of incomplete recovery of effects has spanned decades in the statistical literature. the classic text by scheffe points to the use of random effects as a compromise between the extremes of not including the effects or including them as fixed effects  <cit> . since estimation in a nb model of both the dispersion parameter and random effects is not straightforward, the experimental effects were modeled as fixed effects for the purposes of this investigation.

estimation of the over-dispersion parameter has been the subject of much research; see for example the summary in  <cit> . while the edger local estimates of over-dispersion resulted in the most reasonable gof distributions, the results herein point to the need for further investigation in the estimation of variance for these data. biologically it makes sense for the variance to differ across genes, and that the mean-variance relationship may vary across genes as well. for example, some systems in the body such as ph are very tightly controlled with dramatic consequences for deviations from the baseline normal levels. other systems in the body such as cholesterol are less tightly controlled, and allowed to vary widely before consequences are observed. however, with small sample sizes it is likely too difficult to estimate the mean-variance relationship accurately and precisely on a per-gene basis. local or per-gene estimates of variance are common practice in gene expression microarray and shotgun proteomic literature  <cit> . anders and huber recently presented data from two pools of fruit fly embryos in each of two study groups that agree with this assumption and they described a model for variation based on nb distributional assumptions with a “shot noise” portion and a “raw variance” portion  <cit> . alternatively, the fact that these model fits result in smaller than expected gof statistics for a majority of genes may point to the need for a linear variance function for some genes and quadratic variance function for others due to biological phenomenon such as alternative splicing. indeed, such a modeling strategy has been proposed  <cit> . it is difficult to compare per-gene appropriateness of od poisson and nb distributional assumptions due to the poor behavior of the residual deviance statistic and the fact that estimation of the od poisson dispersion parameter is a function of the pearson statistic. application of a power transformation to the data in order to use poisson modeling assumptions has recently been proposed  <cit> . we expect continual improvement in informatics mapping algorithms to result in decreased variance; e.g. including reads that map to multiple locations on the genome has been shown to improve technical reproducibility  <cit> . robust glms based on m-estimators may be an attractive alternative as well. a gaussian approximation to the poisson distribution is said to be valid when the mean is ≥ <dig>  <cit> ; thus linear models which account for the mean-variance relationship, e.g. via weighted least squares, may be an attractive alternative since model fitting and assessment of model fit is more straightforward than for glms.

our study had several strengths and limitations. we reported on technical and biological variation in mrna-seq data from a relatively large sample set and provide valuable insight into biological variation that will be useful to many researchers. the data herein were from true human biological replicates rather than contrived cell line replicates. we expect that the conclusion of a quadratic mean-variance relationship for biological replication will extend to other experimental settings. however, the precise estimates of over-dispersion are expected to be study-specific; it is plausible they would be smaller in inbred mouse models, smaller yet in cell lines. the present study was not designed to assess bias in estimating gene expression, fold-changes or sensitivity and specificity of fold-change detection. while the modeling strategy utilized does not account for the degrees of freedom used in estimating the dispersion parameter, thousands of data points are used in this estimation, so the estimate should be very stable and precise  <cit> . unfortunately there was a software upgrade mid-way through the study. technology in the field of next generation sequencing is progressing at a rapid pace; indeed, data from third generation sequencing is already available. this rapid pace makes upgrades, whether in software or hardware, difficult to avoid in large studies making it important to utilize randomization and blocking when determining assay processing order.

CONCLUSIONS
we found that the within-gene variance structure is over-dispersed relative to the poisson distribution. as a result, hypothesis tests based on poisson distributional assumptions will be too liberal  and power estimates based on these assumptions will be over-estimated for most genes, i.e., sample sizes will be too small for the estimated power. local estimates  <cit>  of the mean-variance relationship are likely best, but further research is needed to understand the optimal variance estimation strategy. the variance increasing as a function of the mean has implications on modeling strategy even if the data are modeled as continuous values rather than counts; e.g. weighted least squares. modeling experimental factors within the glm framework likely requires larger sample sizes. these conclusions will guide development of analytical strategies useful in study planning, accurate modeling of these data, and will aid in the identification of true biological signals that inform our understanding of biological systems. in addition, as with other high dimensional expression assays  <cit> , since we do not yet thoroughly understand experimental variation in next generation sequencing platforms, it is vitally important to incorporate the fundamental principles of statistical experimental design, namely biological replication, blocking and randomization, during the study design phase in order to avoid confounding of experimental and biological signals.

competing interests
the authors wish to declare that gap is the chair of a data safety monitoring board for merck for non-rubella novel vaccines in clinical trials.

authors’ contributions
alo helped design the sequencing study, conceived the statistical questions, directed the statistical work and wrote the manuscript. bmb helped refine the study questions, performed all computing and participated in critical interpretation of the data. deg helped design the sequencing study, helped direct the statistical computing, helped refine the study questions and participated in critical interpretation of the data. gap helped design the sequencing study. tmt participated in critical interpretation of the data. all authors read and approved the final manuscript.

supplementary material
additional file 1
figure s <dig>  evaluation of asymptotic gof distributional assumptions. qq plot of gof statistics from simulated null  nb data. data for genes were simulated with mean equal to the mean vector in the unstimulated data presented herein, dispersion parameter equal to the edger estimated moderated dispersion parameter values. gof statistics were calculated for each gene as described in the methods, here using the sample mean and true dispersion parameter. sample sizes of a) n =  <dig> and b) n =  <dig> were simulated in order to understand whether the asymptotic chi square distribution was appropriate. the theoretical distributions are chi square with a)  <dig> degrees of freedom and b)  <dig> degrees of freedom. from the right hand tails we see that the observed distribution does not have values quite as extreme as those in the theoretical distribution. however, the observed distributions are very close to the theoretical distributions as demonstrated by most points lying on the identity line. we conclude that the chi-square distribution is approximately correct for the data presented herein. additional file1: figure s <dig> – technical reproducibility and functional form of bias. counts were scaled by total lane counts. a) representative scatter plot of technical replicate  <dig> versus technical replicate  <dig> for one subject. spearman correlation was  <dig>  for this pair. axes are on the log base  <dig> scale. b) mva plot for the same pair of technical replicates. the vertical axis is difference between the counts in the two replicates on the log <dig> scale and the horizontal axis is the average of the two counts on the log <dig> scale; there is one point for each gene observed in at least one replicate. the shading indicates density of points in that area with darker shading representing higher density. if two replicates yielded identical results, all points would lie on the y =  <dig> horizontal line . a locally weighted moving average smoother is indicated to demonstrate the average bias as a function of average count. additional file1: figure s <dig> – individual qq plots assessing distribution of technical replicates. qq plots for all  <dig> subjects for whom data was received assuming poisson variation in pairs of technical replicates. vertical axes indicate observed quantiles and horizontal axes indicate theoretical quantiles.

click here for file

 additional file 2
r function to plot variance as a function of the mean.

click here for file

 additional file 3
r function to create qq plots of pearson gof statistics assuming the nb distribution.

click here for file

 acknowledgments
we are grateful for the contributions of dr. iana haralambieva, mr. sumit middha and mr. bruce eckloff, and for the assistance of ms. rhonda larsen with manuscript preparation. this work was supported by the national institutes of health   and by the national center for research resources  , a component of the national institutes of health, and the nih roadmap for medical research. its contents are solely the responsibility of the authors and do not necessarily represent the official view of ncrr or nih.
