BACKGROUND
normalization is important in real-time qrt-pcr analysis because of the need to compensate for intra- and inter-kinetic rt-pcr variations  <cit> . such variations may be due, for example, to the difference in amount of starting material between the samples, difference in rna integrity, cdna sample loading variation, or difference in rt efficiency. one of the most popular methods is normalizing a target gene expression to the ribosomal rnas  or messenger rnas  from an internal control or reference gene. such reference genes, also called housekeeping genes, should be expressed in abundance, not be co-regulated with the target gene, and have minimal innate variability. on the other hand, the expression of these genes should vary in accordance with the experimental error associated with the technique  in order to correct for these errors through normalization.

the variability of a reference gene has two major sources, experimental variability associated with the technology and the innate or natural variability of the reference gene . the original approach to normalization was to find a single reference gene with the most stable  expression across tissues and individuals. starting with the work of vandesompele et al  <cit> , normalization is carried out using a geometric mean  of multiple internal control genes as a normalizing factor. the rationale is that the same experimental error should be present in all genes expressed in the same sample, if all genes are processed simultaneously. thus, the experimental errors of individual replicates are averaged across the reference genes, and a geometric mean provides a more robust estimate of the experimental error than individual reference genes. in cases of unregulated and uncorrelated reference genes, the innate variance component of the geometric mean variance is no larger than the largest innate variance component of individual reference genes divided by their total number. therefore, by increasing the number of reference genes with bounded innate variance, one can theoretically make the innate variance of their geometric mean as small as desired. however, it is expensive and impractical to process too many reference genes for each sample. thus, careful selection of a small reference genes subset with optimal properties is very important.

it is well documented that optimal reference genes vary according to tissues and treatments  <cit>  and that the final choice of the reference genes should be validated for each particular qrt-pcr study  <cit> . thus, as a part of assay validation, candidate reference genes are studied and optimal genes selected for inclusion into normalizing factors.

vandesompele et al  <cit>  proposed an algorithm that ranks individual candidate reference genes according to their stability measure, which is the average pairwise variation of a particular gene with all other candidate reference genes. the pairwise variation is defined as the standard deviation of the log-transformed ratios of expressions of paired genes. the algorithm first selects a pair of two candidate reference genes that have the highest expression agreement  among all possible pairs of genes. then, the next stable reference gene is identified as the one, which has the highest agreement with the rest of the candidate genes and with the geometric mean of the first two selected reference genes, and so on. thus, the algorithm relies on sequential pair-wise comparisons, which does not guarantee that the optimal subset of three or more genes would be identified.

a more comprehensive approach to selection of the optimal subset of reference genes is to fit a common model that would allow simultaneous quantification and comparison of variability in all candidate genes. this is the approach taken, for example, in  <cit> , where various anova and linear mixed effects models were used for the log-transformed gene expression ratios of all candidate reference genes at once. these models incorporate the average gene effect or the average gene-by-tissue type effect , the effect of each individual sample  and heteroscedastic error terms with the variances that differ by gene and tissue type. szabo et al  <cit>  used the variance component estimates from the model to rank the variances of the candidate reference genes and estimate the standard deviation of the log geometric means of the best  gene set for each possible set size . andersen et al  <cit>  proposed a new measure of gene expression stability based on the variance components estimates from the fitted anova model. similar to  <cit> , this stability measure also allows ranking individual candidate reference genes from the most to the least stable. abruzzo et al  <cit>  considered linear mixed effects models for log-transformed gene expression and demonstrated that treating experimental errors as random effects provides a much better model fit than using anova models, whose assumptions were violated.

the crucial assumption underlying all these methods is independence in innate variation of the candidate reference genes. the corresponding statistical models assume that correlation between expressions of different genes in the same sample comes exclusively from the experimental variation in the sample. in contrast, we have observed that even after subtracting the random  effects of sample, residuals may exhibit non-trivial correlation between some candidate reference genes . therefore, estimates of the standard deviation of the log geometric mean may change substantially when correlation is properly estimated and incorporated. this, in turn, can change the ranking of a subset of candidate reference genes with respect to optimality for inclusion into normalization factors.

we developed a robust approach for directly selecting optimal subset of reference genes rather than addressing stability of individual candidate genes. our approach is based on estimating the unstructured covariance matrix of all available candidate reference genes and using this covariance matrix to estimate the variances of the log normalizing factors  corresponding to all possible subsets of reference genes. robustness is achieved through bootstrapping candidate reference gene samples and obtaining the bootstrap upper confidence limits for the variances of the log transformed normalizing factors and average ranks of reference gene subsets with respect to the variance of their geometric mean in all bootstrap samples. a bootstrap procedure was proposed earlier  <cit>  to maximize the robustness of the approach in  <cit>  for ranking individual genes. in contrast, our procedure ranks the entire gene subsets of all possible sizes. using the proposed approach, the optimal subset of the reference genes may be selected  to minimize the variability of the normalizing factor;  to minimize the number of reference genes with acceptable upper limit on variability of the normalizing factor; or  to minimize the average rank of the variance of the normalizing factor.

two publicly available data sets and one new data set from the validation study of five candidate reference genes for normalization of guanylyl cyclase c  mrna expression in blood are used to illustrate the proposed method and compare to earlier published results. in addition, a small simulation study was conducted to evaluate the performance of the proposed approach under known correlation structures assuming varying degrees of innate correlation among candidate reference genes.

methods
model for the log-transformed expression levels of candidate reference genes
to incorporate all correlations among candidate reference genes, we simultaneously model their log-transformed expression levels or threshold cycle  numbers in a multivariate linear mixed effects model with unstructured covariance matrix. the normality assumption is usually appropriate for log-transformed expression levels or ct numbers in homogeneous populations of samples.

let yjik be the kth, k =  <dig> ..., k, replicate of the log-transformed expression level or threshold cycle ct for the candidate reference gene j, j =  <dig> ..., j, in sample i, i =  <dig> ..., n. denote by yik = t the vector of log-transformed expression levels for all j candidate reference genes in replicate k of sample i. for a homogeneous population of samples, vector yik may be modeled as   

where vector g =  t and gj is the average log-transformed expression level for the candidate reference gene j, si =  t is the random effect of ith sample, which reflects the experimental variation and is the same for all genes, so that si = si  t, ri =  t is the vector of random gene effects in sample i, and eik =  t is the vector of error terms in replicate k.

it is assumed that sample random effects si, random gene effects vectors ri, and the error terms vector eik are all independent, si are identically normally distributed as n, vectors ri are identically normally distributed as j-variate normal distribution mvnj, and eik are identically distributed as mvnj, d = diag. for each gene j and sample i, model  implies that  

and vectors yik have a multivariate normal distribution   

where v = σ21j×j + r + d and 1j×j is j×j matrix of ones.

our model  generalizes models  <dig> and  <dig> in  <cit>  by assuming a general unstructured positive definite matrix r rather than imposing a simple uncorrelated structure with r = diag. sunberg et al  <cit>  also mention in discussion a model similar to  in terms of covariance structure.

for multiple tissues and possible covariates affecting yik the mean vector g would have to be replaced by some linear mean model. since the proposed methodology utilizes only covariance parameters estimates, it is straightforward to extend developments to the case with a linear mean model instead of the mean vector g. the standard way to write a general linear mean model is aβ, where a is some design matrix and β is the vector of unknown parameters. for model , a is just the identity matrix and β = g. in the general case, the model is written as   

notably, such extension has no effect on the assumed covariance structure of the data. for example with just multiple tissues, t =  <dig> .., t, one can use the model  

where vector g =  t represents now across tissues average log-transformed expression levels for all candidate reference genes j =  <dig> ..., j, and vector gt represents the mean differences in expression attributed to tissue t.

in most analyses of qrt-pcr data, the ct numbers for the replicates of the same reaction are averaged, and the majority of methods for selecting optimal subsets of reference genes also operate with averaged replicates, which is appropriate if averaged replicates are to be used for normalizing the target gene. for this reason, and to simplify notation, in further development we do not use multiple replicates of the same reaction. with averaged replicates, vectors yik and eik in model  no longer depend on index k and model  is simplified to:   

where vectors ri effectively incorporate both, the random gene effects and the errors of gene expression measures. the multivariate formulation  still applies to model  with v = σ21j×j + r. if we consider a specific case of model  with si being fixed rather than random effects  and r = diag then we obtain model 1a in  <cit> .

in general, the variance components σ21j×j, r, and d in models  and  are not identifiable unless one imposes additional constraints on the structure of r and d. in previous work, r was constrained to be diagonal, which corresponds to the independent random effects of reference genes. our approach is to estimate v as an unstructured covariance matrix without separating the variance components, and then use v to compute the variance of the log geometric mean of any possible subset of reference genes. an unstructured j×j matrix v has j/ <dig> unknown parameters, with the total of j/ <dig> + j = j/ <dig> unknown parameters for model . hence, one needs at least samples of size n > / <dig> to estimate model . with a moderate number of samples available, the estimates of v may not be reliable. to overcome this, we propose to utilize bootstrap re-sampling and compute the upper confidence bounds for the variances of the geometric means. such upper confidence bounds would properly reflect uncertainty in estimation of the variances.

variability of geometric means of multiple genes
further we focus on single or averaged multiple replicates of a gene in the sample and assume model  with v = σ21j×j + r. the log geometric mean expression of a subset of l ≤ j reference genes j <dig>  j <dig> ,...,jl in sample i is computed as   

in a vector form,  may be written as  

where jx <dig> vector cj <dig> ...,jl has elements equal to  <dig>  if j = j <dig>  j <dig> ,..., jl, and elements equal to  <dig> otherwise. since yi = mvnj , the variance of fi is   

thus, the total variance of the log geometric mean of any subset j <dig>  j <dig> ..., jl of reference genes may be estimated using  with the corresponding vector cj <dig> ...,jl and matrix v, which is estimated by fitting model yi ~mvnj . representation  allows computing the variance of all possible fi through the nested j cycles exhausting all possibilities for vectors cj <dig> ...,jl.

when v = σ21j×j + r, then  implies   

hence, the log geometric mean of any subset of reference genes includes the same variance component σ <dig> corresponding to the experimental error present in all gene expressions for the same sample. therefore, minimizing the total variability of the log geometric mean is equivalent to minimizing the variability described by r.

selection of the optimal subset of reference genes
using model  and expression , we propose a robust approach for selecting optimal subset of reference genes with the smallest variance of the corresponding normalizing factors. robustness is achieved through bootstrapping candidate reference genes data to obtain the bootstrap upper confidence limits for the variances of the  normalizing factors  for all possible gene subsets as well as the distribution of ranks of these variances. the bootstrapping also alleviates the uncertainty in estimation of potentially large number of parameters in unstructured covariance matrix v.

specifically, for each bootstrap sample, the following analyses are performed:

 unstructured covariance matrix v of all available candidate reference genes is estimated from model . in this work, the estimates of v were computed in sas proc mixed , but any other software capable of fitting liner mixed effects or manova models may be used as well.

 vectors cj <dig> ...,jl for all possible subsets of reference genes are generated and expression  is used to compute the variance of the log geometric mean for each possible subset of reference genes. there is a finite, although rather large number, 2j- <dig>  of possible subsets of j reference genes, and the absolute minimum is always attained. in practical qrt-pcr validation studies, the number of candidate reference genes j would not be expected to be much larger than  <dig> 

 all possible subsets of reference genes are ranked from the smallest to the largest variance of the corresponding log geometric mean.

based on results for all bootstrap samples, we compute the bootstrapped upper 95% confidence limit for the variance of the log geometric mean and the average rank of this variance for all possible subsets of the reference genes. then the optimal subset of the reference genes may be selected using one of the following criteria:

 to minimize the upper 95% confidence limit on variability of the log geometric mean regardless of the number of reference genes required;

 to minimize the number of reference genes given that the upper 95% confidence limit on variability is under some acceptable level;

 to minimize the average rank of the variance of the log geometric mean.

the last criterion is similar in spirit to the bootstrap ranking procedure in  <cit> , with an essential difference that they rank individual genes using the approach in  <cit> , while our procedure ranks the entire gene subsets of all possible sizes. also, rather than considering the entire distribution of ranks, which is cumbersome for  possible subsets instead of just j reference genes, we use the mean rank  as the measure of optimality in criterion . in the absence of a desired limit on variability in criterion , one ideally would want to find a reference gene subset that satisfies both, criteria  and . to address criteria  and  simultaneously, we plot the upper 95% confidence limits vs. the average rank by the size of gene subset . such plots help to evaluate how far or how close the competing gene subsets are in terms of both criteria. a subset which is closest to the lower left corner is optimal using both criteria  and . if more than one subset is approximately the same distance from the lower left corner , then it is reasonable to pick the one with the smaller number of genes as an optimal.

a simple direct comparison of our method vs. previously proposed methods was performed by computing the log geometric mean and its variance for the optimal subsets  selected by different procedures. the advantage is direct evaluation of the log geometric mean of interest while ignoring the rest of the genes, which mimics the prospective use of the selected reference genes .

the macros implementing the proposed methodology were developed in sas  <dig>  . the corresponding sas code is included as additional file  <dig>  simulation study was also performed using sas  <dig> . the real data were analysed in sas  <dig>  and genorm  <dig>  .

RESULTS
data sets
the first dataset includes relative expression levels of  <dig> reference genes  quantified in  <dig> breast tumor samples. these data are described in detail in  <cit>  and available for download http://genomebiology.com/content/supplementary/gb-2004-5-8-r59-s <dig> xls. the second dataset includes expression levels for  <dig> reference genes actb, b2m, gapdh, hmbs, hprti, rpli3a, sdha, tbp, ubc, ywhaz) quantified in  <dig> neuroblastoma samples. these data  are part of the data from various tissues that were used and described in  <cit> . this subset was selected because the number of neuroblastoma samples  was the highest among all tissue types included in the study reported in  <cit> .

the third dataset comes from a validation study of five candidate reference genes for normalization of guanylyl cyclase c  mrna expression in blood. the rt-pcr assay to quantify gucy2c mrna in tissues and blood employing external calibration standards of rna complementary to gucy2c  is described in  <cit> . this work is a part of the ongoing multi-institutional nci-funded study of gucy2c as a biomarker for colorectal cancer  <cit> . the study will determine the utility of gucy2c mrna expression in blood for early detection of recurrence in patients with colorectal cancer. five candidate reference genes for normalization of gucy2c expression include actb, glyceraldehyde-3-phosphate dehydrogenase , transferrin receptor , peptidylprolyl isomerase b , and hypoxanthine-guanine phosphoribosyltransferase . these genes were previously considered as candidate reference genes for normalizing mrna expression of various targets in blood. rt-pcr experiments were conducted using an abi  <dig> sequence detection system . blood samples from  <dig> healthy volunteers were analyzed as a part of the validation study of five candidate reference genes. blood was collected in paxgene blood rna tubes , and rna was purified according to the manufacturer's instructions.

here, the log transformed expression levels were computed from the threshold cycle  numbers as in the ms excel add-on software gnorm, which implements the method described in  <cit> . for each candidate reference gene, the largest ct number is subtracted from the ct number for each sample, and the difference is exponentiated with the base  <dig>  the resulting expression levels range between  <dig> and  <dig>  with  <dig> corresponding to the sample with the smallest threshold cycle number and presumably the largest copy number of the corresponding reference gene.

results for the breast tumour data
in the breast tumour data, we first investigated innate correlation among  <dig> reference genes using the residuals from model 1a in  <cit> :   

where si are assumed to be fixed rather than random effects and each gene is assumed to have different variance, yji ~n . the residuals were computed as   

where  and  are estimated by fitting model . since si represents experimental variability in yji common for all reference genes in sample i, the residuals  represent only the innate between-individual variability. table  <dig> presents the pearson correlation matrix of residuals  from model  fitted to the data from  <dig> breast tumor samples. note that the pearson correlation coefficient is significantly different from zero for seven pairs of genes . hence, the variance of the geometric means should depend not only on the variances of the corresponding genes, but also on their correlation, which cannot be ignored.

1pearson correlation coefficient with p-value testing that it is zero

the proposed algorithm was applied to the breast tumor data with  <dig> bootstrapped  data sets of size  <dig> from  <dig> samples. for each possible gene subset size , table  <dig> lists subsets with the lowest bootstrap upper 95% confidence bound for the variance of the log geometric mean. the absolute lowest bound for the geometric mean variance  is achieved by the combination of two genes, actb and sf3a <dig>  thus, according to criterion , actb and sf3a <dig> provide the optimal gene subset. table  <dig> presents the top  <dig> gene subsets with lowest overall  average rank of geometric mean variance in  <dig> bootstrap samples. the same subset of two genes, actb and sf3a <dig>  comes up optimal using the criterion . figure  <dig> shows the upper 95% confidence bound for var vs. the average overall rank of the corresponding gene subset, visualizing the optimality of actb and sf3a <dig>  the subset of three genes, actb, pum <dig>  and sf3a <dig> is very close to actb and sf3a <dig> with respect to criterion  but not with respect to criterion , which adds confidence in actb and sf3a <dig> as the optimal set of reference genes.

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included.

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included.

in contrast, using the model in  <cit> , the geometric mean of four genes, mrpl <dig>  pum <dig>  psmc <dig>  and sf3a <dig>  has the smallest estimated variability . the geometric mean corresponding to three genes, mrpl <dig>  pum <dig>  and psmc <dig>  yields just a small increase in standard deviation. thus, mrpl <dig>  pum <dig>  and psmc <dig> may be considered an optimal subset using the approach in  <cit> .

for direct comparison of results, the empirical variances of the geometric means of selected gene subsets were computed for the actual log geometric means based on the optimal subsets identified by the proposed selection method and methods  <cit>  and  <cit> . table  <dig> reports these geometric means variances for gene subsets of size from  <dig> to  <dig> since the size of the optimal subsets ranges from  <dig> for the new method to  <dig> for the method  <cit> . the optimal 4-gene subset using the method  <cit>  is not reported in  <cit> . note that for any subset size from  <dig> to  <dig>  the geometric mean variance of the genes selected using the proposed method is smaller than for the other two methods. the geometric mean of two genes, actb and sf3a <dig>  selected as an optimal subset using the proposed method, has the smallest variance among all subsets , and the number of genes in this optimal subset is smaller than the number of genes in the optimal or nearly optimal subsets identified by using the approaches in  <cit>  or  <cit> .

1same results using either the method of vandesompele et al  <cit>  or szabo et al  <cit> 

results for neuroblastoma data
for  <dig> neuroblastoma samples, the proposed new algorithm yielded the smallest upper bound for the variance of the geometric mean of six genes, actb, b2m, gapdh, hprt <dig>  tbp, and ywhaz. however, the subsets of four genes, actb, b2m, gapdh, and tbp have a negligibly higher upper bound . for these data, the methods in  <cit>  yielded the same results for any gene set size from  <dig> to  <dig>  these approaches yielded the optimal subset of again six but not the same reference genes . that is, only three genes, gapdh, hprt <dig>  and ywhaz, were common for two optimal subsets using criterion  and previous approaches. table  <dig> presents the top  <dig> gene subsets with the lowest overall  average rank of geometric mean variance in  <dig> bootstrap samples. in these data, using the criterion  we do not identify the same subsets as using  as optimal. the overall average lowest rank corresponds to another set of  <dig> genes . however, the optimal sets of six genes by criterion  and  have  <dig> genes  in common and differ only by inclusion of rpl13a or hprt <dig>  respectively, only two genes, gapdh and ywhaz, are common for two optimal subsets using criterion  and previous approaches.

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included

1ac - actb; 2ga - gapdh; 3hm - hmbs; 4hp - hprt1; 5rp - rpl13a; 6sd - sdha; 7yw - ywhaz

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included

1ac - actb; 2ga - gapdh; 3hm - hmbs; 4hp - hprt1; 5rp - rpl13a; 6sd - sdha; 7yw - ywhaz

1same results using either the method of vandesompele et al  <cit>  or szabo et al  <cit> 

results for five reference genes for gucy2c in blood
for five candidate reference genes for gucy2c , the new approach was applied to the log transformed relative expression levels for direct comparison with previously proposed methods and to the threshold cycle  numbers because ct numbers are actually used for efficiency adjusted relative quantification  <cit> .

tables  <dig> and  <dig> shows the subsets of each possible size  with the lowest bootstrap upper 95% confidence bound for the variance of the log geometric mean and corresponding standard deviations based on the log transformed relative expression levels and ct numbers, respectively. for all set sizes except  <dig>  the same gene subsets are selected using relative expression levels and ct numbers. however, the smallest upper 95% confidence bound is achieved by a single gene  if we use the relative expression levels , and by two genes  using the ct numbers. tables  <dig> and  <dig> present the top  <dig> gene subsets with lowest overall  average rank  of geometric mean variance based on the log transformed relative expression levels and ct numbers, respectively. notably, gapdh and tfrc have the lowest average rank under both conditions. hence, this set of  <dig> genes is optimal with respect to both criteria  and  if we use the ct numbers . figure  <dig> shows that single gapdh and the subset gapdh and tfrc are very close in terms of both criteria  and  if we use the log transformed relative expression levels. these results suggest that the use of relative expression levels may alter the correlation pattern among the candidate reference genes, and if ct numbers are used for relative quantification, then selection of the reference genes should utilize the ct numbers as well.

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included.

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included.

 in the column with gene name,  <dig> indicates that the corresponding gene is included

in the subset and  <dig> that it is not included.

 in the column with gene name,  <dig> indicates that the corresponding gene is included in the subset and  <dig> that it is not included.

for comparison, model 1a in  <cit>  was also fitted treating the sample effects as fixed and assuming that the correlation is zero. based on this model, the estimated variances of the reference genes were ordered as  <dig>  ,  <dig>  ,  <dig>  ,  <dig>  ,  <dig>  . the variances of corresponding the geometric means were  <dig>  ,  <dig>  ,  <dig>  ,  <dig>  . this implies the optimal subset of  <dig> genes, gapdh, tfrc, ppib, and hprt. finally, the variability of empirical log geometric means based relative expression levels on was computed  based on only the subsets of genes selected. the smallest variability of log geometric means was achieved again by gapdh and tfrc, which were selected as an optimal subset of size  <dig> using the approach in  <cit>  but not in  <cit> . however, the szabo et al  <cit>  approach picked the 4-gene subset as the overall best one. thus, using the proposed approach allows reducing the optimal number of genes required for normalization by half while also reducing the variability of the normalizing factor.

simulation study
a small simulation study was conducted to evaluate the performance of the proposed approach assuming varying degrees of innate correlation among reference genes, independent of the variance component corresponding to the sample random effect. samples of size  <dig>   <dig>  or  <dig> of 5-dimensional vectors, representing log transformed expression levels, were generated from the 5-variate normal distribution according to model . since the mean part of the model does not affect either the new or previously proposed methods, without loss of generality, it was assumed that the mean vector had all components equal to zero . the covariance matrix v of the simulated 5-variate normal samples had the structure v = σ21j×j + r, where σ <dig> is the variance component for sample random effect and r is the covariance matrix of random effects of genes, and j =  <dig>  table  <dig> describes the correlation structures and resulting matrices v used in five different simulation scenarios. the values of σ, the standard deviation for the sample random effect, ranged from  <dig>  to  <dig> , while correlation coefficients corresponding to the r matrices, were  <dig>  ± <dig> , or ± <dig> , representing zero, weak and strong correlation respectively. the r matrices used were defined by five standard deviations, corresponding to the innate variances of the each gene and by the correlation matrix shown. the values of the standard deviations were chosen so that resulting elements of matrices v were similar in magnitude to the estimates from the real data examples. table  <dig> provides the true minimum variances of the subset means for each subset size, computed using  and true assumed matrix v. the values in bold correspond to the absolute minimum variance of the mean for any possible subset size and the size of that optimal subset. table  <dig> also gives the corresponding variances using the approach in szabo et al  <cit>  that is, estimating v as a diagonal matrix and assuming the sample effect to be fixed rather than random. the corresponding absolute minimum variance of the mean for any possible subset size is shown in bold italic. since the results using the method of szabo et al  <cit>  were generally very consistent with the approach of vandesompele et al  <cit> , in this simulation study, the proposed approach was compared only to the approach in szabo et al  <cit> .

1nf - normalizing factor

2assuming szabo et al  <cit>  model

the results of the simulation study are summarized in terms of sensitivity to identifying the optimal subset with the absolute minimum variance of the mean. table  <dig> gives the percentage of simulated data sets, for which the corresponding method , proposed criterion b , and method in  <cit> ) correctly identified the optimal subset of genes. this percentage may also be interpreted as the power of the corresponding procedure to detect the optimal subset. for each scenario and sample size ,  <dig> data sets were simulated to have 95% confidence interval for sensitivity of width < <dig>  .

1criterion  

2criterion  

3minimum standard deviation of the normalizing factor variance as in szabo et al  <cit> 

the results of our simulation study suggest that for truly uncorrelated candidate reference genes, the proposed approach may have lower power/sensitivity than the method of szabo et al  <cit> . this may be expected since the true v has the structure as assumed in  <cit> , while our approach would estimate unnecessary extra parameters in unstructured v. for equally weakly positively correlated candidate reference genes, performance of our and approach in  <cit>  was similar for smaller sample sizes , while the new proposed approaches were better for n =  <dig>  when the same weak correlation was assumed positive for some pairs of genes and negative for others, then the proposed approach was clearly superior to the method in  <cit> . similarly, our approach performed much better in the scenario with some strongly positively, some strongly negatively, and some uncorrelated pairs of candidate reference genes. finally, in the case of equally strongly positively correlated candidate reference genes, we also observed an advantage of the proposed approach.

discussion
in this work, we developed an approach for selecting an optimal set of reference genes for normalization in rt-pcr. the key difference from previously proposed methods is that assumption of independence among candidate reference genes is relaxed, and, instead, the estimated correlation among the genes is incorporated into estimates of variability of the prospective normalizing factors. the proposed approach does not explicitly estimate correlation among the genes, but implicitly the correlation is incorporated into the estimate of the total covariance matrix v. then the variance of a log transformed prospective normalizing factor is estimated by substituting the estimated v into .

to overcome uncertainty in estimating a large number of covariance parameters from usually small data sets, we employ bootstrap to obtain robust upper confidence bounds for the variance of the log geometric means of multiple genes. these bounds allow comparing various gene subsets as prospective normalizing factors, but also may be used in sample size calculations while designing an rt-pcr study. our approach also allows certain flexibility to choose a criterion for selecting the optimal subset of the reference genes unless one subset meets all the criteria.

here, our primary focus was on selecting reference genes for normalizing target gene expressions from one tissue as motivated by the study of guanylyl cyclase c  mrna expression in blood. our methodology is easily extendable to multiple tissues or inter-species comparisons by incorporating fixed effects for between-tissue or between-species differences into the mean sub-model aβ in , as long as one can assume that variances and correlation among the genes do not change between tissues or between species. if they do change between tissues or between species, then selecting the same reference genes for different tissues or different species may not be appropriate, or careful consideration may be required to set appropriate criteria of optimal properties of the reference genes that may behave differently in different tissues or species.

in the considered data examples, the use of the proposed methodology yielded generally smaller optimal subsets of the reference genes with smaller variability of the normalizing factors. in direct comparisons, the normalizing factor variances  were reduced by 27-32% when using the proposed selection approach instead of the methods  <cit>  and  <cit> . taken together, the smaller number of reference genes and smaller normalizing factors could result in cost savings due to both reduced primer and probe needs and potentially smaller numbers of samples required for the experiment overall.

CONCLUSIONS
the proposed approach performs comprehensive and robust evaluation of the variability of normalizing factors based on all possible subsets of candidate reference genes rather than addressing the stability of individual reference genes. the results of this evaluation provide flexibility to choose more important criterion for selecting the optimal subset of the reference genes unless one subset meets all the criteria. this new approach identifies gene subset with smaller variability of normalizing factors than current standard approaches when there is some nontrivial innate correlation among the candidate genes.

authors' contributions
saw and ss initiated the biological problem. cw, ic, ss, saw, and th designed the validation study of five candidate reference genes for normalization of guanylyl cyclase c . ic and th designed the statistical methods and analyses. cw conducted the rt-pcr experiments. ic and yl conducted the analysis, devised algorithms and wrote the computer programs. sc carried out the simulation study and prepared the figures. all authors have read and approved the final manuscript.

supplementary material
additional file 1
sas program file with the code implementing the proposed algorithm.

click here for file

 acknowledgements
these studies were supported by nih grants ca <dig>  ca <dig>  ca <dig> and ca <dig>  cw was enrolled in the nih-supported institutional k <dig> training program in human investigation  and was supported by nih institutional award t <dig> gm <dig> for postdoctoral training in clinical pharmacology. saw is the samuel m.v. hamilton professor of medicine of thomas jefferson university.
