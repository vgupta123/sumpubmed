BACKGROUND
genome-wide monitoring of transcription by means of dna microarrays is used to infer transcriptional and regulatory networks in living organisms. in most of microarray experiments, transcript levels of thousands of genes are measured with a relatively small number of replications, so the estimates of true expression levels from microarray data may be poor, mostly due to a small sample size. to address this problem, several statistical methods have been proposed to borrow information from other genes to improve detection of the differentially expressed ones  <cit> . the main idea is to borrow information from other genes to estimate either the distributions of genes's expression levels or the distribution of error terms. the underlying assumption is that it should be possible to improve the estimates of expression levels of genes by borrowing information about transcriptional activity across the sets of genes that are biologically, or physically, related. in some cases, the expression levels may significantly vary across the genes, then borrowing information from unrelated genes may not improve, or even worsen, the estimates of gene expression levels  <cit> . however, if, based on biological knowledge, we can expect that some genes are more likely to express at similar levels , then we can improve the inference by using information about the activity of those genes.

an operon  <cit>  is a set of linearly juxtaposed genes transcribed as a single mrna; operons are commonly found in prokaryotic genomes such as escherichia coli. transcription of operons of e. coli has been examined, and operons have been predicted in many studies  <cit> , which provides background information about the e. coli regulatory network. the genes within the same operon usually have similar expression levels, hence show some local structure in expression profiles  <cit> , and this fact has been successfully used in operon prediction  <cit> .

based on the existing information about the structure of operons, we propose a hierarchical bayesian model which improves gene expression estimation by borrowing information from genes within the same operon. most existing methods for detecting differently expressed genes  <cit>  borrow information from other genes in the whole genome, while our proposed method only borrows information from other genes within the same operon, which has sound biological basis. wren et al  <cit>  have proposed a simulated annealing approach to adjust gene expression data by using existing microarray measurements obtained on the same organism, which effectively reduced the noise and made it possible to compare different microarray experiments. but their method relies on reference microarray experiments that cover the dynamic range of transcript abundances for most of the genes, which may be difficult to select or unavailable. instead of using existing microarray measurements, we use existing information about the operons' structure to reduce the noise in microarray data.

a more accurate estimation of transcript abundances of individual genes will improve our ability to evaluate transcriptional activity on a genome-wide scale, and hence facilitate the exploration of gene regulatory networks. our proposed method provides a better way to estimate relative transcript levels, which is critical for distinguishing differentially expressed  genes from equally expressed  genes. herein, we refer to the logarithm of a ratio of the fluorescent intensities of the test and control samples as the observed gene expression level. the genes with estimated expression levels significantly different from zero are identified as de genes, otherwise as ee genes.

using more than  <dig> microarray experiments, we obtained the evidence of co-transcription of genes within e. coli operons on a genome-wide scale. we applied the proposed method to three simulated and one experimentally obtained data sets. the simulation studies and the real data application demonstrated that the proposed method performed better than the sample mean and the sam t statistics in estimating the gene expression levels as well as in detecting differentially expressed genes. the improvement became more significant as the noise level in microarray data increased.

RESULTS
simulation study
we carried out three simulations, with similar settings and the noise level gradually increasing from simulation  <dig> to  <dig>  in simulations, we assumed that the genes within an operon are co-transcribed. since the true expression levels in a simulated data set were known, we could calculate the mean squared errors of the estimated expression levels . without incorporating the information from operons, the sample mean of the observed expression levels would be a natural estimator of a gene's expression level. the mean squared errors of the two estimates, the posterior mean from the proposed model and the sample mean, are shown in table  <dig> for comparison. it can be easily seen that the incorporation of operon information leads to a better estimate, with a smaller mean squared error, of expression levels. when the noise level increased, the improvement from incorporating operon information also increased.

to evaluate the performance of the proposed method in detecting de genes, the estimated expression level of each gene was used to rank the genes, and the highly ranked genes were identified as de genes. since the identities of de genes in the simulation studies were known, we compared the performances of the proposed method, sample mean, and sam t statistics in detecting de genes using receiver operating-characteristic  curves . in a roc curve, the sensitivity is plotted against  <dig> – specificity. the sensitivity is denned as a fraction of true de genes being correctly detected and the specificity is a fraction of the true ee genes being correctly identified. the roc curves in figure  <dig> demonstrate that the performance of the sample mean and of the sam t statistic were very close, and our hierarchical model, incorporating operon information, outperformed both of them. the difference in the performance became greater as the noise level increased. for example, as the specificity equals to  <dig> , the sensitivities of the methods using the sample mean or sam t were about  <dig> ,  <dig> , and  <dig>  for simulations  <dig> , and  <dig>  respectively, while the sensitivities of the proposed method were  <dig> ,  <dig>  and  <dig> , respectively.

application to e. coli data
to verify the assumption that the genes organized in operons are co-expressed, we pooled together data from  <dig> microarray experiments, obtained in  <dig> conditions  <cit> . the distribution of pairwise correlations between expression profiles of genes in operons was greatly skewed towards positive values, with the mean correlation of  <dig>  . unlike the profiles of genes organized in operons, expression profiles of randomly picked pairs of genes were not correlated; the corresponding distribution of correlation coefficients was almost symmetric around  <dig>  with the mean correlation of  <dig>  . this result demonstrated the similarity of transcriptional activity of genes within operons and served as a motivation for borrowing information from other genes within the same operon.

the proposed method  was used to analyze differential transcriptional activity in an e. coli mutant lacking the flhdc gene, a master regulator of transcription of genes whose products mediate bacterial motility and chemotaxis . the genes were ranked by their estimated expression levels, i.e. their posterior means of μi obtained from the proposed model. for the sake of comparison, the sample mean and sam t statistics were also used to rank the genes . using the functional annotation from macnab  <cit>  as a standard, we obtained the number of false positives at different cut-off levels . the comparison revealed that ranking genes by the proposed method produced fewer false positives than the ranking based on the sam t or sample mean statistics .

to find a reasonable cutoff value for differently expressed genes, we calculated the false discovery rate   <cit> based on the posterior probability  <cit> . in this experiment, we also estimated the fdr by using the functional annotation from macnab  <cit>  as a reference. comparison of the estimated false discovery rates revealed that the estimated fdr from the posterior probability was a little lower than that derived from the annotation, which could be due to the partial incompleteness of the reference . overall, the estimated fdr from the posterior probability is close to the fdr using the reference list of genes, indicating that our method for estimating the fdr is adequate. we set the cutoff for the fdr to be  <dig> , which identified the top  <dig> genes as de genes. at such a cutoff, the estimated number of false negatives is  <dig> and the estimated false negative rate is about  <dig>  . the top  <dig> genes are listed in table  <dig>  note that, in table  <dig>  the gene expression level is on the log scale and the fdr corresponds to a specific number of de genes and not to each individual gene itself. according to macnab's classification  <cit> ,  <dig> genes out of the  <dig> were expected to be differentially expressed in the flhdc- dependent manner, whereas the lists of  <dig> genes identified by using sam t and sample mean contained only  <dig> and  <dig> expected genes, respectively.

we examined some genes and operons in more detail, to demonstrate the advantages of borrowing information from within an operon. for example, an operon argt-hisjqmp contains  <dig> genes  and is not expected to be differentially expressed under the examined experimental condition, according to our biological knowledge  <cit> . but from the microarray data, the mean expression level  of the gene argt was - <dig> , which ranked 15th among all the expression levels in the e. coli genome. this "high expression" of the argt could possibly be caused by random noise in microarray measurements and/or in biological samples, since the mean expression levels of other genes within the same operon were close to  <dig> . however, accounting for expression levels of other genes within the same operon lowered the estimate of the expression level  is known to be controlled by the flhdc  <cit> , and thus, under the experimental condition, differential expression of genes in that operon would be expected. while the expression level of the flit, estimated by the sample mean at - <dig> , ranked only 65th, the estimated expression level of the gene after borrowing information from two other genes in the operon was - <dig> , which ranked 19th.

in general, through borrowing information, our bayesian method worked in a way giving more consistent estimates of the expression levels for the genes of the same operon. for example, compared with using the sample mean to estimate expression levels, the bayesian method tended to yield smaller standard deviations of the expression estimates for within-operon genes .

discussion
in this paper, we proposed and applied a hierarchical bayesian model, to estimate relative gene expression levels and detect differentially expressed genes by borrowing expression information within operons. the performance of the proposed method was compared with that of the sample mean and sam t statistics. through the simulation studies, we showed that the proposed method outperformed the sample mean and the sam t statistics in estimating gene expression levels and detecting de genes. the proposed method was used to analyze differential expression in an e. coli mutant with a defect in transcription of motility/chemotaxis genes, giving results more consistent with the existing biological knowledge than those obtained by using the other statistics.

a major advantage of the proposed approach is in borrowing expression information from other genes within the same operon. the approach is developed within a statistically sound bayesian model and it offers necessary flexibility with respect to the amount of information that needs to be borrowed from other genes. by borrowing information we can obtain stabilized estimates of expression levels from rather noisy microarray data. as a result, the estimates of transcript levels within the same operon become more similar to each other, more so than without borrowing information; this is consistent with a biological fact that genes within the same operon are transcribed as a single mrna molecule. with the proposed method, the estimated expression levels of genes in "differentially expressed" operons are consistently high, and more importantly, transcript abundances of genes in "equally expressed" operons are stabilized towards zero. in the experimentally obtained microarray data, the within operon variation was smaller than the variation among the replicate data points for the same genes, indicating that the expression levels of the genes within an operon were very similar.

in our model, the ratio of parameters τ <dig> and  determines how much information comes from the observed expression of a gene and how much comes from the average expression of an operon, when estimating the expression level of an individual gene within an operon. a smaller τ, as compared to , puts more weight on the average expression of an operon. here we assumed the same τ value for all operons, implying that all operons had similar within-the-operon variability. however, this assumption might not be realistic. in some operons and physiological conditions, the genes might express very similarly, but in others, especially under the control of internal promoters, transcription of individual genes may be more heterogeneous. in the future, we will investigate the effect of an operon-specific τ. operonal organization of genes is common in prokaryotes and also present in some eukaryotic organisms  <cit> , and the proposed method can be extended to biological systems where the operonal structure is unknown. many biological studies have demonstrated that co-expressed genes tend to cluster on the chromosome. although the nature of this phenomenon is not quite understood, a positional clustering of co-expressed genes can be found in many eukaryotes including yeast  <cit> , worm  <cit> , fly  <cit> , mouse  <cit> , and human  <cit> . these findings indicate that the genes are likely to co-transcribe with their chromosomal neighbors. in those cases, instead of borrowing information from genes in the same operon, we can borrow information from gene neighbors on the chromosome. another extension of our method would involve incorporation of gene annotation information into the analysis of expression data. the approach would be very similar to the one described in this paper: based on biological knowledge, the genes belonging to the same functional group are more likely to be co-expressed, so we can use a hierarchical model to borrow information from and for the genes within the same functional group to improve the estimates of gene expression levels.

CONCLUSIONS
the information about operon structure leads to a better estimation of gene expression levels. using simulated and experimental data sets, we have demonstrated that the proposed method performs better than the sample mean and the sam t statistics in estimating the relative levels of transcript abundances and detecting differentially expressed genes.

