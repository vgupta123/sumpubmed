BACKGROUND
with the concept of ‘sytems biology’ coming to the stage of biological research, construction of kinetic models has been the primary focus in a substantial number of studies  <cit> . kinetic models are mechanistic representations of biological systems. they include information on two main levels. the first level of information includes the metabolites, enzymes, signaling molecules and chemical reactions involved in the model together with the formulation of the reaction kinetics such as michaelis-menten kinetics. knowledge about inhibition, activation and allosteric regulation of enzymes are also a part of this level. the second level of information consists of numerical values of all different parameters defined in the first level of information. those parameters include but are not limited to rate parameters for chemical reactions such as production of new metabolites in metabolic models, post-translational modifications of proteins in signaling pathways and transcription processes in genetic regulatory circuits.

as of present, kinetic models are usually restricted to small scale systems. the median of the number of the reactions and species that  <dig> curated kinetic models in biomodels database  <cit>  included are only  <dig> and  <dig>  respectively. yet the information they provide at both levels increases very rapidly. this is usually accomplished by in vitro experiments which give insight into appropriate formulations of enzyme kinetics. also values of the parameters can be determined by in vitro experiments with isolated enzymes. another common way towards this aim is the use of in vivo experiments in which metabolite concentrations are measured. optimal values of the parameters can then be estimated by using concentration data  <cit> . however, in vitro and in vivo kinetics can be very different, not only in the values of the parameters but more importantly, also in the formulation  <cit> . this points to the need for careful investigation of the model’s validity on the first information level that we defined above.

most of the time, models are assessed qualitatively based on the goodness of their fit to concentration data  <cit> . in some other cases, new datasets in different biological conditions are generated and a qualitative analysis is made based on the model’s ability to predict new datasets  <cit> . however, most of the time multiple candidate models with different structures can show very similar goodness of fit and also prediction in another experimental condition. this stems from high levels of adaptability in these models. one could argue that all candidate models are good as long as they perform reasonably well in prediction. however, rapid elimination of less informative models would be very beneficial to the metabolic modeling community. it would ease the way to trustworthy libraries of models providing the researchers with speed and accuracy for larger scale models. to this aim, model selection and invalidation algorithms supply a quantitative framework.

model selection criteria borrowed from statistical literature such as akaike and bayesian information criteria  are among the most popular approaches introduced for the selection of sytems biology models  <cit> . model selection based on aic have also been successfully implemented in software packages which aim to select the best model within a family of automatically generated models derived from one master model by adding/removing species or interactions  <cit> .

however, those criteria always support in favor of one model without providing any significance to their decisions  <cit>  and can not produce clear results when many parameters are involved  <cit> . an alternative which is capable of ranking different models according to their plausibility was introduced within a bayesian perspective using bayes factors  <cit> . this family of bayesian methods unfortunately still remain unemployed in the field due to the need for smart assumptions on parameters’ prior distributions and their costliness in calculation of bulky integrals despite promising effort regarding the second obstacle  <cit> . in some studies robustness based measures were proposed for model selection  <cit> . for oscillating systems, robustness of the model can support its preference over different models. however, this might not hold true for the whole family of kinetic models in systems biology.

although not employed regularly, the systems biology community has been provided with tools to select between different model structures. however, invalidation of a model structure without an alternative to compare with has not been considered much in the related literature. an analytical approach suggests use of barrier certificates which are functions whose existence proves that the model behaviour can never intersect the experimental data  <cit> . the existence of the barrier certificates proves the invalidity of the models. however the approach is purely analytical and very complex so it is not easily applicable by biologists. another drawback is the difficulty in the construction of the barrier certificates for complicated system descriptions as the authors also elaborate in their paper.

in this article, we introduce a statistical measure for the invalidation of kinetic models which suffers neither from complex model descriptions nor large scale models. we use the predictive power of smooth principal components analysis , an unsupervised data analysis method as a threshold to assess the predictive power of kinetic metabolic models. by using this threshold value, we can determine which model structures are informative enough to deserve further attention and which model structures should be abandoned. our approach stands on a basic assumption: if a totally unsupervised data analysis method without any prior biochemical knowledge predicts better than a kinetic model can do, that points to an inaccuracy or incompleteness in the information which the kinetic model provides us with.

with this paper, we also want to bring the attention of the systems biology community to the idea of using resampling methods which have proven to be very useful in machine learning and data analysis. to our knowledge these methods’ potential has not been exploited fully in the analysis of kinetic systems biology models.

using synthetic data generated from metabolic models has been adopted widely in literature as a way of testing algorithms in a controlled context  <cit> . here, we also employed this approach and used a toy metabolic model and a real signaling model for the generation of data. by using this data, we tested models also with lower complexity than the true model to assess the sensitivity and specificity of our approach.

we applied our method also on an eicosanoid production model in human white blood cells. eicosanoid is a subclass of fatty acyls. fatty acyls constitute one of the six major classes of lipids and are related to inflammation, rheumatoid arthritis, sepsis and asthma. eicosanoids are divided into different groups one of which is prostaglandin family. prostaglandins have been found to be related to many symptoms of inflammation like fever and pain  <cit> . that makes the eicosanoids important targets for modeling studies which can be used for predictive purposes in response to treatment with anti-inflammatory drugs. a kinetic model describing the production of prostaglandins from arachidonic acid has been published in  <cit> . the model includes the substrate arachidonic acid,  <dig> downstream metabolites, signaling molecules and  <dig> different enzymes. all reactions were formulated by mass action kinetics. due to the scarcity of information on enzyme activity regulation, rate parameters for enzymatic reactions were formulated as linear functions of enzyme-regulator molecules. given the simplicity of the kinetics in the model and limited number of components, we wanted to assess its informative level and our results showed that the model could not be invalidated with the available data.

the other benchmark pathway we analysed was the well known high osmolarity glycerol  pathway in yeast. osmo-adaptation in yeast has started to receive increasing attention with the discovery of the associated mitogen-activated protein kinase  cascade  <cit> . since then, the hog pathway proved to be a well studied model system to study the principles of signal transduction due to mapk cascades being conserved eukaryotic signal transduction pathways. the pathway is in charge of regulating the glycerol accumulation in the cell in response to the changing osmotic pressure in the environment. it has been widely accepted that the upstream pathway consists of two redundant paths starting with two different transmembrane osmosensor proteins sho1p and sln1p. the cascade proceeds with the phosphorylation of pbs2p, pbs2p-sho1p complex and hog1p towards the transcriptional regulation of glycerol production  <cit> . however, there is still active debate on post-translational interactions and transient feedback mechanisms involved in the signal transduction  <cit> . therefore we analysed a recently published comprehensive model of the hog pathway to check its predictive properties given part of the experimental data used to build the model  <cit> . we also used the model as a basis for our simulation studies in which we generated data according to the published level of complexity and questioned a simplified version for its validity.

methods
toy metabolic model
we used an unbranched toy metabolic pathway for the generation of synthetic data . it included one substrate and four downstream metabolites whose production followed michaelis-menten kinetics. equation  <dig> shows the set of ordinary differential equations constituting the true model  which we used for the generation of the data. we used the dynamic part of the time series data in the first  <dig> time points as the data without experimental noise. we stored the data in a matrix with metabolites in the columns and time points in the rows.

we introduced homogeneous experimental noise to the data in the form of gaussian noise with zero mean and varying standard deviation. we varied the standard deviation of noise between  <dig>  and  <dig> . at each degree of experimental noise, we repeated the simulations with  <dig> different realizations of the data. 

  dsdt=kin-vmax1skm1+sdp1dt=vmax1skm1+s-vmax2p1km2+p1dp2dt=vmax2p1km2+p1-vmax3p2km3+p2dp3dt=vmax3p2km3+p2-vmax4p3km4+p3dp4dt=vmax4p3km4+p3-koutp <dig> 

comparison of predictive power by cross validation
one of the key features of our approach is using cross validation, a resampling technique as we mentioned in our introduction. cross validation is a very commonly used validation method in statistics and machine learning  <cit>  for determining the optimal level of complexity in models. in cross validation, a data set is divided into two parts: training and test sets. only the training set is used for the parameter inference whereas the test set is only used for assessing the performance of the model on parts of the data that have not been associated with parameter inference. the procedure is repeated with alternating training and test sets several times and the performance results are averaged over all repetitions. in classification problems, that performance measure is the accuracy in classification of the test objects. in regression or dimension reduction problems, it is the prediction error. throughout this paper we refer to the residuals in the prediction of only the test set data points by using the term ‘prediction error’. in this study, we inferred the parameters of both the kinetic and the spca model using the training data and we used prediction error as a measure of the predictive power of both modeling approaches.we used a diagonal cross validation scheme in which 10% of the data was used as the test set. this kind of stratified cross validation scheme provided us with diverse test sets which were homogeneous both in metabolites and time points . with this scheme, every element- excluding the first and the last time points- in the data matrix belonged to a test set once and the sum of the prediction error over all test sets gave the total prediction error. the first time points were not included in the test sets because initial concentrations of the metabolites were also unknown parameters of the kinetic model as we will touch upon also in the proceeding sections. that is why these points could not be used as test points in cross validation. the reason for excluding the last time points was related to the fact that it is more challenging to predict the end points with spca compared to the interior time points. due to this fact, we approached the prediction of last time points in the forecast analysis context where we could adjust the smoothing penalty parameter of spca accordingly.

comparison of predictive power by forecast analysis
forecasting refers to predicting the future outcome of a variable of interest. it is commonly used in a lot of disciplines ranging from economics to meteorology where modeling is crucial. in forecast analysis, models are established using past data and extrapolated to the future. variations on forecast analysis exist depending on the types of the models, the needs of the field, partitioning of the training and test sets and the types of the measures that are used to assess the amount of prediction error  <cit> .

here, we used a basic scheme which fits for both spca and kinetic modeling. in each run, we left out approximately the last 20% of the time points of one metabolite as the test set. by this way, we could assign a certain percentage of the end time profiles to a test set once and the total prediction error on those time points gave us a measure for the predictive power of the models.

kinetic modeling
we estimated the rate parameters  and the initial metabolite concentrations at t= <dig> from the training data. we carried out the optimization with a nonlinear solver in matlab, namely lsqnonlin function which implements the trust-region-reflective algorithm  <cit> . the objective function was to minimize the square of the difference between the noisy synthetic data and the model values of the training set elements. in equation  <dig>  the weighting matrix 
w


tr 

is a binary matrix with 0’s corresponding to the test set elements in the data matrix and 1’s corresponding to the training set elements. we excluded test set elements from the parameter inference process by element-wise multiplication by 
w


tr

. this multiplication is denoted by the hadamard product, ∘, whereas the model concentration values  are given as a function of the unknown parameter vectors k→ and x→ <dig>  

  mink→,x→0wtr∘x-x^k→,x→ <dig> 

we estimated the model concentration values by numerically integrating the set of differential equations defining the model in question at every iteration step throughout the optimization. we repeated the procedure with two different models: the true model  and the simplified model . the true model  is the model we had used for data generation. in the simplified model , the production of the first metabolite was formulated with linear kinetics with only one rate parameter. 

  wtest∘x-x^k→,x→ <dig> 

the prediction error for one test set was then calculated as in equation  <dig> where 
w


test 

has 0’s for training set elements and 1’s for test set elements. 

  dsdt=kin-ksdp1dt=ks-vmax2p1km2+p1dp2dt=vmax2p1km2+p1-vmax3p2km3+p2dp3dt=vmax3p2km3+p2-vmax4p3km4+p3dp4dt=vmax4p3km4+p3-koutp <dig> 

smooth principal components analysis
the other key feature of our approach is its comparative nature. the reference method we used for comparison was smooth principal components analysis   <cit> . spca is an extension of the well known dimension reduction method principal components analysis   <cit>  with roughness penalties on the scores.

the reference method is completely unsupervised, making no use of the kinetic model structure nor of any prior biochemical knowledge. smooth principal components analysis penalizes the non-smoothness of the scores and thus can make use of the underlying time profile in predicting the missing points in the data  <cit> . this makes it more efficient than normal pca to be used as a prediction method when the scores are expected to have smoothness as in the case of time series data.

we have estimated the smooth scores  and loadings  within a weighted principal components analysis  formulation. wpca is a special variety of pca in which data points are weighted proportional to the measurement accuracy at those points by using a weighting matrix  <cit> . wpca can also be used to handle pca on data with missing points using a binary weighting matrix where the entries corresponding to missing points are  <dig>  <cit> . that allows it to be employed as a favorite analysis method in multivariate statistics when there are missing points in the data  <cit>  and also for performing cross validation where some of the data points are excluded as test set elements  <cit> . our application in this study follows the latter.

we have minimized the objective function in equation  <dig> by using the same nonlinear solver as we have used for kinetic modeling. the objective function in equation  <dig> is comprised of two terms. the first term is the sum of squares of the difference between the measured  and model values of the training set elements by the spca model . here, 
w


tr 

is the same binary matrix as we used in the kinetic modeling section. the second term is the penalty term scaled with the smoothing parameter λ where 
d


2

 represents a second order difference matrix. with a second order penalty, scores are penalized for the change in slope  <cit>  which is appropriate in our case since we deal with time series data. 

  minz,pwtr∘x-zpt2+λd2z <dig> 

prior to using spca, the number of principal components  and the value of the smoothing parameter  have to be calibrated for each specific problem. we used cross validation also for this purpose. after the test set elements  which we used also in the kinetic modeling section were removed from the dataset, the remaining part was again subjected to a division of test  and training sets for a 10-fold cross validation with  <dig> repetitions. we applied spca using a particular value for λ and a particular number of pcs on every training set. the average prediction error on all different inner test sets from  <dig> different repetitions gave us a measure of how well the inner test set points could be predicted using that particular parameter combination. we repeated the same procedure by using increasing λ values and increasing number of pcs until the predictions on the inner test sets could not improve with increasing number of pcs and started to deteriorate with increasing λ after certain limits. these limits gave us the optimal values for the parameters. this approach is known as “double cross validation” since it makes use of cross validation at two different levels and it leads to unbiased prediction errors  <cit> .

once the optimal λ and the optimal number of pcs were determined, they were used for the estimation of the scores  and the loadings . equation  <dig> shows how we calculated the prediction error for a single test set whether an inner or an outer test set. in equation  <dig>  
w


test 

has 1’s for test set elements and 0’s for training set elements as we used in the kinetic modeling section. in figure  <dig>  we give a detailed flowchart of our approach. 

  wtest∘x-zpt <dig> 

in forecast analysis we followed the same approach with a small variation. there, we left out windows of data which consisted of  <dig> consecutive time points from the same metabolite as inner test sets, in each run. this helped us to infer the optimal parameters better for the accurate prediction of the end time points. this was because, also in forecast analysis, the purpose was to predict consecutive time points, in opposition to cross validation where the outer test set points were not consecutive.

RESULTS
toy model
we carried out simulations at different experimental noise levels. at the lowest noise level we tested, the experimental noise was drawn from a normal distribution with a standard deviation  of  <dig> . at this level of standard deviation, the mean relative noise in all of the  <dig> different realizations of the data was below 1%. at the maximum noise level , the mean relative noise at a single realization of the data could increase up to 13%. mean relative noise  is a measure of the noise in the data calculated as the mean of individual relative noise levels for each element in the data matrix . in equation  <dig>  xijm denotes the values generated by the model according to equation  <dig> whereas x
ij 
denotes the synthetic data with experimental noise added. 

  mrn=∑i=1n∑j=1m|xijm-xij|xijmn×mn=#time pointsm=#metabolites 

tables  <dig> and  <dig> show all the invalidation decisions made in the simulations study. results show that our spca-based comparative approach performs very well in invalidating simplified models, indicating the method’s high sensitivity. the low number of invalidation decisions made for the true model relate to the high specificity of our approach.


σ


noise

ode


s

ode


t

the numbers show in how many of the  <dig> different noise realizations an invalidation decision was made for the models being questioned by using cross validation. ode
s 
and ode
t 
denote the simplified model and the true model, respectively. mean relative noise at each noise level is given as the mean of the mrn values in  <dig> different realizations of the data, calculated based on equation  <dig> 


σ


noise

ode


s

ode


t

the numbers show in how many of the  <dig> different noise realizations an invalidation decision was made for the models being questioned by using forecast analysis. ode
s 
and ode
t 
denote the simplified model and the true model, respectively. mean relative noise at each noise level is given as the mean of the mrn values in  <dig> different realizations of the data, calculated based on equation  <dig> 

at low noise levels , the difference between the prediction error levels of the true  and the simplified  kinetic models was very high, around two orders of magnitude . at these simulations, spca always performed better than ode
s 
and worse than ode
t
, in the cross validations. at that level, forecast analysis resulted in very similar performance with very high sensitivity and specificity.

at medium noise level , the difference between prediction error levels of ode
t 
and ode
s 
became smaller due to noise interference. at that point, the reconstructed metabolite profile by ode
s 
 pointed to a reasonable model for the data  from a qualitative point of view. however, our quantitative analysis showed that ode
s 
predictions were worse than spca in the cross validations. this showed that spca predictions could be used to invalidate ode
s 
with very high sensitivity. decision for not invalidating ode
t 
in most of the cases showed the specificity of the method. the number of noise realizations at which spca cross validation invalidated ode
t 
or ode
s 
can be seen in table  <dig> for each noise level.

up to this noise level, we determined the optimal value of the λ parameter as  <dig>  by cross validation for all different realizations of the data. cross validation gave also the optimal number of principal components as  <dig> in all of the cases covering more than 99% of the variance in the data. we estimated the optimal values of the parameters to be the same in different noise realizations due to the low amount of noise in the data. however, starting with this noise level, we had to determine the values of the spca parameters differently for each noise realization. this clearly showed that the datasets in  <dig> different noise realizations had different characteristics due to the increasing difference in the realization of the added noise. the difference in the parameters were more apparent for the forecast analysis than for the cross validation.

at this noise level, invalidation by forecasting started to drag behind the cross validations. apparently, noise interfered more when consecutive time points in the end of the time profiles were removed from the training data. this held true for both the spca and the kinetic modeling. due to worsening predictions of spca, ode
s 
could not be invalidated in 14% of the noise realizations . however, the predictions by the ode
t 
got also worse, resulting in an incorrect invalidation decision in 17% of the realizations. predictions of an example simulation at this noise level can be seen in figure  <dig> 

at high noise levels , ode
t 
started to lose its predictive power compared to spca in 14% of the realizations . this could have stemmed from inefficient estimation of the model parameters because of possible local minima in the optimization. in order to check that, optimization was repeated in those problematic cases with multiple starting points. this revealed that the problem was not due to sub-optimal parameters but due to the fact that data was too deteriorated to be explained well even by ode
t 
. however, still in 75% of the realizations, spca predictions invalidated ode
s 
successfully. at this noise level, inference of the optimal spca parameters in the cross validations started to be affected by the noise as well. the value of the smoothing parameter λ and the number of pcs determined by cross validation using other test set patterns were not always optimal. that is why we adopted a grid search approach for this noise level in which we varied the parameter λ in a small range around the value determined by cross validation. as long as we could find better predictions by spca than the model in question, we could conclude that we could invalidate that model. here, we have to emphasize that during the grid search in the small neighborhood of the estimated λ, spca predictions changed very little. this showed that prediction error from spca was very stable. as we use it as a threshold for invalidation of models, proving to be robust against small changes in the parameters is very important.the overall results of our simulations study with the toy model suggest that spca predictions within a traditional stratified cross validation framework perform very well as a threshold measure which can be used to invalidate too simple models. it meets the essential criteria of being totally unsupervised and providing a good description of the data. even at very high levels of noise , it can serve as an invalidating measure. spca predictions within a forecasting framework also serve well for the invalidation purpose. however, it performs worse in high noise levels. on the other hand, we think that for many kinetic modelers, forecasting seems more intuitive and biologically meaningful. therefore, it is of high importance to include it in our study.


noise level affects the plausibility of model simplifying approximations:

as a small demonstration of a specific research question for which our approach can be used, we investigated the plausibility of model simplifying approximations in kinetic modeling.

we used a moderate value  for the first michaelis constant  while generating the data. its value was well within the range of the substrate concentration . if it was much higher than the substrate concentration, the substrate concentration term in the denominator of the first rate equation  could have been neglected. therefore, the model simplification from ode
t 
to ode
s 
could have been performed with very low information loss. this approximation is widely employed in many model fitting studies to justify the simplification of michaelis-menten kinetics to linear kinetics which helps to decrease the number of parameters in the model. however, the ranges of the parameter values in which this approximation will be plausible are never clear.

by using our spca-based invalidation approach, we could investigate how the invalidation decisions changed for the simplified model with respect to the value of the michaelis constant. this helped us to assess the plausibility of the approximation based on the degree of support by the available data. we could also observe how that assessment became difficult by increasing noise in the data. for this purpose, we used three different km <dig> values in data generation. we performed the simulations with noise levels between σ
noise 
=  <dig>  and σ
noise 
=  <dig> .

we could see the expected relationship between the value of the michaelis constant and the plausibility of the model simplifying approximation by using our approach. when the michaelis constant was  <dig> , well within the range of the substrate concentration, the simplifying approximation was never supported by the data until high amount of noise in the data . however, when its value was increased nearly 9-fold, well above the substrate concentration range, in all of the realizations, the data supported the simplifying approximation.


km


1

σ


noise 


=  <dig> 
σ


noise 


=  <dig> 
σ


noise 


=  <dig> 
the numbers show in how many of the  <dig> different noise realizations, invalidation decision could not be made for the simplified model, ode
s
. lack of invalidation decision showed the validity of the model simplification. the table shows that at different michealis constant  values there is different level of support for the validity of the linear kinetics assumption.

the change in the accuracy of the plausibility assessment proved to be an even more important observation. table  <dig> shows that under low levels of noise, when the michaelis constant was only slightly above the range of the substrate concentration at  <dig> , in some  <dig> of the realizations, ode
s 
was not invalidated. this means that the simplification was supported in nearly half of the realizations. the number of realizations at which ode
s 
could not be invalidated could increase to  <dig> when the measurements were more erroneous at σ 
noise 
=  <dig>  . this clearly shows that noise is an important factor that interferes with the plausibility of model simplification. at low noise levels, it is easier to pull out the correct kinetic mechanism from the rest of the simpler candidates. when higher noise is existent in data, detection of poorer predictions by simpler mechanisms become more difficult by the noise. models that are in fact too simple to explain the mechanistic behaviour can be wrongly regarded as plausible candidates when the measurement accuracy is low in the experiments.

eicosanoid production model
data belonging to the biological system under study were time series concentration data  of  <dig> metabolites  from  <dig> different experiments with  <dig> technical replicates  in response to treatment of human macrophage cells with kdo2-lipida   <cit> . the model describing the system included  <dig> first order reaction rate parameters. the topology of the pathway is as shown in figure  <dig> 

we used the mean of all replicates in the calculations. however, replicates in data allowed us to estimate the noise level and we calculated the mean relative noise  in the data as 8%. that level of noise in the data corresponded to the medium to high noise level that we have covered in our simulations study. based on the results we achieved in our simulations study, we could expect high sensitivity and specificity of our approach in that noise range.

a weighted objective function was needed in kinetic modeling to overcome the risk of it being dominated by the metabolites with higher concentrations. the weight matrix w we used included the reciprocal of the maximum concentration of the corresponding metabolite in all the time points. equation  <dig> shows the entries of this weight matrix w for the training set elements. for the test elements, entries were  <dig> as in the case of the calculations for simulated data. 

  wij=1maxxj 

in spca, we preprocessed the data in accordance with the kinetic modeling approach. therefore, we first scaled every concentration value in the data matrix by the maximum concentration of the corresponding metabolite in all the time points and carried out spca on that scaled data matrix. it is highly recommended to scale the data prior to any type of pca application if the order of magnitude of the data values change substantially between columns, since that will allow a more fair distribution of the loadings of the variables in the most important principal components. then, the smoothing parameter applies more equally for every metabolite and we can achieve better smoothing of all the time profiles.we used an 8-fold diagonal cross validation scheme with  <dig> repetitions. the first test set involved consecutive time points from consecutive metabolites as was shown in figure  <dig>  the other  <dig> test sets involved time points with increasing intervals from different metabolites. by this approach we could achieve very diverse test sets and all data points except the first and last time points of each metabolite were included in a test set five times. we also weighted the resulting residuals by the maximum concentration before summing up to the final value and averaged by the number of repetitions.

the optimal λ and the number of principal components needed were estimated by using a  <dig> fold stratified cross validation scheme with  <dig> repetitions. we have found the optimal number of pcs to be  <dig> and the λ value between  <dig> and  <dig>  following a grid search between those lambda values, we achieved the final prediction residuals in spca as 6% of the sum of squares of the weighted data matrix, higher than the prediction residuals in kinetic modeling which was only 3%. these predictions can be seen in figure  <dig>  this showed that the model proposed for the eicosanoid production pathway could not be invalidated by using the available data. despite its simplicity in enzymatic reaction kinetics, it proved to be competent in explaining the data.

hog signaling model in yeast
high osmolarity glycerol signaling pathway in yeast is a well studied system since it is regarded as a model system for studying the principles of signal transduction in eukaryotic cells. the structure of the phosphorylation cascade starting from two redundant osmosensors  and leading to the transcriptional regulation of glycerol production for osmotic balance is generally agreed upon. however there are still competing hypotheses on especially the transient feedback relations involved in the cascade. these include but are not limited to the post-translational regulation of glycerol production, fps1p phosphorylation and sho1p phosphorylation by the hog1p. schaber and coworkers carried out a comprehensive study where they compared  <dig> different models  <cit> . here, we used their best approximating model with the accession number of model <dig> in biomodels database  <cit> . the model consisted of  <dig> species and  <dig> free parameters.  <dig> different variations of mass-action kinetics with either inhibitors or activators were used for the reaction kinetics in the model. volume was also included in the model as a variable whose value changes in time. the interactions in the model can be seen in figure  <dig> 


synthetic data

we used the model depicted in figure  <dig> to generate data by using the optimal parameter values determined in  <cit> . synthetic data consisted of the time profiles of  <dig> different species measured following two different osmotic shocks at  <dig>  and  <dig>  m. nacl in wild type cells. the species were the phosphorylated hog1p, glycerol, hog <dig> dependent protein  and the associated mrna. we set the number of measurement points to  <dig> which spans the dynamic part of the profiles between the shock and the steady state at around one hour later. following the generation of model values, we added heterogeneous noise on the data. noise was drawn from a standard normal distribution with two different values of standard deviation and multiplied by the concentration value of the species at that time point. the standard deviation was  <dig>  and  <dig>  in the low and high noise levels, respectively. we carried out kinetic modeling with the true model, ode
t 
that we used to generate the data and a simplified model ode
s 
which lacked the post-translational regulation of glycerol production by the phosphorylated hog1p . during both kinetic modeling and spca we used a weighting matrix which normalizes the difference between the data and the model predictions, by the mean of the concentration values of the species during all the time points. weighting serves the purposes we explained in the previous section.

in this section, we employed the forecast analysis approach. in each run, we left out approximately 30% of the last time points of each species as the test set. for the determination of the optimal spca parameters, we followed a grid search approach and found that  <dig> principal components are enough with a mild smoothing penalty with λ =  <dig>  in table  <dig> we report the number of invalidation decisions made for the two models and figure  <dig> show the kinetic model and spca predictions on this dataset. our results in this section confirmed once more that spca can predict well even when approximately one third of the data for a single species is left out. this can be seen especially in the upper  <dig> plots in figure  <dig> where predictions not only on the steady part but also on the dynamic part of the profile are good. even at this very high noise level , spca predictions in forecast analysis can serve as an invalidating measure since ode
s 
could be invalidated in all the noise realizations.


σ


noise

ode


s

ode


t

the numbers show in how many of the  <dig> different noise realizations an invalidation decision was made for the models being questioned by using forecast analysis. ode
s 
and ode
t 
denote the simplified model and the true model, respectively.


real data

we used a part of the experimental data from  <cit>  and  <cit>  to question the best hog signaling model reported in  <cit> . the real data included  <dig> different species. the first species was the phosphorylated hog1p whose concentration values were normalized by its maximum concentration value in wild type cells at the same osmotic shock experiment. it was measured for the sho <dig> and sln <dig> deletion mutants at  <dig> different levels of osmotic shock. the other species were glycerol, protein and the associated mrna measured in wild type cell following  <dig>  m. nacl treatment. those species’ concentrations were also normalized by their corresponding maximum concentration throughout their time profiles. we used only the dynamic part of the time profiles which start after the osmotic shock. some of the interior time points were missing in the original data so we interpolated between the existing data points to achieve a full data matrix of  <dig> time points and  <dig> columns. we needed a full data matrix because calculating the prediction residuals for the comparison of the two approaches is a very essential step in our analysis and for this purpose, we need to know the real values of the concentration values at the data points that we leave out as test sets. therefore we imputed the missing values prior to spca & ode modeling by interpolation. in total, more than half of the time points were calculated by interpolation for the hog <dig> dependent proteins  and the glycerol. we questioned two different models as in the case of the synthetic data. the simplified model lacked the post-translational modification of glycerol production by the hog1p.

we used forecast analysis in which we left out the last  <dig> time points from each column of the data matrix in each run. spca on this data matrix with  <dig> pc’s and λ =  <dig>  resulted in a very good representation of the dataset. forecasting prediction error obtained from spca equals  <dig> % of the sum of squares of the whole data matrix. this value was below the residuals obtained by the kinetic modeling using the full model and the simplified model, being  <dig> % and  <dig> % of the sum of squares of the whole data. those predictions can be seen in figure  <dig> 

the results showed us that the model in question did not prove to be sufficient to explain the real data from  <cit>  and  <cit>  that we have used in our study. however, here we used only some part of the data that was available. furthermore we had to impute many missing values prior to our calculations as mentioned above in this section. the reason for this is that we preferred to use the minimum amount of data that would suffice for the parameterization of the ode model. therefore the results we highlight here should be regarded as a more realistic demonstration of our approach rather than arriving at strict biological conclusions.

CONCLUSIONS
we introduced the use of two resampling methods, namely cross validation and forecast analysis for the analysis of kinetic systems biology models. cross validation and forecast analysis allowed us to use a part of the available time series metabolite concentration data to infer the proposed model’s kinetic parameters and the remaining part of the same dataset to assess the predictive power of the model. this way, we have showed that resampling strategies eliminated the need for additional datasets for the assessment of predictive capabilities of models. we used those two approaches within a smooth principal components analysis -based comparative approach for the invalidation of models.

our approach depends on the assumption that correct kinetic model descriptions can predict the test data better than unsupervised data analysis methods which do not make use of any biochemical knowledge. therefore, deficiency of a kinetic model in prediction compared to prediction by unsupervised data analysis methods tells us that the model cannot describe the data sufficiently well. a solid measure of this level of ‘sufficiency’ is needed by the biochemical modeling community because most of the time, we aim at the simplest model which is still competent in explaining the data as was also given as a guideline in  <cit> . on the other hand, it is very important to emphasize that this kind of comparison to unsupervised methods is only needed for the assessment of kinetic models’ validity. we do not intend to underestimate the role of kinetic modeling by showing that there can be cases where unsupervised data analysis methods are superior to some kinetic models. every kinetic model in systems biology is valuable and deserves attention just because they aim at providing mechanistic explanations which the unsupervised data analysis methods in statistics lack. that independence from kinetic model structure is also exactly the reason why we used the predictive power of unsupervised data analysis methods as a reference point in this study. we used smooth principal components analysis for this purpose. spca offers better predictive capabilities than normal pca since it can make use of also the underlying time profile and hence is more suitable for time series data. spca is also very robust against small changes in the smoothing parameter λ, proving to be a stable reference point.

with our simulations study using synthetic data generated by a toy model, we showed that until high amount of experimental noise in the data, cross validation spca prediction error can work as a threshold to invalidate a too simple kinetic model with high specificity and sensitivity. it is however important to note that for an accurate comparison of predictive power, the inferred parameters of the kinetic model have to be optimal. although proven to be not an easy task, there are many methods proposed in the literature to overcome the local minima problems encountered  <cit>  during parameter inference.

forecast analysis requires higher penalties for smoothing of the scores in spca and noise is more influential. predictions by spca forecasting and kinetic modeling are more dependent on the noise realization in the data compared to cross validation with interior time points. therefore, we need to be more aware of the estimated noise level in the data if we want to use spca forecasting prediction error as an invalidation measure.

our spca-based invalidation approach can also be employed iteratively for model reduction. analyses of model families derived from a master model has proved to be a popular approach in biochemical modeling  <cit> . in this approach, a master model is allowed to be manipulated in certain directions, either by changing the interactions and the species involved or changing the kinetic laws of the model. by this way, a very high number of models with very different number of parameters are created and analyzed. here, selection of the best model within the large family of models is a critical task. our invalidation approach can be very useful in that stage. the most complex models within the model family can be questioned first for their validity. later, they can be subject to step-wise simplification by removal of interactions or simplification of reaction kinetics. at a certain stage, the models would be invalidated by our approach meaning that they fail to explain the data sufficiently well. this would mean that the models are in their simplest acceptable form one step before the invalidation decision. however, at that step there would still be a number of models with different characteristics which could not be invalidated. therefore, the problem of model invalidation turns to a problem of model selection between a number of models with similar complexities. therefore, at that point, we can make use of model selection criteria like aic or bic complementary to our invalidation approach for the ultimate selection of the best model.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
dh, hcjh and jaw conceived and designed the study. dh wrote the software, performed the calculations and wrote the manuscript. hcjh and aks supervised the study and helped to draft the manuscript. all the authors read and approved the manuscript.

