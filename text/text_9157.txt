BACKGROUND
since the introduction of the operon concept by jacob et al.  <cit> , the lac operon genetic switch has been considered as a paradigm for genetic regulation. several experimental studies of this system over the past several decades have elucidated the underlying biomolecular interactions and a plethora of mathematical models have integrated the complex interplays of the key biochemical species in order to predict the behavior of the system .

most of these models, however, pertain to the single cell behavior  with a limited number of studies focusing on cell populations, or taking comparative approaches. for instance, in a mini-review article, vilar et al.  <cit>  compared different models pertaining to single cells and cell populations, in order to illustrate the performance and limitations of different methodologies. at the single cell level vilar et al.  <cit>  simulated four phenomenological ordinary differential equations  for the concentrations of permease, inducer, and β-galactosidase. a stochastic single cell model was then developed by transforming the phenomenological deterministic rates into propensities. however, the latter transformation is not unique, contrary to the case of a mechanistic model where the reaction rate expressions are derived on the basis of statistical mechanical assumptions . thus, the stochastic model simulated by vilar et al.  <cit>  is based on ad hoc assumptions. in addition, the vilar et al. models do not appear to account for the dilution of the concentrations due to cellular growth  <cit> , for cell division and for stochastic partitioning or dna duplication effects, which are important sources of extrinsic noise  <cit> .

furthermore, van hoek and hogeweg  <cit>  studied the effect of intrinsic and extrinsic sources of stochasticity, as well as genetic mutations and spatial heterogeneity, at the single-cell and the population level from an evolutionary perspective. their deterministic model consists of an intracellular and an extracellular part, with the latter capturing the influxes and effluxes of glucose and lactose into and from the cells, as well as the diffusion of these species over a grid, the points of which are assumed to be vacant or occupied by single cells. the intracellular part of the model employs ten differential equations for the concentrations of mrna, β-galactosidase, permease, lactose, allolactose, glucose, glucose-6-phosphate, camp, atp, and the size of the cell. the rate expressions used in this model contain hill functions to model saturation and cooperativity effects, and account for dilution due to cell growth. hence, stricto sensu the model is not a mechanistic one, and the incorporation of stochastic effects invokes ad hoc assumptions rather than a formal approach based on statistical mechanics. in particular, van hoek and hogeweg  <cit>  use the deterministic equation for the mrna species, but interpret the mrna concentration as the probability of a single mrna molecule being present in the cell. they subsequently use this probability to infer the frequency of translational bursts.

thus, there remain several open questions regarding the emergence of population behavior from the complex interplay between reaction dynamics and stochasticity at the single cell level. investigating this connection and ultimately understanding cell population dynamics is significant for two reasons. first, typical biology experiments involve cell populations rather than single cells and, thus, phenotypic distributions obtained for instance from flow cytometry pertain to the cell population rather than the lifetime of a single cell. second, there have been mathematical modeling studies for simple genetic networks, suggesting that the behavior of the single cell is very different from the behavior of the cell population  <cit> . it would therefore be interesting to investigate whether this is the case in the more complex lac operon system, or whether one can formulate average single cell models that can adequately capture the behavior of the cell population.

in a previously published article, stamatakis and mantzaris  <cit>  have presented a kinetic scheme that captures the salient features of an artificial lac operon system, which can be constructed in the lab by introducing mutations to the wild-type system. in the present paper we will incorporate that kinetic scheme into two monte carlo  frameworks that simulate cell population dynamics.

the first framework assumes stochastic reaction occurrence and takes into account stochastic dna duplication, division and partitioning. mcadams and arkin  <cit>  were the first to employ the gillespie mc algorithm  <cit>  to simulate gene induction and protein synthesis at the single cell level. this approach was later extended to account for cell growth and division  <cit> . however, all these and many other studies simulated the dynamics of biochemical pathways at the single cell level. in a recent study we generalized and expanded the chemical master equation  to the cell population level  <cit> . the resulting cell population master equation  is simulated with a monte carlo algorithm, and captures stochasticity in the intracellular reaction, stochastic dna duplication, and division events, as well as in the partitioning of the content of a mother cell to the two daughters. this novel framework is applicable to cell populations since every single daughter cell is tracked, thereby making possible the calculation of any statistical property of the population.

in order to better understand how stochastic effects shape cell population distributions, we develop here a second framework that assumes deterministic reaction dynamics and stochastic dna duplication, cell division and partitioning. throughout this work, the single cell models are derived from the reaction network developed in ref.  <cit>  by invoking standard assumptions based on statistical mechanics and reaction rate theory  <cit>  rather than ad hoc techniques  <cit> . we also explicitly take into account the dilution effect due to cell growth in the deterministic case  <cit> . furthermore, stochasticity in the times of division and dna duplication, as well stochastic partitioning effects are effects that were neglected in previous studies  <cit> , but are explicitly taken into account in our cell population frameworks.

comparisons of the predictions of the two frameworks reveal that stochasticity can create or destroy bimodality, and may enhance phenotypic heterogeneity by creating heavy tailed distributions, a phenomenon that has not being shown before and can be investigated experimentally. the insights provided from the new study also allow us to construct simpler and less computationally intensive models that can closely approximate the dynamics of heterogeneous cell populations. specifically, for the case of deterministic reaction dynamics, we use the continuum model formulation which assumes that all cells in the population occupy a continuous and expanding biotic phase  <cit> . under this assumption, a set of mass balances for a representative "average" cell in the population provides a lumped description of cell population dynamics. we demonstrate an excellent agreement between the continuum and the cell population models, which is encountered for the first time and contradicts previous studies. extending these results in the stochastic case, we show that the calculation of distributions of intensive quantities  can be performed on the basis of single cell simulations, instead of computationally demanding population-level ones.

methods
we are now ready to present the frameworks that will be used for the simulating cell populations in this study. both frameworks treat the occurrence of division and dna duplication events as stochastic processes. their difference lies in the treatment of reactions and the partitioning of species between the daughter cells: the first framework treats these as stochastic, whereas the second one as deterministic processes. we will refer to the former as the "population model with stochastic reaction dynamics", and the latter as the "population model with deterministic reaction dynamics".

population model with stochastic reaction dynamics
in an earlier study  <cit> , we presented the formulation of a cell population master equation  that describes cell population dynamics and takes into account the major sources of heterogeneity: stochasticity of intracellular reactions, dna-duplication, cell division, and random partitioning of species contents into the two daughter cells. that formulation also takes into account cell growth and respects the discrete nature of the molecular contents and cell numbers. our approach assumes that each cell of a population can be completely described by a state vector z =  where x is a vector with n entries for species copy numbers and v is the volume of the cell. additional morphometric characteristics like cell membrane area or length can be easily incorporated into our framework. we also classify the chemical species into non-chromosomal dna species and chromosomal dna species that may exist in various states.

this cpme describes the evolution of the probability of finding at time t the cell population having ν cells that exist in states ,..., ,..., . if we denote this probability by jν, the analogue of the janossy density used in the continuous population balances  <cit> , the cpme becomes  <cit> :   

where the terms fr, fs, fg and fd describe, respectively, the stochastic dynamics of intracellular reactions, dna duplication, cell growth, and cell division. the form of these terms is presented in eq.  <dig> of additional file  <dig>  our earlier publication  <cit>  provides the details about the development of the cpme and the monte carlo algorithm that simulates the stochastic processes it describes . here, we just note that the partitioning of cellular volumes upon division is governed by a symmetric beta distribution. further, the partitioning of non-chromosomal dna species follows the binomial distribution whereas for chromosomal dna species partitioning is governed by a multivariate hypergeometric distribution. these choices result in division events where the daughters may have different sizes and species contents; however, on average any daughter inherits half the contents and has half the size of the mother cell. in a more general setting, it is possible to use sums of non-symmetric beta distributions to describe asymmetric  division . in this case, one daughter will consistently inherit more of the mother's molecular content.

population model with deterministic reaction dynamics
the extension of our approach to the case where reactions are deterministic is straightforward and is presented in detail in section s <dig> of additional file  <dig>  for this model, the intracellular species contents are assumed to be continuous vector variables that vary according to reactions described by a system of ordinary differential equations . the processes of cell growth and dna duplication are treated in a similar manner as before, while a modified partitioning function is used here to account for the fact that the chemical species are no longer discrete entities. the modified cpme equation then describes a piecewise deterministic markov process  and takes the form:   

where the terms , fs, fg and  describe, respectively, the deterministic dynamics of intracellular reactions and cell growth, and stochastic dna duplication and cell division. section s <dig> of additional file  <dig> provides the details for the derivation of eq.  <dig>  which is essentially the deterministic limit of eq.  <dig> for all species being present in large numbers inside the cell. in this limit, the stochastic fluctuations due to the individual reaction events are suppressed. as a consequence, reaction dynamics become deterministic  and the partitioning of species is now governed by dirac delta distributions .

structured continuum model: a lumped description of cell population dynamics
since the simulation of detailed population models can be computationally expensive, one often resorts to simpler models. in this study, we will use and evaluate the structured continuum model formulation attributed to fredrickson  <cit> . this model essentially lumps the volume occupied by the cells into a continuous and expanding  biotic phase. thus, the structured continuum model consists of transient mass balance equations written for species concentrations, assuming deterministic reaction dynamics and taking into consideration the dilution effect due to cell growth. a general continuum model can thus be written as a set of ordinary differential equations:   

where  is the average intracellular concentration  of species i over the entire cell population and μ is the average specific growth rate:   

the artificial lac operon reaction network
to simulate the artificial lac operon genetic network, we will use the reaction network of stamatakis and mantzaris  <cit> . this is a minimal model that neglects effects such as the σ <dig> dependence of the lac promoter and assumes that only one laco operator is functional; thus, dna looping is not accounted for. the existence of three operator sites has been previously shown to result in stronger repression and higher sensitivity in induction  <cit> , as well as lower sensitivity to changes in repressor molecules and lower transcriptional noise  <cit> . computational studies of mutations and deletions in these operators have been able to successfully reproduce experimental results  <cit> .

here, our intention has been to model an artificial lac operon that can be constructed in the lab rather than the natural lac operon system. this artificial system incorporates the positive feedback from the lacy permease resulting in bistable behavior, and thus, allows us to isolate the contributions of stochasticity and bistability in shaping the behavior of the cell population. a more complicated pathway incorporating the aforementioned interactions would be intractable within the cell population frameworks that we have developed, and it is not within the scope of this work to investigate these effects.

 <dig> variables without brackets denote number of molecules of the corresponding species.

 <dig> all propensity functions have units of min- <dig> 

 <dig> avogadro's number: na =  <dig> · <dig> nmol- <dig> 

finally, table  <dig> presents the parameter values of the lac operon reaction model, the propensities as and ad appearing in the terms fs and fd of eqs.  <dig> and  <dig>  the growth rate g needed for the term fg, and the volume-related part of the partitioning pdfs . the parameter set is consistent with the one used in ref.  <cit> .

there is considerable uncertainty for some parameters. for instance, the equilibrium constant for repression, k-r/kr is in the range of 10- <dig> to 10- <dig> m  <cit> . the half-life for dissociation of operator dna fragments from the repressor has been reported as  <dig> ~  <dig> s  <cit> ; thus, we have taken the dissociation rate k-r =  <dig>  min- <dig> and kr =  <dig> nm-1·min- <dig> which results in k-r/kr =  <dig> ·10- <dig> m. this value for kr turns out to be much higher than the experimentally measured one of  <dig>  nm-1·min- <dig>  which is deduced by the  <dig> s time needed for a repressor to find an operator  <cit> , assuming ve.coli = 10- <dig> l. yet, simulations of the single cell deterministic model with this value of kr produce quantitatively identical bifurcation structures with the nominal parameter set, provided that the value of k-r has been adjusted to keep the thermodynamic constant for repression the same. since the timescale for repression will be different in this case, the single cell stochastic model is expected to exhibit bistability for different induction levels. previous work  <cit>  showed that slower repressor-operator association and dissociation results in wider bistable regions. in general, however, we expect all qualitative features reported here, to be valid for slower repressor-operator dynamics as well.

for the lac operon networks whose parameters are presented in the previous tables, the propensity functions and rate expression associated with free thiomethyl beta-d-galactoside  transport require knowledge of the cell membrane area ae.coli. the latter can be calculated assuming that the e. coli cells consist of a cylindrical segment with length w and radius r <dig> and two hemispherical caps of radius r <dig> at both ends. then the overall length of the cell l is equal to w + 2·r <dig>  since the diameter of e. coli changes only about 8% or less during one division cycle  <cit> , we neglect this change as insignificant in comparison to the two-fold length change of the bacterium. thus, we assume that r <dig> is fixed in the following expression for the volume:   

the cell membrane area can be then calculated as a function of the volume :   

RESULTS
comparison of deterministic and stochastic reaction dynamics
deterministic reaction dynamics: phenotypic distributions and statistics
the lac operon system is well known for its ability to exhibit bistable behavior when artificial inducers are used  <cit> . in our model bistability arises from the positive feedback that lacy exerts on its own expression. other studies suggest that dna loop structures also play a key role in the bistable behavior of the lac operon system . in this work, however, we focus solely on the aforementioned autocatalytic architecture.

thus, figure  <dig> demonstrates the key behavior resulting from this architecture by presenting two representative transient simulations with the modified cpme of eq.  <dig>  for both simulations, the extracellular inducer tmg concentration is  =  <dig> μm and the only difference is in the initial conditions. in panels  and , the population is initialized with a single cell having species concentrations close to the off state of the lac operon switch. panel  shows the total lacy concentrations, lacyt, for every cell in the population versus time. notice that all offspring remain close to the off state of the lac operon switch. also, the concentrations of the mother and daughter cells are the same at the time of division , and thus, each division appears as a bifurcation in this plot. for example, the first division occurs at  <dig>  min. panel  shows the dynamics of the population average for lacyt, and the number of cells considered in the population . on the other hand, panels  and  pertain to the case where the population is initialized with a single cell having species concentrations close to the on-state of the lac operon switch. for this case, all offspring remain close to the upper state , and so does the population average plotted in panel .

the oscillations shown in figure  <dig> are due to the fluctuations of the promoter concentration during growth and dna duplication. in particular, at the beginning of the life cycle of a newborn cell, a single promoter exists and the cell has a small volume. thus, the promoter concentration is high and drops as the cell grows. right after the dna duplication event, the concentration of the promoter doubles and subsequently drops again as the cell continues to grow up to the point it divides. upon cell division, the promoter concentration could also change if division is not symmetric, and thus the daughters inherit half the promoter content but they have volumes that are not equal to vmother/ <dig>  of course, the concentrations of all other species  remain the same during dna duplication and cell division .

the results of figure  <dig> may give the impression that it is impossible for a cell to switch between the two states. furthermore, single cell simulations  that follow only one daughter at each division show that even for large simulated times , no transitions between the upper and the lower attracting state were observed . this behavior can be attributed to the assumption of deterministic reaction dynamics. thus, in the absence of intrinsic noise it might appear that noise induced transitions are impossible. this assertion is not true, however, because other sources of noise exist in our system. as a matter of fact, a transition from the off to the on state can be achieved just by means of an extremely asymmetric division . such a division results in high dna concentrations in one daughter . consequently, the existing free lacy is able to turn on the lac operon in that cell, thereby allowing it to reach the upper attracting vicinity. in addition, the opposite transition can also be achieved by means of a delayed cell division . the prolonged cell growth after dna duplication results in low concentrations for the operator, thereby decreasing lacy production rates. consequently, the autocatalytic feedback weakens and the lac operon switches to the low state.

for the simulations of figure 3c and figure 3d we have biased the process in order to observe such transitions. still, we must emphasize the fact that we did not impose conditions that are totally unrealistic. both extremely asymmetric divisions and long delays in division are possible, albeit highly improbable. thus, they are not observed within the reasonable simulated time intervals of  <dig> min. these observations are in line with results obtained with the models of vilar et al.  <cit>  and van hoek and hogeweg  <cit> , which also predicted no switching between the two equilibrium states, namely, induced and uninduced.

effect of stochasticity on cell population behavior
having analyzed the case where reaction dynamics follow deterministic laws, we will now investigate the case of stochastic reaction occurrence since the small copy numbers of molecules encountered in this system are expected to result in significant intrinsic stochasticity.

stochasticity in reaction occurrence results in transcriptional and translational bursts, as shown in panel  of figure  <dig> that depicts the timecourses of the cells in a population, that is, all daughter cells originating from a single cell. thus, each cell exhibits noise-induced transitions between states with high and low total lacy contents. we previously saw that in the case of deterministic reaction dynamics, such transitions were possible but extremely rare and were generated either by strongly unequal partitioning or long delays in cell division. thus, the frequent noise-induced transitions observed in the present case are novel and genuine outcomes of the stochastic nature of reaction occurrence. furthermore, panel  shows the temporal evolution of the cell population average, in which we observe that the cell population average reaches a plateau and fluctuates around an equilibrium point. note that these fluctuations are a consequence of the finite sample size . if we were to simulate without any restriction on the sample size, any fluctuations in the cell population average would eventually disappear. also note that the population average appears to equilibrate faster in the case of stochastic  versus that of deterministic  reaction dynamics.

we have just discussed the effects of stochasticity on the transient behavior of the cells as well as the cell population average. in order to characterize the cell population dynamics, however, one needs to know the entire number density function  which expresses the number of cells that exist in states  and  . figure  <dig> compares the ndfs of the two models, both accounting for stochastic division and dna duplication, but incorporating deterministic versus stochastic reaction occurrence, thereby revealing the effect of the latter on population heterogeneity.

for low extracellular tmg concentrations, , stochasticity creates a heavy tail in the ndf, whereas the simulation with deterministic reactions exhibits a narrow peak in the total lacy concentration . this heavy tail can be attributed to the autocatalytic mechanism present in the lac operon system, an assertion that could be used as a starting point for formulating experimentally testable hypotheses. heavy tails have also been observed in the absence of positive feedback  <cit> . in that case heavy tails result from the additive noise due to partitioning of species, as well as due to the exponential evolution of protein number during a division cycle, when protein numbers are large, or the fluctuations in protein production rate, for small protein numbers. these effects exist in our model as well; note, however, that in this study we observe heavy tails in the intensive quantities  as opposed to the extensive quantities  of ref.  <cit> . since the increase of the protein numbers inside the cell is accompanied by an increase in volume, focusing on the concentration would offset the effect of cell growth. further, heavy tails have been observed for the single cell lac operon model in the absence of growth  <cit> , further supporting our assertion that this behavior is due to the autocatalytic dynamics of the system.

for intermediate inducer concentrations , the deterministic reaction ndf is clearly bimodal, in contrast to that for stochastic reaction, which exhibits a much less prominent higher mode . thus, intrinsic noise in this case suppresses bistability; yet, a heavy tail indicative of the positive feedback dynamics is still observed. note that intrinsic noise does not always result in the suppression of bistability: in a previous study pertaining to the single cell level  <cit>  it was shown that intrinsic stochasticity alone can also result in extending the bistable region to parameter values for which a deterministic model would predict monostable behaviour. finally, for high  the ndf for deterministic reaction is unimodal . however, the ndf for stochastic reaction appears bimodal, with a sharp peak at total lacy concentration equal to zero and a wide peak at high t. in this case, stochasticity in reaction occurrence appears to extend the region where the ndf is bimodal and widen the upper mode of the distribution.

in all cases , the heterogeneity exhibited by the population model with stochastic reaction occurrence is significantly larger than that exhibited by the model with deterministic reaction occurrence. this observation agrees with previous results by van hoek and hogeweg  <cit> , whose model also predicted that, in the absence of spatial and genetic heterogeneity, the population variability exhibited by the stochastic simulation is much larger than that of the deterministic one.

structured continuum model for deterministic reaction dynamics
simulating in detail the intra- and inter-cellular processes at the population level is computationally demanding. therefore, it is natural to ask whether one can adequately predict the dynamics of the population average with the use of a lumped model that neglects heterogeneity. for this purpose, we will use the structured continuum model formulation  <cit>  that treats all cells as a lumped and expanding  biotic phase. section s <dig> in additional file  <dig> presents all the transient mass balances that constitute the structured continuum model defined by eqs.  <dig> and  <dig>  in our case, μ is equal to g  because we have assumed exponential growth, which implies a constant average specific growth rate. note again that these balances are written for the average intracellular concentrations  of the chemical species of interest over the entire cell population. the structured continuum model is valid for all times. the assumption here is that the concentrations in any cell at any time remain close to the concentrations predicted by this continuum model. note that we did not include the dilution effect for the operator species o, since the dna duplication process continuously regenerates o.

simulations with the structured continuum model require estimates for the average membrane area over the volume 〈a/v〉 and the average total operator concentration 〈t〉. these average quantities can either be obtained directly from the population simulation or estimated if we know approximately the sizes at which the cells duplicate their dna or divide.

the average ratio of area over volume 〈a/v〉 can be estimated by assuming that a newborn cell with volume 1/2·vd,crit divides when it reaches vd,crit. since the cell is growing exponentially and the a/v is known from eqs.  <dig> and 6:   

therefore, the average 〈a/v〉 can be calculated over the time course of a birth-division cycle using the first mean value theorem for integration:   

using the parameters of table  <dig>  this estimated average equals  <dig>  μm- <dig>  cell population simulations give an average equal to  <dig>  μm- <dig>  thus, using these heuristic arguments, we estimated the average ratio 〈a/v〉 with a remarkably low error .

to estimate the average operator concentration 〈t〉, let us assume that a newborn cell with volume 1/2·vd,crit duplicates its dna when it reaches vs,crit and divides when it reaches vd,crit. since the cell is growing exponentially and the initial operator content is  <dig> copy before duplication:   

using the parameters of table  <dig>  we obtain an estimate of the average operator concentration equal to  <dig>  nm. cell population simulations give an average equal to  <dig>  nm .

panel  of figure  <dig> compares the results obtained by the structured continuum model to those obtained by the modified cpme with deterministic reaction dynamics . the solid and dashed curves show bifurcation diagrams for the total steady state lacy concentration calculated by the structured continuum model. for the solid curve, the average values for the membrane area over cell volume ratio and the total operator concentration were computed from the cell population simulation. for the dashed curve, these average values were taken to be equal to the estimates of eqs.  <dig> and  <dig>  the symbols with the error bars give the average and standard deviation respectively of the modes of the resulting ndfs computed by the modified cpme with deterministic reaction occurrence. each segment of the error bar is one standard deviation, so the full error bar is equal to two standard deviations. if the ndf is bimodal  of figure 6), the two subpopulations are identified and the means and standard deviations for each subpopulation are computed.

the qualitative agreement between the steady states of the structured continuum model and the population averages is excellent. the agreement between the two models is remarkably good when the population-average values for a/v and t are used in the structured continuum model. when we use the estimated values from eqs.  <dig> and  <dig>  the total lacy concentration at maximal induction is slightly underestimated due to the underestimation of the average total operator concentration. thus, the level of agreement between the steady states of the structured continuum model and the averages of the population model depends on how good the estimates for the average cell characteristics are.

the above results pertain to the time invariant behaviors of the cell population. it is interesting, however, to also compare the dynamical behavior of the structured continuum and the cell population model.

panels  and  of figure  <dig> show two such comparisons. the solid curves on both panels show the dynamics of the cell population average as predicted by the cpme model with deterministic reaction dynamics. for the run of panel , a population simulation is first performed for  =  <dig> μm. at time t =  <dig> min, the resulting cell population  has equilibrated to the stationary distribution that corresponds to  =  <dig> μm. then, this population is used as initial condition for a simulation with  =  <dig> μm in order to observe the dynamics of switching from the low to the high state at the population level. this computational procedure mimics the experimental task of inoculating cells to different environment conditions. the dynamics of the opposite switch are simulated for panel : first the cells equilibrate at  <dig> μm tmg and then the population is "transferred" to  <dig> μm tmg).

the dashed and dash-dotted curves on panels  and  of figure  <dig> present predictions of the structured continuum model. for the dash-dotted curves, the average values for the cellular characteristics 〈a/v 〉 and 〈t〉 were taken from the cell population simulations, while for the dashed curves these values were estimated using eqs.  <dig> and  <dig>  for panel , the structured continuum models are simulated for  =  <dig> μm, using as initial conditions the steady state concentrations calculated for  =  <dig> μm. the dynamics of the opposite switch are presented in panel .

the agreement between the transient behaviors predicted by the structured continuum model and the population model is excellent even in the case where the intracellular dynamics are significantly slower than the proliferation rates of the cell as shown in panels  and  of figure  <dig>  panel  shows that for slow lacy mrna dynamics the switching from the low to the high state takes approximately  <dig> min, which is much longer than the  <dig> min average doubling time . even so, the structured continuum model yields excellent predictions of the population average. similar observations were previously reported by vilar et al.  <cit> , who showed that an approach taking into account single cell stochasticity and population level heterogeneity may not be needed, depending on the system studied and the conditions of interest. in particular, vilar et al.  <cit>  noted that, when the lac operon is under the influence of high inducer concentrations, averages taken over independent cells versus the overall population give very similar results.

this agreement between the steady state and the transient behavior of the structured continuum and the cell population models can be explained as follows. in this system, the only coupling between the cells is due to stochastic partitioning that can generate variability but no bias on the total lacy concentration, in the sense that one does not observe consistently higher lacyt concentrations in one daughter versus the other. in fact, the two newborn daughters may have different lacyt contents, but they always have equal lacyt concentrations, which are identical to their mother's lacyt concentration just before division. similarly, unsynchronized dna duplication and division events also contribute to the observed variability in lacyt, but they cannot consistently bias the lacy concentration.

in general, the key to understanding this effect lies in the fact that in the cell population, division results in the removal of an "old" mother cell and the addition of two "young" daughter cells. if the properties of the "old" cells are different than those of the "young" daughters, then this effect results in the properties of the "young" ones being overrepresented in the population. on the other hand, such an effect is absent in a cell chain, where each division results in the removal of a mother cell and the addition of a single daughter, and thus, the properties of both subpopulations are equally represented in the cell chain probability distribution.

let us now suppose that the property we chose to investigate is a species concentration . the concentrations of mother and daughter cells are on average the same, due to the symmetric properties of the binomial and beta distributions that model division. consequently, the cell chain and cell population distributions will be practically indistinguishable. on the other hand, if we chose an intensive property to investigate, the two distributions would be different in general, as we have shown in our previous work . this point is rigorously proven for deterministic reaction dynamics in an earlier publication  <cit> , where we establish that a population balance equation transforms into a continuum model for the species concentrations if certain conditions are satisfied. the conditions, in summary, call for equal species concentrations in mother and daughter cells, size-independent intensive reaction rates, size-dependent but concentration-independent growth and division rates and partitioning probability density function. all conditions hold true to a good approximation in our present simulations and they are also expected to be biologically plausible for a range of systems of interest.

these observations contradict previously published results by mantzaris for different biological systems  <cit> . in these studies, comparisons of the steady states of structured continuum models with the stationary averages of cell population balances  showed that the regions in which the two models exhibit specific types of behavior, such as bistability, were vastly different. these differences were interpreted as effects of cell population heterogeneity. however, we believe that the differences shown by mantzaris  <cit>  are not genuine effects of heterogeneity, but rather stem from the modeling assumptions employed.

more specifically, these studies incorporated into the cpb single cell models that are written for species concentrations. however, the cpb accepts single cell models written for cellular contents , which are extensive quantities, and not concentrations which are intensive  <cit> . one immediate consequence of this fact is by partitioning the concentrations upon cell division one would violate mass conservation. moreover, the cell volume is not taken into account in any of these studies. cells in the exponential phase, however, are continuously growing and dividing, thereby changing their volume roughly two-fold during one division cycle. in turn, the change in volume shifts the thermodynamic equilibrium point and also affects the dynamics if multi-molecular reactions are present in the reaction scheme, which is the case in all of the systems considered in these studies  <cit> . therefore, neglecting the change of the cell volume as time progresses changes creates a priori an inconsistency between the single cell expressions incorporated into the population balance and the structured continuum model.

furthermore, some of these studies used unequal partitioning to artificially generate complex behavior, such as oscillations in a reaction network with 0th and 1st order reactions. however, the asymmetry in e. coli division is negligible: cells may stochastically divide in two unequal daughters, but consistent generation of one large and one small daughter has not been experimentally observed. in fact, it has been shown that the distribution of daughter cell sizes has a mean corresponding to equal partitioning and a small coefficient of variation  <cit> .

simulation of cell chains for stochastic reaction dynamics
given the high computational expense of simulating the population model with stochastic reaction dynamics, we pose the question of whether there is a simpler method for obtaining good approximations for the distributions of phenotypic characteristics. in contrast to the case of deterministic reaction dynamics, we cannot use a continuum model for comparison purposes here. the main reason is that in chemical systems far from the thermodynamic limit, the size influences noise strength. in the case of stochastic reaction occurrence, therefore, growth results in dilution of molar contents and also suppression of stochastic fluctuations. consequently, we cannot create a lumped model that accounts for growth with just the incorporation of a dilution term as was done in the deterministic case.

however, we can take a different approach. we have already observed that cell population dynamics emerge from single cell behavior and that, on average, the two daughters share the same concentrations as their mother cell. therefore, instead of tracking the ndf in a cell population, we could compute the pdf in a cell chain. simulation of a cell chain tracks only one daughter after each division event. thus, instead of focusing on the expected number of cells of the population that exist in state z, we turn our attention to the probability of finding a single cell of the cell chain at state z. note, however, that we will be comparing the pdf and ndf of intensive quantities, in particular the total lacy concentration.

a comparison of the cell population ndf with the single cell pdf for t shows a remarkable agreement between the two . such an agreement is obtained for different parameter sets that generate dissimilar distributions. note that this comparison pertains to stationary conditions and refers to intensive quantities . essentially, this comparison shows that under the assumptions used to build the models, the cell chain behavior is indicative of the population behavior. thus, we can successfully predict the stationary ndf of the concentrations just by simulating a cell chain, which is computationally less expensive than simulating the cell population.

CONCLUSIONS
this study generalized the deterministic and stochastic single cell lac operon models of an earlier publication  <cit>  using two cell population frameworks that account for stochastic and deterministic dynamics of the biochemical reactions. we subsequently performed simulations to investigate the behavior of the cell population and demonstrated the effect of stochasticity in reaction dynamics. we concluded that this source of stochasticity can amplify population heterogeneity by introducing heavy tails to the phenotypic distributions and can create or destroy bimodality.

we also carried out a systematic comparison of predictions obtained by a structured continuum model and a detailed cell population model with deterministic reaction dynamics. these comparisons showed that the structured continuum model gives satisfactory results for the average lacyt concentration of the population, even in the case where the reaction dynamics are much slower than the proliferation dynamics. this agreement between the two models was attributed to the similar intensive properties  between mother and daughter cells.

finally and in the case of stochastic reaction dynamics, we demonstrated that by simulating the dynamics of a cell chain we can obtain very accurate approximations of the cell population dynamics. the pdfs obtained by cell chain simulations for the lacyt concentration were in excellent agreement to the cell population ndf computed with the monte carlo algorithm implementing the cpme of eq.  <dig> 

our study shows that for cell populations in which the cells interact weakly, through division only, it is possible to accurately model and explain the population behavior in terms of the single cell dynamics. for such systems, the key parameters for describing the behavior of the population are the kinetic constants of the underlying pathway of interest, and the physiological functions that express the single cell growth rate, dna-duplication and division propensity, as well as the partitioning mechanism. intrinsic noise can be inherently accounted for, once the cell size has been specified and thus no additional parameters are needed for this purpose. such a description is expected to be of great importance in bioinformatics studies focusing on population variability, since, for cells interacting though division only this variability can be explained in terms of a limited number of parameters.

finally, deviations between the experimentally observed population dynamics and the behavior predicted by our framework may indicate the presence of more complex effects that are not accounted for in this framework. for instance, the cells could be non-isogenic, or coupled with strong interaction mechanisms. another source of complexity is the existence of multiple compartments in the cell, which would invalidate the assumption of a single well-mixed intracellular space. such effects would have to be incorporated to the framework in order to obtain a more accurate description of the system of interest.

competing interests
the authors declare that they have no competing interests.

author's contributions
ms developed the mathematical models and performed the simulations, analyzed the results and drafted the manuscript. kz conceived of the study, participated in its design and coordination, and refined the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary text that includes:  detailed descriptions of the population level modeling frameworks for deterministic and stochastic reaction dynamics;  a discussion of asymmetric volume partitioning;  the derivations of the partitioning probabilities for population models with deterministic reaction dynamics  the structured continuum model simulated in figure  <dig> and figure  <dig> 

click here for file

 acknowledgements
the financial support of nih-nigms through grant r <dig> gm <dig> is gratefully acknowledged. this work was also supported in part by the shared university grid at rice funded by nsf under grant eia- <dig>  and a partnership between rice university, sun microsystems, and sigma solutions, inc.
