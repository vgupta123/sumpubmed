BACKGROUND
in the last few years, real-time quantitative polymerase chain reaction  has become the technique of choice for absolute or relative quantification of gene expression due to its rapidity, accuracy and sensitivity  <cit> . furthermore, recent advances in the sequencing of the human genome, mrna and mirna expression profiling of numerous cancer types, disease-associated polymorphism identification and the expanding availability of genomic sequence information for human pathogens have led to marked growth in molecular diagnostics  <cit> .

the gold standard quantification method  in real-time pcr assumes that the compared samples have similar pcr efficiencies. however, quantification by real-time pcr is very sensitive to slight differences in pcr efficiencies among samples. indeed, a small difference of 5% in pcr efficiency will result in a three-fold difference in the amount of dna after  <dig> cycles of exponential amplification. many factors present in samples as well as co-extracted contaminants can inhibit pcr, confounding template amplification and analysis  <cit> . this is a major problem when working with biological samples. severe inhibition will lead to false-negative results, whereas a slight to moderate inhibition can result in an underestimation of the affected sample's dna concentration  <cit> . furthermore, amplification efficiency can fluctuate as a function of non-optimal assay design, enzyme instability, or the presence of inhibitors  <cit> . although a variety of methods have been developed to quantify template dna  <cit> , very few allow simultaneous evaluation of template quantity and quality without the addition of an internal positive control that is co-amplified with the target of interest. hence bar and co-workers proposed a method  based on amplification efficiency calculation for the early detection of non-optimal assay conditions  <cit> . this approach is extremely straightforward and effective, but it is based on a pcr amplification efficiency calculation for which there is still not a method fully accepted by the scientific community. a large number of studies have attempted to calculate amplification efficiency assuming that pcr is inherently exponential in nature. based on the assumption of the log-linearity region, constant amplification efficiency is calculated from the slope of linear regression in that window  <cit> . an alternative approach is based on the observation that pcr trajectory can be effectively modelled by the sigmoid function  <cit>  allowing pcr efficiency to be estimated using non-linear regression fitting  <cit> . recently, a simplified approach called "linear regression of efficiency" has allowed us to estimate amplification efficiency by applying linear regression analysis to the fluorescence readings within the central region of amplification profile  <cit> . notably, it has been demonstrated that estimates of pcr efficiency vary widely according to the approach that has been adopted  <cit> .

very recently, tichopad et al.  <cit>  introduced a new quality control test for quantitative pcr; in this procedure the first derivative maximum and the second derivative maximum were estimated using a logistic fitting on the pcr trajectory. this approach allowed them to monitor the first half of the curve using two parameters.

our study aims to develop a quality test tool, which is not based on amplification efficiency estimation, in order to detect samples that do not show an amplification kinetic similar to those of standard samples. in this work, a non-linear fitting of richards equation was used to parameterize pcr amplification profiles from a large sample set. the subsequent calculation of the variance of the estimated parameters and the development of a statistical measure based on the mahalanobis distance allowed us to develop the sod method . the sod analysis of inhibited amplifications and the comparison of this method with kod were investigated in detail.

methods
quantitative real-time pcr
the dna standard consisted of a pgem-t  plasmid containing a  <dig> bp fragment of the mitochondrial gene nadh dehydrogenase  <dig>  as insert. this dna fragment was produced by the nd1/nd <dig> primer pair . this plasmid was purified using the plasmid midi kit  according to the manufacturer's instructions. the final concentration of the standard plasmid was estimated spectophotometrically by averaging three replicate a <dig> absorbance determinations.

real-time pcr amplifications were conducted using lightcycler®  <dig> sybr green i master  according to the manufacturer's instructions, with  <dig> nm primers and a variable amount of dna standard in a  <dig> μl final reaction volume. thermocycling was conducted using a lightcycler®  <dig>  initiated by a  <dig> min incubation at 95°c, followed by  <dig> cycles  with a single fluorescent reading taken at the end of each cycle. each reaction combination, namely starting dna and inhibitor agent, was performed in triplicate and repeated in two separate amplification runs. all the runs were completed with a melt curve analysis to confirm the specificity of amplification and lack of primer dimers. ct  was determined by the lightcycler®  <dig> software version  <dig>  and exported into an ms excel data sheet  for analysis after background subtraction . for ct  evaluation, a fluorescence threshold manually set to  <dig>  was used for all runs.

estimation of pcr efficiency
the raw pcr data were used to calculate amplification efficiency. the pcr efficiency for each individual sample was derived from the slope of the regression line in the window of linearity  <cit> . baseline correction and window of linearity identification were carried out using the latest version of linregpcr   <cit> . pcr efficiencies were estimated from four sample sets: standard amplification curves, standard amplification curves with the addition of tannic acid read-outs, standard amplification curves with the addition of igg read-outs and standard amplification curves with the addition of quercitin read-outs. the window of linearity calculated from all the data sets encompassed the fluorescence threshold of  <dig>  chosen for the quantitative analysis.

mathematical model of kod
the mathematical model of kod, based on efficiency, was proposed by bar et al.  <cit> . briefly, this was done comparing pcr efficiency of a sample  with the efficiencies of standard curve samples. a test sample is classified as an outlier if |z| >  <dig>  with , where μeff is the efficiency mean and σeff is the standard deviation of the efficiency of standard curve samples. alternatively, it is to be considered that the statistic  is distributed as a χ <dig> with one degree of freedom; if χ <dig> >  <dig> , we can reject the null hypothesis at α =  <dig> .

mathematical model of sod
shape based kinetic outlier detection  was based on the shapes of the amplification curves. in order to fit fluorescence raw data, nonlinear regression fitting of 5-parameter richards function, an extension of the logistic growth curve, was used  <cit> .   

where x is the cycle number, fx is the reaction fluorescence at cycle x, fmax is the maximal reaction fluorescence, fb is the background reaction fluorescence and b, c and d represents the estimated coefficients. nonlinear regressions for 5-parameter richards functions were performed determining unweighted least squares estimates of parameters using the levenberg-marquardt method.

the shape parameters used were the plateau value of amplification curve , tangent straight line slope in inflection point  and y-coordinate of inflection point  .

the y-coordinate of inflection point  was calculated as follows:   

and the tangent straight line slope  was estimated as:   

normal distribution of fmax, yf and m parameters, obtained from standard samples, was checked using the kolmogorov-smirnov test for normality; the significance of the correlation between these parameters and input dna concentrations, expressed as log, was tested with a t test as follows:   

where r is the pearson coefficient and n the sample size . the multivariate normality of the adopted reference set was evaluated according to rencher ac  <cit>  . in addition, the asymmetry  of the amplification curves was estimated as follows:   

replacing yf and fmax, eq.  <dig> can be simplified as: . in agreement with this equation the curve is symmetric  when d =  <dig>  or 2*yf = fmax. on the contrary, when d> <dig> we have 2*yf<fmax  hence asym> <dig> 

statistical model of sod
after developing a method to estimate three different shape-parameters , the next step was to set a criterion to identify test samples that deviated from expected values. this was done using sample vector  which can be calculated for each experimental amplification; if y belongs to a multivariate normal distribution, with mean vector  and Σ the corresponding variance-covariance matrix, the 'Σ- <dig> value  has asymptotic χ <dig> distribution, with  <dig> degrees of freedom. the mahalanobis distance is based on correlations between variables through which different patterns can be identified and analyzed. it is a useful way of determining the similarity of an unknown multivariate sample set to a known one. it takes into account the correlations of the data set and is not dependent on the scale of measurements. mean vector and variance-covariance matrix were calculated from shape parameters of standard curve samples. then if χ <dig> >  <dig> , we can reject the null hypothesis  and establish that the shape of the amplification curve is different from the shape of the standard curve samples, considering all three parameters  <cit> . all elaborations and graphics were obtained using excel , statistica  <dig>   and statistical package for social sciences .

RESULTS
standard curve sod analysis
the sod model relies on the assumption that in order to achieve a reliable quantification, the amplification curves of unknown samples should not be significantly different from those of the standard curve. we introduced the idea that the amplification kinetic can be monitored by the shape of the amplification curve. the shape of amplification curves was parameterized using the nonlinear regression fitting of the richards function on the fluorescence readings  <cit> . this mathematical procedure allowed us to obtain the five parameters characteristic of the richards equation. these values were subsequently used to calculate the slope of the tangent at the inflection point , the y-coordinate of the inflection point  and the maximum fluorescence value  of the reading. finally, these three parameters allowed us to create a "fingerprint" for each amplification curve.

based on this assumption, the parameters m, yf and fmax of the amplifications used to build a standard curve should not be significantly different from one another and should not be correlated with input dna. to verify this assumption, a standard curve was generated over a wide range of input dna . table  <dig> shows the mean, sd, and kolmogorov-smirnov test from a total of  <dig> runs. these results demonstrated that m, yf and fmax were normally distributed, even though they showed a different dispersion. subsequently, the relationship between m, yf and fmax and the log of the starting dna template was studied. as shown in fig.  <dig>  there was not a significant correlation between the log of input dna and these parameters . in fact, determination coefficients  quantified only a very low proportion of parameter variances less than  <dig> %.

means  and kolmogorov-smirnov  test value  of the following parameters: linereg efficiency , ordinate value of inflection point , slope of tangent straight line in inflection point  and plateau value .

in order to objectively define an amplification profile as an outlier, we introduced the variable log, which estimates errors from quantification analysis using the ct method. this variable relies on the residues estimated as the difference between calculated molecules, using the ct method , and input dna molecules ). the ratio log showed a normal distribution satisfying the assumption of homoscedasticity . it is thus possible to determine a 95% confidence interval  for the variable log. these residues showed a normal distribution regardless of the starting dna template, with the average equal to zero and the standard deviation constant . in our database, out of a total of  <dig> runs used to construct the standard curve,  <dig> runs showed the ratio log out of the ci . subsequently, pcr efficiency  was also estimated for each amplification curve; the linregpcr software  <cit>  was used to fit the data points in the optimal range of the pcr exponential phase to obtain an automated evaluation of eff .

to determine how well outlier samples can be identified by kod and sod, we applied these statistical analyses to the runs of the standard curve; in particular we found that kod identified  <dig> runs over the χ <dig> threshold value of  <dig>  while sod revealed  <dig> runs out of the ci . these outliers are probably false-positives due to the definition and intrinsic properties of the 95% ci.

inhibitor effects on real-time amplification
tannic acid oxidizes to form quinones which covalently bind to taq dna polymerase inhibiting its activity  <cit> . real-time amplification plots from  <dig>  ×  <dig> dna molecules in the presence of increasing concentrations  of tannic acids were obtained. all the quantification values were obtained using the ct method. the resulting amplification curves and the corresponding quantifications demonstrate the effects of inhibition on real-time analysis . as the tannic acid concentration increased, the ct values went up steadily leading to an underestimation of the starting molecules. this quantification error was highlighted when log dropped out the corresponding ci . suppressed amplification was demonstrated by the calculations of efficiency using linregpcr procedure . the observed errors were the result of the progressive reduction of the plateau, linear phase length and slope of the inhibited curves; together these effects led to increasing ct values   <cit> .

these data led us to investigate the modifications of the parameters m, yf and fmax in response to increasing inhibitor concentrations. fig. 3c shows the increase in relative error of m, yf and fmax in the presence of increasing tannic acid concentrations. notably, these results also showed that curve asymmetry  increased with higher inhibitor concentrations. this in turn demonstrates that not only the slope  and plateau  of the curve decreased but also the shape changed moving towards a more and more richards' type kinetic .

subsequently, we evaluated the effects of igg and quercitin, molecules known to inhibit pcr, on amplification kinetics  <cit> . both these molecules result in a significant underestimation of starting dna molecules at high inhibitor concentrations . as shown in fig.  <dig> and  <dig>  we always found a change in parameters m, yf and fmax when the quantification error occurred.

furthermore, the asymmetry analysis showed an interesting singularity in the quercitin effects compared to those of tannic acid and igg. in fact, quercitin led to kinetic alterations without a significant effect on the curve symmetry .

sod versus kod analysis
sod and kod analyses were used to identify samples with aberrant pcr kinetics, due to inhibitor presence, which might lead to erroneous quantifications. fmax, m and yf values calculated from each amplification curve, obtained in the presence of increasing tannic acid, igg or quercitin concentrations, were used to estimate the χ2sod value. hence if the χ2sod value from an amplification curve was higher than the threshold value  <dig> , the quantification was defined as an outlier. pcr efficiencies were also estimated and χ2kod values determined from the same amplifications. quantification curves with a χ2kod values over  <dig>  were rejected.

hence the sod and kod performances were evaluated according to their ability to identify an amplification as an outlier when the log ratio is not within 95% ci. the results obtained by sod and kod analyses in the presence of increasing tannic acid concentrations are shown in fig. 6a and 6b. when tannic acid concentrations ranging from  <dig> - <dig>  mg/ml were added, all the obtained curves had significant quantification errors  below the lower limit of 95% ci). these curves were associated with χ2sod values higher than the threshold value of  <dig>  . in this concentration range, kod analysis appeared to be less powerful than sod. in fact, kod found as outliers  only  <dig> of the  <dig> curves showing a log ratio out of 95% ci . there were no outliers under  <dig>  mg/ml tannic acid concentration, with the exception of some amplifications that were randomly out of the ci.

sod and kod analyses were also applied to real-time quantifications in the presence of igg or quercitin as inhibitors. when amplification reactions were conducted in the presence of 2- <dig>  mg/ml igg, the suppression of amplification was efficiently revealed by both sod and kod, though sod was more sensitive than kod. in fact, sod highlighted  <dig> outliers versus  <dig> revealed by kod out of a total of  <dig> outliers  out of 95% ci) . analogous results were also obtained for quercitin. in the presence of  <dig>  mg/ml of quercitin, sod found  <dig> outliers compared to the  <dig> revealed by kod out of a total of  <dig> outliers .

finally, we defined as true positives  those amplifications showing χ2>threshold value and those that led to a log ratio out of the 95% ci. conversely, false positives  were defined as samples that showed the χ2>threshold value and a log ratio within the 95% ci. consequently, true negatives  were those amplifications showing χ2<threshold value that led to a log ratio within the 95% ci and false negatives  those showing χ2<threshold value and log ratio out of the 95% ci.

based on these definitions, the 'sensitivity' of sod and kod is represented by the ratio  while the 'specificity' is the ratio: . table  <dig> shows that sod was more sensitive than kod in all the tested settings, while sod and kod were equally specific in the presence of igg and quercitin. sod was also more specific than kod in the presence of tannic acid.

the comparison between pcr amplification profiles in the presence of different inhibitors using kod and sod analyses showed that sod is significantly more sensitive than kod in all the tested conditions , whereas kod and sod specificity is similar in the same conditions .

discussion
a topic of great interest is the development of hand-free tools for the detection of aberrant amplification profiles in real-time pcr analysis. real-time pcr has rapidly become the most widely used technique in nucleic acid quantification. although real-time pcr analysis has gained considerable attention in many fields of molecular biology, it is still troubled by significant technical problems  <cit> . hence the present study has focused on the investigation of a new outlier detection approach which is not based on the pcr efficiency estimate but rather on the shape of the amplification profile.

the amplification nature of pcr makes it vulnerable to small differences in efficiencies of compared samples  <cit> . in fact, the current "gold standard" in real-time pcr analysis, the threshold cycle method , requires similar pcr efficiencies among compared samples.

however, dissimilarity in pcr efficiency results from different starting material sources, for example, different types of tissues  <cit> . such differences might also be found when inhibitors of taq dna polymerase are present in cdna samples  <cit>  or in the presence of low quality sybr green and/or dntps  <cit> . furthermore, the frequency of pcr inhibition  <cit>  and different inhibitory effects even among replicates  <cit>  highlight the need of kinetic quality assessment for each sample. hence bar et al.  <cit>  proposed a statistical method, called kod, to detect samples with dissimilar efficiencies.

kod searches for outliers based on the main assumption that to obtain a reliable quantification, pcr runs have to show efficiencies which are not significantly different from each other. this condition is verified comparing the slopes of the straight-line regression calculated in the window-of-linearity after the log-transformation of each read-out fluorescence. in other words, if we return to raw data, the profile of the exponential curves in the window-of-linearity, mustn't be significantly different among compared runs. in the development of the sod method we extended this concept to the whole curve, and all the runs included in the analysis have to show comparable amplification profiles.

the ct method is based on the analysis of a serially diluted target. an example of this approach is presented in fig. 1a careful examination of the obtained amplification profiles illustrates the central principle of the sod method: all amplification curves are similar in shape and only the profile position is related to target quantity. the first amplification profiles, corresponding to the most concentrated samples, are found on the left, whereas samples with an increasing dilution factor regularly shift towards the right. this observation led us to the insight that an exclusion criterion could be based on the difference in shape rather than efficiency. this is in agreement with the work by rutledge and stewart  <cit>  in which these authors described the amplification curve as a function of efficiency. hence if efficiency determines the shape of a curve, by monitoring the shape of an amplification profile, information concerning the efficiency of amplification can be obtained.

firstly, a "fingerprint" for each amplification curve using m, yf and fmax resulting from the fitting of the richards equation on raw data was obtained. subsequently, these parameters were used to obtain the variance-covariance matrix in order to calculate the mahalanobis distance  <cit> . this statistical measure is based on correlations among variables through which different patterns can be identified and analysed. in particular, the sod analysis made use of the mahalanobis distance to determine the similarity of an unknown sample compared to the standard set. this approach was very useful because it allowed us to evaluate not only the variance of single parameters , but also to quantify the reciprocal co-variations among m, yf and fmax.

fmax was considered in the development of sod because this parameter demonstrates successful amplification and usually, in suboptimal amplification conditions, the read-outs do not reach characteristic fmax values  <cit> . examining our database, it was noted that fmax showed high variance, thus it slightly affects χ2sod alone, but fmax had a significant impact on the variance-covariance matrix. the parameter m describes the slope of the curve in the inflection point  <cit> . in our model, the higher the value of m, the higher the amplification rate is. however, this estimator does not directly indicate the amplification efficiency understood as the proportion between current and previous product amounts  <cit> . finally, the asymmetry of amplification profiles was monitored by the relationship between fmax and yf. it has been demonstrated that absolutely symmetrical pcr curves seldom occur, justifying the introduction of a five-parameter fit  <cit> . furthermore, in our previous work  <cit> , it was demonstrated that the amplification reaction may deviate from a symmetric sigmoid curve to an asymmetric sigmoid  in the presence of suboptimal efficiency. in fact, the goodness of fit of the logistic model progressively decreased with lower efficiency suggesting a change of pcr curve amplification shape  <cit> .

the correlation analysis between m, yf and fmax obtained from the standard curve and input dna demonstrated that these shape parameters are concentration-independent. this supports our experimental hypothesis that all the amplification curves of the standard curve are similar in shape and only the profile position determines target quantity. in the presence of pcr inhibition, it was found that increasing concentrations of tannic acid and igg resulted in decreasing fmax and m values, while asymmetry increased with higher inhibitor concentrations . it may be that tannic acid inhibition is simply due to fluorescence quenching since we found a dramatic decrease in fmax and a slide curve slope decrease. however, we also showed that fluorescence asymmetry increased demonstrating that tannic acid produced an amplification kinetic distortion. the addition of quercitin to pcr amplifications produced very interesting data. in fact, we found decreased fmax and m values in the presence of high inhibitor concentrations, however this flavonid did not induce an asymmetric modification of the curves . the reported data clearly demonstrate that the sod method can identify non-optimal pcr kinetics resulting from different inhibition models. furthermore, the results obtained in the presence of quercitin highlight the importance of using a multivariate approach.

when comparing sod to kod performance, it was found that sod was more sensitive than kod in all the tested settings. sod and kod were equally specific in the presence of igg and quercitin, whereas sod was more specific than kod in the presence of tannic acid.

furthermore, the sod method presents several advantages over kod; sod is completely hand-free. indeed, it is not necessary for the user to identify a window of analysis as in the kod method, and more importantly, sod does not rely on a constant efficiency value avoiding all the problems connected with its determination  <cit> . as previously reported, variable pcr efficiency determination can lead to different results contributing to erroneous and spread quantifications  <cit> . moreover, log-transformation of fluorescence data that could be responsible for bias in the analysis are avoided.

the sod method has been developed for the chemistry sybr green, and the application of this procedure to other chemistries such as taqman, needs to be evaluated extensively.

very recently, tichopad et al.  <cit>  proposed a new kod procedure based on malahanobis statistic  <cit> . in this study the first derivative maximum and the second derivative maximum were estimated using a logistic fitting on the central portion of the pcr trajectory. using these two parameters these authors proposed monitoring only the first half of the curve. on the contrary, the sod method is based on the possibility of describing the whole pcr trajectory using richards equation. sod represents a continuation and an extension of the application of richards equation to real-time pcr readings  <cit> . we think that the sod method introduces original concepts that are not found in the recently developed method described by tichopad et al.  <cit> . sod takes advantage of the possibility of describing the shape of the whole pcr trajectory through the combination of the parameters m, yf and fmax while the method by tichopad et al.  <cit>  focuses on two key points of the trajectory: the maximum of the first and second derivative. furthermore, in the sod method we used quite a different metric approach. although other multivariate methods are available for similar tasks , we used asymptotic distribution of the mahalanobis distance because it is a logical extension of the kod method, which is based on univariate normal distribution.

CONCLUSIONS
we demonstrated for the first time that a comparison of the shape variation of an amplification profile with the shape of standard profiles can be used to exclude aberrant samples from ct analysis. this allows us to avoid the spread of results and therefore increases the potential of quantification analysis.

hence we propose sod as a hand-free quality control method in real-time pcr analysis with applications in any field of molecular diagnostics.

abbreviations
ct: threshold cycle; igg: immunoglobulin g; sod: shape based kinetic outlier detection; kod: kinetic outlier detection; asym: asymmetry.

authors' contributions
mg and ds carried out the design of the study, participated in data analysis, developed the sod method and drafted the manuscript. mblr participated in data collection and analysis and critically revised the manuscript. pt carried out the real-time pcr. dm participated in data collection. vs participated in the design of the study and critically revised the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
fluorescence data and fitting elaboration of standard sample amplifications  and amplifications obtained in the presence of: tannic acid, igg and quercitin.

click here for file

 additional file 2
analytical solutions for the y value of the inflection point  and the slope of tangent straight-line  crossing the inflection point.

click here for file

 additional file 3
a) chi-square distribution of the squared distances about the population mean vector 'Σ-1) with  <dig> degrees of freedom. b) scatter plots of all pairs of variables fmax, yf and m.

click here for file

 additional file 4
p-p plot of the variable log.

click here for file

 additional file 5
kod and sod elaborations of standard sample amplifications  and amplifications obtained in the presence of: tannic acid, igg and quercitin.

click here for file
