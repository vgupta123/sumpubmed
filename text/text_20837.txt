BACKGROUND
in the last  <dig> years microarrays have become a fundamental tool in biological research laboratories throughout the world. the recent growth in interest of applying this technology to studying a different aspect of the genome, namely the epigenome, requires that researchers have a good understanding of the biological processes underlying the new array technologies and their applications as well as the statistical issues involved when analysing the resulting data. whilst there are many publications exploring the biology of dna methylation and the epigenome, and a large number of articles describing the development of approaches for studying dna methylation, there are few articles that address aspects of the analytic issues involved in these new technologies.

in genome-wide epigenetic analyses a small number of samples are typically submitted to a whole genome methylation array due to cost and sample availability constraints; these arrays can generate in excess of  <dig>  data points  for each sample. if the samples are chosen to be extremes of available phenotype, statistical tests appropriate for two groups, such as t-tests or mann–whitney u tests, can be used on the methylation results for each probe. if the samples are chosen across the full range of phenotype values, techniques such as linear regression can be used to test the association of phenotype with methylation results. both of these approaches lead to a large number of statistical tests based on a small number of subjects and statistical techniques have been designed to accommodate this  <cit> .

if there were no association between any of the probes measuring methylation of the various cpg sites in the array and the phenotype, the distribution of p values from the statistical tests used would approximate a uniform distribution. a uniform distribution can be visualised as a histogram where each bar is equal in height, as each possible p value is equally likely to occur. for example if you consider putting each p value  into bins of width  <dig> , as each p value is equally likely to occur the same number of p values are likely to be put into each bin and would therefore produce bars of equal height when plotted on a histogram. if however some probes are significantly associated with the phenotype of interest we would expect an excess of p values less than alpha  due to the association; the p value distribution would no longer be a uniform distribution and a histogram would show longer bars representing p values less than alpha resulting from an excess of probes significantly associated with the phenotype.

in exploratory analyses using a whole genome methylation promoter array we observed a p value distribution for some outcomes where fewer p values less than alpha were observed than would be expected by chance. we hypothesised that this could be due to some of the assumptions of the statistical technique used being violated and sought a solution to this problem. our solution is a new approach which differs from the published literature  <cit>  and is much easier to implement using routines already contained in a variety of statistical software packages including r  <cit> .

RESULTS
methylation at the various cpg sites across the genome was measured using the log of the ratio of methyl to input signal , hereafter referred to as the log ratio value. the association of log ratio values for approximately  <dig>  probes designed to measure methylation of cpgs situated on the promoter regions of genes on chromosomes  <dig> to  <dig>  with a continuous neuro-cognitive outcome were obtained using linear regression controlling for gender. the distribution of p values obtained for the regression coefficients is shown in figure 1; this shows that there are more p values ≤  <dig>  than would be expected by chance and thus suggests that some probes are significantly associated with the neuro-cognitive outcome.

a simulation exercise was undertaken by randomly permuting the outcome values across all participants with respect to the probe log ratio values for each regression and recalculating the regression coefficients and corresponding p values. figure  <dig> shows the p value distribution obtained; as expected there are no more p values ≤  <dig>  than would be expected by chance, resulting in a distribution similar to a uniform distribution.

when the associations between the probe log ratio values and a continuous body composition outcome were assessed using linear regression, the distribution of p values shown in figure  <dig> was obtained; fewer p values ≤  <dig>  were obtained than would be expected by chance. the distribution of p values in figure  <dig> is unexpected; if there were no association between any of the probes and the outcome, each p value would be equally likely to occur and a distribution similar to figure  <dig> would be obtained. in the few occasions in published literature that a distribution similar to figure  <dig> has been reported  <cit>  this was thought to be due to technical issues concerned with imperfect normalisation between plates or cross-hybridisation in the array. neither of these potential explanations is likely for our results, as one outcome produced the expected distribution of p values  and a second outcome analysed in relation to the same probe log ratio values produced the unexpected p value distribution in figure  <dig>  the distribution of p values obtained from regressions based on chromosomes  <dig> to  <dig>  x and y with the neuro-cognitive and body composition outcomes were very similar to figures  <dig> and  <dig> respectively. therefore in the interests of clarity and brevity we have only reported on the analysis of chromosomes  <dig> to  <dig> 

in response to an anonymous reviewer we considered whether correlation of log ratio values between probes located in the promoter region of the same gene could be affecting the distribution of p values. the median number of probes in the promoter region of the genes was found to be  <dig>  with a lower quartile of  <dig> and an upper quartile of  <dig>  the  <dig>  probes are located in or around  <dig>  genes  on chromosomes  <dig> to  <dig>  we therefore took a random sample of 4% of the p values for each outcome so that adjacent probes in the same gene are unlikely to be selected. as we observed a distribution of p values for these 4% datasets similar to figure  <dig> for the neuro-cognitive outcome and similar to figure  <dig> for the body composition outcome, we conclude that correlation between probes located in the same promoter region is unlikely to affect the shape of the p value distribution.

we hypothesised that the reason that fewer p values ≤  <dig>  were being obtained than would be expected by chance could be due to violation of assumptions for the statistical test or procedure used . therefore a thorough investigation was carried out to check regression assumptions for a selection of probes. scatter plots were used to check the assumption of a linear relationship between outcome and predictor variables. plots of the residuals from the regressions  were checked for obvious deviations from a normal distribution using a probability-probability  plot and for heteroskedasticity . for the probes investigated there was no obvious non-linearity between probe log ratio value and outcome, and the p-p plots did not show extreme deviation from normality. however when the residuals were plotted against predicted values for a selection of probes several of the plots showed evidence for heteroskedasticity; figure  <dig> shows one of these plots, in which the regression residuals increased with increasing predicted values , reflecting heteroskedasticity.

it was therefore decided to test the residuals from all  <dig>  regressions with the body composition outcome for heteroskedasticity using the cook-weisberg test, a standard statistical test  <cit>  implemented in a commercial statistical software package  <cit>  . this showed that  <dig> %  of the regressions for the body composition outcome possessed significant heteroskedasticity. in comparison the  <dig>  regressions with the neuro-cognitive outcome were also tested for heteroskedasticity and only  <dig> %  of these possessed significant heteroskedasticity. we therefore concluded that the source of the heteroskedasticity must be due to differences in the measured phenotypes and undertook investigations accordingly. the neuro-cognitive phenotype was negatively skewed  and the body composition phenotype was positively skewed . although this is not a significant difference it may still contribute to heteroskedasticity in the regressions. a log transformation of the body composition phenotype to counteract skewness was not observed to rectify heteroskedasticity on the residual plots. a possibly more important difference between the phenotypes is that the body composition phenotype was found to contain an outlier  whereas the neuro-cognitive outcome does not contain any outliers. the presence of outliers is known to cause heteroskedasticity, especially when the sample size is small  <cit>  and therefore we believe that this is the most likely source of the heteroskedasticity. we tested this by removing the outlier, rerunning all  <dig>  regressions and retesting for heteroskedasticity. we observed that the percentage of heteroskedastic regressions dropped from  <dig> % to  <dig> % and therefore we conclude that this outlier significantly contributed to heteroskedasticity in the regressions. the validity of this outlier was carefully checked and it was thought to be a genuinely large value . we therefore did not consider it statistically appropriate to exclude this outlier from the analysis.

heteroskedasticity can be accommodated in a regression model using a heteroskedasticity–consistent covariance matrix estimator  <cit>  to calculate standard errors of regression coefficients that are robust to heteroskedasticity. this can be easily incorporated into the calculation of standard errors of regression coefficients using commercial software packages . p values for regression coefficients are calculated using the estimates of regression coefficients and associated standard errors. new p values were therefore calculated in a heteroskedasticity-consistent  manner for the body composition outcome and the distribution of these p values is shown in figure  <dig> 

the p value distribution in figure  <dig> indicates that a number of probes are associated with the outcome of interest as there are more p values ≤  <dig>  than would be expected by chance. thus the robust estimator for the standard error of the regression coefficients leads to an acceptable distribution of p values and enables inference about which probes are likely to be significantly associated with the outcome of interest.

in order to aid interpretation of these significant associations an anonymous reviewer helpfully suggested that we calculate false discovery rates for our results. we therefore calculated q values and hence false discovery rates using the q-value software of dabney and storey  <cit> . for the neuro-cognitive phenotype pi  <dig>  =  <dig> . p values ≤  <dig>  had a false discovery rate of  <dig> % and p values of ≤  <dig>  had a false discovery rate of  <dig> %. for the body composition phenotype with p values calculated using robust estimates, pi 0 =  <dig> . p values ≤  <dig>  had a false discovery rate of  <dig> % and p values of ≤  <dig>  had a false discovery rate of  <dig> %. it was not appropriate to calculate q values using the classical regression p values for body composition as the required assumption of ‘null’ probes having a uniform distribution was not met.

we were also curious as to what happened to the original p values  that were ≤  <dig> , represented by the first bar  on figure  <dig>  after they had been re-estimated using robust standard errors. figure  <dig> shows that the majority of these p values are still ≤  <dig>  after re-estimation. it therefore follows that the majority of significant p values calculated using heteroskedasticity-consistent standard errors were not observed to be associated when classical regression estimates were used. this therefore reinforces the principle that if statistical assumptions are not met significant associations can be missed.

CONCLUSIONS
a literature search for non-uniform distributions of p values shows few citations  <cit>  and these both relate to statistical tests applied to expression results generated using affymetrix microarrays. huang et al.  <cit>  compare gene expression profiles of tumours in three groups of mice using an affymetrix mouse genechip array. when an anova was performed on the expression of around  <dig>  genes, a distribution of p values similar to figure  <dig> was obtained. however when a t-test was applied to  <dig> of these groups, a distribution of p values similar to figure  <dig> was obtained. the authors hypothesised that the reason for such a non-uniform distribution was due to excess biological similarity between some samples in the groups used for the t-test. this excess biological similarity was thought to be due to  <dig> pairs of samples being littermates of the same age and a further  <dig> pairs of samples were assayed at the same time. this resulted in the samples used for the t-test not being statistically independent. as such samples are not statistically independent this violates one of the main assumptions required for the t-test, namely that of independence i.e. observations between or within groups are not paired, dependent, correlated, or associated in any way  <cit> . thus huang et al. also observe that violation of statistical assumptions can result in an unexpected distribution of p values similar to figure  <dig> 

fodor et al.  <cit>  using human and mouse affymetrix genechip arrays, hypothesised that poorly characterised variance and normalisation strategy for a microarray can produce a non-uniform distribution of p values for null genes . the authors proposed the use of a cyber t-test which uses bayesian statistics to weight the variance of each individual gene with the variance of other genes on the array with similar intensities and also the use of an additional statistic-level normalisation to rectify the problem. they state that it is clear that one of the assumptions of the standard t-test has been violated to lead to the non-uniform distribution of p values. however if the assumptions of the t-test have not been met, a much simpler solution would be the use of non-parametric tests, such as the mann–whitney u test, which do not require an assumption of equal variance between genes.

fodor et al. also suggested other technical reasons why a p value distribution can be non-uniform such as cross-hybridisation . dabney and storey  <cit>  come to a similar conclusion when they attributed the non-uniform p value distribution of a particular analysis to errors in experimental design. this was contested by the authors  <cit>  who suggested that a non-uniform distribution of p values may be a common feature of data generated by microarray experiments. however in our data technical issues to do with the array are not thought to be a problem as we obtained a plausible distribution of p values for our neuro-cognitive outcome.

the statistical analysis of ‘omics data requires careful handling, especially in the choice of statistical test. it is imperative that the assumptions behind these tests are carefully examined and any violations rectified if possible, or a more appropriate statistical test chosen  if meaningful results are to be obtained.

