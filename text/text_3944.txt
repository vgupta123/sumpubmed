BACKGROUND
cytotoxic lymphocytes  is a collective term for natural killer  and cytotoxic t lymphocytes . as the name suggests, these cells are cytotoxic towards virally infected, neoplastic or foreign cells. the two major mechanisms they use to elicit apoptosis in target cells involve  cell surface death receptors and their ligands  and  the granule-exocytosis pathway  <cit> . the latter involves the targeted secretion of specialised secretory lysosomes  from cls into the immunological synapse, a cleft formed at the site of cl-target cell contact  <cit> . the granules contain the granzyme family of serine proteases, effectors that cleave cytoplasmic proteins to induce apoptosis, and perforin, a membrane pore forming protein that is required for entry of the granzymes into target cells  <cit> .

ctl form part of the adaptive immune system in all jawed vertebrates but not in earlier chordates  <cit> . the lamprey, a jawless vertebrate, has an unconventional adaptive immune system which does not use the major histocompatibility complex  or t cell receptor  recognition system, but a more primitive leucine rich repeat-containing antigen receptor  <cit> . this species appears to have ctl-like leukocytes but whether they are armed with granule mediated cytotoxic machinery is unknown. nk cells, by contrast, are more difficult to define than ctl, but appear to have evolved earlier. there is evidence for cells with nk properties in the tunicate botryllus schlosseri, and the ciona intestinalis genome includes homologs of some nk cell receptors  <cit> . more basic cytotoxic nk-like cells have been described in earlier divergent invertebrates such as earthworms  <cit> . how similar these cells are to conventional mammalian nks, including their mechanisms of killing, remains to be seen.

perforin  is essential and central to the granule-exocytosis pathway in mammals. effective cl induction of apoptosis requires both granzymes and perforin, although at high concentrations perforin alone can kill cells by causing necrosis, whereas granzymes are ineffective without perforin to translocate them into the target cell cytoplasm. this is highlighted by the human autosomal recessive disease familial hemophagocytic lymphohistiocytosis type  <dig> , caused by mutations in the perforin gene  <cit> . ctl from these patients cannot kill fas-deficient target cells and so do not have an active granule-exocytosis pathway  <cit> .

perforin forms circular pores in the plasma membrane of target cells by a mechanism involving at least three steps:  perforin monomers bind to the membrane via their c <dig> domains in a calcium dependent manner;  monomers polymerise into a ring, mediated in part by salt bridging between residues in adjacent n-terminal membrane attack complex/perforin  domains;  two clusters of α-helices within each macpf domain rearrange into anti-parallel β-strands that puncture and span the membrane, creating an aqueous pore  <cit> . the mechanism of  and the order of  and  are inferred from structural similarity to the well-studied cholesterol-dependent cytolysin family of proteins as well as experimental observations of the perforin pore  <cit> .

the macpf domain has been identified in  <dig> human proteins and is named after the six best characterised members found in the immune system: five of the terminal complement components  that form the membrane attack complex , and perforin  <cit> . the mac is formed when c5b, c <dig>  c <dig>  c <dig>  assemble on foreign cell membranes, which then recruits multiple c <dig> monomers to polymerise and insert into the membrane  <cit> . perforin has long been compared to c <dig> as they are both able to polymerise and insert into membranes and the pores formed look similar by transmission electron microscopy  <cit> .

the only other macpf domain-containing protein known to be involved in the human immune system is macrophage expressed gene  <dig> protein , produced by macrophages  <cit> . besides the macpf domain mpeg <dig> contains one or more additional domains with no identified relationship to known protein folds, and a c-terminal transmembrane anchor  <cit> . mpeg <dig> is an ancient gene with homologs in species from one of the earliest metazoan lineages, the phylum porifera , amphimedon queenslandica and suberites domuncula <cit> . the homolog from s. domuncula is the best studied mpeg <dig> gene and is part of an ancient toll-like receptor pathway that is upregulated by lipopolysaccharide  <cit> . this role in innate immunity, along with its expression in macrophages, has led to the hypothesis that mpeg <dig> clears phagocytosed gram-negative bacteria  <cit> . indeed, recent evidence shows that the isolated macpf domain from mpeg <dig> of the pacific oyster crassostrea gigas has anti-microbial activity against both gram-positive and gram-negative bacteria  <cit> .

here we trace the origins and evolution of the perforin gene to gain insight into the evolution of the granule-exocytosis pathway. using a variety of approaches including linked gene comparisons, blast searches and protein phylogenetic trees we have catalogued all of the available perforin homologs. these data suggest that the perforin-dependent granule-exocytosis pathway originated in jawed vertebrates , at around the same time as true ctls. in addition, we present evidence that mpeg <dig> is the precursor of perforin.

methods
identification of human perforin homologs
to search for perforin homologs, the human perforin protein sequence  was used to query genome and protein databases on ncbi and ensembl using both tblastn and blastp  <cit> . hits representing true perforin homologs were distinguished from other macpf domain-containing proteins/genes in two ways. firstly, full-length sequences were subjected to domain prediction in pfam, any sequences not possessing both a macpf domain and c <dig> domain were discarded. secondly, partial sequences without sufficient data to reasonably contain both domains were used to query the non-redundant protein database by blast, any sequences with top hits to proteins other than perforin were discarded. in some cases, annotated protein sequences in ensembl required amendment to fix non-canonical splice sites and obtain valid start and/or stop codons. a complete table of accessions used in this study is in additional file 1: table s <dig>  and a complete file of amended protein sequences used in this study is in additional file 2: figure s <dig> 

locus diagrams
genome scaffolds were viewed in ensembl and ncbi and redrawn for ease of comparison. orientation of genes were made relative to perforin, which was always represented in the positive orientation, except where it was necessary to be drawn in the negative orientation for comparison to other scaffolds in the figure.

assembly of ornithorhynchus anatinus contigs
we exported the contig sequences containing perforin genes and used these as queries with megablast on the trace archive  to search for end sequences of bac and fosmid clones. we used the paired ends of matching clones to query the reference genome sequence to find matching contigs and by comparing the orientation of the clone hits we could infer the orientation of the various contigs. we assembled ten previously disconnected contigs in one instance, and two contigs in another instance, shown in additional file 3: figure s <dig>  to search for genes on these contigs we viewed them in ensembl. we found annotated partial genes that matched adamts <dig> on some contigs, and where there were no annotated genes we searched for homologous protein sequences using tblastx and compiled these into a single protein sequence in the order suggested by our assembly.

protein sequence alignment and phylogenetic trees
fish perforin protein sequences were aligned using clustalw and manually edited to minimise gaps and align conserved structural elements in bioedit   <cit> . the alignment is available in additional file 4: figure s <dig>  the bayesian inference tree was constructed using mrbayes  with the wag amino acid substitution model, invariant sites and a gamma distribution  <cit> .  <dig>  generations were run with trees sampled every  <dig> generations and the final 50% majority rule tree was calculated after discarding the first 25% of trees as burnin. trees were displayed using figtree   <cit> .

to align the macpf domains of perforin, c <dig> and mpeg <dig>  domain boundaries were chosen based on three rounds of psi-blast using full-length murine mpeg <dig> as the probe, together with information of the perforin and c <dig> structures  <cit> . sequences truncated to the macpf boundaries were then aligned with clustalw, positions with gaps were removed and phylogenetic trees were constructed with mrbayes as above. the alignment  is available in additional file 5: figure s <dig>  phylogenetic trees have been deposited in treebase and can be accessed here: http://purl.org/phylo/treebase/phylows/study/tb2:s <dig> 

RESULTS
search criteria for perforin orthologs
to search for orthologs of human perforin we first examined and set defining criteria based on the human perforin protein, mrna transcript and gene locus . perforin contains a macpf, egf-like and c <dig> domain, and with the x-ray crystal structure of mouse perforin recently being solved, the domain boundaries have been clearly delineated  <cit> . the combination of a macpf and egf-like domain is seen in many macpf proteins, however, to date, the c <dig> domain is unique to perforin and thus was a key criterion for our ortholog searches. the perforin gene structure is also unique among human macpf family genes, none of which share perforin’s  <dig> exon,  <dig> intron splicing pattern. the first intron, located in the 5’ untranslated region  can only be tracked where expressed sequence tag  information is available. the other intron, found in the coding sequence , is conserved with identical phasing  in mammalian perforin orthologs. human perforin is a single copy gene located at q <dig>  on chromosome  <dig> and is flanked by the genes c10orf <dig>  adamts <dig> and kiaa <dig> .

conservation of the human perforin locus extends to the last common ancestor  of mammalia but not to earlier vertebrate lineages
we followed the synteny of this locus and found the position and orientation of these three genes was conserved throughout theria  . looking at more divergent vertebrates such at the reptile anolis carolinensis we observed that the position and orientation of the other genes of this locus were conserved but perforin was no longer present. a similar situation was evident in the bird gallus gallus and fish takifugu rubripes. the data available from assembled genomes thus points to the appearance of perforin at this locus some time between the last common ancestors  of amniota and theria. to investigate this we looked at the monotreme o. anatinus . using the human perforin protein sequence we used tblastn to query the platypus genome on ensembl and found multiple full length and partial matches including some that appeared to be pseudogenes. these were mostly on short contigs with no other genes present. given the importance of this question we assembled this region ourselves . using this approach we assembled  <dig> contigs  and could now search these for genes predicted to be linked to perforin. we identified protein fragments with similarity to adamts <dig> on all of the linked contigs . combining the protein fragments from these contigs in the order suggested by our assembly  and using blastp we found adamts <dig>  affirming the order of our de novo assembly. c10orf <dig> was also found on one of these linked contigs, further strengthening the match between the platypus and human loci . this indicates a new phylogenetic position for the appearance of the perforin gene at this locus, between the lca of amniota and mammalia .

perforin is present in gnathostomata but not earlier chordata, and many species have multiple perforin genes
as perforin is absent from this locus in earlier vertebrate lineages we subsequently changed our search strategy to using tblastn with the human perforin protein sequence to search the nucleotide databases in ncbi and ensembl and blastp to search the protein databases in ncbi. using this approach we found perforin genes in all species of bony vertebrate  with available data, with the exception of zebra finch . the only evidence of a perforin gene in earlier gnathostomata was a single est from leucoraja erinacea  which matched part of the human perforin protein by blastx. the only species from the class chondrichthyes with available genome resources, the elephant shark , does not show any evidence of a perforin gene but due to the low sequence coverage  we cannot conclude that it is absent. earlier chordates such as the tunicate c. intestinalis and lamprey  show no evidence of a perforin ortholog, nor do any earlier metazoa . this suggests that the perforin gene originated about  <dig> million years ago before the divergence of chondrichthyes and euteleostomi   <cit> .

tracing perforin linked genes through bony vertebrate lineages we created maps of perforin loci and inferred the locus configurations in various major lineages . this analysis shows that the perforin gene has undergone a striking degree of duplication and repositioning within vertebrate genomes, being found at no fewer than  <dig> distinct loci across various lineages, and more if individual fish species are considered. the most conserved locus is the stx1b locus, which emerged before the lca of euteleostomi, as it is found in both teleost fish and tetrapods . this locus is present in amphibians and reptiles but absent in birds and therian mammals. it is also present in platypus, where we again linked two contigs using the approach described above . the orientation of the o. anatinus perforin  <dig>  gene relative to stx <dig> is opposite to other examples of this locus but this may be a result of incorrect assembly rather than a true gene inversion as there are many gaps in this short contig. the second contig contains the fus gene, present at this locus in a. carolinensis which further confirms the arrangement of this locus in the platypus.

in figure  <dig> we have summarised the numbers of full length genes, apparent pseudogenes and partial genes present in the available bony vertebrate genomes. all therian mammals have a single perforin gene and no pseudogenes, with the exception of the hedgehog , which also has a full length pseudogene, and the hyrax  which also has a partial pseudogene. by contrast, most other lineages within euteleostomi have species with multiple perforin genes. birds appear to be an exception with evidence for only one perforin gene in each of chicken , turkey  and mallard duck  genomes, and the aforementioned exception of zebra finch . all sequenced teleost fish have at least three full length perforin genes and the frog xenopus tropicalis has the largest number of perforin genes at  <dig>  we investigated these cases of perforin gene duplication in more detail.

the lca of teleostei possessed multiple perforin genes
we compiled all the full length perforin protein sequences from the five available fish genome sequences  as well as nine sequences from cloning projects from five other fish species  giving a total of  <dig> full length fish perforin proteins  <cit> .

to examine the relationship between these proteins we constructed a phylogenetic tree . we expected that the clades formed would provide insight into the evolution of fish perforin paralogs. clades containing proteins from the same species would arise from species-specific duplications, and comprise recently derived paralogs. conversely, clades containing proteins from different species comprise orthologs arising during speciation. in the tree in figure  <dig> we see both types of clades formed, for example the sub-clade containing o. latipes perforin  <dig> ,  <dig> ,  <dig>  and  <dig>  is made up of recently derived paralogs, and the clade containing d. rerio perforin  <dig> , t. nigroviridis perforin  <dig> , t. rubripes perforin  <dig>  and c. auratus langsdorfii perforin  <dig> , which have arisen by speciation.

we also noted that each clade grouped genes found at syntenic loci. two clades, with genes at paqr <dig> and mpeg <dig> loci , have representatives in all fish genome data available, demonstrating that they were present in the lca of teleostei . others have representatives in only a few species, suggesting that they either arose via a later duplication or that they were present in the lca of teleostei but were subsequently lost in some lineages. we see evidence for both of these processes. for example  the myadml <dig> clade is present in t. rubripes and g. aculeatus but no other species, suggesting it was acquired in the percomorpha lineage and subsequently lost from t. nigroviridis and o. latipes; and  the stx1b clade is found in d. rerio, t. rubripes and t. nigroviridis as well as some tetrapods  but is lost from smegmamorpha.

there are also nine perforin sequences from fish species without genome assemblies on this tree . this allowed us to make predictions about the loci of these genes based on their clustering. of these, six fall in the paqr <dig> clade and one in the stx1b clade. c. auratus langsdorfii perforin  <dig>  clusters with a group of linked d. rerio perforins  at the s100v <dig> locus, a locus which we originally believed to be d. rerio specific but this additional evidence suggests that it may have originated earlier, possibly in the lca of the cyprinidae family. the other sequence, s. salar perforin  <dig>  does not make a strong cluster with any group and may represent a new locus, perhaps specific to the atlantic salmon.

we were interested to know about the expression of these multiple fish perforin genes. we cross-referenced our collection of perforin genes with available est data. in this way we found evidence that seventeen fish perforin genes are expressed in a wide range of tissues, and that more than one perforin gene is expressed in most species . looking at how these expressed genes clustered we noticed that while all major clades contained genes that were expressed in one or more species, only for members of the mpeg <dig> clade was expression evident in all species examined. it is tempting to speculate that this locus contains a highly - or widely - expressed perforin gene . conflicting with this is the fact that most of the manually cloned perforin genes fall within the paqr <dig> clade and none fall in the mpeg <dig> clade. in any case these findings raise the interesting question of why fish possess multiple perforin paralogs.

to further classify fish perforin genes we analysed their exon/intron patterns and phasing. where 5’ ests were available we noted an intron in the 5’utr, as seen in mammalian perforin genes . in stark contrast to mammalian and reptile perforin genes, many of the fish genes have gained between one and eight introns . these patterns are related but cannot be used to infer the descent of these paralogs as they indicate that both intron gain and loss has occurred. for example, the first intron of tru <dig>  is conserved in tni <dig>  but not tru <dig> , while the third intron of tru <dig>  is conserved in tru <dig>  but not tni <dig> , so we cannot deduce which intron was gained first. also, one of these introns must have been lost in the duplicated genes but we cannot determine which one. while there are many different exon/intron patterns, some genes still have the same, simple pattern as the mammalian and reptile perforin gene. this implies that the lca of euteleostomi had a perforin gene with this structure , and that some fish genes have subsequently acquired additional introns.

the additional perforin genes in x. tropicalis are recent, lineage specific duplications
the massive expansion of perforin genes in x. tropicalis intrigued us. as shown in figure  <dig>  nine of these are found on two scaffolds. both of these are likely to be stx1b loci, supported by upstream gene information in comparison to a. carolinensis, and both scaffolds finish shortly after perforin genes and are missing downstream sequence that would confirm this hypothesis. the remaining two are all found alone on small scaffolds with no linked genes to provide context.

to further assess the origin of these multiple genes we looked at their exon/intron patterns. all of the nine full length genes in x. tropicalis contain a second cds intron  in addition to the completely conserved phase  <dig> intron . this intron is specific to this species and demonstrates conclusively that these multiple perforin genes are a result of lineage specific duplications, occurring subsequent to intron gain. genome information from additional amphibians would allow us to narrow the timeframe of this event but at this stage we can only conclude that it occurred sometime after the divergence of amphibia and amniota. est evidence exists for two full length and one partial gene, again raising the question of why some species need many perforin genes when one is sufficient in mammals.

perforin most likely evolved from an mpeg1-like ancestor
while performing our locus analysis of fish perforin genes we discovered the gene mpeg <dig> is adjacent to perforin and transcribed in the same orientation at one locus in each fish genome . this is the only macpf family gene found in close proximity to perforin, and is apparent in the earliest lineage that has perforin genes . this indicates that perforin could have originated from a segmental duplication by uneven crossing-over in the region of the mpeg <dig> gene. we therefore looked at the exon/intron patterns for additional evidence. the single phase  <dig> cds intron in perforin is 100% conserved in perforin genes, and occurs in the region encoding the macpf domain. we anticipated that this would be conserved in another macpf gene, but no other genes we examined contain this intron; it is a unique and defining characteristic of perforin genes. instead we looked at the numbers of cds introns in vertebrate complement, perforin and mpeg <dig> genes. we summarised the cds intron numbers of these genes from d. rerio from ensembl and saw that mpeg <dig> and perforin have just one while all of the complement genes have at least  <dig> . this prompted us to examine the mpeg <dig> intron in more detail. all fish mpeg <dig> genes have this conserved intron, but tetrapod mpeg <dig> genes have no cds introns, and neither do earlier, invertebrate mpeg <dig> genes . we concluded that the mpeg <dig> gene has gained an intron in the teleostei lineage, but it exists as a continuous open reading frame in other lineages. this simpler configuration makes mpeg <dig> more likely than the complement genes to be the precursor of perforin. an alternate, more complicated explanation is that one of the complement components have lost multiple introns and/or given rise to perforin from a retrotransposed processed transcript.

athese genes have paralogs with an identical/similar number of introns.

to further examine the evolutionary relationship between perforin, mpeg <dig> and complement proteins we curated and aligned these protein sequences from human, mouse, lizard and fugu, and produced a phylogenetic tree. the terminal complement components and perforin all contain an egf-like domain after their macpf domain. while mpeg <dig> has a cysteine rich region in a similar position, this is not believed to be an egf-like domain  <cit> . we therefore restricted our alignment to the macpf domain, the boundaries of which were chosen based on psi-blast results and structural data and then aligned with clustalw. as shown in figure 7b, the branch lengths of the tree show that the macpf domain of perforin is more closely related to c <dig> than to mpeg <dig>  this is also true of trees where c <dig> is substituted for c <dig> .

considered together, the genomic and protein evidence suggests that an ancient mpeg <dig> gene underwent a local duplication to produce a common ancestor of perforin and c <dig> . this precursor retained the mpeg <dig> gene structure but eventually lost the transmembrane anchor and gained an egf-like domain. the precursor then duplicated to a distant locus. subsequently, the paralog linked to mpeg <dig> evolved into perforin by gaining the conserved intron and a c <dig> domain, explaining the linked mpeg <dig> and perforin genes evident in extant fish species. the other paralog gave rise to the c6-like genes, as seen in the early chordates c. intestinalis and branchiostoma floridae, hypothesised to be the common ancestors of c6- <dig>  <cit> . this involved acquiring multiple tsp domains and an ldlra domain, as well as at least  <dig> introns . the evolution of a c6-like gene must have been completed by the lca of chordata as species from multiple lineages possess this gene . the mpeg1/perforin locus has either been lost from the species c. intestinalisb. floridae and p. marinus, or is not covered by these genome projects . by the lca of gnathostomata, mpeg <dig>  perforin and c6- <dig> were all established and by the lca of tetrapoda mpeg <dig> and perforin were no longer linked genes .

discussion
perforin is a critical protein in the granule-exocytosis pathway of cls, therefore tracing the evolution of this gene yields insights into the evolution of the pathway itself . we have characterised all of the perforin genes from available databases and find many species with multiple perforin genes. classifying these duplicated genes led to the discovery of multiple gene duplication events in different lineages, and insights into the origins of perforin itself.

mpeg1: the precursor of perforin?
as no other proteins share the entire domain structure of perforin, the origin of the perforin gene is obscure. in terms of structure and function it has always been compared to c <dig> because this terminal complement component also polymerises and inserts into membranes, although unlike perforin it requires a primer  to initiate membrane binding. although the complement proteins appear to have descended from a common ancestral gene, a precursor of the perforin gene has not yet been identified  <cit> .

we suggest here that perforin originated from the ancient gene mpeg <dig> on the basis of similar gene structure and chromosomal co-location of these genes in ancient bony vertebrate lineages. it is more likely that perforin originated from mpeg <dig> than from any other extant macpf family member because no other genes encoding macpf domain-containing proteins share these genetic characteristics. however, given that the macpf domains of perforin and complement component c <dig> are more closely related than those of perforin and mpeg <dig>  it is likely that perforin and mpeg <dig> are separated by an intermediate with features of both perforin and a terminal complement component. at present no available genome data contains remnants of such a gene.

the origins of mpeg <dig> itself are presently obscure, but its presence as an intronless gene in one of the most ancient metazoan lineages , and absence in other eukaryotic kingdoms, coupled with the existence of macpf proteins in prokaryotes, suggests a mechanism of horizontal gene transfer from prokaryotes to early metazoans.

do birds possess functional perforin genes?
perforin genes appear in all available bony vertebrate genomes with the surprising exception of zebra finch . the presence of other genes of the granule-exocytosis pathway in zebra finch , as well as perforin’s absolute conservation in euteleostomi, predicts that any tetrapod without a perforin gene would be severely immunocompromised, yet there are no reports of zebra finches having such a defect. we therefore suggest that this species does indeed have a perforin gene but it has not yet been uncovered by sequencing projects. the turkey  perforin gene also appears to be affected by a sequencing error; the gene contains a frameshift caused by a single nucleotide deletion. ensembl corrects this by modelling a frameshift intron  to maintain the coding sequence, but the possibility remains that this perforin gene in turkey is a pseudogene, in which case the species would be immunocompromised unless a functional paralog has been missed. the best studied bird species, the chicken  has only a partial perforin gene sequence annotated, with a gap in the assembly where the remainder of the gene should be found. chicken perforin expression has been assessed in the context of marek’s disease, where mrna was shown by real time pcr to be upregulated in the spleens of infected chickens, although another study involving infectious bursal disease saw no upregulation in bursal mononuclear cells  <cit> . this suggests that at least one bird species has a functional perforin gene but ultimately more data, particularly est or biological data, is required to make firm conclusions about the perforin gene in birds.

multiple perforin genes for multiple functions?
it is well established that a whole-genome duplication occurred in the teleostei lineage, and that many genomic rearrangements are possible when reverting from a tetraploid to a diploid state  <cit> . duplications of genes functioning in the immune system have been noted before in teleost fish, for instance an expansion of the cc chemokine genes has been described  <cit> . however perforin is an extreme example with a single gene in the gnathostomata lca giving rise to nine in danio rerio. paralogs are likely to have arisen from the whole-genome duplication and from local and distal segmental duplications. multiple gene loss as well as intron gain and loss events have also occurred, highlighting the instability of the perforin gene in the teleost fish.

one of the most interesting questions that the duplicated fish perforin genes poses is why fish require so many, when in therian mammals a single gene is sufficient for the function of cytotoxic lymphocytes. simple explanations of this phenomenon are that perforin has evolved additional molecular functions in fish , and/or it has a broader tissue distribution and role or a more complex regulatory pattern than in mammals. for example, perforin is essentially restricted to two hematopoetic cell types in mammals  and is controlled by similar circuitry. in fish it may be present in three or more immune cell types, with each paralog being restricted to a particular type. alternatively, all perforin paralogs may be present in the same cell type, with each responding to distinct developmental or environmental signals. indeed one study characterizing perforin from c. auratus langsdorfii notes that only one of the three perforin genes cloned was up-regulated by allo-reactive stimulation as measured by real time pcr, suggesting that the other two are not important for ctl cytotoxicity  <cit> . however it has been shown in mice that the perforin protein can be translated on demand from a stored pool of mrna so increased mrna expression may not be required to increase levels of perforin protein  <cit> . nevertheless, the study by nakanishi and colleagues, as well a wealth of est data which we have mapped to our collection of perforin genes, demonstrates that multiple perforin genes per species are expressed at least at the mrna level. being present at distant loci, it is likely that these paralogs would be controlled by different regulatory elements, and therefore may have different tissue distribution. the role of these extra perforins will remain obscure until molecular and cellular studies examine their functions.

emergence of the perforin-mediated cytotoxic pathway
cell-mediated cytotoxicity has been described in many species but the mechanisms of killing are not well understood except in mammals. invertebrates can determine self-non-self and nk-like cells have been implicated in rejecting non-self cells  <cit> . in addition, a primitive form of adaptive immunity is present in the lamprey, a jawless vertebrate. this species possesses t cell-like lymphocytes that would be expected to kill target cells  <cit> . our data suggests that ancient cytotoxic cells from species earlier than gnathostomata are unlikely to have an active granule-exocytosis/perforin pathway, so invertebrate nk-like cells and lamprey ctl therefore must kill their targets in another fashion. this pathway seems to have arisen concurrently with the mhc-tcr antigen presentation system, suggesting primordial ctls possessed perforin, whereas nks acquired this cytotoxic machinery after their inception.

CONCLUSIONS
the pore-forming protein perforin is the only component that is absolutely required for the granule-exocytosis pathway that cytotoxic lymphocytes deploy to eliminate deleterious cells. the perforin gene is present in gnathostomata but not earlier species. perforin evolved from a duplication of the related gene mpeg <dig>  and shares a common ancestor with the terminal complement components. surprisingly, we find that most bony vertebrate species predating placental mammals have multiple perforin genes, of unknown function. these findings also indicate that cytotoxic cells from invertebrates and jawless vertebrates must use alternative proteins or pathways to kill their target cells.

abbreviations
mhc = major histocompatibility complex; tcr = t-cell receptor; mpeg <dig> = macrophage expressed gene 1; cl = cytotoxic lymphocyte; nk = natural kill cell; ctl = cytotoxic t lymphocyte; fhl <dig> = familial hemophagocytic lymphohistiocytosis type 2; mac = membrane attack complex; macpf = membrane attack complex/perforin; c <dig> = complement component 6; egf-like = epidermal growth factor-like; utr = untranslated region; est = expressed sequence tag; cds = coding sequence; lca = last common ancestor.

competing interests
the authors declare that they have no competing interest.

authors’ contributions
med identified homologs, performed locus analyses, constructed sequence alignments and phylogenetic trees, helped design the study and drafted the manuscript. mad constructed and interpreted sequence alignments and phylogenetic trees and helped conceive the evolutionary model. jcw helped conceive the evolutionary model and helped draft the manuscript. jat helped draft the manuscript. pib conceived and designed the study, interpreted results and drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file  <dig> 
table s <dig>  list of accessions used in this study.

click here for file

 additional file  <dig> 
figure s <dig>  manually annotated perforin protein sequences used in this study.

click here for file

 additional file  <dig> 
figure s <dig>  platypus contig assembly by trace archive blast. contigs are shown in blue with arrows indicating their relative 5’–3’ orientation. linking bacs and fosmid clones are shown in grey and white respectively, with red regions showing where clone end sequences match contigs. genes are shown as arrowheads with gene symbols above.

click here for file

 additional file  <dig> 
figure s <dig>  alignment of fish perforin proteins for figure5tree.

click here for file

 additional file  <dig> 
figure s <dig>  perforin, mpeg <dig> and c <dig> alignment for figure7tree.

click here for file

 acknowledgements
we thank b.t. porebski and the orchard supercomputer at monash university for computational resources and assistance. this work was supported by the national health and medical research council of australia and the australian research council. m.e.d. is a recipient of the australian postgraduate award, m.a.d. is an nhmrc career development fellow, j.c.w. is an arc federation fellow and honorary nhmrc principal research fellow.
