BACKGROUND
most multicellular organisms have two copies of chromosomes . an allele refers to one of the different arrangements of nucleus acids in the same genetic location  on homologous chromosomes. every individual has two alleles in one locus, making up the genotype, either homozygous or heterozygous. a single nucleotide polymorphism  is a genetic variation where one single nucleotide differs between the two alleles in members of a population or paired chromosomes. in humans, although most snps have no effect on health, some of them have been shown to affect how an individual develops diseases and responds to drug treatments. as a result, a great deal of contemporary biomedical research focuses on investigating the association between snps and phenotypes , known as genome-wide association study .

since the release of the first commercial snp array in  <dig> by affymetrix , snp arrays have been intensively used in gwas. in the last decade, these applications have resulted in the identification of a large number of common genetic variants that are associated with different diseases. today, while next-generation sequencing  has greatly changed the landscape of genetic research due to the rapid drop in cost, snp array technique is still more economical to use and has many other advantages, such as less labor intensive sample preparation and being more conducive to working for a large number of samples.

accurate snp genotyping is one of the important factors of a successful gwas. this has motivated researchers, in both academia and industry, to develop sophisticated algorithms to improve genotyping accuracy.

for technical supports, affymetrix developed the accompanying genotyping software - modified partitioning around medoids , after the release of their first generation genechip array, and then the dynamic model  algorithm for the genechip 100 k array. these two arrays have similar designs although the 100 k arrays include more snps. for each array, every snp is interrogated by a number of probe quartets, each of which is composed of a 25-base-pair perfect match oligonucleotide probe  and a mismatch probe  base of the pm with its watson-crick complement) for alleles a and b separately. to make a genotype call for a snp, one can use allelic intensities detected by the pm probe as foreground and those by the mm probe as background to calculate the likelihood for each possible genotype , and then make the genotyping call, based on the highest likelihood  <cit> . for example, if the likelihood for genotype aa is the largest, we assign “aa” as the genotype for the snp. however, since both mapm and dm were designed to genotype one snp on one chip  at a time, their overall genotyping call accuracies are not satisfactory. to improve genotyping accuracy, many other methods have been proposed, including the robust linear model with mahalanobis distance classifier   <cit> . specifically, for each snp, by using pm probes only , rlmm includes all allelic intensities across multiple chips in a model to estimate the possible genotype clusters. in this way, the between-chip-level variations can be well accommodated. subsequently, an improved model, named brlmm  <cit> , was proposed by adding a bayesian step to rlmm. brlmm utilizes the genotyping calls from dm as the initial “seed” genotypes to determine the parameters of the bayesian prior distributions, and adopts the multi-array model approach to enhance the accuracy of genotype cluster estimates. note that the link between brlmm and dm limits the application of brlmm to newer generations of arrays, such as snp array  <dig> / <dig> , because these new arrays do not have mm probes that are employed by dm to make the initial “seed” genotype calls. to overcome this limitation, brlmm-p was introduced, which estimates initial “seed” genotypes directly from the clustering properties of the pm probes  <cit> . however, this data-driven approach requires a rigorous performance standard for snp screening. as a result, for 500 k array, only  <dig> , out of  <dig> , snps are considered to have high quality brlmm-p calls.

the birdsuite software, introduced by the broad institute in collaboration with affymetrix, was initially developed for genotyping snp  <dig>  array data. the birdseed, one component of the software, like all other software mentioned above, was developed exclusively for genotyping diploid genomic regions that do not have cnas   <cit> , and copy number variations . the birdseye software, another component of birdsuite, although being able to detect rare cnvs and genotype snps in cnv regions, was not designed to make genotype calls for samples with cnas. this is generally because of issues such as random occurrence of cnas along the genome and contamination of normal tissues in tumor samples  <cit> .

like affymetrix, illumina has its own genotyping software, called gencall and implemented within the beadstudio, to genotype snps on the beadchip arrays. similar to rlmm and brlmm-p, gencall applies a multi-array approach and can make genotype calls with or without using a reference dataset, depending on the sample size.

in addition, other methods are also available for genotyping affymetrix/illumina arrays. these algorithms differ in their aims. for example, corrected robust model with maximum likelihood distance   <cit>  focused on reducing across-lab variations through improving data pre-processing. sniper-high density   <cit>  was designed to obtain high accuracy for highly informative  snps. chiamo  <cit>  and alchemy  <cit>  were especially useful for calling small batch sizes and highly homozygous populations. algorithms designed for illumina arrays include genosnp  <cit>  for improved calling on rare variants; m <dig> <cit> , which is based on modified mixed model; and opticall  <cit>  for more accurately genotyping rare, low-frequency and common variants.

although the majority of these algorithms showed some success in improving the genotyping accuracy, they were initially developed for genotyping samples without cnas. we comment that genocn  <cit>  could genotype samples with cnas, but it adopted a one chip at a time approach, and was designed mainly for illumina array data.

on the other hand, many genetic diseases  are associated with cnas, and lots of methodologies have been developed to correctly detect cnas  <cit> . by each of these methods, copy number status  can be obtained for every snp in a sample. generally, cna calls for tumor samples with paired normal samples can have a high level of accuracy. if there are no paired normal samples, one can still be able to obtain reliable cna calls by using a generic normal as control  <cit> . note that since cnas are somatic alterations, it is difficult to predict where on the chromosome cnas occur. meanwhile, in the sample preparing step, it is usually hard to avoid normal tissue contamination. most cluster-based genotyping algorithms could run into the problem of misclassification at the regions of cnas because cnas substantially altered the number of a and b alleles, and thus, the a and b allele log-intensities from the array. we recommend incorporating cna status into the cluster regression model to adjust for the effect of cnas. to do so, both high quality copy number calls and stringent sample screening are necessary.

in this paper, we propose a bayesian cluster regression based genotyping  approach to genotype samples with cnas. this is motivated by the facts that cancer tissues often have large regions of genetic structural alterations such as cnas  <cit> , and that researchers have been interested in genotyping snps from such samples.

the setup of the paper is as follows. in section methods, we will describe the steps of bcrgt. in section results and discussion, we use hapmap  genotype calls as a gold standard to calculate the concordance rates, the probability that a pair of genotyping results have a certain genotype, given that one of the pair has such a genotype, in order to evaluate the performance of bcrgt for samples without cnas. furthermore, we will apply bcrgt to samples with cnas, to illustrate the improvement that bcrgt makes in genotyping cna regions comparing over brlmm. at the end of the paper, we will briefly discuss the ideal situation for using bcrgt and the limitations of this method.

methods
there are several widely used affymetrix snp array platforms, including the genome-wide human snp array  <dig> / <dig> , genechip® mapping 10 k/100 k/500 k array. in this paper, we will focus on the affymetrix genechip® mapping 500 k array. the array set consis ts of nsp and sty arrays for nsp i and sty i restriction enzyme digested genomes, respectively. each nsp  array has the capacity to interrogate about  <dig>  snps, with, on average,  <dig> to  <dig> pairs of allele-specific intensity measurements per snp. in our analysis, for each snp, these  <dig> to  <dig> measurements are averaged for both a and b alleles, and the averaged values will be used as the input in bcrgt. note that although mapping 500 k array has both pm and mm probes for each allele, bcrgt utilizes only pm probe intensities, and thus, can be directly applied to newer generations of affymetrix arrays.

quantile normalization
snp-specific signal intensity distributions are different not only across snps but also across samples/labs/studies. snp array genotyping is usually carried out array-wisely, one snp at a time. thus, a successful genotyping algorithm can benefit from an appropriate normalization step to adjust for the undesirable between-array experimental/biological variations. quantile normalization  is one of the widely used normalization methods. by assuming that the distributions of dna abundances are nearly the same across all samples, qn transforms the raw intensities to the corresponding quantile’s value. although qn has many good properties when all the samples for genotyping do not have cnas, it does not perform well in normalizing samples with cnas  <cit> . therefore, for simplicity we recommend applying qn on samples without cnas, but not doing so for samples with cnas.

bayesian cluster regression
let xij ∈ , yij ∈  denote the log-intensities of a, b alleles of the jth snp of the ith subject. a successful genotyping approach should depend on the relative relationship between a and b alleles, not on the absolute values of a and b alleles. thus, we will make genotype calls based on such allelic relationship, and arbitrarily choose either a or b allelic log-intensity as the predictor so that the linear relationship between a and b alleles can be investigated via a traditional linear regression if they come from the same population . we further assume, for simplification, that the allelic log-intensities of adjacent snps are independent of each other. the rationale underlying this assumption is that the physical distance between two consecutive snps is very often at least hundreds of base pairs apart. for notational convenience, we will drop the subscript j because genotyping call is made independently for each snp in the proposed algorithm. in addition, for every snp, both a and b allelic log-intensities are centralized at the median of the a allele log-intensities.

traditional cluster regression
consider the case of three clusters, and assume that the paired observations  come from one of the three unknown component populations , that is, ci = k with probability πk, where k ∈ { <dig>   <dig>  3}. let x be a matrix with the first column being an all-ones vector, and the second column consisting of the corresponding x values from the cluster k. for a given cluster ci = k, the relationship between x and y can be expressed in the following model with parameter βk,

 yci=k=xci=kβk+ξk, 

where ci ~ multinomial  and the error vector ξk ~ n  <cit> . note that the three clusters represent three different genotypes, aa, ab, bb, and that each of the three linear regression models in the above equation is fitted for one of the three genotypes. a nocall can be made if none of the probability of aa, ab or bb is above a certain threshold, such as  <dig> %. we comment that setting such a threshold can improve the overall genotyping accuracy, but, as a tradeoff, the overall call rate  drops.

bayesian cluster regression
despite the fact that cluster regression has many good properties in classifying samples into different groups at the individual snp level, further improvement can be made by incorporating additional information from all snps across the samples. adding a bayesian step would be a good choice for this purpose.

for every snp, cluster regression partitions all samples into “aa”, “bb” and “ab” genotype clusters. however, problems might arise if one or even two genotypes do not exist for all samples, thus misclassification is very likely to occur. bcrgt adds a bayesian layer to pre-define the distribution of each of the three clusters based on the intercept and slope of each cluster, which are estimated from the a and b allele log-intensities of a large sample of all snps and all samples. then, if the genotypes of a snp are the same for all the samples, applying a prior distribution based on these estimates will improve the accuracy in estimating the parameters of the posterior distributions.

one of the key issues in a bayesian model is to derive the posterior distribution. in order to have a closed-form posterior distribution, the commonly used prior for  is a normal-inverse-gamma distribution of the form p = pp with the first part being a multivariate normal distribution and the second part an inverse-gamma distribution  <cit> . note that the posterior distribution is also a normal-inverse-gamma distribution. in this paper, for model and computational simplicity, we will use the frequentist method  to estimate σ <dig>  instead of imposing a prior on σ <dig>  by doing so, we impose that the prior is reduced to a multivariate normal distribution n, where the elements βk <dig> prior and βk <dig> prior of the two-dimensional mean vector βprior represent the expected values of the distributions of the intercept and slope for the cluster k, respectively, and σ2v is a diagonal matrix with the diagonal elements being the corresponding variances. the expectation of the posterior distribution can be easily derived as β^bayes=v-1+x'x-1v-1βprior+x'y . we comment that higher-order polynomial terms may be added to the model in order to better accommodate the samples with less stringent quality control. however, since minor changes in higher-order terms usually have substantial effects on model fitting, in order to make sure that the prior distributions of the higher order terms do not have dominating effects on the posterior distribution, a very strong prior favoring the null hypothesis, i.e., higher order terms do not contribute to the model, should be used. in practice, we observed that, for the samples we have tested, adding a quadratic term to the simple linear model could only result in a negligible difference in the fitting results. thus, for the model parsimony reason, we only considered a simple linear model.

the expectation-maximization  algorithm  <cit>  was used to estimate β. specifically, the expectation step was to find the expectation of q, σ2), namely e, based on data; and the maximization step was to update  with , σ2) that maximizes q, σ2) . the em algorithm was converged/stopped when the difference of two consecutive estimates of the parameters was smaller than a pre-set small value or after  <dig> iterations. the parameter values from the last iteration were taken as the final estimates.

the values of the parameters of the prior distributions
setting parameter values for the prior distributions is a critical step in a successful bayesian cluster regression. we describe in the next subsections how to setup these values.

the expectations of the intercepts and slopes of the prior distributions
we followed the approach in  <cit>  to take advantage of the information obtained from the data. specifically, we randomly selected a subset of all the paired a and b allelic log-intensities across samples. the size of the subset is quite arbitrary, for example,  <dig>  to  <dig> . the three clusters representing aa, ab and bb genotypes are clearly separated ) and can be roughly classified by most of cluster analysis methods proposed in literature. our approach is a computationally simple alternative. we calculated the first difference statistics  <cit> , diff =  - , where  is log-ratio of the a and b allelic signal intensities and t is the order, and searched by a moving average  approach for the two maximum values, between the 25th and 50th percentiles and between the 50th and 75th percentiles, respectively. the numbers of observations separated by the two maximum values are roughly equal to the numbers of observations with aa, ab and bb genotypes respectively ). after identifying these three clusters, we fitted a simple linear regression for each cluster and used the estimated model parameters as the intercept and slope of the prior distribution for the corresponding cluster. we comment that, 1) in practice, although the estimates of the slopes are somewhat different from  <dig> , it usually works well to use  <dig> for all slopes for simplification purpose; 2) the proportion of observations with ab genotype is lower than those of observations with aa/bb genotypes, and this can be conveniently adjusted in the em algorithm by putting different weights for ab and aa/bb genotypes.

the variances of the intercepts and slopes of the prior distributions
it is well known that the posterior mean of the parameter vector in bayesian linear regression can be expressed in terms of the least square estimate and the prior mean. to obtain the variance of the least square estimate, we chose  <dig> snps that have only one genotype , and calculated the average of the  <dig> variances of the least square estimates of the slope. we then used one third of such an average value as the variance of the prior distribution for the slope to ensure that the prior information on the slope plays a substantial role. as a justification, we replaced one third by a decreasing sequence: one fifth, one tenth of the average value, and observed very small differences in genotype calling results . similarly, we set the variance of the prior distribution for the intercept to be roughly equal to three times of that estimated from the data so that the intercepts are more influenced by the data.

meanwhile, the model in maximization step is defined as

 yci=k=βk0+xci=kβk1+ξk,wherek= <dig> , <dig> andξ1=ξ3=2ξ <dig>  

the error term for the heterozygous ab cluster was set smaller than those of the homozygous clusters in order to adjust for the difference in the spreads of the heterozygous and homozygous observations . the adjustment factor could be obtained empirically from the sample data described in section genotyping the samples without cnas by bcrgt. here we use  for convenience.

for demonstration purposes, we applied bcrgt to a good-quality snp with no missing genotypes and presented the results in figure  <dig>  the effect of the priors can be seen from two observations with bb genotype . the prediction line would go through both dots if no prior were imposed. with bcrgt, the slope for bb genotype is very close to  <dig> . this example shows how the prior information on slope works. and we expect that the true slope for bb genotype would be approximately  <dig> if more samples were observed. in addition, the heterozygous cluster  has less spread than the cluster representing aa genotype , which concurs with the pattern in figure  <dig>  we also demonstrated in additional file 1: figure s <dig> that bcrgt performed well if one or two genotypes were missing.

incorporating the cna variable into the model
comparing with the commonly used genotyping methods , bcrgt has the advantage of conveniently adding extra covariates in the model. next, we will explain how to utilize this advantage in incorporating copy number information in bcrgt. the reason for adding this information is given in section background.

once the cna calls are obtained, we include cna as a covariate in the regression, and the maximization step will be to find the maximum likelihood estimators for the following new regression model. the main rationales behind this model are that the relationship between the log-intensities of a, b alleles within a cluster  is approximately linear , and that any allele gain/loss will move the corresponding observation vertically.

 yci=k=βk0+xci=kβk1+cnci=kβkcn+ξk,wherek= <dig> , <dig> andcnisdefinedascn= <dig> ifnocopynumberchange,cn=‒constant,ifaalleleloss,cn=constant,ifballeleloss,cn=‒constant/ <dig> ifballelegain,cn=constant/ <dig> ifaallelegain,withxci=kandyci=kbeingthelog‒intensitiesofaandballeles,respectively. 

note that, for samples with copy number loss, if the log-intensity of a allele is greater than that of b allele, we define them as b allele loss; otherwise, we define them as a allele loss. a or b allele gain can be defined similarly for the samples with copy number gain. in em algorithm, we treated cn as a fixed factor for computational simplification. also, for copy number gain based on empirical evaluation, the input value for cn is five times smaller than that for copy number loss in order to adjust for 1) the saturation effect – the maximal signal intensity is limited by the amount of corresponding probes on the array, so that increases in copy number might not be proportionally reflected in signal intensity; and 2) the difference in absolute change in signal intensity between copy number gain and loss . in addition, we used the larger of the absolute values of the  <dig>  and  <dig>  percentiles of the differences of a and b allele log-intensities as the input value for “constant” in the above model. we comment that, because we choose a weak prior on βkcn, these pre-set values do not significantly affect genotyping results unless they are completely out of range.

RESULTS
genotyping the samples without cnas by bcrgt
in order to evaluate the performance of our proposed method, a decent number of samples with known genotypes are needed. the international hapmap consortium has made such samples available – the phase  <dig> of hapmap data release provides reference calls for approximately 70% of the snps on the genechip® human mapping 500 k array set for a collection of  <dig> samples, and the phase  <dig> release provides more reference calls. these calls were generated from the consent of results from various technologies and sources, and are generally considered as a gold standard, although it is reasonable to assume that the genotype calls in hapmap still have some rare errors.

the mapping 500 k array data for all  <dig> hapmap samples were downloaded from the ncbi’s gene expression omnibus website . in the comparison, we focused on chromosome  <dig> to demonstrate the performance of bcrgt, but it is reasonable to assume that results from other autosomal chromosomes would be very similar.

genotype calls for over 93% of snps on chromosome  <dig> are available from the hapmap genotype data . concordance rates, the percentage of agreement between hapmap calls and bcrgt calls, for different datasets are presented in table  <dig>  there are two sections in this table. the upper section  displays genotyping concordance rates using the bcrgt without any model training, that is, we used generic prior distributions for every snp. note that in this upper section we genotyped different numbers of samples  in order to evaluate the effect of sample size on concordance rate. also, for datasets a to d, h, each dataset has two rows corresponding to two different call rates. the lower section  displays the concordance rates using bcrgt with a model training step. we randomly split the whole hapmap  <dig> samples into two groups of equal size , and used one group as the training set to obtain parameter estimates  of the prior distributions for each snp. then we employed these prior distributions in bcrgt, and performed genotyping on different subsets of samples  randomly selected from the other group. we expected that, by including the training step, much higher concordance rates with hapmap genotype calls can be achieved.

for dataset a, the overall concordance rates between hapmap and bcrgt genotypes are  <dig> % and  <dig> % with overall calling rates at  <dig> % and 100%, respectively. we can see that the lower call rate is associated with a higher concordance rate because snps that are difficult to call were treated as nocall, and this reduced the probability of making an error. for datasets b, c and d, each having  <dig> samples randomly selected from the hapmap samples, the average overall concordance rates are  <dig> % and  <dig> % with average calling rates at  <dig> % and 100%, respectively. with further reduced size of  <dig>  datasets e, f and g have the average overall concordance rate of above  <dig> % with an average overall call rate of  <dig> %. we observed that the concordance rate declines as the dataset becomes smaller. note that this is an empirical conclusion from several estimations. it would be interesting to rigorously assess the statistical relationship between sample size and concordance rate in the future study.

the percentages in the lower section of table  <dig> indicate that adding the training step can greatly improve genotyping accuracy. for example, the overall concordance rates  reach  <dig> % and  <dig> % with overall call rates at 100% and  <dig> %, respectively. for a further reduced sample size of  <dig>  we could still have an overall concordance rate at about  <dig> % . in table  <dig>  we also list concordance rates for homozygous and heterozygous calls separately, which are generally close to the overall concordance rates.

we could not provide the concordance rate for dataset of size greater than  <dig> due to the sample size limitation in the hapmap database. interested users are encouraged to apply the strategy described in  <cit>  for genotyping larger datasets.

our training step is different from the commonly used approach in that the latter would use the whole set of the  <dig> samples from one laboratory to train the model, and then perform genotyping on another independent dataset from a different laboratory . we comment that, although not taking advantage of the whole hapmap samples in the training step, our method can avoid the possibility of inflating the measures of performance because it does not use the same biological samples in both the training and validating sets. note that if the objective is to genotype samples other than those participated in the hapmap study, we will use all the  <dig> samples as the training set.

genotyping samples with cnas by bcrgt
genotyping samples with cnas is more challenging, and the validation of genotypes for such samples is currently difficult due to the lack of a gold standard such as the hapmap genotype data. therefore, in this subsection, we will provide some individual snp level as well as individual sample level examples to illustrate how bcrgt performs. the comparisons, regarding heterozygous call rate and genotyping error rate, between genotype calls made by bcrgt and brlmm, will be presented at the end of this subsection.

the data, downloaded from geo , were generated for the study of myeloma, a disease associated with cnas  <cit> . there are  <dig> paired myeloma samples in the dataset. the rationales of using these samples include the known existence of cnas in the tumor samples and the availability of the paired normal samples from the same patients. we comment that bcrgt does not require paired normal samples in genotype calling, but it could achieve higher accuracy in genotyping from improved copy number assignment if paired normal samples are available . the genotype calls for the paired normal samples were used to evaluate the performance of the genotype calls for the tumor samples. note that, since tumor samples can have normal cell contamination, we excluded samples with choppy noises or poor quality, as well as those having less than 1% cnas, in order to obtain reliable genotype calls. thus, only  <dig> samples were genotyped by bcrgt.

as indicated by the three clusters in figure  <dig>  if there are no cnas, samples with the same genotype, aa or ab or bb, tend to cluster together in the scattered plot of a versus b allele log-intensities. this is not the case if there are cnas in some tumor samples. figure  <dig> shows that it is difficult to call the observations pointed by the black and red arrows without knowing the copy number status. note that brlmm has no call on the observation pointed by the black arrow, and a call of ab for the observation pointed by the red arrow ). this is not consistent with the copy number status because the copy number call plot ) implies that both tumor samples have copy number loss at this snp locus, and thus, they cannot be heterozygous. as a comparison, bcrgt is able to call both correctly as aa/a ). since paired normal samples are available, we can use the genotypes of them as references ), to assess how copy number change affects genotype callings . furthermore, we can see that among the three bb observations ), one does not have copy number loss, while the other two do. the prediction line ) provides a good fit even though there are only three observations with the bb genotype.

at the individual sample level, copy number status can be visualized on a scatter plot. we illustrate this with a sample that has multiple large segments of copy number losses . the copy number analysis suggested that chromosomes  <dig>   <dig>   <dig>   <dig>   <dig>  12– <dig>  16– <dig>   <dig> and  <dig> have copy number losses  in  <cit> ). thus, we expect no heterozygous calls because only one copy of chromosome exists on those chromosomes. the genotype calls by bcrgt and brlmm are presented in figure  <dig>  figure  <dig> and  are snps with ab genotypes called by bcrgt and brlmm, respectively, while figure 4b) and  are snps with either aa or bb genotypes called by bcrgt and brlmm separately. it is clear that on chromosomes with copy number loss, bcrgt called much less ab genotypes than brlmm did. note that some regions of chromosomes  <dig> and  <dig> are minor clone  copy number losses, but bcrgt still performs better than brlmm on these regions. there are on average more than 4% heterozygous genotypes called by brlmm, comparing to only  <dig> % by bcrgt  for snps in regions with copy number loss. we also calculated the genotyping error rates for snps in cna and normal two-copy regions separately. a genotyping error occurs if the paired normal sample has aa/bb, but the tumor has ab call, or, very uncommonly, the tumor and paired normal samples have different homozygous calls. here, we assume that the calls for the paired normal samples are highly accurate. from table  <dig>  we observe that in the cna regions, the calling error rate by brlmm is much higher  than that by bcrgt, while these rates are similar in regions without cnas. in addition, for the tumor samples with higher normal cell contamination, brlmm generally has a much worse performance in that the proportion of ab genotypes in copy number loss regions can be as high as 13%, while the proportion by bcrgt is only around  <dig> % in the same regions .

misclassification of cna status may be an issue in bcrgt because cna status is an input covariate. however, with a retrospective check of the genotyping calls, we can recognize possible cna global misclassification. in figure  <dig>  we intentionally misclassified the copy loss regions on chromosomes  <dig>   <dig>   <dig>   <dig>   <dig>  12– <dig>  16– <dig>   <dig> and  <dig> as normal, and thus the proportion of heterozygous snps substantially increased . based on our empirical study, we recommend that if this proportion is higher than 1%, we will examine the cna detection algorithm. note that this step is important not only for generating correct genotype calls, but also for examining the validity of the upstream copy number analysis. on the other hand, this type of overall misclassification is less likely if both tumor and paired normal samples are available because new statistical methods can handle this situation very well. in our recent paper on snp array data normalization of paired samples  <cit> , we showed that two-copy regions can be explicitly identified in the normalization process, and thus the major cnas can be identified with very high accuracy. note that some focal gains/losses may be missed or falsely detected. but, if true gains/losses are misidentified as normal copy number, bcrgt will perform similarly to other genotyping methods.

in regions with copy number gain, the proportion of the heterozygous calls does not provide much information because the loss of heterozygosity  does not occur in these regions. however, again because genotyping calls for the paired normal samples are available, we can calculate and compare the concordances of genotyping calls from the tumor samples with those from the paired normal samples by bcrgt and brlmm. the results are presented in table  <dig>  note that a snp with at least one a allele and one b allele is termed as ab genotype, regardless of how many extra copies of a and/or b allele it actually has. similarly, a homozygous snp with at least two a alleles or two b alleles is termed as aa or bb. the overall concordance at the copy number gain regions is higher by bcrgt  than that by brlmm . this reflects an approximately  <dig> % increase in the concordance rate for heterozygous calls, and a slightly lower concordance  for homozygous calls. both calling methods give much higher  concordance rates for homozygous calls than for heterozygous calls. theoretically, for snps with ab genotype, copy number gain should not cause loh, and should not add heterozygosity for aa or bb alleles based on the definition of loh. therefore, we expect a  100% concordance rate. however, due to the issues such as normal cell contamination, the existence of minor clone, and signal saturation effect, the concordance rate is much lower compared to that of repeated arrays with the same normal samples, which often has a concordance rate of around  <dig> %  <cit> . the  difference between concordance rates for homozygous calls and for heterozygous calls makes perfect sense because copy number gains for homozygous calls move the intensities of the homozygous snps away from the heterozygous snps in scattered plots, as shown in figures  <dig> and  <dig>  and thus are unlikely to cause incorrect genotyping calls. on the other hand, copy number gains make heterozygous snps to move closer to homozygous snps, and consequently increase the possibility of incorrect genotyping calls.

to conclude this section, we comment that including more term, such as the percentage of normal cell contamination, in bcrgt may help improve the concordance rate. this will be investigated in our future research.

CONCLUSIONS
accurate genotyping is one of the key components for a successful gwas study. genotyping calls for samples without cnas can achieve a  <dig> % or higher accuracy  <cit> . however, it remains a challenge to genotype samples with cnas, and the result of a well-designed gwas study can be severely compromised if the genotyping calls have low accuracy. therefore, it is appealing to develop methods that can achieve high genotyping accuracy for samples with cnas. note that there are many statistical methods for analyzing copy number abnormalities. although most of those methods work well in detecting cnas at individual sample level, methods for formally evaluating the effect of cnas are largely lacking.

whether or not applying hardy-weinberg  test in bcrgt should be considered case by case. for samples without cnas, if the main assumptions of hw equilibrium are violated , the hw test should not be used to refine genotype calling, and a significant test result does not imply a problem in genotyping. similarly, the hw test should not be applied when genotyping samples with cnas because hw is not supposed to be valid for samples that are not diploid.

we achieved fairly high calling accuracy for samples without cnas when directly applying bcrgt to all  <dig> hapmap samples. later, a training step was added to further improve the accuracy. we adopted a strategy similar to the cross-validation approach – half of the  <dig> samples were randomly selected and used to train the model, while the remaining half were used as the validation set to calculate the concordance rates with hapmap call. we comment that this strategy is unlikely to overestimate the concordance rate because we avoided using the same biological sample in both the training and validation sets. note that there are other strategies that may work better. for example, we can train the data produced by one laboratory for a subset of the hapmap samples, and then apply the trained model to the data obtained from a different laboratory for the complementary subset of hapmap samples. by so doing, both biological samples and experimental variations are independent between the training and validation sets.

bcrgt has substantial improvement over brlmm for calling snps in copy number loss regions, and performs better in copy number gain regions. there is minimal difference between these two methods in calling snps in normal two copy regions.

the core of bcrgt is a bayesian linear regression, which allows the adjustment for cnas in snp calling. it is also feasible to incorporate additional information, such as the percentage of normal cell contamination, into the model for better genotype calling results. moreover, incorporating genotypes of the paired normal samples into the model might further reduce genotyping error should those data be available.

depending on objectives, the output format of genotype calls for snps in the cna regions can be flexible. for example, genotypes in the copy number loss regions can be outputted as 0/a/b, or 00/aa/bb, and similarly those in one copy gain regions can be outputted as aaa/aab/abb/bbb, or aa/ab/bb. we do not suggest assigning higher copy number calls to the genotypes in copy number gain regions due to several issues including: 1) normal cell contamination, 2) array signal saturation effect, 3) less robustness of more complex models, and 4) increased difficulty in result interpretation.

unlike the affymetrix platform, illumina arrays produce two measurement variables, log r ratio and b allele frequency . statistical methods, based on either the bayesian approach or hmm, have been proposed to utilize both variables simultaneously to perform the analysis. however, most of these methods, such as penncnv  <cit> , quantisnp  <cit>  and oncosnp  <cit> , were designed mainly for detecting cna/cnv, and are not applicable to make genotyping calls by default. genosnp  <cit> , for an illumina platform too, provided a very low homozygosity rate  when used for genotyping deletion regions in the hapmap samples  <cit> . in addition, though penncnv has a plug-in for calculating baf for affymetrix data, the qn component used in the process makes it unattractive for samples with cnas .

most of the current genotyping methods assume bivariate normality on the joint distribution of a and b alleles for each genotype, which implicitly assumes that the marginal distribution of each allele is unimodal. this may not be true if cnas exist because the marginal distribution may be bimodal. in contrast, bcrgt adopts a linear regression approach. thus the assumption we need is that the residuals of each cluster follow a normal distribution, which is commonly made in regression analysis.

alhough accurate copy number calls are required by bcrgt, at each snp, an incorrect copy number call for one sample does not affect genotyping calls for other samples even though this property will not hold if the majority of the copy number calls are incorrect. in sum, bcrgt requests that the extra information added to the regression model is of high quality, but this should not be a big concern if paired normal samples are available. if the paired normal samples are not available, how to obtain high quality information from quality array and cytogenetic data is worth a lot of discussion. this is out of the scope of this paper.

availability
the r package “bcrgt” including documentation is available online. see the website, http://publichealth.lsuhsc.edu/bcrgt.html for details.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
sy and zf designed the experiments. sy did the data analysis. sy, zf and xc wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1: figure s1
a brief derivation of the posterior distribution for βs.s <dig>  cluster regression parameter estimation. figure s <dig>  an example of “bb” genotype missing . figure s <dig>  illustration of the difference in absolute change in signal intensity between copy number gain and loss. figure s <dig>  illustration of copy number loss caused signal intensity drop. figure s <dig>  copy number status of the same sample presented in figure  <dig>  figure s <dig>   an example of higher normal cell contamination. figure s <dig>   the copy number status of the sample presented in figure s <dig>  figure s <dig>  an example that the normal regions were intentionally misclassified as copy number loss regions.

click here for file

 acknowledgements
we are grateful for the thorough review by two anonymous referees of a previous version of this paper, and for the helpful comments of these referees and the associate editor. we also thank ms. alice leblanc for her english editing of the paper.

zf’s research was supported by  <dig> u <dig> gm <dig> from the national institute of general medical sciences of the national institutes of health which funds the louisiana clinical and translational science center of pennington biomedical research center.
