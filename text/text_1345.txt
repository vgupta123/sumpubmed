BACKGROUND
digital dnasei footprinting is a high throughput adaptation of classical dnasei footprinting  <cit> . by subjecting nuclei to digestion by dnasei, nucleosome-depleted genomic regions  that are sensitive to cleavage can be identified as dnase hypersensitive sites   <cit> . analyses of the patterns by which dnase i cuts within dhss enables the identification of regions protected from digestion or “footprints”, which accurately demarcate transcription factor binding sites  at sub-30 bp resolution . however, all currently available footprinting tools are designed for the analysis of a single dnase-seq data set at a time and thus will indiscriminately identify tfbss that are part of a variety of different gene regulatory networks, limiting the ability to link regulatory events to cell- and tissue-specific processes, such as changes in cell fate or response to extracellular signals. for gene expression studies, a plethora of computational methods have been developed in order to identify genes that are differentially expressed in different conditions, thereby linking gene expression to changes in cellular status. however, a similar methodology that identifies differential transcription factor occupancy between dnase-seq datasets has so far been lacking, and methods such as diffbind  <cit> , designed for chip-seq are not appropriate for dnase-seq data. here we describe the development of a novel computational tool to identify differential footprints . we show that this tool can be used to link differential tf occupancy with differential gene expression and to identify closely related cell types by virtue of their tf occupancy patterns.

RESULTS
we have developed a conceptually simple and computationally efficient method, wellington-bootstrap, for pairwise analysis of dnase-seq data sets. wellington-boostrap builds on the wellington method for detecting footprints in individual data sets  <cit> . wellington uses knowledge of the strand imbalance around the tfbs introduced by the size-selection step in the double-hit dnase-seq method  <cit>  in order to accurately detect footprints. this strand imbalance results in a characteristic pattern of reads aligning to the positive reference strand directly upstream of the tfbs and reads aligning to the negative reference strand directly downstream of the tfbs. with wellington-bootstrap, footprints in data set a are detected and at each footprint locus a statistical test is performed testing whether pooling the data of data set b with a contributes to the footprint pattern or not. this yields a set of sites that are over-footprinted in a  and associated dfp scores. repeating the analysis with reversed roles for a and b yields over-footprinted sites in b . we chose the approach of pooling data at individual loci in order to avoid biases that may be brought about by variations in sequencing depth.

applying wellington-bootstrap to publically available dnase-seq data for cd8+ and cd19+ cells we find  <dig>  sites with evidence for dfps. furthermore, the wellington-bootstrap score provides a way to order dfps by the extent of footprint differences . we found similar results making pairwise comparisons for all dnase-seq data sets for seven cell types from clinical tissue samples. a large proportion  of dfps are found in dhss that are shared between cell types, in particular in closely related cell types, indicating that these differences would be missed by restricting analyses to the presence or absence of dhss .fig.  <dig> wellington-bootstrap scores differential footprint occupancy between dnase-seq datasets. wellington-bootstrap was applied at footprint loci in cd8+ cells to detect over-footprinted sites relative to cd19+ cells. a  <dig>  loci were sorted by increasing wellington-bootstrap score comparing cd <dig> vs cd <dig>  eight thousand seven hundred eighty loci were deemed to be dfps. red indicates an excess of positive strand cuts over negative strand cuts per nucleotide position, and green indicates an excess of negative strand cuts. common footprints at the top of the heatmap share similar dnase activity as exemplified in  and  whereas footprints with increasing differential score towards the bottom of the heatmap show increasingly differential footprints 

number of dhss and shared dhss, number of over-footprinted sites, and number of over-footprinted sites located in the overlap of shared dhss are shown for pairs of cell types. for closely related cell types most differential footprints tend to be found in common dhss . developmentally distant cell types, however, often have a large number of dhss that are cell type specific, and therefore the majority of differential footprints are in cell-type specific dhss 



using spinal cord and cd4+ cells as example we tested the ability of dfps to re-discover known regulatory links and predict gene expression. in cd4+ cells, the t cell specific tf t-bet binds t-box motifs and enhances target gene expression as part of the th1-differentiation programme  <cit> . in spinal cord cells, the tf maz is known to be involved in neuronal development  <cit> . among the set of all dfps located near transcriptional start sites and over-footprinted in cd4+ cells we identified the sites containing a match for the t-box motif. we found that the expression of nearby genes differed significantly, with the dnase-seq data providing strong evidence for the presence of protein binding in cd4+ cells and absence of binding in spinal cord cells . similarly, we found that a link between binding to maz motifs and gene expression was evident , demonstrating the ability of the dfp approach to isolate the effect of individual tfs from their genomic context.fig.  <dig> differential footprints reveal links between tf binding and gene expression. a differential gene expression  of all genes that have a differential cd <dig> footprint containing a match for the t-box motif in their promoter. b average bias-corrected dnase-seq cleavage profiles  centred on t-box motifs in promoters of genes from  show evidence for binding of t-box motifs in cd4+ cells, but not in spinal cord cells. genes over-footprinted for t-box in cd4+ cells are also over-expressed, confirming a known lineage-determining link. c differential gene expression of all genes that have a differential cd4+ dhs containing a match for the t-box motif in their promoter. d average bias-corrected dnase-seq cleavage profiles centred on t-box motifs in promoters of genes from  do not show evidence for binding in either cell type. the differential expression observed in  cannot be linked to tf binding using differential dhs scores alone



previously, comparisons of total read numbers in dhss have been used as a means of analysing pairs of dnase-seq data sets  <cit> . we identified the set of t-box motif-containing dhss in gene promoters with the highest increase in read numbers in cd4+ cells compared to spinal cord cells. while these showed differential expression of nearby genes, no evidence for differences in binding was revealed using this approach . similarly, this approach did not reveal the regulatory link between maz binding and target gene expression . the cleavage profiles shown in fig. 2b, d and additional file 1: figure s1b, d have been corrected for the known sequence preference of the dnasei enzyme. additional file 1: figure s <dig> compares cleavage profiles with and without this correction. overall, this suggests that unlike dfps, motif analysis of dhss is insufficient to link a given tf to changes in gene expression, making the use of dfps a valuable tool for this purpose.

we sought to further explore the potential of the dfp approach to reveal cell type-specific regulatory mechanisms. using differential footprints amongst all pairs of dnase-seq data sets of seven primary cell types, we determined the relative frequency of motif occurrences for a set of known tf binding motifs and used this data to cluster the set of pairs of cell lines as well as the set of tf binding motifs . this analysis generated a number of striking results. firstly, our dfp methodology combined with clustering recovered the different cell types as separate clusters. moreover, it was able to distinguish between the different cell types as their specifically occupied dna sequences clustered together. secondly, the analysis gave interesting insights into the relative role of individual tf families within a given cell type. for example, high differential c/ebp motif occupancy was a classifier for cd14+ monocytes as well as fibroblasts, both of which express cebpa, but the relative motif frequency was lower in fibroblasts which agrees with the fact that this factor is absolutely essential for monocyte but not fibroblast development  <cit> . another interesting finding was that increased occupancy of pu. <dig> motifs was a classifier for both b cells and cd14+ monocytic cells where this factor plays an important role  <cit> , but a significant number of such sites were occupied also in t cells. pu. <dig> is expressed in hematopoietic stem cells from which all hematopoietic cells originate, but its expression is down-regulated in t cells and its overexpression is detrimental for their development  <cit> . there is some overlap between the binding specificities of different ets-family proteins  <cit> . it is therefore possible that some of these sequences are bound by another ets factor in t cells. importantly, gene expression patterns of typical tfs corresponding to motifs enriched in differential footprints showed tissue-specific expression, whereby they tended to be expressed in the cell type in which they were differentially footprinted. comparable motifs could also be obtained in an unbiased way via de novo motif discovery, as exemplified for a cd <dig> versus cd <dig> differential footprinting analysis . these motif results are supported by previous findings in b-cells  <cit> .fig.  <dig> analysis of differential footprints in the haematopoietic system reveals cell-type specific transcription factor networks. differential footprints in  <dig> pairs of cell types and matches to known motifs inside differential footprints were determined using dnase-seq data from the nih roadmap epigenomics project. coloured boxes represent motif frequency with red indicating higher than average frequency. hierarchical clustering was applied to rows and columns. red arrows highlight members of the ets family of transcription factors. biogps gene expression of typical tissue-specific tfs corresponding to motifs enriched in dfps is shown to the right, with gapdh as a positive control . the result correctly groups cell types and reveals known and likely regulatory factors



to facilitate the wide-spread use of our method, we provide an implementation of wellington-bootstrap alongside a substantial update of pydnase, including increased performance and parallelised computations. this is released as open source under the gplv <dig> license at https://github.com/jpiper/pydnase.

CONCLUSIONS
in conclusion, we introduce a fundamental and useful method for differential footprints, provide a tool for the detection of dfps, and reveal the potential of this approach to map regulators to context-specific gene expression. applying this methodology will be highly relevant for classifying closely related cell types, both in the normal, but also the diseased state and to assess the relative importance of specific tf families for each state. wellington-bootstrap is applicable to any pair of dnase-seq data sets obtained with comparable experimental protocols including perturbation and time course experiments, making it a widely applicable approach for the identification of transcriptional regulatory hierarchies.

