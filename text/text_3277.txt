BACKGROUND
using genetic data to infer the demographic history of a species or a population is of importance for several reasons. for instance, a central goal in evolutionary genetics is to understand which forces have contributed to the observed patterns of genetic variation in natural populations. of particular interest is the identification of genomic regions that evolve under pressure of natural selection and characterization of functional elements underlying fitness traits  <cit> . since demographic events in the history of populations govern the distribution of alleles on a genome-wide scale, the design, analytical efficiency and interpretation of downstream population genetic analyses or genome scans to discover such regions can be enhanced if the population history is known in some detail  <cit> . for example, association analyses may be severely biased if there is population structure or recent admixture in the set of sampled individuals  <cit> . moreover, demographic inference based on genetic data supplements morphological records in the quest towards understanding the natural history of organisms on deeper time scales [eg.  <cit>  and can aid in discriminating between different scenarios of population differentiation and speciation, for instance, between speciation models including or excluding post-divergence gene-flow  <cit> . until recently, demographic history and the factors governing genetic diversity were generally studied using limited data sets. however, since the variance in genetic diversity at a single or a few loci is unlikely to reflect the overall genomic patterns, assessment of the proportional contribution of drift, selection and demography in shaping genetic variability and population differentiation should ideally be based on multi-locus datasets  <cit> . a recently developed and powerful way of disentangling between alternative demographic hypotheses is the application of isolation migration model theory via a maximum likelihood analysis framework [eg.  <cit>  of coalescence based models of population history  <cit> . this type of analysis can be time consuming and computer intense and are still not suitable for data on a genome scale but can be useful for multi-locus re-sequencing data sets with a moderate number of loci.

the pied flycatcher  and the collared flycatcher  are small, migratory, passerine birds  which occur over large parts of the western palearctic . current distribution ranges likely reflect expansions from pleistocene glacial refuges on the iberian  and the apennine  peninsulas  <cit> . areas of sympatric occurrence are present both in central and eastern europe and on the baltic sea islands gotland and Öland , and hybridization occurs at a low rate within these zones  <cit> . the hybrid zone on the islands in the baltic sea might have been formed as recently as  <dig> years  to  <dig> years  ago when the collared flycatcher started colonizing the islands previously occupied by the pied flycatcher only  <cit> . the species system has been subject to thorough studies of speciation and hybridization, and the emerging consents include the presence of powerful intrinsic post-zygotic isolation , and potential reinforcement of pre-copulatory isolation, despite limited ecological differentiation  <cit> . moreover, a suite of genetic mapping studies  <cit> , transcriptome characterization [e.g.  <cit>  and on-going efforts to sequence the flycatcher genome point towards that the species system is underway of becoming a genetic/genomic model and hold promise for downstream unravelling of important genotype-phenotype relationships. however, the knowledge about the demographic history is still sparse and likely insufficient to allow for robust interpretations of results from genome-wide selection scans or association efforts in these species.

we set out to use a multi-locus re-sequencing approach to obtain better understanding of the population history of the collared flycatcher and the pied flycatcher in europe. initially we focused on between-species divergence by estimating effective population sizes, species divergence time and by assessing potential post-divergence gene-flow. we followed up by investigating intra-specific patterns of genetic diversity and differentiation, our specific aims being to i) assess the level of genetic diversity in different parts of the distribution range of each species, ii) identify potential population structure within species, and iii) use allele frequency data to look for signs of demographic events in the history of the species.

methods
sampling and dna extraction
blood samples were available from previous studies  <cit>  and taken during breeding season from between  <dig> and  <dig> birds at four different locations within each species distribution range, respectively . pied flycatchers were sampled in central spain , northern germany , central sweden  and in southeastern sweden . collared flycatchers were sampled in central italy , northern hungary , sothern czech republic  and in southeastern sweden . dna was extracted with either the dneasy dna extraction kit , or with a standard proteinase k digestion, phenol-chloroform purification procedure  <cit> .

marker development
we selected  <dig> autosomal, gene-based  markers from a set previously developed for amplification in a wide range of avian taxa  <cit> . the markers were chosen on basis of their amplification success in ficedula flycatchers and to represent genes widely distributed over the genome, including both macro- and microchromosomes . pcr amplifications were set up according to backström et al. <cit> , the general recipe was a  <dig> μl reaction with 50– <dig> ng of template dna with  <dig> μm of each dntp,  <dig>  mm mgcl <dig>   <dig>  pmol of each primer, and  <dig>  u of amplitaq or amplitaq gold . all pcrs were run on a tetrad ptc- <dig> thermal cycler  with the general temperature profile; initial denaturation  <dig> min at 95°c,  <dig> cycles with  <dig> s denaturation at 95°c,  <dig> s annealing starting off at 65°c and decreasing the annealing temperature with  <dig> °c per cycle and  <dig> min elongation at 72°c,  <dig> cycles with the same temperature profile but with fixed annealing temperature at 55°c, and finally finishing off with an extra elongation step for  <dig> minutes at 72°c. pcr products were purified with exo-sap it  according to recommendations from the manufacturer. purified pcr products were prepared for sequencing by running a  <dig> cycle sequencing reaction using ≈ <dig> ng product together with  <dig> pmol of either forward or reverse primer,  <dig>  μl bdx <dig>   <dig>  μl bigdye <dig> ,  <dig>  μl 5x dilution buffer and  <dig> μl ddh2o . the temperature profile was initiated by a denaturation step for  <dig> min at 96°c followed by  <dig> cycles including  <dig> s at 96°c,  <dig> s at 50°c and  <dig> min at 60°c as suggested by the manufacturer. sequencing reactions were purified using the xterminator system according to manufacturer’s protocol and sequences were run on an abi3730xl dna analyzer . likely as a consequence of length polymorphisms in some loci in some populations, all loci could not be sequenced to full length in all individuals. the number of chromosomes sequenced for a specific population and a specific locus is given in table  <dig> 

sp = spain, ge = germany, sc = scandinavian mainland, ba = baltic sea islands, it = italy, cz = czech republic. the id given is the five last figures in the orthologous transcript identifier in the chicken genome assembly  according to backström et al. <cit> .

data analysis
sequences were edited using sequencher  <dig>   and trimmed to include only non-coding parts . locus specific alignments were created using clustal w  <cit>  as implemented in mega  <dig>   <cit> . we selected  <dig> individuals  with the highest sequence coverage as averaged over all  <dig> loci from each of the four populations from each species, respectively , for analysis.

we applied a six-parameter isolation-migration model [ima;  <cit>  to the data using selections of individuals that represented two allopatric  and one sympatric  population pair as well as to a dataset including all  <dig> individuals from all four populations lumped together for each species, respectively. since the isolation-migration model assumes no intra-locus recombination we inferred gametic phase and analysed all four datasets for signs of recombination using phase and the four-gamete test as implemented in dnasp  <cit> , and cut the alignments so that the longest stretch of sequence without evidence for recombination was kept for analysis. ima simulates genealogies under different demographic scenarios using a markov chain monte carlo approach and provides the estimates of six parameter values  that best fit the data. all datasets were analysed in an initial m-mode run sampling every  <dig> genealogies to a sum of 5* <dig> genealogies after a burn-in of  <dig> million steps with prior ranges as follows: q <dig> = 0– <dig> q <dig> = 0– <dig>  qa = 0– <dig>  τ = 0– <dig>  m <dig> = 0– <dig>  m <dig> = 0– <dig>  after inspecting the posterior distributions for the parameters a second, equally long, m-mode run was performed with narrower prior intervals and a different random seed number. the prior ranges for the second run were generally q <dig> = 0– <dig> q <dig> = 0– <dig>  qa = 0– <dig>  τ = 0– <dig>  m <dig> = 0– <dig>  m <dig> = 0– <dig>  ess values varied substantially between runs, the second analysis of allopatric populations  had lower ess values than the other analyses, but there was good agreement in hipt values and posterior distribution ranges between independent runs. subsequent analysis and the interpretations were therefore restricted to the runs with narrower priors only. all parameter estimates were scaled by a mutation rate of  <dig> *10- <dig> <cit>  and a generation time of one year. we evaluated different demographic models by comparing relevant nested models  to the full six-parameter model and assessed the significance by likelihood ratio tests implemented in the software  <cit> .

population genetic analyses including estimates of nucleotide diversity , tajima’s d, and inter-population genetic differentiation  within and between species were calculated in dnasp version  <dig>  <cit> . all single nucleotide polymorphisms  were used to assess intra-specific population structure using both a model-based clustering algorithm based on allele sharing among populations [structure v <dig> ;  <cit> , and a principal component analysis  based population stratification tool in the software package eigensoft [smartpca;  <cit> . structure version  <dig>   <cit>  was run with default settings, using the admixture model and inferring α, for  <dig>  steps after a burn-in period of  <dig>  steps for each species, respectively. for both species,  <dig> independent analyses with different random seeds were run for each value of k from k =  <dig> to k =  <dig>  the optimal number of populations  was assessed using the method suggested in the structure  <dig>  documentation . graphical displays of individual assignment coefficients were created using distruct version  <dig>   <cit> . nexus files exported from mega  <dig>   <cit>  including intra-specific polymorphisms  were transformed to eigenstrat format using an in-house developed python script . smartpca  <cit>  was run with default settings for each of the species separately as well as for both species combined, and the three most informative principal components were selected for the plots.

RESULTS
we collected up to  <dig>  bp of sequence data from  <dig> autosomal loci  for a total of  <dig> pied flycatchers and  <dig> collared flycatchers sampled from four different locations throughout their respective breeding ranges . from each population,  <dig> individuals with the highest yield of sequence data were selected for analysis.

species divergence
the isolation-migration analyses showed relatively consistent results over different datasets including allopatric populations, sympatric populations and all populations from each species combined. distributions of divergence time estimates from all pair-wise comparisons steadily fell in the range of a few hundred thousand to one million years and all analyses showed a biased migration rate with higher estimated gene-flow from the pied flycatcher into the collared flycatcher  than vice versa . the rate of gene-flow from the pied flycatcher into the collared flycatcher was also considerably higher in the comparison of sympatric populations  than in the comparisons of allopatric populations . the analysis of samples from all populations showed that the estimated effective population size was higher for the collared flycatcher  than for the pied flycatcher  and for the ancestral population . posterior probability distributions for all parameter estimates and datasets are presented in figure  <dig> and hipt  and 90% highest posterior density boundaries in table  <dig> 

ne = effective population size.

direction of gene-flow is indicated by an arrow .

since the analysis of allopatric spanish pied flycatchers and hungarian collared flycatchers showed low ess values  we focused on the other three datasets for the interpretation of nested models. these analyses supported the findings from the isolation-migration analysis with only minor differences among data sets ). in general, a model assuming equal effective population sizes between the pied flycatcher and the collared flycatcher  or between the collared flycatcher and the ancestral flycatcher  was significantly rejected, especially if the gene-flow was assumed to be equal in both directions  or completely absent . a model assuming equal effective population sizes between the pied flycatcher and the ancestral flycatcher  was also rejected if the rate of post-divergence gene-flow was forced to be equal in both directions , but not otherwise . the models excluding gene-flow in both directions  were the least supported nested models of all, irrespective of if they allowed for differences in effective population size or not. specifically, the full model, allowing for unequal population sizes and gene-flow in both directions  was not significantly better than a model with no gene-flow from the collared flycatcher to the pied flycatcher  and could be rejected in all datasets. however, the corresponding model without gene-flow from the pied flycatcher to the collared flycatcher  was marginally, but significantly, rejected in both sympatry  and in the comparison of all populations combined .

polymorphisms and allele frequency distributions
the overall genetic diversity  was lower in the pied flycatcher  than in the collared flycatcher , but the difference was not significant . there were only small differences in genetic diversity between populations within species, the range of diversity estimates was between  <dig>  -  <dig>  for all populations with the exception of the spanish pied flycatcher population which had lower diversity . tajima’s d was significantly higher  in the pied flycatcher  than in the collared flycatcher  but there was no significant difference between populations within species .

sp = spain, ge = germany, sc = scandinavian mainland, ba = baltic sea islands, it = italy, hu = hungary, cz = czech republic.

population differentiation
the average fst between species was  <dig>  ±  <dig> . within the pied flycatcher, there was significant differentiation between population pairs including the spanish population with fst =  <dig>   in the comparison to the baltic sea islands and the scandinavian mainland populations and fst =  <dig>   in the comparison to the german population. the level of differentiation between all other population pairs was limited . there was no significant differentiation between any collared flycatcher population pairs .

sp = spain, ge = germany, sc = scandinavian mainland, ba = baltic sea islands, it = italy, hu = hungary, cz = czech republic. intra-specific comparisons are in bold face font.

the analysis of assignment of individuals to specific populations with structure  <cit>  and smartpca  <cit>  did not indicate any considerable population stratification in either of the two species . likelihood values for different number of clusters did not vary significantly and we interpreted the most likely number of clusters to be one in both the pied and the collared flycatcher. the pca analysis also indicated limited population differentiation in both the pied flycatcher and the collared flycatcher. however, the resolution of the pca allowed for more detailed visual inspection and a few observations are worth bringing up. first, in agreement with the intra-specific differentiation analyses using fst-values, the spanish pied flycatcher population grouped outside the range of the other pied flycatcher populations, in particular along the axis of principal component  <dig> and  <dig> . second, in the collared flycatcher the most differentiated population was the population from the baltic sea islands . both these patterns could also be observed when all individuals from both species were analyzed together .

discussion
we re-sequenced  <dig> autosomal loci in population samples of pied flycatchers and collared flycatchers collected throughout their respective european breeding distribution ranges and used the data to infer parameters in the history of the species and to evaluate potential population stratification within species. the isolation-migration model fitting generated relatively consistent estimates for the parameter values over all data sets. the ancestral population size was generally estimated to be smaller than the current population sizes or similar to the current population size of the pied flycatcher. in agreement with the diversity estimates, the effective population size of the pied flycatcher was smaller than the effective population size of the collared flycatcher in all comparisons. although the exact numbers for the effective population size estimates from the isolation-migration analysis should be treated with care since they are heavily dependent on the assumed generation time and mutation rate, it is of some interest to compare the ratio of census to effective population size estimates for the different species. the estimated census population size for the pied flycatcher,  <dig> , <dig> in europe plus > <dig> , <dig> in russia  <cit> , is approximately one order of magnitude higher than the estimated effective population size. in the collared flycatcher, the estimated census population size is only about 10% of the pied flycatcher estimate  <dig> - <dig> ,  <cit>  and very similar to the estimated effective population size. in line with indications of a recent population expansion  <cit> , this suggests a stronger bottleneck and a more dramatic population growth from the bottlenecked population in the pied flycatcher , during re-colonization of northern europe subsequent to the retrieval of the ice cover from the latest pleistocene glaciations. previous work has shown that the pied flycatcher is more opportunistic in choice of habitat than the collared flycatcher. for example, it can breed successfully also in relatively poor habitats  <cit> , and pied flycatcher hatchlings are less vulnerable to periods of low food abundance than collared flycatcher hatchlings  <cit> . hence, the pied flycatcher is likely able to re-colonize new areas more rapidly than the collared flycatcher when an ice cover retracts after a glaciation. this ability can potentially explain the current, more widespread and more northern distribution of the pied flycatchers as compared to the collared flycatcher.

there was also regularity in the estimated divergence time among datasets, all results pointed towards numbers around  <dig>  million years. previous estimates, using mitochondrial data and a fixed clock, implied a divergence time of 1– <dig> million years between the species . the inconsistency between estimates could be caused by several factors [cf.  <cit> . first, the estimate from the isolation-migration model is dependent on the assumed generation time and mutation rates; a halving of the mutation rate would double the divergence time estimate. second, divergence times based on strict molecular clocks have proven to be subject to biases from rate heterogeneity both among lineages and among genomic regions and the rate of mtdna divergence is variable among different taxa  <cit> . finally, the estimates could reflect a true difference in divergence between mtdna and nuclear genes. during a speciation process different genomic regions may diverge at varying rates. simulation analyses show that a higher degree of mtdna differentiation is expected in organisms with female biased dispersal  due to smaller drift effects of introgressed alleles in regions with high intra-specific gene-flow  <cit> . the rate of differentiation in a region can also be dependent on the proximity  to selected alleles  <cit> , differences in relative fitness of male and female hybrids  <cit> , or the effective population size of the locus  <cit> . it is also known that female hybrids are sterile while male hybrids can produce viable offspring  <cit> , albeit with severely reduced fitness  <cit> . this fitness difference has potentially contributed to reduce the gene-flow on mitochondria compared to autosomes  <cit> . moreover, as mtdna is clonally and strictly maternally inherited, recessive mutations are not masked by dominance, similar to the case for sex-chromosomes in hemizygous state [cf. haldane’s rule;  <cit> . consequently, there is scope for stronger selection against incompatible combinations of alleles and potential for more rapid build-up of barriers to gene-flow on mitochondria than on autosomes. if so, it is possible that recurrent secondary contact events following re-colonizations during warmer interglacial epochs have resulted in less introgression on the mitochondria than on the autosomes, similar to what has recently been observed on the z-chromosome in several avian taxa  <cit> . this would result in relatively larger proportion of shared polymorphisms and, hence, a shallower divergence estimate for the autosomes. another possible explanation for a deeper mtdna divergence estimate is historical  introgression of mtdna into any of our focal species from more distant relatives, ie. atlas flycatcher  or semi-collared flycatcher   <cit> . however, this scenario is less plausible since mtdna from all abovementioned species are more or less equally differentiated postulating that past introgression has to have occurred from several extinct lineages into at least three of the extant species. our data does not provide the power to disentangle the factors underlying the discrepancy between divergence time estimates based on mtdna and genomic dna. however, since many of the causes are not mutually exclusive, it is not unreasonable that a combination of factors have acted in concert, or during different time periods, to finally result in the observed pattern.

the strongest evidence for post-divergence gene-flow in our data was from the recently formed hybrid zone on the baltic sea islands. this result is in consistency with preceding studies  <cit>  and further supports the idea that hybridization barriers are not yet complete in this young hybrid zone  <cit> . the data also support a directional bias with significantly more, or even completely unidirectional, gene-flow from the pied flycatcher to the collared flycatcher. this is in agreement with genotype information in backcrossing pied and collared flycatcher families  <cit>  as well as re-sequencing data  <cit>  and, given that hybrid females are sterile  <cit>  this implies that the exclusive option for successful back-crossing will be hybrid males mating with collared flycatcher females.

contrary to expectations from a substantial founder effect during re-colonization of new areas after expansion from glacial refuges, there was little variation in nucleotide diversity among populations within species. for the pied flycatcher the trend was actually opposite expectations, the spanish population had the lowest diversity and the northern and thus more recently founded populations showed on average slightly higher diversity. this could reflect a smaller effective population size in spain resulting from a partially fragmented population and, as implied by previous microsatellite data  <cit>  and by our differentiation analyses, also probably from restricted gene-flow to other pied flycatcher populations. the pyrenees may act as a dispersal barrier and the pied flycatcher has a disjunct distribution pattern in southwestern europe indicating that there are limited opportunities for short-range diffusion. overall, this suggests that newly established populations inhabiting novel habitats after glacial retraction were founded by a large number of immigrants. alternatively, subsequent gene-flow between newly established and refugial populations may have been extensive enough to maintain similar diversity levels among populations.

all pied flycatcher populations showed slightly positive tajima’s d values while the collared flycatcher populations showed on average slightly negative tajima’s d values in derived populations but a slightly positive value in the supposedly ancestral italian population. these observations stand in some contrast to previous findings in both the pied flycatcher and the collared flycatcher for a large set of z-chromosome linked genes  and to another dataset including both autosomal  and z-chromosome data d =  <dig>  and − <dig> ;  <cit> . admittedly, these mixed trends make interpretation difficult and speculative. it is known that historical events like bottlenecks followed by population expansions, can have varying effects on the allele frequency distribution dependent on the effective population size of the chromosomal region  <cit> . since both species may have had fluctuating population sizes during relatively recent history, a discrepancy between autosomal and z-chromosome linked loci is not entirely startling. however, the considerable variation among loci within chromosomes and the substantial difference between estimates among studies  <cit>  suggest that the results spring from a complicated combination of random effects, demographic history and selective pressures unique to specific populations, species or genomic regions. this implies that particular caution should be taken before drawing any conclusions regarding general population history from these data.

the fst estimates varied only slightly among population comparisons between species and averaged at  <dig> . this is lower than a previous estimate using a large set of z-chromosome linked loci [ <dig> ;  <cit> , as expected given the lower effective population size  <cit> , and reduced introgression on the z-chromosome compared to the autosomes  <cit> . the latter effect could possibly be a consequence of the importance of z-linked loci in species recognition and female mate choice  <cit> . within species, the level of differentiation was generally low with the exception of pair-wise comparisons including the spanish pied flycatcher population. this agrees with the analysis of genetic diversity and the principal component analyses, and implies that there is some differentiation among current european populations of the pied flycatcher that inhabit appreciably geographically separated areas.

recent data from large-scale genotyping assays have revealed a potential to identify genetic structure on a very detailed scale  <cit> . for example, derived contemporary human populations, which actually harbor relatively limited genetic variability compared to eg. the species of flycatchers in our study  <cit> , can be assigned to geographic sampling site with very high precision  <cit> . this indicates that the possibility to detect fine-scale population structure depends mainly on the number of markers used. it has also proven true that genome-wide scans for genotype-phenotype associations are highly sensitive to population structure  <cit> , and that a large proportion of associations might be explained by rare genetic variants and alleles private to restricted populations  <cit> . methods for handling stratification have been suggested and they apparently perform well except under some circumstances when the loss of power is substantial and when the number of markers is low  <cit> . consequently, understanding the underlying population stratification is crucial to correctly infer the proportion and effect size of specific alleles on phenotypes of interest and to accurately transfer information from population to population. we utilized a limited number of markers,  <dig> loci with a few hundred snps in total, and detected significant population stratification in the pied flycatcher and observed some stratification also in the collared flycatcher, although between population differentiation, as measured by fst, was insignificant in this species. extensive genomic tools are currently under development in both the pied flycatcher and the collared flycatcher. our data indicates that forthcoming analytical efforts using these tools should be designed so that within species stratification is taken into account using e.g. genomic control  <cit> , or performed with individuals sampled within an unstructured subpopulation.

CONCLUSIONS
we sequenced  <dig> autosomal intronic loci in population samples of the pied flycatcher and the collared flycatcher, two model species for ecology and behavior. the data indicate substantial differences in effective and census population size for the pied flycatcher, population stratification within species and shorter divergence time for autosomes than previously reported for mtdna. we also observed unidirectional post-divergence gene-flow between the species. our findings support a scenario where different portions of the genome can be at different stages of speciation and they provide important information about population stratification that will be useful for forthcoming analyses of the link between genotypes and phenotypes in these ecological model species.

availability of supporting data
all sequences have been deposited in the dryad database under doi:http://dx.doi.org <dig> /dryad.dh53m.

competing interests
the authors declare no financial or non-financial competing interests.

authors’ contributions
nb and he conceived of the study. nb designed the study, did the molecular work and analysed the data. gps contributed materials. nb and he wrote the manuscript with input from gps. all authors approved the final version of the manuscript.

supplementary material
additional file 1
supplementary information: nested model analysis test values  and corresponding p-values. df = degrees of freedom. * = 2llr test statistic follows a mixed chi-squared distribution . allopatry  <dig> = spanish pied flycatchers and italian collared flycatchers, allopatry  <dig> = spanish pied flycatchers and hungarian collared flycatchers, sympatry = pied flycatchers and collared flycatchers from the baltic sea islands, species = samples from all four populations combined for each species, respectively. 

click here for file

 acknowledgements
nb acknowledges post-doctoral funding from the swedish research council . gps is supported by the norwegian research council. he is supported by a european research council advanced investigator award, a knut and alice wallenberg scholar award and by the swedish research council.
