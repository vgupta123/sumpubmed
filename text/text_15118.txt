BACKGROUND
high-throughput screening  is a modern technology used by drug researchers to identify pharmacologically active compounds  <cit> . hts is a highly automated early-stage mass screening process. contemporary hts equipment allows for testing more than  <dig>  compounds a day. hts serves as a starting point for rapid identification of primary hits that are then further screened and evaluated to determine their activity, specificity, and physiological and toxicological properties  <cit> . as a highly sensitive test system, hts requires both precise measurement tools and dependable quality control. the absence of standardized data validation and quality assurance procedures is recognised as one of the major hurdles in modern experimental hts  <cit> . acknowledging the importance of automatic quality assessment and data correction systems, many researchers have offered methods for eliminating experimental systematic artefacts which, if left uncorrected, can obscure important biological or chemical properties of screened compounds  and can seemingly indicate biological activity when there is none   <cit> .

systematic error may be caused by various factors, including robotic failures and reader effects, pipette malfunction or other liquid handling anomalies, unintended differences in compound concentrations due to agent evaporation or variation in the incubation time and temperature differences, and lighting or air flow present over the course of the entire screen  <cit> . unlike random error that produces measurement noise and usually has minimal impact on the whole process, systematic error produces measurements that are systematically over- or underestimated. systematic error may be time dependent, introducing biases in individual plates or subsets of consecutive plates, but it may also affect an entire hts assay . in practice, systematic error is almost always location related. the under- or overestimation affects compounds located in the same row or column or in the same well location across the screened plates. the row and column effects may be persistent across the assay affecting repeatedly the same rows and columns on different plates or may vary from plate to plate, perturbing some rows and columns within a particular plate only  <cit> . plate controls are used in hts to ensure the accuracy of the activity measurements being taken. controls are substances with stable well-known activity levels. they might be positive  or negative . controls help to detect plate-to-plate variability and determine the level of background noise.

the following normalisation and pre-processing methods have been widely used in experimental hts to remove plate-to-plate variation and make plate measurements comparable across plates  <cit> :

• percent of control - the following formula is used:

x^ij=xijμpos, where xij is the raw measurement of the compound in well , x^ij is the normalized value of xij, and μpos is the mean of positive controls.

• control normalization  is based on the following formula:

x^ij=xij-μnegμpos-μneg, where xij is the raw measurement of the compound in well , x^ij is the normalized value of xij, μpos is the mean of positive controls, and μneg is the mean of negative controls.

• z-score normalization is carried out as follows:

x^ij=xij-μσ, where xij is the raw measurement of the compound in well , x^ij is the normalized value of xij, μ is the mean of all the measurements of the given plate, and σ is the standard deviation of all the measurements of the given plate.

• b-score  is carried out as follows:

first, a two-way median polish procedure  <cit>  is performed to account for row and column effects of the plate. the resulting residuals within each plate are then divided by their median absolute deviation, mad. it is worth noting that there is an additional smoothing step that could be applied across plates . this optional smoothing step was not applied however in .

the residual  of the measurement in row i and column j on the pth plate is obtained as follows by a two-way median polish procedure :

  rijp=xijp-x^ijp=xijp-. 

the residual is defined as the difference between the observed result  and the fitted value x^ijp, defined as the estimated average of the plate  + estimated systematic measurement offset  for row i of plate p + estimated systematic measurement column offset  for column j of plate p. for each plate p, the adjusted median absolute deviation  is then obtained from the rijp's.

median absolute deviation - a robust estimate of spread of the rijp's values is computed as follows: median{ | rijp-median | }.

the b-score normalized measurements are then calculated as follows:

  b-score=rijpmadp. 

the b-score normalization was introduced by a team of merck frosst researchers  <cit>  as a systematic error correction method.

• well correction is another advanced systematic error correction technique  <cit>  used to remove systematic biases affecting the assay's wells, rows or columns, and spread across all the plates of the assay. it consists of two main steps:

 <dig>  least-squares approximation of the data carried out separately for each well location of the assay;

 <dig>  z-score normalization of the data within each well location of the assay .

in the hts workflow, the normalization/data correction phase is usually followed by the hit selection process. during this process the most active compounds are identified as hits and selected for additional screens. a predefined threshold is usually established to select hits  <cit> . depending on the specifics of the research study, one may be looking for compounds whose activity level is greater than the defined threshold  or interest may lie in the compounds whose measurements are below the defined threshold . in this study, we always assume the latter case where the hits are the compounds with the smallest measurement values. the threshold for defining hits is usually expressed using the mean value and standard deviation of the considered measurements. the most widely used threshold is μ-3σ, where μ is the mean value and σ is the standard deviation of the considered measurements. hits can be selected globally, over the whole assay, when the mean and standard deviation of all assay compounds are calculated, or on a plate-by-plate basis, when the mean and standard deviation of the compounds of each single plate are considered  <cit> .

the presence of systematic error in a hts assay can be identified and visualized using its hit distribution surface  <cit> . such a surface can be computed by determining the number of selected hits for each well location. in the ideal case when systematic error is absent, we expect that the hits are evenly distributed over the well locations. however, this expectation is not always fulfilled in real datasets . this figure presents the hit distribution surfaces computed for two hit selection thresholds,μ-2σ and μ-3σ, of two experimental hts screens performed at mcmaster  and princeton  universities. the row and column effects in the hit distributions across plates are easily noticeable here, especially in the case of a lower  hit selection threshold. the dataset provided by the chemistry department of princeton university consists of a screen of compounds that inhibit the glycosyltransferase murg function of e. coli  <cit> . the experimental data for  <dig> plates were considered. according to the chembank description, this assay has been obtained during a screen that measured the binding of murg to a fluorescent  analogue of udp-glcnac. positives were defined as compounds that inhibit binding of glcnac to murg. the mcmaster assay was originally used as a benchmark in mcmaster data mining and docking competition  <cit> . the mcmaster dataset, which will be examined in detail in this study, consists of compounds intended to inhibit the e. coli dihydrofolate reductase . the screen of  <dig>  training molecules selected by the organizers of mcmaster competition yielded  <dig> primary hits, then,  <dig> potent hits , the majority of which were novel dhfr inhibitors that fell into  <dig> broad structural classes  <cit> .

it is worth noting that the application of sophisticated pre-processing hts techniques does not always guarantee data improvement. moreover, the application of systematic error correction methods on error-free hts assays will produce data in which certain activity measurements will be biased  <cit> . the result of such a misuse of data pre-processing methods can lead to a dramatically inaccurate hit selection. makarenkov et al.  showed that all data correction methods introduce a bias when applied to error-free hts data. this bias can be less important  or very significant . hence, the data correction methods should be applied with caution and only in situations when the presence of systematic error in the given assay has been demonstrated by an appropriate statistical methodology. assessing the presence of systematic error in experimental hts is the main focus of this article.

methods
data description
in this study we consider an experimental assay provided by the hts laboratory of mcmaster university. this assay was called test assay and used as a benchmark in mcmaster data mining and docking competition  <cit> . mcmaster test assay consists of  <dig>  different chemical compounds whose potential to inhibit the e. coli dhfr was tested. each of the  <dig>  considered compounds was screened in duplicate; two copies of each of the  <dig> plates were run through the hts equipment;  <dig> plates in total, with wells arranged in  <dig> rows and  <dig> columns, were screened; columns  <dig> and  <dig> of each plate were used for positive and negative controls and were, therefore, not considered in our study. thus, every plate comprised  <dig> different compounds. the exact experimental conditions of test assay are reported in  <cit> . the competition organizers defined as primary hits the compounds that reduced the dhfr of e. coli to 75% of the average residual activity of the high controls. two lists of hits were published . the first list, called a consensus hits list, contained all compounds that were classified as hits in both of their replicate measurements . only  <dig> of all the  <dig>  tested compounds were declared consensus hits. the second list, called an average hits list, contained  <dig> compounds classified as hits when the average value of the two hts measurements was lower than or equal to 75% of the reference controls. obviously, all consensus hits were also average hits. a secondary screening of the  <dig> average hits was also performed in order to determine their activity in different concentrations. as result of the secondary screening,  <dig> of the average hits were identified as d-r hits .

generating systematic error
we simulated data in order to evaluate the performances of the systematic error detection tests. first, we generated error-free datasets consisting of random normally distributed data. the basic data format adopted here was that of the mcmaster dataset -  <dig> plates, each containing  <dig> wells arranged in  <dig> rows and  <dig> columns. in addition, we also generated two other basic datasets which were  <dig> and  <dig> times bigger. they also included  <dig> plates, each of them comprising  <dig>  and  <dig>  wells, respectively. it is worth noting that  <dig>   <dig> and 1536-well plates are the most typical plate formats used in the modern hts.

an assay was defined as an ordered set of plates plp, where p  is the plate number. each plate, plp, can be viewed as a matrix of experimental hts measurements xijp, where i  is the row number, j  is the column number, and nr and nc are, respectively, the number of rows and columns in plp. the generated values xijp's followed the standard normal distribution ~n.

then, the hits were added to the datasets. several hit percentages, h, were tested in our simulations: h =  <dig> ,  <dig>   <dig>   <dig>   <dig> and 5%. the locations and values of hits were chosen randomly. the probability of each well in each plate to contain a hit was h%. the values of hits followed a normal distribution with the parameters ~n, where μ and sd are the mean value and standard deviation of the error-free dataset.

in total, five types of datasets, presented in table  <dig>  containing different kinds of systematic and/or random error were generated and tested.

where: x′ijp is the error-affected value in well i,j  of plate p.

xijp is the original value in well i,j of plate p in the error-free dataset.

ri is the systematic error in row i ; it had a normal distribution with the parameters ~n.

xj is the systematic error in column j ; it had a normal distribution with the parameters ~n.

wij is the systematic error that affects well i,j  and is the same for all plates; it had a normal distribution with the parameters ~n.

rip is the systematic error in row i of plate p; it had a normal distribution with the parameters ~n.

cjp is the systematic error in column i of plate p; it had a normal distribution with the parameters ~n.

randijp is the random error affecting well i,j  of plate p; it had a normal distribution with the parameters ~n.

datasets for c =  <dig>   <dig> ×sd,  <dig> ×sd,  <dig> ×sd,  <dig> ×sd and 3×sd were generated and tested, where μ is the mean and sd is the standard deviation of the error-free dataset.

in order to render our simulation study more realistic, we limited the number of rows, columns and wells affected by systematic error. typically, in real hts assays only some of the error parameters  are non null and only a few columns and rows are biased by systematic error. in datasets of types a and b, the number of rows and columns affected by systematic error as well as their locations were chosen randomly. these parameters were identical for all the plates of the assay. in datasets of type d, the number of rows and columns affected by systematic error as well as their locations were also randomly selected, but these parameters were different for different plates of the assay. in datasets of type c, the number of biased wells and their locations were randomly selected and were the same for all assay plates. the datasets used in our simulations were subject to the following constraints. for the 96-well plates, at most  <dig> rows and  <dig> columns , and not more than 10% of the wells  were affected by systematic error. for the 384-well plates, the limits were  <dig> rows,  <dig> columns and 10% of the wells, whereas for the 1536-well plates, systematic error affected at most  <dig> rows,  <dig> columns and 10% of wells.

systematic error detection tests
three systematic error detection methods, including the t-test, the χ <dig> goodness-of-fit test and discrete fournier transform procedure followed by the kolmogorov-smirnov test, were examined in this study in the context of experimental hts.

t-test
the first systematic error detection test was based on the classical two-sample student's t-test for the case of samples with different sizes. in simulation  <dig>  we carried out this test on every row and every column of each assay. in simulation  <dig>  we applied it to the rows and columns of the assay's hit distribution surfaces. in both cases, we divided the data into two independent subsets . the first subset contained the measurements of the tested row or column while the second subset consisted of all remaining plate measurements. in this test, the null hypothesis h <dig>  was that the selected row or column does not contain systematic error. if systematic error is absent, then the mean of the given row or column is expected to be close to the mean of the rest of the data in the given plate or hit distribution surface. for the two samples in hand: s <dig> with n <dig> elements and s <dig> with n <dig> elements, we first calculated the two sample variances s <dig> and s <dig>  and then their weighted average :

  sp2=×s12+×s22n1+n2- <dig>  

the value of the t-statistic was then obtained as presented in equation 4:

  t=μ1-μ2sp <dig>  

where μ <dig> is the mean of the sample s <dig> and μ <dig> is the mean of the sample s <dig>  the calculated t-statistic was then compared to the corresponding critical value for the chosen statistical significance level α  in order to decide whether or not h <dig> should be rejected. while assuming homogeneity of variance in the construction of the t-test, the computation can be optimized using the equivalent contrasts in the context of an analysis of variance.

χ <dig> goodness-of-fit test
the second tested method was the χ <dig> goodness-of-fit test. this test was performed in simulation  <dig> only in order to assess the presence of systematic error in the hit distribution surfaces. it was first recommended in  <cit>  in order to identify systematic error in hts data. the null hypothesis h <dig>  here, is that no systematic error is present in the data. if h <dig> is true, then the hits are evenly distributed across the well locations and the observed counts of hits xij in each row i and each column j of the hit distribution surface is not significantly different from the expected value calculated as the total counts across the entire surface divided by the number of wells. the rejection region of h <dig> is p>α, where cα is the χ <dig> distribution critical value corresponding to the selected α parameter  and to the number of degrees of freedom of the model.

for a hit distribution surface with nr rows and nc columns, we can assess the presence of systematic error in a given row r by computing the test statistic χr <dig> by means of equation 5:

  χr2=∑j=1nc2e, 

where e is the total hits count of the whole hit distribution surface divided by the number of wells  with the number of degrees of freedom equal to nr -  <dig> 

similarly, the columns of the hit distribution surface affected by systematic error can be identified by calculating the test statistic χc <dig>  using equation  <dig> below:

  χc2=∑i=1nr2e, 

where e is the total hits count of the whole hit distribution surface divided by the number of wells  with the number of degrees of freedom equal to nc-  <dig> 

the presence of systematic error in the assay can be detected even if systematic error affects particular wells of the assay, not necessarily located in the same row or column. we can achieve it by calculating the test statistic χ <dig> over all well locations of the given hit distribution surface :

  χ2=∑i=1nr∑j=1nc2e, 

where e is the total hits count of the whole hit distribution surface divided by the number of wells  with the number of degrees of freedom equal to nr × nc -  <dig> 

discrete fourier transform and kolmogorov-smirnov test
the third tested method consisted of the discrete fourier transform  procedure  <cit>  followed by the kolmogorov-smirnov goodness-of-fit test  <cit> . dft has been widely used in the frequency analysis of signals and, in particular, for building the signal's density spectrum. the power density spectrum shows the energy contained in each frequency component existing in the signal. in order to apply dft to hts data we need first to unroll a plate measurement matrix into a linear sequence of measurements. there are two natural ways to do so:  to build the sequence starting by the first row of the plate, followed by the second row, then third one, and so on, and  to start by the first column of the plate, followed by the second column, third one, and so on. the analysis of sequences  and  would allow us to detect column and row effects, respectively. dft detects frequencies of signals that repeat every two, three, four, and so on, positions in the sequence. dft calculates the amplitudes of every possible frequency component. let ykp  be the power density spectrum generated by the dft analysis for the plate p with n wells.

as a second step of this method, we carry out the kolmogorov-smirnov test to compute the probability of the density spectrum ykp occurring under the null hypothesis of no effect. the test statistic d can be calculated as follows:

  d=max1≤k≤n×-k-1n,kn-f), 

where f is defined as the number of values in the density spectrum that are lower than or equal to ykp, i.e., f≡‖ {ylp, 1≤l≤n, ylp<ykp} ‖. big values of d lead to the rejection of the null hypothesis . the method consisting of the dft analysis followed by the kolmogorov-smirnov test was included in some commercial software focusing on the detecting systematic error in experimental data .

RESULTS
simulation 1: detecting systematic error in individual plates
simulation  <dig> consisted of the detection of systematic error on a plate-by-plate basis. artificial hts data for three different plate sizes:  <dig> wells -  <dig> rows and  <dig> columns,  <dig> wells -  <dig> rows and  <dig> columns, and  <dig> wells -  <dig> rows and  <dig> columns were first generated. we started by creating basic error-free datasets for which the well measurements followed a standard normal distribution ~n. for all datasets the number of plates was set to  <dig> - the same as in mcmaster test assay  <cit> . then, we added 1% of hits to each of the generated basic datasets. the hits were added in such a way that the probability that a given well contained a hit was 1%. all the hit values followed a normal distribution with the parameters ~n, where μ and sd are the mean value and standard deviation of the basic dataset .

using these error-free datasets, we generated datasets comprising different types of systematic error, labelled a to e, as reported in table  <dig>  systematic error was added only to some of the assay rows . the number of rows  affected by systematic error as well as the indexes of the affected rows, columns and wells were determined randomly for each considered dataset. six types of error-affected sets were produced for each error-free dataset by varying the standard deviation of systematic error. the following values of the systematic error standard deviation were used:  <dig>   <dig> sd,  <dig> sd,  <dig> sd,  <dig> sd and  <dig> sd, where sd is the standard deviation of the basic dataset. the t-test and k-s test were then applied to error-affected data. both tests produced a binary result for each row and column of each plate: systematic error was detected or not detected in this row or column. the output was then compared to the information from the data generation phase to determine whether the result of the test was correct.

cohen's kappa coefficient  <cit>  was calculated to estimate the accuracy of both statistical tests. cohen's kappa is a measure of inter-rater agreement or inter-annotator agreement. the kappa coefficient, which takes into account the agreement occurring by chance, is computed as follows :

  κ=pr-pr1-pr, 

where pr is the relative observed agreement among raters  and pr is the hypothetical probability of chance agreement. if the raters are in complete agreement, then κ =  <dig>  if there is no agreement among the raters, other than what would be expected by chance, then κ ≤  <dig> 

in our hts context, pr and pr were calculated as follows: pr=tp+tnp× and pr=×+×) <dig>  where p is the number of plates in the assay, nr and nc, are, respectively, the number of rows and columns per plate, tp  is the sum of the numbers of rows and columns where systematic error was added during the data generation and then detected by the test, fp  is the sum of the numbers of rows and columns where systematic error was not added but detected by the test, tn  is the sum of the numbers of rows and columns where systematic error was not added and not detected by the test, and fn  is the sum of the numbers of rows and columns where systematic error was added but not detected by the test.

for all generated variants of error-affected data,  <dig> different sets were created. the averages of obtained cohen's kappa coefficients are represented in figures  <dig>   <dig> and  <dig> . also, the sensitivity , specificity  and success rate  of the two tests are depicted. the sensitivity and specificity of the two tests were calculated as follows :

  sensitivity=tptp+fn, specificity=tntn+fp. 

since datasets of types c and e did not contain row or column systematic error, the sensitivity and cohen's kappa coefficient of both competing statistical tests for these data were undefined .

the kappa coefficient curves in figures  <dig>   <dig> and  <dig> show that the t-test clearly outperforms dft followed by the k-s test for all selected sizes of systematic error, confidence levels and plate sizes. the accuracy of the t-test grows as the size of systematic error increases. it also grows slightly as the plate size increases. the accuracy of the k-s test remains very low and usually varies between  <dig>  and  <dig> , thus suggesting a very poor systematic error recovery by this test. figures 13sm, 14sm and 15sm indicate that the success rate of the t-test is largely independent of the systematic error variance and remains very steady for all tested types of systematic error and plate sizes. in contrast, the success rate of the k-s test decreases as the standard deviation of systematic error increases. the performance of the k-s test is also affected by the size of the plate . the k-s test success rate decreases significantly, and often falls below 50%, for larger plates . the chosen confidence level α affects the accuracy of both statistical tests. for instance, the use of α =  <dig>  generally causes a decrease in the kappa coefficient  and in the success rate  of the t-test, when compared to α =  <dig> . the sensitivity charts  show that the increase in the variance of systematic error leads to the increase in sensitivity of both tests. in terms of sensitivity, the t-test outperforms the k-s test for all data types and all sizes of systematic error, the only exception being large plates tested with the confidence level α =  <dig>  .

similarly to real hts assays, our artificially generated datasets had systematic error in only a few rows and/or columns. they contained many negative and only a few positive samples. such an imbalance between positive and negative samples implies that the overall accuracy of the tests will depend much more on the test specificity than on its sensitivity. figures 4sm, 5sm and 6sm confirm this observation - most of the specificity charts resemble the corresponding success rate charts .

simulation 2: detecting systematic error on hit distribution surfaces
the second simulation, simulation  <dig>  consisted of the detection of systematic error on the hit distribution surfaces. the recommendation to use statistical tests to examine hit distribution surfaces of experimental hts assays was first formulated in  <cit> , in the case of the χ <dig> test. in simulation  <dig>  we also considered artificially generated assays with plates of three different sizes  with the measurements following the standard normal distribution. from every basic dataset we generated  <dig> error-free datasets comprising  <dig> %, 1%, 2%, 3%, 4% and 5% of hits. all the hit values followed a normal distribution with the parameters ~n. using the error-free datasets, we generated assays containing different types of systematic error . systematic error, added to some of the assay rows  only, followed the normal distribution with the mean value of  <dig> and the standard deviation of  <dig> sd. for each such an assay, we calculated its hit distribution surface for the hit selection threshold of μ-3σ. then we applied, in turn, the t-test, and the k-s and χ <dig> goodness-of-fit tests to detect the presence of systematic error.

for each error variant,  <dig> different datasets were generated and the averages of obtained cohen's kappa coefficients were plotted in figures  <dig>   <dig> and  <dig>  the sensitivity and specificity of the three tests were depicted in figures 7sm to 12sm, and the success rate in figures 16sm, 17sm and 18sm. the hit distribution surfaces for the assays of types c, d and e  cannot be used to retrace row or column systematic error. hence, the sensitivity and cohen's kappa coefficient for datasets of types c, d and e were undefined.

the kappa coefficient curves presented in figures  <dig>   <dig> and  <dig> illustrate that the t-test clearly outperforms the χ <dig> goodness-of-fit test as well as the combination of dft and the k-s test for all selected sizes of systematic error, confidence levels and plate sizes. the accuracy of the t-test generally grows as the size of systematic error increases, but this trend is not as steady as in simulation 1: the curve's minimum is not always associated with the lowest systematic noise . the kappa values for the χ <dig> and k-s tests usually varies between  <dig>  and  <dig> , thus suggesting a poor systematic error recovery provided by both of them. as in simulation  <dig>  the success rate of the t-test is largely independent of the systematic error variance . moreover, the success rate of the t-test varies between  <dig> and 100% in the most of simulated experiments. at the same time, the accuracy of the k-s test is extremely low in almost all of the considered situations. the success rate analysis of the χ <dig> goodness-of-fit test suggests that this test follows different patterns for different types of data. for datasets of types d and e, whose hit distribution surfaces did not contain systematic error, the accuracy of the χ <dig> test is very close to that of the t-test . however, for the datasets that contained row and/or column systematic error and well systematic error, the success rate of the χ <dig> goodness-of-fit test is significantly lower than that of the t-test  and shows a tendency to deteriorate when the percentage of hits in the data increases. the sensitivity patterns shown in figures 7sm, 8sm and 9sm demonstrate that the sensitivity of the three statistical tests grows as the percentage of hits contained in the data increases. similarly to simulation  <dig>  choosing a bigger value of α led to a decrease in the accuracy of all tests.

application to the mcmaster data
as a final step in our study we applied the three discussed systematic error detection tests on real hts data. we examined the impact that the presented methodology would have on the hit selection process in mcmaster data mining and docking competition test assay  <cit> . similarly to simulations  <dig> and  <dig> carried out with artificial data, we performed two types of analysis. first, we studied the raw hts measurements, and then calculated and analyzed the hit distribution surfaces of test assay.

we carried out the t-test on every plate of test assay, scanning all rows and columns of each plate for the presence of systematic error. we performed the calculation for several confidence levels including: α =  <dig> ,  <dig> ,  <dig>  and  <dig> . in each case, we counted the number of rows and columns in which the test reported the presence of systematic error and also the number of plates in which at least one row or column contained systematic error. the collected results are presented in table  <dig> 

only  <dig> rows and  <dig> columns of mcmaster test assay were examined because the first and twelfth columns of the  plates were used for controls.

the obtained results suggest that the number of positives for the row and column effects is almost exactly what we would expect by chance . this means that there is no statistical evidence of bias for columns and rows in mcmaster test assay.

for comparative purposes, we corrected the raw mcmaster data using the b-score method in all plates where systematic error was detected by the t-test. unlike the artificially generated data used in the simulation study, mcmaster test assay contained replicated plates - every compound of the assay was screened twice  <cit> . we adjusted our hit selection procedure to search for average hits. thus, we first calculated the average of the two compound measurements and then used it in the hit selection process. if systematic error was detected only in first plate and, therefore, corrected using the b-score method, then the residuals produced by b-score were incomparable with the values of the second  plate. in order to make the measurements in both plates comparable, we normalized both plates by means of the z-score method prior to calculating the average compound activity. using the corrected dataset, we determined the assay hits for two hit selection thresholds: μ-3sd- the most popular hit cutting threshold employed in hts, and μ- <dig> sd- the threshold used by the mcmaster competition organizers to identify the original  <dig> average hits. the obtained results are reported in tables  <dig> and  <dig>  respectively. a comparison between the original set of hits and the newly selected hits is also made in these tables. in fact, these tables report how many of the original hits remained hits, how many of them were removed and how many new hits were selected. for the threshold μ-3sd, only about half of the original hits were preserved, whereas for the threshold μ- <dig> sd about four times more hits were selected for the b-score corrected data. the presented results demonstrate how significantly the selected error correction method and confidence level α can affect the hit selection process in experimental hts.

the t-test was carried out to detect systematic error.

the t-test was carried out to detect systematic error.

in our second experiment, we computed and analyzed the hit distribution surfaces of mcmaster test assay for the hit selection thresholds: μ-3sd and μ-2sd. we assessed the presence of systematic error in the assay by applying the three discussed systematic error detection tests: t-test, k-s test and χ <dig> goodness-of-fit test. all three tests detected the presence of systematic error in both surfaces for both considered confidence levels α =  <dig>  and  <dig> . while the hit distribution surface is useful for detecting the presence of overall bias, it does not capture the variability of the bias on a plate-by-plate basis.

finally, we also applied the well correction method to remove systematic error from mcmaster test assay. after well correction was performed, the hit selection was carried out again for the hit selection thresholds: μ-3sd and μ- <dig> sd. table  <dig> reports the comparative results of the two hit selections. when analyzing the obtained hits for the μ- <dig> sd threshold, one can notice that  <dig> of the original hits were not detected and, at the same time,  <dig> new compounds were selected as hits. figure  <dig> presents a summary of our experiments conducted with mcmaster test assay. the pairwise intersections between the three obtained sets of hits are presented. the dashed grey area in the middle represents the intersections between the three hit sets and thus defines the consensus hits for mcmaster test assay. the results provided by the b-score method  shows that this data correction procedure tends to overestimate, at least when compared to z-score and well correction, the number of hit compounds. on the other hand, the results provided by the well correction method suggest that about one third of the original hits could be, in fact, false positives and that about the same percentage of false negatives could be ignored if systematic error present in the raw mcmaster data is not identified and removed adequately.

CONCLUSIONS
in this article we discussed and tested three methods for detecting the presence of systematic error in experimental hts assays. we conducted a comprehensive simulation study with artificially generated hts data, constructed to model a variety of real-life situations. the variants of each dataset, comprising different hit percentages and various types and levels of systematic error, were examined. the experimental results show that the method performances depend on the assay parameters - plate size, hit percentage, and type and variance of systematic error. we found that the simplest, and computationally fastest method, the t-test, outperformed the kolmogorov-smirnov  and χ <dig> goodness-of-fit tests in most of the practical situations. the t-test demonstrated a high robustness when applied on a variety of artificial datasets. the success rate of the t-test was, in most situations, well above 90%, regardless the plate size, noise level and type of systematic error, while the values of cohen's kappa coefficient computed for this test suggested its superior performance especially in the case of large plates and high level of systematic noise. we can thus recommend the t-test as a method of choice in experimental hts. on the contrary, advocated in some works  <cit>  discrete fourier transform followed by the k-s test yielded very disappointing results. moreover, the latter technique required a lot of computational power but provided the worst overall performance among the three competing statistical procedures. the k-s test can still be used to examine hts data located in small plates , but we strongly recommend not using it for the analysis or large plates  and hit distribution surfaces. the main reason for such a disappointing performance of the k-s test is it that was applied, as recommended in  <cit> , on the data already transformed by the discrete fourier method. figure 19sm presents an example of data from one of the simulated 96-well plates before and after the application of discrete fourier transform. the raw data followed a normal distribution and contained random error only . the raw data did not deviate from the normal distribution, as shown both graphically  and by the k-s test . however, after the application of discrete fourier transform, the data deviate from normality as shown in the graph  and by the k-s test . the third method, the χ <dig> goodness-of-fit test suggested in  <cit> , can be employed to assess hit distribution surfaces for the presence of systematic error. in general, its performances were lower than those of the t-test and were very sensitive to the type of systematic error as well as to its variance. the χ <dig> goodness-of-fit test could be recommended, especially to analyze hts assays with small plate sizes, but we suggest carrying out the t-test as well to confirm its results.

in addition to the experiments with simulated data, we applied the three discussed systematic error detection tests to real hts data. our goal was to evaluate the impact of systematic error on the hit selection process in experimental hts. the obtained results  confirm the following fact: if raw hts data are not treated properly for eliminating the effect of systematic error, then many  of the selected hits may be due to the presence of systematic error and, at the same time, many promising compounds may be missed during hit selection. a special attention should be paid to control the results of aggressive data normalization procedures, such as b-score, that could easily do more damage by introducing biases in raw hts data and, therefore, lead to the selection of many false positive hits even in the situations when the data don't contain any kind of systematic error.

our general conclusion is that a successful assessment of the presence of systematic error in experimental hts assays is achievable when the appropriate statistical methodology is used. namely, the t-test should be carried out by hts researchers to pre-process raw hts data. this test should help improve the "quality" of selected hits by discarding many potential false positives and suggesting new, and eventually real, active compounds. the t-test should be used in conjunction with data correction techniques such as: well correction  <cit> , when row or column systematic error  repeats across all plates of the assay, and b-score  <cit>  or trimmed-mean polish score  <cit> , when systematic error varies across plates. thus, we recommend adding an extra preliminary systematic error detection and correction step in all hts processing software and using consensus hits in order to improve the overall accuracy of hts analysis.

authors' contributions
pd and vm designed the study. pd implemented the statistical tests and carried out the simulations. vm and rn supervised the project and coordinated the methodological development.

supplementary material
additional file 1
supplementary materials. additional file  <dig> includes supplementary materials for the article. this file contains figures 1sm to 19sm presenting additional simulation results  and an example of data distribution before and after the application of the discrete fourier transform  method .

click here for file

 acknowledgements
the authors thank the natural sciences and engineering research council of canada  and nature and technologies research funds of quebec  for supporting this research. we also thank professor jean-jacques daudin and two anonymous referees for their helpful comments. all authors read and approved the final manuscript.
