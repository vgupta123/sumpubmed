BACKGROUND
micrornas , small non-coding rnas of  <dig> to  <dig> nt, play important roles in gene regulation in both animals and plants. generally, mirnas hybridize to the 3'-untranslated region of mrna to downregulate gene expression or to induce the cleavage of mrna and can fully hybridize to the transcripts of target genes  <cit> . previous studies have suggested that mirnas are strongly associated with various cancers and are considered tumor suppressors or oncogenes  <cit> .

in the last few years, high-throughput and robust approaches for monitoring the expression of mirnas have been used to understand how mirnas are differentially expressed under various conditions. the oligonucleotide microarray is one method for detecting mirna expression  <cit> . this approach involves the design of probes based on known mirnas that are collected in mirbase  <cit>  for mirna expression profiling studies  <cit> . however, the approach is restricted to detecting the expression of known mirnas.

second-generation sequencing is an inexpensive and high-throughput sequencing method. this new method is a promising tool with high sensitivity and specificity and can be used to measure the abundance of small-rna sequences in a sample. hence, the expression profiling of mirnas can involve use of sequencing rather than an oligonucleotide array  <cit> . additionally, this method can be adopted to discover novel mirnas. numerous investigations have applied second-generation sequencing for discovering and profiling mirna in various species. using small-rna sequencing, glazov et al. identified  <dig> novel mirnas in chicken embryo and  <dig> differentially expressed known chicken mirnas in three embryonic small rna libraries  <cit> . morin et al. discovered  <dig> novel mirnas in human embryonic stem cells  and  <dig> differentially expressed known human mirnas in two developmental states  <cit> . stark et al. identified  <dig> novel mirna genes in drosophila and used these sequencing reads to validate  <dig> of the genes  <cit> . sunkar et al. identified  <dig> novel mirnas in rice and found  <dig> differentially expressed mirnas in three libraries  <cit> .

these sequencing schemes can generate millions of short sequences. profiling mirna expression levels with second-generation sequencing technologies involves aligning sequences to those in a genome. however, aligning millions of sequences to those in a genome is less efficient than aligning to sequences of known mirnas. several previous studies apply next-generation sequencing to profile mirna expression through aligning sequences against genomic sequence  <cit> . in their work, blat  <cit>  or blast  <cit>  are utilized to map sequencing reads of small-rnas to genomic sequence and the sequences of known mirnas. however, the alignment software, blast and blat, cannot efficiently handle a huge scale of short sequences. to solve this problem, other programs, such as rmap  <cit> , seqmap <cit> , zoom  <cit> , maq  <cit>  and soap  <cit> , are developed for analyzing numerous short sequences and map millions of short sequences to genomic sequences. however, these software cannot achieve their capability when the genomic sequences are not available. in detecting mirna expression, aligning millions of sequencing reads to genomic sequences can be alternatively replaced by aligning these sequencing reads against the sequences of known mirnas. consequently, a tool designed for constructing mirna expression profile through directly aligning millions of short sequences with the sequences of known mirnas is certainly needed.

this work presents a systematic method, mirexpress, for extracting mirna expression profiles from sequencing reads generated by second-generation sequencing. mirexpress is the first stand-alone package that contains mirna information from mirbase  <cit>  and efficiently reveals mirna expression profiles by aligning sequencing reads against the sequences of known mirnas. this approach can be used to determine mirna expression profiles when genomic sequences are unavailable and can greatly reduce the time spent aligning sequencing reads and genomic sequences. furthermore, mirexpress can be used to find novel mirna candidates by aligning reads with sequences of known mirnas of various species. we used mirexpress to extract the mirna expression profiles from two illumina data sets constructed for the human and a plant species to demonstrate the utility of mirexpress. one data set is a publicly available illumina sequencing data set of two developmental states of hescs  <cit> , and the other is a data set we generated in this work using illumina sequencing for three inoculations of arabidopsis.

implementation
in the first step, mirexpress merges the identical reads into a unique read and counts each unique read. then, each unique read is checked to determine whether it contains a full or a partial adaptor sequence. in checking the full adaptor sequence, if the adaptor sequence is in the middle and at the beginning of the read, then the read is removed. if the adaptor sequence is at the end of the read, then the adaptor sequence is trimmed from the read sequence. in checking the partial adaptor sequence, the last bases of the 5' adaptor are used as a probe to match the first bases of the reads. the first bases of the 3' adaptor are used as probes to match the last bases of the reads. if the sequence identities of the matched regions are greater than 70%, these regions are eliminated.

in the second step, each read is aligned with the sequences of known mature mirnas. the information for known mirnas was obtained from mirbase . in mirexpress, the same sequences from different mirnas are analyzed as a single sequence. for example, ath-mir157a, ath-mir157b and ath-mir157c have the same sequence. the proposed alignment algorithm is based on the smith-waterman algorithm and implemented by following single instruction multiple data  instructions  <cit> . when mirexpress is executed on a pc machine with an sse <dig> instruction set, it can compare one mirna with eight sequencing reads simultaneously. however, the proposed software is multiple-processor ready. for example, mirexpress can compare one mirna with  <dig> sequencing reads simultaneously on a computer with eight processing cores. another advantage is the use of a lookup table for scoring: the proposed algorithm can feasibly change the score or penalty for every pair of nucleotides as easily as when changing the match score and mismatch of only one nucleotide pair.

in the third step, mirna expression profiles are constructed by computing the sum of read counts for each mirna according to the alignment criteria . users can set the cutoff of alignment identity based on their requirements when using mirexpress.

previous studies suggest that rna editing occurred in mirnas can affect their interactions to targets and regulate the gene expression  <cit> . the sequence reads with high similarity to known mirnas are valuable for further analysis of rna editing and mutations occurred in mirnas. hence, we also provide a function in mirexpress which can return the sequence reads that are highly similar to known mirnas including the nucleotide mismatch information.

RESULTS
evaluation of illumina reads
in this work, we used two data sets generated using second-generation sequencing to evaluate the capability and effectiveness of mirexpress. the first data set was constructed in this work. the illumina sequencing reads were generated from three inoculations of arabidopsis thaliana . for each inoculation, a. thaliana plants were inoculated with water , bamboo mosaic virus  alone, or co-inoculated with bsf <dig> satellite bamv  . satbamv is a subviral agent and depends on bamv for replication, encapsidation and movement. bamv and satbamv were prepared as described  <cit> . rna extracted from three inoculated leaves of arabidopsis was used for sequencing with the illumina genome analyzer system following the instruction from fasteris which is a biotechnology company headquartered in geneva, switzerland http://www.fasteris.com/.

the other data set consisted of illumina sequencing reads taken from publicly available data generated by morin et al.  <cit> . the sequencing of small-rna libraries yielded  <dig> , <dig> and  <dig> , <dig> 37-nt unfiltered sequencing reads from hescs  and human cell aggregates called embryoid bodies , respectively. the hesc sample was harvested by use of trypsin under non-adherent conditions that induced hescs to differentiate into cells in all three germ layers and form hebs. we analyzed the data set to elucidate the roles of mirnas in the two developmental states  of hescs.

mirna expression profiles in arabidopsis
arabidopsis mirna expression profiles were constructed under three experimental conditions based on an alignment identity of 100% and a length of reads that equals the length of mirna sequences. table  <dig> presents the top  <dig> known arabidopsis mirnas expressed under three experimental conditions . for example, the mirna with the top expression level  is ath-mir158a, with  <dig> ,  <dig>  and  <dig>  read counts for mock, bamv and bamv+satbamv treatment, respectively. the results suggest that ath-mir158a might play critical roles in bamv infection mechanism in arabidopsis. consequently, it demonstrates that mirexpress facilitates the detection of mirna expressions from huge data generated by next-generation sequencing of small-rnas.

mirna expression profiles in human
the mirna expression profiles of hescs were constructed under two experimental conditions, hescs and hebs, based on an alignment identity of 100% and read lengths that equaled the length of mirnas. table  <dig> presents the  <dig> known human mirnas expressed under two experimental conditions . for example, the expression levels  for hsa-mir-25-3p are  <dig>  and  <dig>  for hescs and hebs, respectively. we demonstrated that the expression profiles of known mirnas discovered by mirexpress can be comparable with the results provided by morin et al.

discovery of novel human mirnas by aligning reads to mammalian but not human mirnas
in hescs and hebs,  <dig> and  <dig> novel mirnas, respectively, were detected by aligning reads that cannot be mapped to known human mirnas for all mammals, excluding human mirnas. the alignment criteria are an alignment identity of 100% and read lengths that equal the length of mirnas. table  <dig> gives the top  <dig> expressed mirnas belong to different species . for example, the most abundant sequencing reads matched to cfa-mir- <dig> has  <dig>  read counts in hescs and  <dig>  in hebs. in order to assess the potential mirna precursor of the putative mirna,  <dig> nt 5'-flank and  <dig> nt 3'-flank are extracted from the matched region after aligning the putative mirna against the human genomic sequence. we use mfold  <cit> , which is a software for folding secondary structure from a rna sequence, to obtain putative rna secondary structures of mirna precursor. figure  <dig> shows the structure of a human putative mirna , which is homologous to cfa-mir- <dig>  another human putative mirna  homologous to oan-mir-135a is presented in figure  <dig>  moreover, we obtain the cross-species sequence information from ucsc genome browser  <cit>  to observe the conservation of putative mirnas. from the rna structural logo generated by rnalogo  <cit> , the precursor of hsa-mir-putative- <dig> shows that it is highly conserved among dog, human, mouse and rat. similarly, the precursor of hsa-mir-putative- <dig> is well conserved among six different species, i.e., platypus, opossum, human, mouse, chicken and lizard. consequently, mirexpress can produce abundant sequencing reads of small-rnas for discovery of novel mirnas.

discussion
experimental errors associated with illumina sequencing
in human and arabidopsis data sets, the middle  <dig> %~ <dig> % of the sequencing reads have an adaptor sequence . the location of an adaptor in the middle of the reads means that the start location of the full-length adaptor in the read is not the start of the read. for example, the read sequence "aagccaaggtcgtatgccgtcttctgcttggaaaaa" contains the full-length adaptor from  <dig> to  <dig>  this condition reveals that illumina sequencing has a few experimental errors, but these do not affect further analysis.

comparing the results of the application of a trimming adaptor to arabidopsis obtained by mirexpress with those obtained by other schemes
to confirm the workability of the trimming adaptor method in mirexpress, we compared the use of a trimming adaptor with mirexpress to that with another method, fasteris. use of fasteris involves three steps. first, the adapter sequence is employed as a probe, which allows for exact match inserts to be identified. second, if no adapter sequence is found, the last bases of the sequencing reads are probed successively with use of the first bases of the adapter  until a match is found, identifying inserts in up to  <dig> bases. third, the remaining reads are searched to identify non-exact matches of the adapter. the first four bases of the adapter are used as a probe. the following properties are adopted to determine the presence of the adapter. seventy-five percent of them must be identical to the adapter sequence. the read number distribution is consistent with the read length distribution . the correlation coefficients of the read number distribution for the mirexpress and fasteris methods under mock, bamv and bamv+satbamv conditions are  <dig> ,  <dig>  and  <dig> , respectively. the correlation coefficients of the read count distribution under mock, bamv and bamv+satbamv conditions are  <dig> ,  <dig>  and  <dig> , respectively . the high correlation coefficient indicates that the two methods of trimming the adaptor sequence yield the same results for different lengths of reads. accordingly, the results of applying the trimming adopter sequences with these two methods are mutually consistent.

comparing mirna expression profiles produced by mirexpress and alignment of reads to genome sequences in arabidopsis
a comparison of mirna expression profiles generated with mirexpress and the alignment of sequence reads to genome sequences of arabidopsis suggests that the construction of mirna expression profiles by aligning sequence reads with those of known mirnas is equivalent to aligning the reads to genome sequences. table  <dig> shows the mirnas with the top  <dig> expression levels under mock, bamv and bamv+satbamv treatment by both methods. additionally, aligning reads with mirna sequences can reduce the time required to profile the expression of mirnas to less than that required for aligning reads with genome sequences . these two mirna expression profiles are both constructed according to the criteria that the alignment identity must be 100% and the length of the reads must equal the length of mirnas, such that mirnas that have the same sequence are considered as a single sequence in the detection of the expression levels. for example, ath-mir157a, ath-mir157b and ath-mir157c have the same sequence but are generated from different chromosome loci. these mirnas are regarded as one sequence in the determination of their expression levels because when reads can perfectly match these mirnas, the mirnas to which they belong cannot be identified .

ath-mir157
ath-mir166
ath-mir156
comparing mirna expression profiles generated by mirexpress and method of morin et al
a comparison of mirna expression profiles produced by mirexpress and morin et al. for the human species suggests that different adaptor trimming schemes might result in different mirna expression levels. among  <dig> expressed mirnas, the expression levels of hsa-mir- <dig>  hsa-mir- <dig>  hsa-mir-302b, hsa-mir- <dig>  hsa-mir- <dig>  hsa-mir-199a, hsa-mir-302d, hsa-mir-26a, hsa-mir- <dig>  hsa-mir- <dig>  hsa-mir- <dig> and hsa-let-7e in the study of morin et al. exceed those obtained with mirexpress, but the levels of hsa-mir- <dig>  hsa-let-7a, hsa-mir- <dig>  hsa-mir- <dig>  hsa-mir-302a, hsa-mir-130a, hsa-let-7f and hsa-mir- <dig> in the work by morin et al. are lower than those obtained from mirexpress  . the method of trimming the adaptor sequence is largely responsible for the difference in mirna levels detected. morin et al. firstly trimmed all reads at  <dig> nt. the authors then aligned these reads against the genome and identified the longest alignment for every read. finally, they determined whether the alignment region of read contained a 3' adaptor. with mirexpress, the trimming adaptor sequence is completed before reads are aligned to mirna sequences and reads that can perfectly match mirnas are found. for example, in detecting hsa-mir- <dig> expression levels, morin et al. trimmed reads at  <dig> nt and aligned them with the human genome. the 1~ <dig> bases of some reads were mapped to the hsa-mir- <dig> chromosome location. the 24~ <dig> bases of these reads were trimmed by the morin's methods, and the counts of these reads were summed to represent this mirna expression level. however, the 24~ <dig> bases of some of these reads are not partial adaptor sequences . for instance, the read sequence "aaagtgctgcgacatttgagcgtgcgtgtg" has the same sequence from bases  <dig> to  <dig> as that of mir- <dig>  but bases 24~ <dig> of its sequence "gcgtgcg" do not constitute a part of the adaptor sequence "tcgtatgccgtcttctgcttg". with mirexpress, after the adaptor sequence is trimmed and aligned with mirna sequences, the perfectly matched read is determined. therefore, we recommend that the analytical results of mirexpress are closer to the truth than the results generated by morin's methods. figure  <dig> clearly demonstrates that the method of morin et al. but not mirexpress retains some reads whose 24~ <dig> bases do not form a partial adaptor sequence. accordingly, the detected expression level of hsa-mir- <dig> differs between the two methods.

CONCLUSIONS
this work develops mirexpress, which is a database-supported, efficient and flexible tool for detecting mirna expression profile. all previous programs are designed based on mapping high-throughput sequencing reads to genomic sequence. however, mirexpress is the first design for detecting mirna expression profile from next-generation sequencing reads of small-rnas without the need of sequenced genomes. the expression profiles of mirnas can be monitored if the sequenced genomes are not available. since mirexpress does not align the sequencing reads against genomic sequences, it can greatly reduce the computational time required for the analysis . notwithstanding, similar concepts have been demonstrated in prior studies  <cit> , none of them implements user-friendly and rapid analysis software for mirnas expression profiling. besides, mirexpress produces abundant sequencing reads, which can be served as basis to discover novel mirnas, by aligning the sequencing reads to mirnas in other species. however, people may argue that using known mirnas from multiple species might miss some novel mirnas that are yet to be discovered in any species. to address this issue, the highly expressed reads, which cannot be annotated as the expressed evidences of known mirnas, are listed in mirexpress output pages. the listed sequencing data can be mapped to the genomic sequences for further analysis. actually, we plan to extend this function in mirexpress in the near future. moreover, the analysis of two illumina data sets constructed from human and plant demonstrate the effectiveness of mirexpress to obtain mirna expression profiles and show the usability in finding novel mirnas.

availability and requirements
mirexpress software was written in c++ programming language and can be executed in  <dig> or  <dig> bit linux machine. the software can be freely downloaded at http://mirexpress.mbc.nctu.edu.tw.

authors' contributions
hdh and nsl conceptualized the project. wcw and fml designed and built the database and web interface. wcw, fml, wcc, and kyl performed data analysis. nsl and kyl generate illumina sequencing reads from arabidopsis thaliana. hdh, wcw and wcc wrote the draft. all authors tested the database and interfaces. all authors read and approved the final manuscript.

supplementary material
additional file 1
mirna expressions profile in arabidopsis. arabidopsis mirna expression profile in three experimental conditions

click here for file

 additional file 2
mirna expressions profile in human embryonic stem cells. human embryonic stem cells mirna expression profile in two experimental conditions

click here for file

 additional file 3
novel mirna candidate expression profiles in human embryonic stem cells. using cross-species known mirnas to construct novel mirna candidate expression profiles in human embryonic stem cells

click here for file

 additional file 4
read number distributions between mirexpress and fasteris. comparison of read number distributions obtained using mirexpress and fasteris. the correlation coefficients of read number distribution in mock, bamv and bamv+bsf <dig> are  <dig> ,  <dig>  and  <dig> , respectively.

click here for file

 additional file 5
read count distributions between mirexpress and fasteris. comparison of read count distributions obtained using mirexpress and fasteris. correlation coefficients of read number distribution in mock, bamv and bamv+bsf <dig> are  <dig> ,  <dig>  and  <dig> , respectively.

click here for file

 additional file 6
compare mirna expressions profile in arabidopsis between mirexpress and aligning reads to genome. compare arabidopsis mirna expression profile in three experimental conditions by different methods. one is mirexpress. another is aligning sequence to genome.

click here for file

 additional file 7
mirna expressions profile in human embryonic stem cells between mirexpress and morin et al. compare human embryonic stem cell mirna expression profile in two experimental conditions by different methods. one is mirexpress. another is morin et al.

click here for file

 additional file 8
spending time in constructing mirna expression profiles between mirexpress and blast. the data sets of three experimental conditions in arabidopsis are used to compare spending time in constructing mirna expression profiles between mirexpress and blast.

click here for file

 acknowledgements
the authors thank the national science council of the republic of china for financially supporting this research under contracts no. nsc 98-2311-b-009-004-my <dig> and nsc 98-2627-b-009- <dig>  special thanks to the national research program for genomic medicine , taiwan, for financial support. this work was also supported in part by moe atu. funding to pay the open access publication charges for this article was provided by the national science council of the republic of china and moe atu.
