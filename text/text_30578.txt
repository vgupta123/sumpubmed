BACKGROUND
the advent of next-generation sequencing technology in recent years has provided new opportunities to the field of rna sequencing , which has emerged as a powerful tool for transcriptome study. with advances in sequencing technology, rna-seq, which is cost-efficient and yields sufficient information, has been widely used in both well-studied model organisms and non-model organisms in various studies, including transcript profiling, snp discovery, and the identification of genes that are differentially expressed between samples  <cit> .

for organisms with known reference genomes, mapping-first approaches have often been used for rna-seq analysis. reads were first mapped to the annotated references. then, the assembly of transcripts and the quantification of transcript expression levels were based on the mapping information. alternatively, for those organisms lacking well-defined genomic references, these studies were typically performed using references to related species  <cit> , assembled ests from target species  <cit>  or de novo assembly of rna-seq data  <cit> . to use sequences from related species as references, there must be a well-studied and closely related species. moreover, mapping reads to a related organism may result in a loss of information regarding species-specific genes, and, additionally, no overview of the target transcriptome can be generated. assembling ests from the organism of interest to serve as a reference requires the existence of comprehensive est information, and researchers may lose tissue-specific information. this loss poses a problem because the reliability of the results partly depends on the quality of est assembly. to gain an accurate overview of the transcriptome, de novo assembly is crucial for downstream rna-seq analyses. however, de novo assembly of the transcriptome has some unique challenges, particularly in the case of plants, which possess a large amount of paralogs and isoforms. assembling non-normalized transcriptomes is different from assembling normalized transcriptomes and genomes because the read depth of transcripts is uneven, which, in turn, reflects differences in expression levels. many de novo assembly projects for non-model organisms have used roche  <dig> pyrosequencing technology  because the length of reads generated are much longer than the short reads  generated by illumina solexa and abi solid technologies. however, short-read technologies are much more economical. recently, oases, trinity, and trans-abyss have been developed specifically for rna-seq assembly using short sequence reads and have been applied successfully in many experiments  <cit> .

common wheat  is one of the most important food crops in the world. the large genome , high proportion of repetitive sequences , and hexaploid nature make complete sequencing of the wheat genome a daunting task for even state-of-the-art technologies. in addition to the identification of differentially expressed genes among different phenotypes to understand biological processes, due to the lack of high quality genomic sequence, rna profiling is a practical approach to surveying the wheat genome. however, few wheat studies had taken advantage of rna-seq. cantu et al. <cit>  assembled  <dig>  million  <dig> reads into  <dig>  contigs to study grain protein content gene in wheat. li et al. <cit>  performed an mrna tag analysis of wheat seedlings, rather than using assembly and mapped sequence reads to assemble public ests, to gain an overview of how wheat respond to h2o <dig> treatments. pont et al. <cit>  assembled  <dig>  reads generated from  <dig> sequences of normalized cdna libraries into  <dig>  sequence clusters, accounting for  <dig>  mb, to understand the polyploidization events of common wheat. pellny et al. <cit>  utilized rice sequences and  <dig>  million public ests as references to study the transcriptome of the developing starchy endosperm of common wheat. trick et al. <cit>  mapped short reads from two samples to  <dig>  unigene sequences  to identify snps. however, none of these groups performed de novo short read assembly from non-normalized wheat cdna libraries.

although rna-seq has been successfully used in many non-model organisms to understand transcriptome architecture and various biological processes, the results of de novo assembly from short reads still can be improved by using recent advances in bioinformatics, such as the method of merging single k-mer assemblies  <cit> . strategies for dealing with multiple samples are an important aspect of de novo assembly that still lacks thorough discussion. in this study, we optimized de novo assembly of the hexaploid wheat transcriptome using  <dig>  gb short reads, and we documented every detail of the assembly process and discussed the effects of each assembly step to gain insight into the transcriptome assembly of non-model organisms. this study also provided comprehensive new transcript data to the wheat community.

RESULTS
illumina sequencing
to obtain a general overview of the common wheat transcriptome and an initial comparison of fertile and sterile wheat transcripts, four libraries  were constructed for paired end  sequencing. af, as, sf, and ss were mix samples of fertile anthers, sterile anthers, fertile young spikes, and sterile young spikes of common wheat, respectively. a total number of  <dig>  million 90 bp pe reads accounting for  <dig>  gb of raw data were generated for the four libraries. after trimming the low-quality part at the 3’ end of each read and filtering out singleton reads and reads less than 25 bp in length,  <dig>  million pe reads  were used for downstream analyses . the gc content of raw reads dropped from about 51% to about 40%, suggesting that our data may not have had good coverage across parts of the wheat transcriptome with high gc content .

the numbers in the parentheses indicated the trimmed proportions of reads, bases and the gc content before trimming.

different strategies of de novo assembly
the greatest concern for plant transcriptome de novo assembly is the misassembly of a large amount of paralogs and diverse alleles in plants. considering the fact that common wheat has three sub-genomes, to gain the optimal assembly, several assembly strategies were used and their performance in assembling the wheat transcriptome was compared. we chose two state-of-the-art de bruijn graph assemblers, trinity  <cit>  and trans-abyss  <cit> , which use single k-mer and multiple k-mer methods to generate assemblies, respectively. trinity is reported to be efficient in recovering full-length transcripts and spliced isoforms  <cit> , whereas trans-abyss is reported to yield optimal overall assembly covering wide transcript expression levels by merging multiple individual k-mer assemblies  <cit> . moreover, because we had four libraries reflecting different phenotypes and tissues, we evaluated the performance of assembling each library separately and then merged them or assembled all libraries at the initial stage. for each of these two programs, we performed seven assemblies that can be divided into the following three categories: assembly of all four samples as a whole , assembly of samples with the same phenotype  and assembly of each of the four samples individually . afsf and asss were then merged to form the final assembly , as well as the four individual assemblies of af, sf, as, and ss .

statistics of pre-assemblies
for each of the trans-abyss assemblies, we used k-mer lengths from every odd number starting from  <dig> to  <dig>  to facilitate the subsequent merging step, the scaffolding option, which introduces ns into the assembly results, was turned off. for every k-mer length, the more reads that were used, the larger were the n <dig> and the total sum of assembly . the largest n <dig> of individual k-mer assemblies for afsfasss, afsf, asss, af, as, sf, and ss was 623 bp , 584 bp , 613 bp , 524 bp , 588 bp , 534 bp , and 560 bp , respectively. after merging individual k-mer assemblies, the n <dig> slightly increased for all seven assemblies . in contrast to the trans-abyss results, trinity assemblies had much larger n <dig> and more contigs that were longer than 1 kb. alternatively, trans-abyss produced much larger transcriptomes, which were on average  <dig>  times larger than the results when using trinity .

contigs less than 300 bp were excluded.

merging of individual sample assemblies, redundancy reduction and scaffolding
assemblies from individual samples were merged using cd-hit-est with 100% identity  <cit>  to form the overall assemblies. contigs representing non-sample-specific genes existing across multiple samples were merged into single contigs. after merging individual samples, both the number and the total summed length of contigs had been reduced. the most redundant assembly was trans-abyss_af + sf + as + ss, because the number of contigs had been reduced by  <dig> %. assemblies produced by trans-abyss contained many more non-sample-specific contigs. the merged proportion of the four-sample-merging approach was higher than that of merging two assemblies . after merging separate sample assemblies, we had the following six pre-assemblies: three assemblies from trinity and three from trans-abyss.

a trinity_afsfasss and trans-abyss_afsfasss had not been merged.

detail statistics can be found in additional file  <dig>  contigs less than 300 bp were excluded.

contigs that overlapped with a minimum length of 50 bp and minimum identity of 99% were collapsed into single contigs using gicl to further remove redundancy  <cit> . after this step, a large proportion of contigs had been merged . before deduplication , assemblies produced by trans-abyss had a much greater number of contigs and total summed length than those of the counterpart trinity assemblies. after the removal of redundancy, both the number of contigs and the summed lengths were lower than those of the counterpart trinity assemblies . moreover, this deduplication step significantly increased the n <dig> of the three trans-abyss assemblies . merging individual assemblies, including multiple samples or multiple k-mer assemblies, introduced more redundancy.

to reduce fragmental degree, contigs were joined using read pair information as implemented by sspace  <cit> . after scaffolding, the n <dig> of all six assemblies had been slightly increased by approximately  <dig> % .

assessment of novelty and redundancy
to determine whether the different assembly sizes and contig numbers were mainly due to novel sequences in each assembly or redundancy, pairwise comparisons of the six assemblies were performed using blat  <cit> . the novelty and redundancy of each assembly were determined by the proportion of base coverage by the other five assemblies with a high threshold . pairwise comparisons showed that the trinity_af + sf + as + ss assembly had the most novel bases, whereas the trans-abyss_afsf + asss assembly had the fewest. trinity assemblies had more novel sequences  than those of trans-abyss . assemblies produced by the same assembler were covered more frequently by each other .

to evaluate assembly redundancy, reads from all four samples were mapped to the six assemblies. the proportion of reads mapped to more than three locations was used as an indicator of redundancy. on average, after removing redundancy and scaffolding, trans-abyss assemblies were less redundant than trinity assemblies . similarly, the merging samples approach resulted in more redundancy, whether using trinity or trans-abyss. the most redundant assembly was trinity_af + sf + as + ss, of which  <dig> % of its mapped reads had more than three hits. the contig number and total size of trinity_af + sf + as + ss were also the largest among the six assemblies.

assessment of sample specificity
to evaluate the performance of assembling all libraries at the initial stage and assembling each library separately and then merging them for each of the two assemblers, we performed three assemblies, afsfasss, afsf + asss, af + sf + as + ss, representing the assembly of all samples, samples with the same phenotype, and individual samples at the initial stage, respectively. the purpose of this evaluation was to determine whether afsfasss and afsf + asss lost a considerable amount of sample-specific transcripts or if afsf + asss and af + sf + as + ss contained more redundant transcripts and more fragmental transcripts.

reads from four samples were mapped to the six assemblies separately. with the exception of trinity_afsfasss, the proportions of reads for the four samples mapped to the other five assemblies were equivalent, indicating that the assemblies did not favor certain samples. as for trinity_afsfasss, the proportion of mapped reads from the ss sample was only  <dig> %, and those for af, as, and sf were all above 80%, suggesting that trinity_afsfasss was less represented in the ss sample. in the instance of the af sample, the proportion of reads mapped to trans-abyss_afsfasss, trans-abyss_afsf + asss, and trans-abyss_af + sf + as + ss was  <dig> %,  <dig> %, and  <dig> %, respectively, suggesting that for trans-abyss assemblies, the more assemblies that were merged, the less reads were mapped, which differs from trinity assemblies. merging individual trinity assemblies increased mappable reads.

assessment of continuity and accuracy
a full-length common wheat cdna dataset from trifldb was used to evaluate assembly continuity  <cit> . this dataset contained  <dig>  sequences ranging from  <dig> bp to  <dig>  bp in length . six assemblies were used to blat against these full-length transcripts. the proportion of numbers and bases of full-length transcripts covered by each of the six assemblies was calculated and are shown in table  <dig>  approximately 90% of full-length cdnas were matched by the six assemblies separately, and nearly all matched assembled transcripts covering over 90% of the full-length cdna in length. trinity outperformed trans-abyss in assembly continuity , and for both assemblers, merging individual assemblies decreased contig length, particularly for trans-abyss.

another metric of assembly performance is transcript accuracy. to gain a general overview of transcript accuracy, a custom est library, constructed using the recurrent parent chinese spring  containing  <dig>  sanger-sequenced ests ranging from 100 bp to 922 bp in length  was used . with the threshold minimum of 98% base identity, trans-abyss_afsfasss covered  <dig> % cs ests bases, which was greater than the other five assemblies. on average, trans-abyss assemblies were much more similar to the cs ests than those of trinity .

comparisons with public wheat ests
to compare the six assemblies to other publicly available transcript data, all common wheat ests deposited at dbest/genbank were downloaded . similarity searches against this est dataset were performed . the proportions of public common wheat ests bases covered by these six assemblies were all approximately 80%, and the highest one was trans-abyss_afsfasss. in general, approximately 80% of est bases were covered by these six assemblies. however, the proportions of the six assemblies covered by this est dataset varied, with the lowest being  <dig> % from trinity_afsfasss to the highest being  <dig> % from trans-abyss_af + sf + as + ss.

a proportion of public ests matched by assembled transcripts.

b proportion of assembled transcripts matched by public ests.

size of wheat transcriptome
the sizes of the six assemblies varied from  <dig>  mb to  <dig>  mb. these transcripts were mapped to a draft genomic sequence of ae. tauschii, which is the diploid progenitor of common wheat . we selected only  <dig>  scaffolds ranging from 300 bp to  <dig>  bp in length from the d genome sequence to perform the alignments. assembled transcripts from the six assemblies were aligned to the draft reference sequence using bwasw with default parameters   <cit> , and the numbers of covered bases for the diploid sequence were calculated as shown in table  <dig>  on average, approximately two transcripts aligned at a single locus for all six assemblies, whereas the coverage range differed dramatically. trinity_afsfasss covered about  <dig>  mb for this diploid draft genome, which was the most among the six assemblies .

assembled transcripts were aligned to the draft genomic sequence. for the covered regions of the reference by assembled transcripts, mean coverage indicated how many transcripts covered on average for a certain region.

discussion and 
CONCLUSIONS
in this study, we constructed six wheat transcriptome assemblies using different assemblers and merging strategies on  <dig>  gb pe data. we divided the assembly processes into the following four steps: pre-assembly, merging samples, removal of redundancy, and scaffolding. we recorded the effects of each step in detail. the yielded six assemblies had promising n <dig> , continuity , and accuracy .

performance comparisons between trinity and trans-abyss
trinity, which uses the single k-mer method, outperformed trans-abyss in assembly continuity. the average n <dig> of the three trinity assemblies was  <dig> % longer than that of trans-abyss . all three trinity assemblies covered more bases of full-length cdna than their counterpart trans-abyss assemblies . after the same procedures, trans-abyss assemblies, which were produced by the multiple k-mer method, were less redundant  and covered a greater proportion of existing sanger-derived ests , representing a good spectrum of expression levels.

pairwise comparisons of these six assemblies suggested that assemblies produced by the same assembler were more similar to each other. there was a tradeoff between specificity and sensitivity based on the choice of k-mer size. assemblies with larger k-mers had fewer spurious overlaps but lower coverage. low-expression genes were assembled more effectively with small k-mer sizes, leading to the assembly of numerous and highly fragmented transcripts, whereas high-expression genes were assembled more effectively with large k-mer sizes, emphasizing contiguity  <cit> . for trinity, we used the default k-mer size of  <dig>  while trans-abyss used every odd number starting from  <dig> to  <dig>  to test whether the different k-mer sets used by trinity and trans-abyss caused the low level of overlapping regions, we reassembled an assembly with all four samples together using a single k-mer size of  <dig>  as implemented by abyss version  <dig> . <dig>  <cit> , named abyss_afsfasss_k <dig>  when abyss_afsfasss_k <dig> was compared with trinity_afsfasss,  <dig> % of trinity_afsfasss bases were covered, which was lower than the  <dig> % of bases covered by trans-abyss_afsfasss . this suggested that when using the same k-mer size of  <dig>  abyss and trinity still had a large proportion of unique bases. for the initial assemblies, trans-abyss produced assemblies that had more contigs that were much larger than those of trinity . for this dataset , both trinity and trans-abyss had good performance, and the majority of reads were able to map to the six final assemblies, particularly for the trans-abyss_afsfasss .

merging assemblies of individual samples
rna-seq analyses often deal with multiple samples. in this study, we compared the performances of different assemblers and merging strategies. the greatest concern for assembling all samples at the initial step is the loss of sample-specific transcripts. with the exception of trinity_afsfasss, the other five assemblies, including trans-abyss_afsfasss, had equal proportions of the four samples, suggesting that using reads from all samples together may not always introduce bias from over- or under-represented samples.

for the single k-mer assembler trinity, merging assemblies of individual samples increased the number of mappable reads  and the proportion of bases covered from full-length cdna and public ests , suggesting that the merging strategies broadened the coverage of the assemblies produced by trinity. alternatively, merging trinity assemblies slightly decreased the base coverage of full-length transcripts  and n <dig> , suggesting that merging assemblies from individual samples decreased continuity. the main defect was the substantial introduction of redundancy, as indicated by the decreased number of uniquely mapped reads and increased number of repetitively mapped reads .

for the multiple k-mer assembler trans-abyss, merging assemblies from individual samples had the following shortcomings: shorter n <dig> , fewer number of mappable reads, reduced proportions of bases covered from full-length cdna and public ests, and slightly increased redundancy .

removal of redundancy
a large assembly including transcripts across a wide range of expression levels but containing many redundant contigs/scaffolds could be worse than a small assembly only contain unique bases. redundancy can pose difficulties in the downstream analysis.

after merging assemblies from individual samples, the overall contig numbers from these six assemblies were still very high , even when considering the various transcript isoforms . the reason might be sequencing errors and potential sequence variations among individual plants. thus, we implemented a clustering step to remove redundancy. a major concern of removing redundancy is the mis-assembly of highly similar transcripts. although there is no straightforward way to evaluate the performance of this step due to the lack of well-defined genomic sequences, we used two datasets to assess the parameters we used: one with  <dig> wrky transcription factors detected from common wheat unigenes, and the other with  <dig> groups  of orthologous genes from a, b, and d subgenomes of hexaploid wheat, representing conserved gene families and highly similar but distinct sequences, respectively . with the thresholds of a minimum length of 50 bp and minimum identity of 99%, none of these sequences were assembled together suggesting the parameters we used in removing redundancy is proper.

after removing duplications using this strict standard, for the trinity_afsfasss that was assembled without merging individual assemblies,  <dig> % of its contig number and  <dig> % of its total length had been reduced. to compare the effect of deduplication, we reproduced an assembly  that used every procedure used for assembling the trinity_afsfasss without the step that removes redundancy. trinity_afsfasss_2nd had an n <dig> of  <dig>  bp contained  <dig>  scaffolds ranging from 300 bp to  <dig>  bp in length. trinity_afsfasss_2nd, with a total size of  <dig> ,671 bp, was mapped to the draft diploid ae. tauschii sequence using the same parameters used for trinity_afsfasss. trinity_afsfasss_2nd covered about  <dig>  mb, which was equivalent to that of trinity_afsfasss, suggesting that the removing the redundancy step that we used may not greatly reduce unique transcripts and was appropriate to use . to further compare the effects of removing redundancy, reads from the four samples were mapped to trinity_afsfasss_2nd. comparing to trinity_afsfasss, the total number of mappable reads slightly decreased by  <dig> %. moreover, the proportion of reads mapped to more than three locations increased from  <dig> % to  <dig> %, and the uniquely mapped reads were reduced from  <dig> % to  <dig> % . it is probably difficult for this assembly to generate accurate overall downstream rna-seq analyses, suggesting that proper removal of redundancy may be crucial for polyploidy plant transcriptome assembly.

using assembled ests or de novo assemblies as references
in general, only uniquely mapped reads can be used in common downstream rna-seq analyses, including snp discovery and the identification of genes that are differentially expressed between samples. this was the reason we used mapped reads, especially the number of uniquely mapped reads as a measurement of assembly performances. considering the large amount of common wheat cdna that already exists in the public domain, we mapped all reads to the following two most commonly used assembled est datasets: wheat gene index  and wheat put assembly   <cit>  . the proportions of mappable reads, repetitively mapped reads, and uniquely mapped reads were  <dig> % and  <dig> %,  <dig> % and  <dig> %,  <dig> % and  <dig> % of tagi and taput, respectively. when compared with the results of de novo assemblies, a more accurate overview of the wheat transcriptome can be obtained using de novo assemblies as references, particularly the trans-abyss_afsfasss .

the gc content of the six de novo assemblies was about 48% , and those of  <dig> , <dig> common wheat ests, tagi and taput were  <dig> %,  <dig> % and  <dig> %, respectively. the lower level of gc content for these assemblies may be due to filtered reads, which were already gc content-less-presented .

construction of wheat transcriptome with short reads
due to the lack of a well-annotated genomic sequence, we could not assembly the wheat transcriptome using a mapping-first strategy. to assess the performance of assembling the wheat transcriptome using short reads, we used the existing public wheat ests, a custom chinese spring cdna library and a draft genome sequence of ae. tauschii, the wheat d genome progenitor.

by mapping assembled transcripts back to the draft ae. tauschii sequence, the number of bases covered by each of these assemblies was used to compare the total number of bases constructed from each assembly. combining the length of n <dig> for these assemblies from both assemblers, the more reads that were used at the initial assembling step, the more unique bases that were constructed in the final assemblies. considering that we had used the maximum of  <dig>  gb reads at the pre-assembling step, which was already more than  <dig> times larger than the size of the final assemblies, further improvements in assembly may need even more reads or longer reads. the use of  <dig>  gb data has already provided promising results. nearly all assembled transcripts, which were matched by full-length cdna using blat, covered 90% of full length cdna in length , suggesting that the length of transcripts assembled by illumina reads was acceptable.

on average, more than one transcript was mapped to the same locations of the draft ae. tauschii sequence for all six assemblies , which was expected, because the reference is diploid while the transcriptome is from hexaploid wheat.

to compare the assemblies with existing wheat resources, all of the currently available wheat ests were aligned to the same ae. tauschii sequence. a total of  <dig> , <dig> common wheat ests deposited in genbank covered  <dig>  mb of reference sequences, which was less than that of four of the six assemblies . considering the direct comparison results between these assemblies and public ests , this study also provided considerable new wheat transcript resources to the research community.

