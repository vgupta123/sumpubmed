BACKGROUND
in a relatively short time microarrays have become a well established technique, widely used by researchers. microarrays offer nothing less than to be able to monitor simultaneously the expression levels for thousands of genes.

the rna molecules from the biological sample are called targets, and the polymers of nucleic acids fixed on the surface are called probes. the very large number of genes represented on each microarray requires the use of computer based approaches. although such approaches currently constitute a very rich and active area of research, for many data analyses this step can be summarized simply: under the prior assumption that for the large majority of the genes represented on a microarray the expression will not vary significantly across experiments, the main focus is be to isolate the few genes of interest from the rest. short oligonucleotide arrays are a particular type of microarrays. short oligonucleotide arrays are constituted of short probes  with several probes designed to match different part of the target sequences. the use of techniques originating from the micro-electronics industry proved very successful in the making of short oligonucleotides arrays  <cit> , helping the affymetrix company establish itself as one of the primary manufacturers for microarrays. the pre-processing of oligonucleotide array data differs from other microarray data, specifically because probe intensities associated with each gene are generally summarized by an expression value, or expression index. as it contributes to the computation of the expression values, this step alone is of importance. different algorithms have been suggested to replace and improve affymetrix's original algorithms  <cit> , including e. lazaridis et al.'s playerout  <cit> , li and wong's model  <cit> , medianpolish  <cit> , and affymetrix's own improvements to its algorithms  <cit> . however, information about the individual probes was not disclosed until a few years ago. only with the release of the probe sequences for a significant number of affymetrix chips, data analysis approaches considering the nature of individual probes have been made possible. the use of the chemical nature of the probes, on which depends the binding energy with complementary sequences, has already been suggested to improve pre-processing of affymetrix data at the probe level  <cit> .

the annotation for sequenced genomes have progressed considerably since the design of the affymetrix chips, even the most recent ones, and matching the latest transcriptomic  data available with the chip designs is an obvious thing to do.

we have performed such a remapping for a few affymetrix chips, and we show that the resulting probe-to-gene mapping can differ substantially from the original affymetrix mapping. this can affect the interpretation of experimental data.

as annotations of genomes continue to evolve, it is also desirable to have a framework to perform and handle up-to-date probe-to-gene mapping. we provide an open source and documented implementation to do so.

RESULTS
the results obtained are subdivided in two main categories: the matches between probes and reference sequence obtained, and the difference in the outcome of an analysis when using an alternative mapping.

probes matching multiple refseq entries
a fair number of probes were found to match several reference sequences, as shown in figure  <dig> 

for example, the refseq nm_ <dig>  is found to have  <dig> matching probes. eleven of these matching probes also match another reference sequence: nm_ <dig> . a quick look at the annotation reveals that both reference sequences are two different transcripts variants of the same gene 'homo sapiens intercellular adhesion molecule  <dig>  landsteiner-wiener blood group ' and that the same probes are found matching these two sequences. however the ten remaining probes matching nm_ <dig>  are also found matching a fairly large number of other reference sequences . we found that these probes are designed to match sub-sequences frequently found in mrna: alu repeats. all the probes matching alu repeats are in the official mapping grouped in a common probe set, called 'human alu'.

besides 'human alu' probes, other probes matching multiple reference sequences were found. in that case, the reference sequences matching a given probe have closely related annotations, or even identical annotations. complex mixtures of partial overlaps for the probe sets can then be observed. as an example, the probe  <dig> is found matching the reference sequences nm_ <dig> , nm_ <dig> , nm_ <dig> , nm_ <dig> , nm_ <dig> , nm_ <dig> , nm_ <dig>  and xm_ <dig> , annotated 'h2b histone family, member s , mrna', 'histone  <dig>  h2bl , mrna', 'histone  <dig>  h2bn , mrna', 'histone  <dig>  h2bm , mrna', 'histone  <dig>  h2bi , mrna', 'histone  <dig>  h2be , mrna', 'histone  <dig>  h2bk , mrna' and 'similar to histone h2b 291b , mrna' respectively.

such matches in each case require expert annotators to curate the alternative mappings, so we chose to simply ignore the probes matching several reference sequences in the rest of this study.

other multiple matches are more easy to handle, and potentially more harmful when included in an analysis. some probes are found to hybridize to several unrelated reference sequences, as shown in figure  <dig>  only  <dig> probes that were labeled mismatches in the official mapping, were found to be legitimate perfect match probes in the alternative mapping.

reference sequences matching all the probes from probe sets
we also found a significant number of reference sequences for which all the matching probes belong to one probe set in the official mapping. when a 'one to one' association can be established between a probe set of the official mapping and a probe set in an alternative mapping, which means that a given reference sequence matches all the probes associated with one affymetrix id, we conclude a complete agreement between the alternative mapping and the official one . that is the case for  <dig> out of  <dig> reference sequences . when the association is 'one-to-many', in the sense that several complete probe sets in the original mapping are matching one reference sequence, one could conclude that, alternative splicing events left aside, some probe sets are redundant .

we obtain  <dig>   <dig>   <dig>   <dig> and  <dig> reference sequences for which the matching probes are coming from  <dig>   <dig>   <dig>   <dig> and  <dig> original probe sets respectively. the figure  <dig> shows that it represents a significant part of the cases. this represents 8% of the original probe sets of a hg-u133a that are potentially redundant.

effect on the outcome of an analysis
naturally the expression values, or expression indexes, computed from the probes intensities are sensitive to differences in the mapping: different probes will give different summary expression values, which can have an effect on the outcome of an analysis. to verify it, we performed a standard exploratory analysis of affymetrix data . the probe level intensities were pre-processed and expression values computed. the original mapping was used to obtain a first set of expression values , while the alternative mappings made from matching ncbi's reference sequences was used to obtain two more sets of expression values , using all the matching probes or all the probes matching uniquely respectively. in other words, the set alt <dig> differs from the set alt <dig> in the sense that probes in alt <dig> matching several reference sequences were removed from alt <dig>  the set affy describes  <dig> probe sets, the set alt <dig> describes  <dig> probe sets  and the set alt <dig>  <dig> probe sets . the number of mismatch probes in the official mapping that are found in the alternative mappings is low:  <dig> in alt <dig> and  <dig> in alt <dig> 

for each one of the three sets, 'significantly differentially expressed genes'  are searched for: a welch's two-sample t-test is performed on all the expression values in each set, and the selection for significant p-values done as described by ventura and collaborators  <cit>  . the number of sdegs obtained in the sets affy, alt <dig> and alt <dig> are  <dig>   <dig>  and  <dig> respectively. table  <dig> shows how many of these represent identical probe sets.

however, there is also a significant fraction of probe sets for which no simple equivalence could be made. as shown when discussing the matches, the situation is rather complex and a detailed examination for each case would be needed before a comparison between the mappings is possible. the presence of mismatch probes in the alternative mappings does not appear to have much influence. a legitimate concern can be that some of the probe sets in the alternative mappings only contain one or two probes, therefore the results obtained with theses probe sets may be dubious. in fact, only very few of these probe sets contain a small number of probes, as shown in figure  <dig>  moreover, the minimal acceptable number of probes in a probe set has been reported to be lower than the number of probes commonly used  <cit> . validation of the results found with our alternative mappings will have to be done in silico through the curation of the mappings by expert annotators and experimentally with techniques like rt-pcr.

software for inter-exchange mappings
we present a complex situation, with new probe sets built on matches between ncbi's refseq reference sequences and the sequences of the short oligonucleotide probes found on commercial arrays. this would be of little practical use for the research community without an easy access to the data or the tools used to obtain them. the framework developed in the package 'affy', an open-source and documented collection of data structures and functions for the analysis of genechip oligonucleotide arrays at the probe level, is currently used by a growing number of researchers. we take advantage of the features it offers by providing alternative mapping objects that can be 'plugged in', and used instead of the original ones, whenever wanted. the bioconductor package 'altcdfenvs' contains helping functions, and documentation explaining how to achieve this.

discussion
we performed a matching of the affymetrix probes against the latest reference sequences from ncbi's refseq data bank. a number of probes appear to match a large number of reference sequences, hence to match a large number of transcripts. when analyzing a real data set with state-of-the-art processing methods, we observe that the outcome of an analysis can be influenced by inaccuracies in the probes mapping. this is a potential problem when more and more people use 'high-throughput' procedures, to select 'significantly important genes' in an automated or semi-automated fashion.

we introduce an alternative mapping between probes and identifiers, our identifiers being ncbi's refseq ids, and offer for download alternative mappings for the affymetrix chips hg-u95av <dig> and hg-u133a.

the affy package is a free environment to work with affymetrix data at the probe level. it has capabilities to include alternative mapping and use them in a simple way.

our work aims at showing potential problems. biological expertise remains necessary to discuss the exact nature of each match. affymetrix offers at their netaffx web site  <cit>  a tool that allows visualization of probes matching to multiple sequences. as the annotation of the human genome improves over time, our environment allows to update the probe-to-gene mapping accordingly and analyze microarray data using the best biological data and knowledge available.

the environment for alternative mappings we present could also be of use when using genechips designed for a certain organism with mrna known to differ .

CONCLUSIONS
we built new 'probe to gene' mappings by matching the sequences for the probes found on human affymetrix genechip arrays against ncbi's refseq database of sequences. solely observing the distribution of the probes matching reference sequences, and comparing the results with the mapping provided by the manufacturer of the chips, we found potential problems such as probes matching several reference sequences and probes from different probe sets in the official mapping matching all the same reference sequence. depending on the mapping used, the outcome of the data analysis will change as different genes may be selected as differentially expressed. we suggest that a good mapping of probe to genes changes in time, follows the most recent updates in sequence databases . we like to picture the current situation, where the mappings are frozen, as a dorian gray-like syndrome: the apparent eternal youth of the mapping does not reflect that somewhere the 'picture of it' decays. we developed a set of open-source tools, perfectly integrated to an already existing working environment for affymetrix arrays. the tools are documented and made available to the research community. they let one reproduce our results, and build other mappings.

