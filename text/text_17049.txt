BACKGROUND
the biological function of many proteins can only be understood in the context of their relationships with others. for this reason the biological knowledge represented in the "interactome"  cannot be derived from the properties of the isolated proteins. in recent years, efforts have attempted to decipher networks of protein interactions using experimental and computational approaches  <cit> .

one of computational techniques for predicting and studying protein interactions widely accepted by the community is that based on the similarity of phylogenetic trees. this arose from the initial qualitative observation of topological similarities between the phylogenetic trees of a number of interacting protein families  <cit> . later these observations were systematized and quantified, and the use of tree-similarity based methods to separate interacting and non-interacting families in large sets of proteins was proposed  <cit> . this original mirrortree approach was subsequently improved in different ways, for example by introducing a correction for the background similarity created by the underlying speciation events  <cit> . the hypothesis that explains the relationship observed between tree similarity and interaction states that physically or functionally interacting proteins are subject to similar evolutionary pressure and forced to adapt to each other, both factors resulting in similar evolutionary histories, which are in turn reflected in similar trees. although the co-adaptation hypothesis is still a matter of debate  <cit> , the relationship between tree similarity and protein interaction has repeatedly been demonstrated by different authors in different test sets.

mirrortree and related approaches indirectly measure the similarity of two phylogenetic trees by comparing the distance matrices obtained from the trees or from the multiple sequence alignments. this has been demonstrated to be a practical shortcut that avoids the complications associated with the direct comparison of trees, a problem yet to be fully resolved. to compare the distance matrices, a "mapping" or correspondence between the leaves of both trees has to be established in order to confront the appropriate elements of the matrices. hence, having a common underlying rationale, this mirrortree approach has two main angles. in the first, the mapping between the sequences of the two families is known . in this case, the similarity of the trees according to this mapping is evaluated in order to assess the possible interaction between these two families of orthologues  <cit> . in the second, the interaction between the two families is known and the expected high similarity between their trees is used as the criteria to select the mapping . this approach, introduced by ramani & marcotte  <cit>  and followed by others  <cit> , explores different sets of relationships between two families of interacting proteins  on the basis that the correct mapping will be that which maximizes the similarity between the trees. this situation is particularly common in eukaryotic organisms where there are many cases of large families of interacting paralogues for which only one or a few pairs of interacting proteins have been experimentally determined, and where the goal is to decipher the entire set of interactions between the two families.

the way in which most of these methods explore different mappings is by swapping pairs of columns in one of the distance matrices. it is easy to see that swapping two columns  is equivalent to interchanging the mappings of two proteins . the exhaustive exploration of all possible mappings will require n! calculations for a set of n elements, which soon becomes unfeasible for large protein families. for this reason, current methods use heuristic approaches  to perform a "guided" non-exhaustive exploration of the solution space. due to their intrinsic heuristic nature, these methods do not ensure the global best solution will be found, and they are easily trapped within local sub-optimal solutions. to partially overcome this problem, these methods are run several times in the search for a consensus between the different analyses, commencing each execution from a different point in the solution space. some of the methods also make use of the fact that the distance matrices have an underlying tree structure behind them that imposes some restrictions on the possible mappings, thereby reducing the search space  <cit> .

another intuitive way of decreasing the number of mappings to be explored is by avoiding pairings between proteins of incompatible "classes", for example between proteins of different species in families that contain both orthologues and paralogues. we have developed a new monte carlo based method to predict the mapping between two interacting protein families. this method overcomes some of the limitations of previous approaches by taking advantage of the information available on the species from which the trees are derived. basically, the method does not allow pairings involving proteins from different species, or "incompatible classes" in general. this is different to applying the previous equivalent approaches separately to each of the species , since even if the mapping is restricted to intra-organism pairings the information of the whole tree is used to assess these mappings.

we evaluated the performance of this method on a large set of interacting protein domains and a well described case of co-evolving interacting families: the sensor kinases and response regulators of the ntr-type two component system. this analysis proved to be more accurate than previous approaches. additionally, the spectrum of variables related to the number of proteins within the families, the number of species in the alignments, the complexity of the trees, etc., could for the first time be explored to set the boundaries of the expected accuracy and its dependence on the characteristics of the data.

RESULTS
we first present the results for the large dataset of interacting domains. this allows to obtain performance figures based on a statistically large number of examples. then, we discuss in detail the results for the ntr-type two-component system.

large-scale evaluation based on interacting protein domains
the relationship between accuracy  and family size  shows that smaller families tend to produce better results . this makes sense since the smaller the family the smaller the number of possible mappings  and hence, it is easier for the algorithm to find a good mapping. for most of the proteins  the accuracy values are around 50â€“80%.

in terms of the relationship between the accuracy and the average number of paralogues , the method performs better when there are fewer paralogues for each organism . as the number of paralogues decreases, the size of the solution space also decreased drastically, since only pairs between proteins from the same organism were admitted.

the relationship between the accuracy and the number of pairings between the two families, that is the percentage of proteins that were involved in an interaction  was assessed . it must be remembered that for the test set to remain as close to the real situation as possible, we did not require all the proteins to be paired. indeed, the test set contains pairs of domains with many members in the corresponding families for which only a few were involved in interactions. it can be seen that it is easier for the method to succeed when more proteins are involved in interactions, while the results are worse when a smaller fraction of proteins were involved in interactions.

the dependence of the accuracy on the information content of the trees is shown in figure 1e. it is clear that this method works better as the trees contain more information. trees with low information content have a characteristic "star-like" shape, meaning that all the distances between leaves are very similar. this similarity of the distances makes ambiguous the matching with other trees, since there are many equivalent possibilities producing the same score. so, in general trees with high information content are associated to better results. however, it can be seen that trees with very low information content  also produce good results. this is an artefact due to the fact that the entropy is not totally independent on the number of sequences. trees with few sequences tend to produce low entropies and good results since the size of the search space is smaller . if we disregard this artefact it was clear that more informative trees produced better results.

the whole methodology is based on the fact that interacting families show similar phylogenetic trees. even if this is true for most cases, it has been shown that the trees of some particular interacting families are not correlated  <cit> . in these cases, tag_tsema, or any other method based on tree-correlations, would not be expected to work. to quantify this, we studied the relationship between accuracy and tree similarity for both the real mapping and for the best solution found by the heuristic method . it can be seen that there is a clear relationship between both similarities and the accuracy, although this relationship was higher for the similarity obtained from the real mapping. hence, the method would be expected to work well for pairs of families with a clear co-evolutionary behaviour, as represented by a high similarity of their corresponding phylogenetic trees.

trying to better evaluate the contribution of "tagging" to the improvement of the results, we represent the relationship between the accuracy, the average number of sequences per tag  and the number of organisms. if tagging is improving the results, the highest accuracies should be in the region of large number of organisms and low sequences/organism. this seems to be the case .

in order to compare the influence of all the different factors mentioned above on the performance of the method, we performed a multiple regression in which the independent variables were these factors and the dependent variable was the accuracy. the corrected r <dig> of this multiple regression is  <dig> , indicating that the success  is clearly dependent on these factors. the coefficients of the different factors in the regression indicate the extent to which each of them contribute to the accuracy, and whether this contribution is positive or negative . the most influential factor is the average number sequences per organism, and the negative sign indicates that it contributes negatively . the next factors in terms of their importance in determining accuracy, are the score for the best solution found by the algorithm and the fraction of proteins that have some pairing. apparently, the accuracy is relatively independent on the information content of the trees, as reflected in the coefficient close to  <dig>  however, this is an artefact due to the "u" shape of the boxplot representing the relationship between the entropy and the accuracy discussed previously . this shape brought the global best fit line closer to the horizontal, which is indicative of no dependence.

ntr-type two-components system
to illustrate the predictive power of this method in a real-life scenario, we tested the method with a well-studied example of two interacting protein families: the sensor kinases and transcriptional regulators of the ntr-type two-component system. using these families, ramani and marcotte successfully predicted 57% of the correct protein pairs and up to 86% of the correct ko pairs  <cit> . figure 4a shows an overview of the mapping predicted by tag-tsema for these two families. additionally, a figure showing the whole mapping and a table with the list of pairings within this mapping, indicating the correct ones are available as supplementary material . the best mapping found comprises  <dig> pairings between the two families, 88% of which are correct according with the ko assignments. from the original  <dig> pairings described in the literature , our method correctly predicted  <dig> . nevertheless, there are some cases where the ko assignments are possibly incorrect. analysing the detailed structures of the trees, it was clear that some proteins were wrongly assigned to a given ko by the automatic method used in kegg . for example, the proteins in the right tree of figure 4b  assigned to the dark-blue ko  should in reality be assigned to the light-blue ko  note the positions of these dark-blue proteins within the light-blue clade, their distances to light-blue proteins, and the relative positions of the light-blue and dark-blue ko in the trees of figure 4a). similarly, another case of a possible wrong assignment is shown in figure 4c. when these potential errors in ko assignments are manually corrected , the accuracy rises to 98%  and, in fact, most of the wrong pairings  were due to these incorrect ko assignments. only  <dig> of the  <dig> pairs are still incorrect after this manual correction of ko assignments . even more,  <dig> of these  <dig> wrong pairings could be explained by the fact that it involves an organism for which only  <dig> protein is present in each one of the trees, a situation whereby the automatic method has no other choice than to link them.

for comparative purposes, we run this method using rmsd as scoring function and obtained an accuracy of 86% pairs correctly predicted. comparing with the corresponding figures for marcotte's published data , and this method with pearson/student-t , it looks like the improvement comes from both, the usage of pearson correlation, and the "tagging", and that this last factor produces a significant increase in the accuracy. to further asses the individual effect of the "tagging" in the accuracy, we ran the pairs of trees for each organism separately. in this case we used those organisms with at least three proteins in both families . with this procedure, we could retrieve  <dig> correctly assigned k <dig> pairings out of  <dig> , an accuracy which is quite low compared to the results using tagging . this shows how predicting a mapping using tag restrictions is better than running each one of the tags  separately and joining the results afterwards. the reason could be related to the inclusion of more information for discriminating mappings  while not increasing the size of the search space . nevertheless, all these results should be taken carefully since they are based on a single example and a deeper analysis would be required to better dissociate the contribution of these factors.

CONCLUSIONS
in this work, we present a method for the prediction of the mapping between two families of interacting proteins based on the well-established relationship between similarity of phylogenetic trees and protein interactions. the method is able to incorporate information on the belonging of proteins to classes in order to restrict the protein-protein pairings according to these classes. the most general class we can define is the organism that the proteins belong to, in this way avoiding "heterologous" interactions between proteins from different organisms. many other classes can also be defined, such as the cellular compartment, co-expression, etc. we show that these restrictions improve the performance of the method. it is important to note that applying this method to an example with n classes  is different from applying other similar approaches n times to n pairs of trees, each one containing only paralogues for a given organisms. this fact, illustrated for the ntrc example, is possibly related to the inclusion of more information for distinguishing mappings  while keeping the search space relatively small due to the restrictions associated to the classes.

moreover, for the first time we apply here a tree-similarity-based method to predict pairings in a large set of interacting domains, which allowed us to obtain statistically significant figures regarding performance, and to asses their dependence on the characteristics of the input data. previous studies have only tested the methodology employed on a very limited number of examples. although this dataset is "unrealistic" in the sense that it is composed of protein domains instead of complete proteins, we have tried to keep the level difficulty as realistic as possible. for example, unpaired domains were left in the alignments that obviously makes it harder for the method to find the right solution. it is important to note that in our experience, this is the only large-scale test set possible, since there is little systematic information available on the interaction between members of proteins families that can be used to construct a large dataset of full-length proteins. indeed, this lack of information strengthens the need for methods like that presented in this work. we complemented this large-scale set with a more "real-life" example that involves a well-described case of interacting families. in this case the method produces substantially better results than previous similar ones.

there are large families of interacting proteins for which only one or a limited number of pairs of interacting proteins have been experimentally determined . in many of these cases, which are highly significant in eukaryotic organisms, the differential interaction of the members of the two families is crucial to explain their biological roles. it is expected that with the continuous stream of genomic sequences, we will see more and more of these examples. thus, it is in this context that the automatic method presented here can provide clues about specific interactions, complementing other computational and experimental techniques in the search for the molecular basis of functional specificity.

