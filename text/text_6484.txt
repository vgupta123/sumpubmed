BACKGROUND
gene expression microarrays are a powerful tool used in molecular biology and genetics for understanding gene expression change in biological processes under normal and pathological conditions  <cit> . intensity measurements of gene expression are associated with significant variations as a result of the complex and multi-stage processing involved in microarray experiments. beyond the variability that may be introduced during the fabrication of arrays as a result of print substrate quality and printing pin anomalies, several processing steps – mrna sample extraction, amplification and labeling, hybridization, and scanning – may introduce substantial variation in measurements  <cit> . although several studies have characterized the potential impact of these latter sources of variation on measurements of gene expression  <cit> , methods for assessing the physical measurement quality of individual microarrays are not widely available. if technical replicates for a biological case are available, the degree of concordance between technical replicates can be used as an index of reliability  <cit> . however, when only one technical replicate is available per biological case, this information cannot be generated. even in situations where two technical replicates are available, at least one of the replicates must have adequate quality, preferably based on objective rather than subjective evidence, to be used to determine the degree of concordance between the two technical replicates. therefore, it is important to seek an alternative objective metric by which we can judge the quality of individual microarrays.

ideally, all intensity measurements should be randomly expressed without any systematic or spatial patterns across an array. in other words, the geographic location of each gene expression measurement on an array should not be related to its intensity level. the intensity level of the same gene should be constant no matter where the gene locates on the array, meaning that geographic locations do not determine intensity levels. however, this assumption is not always true. for example, we assume that all arrays are produced through routine microarray procedures according to the manufacturing protocols or widely accepted academic protocols. some measurement artifacts may create patterns of hybridization that depend on the geographic positions of these artifacts on arrays. an example would be the case of an imbalanced  hybridization across an array. an array may have a smudgy high background signal or "strain" on certain geographic regions, creating a pattern of hybridization dependent on geographic position. another extreme example would be the case of physical scratches caused by coverslip removal or finger imprints on an array. in the absence of such artifacts, gene expression levels should show no unusual spatial pattern or bias across the microarray's surface other than systematic patterns due to the array design in the manufacturing of chip. thus, if we compute an index for an array by which a geographic position on the specific microarray's surface predicts its intensity level of gene expression, then this index may provide information about the summary of physical reliability of an individual array based on spatial correlation.

to create such an index, it is necessary to clarify the meaning of independence between two variables. herein, we define that two variables are geographically independent if knowing the value of one variable provides no information about the location of the other variable, and vice versa. we define the geography index as a quantitative measure of the degree of geographical independence between intensity measurements and their geographic locations on an array. presumably, higher geography index values indicate no significant spatial correlation between intensity measurements and their physical locations on an array. arrays with higher geography index values are considered to be more reliable. moreover, if two replicate arrays have high, constant geography index values, then the two arrays are considered physically reproducible in terms of spatial correlation. therefore, in this study we examine the spatial correlation between gene expression levels and their geographic locations on an array. we propose a statistical approach by regressing measurements on a third degree of the polynomial response surface model of the microarray's cartesian coordinates to calculate a geography index. to illustrate the utility of geography index and evaluate its validity, we first conducted tests with a series of real arrays from several microarray experiments and with a set of simulated arrays. second, we compared two different microarray platforms – spotted cdna arrays and affymetrix chips – to evaluate whether this method could be applied generally for microarray technology. from a practical point of view, this metric allows investigators to determine the quality of individual arrays. further studies will be needed with larger sets of microarray data to develop benchmark quality values for this geography index so that threshold values can be set to determine whether an array has sufficient quality to be retained for further downstream analysis such as identification of differentially expressed genes.

RESULTS
assessing the reliability of measurements using the geography index
twenty five affymetrix™ arrays of experiment a were used to evaluate the utility of geography index, which served as a predictor of the physical quality of arrays. for the assessment of reliability of arrays, the global geography index  for individual chips was calculated by fitting all intensity measurements  to model . results are summarized in table  <dig>  the distribution of geodex  of all chips is depicted in figure  <dig>  the degrees of geodex <cit>  were almost constant, except for chip  <dig>  which appeared to have more spatial correlation than others. it was evident that chip  <dig> possessed a systematic pattern or irregular behavior dependent on geographic locations across the array. for this reason, we visually inspected each individual chip and found that chip  <dig> had been damaged by careless handing during the scanning procedure and contained a small artifact across the array . this result demonstrated that the proposed metric was capable of pinpointing chips that contained artifacts on arrays. however, it was possible that the bias of the small artifact might not influence the overall spatial variation. as a result, the relative amount of variance due to the artifact was underweighed. hence, we studied the spatial variability of arrays while taking blocks into account as a regressor of block-dependent variance. we calculated robust geodex of individual chips using model . the results showed that the regressor  increased the overall spatial correlation and reduced the degree of geodex <cit>  ). chip  <dig> still displayed the lowest geography index.

for the sensitivity of block size on results of model , we compared results from three different block sizes:  <dig> ×  <dig> features per block ,  <dig> ×  <dig> features per block , and  <dig> ×  <dig> features per block , where nb is the total number of blocks per chip. as shown in table  <dig>  geodex for all the three different sizes appeared to have the same trend, and geodex became smaller as the number of defining blocks per chip increased. hence it is possible to make fine distinctions between more reliable chips and less reliable chips when a chip is defined with a larger number of blocks. however, more work is needed to define appropriate block sizes.

for most measurements, two technical measurement replicates per biological case should be highly correlated. on the other hand, outliers or problematic blocks distort variances. most outliers are likely to be due to measurement errors and, therefore, tend to cause not only low reliability but also poor quality of arrays. those outliers can be detected by noting whether the observed intensity value is within the possible range of values. relative to this point, we studied the distribution of blockwise geodex to identify blocks that displayed significant deviation relative to other blocks. those highly deviant blocks could be outliers and strongly influence the spatial correlation. blockwise geodexbij for each block bij  on each slide i was calculated using model . block effects varied from chip to chip, and each chip had outliers ). blocks  <dig>   <dig>   <dig>  and  <dig> on the four corners of the arrays tended to have the lowest geodexbi values, indicating that these blocks were more likely outliers and caused the edge effects ). this may not be unusual in microarray experiments because of unstable conditions of hybridization around the boundaries of slides. moreover, there was a strong trend that the non-edge blocks  had higher blockwise geodex values and smaller blockwise geodex variance for all the arrays. this finding suggested that the measurements in those non-edge blocks had less spatial correlation between the intensity levels and their locations on the arrays and were less affected by the spatial effects. this implied that a certain amount of edge effects would be an impediment to assessing the quality of measurements. in this case, local normalization of measurements for spatial effects, such as local normalization based on loess nonparametric regression, may be helpful to relieve issues related to edge effects  <cit> .

to reduce the effects of outliers on overall spatial variance, we trimmed the distribution of measurements by removing a small number of blocks that had high spatial correlation. we used the trimmed measurements to recalculate a global geography index, geodex <cit> adj, using model . we compared geodex <cit>  obtained using the entire array including all the measurements with geodex <cit> adj obtained using the trimmed array that discarded blocks having lower blockwise geodex ). when we discarded edge blocks  <dig>   <dig>   <dig>  and  <dig> , the magnitude of geodex <cit> adj improved. this result led to two findings: 1) the measurements around the edges exaggerated the overall spatial correlation and 2) the outliers deflated the magnitude of geodex. therefore, investigators interested in unraveling the spatial effects of outliers are well advised to perform an additional analysis to evaluate whether results change when highly deviant blocks or outliers are excluded from the study. note, however, that it is unwise to exclude such outliers when the interest is in cross comparisons between arrays for the purpose of a chip's quality check.

assessing the validity of the geography index as a predictor of reproducibility
alternatively, we conducted a simulation study to explore the validity of geodex as a predictor of reproducibility of arrays based on spatial concordance. we randomly took a chip from experiment a as a "sample" array and added systematic noise only to block  <dig> located in the middle of array. systematic bias was simulated under eight different scenarios: 1) added systematic bias from a standard normal distribution ), in which the randomness across the array was not affected by artificial bias; 2) decreasing the intensity values by subtracting a constant ; 3) increasing the intensity values by multiplying by  <dig> ; 4) multiplying by  <dig> ; 5) multiplying by  <dig> ; 6) multiplying by the standard deviation  of the measurements on the sample chip ; 7) multiplying by two sds ; and 8) multiplying by three sds . we hypothesized situations in which the background hybridization signal should be uniform across the array; however, small artifacts, such as smudges or scratches or imbalanced hybridization, changed the gene expression levels on block  <dig>  we created eight simulated technical replicates plus the sample array with identical measurements except for those on block  <dig>  maintaining the randomness property of the arrays. introducing bias on block  <dig> inflated the overall variances of the individual chips even though the first two cases had very little influence on the overall variances and were less informative than the other cases. however, block  <dig> was the only source of between-chip variance and leveled the degree of inter-chip discrepancy between the sample array and other simulated arrays. we were interested in examining what would happen to the relationship between the inter-chip discrepancy and pairwise geodex of the eight pairs of the two replicates. we calculated geodex <cit>  and geodex <cit>  for the simulated chips using models  and , respectively. table  <dig> summarizes the results. the relationship between geodex <cit>  and the cv of the intensity measurements is depicted in figure  <dig>  in the presence of spatial effects by block  <dig>  geodex and cv had a negative relationship, indicating that the degree of geographic independence increased as cv decreased. note that the spatial variation dependent on the intensity measurements of the geographic locations was proportional to the overall variance of the measurements on the arrays. the excessive spatial correlation reflected more measurement error of the measurements on the arrays and thus induced less reliability of the arrays. a scatter plot of the degree of inter-chip discrepancy of the eight pairs of the sample chip and every simulated replicate against pairwise geodex is depicted in figure  <dig>  as would be expected, the increase in pairwise geodex was opposite to the decrease in the inter-chip discrepancy. this simulation study affirmed the validity of the hypothesis that geodex is capable of predicting the reproducibility of measurements when there is enough inter-chip spatial variance between two replicates. from comparisons of geodex <cit>  with geodex <cit> , we found that geodex <cit>  was affected by variation from a small cluster of extremely expressed genes or a small artifact, and the bias of the small artifact on block  <dig> exaggerated the overall spatial correlation. therefore, model  is more effective for estimating spatial correlation than model  in situations in which block-to-block differences across an array are significant.

the findings from experiment a were commonly observed when the total six chips  of experiment b were analyzed using model : chip  <dig> of biological sample  <dig> had the lowest geodex, suggesting that this chip had a higher spatial correlation between the intensity levels and their locations on the array than others ); and the spatial concordance between technical replicates within a biological case was higher than that between technical replicates across biological cases .

despite the limitations of geodex as a predictor of reproducibility of technical replicates in general, geodex could be used to assess the reproducibility depending on spatial patterns. we supposed the two most interesting cases: 1) one technical replicate  had all its expression measurements shifted by  <dig> x-units relative to the other technical replicate ; the x-axis coordinates for the shifted were changed by  <dig> units and the y-axis coordinates were unchanged and 2) one technical replicate had all its expression measurements shifted by both  <dig> x-units and  <dig> y-units relative to the other technical replicate; both the x-axis and y-axis coordinates for the shifted were changed by  <dig> units. in these cases, the pearson correlations between the two replicates  were less than . <dig> , suggesting that the replicates had a low correlation due to inconsistency between corresponding measurements. however, the two replicates had the exactly same geodex value, indicating that the two replicates were reproducible in terms of their spatial correlations. hence geodex can be used to assess reproducibility of technical replicates for such particular cases in which one replicate is shifted vertically or horizontally systematically during printing or scanning as illustrated above.

effects on results of the violation of assumptions
we examined whether the violation of assumptions within the models influenced the analyses. because the standard deviation  of measurements of gene expression was proportional to the mean value , dataset a was log-transformed to normalize the distribution with residual errors that had the same variance for all measurements. then we recalculated geodex using model  and compared geodex <cit>  of the untreated data with geodex <cit> log <dig> of the log-transformed data ). geodex <cit> log <dig> was smaller than geodex <cit> , suggesting that the log-transformation provided a better fitting polynomial model with a larger r <dig> that implied small error or variability in the prediction of spatial correlation. in contrast, the untreated data had a poor fitting polynomial model in which r <dig> was smaller than that of the log-transformed data. thus, this provided a less accurate estimation of spatial variation of measurements associated with their geographic locations on an array.

the use of appropriate transformations may make the proposed method more plausible  <cit> . however, the two distributions of geodex of the two data treatments had similar patterns in general. after log-transformation the only significant difference was that a range of geodex values varied and discriminated from each other more remotely. therefore, without a loss of significance, we chose to retain data in the original scale for the sake of simplicity. nevertheless, it is noteworthy that the proposed metric for assessing the geographic independence of measurements on geographic locations was not affected exclusively by the distributions of measurements. therefore, the proposed approach perhaps can relax distributional assumptions.

comparison between different measures of gene expression
for affymetrix chips we calculated geodex with pm-only and mm-only intensities using model . scatter plots showing the distributions of geodex for pm-only and mm-only intensity measures are depicted in figure  <dig>  the results of these analyses confirmed that the intensity levels of chip  <dig> showed less geographic independence from the geographic locations on the chip. however, the geographic independence appeared to differ depending on which gene expression measure was used. geodex <cit>  of pm-mm and pm-only measurements were close to being parallel. in contrast, geodex <cit>  of mm-only measurements differed from the others. overall, some interesting findings were observed: 1) it was obvious that the mm-only measurements depended more heavily on their geographic positions on the arrays than did the other measurements. this finding was not surprising because of the additive signals on every 25th mm probe that appeared regularly across array-enhanced systematic patterns on the array surface. 2) for most chips, geodex <cit>  for the three measures were parallel and very close to each other, suggesting that the mm-only measurements detected not only a non-specific binding signal but also a transcript signal , as did the pm-only measurements. also noted was that the pm-mm difference measurements included noise. 3) as one would expect, the pm-only measurements, which did not account for non-specific binding, appeared to have less spatial correlation, suggesting that pm-only is perhaps a more adequate expression measure especially when mm-only has significant spatial effects  <cit> .

comparison between different microarray platforms
experiment c was originally conducted to perform cross comparisons of two different platforms, cdna spotted arrays and affymetrix oligonucleotide arrays. in this experiment, two samples of mrna were labeled with two different fluorophores  and co-hybridized onto a glass slide on which pcr products generated from  <dig>  thousand clones were immobilized at array positions. ratios  of two dye intensities were then calculated. cy5-only, cy3-only, and cy5/cy <dig> measures were compared to assess the measurement reliability of arrays. as shown in figure  <dig>  there was a difference between the two platforms: geodex of the cdna arrays was smaller than that of the affymetrix oligonucleotide arrays, indicating that the affymetrix oligonucleotide arrays used in this study had less spatial correlation or bias. this seems reasonable because affymetrix oligonucleotide arrays have random manufacturing systems of ordering features across an array comparing to cdna spotted arrays placing spots functionally across an array with  <dig> different printing pins. in addition, it is important to consider different measures of gene expression level. we found that there was no significant difference in dye-dependent spatial bias between two dyes ). however, the results showed that taking the ratio of two dye intensities could increase or reduce spatial bias even though the ratio measurements reduced variation in measurements within an array and variance between technical replicates. therefore, when the ratios of two dye intensities are considered for gene expression analysis, a normalization procedure taking into account spatial variance of expression measurements would be an alternative strategy for removing systematic variations in microarray experiments  <cit> .

discussion
we have developed a metric for evaluating the physical reliability of individual arrays in terms of a degree of spatial correlation among expression measurements. the proposed geodex metric was designed to estimate a degree of the geographical independence between gene expression measurements and their geographic locations on an array. this provided an equivalent measure of spatiality-based physical reliability of an array. through the analyses of multiple real datasets, we found that geodex was useful and valid for assessing the quality of individual chips in terms of spatial correlation. specifically, 1) geodex could be used to check the quality of an individual chip in which there are multiple biological replicates available but no technical replicates per biological case. in particular, it could identify seriously damaged chips or chips with small artifacts leading to poor array quality. because the array detected in experiment a was so obviously at fault, one could argue that inspecting the arrays visually was at least as effective as using geodex. hence, we will investigate how sensitive the method is to small artifacts that are not visually identified but still lead to poor chip quality in future studies. 2) in the presence of sufficient spatial effects on arrays, geodex predicted spatial concordance between technical replicates that could be used as a predictor of the reproducibility of technical replicates. 3) if global geodex indicated that some kind of spatial artifacts were on arrays, blockwise geodex could lead to suspect locations. also, edge effects and other systematic biases were detected by conducting analysis of blockwise geodex. 4) this method was easy to implement in software with a standard statistical analysis tool. hence, it is readily accessible to laboratory scientists. therefore, geodex offering a good prediction of physical array reliability in terms of spatial correlation can be installed in laboratories as a quality control monitor to allow investigators to determine whether arrays have adequate quality to be retained as part of a larger data set.

regarding issues of model choice in analysis, we chose an intermediate cubic polynomial response surface model as a compromise between oversimplifying and overspecifying variables  to introduce a novel idea for how to proceed with this proposed approach. however, our approach is not restricted to a particular model and is flexible enough to incorporate into models any necessary data-specific regressors that would provide a best approximation of geodex. one can also develop other functional models that establish a relationship between measurements and their geographic locations on an array. to enhance the practical utility of this method, development of more extensive prescription-type procedures searching for best models will be undertaken in future studies.

to calculate geodex, we have focused on a number of robust models between local approaches  and global approaches . these ranged from highly local approaches that regressed measurements to neighboring models to completely global approaches that regressed them to across-all-over models. it appeared that a regressor-dependent model, such as model , reasonably predicted a chip's quality. on the other hand, local approaches tended to be more effective when spatiality varied across blocks. for example, a block-by-block analysis could not only detect outliers but could also explore the nature of irregular patterns in the neighborhood of outliers, such as edge effects. in contrast, when local geodex across blocks did not change dramatically, global approaches were sensitive enough to assess a summary of the physical reliability of arrays.

developing benchmark geodex threshold values for discriminating between good- and poor-quality arrays for different platforms and manufacturers will require application of the metric against much larger and more diverse data sets than those used in this study. the narrow range of geodex across all arrays and chips used in this feasibility study suggests that in general all of these arrays were of good quality. a larger, more complex and diverse quality set of array data would provide a test for such benchmarks. however, in practice, a threshold that determines whether a chip should be retained or discarded very likely varies from laboratory to laboratory because of many factors such as different batches, technicians, chip types, production methods, and experiments. hence it is difficult to judge whether a specific benchmark for one experiment can be transferred to another experiment. the proposed metric would be interpreted relative to other chips obtained from a single experiment in a given laboratory. however, there are some uses of the geodex that are not related to using a threshold for discarding chips. for example, one may wish to assess trends in the quality of chips being produced in a facility. in such cases, the judgment of chip quality is based on the empirical distribution of all geodex values for chips from a single experiment and/or across multiple experiments. alternatively one might want to use the index to assess the level of training and development of a student or technician. the geodex metric does not appear to be able to distinguish between variability due to positional effects created during fabrication of chip or array versus those effects that arise during labeling and hybridization and, therefore, the validity of the global claims of superiority of one platform or another in cross-platform comparison.

normalization is the process of removing biases due to technical variation. however, some results show that biases still remain in the data after normalization even normalization adjustments account for local spatial variation  <cit> . smyth and speed  <cit>  indeed noted that poor spot qualities could contribute to biases. thus they suggested that a regression-based normalization method might be improved by incorporating quality weights for individual spots. geodex can be used as a quality assessment procedure for spots and chips before normalization to identify the spatial position of less reliable spots on the slide so that a quality weight is assigned according to a degree of spot quality. gene expression data adjusted by a combination of geodex and normalization can be used for downstream analysis such as differential gene expression, and their resulting estimates are expected to be more precise because of a reduction of biases in data.

CONCLUSIONS
assessment of the physical quality of individual chips is important for gene expression studies to obtain reliable analysis results of differential expression. we discussed the potential of a quantitative metric that could summarize the physical reliability of individual arrays based on spatial correlations among gene expression measurements. we also illustrated the possibility of incorporating this procedure into laboratory practices as a means to set quality control specifications and as a tool to determine whether an array has sufficient quality to be retained.

