BACKGROUND
linking genotype to phenotype is one of the central questions in biological sciences. current approaches to map intraspecific variation to causative sequence variation use either a quantitative genetics framework  or rely on population genetic theory .

population genetic theory predicts that a favorably selected allele is either lost or increases in frequency until fixation  <cit> . with the spread of a beneficial allele, linked, non-selected sites also increase in frequency, a phenomenon that has been termed hitchhiking  <cit> .

based on this principle, genome scans were performed in a large number of species such as human, maize, drosophila, arabidopsis thaliana and plasmodium falciparum  <cit> . selection signatures in cattle based on snp data on single chromosomes were reported on bos taurus  chromosomes  <dig>  <cit> ,  <dig>  <cit>  and  <dig>  <cit> . barendse et al.  <cit> , gibbs et al.  <cit>  and hayes et al.  <cit>  published genome wide maps of diversifying selection between bos taurus dairy and beef cattle, flori et al.  <cit>  between three different french dairy cattle breeds, and gautier et al.  <cit>  among several west african cattle breeds. qanbari et al.  <cit>  employed an extended haplotype homozygosity test and published a genome wide map of recent selection within the german holstein dairy cattle population. gautier et al.  <cit>  also used this signature of selection within a recently admixed caribbean cattle breed. furthermore these authors employed a modified version of rsb scores proposed by  <cit>  to detect local excess or deficiency from a given ancestry relative to the average genome admixture levels. qanbari et al.  <cit>  recently published a genome scan in several dairy and beef breeds including german brown swiss cattle based on integrated haplotype scores and when contrasting breeds employing fst statistics. however, disentangling selection from nuisance signals caused by the demographic history of a breed or species based on genome wide polymorphism data remains challenging.

stringent artificial selection resulted in an enormous improvement of production traits over the last couple of decades, especially for traits with moderate to high heritability. in combination with the availability of high density snp arrays and high quality phenotypes, this intense selection renders the genome of dairy cattle an optimal model to look for signatures of recent positive selection.

while for genetic model organisms very powerful genomic tools are available, these species frequently lack phenotypic records to link signatures of selection in the genome to actual variation in phenotype unless a huge additional phenotyping effort is undertaken. this is the great advantage of using livestock species, as numerous production- and fitness traits are routinely recorded and used in breeding value estimation.

the estimated breeding value  expresses the genetic merit of a breeding animal estimated based on their own performance and performances of all available relatives. in the case of dairy bulls this typically includes hundreds to thousands of daughters. furthermore ebvs are corrected for systematic environmental effects. therefore the breeding value of an animal is the sum of its genes' additive effects based on fisher's infinitesimal model  <cit> , which assumes a very large  number of loci each with very small effect. although only approximatively correct, application of this model in selection paved the way for efficient livestock breeding.

since sax's experiments with beans in  <dig>  <cit>  we know however, that there are so called quantitative trait loci  that have a bigger than infinitesimal effect and that these loci can be mapped i.e. via linkage analyses. such qtl mapping studies as a quantitative genetics approach have been very successful in cattle, see  <cit>  for a summary.

rapid improvements in high throughput snp genotyping technologies and commercially available high density snp arrays for livestock species allowed livestock geneticists to turn towards whole genome association  mapping approaches in the recent past e.g.  <cit>  or see  <cit>  for a review in livestock. the number of individuals that need to be genotyped to achieve reasonable power in a stand alone wga is nevertheless still limiting  <cit> .

population genetics provides information that is independent of phenotypic information on putative loci under strong directional artificial or natural selection. we show in this paper that combining a population genetics signal with association tests based on quantitative genetics in a composite statistic, increases power and reduces the number of false positive signals for localizing the source of selection.

in a similar vein,  <cit>  proposed a composite test statistic of several selection signature signals to increase power to detect selection. barendse et al.  <cit>  discussed the potential of combining genome wide scans for selection and whole genome association studies. however, as these authors were looking for signatures of diversifying selection based on fst values the combination with association results is not straightforward. akey at al.  <cit>  followed up a region on dog  autosome  <dig> that showed evidence for selection in the shar-pei dog breed with association mapping and finally dissected the molecular basis of the typical skin wrinkling phenotype in this breed. ayodo et al.  <cit>  found that in a case-control candidate gene approach in humans the statistical power to detect disease variants can be increased by orders of magnitude by weighting candidates by their evidence of natural selection.

our composite statistic combines a long-range haplotype statistic, based on genomic signatures of  positive mutations that are not yet fixed in a single population, and the regression coefficient based on allele-count indicator variables of a wga - as the quantitative genetic approach. both estimators rely on the underlying linkage disequilibrium  between the causal variant and the genotyped snp. we further propose a new mixed model approach to account for stratification in population based association studies, and we introduce a modified extended integrated haplotype score test statistic to detect selection. using computer simulations and real data we show that the combination of both tests increases the power for localizing the target of selection relative to a single test and reduces the number of false positive signals.

methods
experimental design
the highest selection pressure in the overall breeding goal in brown swiss cattle over the last decades was put on protein yield, the main trait of interest in this study to ensure high power for both mapping approaches.

the  <dig> highest and  <dig> lowest bulls with respect to protein yield ebv and a minimal ebv-accuracy  of  <dig>  were chosen out of  <dig> progeny tested brown swiss bulls for selective genotyping  <cit> . up to two generations were present among the genotyped bulls. the bulls descend from  <dig> different sires and  <dig> maternal grandsires. sire and maternal grandsire family size ranged from  <dig> to  <dig> and  <dig> to  <dig> members, respectively.

phenotypes
sire ebvs were obtained from the genetic evaluation centre lfl grub, germany from the august  <dig> genetic evaluation for py. ebvs for protein yield are in kilogram units.

genotypes
genomic dna was prepared from semen straws following standard protocols using proteinase k digestion and phenol-chloroform. across all samples the concentration was set to  <dig> ng/μl. bulls were genotyped according to the manufacturer instructions with the illumina bovinesnp 50k bead chip® comprising  <dig>  snps at the institute of human genetics of helmholz zentrum münchen, germany. genotypes of one individual were omitted due to a call rate of < 90%. the average call rate of the remaining  <dig> bulls was  <dig> % corresponding to approximately  <dig>  genotypes obtained per individual. the software plink, version  <dig>   <cit>  was used to filter raw genotype data. snps with known genomic location on autosomes, with a minor allele frequencies of > 5%, that were missing in less than 10% of bulls were considered. we then filtered for all snps for which the ancestral state of the allele was reported by  <cit> . the final dataset contained  <dig>  snps. haplotypes were inferred with fastphase, version  <dig>   <cit> . parameters in fastphase were set to  <dig> random starts for the em algorithm and  <dig> clusters. haplotypes were inferred for whole chromosomes ignoring pedigree information.

detection of selection signatures
we wrote r and c++ scripts to calculate extended haplotype homozygosity  test statistics from phased haplotype data as proposed by  <cit> . briefly, the ehh of a core snp is calculated as:

 ehhi=∑j=1seij2ci <dig> 

where ci is the number of samples of a particular core snp allele i, eij is the number of samples of a particular extended haplotype j, carrying the allele i at the core position, and s is the number of unique extended haplotypes  <cit> . ehh captures, as a function of distance, the decay of identity of haplotypes that carry a specific core allele. ehh starts at one and decays to zero, with increasing distance for both alleles at each core snp. the area under the ehh curve that results from plotting ehh versus distance is expected to be greater for the selected allele than for the neutral allele. as proposed, we computed the integrated ehh  as the integral of the observed ehh in both directions from the core position until ehh reaches  <dig>   <cit> . the unstandardized integrated haplotype score  is then calculated as

 uihs=lnihhancestra1ihhderived, 

voight et al.  <cit>  estimated the expectation and standard deviation  of ln  in bins of derived allele frequencies from the empirical distribution at snps whose derived allele frequency p matches the frequency at the core snp. the resulting standardized ihs  follows approximately a standard normal distribution.

 ihsvoight=uihs-epsdp 

since standardisation is based on the frequency of the derived allele this sets an upper limit to the age of the mutation. this test statistic answers the question of how unusual the length of a haplotype is, assuming the same age of allele across all observed selection coefficients acting on any core snp with a similar derived allele frequency in the genome. it therefore does not provide a formal test of significance. furthermore if different outgroups are used to define ancestral and derived states this sets different age boundaries to the mutations resulting in less precise standardisation.

a locus specific permutation-based ihs
when the rate of ehh decay is similar for the ancestral and derived allele, as expected for a neutral locus, uihs is ~  <dig>  <cit> .

voight et al.  <cit>  showed via simulation that extremely positive and negative ihs scores are both potentially interesting selection signals and polarisation with the ancestral allele results in a change of sign, but does not change the magnitude of the uihs test statistic.

in the following we introduce a locus specific permutation based approach that relies on minor and major allele frequencies rather than ancestral and derived states, respectively. most importantly this test statistic provides significance of deviations of uihs from its neutral expectation.

the core site in ihs test statistics is used to define two groups of haplotypes for comparison with regard to their block structure. we shuffled core snp alleles  <dig>  times at the core position while retaining the neighbouring haplotype configuration and calculated uihs for each permuted sample  within each core snp. random shuffling snp alleles at core sites randomizes allocation of haplotypes to the two groups for comparison while maintaining the ld structure in the surrounding genomic region. this simulates the null hypothesis of neutrality: the site was not subject to selection. we hereby obtain an empirical distribution of ihs under the h <dig> for each snp, from which we obtain the probability that we see such an extreme ihs just by chance. the locus specific standard deviation of the  <dig>  ihsp test statistics is then used to scale the observed deviation of uihs from its expectation zero. scaled, permutation based ihs  is therefore calculated as

 sihsp=uihs-0sd 

since the empirical mean of permuted ihs statistics is approximately  <dig>  our test is a formal test of significance, given the allele frequency of the core site and the ld structure in the surrounding region. this is a property of crucial importance of a test statistic, especially since we want to combine our results with an association test from a wga study.

generally snp sites with low minor allele frequencies show larger sd of ihsp. however, to avoid any additional bias due to possibly remaining dependence of sihsp on allele frequency, sihsp was fit in a linear model by regressing the snp minor allele frequency  at the core site on sihsp. for each site, the random residual εij was obtained and subsequently standardized using the standard deviations sd of residuals across all snps. in contrast to  <cit>  , our frequency correction is not done based on the expectations of snps within allele frequency bins but carried out on a continuous scale.

 sihspij=mafi+εij 

the resulting frequency corrected, and scaled test statistic is termed ihs.

 ihs=εijsd 

this final test statistic is approximately standard normally distributed.

since no high resolution genetic map was available for the snps in this study, physical distances between snps were used for calculating all integrated haplotype scores.

whole genome association study
standard statistical tests, e.g. regressing phenotype on allele count in a linear model, are inappropriate for population based wga in structured populations because they either result in an inflated proportion of spurious marker - phenotype associations or mask true associations , even with modest levels of population stratification and/or admixture. in the case of cattle populations, artificial insemination schemes allow the use of a few superior bulls as sires of the next elite sire generation. thus, genotyped bulls are frequently paternal half-sibs or share the same maternal grandsire. the subsequent family structure can cause substantial stratification. quantile - quantile plots and inflation factors  were used to characterize the extent to which the observed distribution of p-values follows the expected null distribution. inflation factors were calculated as

 λ=median/ <dig>  

with ti2=βi2/var, where βi is the effect of the i-th snp ,var the variance of the estimate and  <dig>  the median of the χ1df <dig> distribution  <cit> .

recently, linear mixed models were proposed to effectively account for different levels of relatedness by incorporating pairwise genetic relatedness into the model  <cit> . this approach relies on the fact that the phenotypes of two genetically related animals are more similar than those of genetically distant individuals. estimation of covariance between individuals is assisted by the availability of a marker based kinship matrix, which can be estimated more accurately using genotype data from the wga experiment than from pedigree information.

we therefore employed the following single locus mixed model which we term "mix" that explicitly models the polygenic relationships among inviduals, as

  y=xb+za+e, 

where y is a vector of sire ebvs for protein yield, x is the design matrix in which snp genotypes were coded  <dig>   <dig> and  <dig>  counting the number of minor alleles and b the vector of regression coefficients on recoded snp genotypes. z denotes the design matrix for random effects with a ~ n  being the vector of polygenic effects, σa <dig> the additive genetic variance and g the genetic covariance matrix and e ~ n , a vector of residual effects. g was obtained from pairwise identical by descent  estimates using genome wide snp data as implemented in plink  <cit> , in which the ibd state is estimated by a hidden markov model, given the observed identity by state  sharing and genome wide levels of relatedness between the pairs. diagonal elements of g were calculated as 1+f, with f being the inbreeding coefficient estimated from snp data using plink  <cit> .

mixed models were solved in r  via direct matrix inversion. empirical p-values were calculated by an adaptive permutation procedure, shuffling the vector of genotype codes among phenotypes. this does not destroy the relationship between ibd status and phenotypes, but breaks up any association between snp genotypes and phenotypes. this leaves ld patterns unperturbed and hence does not control for stratification. the number of permutations was sequentially increased up to  <dig> ×  <dig> permutations if the snp indicated association. the empirical p-value was calculated as the number of test statistics obtained on permuted sets being greater than or equal to the observed test statistic.

all  <dig>  snps were tested one after the other for association with the protein yield  phenotype.

as model mix did not overcome the stratification present in our highly structured sample we applied a two stage approach. besides accounting for the relationship via a mixed model, stratification was accounted for by pre-correcting snp genotype codes for sire and maternal grandsire  differences using the following regression model

  gtij=sirej+mgsj+εij, 

where gt is the recoded genotype code , sire is the fixed effect of sire i and maternal grandsire the fixed effect of maternal grandsire j and εij~ n , the vector of random residual effects. sire- and maternal grandsire families smaller than five were merged into one group.

residuals εij were used instead of raw recorded genotypes  in the design matrix x of equation , henceforth termed method "mixstrat".

evaluation of wga via monte carlo simulation
the proposed method to account for stratification is specific to situations typically observed in intensively selected livestock species and populations. we evaluated the effectiveness of mixstrat by monte carlo simulations. phenotypes, sire- and maternal grandsire family structure were taken from the population under consideration. genotypes for  <dig> bulls and  <dig>  diallelic sites were sampled based on the following procedure:

first, the allele frequency p of the first allele at a snp was drawn from a uniform distribution, the allele frequency for the second allele q at this snp is then given by q = 1-p. two alleles each were sampled for all sires and maternal grandsire according to these frequencies. bulls inherited sire and maternal grandsire alleles following mendelian rules. alleles inherited via the dam were sampled corresponding to the population allele frequencies. this simulates the null model  taking into consideration the observed population structure. association was tested for, using the models mix and mixstrat.

rate of false positives
the average rate of false positive detections across m =  <dig> random repetitions was calculated as

 αp= ∑i=1mp∈{p< <dig> } <dig> /m 

power analysis
for true associations the mean genotype values within bulls of sire and maternal grandsire are correlated with phenotypic family means. this information is not utilized when genotypes are recoded and will thus reduce power. we evaluated the power of mixstrat relative to the power of mix under the alternative model. this was achieved by simulating an additive qtl effect which explained  <dig>   <dig> and 10% of the ebv variance:

 αqtl=σebv2qtlsize2p 

where αqtl is the allele substitution effect  <cit> , σ2ebv the variance of ebv, qtlsize is the size of the effect as proportion of σ2ebv and p the allele frequency of the simulated diallelic locus. power was calculated as

 power= ∑i=1mp∈{p<αbonf} <dig> /m 

with αbonf being the 5% bonferroni- corrected type i error threshold of  <dig>  × 10- <dig> and m being the number of random monte carlo repetitions.

composite test combined significance test and false discovery rate
we used stouffer's method  <cit>  to combine p- values from the association study with those from the selection signature analysis .

the test statistic was calculated as

 z= ∑i=1kz/k 

where z is the standard normal variable under h <dig>  z is the p - value from test i transformed to z and k is the number of tests that are combined in the test statistic. p - values pcomb were obtained using the quantile function of the standard normal distribution. the tail area based false discovery rate  was calculated from pcomb values using the r package fdrtool, v <dig> . <dig>  <cit> . significance was declared if the q value  was <  <dig> .

RESULTS
evaluating the locus specific permutation of the ihs test statistic to detect signatures of selection and comparison to ihsvoight
we mapped selection signatures with ihsvoight and our newly proposed ihs to detect sites under selection.

for snps with low minor allele frequencies we found a relatively higher proportion of extreme unscaled ihs statistics. we postulate that this is due to increased rates of false positives, since power simulations by  <cit>  and  <cit>  show that ihsvoight is powerful for loci with intermediate allele frequencies and that the power of the test drops substantially when the selective sweep is close to fixation, in other words for snps with low maf.

figures  <dig> and  <dig> show the histograms of ihsvoight and ihs, respectively. figure  <dig> shows a qq-plot of ihs and ihsvoight.

figures  <dig>   <dig> and  <dig> all suggest that ihs has increased power compared to ihsvoight.

our permutation based standardization allows a formal test against the null hypothesis of neutrality at a core snp . our standardization is against  <dig> permuted test statistics at the same locus in the same ld background. we therefore do not need to define the state of ancestral and derived allele.

additional file  <dig>  figure s <dig> shows a histogram of derived allele frequencies and additional file  <dig>  figure s <dig> a histogram of minor allele frequencies of the  <dig>  snps used in this study. additional file  <dig>  figures s <dig> and s <dig> show histograms of p - values for ihsvoight and ihs, respectively.

detection of selection signatures in the brown swiss dairy cattle population
manhattan plots for ihsvoight and ihs for each autosome except bta  <dig> are shown in additional file  <dig>  figure s <dig> - s <dig> plots a and b.

among the  <dig>  snps tested genome wide  <dig>  and  <dig>  snps had a test statistics > | <dig> | with method ihsvoight and ihs, respectively.

distribution among chromosomes is remarkably uneven: bta  <dig>   <dig>   <dig>   <dig> harbor  <dig>   <dig>   <dig>   <dig> sites, respectively which corresponds to  <dig> - 11% of all investigated snp on the corresponding chromosomes that show significance applying ihs. on other chromosomes, namely bta  <dig> and  <dig> ~ 1% of investigated snps exhibit significant selection signatures.

the same is true for ihsvoight bta  <dig>   <dig>   <dig>   <dig> and  <dig> have  <dig>   <dig>   <dig>   <dig> and  <dig> snps that show an ihsvoight test statistic > | <dig> | which corresponds to  <dig> - 14% of all snps on these chromosomes. bta  <dig>   <dig> and  <dig> have only around ~ 1% sites with extreme ihsvoight test statistics.

one particularly illustrative example is given by snp hapmap52798-ss <dig> located in the proximal region of bta  <dig> at  <dig>  mb . an ihs of  <dig>  for this snp with a frequency of  <dig>  for allele g exhibits a larger area under the ehh curve as compared to allele a and was possibly under selection. interestingly, this snp is in close neighborhood to the well known dgat <dig> k232a polymorphism, located at  <dig> - <dig>  mb, with strong effects on milk production traits . in the brown swiss  breed the frequency of the k allele is very rare with about 2% in the german bs population  <cit>  and fixed for the a allele in the italian bs population  <cit> . most likely allele a was selected for because of its milk yield increasing effect while it reduces fat content. note that the dgat <dig> k to a mutation itself is not part of the illumina bovinesnp 50k bead chip®. interestingly, our ihs provided a strong and convincing signal of selection, while the ihsvoight  provides considerably weaker support. hence, this might illustrate the increased power of our modified ihs as compared to the ihsvoight.

however, there is growing evidence for additional polymorphisms in the dgat <dig> gene and its neighborhood that cause phenotypic variation for milk production traits eg  <cit> . of particular interest is a qtl mapping study in the german-austrian-italian bs population  <cit> , that reported significant qtl for milk yield and protein percent in the dgat <dig> region although all bulls in this study were shown to be homozyogous for the p.k232a polymorphism  <cit> . this finding is supported by the large snp effects estimated for fat and protein percent in the us - bs population  albeit the near fixation of allele a in this breed. so it is likely that the selection signal that is picked up by ihs is not purely for the dgat <dig> p.k232a polymorphism but for the proximal region of bta <dig> as a whole including the vntr polymorphism in the promoter region of the dgat <dig> reported by  <cit> .

association study on py
we used  <dig>  snps that met our stringent quality criteria and also had the ancestral allele reported in literature for association testing. population stratification was accounted for by including ibd estimates from the genotype data . a quantile - quantile plot analysis indicated, that this procedure did not sufficiently account for population stratification in our dataset  .

we therefore developed a new strategy to reduce the number of erroneous association signals in our data . both the quantile - quantile plot  as well as an inflation factor λ of  <dig>  confirmed that the mixstrat model successfully controlled for spurious results caused by stratification of our sample. nevertheless, we also experienced a drop in power, as expected. the snp with the smallest q value in method mixstrat was  <dig>  ) calculated with r package fdrtool, v <dig> . <dig>  <cit> , corresponding to a nominal p-value of  <dig> e- <dig>  note that the flattening out of the p -value curve for method mix is a consequence of the adaptive permutation procedure.

evaluation of wga via monte carlo simulation
computer simulations showed that using mixstrat the sample size in this study is sufficient to only detect strong effects explaining at least 10% of the phenotypic variation. the monte carlo simulation did not account for ld because conservative significance thresholds using bonferroni correction were used. nevertheless, it assesses the influence of population substructuring in single snp regression whole genome association studies. our simulations show clearly that the sire-, paternal grandsire- and maternal grandsire structure in dairy cattle populations alone can create significant results without any association between genotype and phenotype.

additional file  <dig>  figure s <dig> shows a histogram of allele substitution effects across all  <dig>  snps tested.

rate of false positives
empirical type i error rate α and the inflation factor λ using mixstrat were  <dig>  and  <dig> , respectively, while an α of  <dig>  and λ  <dig>  was observed when method mix was applied. furthermore the quantile - quantile plot in figure  <dig> shows clearly that a standard mixed model cannot fully account for the stratification present in the data, whereas our mixstrat approach succeeds in controlling the type i error rate under the simulated null distribution.

power analysis
as expected, mixstrat reduced power under the model of an existing qtl . power reduction was  <dig>  and  <dig>  for qtl that explain  <dig> and 5% of the trait variance, respectively. the relative power loss compared to mix analysis of  <dig>   and  <dig> %  indicates, that for large and particularly moderate qtl sizes our method leads to substantial power reduction.

as further shown in table  <dig> our dataset has sufficient statistical power to detect qtl explaining > 10% of the variance in ebv. effect sizes of that magnitude are expected to be rare in livestock species  <cit> . mixstrat without integration of information on selection signatures has insufficient power to detect loci explaining only 1% of the variance.

consensus of selection signature signals and association signals
a positive ihs value indicates that the minor snp allele, relative to the major allele, is associated with the larger integrated ehh statistic and was possibly selected for. likewise the estimated regression coefficient in the association analysis  represents the estimated increase in trait value per additional copy of the minor allele. thus alike signs of ihs test statistics and βmixstrat indicate that the snp is causative by itself or is in ld with a causative site that is under positive selection. opposite signs of ihs and βmixstrat may be observed when sites have pleiotropic effects and were selected on a different, possibly unobserved, trait. generally one would expect to see a higher proportion of like signs as compared to opposite signs and a positive correlation coefficient for traits of major economic importance in the selection history of a breed.

combining signatures of selection with association tests
selection signature - and association test statistics were moderately correlated  across all  <dig>  snps as the majority of snps are not in ld with a causative locus and therefore not under selection. this justifies treating the two sets of results as independent and using stouffer's method to obtain p- values  from a combined significance test. figure  <dig> indicates that combination of tests increases power of detection substantially. we applied a fdr threshold of  <dig> , which corresponds to a nominal p-value cut-off of  <dig> e- <dig> 

additional file  <dig>  figures s <dig> - s <dig> show manhattan plots for each of the bovine autosomes, combining model mixstrat with ihsvoight  and mixstrat with ihs . all manhattan plots are annotated with selection signature signals among the top 5% found by  <cit>  applying ihsvoight in windows of  <dig> kb in bs cattle  and in any of the other breeds investigated, symbol . all plots are further annotated with qtl results reported from whole genome association studies in the cattle qtl database "cattle qtldb"  <cit> . we downloaded the gff <dig> file for btau <dig> at  <cit> http://www.animalgenome.org/cgi-bin/qtldb/bt/download?file=gbpbtau. qtl positions are annotated at the midpoints between start and end position of the reported qtl. qtl annotated outside the assembled bovine autosomes and in reverse direction  were filtered. capital letters summarize qtl trait ontology classes: b for meat  traits, e for exterior traits, h for health traits, m for milk traits, p for production traits, r for reproduction traits as classified at animalgenome.org

only qtl annotated from wga studies were considered, because of the large confidence intervals of qtl positions from linkage studies.

additional file  <dig>  figure s <dig> shows a histogram of stouffer's p - values combining whole genome association results with model mixstrat and ihsvoight while additional file  <dig>  figure s <dig> a histogram of stouffer's p - values combining whole genome association results with model mixstrat and ihs.

plots a and b in figure  <dig> report selection signature mapping results applying method ihsvoight and ihs, respectively. we see a nice agreement for both test statistics with the selection signatures reported by  <cit> , in the same breed around  <dig> and  <dig> mb. both plots show an additional strong signal for selection in the region between  <dig> -  <dig> mb which harbours the well studied casein gene family. this becomes evident by the large number of annotated wga results in this region. recently  <cit>  reported a long range haplotype affecting protein yield and mastitis susceptibility in norwegian red cattle that was introgressed from a swedish holstein bull into norwegian red. snps in this region almost reach significance in the combined approach , which clearly demonstrates the increased power of the combined approach, as results from stand alone wga applying model mixstrat was far from signifance for any of the tested snps.

hayes et al.  <cit>  do not provide a supplemental table of ihs test statistics, we could therefore not annotate our manhattan plots with their results. nevertheless the topology of their manhattan plot for bta  <dig> is strikingly similar to our results and results reported by  <cit> . when comparing plot c and d in more detail it becomes evident that combining ihsvoight and wga results does not give as good agreement between the combined ihs and wga test. this is supported by the lower correlation among the top 1% ihsvoight test statistics and regression coefficients from wga .

discussion
mixed model and method to control for stratification
the pairwise ibd matrix obtained by plink  <cit>  based on genome wide snp data most likely underestimated the relatedness among bulls because the underlying algorithm estimates population allele frequencies from a presumably unrelated sample. this is supported by the observation that the average ibd estimate was exactly  <dig>  between  <dig> paternal half-sib pairs and not, as expected, elevated due to underlying distant relatedness. stich et al.  <cit>  used spagedi software  <cit>  to estimate the ibd matrix and noted a similar problem. spagedi also assumes that random pairs of individuals are unrelated and assigns them a kinship coefficient of zero.

the „q+k" method, proposed by  <cit> , is a mixed model with q, a matrix containing population substructure to estimate v, the vector of population effects and the kinship matrix k, which allows estimation of polygenic background effects based on information on familial relatedness from recent coancestry. the authors claimed improved control of the type i and type ii error rates over other methods.

applying method mix instead of a least squares allelic regression substantially reduced the inflation factor λ from  <dig>  to  <dig>  for py. when we extended method mix by q, the matrix on population substructure based on clusters, estimated using the „pairwise population concordance" criteria  <cit> , λ was further reduced to  <dig>   but still did not control for all of the stratification. the here proposed method mixstrat was able to remove stratification  and proved an advantage over method „q+k".

the monte carlo simulation confirms that the proposed mixstrat approach deals correctly with all stratification in the data, as under the simulated h <dig> the observed -log p - value distribution follows their expectation for the dataset as highly substructured as dairy cattle. if our two-step approach had resulted in an overcorrection we would expect to see deflation in the quantile - quantile plot.

detection of selective sweeps
alleles under positive selection increase in frequency in a population and leave distinct signatures in the dna sequence. one of these population-genetics based signatures is the increased length of the haplotype carrying the advantageous allele  <cit>  which is caused by a rapid rise in frequency of the mutated allele. this creates temporary ld with nearby loci. extended haplotype homozygosity statistics  <cit>  contrast this signature between the ancestral and the derived allele at each locus.

the challenge is to determine whether a signature is due to selection or to confounding effects of population demographic history, such as bottlenecks, population expansions and population subdivision or simply due to drift in a finite population. two striking bottlenecks were estimated by  <cit>  in data from  <dig> european and african bos taurus and bos indicus cattle populations. the first and most prominent bottleneck occurred roughly  <dig>  generations ago, which corresponds well with the time of domestication in cattle. the second less pronounced bottleneck, which occurred approximately  <dig> -  <dig> generations ago, is most likely caused by breed formation. we therefore expect substantial demographic noise in our set of selection signature test statistics. furthermore consequent assortative mating is expected to leave signatures in the genome that can easily be mistaken as a signature of selection.

we mapped selection signatures with ihsvoight. large negative values indicate regions in which newly derived alleles are increasing in frequency in the population. large positive test statistics advocate so called soft sweeps, sweep from standing natural variation where the ancestral allele is increasing in frequency for ihsvoight. as changes in the selection regime of dairy cattle are well documented and make sweeps from standing genetic variation likely we believe that it is important to consider both extreme positive and negative ihs test statistics as potentially interesting regions in the cattle genome. we developed a permutation - based extension to the ihs statistic proposed by  <cit>  for which there is no need to determine the ancestral and derived state of the alleles but contrasts minor and major allele. our method obtains locus specific standard deviations of ihs in simulating the null hypothesis and contrasting against an expectation of zero. compared to   <cit>  our method is more conservative for loci with low minor allele frequencies. a higher correlation coefficient between our ihs and βmixstrat indicates that this is a consequence of a decreased rate of false positive detections rather than reduced power. despite successful selection signature scans in cattle we note that protein yield is a typical quantitative trait for which selection is essentially multigenic and therefore likely to undergo simultaneous selective sweeps. chevin and hospital  <cit>  showed that for quantitative traits selection at specific quantitative trait loci may strongly vary in time and depend on the genetic background of the trait. this can blur the signature of selection and the corresponding region will go undetected in a genome scan  <cit> . given the long generation intervals in cattle the number of generations of intense artificial selection is still small which could result in weak selection signals for alleles with small effects. selection signature mapping applied to livestock with similarly strong selection but shorter generation intervals could be even more powerful.

method to combine selection signatures with association signals
we propose a novel approach to increase the power to detect association signals. in this study the statistical power to detect an association signal was quite limited, but by combining two independent sources of information for qtl detection in genome wide studies: association and signatures of selection, we were able to increase power and to reduce the false positive rate. loci that explain variation in economically important traits are likely under selection and will often show incomplete selective sweeps. thus there is a good chance to observe extreme ihs values among loci that show association. this is supported by the positive correlation of  <dig>  between βmixstrat and ihs for loci among the top 1% ihs test statistics. although many of the associations identified by our method are not yet confirmed, the concordance with prior results from wga studies indicates that we were successful in detecting interesting loci. fine mapping of qtl involves genotying of many more snps in the associated region possibly supported by resequencing a subset of extreme individuals  <cit>  and is often tedious and costly. thus it is highly desirable to eliminate false positive associations prior to further investigations.

our combined approach has highest power at intermediate allele frequencies, as both independent sources of information  have highest power at intermediate allele frequencies. alleles that are not allowed to go to fixation are either likely to be under balancing selection  or have pleiotropic effects with positive and negative effects for the traits under selection. such loci are not expected to show a signature of recent positive selection. wga, given the same size of effect, will have equal power to identify such loci and loci under positive selection.

CONCLUSIONS
the combination of wga with hitchhiking mapping to identify a bona fide set of snps for candidate gene studies is very promising. we argue that our method improves power of qtl detection and reduces type i error rate by combining two independent sources of information. our approach can of course be extended to all routinely recorded phenotypes, but for a proof of principle we restricted our analyses to py as this trait was under most stringent selection over the last couple of decades and the bulls were selectively genotyped for py to increase power for the whole genome association study.

stratification is a substantial problem in wga studies, particularly when carried out in livestock populations. our mixstrat approach controls the type i error rate, however at the cost of reduced power.

we accomplished a whole genome hitchhiking mapping study and identified roughly  <dig>  snps displaying selection signatures that show generally good accordance with effects estimated in the wga study. our extension to the ihs test statistic proposed by  <cit>  resulted in a reduced false positive rate in the maf class < 10%, however, it provides reliable p - values only after extensive monte carlo simulations.

given the substantial increase in power and the reduction in false positive signals we recommend using our combined strategy rather than stand alone wga. this is especially important in small populations where it is not possible to genotype additional animals.

competing interests
the authors declare that they have no competing interests.

authors' contributions
md, hs, cs and rf, wrote the manuscript; kf, cw, fs produced genotyping data; hs, md carried out the statistical analysis, hs, md, cs and rf designed the study. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary figures s1-s <dig>  the pdf contains figure s1: histogram of means of  <dig> permuted uihs test statistics per locus; figure s2: histogram of derived allele frequencies for  <dig>  snps in the study; figure s3: histogram of minor allele frequencies for  <dig>  snps in the study; figure s4: histogram of p - values of ihsvoight test statistics; figure s5: histogram of p - values of ihs test statistics.

click here for file

 additional file 2
supplementary figures s6-s <dig>  the pdf shows manhattan plots of bovine autosomes 1- <dig>  7-29; capital letters denote qtls reported from whole genome association studies  in cattle qtldb at animalgenome.org, summarized as qtl trait ontology classes: b.. meat traits, e... exterior traits, h.. health traits, m.. milk traits, p.. production traits, r.. reproduction traits; o annotates a top 5% ihsvoight test statistic as reported in by  in windows of  <dig> kb in brown swiss, x in any of the other breeds investigated; plot a: ihsvoight test statistics, blue line: threshold identifying the top 5%; b: ihs test statistics, blue line: threshold identifying the top 5%; c: combined ihsvoight and wga results with model mixstrat, d: combined ihs and wga results with model mixstrat; blue line is a at 10% false discovery rate threshold.

click here for file

 additional file 3
supplementary figures s34-s <dig>  the pdf shows figure s34: histogram of allele substitution effects from whole genome association study employing model mixstrat in kilogram protein yield; figure s35: histogram of stouffer's p - values of combined model mixstrat and ihsvoight test statistics; figure s36: histogram of stouffer's p - values of combined model mixstrat and ihs test statistics.

click here for file

 acknowledgements
these studies were internally funded by the technische universität münchen. we thank the following artificial insemination stations for providing us with semen samples: besamungstation j. bauer gmbh & co. kg, besamungsverein neustadt a. d. aisch e. v. meggle besamungsstation rottmoos gmbh, niederbayerische besamungsgenossenschaft landshut-pocking e. g., prüf- und besamungsstation münchen-grub e. v., rinderbesamungsgenossenschaft memmingen e. g., besamungsstation birkenberg, besamungsanstalt gleisdorf, oberösterreichische besamungsstation, nÖ-genetik wieselburg. we thank t. meitinger and p. lichtner from institute of human genetics from helmholtz zentrum münchen for generating and validating genotypes. md was supported by austrian science fund : project number l403-b <dig> to cs. we thank three anonymous reviewers for helpful comments and criticisms on earlier versions of this manuscript.
