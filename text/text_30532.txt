BACKGROUND
cells are complex dynamic systems capable of performing a variety of biochemical processes, many of which are of medical or industrial relevance, such as antibiotic biosynthesis or pathways for plant biomass degradation  <cit> . despite the large number of sequenced genomes and metagenomes that are becoming available, our knowledge of the biological processes encoded therein is still limited and process-level genome annotation is far from complete  <cit> . thus, the lack of high quality functional annotation or knowledge of the functional context for the majority of genes in any given genome/metagenome represents one of the biggest obstacles to obtaining quantitative insights into the relevant biological systems  <cit> .

the functional units of signal transduction pathways, metabolic or gene regulatory networks are the products of individual genes, and the analysis of biological processes starts with their identification and characterization. a class of methods known as genome context methods are commonly used to infer the functional relationships between genes. one such method is pairwise co-occurrence  profiling  <cit> . this technique is based on the 'guilt by association' principle  <cit> , which states that genes whose products are functionally coupled are likely to co-evolve and show similar evolutionary histories, resulting in conserved co-occurrence patterns across genomes  <cit> . the phylogenetic profile of a gene defines the organisms in which orthologs can be found, usually encoded as a binary or a real-valued vector with a length corresponding to the number of genomes considered  <cit> . a functional linkage between a pair of genes is predicted if their phylogenetic profiles show pairwise similarity. commonly used similarity or distance measures are the hamming distance, pearson's correlation coefficient, the mutual information and the jaccard coefficient . furthermore, functional coupling is frequently seen in genes that are in spatial proximity to each other in the genome  <cit> . this can be due to their organization in operons, which allows the joint expression and regulation of functionally related genes. therefore, conserved gene neighborhoods are a strong predictor for functional coupling  <cit> . other genome context methods search for gene fusion events  <cit> , similar expression patterns  <cit>  or shared transcription factor binding sites  <cit> . in particular, gene fusion events, in which two genes with linked functions have been fused into one gene during evolution, provide substantial evidence for functional linkage. an obvious strategy to improve functional linkage prediction is to combine these methods  <cit> . this approach is realized in the string database  <cit> .

functional module detection
a functional module is defined as a set of proteins that jointly participate in a biological process  <cit> . as such, it is likely to be rich in proteins that are functionally coupled in a pairwise manner. if not all proteins, at least some subsets of a module's proteins are likely to be tightly coupled in their function. accordingly, the proteins involved may map to densely connected subgraphs of protein-protein interaction networks.

a three step approach for detecting functional modules is common practice: first, genome context methods are used to identify pairwise interactions between proteins. subsequently, the predicted interactions are combined into a functional linkage graph, in which the nodes represent the proteins, and the weighted edges represent the combined evidence for a functional relationship  <cit> . finally, graph-based clustering techniques are used to identify communities of proteins that are likely to be functionally related  <cit> . many definitions for communities in graphs exist  <cit> ; however, the detection of functional modules essentially corresponds to identification of highly connected subgraphs  <cit> . graph-based clustering and problems related to graph partitioning are often np-hard, but can be tackled by approximate methods with good  results  <cit> .

watanabe et al.  <cit>  used the bond energy algorithm to find clusters of functionally coupled proteins, based on pairwise co-occurrence patterns, without constructing a graph. their method uses pairwise distances between gene occurrence profiles, measured with the hamming distance, to identify  groups and is able to detect first-order transitive relationships between proteins. however, biological modules need not be disjoint, in general, and a potential limitation of this approach is the greedy nature of the algorithm, which makes the results sensitive to the order of the input data  <cit> .

besides the aforementioned unsupervised methods, supervised methods such as support vector machines have been applied to identify the proteins of metabolic and signal transduction pathways  <cit> . note that the selection of genomes may be a critical factor for context analyses, because of phylogenetically conserved signals in the annotation data and a taxonomic bias in the determined genome sequences  <cit> . jothi et al. studied the influence of genome selection on the results of co-occurrence profiling and suggested to use phylogenetically diverse, non-redundant sets of genomes  <cit> .

using genome context information in combination with state-of-the-art machine learning approaches is one of the most promising avenues to make progress in functional inference and has not been greatly explored at present  <cit> . here, we demonstrate the utility of this approach for functional context inference. in particular, we use a bayesian method known as latent dirichlet allocation , which is based on a probabilistic topic model  <cit> . topic models are used in text mining applications to reveal statistical relationships between words in collections of text documents, because it was observed that strong relationships usually correlate well with semantic agreement of words. the lda model has previously been applied to identify protein relationships from medline abstracts of scientific articles  <cit>  and to identify genes with similar behavior in multiple chemo-genomic experiments with saccharomyces cerevisiae  <cit> . in contrast to this, our method processes large collections of genome annotations to detect functional modules of biological processes with heterogeneous sizes, which allows both small and large processes to be captured. furthermore, a bayesian model like lda promises a robust performance with respect to common noise present in genome annotations, which greatly vary in quality, and may in part be incomplete or incorporate false functional assignments  <cit> . we applied our technique to a large collection of microbial genome annotations and compared the results with a state-of-the-art pairwise co-occurrence method. our method identified a largely distinct set of predictions, many of which are supported by known functional interactions from string. the set of inferred modules partially maps to known kegg pathways and the modules indicate a functional context for many protein families of currently unknown function. our results thus represent a novel source of functional context assignments for protein families.

RESULTS
a bayesian method for functional module inference
our method uses latent dirichlet allocation  for inferring functional modules of biological processes as follows: a set of genome annotations serves as the document corpus, with individual genome annotations representing the documents. we define a fixed-sized vocabulary of words based on the gene annotations, such that words correspond to functional descriptors for gene products, as for instance orthologous groups  of genes  <cit> , figfams  <cit> , pfam terms  <cit> , ec numbers or other commonly used functional identifiers. genes that are annotated with a certain functional descriptor represent single instances of the respective word. note that our method treats genome annotations as a 'bag of functional descriptors', meaning that the order of genes in the genome sequence is not considered.

the collection of functional descriptors, grouped into genome documents, serves as input to lda, and gibbs sampling is used for model inference . so-called topics represent the latent variables of the lda model and their values are inferred from the collection of genome annotations . each inferred lda topic defines a probability distribution  over the chosen vocabulary. functional descriptors with high probabilities show similar co-occurrence patterns within the collection of annotations. according to the 'guilt by association' principle, the inferred topics are likely to represent functional modules - sets of protein domains or orthologous groups of genes that are functionally linked to each other.

we used the k obtained topic distributions to define potential functional modules : each pf-module is defined by a single topic and comprises the set of functional descriptors selected from the topic distribution by applying a threshold value c. for our experiments, we used c =  <dig> . this choice of c was guided by visual inspection of the topic distributions, in accordance with  <cit> . in this study, identifiers for orthologous groups  of genes, i.e. cog and nog terms from the eggnog database  <cit> , were used as input vocabulary for lda. as such, the inferred potential functional modules correspond to groups of conserved gene families.

functional module inference from prokaryotic genomes
we applied our method to  <dig> prokaryotic genome annotations from the string database, and tested it for different settings of k , with three independent runs for each setting. we achieved the best results for k =  <dig> and k =  <dig> , and discuss results for k =  <dig> in more detail. to obtain a reliable estimate of model stability for k =  <dig>  we performed six additional runs and averaged numerical results over the pf-module sets of all nine runs.

the largest pf-module consists of  <dig>   <dig> ) ogs; the average module size is  <dig>  . based on the module sizes, we would expect approximately  <dig>  ogs to be associated with the modules. however, the inferred modules overlap in og content, as only  <dig> . <dig>  distinct ogs on average are forming the set of modules of a run. in total,  <dig> ogs were consistently associated with the modules for all nine runs. these are likely to represent a core of conserved gene families with strong co-occurrence patterns in the data.

in accordance to the similar module size distributions over the nine runs, we also observed little variation over runs based on other evaluation criteria, discussed below. in the following, we therefore discuss the results from a randomly chosen, exemplary run with k set to  <dig>  in this run,  <dig> non-empty pf-modules were identified ; for two topic distributions, no ogs exceeded the probability threshold c. of these  <dig> modules,  <dig> particularly stable pf-modules could be tracked over all nine runs . the average size of the  <dig> stable modules is  <dig> ogs, and of the  <dig>  ogs associated with all  <dig> modules of the exemplary run,  <dig> % are part of these stable modules. note that the tracking of topic identities over runs follows a greedy heuristic strategy and may underestimate the true number of stable pf-modules .

we analyzed the functional consistency of the  <dig> modules in terms of their enrichment in cog functional categories  <cit> . on average, the most frequent functional category present in a module  is associated with 35% of the contained ogs . this implies that modules are heterogeneous, but often include a significant portion of ogs from the same functional category. interestingly, one of the most abundant categories is general function prediction only , which contains ogs with insufficiently characterized functions. thus, placement in a functional module might further indicate the functionalities for these gene families.

we could map  <dig> of the stable modules  and  <dig> of all modules of the exemplary run  to kegg pathways, based on six or more matched ko terms in the respective pathway. overall, the modules contained many interactions annotated in the kegg database. however, this only explained a part of the pf-modules, so we evaluated the functional coherence of the identified groups by means of additional quantitative measures.

the modules were identified as being stable across nine independent runs of our method with k =  <dig> 

functional coherence of modules
for the analyzed genomes, the string database provides evidence for pairwise functional couplings of ogs related to different types of functional modules, such as metabolic and signal transduction pathways, as well as protein complexes. the data include predictions from several genome context methods, as well as functional relationships from public protein-protein interaction and metabolic pathway databases. for our evaluation, we exclusively selected pairs of ogs that were sufficiently supported by evidence other than co-occurrence profiling . overall, the reference dataset with this restriction comprised  <dig>  distinct og pairs. to evaluate the functional coherence of a module, we considered all possible pairs of ogs within the module, and determined the percentage of these found in the reference set. module derived og pairs that are part of the reference are referred to as verified pairwise functional couplings . a high proportion of verified pairs then indicate the functional coherence of a module.

the average percentage of verified pairwise functional couplings for all  <dig> modules of the exemplary run is  <dig> % , and the individual results for the modules are highly significant according to an estimate based on the hypergeometric distribution . given the size of the input vocabulary , the probability of an arbitrary og pair matching a pair from the reference set by chance is phit =  <dig> . for an average-sized functional module, which consists of  <dig> ogs and  <dig> og pairs, one would expect to observe less than one match by chance . thus, even small numbers of verified couplings are highly significant.

the proteins of a functional module may not directly interact, but be transitively linked to each other instead. therefore, we also searched for indirect relationships. the og pairs in the reference set correspond to edges in a functional network defined by high confidence interactions in string. we matched the og pairs of a module against this network. if a pair exists in this reference network, it may either be an isolated edge or an edge connected to other matched edges. ideally, all ogs of a module are functionally related and form a single connected component within the network. this would mean that they are either directly or indirectly functionally linked to each other. we denote the fraction of a module's ogs that are part of the largest connected component in the reference set as the module's coverage . thus, if a module has coverage of 75%, this means that three-fourths of the module's ogs are either directly or indirectly linked to each other.

in total, we found  <dig> modules with an average size of  <dig>  ogs and coverage of more than 50%. we also evaluated the first-order transitive relationships , for which the total fraction of verified pairs rose from  <dig> % to  <dig> % .

we subsequently investigated how the validated pairs of the modules are dispersed within the reference network, i.e. whether they form isolated edges or highly-connected components. to this end, for each module, we determined the number of its connected components within the reference network. more than half of the modules map to only one such component; the average is less than two  components per module. thus, the majority of modules represent large clusters within the reference network, with only a few isolated edges.

modules with matches to kegg pathways
we found three interesting modules  among the stable modules in all nine lda runs. these have a cog category functional enrichment of more than 50%. the first two modules are related to chemotaxis and the flagellar apparatus. 'chemotax' consists of  <dig> ogs and is very rich in signal transduction genes . strikingly, this module achieves a coverage of 100%. of the  <dig> verified og pairs , only  <dig> were also detected by co-occurrence profiling. the larger 'flagell' module consists of  <dig> ogs and is rich in cell motility genes . this module has a coverage value of 91%. in the 'flagell' module, we identified  <dig> verified pairwise and  <dig> verified transitive functional couplings, whereas pairwise co-occurrence profiling identified  <dig> of these  <dig> couplings. interestingly, 'chemotax' and 'flagell' share two gene families , which are both assigned to the functional categories for signal transduction  and cell motility . 'chemotax' and 'flagell' thus may capture different aspects of a biological network related to chemotaxis and cell motility. while 'chemotax' does not correspond to a kegg pathway and mainly consists of the ogs responsible for signal transduction, 'flagell' comprises structural components of the flagellar apparatus and contains most of the elements of the respective kegg map . indeed, the relationship between the flagellar apparatus and chemotaxis is well known  <cit> .

furthermore, we identified a module comprising  <dig> gene families  that largely maps to the kegg pathway 'porphyrin and chlorophyll metabolism' . the module almost completely covers the process of synthesis from precorrin- <dig> to the vitamin b <dig> coenzyme, and we therefore refer to this module as 'vitb12'. the module has a coverage of  <dig> %, while pairwise co-occurrence only predicted  <dig> % of the  <dig> verified pairwise or transitive functional couplings. it should be noted that 'vitb12' clearly represents a meaningful module, although its  <dig> og pairs with direct matches in the reference set cover only  <dig> % of the tested pairs. most supported pairs for this module originate from the 'database' and 'neighborhood' channels of string.

another interesting stable module of  <dig> ogs that comprises ribosome-related gene families was found for k =  <dig> in all nine runs . the module maps to the kegg reference pathways 'ribosome'  and 'aminoacyl-trna biosynthesis' . the functional enrichment for category translation and ribosomal structure  is 73%, and four gene families represent translation factors. thus, our method is capable of identifying modules with a larger functional context than a single kegg pathway. interestingly, the module has a coverage value of 97% and none of the interactions were found by pairwise co-occurrence. note that this module is not the only module related to the ribosome kegg pathway. several other modules map to pathways that are involved in protein biosynthesis. the number of verified pairs for all presented modules was highly significant according to our significance estimate .

functional coherence of the modules in dependence of lda parameter k
we evaluated the impact of k, the number of topics to be inferred, in a series of experiments with k set to  <dig>   <dig>   <dig>   <dig> and  <dig> . each experiment comprised three independent runs. the mean module size increased notably from k =  <dig>  to k =  <dig> , whereas it remained similar for k =  <dig>   <dig>   <dig> and  <dig>  interestingly, the functional coverage values only varied slightly for different settings of k, although the number of modules and their sizes steadily increased. this suggests that most of the identified modules for different settings of k were supported by evidence from string. the number of stable modules is larger for k =  <dig> and k =  <dig> than for runs with smaller values of k, and these modules also contain more distinct ogs. thus, for larger values of k, a larger part of the string reference interaction network is identified. we additionally matched the stable modules from each experiment to the kegg database to identify pathways with six or more hits to any one of the modules. for k =  <dig> and k =  <dig>  this resulted in the most diverse profiles with matches to  <dig> different kegg pathways. we decided to use a setting of k =  <dig> for a further detailed analysis, which included six additional runs, because this setting showed good results with respect to identified kegg pathways and the largest support by known functional interactions; in terms of the fraction of identified stable modules with a coverage of at least 50% . further details of this comparison are discussed in a supplementary note in additional file  <dig> 

we performed  <dig> experiments to test different settings of k. the reported numbers for each experiment are averaged mean values of three runs. we used a greedy approach to track module identities across the runs for each setting of k, and refer to the modules identified in all three runs as the stable modules. the last column gives the number of stable modules with sufficient evidence for functional coherence based on the string analysis .

comparison with pairwise co-occurrence profiling
we compared our method with the state-of-the-art pairwise co-occurrence profiling method used in string. pairwise co-occurrence identified a small fraction of the verified pairwise or first-order transitive couplings of the modules . the venn diagram in figure  <dig> shows the overlap with the reference set for both methods. overall, both methods detected a small subset of the  <dig>  reference pairs, resulting in recall rates of  <dig> % for the modules and  <dig> % for pairwise co-occurrence. these rates suggest that, in general, co-occurrence patterns contribute different evidence for functional linkage than other available sources of information about functional linkages. the pf-modules cover a largely distinct set of interactions, which includes  <dig> % of the validated predictions of the pairwise method. the  <dig>  validated functional couplings exclusive to the pf-modules exceed the overall number of linkages predicted by pairwise profiling. we mapped these  <dig>  pairs to kegg and found matches for  <dig> % of them. the most abundant kegg pathways were 'ribosome', 'two-component system' and 'oxidative phosphorylation'.

for a complete evaluation, the precision, i.e. the fraction of correct assignments of all predicted linkages should be determined. however, this is complicated by the fact that non-existing interactions  may reflect incomplete knowledge rather than the absence of interaction. furthermore, solely for the sake of comparison with pairwise co-occurrence, all possible pairs were enumerated as functional linkage candidates within each module, which is not an assumption warranted by our method and results in a large number of pairwise interactions being tested. with these restrictions being applied, precision values for both methods are  <dig> %  and  <dig> % . this value may serve as an estimate of the lower bound of the actual precision for functional module inference. as pairs of gene families in a module may also interact indirectly with each other, they may not directly match a pair of the reference set. when taking these indirect interactions in the reference set into consideration , we found evidence for  <dig>  og pairs that represented further functional relationships implicitly verified by string. combined with the  <dig>  directly verified pairs, this corresponds to  <dig> % of the tested  <dig>  pairs and may serve as a second estimator of precision for the presented functional module inference.

the capacity to identify indirect relationships highlights an important advantage of directly inferring groups of functionally related ogs. of the identified transitively linked pairs,  <dig> could be mapped to kegg pathways. interestingly, the fraction of verified-trf-couplings also serves as an indicator for meaningful relationships revealed by the modules that are not directly identified by any of the pairwise operating genome context methods used in string. as such og pairs are not explicitly part of the reference set, none of the prediction methods in string provided sufficient evidence for their direct coupling. however, as demonstrated, a transitive relationship exists in the reference.

the modules cover parts of the reference network that tend to be tightly interconnected. figure  <dig> visualizes the densely connected core of the functional network defined by the reference set, showing the embedded prediction sets of both methods . the modules that we have discussed are embedded in this network, showing that our method is capable of identifying meaningful groups of ogs in a dense interaction network.

CONCLUSIONS
we proposed and evaluated a new probabilistic method for directly identifying functional modules of gene or protein families using co-occurrence patterns in a collection of annotated sequence samples. in our analysis, we used orthologous groups of genes , which are considered to be a reliable estimator for isofunctional groups of genes  <cit> . however, one could also use terms such as figfams, which incorporate careful manual curation by experts  <cit> , ko terms, pfam domains, tigrfam terms or ec numbers  <cit> .

the presented method is capable of simultaneously processing a large number of genome or metagenome annotations. we tested our methodology on a comprehensive set of microbial genomes; but certainly a targeted selection of a suitable collection of genome annotations for input will be a major key to the detection of further interesting pf-modules in the future.

our method returns a soft clustering of functional annotation terms, in which a term can be assigned to multiple modules. this is well suited for the problem of assigning gene families to biological processes, given the multiplicity of roles and functionalities associated with some gene families, which may depend, for instance, on the genomic context  <cit> . furthermore, processes may appear in multiple, slightly different variants across genomes. such process variations arise, for instance, through alternative branches in metabolic pathways, or through reactions that can be realized by structurally different proteins  <cit> . the topic model that we use accounts for this phenomenon adequately. lda topics are globally defined for the analyzed collection of genomes and therefore generalize over slightly different variants of a process, instead of splitting them into multiple modules. thus, a functional module may combine multiple isofunctional but non-orthologous gene families, which fulfill similar roles in different organisms.

lda is an unsupervised method, which requires no a priori knowledge about the structures it identifies. this gives us the opportunity to detect previously unknown functional modules. however, this also means that the nature of the biological entities captured by these modules is uncertain. for instance, metabolic and signal transduction pathways, protein complexes or mixtures of these might be the underlying biological signals.

we evaluated the biological significance of the identified modules using functional interactions from string, which integrate different sources of biological information about functional modules. as a result, we found that pf-modules cover diverse biological signals, such as protein complexes , signal transduction components  and metabolic pathways . a convenient property of the method is that the input data are represented as 'bags of gene families' and thus no knowledge of the neighboring genes is required. therefore, it can also be applied to highly fragmented metagenomes with many short fragments, for which there is currently a shortage of analysis techniques  <cit> .

in our study, we observed that the identified potential functional modules are significantly enriched with high confidence functional interactions and capture well-known biological processes, such as chemotaxis. moreover, the majority of the modules' high confidence interactions were not detected by a state-of-the-art pairwise co-occurrence method.

notably, a great number of newly implied og interactions, derived from the pf-modules, could not be verified as pairwise interactions, but received reasonable support as first-order transitive relationships from string instead. and many of these interactions could also be mapped to kegg pathways. in summary, this shows that an approach of direct inference of functional modules reveals further information about biological processes. we believe that the direct inference of groups of genes is well suited for the discovery of functional context, as biological processes incorporate many indirect functional couplings between the encoded proteins. for instance, proteins may serve as network hubs that link two or more processes. in this case, proteins from the processes involved will be directly coupled to the hub and only indirectly to the proteins of the other processes. finally, in many cases, the proteins of a particular process vary between different organisms  <cit> . these scenarios result in proteins that are only transitively linked to each other via other proteins of a process.

the inference procedure of the lda model is based on a markov chain monte carlo method. with a limited number of iterations, such methods are non-deterministic, i.e. a series of lda runs will not produce exactly the same sets of pf-modules. at the chosen stop point of iterations, we observed that the size distribution as well as the degree of functional coherence over the module sets varied only slightly between runs, indicating that there is sufficient convergence of the markov chain. our heuristic search strategy allowed us to identify  <dig> stable modules across the nine runs we performed. however, many of the other pf-modules also occur in more than one run. we investigated the relationship between stability and functional coherence. the average coverage over all  <dig> pf-modules was  <dig> %, while the  <dig> less stable pf-modules showed an average coverage of  <dig> %. thus, also the less stable modules contribute significantly to the overall estimate of functional coherence.

an interesting future direction for research will be the use of the genome-specific topic-weights to investigate how the gene family content of a functional module varies in individual genomes . we found that the ogs of the modules are associated with almost all the cog functional categories and that ogs with no specific functional assignment  are frequent. therefore, we could use modules to refine gene annotations in the following way: assuming that a given module shows evidence for being related to a specific biological process and that the module is assigned a high weight for a genome of interest. then, poorly characterized genes of this genome, whose gene families are associated with the module, could be tentatively associated with this biological process. methods for assessing the function of poorly characterized genes from putative interaction partners are currently being investigated  <cit> . another interesting research direction will be to analyze the evolution of functional groups, based on the presence or absence of  a module across taxa.

prediction methods for functional relationships that rely on conserved genomic context are prone to false positive predictions if pseudo-genes are involved  <cit> . pseudo-genes are functionally disabled copies of genes, which typically occur in at least 1-5% of gene-like sequences in prokaryotic genomes  <cit> . we found several pf-modules that integrate different transposable elements. in these cases, pseudo-genes might have had an impact on the inferred modules. lda, like other co-occurrence techniques, could principally be misguided in cases where multiple copies of an og reside in the same genome by chance without being retained by selection for a certain functionality, e.g. due to repeats of a genomic sequence.

we compared results for different choices of the number of topics to be inferred, and suggest choosing a setting for k between  <dig> and  <dig> for the analyzed set of genomes. finding an optimal choice for the number of topics corresponds to the problem of model selection in latent class cluster analysis  <cit> . blei et al.  <cit>  proposed tackling this problem by modeling a hierarchy of topics and embedding lda into a hierarchical dirichlet process  <cit> . however, the additional level of complexity in these models is likely to cause the inference process to be more time-consuming, and convergence of the process has to be carefully monitored.

in summary, we found that our method allows identification of well-known biological processes, as well as the discovery of new modules supported by high confidence functional interactions. it furthermore places many gene families of currently poorly characterized function within a functional context. the presented technique could thus help to enhance our knowledge of the biological processes governing microbial life and reveal new functional connections for many microbial genes.

