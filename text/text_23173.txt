BACKGROUND
the accurate determination of orthology is central to comparative genomics. pinpointing the origin of new genes, understanding the evolution of new gene families, and assessing the impact of gene and genome duplication events all require the accurate assignment of orthology between genes in distinct genomes. in complex genomes with large gene families this task requires differentiating between genes that have diverged through a speciation event  and those derived through duplication events within a species . determination of orthology and paralogy is especially challenging in vertebrates species such as the mammals. very large gene families, high rates of gene duplication and loss, multiple mechanisms of gene duplication, and high rates of retrotransposition all combine to make the determination of orthology between vertebrate genes difficult.

given the importance of accurate orthology assignment, many methods have been developed to identify orthologous genes. most of these methods rely upon analysis of the inferred protein sequence of the genes in question by clustering the results of protein sequence comparisons results in the classification of putative orthologs. examples of this approach include reciprocal best blast hits and more inclusive blast based clustering methods. splitting of these clusters based on relative similarity can distinguish between older and newer duplication events and is implemented in the widely used inparanoid algorithm  <cit>  and related approaches  <cit> . while these methods are robust and easily implemented, they rely upon a single character, the protein sequence, for classifying genes into orthologous groups.

more recently, methods have been proposed that use genomic context in addition to protein sequence to improve orthology assignment. these methods have been most successfully implemented in fungal genomes  <cit> , and have long been used in prokaryotic genomes  <cit> , where gene order is far less variable than in eukaryotes. an interesting implementation of this approach is found in the soar and msoar algorithms  <cit> , which seek to assign orthology by minimizing the recombination distance between two genomes. in most of these approaches, synteny blocks covering some percentage of the genome are used hierarchically with protein coding information to assign orthology between similar genes. approaches that exploit synteny information can be particularly useful in resolving ambiguous sequence based matches between putative orthologs. recently, han and hahn  <cit>  used local synteny information to identify parent-daughter relationships among duplicated genes. however, it is worth noting that "phylogenetic shadowing"  <cit>  approaches used in genome assembly might lead to a lack of independence between sequence and synteny information.

in this study, we evaluate a simple method for using gene order  in the identification of mammalian orthologs. we explicitly compare the relative performance of local synteny and inparanoid for inferring orthology within this clade and show that local synteny alone is sufficient to identify orthologs with an accuracy comparable to that of inparanoid. by analyzing cases of discordance between local synteny and inparanoid we show that local synteny can distinguish between true orthologs and recent retrogenes, can resolve ambiguous many-to-many orthology relationships into one-to-one ortholog pairs, and can highlight possible cases of parental gene displacement by retrogenes.

RESULTS
using local synteny to infer orthology
several orthology inference methods, such as inparanoid  <cit>  and orthomcl  <cit> , use coding sequence similarity  as primary orthology signal. in this paper, we use local synteny information to determine orthology. we define the local synteny of two genes as the maximum number of unique homologous matches between their six neighboring genes . homology between two neighboring genes is defined as blastp e-value < 1e- <dig> 

to validate the use of local synteny for inferring orthology, we evaluated the correlation between protdist and local synteny using a dataset derived from the pfam protein family database. pfam families are highly accurate protein families based on protein domains  <cit> . we randomly selected  <dig>  cross-species homologous protein pairs  from five mammalian genomes: homo sapiens , pan troglodytes , mus musculus , rattus norvegicus , and canis familiaris . to avoid protein family-specific bias in this analysis, we chose one homologous pair from each pfam family. for each pair we computed protdist and the degree of local synteny between the two genes. figure 2a shows that there is negative correlation between protdist and the local synteny of these samples . this is not surprising as gene order is conserved between dna segments resulting from speciation or large-scale segmental duplication events. however, because local synteny is not directly computed based on the coding sequence, we can use local synteny to test hypotheses of orthology between two genes independent of their coding sequence.

theoretically two non-orthologous genes should not share homologous neighboring genes. however, there is a small probability of homology matches occurring by chance. moreover rearrangements, insertions, and deletions will lead to loss of local synteny between orthologous genes. in order to account for these events, we wanted to determine an optimal window size and match percentage that could reliably identify orthologs based on local synteny. in figure 2b, we test the impact of the number of matches between six neighboring genes to determine local synteny. student's t tests comparing protdist means illustrate that  <dig>   <dig>  and > <dig> matches have significantly different protdist means . in order to choose the threshold of homologous matches, we calculate the false positive rate  and false negative rate  to inparanoid orthologs and ensembl orthologs then choose the threshold that minimizes the sum of fp and fn events. for six neighbors, the pairs with more than one homologous match minimizes fp and fn rates ). increasing the window size to  <dig> or  <dig> flanking genes does not show a significant difference in detecting orthology . based on these results we define orthology by local synteny when the number of maximum unique homologous matches between the six neighboring genes is greater than one. we will refer to those pairs as syntenic from now on.

false positive/false negative rates estimated by lca 
since many orthology detection methods use more complicated algorithms than just coding sequence similarity, a high correlation between protdist and local synteny  is not sufficient evidence that local synteny captures true orthology. for a more rigorous analysis we compared local synteny based orthology to the orthology relationships inferred by six well-known orthology detection methods: inparanoid  <cit> , orthomcl  <cit> , rbh , sbh , blastp, and orthology data from ensembl  <cit> . since there is no gold standard of orthology, we performed latent class analysis   <cit>  to estimate the accuracy  in the absence of a reliable standard. lca estimates false positive  and false negative rates  based on agreement and disagreement between various ortholog definitions. to minimize sampling bias  <dig> lca's were performed on random samples with a size of  <dig>  orthologous genes from five mammalian genomes using the same sampling method described in the previous section. for one sample  <dig>  pfam families were randomly selected, then one cross-species protein pair was selected from each pfam family for analysis by the seven compared orthology inference methods. for all methods based on coding sequence similarity, the longest proteins were used as the representative proteins of the genes. a more detailed description can be found in the methods section.

discordance between inparanoid orthology and local synteny based orthology
because inparanoid is one of the most widely used ortholog definition methods  <cit>  and is purely based on the coding sequence information, we decided to do a more thorough comparison of inparanoid and local synteny based orthology. figure  <dig> shows the agreement and disagreement between these two orthology prediction methods. the majority of these samples are concordant between two ortholog predictions  and non-syntenic/non-inparanoid ), which agree with the lca results . however,  <dig> % of inparanoid orthologs are non-syntenic, and  <dig> % of gene pairs are syntenic but not inparanoid orthologs.

in order to identify the source of this discordance we employed intron-based evidence. specifically, for each gene pair used in the test we computed the intron conservation ratio  between the two genes defined as follows :  

non-syntenic inparanoid orthologs with zero icr: retrotransposed copies
all the non-syntenic inparanoid ortholog pairs with zero icr contain one intronless copy and one intron-bearing member. based on local synteny information and intron conservation ratio, these intronless copies are probably retrotransposed  copies of the original orthologs. of all the samples,  <dig> % are non-syntenic 0-icr inparanoid orthologs. inparanoid likely included rt copies in these orthologous groups because the rt copies have not diverged sufficiently to be distinguished from their parent gene. in  <dig> % of samples inparanoid chose rt copies even though there were other syntenic high-icr copies. figure  <dig> shows one of these pairs. in this case, the blastp score of the dog gene to the rt rat gene  is smaller than to the syntenic high-icr rat gene , which caused an inparanoid miscall, assigning the rt paralog as the ortholog. for the detailed information including blastp scores and protdist in tabular format, see additional file  <dig> 

the rest of non-syntenic 0-icr inparanoid orthologs  of all samples are classified as one-to-many orthologs by inparanoid. in many of these one-to-many orthologs, syntenic high-icr pairs are chosen as "core orthologs"  with additional rt copies added to the orthology group because their protein sequences are still close to those of the original copies. by using local synteny, the rt copies in one-to-many orthologs would be distinguished from the other members. thus, local synteny based orthology separates rt copies from those generated by speciation or other duplication mechanisms and can be more informative in recovering the evolutionary history of a gene family.

non-syntenic inparanoid orthologs with non-zero icr: loss of local synteny
all non-syntenic inparanoid orthologs with an icr >  <dig>  are likely to result from the loss of local synteny. they each have one homologous match between neighboring genes  and are selected from distant species pairs . each of these distant pairs is part of larger orthology groups , in which the counterparts in closer species pairs have higher local synteny . this loss of local synteny likely results from rearrangements and gene insertions or gene losses in more distant species. see additional file  <dig> for an example.

syntenic non-inparanoid orthologs: distant paralogs
there are  <dig> % syntenic non-inparanoid orthologs with an icr ≥  <dig>  . the majority  of syntenic non-inparanoid orthologs with high icr are likely distant paralogs: both genes are in different syntenic inparanoid orthology groups with high icr. this may result from old dna-mediated duplication events followed by speciation events without significant local genome rearrangements. local synteny cannot distinguish between orthologs created by large-scale segmental duplications and by polyploidy events. moreover, the syntenic non-inparanoid pairs with an icr <  <dig>   are also likely distant paralogs, by old tandem duplications with different gene structures resulting in lower icr.

non-syntenic non-inparanoid orthologs with icr of 1: more distant paralogs
in the non-syntenic non-inparanoid case , where the most of these pairs have low icr, we still find  <dig> % of pairs with icr equal to  <dig>  all these pairs are likely distant paralogs. table  <dig> contains the summary of all of these cases.

local synteny breaks the tie
since local synteny is able to differentiate some speciation and duplication events, a phylogenetic tree  of ambiguous many-to-many orthologs may be determined using local synteny information. in mouse-to-rat ortholog definitions from inparanoid, there are  <dig> many-to-many ortholog groups. the majority  of many-to-many groups are comprised of dna-mediated duplicated copies  while ~20% have true orthologs  as well as non-syntenic intronless copies .

we present two many-to-many inparanoid ortholog groups where the local synteny determines the order of evolutionary events in the gene family. one of them is an example of orthologs from distant dna-mediated duplication event followed by possible rearrangements or gene gains/losses, and then speciation event . in this ortholog group, there are three mouse gene members, ensmusg <dig> , ensmusg <dig> , ensmusg <dig>  and two rat gene members, ensrnog <dig> , ensrnog <dig> . all the genes are on different chromosomes and the transcripts of these  genes are known. since all the cross-species pairwise sequence similarity measures are equal, inparanoid could not pick distinct orthologs nor could phylogenetic tree-building programs determine the tree . neither could icr break the tie due to a high conservation of gene structure. finally, no ensembl ortholog prediction is made between these genes. however, in the figure, two calm <dig> genes  and two calm <dig> genes  have high local synteny  and any other local synteny is either  <dig> or  <dig>  in this specific case, local synteny helps break the tie in sequence based similarity. using this information we can infer an old segmental duplication  event before mouse-rat speciation giving rise to the calm <dig> and calm <dig> ancestors followed by rearrangements reducing the local synteny between these two mouse and rat ortholog pairs . the third mouse gene  has just one match with mouse calm <dig> gene and rat calm <dig> gene, and high levels of intron conservation, indicating a dna duplication event, but we do not have enough local synteny information to tell precisely when the duplication occurred. also since the mouse calm3x gene has only one match with the rat calm <dig> gene, local synteny does not find this apparent ortholog. for the detailed information in tabular format, see additional file  <dig> 

another case where local synteny clarifies the history of closely related groups of duplicates can be seen in a mouse-rat many-to-many inparanoid ortholog group including rt copies . this example contains two members from each species, ensmusg <dig> , ensmusg <dig>  and ensrnog <dig> , ensrnog <dig> , where each has one known transcript on different chromosomes. again, neither inparanoid nor pairwise protdist analysis could discriminate orthologs due to identical cross-species blastp measures . ensembl has a bigger ortholog group including these four genes, but no better information about which are orthologs or rt copies. however two intron bearing genes have perfect local synteny  and an icr =  <dig>  and two intronless copies do not have any local syntenic match to the two intron bearing genes. therefore, we can infer that two intron bearing genes are the main orthologs and two intronless genes are rt copies of these orthologs. furthermore, since intronless genes are not syntenic to each other, we infer that the two intronless genes are the result of two separate rt events on each species lineage. for detailed information in tabular format, see additional file  <dig> 

discussion
fp and fn estimates by using lca
the accurate determination of orthology is critically important to comparative genomics. however it has been a challenge to compare the various orthology determination methods without a reliable gold-standard orthology dataset  <cit> . the statistical technique of latent class analysis allows estimates of false positive and false negative rates from data based on agreement and disagreement between various ortholog definitions. because error rates estimated in this way may be affected by which methods are included in the analysis, we must consider the fp and fn rates estimated here as relative error rates. furthermore, these error rates might not reflect rates obtained from a genome-wide implementation of these methods. there is an ongoing effort on standardizing protein datasets for benchmarking orthology determination methods  <cit>  which would help resolve this issue.

in figure  <dig>  inparanoid and rbh agree more closely than any other pair of orthology definitions. this is in accord with the fact that inparanoid uses the reciprocal best hit to start core ortholog identification. sbh and blastp have zero fn rates and higher fp rates than inparanoid and rbh due to less stringent conditions used for ortholog detection in these methods. the order of fp rates  is concordant with the stringency of each method. the fp rate of local synteny based orthology falls between sbh and rbh. this is reasonable considering the fact that sbh and local synteny based orthology cannot distinguish close paralogs from ortholog pairs, but local synteny can separate rt close paralog copies from orthologs.

the fn rate of local synteny based orthology is higher than those of blastp based orthologies . this may be due to distant paralogs retaining flanking genes, but diverging in their coding sequences enough to be distinguishable by blastp. rt miscalls by inparanoid  are also likely to have contributed to the relative fn rate of local synteny based orthology.

due to the fact that orthomcl detected the smallest number of orthologs in any sample  the estimated fn rates from orthomcl are the highest in this experiment . this is opposite from the result of chen et al.  <cit>  where orthomcl and inparanoid were shown to have lowest estimated fp and fn rates and orthomcl has lower fn rates than inparanoid. the apparent disparity between these results could be explained by the fact that lca is designed to estimate consensus fp and fn rates without any guarantee that the estimated rates are close to absolute values, and by the difference in the species sets used in the two experiments: our dataset of five mammalian genomes and the comparatively distant seven eukaryotic genomes used in chen et al.

gene order as a measure of conservation
synteny information has been used to cluster synteny blocks between two related genomes in order to detect orthologous gene pairs  <cit>  and to reconstruct phylogenetic trees  <cit> . these synteny blocks are generally used as "genomic anchors"  <cit>  or to place gene loss/deletion events on phylogenetic trees  <cit> , not as a definitive measure to distinguish close paralogs from distant paralogs. in zheng et al.  <cit> , one of three methods to define orthologs between human and mouse used a genomic anchor approach. they identified synteny anchors and synteny blocks  <cit>  then introduced a local synteny approach for the anchor-poor regions by accepting the pairs of genes flanked by previously identified ortholog pairs. with this approach they found 11% more orthologs than by rbh alone.

another similar approach to local synteny was used to reconstruct phylogenetic gene trees from coding sequence similarity and local gene order  <cit> . in the algorithm synergy, wapinski et al. measure a synteny similarity score for a pair of genes by counting the neighboring genes in syntenic blocks. however, synergy has not been tested in mammalian genomes.

finally, msoar  <cit>  uses combinatorial optimization on global gene order to identify orthologs based on minimal rearrangement scenarios. however, fu et al. point out that the global optimization might lead to false ortholog links in some scenarios. because our local synteny exploits proximate synteny information we expect lower false positive ratios than those obtained with msoar.

most importantly, when the orthology is defined by codon sequence similarity, testing any hypothesis of selective pressures on orthologous gene presents tautological challenges. since orthology detection by local synteny is not based on the comparison of coding sequence information between candidate orthologs, testing the selective pressure between orthologs becomes a valid comparison of largely independent variables. however, gene order also degrades over evolutionary time. how well synteny will be able to effectively identify ancient orthologs remains to be seen.

gene duplication mechanisms and orthologs
gene duplications are a major force in genome evolution  <cit> . genes are duplicated through two main duplication mechanisms; dna-mediated and rna-mediated  <cit> . dna-mediated duplications can include multiple genes and associated intergenic sequences and introns. on the other hand, rna-mediated duplication, or retrotransposition , only copies coding sequences in the duplication event. retrotransposed genes had been considered mostly "dead on arrival", but recent studies  <cit>  show that there are many functional rt copies in the human and mouse genomes.

sometimes the difference between coding sequences of parental genes and rt copies is not large enough to distinguish the rt copy from the parent. rt copies, however, do not share introns or flanking genes with the parental paralog. therefore, local synteny and gene structure can often separate the rt copy from the original gene. however, when neither has an intron, only local synteny will distinguish parental and rt copies. based on our random sampling, approximately 8~10% of pfam orthologs are intronless gene pairs.

gene order helps illuminate gene family evolution
reconstructing phylogenetic trees informs our understanding of the evolutionary history of gene families. using tree reconciliation between a species tree and gene tree we can identify duplication and lost events on the tree. however by distinguishing two duplication mechanisms, dna-mediated and rna-mediated, not just identifying duplication events, we can sometimes place duplication events in an appropriate phylogenetic context. for example, as figure  <dig> and figure  <dig> show, when coding sequence does not distinguish paralogs, local synteny can determine whether dna or rna-mediated duplication occurred first. local synteny can also help place rt duplication events before or after speciation . even when the coding sequence of rt duplicates drifts apart, pre-speciation rt genes often retain local synteny. conversely, when rt duplicates are young enough to be indistinguishable by coding sequence comparison, synteny can discriminate between pre-speciation duplications, and independent rt duplication events in parallel lineages. finally, local synteny information can often resolve the order of iterative dna-mediated duplication events in large gene families .

CONCLUSIONS
in this paper, we investigate the concordance between coding sequence based orthology  and local synteny based orthology. in the  <dig> mammalian genomes studied, 93% of the sampled inter-species pairs were found to be concordant between the two orthology methods, illustrating that local synteny can largely substitute for coding sequence in identifying orthologs. however, 7% of pairs were found to be discordant. discordance is often associated with evolutionary events like retrotransposition, iterative dna-mediated duplication, and genome rearrangement. analysis of discordant cases between local synteny and inparanoid shows that local synteny can differentiate between true orthologs and recent retrogenes, can split ambiguous many-to-many orthology groups into more precise one-to-one ortholog pairs, and, when employed in a genome-wide screen, might help in highlighting possible cases of non-orthologous gene displacement by retrocopied paralogs in mammalian genomes.

