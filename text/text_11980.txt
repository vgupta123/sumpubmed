BACKGROUND
genome-wide association studies  have emerged as a powerful tool to examine the genetic components of complex disease. during the past six years, gwa studies have successfully uncovered a few thousands of markers/genes that are associated with complex diseases/traits  <cit> . so far, most standard gwa studies have focused on single marker based analysis and applied the genome-wide significance cutoff p value  <dig> × 10- <dig> for detecting significant markers; however, many weakly or moderately associated markers  may also provide valuable insights. these markers have been generally missed in the standard analysis.

gene set analysis  of gwas data provides an alternative approach of assessing the joint effects of multiple genes  <cit> , regardless of whether they are individually significant or not. complex diseases are likely caused by multiple genes and markers, each of which may only contribute weak to moderate effect. given that these markers are biologically or functionally correlated, gsa would increase the power to detect them in a typical gwas dataset  <cit> . gsa typically uses pathways or functional categories of cellular processes to define gene sets, such as those from the kegg database  <cit>  and the gene ontology  annotations  <cit> . among the available gsa methods, representative ones include the gene set enrichment analysis  of gwas data  <cit> , the association list go annotator   <cit> , and the gene set ridge regression in association studies   <cit> . an advanced gsa approach is to use protein-protein interaction  network data as the platform to dynamically search for "gene sets", namely network modules, and perform an enrichment test for association signals. our dense module search of gwas association signals from ppi network is one of the first methods <cit> . besides, rossin et al.  <cit>  used ppi network to assess whether the association loci uncovered in standard gwa studies are significantly connected through ppis. they adapted a straightforward way of defining subnetworks  <cit> , i.e., given a list of loci and the genes located in them, "direct networks" and "indirect networks" are constructed based on the network data. however, the gwas data is not effectively incorporated in the process of network building such that the moderately associated genes  are still missed. therefore, more comprehensive methods are in need to incorporate the gwas data with the ppi data to help construct, prioritize, and evaluate subnetworks for complex diseases.

in most of these gsa methods, a critical issue is how to define the gene-wise p value, the p value representing the association signal at each gene region. in a typical gwas data, statistics at the single nucleotide polymorphism  level is used, but biological data  are typically annotated to genes/proteins. thus, there is a gap between marker's significance and gene-wise significance. a popularly applied method in the field is to select the most significant snp from the multiple snps mapped to each gene and represent the gene by the smallest p value  <cit> . although this method is sensitive to retain the association signals and is easy to implement, this way of using the minimum p value bears intrinsic biases, including gene length, snp density, and/or linkage disequilibrium  structures <cit> . recently, several reported methods aim to compute gene-wise p values, such as gates  <cit> , which adapts the simes' test within each gene, vegas  <cit> , which builds on the multivariate normal distribution and takes into account pairwise ld values, and the snp-set analysis  <cit> . incorporation of these methods into a gene set analysis of gwas data can reduce potential biases at the gene level and improve the robustness of follow up analyses.

in this work, we proposed a restricted search strategy to implement our previously developed dense module search  method  <cit> . this new strategy could greatly reduce the computational intensity problem. we demonstrated this method in a gwas dataset for schizophrenia and explored three different ways to define gene-wise p values. our results showed that the way to define gene-wise p values could affect the network-based analysis substantially, and it also concluded that caution is needed when designing and interpreting the results.

materials and methods
gwas dataset
we used the gwas dataset for schizophrenia from the clinical antipsychotic trial of intervention effectiveness  project  <cit> . the catie project is a multiphase randomized controlled trial initially designed to investigate and improve the use of antipsychotic medications in treating schizophrenia patients. we included the samples involving  <dig> schizophrenia patients and  <dig> controls, which were genotyped by perlegen sciences using the affymetrix 500k and perlegen's custom 164k chip, resulting in ~ <dig> k genotyped snps. a detailed description of the samples can be found in reference  <cit> . we accessed this dataset  from http://www.nimhgenetics.org/ through nimh approval. only the caucasian samples were used. we followed the pipeline of quality control, including the selection of samples and markers, as described in references  <cit> .

gene-wise p value
to compute gene-wise p values, given multiple snps mapped to each gene, an ideal algorithm should account for potential confounding factors, such as gene length, snp density, and ld structures. we incorporated the software tool vegas  <cit>  to compute the gene-wise p values. vegas combines the information of multiple snps by making use of simulations from the multivariate normal distribution while explicitly accounting for the ld between markers. we followed the default settings in vegas; this default setting maps snps to genes with  <dig> kb extension of gene boundaries. the hapmap ceu samples  were selected to estimate the ld structure in our work, as we only included the caucasian samples in the catie data.

we explored three options in vegas to compute gene-wise p values based on sets of snps:  using all the snps mapped to a gene ;  using the top 10% snps based on snp-level p values ; and  using the most significant snp, i.e., the snp with the smallest p value . note that the minp option is the same as the smallest p value strategy widely used in many post-gwas analysis methods. we included it here to compare with the other, more advanced approaches based on combining of multiple snps.

ppi dataset
our background ppi network data were collected from six public ppi databases: mint, intact, dip, biogrid, hprd, and mips/mpact. we downloaded these data from the protein interaction network analysis  platform   <cit> . to ensure the reliability of the ppi data, we explicitly included only interactions that have experimental evidence and involve both interactors from human genes. self-interaction and duplicates were removed. the final network included a total of  <dig>  nodes and  <dig>  interactions.

module search algorithm
we first overlaid the gwas data onto the whole human ppi network by assigning each node a z-score: z=Φ- <dig>  where Φ- <dig> is the inverse normal cumulative density function and p is the gene-wise p value from any one of the three methods. for a module with k genes, a module score was computed according to the stouffer's z-score method:zm= ∑i=1kzi/k. the detailed module construction process can be found in our previous work  <cit> . briefly, for a given "seed node", a "best module" with the maximum module score will be returned in the context of the working parameters, i.e., d= <dig> and r> <dig> . here, d is distance for the nodes to be included to the seed node and r is the network score increment cutoff value.

the overall network weighted by the gwas data serves as the working background. the restricted search strategy we proposed in this study is implemented as follows. first, we ranked all the nodes in the network according to their weights zi and started with the node that had the highest score as the seed to perform a module search. once the module was generated, all the nodes present in this module, including the seed node itself, were then removed from the network, and the rest of the network constituted the new background network. a new module search round was started again, with the highest scored node in the new background network each time, until none of the nodes in the background network could generate a module with ≥ <dig> nodes . this restricted strategy takes into account every single node in the background network but does not require using each of them as a seed node, which has been implemented in our previous work. thus, this tactic could greatly reduce the computational duty and also avoid the heavy redundancy of resultant modules using our original algorithm.

significance test
to estimate the significance of the resultant modules, we calculated p values based on the module scores . we adopted the method proposed in  <cit>  to empirically estimate the null distribution, which is assumed to be a normal distribution. specifically, we used the median-centered module score to estimate the location parameters δ and σ for the empirical null distribution using the r package locfdr and computed standardized module scores by zs = /σ, where zm' is the median-centered module score. the final module p values were obtained using the standard calculation, p = 1-Φ, where Φ is the normal cumulative density function. the module p values were then used for significance test of the resultant modules and help module selection.

evaluation by aligator
we utilized the software tool aligator  <cit>  to evaluate the module gene sets. the algorithm of aligator is initially designed to prioritize gene ontology  categories using summary gwas data at the snp level. building on a resampling strategy, aligator first pools all the snps and their p values from the gwas data and builds the snp collection. in each resample, the algorithm randomly selects snps from the collection and records the number of significant genes defined by the selected snps. here, significant genes were defined as those with at least one snp that has a p value less than a pre-defined cutoff value, e.g.,  <dig> . the random selection process keeps running until the significant genes targeted by the selected snps reaches the number of the significant genes in the real case. after the resampling snp set is constructed, each of the go categories are compared with the resample data to obtain the number of significant genes. this resampling process is repeated numerous times , resulting in the null distribution of the number of significant genes in each go category. finally, an empirical p value can be computed for each go category by comparing the significant genes in the category in the real case versus those in the resample sets.

in our application, instead of using go categories, we constructed new gene sets based on the module genes. the module genes identified by each input dataset were pooled as one gene set, and  <dig> module gene sets were generated, corresponding to the input dataset of vegas-all, vegas-top, and minp. as a comparison, we also included the kegg pathways   <cit> . we restricted the kegg pathway size  to ≥ <dig> and ≤ <dig>  in total, there were  <dig> kegg pathways plus  <dig> module gene sets collected for the aligator analysis. we followed the aligator default definition of significant genes, i.e., genes with at least one snp having p 
< <dig> , and we performed the resampling  <dig>  times. multiple testing correction by the benjamini & hochberg  method  <cit>  was then conducted.

comparison with dapple
we compared with another available network based gsa method, "disease association protein-protein link evaluator "  <cit> . we applied dapple to the catie dataset. dapple aims to evaluate whether genes in association loci are significantly connected by ppi, where the association loci are typically defined by the standard single marker analysis of a gwas dataset for a complex disease/trait. using the genes located in these association loci, dapple searches for two types of subnetworks: a direct network, in which the input genes are directly connected, and an indirect network, in which the input genes are connected through a common interactor  <cit> . both networks are then evaluated by a permutation test to assess their significance. because the construction process of the resultant subnetworks starts with the input association genes/loci, the method relies heavily on the input genes and can generate different subnetworks if the input gene/locus list is changed. however, the ways to define associated genes have not been standardized yet, although all adopt a pre-defined hard cutoff. for example, the widely applied method employs the cutoff of  <dig> × 10- <dig>  which is challenging in psychiatric diseases, because the association signals are typically weak in psychiatric gwas datasets. alternatively, a user-defined cutoff value, which can be less strict yet arbitrary, could be considered.

functional evaluation
we performed pathway enrichment test of the three module gene sets using the canonical kegg pathways. the hypergeometric test was implemented with the genes in the network used as the gene universe and module genes used as the genes of interest. multiple testing correction was performed using the bonferroni method.

RESULTS
exploration of gene-wise p values
using vegas, three sets of gene-wise p values were generated, each of which used the full set of snps, the top 10% of snps, and the most significant snp among all the snps mapped to a gene. figure  <dig> shows the q-q plot of each of these p value sets as well as the distribution of gene-wise p values versus gene length. the q-q plot of the vegas-all set showed a trend most closely located as would be expected in random cases. furthermore, this set did not display any strong correlation with gene length , indicating that the vegas-all set does not have strong confounding factors. on the other hand, the minp method generates the most inflated distribution, and the gene-wise p values showed a strong correlation with gene length, i.e., higher proportion of significant genes were observed with larger gene length . the behavior of the vegas-top set falls between those of the other two methods: neither the q-q plot nor the correlation with gene length showed strong inflation.

dense module search for schizophrenia
for each of the three gene-wise p value sets, we applied the restricted search strategy of dms to construct candidate modules significantly enriched for schizophrenia. the restricted strategy greatly reduced the space for available seed nodes; thus, the executing time for a complete search round is much shorter than the full search strategy. in each set, we obtained the number of modules, the number of significant modules, and the number of module genes in the significant modules .

to explore the results, we first compared the module genes in each data set using the weighted dms method. as shown in figure  <dig>  the overlapped genes varied greatly among the three data sets, indicating that the gene-wise p value definition approach influenced the resultant subnetworks substantially. when using the vegas-all method, the smallest number of module genes were generated, as well as the number of significant modules, compared to the other methods, while the minp method generated the largest number of significant modules and module genes. however, the minp method is prone to potential biases, such as gene length, snp density and ld structure. thus, the results in this minp set might be inflated by these biases.

validation by aligator
for each of the three resultant sets, we validated them using aligator, along with the canonical kegg pathways. as shown in table  <dig>  the three resultant module gene sets, each of which contains module genes identified using the vegas-all, vegas-top, and minp gene-wise p values as node weights, showed the most significant p values, especially when compared to kegg pathways. this indicates that all three gene sets were significantly enriched with association signals for schizophrenia, regardless of the methods to define gene-wise p values. interestingly, the significant pathways from kegg include several immune-related pathways, such as asthma , cytokine-cytokine receptor interaction , and intestinal immune network for iga production . these findings confirm the previous knowledge that schizophrenia is a complex disease involving immune systems  <cit> .

$p values were adjusted by benjamini & hochberg  method  <cit> .

exploration of module genes
at the gene level, module genes showed extreme convergence of significant genes compared to the background genes in the network. defining significant genes as those whose gene-wise p values were less than  <dig> , we computed the proportion of significant genes in the module gene set and the background set for each of the three input datasets. as shown in figure  <dig>  the module gene sets had a high proportion of significant genes in all three scenarios, with the vegas-all dataset showing the largest difference. note that the minp dataset of gene-wise p values is possibly inflated , and consistently, the minp weighted background network has a higher proportion of significant genes compared to the other two scenarios. in such a context, the high proportion observed in minp module genes  should be interpreted with caution.

we observed several well-studied candidate genes for schizophrenia in each of the three resultant module gene lists, such as akt <dig>  dtnbp <dig>  esr <dig>  flnb, grin <dig>  il <dig>  nos1ap, ywhaz, and others. when compared to the genes previously studied for associations with schizophrenia as those deposited in the szgene database  <cit> , a total of  <dig> module genes were found to have positive association results . further examination of these genes showed that only a few of them were simultaneously identified by all three gene-wise p value definition methods, while many genes were uniquely identified in only one of the three scenarios . the diversity of the module genes suggests that each of these approaches to define gene-wise p values may have its own advantages in prioritizing candidate genes for the disease, yet the methods also differ greatly in the resultant gene sets.

$a: vegas-all; t: vegas-top; m: minp.

comparison with the existing method 
dapple requires a user-defined list of loci from the gwas dataset. in our case, the catie gwas dataset did not report any marker with significant p values at  <dig> × 10- <dig>  <cit> , and no genes could be used for the dapple method at this conventional definition. therefore, we manually selected the top  <dig> genes in each of the three gene-wise data sets, regardless of cutoff values for significance. table  <dig> summarized the results using dapple analysis. in the scenario of vegas-all top genes, a total of  <dig> direct interactions involving  <dig> genes were identified. six genes were prioritized that achieved a corrected p value < <dig> , all of which belong to the group of  <dig> input genes. in contrast,  <dig> of the  <dig> input genes were included in our module gene list. in the scenario of vegas-top genes, only one direct interaction and two prioritized genes were reported. meanwhile,  <dig> of the  <dig> genes were found in the module gene list. finally, in the scenario of minp genes, three direct interactions and three prioritized genes were reported, while  <dig> of the  <dig> genes were found in our module gene list. these results indicated that our dms methods could effectively recruit significant genes as compared to dapple.

functional enrichment test of the module genes
our functional enrichment test of the module gene sets showed that the neurotrophin signaling pathway  was significantly enriched in all three gene sets . the neurotrophin pathway functions in the differentiation and survival of neural cells, playing significant roles in neural development. a total of  <dig>   <dig>  and  <dig> module genes from the three module gene sets, vegas-all, vegas-top and minp, respectively, were presented in this pathway. however, the diversity at the gene level was high: only  <dig> genes were overlapped among all three module gene sets in this pathway, further supporting the rationality of functional analysis at the gene set level. interestingly, in the minp module gene set, there were also two immune-related pathways significantly enriched: the t cell receptor signaling pathway  and the antigen processing and presentation pathway .

discussion
by taking advantage of our previously developed dense module search method, we proposed an alternative search strategy in this work and demonstrated it in the catie gwas dataset, one of the major available gwas datasets for schizophrenia. additionally, we explored the different options to define gene-wise p values, including the vegas-all method, which built on all the snps mapped to a gene, the vegas-top method, which used the top 10% snps mapped to a gene, and the minp method, which used the most significant snp. by applying our restricted search strategy in each of the three data sets, we showed that the vegas-all method generated the smallest number of module genes and was least affected by other potentially confounding effects such as gene length. the other two methods resulted in similar numbers of module genes. these results call for caution when selecting different methods to compute gene-wise p values, which may have significant influences on the resultant module genes prioritized for the disease.

the restricted search strategy is intended to reduce the overlap among modules. assuming that a local environment of the background network includes  <dig> nodes, namely a, b, c, d, and e. starting from node a, a module including a, b, c, and d would be generated at zm+1>zm × . starting from b, a module including b, c, d, and e would be generated. in our previous strategy to apply dms, both modules would be reported, even though they had 75% overlapping genes. in the current strategy, to resolve the issue of overlap, we starts with the node that has the highest weight, e.g., a, to search for the module. and then we would remove the module genes from the background network after it is done, e.g., the nodes a, b, c, and d would be removed from the network and, thus, from further analysis. in this way, the module starting from b would not be reported, as most nodes in it have already been removed from consideration. this ensures that each node in the network could be analyzed once and will be involved in only one module. both methods have their own advantages. the traditional one performs a comprehensive search and allows every node in the network to have the chance of being a seed. the computational intensity is high and redundancy among modules is strong. furthermore, the correlation among modules posts challenges for the follow up statistical tests when selecting modules. in contrast, the restricted strategy is computationally efficient by gradually shrinking the background network, and it ensures against physical overlap among modules. however, it may miss moderately significant genes that cannot be included in any module. in practice, either of the two strategies can be selected depending on the specific aims and project design.

computation of gene-wise p values is one of the key steps in most post-gwas analyses. there have been several methods and tools published to compute gene-wise p values. the most widely applied method in the field is to select the snp with the smallest p value among all snps mapped to a gene, although this method is subjected to several known biases, such as gene length, snp density, and the local ld structure. we selected vegas because of its advantages, such as acceptable computation time  and no need of genotyping data. the rationale of including two formulations in vegas is that using all snps mapped to a gene  is comprehensive but considering all snps potentially dilute the signals, while using part of the snps  may miss some informative snps but captures the most significant 10% snps for the computation.

however, vegas computes snp-snp matrix based on pairwise ld values and could only deal with autosomal snps. snps located on the sex chromosomes  are not applicable for vegas and were removed from our network based analysis. although these genes accounted for only a small proportion  in the pina network we used, more comprehensive algorithms that are able to handle all genes in the genome is needed for future work.

the module genes we identified, in any scenario, recruited neuro-related and/or immune-related genes and pathways. all three sets of module genes include well-studied candidate genes for schizophrenia , glutamate receptors , several genes located in the mhc region , and genes from the 14-3- <dig> protein family . interestingly, all three module gene sets contain several genes in the mhc region, even though none of these genes passed the significance test for single markers at  <dig> × 10- <dig>  the mhc region has been shown to harbor significant association signals in a combinatory analysis of three gwas datasets for schizophrenia  <cit> . the identification of these genes by our dms method further confirmed this signal. it also proved that network based analysis could reveal markers that, although they individually failed the single marker test, their joint affects on the disease might be significant.

CONCLUSIONS
we proposed an efficient network-assisted framework to identify candidate genes from gwas data based on dense module search algorithm. augmented by functional annotation as well as a priori knowledge about schizophrenia, we explored the methods to compute gene-wise p values based on multiple snps mapped to a gene and assessed their effects on downstream analysis. in specific applications, caution is needed when selecting different search strategies and methods for gene-wise p values. future work to compute gene-wise statistics for all genes in the genome will further improve such applications.

competing interests
the authors declare that they have no competing interests.

authors' contributions
pj and zz conceived and designed the experiments. pj carried out the data analysis. pj and zz drafted the manuscript. all authors read and approved the final manuscript.

