BACKGROUND
molecular microbial ecology has become an important discipline in natural and medical sciences. research on the structure, dynamics and evolution of microbial communities in environmental, human, and engineered systems provides substantial scientific knowledge for understanding the underlying microbial processes, for predicting their behavior, and for controlling, favoring, or suppressing target populations  <cit> .

different analytical methods have been successively developed for the assessment of microbial communities via profiling or metagenomic approaches  <cit> . terminal-restriction fragment length polymorphism  analysis has been widely used over the last decade for culture-independent assessment of complex microbial community structures  <cit> . standardized, robust, and highly reproducible t-rflp has become the method of choice for community fingerprinting since its automation in capillary electrophoresis devices has enabled the simultaneous analysis of numerous samples at relatively low cost  <cit> . cloning and sequencing methods have been optimized in parallel for taxonomic affiliation of terminal-restriction fragments   <cit> . this approach however remains time-consuming and often leads to only partial characterization of the apparent microbial diversity  <cit> . on the other hand, next-generation sequencing  technologies have recently been applied for comprehensive high-throughput analyses of microbiomes with reduced sequencing costs  <cit>  and high reproducibility  <cit> . metagenomics projects have however generated novel requirements in resource and expertise for generating, processing, and interpreting large datasets  <cit> . overall, ′omics′ technologies challenge the field of bioinformatics to design tailored computing solutions for enhanced production of scientific knowledge from massive datasets. while ngs techniques tend to progressively replace the traditional combination of t-rflp and cloning-sequencing, recent studies have demonstrated the benefits of using both techniques to complement each other  <cit> . the combination of routine t-rflp and ngs strategies could offer an efficient trade-off between laboratory efforts required for the in-depth analysis of bacterial communities and the financial and infrastructural costs related to datasets processing.

if t-rflp and ngs are meant to be used concomitantly for the investigation of microbial systems, one key objective is to link t-rfs to phylotypes. in parallel to early developments of t-rflp methods, several computational procedures have been proposed to predict t-rf sizes and to phylogenetically affiliate t-rfs. for instance, tap t-rflp  <cit> , trifle  <cit>  and t-rfpred  <cit>  have been developed to perform in silico digestion of datasets of 16s rrna gene sequences, originating mostly from clone libraries or reference public databases. repk  <cit>  has been designed to screen for single and combinations of restriction enzymes for the optimization of t-rflp profiles, and to design experimental strategies. all these programs do not involve comparison of in silico profiles with experimental data.

in the current study, we propose a novel bioinformatics methodology, called pyrotrf-id, to assign phylogenetic affiliations to experimental t-rfs by coupling pyrosequencing and t-rflp datasets obtained from the same biological samples. a recent study showing that natural bacterial community structures analyzed with both techniques were very similar  <cit>  strengthened the here adopted conceptual approach. the methodological objectives were to generate digital t-rflp  profiles from full pyrosequencing datasets, to cross-correlate them to the experimental t-rflp  profiles, and to affiliate et-rfs to closest bacterial relatives, in a fully automated procedure. the effects of different processing algorithms are discussed. an additional functionality was developed to assess the impact of restriction enzymes on resolution and representativeness of t-rflp profiles. validation was conducted with high- and low-complexity bacterial communities. this dual methodology was meant to process single dna extracts in t-rflp and pyrosequencing with similar pcr conditions, and therefore aimed to preserve the original microbial complexity of the investigated samples.

methods
samples
two different biological systems were used for analytical procedure validation. the first set comprised ten groundwater  samples from two different chloroethene-contaminated aquifers that have been previously described by aeppli et al.  <cit>  and shani  <cit> . the second set consisted of five aerobic granular sludge  biofilm samples from anaerobic-aerobic sequencing batch reactors operated for full biological nutrient removal from an acetate-based synthetic wastewater. the ags system has been described previously  <cit>  and displayed a lower bacterial community complexity  than the grw samples .

dna extraction
grw samples were filtered through  <dig> -μm autoclaved polycarbonate membranes  with a mobile filtration system . dna was extracted using the powersoil™ dna extraction kit  following the manufacturer instructions, except that the samples were processed in a bead-beater  at  <dig>  m·s- <dig> for  <dig> s after the addition of solution c <dig> 

dna from ags samples was extracted with the automated maxwell  <dig> tissue dna purification system  according to manufacturer′s instructions with following modifications. an aliquot of  <dig> mg of ground granular sludge was preliminarily digested during  <dig> h at 37°c in  <dig> μl of a solution composed of  <dig> mg·ml- <dig> lysozyme in te buffer . the dna extracts were resuspended in  <dig> μl of te buffer.

all extracted dna samples were quantified with the nd- <dig> nanodrop® spectrophotometer  and stored at −20°c until analysis.

experimental t-rflp
the et-rflp analysis of the grw series was done according to rossi et al.  <cit>  with following modifications:   <dig> μl pcr reactions contained  <dig> μl 10× y buffer,  <dig>  μl  <dig> mm dntps,  <dig>  μl of each primer at  <dig> μm,  <dig> μl 5× enhancer p solution,  <dig>  u peqgold taq polymerase , and  <dig>  ng·μl- <dig> template dna , completed with autoclaved and uv-treated milli-q water ;  for each dna extract, pcr amplification was carried out in triplicate. samples from the ags series were analyzed by et-rflp according to ebrahimi et al.  <cit>  with following modifications:  go taq polymerase  was used for pcr amplification;  forward primer was fam-labeled;  the pcr program was modified to increase the initial denaturation to  <dig> min, the cycle denaturation step to  <dig> min, and  <dig> cycles of amplification. all pcrs were carried out using the labeled forward primer 8f  and the reverse primer 518r . for details, refer to weissbrodt et al.  <cit> .

the resulting et-rflp profiles were generated between  <dig> and  <dig> bp as described in  <cit> . the et-rflp profiles were aligned using the treeflap crosstab macro  <cit>  and expressed as relative contributions of operational taxonomic units . for grw samples which exhibited numerous low abundant otus, the final bacterial community datasets were constructed as follows: multivariate ruzicka dissimilarities were computed between replicates of et-rflp profiles with r  <cit>  and the additional package vegan  <cit> ; the profile at the centroid  was selected for each sample to build the final community profiles. for ags samples which were characterized by less complex communities, triplicates were periodically measured and resulted in a mean relative standard coefficient of 6% over the analytical method.

cloning and sequencing
clone libraries were constructed with the 16s rrna gene pool amplified from dna samples using the same pcr procedures as described in the et-rflp method but with an unlabeled 8f primer. the pcr products were purified with the purification kit montage® pcr centrifugal filter devices , ligated into pgem®-t easy vector  and transformed into e. coli xl1-blue competent cells . the et-rflp procedure was then applied on isolated colonies in order to screen for the dominant et-rfs obtained previously by et-rflp on the entire 16s rrna gene pool. then the 16s rrna gene was amplified from selected colonies using pcr with primers t <dig> and sp <dig>  and purified as described above. a sequencing reaction was carried out on each purified pcr product as described in  <cit> . sequences were aligned in bioedit  <cit> , and primer sequences were removed. sequences were analyzed for chimeras using bellerophon  <cit> , and dt-rfs of selected clones were produced by in silico digestion using trifle  <cit>  for comparison with et-rfs.

pyrosequencing
a total of  <dig> biological samples were analyzed using bacterial tag encoded flx amplicon pyrosequencing analysis. a first set of dna extracts from grw and ags samples were sent for sequencing to research and testing laboratory llc . the samples underwent partial amplification of the v1-v <dig> region of the 16s rrna gene by pcr with unlabeled 8f and 518r primers, secondary pcr with tagged fusion primers for flx amplicon sequencing, emulsion-based clonal amplification , and gs flx sequencing targeting at least 3′ <dig> reads with the  <dig> gs-flx titanium genome sequencing system technology . the whole sample preparation protocol has been made available by the company in the publication of sun et al.  <cit> . this series refers, in the present study, to the low reads amount pyrosequencing procedure . the dna extract of one ags sample was analyzed in triplicate through the whole analytical method from pyrosequencing  to pyrotrf-id analysis.

a second set of amplicons from different grw samples was analyzed by gatc biotech ag  following an analog procedure but targeting at least 10′ <dig> reads . the a- and b-adapters for sequencing with the roche technology were ligated to the ends of the dna fragments. the samples were run on a 2% agarose gel with tae buffer and the band in a size range of 700– <dig> bp, 450– <dig> bp, or 100– <dig> bp, respectively, was excised and column purified. after concentration measurement the differently tagged libraries were pooled. the three resulting library pools were immobilized onto dna capture beads and the amplicon-beads obtained were amplified through empcr according to the manufacturer′s recommendations. following amplification, the emulsion was chemically broken and the beads carrying the amplified dna library were recovered and washed by filtration. each pool was sequenced on a quarter gs flx pico-titer plate device with gs flx titanium xlr <dig> chemistry on a gs flx+ instrument. the gs flx system software version  <dig>  was used and the gs flx produced the sequence data as standard flowgram format  file containing flowgrams for each read with basecalls and per-base quality scores.

development of the pyrotrf-id bioinformatics methodology
the pyrotrf-id bioinformatics methodology for identification of t-rfs from pyrosequencing datasets was coded in python for compatibility with the biolinux open software strategy  <cit> . pyrotrf-id runs were run on the vital-it high performance computing center  of the swiss institute of bioinformatics . all documentation needed for implementing the methodology is available at http://bbcf.epfl.ch/pyrotrf-id/. the flowchart description of pyrotrf-id is depicted in figure  <dig>  and computational parameters are described hereafter.

input files
input  <dig> tag-encoded pyrosequencing datasets were used either in raw standard flowgram , or as pre-denoised fasta format  as presented below. input et-rflp datasets were provided in coma-separated-values format .

denoising
sequence denoising was integrated in the pyrotrf-id workflow but this feature can be disabled by the user. it requires the independent installation of the qiime software  <cit>  to decompose and denoise the .sff files containing the whole pyrosequencing information into .sff.txt, .fasta and .qual files. briefly, the script split_libraries.py was used first to remove tags and primers. sequences were then filtered based on two criteria:  a sequence length ranging from the minimum  and maximum 500-bp amplicon length, and  a phred sequencing quality score above  <dig> according to ewing and green  <cit> . denoising for the removal of classical  <dig> pyrosequencing flowgram errors such as homopolymers  <cit>  was carried out with the script denoise_wrapper.py. denoised sequences were processed using the script inflate_denoiser_output.py in order to generate clusters of sequences with at least 97% identity as conventionally used in the microbial ecology community  <cit> . based on computation of statistical distance matrices, one representative sequence  was selected for each cluster. with this procedure, a new file was created containing cluster centroids inflated according to the original cluster sizes as well as non-clustering sequences . the denoising step on the hpcc typically lasted approximately  <dig> h and  <dig> h for highra and lowra datasets, respectively.

mapping
mapping of sequences was performed using the burrows-wheeler aligner′s smith-waterman  alignment algorithm  <cit>  against the greengenes database  <cit> . the sw score was used as mapping quality criterion  <cit> . it can be set by the user according to research needs. sequences with sw scores below  <dig> were removed from the pipeline. sw cutoffs have typically been used in a range between  <dig> and  <dig>  <cit> . this score can be adapted to reduce the probability of mismatches. sw scores normalized by sequence length were computed to allow comparison between sequences of various lengths. two files were generated consecutive to mapping. the first one provided general mapping statistics for each sample. the second one provided the list of unmapped sequences, which were removed from the pyrotrf-id pipeline.

generation of dt-rflp profiles
sequences that passed through all previous steps of the procedure were digested in silico using the restriction enzyme haeiii which was selected from the bio.restriction biopython database. the dt-rflp profiles were generated for each sample considering both the size of the dt-rfs and their relative abundance in the sample. sequences containing no restriction site were discarded. a raw dt-rflp profile plot was generated as output file. different restriction enzymes can be tested in the pyrotrf-id workflow for the optimization of dt-rflp profiles. this is particularly convenient for designing new et-rflp approaches. such screening can be performed on the pyrosequencing datasets without requirements of et-rflp data as input file.

comparison of et-rflp and dt-rflp profiles
in order to allow comparison with et-rflp profiles, t-rfs below  <dig> bp were removed, and a second set of dt-rflp profiles was generated. to overcome any possible discrepancy between experimental and in silico t-rflp  <cit> , pyrotrf-id evaluated the most probable drift between e- and dt-rflp profiles by computing the cross-correlation of the two. a plot showing the results of the cross-correlation was generated in order to help the user assessing the optimal shift to apply for aligning both profiles. by default, pyrotrf-id corrected the dt-rflp profile based on the drift with the highest cross-correlation. however, the user can optionally define a specific shift to apply. after shifting the dt-rflp data, a mirror plot was generated allowing visual comparison of the dt-rflp and et-rflp profiles.

assignment of affiliation to dt-rfs
peak annotation files were generated in comma-separated-values format , listing all digitally obtained t-rfs within each dt-rflp profile, together with their original and shifted lengths. closest phylogenetic affiliations were provided together with the number of reads and their relative contribution to the t-rf, as well as with the absolute and normalized sw mapping scores, and the genbank code of each reference sequence. when et-rflp data were not provided in the workflow, the peak annotation file was directly obtained after dt-rflp processing without removing dt-rfs below  <dig> bp and without indication of t-rf shift.

optimization and testing of pyrotrf-id
the initial testing and validation steps were carried out with the  <dig> pyrosequencing datasets originating from the two environments. the impact of the data processing steps of the pyrotrf-id pipeline was assessed using two samples . three different combinations of algorithms were tested for the processing of sequences , and their respective impact on the final dt-rflp profiles was compared by calculating richness and shannon′s h′ diversity indices. the aim was to optimize the cross-correlation between dt-rflp and the corresponding et-rflp profiles. the optimal standardized pyrotrf-id procedure was selected based on this assessment.

a phred score = − <dig> log perror with perror = 10-phred/ <dig> as the probability that a base was called incorrectly. for all trials, the raw pyrosequencing datasets were systematically filtered according to the phred quality score. only sequences with a related phred score above  <dig> were conserved. this corresponds to a perror of 1/ <dig> 

b a sw mapping score of  <dig> was set as cutoff. in the case when sequences were preliminarily denoised, it was nevertheless observed that no denoised sequence was rejected at the mapping stage. processing without filtering by the sw mapping score was done by setting a cutoff of  <dig> 

c the processed sequences were digested in silico with the restriction enzyme.

d the first combination with denoising was defined as the standard pyrotrf-id procedure.

e in the second combination, only a filtering method at the mapping stage was considered.

f in the third combination, raw datasets of sequences obtained after phred-filtering of the pyrosequencing datasets were digested without post-processing.

the optimal procedure was then applied for the comparison of pyrotrf-id results obtained from groundwater and wastewater environments. finally, restriction enzymes commonly used in t-rflp analyses of bacterial communities  were selected for comparison of profiling resolutions. visual observation, richness and diversity indices, as well as density plots were used to analyze the distributions of t-rfs along the e- and dt-rflp profiles.

RESULTS
pyrosequencing quality control and read length limitation
the principal quality outputs given by pyrotrf-id are presented in additional file  <dig> for the low throughput  and high throughput  pyrosequencing methods used in this study. on average, 6′ <dig> and 32′ <dig> reads were obtained for each method, respectively.

filtering based on the phred quality criterion allowed discarding low quality sequences. most of the remaining sequences had a length below 400– <dig> bp . for the lowra and highra methods, the median number of reads  was related to a phred score of  <dig> and  <dig>  respectively, and more than 99% of reads were related to a phred score above  <dig> . only reads longer than  <dig> bp were conserved for subsequent in silico digestion, because including short sequences in the dt-rflp profiles may have altered the relative proportions of t-rfs to et-rflp profiles. pyrosequencing datasets obtained with the highra method were predominantly composed of short reads below  <dig> bp . however, 7′ <dig> reads  of high quality sequences were still available for pyrotrf-id analysis, which was even larger than the number of high quality sequences remaining with the lowra method .

effect of denoising and mapping procedures
denoising of pyrosequencing datasets was performed in order to correct for classical  <dig> analytical errors including the above-mentioned cut-off values: a minimum phred quality score of  <dig>  as well as minimum and maximum sequence lengths of  <dig> and  <dig> bp, respectively. the denoising process generated a subset of representative sequences harboring at least 3% dissimilarity to each other. this amounted to 17±1% and 43±9% of the number of reads present in the raw datasets obtained with the highra and lowra methods, respectively.

after denoising, the mapping process was the time-limiting step in the pyrotrf-id pipeline. twenty minutes were required for mapping the largest datasets against the greengenes database. discarding sequences shorter than  <dig> bp did not lead to a reduced number of detected bacterial phylotypes . bacterial community compositions obtained both without and with minimum sequence length cut-off exhibited high correspondences with determination coefficients of r <dig> between  <dig>  and  <dig>  depending on the sample type and the reference database used for mapping . within the sets of identified phlyotypes, sequences affiliated to geobacter sp. displayed the highest difference in relative abundance , resulting from a high proportion of short reads below  <dig> bp in the dataset grw <dig> 

after phred-filtering, the remaining raw sequences had maximum lengths of  <dig> bp and therefore the maximal sw mapping scores amounted to around  <dig>  the distributions of the absolute and normalized sw scores are provided in additional file  <dig>  and are compared to the distribution of the sequence identity score, usually used for phylogenetic affiliation of sequences. these two scoring methods are conceptually different, since nucleotide positions and gaps are taken into account in the computation of sw scores. the median absolute and normalized sw scores amounted to  <dig> and  <dig> , respectively. the relative number of bacterial affiliations obtained with normalized sw scores higher than  <dig>  and  <dig>  amounted to 89% and 37%, respectively. a total of 81% of the affiliations up to the genus level were related to a sequence identity score of 100%, and 91% with an identity score above 97%. the normalized sw scores obtained for the predominant affiliations presented in tables  <dig> and  <dig> were comprised between  <dig>  and  <dig> , and are most likely related to sequence identity scores above 97%.

a experimental  and digital t-rfs .

b digital t-rf obtained after having shifted the digital dataset with the most probable average cross-correlation lag.

c number of reads of the target phylotype that contribute to the t-rf.

d diverse bacterial affiliates can contribute to the same t-rf.

e phylogenetic affiliation of the t-rf . only the last identified phylogenetic branch is presented here.

f reference operational taxonomic unit  from the greengenes public database related with the best sw mapping score. in the greengenes taxonomy, otu refer to terminal levels at which sequences are classified.

g genbank accession numbers provided by greengenes for reference sequences.

h best sw mapping score obtained. sw scores consider nucleotide positions and gaps. the highest sw mapping score that can be obtained for a read is the length of the read itself.

i sw mapping score normalized by the read length, as an estimation of the percentage of identity.

j after having observed the presence of the dt-rf  <dig> bp, we returned to the raw et-rflp data and found an important et-rf at  <dig> bp. however, rossi et al.  <cit>  considered that t-rfs below  <dig> bp are inconsistent and lacks of precision in sizing. this peak was therefore initially not taken into account in the original et-rflp profiles.

a digital t-rf obtained after having shifted the digital dataset with the most probable average cross-correlation lag.

b number of reads of the target phylotype that contribute to the t-rf.

c diverse bacterial affiliates can contribute to the same t-rf.

d reference otu from the greengenes public database obtained after mapping.

e genbank accession numbers provided by greengenes for reference sequences.

f best sw mapping score obtained.

g sw mapping score normalized by the read length.

generation of digital t-rflp profiles
the dt-rflp profiles were successfully generated with the standard pyrotrf-id procedure  from denoised bacterial pyrosequencing datasets of the grw and the ags sample series . with haeiii, 165± <dig> and 87± <dig> t-rfs were present in the dt-rflp profiles of the grw and ags series, respectively. for all samples, only a reduced number of dt-rfs above  <dig> bp were obtained because of the low pyrosequencing quality at sequence lengths between  <dig> and  <dig> bp.

an additional feature of pyrotrf-id is the generation of dt-rflp profiles with any restriction enzyme. here profiles were obtained with five additional restriction enzymes and compared. profiles of grw samples were on average  <dig>  times richer than ones of ags samples, and each restriction enzyme generated characteristic dt-rflp features regardless of the sample complexity . haeiii provided dt-rflp profiles with the highest richness. the use of this enzyme resulted in the generation of dt-rfs stacked mainly between  <dig> and  <dig> bp. highest diversities in dt-rflp profiles were obtained with mspi and rsai, respectively. digestion with mspi resulted in the most homogeneous distributions of dt-rfs up to approximately  <dig> bp. with the exception of hhai, endonucleases did not produce numerous dt-rfs in the second half of the profiles, and cumulative curves flattened off. with hhai, the cumulative curves increased step-wise. rsai resulted in dt-rflp profiles displaying homogeneous distributions of dt-rfs for grw samples, but lower diversity than haeiii, alui, mspi, and hhai. taqi always provided profiles with the lowest richness and diversity.

comparison of digital and experimental t-rflp profiles
mirror plots generated by pyrotrf-id computed with raw and denoised pyrosequencing datasets obtained from a complex bacterial community  are presented in figure  <dig>  further examples of mirror plots are available in additional file  <dig>  digital profiles generated from raw pyrosequencing datasets displayed gaussian distributions around the most dominant dt-rfs of neighbor peaks  which exhibited identical bacterial affiliations . this feature was attributed to errors of the  <dig> pyrosequencing analysis. denoised dt-rflp profiles displayed enhanced relative abundances of dominant peaks and had a higher cross-correlation with et-rflp profiles . by selecting representative sequences  for clusters containing reads sharing at least 97% identity, in the qiime denoising process, all neighbor peaks were integrated in the dominant dt-rfs resulting from the centroid sequences. cross-correlations between dt-rflp and et-rflp profiles issued from sample grw <dig> increased from  <dig>  to  <dig>  after denoising of the pyrosequencing data.

the dt-rflp profiles exhibited a drift of  <dig> to  <dig> bp compared to et-rflp profiles. from in silico restriction of a  <dig> clone library obtained in our laboratory using the trifle software  <cit> , we confirmed that in silico t-rfs were, on average, 4± <dig> bp  longer than the experimental ones . after correcting with an optimal shift , maximum cross-correlation coefficients between denoised dt-rflp and et-rflp profiles ranged from  <dig> ± <dig>  and  <dig> ± <dig>  for the grw samples  to  <dig> ± <dig>  for the ags samples  .

a shift leading to optimal matching of the digital to the experimental t-rflp profile.

b maximum cross-correlation coefficients obtained after matching of the digital to the experimental t-rflp profile.

c number and percentage of experimental t-rfs having corresponding digital t-rfs.

d samples grw01- <dig> were pyrosequenced with the highra method.

e samples grw07- <dig> and ags01- <dig> were pyrosequenced with the lowra method.

f samples ags <dig>  ags <dig>  and ags <dig> are triplicates from the same dna extract.

impact of sequence processing steps, pyrosequencing methods and sample types
indices of richness  and diversity  were used to evaluate the impacts of data processing steps, pyrosequencing methods and sample types on the structure of the final dt-rflp profiles . the changes of the indices were considered positive if they approached the indices determined for et-rflp profiles. the raw dt-rflp profiles were composed of  <dig> - to  <dig> -times more t-rfs than the et-rflp profiles. denoising resulted in a decrease of richness and diversity. the ratios of richness and diversity between standard dt-rflp and et-rflp profiles amounted to  <dig> ± <dig>  and  <dig> ± <dig> , respectively, for high-complexity samples , and to  <dig> ± <dig>  and  <dig> ± <dig> , respectively, for low-complexity samples . the raw dt-rflp profiles of the groundwater samples grw01-grw <dig>  which were sequenced with the highra method, were composed of  <dig> to  <dig> -times more t-rfs than their respective et-rflp profiles. groundwater samples grw07-grw <dig> sequenced with the lowra method displayed ratios of raw dt-rfs to et-rfs which were between  <dig>  and  <dig> . after denoising, both sets of groundwater-related dt-rflp profiles exhibited similar richness and diversity and were closer to indices of et-rflp profiles than raw dt-rflp profiles .

the dna extract of one ags sample was analyzed in triplicate from pyrosequencing to pyrotrf-id. the resulting standard dt-rflp profiles contained 94± <dig> t-rfs, and exhibited very close diversity indices of  <dig> ± <dig> . in comparison, denoised profiles of all ags samples collected over  <dig> days contained similar numbers of t-rfs  but exhibited quite different diversity indices of  <dig> ± <dig> . there was also very little variation in the cross-correlation coefficients  between the dt-rflp profiles and the corresponding et-rflp profile. all three denoised t-rflp profiles exhibited similar structures, and affiliations were the same for t-rfs that could be identified.

efficiency of phylogenetic affiliation of t-rfs
comprehensive phylogenetic information was provided by pyrotrf-id for each dt-rf, as exemplified in table  <dig>  depending on the sample type, between  <dig> and 60% of all dt-rfs were affiliated with a unique bacterial phylotype . the other dt-rfs were affiliated with two or more phylotypes, showing different contribution patterns. in such cases, a single phylotype was usually clearly predominating with a relative contribution ranging from  <dig> to 99%. however, for some t-rfs no clear dominant phylotype emerged .

some reference sequences were sometimes represented by several t-rfs . for instance, in ags <dig>  six dt-rfs  were affiliated to the same reference sequence of rhodocyclus tenuis , with shifted t-rf  <dig> being predominant . the dehalococcoides sp. affiliation in sample grw <dig> was related to eight t-rfs, with shifted t-rf  <dig> being predominant . to investigate this phenomenon, reads resulting in different dehalococcoides-affiliated t-rfs were retrieved from the pyrosequencing dataset and aligned with clustalx . this analysis showed that the multiple t-rf sizes observed were due to reads harboring insertions or deletions of nucleotides before the first haeiii restriction site or to nucleotide modifications within haeiii sites.

discussion
advantages and novelties of the pyrotrf-id bioinformatics methodology
this study describes the development of the pyrotrf-id bioinformatics methodology for the analysis of microbial community structures, and its application on low- and high-complexity environments. pyrotrf-id can be seen as the core of a high-throughput methodology for assessing microbial community structures and their dynamics combining ngs technologies and more traditional community fingerprinting techniques such as t-rflp. more than just predicting the most probable t-rf size of target phylotypes, pyrotrf-id allows the generation of dt-rflp profiles from 16s rrna gene pyrosequencing datasets and the identification of experimental t-rfs by comparing dt-rflp to et-rflp profiles constructed from the same dna samples.

at the initial stage of the assessment of a microbial community, pyrotrf-id can be used for the design of an et-rflp procedure adapted to a given microbial community through digital screening of restriction enzymes. in contrast to previous studies involving in silico restriction of artificial microbial communities compiled from selected reference sequences from public or cloning-sequencing databases  <cit> , pyrotrf-id works on sample-based pyrosequencing datasets. this requires the pyrosequencing of a limited number of initial samples. the number of t-rfs, the homogeneity in their distribution, and the number of phylotypes contributing to t-rfs should be used as criteria for the choice of the best suited enzyme. combination of pyrosequencing and et-rflp datasets obtained on the same initial set of samples enables the beginning of the study of new microbial systems with knowledge on t-rfs affiliation. the length of t-rfs and their sequences are directly representative of the investigated sample rather than inferred from existing databases. in this sense, the complexity of the original environment is accurately investigated. for all types of low- and high-complexity environments assessed in this study, haeiii, alui and mspi were good candidates for the generation of rich and diverse dt-rflp profiles.

subsequently, et-rflp can be used as a routine method to assess the dynamics of the stuctures of microbial communites, avoiding the need for systematic pyrosequencing analyses. we suggest that pyrosequencing should be applied at selected time intervals or on representative samples to ensure that the t-rfs still display the same phylogenetic composition. combining t-rflp and pyrosequencing is particularly adapted for the temporal follow-up of a microbial system, taking advantage of the relative low costs of t-rflp and its convenience for routine assessment of microbial community structures, and of the power of pyrosequencing for assessing the composition of these communities. pyrotrf-id has already been used for the study of bacterial communities involved in start-up of aerobic granular sludge systems  <cit>  and in natural attenuation of chloroethene-contaminated aquifers  <cit> .

performance assessment and limitations of pyrotrf-id
classical  <dig> pyrosequencing errors, such as, inaccurate resolving of homopolymers and single base insertions  <cit> , were expected to impact the quality of dt-rflp profiles by overestimating the number of dt-rfs present  <cit> . the use of a denoising procedure based on the analysis of rank-abundance distributions  <cit>  was a prerequisite to minimize pyrosequencing errors and to generate dt-rflp profiles approaching the structure of et-rflp profiles, as assessed by the improved cross-correlation coefficients. filtering pyrosequencing reads with the sw mapping score threshold only slightly reduced overestimations. in addition, this filtering approach does not specifically remove reads based on their intrinsic quality but rather on similarities with existing sequences from the database, hence reducing the complexity of the studied bacterial community to what is already known  <cit> . when denoising was applied, the use of a sw mapping score threshold did not improve the shape of dt-rflp profiles. whereas small-size reads were more abundant in the highra pyrosequencing datasets. the pyrosequencing method and the initial amount of reads did not impact the final pyrotrf-id output. only the level of complexity of the bacterial communities of the ecosystems could have explained the differences in richness among t-rflp profiles.

clipping the low-quality end parts of sequences is an option to improve sequence quality but it is quite improbable that it has an impact on the outcome of the taxon assignment and the creation of dt-rflp profile. when pyrotrf-id is run with the “--qiime” option, quality trimming is done using the protocol proposed in qiime  <cit>  and its online tutorial . this includes the amplicon noise procedure that is efficient in correcting for sequencing errors, pcr single base substitutions, and pcr chimeras  <cit> . even if some wrong base calls remain in the consensus sequences after this, they should not affect the assignment to taxon as the bwa aligner can account for mismatches. it should not influence the dt-rflp profile either since a mismatch outside of the enzyme cleavage site does not affect the length of the fragment produced. as the fragment length is determined by counting the number of base pairs before the enzyme cleavage site and that the bwa aligner does not necessarily use the whole sequence when selecting a match, clipping the low-quality ends of sequences would probably have no measurable effect.

discrepancies of 0– <dig> bp between the size of in silico predicted t-rfs and et-rfs have previously been reported  <cit> . in the present study, an average discrepancy of 4– <dig> bp was observed between dt-rflp and et-rflp profiles. this drift was confirmed by comparison of in silico and experimental digestion of  <dig> clones from a clone library. to overcome the bias induced by the experimental drift, we introduced the calculation of a cross-correlation between dt-rflp and et-rflp profiles. the entire dt-rflp profile was shifted by the number of base pairs enabling better fitting to the corresponding et-rflp profile. it is known that the drift is not constant across the t-rfs but rather depends on the true t-rf length, on its purine content, and on its secondary structure  <cit> . mirror plots sometimes displayed a 1-bp difference between et-rfs and dt-rfs. it was crucial for the user to visually inspect the mirror plots prior to semi-manually assigning phylotypes to et-rfs. the approach adopted here consisted of selecting et-rfs to identify prior to checking their alignment with dt-rfs. in order to overcome manual inspection, a shift could be computed for each single dt-rf in relation with its sequence composition and theoretical secondary structure  <cit> . however, the standard deviation associated with this method is still higher than  <dig> bp. shifting each single dt-rf based on this function was therefore not expected to improve the alignment accuracy. if at a later stage an improved method for calculating drift for single dt-rfs will be available, it could replace our approach combining a shift of the whole profile, cross-correlation calculation between dt-rflp and et-rflp profiles, and manual inspection. though user interpretation can introduce a subjective step, final manual processing of t-rflp profiles can remain the only way to resolve t-rf alignment problems  <cit> . we nevertheless suggest that selected samples of the investigated system should pass through pyrotrf-id in triplicates in order to validate the optimal drift determined in the cross-correlation analysis.

following the standard pyrotrf-id procedure, high level of correspondence was obtained between dt-rflp and et-rflp profiles. over all samples, 63±18% of all et-rfs could be affiliated with a corresponding dt-rf. correspondence between dt-rfs and et-rfs was relatively obvious for high abundance t-rfs, in contrast to low abundance dt-rfs. numerous low abundance dt-rfs were present in dt-rflp profiles but absent in et-rflp profiles. conversely, et-rfs were sometimes lacking a corresponding dt-rf. this mainly occurred in profiles generated using pyrosequencing datasets with an initially low amount of reads exceeding  <dig> bp. the lower proportion of long reads was associated with a decreasing probability of finding a restriction site in the final portion of the sequences. for et-rfs near  <dig> bp, incomplete enzymatic restriction could explain that undigested amplicons were detected in the electrophoresis runs  <cit> . these features, however, do not explain missing dt-rfs, which sometimes occurred in the initial portion of the dt-rflp profile. egert and friedrich  <cit>  have attributed the presence of ′pseudo t-rfs′ to undigested single stranded dna amplicons, and have cleared them by cleaving amplicons with single-strand-specific mung bean nuclease. an interesting possibility to increase considerably the number of long reads would be to use bidirectional reads as used by pilloni et al. for the characterization of tar-oil-degrading microbial communities  <cit> .

the majority of dt-rfs were affiliated to several phylotypes, revealing the underlying phylogenetic complexity, which was in agreement with kitts  <cit> . pyrotrf-id enabled assessing the relative contributions of each phylotype, and determining the most abundant ones. in most cases, one phylotype clearly displayed the highest number of reads for one dt-rf. however, for some dt-rfs several phylotypes contributed almost equally to the total number of reads. although problematic while aiming at identifying t-rfs, this information is of primary importance if pyrotrf-id is intended to be used for designing the most adapted t-rflp procedure for the study of a particular bacterial community. finally, as exemplified by additional file  <dig>  the reference mapping database can have an impact on the identification of t-rfs. a fraction of  <dig> to 45% of the reads was unassigned during mapping in mg-rast with the greengenes database, while only 3-5% was unassigned with rdp. this aspect stresses the need of standardized databases and microbiome dataset processing approaches in the microbial ecology field.

CONCLUSIONS
this study presented the successful development of the pyrotrf-id bioinformatics methodology for high-throughput generation of digital t-rflp profiles from massive sequencing datasets and for assigning phylotypes to et-rfs based on pyrosequences obtained from the same samples. in addition, this study leads to the following conclusions:

• the combination of pyrosequencing and et-rflp data directly obtained from the same samples was a powerful characteristic of the pyrotrf-id methodology, enabling generation of dt-rflp profiles that integrate the whole complexity of microbiomes of interest.

• the lowra and highra  <dig> pyrosequencing method did not impact on the final results of the pyrotrf-id procedure.

• as in any new generation sequencing analysis, denoising was a crucial step in the  <dig> pyrosequencing dataset processing pipeline in order to generate representative digital fingerprints.

• the pyrotrf-id workflow could be applied to the screening of restriction enzymes for the optimization of favorably distributed et-rflp profiles by considering the entire underlying microbial communities. haeiii, mspi and alui were good candidates for t-rflp profiling with high richness and diversity indices.

• the pyrotrf-id methodology was validated with different samples from low- and high-complexity environments, and could be implemented in a broad spectrum of biological samples in environmental to medical applications with optimized laboratory and computational costs. this methodology is probably not restricted to pyrosequencing datasets, and could be, after some modifications, applied to datasets obtained with any kind of sequencing techniques.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
dgw and ns equally contributed to this work by conceiving, designing and coordinating the study, by carrying out sampling and molecular biology investigations, by leading the development of the pyrotrf-id bioinformatics methodology, by analyzing all collected data, and by drafting the manuscript. dgw additionally conceived the tables and the figures. ls was responsible for the optimization and validation of pyrotrf-id and wrote the underlying codes. gl coded the initial bioinformatics procedure. jm and pr participated in the design of the study. jr coordinated the development of pyrotrf-id at the bioinformatics and biostatistics core facility. ch led the project and gave the initial idea of reconstructing t-rflp profiles from pyrosequencing data. dgw and ns wrote the manuscript, with additional contributions of jm, pr, and ch. all authors read and approved the final manuscript.

supplementary material
additional file 1
quality plots generated for samples pyrosequenced with lowra  and highra methods . sequence quality phred scores over all bases : phred scores are defined as the logarithm of the base-calling error probability perror = 10-phred/ <dig> and phred = − <dig> log perror. box plots represent the distribution of reads quality at each sequence length. the black curve represents the mean sequence quality in function of the sequence length. distribution of the mean sequence quality phred score over the pyrosequencing reads . distribution of sequence lengths over all pyrosequencing reads . only sequences between  <dig> and  <dig> bp were kept for dt-rflp analysis.

click here for file

 additional file 2
assessment of mapping performances with pyrosequencing datasets denoised without  and with  minimal read length cutoff. examples are given for the groundwater sample grw <dig>  the flocculent activated sludge sample fls <dig> and the aerobic granular sludge sample ags <dig>  after denoising with the one or the other method, each dataset was mapped against a reference database with mg-rast  <cit> . no cutoff was set for e-value, minimum identity and minimum alignment length. after having observed that between 35-45% of the sequences were unassigned with greengenes, rdp – the ribosomal database project  <cit>  was used as reference database for this assessment . correlations between bacterial community profiles obtained with both denoising methods and both reference databases were analyzed with stamp  <cit> .

click here for file

 additional file 3
comparison of the distributions of the sw mapping score and of the traditional identity score used by microbial ecologists in the field of environmental sciences for phylogenetic affiliation of sequences. the distributions of the absolute sw score  and of the sw scores normalized by the read lengths  obtained after mapping of  <dig> pyrosequencing datasets with the bwa-sw algorithm implemented in the pyrotrf-id methodology are compared to the distribution of the identity score obtained after annotation of  <dig> pyrosequencing datasets with mg-rast  <cit> . greengenes was used as annotation source in all cases. the obtained distributions are characterized by median , average  and standard deviation values .

click here for file

 additional file 4
full digital t-rflp profiles. examples of full digital t-rflp profiles obtained with the restriction enzymes haeiii and mspi for the samples grw <dig>  and ags <dig> .

click here for file

 additional file 5
comparison of mirror plots obtained on raw  and on denoised  pyrosequencing datasets. examples are given for the sample grw <dig> pyrosequenced with the highra method  and for the samples grw <dig>  and ags <dig>  pyrosequenced with the lowra method.

click here for file

 additional file 6
assessment of cross-correlation and optimal lag between denoised dt-rflp and et-rflp profiles. the denoised dt-rflp profiles of the samples ags <dig>  and grw <dig>  were both shifted with optimal lags of − <dig> bp to match with the related et-rflp profiles. at these optimal lags, the maximum cross-correlation coefficients amounted to  <dig>   and  <dig>  .

click here for file

 additional file 7
alignment of sequences mapping with the same reference sequence with identical accession number in the greengenes database, and resulting in different digital t-rfs. examples are given for the rhodocyclus tenuis affiliates  of sample ags <dig> and for dehalococcoides relatives  of sample grw <dig> 

click here for file

 acknowledgements
this research was financed by the swiss national science foundation, grants no.  <dig>   <dig> and  <dig>  we recognize the excellent assistance of yoan rappaz in molecular biology analyses. we acknowledge scot e. dowd, yan sun, lars koenig and at research and testing laboratory , timothy m. vogel, sébastien cecillon and the environmental microbial genomics group at ecole centrale de lyon , and gatc biotech  for pyrosequencing analyses and advice. we are grateful to ioannis xenarios for support and access to the vital-it hpcc of the swiss institute of bioinformatics .
