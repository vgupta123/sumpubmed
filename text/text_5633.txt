BACKGROUND
stochasticity is an inherent property of living cells. stochastic perturbation comes not only from the noisy environment that cells live in, but also from all processes going on inside cells  <cit> . especially when the copy number of molecules like mrna or protein gets smaller, stochastic fluctuations can have significant effect on the behavior of a cell. there have been many studies focused on discovering the effect of noise in living systems  <cit> , and some of the results show that cells do not only evolve to resist noise perturbation better, but also form massive mechanisms which are the benefits of stochasticity  <cit> . genetic switching is a typical example of noise-driven cellular behavior which can be performed spontaneously under particular conditions in living cells, such as the switch of lac operon in escherichia coli  <cit> , the formation of biofilm  <cit> , and the entrance into competence state  <cit>  in bacillus subtilis, etc.

several recent studies discovered strong connections between noise and gene regulation mechanisms through measuring variability in protein and mrna levels  <cit> . both experimental and theoretical results suggested that the switching rates of gene between its active and inactive states have significant effects on the noise of gene expression  <cit>  and are highly responsible to different gene expression dynamics. previous theoretical studies mainly focused on the regime with fast switching rates , however, recently some unique phenomena are observed especially when switching rates are slow, either due to the chromatin remodeling precess  <cit>  or the transportation of transcription factor into nucleus  <cit> . thus, it is important and desirable to provide an approach which can effectively identify the key dynamical features of gene expression system when switching rates are slow, and to distinguish the regime of gene regulatory networks from different phenotypic variations.

in this paper, we aim at providing a method to distinguish the rates of genetic switches from phenotypic variations. first, we systematically investigated the dynamical and stochastic properties of different genetic regulatory models in a comparative way when biochemical rates for gene activation/inactivation, transcription, translation, and mrna/protein degradation vary over a wide range. we focused on a two-state gene-expression model with positive feedback loop, which is simplified from a four-state gene-expression network taking account of chromatin opening/closing step and regulatory protein binding/unbinding step  <cit> . in the regime when the rates of gene activation/inactivation are relatively small compared with the synthesis/degradation rates of mrnas and proteins, we found that the effective dynamics can be reduced to independent evolutions on two separate layers. we reconstructed the energy landscape of the system through gaussian mixture approximations, and it is qualitatively different from the previously known picture in  <cit> . in the regime with relatively fast switching rates, we briefly discussed about the system based on our previous study with large deviation theory  <cit> . in the regime with intermediate switching rates, we utilized the mean switching time  to investigate the stability of the system in different parameter ranges. in the following paragraphs, we will call these three regimes as slow, fast, and intermediate regimes for convenience. finally, based on our theoretical understanding of the essential dynamics of the slow, intermediate and fast regimes, we designed a simulation experiment to distinguish the three regimes. we identified the intermediate regime from the fact that cellular memory is much weaker in this regime than the other two regimes. and we distinguished the slow and fast regimes through their different response behavior with respect to switching rates perturbations. our study gives a global characterization of the genetic switching dynamics in various cells and has potential guidance in real experiments.

methods
we consider a four-state gene-expression model with positive feedback loop . proteins are self-activators in this system, since they can bind to dna and activate the transcription step. chromatin opening becomes relatively easy when dna is bounded by a monomer regulatory protein. open chromatin structure is permissible for transcription whereas closed chromatin is not. the rate of mrna production reaches its maximum on the bounded and open state of dna. additionally, proteins and mrnas are subject to degradation, which is not shown in fig. 1a. assuming that binding and release of regulatory proteins are in fast equilibrium  <cit> , this four-state model can be simplified into a two-state model  through the quasi-steady-state approximation    <cit> . we will say that the gene is open  when the chromatin is open , and the system switches between open and closed gene states through gene activation/inactivation steps.
fig.  <dig> schematic representation of the genetic switching model with positive feedback. a four-state model. a single regulatory protein can bound to the dna and improve the efficiency of chromatin opening. when the chromatin is open, mrna is synthesized and will later be translated into a regulatory protein. the four states of dna are  closed and unbounded,  closed and bounded,  open and unbounded,  open and bounded. the switches between the adjacent states are reversible. b simplified two-state model. binding/unbinding is reduced through the qssa



in the two-state model, there are six reactions occurring among four chemical species. all of the reactions involved in this system are summarized in table  <dig>  here m and n are the numbers of protein molecules and mrna molecules, respectively. the jump rate into the open state and the transcription rate are controlled by the relative occupancy of protein at dna binding site , whereas the jump rate into the closed state is not affected by the number of proteins. op has the form op=n/, where k is a constant by reduction and represents the strength of positive feedback. it is actually the conditional probability of state  in fig. 1a given that the chromatin is open. the rates kgop+kg <dig> and krop+kr <dig> characterize the gene activation and mrna synthesis, which are dependent of the number of proteins. the constants dg, kp, dr and dp correspond to the rates of gene inactivation, protein synthesis, mrna and protein degradation. in fact, if we assume that dimer proteins  regulate the gene instead of the monomer protein, op will have the form op=nk/. the value of k will not influence the essential dynamics of the gene expression model, on condition that we choose proper range of parameters with respect to different k. under some reasonable assumptions, most of the derivations and results in the next section are still correct .
→dg
→kgop+kg0
→krop+kr0
m
→kp
n
m
→dr
∅
n
→dp
∅


due to the intrinsic noise, the dynamics of the system can be described by the chemical master equation   as 
  dp0dt=−kg0+kgnn+kp0+dgp1+kp+dr+dp, 

  dp1dt=kg0+kgnn+kp0−dgp1+kp+kr0+krnn+kp1−p1+dr+dp, 

where pα stands for the probability that there are m mrna molecules and n protein molecules in the system when the gene is open  or closed . one possibility to study the behavior of the system is to numerically solve eqs. 1- by truncating the domain and setting the boundary conditions pα= <dig> when m≥m, n≥n . but simply obtaining this solution does not mean we understand the essential mechanism of the dynamics, and the computational effort may be huge when the mean number of molecules is quite large in this system. thus, we aim to find other ways to learn about the dynamics.

we define a key parameter κ to compare two characteristic timescales of the problem: the timescale dp− <dig> on which the gene state changes and the timescale dg− <dig> on which the number of protein and mrna molecules changes, where dp− <dig> is the lifetime of a single protein and dg− <dig> is the lifetime of the open gene state. the ratio κ=dg/dp can take any positive value, which will lead to notable differences in the dynamics. small ratios  describe long timescales of the change in gene states, compared with the timescale on which mrna and protein numbers change. in this regime, there is enough time for the system to reach a steady state when gene is either open or closed. transition from one steady state to another always occurs immediately after the genetic switches. large values of the ratio  indicate that the gene states change very rapidly, whereas the synthesis and degradation of protein and mrna molecules are relatively slow. as κ goes to infinity, the system exhibits the deterministic features  <cit> . when κ is neither large nor small enough, genetic switches, transcription and translation will take place on the same timescale. the dynamics is complicate in this regime, and analytical results are hard to reach. so we resort to numerical simulations and extract useful information. in all of the three regimes, metastable states may occur with proper choice of parameters. indeed, we will utilize a set of biologically relevant parameters in later computations . for convenience, we will call the steady state with relatively large number of proteins as on state, whereas the steady state with relatively small number of proteins is off state.

RESULTS
case a: slow regime
we first consider the slow regime where the gene states change very slowly compared with the synthesis and degradation of proteins and mrnas. we start from constructing the energy landscape, which is a useful way to illustrate the dynamics of the system. we simply take the definition of the potential as u=− lnp, which is commonly used by wang et al.  <cit> . here p is the invariant distribution with the form p=p0+p <dig>  solving the cme of the system - with brutal force, we get the energy landscape as shown in fig. 2a. it contains two attracting basins, among which the one with large number of molecules is related to the open state, whereas the other one located at the origin is related to the closed state. as the global energy landscape reflects the steady state distribution of the system, it can not tell us non-equilibrium information. below we will address this issue by reducing the dynamics and revealing the essential nature of the system.
fig.  <dig> illustrations of the energy landscapes and transition paths with slow switching rates. a a global view of the quasi-potential energy landscape of the genetic switching system. switching paths from off to on state  and from on to off state  are deterministic paths between two stable fixed points. we call the steady state with relatively large number of proteins as on state, whereas the steady state with relatively small number of proteins is off state. b the two-layer decomposition of subfigure a. jumps between two layers are rare events compared with reactions on each individual landscape. c, d averaged switching trajectories from simulations. we take the two stable fixed points in the deterministic dynamics as the starting and ending points. darkness of the shading points represents the average duration time on reactive trajectories. we keep track of the trajectories from the time that gene states change to the time that the system reaches new stable state. we use principal curve to characterize the averaged switching trajectories . the results suggest that the average switching paths are along deterministic paths. the parameters are k
r= <dig>  k
r0= <dig> , k
p= <dig> , d
r= <dig> , d
p= <dig> , d
g= <dig> , k
g= <dig> , k
g0= <dig> , and k=3000



a careful observation shows that the gene will stay on a single state for a very long time and then make transition to another state. so we decouple the landscape into two separated layers according to the gene state . the upper layer stands for the open state, whereas the lower layer stands for the closed state. transitions between two layers do not often occur. each layer has only one steady state, which can be found through deterministic rate equations 
  dmdt=αkr0+krnn+k−drm,dndt=kpm−dpn, 

where α takes value  <dig> if the gene is closed and value  <dig> if the gene is open. the steady states of eq.  <dig> when α= <dig> and  <dig> characterize the attraction points in the overall energy landscape and the relaxation from one steady state to the other corresponds to the transition paths. if the noise effect can not be neglected, we can further get the diffusion approximation beyond eq.  <dig> . when the system size is large, the dynamical process on each level can be approximated by diffusion process . we consider the concentration variables x=m/v, y=n/v on the lattice ℕ2/v, where v is the volume size. define x=, then the first and second moments of the process satisfy 
  x˙=c),σ˙=σjt+jσ+2d), 

where c and d have the form 
  c=−drx+αkr0+kryy+kkpx−dpy,d=12drx+αkr0+kryy+k00kpx+dpy. 

j is the jacobian of c), and σ is the covariance matrix of the system. thus, given α= <dig> or  <dig>  the dynamics of the system can be well approximated by the time evolution of the moment eqs.  <dig> and the transition paths mainly follow the solution of the odes  . this is verified by gillespie’s stochastic simulation algorithm and the results are shown in fig. 2c, d. the darkness of the shading points represents the number of visits for transition paths, and the fitted curve shows nice coincidence with the deterministic path, which strongly supports our methodology.

this understanding can also be utilized to get a simple approximation of the invariant distribution. when the rates of genetic switches are extremely slow, the system will mainly stay in closed-state basin or open-state basin with rare transitions. so we have κ≈ <dig>  and we can approximate the steady state distribution pαss by simple gaussian distribution n, where xαss and σαss are the corresponding steady state solution of eq.  <dig>  furthermore we can combine the two distributions to depict the invariant distribution of the whole system through a gaussian mixture model 
  pss≈wn+n, 

where the mixture weight w is the proportion of time that the system stays on the closed layer. since the mean time that gene stays on the open layer is dg− <dig>  and the mean time that gene stays on the closed layer is approximately kg0− <dig> , the value of w satisfies 
  w1−w≈kg0dg. 

solve it and we get w=kg0/. this simple gaussian mixture approximation is shown and compared with the accurate distribution in fig. 3a, b. the approximation seems to fit the solutions of eqs. 1- well, especially around the steady point. but some details corresponding with the switching paths are neglected, which makes some difference with the accurate solutions.
fig.  <dig> illustrations of the simple gaussian mixture approximation and the modified gaussian mixture approximation to the accurate energy landscape in the regime of slow switching rates. a the solution of cme which we take as the accurate energy landscape. b illustration of the simple gaussian mixture approximation. c illustration of the modified gaussian mixture approximation. d, e, f the relative errors of two approximation methods on the open layer, closed layer and global energy landscape. dashed lines correspond to the simple gaussian mixture approximation and solid lines correspond to the modified approximation. we use the kl divergence  to measure the difference between two approximations and the accurate solution of cme. to make the kl divergence well defined, we assume that the minimum value of the distributions in the truncated domain is 10− <dig> . from the quantitative comparisons, we find that the modified approximation is superior than the simple approximation since more detailed information are encoded. parameter values are the same with those in fig. 2




when the rates of genetic switches are relatively slow but not extremely slow, we can refine the approximation  by taking into account the transition path information. on the open layer, we solve eq.  <dig> with initial values  to get solutions . then we use the time-average of gaussian distributions to approximate p1ss, i.e. 
  p1ss≈1t1∫0t1pdt, 

where p is the probability distribution density of n, and t <dig> is the average time that system keeps staying on the open layer. the same approach applies to the approximation of p0ss. then we combine p0ss and p1ss to get 
  pss≈wp0ss+p1ss, 

where the value of w remains the same. we call eq.  <dig> the modified gaussian mixture approximation and compare it with the accurate distribution in fig. 3c. indeed, eq.  <dig> is the limit of eq.  <dig> when κ→ <dig> 

we also compute the relative errors of the two approximations and find that the modified gaussian mixture approximation is superior than the simple gaussian mixture approximation nearly in the whole slow regime . on both the open and the closed layers, the modified gaussian approximation performs better than the simple gaussian approximation. when the switching rates are extremely slow, the two approximations perform equally well. when κ is not very small but still belongs to the slow regime, the simple gaussian approximation on the closed layer which is a single-point delta distribution, deviates far from the accurate solution. this is the main reason that simple gaussian mixture approximation has relatively large errors.

case b: fast regime
we now consider the case that genetic switches are much faster than the other reactions in the system. in this regime, the effective synthesis rate of mrna is kon/ according to the qssa, where kon and koff stand for the gene activation and inactivation rates. the deterministic mean-field description of this model yields the odes: 
  dmdt=kr0+krnn+kkg0+kgnn+kdg+kg0+kgnn+k−drm,dndt=kpm−dpn. 

this system has two stable fixed points and one saddle in physically reasonable parameter regime. these two stable fixed points correspond to the expressed and unexpressed states at which the copy number of proteins is at high or low state, respectively. as shown in the previous section, the global energy landscape of the slow regime also has two basins, which looks like the fast case in the first sight. but the essential nature is totally different. the bistability of the system in the slow regime originates from the simple two-layer dynamics induced by genetic switching, whereas the bistability in the fast regime is from an adiabatic reduction of the switching dynamics. the previous work of the authors has established a good framework to understand the metastability based on large deviation theory for markov processes  <cit> . in this framework, we assume that the steady state distribution pss satisfies pss∝ exp), where s is the global quasi-potential function that we focus on, and the volume size v is inversely proportional to the noise strength. from wkb asymptotics  <cit>  or the large deviation theory  <cit> , we know that s satisfies the hamilton-jacobi equation h= <dig> from the leading order analysis for the corresponding cme, where h is the hamiltonian of the system. however, solving the hamilton-jacobi equation is not an easy task, and we utilize an alternative efficient optimization approach to obtain s. we define the local quasi-potential s with respect to a metastable state x <dig> as 
  s=inft>0infϕ,ϕ=x <dig> ϕ=x∫0tldt, 

where l is the lagrangian, which is the legendre transform of the hamiltonian h, and the path ϕ are all possible continuous connections from x <dig> to x within time t. from classical mechanics, the double minimization problem  can be transformed to a single minimization with respect to the intrinsic representation of the curves ϕ by maupertuis’ principle  <cit>  as 
  s=infh= <dig> hp=λϕ′ϕ=x <dig> ϕ=x∫01p·dϕ, 

where p and λ are determined from the constraints for each ϕ. this minimization problem can be efficiently solved by using the geometric minimum action method   <cit> . s can be obtained from its local version s by a suitable sticking procedure  <cit> . with this approach, we can construct the global quasi-potential energy landscape s and obtain the most probable transition paths between two metastable states. more details can be referred to  <cit> .

with proper values of parameters, the system has two metastable states and the global quasi-potential energy landscape can be constructed as shown in fig. 4a. the landscape looks similar with fig.  <dig>  but transition paths between two basins show different features. in the slow regime, the transition paths are characterized by the solutions of deterministic odes  and they do not intersect at any point. in the fast regime, the most probable transition paths of on-to-off switching and off-to-on switching are not identical, either. they intersect at an unique point, i.e. the saddle point of the deterministic odes , but they do not cross over each other . we also present the results by gillespie’s algorithm and compare the theoretically predicted optimal transition paths and the fitted curves in fig. 4c, d. the comparison shows good matching between the fitted curves and the theoretical transition paths. our results are consistent with the previous studies  <cit> .
fig.  <dig> illustrations of the energy landscapes and transition paths with fast switching rates. a the global quasi-potential energy landscape of the genetic switching system. the most probable switching paths from off to on state  and from on to off state  both pass through the saddle point. b details of subfigure a. c, d the principal curves  fitted from shading points obtained by gillespie’s algorithm compare with the optimal transition paths. the result shows good matching between the fitted curves and the theoretical results. the parameters d
g= <dig>  k
g= <dig>  k
g0= <dig>  and the others are the same with those in fig. 2




case c: intermediate regime and comparisons
in both the fast and slow regimes, we have already illustrated some analytical approaches to quantitatively understand the global energy landscape and transitions between metastable states in gene expression model with positive feedback. but in the intermediate regime, where all of the reactions are on the same time scale, these analytical methods fail, since it is difficult to find the appropriate deterministic equations and hard to know whether steady states exist in the system. thus we compute the key properties in the intermediate regime through gillespie’s algorithm and compare the results with the slow and fast regimes.

we simulate the mean switching time  with different parameters. the mst is the average transition time between two basins on the global energy landscape, which is often used to characterize the stability of the attractors. figure  <dig> shows the mst with respect to different κ and positive feedback strength k. when κ increases from 10− <dig> to  <dig>  the gene activation rate changes from slow to fast regimes. since we focus on switching times between metastable states, the value of k should be chosen to guarantee that bistability always exists in the system with respect to all the possible values of κ. we define the existence of bistability as that the system stay at each metastable state with probability more than  <dig> . in the slow regime, bistability always exists for any positive k. in the intermediate and fast regimes, we find two boundary values of k, which are k= <dig> and k= <dig>  when k< <dig>  the system will stay at the off state with probability less than  <dig> , whereas when k> <dig>  the system will stay at the on state with probability less than  <dig> . the smaller k is, the larger positive feedback strength is.
fig.  <dig> the mean switching time  as a function of κ with different positive feedback strength. a mst curve of off-to-on switch. b mst curve of on-to-off switch. parameters are the same with with fig.  <dig> except d
g, k
g, k
g <dig>  and k. when κ changes, d
g should change simultaneously to keep d
g/k
g, d
g/k
g <dig> locked . we use different strength of positive feedback for simulations, which is k= <dig> ,  <dig> ,  <dig> . all of the results are obtained from gillespie’s algorithm



in the slow regime, the mst can be characterized by the waiting time for transitions to occur, so the mst decreases as κ increases. in this regime, k has little effect on mst, which is consistent with our analysis in case a that the mst of on-to-off and off-to-on transitions is approximately dg− <dig> and kg0− <dig>  respectively. when κ increases to a value between 10− <dig> and 10− <dig>  the mst decreases to its global minimum point, and a neighborhood of this point is corresponding to the intermediate regime. then the mst goes up with κ increasing, and finally reaches a stable value in the fast regime. in the fast regime, when k changes from  <dig> to  <dig> , the mst of off-to-on switch increases by a factor of about  <dig>  whereas the mst of on-to-off switch decreases by a factor of about  <dig>  thus, if the positive feedback becomes stronger, the system will be more probable to stay at the on state, with shorter off-to-on switching time and longer on-to-off switching time.

longer mst indicates that metastable states are more stable. thus, our results in fig.  <dig> show that the slow and fast regimes perform better in stability, whereas in the intermediate regime, genetic switches, transcription and translation are on the same time scale, which contributes to large fluctuations of molecule numbers and relatively short mst. these properties remain the same with different positive feedback strength. furthermore, we also did some interesting simulations to study the change of transition paths as a function of κ .

we should mention that the above points are direct observations from numerical results, which are hard to be proven analytically. however, we can confirm from the derivations in case a that when κ is extremely small, the mst of on-to-off and off-to-on transitions is approximately dg− <dig> and kg0− <dig>  that is to say, the downward-sloping shapes of the left parts of the mst curves are qualitatively robust. besides, when κ goes to infinity, the mst will converge to some constant values  <cit> . so the flat parts on the right of the mst curves are also theoretically supported. the existence of “valleys” in the mst curves is in accordance with the intuition, but it is difficult to give a rigorous proof. to investigate the robustness of the whole qualitative shape of the mst curve with respect to different feedback actions, we simulated all the results with op=n2/, and found that the shapes of the mst curves are almost the same as in fig.  <dig>  we may reasonably infer that all results still hold assuming that op is a hill function and the bistability exists in both slow and fast regimes . these results suggest a natural methodology to distinguish the different genetic activation/inactivation rates in the cellular phenotype observations, which is described in detail in the continued text.

distinguishing the three regimes
in molecular experiments, it is hard to directly measure the switching rates of the active or inactive gene state. based on the obtained results, we propose a method to distinguish which regime the considered system falls in. consider a gene expression circuits with the positive feedback in a eukaryotic cellular system , such as the yeast or the immune cell etc, we can observe the level of proteins through fluorescence or other markers by flow cytometry. below we will show how to take advantage of these perceivable data and related analysis to make corresponding distinction.

first let us introduce how to identify the intermediate regime. we utilize the strength of cellular memory as the index, and more concretely, we sort the cells by the protein level and observe how long the sorted cells will take to reach the original invariant distribution of proteins. the detailed flow cytometry procedure of our experiments in silico is stated in the following two steps. 
step 1: sorting the cells by the protein levels. for example, we choose n= <dig> as the threshold of classification in our model setup, where n is the number of protein molecules in a cell. we call the cells with large number of proteins  as p+ cells, and the cells with small number of proteins  as p − cells. we define the fraction of p+ cells in a cell group as the p+ fraction. figure 6a illustrates the numerically sorted results of the system, including  <dig>  sample points which are randomly selected according to the invariant distribution, and p+/p − cells are classified by the protein level in each cell. to apply this approach to the gene regulatory network with different parameters, one need to choose an appropriate threshold according to the real situation, which needs to lie between two metastable states.
fig.  <dig> a method we propose to distinguish the slow, intermediate and fast regimes.   <dig>  sample points are selected randomly according to the invariant distribution solved from the cme, i.e.  <dig>  cells are selected randomly from a cell population. then the cells are classified by the number of proteins. we call the cells with large number of proteins  as p+ cells, and the cells with small number of proteins  as p- cells. we define the fraction of p+ cells in a cell group as p+ fraction. b, c we simulate the evolution of the two groups for a long time with gillespie’s algorithm. the change of p+ fractions are recorded in solid lines and the final values of p+ fractions are drawn in dashed lines. it is obvious that cells of the intermediate regime have shorter memory, for they rapidly recover to the origin unsorted state . d, e, f if we perturb κ , the lines of p+ fractions are shifted in different ways with respect to different regimes. in the slow regime , p+ fraction changes more quickly when κ increases, whereas in the relative fast regime , the time spent for cells to recover to the invariant distribution is longer or unchanged when κ increases. g the evolution of distributions in the view of protein molecules. these are detailed data of subfigure b which illustrate our thought clearly. h comparison of the slow, intermediate and fast regimes. using this method, we successfully distinguish the three regimes. the parameters are the same with fig.  <dig> in all the figures above



step 2: culturing the sorted p+ and p − groups of cells separately, and recoding the changes of p+ fractions in each group. figure 6b, c show the simulation results of the p+ and p − groups respectively. the evolution of the protein distributions of the sorted p+ group is simulated and illustrated in fig. 6g, including results of the slow, intermediate and fast regimes. the sorted p+ group of cells in the intermediate regime can be observed to evolve quickly to its initial equilibrium state. in the third day, a large percent of p+ cells in the intermediate regime have evolved to the p − group, whereas the p+ cells in the slow and fast regimes have little change. this suggests that cellular memory is much stronger in the slow and fast regimes compared with the intermediate regime.



in the real experiments, we do not know whether the time for an appreciable change of protein levels is long or short without reliable reference. but the mst in the intermediate regime is approximately the time for cells to reach a metastable state after leaving another metastable state, thus we can use it as a reference time. we define t as the on-to-off  transition time, which does not contain the dwell time at the on  state. since the synthesis and degradation rates of mrnas and proteins can be estimated through experimental approaches, we can theoretically figure out the time that the system will spend to reach the off state after leaving the on state. that is to say, t can be roughly estimated a priorily. so we make experiments like fig. 6g for a period of time which is close to t. if the value of p+ fraction changes evidently towards the equilibrium level, we will know that the system belongs to the intermediate regime.

second we try to identify the fast and slow regimes through the perturbation-response behavior of changing κ. as shown in fig. 5a, the mst becomes larger and larger when κ approaches to zero, but it increases and gradually stays close to a fixed value when κ is large. thus, if we perturb κ through injection of particular chemicals, cells in the two regimes will perform differently in the experiments we designed above. figure 6d, e, f illustrate the results of corresponding numerical simulations. in the slow regime , p+ fraction changes more quickly when κ increases, whereas in the relatively fast regime , the time for cells to recover to the invariant distribution is longer or unchanged when κ increases. with this perturbation-response approach, the slow and fast regimes can also be distinguished from each other . when the positive feedback strength k takes the boundary values mentioned in case c, the simulation experiments above still work well . this proposal, based on our theoretical understanding of the feature of the three regimes, is yet to be justified by experimentalists.

discussion
understanding the dynamical features and the energy landscapes of the gene regulatory network is an interesting and challenging topic in quantitative biology. some approaches focused on the regime of fast switching rates have been developed in recent years, whereas the slow regime which many eukaryotic cells correspond to attracts less attention. in this paper, besides the theoretical analysis of the essential dynamics in the slow, intermediate and fast regimes, we provide a method to distinguish these three regimes. the result is meaningful and enlightening for the design of corresponding biological experiments.

with regard to a previous work about stochastic dynamics of single regulating genes  <cit> , we provide a systematic study to understand the genetic switching dynamics when the switching rates are in different regimes. although the global quasi-potential energy landscape and other properties of the system can be obtained from brutal force through numerical simulations, the theoretical reductions can reveal the intrinsic mechanisms. we analyze the model theoretically in the slow and fast regimes and successfully reconstruct the global energy landscape which reflects the inherent pattern of system behavior. but we obtain little theoretical results in the intermediate regime, since the nonexistence of time-scale separation makes this problem more challenging. recent new ideas proposed in this field may be helpful in the study of this regime  <cit> .

a related but different concept with multi-layer landscapes for the dna fast switching case was mentioned in a recent literature  <cit> . however, we are mainly concerned with the two-layer case when the system is in slow regime. besides understanding the system as decoupled layers, we further study the properties about transition paths and average switching time, and we construct the global potential energy landscape through simple gaussian mixture and modified gaussian mixture approximations. these pictures are quite different from the case of fast regime.

the mst is a key characterization of gene regulatory networks and has been studied analytically with respect to different genetic switching rates in  <cit> . compared with the detailed theoretical analysis for a typical one-dimensional self-activating switch model, we can not give fully theoretical results in the fast regime, i.e. the strictly adiabatic regimes considered in  <cit> , since our model involves both mrna and protein explicitly. however, we present efficient numerical methods to make the quantitative estimates. the results for the extremely slow regime are also consistent with those obtained for non-adiabatic regime . we also suggested the landscape as an intuitive tool to understand the essential dynamics of our model. overall, the shape of the mst curve we obtained as a function of κ is qualitatively similar as in  <cit>  as well.

the proposed quasi-potential energy function s in the fast regime has close connection with the potential function considered in previous studies. in wang et al’s approach  <cit> , they proposed to define the energy landscape as u=− lnpss, where pss is the steady state distribution. we have the connection that s=limv→∞v−1u  <cit>  since u itself depends on the system size v. we also note that the proposed quasi-potential s satisfies the same hamilton-jacobi equation as the potential defined in  <cit>  in the diffusive approximations. but in addition, we provided a variational minimization approach to explicitly construct the s. nonetheless, this construction is only valid for the fast regime and it is quite different from the picture we showed in the slow regime.

although our four-state genetic switching model is based on chromatin remodeling, this is no longer expressed in the final simplified two-state model. in fact, some prokaryotic cells also have similar gene regulatory networks like fig. 1b  <cit> . our study mainly focuses on the two-state model, which can be suitable for a wide variety of cellular systems rather than the motivating chromatin remodeling process. our simulation experiment to distinguish the slow, intermediate and fast regimes is an important point of the paper. so far, we are not able to perform real experiments to make the verification. the real experimental systems may be also more complicated than the model considered here. but our simulation experiment is logically true and self-consistent, and there have been related experiments performing well in th <dig> cells  <cit> . finding suitable system and validating our proposal will be an interesting task in the future.

our study has potential application in single-cell experiments . in the single-cell gene expression analysis, the protein level of each cell at different time points can be obtained through tracking and recording the behavior of each cell by fluorescence microscopy. with these data, one can obtain the switching time as the time difference between two consecutive states of a cell. thus the mst can be roughly estimated. similar as the procedure in flow cytometry experiments, the information about mst can be utilized to identify the intermediate regime, and the fast and slow regimes can be distinguished by perturbing κ. however, these points remain to be investigated in detail in the follow-up researches.

CONCLUSIONS
in this paper, we proposed a methodology to distinguish the regime of genetic switching rates from phenotypic variations in a simulation experiment. to accomplish this task, we put forward different reduction and investigation methods to reveal the essential dynamics of the genetic switching system when the switching rates are relatively slow, fast, or medium compared with the degradation rates of proteins. although in the fast and slow regimes, the observed steady state distributions of the mrnas and proteins are similar, we showed that the underlying mechanisms are qualitatively different. based on our results, we provided a simulation experiment to distinguish these three regimes. the intermediate regime can be identified from the fact that the strength of cellular memory is lower than the other two cases, and the fast and slow regimes can be distinguished by their different perturbation-response behavior with respect to the switching rates perturbations. we also discussed the robustness of our results with respect to different choices of parameters and feedback function forms. this study provides insights to the experimental analysis of the gene expression system. it will be interesting to investigate similar problems in different experimental setups in the future.

additional file
additional file  <dig> 
supporting information. simplification of the four-state genetic switching model; gaussian approximation in the regime of slow switching rates; an extension of the results: op=nk/,k∈ℕ; distinguishing the three regimes when the positive feedback strength k takes the boundary values; the change of switching paths as a function of κ; and biological relevance of the parameter values.



abbreviations
mstmean switching time

qssaquasi-steady-state approximation

cmechemical master equation

gmamgeometric minimum action method

competing interests

the authors declare that they have no competing interests.

authors’ contributions

tl and fl designed the research. yc and cl performed the research. all authors analyzed the data and wrote the paper. all authors read and approved the final manuscript.

