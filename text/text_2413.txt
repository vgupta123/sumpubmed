BACKGROUND
unsupervised clustering algorithms play a crucial role in the exploration and identification of structures underlying complex bio-molecular data, ranging from transcriptomics to proteomics and functional genomics  <cit> .

unfortunately, clustering algorithms may find structure in the data, even when no structure is present instead. moreover, even if we choose an appropriate clustering algorithm for the given data, we need to assess the reliability of the discovered clusters, and to solve the model order selection problem, that is the proper selection of the "natural" number of clusters underlying the data  <cit> . from a machine learning standpoint, this is an intrinsically "ill-posed" problem, since in unsupervised learning we lack an external objective criterion, that is we have not an equivalent of a priori known class label as in supervised learning, and hence the evaluation of the reliability of the discovered classes becomes elusive and difficult. from a biological standpoint, in many cases we have no sufficient biological knowledge to "a priori" evaluate both the number of clusters , as well as the validity of the discovered clusters   <cit> .

to deal with these problems, several methods for assessing the validity of the discovered clusters and to test the existence of biologically meaningful clusters have been proposed .

recently, several methods based on the concept of stability have been proposed to estimate the " optimal" number of clusters in complex bio-molecular data  <cit> . in this conceptual framework multiple clusterings are obtained by introducing perturbations into the original data, and a clustering is considered reliable if it is approximately maintained across multiple perturbations.

different procedures have been introduced to randomly perturb the data, ranging from bootstrapping techniques  <cit> , to noise injection into the data  <cit>  or random projections into lower dimensional subspaces  <cit> .

in particular, smolkin and gosh  <cit>  applied an unsupervised version of the random subspace method  <cit>  to estimate the stability of clustering solutions. by this approach, subsets of features are randomly selected multiple times, and clusterings obtained on the corresponding projected subspaces are compared with the clustering obtained in the original space to assess its stability. even if this approach gives useful information about the reliability of high-dimensional clusterings, we showed that random subspace projections may induce large distortions in gene expression data, thus obscuring their real structure  <cit> . moreover, a major problem with data perturbations obtained through random projections from a higher to a lower dimensional space is the choice of the dimension of the projected subspace.

in this paper we extend the smolkin and gosh approach to more general randomized maps from higher to lower-dimensional subspaces, in order to reduce the distortion induced by random projections. moreover, we introduce a principled method based on the johnson and lindenstrauss lemma  <cit>  to properly choose the dimension of the projected subspace. our proposed stability indices are related to those proposed by ben-hur et al.  <cit> : their stability measures are obtained from the distribution of similarity measures across multiple pairs of clustered data perturbed through resampling techniques. in this work we propose stability indices that depend on the distribution of the similarity measures between pairs of clusterings, but data perturbation is realized through random projections to lower dimensional subspaces, in order to exploit the high-dimensionality of bio-molecular data.

another major problem related to stability-based methods is to estimate the statistical significance of the structures discovered by clustering algorithms. to face this problem we propose a χ2-based statistical test that may be applied to any stability method based on the distribution of similarity measures between pairs of clusterings. we experimentally show that by this approach we may discover multiple structures simultaneously present in the data , associating a p-value to the clusterings selected by a given stability-based method for model order selection.

methods
in this section we present our approach to stability-based model order selection, considering randomized maps with bounded distortion to perturb the data, stability indices based on the distribution of the clustering similarity measures, and finally we present our χ2-based test for assessing the significance of the clustering solutions.

data perturbations using randomized maps with bounded distortions
a major requirement for clustering algorithms is the reproducibility of their solutions with other data sets drawn from the same source; this is particularly true with bio-molecular data, where the robustness of the solutions is of paramount importance in bio-medical applications. from this standpoint the reliability of a clustering solution is tied to its stability: we may consider reliable a cluster if it is stable, that is if it is maintained across multiple data sets drawn from the same source. in real cases, however, we may dispose only of limited data, and hence we need to introduce multiple " small" perturbations into the original data to simulate multiple "similar" samples from the same underlying unknown distribution. by applying appropriate indices based on similarity measures between clusterings we can then estimate the stability and hence the reliability of the clustering solutions.

we propose to perturb the original data using random projections μ : ℝd → ℝd' from high d-dimensional spaces to lower d'-dimensional subspaces. a related approach is presented in  <cit> , where the authors proposed to perturb the data randomly choosing a subset of the original features ; the authors did not propose any principled method to choose the dimension of the projected subspace, but a key problem consists in finding a d' such that for every pair of data p, q ∈ ℝd, the distances between the projections μ and μ are approximately preserved with high probability. a natural measure of the approximation is the distortion distμ:

distμ=||μ−μ||2||p−q||2     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgkbazcqwgpbqacqwgzbwccqwg0baddawgaawcbaaccigae8hvd0gabeaakiabcicaoiabdchawjabcycasiabdghaxjabcmcapiabg2da9maalaaabagaeiifawnaeiifawnae8hvd0maeiikagiaemicaanaeiykakiaeyoei0iae8hvd0maeiikagiaemycaenaeiykakiaeiifawnaeiifaw3aasbaasqaaiabikdayaqabaaakeaacqgg8bafcqgg8bafcqwgwbaccqghsislcqwgxbqccqgg8bafcqgg8bafdawgaawcbagaegomaidabeaaaagccawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaaa@5afc@

if distμ =  <dig>  the distances are preserved; if  <dig> - ε ≤ distμ ≤  <dig> + ε, we say that an ε-distortion level is introduced.

in  <cit>  we experimentally showed that random subspace projections used in  <cit>  may introduce large distortions into gene expression data, thus introducing bias into stability indices based on this kind of random projections. for these reasons we propose to apply randomized maps with guaranteed low distortions, according to the johnson-lindenstrauss  lemma  <cit> , that we restate in the following way: given a d-dimensional data set d = {p <dig>  p <dig> ...,pn} ⊂ ℝd and a distortion level ε, randomly choosing a d'-dimensional subspace s ⊂ ℝd, with d' = c logn/ε <dig>  where c is a suitable constant, with high probability  the random projection μ :ℝd → s verifies  <dig> - ε ≤ distμ ≤  <dig> + ε for all pi ≠ pj.

in practice, using randomized maps that obey the jl lemma, we may perturb the data introducing only bounded distortions, approximately preserving the metric structure of the original data  <cit> . note that the dimension of the projected subspace depends only on the cardinality of the original data and the desired ε-distortion, and not from the dimension d of the original space.

the embedding exhibited in  <cit>  consists in projections from ℝd in random d'-dimensional subspaces. similar results may be obtained by using simpler maps  <cit> , represented through random d' × d matrices r=1/d′
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqgh9aqpcqaixaqmcqggvawldagcaaqaaiqbdsgakzaafaaaleqaaogaeiikagiaemocai3aasbaasqaaiabdmgapjabdqgaqbqabagccqggpaqkaaa@3844@, where rij are random variables such that:

e =  <dig>  var = 1

strictly speaking, these are not projections, but for sake of simplicity, we call random projections even this kind of embeddings. examples of random projections are the following:

 <dig>  bernoulli random projections: represented by d' × d matrices r=1/d′
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqgh9aqpcqaixaqmcqggvawldagcaaqaaiqbdsgakzaafaaaleqaaogaeiikagiaemocai3aasbaasqaaiabdmgapjabdqgaqbqabagccqggpaqkaaa@3844@, where rij are uniformly chosen in {- <dig>  1}, such that prob = prob = 1/ <dig> . in this case the jl lemma holds with c ≃  <dig> 

 <dig>  achlioptas random projections  <cit> : represented by d' × d matrices p=1/d′
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqgh9aqpcqaixaqmcqggvawldagcaaqaaiqbdsgakzaafaaaleqaaogaeiikagiaemocai3aasbaasqaaiabdmgapjabdqgaqbqabagccqggpaqkaaa@3840@, where rij are chosen in {-3
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabiodazawcbeaaaaa@2dbb@,  <dig>  3
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabiodazawcbeaaaaa@2dbb@}, such that prob = 2/ <dig>  prob = prob = 1/ <dig>  in this case also we have e =  <dig> and var =  <dig> and the jl lemma holds.

 <dig>  normal random projections  <cit> : this jl lemma compliant randomized map is represented by a d' × d matrix r=1/d′
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqgh9aqpcqaixaqmcqggvawldagcaaqaaiqbdsgakzaafaaaleqaaogaeiikagiaemocai3aasbaasqaaiabdmgapjabdqgaqbqabagccqggpaqkaaa@3844@, where rij are distributed according to a gaussian with  <dig> mean and unit variance.

 <dig>  random subspace   <cit> : represented by d' × d matrices r=d/d'
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqgh9aqpdagcaaqaaiabdsgakjabc+caviabdsgakjabcecanawcbeaakiabcicaoiabdkhaynaabaaaleaacqwgpbqacqwgqbgaaeqaaogaeiykakcaaa@396f@, where rij are uniformly chosen with entries in { <dig>  1}, and with exactly one  <dig> per row and at most one  <dig> per column. unfortunately, rs does not satisfy the jl lemma.

using the above randomized maps , the jl lemma guarantees that, with high probability, the "compressed" examples of the data set represented by the matrix dr = rd have approximately the same distance  of the corresponding examples in the original space, represented by the columns of the matrix d, as long as d' ≥ c logn/ε <dig> 

we propose a general mosram  algorithmic scheme, that implements the above ideas about random projection with bounded distortions to generate a set of similarity indices of clusterings obtained by pairs of randomly projected data. the main difference with respect to the method proposed in  <cit>  is that by our approach we perturb the original data using a randomized mapping μ : ℝd → ℝd':

mosram algorithm
input:

   d : a dataset;

   kmax: max number of clusters;

   m : number of similarity measures;

   μ : a randomized map;

   c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@: a clustering algorithm;

   sim : a clustering similarity measure.

output:

   m: a bidimensional list of similarity measures for each k 

begin

   for k :=  <dig> to kmax

      for i :=  <dig> to m

      begin

         proja := μ

         projb := μ

         ca := c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@

         cb := c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@

         m := sim

   end

end.

the algorithm computes m similarity measures for each desired number of clusters k. every measure is achieved by applying sim to the clustering ca and cb, outputs of the clustering algorithm c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@, having as input k and the projected data proja and projb. these data are generated through randomized maps μ, with a desired distortion level ε. it is worth noting that we make no assumptions about the shape of the clusters, and in principle any clustering algorithm c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@, randomized map μ, and clustering similarity measure sim may be used .

stability indices based on the distribution of the similarity measures
using the similarity measures obtained through the mosram algorithm, we may compute stability indices to assess the reliability of clustering solutions.

more precisely, let c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@ be a clustering algorithm, ρ a random perturbation procedure  and sim a suitable similarity measure between two clusterings .

we may define the random variable sk,  <dig> ≤ sk ≤ 1:

sk = sim, c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfce=qaaa@3825@)     

where d <dig> = ρ and d <dig> = ρ are obtained through random and independent perturbations of the data set d; the intuitive idea is that if sk is concentrated close to  <dig>  the corresponding clustering is stable with respect to a given controlled perturbation and hence it is reliable.

let fk be the density function of sk and fk its cumulative distribution function. a parameter of concentration implicitly used in  <cit>  is the integral g of the cumulative distribution:

g=∫01fkds     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgnbwzcqggoaakcqwgrbwacqggpaqkcqgh9aqpdawdxaqaaiabdaeagnaabaaaleaacqwgrbwaaeqaaogaeiikagiaem4camnaeiykakiaemizaqmaem4camhaleaacqaiwaamaeaacqaixaqma0gaey4kiipakiaaxmaacawljawaaewaaeaacqaizawmaiaawicacaglpaaaaaa@4277@

note that if sk is centered in  <dig>  g is close to  <dig>  and hence it can be used as a measure of stability. moreover, the following facts show that g is strictly related to both the expectation e and the variance var of the random variable sk:

fact 1
e =  <dig> - g.

indeed, integrating by parts:

e=∫01sfkds=∫01sf′kds=1−∫01fkds=1−g     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrcqggbbwwcqwgtbwudawgaawcbagaem4aasgabeaakiabc2fadjabg2da9maapedabagaem4camnaemozay2aasbaasqaaiabdugarbqabagccqggoaakcqwgzbwccqggpaqkcqwgkbazcqwgzbwccqgh9aqpdawdxaqaaiabdohazjqbdaeagzaafawaasbaasqaaiabdugarbqabagccqggoaakcqwgzbwccqggpaqkcqwgkbazcqwgzbwccqgh9aqpcqaixaqmcqghsisldawdxaqaaiabdaeagnaabaaaleaacqwgrbwaaeqaaogaeiikagiaem4camnaeiykakiaemizaqmaem4camnaeyypa0jaegymaejaeyoei0iaem4zacmaeiikagiaem4aasmaeiykakcaleaacqaiwaamaeaacqaixaqma0gaey4kiipaasqaaiabicdawaqaaiabigdaxaqdcqghrii8aawcbagaegimaadabagaegymaedaniabguiiydgccawljagaaczcamaabmaabagaeginaqdacagloagaayzkaaaaaa@6bea@

fact 2
var ≤ g.

since  <dig> ≤ sk ≤  <dig> it follows sk2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwudaqhaawcbagaem4aasgabagaegomaidaaaaa@3059@ ≤ sk; therefore, using fact 1:

var = e[sk2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwudaqhaawcbagaem4aasgabagaegomaidaaaaa@3059@] - e <dig> ≤ e - e <dig> = g)     

in conclusion, g ≃  <dig> then e ≃  <dig> and var =  <dig>  i.e. sk is centered close to  <dig>  as a consequence, e can be used as an index of the reliability of the k-clustering: if e ≃  <dig>  the clustering is stable, if e ≪  <dig> the clustering can be considered less reliable.

we can estimate e by means of m similarity measures m computed by the mosram algorithm. in fact e may be estimated by the empirical mean ξk:

ξk=∑i=1mmm     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf+oaedawgaawcbagaem4aasgabeaakiabg2da9maaqahabawaasaaaeaacqwgnbqtcqggoaakcqwgpbqacqggsaalcqwgrbwacqggpaqkaeaacqwgtbqbaaaaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgtbqba0gaeyyeiuoakiaaxmaacawljawaaewaaeaacqai2agnaiaawicacaglpaaaaaa@43ba@

a χ2-based test for the assessment of the significance of the solutions
in this section we propose a method for automatically finding the " optimal" number of clusters and to detect significant and possibly multi-level structures simultaneously present in the data. first of all, let us consider the vector   computed by using the output of the mosram algorithm. we may perform a sorting of this vector:

→sort,ξp,...,ξp)     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqggoaakiigacqwf+oaedawgaawcbagaegomaidabeaakiabcycasiab=57a4naabaaaleaacqaizawmaeqaaogaeiilawiaeiola4iaeiola4iaeiola4iaeiilawiae8nvdg3aasbaasqaaiabdieaijabgucariabigdaxaqabagccqggpaqkdagdkawcbagaem4camnaem4ba8maemocainaemidaqhabegccaglsgcacqggoaakcqwf+oaedawgaawcbagaemicaanaeiikagiaegymaejaeiykakcabeaakiabcycasiab=57a4naabaaaleaacqwgwbaccqggoaakcqaiyagmcqggpaqkaeqaaogaeiilawiaeiola4iaeiola4iaeiola4iaeiilawiae8nvdg3aasbaasqaaiabdchawjabcicaoiabdieaijabcmcapaqabagccqggpaqkcawljagaaczcamaabmaabagaeg4nacdacagloagaayzkaaaaaa@629e@

where p is the permutation index such that ξp ≥ ξp ≥ ... ≥ ξ. roughly speaking, this ordering represents the "most reliable" p-clustering down to the least reliable p-clustering; exploiting this we would establish which are the significant clusterings  discovered in the data.

to this end, for each k ∈ k
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfke=saaa@3835@ = { <dig>   <dig> ...,h + 1}, let us consider the random variable sk defined in eq.  <dig>  whose expectation is our proposed stability index. for all k and for a fixed threshold to ∈  <cit>  consider the bernoulli random variable bk = i, where i is the indicator function: i =  <dig> if p is true, i =  <dig> if p is false. the sum xk=∑j=1mbkj
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgybawdawgaawcbagaem4aasgabeaakiabg2da9maaqadabagaemoqai0aa0baasqaaiabdugarbqaaiabdqgaqbaaaeaacqwgqbgacqgh9aqpcqaixaqmaeaacqwgtbqba0gaeyyeiuoaaaa@3b23@ of i.i.d. copies of bk is distributed according to a binomial distribution with parameters m and θk = prob).

if we hypothesize that all the binomial populations are independently drawn from the same distribution , for sufficiently large values of m the random variables xk−mθkmθk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdifaynaabaaaleaacqwgrbwaaeqaaogaeyoei0iaemyba0gccigae8hude3aasbaasqaaiabdugarbqabaaakeaadagcaaqaaiabd2gatjab=h7axnaabaaaleaacqwgrbwaaeqaaogaeiikagiaegymaejaeyoei0iae8hude3aasbaasqaaiabdugarbqabagccqggpaqkasqabaaaaaaa@40c5@ are independent and approximately normally distributed. consider now the random variable:

∑k∈k2mθwithθ^=∑k∈kxk|k|⋅m     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqadaaabawaaabuaeaadawcaaqaaiabcicaoiabdifaynaabaaaleaacqwgrbwaaeqaaogaeyoei0iaemyba0gccigaf8hudenbakaacqggpaqkdaahaawcbeqaaiabikdayaaaaoqaaiabd2gatjab=h7axjabcicaoiabigdaxiabgkhitiab=h7axjabcmcapaaaasqaaiabdugarjabgigioprthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnagabaiab+pq8lbqab0gaeyyeiuoaaoqaaiabbeha3jabbmgapjabbsha0jabbigaobqaaiqb=h7axzaajaaaaiabg2da9maalaaabawaaabeaeaacqwgybawdawgaawcbagaem4aasgabeaaaeaacqwgrbwacqghiiizcqgfke=saeqaniabgghildaakeaacqgg8bafcqgfke=scqgg8bafcqghfly1cqwgtbqbaagaaczcaiaaxmaadaqadaqaaiabiida4agaayjkaiaawmcaaaaa@6d7c@

this variable is known to be distributed as a χ <dig> with |k
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfke=saaa@3835@| -  <dig> degrees of freedom, informally because the constraint θ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf4oqcgaqcaaaa@2e79@ between the random variables xk, k ∈ k
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfke=saaa@3835@ introduces a dependence between them, thus leading to a loss of one degree of freedom. by estimating the variance mθ, with the statistic m θ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf4oqcgaqcaaaa@2e79@, we conclude that the following statistic

y=∑k∈k2mθ^~χ|k|−12     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbqwcqgh9aqpdaaeqbqaamaalaaabagaeiikagiaemiwag1aasbaasqaaiabdugarbqabagccqghsislcqwgtbqbiigacuwf4oqcgaqcaiabcmcapmaacaaaleqabagaegomaidaaagcbagaemyba0maf8hudenbakaacqggoaakcqaixaqmcqghsislcuwf4oqcgaqcaiabcmcapaaacqgg+bgfcqwfhpwydaqhaawcbagaeiifaw3enfgdovwbhrxajfwnhbqeg0uy0hwztfgdpnwy1aaceagae4ncxvkaeiifawnaeyoei0iaegymaedabagaegomaidaaaqaaiabdugarjabgigiolab+pq8lbqab0gaeyyeiuoakiaaxmaacawljawaaewaaeaacqai5aqoaiaawicacaglpaaaaaa@608c@

is approximately distributed according to χ|k|−12
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfhpwydaqhaawcbagaeiifaw3enfgdovwbhrxajfwnhbqeg0uy0hwztfgdpnwy1aaceagae4ncxvkaeiifawnaeyoei0iaegymaedabagaegomaidaaaaa@3fed@ .

a realization xk of the random variable xk  can be computed by using the output of the mosram algorithm:

xk=∑i=1mi>to)     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg4baedawgaawcbagaem4aasgabeaakiabg2da9maaqahabagaemysakkaeiikagiaemyta0kaeiikagiaemyaakmaeiilawiaem4aasmaeiykakiaeyopa4jaemidaq3aawbaasqabeaacqwgvbwbaagccqggpaqkasqaaiabdmgapjabg2da9iabigdaxaqaaiabd2gatbqdcqghris5aogaaczcaiaaxmaadaqadaqaaiabigdaxiabicdawagaayjkaiaawmcaaaaa@49be@

using y, we can test the following alternative hypotheses:

• ho: all the θk are equal to θ

• ha: the θk are not all equal between them 

if y≥χα,|k|−12
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqecqghljysiigacqwfhpwydaqhaawcbagae8xsdemaeiilawiaeiifaw3enfgdovwbhrxajfwnhbqeg0uy0hwztfgdpnwy1aaceagae4ncxvkaeiifawnaeyoei0iaegymaedabagaegomaidaaaaa@45a8@ we may reject the null hypothesis at α significance level, that is we may conclude that with probability  <dig> - α the considered proportions are different, and hence that at least one k-clustering significantly differs from the others.

using the above statistical test, we propose an iterative procedure to detect the significant number of clusterings:

 <dig>  consider the ordered vector ξ = , ξp,...,ξp)

 <dig>  repeat the χ2-based test until no significant difference is detected or the only remaining clustering is p. at each iteration, if a significant difference is detected, remove the bottom-ranked clustering from ξ

the output of the proposed procedure is the set of the remaining  k-clusterings that correspond to the set of the estimate stable number of clusters . equivalently, following the sorting of ξ, we may compute the p-value  for all the ordered groups of clusterings from the p...p to the the p, p group, each time removing the bottom ranked clustering from the ξ vector. note that if the set of the remaining top-ranked clusterings contains more than one clustering, we may find multiple structures simultaneously present in the data .

RESULTS
we present experiments with synthetic and gene expression data to show the effectiveness of our approach. at first, using synthetic data, we show that our proposed methods can detect not only the "correct" number of clusters, but also multiple structures underlying the data. then we apply our mosram algorithm to discover the " natural" number of clusters in gene expression data, and we compare the results with other algorithms for model order selection. in our experiments we used the classical k-means  <cit>  and prediction around medoid   <cit>  clustering algorithms, and we applied the bernoulli, achlioptas and normal random projections, but in this section we show only the results obtained with bernoulli projections, since with the other randomized maps we achieved the same results without any significant difference. in all our experiments we set the threshold to  with relatively low cardinality , characterized by a two-level hierarchical structure, highlighted by the projection of the data into the two main principal components : indeed a two-level structure, with respectively  <dig> and  <dig> clusters is self-evident in the data.

two clusterings  are detected at 10- <dig> significance level by applying our mosram algorithm and the proposed χ2-based statistical procedure. in particular we performed  <dig> pairs of bernoulli projections with a distortion bounded to  <dig>  , yielding to random projections from  <dig> to 479-dimensional subspaces. indeed table  <dig> reports the sorted means of the stability measures together with their variance and the corresponding p-values computed according to the proposed χ2-based statistical test, showing that  <dig> and 6-clusterings are the best scored, as well as the most significant k-clusterings discovered in the data. this situation is depicted in figure  <dig>  where the histograms of the similarity measures for k =  <dig> and k =  <dig> clusters are tightly concentrated near  <dig>  showing that these clusterings are very stable, while for other values of k the similarity measures are spread across multiple values. note that the p-values of table  <dig>  refer to the probability of committing an error if we reject the null hypothesis. the clusterings with p ≥ α are considered equally reliable , while the clusterings for which p <α are considered less reliable .

experiments with dna microarray data
to show the effectiveness of our methods with gene expression data we applied mosram and the proposed statistical test to leukemia  <cit>  and lymphoma  <cit>  samples. these data sets have been analyzed with other model order selection algorithms previously proposed  <cit> : at the end of this section we compare the results obtained with the cited methods with our proposed mosram algorithm.

leukemia
this well known data set  <cit>  is composed by  <dig> leukemia samples analyzed with oligonucleotide affymetrix microarrays. the leukemia data set is composed by a group of  <dig> acute myeloid leukemia  samples and another group of  <dig> acute lymphoblastic leukemia  samples, that can be subdivided into  <dig> b-cell and  <dig> t-cell subgroups, resulting in a two-level hierarchical structure. we applied the same pre-processing steps performed by the authors of the leukemia study  <cit> , obtaining  <dig> genes from the original  <dig> gene expression values. we further selected the  <dig> genes with the highest variance across samples, since low variance genes are unlikely to be informative for the purpose of clustering  <cit> . we analyzed both the 3571-dimensional data and the data restricted to the  <dig> genes with highest variance, using respectively bernoulli projections with ε ∈ { <dig> ,  <dig> ,  <dig> ,  <dig> } and projections to 80-dimensional subspaces. in both cases the k-means clustering algorithm has been applied.

lymphoma
three different lymphoid malignancies are represented in the lymphoma gene expression data set  <cit> : diffuse large b-cell lymphoma , follicular lymphoma  and chronic lymphocytic leukemia . the gene expression measurements are obtained with a cdna microarray specialized for genes related to lymphoid diseases, the lymphochip, which provides expression levels for  <dig> genes  <cit> . the  <dig> available samples are subdivided in  <dig> dlbcl,  <dig> cll and  <dig> fl. we performed pre-processing of the data according to  <cit> , replacing missing values with  <dig> and then normalizing the data to zero mean and unit variance across genes. as a final step, according to  <cit> , we further selected the  <dig> genes with highest variance across samples, obtaining a resulting data set with  <dig> samples and  <dig> genes. as in the previous experiment, we processed both the high-dimensional original data and the data with the reduced set of high-variance genes, using respectively bernoulli projections with ε ∈ { <dig> ,  <dig> ,  <dig> ,  <dig> } and projections to 160-dimensional subspaces. the k-means clustering algorithm has been applied.

the results with highest variance genes are summarized in figure  <dig> and table  <dig>  the statistical test identifies as significant only the 2-clustering. indeed, looking at the ecdf of the stability index values , the 2-clustering  is clearly separated from the others. the  <dig>  and 4-clustering  graphs, are quite distinct from the others, as shown also by the corresponding empirical mean of the stability index values , but they are also clearly separated from the 2-clustering curve. accordingly, our proposed χ2-based test found a significant difference between the 2-clustering and all the others. similar results are obtained also with hierarchical clustering and pam algorithms. using all the  <dig> genes and bernoulli random projections to 413-dimensional  subspaces with the ward's hierarchical clustering algorithm our method finds as significant the 3-clustering as well as the 2-clustering. in this case also similar results are obtained with ε =  <dig>  and ε =  <dig> . it is worth noting that the subdivision of lymphoma samples in  <dig> classes  have been defined on histopathological and morphological basis and it has been shown that this classification does not correspond to the bio-molecular characteristics and to clinical outcome classes of non hodgkin lymphomas. in particular studies based on the gene expression signatures of the dlbcl patients  <cit>  and on their supervised analysis  <cit> , showed the existence of two subclasses of dlbcls. moreover shipp et al.  <cit>  highlighted that fl patients frequently evolve over time and acquire the clinical features of dlbcls, and lange et al.  <cit>  found that a 3-clustering solution groups together fl, cll and a subgroup of dlbcls, while another subgroup of dlbcls sets up another cluster, even if the overall stability of the clustering is lower with respect to the 2-clustering solution. the relationships between fl and subgroups of dlbcl patients are confirmed also by recent studies on the individual stability of the clusters in dlbcl and fl patients  <cit> . these considerations show also that the stability analysis of patients clusters in dna microarray analysis are only the first step to discover significant subclasses of pathologies at bio-molecular level, while another necessary step is represented by the bio-medical validation.

comparison with other methods
we compared the results obtained by the mosram algorithm with other model order selection methods using the leukemia and lymphoma data sets analyzed in the previous section. in particular we focused our comparison with other state-of-the-art stability-based methods proposed in the literature.

the model explorer algorithm adopts subsampling techniques to perturb the data  and applies stability measures based on the empirical distribution of the stability measures  <cit> . this approach is quite similar to ours but we applied random projections to perturb the data and a statistical test to identify significant numbers of clusters, instead of simply qualitatively looking at the distributions of the stability indices. the figure of merit measure is based on a resampling approach too, but the stability of the solutions is assessed directly comparing the solution obtained on the full sample with that obtained on the subsamples  <cit> . we considered also stability-based methods that apply supervised algorithms to assess the quality of the discovered clusterings instead of comparing pairs of perturbed clusterings  <cit> : the main differences between these last approaches are the choice of the supervised predictor and other parameters . finally we considered also a non-stability-based method, the gap statistic, that applies an estimates of the gap between the total sum within-class dissimilarities and a null reference distribution  to assess the "optimal" number of clusters in the data.

these results show that our proposed methods based on randomized maps are well-suited to the characteristics of dna microarray data: indeed the low cardinality of the examples, the very large number of features  involved in microarray chips, the redundancy of information stored in the spots of microarrays are all characteristics in favour of our approach. on the contrary using bootstrapping techniques to obtain smaller samples from just small samples of patients should induce more randomness in the estimate of cluster stability. a resampling based approach appears to be better suited to evaluate the cluster stability of genes, since significantly larger samples are available in this case  <cit> . the alternative based on noise injection into the data to obtain multiple instance of perturbed data poses difficult statistical problems for evaluating what kind and which magnitude of noise should be added to the data  <cit> .

all the perturbation-based methods need to properly select a parameter to control the amount of perturbation of the data: resampled-based methods need to select the "optimal" fraction of the data to be subsampled; noise-injection-based methods needs to choice the amount of noise to be introduced; random subspace and random projections-based methods needs to select the proper dimension of the projected data. anyway, our approach provides a theoretically motivated method to automatically find an "optimal" value for the perturbation parameter, and in our experiments we observed that values of ε ≤  <dig>  led to reliable results. moreover our proposed approach provides also a statistical test that may be applied also with other stability-based methods to assess the significance of the discovered solutions.

despite of the convincing experimental results obtained with stability-based methods there are some drawbacks and open problems associated with these techniques. indeed, as shown by  <cit> , a given clustering may converge to a suboptimal solution owing to the shape of the data manifold and not to the real structure of the data, thus introducing bias in the stability indices. moreover in  <cit>  it has been shown that stability based methods based on resampling techniques, when cost-based clustering algorithms are used, may fail to detect the correct number of clusters, if the data are not symmetric. however it is unclear if these results may be extended to other stability-based methods  or to other more general classes of clustering algorithms.

CONCLUSIONS
we proposed a stability-based method, based on random projections, for assessing the validity of clusterings discovered in high-dimensional post-genomic data. the reliability of the discovered k-clusterings may be estimated exploiting the distribution of the clustering pairwise similarities, and a χ2-based statistical test tailored to unsupervised model order selection. in the theoretical framework of randomized maps that satisfy the jl lemma, a principled approach to select the dimension of the projected data, and to approximately preserve the structure of the original data is given, thus yielding to the design of reliable stability indices for model order selection in bio-molecular data clusterings.

the χ2-based statistical test may be applied to any stability method that make use of the distribution of the similarity measures between pairs of clusterings.

our experimental results with synthetic data and real gene expression data show that our proposed method is able to find significant structures, comprising multiple structures simultaneously present into bio-molecular data.

as an outgoing development, considering that the χ2-based test assumes that the random variables representing distributions for different number of clusters are normally distributed, we are developing a new distribution-independent approach based on the bernstein inequality to assess the significance of the discovered k-clusterings.

authors' contributions
the authors equally contributed to this paper.

