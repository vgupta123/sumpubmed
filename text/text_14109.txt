BACKGROUND
complex traits of economic importance in animal and plant breeding seem to be affected by many quantitative trait loci , each having a small effect, and are greatly influenced by the environment. predicting these complex traits using information from dense molecular markers exploits linkage disequilibrium  between molecular markers and qtl. basically, genomic selection works by capturing realized relationships between individuals and, to an extent, by capturing the effects of qtl via their linkage or ld with markers. genomic selection  regression models use all available molecular marker and phenotypic data from an observed base  to predict the genetic values of yet unphenotyped candidates for selection  whose marker genotypes are known.

there is a vast literature describing statistical methods that use different functional forms on markers for predicting genetic values, e.g.,  <cit> , starting with the seminal work of  <cit> , which proposed regressing phenotypes on all available markers using a gaussian linear model with different prior distributions on marker effects. several parametric and semi-parametric methods have been described and used thereafter for genome-enabled prediction in animals and plants .

the basic quantitative genetic model yi = gi + γi  describes the ith response or phenotype  expressed as a deviation from some general mean  as the sum of an unknown genetic value  plus a model residual γi. the unknown genetic value can be represented as a complex function of genotypes with a large number of genes. however, since the genes affecting a trait are unknown, this complex function can be approximated by a regression of phenotype on marker genotypes where a large number of markers {xi <dig>  …, xip}  may be used as regressors for predicting the genetic value of the ith individual. thus, for u = u, the basic model becomes yi = ui + γi, where γi includes errors due to unspecified environmental effects, imperfect linkage disequilibrium between markers and the qtl affecting the trait, and unaccounted gene × gene and gene × environment interactions.

in several applications, u is a parametric linear regression with form u = ∑j = 1p 
xijβj,, where βj is the substitution effect of the allele coded as ‘one’ at the jth marker. the linear regression function becomes yi = ∑j = 1p 
xijβj + γi. the regression function u can also be represented by semi-parametric models, such as reproducing kernel hilbert space  regressions or by different types of neural networks  such as the multilayer perceptron or radial basis functions . several penalized linear regression models and bayesian shrinkage estimation methods have been applied to genome-enabled prediction  <cit> . similarly, regularized machine learning has been used for predicting complex traits  <cit> . recently, two-layer feed-forward nn with backpropagation were implemented in various forms using german fleckvieh and holstein-friesian bull data and high prediction accuracies were achieved  <cit> . likewise, a multi-layer nn classifier was applied to study genetic diversity in simulated experiments  <cit> .

nonparametric classification models are a branch of supervised machine learning that has been successfully applied in several fields of knowledge, e.g., text mining, bioinformatics and genomics  <cit> . particularly in applied genomic breeding programs and depending on the trait under consideration, the objective of classification is to focus on candidates for selection contained in the upper or lower classes of the prediction space. a common classification problem arises when an input marker vector xi ∈ ℝp is to be assigned to one of s classes by a classifier. the classifier is trained using a set of training pairs , , where ci describes the class label  to which xi belongs, , where s represents the number of classes. usually, ci is transformed into a vector ci of dimension s ×  <dig>  with  <dig> in class k and  <dig> otherwise.

the multi-layer perceptron  classifier is a typical architecture of feed-forward nn with at least a hidden layer and an output layer, where both layers have nonlinear and differentiable transfer functions. the nonlinear transfer function in the hidden layer enables an nn to act as a universal approximation method. the training process of an mlp for each individual i, with input vector xi and target class ci, typically uses the error backpropagation learning algorithm  <cit> . this process requires a lot of computational time when the number of input variables is large.

the probabilistic neural network  was proposed by  <cit>  and is widely used in pattern recognition and classification. pnn classifies an input vector xi into a specific k class such that the specific class has the maximum probability of being a correct assignment. pnn provides an optimum pattern classifier that minimizes the expected risk of wrongly classifying an object, and is a very efficient  classification method. the pnn training algorithm is simpler and faster than that of the mlp approach because pnn parameters are estimated directly from the input data and an iterative procedure is not required. further, pnn guarantees convergence to a bayes classifier if enough training examples are provided  <cit> . several classification methods such as support vector machines and random forests have been applied in gs . however, despite the apparent advantages of pnn, no pnn classifiers have been applied in gs so far.

the objective of this research was to assess the performance of two nn classifiers, mlp and pnn , to select individuals belonging to a specific class of interest . in an applied gs context, the problem should be formulated according to whether the focus is on selecting individuals into the upper, middle or lower classes, depending on the trait under selection. then the question is how many of the predicted individuals classified in the target class are actually observed in that class. the problem is posed as follows: given an input vector xi of p markers for the ith individual, each individual i in the testing set must be classified in a class of interest of the phenotypic response. classes were defined considering different percentiles of the target trait, specifically,  <dig> and 30 % for the upper and lower classes were analyzed.

methods
this section has four parts: first the two datasets are described; second, the strategy for categorizing the datasets is explained; third, the multilayer perceptron neural network  and probabilistic neural network  are described, and finally, the criteria used to assess model accuracy for classifying the best individuals based on genomic information are described.

maize datasets
the maize datasets include  <dig> trait-environment combinations measured on  <dig> tropical lines genotyped with  <dig>  snps each; these datasets were previously used by  <cit> . four datasets contain information on the complex trait grain yield  evaluated under severe drought stress  and well-watered conditions , and in high yielding  and low yielding  environments. another six datasets include information on days to anthesis or male flowering , on days to silking or female flowering , and the mfl to ffl interval  evaluated under severe drought stress  and well-watered  environments. the remaining six datasets contain information on gray leaf spot  resistance evaluated in six cimmyt international trials . the number of individuals and the type and number of markers are presented in table 1; for further details, see  <cit> .table  <dig> maize datasets – three classes

trait–environment combination, number of markers, total number of individuals, number of individuals in the upper  <dig> and 30 % classes, in the middle  <dig> and 70 % classes, and in the lower  <dig> and 30 % classes from the empirical cumulative distribution function



wheat datasets
these datasets include  <dig> wheat lines from the cimmyt global wheat program  that were genotyped with  <dig> diversity array technology  markers generated by triticarte pty. ltd. , which is a whole-genome profiling service laboratory. two traits were analyzed, grain yield  and days to heading , which were evaluated in different environments . gy was measured in seven environments and dth in ten environments. the number of individuals and the type and number of markers are presented in table 2; for further details, see  <cit> .table  <dig> wheat datasets – three classes

environment code of  <dig> combinations of sites in mexico, agronomic management, and year for two wheat traits  from  <cit> . number of markers, total number of individuals, number of individuals in the upper  <dig> and 30 % classes, in the middle  <dig> and 70 % classes, and in the lower  <dig> and 30 % classes from the empirical cumulative distribution



transforming phenotypic responses into three or two classes
the continuous phenotypic responses yi for each stratified random partition in the datasets were grouped into three classes , based on 15–85 % and 30–70 % percentiles of the response of each trait analyzed. for example, for 15–85 % percentiles, the quantiles q <dig>  and q <dig>  were used to split yi into three classes: yi ∈ upper class, if yi > q <dig> ; yi ∈ middle class, if q <dig>  < yi ≤ q <dig> ; and, yi ∈ lower class; if yi ≤ q <dig>  a similar rule was applied to split yi into three classes with 30-70 % percentiles.

for the two species, the target classes were the upper  <dig> and 30 % classes ; the middle  <dig> and 70 % classes , and the lower  <dig> and 30 % classes .

comparison of prediction accuracy of pnn based on two or three classes was performed only on the wheat datasets to simplify computations. firstly, the phenotypic responses yi for each stratified random partition of the wheat datasets were grouped into two classes from the datasets previously grouped into three classes. the upper 15 % of the binary class was defined by using the upper 15 % of the trichotomous classes, and the lower class was the sum of the middle and lower classes of the trichotomous classes; a similar strategy was applied for the lower 15 % of the binary class. the same random partitions  were used when comparing pnn with two classes versus pnn with three classes. partitions of the wheat datasets into two classes for gy and dth are shown in table  <dig> table  <dig> wheat datasets – two classes

environment code of  <dig> combinations of sites in mexico, agronomic management, and year for two wheat traits  from  <cit> . number of markers, total number of individuals, number of individuals in the upper  <dig> and 30 % classes, and in the lower  <dig> and 70 % classes



multilayer perceptron neural network  classifier
an mlp can be trained to classify items into s different disjoint classes. each target class ci is transformed into a target vector ci of zeroes except for a  <dig> in element k,  the class to be represented. we arranged a set of n input vectors xi into a matrix x of dimension n × p. then we arranged the n target vectors ci into a matrix c of dimension s × n. the rows of x correspond to columns of c, individual-by-individual. statistical learning is inferred from the data only, with no assumption about the joint distribution of inputs and outcomes. this gives mlp great flexibility for capturing complex patterns frequently found in plant breeding  <cit> .

we begin by describing a standard mlp for a categorical response . mlp is an nn that can be thought of as a two-stage regression . in the first stage , m data-derived basis functions, {zm}m = 1m = m are inferred; in the second stage , each neuron’s output is computed on the basis functions inferred in the hidden layer using a nonlinear transfer function .fig.  <dig> architecture of classifier mlp with the input  layer, hidden layer, and sum-output layer



in the hidden layer, one data-derived predictor is inferred at each of m neurons. these data-derived predictors are computed by first inferring a score , which is a linear combination of the input weights and the input markers plus a bias  term. subsequently, this score is transformed using a nonlinear transfer function, φ, that is, zmi = φ, where wmo is the bias term, and wm = {wmj}m = 1; j = 1m = m; j = p is an input weight matrix. the transfer function maps from a score defined in the real line onto the interval   = vki = wko + ∑m = 1mwmi, where φk and φk is the tansig transfer function, k =  <dig>  …, s. finally, the predicted score vector ĉi = {yki}k = 1k = s, and the predicted class ĉi is ĉ = arg max1 ≤ k ≤ s are obtained.

training of an mlp  involves estimating all of the classifier’s parameters by means of an iterative backpropagation error algorithm, based on the scaled conjugate gradient algorithm described by  <cit> . to improve the generalization capacity of mlp, an early stopping ensemble strategy can be applied  <cit> ; early stopping effects non-bayesian shrinkage of coefficients. in this approach, we divided the available data into three subsets. the first subset is the training set, used for computing the gradient and updating network weights and biases. the second subset is the validation set, where the error in the set is monitored during the training process. the validation error normally decreases during the initial training phase, as does the training set error. however, when the network begins to over-fit the data, the error in the validation set typically begins to rise. when the validation error increases at some point in the iteration, the training is stopped, and the weights and biases at the minimum validation error are returned. the third subset is used as testing set.

the performance function to optimize an mlp is usually the mean squared error , which is the average squared error between the predicted classes Ĉ and the target classes c. Ĉ is also a matrix of dimension s × n, where each column contains values in the  <cit>  range. the index of the largest element in the column indicates which of the s classes that vector represents.

probabilistic neural network  classifier
the architecture of a pnn is similar to that of a radial basis function nn  <cit> ; a pnn has two layers, the pattern layer and the summation-output layer, as illustrated in fig.  <dig>  the pattern layer computes distances ) between the input vector xi and the training  input vectors cm ∈ ℝp; m =  <dig>  …, m neurons  and returns an output vector ui ∈ ℝm whose elements umi = bm‖xi − cm‖, where bm=−in <dig> h is a weight and h is the width of the gaussian rbf, indicating how close the input vector xi is to cm  <cit> . then each umi is transformed into a vector zi ∈ ℝm, whose elements are defined by the gaussian operation zmi = exp. the summation-output layer sums these contributions for each class k, that is, vki = ∑m = 1mwkmzmi, where wkm are weights obtained from the target classes c matrix, to generate a vector of probabilities ĉi = softmax of dimension s ×  <dig> as its net output, where the softmax transfer function σ is given byfig.  <dig> architecture of classifier pnn with the input  layer, pattern layer, and sum-output layer

 σvi=expvk∑j=1sexpvj;fork= <dig> …,sclasses 

where vi is a target vector of dimension s ×  <dig> with elements vk. the softmax transfer function on the summation-output layer transforms the outputs of processing units for each k class in the interval  <cit> .

the pattern layer of a pnn is a neural representation of a bayes classifier, where the class density functions are approximated using a windows parzen estimator  <cit> . the standard training method for a pnn  requires a single pass over all the xi markers of the training set. for this reason, pnn requires short training time and produce as output , posterior probabilities of class membership.

criteria for assessing classifier prediction accuracy
the prediction accuracy of mlp and pnn was evaluated using a cross-validation procedure. for each data set,  <dig> random partitions stratified by classes were generated. each partition randomly assigned 90 % of the data to the training set and the remaining 10 % to the testing set. we used stratified sampling by class to make sure there were no empty classes in the training and testing sets. for each data set, partition index matrices pindx were generated, where n is the number of individuals in each data set analyzed; pindx has a value equal to  <dig>  or  <dig>  for the ith individual in the jth partition. each model was trained and evaluated with the same pair of training and testing sets of each partition. for mlp the training sets defined in pindx were subdivided by stratified random sampling by class into two disjoint sets, one for training  and another for validation ; this was done with the objective of applying the training early stopping ensemble strategy <cit> . for each random partition, ten replications  were used to evaluate the performance of mlp.

two performance measures for assessing prediction accuracy of the two classifiers  were used:  the area under the receiver operating characteristic curve , and  the area under the precision-recall curve , or average precision.

for gy in both species, models were trained to maximize the auc of the upper class; for fl, gls, and dth, models were trained to maximize the auc of the lower class; for asi, the target value is zero , models were trained to maximize the auc of the middle class.

the area under the receiver operating characteristic curve 
rather than computing the recall   and the false positive rate  for a fixed threshold τ, a set of thresholds was defined and then tpr vs fpr was plotted as an implicit function of τ; this is called an roc curve.

the recall or sensitivity is r=tptp+fn, where tp is the number of positives predicted as positives and fn is the number of positives predicted as negatives. this measure evaluates the number of individuals that are correctly classified as a proportion of all the observed individuals in the target class. fpr=fpfp+tn, where fp is the number of negatives predicted as positives and tn is the number of negatives predicted as negatives .table  <dig> description of a confusion matrix for binary classes with observed values and classifier predicted values

tp
tp + fn
tn
fp + tn
tp + fp
fn + tn
n

tp true positive, fp false positive, fn false negative, tn true negative, n total number of individuals



to compare the performance of classifiers, the receiver operating characteristic curve  has to be reduced to a single scalar value representing the expected performance. a common method is to compute the area under the roc curve , which produces a value between  <dig> and  <dig>  if auc > auc, then classifier a has a better average performance than classifier b. auc can be interpreted as the probability that a randomly chosen individual is ranked as more likely to be of the target class than a randomly chosen individual of another class. the roc graphs are a useful tool for visualizing the performance of the classifiers because they provide a richer measure of classification performance than other scalar measures  <cit> .

the area under the precision-recall curve 
a precision-recall curve is a plot of precision  vs r for a set of thresholds τ. p=tptp+fp is defined as the fraction of positives predicted as positives with respect to all predicted positives . thus p measures the fraction of the predicted positives that is really positive, while r measures the fraction of the predictive positives that was in fact detected. this curve is summarized as a single number using the average precision , which approximates the area under the precision-recall curve  <cit> . this measure is recommended for classes of different sizes; upper or lower classes of 15 % had a lower number of individuals than the corresponding upper or lower classes of 85 %. auc is commonly used to present results of binary decision problems in machine learning algorithms. however, when dealing with unbalanced classes, aucpr curves give a more informative idea of a machine learning algorithm than auc  <cit> .

software
scripts for fitting models and performing cross-validations were written in matlab r2010b. all the analyses were performed in a linux workstation.

RESULTS
results of the value of auc for classifiers mlp and pnn in each trait-environment combination are depicted in histograms in fig. 3a–d  and fig. 4a–b  for the traits selected in the upper and lower  and middle  classes, respectively.fig.  <dig> histograms of the auc criterion and their standard deviation  for the maize datasets. a grain yield  under optimal conditions  and stress conditions  of classifiers mlp and pnn in the upper  <dig> and 30 % classes; b anthesis-silking interval  under optimal conditions  and drought stress conditions  of mlp and pnn of the middle  <dig> and 70 % classes; c female flowering time , male flowering time  under optimal well-watered  conditions and drought stress conditions  of mlp and pnn of the lower  <dig> and 30 % classes; d gray leaf spot resistance  in  <dig> environments  of mlp and pnn of the lower  <dig> and 30 % classes

fig.  <dig> histograms of the auc criterion and their standard deviation  for the wheat datasets. a grain yield  in seven environments  of classifiers mlp and pnn of the upper  <dig> and 30 % classes; b days to heading  in ten environments  of mlp and pnn in the lower  <dig> and 30 % classes



the first clear trend using the auc criterion is that pnn outperformed mlp for most of the individuals in the upper, middle and lower classes. depending on the trait-environment combination, the pnn30% or pnn15% upper and lower and the pnn40% and pnn70% middle were usually larger than those of mlp; the only exception was pnn15% for gy-ss , which was lower than mlp15% .

we also describe auc and aucpr results of comparing the performance of pnn for wheat trait-environment combinations using two or three classes.

comparing classifiers to select individuals in the upper, middle and lower classes in the maize datasets
upper classes 
results of the prediction accuracy criterion auc of the two classifiers mlp and pnn for traits selected in the  <dig> and 30 % upper classes for gy under the different environmental conditions are reported in fig. 3a. pnn was more accurate than mlp in the upper 30 % class, for assigning individuals based on gy under stress conditions. additional file 1: table s <dig> shows the results based on the auc criterion for the upper, middle and lower classes.

when using the aucpr criterion, which relates p and r for the upper class, pnn outperformed mlp, which is clearly shown in table  <dig> . also, aucpr for pnn30% was always better than pnn15% for all the traits in the upper class. these results lead to the conclusion that pnn was more accurate than mlp for assigning maize lines to the correct upper class for gy under ww and ss conditions. also under the auc criterion, pnn30% was similar to pnn15% for gy-hi and gy-ww, but better than pnn15% for gy-lo and gy-ss. under the criterion aucpr, pnn30% was always better than pnn15% for all gy.table  <dig> maize datasets

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
mean values of the area under the precision-recall curve aucpr aucpr  of  <dig> random partitions for  <dig> and 30 % upper classes for grain yield  in four environments , for  <dig> and 70 % middle class for anthesis-silking interval  in two environments , and for  <dig> and 30 % lower classes for four traits, female flowering  and male flowering  in two environments ; for gray leaf spot resistance  in six environments  and for classifiers mlp and pnn. numbers in bold are the highest aucpr values between mlp and pnn for  <dig> and 30 %



middle classes 
concerning the auc criterion for the middle class based on asi-ss and asi-ww, fig. 3b shows a slight superiority of pnn over mlp for both  <dig> and 70 %; however, pnn40% was, on average, slightly better than pnn70%. on the other hand, results using the aucpr criterion also show a slight superiority of pnn over mlp for mlp40% for asi-ss and mlp70% for both asi-ss and asi-ww . for this middle class, the aucpr results favored pnn as a better predictor than mlp for assigning maize lines to the correct middle class.

lower classes 
for the lower class, fig. 3c for fl and fig. 3d for gls  show a clear superiority in terms of the auc criterion of pnn over mlp for both lower classes. the better prediction accuracy of classifier pnn is reflected in aucpr prediction accuracy, where pnn outperformed mlp for both lower classes, and pnn30% was higher than pnn15% for all  <dig> traits .

comparing classifiers for selecting individuals in the upper and lower classes in the wheat datasets
upper classes 
results of auc for gy that were selected in the upper  <dig> and 30 % classes are presented in fig. 4a and in additional file 2: table s <dig>  pnn outperformed mlp for both upper classes for all gy. pnn30% gave better prediction accuracy than pnn15% in most traits, with the exception of gy- <dig> and gy- <dig>  where pnn15% had better prediction than pnn30%.

criterion aucpr showed that pnn was better than mlp for both upper classes; pnn appeared as the best class predictive models in all gy traits. furthermore, under the aucpr criterion, pnn30% was higher than pnn15% in all wheat gy traits . in summary, results of the upper  <dig> and 30 % classes show that pnn was a more accurate predictor than mlp when using the auc and aucpr criteria.table  <dig> wheat datasets

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
mean values of the area under the precision-recall curve aucpr  of  <dig> random partitions for the  <dig> and 30 % upper classes for grain yield  in  <dig> environments  and  <dig> and 30 % lower classes for days to heading  in  <dig> environments  for classifiers mlp and pnn. numbers in bold are the highest aucpr values between mlp and pnn for  <dig> and 30 %



lower classes 
for the lower classes involving wheat dth, auc of pnn was higher than mlp for both  <dig> and 30 % percentiles and all traits . in five instances , the pnn15% model was slightly more accurate than pnn30% when classifying individuals in this lower class.

the best performance of pnn was reflected in the prediction accuracy given by the aucpr criterion, where pnn was better than mlp in both lower classes for all dth traits. likewise, pnn30% was always higher than pnn15% .

prediction accuracy of pnn classifier with two and three classes in the wheat datasets
this section compares the performance of pnn in the upper and lower  classes for wheat gy and dth traits, when two and three classes are formed and evaluated using the auc  and aucpr  criteria. for the auc criterion, pnn with three classes was slightly better than pnn with two classes for most traits in the upper and lower  <dig> and 30 % classes . for the aucpr criterion, results were not as clear as for auc; however, pnn with three classes was globally better than pnn with two classes .table  <dig> wheat datasets

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
mean values of the area under the roc curve auc  of  <dig> random partitions for the  <dig> and 30 % upper class for grain yield  in  <dig> environments  and for  <dig> and 30 % lower class for days to heading  for classifier pnn with two and three classes. numbers in bold are the highest auc values

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
mean values of the area under the precision-recall curve aucpr  of  <dig> random partitions for the  <dig> and 30 % upper classes for grain yield  in  <dig> environments  and for  <dig> and 30 % lower classes for days to heading  for classifier pnn with two and three classes. numbers in bold are the highest aucpr values



in summary, results for the wheat datasets comparing the performance of pnn for selecting individuals in the lower and upper  <dig> and 30 % classes, based on the splitting of continuous traits into two or three classes, showed that for the lower 15 %, the performance of pnn with three classes was better than pnn with two classes . however, pnn with two classes gave better predictions than pnn with three classes in the upper 15 % . this is not the case when predicting individuals in the upper and lower 30 %, where pnn with three classes was a better predictor than pnn with two classes for most traits.

roc and precision-recall curves for the maize and wheat datasets
some results of the roc and precision-recall curves for various maize and wheat datasets for upper and lower  <dig> and 30 %, with the middle class in maize for  <dig> and 70 %, are displayed in a series of figures . for the maize and wheat datasets, it is clear that the roc curves of pnn for the upper and lower  <dig> and 30 % and the middle  <dig> and 70 % dominated the corresponding curves of mlp. also, auc values for pnn were always greater than those for mlp.fig.  <dig> the upper curve is the roc curve  with recall vs false positive rate. the lower curve is the precision-recall curve aucpr with precision vs recall for the a upper 15 % class of grain yield under well-watered conditions  of classifiers mlp  and pnn ; b upper 30 % class of trait grain yield under well-watered conditions  of mlp  and pnn ; c middle 40 % class of trait anthesis-silking interval under well-watered conditions  of mlp  and pnn  and d middle 70 % class of trait anthesis-silking interval under well-watered conditions  of mlp  and pnn ; e lower 15 % class of trait female flowering under well-watered conditions  of mlp  and pnn ; f lower 30 % class of trait female flowering under well-watered conditions  of mlp  and pnn 

fig.  <dig> the upper curve is the roc curve  with recall  vs false positive rate. the lower curve is the precision-recall curve aucpr with precision vs recall for the a upper 15 % class of grain yield in environment  <dig>  of classifiers mlp  and pnn ; b upper 30 % class of grain yield in environment  <dig>  of mlp  and pnn ; c lower 15 % class of days to heading in environment  <dig>  of mlp  and pnn ; d lower 30 % class of days to heading in environment  <dig>  of mlp  and pnn 



furthermore, the p vs r graphs show that for all the maize and wheat datasets, pnn was better than mlp, indicating that the precision of pnn remains better than that of the mlp for all recall values. the precision of pnn started declining at higher values of r than the values of r for mlp.

discussion
accuracy of the mlp and pnn classifiers for selecting the best individuals
genomic selection aims to accurately predict genetic values with genome-wide marker data using a three-step process: 1) model training and validation, 2) predicting genetic values, and 3) selecting based on these predictions  <cit> .

we evaluated the performance of classifiers mlp and pnn for selecting the best individuals in maize and wheat datasets . results indicated that, overall, pnn was more precise in identifying individuals in the correct class than mlp. previous studies using rbfnn and bayesian regularized nn on the same wheat datasets  <cit>  used in this study showed their prediction advantage over the linear parametric models for complex traits such as gy because these models can capture cryptic epistatic effects in gene × gene networks such as those usually present in wheat . the good performance of pnn for selecting individuals in the correct classes may also be due to its ability for capturing small and complex interactions, while mlp may fail to do so.

the fact that these classifiers are trained to maximize the probability of membership of an individual to the target class, rather than searching for an overall performance, makes it attractive for applying these tools in gs. results from mlp and pnn indicated that pnn was much more efficient in maximizing the probability of membership for the upper, middle, and lower classes than mlp.

from a practical genome-assisted plant breeding perspective, this study attempts to mimic the breeder’s decision, for example when selecting the upper  <dig> or 30 % class candidates for gy, or when selecting the lower  <dig> or 30 % class candidates for dth, gls or fl. in maize breeding, asi synchrony close to zero is a crucial “middle class trait” under ss conditions because it will ensure selecting plants that will simultaneously produce pollen and silk; thus grains can be harvested. therefore, pnn should help genomic-assisted breeding select appropriate candidates in each class of interest.

breeding values have two main components, parental average  and mendelian sampling . genomic prediction should account for these two main components and try to control potential population structures that could modify prediction accuracy between the selected training and testing populations. an important practical question is how well pnn and mlp predict the breeding value of individuals between families and within families that were not phenotyped. although the elite maize and wheat lines used in this study are not ideal as training sets, the cross-validation scheme used in this study  attempts to mimic the prediction of non phenotyped individuals belonging to different families  or to the same family. although this cross-validation design may not have chosen individuals between and within families as precisely as they are in reality, it is likely that the  <dig> random partitions searched for all possible relationships between individuals in the training and testing sets such that some cross-validation partitions selected subsets of training data that had high correlations with the observed data, indicating a family relationship among individuals belonging to those training–testing subsets  <cit> , whereas other random partitions chose subsets of training individuals that had no family relationship with those in the testing set, thus producing low correlations with the observed values. when applied to both classifiers, pnn consistently gave better average prediction accuracy  of the genetic values of the unobserved individuals than mlp in all  <dig> maize and wheat data sets.

auc and aucpr
for both datasets, the results of the aucpr criterion showed that the values of the upper and lower pnn30% were higher than those for the upper and lower pnn15%. also, the values of the middle pnn70% were higher than those for the pnn40% . these results were similar but not equal to those found by auc  in several instances. pnn15% was superior to pnn30% in the maize data  and the wheat data . prediction accuracy of individuals was clearly hampered under biotic stress in the maize data, which was also found by  <cit> .

figures 5a–f and 6a–d showing the roc curve clearly indicated the advantage of pnn over mlp. the r vs fpr graph indicates that, for most of the traits, the probability of correctly classifying an individual in the upper, lower or middle classes was very often  <dig>  or higher, even with a small fpr. in most cases, at a value of fpr =  <dig>  the probability of classifying an individual in the correct class was  <dig>  or greater for pnn. for all traits, the auc of pnn15% was always better than the auc of mlp15% and the auc of pnn30% was better than the auc of mlp30%.

for the aucpr curve, figs. 5a–f and 6a–d indicate that, in most cases, pnn had higher precision than mlp at higher sensitivity values. this criterion also indicates the superior performance of pnn over mlp.

prediction accuracy for  <dig> vs 15 % classes with binary and trichotomous classes
based on the auc criterion, it is clear that pnn gave better prediction accuracy than mlp when assigning maize and wheat individuals to the classes of interest. using the aucpr criterion, the results were equally clear for the wheat and the maize datasets.

for the wheat datasets, the auc criterion showed the superiority of pnn30% with three classes over pnn30% with two classes, as well as the superiority of pnn15% with three classes over pnn15% with two classes . however, the differences given by the auc criterion were not as marked as those shown by the aucpr criterion. the aucpr criterion applied with pnn shows that for the upper 15 % classes , partitioning the data into two classes assigned more wheat lines to the correct observed classes than partitioning the data into three classes. however, for the lower 15 % classes  and for pnn 30 % upper and lower classes, results indicate that three classes gave better prediction than two classes .

CONCLUSIONS
we compared the performance of the multilayer perceptron  and the probabilistic neural network  classifiers for selecting the best individuals belonging to a class of interest  in maize and wheat datasets using high-throughput molecular marker information . pnn outperformed mlp in most of the datasets. the performance criteria used to judge the predictive accuracy of mlp and pnn for assigning individuals to the right observed class were the area under roc curve, auc, and the area under the precision-recall curve, aucpr, pnn had better accuracy than mlp. in genomic selection, where p markers > > n individuals is the norm, pnn seems promising because of its better generalization capacity than mlp, and is faster than mlp in obtaining optimal solutions, thus presenting appealing computational advantages.

availability of supporting data
the  <dig> datasets  and the matlab scripts used in this work are available at http://hdl.handle.net/11529/ <dig> 

additional files
additional file 1: table s <dig>  maize datasets. mean values of the area under the roc curve auc  of  <dig> random partitions for upper  <dig> and 30 % classes for grain yield  in four environments , for middle  <dig> and 70 % classes for anthesis-silking interval  in two environments  and , and for lower  <dig> and 30 % classes for four traits, female flowering  and male flowering  in two environments ; for gray leaf spot resistance  in six environments and for both mlp and pnn classifiers. numbers in bold are the highest auc values between mlp and pnn for  <dig> and 30 %. 

additional file  <dig> :table s <dig>  wheat datasets. mean values of the area under the roc curve auc  of  <dig> random partitions for the upper  <dig> and 30 % classes for grain yield  in seven environments  and for the lower  <dig> and 30 % classes for days to heading  in ten environments  for both mlp and pnn classifiers. numbers in bold are the highest auc values between mlp and pnn for  <dig> and 30 %. 



abbreviations
asianthesis-silking interval

aucarea under the receiver operating characteristic curve

aucprarea under the precision-recall curve

dthdays to heading

fflfemale flowering or days to silking

glsgray leaf spot

gsgenomic selection

gygrain yield

hihigh yielding

lolow yielding

mflmale flowering or days to anthesis

mlpmulti-layer perceptron

nnneural networks

pprecision

pnnprobabilistic neural network

qtlquantitative trait loci

rrecall or sensitivity

rbfradial basis function

rbfnnradial basis function neural network

rkhsreproducing kernel hilbert spaces

rocreceiver operating characteristic curve

sssevere drought stress

wwwell-watered

competing interests

the authors declare that they have no competing interests.

authors’ contributions

jmgc conceived, drafted the manuscript, carried out the study, performed computations and wrote a part of the manuscript; jc conceived and wrote part of the manuscript; ppr, lo and dg helped to provide critical insights and revised the manuscript. all authors read and approved the final manuscript.

we thank cimmyt’s global wheat and maize programs and the national program researchers who performed the experiments and collected the valuable phenotypic data analyzed in this study. we acknowledge the financial support provided to cornell-cimmyt by the bill & melinda gates foundation.
