BACKGROUND
codon optimization is commonly used to improve heterologous gene expression, especially in the context of synthetic biology and metabolic and cellular engineering  <cit> . while most commonly employed in prokaryotic systems  <cit> , codon optimization has also been described in eukaryotic systems such as yeast  <cit> . the basic premise behind this approach is that the distribution of the  <dig> unique dna codons is non-random. specifically, the occurrence of synonymous codons  within any genome is not uniform, resulting in both rare and abundant codons. the distribution of preferred codons varies across all organisms  <cit>  giving rise to a host-specific codon usage bias   <cit> . codon usage, especially the high prevalence of rare codons, is known to influence translational efficiency  <cit> . as a result, the most common strategy for codon optimization is to replace rare codons with more frequently occurring ones, thereby matching the cub of the host organism.

typically, the cub for a given organism is determined using the codon usage tabulated from genbank   <cit> . this process calculates the frequency of codon usage across all annotated protein coding genes and is the primary dataset used for codon optimization. several alternative codon usage tables exist including the codon adaptation index   <cit> , codon bias index   <cit>  and effective number of codons   <cit> . as an outgrowth of these approaches, several online optimization programs have been developed and are freely available  <cit> . despite the promise of these approaches, much of this research has focused on studying and describing endogenous gene expression. moreover, traditional codon optimization does not always lead to improved expression compared to a wild-type, unmodified sequence  <cit> . in fact, in a survey of  <dig> synthetic genes manufactured by blue heron biotechnology , 32% of the “optimized” synthetic genes expressed at lower levels than the wild-type. thus, alternative strategies are required to further improve codon optimization for heterologous genes, especially in eukaryotic hosts and for biotechnological applications.

we posit that the limitations to traditional codon optimization stem from the fact that traditional methods for cub calculations utilize all potential coding regions of the genome. it is well documented that trna abundance is influenced by changes in environmental factors including growth condition and cell-cycle  <cit> . moreover, much of an organism’s protein coding genes are lowly expressed and thus minimal evolutionary pressure has been present to drive efficient natural evolution and optimization  <cit> . as a result, it is expected that the effective cub for a given growth condition may differ from the whole-genome based cub. thus, a traditional codon optimization approach neglects cell conditions and considers all of a genome’s protein coding information as equal. as a result, these approaches fail to capture important nuances of the effective cub that may be essential for guaranteeing expression of a heterologous gene. in addition, traditional approaches neglect evidence that adjacent codons co-evolve  <cit> . finally, it is not always wise to consistently utilize abundant codons, especially in biotechnological applications where multiple genes are optimized and the cognate trna may eventually become limiting  <cit> .

here we demonstrate that a cub generated using only genes expressed under a given condition can enable improved codon optimization in saccharomyces cerevisiae compared to a cub generated using the cutg. we refer to this alternative approach as ‘condition-specific codon optimization.’ furthermore, we utilize a probabilistic method that incorporates codon context into optimized gene design and thus results in multiple variants to be tested rather than a singular design. we demonstrate the utility of this technique in s. cerevisiae through the condition-specific codon optimization of two heterologous genes: a green fluorescent protein variant originally optimized for expression in escherichia coli, and the catechol  <dig> -dioxygenase enzyme from acinetobacter baylyi. to do so, we created a cub for two specific conditions of interest: constitutive high expression and high expression in stationary phase growth. the resulting optimized genes yielded more protein activity under the conditions for which they were optimized. furthermore, our best catechol  <dig> -dioxygenase gene variant resulted in  <dig> -fold higher activity than a commercially optimized gene variant. this technique should be applicable to any organism for which gene expression data can be generated and is thus of potential interest for a variety of applications in metabolic and cellular engineering.

RESULTS
developing a condition-specific codon usage bias matrix
to establish condition-specific codon optimization, we developed a simple workflow for optimizing heterologous genes .

first, the condition under which the heterologous gene of interest will be expressed must be identified and genome-scale expression data for the host should be obtained under this condition. while we have selected dna microarray data for this study, it is conceivable to use additional sources such as rna-seq or proteomics. for commonly studied organisms, the desired information is publically available in databases such as gene expression omnibus , the center for information biology gene expression database  and array express.

second, using the appropriate dataset, genes that are differentially up-regulated or highly expressed under the desired condition are identified. from this set of genes and their corresponding dna sequences, codon frequency and probability can be determined for codon pair usage . the python script used to generate the condition-specific tables and matrices is entitled ‘codonusageanalysis’ . the output of this analysis is a  <dig> by  <dig> matrix termed the ‘codon bias matrix’ . we chose to focus on codon context rather than individual codons as previous studies suggest that codon context may be more important for gene optimization  <cit>  and that this context directly correlates with translation elongation rate  <cit> . in particular, steric hindrance of charged trnas by adjacent codons can be avoided by considering the impact of adjacent codon pairing  <cit> .

third, the condition-specific matrix can be used to reconstruct a series of codon optimized genes that would follow the codon bias rules of the condition of interest. by considering each adjacent codon pairing in the chain, we probabilistically reconstruct the dna sequence from the protein sequence utilizing the codon context probabilities stored in the condition-specific matrix . as an example, if the first two amino acids of the protein sequence are methionine followed by cysteine, there are two possible corresponding dna sequences: atgtgt and atgtgc. the condition-specific matrix stores the probability in which each pairing occurred in the set of up-regulated genes for a given condition. genedesign assigns a dna sequence based on the corresponding probability. for example, if 60% of met-cys pairs are atgtgt and only 40% are atgtgc, genedesign will probabilistically select atgtgt 60% of the time and atgtgc 40% of the time for each occasion that a met-cys pair is present in the peptide sequence. as a result of the probabilistic design, several variants of codon optimized genes are generated. moreover, this process also ensures a balance in codon usage rather than the exclusive use of specific codons which can result in bottlenecks with the formation of charged trna-amino acid complexes and reduced translational efficiency  <cit> .

finally, after genedesign has been used to generate one or more condition-specific codon optimized sequences, the corresponding dna can be synthesized and introduced into the cellular host of interest. functional assays can be used to determine the highest performing variant.

generation of condition-specific codon bias matrices for s. cerevisiae
in order to validate our hypothesis and this approach, we selected two heterologous genes of interest, applied the approach as outlined above, expressed the resulting optimized genes in s. cerevisiae, and measured resulting protein activity. for comparison, we generated a control table and codon context matrix , which were assembled using the protein coding sequences of  <dig>  s. cerevisiae genes. the control table is identical to the cutg from genbank for s. cerevisiae, which is used commercially. a colored representation of the control matrix is shown in figure 1b  with the y-axis representing the first codon and the x-axis representing the second codon in a pair. each square represents the probability of a codon pair occurring given that the first codon is specified, with the color blue representing a probability of one and red representing a probability of zero. the two solid blue columns correspond to a second codon for methionine  or tryptophan , both of which have no synonymous codons and therefore have a probability of  <dig>  amongst the synonymous codons however, there is variation between the columns, indicating an overall genomic preference for particular synonymous codons. there is very little variation between rows, indicating that the choice in second codon is not influenced much by the choice in first codon. since this control matrix incorporates codon context for nearly all protein coding genes in s. cerevisiae, the probability values are an average of codon usage across the entire genome. as a result, the columns become indicative of the frequency of each codon, with the rarest indicated in red.

in contrast, the matrices made for the subset of highest expressed genes and genes expressed in stationary phase  have significant variation between rows . in order to compare the difference between the control matrix and condition-specific matrices we quantified the drift using the frobenius matrix norm of the difference between the matrices. this metric is well established as a quantitative tool to determine drift between matrices of the same size  <cit> . a smaller frobenius matrix norm indicates higher similarity between matrices, such that identical matrices have a norm of zero. we first evaluated the drift between the control matrix and sets of randomly selected genes as a control. random sets of  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> genes were selected in five independent events and the average matrix norm was calculated . as the number of randomly considered genes increases, the frobenius matrix norm or drift relative to the control condition decreases in a power regression fashion . this behavior is expected, as the inclusion of more genes in a codon usage matrix will result in an averaging effect that begins to resemble the control matrix composed of all gene sequences. next, we calculated the drift between the control matrix and the highest expressed genes in s. cerevisiae <cit> . the higher drift demonstrates that these genes exhibit a vastly different codon usage than the control matrix. the difference in codon usage between highly expressed genes and the rest of the genome has been previously noted  <cit> , suggesting evolutionary pressure on codon usage. this further supports the use of only a subset of genes for determining codon usage bias.

condition-specific optimization of egfp for high expression outperforms wild-type and control variants
initially, we sought to investigate the importance of condition-specific codon optimization by re-coding an e. coli fluorescence protein for high, constitutive expression in yeast. to do so, we established a cub based on the  <dig> most highly expressed genes during growth in ypd media  <cit> . the associated condition-specific table and matrix were assembled as described above . an e. coli optimized green fluorescent protein  was selected as a reporter protein as it is poorly translated in yeast. eight sequence variants of egfp were generated and compared to the wild-type sequence. one variant was optimized using the control table, one variant using the high expression table, three variants using probabilistic design based on the control matrix and three variants using probabilistic design based on the high expression matrix. the sequences for each of these variants can be found in additional file  <dig>  each variant, including wild-type egfp, was inserted into the p41k-gpd yeast expression vector and transformed into s. cerevisiae by <dig>  <cit>  and fluorescence was screened in mid-log phase of ypd growth using biological triplicates. we observed that, on average, the egfp variants generated using the high expression matrix are statistically better expressed than those variants generated using the control matrix  and better than the wild-type egfp  . while all three of the high expression matrix-generated variants outperform the wild-type egfp, only two of the three control matrix-generated variants outperform wild-type egfp. these results demonstrate that optimizing codon usage specifically for high expression was effective and that the probabilistic design is suitable for generating functional variants.

we also tested the egfp variants generated using the control and high expression table rather than a probabilistic matrix-based design. while there was no statistical difference between the two conditions, expression of these variants were higher than any of the matrix-generated conditions. this result is not surprising given the short length of the gene . however, a table-optimized approach lacks codon diversity which may ultimately become a bottleneck and decrease enzyme fitness for large metabolic engineering endeavors with multiple genes  <cit> . the fact that two table-optimized genes were similar is not unexpected either, as there was a difference between the most abundant codon for only six of the  <dig> amino acids in the two tables, and thus the genes codon optimized by both tables were highly similar on a sequence basis. nevertheless, these results illustrate that the probabilistic method used to choose codons from the condition specific matrix gives better results than that from the control matrix. as such, this is the first proof-of-concept demonstrating that using condition-specific data can improve codon optimization gene design over the traditional cub methods.

high expression and stationary phase optimization of cata
next, we sought to codon optimize a catechol  <dig> -dioxygenase gene  from acinetobacter baylyi in s. cerevisiae to enable the production of muconic acid, a useful polymer precursor, in the stationary phase. this condition was chosen as it is often desirable to delay gene expression until stationary phase to increase product output and separate growth and production phases. to optimize under these conditions, a codon usage matrix was calculated using the  <dig> genes most differentially upregulated when comparing three day cultures to exponential growth  <cit>  . this data was downloaded from a previous study available under the geo reference e-tabm- <dig>  we designed three cata variants using a probabilistic design based on the stationary phase matrix , three similarly designed using the control matrix , and two using the high expression matrix used above for egfp . finally, we included wild-type a. baylyi cata and a variant that was codon-optimized for expression in s. cerevisiae by blue heron biotechnology using traditional codon optimization methods . these sequences are included in additional file  <dig>  expression of these ten variants was determined using a previously described protein activity assay  <cit>  during various stages of growth . we calculated the catalytic rate, vmax , for each variant .

in exponential phase , the vmax for wild-type cata is significantly higher than the blue heron variant . this illustrates again that traditional codon optimization approaches can often result in poor performance. the most highly expressed variant after 6 hours of growth is high expression # <dig> whereas the lowest expressed variant is stationary # <dig> 

toward late exponential phase and early stationary phase , the cata expression pattern shifts for each variant. compared to the 6 hour time-point, the cellular catalytic level  at 18 hours decreases for many of the constructs including the control variants # <dig> and # <dig>  high expression # <dig>  and the blue heron variant. by comparison, vmax for stationary # <dig> and # <dig> is unchanged between  <dig> and 18 hours, and for stationary # <dig>  vmax actually increases. at 18 hours, the average vmax for the stationary variants is significantly higher than the average for the control variants  and the blue heron variant . while the stationary phase variants either maintain or increase their vmax, the activity of the control variants decreases significantly. moreover, at this timepoint, the control variants perform worse than the a. baylyi wild-type gene.

the disparity between the average vmax for the stationary and control variants is even more significant  at 24 hours. furthermore, outside of high expression variant # <dig>  the stationary variants # <dig> and # <dig> demonstrate the highest vmax values. the profile for stationary # <dig> is particularly interesting as it was among the worst during exponential phase and among the best at stationary phase. these results provide further demonstration that codon optimization based on condition-specific cubs can outperform traditional approaches. by doing so, we were able to design three cata variants which outperformed both a commercially-optimized sequence  and three control cata variants in stationary phase.

we have previously demonstrated that catalytic capacity is just as important as catalytic rate for the cata enzyme  <cit> . to measure this, cultures with each variant were grown for 18 hours and then spiked with 1 mg/ml catechol. resulting muconic acid  was measured via hplc for each of the variants . in this assay, the stationary # <dig> variant outperformed all other variants, including the high expression # <dig> variant . overall, this variant had a catalytic capacity that was  <dig> -fold higher than the wild-type version and nearly  <dig> -fold higher than the blue heron optimized version in the stationary phase—the condition used to optimize this gene. these results highlight the importance and potential of condition specific codon optimization, and demonstrate for the first time that codon optimization can be used to control translation for specific environmental conditions.

analysis of transcription factor-regulated genes suggests codon usage is linked to gene regulation
based on the utility of condition-specific cubs, we were interested in exploring the potential link between transcriptional and translational regulation. utilizing a systems biology perspective, we concentrated on key global transcription factors in yeast. specifically, we sought to calculate the cub matrices for genes regulated by sixteen global transcription factors for s. cerevisiae: cbf1p, dal82p, gcn4p, gln3p, hap4p, hsf1p, leu3p, mbp1p, msn4p, nrg1p, pho4p, rtg3p, skn7p, ste12p, tec1p, and upc2p. codon usage matrices for the gene targets regulated by each of these global regulators were compared with the control matrix derived from all  <dig>  protein coding genes . the frobenius matrix norm was calculated for all pairwise combinations of the  <dig> matrices  and this data set was used to generate a colored table, with darker colored cells representing a higher frobenius matrix norm, and thus more distinct matrices .

the matrices for rtg3p targets and cbf1p targets are both most similar to the control matrix whereas gcn4p and hsf1p targets are most dissimilar in their codon usage compared with the control dataset. in general, figure  <dig> clearly shows that the genetic targets of transcription factors have very disparate codon usage compared to the aggregate of coding regions. furthermore, each transcription factor matrix is more similar to the control condition than to another transcription factor matrix. this result further supports the averaging effect seen by using all protein coding genes to create cub tables, as opposed to a subset. the fact that distinct patterns in codon usage appear for each transcription factor suggests that genetic regulation has co-evolved with codon usage. this finding supports the central hypothesis of this work – that transcriptional profiles  can be used to predict optimization schemes for translational regulation .

CONCLUSIONS
here, we demonstrate the utility of a condition-specific codon optimization method that utilizes both systems-level information and codon context to generate a set of potential variants using a probabilistic algorithm. while we demonstrated the effectiveness of this algorithm using yeast and microarray data, the approach should be generic and easily adaptable to other hosts and other high-throughput datasets. while the consideration of codon pair bias and probabilistic design to create variants has been demonstrated previously  <cit> , this is the first example to demonstrate that gene expression data can be used to generate high-expressing variants for a specific condition. in the case of the cata gene, the s <dig> variant was high-expressing in stationary phase and low-expressing in exponential phase, resulting in the highest productivity of muconic acid of all of the variants. this is of considerable interest as it offers a previously unidentified method of control at the translational regulation level for heterologous gene expression.

it should also be noted that this is the first work to study a specific codon optimization strategy in s. cerevisiae in depth. previous codon optimization strategies have been primarily validated using prokaryotes  <cit> , endogenous expression data  <cit> , or limited heterologous gene variants  <cit> . in contrast, we expressed two heterologous genes in s. cerevisiae, egfp and cata, which were each optimized for different growth conditions. in each case, we observe improved protein expression using the condition-specific optimization technique outlined here. specifically, egfp expression was successfully optimized for high expression in rich media, and the cata enzyme was optimized for high expression in stationary phase growth, with the highest expression variant resulting in  <dig> -fold higher product yield over a commercially optimized variant. finally, we demonstrated that transcriptional regulation is indeed linked to translational efficiency through the significantly different codon utilization patterns of distinctly regulated genes.

codon optimization is an important synthetic biology tool that enables recombinant dna expression. the algorithm we define here is simple to execute and host agnostic. as our ability and desire to produce chemicals in a renewable and environmentally-friendly capacity increases  <cit> , the necessity for optimized heterologous expression will likewise increase. furthermore, many of these processes will be carried out under diverse, non-standard environmental conditions, including changes in temperature, ph, mineral concentration, carbon source, oxygen level, and cell growth phase. the condition-specific approach to codon optimization described here will be a key tool to identify gene variants with the ideal codon usage for any particular condition.

