BACKGROUND
dna methylation, defined as the addition of methyl group on 5-carbon in cytosine, is a widely spread epigenetic mark. the dna methylation pattern can serve to identify cells and guides cell development and tissue maintenance  <cit> . for decades, researchers have focused on methylation at cpg sites  and found that differentially methylated regions  among various cells are involved to cell-specific functions, aging and deceases  <cit> . recently, methylation at cph  sites has been confirmed to be a key regulator of brain development and embryonic stem cell  differentiation  <cit> . therefore, profiling both mcpg and mcph in a genome scale is crucial for understanding of various biological processes.

to analyze the methylation modifications, high-throughput methods coupled with microarray and next-generation sequencing have been widely used. bisulfite microarray is a specially designed genotyping microarray combined with bisulfite treatment. although this method is a useful strategy for targeted dna methylation analyses, it is not suitable for genome-scale studies due to low genome coverage; only  <dig> % of cpgs and  <dig> % of cphs have been covered in the newest version  <cit> . reduced representation bisulfite sequencing   <cit>  utilizes enzyme bindings to "ccgg" sites to detect information-rich regions, whereas the enzyme reaction leads experimental bias and limits the detection of mcph  <cit> . alternatively, as the widely-accepted gold standard method, whole genome bisulfite sequencing  can detect both mcpg and mcph at single nucleotide resolution in a genome scale  <cit> .

for efficiently detecting the methylated sites with wgbs data, many computer programs have been developed. in particular, bismark  <cit> , bsmap  <cit> , and bs-seeker <dig>  <cit>  are the most widely used bisulfite-read mappers that employ different strategies; bsmap is a wild-card type mapper that converts all cytosine bases  of a reference genome to a letter y and then aligns sequenced cs and thymine bases  to the y  <cit>  by using soap  <cit> . bismark and bs-seeker <dig> are three-letter type mappers that convert all cs to ts in both sequenced reads and a reference genome. bismark and bs-seeker <dig> employ bowtie <dig>  <cit>  in global and local alignment modes, respectively. it has been reported that wild-card type mappers are better in mapping rate  but struggle with mapping accuracy   <cit> . three-letter type mappers show exactly opposite tendency  <cit> . therefore, the choice of bisulfite-read mapper is an important issue for not only specific studies that use costly wgbs data but also comprehensive large-scale analyses of public wgbs datasets.

in this study, we investigated the performances of the three mappers on virtual wgbs dataset that has been simulated under various conditions. through gathering detailed information, we confirmed that the mappers exhibit similar behaviors depending on the properties of simulated reads, which is consistent with results from previous studies  <cit> . since the results showed that the behaviors of the three mappers were complementary to each other, we sought to integrate the characteristics of the mappers by scoring them to gain robustness against artifacts . as a result, our integrative approach improved quality  and quantity  of the methylation data with less dependency on the read properties . we also applied our approach to public wgbs datasets of  <dig> tissues, and successfully grouped them according to their originated tissues by the patterns of mcpg and mcph. we believe that this study contributes to dna methylation researches by efficiently analyzing the wgbs data and facilitating comprehensive analyses of methylation patterns under the public wgbs data. in addition, this study gives a clue to algorithmic improvement of bisulfite-read mappers.

RESULTS
overview of integrative approach
we integrated the methylation results from three bisulfite-read mappers: bismark, bsmap, and bs-seeker <dig>  bismark and bsmap are the most widely used three-letter type and wild-card type mappers, respectively  <cit> , and bs-seeker <dig> is the newest three-letter type mapper, which has shown higher mapping rate than bismark  <cit> .

the evaluation and integration of bismark, bsmap, and bs-seeker <dig> were conducted as described below . first, bisulfite-read sets were generated by sherman  <cit> , with randomly designated methylation levels for every block of  <dig> base pairs  in human chromosome  <dig>  then we mapped the reads by bismark, bsmap, and bs-seeker <dig> and evaluated the performances of the three mappers with respect to mapping rate and accuracy; the mapping rate is the portion of mapped read number over total read number, whereas the mapping accuracy is the portion of correctly mapped read number over mapped read number. lastly, we integrated the methylation results from the mappers with three strategies and evaluated the performances in terms of detection accuracy  and amount of detected cs . the d-accuracy was determined by the similarity between generated and detected methylation levels at each block .

read-dependent performances of the three mappers
to investigate the performances of the three mappers under diverse read conditions, we analyzed the mapping results of the three mappers in the context of varying read quality, read length, and methylation levels.

for all three mappers, the mapping rate and mapping accuracy fluctuated with changes in read quality . when reads contained low error , bsmap showed a higher mapping rate and lower mapping accuracy compared with others, consistent with previous studies  <cit> . as the read error rate increased , the mapping rate of the bsmap decreased dramatically, becoming lower than that of bismark. interestingly, for bs-seeker <dig>  both mapping rate and mapping accuracy did not decreased substantially.

the read length also affected the performances of the three mappers . we compared mapping results of  <dig> bp-long reads with those of  <dig> bp-long reads. when read error rate was low , both mapping rate and mapping accuracy were higher within long reads. when read error rate was high , mapping rate of bismark and bsmap were higher within short reads. remarkably, the mapping accuracy of bismark was also higher in short reads.

additionally, we found that the performances of the three mappers varied greatly within repeat regions. in particular, the reads generated from short interspersed nuclear elements  tended to be unmapped by bismark and bs-seeker <dig>  and incorrectly mapped by bsmap , which clearly showed the difference in performances between wild-card type and three-letter type mappers.

lastly, we found that hypo-methylated reads tended to be incorrectly mapped by bsmap and bs-seeker <dig> . this tendency was not found in the mapping results of bismark. this may be explained in part by that the increased number of ts, induced by the bisulfite conversion of unmethylated cs, hindered the correct mapping of bsmap and bs-seeker <dig>  to confirm that, we measured the percentage of ts in reads that correctly and incorrectly mapped by the three mappers. for bsmap and bs-seeker <dig>  the incorrectly mapped reads contained higher amount of ts than the correctly mapped ones .

in summary, bismark, bsmap, and bs-seeker <dig> performed differently in different read conditions. bismark mapped reads with great accuracy and was not affected by the density of ts in reads. however, bismark tended to lose both mapping rate and accuracy when read error rate was higher in longer reads. bsmap generally mapped a large number of reads to incorrect positions. additionally, the mapping accuracy of bsmap was affected by the density of ts in reads. both the mapping rate and mapping accuracy of bs-seeker <dig> were only slightly affected by the read error rate, whereas the mapping accuracy was affected by the density of ts in reads.

integrative approach improved both the accuracy and amount of methylation detection
based on the different performances of bismark, bsmap, and bs-seeker <dig> in varying read conditions, we integrated the mapping results of the three mappers using three strategies: ave - average of the methylation levels from the three mappers, wave - weighting by read depths, and pwave - weighting by probabilistic method .

we first examined the overlap of correctly mapped reads by the mappers. we found that  <dig> % of high-quality  <dig> bps reads  were correctly mapped by all the mappers, but this dramatically decreased to  <dig> % in the case of low-quality reads . this result suggests the possibility that combining consensus of the mappers improves dna methylation detection. indeed, as the number of covering mappers  increased, wave improved the d-accuracy . however, the d-amount was dramatically decreased, even becoming far lower than the average of the three mappers when ni = <dig> in the cases with high read error rate . taking account of this tradeoff, we choose ni â‰¥ <dig> that yields constantly higher d-amount than bismark, and higher d-amount than bs-seeker <dig> or bsmap in some cases .

as shown in table  <dig> among the three integration methods, wave marked the highest d-accuracy in most read conditions, whereas pwave showed the best d-accuracy in limited cases that short reads contain few errors . the wave remarkably improved d-accuracy compared with the individual mappers . the wilcoxon single-rank test over  <dig> bps blocks revealed significantly low p value  in most of read conditions . especially, the wave increased d-accuracy within sines in which the mappers showed low mapping rate or accuracy . taken together, the wave successfully improved the methylation detection compared with using individual mappers.

* numbers in bold are the highest value within each column

the superior performance of wave may be explained by the correlation between d-accuracy and mapping rate. using read depth as weight, the wave considered mapping rate as a first element on determining the certainty of the methylation levels from each mapper. on the other hand, pwave indirectly employed mapping accuracy on weighting by considering the characteristics of the mappers; a mapper that maps larger number of reads compared with other mappers tended to maps reads at incorrect positions. the tendency was clearly revealed within short reads containing low error, so the d-accuracy of pwave was the highest among the integration methods in those read conditions. generally, however, d-accuracy was more strongly correlated with mapping rate  than mapping accuracy , resulting in the higher d-accuracy of wave than that of pwave in most read conditions.

it is noteworthy that the d-accuracy of wave exhibited the reduced dependency on read conditions . we checked the distribution of d-accuracies of the three mappers and wave, gathered from mapping results of  <dig> read sets .the wave shows relatively less variance of d-accuracies among varied read conditions. especially, the wave decreased the difference of d-accuracy between high and low read error cases . this implies that the wave successfully reduces the effects of heterogeneous read conditions on methylation detection, facilitating comprehensive analyses of methylation patterns among public wgbs samples from various experiments.

the integrative approach facilitated the comprehensive analysis of public wgbs data
next, we re-analyzed  <dig> wgbs samples that were generated from various experiments with different read length and quality. in particular, we included six brain samples and four pluripotent stem cells, in which significant amount of cph methylation is accumulated  <cit> .

the mapping rate of wgbs samples was consistent with the mapping results of artificial bisulfite-reads . bsmap showed the highest mapping rate within nine samples, whereas bs-seeker <dig> showed the highest mapping rate within left four samples. bismark showed the lowest mapping rate in most of the samples. in accordance with mapping rate, the d-amount by bsmap was the highest among the three mappers within  <dig> samples. in contrast, bs-seeker <dig> showed the highest d-amount within only one sample. the d-amount by wave was higher than bismark within all samples . also, the wave showed higher d-amount than bs-seeker <dig> within six samples.

we also examined the correlation between samples in terms of cpg and cph methylation levels detected by the wave. we found that both methylation levels clearly grouped samples according to their tissue of origin . in particular, while brain samples were produced from three different experiments, they were closely positioned in the dendrogram. moreover, an unknown-brain sample, a wgbs data from brain of which age was not known, and a sample from liver were produced from the same experiment but were successfully grouped according to each tissue type. these trends were not observed for bs-seeker <dig> . the wave clearly reduced false correlation between brain and liver from the same experiment . we also found that the wave results in significantly higher correlation of cpg methylation levels in gene-body regions within brain samples compared with that observed by bismark . especially, the correlation among brain samples from different experiments were relatively more increased than that from same experiment. thus, the wave decreased the false correlation between samples from the same experiment and increased the correlation among samples from the same tissue.

CONCLUSIONS
to efficiently detect dna methylation from wgbs data, we analyzed and integrated the three most widely used bisulfite-read mappers, bismark, bsmap, and bs-seeker <dig>  the procedure consisted of three steps: mapper analysis, analysis with simulated reads, and analysis with real wgbs dataset.

firstly, we confirmed that with low read error rate, the performances of the three mappers were consistent with the results of former studies of wild-card type  and three-letter type   <cit> . in particular, the two types of mappers performed distinctly in sines, in which the wild-card type mappers falsely mapped reads, whereas the three-letter type mappers failed to map reads. it should be further investigated what distinction in algorithm induces the difference in mapping results in sines. in addition, the performances of bismark and bsmap dramatically decreased in case of high error reads, whereas bs-seeker <dig> did not affected much by the read error rates. lastly, the mapping accuracies of bsmap and bs-seeker <dig> were found to be dependent on the methylation level, whereas bismark were not. based on the complementary performances of the three mappers across varying read conditions, we integrated the mapping results of the three mappers with three methods: average , read depth-weighted average , and probabilistically weighted average by poisson distribution .

with the simulated reads, the wave method resulted in significantly higher detection accuracy than that obtained with individual mappers and other integration methods. on the other hand, pwave showed decreased accuracy compared with wave. it should be further studied what probabilistic methods could improve the detection accuracy compared with read-depth weighting. in addition, the wave exhibited higher detection of cs than bismark. indeed, existing bisulfite mappers exhibit smaller increases in either quality or quantity of the methylation results compared with former systems. it is remarkable that the integration improved both the accuracy and amount of methylation detection. furthermore, the integration reduced the dependency of detection accuracy on read conditions , proving that our method can facilitate the comprehensive analyses of multiple wgbs samples of which read conditions are heterogeneous.

with real wgbs samples, the wave reduced the false correlation between wgbs samples generated from same experiments and increased the true correlation between those originated from same tissues. thus, our method succeeded in facilitating comprehensive analyses of multiple wgbs datasets from various experiments by reducing the dependency of methylation results on read conditions.

in summary, our integrative approach improved both quality and quantity of methylation results from wgbs data, and facilitated the comprehensive analyses of dna methylation among various read conditions. this study may contribute to researches about methylation patterns among samples in different conditions  by combining a massive public wgbs data. in addition, this study may give a new clue to algorithmic improvement of bisulfite-read mappers to enhance epigenetic researches.

