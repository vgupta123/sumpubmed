BACKGROUND
studies of the human microbiome are producing large datasets of partial 16s rdna sequences from prokaryotic colonizers of various human body sites. these metagenomic surveys of microbial communities bypass the need for isolating and cultivating individual species, permit association of bacterial populations with specific environments or conditions of health, and facilitate the discovery of new bacterial and archaeal taxa. recent advances in sequencing technologies have enabled deeper sequencing of microbial communities at a lower cost, which has presented new computational challenges associated with analyzing 16s rdna datasets of the human microbiome .

as part of the vaginal human microbiome project at virginia commonwealth university , we are studying the association of the vaginal microbiome with various physiological and infectious conditions, and we are assessing how host genetic and environmental factors contribute to the composition of the vaginal microbiome  <cit> . microbiome profiles have been generated from mid-vaginal samples from over  <dig>  participants, and the dataset currently contains ~ <dig> million reads targeting the v1-v <dig> hypervariable region of the 16s rrna genes of vaginal bacteria. we sought a classification method that would permit rapid and high-resolution identification of bacterial taxa to the species level or better, facilitate comparisons with previously published literature, enable incremental data analysis, and support classification of newly-identified vaginal taxa.

two general strategies are commonly used to classify 16s rdna reads:  taxonomic assignment approaches that utilize comprehensive databases   <cit> , arb-silva  <cit> , and greengenes  <cit> ); and  taxonomy-independent approaches that classify reads into operational taxonomic units . similarity searches against large public databases, such as the genbank nucleotide database , are problematic for taxonomic identification, in part, because these databases are incomplete and contain many unidentified and poorly annotated sequences. the rdp classifier  <cit> , a naïve bayesian classifier that makes assignments based on the composition of subsequences, is commonly used for taxonomic assignments because of its balance of accuracy, ease of use, and speed. however, the most common applications of the rdp classifier and training set achieve only resolution at best to the genus level. moreover, as many microorganisms that constitute the human microbiome have yet to be identified or sequenced, the 16s rdna reference databases are incomplete, thus often precluding resolution even to the genus level. others have recently used alignment-based methods  to classify 16s rdna reads, and the results of these methods are also highly dependent on reference database quality and completeness.

despite the challenges associated with these classification strategies, partial 16s rdna sequences of informative hypervariable regions can distinguish species assigned to the same genus. lactobacillus species, which often predominate in the vagina, provide a striking example. thus, the v1-v <dig> regions of 16s rrna gene sequences of the most common vaginal lactobacilli; i.e., l. crispatus, l. iners, l. gasseri, and l. jensenii, clearly distinguish these species  <cit> . as lactobacillus species differ in their abilities to exclude the growth of organisms associated with bacterial vaginosis  and other vaginal imbalances  <cit> , species-level resolution of lactobacilli is pivotal in a study of vaginal microflora. while multiple-gene and whole-genome analyses are usually required for sub-genus classifications  <cit> , many if not most species-level distinctions can similarly be made using partial 16s rrna gene sequences when high-quality curated reference databases are available.

de novo clustering methods that group sequences into otus have been widely adopted to address shortcomings of phylotype-based approaches  <cit> . these methods are valuable for characterizing datasets without prior knowledge, particularly in samples of largely uncharacterized complex bacterial communities. however, most otu algorithms are computationally intensive when applied to large datasets. moreover, the number of otus generated by these strategies is often inflated due to sequencing errors inherent in next-generation sequencing technologies  <cit> . finally, a biological interpretation of the otus and how they impact human health requires that they be put into taxonomic context that is linked to a known bacterial taxon or strain.

given the challenges associated with taxonomic assignment of 16s rdna sequences using standard approaches, we developed a comprehensive, non-redundant 16s rdna reference database of bacterial taxa commonly found in the vagina for use in classification of metagenomic 16s rdna sequence data derived from bacteria in vaginal samples. others have recently developed similar reference databases for the oral microbiome: core  <cit>  and the human oral microbiome database  <cit> . these studies demonstrate the feasibility of employing a body-site-specific 16s rdna reference database for taxonomic classification of metagenomic 16s sequence reads. such a resource is currently not available for the vaginal microbiome. here, we describe:  the vaginal 16s rdna reference database, a comprehensive and non-redundant database of 16s rdna reference sequences for vaginal taxa; and  stirrups, a general method for species-level classification that involves three steps: database curation, clustering reference database sequences into species-level taxa, and taxonomic classification using the stirrups classifier. the method is validated on reads from replicates of a mock sample containing dna from six vaginally relevant bacteria and applied to ~ <dig> million v1-v <dig> 16s rdna reads from samples obtained from mid-vaginal swabs.

methods
stirrups: species-level taxon identification of rdna reads using a usearch pipeline strategy
the stirrups method is comprised of the following steps:  curation of an appropriate database,  clustering the reference database sequences into species-level taxa, and  taxonomic classification using the stirrups classifier, a tool that employs the usearch algorithm <cit> . we describe the general method and the application of the method to a mock dna sample and a set of clinical samples collected from the mid-vaginal wall.

the vaginal 16s rdna reference database
a list of previously identified vaginal taxa was compiled from a comprehensive literature search, a review of vaginal species targeted by the hmp strains working group , a review of vaginal isolates at two major culture collections , and preliminary analyses from the vaginal human microbiome project  <cit> . we identified reference sequences for species from over  <dig> genera that are likely to be associated with the vaginal microbiome and three recently identified bv-associated bacteria in the order clostridiales .

for  <dig> of the targeted genera, we sought at least one representative 16s rdna sequence for every validly named bacterial species in the genus from the sequences available in genbank. however, based on the selection criteria , no appropriate sequence was available for approximately 30%  of the species from these genera, and these species were noted and excluded from the database  the online version of the list of prokaryotic names with standing in nomenclature   <cit>  was used to identify bacterial species that have been validly named according the international code of nomenclature of bacteria. well-documented, full-length sequences without ambiguous bases were selected when available. selected representative sequences contain no more than five ambiguous bases in the v1-v <dig> region and span the entire v1-v <dig> window, which has an average length of ~ <dig> bases. nucleotide-nucleotide blast searches against the non-redundant genbank nucleotide database were performed to ensure selection of representative reference sequences, and uchime  <cit> de novo chimera detection was used to identify and remove chimeric sequences. when multiple sequences were available for a given species, sequences from type strains or cultured clones were manually selected.

sequence variation plot
we used clustalw  <cit>  to generate multiple sequence alignments of the v1-v <dig> region of 16s rdna sequences by genus, where all validly named species from a given genus were aligned . the proportion of each nucleotide  at every position was calculated using mesquite  <cit> . gap characters were ignored. for each position in the alignment, shannon's diversity index was calculated as: h=-∑i=a,c,t,gplnp, where p represents the probability of each base i at position x. average shannon's diversity index values were smoothed over a sliding window of  <dig> bases and represented relative to escherichia coli 16s rrna gene numbering.

identification of new reference otus  from mid-vaginal samples
we performed abundantotu  <cit>  analyses to identify consensus sequences for non-rare otus present in the vaginal human microbiome project dataset of mid-vaginal reads. the purpose of this analysis was to obtain v1-v <dig> 16s rdna reference sequences for novel taxa and unnamed bacterial species that are present in vaginal samples. reads were binned by sample or by rdp classification  prior to analysis, to reduce computational demands. since consensus sequences inferred by abundantotu are often shorter than the targeted amplicon, we manually examined multiple sequence alignments, generated using muscle  <cit> , of reads from each otu to identify a reference sequence spanning the entire v1-v <dig> region. a small number of otus for which a full v1-v <dig> consensus could not be identified were not included in the database. nucleotide-nucleotide blast searches were performed to compare consensus sequences to relevant sequences in the genbank nucleotide database. if a v1-v <dig> reference otu sequence exhibited over 98% identity to a sequence corresponding to that of a validly named bacterial species, the species was evaluated for addition to the reference library using the criteria outlined above. otherwise, the consensus sequence was included as a 'candidate otu' reference sequence.

candidate otu reference sequences were screened for chimeras using three approaches:  uchime  <cit> de novo chimera detection,  uchime chimera detection using the 'gold' database  <cit>  of chimera-free sequences, and  careful manual inspection. only otu reference sequences that met the following minimal criteria were added to the vaginal 16s rdna reference database:  the otu was identified with at least  <dig> reads in at least two mid-vaginal samples using stirrups;  the new otu reference sequence was less than 98% identical to the v1-v <dig> rdna sequences of validly named bacterial species, or the otu reference sequence corresponded to a cultured strain yet to be assigned to a species; and  the reference otu sequence was not identified as chimeric.

clustering reference sequences into species-level taxa
partial 16s rrna genes from some bacterial species are too similar to be readily distinguished from one another. therefore, in the stirrups method, reference sequences are clustered into species-level taxa that can be readily differentiated to improve classification accuracy. we describe the method as applied to the vaginal 16s rdna reference database.

vaginal 16s rdna reference database sequences that aligned at ≥ 97% identity in the v1-v <dig> region using the usearch v <dig>  global alignment algorithm  <cit>  were assigned to the same species-level taxon. the vaginal human microbiome project protocol uses a forward sequencing orientation of v1-v <dig> 16s rdna reads. reference sequences may differ in some regions , but may be very similar in others , thus complicating species-level distinctions of short reads. therefore, we generated subsequences of the v1-v <dig> region of each reference sequence by trimming from the 3' end in one nucleotide increments to a minimum length of  <dig> bases, the minimum length of sequences that we process, and we subsequently aligned each subsequence to the reference library of the v1-v <dig> region of the selected sequences. additionally, reference sequences with subsequences that aligned with 97% identity or greater were assigned to the same species-level taxon. more formally, in a graph g where vertices are reference sequences and edges connect reference sequences assigned to the same species-level taxon based on sequence identity, each connected component was named as a species-level cluster. for stirrups classifier analysis , we specified the v1-v3-trimmed version of the 16s rdna database with species-level taxon assignments and a 97% identity threshold.

the stirrups classifier
the stirrups classifier was developed as a tool for species-level classification of rdna reads that summarizes taxonomic results by input sample. the software has an optional feature that permits integration of species-level results with rdp classification. the input files for the stirrups classifier are:  a concatenated fasta file with the following header fields: read identifier, sample identifier, rdp classification , and rdp confidence score ; and  a reference library file containing the reference sequences, the species-level taxon names , and the reference sequence names. the stirrups classifier employs usearch  <cit>  to align sequence reads to the reference library with the parameters for search termination and word count rejection disabled. the best hit in the reference database is identified for each read, and if the global sequence identity is greater than or equal to a user-selected level, e.g. 97%, the read is assigned to the corresponding species-level taxon. read counts and average global identities are summarized for each sample according to species-level taxon assignment. optional output files integrate species-level results with rdp classification results and summarize read counts according to best reference sequence hit. the stirrups classifier is available for download at http://sourceforge.net/projects/stirrups/files/.

mock community
the kjmock sample was prepared as mixture of six bacterial species commonly found in human vaginal samples; i.e., prevotella biva at  <dig>  ×  <dig> cells/ml, gardnerella vaginalis at  <dig>  ×  <dig> cells/ml, fusobacterium nucleatum at  <dig>  ×  <dig> cells/ml, lactobacillus crispatus at  <dig>  ×  <dig> cells/ml, staphylococcus epidermidis at  <dig>  ×  <dig> cells/ml, and enterococcus faecalis at  <dig>  ×  <dig> cells/ml. in brief, each of these bacterial strains was grown to late log phase. p. bivia, g. vaginalis, f. nucleatum were cultured in brain heart infusion broth  supplemented with 5% human serum, s. epidermidis was cultured in tryptic soy broth, e. faecalis was cultured in bhi, and l. crispatus was cultured in man rogosa sharpe . the bacteria were collected by centrifugation and suspended in phosphate buffered saline . the bacterial suspensions were diluted and plated to determine colony forming units. the suspensions were then combined, diluted to the final cell densities listed above, and frozen in single use aliquots at -80°c. dna from  <dig> μl of the kjmock sample was extracted using the powersoil dna isolation kit from mobio  as described by the manufacturer. the v1-v <dig> region of the 16s rdna was amplified, sequenced and analyzed according to the protocols of the vaginal human microbiome project  <cit> .

dataset of mid-vaginal 16s rdna reads from clinical samples
a dataset of ~ <dig> million 16s rdna reads targeting the v1-v <dig> hypervariable region were produced using the roche  <dig> gs flx titanium platform. these data were generated as part of the vaginal human microbiome project  <cit>  and represent a total of  <dig>  unique mid-vaginal samples. the institutional review boards for human subjects research at vcu  and the virginia department of health approved this study. consent was obtained from all participants. raw sequence data from the project is available from the short read archive at ncbi   <cit> .

we processed mid-vaginal reads for which:  valid primer and multiplex identifier sequences were observed;  less than 10% of base calls had a quality score less than 10;  the average quality score was greater than q20; and  the read length was between  <dig> and  <dig> bases. sequences were classified using a local installation of the rdp classifier   <cit> .

RESULTS
we describe an application of stirrups to:  a mock sample containing dna from six bacterial species commonly found in the human vagina, and  a set of samples from mid-vaginal swabs. the stirrups classifier employs the usearch algorithm, which uses a more efficient search algorithm than blast  <cit> , to classify reads to specific taxa. on a standard desktop computer , the stirrups classifier is able to classify one million reads with average read length of  <dig> nucleotides in approximately  <dig> minutes.

the vaginal 16s rdna reference database
currently, the vaginal 16s rdna reference database includes  <dig> partial  16s rdna reference sequences from bacterial genera and species likely to be of importance in studies of the vaginal microbiome. the database includes sequences from  <dig> bacterial species,  <dig> sequences corresponding to provisionally-named bv-associated bacteria in the order clostridiales, and  <dig> sequences from v1-v <dig> reference otus . several otu reference sequences that we have identified correspond to uncultured vaginal phylotypes that have been previously reported in the literature  <cit> ,  <cit>  or in genbank 16s rdna deposits. using a taxonomic outline where mollicutes are placed in tenericutes, six bacterial phyla are represented: firmicutes, actinobacteria, proteobacteria, fusobacteria, bacteroidetes and tenericutes.

the objective of this work was to develop a reference database that would permit us to identify the species from which an rdna read was derived. however, some sequences in the reference database are too similar in the v1-v <dig> region to be readily distinguished. the  <dig> reference sequences were trimmed to include only the v1-v <dig> window and grouped into  <dig> species-level taxa. of these species-level taxa,  <dig> are represented by a single reference sequence,  <dig> are represented by two reference sequences,  <dig> are represented by three reference sequences, and  <dig> are represented by four or more reference sequences . thus, v1-v <dig> region reference sequences for the most common vaginal lactobacillus species, including l. iners, l. crispatus, l. gasseri, l. jensenii, l. delbrueckii, l. vaginalis, l. coleohominis, and l. reuteri, segregate into distinct species-level taxa using a 97% identity criterion as outlined in the methods.

intra-genus sequence variability of the v1-v <dig> window of the 16s rrna gene
the v1-, v2-, and v3-hypervariable regions of the 16s rrna gene are not equally informative for making distinctions among species. figure  <dig> compares sequence variability across the v1-v <dig> region by genus. notably, the v1-v <dig> regions show greater variability than the v <dig> region among species of lactobacillus and prevotella. thus, for shorter 16s rdna sequences that do not cover the entire targeted v1-v <dig> region, sharper distinctions between different species of lactobacilli are afforded by a forward sequencing orientation  of 16s rdna amplicons compared to a reverse sequencing orientation . moreover, the v1-v <dig> window was found to be more informative for making distinctions among some genera  than others . these differences in information content were reflected in species-level taxon assignments , and sub-genus distinctions were possible even in genera with high sequence conservation . in contrast, some bacterial species from different genera  have v1-v <dig> 16s rdna sequences that are too similar to be readily distinguished from one another using the stirrups reference sequence clustering protocol . overall, our results show that species-level distinctions are possible for the vast majority of vaginally relevant genera using ~ <dig> base v1-v <dig> sequence reads such as those generated using the roche  <dig> flx titanium sequencing technology.

validation of stirrups using mock community samples
stirrups was validated using the kjmock sample, a mock community containing dna from six bacterial species commonly found in the human vagina . reference sequences for all species that compose the mock community are represented in the database, and table  <dig> shows the pairwise identities of the v1-v <dig> 16s rdna references for the six bacterial species in the mock sample. the pairwise sequence identities were very low, between  <dig> % and  <dig> %, suggesting that partial rdna sequences derived from the species in the mock community can be easily distinguished from one another.

s. epidermidis
f. nucleatum
l. crispatus
p. bivia
g. vaginalis
e. faecalis
the usearch algorithm was used to calculate global sequence identities of the v1-v <dig> region of 16s rdna reference sequences for the species in the kjmock sample. accession numbers for the reference sequences are: eu <dig> , af <dig> , fn <dig> , ab <dig> , cp <dig> , and cp <dig> .

a total of  <dig> replicates of the mock sample were independently pcr-amplified and sequenced with an average of approximately  <dig>  reads per replicate sample. in this dataset,  <dig> % of processed reads classified to a species-level taxon corresponding to one of the bacterial species represented in the kjmock sample. over 99% of the reads that were not classified by the stirrups pipeline best align to a reference sequence for one of the six expected species-level taxa with a score below the 97% identity cutoff used for species-level assignment, suggesting that the unclassified reads represent mostly reads with errors and/or chimeric sequences rather than misclassified reads or contaminants. only approximately  <dig> % of reads  were classified to a species-level taxon that was not present in the mock community, and these sequences corresponded to taxa representing probable low-level contaminants. a uchime  <cit>  analysis, using the v1-v <dig> trimmed database as a reference, identified  <dig> % of the processed reads from mock samples as likely chimeras.

application of stirrups to clinical samples
stirrups was used to classify ~ <dig> million v1-v <dig> 16s rdna reads from mid-vaginal samples. using a 97% identity threshold,  <dig> % of mid-vaginal reads were assigned to a species-level taxon, and  <dig> of the  <dig> species-level taxa in the database were identified using a 100-read threshold for the entire dataset. the database includes reference sequences for all species in the targeted genera with an appropriate reference sequence, not just those species associated with vaginal health. thus, it is not surprising that many taxa represented in the database are not present in mid-vaginal samples.

the usearch algorithm identifies the best hit in the reference database for each partial 16s rdna read. we found little ambiguity in taxon assignment with only  <dig> % of reads meeting the 97% identity threshold for reference sequences belonging to more than one species-level taxon. overall, we found good agreement between rdp and stirrups classifications at the genus level; e.g,  <dig> % of the rdna sequences classified to the genus lactobacillus by rdp  were classified to a lactobacillus species-level taxon by stirrups , and  <dig> % of reads classified to the genus prevotella by rdp  were assigned to a prevotella species-level taxon by stirrups. we found similar concordance between rdp and stirrups classification with reads classified to other genera. by integrating the stirrups results with rdp results, over  <dig> % of reads were classified to the genus-level or better, whereas only  <dig> % of the mid-vaginal reads from this dataset were classified with confidence  to the genus level by rdp alone . furthermore, we found that more than 86% of reads that could not be classified with confidence  to the phylum level using rdp alone  were in fact classified to a species-level taxon using stirrups.

CONCLUSIONS
given the plasticity of bacterial genomes, species- and strain-level analyses of microbiome datasets are essential to understanding pathogenesis and disease. we have developed and validated a protocol that provides species-level classification of v1-v <dig> 16s rdna sequences from the vaginal microbiome. in a dataset of ~ <dig> million reads from mid-vaginal samples that were generated as part of the vaginal human microbiome project at vcu,  <dig> % were classified to the species level using stirrups. moreover, an average of  <dig> % of reads from our mock sample replicates classified at the species level. these results suggest that the vaginal 16s rdna database contains sequences that correspond to, or that are closely related to, most bacterial species represented in the v1-v <dig> 16s rdna vaginal microbiome datasets examined. we anticipate that greater resolution of some species-level taxa will be possible using careful and targeted analyses, especially as we learn more about which nucleotide positions are associated with specific strain phenotypes. the vaginal 16s rdna reference db reference database may also be useful in training other tools such as the rdp classifier  <cit> .

in addition to being used in studies of the vaginal microbiome, stirrups may be used for species-level classification of other 16s rdna datasets where an appropriate database exists. stirrups permits rapid and high-resolution identification of bacterial taxa to the species level, provides taxonomic context, supports classification of newly identified taxa, and also permits incremental data analysis. thus, reads from new samples can be classified and compared with the results from previously analyzed samples.

defining the pan-vaginal microbiome
one of the goals of the overall human microbiome project is to identify microorganisms that colonize the human body and to understand how these organisms affect human health. it is clear that very little is known about many organisms of the vaginal microbiome, and even less is known about their interactions. notably, we have observed that some well-established vaginal pathogens are in fact detected at low abundance levels . while the current vaginal 16s rdna reference database contains sequences for the abundant vaginal taxa, we anticipate continued discovery of rare and minor taxa, which may nonetheless play an important role vaginal health. stirrups can be used to rapidly reclassify datasets of partial 16s rdna sequences as new reference sequences are identified and added to the database. moreover, stirrups classification results can be used to identify samples containing novel organisms for cultivation efforts, genomic sequencing, and whole metagenome shotgun sequencing studies. thus, we will likely gain a better understanding of the vaginal microbiome and its association with health and disease as novel vaginal taxa are described and as 16s rrna microbiome profiles are integrated with additional microbiome data types  and host assays .

competing interests
the authors declare that they have no competing interests.

authors' contributions
jmf coordinates the vaginal human microbiome project, designed the stirrups speciation methodology, curated the vaginal 16s reference database, identified novel otus, performed work on intra-genus sequence variability and validation, and drafted the manuscript.

mgs designed the stirrups speciation methodology and assisted in the content and writing of the manuscript.

nus designed the stirrups classifier architecture, led the development of the stirrups classifier, and assisted in the content and writing of the manuscript.

cmm implemented the stirrups classifier, contributed to the identification of novel otus, assisted with database validation, and assisted in the content and writing of the manuscript.

alg curated the vaginal 16s reference database and edited the manuscript.

jpb contributed to validation of the methodology and edited the manuscript.

kkj constructed the kjmock sample, contributed to the list of vaginally relevant taxa included in the reference database, and edited the manuscript.

vaginal microbiome consortium members contributed to the design and execution of the study, assisted in the analysis of the data, provided creative feedback, and commented on the manuscript.

gab set research priorities, prioritized the search for subgenus-level classification strategies, critiqued the design and implementation of the stirrups method and the vaginal 16s rdna database, and assisted in the content and writing of the manuscript.

all authors have read and approved the final version of the manuscript.

vaginal microbiome consortium at vcu
all authors are members of the vaginal microbiome consortium at vcu. additional members of the vaginal microbiome consortium who have contributed to this study are listed in alphabetical order: joão m.p. alves, christopher j. friedline, philippe h. girerd, michael d. harwich, stephanie l. hendricks, vladimir lee, melissa a. prestosa, federico a. puma, mark a. reimers, maria c. rivera, jerome f. strauss iii, and logan j. voegtly.

supplementary material
additional file 1
 multiple sequence alignment of v1-v <dig> 16s rdna sequences from lactobacillus species. the muscle algorithm was used to align the v1-v <dig> region of the 16s rdna reference sequences from  <dig> species of lactobacillus.

click here for file

 additional file 2
 multiple sequence alignment of v1-v <dig> 16s rdna sequences from prevotella species. the muscle algorithm was used to align the v1-v <dig> region of the 16s rdna reference sequences from  <dig> species of prevotella.

click here for file

 additional file 3
 multiple sequence alignment of v1-v <dig> 16s rdna sequences from staphylococcus species. the muscle algorithm was used to align the v1-v <dig> region of the 16s rdna reference sequences from  <dig> species of staphylococcus.

click here for file

 additional file 4
 vaginal 16d rdna reference database. the database includes the names of all reference sequences. genbank accession numbers and gene identifiers are provided for named species. species-level taxon assignments are based on clustering of v1-v <dig> 16s rdna reference sequences as described in the methods.

click here for file

 acknowledgements
this work was supported by nih grant uh2/uh3ai <dig>  the vaginal microbiome: disease, genetics, and the environment, from the national institute of health.

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2012: proceedings of the international conference on intelligent biology and medicine : genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/13/s <dig> 
