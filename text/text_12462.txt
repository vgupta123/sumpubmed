BACKGROUND
simulation studies provide a useful insight into the dynamics of epidemiological systems and can be used to obtain a variety of predictions, such as the relative gains expected from different types of control. difficulties often arise in the parameterisation of such models, as results may depend critically on parameters whose values are poorly understood, or which vary greatly between individual populations. a lack of knowledge of the value of a parameter is referred to here as uncertainty, and may represent either a lack of appropriate experimental studies or limitations in current methods for measurement. even if it were possible to know the value of each parameter in any given location or population, there may be variability in their values between locations or populations, as well as variability arising from inherent unpredictability in the system even for fixed parameters . an example of an infection exhibiting a high degree of uncertainty and variability in parameter values is that of paratuberculosis, or johne’s disease, a chronic inflammation of the intestine caused by the presence of mycobacterium avium subsp. paratuberculosis .

the low sensitivity of diagnostic tests and problems associated with culturing map bacteria and with carrying out experimental infections make laboratory studies difficult. furthermore the disease has a long and variable incubation period of many months or even years and generally clinical cases within a given herd occur only sporadically; indeed many infected animals may never be recognized as such. the most important source of infection is the faeces of infected animals  <cit> , so differing environmental conditions combined with the long incubation times are likely to contribute to a high degree of variability between farms. for example, the survival of map in pasture, or the relationship between levels of bacterial contamination and the animal-level force of infection, are likely to vary greatly on different farms, depending on factors such as soil acidity, micro-climate and details of the management practices of the farm. it is essential that such uncertainty and parameter variability are properly accounted for when evaluating potential control options.

we have developed an individual based model which incorporates key aspects of the stochastic dynamics of paratuberculosis transmission in combination with a detailed description of the management practices applicable to a typical scottish dairy herd. stochastic individual based modelling techniques have been applied with considerable success to epidemiological systems  <cit> . stochastic models can show considerable differences from their mean field equivalents  <cit> , particularly in cases with a high degree of nonlinearity , cases in which it is required to have a model of the inherent variability in the system, or situations with low prevalence where the statistics of disease extinction are of interest  <cit> . the stochastic nature of the model described here accounts for within-farm variability in the processes of disease transmission, progression and detection, and provides a suitable example with which to illustrate the use of the statistical methodology which we have developed to compare the impacts of control options.

in the approach taken here some of the parameters whose values are considered to be the most poorly known or to be the most variable between farms were assigned independent distributions of values. parameters which have been treated in this manner shall be referred to as sampled parameters. we used independent distributions because the literature typically does not provide information on the correlations between parameters. latin hypercube sampling  is an efficient means of sampling and combining parameters to generate a collection of k sample parameter sets, which gives coverage of the entire distribution for each parameter . this is achieved by dividing each distribution into k equally probable intervals, which can then be sampled and combined into the parameter sets for running the model using a latin hypercube design. a recent review  <cit> , highlighting a number of important features which have yet to be explored in paratuberculosis modelling research emphasised treatment of parameter uncertainty and model variability as key areas for improvement. previous attempts to model the epidemiology of paratuberculosis in cattle have ranged from the largely theoretical , to more detailed exercises which used published literature and expert opinion to parameterise models  <cit> , although a more recent model has carried out a more detailed sensitivity analysis  <cit> .

in order to account for correlations between parameters and to incorporate additional information available from observed prevalence data, a statistical methodology was developed which assigns weights to the sampled parameter sets by quantifying the model’s resultant ability to reproduce the prevalence data. outputs were subsequently obtained by running the model for all sampled parameter vectors with the outputs renormalized according to the assigned weights. once the parameterisation and weightings are in place the model can be used to investigate the impact of control strategies on the infection. this involves modelling the test procedure and applying it to individual model realisations, prior to the subsequent reweighting of the results. the reweighting was carried out using the weights obtained in the ‘reference scenario’ in which the only control strategy in place was the removal of clinical animals, in order to reflect the conditions under which the data were collected. in this way we have been able to produce probabilistic assessments of different control strategies that combine model assumptions, uncertain information about parameter values found in the literature and limited data on within-herd prevalence.

in section “paratuberculosis model design” we describe the model of paratuberculosis infection dynamics that has been designed for this study, and present its behaviour for a fixed set of parameters. the test models and infection management measures which were evaluated are also described. in section “latin hypercube sampling and reweighting parameter sets” we go on to describe in detail how the parameter uncertainty has been factored into the model by the use of the reweighted latin hypercube sampling scheme. in section “results and discussion” the results before and after the reweighting process are compared, showing how the reweighted results provide a close reproduction of the prevalence data upon which the weighting is based. we then examine the impact of test and cull control strategies, both with and without husbandry measures in place to control the spread of infection between individuals.

methods
paratuberculosis model design
the key aspects of paratuberculosis infection that we intended to capture in our model were the impact of herd management practices, the spread of infection through the environment, vertical and pseudo-vertical transmission from dam to calf, and the influence of imperfect tests on the effectiveness of control strategies.

a continuous time stochastic model was developed by assigning mean rates to the various possible events, from which inter-event times can be generated using the gillespie algorithm  <cit> . although the infection model is in continuous time, management decisions are taken on a discrete time basis, with a time step of one week, in order to reflect typical farm routines. individuals are assigned one of four management states  as well as one of five infection states . as the approach is computationally intensive, the model and reweighting procedure were constructed in the c programming language.

herd management
the herd was assumed to be closed . control methods which are found to be appropriate in the closed case will still be useful in the open herd situation if coupled with sensible purchasing strategies to minimize the risk of importing infection into the herd. the converse is not true, since the long-term epidemiological state of an open herd will be critically driven by the level of infection imported into the herd. therefore we have considered the long-term behaviour of the epidemic following the introduction of a single infected animal onto the farm. for the purposes of the current study a herd size of  <dig> dairy cattle was used, a figure which reflects average herd sizes in scotland circa  <dig>  <cit> , as well as the mean of  <dig> animals in the data set  <cit>  used in the reweighting procedure, described in section “latin hypercube sampling and reweighting parameter sets”. a spread rather than seasonal calving strategy was assumed, where individual births can occur at any point in the year so that no seasonal variation was included in the model. at birth, it was assumed that 50% of individuals are male, with these individuals being immediately culled. furthermore 8% of female calves are born dead or abnormal and removed from the model. after a fixed time span of  <dig> months individuals are moved into the next management state, “heifer”, in order to form a supply of new animals for the milking herd. a calf mortality rate μc of  <dig>  per animal per month was assumed, corresponding to an overall calf mortality of 5% over  <dig> months, as given by the milk development council  <cit> .

the herd was assumed to be operating under a set stocking management practice, in which a constant number of productive animals is maintained. animals in the heifer class are matured until they reach an age of  <dig> months. during this period they have an instantaneous mortality rate μh of  <dig>  per animal per month  <cit> . in order to keep the spread calving pattern intact, the death of an individual in the milking herd will result in the selection of a replacement from those heifers in the age range of  <dig> to  <dig> months, with a view to calving occurring at around  <dig> months. heifers which have not been selected by the time they reach  <dig> months are culled  <cit> , while if a replacement is needed when the pool of  <dig> to  <dig> month old animals is empty, a clean animal is bought in.

productive animals are pregnant for a period of  <dig> months, and then left empty for  <dig> months  <cit> . in order to calculate mortality rates for productive animals an estimate for the annual replacement fraction in a typical scottish dairy herd of  <dig>  was used, based on the scottish government economic report on scottish agriculture  <cit> . the proportion of culls which are due to age related factors was taken from literature estimates of  <dig>   <cit>  and  <dig>   <cit> . combining these figures gave estimates of the fraction of the herd culled annually for reasons not related to age, q, of  <dig>  and  <dig>  respectively. as this range is fairly narrow we take a fixed intermediate value of q= <dig> . this proportion is further partitioned into a fraction due to reproductive failure, taken as  <dig>   <cit> , with the remaining  <dig> %being assigned to other non-age related causes. an exponential inter-event time distribution was assumed, giving an instantaneous mortality rate for non-pregnant animals μa=−ln per year. as animals are pregnant for  <dig> months followed by  <dig> months empty, the expected length of pregnancy in a randomly selected  <dig> month block is 108/ <dig>  using this to generate the excess mortality μpassociated with pregnancy gives a total mean monthly rate for pregnant animals of 

  μa+μp=−ln/12−13ln/ <dig>  

an additional source of mortality in productive animals is culling due to decline in milk yield. in this model it was assumed that individuals are kept for a fixed number of lactations, n, and culled upon reaching this limit. the value of n is fixed for a particular farm or, equivalently, sample parameter set, but due to the wide range of values quoted in the literature was treated as one of the sampled parameters, with values between  <dig> and  <dig> lactations.

infection model
due to the long incubation period of paratuberculosis, it was assumed that no calves are in the shedding states of the model  <cit> . the principal route of transmission applicable to all animals is by ingestion of bacteria from the environment. in addition to the average level of environmental bacteria, adult  animals are exposed to a further bacterial source term representing an increased level around a clinical individual, whereas it was assumed that calves have little direct contact with animals other than their dam. let c be the level of bacteria in the environment at time t and za, yah and yal be the number of clinical, high and low shedding adults respectively. the number of sub-clinical individuals is denoted by xa for adults and xc for calves.

adult animals become infected at a rate 

  βdnaza+βainafa), 

where βdand βaiare parameters controlling the overall rate of direct and indirect infection, while na is the total number of adult individuals. the function fa) defines the relationship between the level of bacteria in the environment and the force of infection on a susceptible adult. for calves, infection through the environment is modelled in a similar manner to that in adults, with a rate 

  βcincfc), 

where βciis a further parameter controlling the rate of indirect infection of calves, and fc) defines the relationship between the level of bacteria in the environment and the force of infection on a susceptible calf.

where a calf is born to a shedding animal both in utero and post partum routes of infection were included. for in utero infection, the probability piuof being infected at birth is given by 

  piu=loglogpmaxfor a low shedding animalpmaxfor a high shedding animal 

in which αlow and αhigh are shedding rates, defined below, and pmaxis a sampled parameter.

in order to represent post partum infection an additional term is added to the in utero probability, so that the total probability of vertical infection is given by 

  pv=piu+uϕ1−piu. 

here u is a sampled parameter taken from a u distribution, representing the extent to which post partum infection through routes such as infected milk/colostrum is present in the model, while ϕis a parameter which is used to represent infection management on the farm by limiting dam-calf contact, as will be discussed in section “control measures”. in the absence of management interventions  the probability of post partum infection will range from piu to  <dig>  it was assumed that calves have little direct contact with animals other than their dam. calf to calf transmission has recently been demonstrated  <cit> , however we do not include this route as it is assumed to be a low probability event given the low levels of shedding.

the response functions fa and fc describe the infective impact of environmental bacteria. the true infective impact of any environmental infection is difficult to model as it will depend on the distribution of the bacteria and the grazing habits of the animals  <cit> . for this reason it is more useful to assume a simple functional form for this response, which will be nonlinear with a sigmoidal form obeying the natural constraints f= <dig> and limc→∞f=k. the constant k can be set to  <dig> without loss of generality as its value can be absorbed into the values of βd, βai and βci. given these constraints a piecewise linear function was used, as this has relatively few parameters involved and will allow more effective sampling, hence 

  f)=0ifc<cminc−cmincmax−cminifcmin<c<cmax1ifc>cmax 

with different values ccmin, ccmax, camin and camax for calves and adults. using a different function fc) for calf infection from the environment allowed for calves to be modelled as being at a higher risk of infection for a given level of contamination. the models of  <cit>  all assume that initial infection can only occur up to one year of age, whereas here it has merely been assumed that the rate of infection is higher for calves.

once infected each animal is assigned a sub-clinical phase of duration ti, which is drawn from a gamma distribution Γ for calves and Γ for adults. the parameters in these distributions were obtained by fitting to published data  <cit> . the sub-clinical period for each animal i is divided into the non-shedding phase of duration f1ti, the low shedding phase of duration f2ti and the high shedding phase of duration ti. these classes were designed to be analogous to those of  <cit> , with disease states also being similar to those used in  <cit> .

animals in the low shedding phase excrete bacteria at a rate αlow, while those in the high shedding state do so at a rate αhigh. in order to calculate these shedding parameters, an underlying exponential shedding process for an animal infected at time t <dig> of α=aeλwas assumed. at the start of the low shedding phase, a shedding rate α=αmin was assumed, which is derived using the faecal test model described in section “control measures” assuming a mean detection probability for an animal in the low shedding state equal to  <dig> , as given in  <cit> . the final shedding rate αti)=αmax, obtained when an animal reaches the clinical phase of infection, is likely to be the most critical to the epidemiology and was thus treated as a sampled parameter. given these values it is straightforward to calculate a and λ. the values of αlowand αhighwere then calculated as averages of the exponential process over the corresponding time periods, 

  αlow=1f2ti∫0f2tiα, 

  αhigh=1ti∫f2titiα. 

explicitly modelling shedding in this manner, allowing for some individuals to shed at extremely high rates, incorporates some of the issues addressed by mitchell et al.  <cit> , although the current model only allows for variability in shedding rates between realisations, rather than explicit inclusion of a small number of animals shedding at an exceptionally high rate. it is likely that such animals would have a relatively limited impact on the long term dynamics of infection as they would be easily picked up by faecal tests  <cit> , however they would contribute to additional variability in the observed dynamics, a feature which would not be observed in a deterministic model such as that of mitchell et al.

individuals in the clinical state were assigned a disease induced mortality μi which is added to their basic mortality rates, μh, μa or μa + μp, in order to reflect culling of such animals. it was assumed that an animal is culled one week after entering the clinical state, equivalent to a value for μiof  <dig> per animal per month.

environmental infection
mitchell et al. do not model environmental infection, but suggest that doing so would be worthwhile. the level of environmental contamination c was modelled as a deterministic process with a linear decay rate δ, which is a sampled parameter having a range of values that gives an infective dose a half life of between  <dig> and  <dig> days, consistent with data in  <cit> . the value of c is governed by the differential equation 

  dcdt=αlowyal+αhighyah+αmaxza−δc. 

a deterministic process was chosen as this quantity is likely to be very high, and hence the size of fluctuations will be relatively small. a stochastic process for a population of such a size would be extremely numerically intensive, whereas the deterministic process can be solved relatively straightforwardly. as yal, yah and za are stochastic variables, the function c will exhibit random changes in the growth rate at discrete time points. there is no source term in this equation as the bacterium is an obligate parasite. as the stochastic variables are discrete valued, it is possible to solve this equation piecewise in a sequence of time windows over which these variables are constant. over such an interval we can rewrite equation  as 

  dcdt=a−δc, 

in which a is constant. this equation has the solution 

  c=ce−δt+aδ1−e−δt, 

which allows forward calculation in time of c by inserting its value just prior to any change in the random variables as c, with the new value for a arising from the change.

control measures
we have examined simple control measures which consist of annual test and immediate cull of positive animals using simulated faecal culture and elisa tests, as well as infection management, which reduces both contact between dam and calf and the excess infection arising from localized exposure to clinical animals. the calf exposure and isolation of clinical case infection management methods have been run together, without examining their effects separately. they have also been examined in combination with each of the test and cull strategies.

reduction of the level of calf exposure from the dam was modelled by reducing the dam-calf contact parameter ϕ in equation  from  <dig> to  <dig> , which simulates reducing the level of post partum infection through routes such as infected milk or colostrum, although the probability of infection in utero remains unchanged. the impact of management on transmission from exposure to clinical individuals was examined by reducing the contact parameter βd to zero.

note that the elisa test, as well as being used in the simulation of control, was also used to model the collection of the reference data set for the fitting procedure described in section “latin hypercube sampling and reweighting parameter sets”.

elisa testing
an elisa testing process was modelled in which each animal is tested independently. based on the commercial herdchek elisa kit  <cit> , it was assumed that a proportion es= <dig>  of infected animals will sero-convert at a sufficient level to be detected at some point in their latent period. in order to determine at what time point this threshold is reached a random variable eτ is drawn from a beta distribution, beta. the parameters in this distribution have been derived from  <cit> , in which estimates are provided of the relative proportions of animals in the different shedding states which will be successfully detected. the elisa test was used to collect the parameterisation data set  <cit> , making it necessary to use this test model in order to model observed values from the underlying true within-herd prevalence, prior to carrying out the reweighting. a recent review compares the accuracies of elisa and other tests for paratuberculosis  <cit> .

faecal testing
although a piecewise constant form was used for the purposes of calculating the amount of bacteria deposited into the environment, it was necessary to explicitly model the rate of shedding when calculating a detection probability in modelling a faecal test. thus the shedding rate for an individual animal that has undergone a fraction t/ti of its latent period was modelled as 

  rs=0iftti<f <dig> αminαmaxαmin11−f1tti−f1iftti≥f <dig>  

we assume that the probability of detection is subject to poisson variability, with a proportion ff= <dig>  of an animals daily faecal production being used in the culture. we thus arrived at a detection probability 

  s=1−exp). 

the models used in  <cit>  and  <cit>  both used test sensitivities which monotonically increased with the severity of the infection, although in those cases a step function with fixed parameters was chosen.

latin hypercube sampling and reweighting parameter sets
in order to take proper account of parameter variability and uncertainty we have used a latin hypercube sampling scheme  <cit> , combined with a novel reweighting procedure, which selects parameter combinations that best reflect empirical data. among the parameters in the model, some are based on fairly consistent evidence, are considered unlikely to vary greatly between farms or may be considered less critical as the model is less sensitive to them. these parameters were not used as sampled parameters, but instead assigned point estimates, and are described in additional file 1: table s <dig>  while there is a degree of judgment required in the choice of these parameters and a trade-off between the number of sampled parameters and the efficiency of the procedure, other models do not account for uncertainty in parameter values, effectively choosing all parameters to be fixed,  <cit> , although in most cases the sensitivity of the model to each parameter is explored. for the sampled parameters, expert opinion together with a range of published estimates has enabled the calculation of an appropriate range and distribution for their values, as described in additional file 2: table s <dig>  samples were generated from the joint distribution of these parameters, assuming independence, by latin hypercube sampling  <cit> , in which each parameter distribution is divided into equally probable intervals and combined into parameter sets using a latin hypercube design in which each parameter interval appears once. thus to generate k parameter vectors, each sampled parameter distribution is divided into k equally probable intervals. the generation of the input parameter sets was carried out in r  <cit>  using the ‘lhs’ package.

as no correlation between the parameters has been assumed, the set of parameter combinations generated in this manner will contain some combinations which would have very low probability if the true joint distribution were known. typically information on correlation between such parameters is not available. in order to generate results over the ensemble of parameter sets a prevalence data set was used to derive a set of weights, effectively picking out the parameter combinations which gave rise to results which best reflected the data. to do this a reference scenario was used in the model which recreates the conditions under which the data were collected. the best dataset identified for this purpose was that of boelaert et al. <cit> , describing the belgian cattle population, as no comparable data for uk cattle populations were identified. boelaert et al. present this data in the form of a median and quartiles of the within-herd seroprevalence for different herd types including data for dairy cows. this necessitated the recasting of model outputs into the seroprevalences obtained by the elisa test model, described above, in order to generate these weights using comparable data.

for a sample parameter set labeled θ, the equilibrium simulated true and simulated observed within-herd prevalence distributions, which we denote pθ and p~θ respectively, were formed. this was done by running many realisations of the model for each parameter set θ, without use of any control methods other than the removal of clinical animals. each run was left for a burn-in period of  <dig> years in order to ensure equilibrium had been reached before taking the prevalence, either directly or through the simulated test, and generating the corresponding prevalence distribution from the set of values obtained. given that the seroprevalence distribution in the data is the within-herd distribution among infected farms, the distributions needed for generating weights are the zero censored distributions defined by 

  qθ=pθ1−pθp> <dig>  

for the underlying prevalence, together with 

  q~θ=p~θ1−p~θpobs> <dig>  

for the prevalence observed by elisa test. if pθ and p~θ are well defined probability distributions it is straightforward to see that qθ and q~θ are also.

for each parameter set the probability qθk of the observed seroprevalence falling into quartile k of the dataset  was calculated using 

  qθk=∫qk−1qkq~θdp. 

each parameter set was assigned a weight for that quartile 

  wθk=qθk∑θqθk. 

the final weights for each parameter set are given by combining the wθk for each quartile, 

  wθ=14∑k=14qθk∑θqθk. 

this is consistent with the concept that the observed prevalence distribution has been generated by a set of farms exhibiting between farm variability in parameter values. parameter sets which give rise to distributions which are generated by many other parameter sets will be given lower weight, due to the normalisation factor in this equation, whereas parameter sets that generate results in quartiles for which other parameter sets infrequently produce results will be given higher weights. the overall effect of this weighting is to ensure that the weighted outputs from all the parameter sets, when run under the reference scenario, match the observed quartiles from the data.

the set of weights was generated by running the reference scenario described above, which was designed to represent the conditions under which the data were collected, but once the final weights have been generated it is possible to run alternative scenarios, such as those with control present, and hence to form weighted prevalence distributions for different control options. in all such cases the weights used should be those generated as described above using the reference scenario.

RESULTS
when examining control, the system was allowed to reach an equilibrium by being run for a burn in period before the control begins, after which the system was run for a further  <dig> years with the control strategy in place. in order to show the effect of control on the time evolution of the system, figure  <dig> displays an equivalent density plot to that shown in figure 2b, with the addition of an annual elisa test and cull strategy commencing after the burn in period. it is clear that this strategy is highly unlikely to achieve eradication, as even after  <dig> years of control, there is still a significant probability  that a typical farm will be infected, with the rate of change of this value indicating that it is broadly at equilibrium.

the distributions of the within-herd prevalences are shown in figure  <dig> for various timepoints beyond the start of control, comparing strategies with and without management and elisa test and cull. from these figures it can be seen that the use of elisa test and cull has a limited and slow acting impact upon low prevalence farms, reflecting the low sensitivity of the test at the onset of infection. this is a consequence of the use of the beta distribution in the elisa model. as high shedding individuals are detected and removed from the population the effective sensitivity drops, demonstrating a fundamental limitation of any test which is not effective at the early stages of infection. by contrast, infection management predominantly targets younger animals, preventing infection from occurring and hence targeting high and low within-herd prevalence outbreaks equally. although it is not able to completely remove infection, it is able to compensate for the shortcomings of the elisa test and consequently the combined strategy is shown to be effective.

control strategies have been run here for  <dig> years in order to observe their effect over timespans which may be of interest in practise. over timescales of this magnitude it is likely that the values of parameters or other environmental factors will vary, and this change is not reflected in our analysis as the control options are evaluated in a fixed environment. if large scale longitudinal data were available the methods described here would be able to handle such change by using a combination of time dependent parameter distributions and weightings, thus allowing an investigation of these effects by comparison with the fixed environment examined here.

the reweighting approach implicitly allows for variation in sensitive or poorly understood parameters through the sampling algorithm. where changes in a parameter have a strong effect on the outcome of the model, the reweighting will tend to assign an appreciable weight only to a narrow sub-range of the initial distribution. thus, whilst the approach does not allow for the sensitivity of individual parameters to be quantified, such sensitivity is fully accounted for in the results.

CONCLUSIONS
a practical method of accounting for uncertainty and between farm variability in realistic models of disease transmission has been developed and shown to be an effective tool for predicting their behaviour. the example of paratuberculosis in dairy herds has been explored, a disease for which there is considerable uncertainty in the values of many key quantities affecting the dynamics. good agreement has been shown with the experimental within-herd prevalences in the control free scenario, so that with the inclusion of uncertainty and variability greater confidence can be felt in the extrapolations into the use of control.

the model developed here includes many of the key features of paratuberculosis infection, such as vertical infection as well as infection through a contaminated environment, important details when considering the common approaches to managing and eradicating infection that have been used here. using this model in combination with the reweighting scheme, we have been able to reproduce the within-herd prevalence distribution seen in the field data. regions with different distributions or where similar results are observed under different management or control scenarios will generate different weightings, and hence evaluations of the effectiveness of treatments will vary. this approach is able to deal with such variations and would be applicabe to making detailed regionalised predictions on the effectiveness of different control strategies. it would also be straightforward to incorporate post-control data into the generation of the weights, giving additional potential sources for increasing the robustness of the weighting scheme. furthermore it is anticipated that it will be possible to apply the reweighted lhs technique to other diseases and other models more generally.

the use of statistical approaches to parameterising models based on field data allows greater insight into the relative strengths of different control strategies and into the range of possible outcomes and associated variabilities, particularly in cases such as paratb in which there are a large number of biological parameters whose values are poorly understood.

author’s contributions
ijm and mh developed the study design, ijm conceived the reweighted lhs methodology. the underlying paratb model was initially implemented by jcw and then subsequently by rsd, with specific advice on the design, parameterisation and various aspects of paratb from ms, ks, ag and mh. the sampling and weighting schemes were initially implemented by jcw and further developed by rsd with advice from ijm and gm. the manuscript was prepared by rsd. all authors have read and approved the final manuscript.

supplementary material
additional file 1
parameter_tables <dig>  model fixed parameters.

click here for file

 additional file 2
parameter_tables <dig>  sampled parameters incorporated into the model via lhs.

click here for file

 acknowledgements
bioss and sac receive funding from the scottish government; much of this work was carried out as part of project bss/827/ <dig>  this project was also funded in part by the eu under the paratbtools project  <dig>  thanks to basil lowman, george gunn and michael pearce for useful discussions on the structure and management of scottish dairy herds.
