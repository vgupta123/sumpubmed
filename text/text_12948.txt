BACKGROUND
contamination is a well-known and ancient problem in molecular biology research. most people who have worked in a molecular biology laboratory for a while have at least once observed an extra band on a gel, or obtained dna sequence data originating from an unexpected species. projects involving a polymerase chain reaction  step are particularly sensitive to contamination because initially small amounts of foreign dna can accidentally be amplified by pcr, and transferred from tube to tube. a number of published results obtained by sanger sequencing were subsequently demonstrated to most likely result from laboratory contamination .

massive sequencing projects and databases based on next-generation sequencing  technologies are far from immune from contamination issues . the problem is perhaps even exacerbated, with contaminant sequence reads being lost in the myriad of reads from the target sample, and therefore difficult to detect and clean out. the concern is particularly serious when the target sample is from a non-model species lacking a reference genome, so that genuine sequence reads cannot be easily identified by similarity. it should be noted that many ngs library construction protocols involve one or multiple pcr amplification steps that generate elevated concentrations of dna, thereby increasing the risk of contamination.

contamination is a well-identified problem in projects targeting very small amounts of dna, such as ancient dna projects  <cit>  and low-frequency variant analysis , in which small amounts of contamination can be sufficient to confound the results. a couple of recent studies, however, have revealed that both cross-contamination  <cit>  and environmental contamination  <cit>  can cause serious problems even in standard ngs projects, that is, when target dna is a priori thought to be much more abundant than contaminant dna  <cit> . these studies ring an alarm bell and call for a systematic examination of the prevalence of contamination in past, present and future ngs datasets.

recently, we conducted a multispecies population genomic project in which one to ten individuals from each of > <dig> non-model species of animals were subjected to rna sequencing , leading to a number of scientific publications . the co-occurrence in the same laboratory of many samples from many distinct species in a relatively short period of time provides an ideal situation for investigating the effect of cross-contamination in a molecular ecology project. our goals in this study were multiple. first, we aimed to quantify the prevalence of cross-contamination, identifying at which steps of the experimental protocol it most often happens, and if possible delivering guidelines on how to avoid it. second, we wanted to check the robustness of our published results to the problem of contamination, and if possible identify solutions to this problem.

two distinct, complementary approaches were taken. regarding between-species contamination, cytochrome oxidase  <dig>  was used to detect the occurrence of foreign cdna sequences in a sample and trace their likely sources. cox <dig> is a high-expressed gene, and is therefore expectedly prevalent in rnaseq data. it is the standard dna barcoding tool in animals, so a huge database of cox <dig> reference sequences from many distinct species of animals is available. regarding within-species contamination, patterns of read counts were analyzed to search for evidence of allele leakage across individuals. the inferred patterns of contamination across individuals and species were considered in the light of laboratory metadata – dates of entry and processing of samples in the laboratory, identity of technicians in charge of the samples, date of shipment to sequencing center, identity of sequencing center, flowcell number, and lane number. a modified single nucleotide polymorphism -calling method that accounts for among-individual contamination was introduced and a re-analysis of our main published results was conducted.

methods
project overview and protocols
european research council project  <dig> “popphyl” took place at the institute of evolutionary sciences montpellier, france, from june  <dig> to december  <dig>  during this period, samples from > <dig> distinct individuals of  <dig> species from eight phyla of animals entered the laboratory located in building  <dig> of university montpellier, france. samples were either collected by ourselves in the field or shipped by colleagues in rnalater®  buffer. a fraction of the samples were barcoded after dna extraction and cox <dig> amplification. roughly  <dig> samples were subjected to rna isolation following standard or modified protocols  <cit> . the quality and quantity of extracted rna were assessed using spectrophotometry and capillary electrophoresis. total rna from  <dig> of these samples was sent out for illumina sequencing on either a genome analyzer ii  or a hiseq  <dig> . illumina library construction, dna fragment tagging, pooling, and demultiplexing were achieved in the sequencing centers. short-read data were returned to us as one or several fastq files per sample and we performed the downstream bioinformatic analyses  <cit> . no more than one sample per individual was sent out for sequencing. the individual samples that were sent out for sequencing belonged to  <dig> distinct species. sixty-three additional species were subjected to rna extraction but not sent out for illumina sequencing.

in our laboratory, eight distinct persons, referred to below as “technicians,” processed the samples. two technicians collectively processed ~80% of the samples. these two technicians, and the majority of the other technicians involved, were 100% dedicated to the project and did not  manipulate biological material coming from species not included in the project. in  <dig> species, the same technician processed all the samples, whereas in  <dig> species, two distinct technicians were involved. all samples were processed at the same laboratory bench, in a room almost entirely dedicated to the project, with specific materials shared by the involved technicians.

samples were sent to sequencing centers in dry ice at  <dig> distinct dates, from september  <dig>   <dig>  to february  <dig>   <dig>  shipments typically involved several individuals from several distinct species. in each shipment, samples were contained in separate, labeled tubes that were gathered in a single box and accompanied by a form briefly describing the label and content of each tube. tubes in boxes were organized by species and ordered consistently with the form. when more than one technician was involved in a shipment, tubes were ordered by technician, that is, samples processed by technician  <dig> first, then samples processed by technician  <dig>  tubes were not opened at shipment stage: they were simply taken out from freezers, packed, and transferred to the carrier. samples were sent to three distinct sequencing centers, of which one  processed ~85% of the samples. the dates of first entry in the laboratory, first and last experiment in the laboratory, and shipment were recorded per species. this information is available in additional file 1: table s <dig>  details on experimental dates per sample are available on request. we also retrieved flowcell identifiers and lane numbers from read headers in fastq files – this information was absent from  <dig> of the files we received, though. we have no information on the dates of library construction and the identity of the technicians involved in library construction and sequencing.

short-read data sets
we analyzed illumina short-read data sets from  <dig> individuals of  <dig> species . read length was  <dig> in  <dig> individuals ,  <dig> in  <dig> individuals , and  <dig> in  <dig> individuals . single-end sequencing was ordered in all cases. occasionally, sequencing centers still returned paired-end reads, which were treated as single-end reads in our analyses for the sake of homogeneity – meaning that both reads were treated as independent events. the total number of reads varied from  <dig>  to  <dig> millions among samples. samples sequenced later in the project typically received more reads than early-sequenced samples. most of the generated data sets have been submitted to the national center for biotechnology information  sequence reads archive  under bioprojects prjna <dig>  prjna <dig>  prjna <dig>  prjna <dig>  prjna <dig>  and prjna <dig>  we here publish data from an additional  <dig> individuals from  <dig> species, which were submitted to ncbi-sra under bioproject prjna <dig>  a list of sequenced individuals with associated identifiers is provided in additional file 2: table s <dig> 

cox <dig> reference database
we created a reference database of cox <dig> sequences for subsequent sequence similarity searches. this database had three components: a target species component, a companion species component, and a model species component. the target species component corresponds to cox <dig> sequences from the species that have been subjected to dna barcoding and/or rna extraction in our laboratory between  <dig> and  <dig>  we automatically downloaded target species cox <dig> sequences from the barcode of life database  <cit>  , accounting for taxonomic synonymy – we equated myodes with clethrionomys, cervus with rucervus, parus with cyanistes, mellicta with melitaea, physa with physella, galba with lymnaea, lineus with ramphogordius, and abatus agassizi with abatus agassizii. sequences in the barcode of life data system  database are binned based on similarity. we kept a single cox <dig> sequence per bin per target species, maximizing sequence length and number of annotations – geographic origin, collector, sampling date, lifestyle, tissue, and existence of voucher. sequences not assigned to a bin were excluded. a similarity search was performed by blast to the ncbi non-redundant  database. thirteen sequences not hitting any cox <dig> sequences from nr were removed or manually replaced. some of our target species were not represented in the bold database. for these we performed a manual search in genbank and retrieved additional cox <dig> sequences.

the companion species component of our reference cox <dig> database corresponds to species that never entered our laboratory, but that are phylogenetically related to target species. for each genus of our target species sample, we identified a companion genus from the same family or same order in which cox <dig> sequences were available in a roughly equivalent number of species . the same automatic and cleaning procedure as described above for target species was applied to companion species, with the exception that we did not manually search genbank for companion species. the companion species component was added as a negative control, that is, a measure of the prevalence of seemingly foreign cox <dig> sequences in our samples due to experimental noise, in the absence of contamination.

the model species component of our reference cox <dig> database corresponds to species of animals that are frequently subjected to ngs projects, with which our samples might have been in contact at some point during the experimental protocol – including homo sapiens. we selected the  <dig> species of animals with the largest number of entries in the ncbi-sra database , and retrieved the complete cox <dig> sequence of each of these.


cox <dig> sequences from the target species, companion species, and model species were aligned using macse  <cit> . a single segment of the cox <dig> sequence was selected, from position  <dig> to position  <dig> . sequences for which the segment was not entirely determined were discarded. for each genus of the target species component, a phylogenetic tree was reconstructed using phyml in seaview  <cit>  and inspected by eye. obvious anomalies were corrected by removing the misplaced sequences, in light of existing taxon-specific literature when available. our reference cox <dig> sequence alignment is provided as additional file  <dig> 

detection of between-species contamination
short-read illumina data sets were cleaned for low-quality reads or read portions as described previously  <cit> . reads were mapped to the reference cox <dig> database using burrows-wheeler aligner  software  <cit> . mapping tolerance was one mismatch for data sets in which read length was  <dig> and two mismatches for data sets in which read length was  <dig> or  <dig>  the best scoring hit of each read, if any, was recorded – note that in case of equal mapping scores, bwa will randomly output one of the highest scoring hits. for each individual, the number of hits for each sequence of the reference database was recorded and normalized by total number of reads for the considered individual. the results were then summed up by species in order to calculate, for every pair of species , the total number of cox <dig> reads from sp <dig> mapping to a reference sequence from sp <dig>  species from the reference database between which cox <dig> divergence was <5% were considered as non-diagnostic, meaning that a hit of a sp <dig> read to a sp <dig> read was only considered to reflect contamination if cox <dig> divergence between sp <dig> and sp <dig> was >5%. when more than one reference sequence per species was available, we required that the minimal divergence between any two cox <dig> sequences from the two species be >5%. sixty such closely related species pairs were identified. these analyses were performed using homemade programs in c++ and r.

read counts, homo-quartets, and detection of within-species contamination
for each species including at least four individuals, transcriptome assembly was performed using a combination of abyss  <cit>  and cap <dig>  <cit> , as described previously  <cit> . reads were mapped to predicted cdnas using bwa, following  <cit>  and  <cit> , and potential pcr duplicates were removed – meaning that identical reads in any particular individual were counted only once. open reading frames were predicted as in  <cit>  and coding sequences were retained. for each position of each coding sequence and each individual, the number of reads for the four possible states a, c, g, and t were recorded. below we refer to these vectors of counts as “quartets.”

to characterize within-species, between-individual contamination, we focused on quartets in which  exactly two states were observed,  read count was high  for the most prevalent state, and  read count was exactly one for the other state. such quartets were assumed to correspond to genotypes that are homozygous for the major state and in which an error had been introduced – the minor state. we called these quartets “homo-quartets.” we defined two categories of homo-quartets, depending on the read counts in other individuals at the same position. the first category corresponds to homo-quartets occurring at positions dominated by the major state – specifically, when the sum across individuals of allele counts for the major state was >95% of total counts. such positions were called monoallelic . the second category corresponds to homo-quartets occurring at positions in which two alleles were found at a substantial frequency – specifically, when the sum across individuals of read counts for the second more frequent state was more than 10n, n being the number of genotyped individuals. such positions were called biallelic . homo-quartets not falling in either of these two categories were disregarded.fig.  <dig> detection of within-species contamination through homo-quartet analysis. each multicolored square represents a quartet, that is, read counts for states a , c , g , and t  at a specific position in a specific individual, zeros being omitted. a fictive dataset of four individuals  and five positions  is shown. at all five positions, the quartet for individual ind <dig> is a homo-quartet : the major state has more than  <dig> reads, and the minor state has exactly one read. positions pos <dig> and pos <dig> are monoallelic: the major state represents more than 95% of reads across the four individuals. these two positions inform on the contamination-free error pattern. positions pos <dig>  pos <dig>  and pos <dig> are biallelic: besides the major state, another allele segregates in the sample. at pos <dig> the ind <dig>  the minor state  differs from the other segregating allele ; this error cannot result from within-species contamination. at pos <dig> and pos <dig>  the ind <dig> minor state is identical to the other segregating allele , potentially reflecting allele leakage between individuals, as indicated by red arrows. the proportions of these different types of position inform on the prevalence of within-species contamination




we reasoned that, in the absence of contamination, the identity of the minor state in any given homo-quartet should be independent of read counts for other individuals, so that a similar pattern of sequencing error would be expected for the two categories of homo-quartets. if, however, the distribution of the minor state in homo-quartets differed between monoallelic and biallelic positions, and was influenced at biallelic positions by the identity of alleles segregating in the sample, then such a pattern would demonstrate the existence of within-species contamination .

formally, for each species, we first considered homo-quartets occurring at monoallelic positions and calculated p, the matrix of minor state prevalence given the major state:  <dig> pab=hmonoab/∑hmonoak 


where a and b are two of the four a, c, g, and t states , and h
mono is the number of homo-quartets occurring at monoallelic positions and having a as the major state and b as the minor state. p can be understood as an estimate of the error matrix at monoallellic positions.

then we considered homo-quartets occurring at biallelic positions and calculated q
obs, the observed prevalence as a minor state of the other allele segregating at the considered position:  <dig> qobs=∑rzk/hbi 


where h
bi is the number of homo-quartets occurring at biallelic positions, z is the allele different from the major state segregating at the position at which homo-quartet k occurs, and r
z is read count for state z at homo-quartet k. by definition of homo-quartets, r
z must be zero or one. this number was compared to q
exp, the expected prevalence as a minor state in homo-quartets of the other segregating allele assuming no contamination, that is, assuming that sequencing errors at homo-quartets occurring at biallelic positions are well predicted by p:  <dig> qexp=∑paz/∑∑pai 


where a is the major state of homo-quartet k and z is the allele different from a segregating at the position at which k occurs. we defined λ, the index of allele leakage among individuals within a species as:  <dig> λ=/qexp 


λ is expected to equal zero in the absence of contamination, that is, when the identity of the minor state for a given homo-quartet is independent of the genotypes and read counts of other individuals.

contamination-aware genotype calling
we modified our genotype-calling procedure  <cit>  to account for between-individual, within-species contamination. following  <cit> , we describe a quartet r by r
 <dig> , r
 <dig> , r
 <dig> , and r
 <dig> , and define r = r
1 + r
2 + r
3+ r
 <dig>  let us call f
 <dig>  f
 <dig>  f
 <dig>  and f
 <dig> the frequencies of alleles a, c, g, and t in the population at the considered position. assuming hardy-weinberg equilibrium and a constant error rate ε, the probability of a quartet can be written as:  <dig> prr=∑a=14∑b=a4fafbr!r1!r2!r3!r4!∏x=14qxabrx 


with  <dig> qaaa=1−3ε 
  <dig> qbaa=ε 
  <dig> qaab=1/2−ε 
  <dig> qcab=ε 


where a ≠ b ≠ c are in {a,c,g,t}. q
x is the probability of calling state x from an individual carrying genotype {y,z}. equations  <dig>   <dig>   <dig>   <dig>  and  <dig> assume that, for every read, the genuine state will be called with probability 1 − 3ε, whereas an erroneous state will be called with probability ε. equation  <dig> sums the contributions of the  <dig> possible diploid genotypes to the likelihood of r. in our implementation, the allele frequencies f
k were estimated from observed read counts, the error rate was estimated by maximizing the likelihood function, and distinct rates were assumed for transition-type vs. transversion-type errors  <cit> .

here, we introduce a generalization of eqs.  <dig>   <dig>   <dig>  and 9:  <dig> qaaa=1−γ1−3ε+γfa'1−3ε+1−fa'ε 
  <dig> qbaa=1−γε+γfb'1−3ε+1−fb'ε 
  <dig> qaab=1−γ1/2−ε+γfa'1−3ε+1−fa'ε 
  <dig> qcab=1−γε+γfc'1−3ε+1−fc'ε 


where f
x' is the frequency of reads of state x at the considered position excluding the focal individual. equations  <dig>   <dig>   <dig>  and  <dig> assume that with probability  a read state is determined by genotype and error rate, as in the original method, whereas with probability γ a read state is obtained by randomly sampling one state at the considered position, excluding reads from the focal individual. here, γ is the probability of contamination, and is assumed to be homogeneously distributed across individuals of the sample. note that even a contaminant read can be affected by sequencing error, as expressed in the right-hand term of eqs.  <dig>   <dig>   <dig>  and  <dig>  genotypes and snps were called assuming four distinct values for γ, namely γ =  <dig> , γ =  <dig> , γ =  <dig> , and γ =  <dig> .

RESULTS
cox <dig> reference database
we created a reference database of  <dig> aligned, partial, 351-bp-long cox <dig> sequences. the database included a mixture of sequences from our target species , companion species , and model species . target species were intended to trace cross-contamination among samples. companion species were introduced as negative controls. model species were introduced to search for contamination by standard laboratory organisms. in our reference databases,  <dig> of our target species were not represented at all,  <dig> were represented by a single cox <dig> sequence, and six were represented by more than ten cox <dig> sequences, implying that our ability to detect the occurrence of a given species in a given sample varied among species.

patterns of between-species contamination
short sequence reads from each of  <dig> samples  from  <dig> species were aligned to our reference cox <dig> database using bwa. the number of hits to each reference sequence was recorded and divided by the number of millions of reads of the considered sample. for each sample, we calculated the prevalence of cox <dig> hits to a reference sequence from the expected species, and the prevalence of cox <dig> hits to a reference sequence from an unexpected species – that is, a species differing from the expected species by >5% of cox <dig> divergence. hits to a species different but <5% divergent from the expected one were not counted.

figure  <dig> shows an overview of the contamination pattern in this large-scale data set. figure 2a shows the across-samples distribution of the prevalence of expected  vs. unexpected  cox <dig> reads, while fig. 2b plots these two variables. the across-samples median prevalence of expected cox <dig> reads was  <dig> cox <dig> reads per million. the prevalence of expected cox <dig> reads was sometimes low: it was < <dig> per million in  <dig> samples, and zero in  <dig> samples, of which  <dig> were from a species that was represented in our reference cox <dig> database. this is quite surprising, given that cox <dig> is considered a generally high-expressed gene. this result might be explained by insufficient/inappropriate species representation in the reference database for these particular samples. it might also be that in some taxa mitochondrial transcripts lack a polya tail  and were therefore excluded at the retrotranscription stage in our protocol.fig.  <dig> overall pattern of between-species contamination. a among-sample distribution of the prevalence of reads mapping to a cox <dig> reference from the expected  or an unexpected  species. prevalence is defined as the number of cox <dig> reads per million reads. b relationship between the prevalence of cox <dig> reads mapping to the expected  vs. an unexpected  species, again per million reads. each dot represents a sample. plain line: ratio of unexpected to expected cox <dig> reads is one. dotted lines: ratio of unexpected to expected cox <dig> reads is  <dig>  . samples from species not represented in our cox <dig> reference database are not shown




we found at least one hit to an unexpected species in  <dig> of the  <dig> samples. the prevalence of unexpected cox <dig> hits was > <dig> per million in  <dig> samples, and > <dig> per million in seven samples. one species, woodlouse armadillidium vulgare, was particularly affected by unexpected hits – six individuals out of ten showed > <dig> per million unexpected hits. twelve samples for which the prevalence of expected hits was > <dig> per million had a ratio of unexpected to expected hits > <dig> , and two samples, ga24o  and ga17l , had a ratio > <dig> . in summary, expected cox <dig> reads clearly dominated but contaminant reads were common and reached a high prevalence in a substantial number of samples.

the vast majority  of the  <dig>  unexpected cox <dig> reads originated from target species. only  <dig> % of the unexpected hits were assigned to a companion species, and  <dig> % to a model species. the low prevalence of companion species was expected and confirmed that unexpected cox <dig> hits result almost uniquely from contamination. regarding model species, we detected human cox <dig> reads in ten samples from nine distinct species, but always at very low prevalence – the total number of reads hitting a human cox <dig> sequence was  <dig>  mus musculus and bos taurus were more prevalent in terms of total reads , but concerned a smaller number of samples  and species .

among the  <dig> analyzed samples,  <dig> included at least one read mapping to an unexpected species – that is, showed evidence for between-species contamination. of these,  <dig> were contaminated by at least two species, and we detected up to eight contaminant species in samples ga08r  and ga34l . summing contaminant species across samples, we found that the data set had been affected by at least  <dig> distinct events of between-species contamination. this is an underestimate, due to the incompleteness of our reference database, our inability to detect contamination between closely related species, and the possibility of multiple events of contaminations of a given sample by a given species. the number of expected cox <dig> reads, unexpected cox <dig> reads, and contaminant species per sample are available in additional file 2: table s <dig>  reversely,  <dig> of the  <dig> species we processed in this project did contaminate at least one sample from another species. among these, four species contaminated more than  <dig> distinct samples, and one, king penguin aptenodytes patagonicus, contaminated samples from as many as  <dig> distinct species . we found that the mean prevalence of expected cox <dig> reads of a species was significantly correlated with the number of individuals it contaminated  and with the total number of contaminant reads it contributed .

dubious samples
two samples resulted in unexpected patterns. sample ga36k, assigned to species mytilus trossulus , yielded a single cox <dig> read that mapped to a m. trossulus reference, but > <dig>  cox <dig> reads that mapped to a sequence from either m. edulis or m. galloprovincialis, two interbreeding species of european mussels . by contrast, 99% of cox <dig> reads from the other m. trossulus sample that we analyzed, ga36l, mapped to a m. trossulus reference. the ga36k sample was collected in seattle, wa, usa, a state in which invasive populations of european mussels are documented  <cit> . sample ga36k therefore probably results from an identification error, or reflects m. galloprovincialis/edulis mtdna introgression into m. trossulus.

similarly, sample ga08f, assigned to glanville fritillary melitaea cinxia , did not yield a single cox <dig> read that mapped to a m. cinxia reference, but > <dig>  cox <dig> reads that mapped to a reference from the spanish fritillary euphydryas desfontainii. this species is quite divergent from m. cinxia, both morphologically and molecularly , so mtdna introgression and misidentification appear unlikely in this case. according to our records, the ga08f sample came from aland, finland, a place where e. desfontainii does not occur. we did, however, sample e. desfontainii, together with m. cinxia, in morocco. the problem, therefore, probably resulted from sample mislabeling. the ga08f sample very likely belongs to e. desfontainii and was mistaken for an m. cinxia individual in our published analyses. we checked, however, that our main results are robust to these problems .

analysis of laboratory metadata
we created a between-species contamination matrix m in which cell m
ij contained zero in the absence of evidence for contamination of species j by species i, one in case of the detected contamination of species j by species i, and missing data if species i and j were <5% divergent cox1-wise, such that contamination detection was assumed to be unreliable. here, a single read from any individual of species i hitting a reference sequence from species j was considered sufficient to attest for an event of contamination of i by j. requiring at least ten unexpected reads, instead of just one, yielded qualitatively similar results. the  <dig> samples from species not represented in our reference cox <dig> database were here disregarded, so that sample size was  <dig> in this analysis. the total number of ones in m was  <dig>  and the total number of pairs of species sufficiently divergent such that contamination detection was possible was  <dig> , so that the proportion of species pairs for which an event of contamination was detected was p =  <dig> .

we focused on five predictors of the probability for two species to be connected by contamination, namely lab_overlap, same_technician, same_shipment, same_flowcell, and same_lane. to calculate the lab_overlap variable, we first defined the processing period of any given species as the period from date of entry into our laboratory to date of last shipment to a sequencing center. for any given pair of species, lab_overlap was defined as the length, in days, of the intersection between the processing periods of the two species. the same_technician variable was a boolean variable set to one if at least one sample of each of the two considered species was treated by the same person in our laboratory, and to zero otherwise. similarly, the same_shipment, same_flowcell, and same_lane variables indicated whether at least one sample of each of the two considered species had been shipped on the same day to the same sequencing center, or sequenced on the same flowcell/same lane, respectively.

we calculated the average value of these variables across all pairs of species for which an event of contamination was attested , and compared these to null distributions obtained by shuffling zeros and ones in the contamination matrix . more precisely, each cell of a randomized matrix was assigned one with probability p, or zero with probability , with missing data being left unchanged, where p =  <dig>  was the overall probability of contamination . we detected a strong and significant effect of each of the five variables: compared to the average species pair, species contaminating each other tended to have a longer period of overlap in our laboratory, to be handled by the same technician, and to be sent the same day and sequenced on the same flowcell. the effect of sequencing center-associated variables was particularly strong. for instance, the probability for two species that were shipped together to be connected by an event of contamination was  <dig> , that is, more than ten times the unconditional probability. the same_lane pattern was very similar to same_flowcell and is not shown in fig.  <dig> fig.  <dig> effect of laboratory metadata on the probability of between-species contamination. four statistics are shown: lab_overlap , same_technician , same_shipment , same_flowcell . x-axis: average value of each statistics. vertical red line: actual data set. y-axis: number of randomized data sets . white histograms: expected distribution assuming random probability of contamination. blue histograms: expected distribution assuming that contamination is dependent on same_shipment. green histograms: expected distribution assuming that contamination is dependent on lab_overlap and same_technician




the five analyzed variables were significantly correlated with each other. we tried to disentangle their effects, and particularly distinguish the influence of our laboratory from that of sequencing centers. to this aim, we compared the observed value of lab_overlap and same_technician to null distributions obtained by reshuffling m in a way that controls for the effects of same_shipment . in this analysis, each  cell of a randomized matrix was assigned one with probability p
ij, or zero with probability , again leaving missing data unchanged, where p
ij was the probability of contamination knowing same_shipment. these were obtained by calculating the proportion of ones in m conditional on values  <dig> or  <dig> for same_shipment. similarly, the null distributions of same_shipment and same_flowcell conditional on lab_overlap and same_technician were generated . the effects of the five variables were still significant in these control analyses: a laboratory effect was detected when controlling for sequencing center-associated variables and a sequencing center effect was detected when controlling for laboratory-associated variables.

to analyze this effect more deeply, we created two synthetic variables summarizing the effect of laboratory  and sequencing center , respectively. the lab variable was positive when same_technician was true and lab_overlap was >200 days, but negative otherwise. the center variable was negative for pairs of species shipped on distinct dates, but positive otherwise. regarding species pairs that were sent together, we distinguished pairs sequenced on distinct flowcells , the same flowcell but distinct lanes , and the same lane . in this analysis we focused on the  <dig> species for which information on shipment dates, flowcell, and lane numbers was available for all individuals. as far as species sent on distinct dates were concerned , the contamination probability was very low regardless of lab . this seems to be incompatible with the hypothesis of a substantial level of contamination in our laboratory. in contrast, the probability that two species shipped on the same day were connected by an event of contamination was as high as  <dig> , and further increased in case of shared flowcell and shared lane , reaching values > <dig> .table  <dig> effect of laboratory and sequencing center variables on the probability of contamination





data are presented as: contamination probability 




surprisingly, we detected a strong and significant interaction between the lab and center variables . two species being shipped the same day , overlapping in our laboratory, and being handled by the same technician  substantially increased the probability of contamination. we suggest that this is an induced effect resulting from the fact that tubes in shipped boxes were ordered by technician, so that samples processed by the same technician in our laboratory were presumably more likely to be processed together by sequencing centers, and therefore to contaminate each other. to test this hypothesis, we subsampled species in such a way that a single species per technician per shipment was kept, so that no induced effect of same_shipment on same_technician was possible. we found eight events of contamination between the  <dig> species of the subsample. there was still a significant effect of same_shipment on contamination probability in this subsample, but no effect of lab_overlap or same_technician was detected , suggesting that the lab effect conditional on center+ reported in table  <dig> was an induced effect. these analyses therefore indicate that the vast majority of the events of between-species contamination we detected occurred in sequencing centers. the results were qualitatively unchanged when a 10% threshold was used, instead of 5%, for the minimal cox <dig> divergence between contaminant and contaminated species .

laboratory contamination: detailed analysis
eight events of contamination were detected between species that were not shipped on the same date. of these, four involved glanville fritillary m. cinxia. this is the one species in our data set that included samples for which data on shipment date are missing . the three species that contaminated or were contaminated by m. cinxia but lacked an attested shared shipment date with m. cinxia – iberian hare lepus granatensis, mountain hare l. timidus and ascidian ciona intestinalis a – were shipped the same day, may  <dig>   <dig>  it seems therefore possible, not to say probable, that samples ga08b to ga08f were actually sent out for sequencing on may  <dig>   <dig>  and that contamination occurred in the sequencing center in this case, too.

besides these four cases, one detected event of contamination between species not shipped on the same date involved gorgonian eunicella cavolini and european blue mussel m. galloprovincialis. e. cavolini, however, shares a shipment date  with m. edulis, the other species of european mussel, which hybridizes with m. galloprovincialis – the two species have very similar haplotypes in our reference cox <dig> database. a closer inspection of the data revealed that the single e. cavolini sample, ga31l, affected by contamination from m. galloprovincialis is the single e. cavolini sample that was shipped on january  <dig>   <dig>  eight cox <dig> reads from this sample mapped to a m. edulis reference and two mapped to a m. galloprovincialis reference. in conclusion, only three events of between-species contamination out of  <dig> can be unambiguously assigned to our laboratory: contamination of european pond turtle emys orbicularis by ascidian ciona intestinalis a and of seahorses hippocampus hippocampus and h. guttulatus by each other.

within-species contamination
the above analyses suggest that there was substantial contamination in this project, and primarily involves samples that were shipped together. this is worrisome because samples from distinct individuals of the same species, between which contamination is most problematic and difficult to detect, were typically sent together. to quantify the amount of within-species contamination, we examined the prevalence as the minor state  at homozygous genotypes of alleles segregating in the sample. first focusing on homo-quartets  that occurred at monoallelic positions, we determined p, the error matrix in the absence of contamination. this was done separately for each of the  <dig> species of the sample in which at least four individuals were sequenced. note that in this study we did not use strand information, so we could not distinguish between x → y and x* → y* errors, where x* is the complementary of base x.

error matrices revealed two main features. first, the a → c or t → g errors were often more frequent than the other three transversion-type errors, namely a → t or t → a, c → g or g → c, and c → a or g → t. the ratio of a → c or t → g to other transversion-type errors varied between  <dig>  and  <dig>  among species , when a ratio of  <dig>  would be expected under random error. this is consistent with documented error biases of the illumina technology  <cit> . second, transition-type errors, c → t or g → a and t → c or a → g, were typically more numerous than expected. the ratio of transition-type to transversion-type errors varied from  <dig>  to  <dig>  among species , when the expected ratio would be  <dig>  under random error, and < <dig>  according to  <cit> . knowing that dna polymerases typically generate more transition-type than transversion-type errors, this result suggests that a fraction of the sequencing errors affecting our data was introduced prior to sequencing, presumably at the pcr step during library construction.

we then considered homo-quartets occurring at biallelic positions, where two alleles segregate at substantial frequency. here, we only considered the  <dig> species in which at least  <dig> such homo-quartets were found. we asked whether the minor state at such homo-quartets tended to correspond with the other segregating allele more often than expected based on p. we found that the relative prevalence of the other segregating allele was above its expected value in all  <dig> species. the index of allele leakage, λ, varied from  <dig>  to  <dig> , when λ =  <dig> would be expected in the absence of contamination. this analysis therefore indicates that within-species contamination is widespread in our dataset and probably affects all the sequenced species.

we investigated the influence of laboratory metadata, and particularly the date of shipment to sequencing centers, on the prevalence of within-species contamination. to this end, we focused on the  <dig> species of our data set in which not all samples were shipped the same day – that is, most often at two distinct dates, and up to four dates in the blue tit parus caeruleus. in these species, we measured λ', the index of allele leakage between samples sent on different dates. this was achieved by only considering homo-quartets occurring at positions that were biallelic across the whole sample of individuals, but monoallelic in the subsample of individuals shipped the same day as the focal individual . this analysis could not be performed species by species due to the small number of relevant homo-quartets per species. we therefore pooled homo-quartets across the  <dig> species, still accounting for species-specific error matrices p, and obtained an index of allele leakage between samples sent on different dates of λ' =  <dig> . this figure was twice as small as the index calculated as above, that is, irrespective of shipment date, which for these  <dig> pooled species was λ =  <dig> , demonstrating an effect of same_shipment on the prevalence of within-species contamination.

contamination-aware snp calling
to assess the robustness of our published results to the problem of within-species contamination, we re-called snps and genotypes using a modified method accounting for allele leakage between individuals. compared to our original snp-calling method, a parameter γ was added, which represents the probability that a read originates from another individual of the sample. three arbitrary values of γ were used:  <dig> ,  <dig> , and  <dig> . contamination-aware snp calling was applied to the  <dig> species of our sample in which at least four individuals were available. classical population genomic statistics were calculated from this data set using the same pipeline as in  <cit> . to save computational time, snp calling was applied to reduced data sets consisting of exactly one million positions per species, instead of the  <dig> – <dig> million positions in full data sets.

we found that the number of called snps and the estimate of πs, the genetic diversity at synonymous positions, decreased with increasing γ . this was expected: contamination spuriously increases heterozygosity by moving alleles around. the relative bias was substantial – the median ratio of corrected to uncorrected πs was  <dig>  when γ was  <dig> , and  <dig>  when γ was  <dig> . the relative bias, however, was fairly constant across species, and much smaller that the between-species differences in πs, suggesting that our published comparative analyses of πs across species  <cit>  are robust to within-species contamination. we checked that the correlation reported by romiguier et al.  <cit>  between πs and species life history traits were still valid after control for contamination. we found that the correlation coefficient between log-transformed πs and log-transformed longevity was very similar in all four analyses, that is, between − <dig>  and − <dig> , the most negative coefficient being obtained when γ =  <dig> . similarly, the relationship between log-transformed πs and log-transformed propagule size  <cit>  was very robust to changes in γ .fig.  <dig> robustness of population genomic estimates to contamination-aware single-nucleotide polymorphism  calling. a synonymous diversity πs; b ratio of non-synonymous to synonymous diversity, πn/πs; c fit; d tajima’s d, synonymous snps only. each dot represents a species. x-axis: estimates obtained assuming no contamination. y-axis: estimates obtained from contamination-aware snp calling. black dots: γ =  <dig> ; blue dots: γ =  <dig> ; red dots: γ =  <dig>  synonymous diversity πs; top right: πn/πs ratio; bottom left: fit; bottom right: tajima’s d, synonymous snp’s only




the ratio of non-synonymous to synonymous diversity, πn/πs, was only slightly modified when we controlled for contamination , the median relative bias being close to  <dig>  for all three positive values of γ. the synonymous  and non-synonymous tajima’s d, a statistic measuring the departure of the distribution of minor allele frequency from the standard coalescent, were also only moderately affected. these two results suggest that published inferences based on πn/πs and site-frequency spectra  <cit>  are presumably robust enough to within-species contamination.

the fit statistics measures the excess of individual homozygosity compared to hardy-weinberg expectations. a positive fit is expected in cases of inbreeding and/or population substructure. figure 4c shows that our fit estimate is particularly sensitive to contamination issues. controlling for contamination resulted in a substantial increase in fit in all the analyzed species, reflecting the fact that within-species contamination tends to increase individual heterozygosity. in our uncorrected analysis , a negative estimate of the genome-average fit was obtained in nine species  <cit> . this is an unexpected result, given that processes leading to heterozygote excess, such as balancing selection, are presumably limited to a small fraction of the genome  <cit> . in our contamination-aware analyses, a negative fit was obtained in just four, two, and one species when γ was set to  <dig> ,  <dig> , and  <dig> , respectively, suggesting that within-species contamination might explain, at least partly, our previously unexpected report of negative estimates of fit  <cit> . harvest ant messor barbarus was not included in this analysis because the genome-average fit is very negative in this species as a consequence of its peculiar mating system, such that worker individuals are highly heterozygous  <cit> .

we have not commented on fit estimates in our published analyses, with the exception of  <cit> , in which the lack of detectable population substructure  in the giant galapagos tortoise chelonoidis nigra provided evidence against the definition of as many as  <dig> species in this taxon  <cit> . this result was here corroborated: c. nigra is one of the two species still showing a slightly negative fit estimate after correction for contamination. we have, however, published a couple of analyses assessing the prevalence of hybridization and gene flow between diverged species or populations  <cit> . these results should be confirmed by reproducing the analyses using contamination-corrected data.

we compared for each species the likelihoods of the four considered values of γ. the maximally likely γ, which we called γ*, was  <dig> in ten species,  <dig>  in  <dig> species,  <dig>  in five species, and  <dig>  in nine species. we detected a strong effect of species diversity on γ* : the median πs was  <dig>  among species for which γ* was  <dig>  but  <dig>  among species for which γ* was  <dig> . this was unexpected and probably reflects the existence of factors that confound contamination detection .

finally, we reproduced the analyses of romiguier et al.   <cit> , accounting for the dubious ga36k and ga08f samples. the published relationships between genetic diversity and species life history traits were robust to the exclusion of m. trossulus and m. cinxia: the correlation coefficient between πs and propagule size was almost unchanged compared to the uncorrected analysis , whereas the correlation coefficient between πs and longevity was slightly increased , as was the case for correlations between the πn/πs ratio and life history traits. we recalculated population genomics statistics in m. cinxia after excluding individual ga08f, that is, based on just nine individuals instead of ten. excluding ga08f resulted in a substantial decrease in genome-average πs , πn , and fit . correlation coefficients with life history traits, however, were hardly affected by this correction.

discussion
here, we analyzed the prevalence and impact of between-species and within-species contamination in an rnaseq project involving  <dig> samples from  <dig> distinct species of animals. we focused on cross-contamination and contamination from model animals. we did not investigate contamination from, for example, microbes, which can be highly problematic, too  <cit> . this is in part because our experimental process targets polya-containing rnas, which filters out the bulk of bacterial mrnas, and in part because a blast search that was performed in a previous study  <cit>  indicated very low levels of microbial contamination in our final sets of contigs. our analysis indicates that cross-contamination was widespread: approximately 80% of our samples showed evidence of contamination by a foreign species, and traces of within-species contamination were detected in all the species we analyzed. contamination in this project was not an accident, it was a pattern.

a single unexpected cox <dig> read was taken as sufficient to document an event of between-species contamination in our analysis. this might appear too liberal a criterion: contamination at such low levels is very unlikely to affect the analyses or the conclusions. the near-zero detection of contaminant reads from companion species, however, demonstrates that the unexpected cox <dig> reads we uncovered do not result from environmental contamination or experimental noise, but indeed trace transfers of genetic information from sample to sample. even at very low prevalence, therefore, unexpected reads do provide relevant information on when and how events of contamination have happened. our results were qualitatively unchanged when we only counted events of contamination supported by at least ten reads .

contamination occurred in sequencing centers
we uncovered indirect evidence that the vast majority of the events of cross-contamination occurred in sequencing centers. this was attested to by the very strong effect of same_shipment on the probability of between-species contamination, and confirmed by the reduced within-species allele leakage when only samples sent on different dates were considered. roughly 15% of species pairs sharing a common shipment were connected by at least one event of contamination, and we detected only three events of contamination between species that were not shipped together. in this project, libraries were constructed in the sequencing centers. this step involves pcr amplification and might be more prone to contamination than rna extraction, purification, and quantification, which were achieved in-house. it might also be that sequencing centers were simply less careful than our technicians about contamination. sequencing center sc <dig> only handled two shipments, and sc <dig> only one, so we do not have sufficient power to compare centers in this analysis.

in principle, contamination could occur during the library preparation stage through physical transfer of material, or during the sequencing stage through mis-tagging – that is, when the identifier assigning a read to its source sample is in error. in this project, we used simple indexing of samples, which can result in a non-negligible rate of sample misidentification  <cit> . we detected a strong effect of shipment, and on top of this a significant effect of flowcell and lane identity , suggesting that contamination occurred during both stages. however, in the absence of data about which samples were handled together during library preparation, it is difficult to firmly conclude at which experimental steps contamination most often occurred – especially if libraries prepared together were more likely to be sequenced in the same flowcell/lane, as might well have been the case.

it should be noted that our index of allele leakage λ was still significantly higher than zero in the control analysis when only samples sent at different dates were considered. this might indicate that a fraction of the events of within-species contamination did occur in our laboratory. alternatively, λ might be inflated by processes different from contamination, such as hotspots of systematic errors  <cit> , mosaicism  <cit> , hidden paralogy, and variable expression level between alleles and individuals  <cit> . approaching and quantifying within-species contamination is actually a difficult problem, especially with rnaseq data, because a number of distinct processes can potentially generate asymmetric read counts. families of recently duplicated genes are particularly tricky in this respect: they will yield an unpredictable number of contigs after de novo assembly, which will each attract a fraction of the reads of the distinct individuals at the mapping step. this might generate patterns similar to the ones shown in fig.  <dig>  confounding within-species contamination detection .

modeling contamination
we introduced a modified snp-calling method that accounts for within-species contamination by assuming that a fixed fraction of the observed reads originates from other individuals of the sample. estimates of the classical population genomic statistics were affected to various extents by this correction, depending on the assumed contamination rate γ. fit was particularly sensitive to γ, calling for caution as far as studies of population substructure and gene flow are concerned. the effect of γ on population genomic estimates was essentially homogeneous among species, suggesting that our published comparative analyses are reasonably robust, as we explicitly checked in some cases.

in these control analyses, γ was fixed to arbitrary values. when we tried to estimate the contamination rate in the maximum-likelihood framework, together with the sequencing error rate and transition/transversion ratio, we obtained estimates of γ that were negatively correlated to species genetic diversity. we suspect that this might reflect the confounding effect of hidden paralogy, when the reads corresponding to two paralogous genes map to a single reference cdna due to erroneous assembly. hidden paralogy tends to mimic contamination by resulting in sites at which all individuals carry similar read counts for two distinct “alleles”  <cit> . such sites tend to inflate the estimate of γ, particularly in low-diversity species, where the ratio of spurious to correct snps is maximal. read counts in ngs projects are typically over-dispersed compared to the multinomial distribution that is assumed by snp-calling methods, and contamination is one out of several sources of over-dispersion . to distinguish between these various effects is a methodological challenge that would require further developments. one consequence is that we do not know which values of γ in our analyses are closer to the true contamination rates – which perhaps differ between species and between pairs of individuals. it is therefore premature to draw conclusions on the quantitative impact of within-species contamination on population genomic statistics based on this analysis. we still believe that the newly introduced γ parameter, which likely captures a combination of undesired effects, tends to improve the accuracy of predicted snps and genotypes – as reflected by the positive values of genome-average fit we obtained when assuming non-zero γ. for this reason, this approach and recently published related approaches  <cit>  deserve to be further developed.

CONCLUSIONS
are our results generalizable to other ngs-based population genomic/molecular ecology studies? we are not sure, mainly because sequencing centers were critical in the contamination patterns we detected, and our sampling of sequencing centers was poor. there is, however, no reason to a priori believe that the patterns we uncovered here will not apply to other studies – particularly those having relied on sc <dig> in 2009– <dig>  the three shipments addressed to centers sc <dig> and sc <dig> were not devoid of contamination, so the problem is probably not specific to sc <dig>  can guidelines for avoiding contamination be deduced from this analysis? possibly not, again because sequencing centers were critical and we have no control over, or even knowledge of, their detailed experimental processes. we do, however, still make a number of recommendations. first, we suggest taking the cost of potential contamination into account when deciding to subcontract, or not, part of a research project in molecular biodiversity. second, if samples have to be shipped for sequencing, we would suggest, whenever possible, sending together samples that are as genetically divergent as possible, such that contamination would be both easier to detect and less problematic. third, when possible, we would suggest sending replicated samples, preferably on distinct dates, as controls for contamination. this can be expensive but is a direct way to identify and clean contaminant sequences, and measure their prevalence. finally, we suggest that bioinformatic pipelines for ngs-based population genomic data should be further developed/improved in order to account for the probable existence of between-species and within-species contamination.

additional files

additional file 1: 
table s <dig>  list of species and laboratory metadata. 

 
additional file 2: 
table s <dig>  list of samples, shipment dates, and prevalence of expected and unexpected cox <dig> reads. 

 
additional file 3: alignment of reference cox <dig> sequences used in this study. the fragment we used corresponds to positions 6189– <dig>  cambridge reference sequence. 

 
additional file 4: figure s <dig>  contaminant species-associated statistics. each dot is for a contaminant species, that is, a species for which at least one cox <dig> read was found in a sample from another species. x-axis: number of contaminated species . y-axis, bottom: number of contaminated individuals . y-axis, top: number of contaminant reads . 

 
additional file 5: figure s <dig>  effect of laboratory metadata, one species per technician per date. see legend to fig.  <dig>  here, a single species per technician per shipment was kept, removing any possible induction by same_shipment of a same_technician effect on the probability of between-species contamination. no significant effect of laboratory-associated variables is detected in this control. 

 
additional file 6: table s <dig>  effect of laboratory and sequencing center variables on the probability of contamination, with the minimal cox <dig> divergence between contaminant and contaminated species being set to 10% instead of 5%. 

 
additional file 7: figure s <dig>  homo-quartet analysis of contamination between shipments. see legend to fig.  <dig>  here we assume that ind <dig> and ind <dig> have been shipped together on a date different from the shipment date of ind <dig> and ind <dig>  we want to specifically assess the prevalence of contamination between individuals shipped at different dates. here, pos <dig> is not considered because the {ind <dig>  ind2} group is not monoallelic, so that contamination could involve two individuals shipped together. only pos <dig> is identified as a candidate for between-shipment contamination. 

 
additional file 8: figure s <dig>  effect of laboratory metadata, at least ten reads per contaminant. see legend to fig.  <dig>  here, at least ten unexpected cox <dig> reads were required to call a contaminant, instead of one read in the main analysis. 

 


we thank mark blaxter, claire daguin, clémentine françois, philippe gayral, sylvain glémin, hervé philippe, jonathan romiguier, marjolaine rousselle, paul simion and one anonymous reviewer for comments and discussions.

funding
this work was supported by european research council grant  <dig>  swiss national foundation grant crsii3_ <dig>  and agence nationale de la recherche grants anr-10-binf-01- <dig> and anr-15-ce12- <dig> 

availability of data and materials
the data sets generated or analyzed during the current study are available from the ncbi-sra repository under bioprojects prjna <dig>  prjna <dig>  prjna <dig>  prjna <dig>  prjna <dig>  prjna <dig>  and prjna <dig> .

authors’ contributions
mb and nf established the rna extraction protocols and generated the data. ng performed the statistical analyses and drafted the manuscript. all authors read and approved the final manuscript.

competing interests
the authors declare they have no competing interests.

consent for publication
not applicable

ethics approval and consent to participate
not applicable

publisher’s note
springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
