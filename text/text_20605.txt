BACKGROUND
drug metabolism is a process by which pharmaceutical substances undergo biochemical modification in living organisms. such modifications may lead to the generation of an active drug from an inactive precursor or in other cases lead to the generation of an inactive compound from an active substance, aiding in detoxication. this process is performed by a network of biochemical reactions that modify the pharmaceutical substances. the mechanisms of action of a drug refer to the specific biochemical, chemical, or physical interactions through which a drug substance exerts its pharmacological effect. the biochemical transformations of a drug form part of the pharmacokinetic pathway, whereas the interactions of the drug on its targets compose the pharmacodynamic pathway. our study focuses on the reconstruction of network of biochemical interactions taking place between the drug, its metabolites, and their cellular targets. in brief, reconstructing a pharmacokinetic model starting from in-vitro experiments.

at the macroscopic level, the pharmacokinetics concerns with the intracellular uptake kinetics and the metabolic transformations of a drug, usually performed by specialized enzymatic systems. similarly, at the microscopic level, the pharmacodynamics concerns with biochemical interactions between the drug, or in some cases its metabolites, and their molecular targets. the drug metabolites and the drug targets are components of a network of interactions. this network is usually represented by a graph whose nodes are the system’s components  and the edges between nodes link two biochemically interacting components. the directions of the edges specify the directions of the chemical reactions and the sign of the edges denotes the inhibitory or activatory effect of one component on another.

to infer the directional signed edges of the network it is common to use experimental time series of the concentration of the components of the systems, i.e. of the nodes of the network we want to infer. the network inferred from the species dynamics will include edges between those nodes whose time series exhibit sufficient functional connectivity, typically defined as a measure of coupling exceeding a predetermined threshold  <cit> . the same time series used to infer the network can be used also to estimate the rate constants that parametrize the interactions between the biochemical species. the preliminary network can be fitted to the experimental time series to eventually detect those edges whose kinetics is null, and that can be removed from the network.

in accordance to several studies of the late 1990s that indicated that poor understanding of pharmacokinetics properties and toxicity were important causes of costly late-stage failures in drug development  <cit> , it has become appreciated the ability to infer and calibrate pharmacokinetic models, whose usefulness is now widely recognized through all the process of drug design and clinical development  <cit> .

our study proposes a method to deduce both reactions pathways and kinetic parameters of biotransformations of drugs from time series data of measured concentrations of metabolites. determining the pathways in chemical reaction networks from time series data has been an active area of research over a decade. a comprehensive review of available techniques can be found in  <cit> . unlike in the most part of network inference techniques, in our approach a probabilistic model of parameter inference is part of the procedure of the identification of interconnection topology. the integration of parameters estimation into a method of topology identification results in a well performing network inference algorithm. the parameter estimation works as a sort of model discriminator selecting only the interaction responsible for the kinetic of the system. in this way, the whole procedure is able to recover a good approximation of the true network topology, especially for metabolic networks. in this study, we focus on gemcitabine metabolic pathway. gemcitabine is an oncological drug used in various carcinomas: non-small cell lung cancer, pancreatic cancer, bladder cancer and breast cancer  <cit> . it is being investigated for use in esophageal cancer, and is used experimentally in lymphomas and various other tumor types. the gemcitabine reaction pathway has been recently investigated  <cit>  and new observational data provided by the experiments of veltkamp et al.  <cit>  contribute to elucidate the cellular pharmacology of gemcitabine. therefore, the gemcitabine pathway is a good case study for our inference algorithm.

the majority of the literature about application of inference techniques in pharmacokinetics and pharmacodynamics modelling concerns the parameter estimation, rather then the identification of the interaction network structure. moreover, the majority of the methods of parameter estimation fits continuous pharmacokinetics models to discrete time measurements of the drug’s kinetic and/or dynamic response. in pharmacokinetics, the first methods of inference were applied almost thirty years ago to the clinical problem of dose regimen  <cit> . they were mostly bayesian methods.

more recently other parameter inference techniques and parameter fitting procedures have been developed. as a result, many software tools implementing them were developed and provided to the scientific community of modelers and pharmacologists . now, the application of inference and fitting procedures for parameter estimation has been extended to all phases of drug development  <cit> , and it is no longer limited to the dose regime scheduling. in pharmacokinetics and pharmacodynamics, the parameter estimation techniques are applied to infer or fit two categories of parameters. the first category includes parameters for which a priori information is available, e. g. organ blood flows, organ volume fractions, receptor density, cellular signalling protein turnover, whereas the second category includes parameters with no a priori information, e. g. intrinsic clearance, transport and binding coefficients, or parameters representing specific properties of the drug such as partition coefficient.

the development of inference methods that deduce from time discretely observed concentrations of metabolites, both the network of the biotransformations and mechanisms of action as well as the kinetic parameters of these interactions is a new challenge of a new paradigm in drug design and discovery: the network pharmacology introduced by a. l. hopkins  <cit> . network pharmacology is grounded on network biology, that conceives a biological systems as a network whose nodes are the system’s components and the edges between nodes indicate the occurrence of interactions between the nodes. in the network-centric view of a biological system, the time evolution of biological systems, entities and processes is the result of the occurrence of the interactions among the system’s components. the dynamics of the network is governed by the kinetic parameters of the interactions. in most of the cases these parameters are not directly measurable and a priori knowledge is unavailable. often, subjective prior beliefs on the parameters are difficult to be converted into a mathematically formulated model and prior. all these considerations motivated our work and our attempt to develop inference methods which are robust against noise, efficient in computation and flexible enough to meet different constraints.

the network inference method we propose is inspired to the recent works of m. samoilov et al.  <cit>  and a. arkin et al.  <cit>  and has been tailored for pharamcokinetics-pharmacodynamic modelling. it takes as an input the time series data of the concentrations of the parent drug and its metabolites. a prediction of the reaction network is deduced from time-lagged correlation functions of two chemical species at a time, obtained from concentration measurements. these functions are converted into interspecies distances whose analysis and visualization on a spatial domain yields the reaction pathway of the reacting system. to calibrate the network, i.e. to estimate the parameters, we developed an innovative probabilistic model of inference of the rate coefficients  <cit> . the tool implementing the parameter inference of a model of biochemical network, is the software kinfer  <cit> . kinfer is a software  available for download from the software web page  <cit> . the only inputs required by kinfer are the list of chemical equations, or alternatively a generalized mass action, and the experimentally measured time-series of the reagents that are known to be involved in the system. principal features of the tool are: automatic generation of generalized mass action model from the chemical reactions involved in the system; automatic estimation of the initial guesses and bounds for the parameter values; estimate of the propagation of the experimental errors from the input data to the parameter estimates; estimation of the level of noise in the input data. no a priori knowledge about parameter distribution is required by kinfer. a schematic overview of the main steps of the network identification method presented in this paper is shown in figure  <dig>  all the steps will be described in detail in the rest of the paper.


the paper outlines as follows:  we first present the model of inference based on the estimation of the time-lagged correlation functions;  we review the parameter inference methods of kinfer;  we describe the in vitro cytotoxicity, cellular uptake, efflux, biotransformation, and nucleic acid incorporation of the gemcitabine and present the experimental data used in this study;  we show and discuss the inferred network of biotransformations and mechanisms of action of gemcitabine as obtained by our inference algorithm. finally,  we end up the paper with some final conclusions and plans of future works.

a time-lagged correlation based network inference
the time-lagged correlation is a measure that is related to the pearson correlation coefficient but that takes into account shifts in time, i.e. lags, between the expression of the causal effector and the target module. the key-idea of correlation-based methods for network inference is that for a data set comprising time series profiles of n species, xi for i =  <dig> …,n, the correlation matrix of the n/2
independent pairwise correlation coefficients can be used to cluster the data set into groups of species within which correlations between species are high, when compared to pairwise correlations between different groups. these groupings can most easily be discerned by calculating a matrix of pairwise distances, dij from the correlation matrix, whereby dij = 0
for two species which are completely positively correlated and increases as the pairwise correlation coefficient decreases.

the distance matrix can subsequently be analyzed to find, and visualize, patterns of proximities between species. a large family of techniques for the analysis and visualization of proximity data coming from similarity/distance matrix is available in literature. many of these techniques refer to methods of data clustering, and, more recently, to generalized methods of graph splatting such as layout algorithms and multidimensional scaling algorithms  <cit> . the purpose shared by all these techniques is to reveal and, possibly, visualize, patterns of similarities and topological structures underlying the data. in this study we use a multidimensional scaling method. multidimensional scaling transforms a distance matrix into a set of coordinates such that the distances derived from these coordinates approximate as well as possible the original distances. this way, the multidimensional scaling techniques are used in information visualization for exploring similarities or dissimilarities in data. in fact, the visualization of the similarities/distances among data facilitates the interpretation and the analysis of complex network, and, for this reason, they are currently becoming popular in bioinformatics  <cit>  in network inference  <cit>  and network analysis problems. we will describe later in the paper the details of the multidimensional scaling we used for this study.

very often in practical situations the influence of one species on another takes some finite amount of time to propagate through the network, and the ordering of responses to impulse stimuli reveals information about network connectivity. in particular, this will be evident in the time series if the time interval Δt between concentration measurements is smaller than the characteristic response timescales for the network. two time series which have a low correlation coefficient may in fact be strongly correlated if a time lag is allowed between the data points for the two species. therefore, according to arkin et al.  <cit>  and samoilov et al.  <cit> , the covariance function between xi
and xj is


  cij=∫x^iminx^imax∫x^jminx^jmax−〈xi〉)−〈xj〉)×p,xj)dxidxj 

where x^imin=mintk{x^i,k= <dig> …,m} ; p,xj)
is the pair distribution function, corresponding to the density of points on a scatter plot of
xi and xj, and m is the number of measurements. the pair distribution function gives the density of points in the rectangle dxi × dxj on the plot . τ is a delay  introduced to detect correlations that otherwise could be non-detectable. the delay τ can be estimated in the following way. consider


 〈τi〉≈1m∑k=1m|1xi−xidxidt|t=tk|− <dig> 

 where dxidt|t=tk can be calculated with the stineman procedure  <cit>  on the curve interpolating experimental time-series of species i at time point tk. we assume that


  τ∈ <dig> τmin 

and


  τmin=mini{τi} 

the values of τ
in  range over the interval of the rate limitingness across the entire reaction network.

now, since generally the analytical expression of p,xj)
cannot be obtained, the calculation of the integral in eq.  can be performed only switching from a continuous to a discrete domain, so that the integral can be approximated by a sum


  cij=∑μ∑ν−〈xi〉)−〈xj〉)pμν}. 

and, taking a time average over all of the measurements, we obtain a covariance matrix depending only on τ, as follows


  cij=〈∑μ∑ν−〈xi〉)−〈xj〉)pμν}〉. 

in order to estimate the pair distribution function pμν, samoilov et al.  <cit>  proposed to divide the space of the phase plane into rectangles of varying size so that the distribution of points is uniform in each rectangle. the algorithm developed by a. fraser  <cit>  is the most used procedure to perform such a partition of the phase plane xixj. the pair distribution density can then be estimated as


  pμν=nμνntotaμν 

where nμν is the number of points in the particular rectangle labeled μν, ntot is the total number of points and aμν
is the area of the rectangle.

we propose here a different solution to the problem of the pair distribution function. instead of diving the phase plane into rectangle of variable size, we propose a voronoi tessellation of the space, following the results of the recent study of m. browne  <cit>  and q. du et al.  <cit> . this division of the space according to point proximity leads to region boundaries being straight lines, bisecting and running perpendicular to the line connecting the delaunay neighbors. boundary points are equidistant to exactly two sites, and vertices are equidistant to at least  <dig>  neighboring points are points whose associated voronoi regions share a common boundary. thus, voronoi tessellation generates a clustering of the points in the phase plane that in a good approximation satisfies the requirement of homogeneity for the distribution of points inside a cell, and pμν in eq.  can be calculated as follows


  pμν=1/area 

where vμν is the voronoi cell μν.

once, the covariance matrix has been calculated, the time-lagged correlation matrix r can be calculated according to the definition in eq.   <cit> .


  rij=cij|ciicjj| 

finally, from the correlation matrix we calculate a distance matrix d whose elements are defined in eq. .


  dij=|cii−2cij+cjj| 

where


  cij=maxτ|rij| 

is the maximum absolute value of the correlation between two species with a time lag τ.

the distances are used to find the connections between the different species in the system. namely, the distances measure the relatedness of the time series describing the time behaviour of the species; the more related the more likely that two species are connected by a single reaction. the greater the distance between two species the more likely that two species are connected by several intermediate reactions or they are not connected at all.

inspired by  <cit> , we analyzed the distance matrix elements with a multidimensional scaling algorithm. a multi-dimensional scaling algorithm starts with a matrix of species-species distances. then it assigns a location, i.e. the spatial coordinates to each item  in a d-dimensional space, where d is specified a priori. we used the kruskal-shepard multidimensional scaling  <cit> . this scaling is defined in terms of minimization of a cost function called stress function which is a measure of lack of fit between distances dij and distances ||xi−xj||. the stress is a residual sum of squares:


  sd=∑i≠jdij−||xi−xj|| <dig> 

so that kruskal-shepard scaling is also known as least-squares scaling  <cit> . this scaling seeks values of the coordinates x <dig> x <dig> …,xn∈rd to minimize s. for a given value of d the estimation of the coordinates is performed in such a way that the pairwise distances are preserved as well as possible. the choice of d is arbitrary in principle, but low in practice: d = 2;  <dig> are the most frequently used dimensions, for the simple reason that the points serve as easily visualized representors of the species. a downhill simplex  algorithm is used to minimize sd <cit> . in the application domain of this study, the downhill simplex method turned out to be more efficient that the gradient descendant minimization method that is usually exploited in the kruskal-shepard scaling algorithm.

in this study we reported the 2d and the 3d visualizations of the networks. nevertheless, a set of euclidean distances on p points can be represented exactly  in at most p−1
dimensions. an insufficient number of dimensions is not the only cause of non zero stress. it may be caused also by random measurements errors in the input data. in such cases, even if the “true” number of dimensions of the problem were known, this would not guarantee that the stress corresponding to that number of dimensions is null  <cit> . unfortunately, in most datasets the true dimensionality of the problem is not known in advance, like in the case treated in this study. the commonly advocated procedure for determining the dimensionality is a heuristic one of seeking a sharp drop or “elbow” in the rate of decline of stress as dimensionality increases. in practice such elbows are rarely obvious. in fact is has often noted that the pattern of change of stress versus dimensionality, rather than having an elbow, is characterized by a smooth and gradual decline  <cit> . as reported by m. d. lee in  <cit> , although there are at least two variants  <cit>  of the multidimensional scaling that attempt to determine automatically the number of dimensions of the spatial representation they derive, there is not a rigorous and principled basis for this determination.

however, it not necessary that a multidimensional scaling representation has zero stress in order to be informative and useful. a certain amount of distortion is tolerable  <cit> . the amount of stress to tolerate can be derived from the accuracy of the input time series. the measurement error on the input data propagates to the distance matrix entries and, consequently, to the estimate of the stress function in the following way. for convenience, we introduce the following notation


 si≡xi−x¯isj≡xj−x¯jp,xj)≡pij. 

then, we apply the rules of error propagation  <cit>  to find the error on the covariance estimate given in eq.  <dig> 

the relative error on cij
is


  δcijcij=∫∫δsisi2+δsjsj2+δpijpij2×dxidxj 

where


  δsi=δxi+δx¯i 

  δsj=δxj+δx¯j 

we assume that the estimate of the relative error of the density pij is such that


 δpijpij2≪δsisi2+δsjsj <dig> 

 so that, the absolute error on cij
is


  δcij=cij·∫∫δsisi2+δsjsj2×dxidxj 

and the absolute error on the time average of cij
is


  δcij=1m∑k=1mδcij 

where m is the number of records in the time series.

from the eq. , the absolute error on the correlation coefficient rij is


  δrij=rij·δcijcij2+12δciicii2+δcjjcjj <dig>  

now, applying the rules of error propagation to the eq. , we obtain that the absolute error on the distance dij is


  δdij=12dij·δcij+2δcij+δcjj|cii−2cij+cjj|=12dij·δrij∗+2δrij∗+δrjj∗|rii∗−2cij+cjj| 

where, as per the definition in eq. 


 δrij∗=maxτ|δrij| 

 with δrij as in eq. .

therefore, in a given dimensionality d we can consider tolerable a non-zero value of the stress function if


  ||zi−zj||∈dij−δdij,dij+δdij,∀i,j 

this condition can be satisfied for more than one non-null value of the dimensionality d. if the condition is satisfied for d= <dig> , we will use these values as input to the multidimensional scaling procedure and the network can be visualized. in particular, d= <dig> is selected if, moving from two to three dimensions, we have a significant reduction in stress, i.e. if


  sd=3+δsd=3≤sd=2+δsd= <dig> 

where δsd
is the error affecting the value of the stress function because of the error δdij on the distance dij. δsd is given as in the following


 δsd=2sd·∑i≠j2·δdijdij−||zi−zj||∑i≠j <dig> 

if d≤ <dig>  once the coordinates of the species in d-dimensional space have been calculated from the distance matrix, we fix a threshold on the multidimensional-scaling estimated distances to establish when two species interacts through a single reactions or not. the threshold is calculated from the histogram of the distances, and it is set equal to the average of the values on the x-axis corresponding to the absolute maxima of the histogram . if d> <dig>  the multidimensional scaling procedure can be skipped and the original distance matrix can be directly analyzed and thresholded.


then, we derive the undirected graph representing the network: species whose distance do not overcome the threshold undergo a biochemical interaction. in order to determine directions of the edge we need to infer a temporal ordering of the reaction events. having knowledge of the temporal sequence of the reaction means knowing whether a perturbation of one species follows or proceeds that of another species. as suggested by arkin et al.  <cit>  the temporal ordering of variation in each of the variables can be assigned in the following way. if the time series for a given species has a maximum correlation at negative lags compared to a reference time series, then that species receives the input signals after the reference series, and vice versa. similarly, if the two series are maximally correlated at zero lag but correlation tails to negative  lags, variation in the given species closely follows  variation in the reference species. in this study, we do not consider negative lags, but without any loss of generality, we consider only positive lags and look for cause-effect relationships on a positive temporal scale.

in the next section we will describe the procedure of inference of the kinetic parameters of the interactions among the nodes of the network.

inferring the kinetic parameters with kinfer
the tool we recently developed to infer the kinetic parameters is kinfer . it takes as an input the experimental time series of each reactants in the systems and a set of chemical reactions that are supposed to occur among the species of that system. therefore, we apply kinfer to the network model we inferred with the time-lagged correlation based inference procedure described in the previous section.

we report here the key statements of the theory implemented by the tool and refer the reader to the references  <cit> .

consider n reactant species, with concentrations x <dig> x <dig> …,xn, that evolve according to a system of rate equations established by the generalized mass action law.


  dxidt=fi;θi)=∑h=1niθih∏w∈shxwαw 

where θi , i= <dig> ,…,n
, is the vector of the rate coefficients, which are present in the expression of the function fi; αw∈r, and ni is the number of parameter in the fi
rate equation.

we wish to estimate the set of parameters Θ={θi}
, whose element θi
is the set of rate coefficients appearing in the rate equations of i-th species, therefore


 θ1={θ <dig> θ <dig> …,θ1n1},…,θn={θn <dig> θn <dig> …,θnnn} 

x
is the vector of concentrations of chemicals that are present in the expression of the function fi for the species i. we assume we have noisy observations xi^=xi+ε at times t <dig> …,tm , where ε∼n is a gaussian noise term with mean zero and variance σ. with this choice we are assuming that the concentration measurements are not significantly affected by systematic errors, but by uncontrolled random errors and that an error is equally likely to occur in either positive or negative direction with respect to the symmetry axis of the distribution. we also assume a number m of concentration measurements for each considered species. approximating the rate equation  as a finite difference equation between the observation times, gives


  xi=xi+fi;θi) 

where k= <dig> …,m. in eq.  the rate equation is viewed as a model of increments/decrements of reactant concentrations; i.e., given a value of the variables at time tk− <dig> , the model can be used to predict the value at the next time point tk. increments/decrements between different time points are conditionally independent by the markov nature of the model . therefore, given the gaussian model for the noise, the true value of xi is normally distributed around the observed value xi^, so that


  pxi|x^i=nx^i,σ2=12Πσ×exp−−x^i)22σ <dig> 

therefore, the probability to observe a variation di=xi−xi
for the concentration of the i-th species between the time tk− <dig> and tk, given the parameter vector θi
is


  p|θi,σ)=nefi,θi),2σ <dig> 

and


  efi)=∫Ωxfi,θi)∏i=1ki×pixi|x^idx 

where Ωx is the sample space of x, and ki is the number of chemical species in the expression for fi.

while the increments/decrements are conditionally independent given the starting point xitk, the random variables di are not independent of each other. intuitively, if xi
happens to be below its expected value because of random fluctuations, then the following increment di can be expected to be bigger as a result, while the previous one di will be smaller. a simple calculation allows us to obtain the covariance matrix of the vector of increments for the i-th species. this is a banded matrix ci≡c=cov with diagonal elements given by 2σ <dig> and a non-zero band above and below the diagonal given by −σ <dig>  all other entries of c
are null.

the likelihood for the observed increments/decrements therefore will be


  p=∏i=1nn,c)=12Πdetn×e∑i=1n−12tc− <dig> 

where d={d <dig> …,dn}, di=di,di,…di
, and mi≡efi,θi).

eq.  can be optimized w. r. t. the parameters Θ=
of the model to yield estimates of the parameters themselves and of the noise level. the inferred parameters are then used as multiplicative coefficients for each element of the correlation matrix, so that we obtain a weighted correlation matrix, reflecting the physical interaction in the network.

this procedure makes null the element of the correlation matrix if the rate constant multiplying this element is a null kinetic rate constant or if this rate constant is affected by a relative error of 50%.

metabolism and mechanisms of action of gemcitabine
gemcitabine  is an anticancer drug, which is effective against solid tumours, including non-small-cell lung cancer and pancreatic cancer. gemcitabine is an anticancer nucleoside analog in which the hydrogen atoms on the 2′-carbon of deoxycytidine are replaced by fluorine atoms. as with fluorouracil and other analogues of pyrimidines, the triphosphate analogue of gemcitabine replaces one of the building blocks of nucleic acids, in this case cytidine, during dna replication. the process arrests tumor growth, as only one additional nucleoside can be attached to the “faulty” nucleoside, resulting in termination of dna replication and ultimately leading the cells to apoptosis.

in this study we refer to the recent model proposed by veltkamp et al.  <cit> . the model is depicted in figure  <dig>  the gemcitabine is transported into cells by equilibrative and concentrative nucleoside transporters. then, it is phosphorylated by deoxycytidine kinase  to become the gemicitabine mono-phosphate . dfdc-mp is phosphorylated to its active diphosphorylated  and triphosphorylated  forms with the intervention of nucleoside monophosphate kinase  and nucleoside diphosphate kinase , respectively. the triphosphate metabolite  competes with the natural nucleoside triphosphate for the incorporation into the dna and blocks cells in the early dna synthesis phase. gemcitabine is also rapidly metabolized by cytidine deaminase to 2′,2′-difluorodeoxyuridine , which can be further phosphoriylated to its disphosphate  and triphosphate  whose activity has been recently associated with the cytotoxic effect of the drug  <cit> .


in this study we used the time series data on the concentration of the gemcitabine and its metabolites published by veltkamp et al.  <cit>  and reported in figure  <dig>  the concentration of the following metabolites has been measured at four time points : extracellular dfdc , intracellular dfdc, intracellular dfdc-mp, dfdc-dp, dfdc-tp, dfdu, dfdu-mp, dfdu-dp, and dfdu-tp.


RESULTS
we first applied the algorithm of network inference to deduce some of the biotransformations of gemcitabine from the experimental time series of metabolite concentrations available in  <cit> . the algorithm can infer the reactions between the measured species, therefore, since the experiments in  <cit>  measured the concentrations of dfdcout, dfdc, dfdcmp, dfdcdp, dfdctp, dfdu, dfdump, dfdudp, dfdutp, the reactions we expect to infer are only those among these chemical species.

the figures  <dig>  and  <dig>  show the undirected unsigned graph representing the network of interactions between the systems components, in a 2d and 3d space respectively the maximum value of the distance at which two species are still connected by an edge has been estimated to be  <dig> . the interval ranged by τ has been calculated by the formulas  and  and is  <cit> 
hours.


the analysis of the pairwise time-lagged correlation cij allows to deduce the directions of the edge of the graph. to facilitate the understanding of this analysis and its results, we visualized on a plot this correlation metric. figures  <dig>   <dig>  and  <dig> are heatmap representations of the behavior of the correlation cij
for each possible pairwise combination of the biochemical species. in figure  <dig>  the reference species are dfdcout  and dfdc , i.e. the extracellular and the intracellular gemcitabine, respectively. in figure  <dig>  the reference species are the mono- , di-  and tri-phosphate  of dfdc. in figure  <dig>  the reference species are dfdu , dfdump  and dfdudp , i.e. the intracellular 2′,2′-difluorodeoxyuridine and its mono- and di-phosphate. a linear increment of the correlation is obtained in almost all the cases in the observed time interval. this behavior of the correlation indicates that most of the reactions are sequential and reversible. species connected by a chain of sequential reversible reactions maintain a correlation significantly different from zero during all the observation time. moreover, as we can see in figures  <dig>  and  <dig> , these species appear to be connected by an edge if they do not directly interact. the linear increment of the correlation for almost all the couples of species makes not easy to dissect the chain of sequential reactions and distinguish between direct and indirect interactions. table  <dig> reports the values of the lags corresponding to the maximum and minimum value of the correlation. in this table we see that the extra-cellular concentration of dfdc  is maximally anti-correlated to all the other species after  <dig> hours, whereas the minimal value of the correlation is obtained for τ= <dig>  this results is consistent with the behavior of the experimental time series in figure  <dig>  and is explained by the time resolution of the measurements. although the concentration of dfdcout rapidly decreases within the first  <dig> hours, the increment of the intracellular dfdc slowly increases and reaches the maximum around t= <dig> hours. therefore the correlation between dfdcout and dfdc and between dfdcout and the phosphorilated metabolites of dfdc and dfdu is detected only after  <dig> hours . conversely, the correlation between dfdcout and dfdc, as well as the correlation between dfdcout the phosphorilated metabolites of dfdc and dfdu reaches a minimum at τ= <dig> . table  <dig> also shows that dfdc and its phosphorilated metabolites are maximally correlated at τ= <dig>  dfdc is maximally correlated to the dfdu metabolites at τ=0
as well . similarly the correlation between the metabolites of dfdc and dfdu has a maximum at τ= <dig> .

are reported.
are reported.
are reported.

although these results are consistent with the dynamics measured in the experiments , they do not reflect the expected kinetics in the first  <dig> hours. in fact, the kinetics of uptake of dfdc is expected to be faster than the one observed in the experiments. in particular, the rate of increment of the intracellular concentration of dfdc is expected to be proportional to the decrement of its extracellular concentration within the first  <dig> hours. we argued that the time resolution of measurements of the concentration of the metabolites does not allow to detect the dynamics of the concentration in the first  <dig> hours. as a consequence, the observed slow increment of dfdc in spite of the rapid decrement of its external concentration, and the observed peaks of the concentration of dfdc metabolites after  <dig> hours should be the reason why the maximum correlation between dfdcout and dfdc and its metabolites is reached at  <dig> hours. in order to demonstrate this guess, and to check the capability of our algorithm to correctly detect the connectivity between the biochemical species, we simulated a mass action model of the metabolism and mechanisms of action depicted by the cartoon in figure  <dig>  the aim of this experiment is to validate the capability of the inference procedure to correctly identify the simulated model, i.e. to detect all the interactions specified in the model. the model parameters have been obtained by fitting the model to the experimental time series of veltkamp et al.  <cit> . the best-fitting parameters have been estimated with a downhill simplex technique  <cit>  and provide the dynamics showed in figure  <dig>  unlike the experimental observation, the simulation of time behaviour of the internal dfdc has a maximum within the first  <dig> hours ). although this maximum is expected, it has been not detected in the experiments because of the coarse-grain time resolution of the records.


we used the time series of dfdcout, dfdc, dfdcmp, dfdcdp, dfdctp, dfduout, dfdu, dfdump, dfdudp, dfdutp generated by the simulation of the model as input to the inference algorithm. the simulated time series contain  <dig> points regularly spaced in the interval  <cit>  hours . unlike the set of real data, this set contains also a time course of the extracellular concentration of dfdu .

the undirected unsigned graph represented in two and three dimensions are shown in figures  <dig>  and  <dig> , respectively. similarly to table  <dig>  tables  <dig> and  <dig> list the time lags corresponding to the minimum and the maximum of the correlation cij, and figures  <dig>   <dig>  and  <dig> show the heatmap representation of the behavior of the correlation as function of τ. a monotonic behavior of the correlation vs the time lag is observed for almost all the pairs of the species. this indicates again the presence of chains of reversible reactions involving the species. an elementary single reaction is inferred whenever the maximum correlation between the reference species and another potentially interacting species occurs at a time lag τ′ equal to the average value of the τs at which a given species exhibits the maximum correlation with the other. in this experiment τ′= <dig> .

are reported.
are reported.
are reported.

for more clarity, we did not indicate the directions of the edges on the graph in figures  <dig>  and  <dig> , but we show the directions of each inferred interaction in table  <dig>  the third column of the table tags with the letter “e” the expected reactions , and with the letter “u” those unexpected and incorrect, and with the letter “p” those reactions that are unexpected as direct reactions but that are plausible. in fact, two species could appear to be significantly correlated  even if their interaction is mediated by intermediate biotransformations.

dfdu  has been not detected

the rate constants have been estimated with kinfer. theirs values are reported with a precision of  <dig> digits. the third column of the table denote with the letter “e” the expected reactions, and with a letter “u” those unexpected and incorrect, and with the letter “p” those reactions that are unexpected but that can be easily explained and are plausible in terms of correlation. the reaction dfdcmp→dfdu
 has been not detected.

the reactions r <dig>  r <dig> and r <dig> tagged as “expected” by the correlation-based inference procedure and reported in table  <dig> have been cut off by the network calibration procedure, and thus they do not appear in this table. the reactions whose id is bold faced are discussed in the text in section “results”.

the comparison of this set of reactions with those observed in experiments and depicted in figure  <dig> reveals the presence of false positive in the inferred reactions set. the calibration of the inferred model with kinfer allowed to detect the null kinetics, i.e. those reactions whose rate constant k is null or it is affected by an error Δk equal or greater than the estimated value. the cases in which the ratio between the estimate of the parameter value and the estimate of its error is equal or greater than one, are interpreted as noise and not as a biochemical kinetics governing the time behavior of the species concentration. the calibration of this inferred model with kinfer gives as non-null kinetics the reaction showed in table  <dig>  in this set of reactions, r <dig>  r <dig>  r <dig> and r <dig> are also included, although in these reactions the interaction between the reactants are mediated by intermediate reactions. reaction r <dig> has been inferred, but it is not expected at all.


according to reaction r <dig>  the decrement of dfdcout is directly proportional to the increment of dfdcmp via a single reaction consuming dfdcout and producing dfdcmp. however, the model includes also the uptake of external dfdc into the cell and its excretion, i.e. dfdcout⇌k2k1dfdc. once gemcitabine is inside the cell, it undergoes a reversible reaction of phosphorilation, i.e: dfdc⇌k6k5dfdcmp. the estimates of the rates obtained with kinfer for these reactions are: k1= <dig> , k2= <dig> , k5= <dig>  and k6= <dig> . k <dig> is one order of magnitude greater than k <dig>  and similarly k <dig> is one order of magnitude greater than k <dig>  as consequence, since  the uptake of dfdcout is much faster than the phosphorilation reaction, and  the dephosphorilation of dfdc is much faster than the excretion from the cell  <cit> , the correlation-based inference model detects a significant correlation between dfdcout and dfdcmp through the reactions r <dig> and r <dig>  nevertheless, the algorithm is able to detect the uptake and the excretion of the dfdc .

similarly, the algorithm infers also reaction r15: dfdcdp→k15dfdu. dfdcdp and dfdu are connected through a pathway depicted in figure  <dig>  . the variation of the concentration of dfdu is correlated to the variation of the concentration of dfdc and dfdump. in turn, the variation of the concentration of dfdc and dfdump are both correlated to the variation of the concentration of dfdcmp.


finally, the correlation-basednetwork inference algorithm does not detect the reaction dfdcmp→dfdu that is reported in the cartoon of figure  <dig>  and later in the table  <dig> .

the reactions r <dig>  r <dig> and r <dig> tagged as “expected” by the correlation-based inference procedure and reported in table  <dig> have been cut off by the network calibration procedure, and thus they do not appear in table  <dig> 

summarizing, from the model in figure  <dig> and the list in table  <dig>  we see that  <dig> reactions are expected. the network inference algorithm paired to the parameter inference algorithm of kinfer correctly inferred  <dig> reactions. it inferred two false positive, i.e. r <dig> and r <dig>  moreover, it missed reactions r <dig> and r20: they are expected, but they have been not detected. we introduce two parameters to evaluate the performance of the procedure: the sensitivity and the accuracy. the sensitivity is defined by the ratio between the number of detected edges and the number of expected edges. the accuracy is defined as the ratio between the number of correctly detected edges and the number of detected edges. the number of expected edges is the numer of expected reactions, that is  <dig> . according to these definitions we have


 sensitivity=nr. of detected edgesnr. expected edges=1219= <dig> % 

 sensitivity=nr. of detected edgesnr. expected edges=919= <dig> %accuracy=nr. of correctly detectednr. detected edges=912=75%. 

our procedure on the case study of gemcitabine metabolism outperforms the algorithm in  <cit>  that has been designed for the determination of chemical reaction network interconnections from time series data too. however, we point out that the sensitivity and the accuracy defined in this way are global measures that average over the whole network giving two values as representative of the performance of the inference algorithm. a better assessment of the inference algorithm could be conducted if we disposed either of real biological but small-scale data. a comparison of these performances with the performances of other state-of-art tools is still in progress. preliminary results of this analysis show us that the outcome of the network inference varies between tools and can be complementary. moreover, each tool is tailored to a specific biological pathway and experimental set up. for this reason mainly, in the scientific community there is no general consensus that would have been reached declaring one network inference method as gold standard  <cit> .

CONCLUSIONS
we presented a method for the prediction of the interactions within reaction networks from experimental time series of the concentration of the species composing the system. the overall aim of our investigation was to develop a procedure of system identification in which the parameter inference acts as tool of model refinement and elimination of false positive interconnections. both the network topology inference and the parameter estimation have been designed to predict reaction pathways in chemical kinetic systems from noisy time resolved concentration measurements.

we developed a method that does not require any a priori information about the topology of the interconnections. it consists of two parts: the estimation of time-lagged correlation function between the components of the systems for the determination of direct edges between the components and the inference of the kinetic parameters to establish real dynamics and to cut “null dynamics” edges instead. the method has been developed to deducing the connectivities of chemical species, the reaction pathway, and the reaction mechanism of complex reaction systems. the procedure can process more than  <dig>  reactions involving hundreds of species. in particular, our methodology coupling the connectivities inference to the parameter inference reveals to be suitable to infer reactions mechanisms of complex systems as drug metabolic network, where many feedback loops and reversible reactions are present. the data driven estimation of the time lag interval facilitates the use of the tool and minimize the a priori information to input. good performances have been obtained on the test case of gemcitabine metabolism, that is supported by recent experimental studies. finally, this work highlights five main aspects determining a sensitive and accurate inferability of a biochemical network with time-lagged correlation-based methods:  the availability of replicates of experiments, so that averaged time series can be used to soften the noise in the input data;  the availability of data having a time resolution suitable to capture the time of onset of the correlation between the species and the number of chemical species that can be measured simultaneously;  the availability of local measures on the level of individual edges and subnetworks, instead of having only global measures of time series averaging over the whole network dynamics  <cit> ;  the effects of measurement error, and  the presence of unmeasured species. these issues have to be addressed before adopting inference methods in the daily laboratory practice for any specific problem.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
each author contributed to this work in compliance with his/her expertise field. pl developed the mathematical framework of the network inference methods and contributed to the development of the software tool implementing it. pl also designed the in silico experiments and the tests of the method on the case study of gemcitabine metabolism. dm contributed to the analysis and validation of the results of the inference. gf performed the experimental data preprocessing necessary to use them as inputs of the inference procedure. cp and ac dealt with the program coding the mathematical expressions and the data structures of the inference method to allow its execution on computer. they also contributed to testing and validating the theory, and provided solutions for an efficient implementation. all authors read and approved the final manuscript.

