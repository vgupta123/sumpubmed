BACKGROUND
the evolution of the complexity of organisms has been a challenge for darwinian theories of evolution  <cit> . how does evolution produce complex organs, when the functioning of such organs requires the successful interaction of many components? despite the recent proliferation of large nucleotide, proteomic, and metabolic databases, it remains difficult to define the complexity of organisms  <cit> , and even more to understand the determinants underlying the emergence of complexity.

any attempt to understand the evolution of complexity must rely on a meaningful definition of complexity coupled to some quantitative methods of estimation. initial estimates of complexity have been based on the number of nucleotides, genes or cell types in a genome, but such bottom up estimates often fail to have useful properties  <cit> . for instance, the multicellular green algae volvox carteri has the same number of genes as its unicellular relative, chlamydomonas reinhardtii  <cit> , even though the evolution of multicellularity is one of the major transitions affecting organismal complexity. to overcome possible problems associated with the previously mentioned bottom up metrics of complexity, recent studies have shifted to a more top down approach by incorporating population genetics  <cit> , quantitative genetics  <cit>  and ecology  <cit>  and quantifying complexity from the perspective of natural selection acting on the organism as a whole  <cit> .

the most integrated vision of complexity comes from fisher's geometric model of adaptation  <cit> . fitness in the model is a function of the phenotype of the organism. individual organisms are depicted as points in a multidimensional space and each axis corresponds to an independent phenotype under selection. the total number of independent phenotypes, i.e. the dimensionality of the phenotypic space, is taken to represent phenotypic complexity. this model has received much attention in the last decade and has provided many qualitative predictions  <cit>  that have been validated experimentally  <cit> .

using fisher geometric model of adaptation, several theoretical studies have also analyzed the consequences of phenotypic complexity on evolution. all of them found higher complexity to be costly. the cost results from the difficulty of having to optimize many phenotypes simultaneously and it is manifested by the decreasing fraction of beneficial mutations as dimensionality increases  <cit> . as a result, the rate of adaptation decreases  <cit>  and the drift load increases  <cit> . drift load represents the loss of fitness due the effects of genetic drift on the fixation rate of beneficial and deleterious mutations.

although previous studies have used fisher's geometrical model to examine the effect of complexity on evolution, none have allowed dimensionality to change as a result of evolution and adaptation. to characterize both the selective forces acting on the emergence of complexity and the underlying mechanisms, we have designed an evolutionary system in which complexity was free to emerge depending on its costs and benefits. although experimental studies of complexity with real biological organisms are possible  <cit> , a systematic investigation is still difficult. we chose therefore to use computational models employing artificial neural networks evolving asexually under a mutation-selection-drift process as an alternative.

methods
models
neural networks were chosen over other models  <cit>  because they offered more quantitative control over environmental challenges and network size, which is comparable to genome size. neural networks can be seen biologically as a transduction signal pathway with no retroaction. in other words, depending on an initial input value, analogous to a chemical concentration, nodes are activated and provide a quantitative output equivalent to the transcription level of a gene. as such node-outputs/gene-expressions may affect the regulation of nodes/gene downstream in the network, the response to the initial chemical concentration is propagated through the network to the final node/gene. this node/gene is assumed to be directly linked to fitness such that the quantitative value of its output/expression can compared to some expected value to estimate fitness. in other words, for a given concentration of a chemical, a given expression level of the final gene is expected and any deviation from that value will reduce the fitness of the network. to go further, rather than evaluating the fitness of a network base only on its response to a single input value or concentration, we assess it on a linear gradient of concentrations. for  <dig> different concentrations spread between  <dig> and  <dig>  we expect  <dig> different levels of expression of the output node. this means that fitness is defined as a goodness of fit between the output of the networks and a reference function. by allowing selection to operate through the fitness of the individual networks, the population was allowed to evolve.

we used as the reference function legendre polynomials. these functions were chosen because they could be readily ranked in term of complexity by the order of the legendre polynomial . higher olp's both require more parameters and have a higher kolmogorov complexity  <cit>  . biologically, this means that a high olp environment will select for networks whose response to a linear gradient of concentration is complex. for instance, if the expression of the key gene determines the state of the cell depending on a threshold level, as observed during development, an olp of p selects for networks performing p transitions from one state to another along the full gradient. we note that while the reference function, and hence the environmental challenge could also be described as having either high or low complexity, we have chosen to restrict our use of the term complexity to describe only networks. environmental challenges will be described as having different levels of demands: the higher the olp, the more difficult is the environmental challenge 

the evolution of complexity in our networks was monitored and compared to standard bottom up metrics such as network size with three additional metrics: information complexity , principal component phenotypic complexity , and effective phenotypic complexity  . ic measures the information content of the environment that is stored in a network by selection  <cit> . ic is based on a summation of the intensity of the selective constraints acting on each mutable component of the network. as such, ic estimation uses both bottom up  and top down  factors, it represents the functional size of the network and is a hybrid metric. both pcpc and epc are based on fisher's geometric model of adaptation  <cit>  , which represents complexity as the dimensionality of the phenotypic space . pcpc directly measures fisher's dimensionality from a principal component analysis based on the effects of randomly drawn mutation on the network fitness  and is comparable to the dimensionality of the mutational variance-covariance m-matrix used in multivariate quantitative genetics  <cit> . epc indirectly measures fisher's dimensionality from the drift load  <cit>  . drift load results from the impact of genetic drift on the fixation of deleterious and beneficial mutations. as the efficiency of selection depends on population size and the ratio of beneficial to deleterious mutations depends on dimensionality, dimensionality can be inferred from the intensity of drift load for different population size. because epc is easier to measure, it is one of the few indexes that have been measured in a real biological organism  <cit> . because both pcpc and epc respond only to selection, they are top down metrics.

detailed methods
networks
neural networks consisted of single input and output cells connected by a series of neurons, or nodes . network size was determined by varying the number of nodes. the input cell and nodes were connected sequentially and all nodes received out outputs from all lower nodes. the value of the output corresponds to the output of the last node. the output oj of node j was determined as

  oj=1-e-x <dig> 

), where

  x=∑i=0j-1wijoi+bj 

oi were the outputs of the preceding nodes in the network, wij the weight of the connection between node i and j , bj a weight associated to node j , and o <dig> the input cell value. oj equaled zero when its inputs were zero and close to one with strong positive or negative inputs.

for each input value, the network provides an output value that can be compared to a reference. rather than using the response to a single input value to define the fitness of the network, we used the response to  <dig> different input values. fitness was hence determined by testing the response of each network to a gradient of values g that increased linearly from - <dig> to + <dig> and i =  <dig> to  <dig>  = -1+ <dig> × i/100). for each value g, the network was evaluated by letting o <dig> = g and measuring the response n) in the output cell. fitness was measured over all values of i as

  fitness=e-k*∑i=1100n-r2∕100*var 

where k was a constant set to  <dig> and r) the target value that n) is supposed to match. the division by the variance of r), var normalized fitness to have comparable values for different forms of r.

function r was a legendre polynomials . these are polynomials that define an orthogonal base for continuous functions defined between - <dig> and  <dig>  in that interval, any function can be decomposed in a linear combination of legendre polynomial of various orders. these polynomials are defined by the recursive functions

  n+1pn+1x=2n+1xpnx-npn-1xp0x=1p1x=x 

for our purposes, we normalized them to be bounded by  <dig>  and  <dig>  in interval .

legendre polynomials of high order require many parameters to be defined and as such have a higher complexity than simple ones . we therefore chose the order of the legendre polynomial to reflect the demand of the network environment.

network evolution
populations of networks were initially monomorphic, starting with a network having random weights . the population of  <dig> networks was then submitted to a model of asexual evolution with discrete generations. each generation, a network had a 1% probability of mutating one of its weights. the quantitative value of the mutated weight was then shifted by a random normal deviate of mean  <dig> and standard error  <dig> . using classical wright-fisher population genetics formalism, networks contributed to the next generation of networks according to their respective fitness.

the above evolutionary process represents our primary process of adaptation, however two other slightly modified evolutionary processes were used. we call the first modified process the "intense selection" evolutionary process. for that process, a smaller population size was used , but every  <dig>  <dig> generations, the intensity of selection was increased, by increasing constant k, to set fitness back to 3%. this promoted an intense selective pressure that allowed the emergence of very high fitness clones that would have otherwise required very high population size  to emerge, as mutation of effects smaller than the inverse of population size behave as neutral mutations. using this protocol fitness as high as  <dig>  were sometimes reached, while a population size of about  <dig> would be required for this level of fitness to be reached. the final evolutionary process we used can be called "adaptive dynamics"  <cit>  since it is similar to the one used in this field. for that process, populations were always monomorphic except when a single mutant appeared. then based on the mutant fitness fi relative to the resident fitness f <dig>  the mutant either immediately invaded the population and became the new resident or disappeared. the probability of invasion p, depended on the evolving population size n and, using sella and hirsh formalism  <cit> , was computed as:

  p=1-21-2n 

this protocol provided an exact solution for populations having a small mutation rate by population size product. this evolutionary process allowed a faster computing than the process simulating a whole population; it limited the effects of high mutation rate by population size product that may lead to confusing effects and provided a direct access to the whole line of descent of the final clones. it allowed to follow of the coupled changes in fitness and complexity through the adaptive walk.

similar levels of complexity were reached under all of these evolutionary algorithms. our results are therefore robust and are not resulting from some specific selection favoring genetic robustness due to a high mutation supply.

in the first dataset , we used our primary method to generate the evolutionary process. networks evolved for  <dig> millions of generations or until they reached fitness of  <dig> , with a population size of  <dig>  epc was then computed following the method described bellow. if in the process of computing the epc a better fitness was found the best fitness network was stored and readapted for  <dig> million generation and computation of epc started completely. in the second dataset , the "intense selection" evolutionary process was used for  <dig> millions of generations. the "adaptive dynamics" evolutionary process was used to follow the changes in complexity along the adaptive walk either starting from random networks or starting from networks previously adapted to an olp of  <dig> and then shifted to an olp of  <dig> .

network complexity
principal component phenotypic complexity
for a given network, the different outputs of  <dig>  mutations having more than 1% effect on fitness were recorded . for each mutation and for each of the p =  <dig> fitness linked phenotype , the deviation between the mutant and wild type output n) was recorded. a principal component analysis  was then performed in r, with a correlation approach. the eigen values, λi, representing the variation explained by each of the p axes of the pca were then used to estimate the number of effective dimensions, or pcpc. because log values tended to follow some uniform distribution, as in many system biology models  <cit> , it was not easy to identify clear thresholds between axes contributing to the observed variance and those that did not. however, one could compute the number of effective dimension n or pcpc that would produce a variance among the contribution of all the p axes similar to the one observed ), assuming that the n first axes contribute equally to the observed variance and the remaining p-n have no contribution. hence, as previously shown  <cit> ,

  pcpc=n=p∕1+cvλi <dig> 

cv being the coefficient of variation of λi.

pcpc can be used to estimate the number of effective dimensions in fisher's geometric model even when individuals sharing the same fitness are not equidistant from the optimal phenotypic combination   <cit> . the resulting estimate of pcpc corresponds to the number of dimension of fisher's geometric model with equidistant fitness isoclines that would have a distribution of mutation fitness effects similar to the one observed in the original phenotypic space in which fitness isoclines may be ellipsoidals  <cit> .

effective phenotypic complexity
in fisher geometric model of adaptation, population evolves towards equilibrium fitness values defined by population size and the dimension of the phenotypic space or epc. the best network at the end of adaptation was then used to initiate new populations of reduced size , which were evolved for  <dig> millions of generation to be sure that equilibrium would be reached. fitness was recorded over the last  <dig> million generations and the observed decay of fitness with population size was fitted by the theoretical prediction to estimate epc  <cit>  .

  f∝epc 

indeed epc is a composite index which corresponds to the ratio of dimensionality and an epistasis parameter named q in reference  <cit> . for the sake of simplicity we assumed q =  <dig> ). as we are not focusing on absolute values of epc, this does not affect our results.

informational complexity
the quantity of information stored in a genome and transmitted to the next generation has been used as a measure of organismal complexity  <cit> . if more information is necessary to build up an organism, the organism is more complex. however, genome size alone may not be adequate because some parts may not encode any information. to account for the information content of a locus, its effects on fitness must be assessed. if all alleles at a locus had the same fitness, then there is no constraint on that locus: all alleles are equally probable and the information content is null. if all alleles but one are lethal then the information content is maximal, as the non-lethal allele will always be found at that locus. because our loci are quantitative , we estimated the quantity of information  by sampling the fitness effects of an observed weight. for each weight, we estimated the fitness for  <dig> interspersed values of the weight around its observed value . to calculate the ic, we calculated the probability to observe each of these possible values in a population at equilibrium . published measures of ic have used an infinite population size with mutation rate μ to get the equilibrium frequencies  <cit> , but the resolution is not trivial. hence rather than studying the equilibrium probability of each weight value in an infinite population size with a given mutation rate, we studied the probability to observe a given weight value in a finite population of size n with a very small mutation rate. the two approaches focus on different noise parameters in the transmission of information. the first one focuses on mutation rate, and the other one on genetic drift, but both have very similar behavior. the benefit of the drift approach is that it allows the exact computation of the of the frequency of an allele in an equilibrium population  <cit> , as long as we know the fitness values associated with each allele.

for a given weight, j, the fraction of populations evolving with size n having the ith value for that weight and the associated fitness fj,i is just:

  p=fj,i2n-2∑k=1600fj,k2n- <dig> 

the entropy for that weight is then

  h=-∑k=1600pj,ilog600pj,i 

and the information content

  ic=1-hj 

the information content of a network was hence defined as the sum over all the w weights

  ic= ∑j=1w1+ ∑i=1600fj,i2n-2∑k=1600fj,k2n-2log600fj,i2n-2∑k=1600fj,k2n- <dig> 

the larger the n, the higher the information content, as any slightly deleterious mutation is easily filtered by natural selection. to be able to uncover the differences among networks and to be able to compute the solutions we chose an n of  <dig> 

network pleiotropy
to estimate pleiotropy, we used a method similar to the one used to estimate pcpc. we sampled one hundred mutations per mutable entity, wi, of the network and averaged their effect, to obtain μ¯i,p  on each of the p =  <dig> network outputs or fitness-linked phenotype. we then estimated how many effective phenotypes were affected by a given weight, wi by studying the coefficient of variation of these μ¯i,p.

  pleiowi=p∕1+cvμ¯i,p <dig> 

similarly to pcpc, a pleiotropy of  <dig> meant that the mutation had a distribution of effects on traits equivalent to a mutation that would affect  <dig> traits identically and none of the other traits . the network pleiotropy was then computed as the average pleiotropy across all mutable entities. as there are  <dig> fitness-linked phenotypes, our measure of pleiotropy ranges from  <dig> to  <dig> 

network modularity
to estimate modularity, we used the bipartite leading eigen vector approach  <cit>  with an implementation kindly provided by j. zhang. this method required a boolean matrix of connectivity in which nodes are either connected to a phenotype or not. similarly to the analysis of pleiotropy, to generate such a matrix from our networks, for each weight an average effect on each phenotype was computed based on  <dig>  mutations on that weight. a weight was connected to a phenotype if mutations shifted the phenotype value by at least  <dig>  . such a shift generates a fitness loss that is perceivable by natural selection with our evolving population of  <dig>  the value of modularity q was retained for each network. however because absolute values of q are also dependent on the connectivity of the matrix, similarly to wang et al  a normalized modularity was computed by comparing the observed q with that of matrices in which the phenotype affected by each weight were randomly chosen, and normalizing by the variance of q among the random matrices .

RESULTS
networks were evolved under an asexual mutation-selection-drift process and selected to match olp's of the order of  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  we examined network sizes of  <dig>   <dig>   <dig>   <dig> and  <dig> nodes. for each combination of network size and olp, thirty to eighty populations were started from a random network and evolved until they either reached fitness of  <dig>  or evolved for at least  <dig> million generations at a population size of  <dig>  populations of networks with an absolute fitness of less than a threshold of 15% were not retained, as they do not match properly the imposed challenge . with low olp's, all networks evolved to high fitness values and matched accurately their reference function. with increasing olp's, fewer networks reached a fitness greater than 15%, and those that did, especially the smaller ones, attained a lower fitness. for instance, at an olp of  <dig>  only 29% of the networks with  <dig> nodes exceeded 15% while 82% of the networks with  <dig> nodes did; of these, average fitness was 74% in the 4-node networks and 96% in the 19-node ones. hence, increased network size facilitates adaptation to increased environmental challenge .

pcpc, epc and ic were all found to correlate positively with the size of the network and the environmental demand  . all three metrics increased close to linearly with olp when networks were able to evolve high fitness. however, the similarity between the three metrics weakened with a more detailed comparison.

despite the fact that they are measured with radically different methods, the two estimates of phenotypic complexity pcpc and epc correlated strongly . ic correlated to the other two metrics, but to a lesser degree . network size was able to explain 85%, 20% and 8% of the variance of ic, pcpc and epc, while olp explained 2%, 40%, and 57% of the variance, respectively . moreover, the impact of network size on pcpc and epc was partly driven by the inability of small networks to reach high fitness and high complexity in high olp. thus, while epc/pcpc were much more influenced by the olp, ic and its hybrid features was much more sensitive to bottom up properties of network such as network size.

although network size did correlate with all three metrics of complexity, its inability to explain the variance in pcpc and ec revealed its limitations in influencing the evolution of complexity. this effect was further illustrated when networks were challenged with the simplest demand of olp equal  <dig> . increasing network from  <dig> to  <dig>  which corresponds to a 15-fold increase in the number of evolvable weights , had not effect on ec and pcpc  . consistent with earlier measurements, network size also explained up to 88% of the variance of ic in these conditions.

to elucidate how connections within a network evolved, we examined the effects of changing randomly the connection and node weights on each of the  <dig> traits used to estimate the network fitness . a change in a weight is equivalent to a mutation and its effects were quantified as a pleiotropic coefficient, based on the coefficient of variation of the magnitude change at each trait . a mutation affecting equivalently all traits is universally pleiotropic with a coefficient of  <dig>  a smaller coefficient indicated a mutation with restricted pleiotropy. the average pleiotropy of networks correlated negatively and strongly with metrics of complexity  and restricted pleiotropy was associated with increased complexity. thus, mutations in the simplest networks were maximally pleiotropic and affected most traits, while the ones in complex networks exhibited restricted pleiotropy by affecting differing subsets of traits. this negative correlation was highly significant across network sizes or olp. the correlation was maximal for pcpc  but was still strong for epc  and ic . indeed such a link between phenotypic complexity and pleiotropy is fully compatible with the principal component analysis vision of complexity. for many independent axes to emerge, mutations must affect differentially the different traits, such that no absolute correlation exists among them.

the negative correlation between pleiotropy and our three metrics of complexity indicated that complexity evolved by incorporating mutations with restricted effects on the response of the networks. to determine whether the restriction also created structuring in which particular group of weights interacted preferentially with different subsets of phenotypes, we searched for modularity by applying the bipartite leading eigen vector approach to the matrix of connections from weight to phenotypes  <cit> . in this matrix, a weight was connected to a phenotype only if the average effect of mutations on that weight affected the phenotype value by  <dig>  units, which corresponds approximately to an effect on fitness detectable by natural selection with the population size of  <dig>  the modularity statistic q correlated negatively with pleiotropy  and positively with pcpc , but the correlations were not very strong. this may be due to the dependency of q to the density of the matrix used to compute it. we therefore computed a modified value of q, which corresponds to the normalized difference between the observed value of q and that of random matrices sharing the same connectivity  or z-scores. the presence of modularity was pervasive:  <dig> out of  <dig> networks had a higher than expected modularity at the 5% level. so restricted pleiotropy emerged partly due to the emergence of modularity. however, some further analysis of modularity, pleiotropy and complexity will have to be performed with greater care, as the statistical properties of these z-score and of the basal level of the q statistic remain to be uncovered.

previous theoretical studies, analyzing the consequences of phenotypic complexity on evolution, have indicated that high complexity generates some costs such as an increased drift load  <cit> . as drift load is also the basis of our metric epc, the evolution of higher epc with increasing environmental demands  reveals directly the existence of some cost. because complexity emerged in our networks despite the presence of a drift load, some associated benefits must have outweighed its cost. to unravel these benefits, we monitored the emergence of phenotypic complexity to determine if it conferred better adaptation and higher fitness. first, we analyzed the networks reported in figure 6a and  <dig> found that complexity measured by pcpc both increased during the early phases of adaptation and correlated positively with fitness. similarly, the level of pleiotropy decreased during adaptation . second, we generated and analyzed another dataset in which the selective pressure was kept intense such that very high fitness could be reached independently of the evolving population size . the final fitness reached in this "intense selection" dataset again correlated positively with pcpc for each of the environmental challenges  and the pcpc values reached were similar to the one observed previously. third, we examined an additional dataset in which complexity emerged while being forced to remain below a threshold. mutations producing networks with a pcpc higher than the threshold value were rejected. once again the maximal fitness reached was very strongly positively correlated with the maximal pcpc allowed . those three approaches revealed that low complexity organisms are unable to reach very high fitness while organisms above a given complexity manage to . for instance, in figure 6a a network could reach a fitness higher than 40% only if its pcpc was higher than  <dig>  and its pleiotropy lower than  <dig>  thus, when facing a demanding environment, networks could achieve a high fitness only if restricted pleiotropy emerged through the decoupling of mutation effects and allowed fine-tuning of its outputs.

however, an ever-increasing complexity, which could in theory lead to an ever-increasing fitness, was not observed . this suggests that the cost of increasing complexity may have been substantial. while the emergence of high complexity was observed for networks adapted to high olp, such high levels were never observed for lower olp despite the permanent selective pressure we maintained in our "intense selection" dataset . this outcome suggests that the failure to evolve high complexity result from the cost of high complexity and not from  a weakening selective pressure as fitness increases, or  a mutational pressure due to an increased probability to decrease complexity by mutation. indeed, both alternatives would generate a dependency of the complexity reached with the intensity of selection and/or the population size, but neither were observed . moreover, we looked at the distribution of changes of pcpc caused by random mutations and did not found any consistent pattern: networks had sometimes an excess of mutations increasing pcpc, sometimes a lack. this further discredits the role of biased mutational pressure in setting the complexity equilibriums. finally, to test for the presence of a cost of complexity, we evolved networks to very high levels of complexity by selection in a very demanding environment  and then switched them to a lower olp . in all cases, we observed a gradual decrease in pcpc towards the average value reached by random network adapted to olp =  <dig> . hence an optimal level of complexity was favored and resulted most likely from a balance between the benefits and the costs of complexity.

discussion
by evolving adaptive networks with different physical properties under different environmental conditions, we have been able to identify the determinants controlling the evolution of complexity. the three different measures of complexity we used correlated positively with one another, yet our analysis reveals that they captured different facets of complexity. we found that while ic captured the physical architecture used to accomplish a given task, pcpc and epc were most useful in describing the integrated task the organism performs.

the measure of informational complexity or ic, being still connected to the physical constituents of the networks, was found to be mostly driven by network size and not to correlate well with the environmental challenge. for large networks, ic responded more to the environmental challenge , presumably because inactivating unnecessary parts of the network was an achievable solution for large networks facing simple challenges. however, as soon as the intensity of the challenge increased the whole network was recruited and ic saturated. overall, for all environments, the size of the networks was the principal determinant of ic. the latter outcome demonstrates dramatically that the same ecological problem can be solved by a variety of genetic solutions in these networks and raises the possibility that the more physical aspects of complexity may be more subject to the vagarities of historical contingencies  <cit> . this may be the reason why bottom up approaches of complexity do not match adequately our intuitive perception of complexity which is based on the observation of organisms phenotypes. for instance, the recent analysis of the genomes of c. reinhardtii and v. carteri  <cit>  supports well the qualitative outcome of our study. while c. reinhardtii is a single-celled algae, v. carteri is multicellular, the two have similar genome size and number of genes. thus, two organisms straddling the boundary of a major biological transition are able to manifest marked differences in phenotypic complexity while evolving minimal changes in their informational content.

the estimates of phenotypic complexity, pcpc and epc strongly correlated with each other, which is remarkable because it indicates that mathematical derivations from an idealized model of adaptation such as fisher's quantifies complexity in a manner similar to a statistical model of principal components. although this may seem intuitive as both estimates are supposed to measure phenotypic complexity as defined in fisher's geometric model, nothing suggested initially that such a model should apply to our networks. the high correlation we observed relies on the robustness of the estimators of complexity derived from fisher's geometric model that we used. other measures of dimensionality based on the distribution of mutation effects in fisher's geometric model have been proposed  <cit> , but they are dependent on assumptions of made on how mutations affect phenotypes  <cit>  and have failed to be informative in our system . contrary to these estimators, epc is independent of the mutation process  <cit>  and is therefore more robust. pcpc which uses mutations to sample the phenotypic space directly, is also more informative in our case, simply because all phenotypes influencing fitness are known and the effect of thousands of mutations on all these phenotypes can be measured in artificial systems. as a consequence, pcpc relies on the full information of mutational effects on phenotypes and not only on summary statistics such as the mean and variance of mutation effects on fitness that are informative on the dimensionality of the space in fisher's geometrical model only under restrictive conditions. 

both pcpc and epc responded consistently to the demands of the environment. because the environment is perceived by the networks through the fitness consequences of natural selection, our results shift the evolutionary focus of complexity from bottom up or physical measures of complexity  to top down or more ecological ones in which complexity is linked to the ecological niche. physical measures of complexity alone are not adequate to capture complexity of the task performed because their mapping to phenotype was modulated as we found by pleiotropy.

pleiotropy has been defined a century ago  <cit> , yet, some large scale estimates of pleiotropy within an organism have only been provided recently  <cit> . consistently with the results of our toy model, analysis of mouse qtl  <cit> , or yeast, nematode and mouse knock outs  <cit>  have suggested that pleiotropy was very restricted  <cit> . mutations affected a fraction of the phenotypes measured and not all as considered classically for a long time in fisher's geometric model. moreover, similarly to what we found, some extensive modularity may contribute to the emergence of restricted pleiotropy  <cit> . while our results are compatible with these observations, they extend them by suggesting a more intimate connection between pleiotropy and phenotypic complexity.

the link between restricted pleiotropy and the emergence of phenotypic complexity provides both a mechanistic interpretation of complexity and a selective hypothesis underlying its evolution. previous analyses of phenotypic complexity have mostly focused on the consequences of complexity on evolution, rather than on the selective forces acting on it. as such it appeared costly to have a high complexity due to a limited number of beneficial mutations  <cit> , a limited rate of adaptation  <cit> , or a higher drift load  <cit> . however, these models assumed that all organisms independently of their complexities could potentially reach the same maximal fitness. here, we suggest that if strong correlations between mutations effects exist within an organism, this organism has low complexity because it can only explore a fraction of the phenotypic space  <cit> . hence, it could not reach a high fitness when placed in a challenging environment. the way to reach a higher fitness is then to decouple mutation effects such that mutations affect a subset of phenotypes and not all. as a result the accessible phenotypic space becomes larger and its number of dimensions, i.e. the phenotypic complexity of the organism is increased.

phenotypic complexity and restricted pleiotropy appeared to be under stabilizing selection due to a balance between their benefits and costs. increasing complexity allows the organisms to wonder in a larger phenotypic space and closer to the optimal combination of phenotypes, but it also leads to a higher drift load  <cit> . the effects of drift limit the ability of the population to stay close to the optimal combination because it is harder to optimize more independent traits simultaneously. both the costs and the benefits of complexity appear to be indirect  and weak:  if selection for complexity was direct, there would be a correlation between the effect of mutations on fitness and the ones on complexity, but no such correlation was found ,  if selection for complexity was strong, changes in complexity fixed in the adaptive process should be mostly positive when selection favored an overall increase in complexity and negative in the opposite case. yet, in both cases, the distribution of changes fixed was only slightly off-centered , with almost as many changes towards increased complexity than towards decreased complexity. interestingly, in a fisher's geometric model with fixed complexity, restricted pleiotropy was found to alleviate the costs of complexity in terms of adaptation rate  <cit> . yet in the model developed here, we suggest that restricted pleiotropy emerges to expand the range of accessible combinations of phenotypes. hence the benefit of restricted pleiotropy we monitored is linked to a change of the maximum fitness reached  and presumably not to a change of the rate of adaptation. whether networks with higher complexity tend to adapt faster or slower in our system and whether this effect could promote the evolution of complexity remain to be tested.

finally, restrictive pleiotropy's link to complexity is consistent with ohno's hypothesis for the evolution of complexity via gene duplication  <cit> . much as how restrictive pleiotropy can decouple two phenotypes in our model, gene duplication allows the two gene copies to evolve freely. sub-functionalization following a gene duplication  provides a perfect example of a mechanism by which pleiotropy can be reduced. moreover, as the selection acting on complexity appears to be indirect in our system , our results are compatible with the idea that chance or genetic drift may play a role in the emergence of complexity  <cit> : some slightly deleterious changes in complexity may be required to facilitate the acquisition of subsequent beneficial mutations. this is equivalent to the idea that sub-functionalization may initially result from non-selective forces, but may in the longer term be recruited by natural selection to fine tune the adaptation and therefore support long term incremental evolution of complexity. such a perspective will be subject to further studies.

CONCLUSIONS
using a model of adaptive neural networks, we have shown that phenotypic complexity evolved as a function of the demands of the selective pressures, rather than the physical properties of the network architecture, such as functional size. the phenotypic complexity we observed resulted from a selective balance between the costs associated with the optimization of many independent traits and the benefit provided by the exploration of a larger phenotypic space. our model suggests hence both a selective process for the emergence of phenotypic complexity and a mechanistic model allowing its evolution: the emergence of restricted pleiotropy. our results therefore show that complexity may be more predictable, and understandable, if analyzed from the perspective of the integrated task the organism performs, rather than the physical architecture used to accomplish such tasks. thus, top down metrics emphasizing selection may be better for describing biological complexity than bottom up ones representing size and other physical attributes.

authors' contributions
hln and ot conceived and design the experiments. hln performed the experiments. hln, lc and ot wrote the paper.

