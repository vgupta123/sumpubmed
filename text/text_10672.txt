BACKGROUND
it is evident that that patient history can improve interpretability of diagnostic data such as a panel of assayed biomarkers. when this history includes a previously collected assay, the assay constitutes a reference baseline against which the current assay can be quantitatively compared. however, as the size and complexity of clinical biomarker panels increase, manual cross-assay comparisons become impractical. this motivates the development of automated algorithms that can combine a current target assay and a reference assay with improved prediction or classification performance. in this paper we consider the problem of using a panel of biomarkers to predict a patient’s health state when both the target sample and reference sample are available. two questions are of interest. can such a reference sample be used to more accurately assess the deviation of the target sample from a previously established patient baseline, potentially translating into improved predictions? can such predictions be performed accurately with relatively fewer biomarkers, i.e., a smaller test panel, potentially translating into a less expensive test? in this paper we show that the answer to both of these questions is affirmative. using a state-of-the-art multi-block sparse predictor algorithm, and a large-scale serially sampled data set collected in a human viral challenge study, we present an algorithm for reference-aided health prediction that attains higher predictive accuracy using a smaller panel of biomarkers.

the reader may not find it surprising that automated diagnostics may benefit from pairing a reference sample and a target sample. indeed, it has been common clinical practice for a physician to manually compare a small number of a patient’s analytes to his or her previous test results. however, such manual comparison will become increasingly difficult as we enter the era of precision medicine where whole genome expression or next generation sequencing platforms may play an important clinical role . in this era, automated algorithms will be needed not only for accurate prediction but also for selection of a suitably small subset of the thousands of probes generated by these platforms. such algorithms impose sparsity on the predictor by utilizing only a small fraction of the available probes. the reduction of the number of probes  is relevant to personalized medicine applications since it leads to a more economical  targeted biomarker assay. previous work has developed such algorithms in the context of prediction of acute respiratory virus infection . this paper goes one step further and shows that adding one healthy reference sample can result in improved prediction performance.

the paper is organized as follows. we first present the formulation of our optimization problem in the “methods” section, including the loss function used as surrogates in reference-based classification, the proper regularization that selects variables relevant simultaneously to all classes and references, and followed by a discussion about the general algorithm we propose to solve the optimization. then we present the performance of the reference-based classification applied to h3n <dig>  h1n <dig>  hrv, and rsv flu challenge data sets in the results section. advantages of the methods and biological interpretation are presented in the discussion section. the conclusion section concludes this paper.

methods
the proposed reference-aided prediction method is based on a state-of-the-art supervised multi-block multi-class classifier algorithm with variable selection  <cit> . to illustrate the advantages of the proposed predictor, we will demonstrate superior prediction performance on data collected from large scale serially sampled respiratory virus challenge studies. data from the challenge studies have previously been used by us and others to derive molecular signatures for acute respiratory infection   <cit> . this paper’s contribution is the introduction of a new individualized reference-aided predictor that is demonstrated on an extended set of data collected from additional challenge studies . more details on these challenge studies can be found in the aforemementioned references and in the additional file  <dig>  we describe the challenge studies first and then turn to the automated predictor afterwards.


viral challenge study model
to demonstrate the advantages of reference-based prediction, we use data from a serially sampled challenge study. the challenge study consists of a total of  <dig> subjects  that, shortly after enrollment in the study, were inoculated with sham or live virus from one of  <dig> categories of pathogen . the overall study was conducted over a  <dig> year time period in  <dig> stages . research participants in these studies provided informed consent and all research activities were conducted in accordance with the declaration of helsinki and local policies and regulations. these studies were approved by the duke university health system  institutional review board . where applicable, additional approval was obtained from a local governing irb where the study activities occurred: western institutional review board  and the university of virginia irb approved the studies that were conducted retroscreen virology, london, uk and uva, respectively.

each subject in the study was serially sampled for several days quantifying time courses of whole blood gene expression by affymetrix human u133a  <dig>  genechips, self-reported clinical symptom scores over 8- <dig> symptoms , and viral shedding from periodic nasopharyngeal titrations. the affymetrix gene probes were log transformed and normalized using the rma package with quantile normalization, median polish and a custom cdf mapping from oligoprobes to gene yielding  <dig>  gene probes .

subjects were sampled at least once before the viral inoculum was administered and at least  <dig> times after inoculation. each subject was designated as a symptomatic subject  or an asymptomatic subject  and as an infected subject  or uninfected subject . the asx/sx designation was based on a modified jackson score computed from the self-reported clinical symptoms  <cit> . the inf/uninf designation was determined from viral shedding data: a subject was declared infected if the viral titers exceed a high threshold at any time point or if they exceed a lower threshold at any tow time points. further details are provided in the additional file  <dig> deposited to the geo database .

for the prediction analysis, we excluded  <dig> clinically ambiguous subjects due to inconsistencies between their declared symptomatic status and measured shedding status and  <dig> subjects that had no affymetrix gene probes collected. these  <dig> clinically ambiguous subjects were at some time either acutely infected but asymptomatic or not infected but acutely symptomatic. thus the results reported below are restricted to the  <dig> unambiguously healthy  and unambiguously ill  subjects. of these  <dig> unambiguous subjects  <dig> were infected subjects and  <dig> were uninfected subjects, and they will be designated as such in the sequel.

for these  <dig> subjects five time-specific infection states were determined on the basis of symptom scores and the viral shedding measurements. state  <dig> is “baseline” before inoculation. the other states occur after inoculation. state  <dig> is “asx and uninf” and applies to all post-inoculation samples of the uninfected subjects. states  <dig>   <dig> and  <dig> occur in the infected subjects after inoculation. state  <dig> is “sx and pre-acute inf,” state  <dig> is “sx and acute inf,” and state  <dig> is “sx and post-acute inf.” for each subject a healthy reference genechip sample was taken from baseline  and paired with one of the post-inoculation genechip samples taken from the subject’s post-inoculation time course . the state predictors, described below, were trained and tested on subsets of these paired samples. the  <dig> state designations are illustrated in fig. 2c for the h3n <dig> dee <dig> cohort and in corresponding figures for the hrv, rsv and h1n <dig> cohorts availabel on geo . the additional file  <dig> also contains details about the data collection and the criteria used for designating the states from shedding and symptom score data.


mathematically, we denote the i-th microarray sample as the p= <dig>  dimensional vector xi. the i-th sample is labeled as yi∈{ <dig> ,…,k} corresponding to one of the k= <dig> possible infected/symptomatic states. the subject from whom the i-th sample was collected is denoted as si∈{ <dig> …,m}, where m is the total number of subjects. figure  <dig> illustrates the time vs. subject matrix layout of the challenge study. the time instant labeled  <dig>  corresponds to the time of inoculation. the location of a hypothetical reference sample and target sample for a given subject si is shown in the figure. for illustration, fig.  <dig> shows the titration and symptom data collected from subjects in the h3n <dig> dee <dig> study. similar figures for the other studies, summarized in table  <dig>  are available on geo .
fig.  <dig> sample data layout for standard and reference-aided prediction. each cell in this matrix corresponds to a sample x
i of a subject s
i taken at some time during the viral challenge study. the corresponding infection state label y
i for each target sample x
i is shown in fig.  <dig> c for the particular case of the h3n <dig> challenge study. the standard predictor tries to predict the state using only the target sample. the reference-aided predictor uses both the target sample and the reference sample taken prior to inoculation time, denoted by the white vertical line

fig.  <dig> h3n <dig> dee <dig> challenge study viral shedding map , symptom score map , infection state map . a shows viral titration measurements for each subject at each sample time. b shows the sum of the  <dig> self-reported symptom scores. we use the measurements in a and b to designate each subject as infected , noninfected , symptomatic , or asymptomatic . the subject dedignations can be found in the additional file  <dig>  subjects whose titer scores and symptom scores agree, i.e., those who are either infected and symptomatic or uninfected and asymptomatic, are used for training the predictors. we assign  <dig> state labels to these subjects, as shown in , that correspond to baseline reference , uninf , pre-accute inf , acute inf , and post-acute inf . the onset and offset time of detectable titration are used to set the boundaries between class  <dig> and  <dig> and class  <dig> and  <dig> respectively 



prediction algorithms
to establish and quantify the value of including a subject’s reference sample, we implement a state-of-the-art automated prediction algorithm that performs variable selection and accomodates a reference sample in addition to a target sample. the predictor for the state yi is learned from the biomarker data xi using a supervised sparse multi-block multi-class classification algorithm, described in detail below. the different classes classified by the algorithm correspond to the different infection states. sparsity forces the algorithm to select a small number of biomarkers  from the  <dig>  possible biomarkers. the imposition of sparsity is required in order to minimize overfitting error since the number of samples available to train the classifier is much smaller than the total number of biomarkers  <cit> . the multi-block structure is used to force the reference-aided classifier to use the same subset of biomarkers for the paired reference and target samples in the classifier function. more specifically, as discussed below, for the reference-aided predictor there are two blocks corresponding to, respectively, the gene probe values in the reference sample and the target sample. for the standard predictor there is only one block corresponding to the gene probe values of the target sample.

a classifier is a function that operates on a data point x  and produces a decision ŷ  about the class, where ŷ∈{ <dig> …,k}. in machine learning the classifier function is optimized to achieve the best possible classification accuracy over a set of training samples {xi,yi}i=1n, which are typically a subset  of all the available data. the result of this optimization is often averaged over many different training subsets of the data, e.g., by random resampling or leave-one-out resampling, a process called classifier cross-validation  <cit> . among the many different algorithms available for multi-class classification the support vector machine  is one of the most prevalent. there are two common strategies for multi-class classification that have been proposed:  solving the multi-class problem by a series of binary svm classifiers  <cit> ;  formulating a single unified multi-class svm . in this paper we adopt the latter more direct approach to multi-class classification.

as described in  <cit> , the unified k-class classifier is a scoring based algorithm that classifies the input by computing its score for each class and outputs the class label associated with the maximum score. specifically, given k functions f <dig> …,fk the unified k-class classifier outputs the decision ŷ=argmaxkfk these functions assign confidence scores to the input x and can be chosen as linear functions of the form 
  fk=wktx+bk,k= <dig> …,k 

where wk∈ℝp is a  vector of p weights {wki}i=1p and bk∈ℝ is a scalar offset. while other forms of the score functions are also common, e.g., kernelized linear, polynomial or sigmoidal functions, we will use the linear function  to design both the standard and reference-aided predictor.

since there are many fewer samples  than variables  it is desirable to reduce the number of biomarkers used by the classifier in order to minimize overfitting errors  <cit> . this can be accomplished by constraining the weight vectors {wk}k=1k to have common sparsity, i.e., the wk’s have many common entries equal to zero. defining the k×p weight matrix w=t and k-element vector b=b <dig> …,bkt, this common sparsity constraint is expressed as w having many columns identically equal to zero. this is a form of structured sparsity  <cit> , also called group sparsity, that is mathematically expressed as the “mixed ℓ1/ℓ <dig> norm” constraint on w: ∥w∥ <dig> =∑j=1p∥w∥0≤q, where q is much less than p, w is the j-th column of w and ∥u∥ <dig> is a function that counts the number of non-zeros in a k-element vector u. a convex relaxation of this constraint, adopted for the classifier used in this paper, is the mixed ℓ1/ℓ <dig> norm constraint  <cit> : 
  r=∥w∥ <dig> =∑j=1p∥w∥2≤q, 

where ∥u∥22=∑k=1kuk <dig> denotes the ℓ <dig> or euclidean norm of u.

to specify the unified multiclass classifier it therefore suffices to select the sparse weights w and offsets b defining . these are learned from the data by solving the sparsity penalized empirical risk minimization problem: 
  minw, b1n∑i=1nv+λr, 

where r=∥w∥ <dig>  is the relaxed group sparsity inducing regularization function , λ> <dig> is a regularization parameter, and v is an empirical loss function, depending on the parameters and the training data {xi,yi}i=1n, that penalizes errors between the classifier output ŷi and the true class label yi.

as contrasted to the standard multi-class classifier, developed above, the reference-aided multi-class classifier uses a higher dimensional subject-specific input xs, which is a 2p-dimensional vector, constructed by concatenating the paired reference and target samples of subject s, denoted xsref) and xstarget, into a single vector. note that the j-th and -th elements of the vector xs correspond to the same biomarker . with the subject-specific input xs the weight matrix w of the multi-class classifier is k×2p dimensional. figure  <dig> illustrates the group sparsity constraint that enforces that w select only a few common biomarker variables from each pair. such sparsity structure can be induced into the predictor by modifying the penalty function in  from the mixed ℓ1/ℓ <dig> norm  to the following convex function: 
  r=∑j=1pw~2w~=wt,wtt. fig.  <dig> multi-block group sparsity structure for proposed reference-based predictor. a multi-block multi-class classifier of k= <dig> classes applies a k×2p matrix w= to the combined vector of probes on reference and target gene chips in order to form the vector of scores for each of the k= <dig> states. the two blocks of the classifier correspond to the block of weights w, applied to the reference sample, and the block of weights w, applied to the target sample. the classifier decision rule is to assign the state label that corresonds to the maximum score. the blocks share sparsity, denoted by the black columns in the weight matrix, which designate columns that are identically zero. variables associated with these zero columns are not selected by the classifier



both the standard and the reference-aided multi-class classifier are learned by minimizing a risk function of the form . for the purposes of this paper, we adopt the multi-class hinge loss function v proposed in  <cit>  which, along with the proposed mixed ℓ1/ℓ <dig> norm sparsity penalty r, makes  a convex but non-smooth optimization problem. this problem can be solved with iterative optimization methods and we use an optimization algorithm, developed in  <cit> , that is based on variable splitting  <cit> . the optimization algorithm used in this paper is given as algorithm  <dig> 

a two-stage adaptive group sparsity method was used to further reduce the danger over-fitting in training the classifier. this method is an extension of the adaptive lasso  <cit>  to the group sparse multi-class classification framework developed above. the method is implemented as follows. suppose after solving  we have an initial estimate winit,b of the classifier parameters. then we refine this estimate by solving  once more, except in place of r in  we use 
 radapt=∑j=1p∥w∥2∥winit,∥ <dig>   for the standard classifier. a two-stage adaptive reference-aided classifier is defined similarly except that in the summand defining radapt the weights w and winit, are respectively replaced by w~ and w~init,.



RESULTS
here we demonstrate that the reference-based predictor described in the methods section results in improved state classification accuracy with a smaller panel of biomarkers for the challenge study dataset studied. the standard and reference-aided predictors were trained and tested separately on data from each virus category. these data are denoted h3n <dig>  h1n <dig>  hrv and rsv, respectively, for the pooled data from the two h3n <dig> studies, the pooled data from the two h1n <dig> studies, the pooled data from the two hrv studies, and the data from the single rsv study . these four virus-specific datasets consisted of m= <dig> , <dig>  subjects, respectively. each of the virus-specific datasets was divided into m training-test partitions containing m− <dig> subjects for training by successively removing subjects one at a time for testing . for each of these subsets the predictors were trained by minimization of the empirical risk , using 2-fold cross-validation to first select the regularization parameter λ with the mixed norm sparsity constraint r, and an additional 2-fold cross-validation to select the regularization parameter with the adaptive sparsity inducing regularizers radapt discussed at the end of the methods section on prediction algorithms. the prediction performance and variable selection frequencies were assessed by averaging the predictor’s state misclassification errors over the m training-test partitions.

furthermore, each of the variables in each training set was standardized to z-scores by subtracting the sample mean and dividing by the sample standard deviation, where these sample statistics were computed over the samples in the training set. the biomarkers of each subject in the each test set were standardized using the sample mean and standard deviation computed from the associated training set. to reduce possible bias due to imbalance in the numbers of samples across classes , at each training iteration we applied uneven cost to each sample such that the average sampling proportions among the classes were identical.

the accuracy of the reference-aided predictor is presented in row  <dig> of table  <dig> for each of the four virus-specific datasets. for comparison the accuracy of three other predictors is shown in the remaining rows of table  <dig>  the proposed reference-aided predictor achieves better performance in terms of average error rates. this improvement is achieved using biomarker panels with significantly fewer genes, as compared to the standard predictor in row  <dig> of table  <dig>  the number of genes selected by the standard predictor was optimized by the two-stage adaptive cross-validation procedure described in section methods. row  <dig> shows the performance of a constrained standard predictor when the regularization parameter is selected so that it uses approximately the same number of genes as the proposed reference-aided predictor. the actual genes selected by this constrained predictor differ from those slected by the reference-aided predictor and the performance is significantly worse than the unconstrained predictor in row  <dig>  row  <dig> shows the performance of a differential predictor that is implemented by applying the standard predictor to the difference between target and reference sample xstarget−xsref. this differential predictor is implemented by restricting the reference-aided predictor to the case where the reference and target weights have identical magnitudes but opposite signs. the performance in row  <dig> of table is better than that of the standard predictors  but worse than that of the proposed predictor . this indicates that simple differencing of the target and reference samples, corresponding to using all probes as contrast genes and none as reinforcement genes, leads to a less effective predictor than the one proposed in row  <dig> of table  <dig> 


the per-chip misclassification error rates, computed by aggregating over the m training-test partitions, are shown in fig.  <dig> as heatmaps over times and subjects for each virus-specific dataset. figures  <dig> and  <dig> show that the proposed reference-aided predictor achieves the most improvement in predicting states  <dig>  and  <dig> , which are the most difficult states to classify.
fig.  <dig> heatmaps of predictor error rates for h3n <dig> dee <dig> dataset. the heatmaps of the sample-specific predictor error rate for classifying states  <dig> , <dig> and  <dig>  defined in fig.  <dig>  for samples in the h3n <dig> dee <dig> dataset. the top figure  shows the error rates of the standard predictor . the bottom figure  show the corresponding results of the reference-aided predictor

fig.  <dig> heatmaps of predictor error rates for h3n <dig> dee <dig> dataset. the heatmaps of the sample-specific predictor error rate for classifying states  <dig> , <dig> and  <dig>  defined in fig.  <dig>  for samples in the h3n <dig> dee <dig> dataset. the figure shows the difference between the error rates of the standard predictor  and the error rates of the reference-aided predictor  for h3n <dig> dee <dig>  the entries in red have higher error rate using the standard predictor than the reference-aided predictor, and vice versa



the different roles of the biomarkers that were automatically selected by the reference-aided predictor yields insight into these accuracy improvements. for concreteness, we focus on the h3n <dig> dataset. see additional file  <dig> for analysis of the biomarkers selected in the hrv, rsv and h1n <dig> datasets. the variables that were frequently selected by the reference-aided predictors are shown in fig. 6a for h3n <dig>  the genes in this figure were selected with frequency at least  <dig> %; i.e., they were included in the trained reference-aided classifier in at least  <dig> % of the training-test partition sets. the genes are ordered according to the cluster order illustrated in panel b. the bars in fig. 6a represent the average value of the weight w applied to a specific gene in the reference sample , denoted as yellow bar, and the weight w applied to the same gene in the target sample , denoted as a green bar. these selected biomarkers can be grouped into two categories:  contrasting genes ; and  reinforcing genes . contrasting genes are selected by the predictor for their differential expression between r and t, while reinforcing genes do not differentially express but rather serve to normalize the other variables .
fig.  <dig> biomarkers selected by reference-aided predictor. the top figures in  show the genes selected by the proposed reference-aided predictor with selection frequency ≥ <dig> % for the  <dig> different score functions for states  <dig> , <dig> . the value of the classifier weights for each of the score functions are shown as yellow bars  and green bars . note that genes having yellow and green bars of opposite sign are contrasting information in r vs t while genes having these bars with the same sign are reinforcing information in r and t. the bottom figures in  show the expression of the genes shown in  averaged over the uninfected subjects  and infected subjects . the expression levels are normalized such that the maximum and minimum of each gene achieve  <dig> and − <dig> respectively. let the averaged expression at time t be z, the maximum of z be z
max, and the minimum be z
max. the normalized expression levels are computed as z~=2×z− <dig> ×/




an example of a contrasting gene is the interferon induced gene ifi <dig> which differentially expresses between r and t for states  <dig>   <dig>   <dig> and  <dig>  interestingly, the signs of the r and t weights for ifi <dig> are reversed in the score function for state  <dig>  as compared to their signs for the score functions of the other three states : a relative decrease in ifi <dig> from reference to target sample induces a high uninf score while a relative increase induces a high inf score. an example of a reinforcing gene is the immunoglobin lambda variable iglv3- <dig> that plays the role of reinforcing the uninf state  to the detriment of the inf states . another example, that reinforces the inf states instead of the uninf state, is the nedd <dig> binding protein gene n4bp <dig>  note that some genes, e.g., pex <dig> and loc <dig>  take on a contrast role for some states while they take on a normalizing role for other states. many of the genes that were selected by the reference-aided predictor were not selected by other predictors studied in table  <dig>  . since the differential predictor can only form contrasts between reference and target gene probes none of the reinforcing genes. indeed, we did not find the reinforcing genes, e.g., igvl3- <dig>  nbp <dig> and myom <dig> were selected by the differential predictor. the lack of reinforcement genes deprives the differential classifier of potential normalizing variables leading to poorer performance.

the average expression levels over time of the frequently selected h3n <dig> genes shown in fig. 6a are shown as heatmaps in fig. 6b, where the expression levels are averaged over the uninfected and infected subjects, respectively, in the left and right heatmaps. notice that the reinforcing genes, such as igvl3- <dig>  nbp <dig> and myom <dig>  appear to be related to susceptibility since the expression levels are substantially higher or lower in the uninfected population than in the infected population, even before viral inoculation. the expression levels of contrast genes such as ifi <dig>  pex <dig> and loc <dig>  are relatively stable in the uninfected subjects but rapidly increase as an infected subject enters the acute inf phase .

the improved accuracy of the reference-aided predictor can be visualized by rendering a scatter plot of the vector of confidence scores, defined in , over all of the samples. in fig.  <dig> the scatterplot of the k= <dig> dimensional vector of scores is shown for the h3n <dig> pooled challenge studies. in the scatterplot each of these vectors has been given a different color depending on the state of the particular target sample at which the score is evaluated. the right panel of fig.  <dig> shows the scatterplot of confidence scores computed with the classifier weight matrix w by reference-aided predictor, averaged over the m training-test partitions. the left panel shows the associated scatterplot for the standard predictor, implemented with the average weights. notice that the scores are better separated when the references are taken into account. note that both with and without reference-aided training, among all pairs of states, discrimination between state  <dig>  and state  <dig>  is the most difficult. this is explained by the fact that states  <dig> and  <dig> apply to the same group of subjects, namely, those that develop acute symptomatic infection with significant levels of viral shedding. for these subjects the ari signature is developing during state  <dig> and comes into full bloom during state  <dig>  thus making these states more similar to each other.
fig.  <dig> scatter plots of the vector of scores over the h3n <dig> samples. shown are scatterplots of the score functions in the multi-class classifier evaluated for the standard predictor  at left and for the reference-aided predictor  at right. points with a particular denote the vector of scores for states  <dig>   <dig>  and  <dig> for samples labeled with a particular state. the scores are better separated when the references are taken into account. especially note that the class  <dig>  scores  are much better separated



there are common genes in the four sets of biomarkers selected by the predictors trained separately on the hrv, rsv, h3n <dig>  and h1n <dig> viral-specific datasets. we call these common biomarkers pan-viral predictive genes. a venn diagram of all the biomarkers that have been found in each virus study is shown in fig.  <dig>  and the pan-viral predictive genes in the intersection among all of the studies are listed in table  <dig>  heatmaps, analogous to those shown in the h3n <dig> heatmap fig. 6b, are shown for these pan-viral predictive genes in fig.  <dig> for all  <dig> viral-specific datasets. similarly to the h3n <dig> heatmap, some genes seem to have a reinforcement role, such as c7orf <dig>  and others have a contrasting role, such as ifi <dig> 
fig.  <dig> venn diagram of the genes selected in hrv, rsv, h3n <dig> and h1n <dig> datasets. indicated are the intersections of the genes that were selected at least once by the standard predictor  and reference-aided predictor  in each of the virus-specific datasets. the list of the genes in the intersection among all  <dig> datasets is listed in table  <dig>  these are called pan-viral predictive genes

fig.  <dig> expression profiles of reference-aided pan-viral predictive genes. average expression profiles of the pan-viral predictive genes discovered by the reference-aided predictor  averaged over the uninfected subjects  and infected subjects  in each virus-specific dataset . the expression levels are normalized such that the maximum and minimum of each gene achieve  <dig> and − <dig> respectively




discussion
the proposed reference-aided predictor significantly outperformed the standard predictor that does not use the reference, implemented with a single block multi-class classification algorithm. specifically, the reference-aided predictor achieved an average  state prediction accuracy improvement of:  <dig> % for rsv,  <dig> % for h3n <dig>   <dig> % for hrv, and  <dig> % for h1n <dig>  remarkably, for all of these viral challenges this gain in accuracy was achieved with a smaller panel of genes:  <dig> % fewer for rsv,  <dig> % fewer form h3n <dig>   <dig> % fewer for hrv, and  <dig> % fewer for h1n <dig>  as shown in table  <dig>  this suggests that by including such a reference sample with the target sample, the reference-aided predictor can build a more parsimonious description of the infected vs uninfected phenotypes. as seen in the previous section, this better description translates into improved prediction of infection state. there are several possible reasons that the reference-aided predictor achieves improvement in accuracy while using significantly fewer predictor variables. first, by pairing an individual’s target sample to his baseline reference sample, the reference-aided predictor turns the standard predictor into an individualized predictor. second, the availability of a baseline sample allows the predictor to learn genes that display a contrast between an individual’s healthy baseline and sick target samples. third, even though the reference-aided predictor has to learn twice as many coefficients, our predictor sparsity penalty forces most of these to zero, resulting in a more parsimonious predictor that minimizes overfitting errors.

moreover, many of the genes in the panels selected by the automated reference-aided predictor and the standard predictor were different. the genes in the standard predictor were similar to the acute respiratory infection  signature reported in  <cit> . the reference-aided predictor selected a panel of genes that fall into two classes: 1) contrast genes that exploit the fact the the baseline reference differs significantly from the target sample; 2) reinforcement genes that do not differ significantly but are used by the classifier for baseline normalization. specifically, for a contrast gene, the predictor forms a weighted average of the baseline and target expression levels using two coefficients having opposite sign. for a reinforcement gene these two coefficients have the same sign. we caution that these definitions only make sense when the two coefficients have similar magnitudes.

the reference-aided predictor identified the pan-viral predictive genes as some of the best subject-specific genes that either reinforce or contrast expression in the subject’s reference and target samples. many of these genes are not included in the standard predictor that does not use a reference. table 3) indicates that the reference-aided predictor found  <dig> pan-viral predictive genes  that were not found by the standard predictor. while some of these are orthologs to genes in the standard predictor, others might represent additional pathways that can only be picked up by analysis of paired samples. for example, some studies suggest that ifitm <dig> is important for intrinsic viral resistance. specifically, in vitro studies show that many pathogenic viruses’ replication can be restricted by genes in the interferon inducible transmembrane  protein family, and it has been found that ifitm <dig> plays an important role in the host’s defense against influenza a virus  <cit> . furthermore, it has been reported that during rsv infection deletion of ccr <dig> leads to attenuated pathophysiologic responses  <cit>  and, as reported by the ncbi gene database, an important acute phase plasma protein is encoded by orosomucoid  <dig> , which can be stimulated during acute inflammation and be may an important factor in immunosuppression. other genes among the  <dig> genes specific to the reference-aided predictor have no obvious function in immune response but appear to have been selected to serve as normalization genes.

many of the genes that were selected by both the predictors  are well known transcription factors in host immune response. specifically, interferon-stimulated genes, such as ifi44l, produce cellular factors that protect cells against invading viral pathogens  <cit> . oas <dig> has been identified to be relevant to apoptosis, which eliminates the cells that have damaged dna or have experienced uncontrolled proliferation  <cit> . therefore, it may prevent viral replication by eliminating virus-infected cells. indeed we observe the steady up-regulation of oas <dig> during acute-infection. the role of isg <dig> in innate immunity to viral infection has been studied in  <cit> , and has been found to be highly expressed upon viral infection. il1f <dig> is reported in  <cit>  to be be up-regulated in cells involved in immune responses induced by hrv. irf <dig> is one of the transcriptional activators, along with stat <dig> in the isgf <dig> transcriptional complex, which stimulates the expression of the interferon-inducible genes, e.g., irf <dig> for antiviral responses  <cit> . irf <dig> is one of the interferon regulatory factors, which regulates transcriptional activities to induce cellular response to the invasion of viruses. it has been reported to induce the interferon inducible genes like ifi <dig> in infected cells  <cit> . further studies suggest that irf <dig> controls both the innate immunity and adaptive immunity  <cit> . several of the pan-viral predictive genes, e.g, ifi44l, ifi <dig>  and oas <dig> are related to type-i interferon antiviral response, and have been reported to constitute pathways regulating inflammatory response .

in this paper, several viral challenge study datasets were used to demonstrate the intrinsic value of the proposed reference-aided method for biomarker selection and improved performance in predicting symptomatic infection. these findings are, of course, specific to the setting of our challenge studies and the value for clinical applications needs to be further explored. two issues stand in the way of direct generalization of our findings to clinical medicine.

the first issue is that each enrolled subject’s healthy reference sample was collected within  <dig> h of exposure to the viral pathogen. an open question is whether the demonstrated performance advantages of the proposed method would generalize to the clinically relevant case where the reference sample collected in the more distant past. such a generalization will require testing our method on observational data collected over a longer baseline period than  <dig> h prior to exposure. given the expanding interest in discovery of temporal pathways for processes such as biochronicity, immunity, and aging, we can anticipate that such data will become available in the not so distant future.

the second issue is that the findings reported here are restricted to the subset of enrolled individuals who unambiguously reported health or illness, as measured by concordance between viral shedding and self-reported symptoms. all predictors have low average accuracy when ambiguous reports are included in the training data, even though the proposed reference-aided predictor maintains significant performance advantages over the other predictors to classify the state of infection . this poor performance on ambiguous subjects may signal the need for more complex non-linear modeling of gene expression for these subjects. on the other hand, such ambiguities may simply reflect the inadequacy of viral shedding and self reported symptom as reliable proxies for symptomatic illness.

in spite of these caveats, the framework presented here may be relevant to personalized medicine, where preventative and diagnostic medical testing could possibly benefit from availability of a recent personalized baseline reference. the reported results establish that, when used with a carefully designed classifier, inclusion of such a reference can improve the accuracy of classifiers of early onset infection based on gene expression assays. furthermore, the variables selected by the predictor can give insight into the molecular discriminants that provide high contrast between healthy baseline and infection states. the referenced-based classifier framework we have developed can likely be extended to other diseases and diagnostic tasks, e.g., classifiying yellow fever  <cit>  or personal health monitoring  <cit> . for example, in a recently published paper by chen et al.  <cit> , the authors have demonstrated the ability of a personal ‘omics’ profile to reveal dynamic molecular and medical phenotypes by monitoring a single individual over  <dig> months. this might be modeled by our multi-block multi-class classifier framework, where the blocks partition the periods of health and sickness and the classes indicate different stages of infection and/or types of infection. the accuracy of such a multi-block classifier might also benefit from integration of other biomarkers, e.g., proteomic, metabolomic, antibody, into the predictor.

CONCLUSIONS
this paper developed reference-aided prediction as way to design personalized test panels and associated predictors when one can pair a target sample with a baseline reference sample from the same subject. the framework is applicable when a population of serial samples from multiple subjects are available. the proposed referenced-aided predictor uses the framework of learning sparse linear score functions in a multi-block multi-class support vector machine . however, other types of reference-aided predictors may also be worth investigating, e.g., using multi-block non-linear kernelized multi-class classifiers or multinomial logistic classifiers.

we used a large-scale respiratory virus challenge study to illustrate the advantages of reference-aided prediction. in this predictive health problem, pre-inoculation reference  samples of each subject are incorporated into the classifier along with post-inoculation target samples. application of the reference-aided predictor demonstrated significant improvement in the accuracy of prediction of different stages of host immune response for infected and uninfected subjects. furthermore, it achieved this improved accuracy using fewer biomarkers than a standard predictor that does not use a reference sample. some of the biomarkers discovered by the reference-aided predictor are genes that exhibit high contrast in expression between the target and reference samples. other biomarkers were discovered to be low contrast genes that use the reference sample to normalize the target sample.

with minor modification, the prediction algorithm used in this paper applies to more general serially sampled diagnostic tests than the single-reference/single-target predictor. for example, consider a predictor that labels the state of a particular subject at the time a target sample is acquired using both the target sample and at least one previously acquired sample. this framework is applicable to a wide range of applications in diagnostic medicine, drug discovery and biology. for example, when using a panel of biomarkers to test for health or disease of the subject, the anterior samples might correspond to the same panel taken when the subject was at a baseline of health. when testing for the specific stage of an advancing disease the anterior samples may be panels of previously acquired target samples. it is likely that in these situations, reference-aided predictors will similarly show accuracy benefits.

availability of supporting data
the data has been deposited to the geo database .

additional file
additional file  <dig> 
supplemental materials for the paper: an individualized predictor of health and disease using paired reference and target samples. 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

cww, akz and gsg conceived and designed the experiments. tb and lpp participated in the subject designation. tl and aoh contributed analysis tools and analyzed the data. tl and aoh wrote the paper. all authors read and approved the final manuscript.

