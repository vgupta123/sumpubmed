BACKGROUND
over the past few years, molecular evolution within a network architecture has been of great interest in population genetics  <cit> . studies on major cellular pathways have demonstrated that network topology constrains the evolutionary pattern of genes. many reports have demonstrated the existence of a positive correlation between gene pathway position and nucleotide substitution rate. for example, in the melanin synthesis pathway of silkworms  <cit> , the anthocyanin biosynthetic pathway in plants  <cit> , and the drosophila ras signal transduction pathway  <cit>  the upstream genes are subjected to stronger evolutionary constraints. in contrast, an opposite effect was observed in other pathways, such as the animal toll-like receptor   <cit>  and the yeast hog  <cit>  signaling pathways. moreover, in the caenorhabditis insulin/tor signaling transduction pathway, the pattern of selective constraints is driven by expression level  <cit> , whereas in the n-glycosylation metabolic pathways across primates, connectivity of each gene drives the strength of purifying selection  <cit> .

multiple factors may affect the evolution of genes within networks and pathways, including the gene position, gene expression level  <cit> , protein length  <cit> , codon bias  <cit> , connectivity  <cit> , the number of regulatory micrornas  that target a gene  <cit> , and the length of its 3′-untranslated region   <cit> . furthermore, studies have demonstrated that mirnas participate in the regulation of innate immunity and inflammatory responses  <cit> . thus, mirna regulation should be analyzed from an evolutionary perspective to improve our understanding of the impact of mirnas on protein evolution.

the nuclear factor κb  pathway plays a central role in innate immunity by which invertebrates defend against pathogens  <cit> . drosophila possess two pathways  to activate nf-κb transcription factors  <cit> . the toll pathway is responsible for defense against gram-positive bacteria or fungi when the cleaved ligand spatzle binds to the toll receptor, eventually leading to the activation of the nf-κb family members dorsal and dorsal-related immunity factor . this pathway also participates both in developmental processes  <cit>  and immunity  <cit> . in contrast, the imd pathway controls resistance to gram-negative bacterial infections  <cit> . the jak-stat pathway also correlates with the drosophila innate immune response, but unlike the toll and imd pathways, it remains poorly understood, and only four genes  have been reported within this pathway  <cit> . studies have shown that natural selection may drive the evolution of immune system proteins  <cit> . yet, the mechanism by which network architecture influences protein evolution within innate immune systems remains unclear. the complete genome sequences of drosophila species and our current knowledge of the innate immune pathways in d. melanogaster together offer opportunity for a fine-scale evolutionary analysis of the drosophila toll and imd pathways within the context of a network framework.
drosophila 
toll and imd pathways.

by surveying recent papers, we identified  <dig> immune-related genes that are directly involved in the drosophila toll and imd signaling pathways, by transferring signals from receptor to transcription factor. we further investigated the evolutionary mechanism of toll and imd pathway genes across drosophila species to understand 1) whether there exists a correlation between the strength of purifying selection and gene pathway position within the toll and imd innate immune signaling pathways; and 2) which of the topological parameters that characterize network evolution contributes most to the observed selective patterns.

RESULTS
analysis of protein sequence evolution
variation in selective constraints across immunity pathways was assessed with the help of the program paml  <cit>  and a comparison of alternative evolutionary models. for all  <dig> immune-related genes that we identified from the literature, the m <dig>  model calculated a single nonsynonymous/synonymous substitution rate  ratio for all branches using a muscle alignment  <cit> . according to our results, the drosophila immune genes have undergone strong functional constraints, with ω values ranging from  <dig>   to  <dig>   . additionally, by comparing the m1a  and m2a  models, the m <dig>  and m <dig>  models, and also the m <dig> and m8a  models, positive selection was observed for spz, mstprox, tl, toll- <dig>  cact, dif, sphinx <dig>  ect <dig>  and dnr <dig> . however, after the false discovery rate test , only five genes  remained significantly positively selected . to improve the reliability of our analysis, we further used a prank  <cit>  alignment and detected positive selection for dnr <dig>  sphinx <dig>  mst and tl after the fdr test  . the paml results based on two different alignments  were only consistent for two genes, sphinx <dig> and dnr <dig>  therefore, these two genes seemed to contain a rather robust signal of positive selection, strongly suggesting that they were indeed subjected to positive selective constraints.

the strength of purifying selection within drosophila toll and imd signaling pathways
correlations between evolutionary parameters  and topological factors  were estimated applying spearman’s rank correlation coefficients . for different factors that may affect protein sequence evolution, a significant negative correlation between ω values and gene position was observed , indicating that the downstream genes were more conserved and therefore underwent stronger purifying selection. in addition, dn and ds values were significantly correlated with gene position .

given that selective constraints can be affected by various topological factors, the relationship between different variables was further analyzed. according to our results, connectivity was significantly correlated with the expression level of immune genes after infection by bacterial  or fungal  . when we estimated the expression levels after infection at each separate time point, similar results were observed . the highly significant correlation between connectivity and gene expression level indicated that the more connected a protein was, the higher gene expression level it had.

we also observed that the number of regulatory mirnas  and the length of the 3′-utr  both significantly correlated with dn, ds, and ω . to test the robustness of our predicted mirna targets, we set the miranda score to a higher level of  <dig> ,  <dig> , and the correlation remained significant . these results confirmed that genes regulated by more mirnas were likely to undergo stronger functional constraints and therefore evolve at slower rates  <cit> .
dn, 
ds 
and 
ω


dn
ds
ω
this table is calculated based on all the genes involved in toll and imd pathways;

lower and upper indicates the confidence intervals of the correlation;

*, p <  <dig>  after the fdr correction at q =  <dig> .

multivariate analysis
to investigate whether the observed correlations resulted from direct or indirect influences, two multivariate analysis techniques  were performed. as shown in additional file 1: table s <dig>  gene pathway position, the number of regulatory mirnas, and the length of the 3′-utr are correlated with each other and with the dn, ds, and ω values. partial analysis revealed that, when controlling for nmir and l3′utr, the correlation between position and dn remained significant  while those between position and ds and between position and ω disappeared . similarly, when controlling for l3′utr, the significant correlations disappeared, except for those between dn and position , between nmir and dn , and between nmir and ds , suggesting that the correlations between nmir and dn and between nmir and ds were not mediated by the length of the 3′-utr. however, when controlling for nmir, only the correlation between dn and position remained significant , while the correlations between l3′utr and dn, ds, and ω were no longer significant , indicating that the correlation between gene evolutionary rate and l3′utr was mediated by the number of regulatory mirnas. throughout our partial analysis, the significant correlation between pathway position and dn consequently indicated that gene position within the pathway is an important parameter that influences protein sequence evolution within a network framework.

through path analysis, the regression coefficients can be decomposed into direct and indirect correlations under the user-defined causal model. we therefore applied path analysis to investigate which contributor primarily constrained protein evolution within the network framework. during our path analysis , dn and ω were considered endogenous variables while the other variables were considered exogenous. consistent with the results of partial correlation analysis, we observed that dn was significantly affected by position  while ω was only affected by dn  even after removing the influence of other topological features. in addition, dn was significantly correlated with enc . thus, figure  <dig> demonstrates that pathway position and enc can affect ω by influencing dn. similar results were observed when enc was considered as an endogenous variable in addition to dn and ω. together, these results suggest that among the parameters that describe the network, pathway position is a major contributor to the tendency of the selective constraints.

discussion
positive selection acting on toll and imd pathway genes
there were  <dig> genes in common between the study by sackton et al. on the dynamic evolution of the drosophila innate immune system  <cit>  and ours. sackton and his colleagues detected signals of positive selection for dnr <dig>  modsp, pgrp-lc, and nec, whereas we detected signals of positive selection for dnr <dig>  sphinx <dig>  dif, cact, and ect <dig>  the discrepancy between these studies might result from the use of different aligners . to explore the hypothesis, we performed the similarity analysis again using prank. our results showed positive selection for dnr <dig>  sphinx <dig>  mst, and tl after the fdr test . only two of the genes, sphinx <dig> and dnr <dig>  were consistently identified in at least two of the three analyses based on different alignments. therefore, these two genes seemed to exhibit a rather robust signal of positive selection, strongly indicating that they have indeed undergone such selective constraints. overall, the discrepancy between different alignments confirmed that the choice of alignment algorithm has a strong impact on estimates of positive selection  <cit> . as described in markova-raina et al., not all alignment errors are created equal, and even prank, which was reported to outperform other aligners in simulation  <cit> , still has a high false positives rate; therefore, one must compare the results of different alignment programs to reduce the rate of false positives in estimates of positive selection.

for sphinx <dig>  which is located upstream in the innate immune pathway, the positive selection acting on it might make it more functional, better adapted to the changing extracellular environment, and subsequently, gain new functions through adaptive evolution  <cit> . furthermore, a quantitative analysis by obbard et al.  <cit>  confirmed that adaptive evolution is a major factor driving molecular evolution within the drosophila immune system. while we performed our network-level analysis from a phylogenetic perspective, obbard et al. focused on population genetic data  to quantify the effects of natural selection. despite different data and methods in our study and that of obbard et al., we both found that the peptidoglycan recognition protein and gram-negative binding protein showed no signs of positive selection, perhaps because of their roles in binding with highly conserved microbial molecules  <cit> .

selective constraints and pathway architecture
because upstream genes are more exposed to the hostile environment, to defend against pathogens, mutations in these genes are likely to have more pleiotropic effects than those in genes acting downstream. studies have also demonstrated that immune system genes tend to exhibit higher rates of adaptive evolution, which have been attributed to their coevolution with pathogens  <cit> . indeed, in our analysis, we detected a robust negative correlation between the rate of protein evolution and a gene’s position in the drosophila toll and imd signaling pathways, indicating that upstream genes experienced more relaxed selective constraints. a similar distribution of purifying selection has also been observed along the insulin/tor pathways in vertebrates and drosophila <cit> , the animal tlr signaling pathway  <cit> , the n-glycosylation metabolic pathway in primates  <cit> , and the hog signal transduction pathway in yeast  <cit> .

throughout our multivariate analysis, the correlation between gene position and dn was significant, and given the results of path analysis, we see that pathway position can influence ω values through an effect on dn. because dn/ds is the measure of selection/constraint, dn is actually the metric of selective pressure; these results overall demonstrated that gene position within the network was an important factor driving the polarity of selective constraints along toll and imd pathways. although in the caenorhabditis insulin/tor signaling transduction pathway, the pattern of selective constraints was driven by expression level  <cit> , and in the n-glycosylation metabolic pathway in primates, connectivity was the main contributor  <cit>  a study of animal tlr signaling pathway  <cit>  agrees with our results in finding a negative relationship between evolutionary constraint and gene position. because the toll and imd signaling pathways are homologous to the mammalian tlr signaling pathway, which plays a vital role in animal innate immunity  <cit> , the shared evolutionary pattern provides strong supporting evidence for our observations.

the negative correlation between the number of regulatory mirnas and protein sequence evolution
in addition to the negative correlation between gene evolutionary rates and pathway position, we observed significant correlations between nmir and the ds, dn, and ω values, and between l3′utr and the ds, dn, and ω values. given the significant correlation between nmir and l3′utr, to determine which was the main factor influencing evolutionary rates , partial analysis was performed. when controlling for l3′utr, the correlation between nmir and dn and between nmir and ds remained significant. however, when controlling for nmir, the significant correlation between l3′utr and dn, ds and ω all disappeared, indicating that the correlation between gene evolutionary rates and l3′utr was mediated by the number of regulatory mirnas. one possible explanation is that genes regulated by more mirnas tend to have more molecular functions in different biological processes  <cit> . consequently, these pleiotropic genes require more complex and precise regulation by mirna  <cit> .

in this study, we estimated different topological parameters that may influence the evolution of immune-related gene within a network framework. because dn, ds, and ω are subjected to many evolutionary pressures, there might be other topological factors that we did not consider in this study. notably, to estimate the evolutionary pattern of genes in the drosophila immune pathways toll and imd, the expression data we analyzed were gene expression levels after infection rather than constitutive expression. compared with previous studies, we added two more topological parameters to our analysis  to improve our understanding of the impact of mirnas on protein sequence evolution.

CONCLUSIONS
we found a polarity in the strength of purifying selection along the drosophila toll and imd pathways, with the downstream genes being more conserved. of all the immune genes investigated, two  exhibited signals of positive selection. notably, we provided strong evidence to show that gene position within the pathway was an important parameter influencing protein sequence evolution within the drosophila toll and imd innate immune response systems. moreover, the negative correlation between protein sequence evolution and the number of regulatory mirnas confirmed that genes regulated by more mirnas are likely to undergo stronger functional constraints, and therefore exhibit slower gene evolutionary rates. further studies investigating the patterns of molecular evolution within different pathways will undoubtedly improve our understanding of natural selection in pathways and networks.

