BACKGROUND
the technology of long-read sequencing now offers different alternatives to solve genome assembly problems  and haplotype phasing, which cannot be resolved adequately by short-read sequencing. application of the single-molecule real-time sequencing  platform produced by pacific biosciences to small microbial as well as large complex eukaryotic genomes demonstrated the possibility of considerably improving genome assembly quality  <cit> . microbial genome could now be fully assembled  using pacific biosciences’s smrt reads alone  <cit>  or in combination with short but high quality reads  <cit> . the high error rate of smrt reads renders the necessity for either deep coverage or a strategy of error correction using illumina reads. it’s clear that the current yield and high cost per base of this technology remain a barrier for most genomic projects targeting large genomes. moreover, the price of the commercially available pacific biosystems pacbio rs ii instrument is high and the needs in terms of infrastructure and implementation does not make it accessible to the whole research community. similar improvements in read length were also accomplished by the illumina truseq synthetic long-read sequencing strategy; its application to the human genome and the resolution of highly repetitive elements in the fly genome provided encouraging results  <cit>  and showed the importance of long and high-quality reads. nonetheless, the long range polymerase chain reaction step included in the library preparation may introduce important genome coverage biases. moreover the time needed for library construction may be a limitation in a time-constrained project, and again does not make it accessible to the whole research community.

this year, oxford nanopore technologies ltd released the minion® device, a single-molecule nanopore sequencer connected to a laptop through a usb  <dig>  interface, to hundreds of members of the minion® access programme  who are testing the new device. the technology is based on an array of nanopores embedded on a chip that detects consecutive 5-mers of a single-strand dna molecule by electrical sensing  <cit> . this new technology provides several advantages: the minion® device is small and low cost, the library construction involves a simplified method, no amplification step is needed, and data acquisition and analyses occur in real time. in the oxford nanopore technology, the two strands of a dna molecule are linked by a hairpin and sequenced consecutively. when the two strands of the molecule are read successfully, a consensus is built to obtain a more accurate read . otherwise only the forward strand sequence is provided .

minion® tests were performed by all early access members, first on the phage lambda genome. three recent publications of these studies  <cit>  showed the production of long reads with an average size of  <dig>  and  <dig>  bp, respectively. these primary studies point to a high error rate in reads from the current version of minion®. however, despite the high error rate, ashton et al.  <cit>  demonstrate the potential of the minion® device for microbial sequencing. this motivated the need to develop new tools, either for minion® read correction or for new alignment algorithms. methods for correction of long reads produced for the pacific biosciences sequencer have already been proposed  <cit> . however, these methods are based on read alignment, thus the ability to correct input reads is linked to the local error rate. as a consequence, the size of the corrected read is closely correlated to the sequencing errors of the input long read. long and relatively inaccurate reads that harbor hotspots of sequencing errors will lead to mosaic reads, with alternating regions of high and low fidelity. as existing assembly softwares were not implemented to deal with long reads with a high error rate, we developed a method based on a combination of two sequencing technologies: oxford nanopore and illumina, to produce long and accurate synthetic reads before assembly.

RESULTS
overview of minion® reads
we performed five runs of minion® sequencing with four different a. baylyi genomic dna libraries , and two different flowcell chemistries, r <dig> and r <dig>  . we produced a total of  <dig>  reads, representing a genome coverage of approximately  <dig> ×. about 13% of these  <dig>  reads were 2d reads, which represent 42% of the cumulative size, indicating a significant difference of length between 1d and 2d reads. the 1d reads had an average size of  <dig>  bp, in contrast the average size of 2d reads reached  <dig>  bp . the n <dig> size is two times higher when using the 20 kb library, suggesting that we obtained longer minion® reads when sheared size is increased. the lower average read size of run <dig> and run <dig> was due to a high proportion of very short 1d reads . these two runs were achieved using the same library preparation . as previously reported  <cit> , we observed a low mappability on the reference genome  <cit> ;  <dig> % of 2d reads and  <dig> % of 1d reads were aligned . thus, the real genome coverage, when only taking into account aligned nucleotides, is about  <dig> ×. the mean identity to the reference of 1d reads was  <dig> % while 2d reads revealed a mean identity of  <dig> %. the r <dig>  chemistry showed several improvements in terms of throughput, proportion of 2d bases  and in quality of 2d reads . even, if more recent chemistry and flowcells exhibited a significant progress, these first results still showed a heterogeneity in throughput and in proportion of 2d reads.table  <dig> 
overview of the five minion® runs


run1
run2
run3
run4
run5


1d reads
2d reads


nas overview
because the accuracy of minion® reads is not high , we developed the nas workflow to overcome the limitation of existing assemblers. the ability to successfully align illumina reads on minion® templates is strongly reduced and as a result we observed that existing methods like proovread  <cit>  are not performing well with this new type of data . instead of using illumina short reads to correct minion® reads, we propose a method that uses the minion® read as a template to recruit illumina reads and, by performing a local assembly, build a high-quality synthetic read . in the first step, a stringent alignment is performed to efficiently retrieve illumina short reads and their complementary sequences, called seed-reads. next, the seed-read set is extended by searching for similar reads and their complementary sequences in the initial set . this second step is crucial to retrieve illumina reads that correspond to low-quality regions of the template . finally, a micro-assembly of the reads is performed, using an overlap-layout-consensus strategy .figure  <dig> the nas workflow. inputs are the illumina short reads and the minion® reads , purple bars on minion® reads represent sequencing errors. step <dig>  illumina reads are aligned on the minion® templates to select seed-reads . step <dig>  seed-reads are used to recruit similar reads in the initial illumina read set. step <dig>  good recruits  are light blue rectangles, bad recruits  are red rectangles. step <dig>  overlap-layout-consensus-based assembly of the recruited-reads and the seed-reads. outputted contigs  are then filtered using seed-read alignments. in this example, after filtering step, a single contig representing the final nas read is produced.



in most cases , none or one contig is obtained per minion® template. however in repeated regions, the micro-assembly leads to a complicated contig-graph structure. in fact, in the second step of the process, a small fraction of reads that did not come from the correct genomic regions were recruited. these incorrect reads produce contigs, named foreign-contigs that should not be associated with the minion® template; moreover these contigs generate branch points in the contig-graph.

the basic idea to solve the repeats problem and to remove foreign-contigs from the assembly was to select the path that used the contigs with the highest seed-reads coverage . then the consistency of the output synthetic read was checked by aligning the initial illumina reads set.figure  <dig> untangling complex regions. in the case of repetitive regions , the nas workflow produced several contigs per minion® template . indeed, the nas read is fragmented, due to the indeterminate position of the repetitive region, contig <dig>  step <dig>  construction of the contig graph weighted with the seed-reads coverage of the given contig. contig <dig>  which represents the repetitive region, is linked to four different contigs. step <dig>  the contigs present in the path with the highest weight  are selected, using the floyd-warshall algorithm, and assembled to generate the final nas read. step <dig>  the consistency of the synthetic nas read is checked by aligning the initial illumina reads set and detecting gap of coverage.



we chose a micro-assembly strategy, instead of a classical polishing of the consensus, which would have been more error prone to precisely place illumina reads on the minion® template because of the high error rate. one major drawback of the micro-assembly approach is the generation of potential chimeric reads. to overcome this limitation, we developed, as previously described, a specific approach based on a graph traversal, and we added a validation step at the end of the process.

the whole nas workflow is easy to parallelize, as the processing is the same for each input minion® template. we used the shell tool, gnu parallel  <cit> , for executing jobs. the elapsed time was between 30 min and 3 h for each dataset. for instance, the nas reads from the 2d reads of the minion® run <dig> were produced on a 16-core computer in 34 min. the average cpu time is less than 1 min per nas read on a single core computer.

impact of illumina coverage and read length on nas reads
by sampling randomly the initial illumina dataset , we generated subsets from  <dig> × to  <dig> × genome coverage. furthermore, we trimmed reads to obtain subsets with the corresponding read length: 100 bp, 150 bp, 200 bp, 250 bp and 300 bp. interestingly, we found that nas reads were of high quality, even with a coverage as low as  <dig> × . additional coverage may be used to generate longer nas reads, but the method reached a plateau rapidly. for instance, the average size increase of only 4% between  <dig> × and  <dig> × when considering 200 bp illumina reads. likewise, the error rate was not sensitive to the coverage, and remained above  <dig> %. strikingly, the optimal read length was 200 bp and not the longer one. it could be a consequence of the initial size of the library  and the lower accuracy of bases located at the end of illumina reads. indeed, the 250 bp and 300 bp sequencing generate more overlapping direct and reverse reads. these results demonstrated that our method could be used using illumina miseq reads  as well as illumina hiseq  <dig>  reads in the case of larger genomes, to drop off the cost.

acinetobacter baylyi adp <dig> dataset
to validate our approach, we used our five minion® runs from the bacterium acinetobacter baylyi adp <dig>  nas was launched using several subsets of illumina reads and those corrected using  <dig> × of coverage with 250 bp reads were kept . we applied the nas approach using the previously described  <dig>  minion® reads and it generated  <dig>  nas reads . only 17% of the initial minion® templates lead to a nas reads, this low success rate is directly correlated with the error rate, indeed this is in agreement with the number of reads we were able to map onto the reference genome . moreover, we observed a higher success rate with 2d reads  compared with 1d reads . in contrast with correction-based methods,  <dig> % of nas reads are longer than their corresponding 2d minion® templates owing to recruitment of reads outside the border of the template. in this case, the  <dig>  nas reads are on average  <dig>  bp longer than their corresponding 2d minion® template . this elongation size relies first on the recruit-step of the nas workflow, which retrieves similar reads outside the minion® template, and second on the fragment size of the illumina library. we observed a higher number of longer nas reads when generated from the 2d reads compared with when nas reads were generated from the 1d reads . this can be explained by the lower error rate in the 2d reads  that makes seed-read capturing easier.figure  <dig> comparison of minion® and nas 2d read length. the x axis represents the 2d minion® read lengths from run <dig>  and the y axis the length of resulting nas reads. the red line represents x = y, and the green line shows the linear regression.



to inspect the quality of the nas reads, they were aligned to the reference genome using bwa mem aligner  <cit> . the  <dig>  nas reads cover  <dig> % of the reference genome and align with an average identity of  <dig> %. ninety-seven percent of the reads align completely with the reference with no error and  <dig> % align when allowing one error. furthermore, the four nas reads longer than 50 kb aligned perfectly with no error on the reference genome. two different regions of the reference genome are not covered, implying two gaps of the following size: 1076 bp and 408 bp. we observed that these two genomic regions contain repeated elements. when comparing the coverage distribution of nas and minion® reads, we observed that most of the genome is covered accordingly by the two dataset . however, we observed in few cases, a lower coverage in nas reads. these regions of low coverage mostly contain repeated elements. generally, if the input minion® read do not span entirely the repeated element, nas workflow is not able to generate a read of the same length than the minion® template. as a consequence, the coverage of large repetitive regions  is lower  than non-repetitive genomic regions .

the genome of a. baylyi harbors seven scattered rdna clusters, four of which are identical . fourty-three nas reads spanned completely the seven rdna clusters and include neighbour sequences that can anchor a read to its true location. each rdna cluster is spanned completely by the following number of nas reads:  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> respectively. for instance, rdna cluster  <dig> is spanned by a nas read of  <dig>  bp  that aligned entirely and with an identity percent of  <dig> %, presenting only two mismatches .

genome assembly
to demonstrate the utility of the nas workflow, we attempted a nas reads assembly using the celera assembler  <cit>  and the set of  <dig>  nas reads previously described, representing a  <dig> × genome coverage. our assembly was initially composed of  <dig> contigs, compatible with the two regions devoid of nas reads. we then used the input minion® reads with the sspace-longread  <cit>  scaffolder to produce the final assembly, which is composed of a single scaffold. the  <dig>  mb sequence covered  <dig> % of the reference genome with an identity greater than  <dig> %. to evaluate the advantage of using the nas reads for assembly, we performed a control assembly based on the subset of  <dig> × illumina 250 bp pe reads using the celera assembler. although this assembly harbors a high continuity  and a good completion , no contigs were found that spanned a rdna cluster . the fact that nas reads are able to go through complex and repetitive regions explains why assemblies based on nas reads lead to higher quality in terms of solving repeat regions.figure  <dig> comparison of illumina and nas reads assemblies. the figure shows a capture of a 700 kb genomic region from acinetobacter baylyi adp <dig>  the first track contains rdna clusters  <dig>   <dig> and  <dig> . the orange rectangles represent alignments of contigs from the illumina-only assembly, whereas blue rectangle represents the alignment of the nas assembly contig. the three plots represent respectively the coverage of illumina, nas 2d and minion® 2d reads. we observed that breakpoints of the illumina assembly coincide in part with rdna clusters, in contrast with the nas assembly which exhibits a perfect alignment.



we performed two other assemblies by lowering the input coverage, and used respectively  <dig>  × and  <dig>  × of minion® reads . the final assemblies, respectively composed of  <dig> and  <dig> scaffolds, were still less fragmented than the illumina-only assembly . this last result showed that even with a low coverage of minion® reads, the result obtained is still valuable.table  <dig> 
comparative statistics of assemblies generated from subsets of nas or illumina reads


assembly 1
assembly 2
assembly 3
illumina_only assembly


this sequencing strategy is easy to set up and manage, even in a time-constrained framework. the pe illumina and minion® libraries were prepared in  <dig> and 3 h respectively, the sequencing was spread over 2 days  and the computational step  is no longer than 24 h on a standard 16-cores computer .

CONCLUSIONS
the approach we present here is an efficient method to sequence genome by combining advantage of illumina and the new oxford nanopore technologies. these sequencing technologies are commercialized through two desktop instruments, the minion® device and the miseq sequencer respectively, that have the advantage to be small and relatively low cost. our method, based ideally on at least  <dig> × and  <dig> × of nas and illumina reads respectively, offers the opportunity to sequence microbial or small eukaryotic genomes in a very short time, even in small facilities, to high accuracy with informatics finishing steps. this hybrid approach presents an interesting alternative compared with standard strategies, such as smrt of pacific biosciences and illumina truseq synthetic long reads. for example, our approach is straightforward in terms of library preparation, as well as laboratory and information technology infrastructure requirements. the real novelty is to give access to these accurate genome assemblies through desktop and portable sequencers. the limitation of our method is currently the throughput of the minion® device, however if a higher throughput of the oxford nanopore technology becomes available, it may be speculated that nas would provide an efficient method for sequencing organisms with large and repetitive genomes. finally, this study shows that although the oxford nanopore technology is a relatively new sequencing technology, currently with a high error rate, it is already useful in the generation of high-quality genome assemblies with an adapted strategy.

