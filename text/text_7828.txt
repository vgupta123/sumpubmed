BACKGROUND
arising interests in metabolic engineering have focused on systems analyses of cell metabolisms  <cit> . metabolic flux analysis is a key approach in systems biology that determines the in vivo enzyme activities in a metabolic network and links genotype to phenotypes. in the past decade, over  <dig> genome-scale metabolic models have been constructed for e.coli <cit> , bacillus subtilis <cit> , and saccharomyces cerevisiae <cit>  to expand our understanding of their physiologies. although metabolic model reconstructions are important, their development is still much slower than that of high throughput genome sequencing of diverse microorganisms  <cit>  due to three reasons. first, constructing metabolic models is normally a slow, tedious and labor-intensive process, including over  <dig> steps from assembling genome annotations of target organisms to validating the metabolic model by various “omics” studies  <cit> . second, a systemic reconstruction of metabolic models often relies on commercial software  and requires proficient programming skills. though the majority of microbiologists know the physiology of environmental microorganisms well, they may not have practical experience with computer modeling. third, for studying numerous poorly understood environmental organisms, it is necessary to build a programming-free and user-friendly computer platform that facilitates researchers to convert a vast amount of experimental data into model constraints to reduce solution space and to improve the model predictability.

currently, a few software tools are available to assist biologists in metabolic modeling. simpheny  is a commercial software tool for genome-scale flux balance analysis . webcoli supplies diverse approaches for users to reconstruct a genome-scale e.coli metabolic model  <cit> . openflux is a computationally efficient software tool for 13 c-assisted metabolic flux analysis  <cit> . optflux is an open-source, modular software package for fba and microbial strain design using an evolutionary optimization algorithm  <cit> . biomet toolbox provides web-based resources for fba and transcriptome analysis  <cit> . model seed  <cit>  can automatically generate genome-scale metabolic models for different microbes based on the rast  annotations. fame  <cit>  is a web-based modeling tool for creating, editing and analyzing metabolic models for microorganisms from the kegg database. to augment these tools, we are developing microbesflux, a web platform to draft and reconstruct metabolic models . this system has several distinguishing features: 1) it can automatically generate metabolic models of ~ <dig>  microbes sequenced in the kegg database , 2) it allows users to fine tune the metabolic models according to user-defined requests, and 3) it can help researchers perform both flux balance analysis  with user-defined objective functions and dynamic flux balance analysis . the marriage of flux model generation and customized model reconstruction is of great benefit to biologists since they can easily validate or refute hypotheses in microbial metabolism by drafting and comparing numerous metabolic models. in the future, this prototype platform will potentially be able to interact with other software packages  to perform broad-scope metabolic modeling of complex biological systems. 

1: the embedded functions, as developed in microbesflux, fame and webcoli, are the functional modules that are directly incorporated into the web-based software to provide human-computer interaction and to minimize users’ programming work. model seed can achieve the model reconstruction via manual programming on a sbml-formatted metabolic model, instead of using the embedded functions  <cit> .

2: the biomass composition needs to be manually inputted in microbesflux and fame. model seed can automatically generate one template biomass composition for different organisms. webcoli has fixed the biomass composition of e.coli in the system.

3: the transport reactions  can be coupled to atp and proton translocation manually in microbesflux, fame, and webcoli.

4: none of the software included in table <dig> predicts the reaction directionality/reversibility based on thermodynamics.

5: gap-fill is achieved manually in microbesflux and fame. model seed uses a computational algorithm to achieve semi-automatic gap-fill.

implementation
microbesflux is an open-source platform that is free to academic users with mandatory registration. it has three high-level components: the logic level, the application level, and the achievement level. the logic level includes kgml and kegg ligand, two fundamental databases used in microbesflux. kgml is for organism-specific metabolic networks and kegg ligand is for general enzymatic reactions and metabolites. the basic principles for metabolic model reconstruction and constraint-based flux analysis are summarized in the logic level . in the application level, organism-specific metabolic networks are downloaded from the kegg database to generate metabolic models, which are then used for customized reconstruction. the reconstructed metabolic network can be formulated as either an fba or a dynamic fba model to determine the flux distributions under metabolic steady or dynamic states, respectively. the constraint-based flux analysis will be accomplished in the achievement level, by using state-of-the-art optimization solvers, such as ipopt . the calculated flux distributions and the reconstructed metabolic network are recorded in the sbml format  and the metabolic networks can be viewed in a web browser using scalable vector graphics  format. both results are sent to users via email in the output module. the front end of microbesflux is written with google web toolkit technology and the backend is written in python with the django web framework. in summary, three key features to facilitate flux model development are embedded in microbesflux: 1) high-throughput metabolic models generation; 2) customized metabolic models drafting; and 3) constraint-based flux analysis in steady and dynamic metabolic states.

high-throughput generation of metabolic model
microbesflux can serve as a platform to build metabolic models for  <dig>  organisms sequenced in the kegg database. to generate a metabolic model for a specific microorganism, the gene annotation information is downloaded from a set of corresponding kgml files, and cross-referenced with the kegg ligand database. the generated pathway network serves as a seed model subject to further customization by the users.

customized drafting of metabolic models
the model draft of the designated microorganisms, automatically generated from the kegg database, should be reconstructed to fill in the gaps between the genome annotation and the functional metabolism. microbesflux can provide a list of tools to help users build customized metabolic models. they include: 1) the introduction of inflow/outflow fluxes to describe the nutrient transport between the cytosol and the extracellular medium; 2) the implementation of biomass production reactions with the manual identification of the organism-specific biomass composition; 3) the inclusion of heterologous pathways or gap-fill pathways that do not exist in the seed model; and 4) the modification of metabolic pathways by tuning reaction directions and reactants/products species in the reactions. the functions in microbesflux can help users build a drafted metabolic model for further reconstruction and flux analysis. the metabolic pathway network can be exported as sbml and viewed with svg.

it is necessary to point out that the complete genome-scale metabolic model reconstructions cannot be automatically achieved in microbesflux  yet. according to the protocol made by thiele and palsson  <cit> , a high-quality genome-scale metabolic reconstruction requires  <dig> stages and  <dig> steps. by using microbesflux, users can finish 100% of stage  <dig> , 69% of stage  <dig> , 100% of stage  <dig>  and 33% of stage  <dig> . more specifically, several iterative model curation steps in stage  <dig> and  <dig> cannot be achieved in the current version of microbesflux yet. for example, the compound charging  and charge balance in metabolic reactions such as electron transport chains  cannot be automatically curated due to the lack of information in the kegg ligand database and kgml files used for building the metabolic models in microbesflux. in addition, the automated computational gap-analyses  and gap-fill algorithms  are not incorporated in microbesflux, although, for a medium-scale metabolic model, users can manually identify gaps  and adjust the metabolic reactions to fill these gaps. other features that are essential for completing a high-quality genome-scale metabolic model but are not covered by microbesflux include predicting reaction directions based on thermodynamics , assigning the location of genes and metabolic reactions , and correlating genes, proteins and metabolic reactions . in order to construct an accurate genome-scale metabolic model, these steps need to be done by users off-line to expand the microbesflux-drafted model. given this, the microbesflux software should be used as a toolkit for “drafting” instead of “finalizing” metabolic models.

constraint-based flux analysis in steady and dynamic metabolic states
for each reconstructed metabolic network, users can choose to perform either fba or dfba tasks to determine flux distributions under metabolic steady or dynamic states. the objective functions used in constraint-based flux analysis can either be the commonly used “maximizing biomass”, or a user-defined objective function. the users can also define the upper and lower bounds for each flux in fba and dfba. microbesflux converts the constraint-based flux analysis model on the reconstructed network to a large-scale optimization problem with constraints, and employs ipopt  to find an optimal solution  <cit> . the solutions acquired by ipopt are then transformed into the metabolic fluxes as requested by users. microbesflux automatically distributes these large-scale optimization tasks to a cluster of machines so that multiple users can conduct flux analyses on our system simultaneously. our system also supports the dynamic simulation of metabolic fluxes by using the static optimization approach   <cit> . in this approach, the users can assume that the entire dynamic microbial metabolism is composed of numerous pseudo-steady states. for each pseudo-steady state, a conventional fba problem is formulated with the user-defined inflow and outflow fluxes. in other words, a dfba problem will be converted to multiple mini-fbas that are subject to constraints from the measurement of time-dependent inflow  and outflow fluxes . to avoid extensive analytical efforts to measure inflow and outflow fluxes at each time interval, the users can use an empirical or a kinetic model to estimate the time-dependent inflow/outflow fluxes for the mini-fbas through an entire growth period based on limited measurement data. the dynamic flux simulation is of particular industrial interest  <cit> , since many biological systems cannot maintain a meaningful metabolic steady state during the fermentation process.

RESULTS
we have applied microbesflux to a few case studies in drafting metabolic models. we first drafted a toy model , which has  <dig> metabolites and  <dig> fluxes, as a demonstration of the microbesflux workflow. we then constructed a medium-scale stoichiometric model with  <dig> metabolites and  <dig> reactions for thermoanaerobacter sp. strain x <dig>  a thermophilic bacterium that is of great interest in cellulosic ethanol production  <cit> . the functionality and applicability of microbesflux have been proved in both case studies.

case study 1: a toy model
to demonstrate the use of the microbesflux platform, a simple toy model was constructed, which only included the central metabolic pathways: the glycolysis pathway, the pentose phosphate pathway, the tca cycle, and the anaplerotic pathway. glucose represented the carbon substrate and acetate represented the extracellular metabolite product. the toy model was loaded from microbesflux , which included  <dig> reactions that described the intracellular fluxes and lumped biomass production. subsequently, the toy model was reconstructed by introducing the inflow flux: “glucose → g6p” and the outflow flux: “accoa → acetate”. the drafted toy model was then used for constraint-based flux analysis by setting the objective function as “maximizing biomass” and fixing the inflow and outflow fluxes as  <dig>  and  <dig>  mmol/g dcw/h respectively. the reconstructed pathways and the simulated flux distributions from the toy model can be found in additional file  <dig> and additional file  <dig>  the simulated results from microbesflux were confirmed by an independent linear optimization of the same toy model via “linprog” in matlab .

case study 2: a medium-scale metabolic model for thermoanaerobacter sp. strain x514
based on a similar flowchart to that of case study  <dig>  we drafted a medium-scale metabolic model of thermoanaerobacter sp. strain x <dig>  thermoanaerobacter species are thermophilic bacteria that can simultaneously convert both pentose and hexose to ethanol with high yield  <cit> . it can also be co-cultured with cellulosic clostridium thermocellum species to produce ethanol from cellulose. thermoanaerobacter sp. strain x <dig> was not sequenced until recently. the metabolic pathways of the central metabolism have been studied via a 13 c-based metabolic pathway analysis  <cit> . however, there is limited experimental data on the secondary metabolism, including the peripheral pathways of thermoanaerobacter sp. strain x <dig>  therefore, this study chose to reconstruct a medium-scale model that included only the central metabolic pathways to demonstrate the applicability of microbesflux-based fba for understanding strain x514’s ethanol metabolism.

using the experimental data of strain x <dig> reported in  <cit>  and  <cit> , we applied microbesflux and reconstructed a metabolic model that described the carbohydrate metabolism and amino acids biosynthesis in strain x <dig>  the drafted model consisted of  <dig> metabolites and  <dig> reactions, of which  <dig> reactions were intracellular reactions,  <dig> reactions were inflow/outflow reactions,  <dig> reactions were gap-filling reactions, and  <dig> reactions were used for biomass building block syntheses and biomass production. the intracellular reactions in the drafted model were derived from the genome-annotation of thermoanaerobacter sp. strain x <dig> from the kegg database, considering only the carbon and cofactor balance. the inflow/outflow reactions were introduced into the metabolic model only if the transporters of the specific substrates or extracellular products had been reported by published research. moreover, two algorithms were employed to fill the gaps in the metabolic pathways. first, we implemented un-annotated pathways identified from the 13 c-assisted pathway analysis  into the metabolic model of strain x <dig>  <cit> . since the draft model was a simplified model focusing on carbohydrate metabolism and amino acids biosynthesis, the gaps might have been generated due to the lack of consideration of the metabolites exchange between the pathways that were included in the model  and other pathways that were not included in the model . accordingly, we employed the principle of introducing the metabolite-exchange-reactions to fill the gaps. for example, utp is involved in both carbohydrate metabolism and rna synthesis. since we did not include the rna synthesis pathway in the microbesflux model, we instead introduced a utp exchange pathway to fill the gap. the gap-filling reactions were evaluated carefully to make sure that each one of them was necessary for feasible predictions of biomass production.

the biomass composition of thermoanaerobacter sp. strain x <dig> is not yet available. in the drafted model, we used the reported biomass composition of a related species, clostridium acetobutylicum <cit> . besides the biomass composition, the growth-associated maintenance  and non-growth associated maintenance  energies were found to play an important role in simulating the growth rate of organisms  <cit> . in our model simulation, the ngam was chosen as  <dig>  mmol atp/g dcw/h, as reported previously  <cit> . to identify the gam, we plotted the relationship between growth rate and gam , and found the value of gam that could match the experimental measurement  to be  <dig>  mmol atp/g dcw. this fitted value is higher than the previously reported gam value  in a thermopilic cellulose degrader   <cit> . such a high value of gam in strain x <dig> could be associated with the much higher ethanol productivity in x <dig> than c. thermocellum during cell growth  <cit> . this result is consistent with the positive correlation of ethanol yield and maintenance-energy in other microbial species  <cit> . the strain  <dig> model and the simulated flux distributions can be found in additional file  <dig> and additional file  <dig>  based on this model, we also predicted the correlations between growth rate, ethanol production, and waste product outflow . the prediction shows a trade-off relationship between ethanol production and growth rate. the ethanol production can be increased by 25%  while halving the growth rate . by inhibiting the acetate production from  <dig>  mmol/g dcw/h to  <dig>  mmol/g dcw/h, the ethanol production under the optimal growth conditions could be improved by 33%. therefore, we have shown the platform is able to make reasonable predictions for the biomass growth in response to metabolites synthesis.

CONCLUSIONS
microbesflux is designed for semi-automatic and high-throughput drafting of metabolic models for environmental microorganisms based on genome annotations in kegg. unlike the model organisms that have been systemically studied via different “omics” approaches, the environmental organisms have more complex metabolic features and fewer measurements from laboratories. therefore, microbesflux is a platform to construct models for predicting cell metabolisms. this main goal of this software is to offer an interface to make flux modeling as simple and efficient as possible for users. on the other hand, the validation of a genome-scale metabolic model can be a challenge due to the requirement of manually tuned pathways and due to a lack of experimental data to confirm functional pathways. for example, thermoanaerobacter sp. strain x <dig>  is capable of growing under high temperatures and converting sugars to ethanol, which can be simulated by a medium-scale metabolic model. such a convenient fba model has decent predictive power for in silico studies of a non-model environmental microorganism for bioethanol production at different growth rates . however, many other metabolic features  in the strain x <dig> are not fully understood yet. it requires extensive experimental studies, including transcriptomics and proteomics analyses, for a precise reconstruction of the genome-scale model. although the x <dig> model in this study only focused on the central carbon metabolic pathways , it serves as a good demonstration for users to learn how to use the microbesflux platform to fill annotation gaps and reconstruct metabolic models for real applications.

in summary, we have developed microbesflux to draft the metabolic models of environmental organisms from the kegg database and to serve as a high-throughput tool for systems biology. the user manual is also provided along with this software . microbesflux relieves microbiologists from having to write computer programs for metabolic modeling. it covers a large number of sequenced organisms in the kegg database and provides multiple approaches to assist systems biologists in model generation and reconstruction. both fba and dfba  can be done in microbesflux to simulate the metabolic behaviors of organisms in metabolic steady state and dynamic state. the drafted model can also be used by other software packages for genome-scale model reconstruction and in silico predictions. in the future, we will implement broad fluxomic approaches  in microbesflux to improve the accuracy and predictive power of the drafted metabolic models.

availability and requirements
· project name: microbesflux

· project homepage:http://tanglab.engineering.wustl.edu/static/microbesflux.html

· operating systems: platform independent

· programming language: java and python

· license: microbesflux is freely available for noncommercial purposes.

· any restrictions to use by non-academics: none

misc
xueyang feng and you xu are the authors contributed equally to this work.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
xf and yjt initiated this study. yx, xf and yc developed the microbesflux software. xf and yx performed the flux analysis. xf and yjt wrote the manuscript. all authors revised and approved the final manuscript.

supplementary material
additional file  <dig> 
sbml of toy model used in microbesflux.

click here for file

 additional file  <dig> 
simulated results of toy model used in microbesflux.

click here for file

 additional file  <dig> 
matlab code for fba of toy model.

click here for file

 additional file  <dig> 
sbml of drafted model of thermoanaerobacter sp. strain x <dig> 

click here for file

 additional file  <dig> 
simulated results of drafted model of thermoanaerobacter sp. strain x <dig> 

click here for file

 additional file  <dig> 
user manual of microbesflux.

click here for file

 acknowledgements
the project was funded by an nsf career grant  and by a doe bioenergy research grant . we thank jizhong zhou’s lab for providing us with experimental information on thermoanaerobacter sp. x <dig>  we also thank james ballard and amelia chen at washington university in st. louis for editing this manuscript.
