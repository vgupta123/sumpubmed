BACKGROUND
marker design from genome variants
economical third generation sequencing technologies now permit the deep sampling of variation from poorly characterized species, providing a wealth of data to enable genetic studies  <cit> . in practice, a dearth of accessible, scalable and biologist-friendly bioinformatics tools for exploiting these large-scale data restricts application of these sequencing technologies in minor species and institutions lacking bioinformatics infrastructure  <cit> .

the typical goal in sampling sequence variation is to detect variants for diagnostic and/or functional studies, most commonly single-nucleotide polymorphisms  and insertion-deletion polymorphisms . although a myriad of technologies have been developed for interrogation of snps, the most widely accessible technologies are those based on pcr. among the most simple and robust means to interrogate snp variation is that of cleaved amplified polymorphic sequences , where sequence variants are revealed by post-pcr cleavage of amplicons with restriction enzymes  <cit> . addition of engineered mismatches in primer sequences can allow detection of snps that do not condition restriction polymorphisms  <cit> . high-resolution melting  of small amplicons in the presence of intercalating dyes is increasingly used as a means to reveal sequence variation  <cit> , and has the advantage of being a closed-tube assay. although both approaches could be used to validate and evaluate polymorphism at variant sites identified by deep sequencing, the principal barrier to achieving this on a useful scale is design of flanking pcr primer pairs for large numbers of targets.

web-based tools which have been reported for design of caps markers from small numbers of sequences include blastdigester  <cit> , snp2caps  <cit>  and snp cutter  <cit> . none of these tools readily scale to large volumes of ngs data. bulk design of primer sets to snps or other genome targets can be performed using the primer <dig> executable  <cit> . although the use of this command-line tool can be simplified by use of programming interfaces such as those provided by bioperl  <cit>  or biopython  <cit> , such scripting is usually performed by specialists and is generally reported in the scientific literature as ‘custom scripts’ without code or detail sufficient to permit reproducibility by non-specialists. web-based tools suitable for larger-scale primer design include snp-rflping  <cit>  for mammalian snp assay design and primegens-w <dig>  <cit>  which provides a variety of options for assay and probe design, especially for well-characterized genomes. neither of these tools provides source code and the web-based tools they provide are constrained to specific uses in well-characterized genomes. the principal challenge faced by developers of such traditional web applications has been to support the diversity of input data and possible applications by biologists.

web-based bioinformatics workflow frameworks, such as genepattern  <cit>  and galaxy  <cit> , now provide a means to share biologist-friendly tools and complex workflows for bioinformatics tasks such as pcr-based primer design. importantly, they encourage a modular approach to code and tool development, providing greater flexibility to accommodate diverse inputs and goals. these features support reproducibility of bioinformatics methods by specialist tool developers and non-specialist end-user scientists. we previously reported the potential for enabling pcr-based primer design in web-based bioinformatics frameworks when we adapted misa scripts  <cit>  for simple sequence repeat  marker design to galaxy  <cit> .

onion genome resources
although onion and shallot  are among the most widely cultivated and traded vegetable crops, knowledge of their genomes, population structure and genetic architecture of key traits is limited  <cit> . there is strong need for applied genomic resources to enable quality control of hybrid seed, inform genetic resource mining and to accelerate genetic analysis and improvement of consumer and sustainability traits. laboratories engaged in onion research and breeding typically have limited technical and financial resources, as is common in those researching second-tier crops and non-model species. therefore it is desirable that marker assays can be implemented in laboratories with basic equipment.

the genomes of onion and related allium crops such as garlic  and bunching onion , are very large  and even transcriptome sequencing has been limited to modest est projects  <cit> . a partial  onion bac library  <cit>  provided insights into gene structure and genome composition, most notably the very low gene density of one gene per  <dig> kb  <cit> . the initial genetic linkage map ‘byg15- <dig> x ac43’ developed by havey and colleagues using rflp markers remains as the key reference map  <cit> . notably, this map revealed a very high level of dominant rflp, suggesting that the large genome size of onion is associated with high levels of gene duplication. genetic stocks used to date for development of onion mapping populations have generally been inbred lines that have typically been only subjected to one generation of self-pollination. the high levels of residual heterozygosity have previously greatly complicated marker development and sequence analysis in onion. although a number of researchers have produced doubled haploid onion  lines, these have in general suffered from poor seed set  <cit> . the development of highly fecund dh lines from long-day us onion varieties by alan et al.  <cit>  now provides an opportunity to use homozygous, distributable reference lines for onion genetics and genomics.

in the present study we sought to develop pcr-based genetic markers that were easily transferable among the allium research community, based on transcriptome sequence polymorphisms segregating in a wide bulb onion cross. inspection of the data revealed potential for large-scale development of robust, low-technology pcr-based markers, which was enabled by a set of simple bioinformatics tools usable in the galaxy workflow environment. we used these markers to develop a framework map spanning much of the genome. we further tested the utility of these by conducting targeted design and bin mapping of transcription factor candidates  <cit> . the genomics resources developed in this study provide a framework for genetic analysis and genome sequencing in onion. the bioinformatics tools are applicable for any biologist requiring large-scale pcr-based variant validation and assay design from modern sequencing platforms.

RESULTS
cdna sequencing and variant discovery
we set out to discover snps which could be used to develop genetic markers revealing allelic variation between the genetically distant onion parent lines used to develop a large f <dig> mapping population. to maximise the amount of novel sequence obtained using gs-flx sequencing, we normalized the cdna samples to reduce the most abundant transcripts. blastx analysis of pilot 1/ <dig> plate gs-flx sequencing runs of normalised shoot cdna samples from ‘cudh2150’  and ‘nasik red’  revealed that high-abundance transcripts  comprised  <dig> % and  <dig> % of reads respectively, indicating acceptable normalisation. a full plate of gs-titanium sequence was generated from the homozygous line ‘cudh2150’  to provide a working reference assembly and a plate of gs-flx sequence was obtained for ‘nasik red’  for variant discovery. we chose  <dig> sequencing chemistry for greater read length, since the genome of onion has not been sequenced and there is only limited transcriptome data  <cit> . this reference assembly of ‘cudh150’ contains  <dig> contigs with n <dig> contig size of  <dig> bp representing 85% of the total reads. mapping ‘nasik red’ reads onto these contigs revealed  <dig> and  <dig> indels between the parental lines, representing one variant per  <dig> bp. due to the high degree of duplication in onion, estimates of snp frequency based on this assembly should be interpreted conservatively.

bioinformatics and marker design
preliminary inspection of variant data revealed numerous snps conditioning restriction polymorphisms suitable for caps marker design. however, a literature survey failed to reveal any published code or tools that could be readily used to facilitate identification of these and to design flanking pcr primer sets on large data sets. therefore, prototype scripts were developed using biopython  <cit>  to identify snps conditioning restriction polymorphisms for enzymes known to perform well in pcr buffers, based on our prior experience developing caps markers in onion  <cit> . mining of the variant data revealed a total of  <dig> polymorphic restriction sites, the most abundant being those revealed by taqi , alui , rsai , dpnii , hinfi  and haeiii . using the biopython interfaces to emboss and primer <dig>  custom scripts were used to design flanking primer pairs to variant features with masking of non-target variant sites.

based on experience gained in developing tools for ssr marker design  <cit> , we modified the prototype scripts to enable more general usage in the galaxy workflow environment  <cit> . the detection of caps polymorphisms and design of primers was separated into two tools, which were modified to use galaxy interval format and gff3/gvf formats  <cit>  as the input and output formats. helper scripts were developed to enable conversion of vcf  <cit>  and roche gsmapper 454hcdiffs.txt variant formats to gff <dig> formats. caps detection and primer design tools were modified to use iterators to provide efficient memory usage with genome-scale data. additional tools were developed to parse emboss primersearch output for conducting electronic pcr and patman  <cit>  for mapping primers back to sequences. the tools are available for installation to any galaxy installation at galaxy toolshed  as repository ‘pcr_markers’ . the scripts may also be obtained from github  for direct use from the command-line.

workflows for using these tools to design caps markers from illumina  or roche  <dig> data  are provided in the galaxy toolshed repository and are described in on-line documentation at github . polymorphism information from illumina  or roche  <dig>  read mappers is converted to gff <dig> format using vcf2gff or gsmapper2gff tools. the resulting gff <dig> and reference fasta file are provided as input to the caps detection tool. the list of desired features can then be filtered out and cut from this tabular output file using standard galaxy tools and provided to the primer design tool. this provides tabular output containing primer pairs. these or existing primer pairs may be tested for redundancy and specificity by electronic pcr against reference sequences using emboss primersearch or individual primers mapped onto sequences using patman.

construction of a genetic linkage map
a total of  <dig> primer sets were designed to target putative restriction polymorphism, indel or snp variants. of these, 91% of the sets amplified products under standard conditions with no optimisation . hrm markers exhibited the most polymorphism during screening but were frequently unsuitable for mapping in the f <dig> population because of difficulty in reliably resolving homozygotes. by contrast, the caps and indel markers were robust and reproducible. these markers are the most transferrable as they only require standard pcr and gel analysis equipment available in all genetics laboratories. overall, 58% of the markers designed from est sequence which amplified in genomic dna were polymorphic between the parent lines. this snp conversion rate is higher than the 25% found in onion previously  <cit>  and similar to the 51% found for pine  <cit> . koepke et al.  <cit>  reported a validation rate of  <dig> % from hrm primers designed using 3′ utr sequencing data.

despite the lower success rate of hrm markers, these are an appealing marker class for design and screening in bulk using these approaches. importantly, for studies of the large and duplicated onion genome, the use of a homozygous dh during screening permits ready confirmation that the amplicon derives from a single locus and heterozygosity is easily discerned in f <dig> or population samples. implementing melt prediction methods such meltsim  <cit>  and unlabeled probe design are two obvious strategies that could be used to improve outcomes for bulk hrm marker design in galaxy.

of the  <dig> markers tested,  <dig> were assigned to  <dig> of  <dig> linkage groups assigned to the  <dig> chromosomes of a. cepa anchored using previously published markers . the overall map length was  <dig> cm. the map and underlying data can also be accessed at alliumgenetics.org  <cit> . the markers appeared to show both some overlap at particular positions, which may indicate redundancy or gene clusters but were also spread across the genome with an average spacing between markers of  <dig>  cm. the major genetic loci conditioning red bulb colour  and fructan content  were located on this map by qtl analysis on chromosomes  <dig> and  <dig> respectively, as expected  <cit> . this resource is useful across onion germplasm since the anchor markers used here have been tested in other mapping populations, allowing the linkage maps to be aligned for comparative mapping using the cmap tool  <cit>  provided at http://alliumgenetics.org <cit> . the map was then used as a reference to select a subset of genotypes for bin mapping  <cit>  to facilitate rapid marker screening and targeted map development. a set of  <dig> genotypes was identified for selective genotyping  using mappop  <cit> , providing an approximate bin length resolution of  <dig>  cm.

design and bin mapping of transcription factor markers
using a galaxy workflow, snps were identified by mapping ‘nasik red’ reads to ‘cudh2150’ contigs that showed significant matches to transcription factor motifs. transcription factors have been implicated in regulating genes in pathways controlling many key economic traits in crops including stress response, flowering and colour. a total of  <dig> primer sets  were designed to flank these polymorphisms. of these,  <dig> amplified products, including  <dig> that amplified multiple loci. of the remaining, 31/ <dig>  exhibited polymorphism between parent lines and could be assigned to the genetic map by selective or complete genotyping in the mapping population . this confirmed the utility of these tools for targeted design of markers to sets of candidate gene variants. the genetic resources developed also allowed the markers to be efficiently mapped to the onion genetic map to within  <dig> cm using just  <dig> lines from the population. the combination of bulk marker design and bin mapping now allows a more targeted approach to onion genetic map improvement through saturating regions of interest or low coverage.

CONCLUSIONS
the tools for pcr-based assay design we present provide a ‘missing link’ to facilitate access to the wealth of sequence variant data from modern sequencing technologies by researchers with limited informatics and laboratory equipment. importantly they are provided with source code and customised for use in a web-based framework to permit community improvement and use by non-specialists. the ability to easily develop custom panels of snp markers for interrogating genes or genome regions of interest will complement modern genetic strategies that identify candidate variants through deep sequencing of population samples.

the success and practical utility of our assay design highlights the benefits of implementing bioinformatics applications in a reproducible research environment. prior studies have either not disclosed code or methods in a reproducible form, or have exposed tools through web interfaces specialised for particular application domains. in contrast to the previous web-based solutions for caps design that enable a multistep pipeline, implementation in galaxy requires tools for individual steps and encourages sharing of these through public repositories. this provides greater flexibility for researchers with diverse technologies and needs.

the practicability of caps markers in onion supports previous reports in arabidopsis <cit> , caenorhabditis <cit>  and human  <cit> . now that such polymorphisms may be readily designed using ngs data these may become an appealing marker class for other non-model organisms.

the strategy employed in this study integrating a dh reference parent line, ngs variant data and bulk marker design is a next-generation strategy for onion genetics that has proven much faster, cheaper and less technically demanding than marker development in previous studies of onion  <cit> . because the sequence resources, galaxy tools and parental lines forming the basis of this work are publically available, they will provide a reproducible framework for future onion genome research. the very large family sizes, high levels of polymorphism and segregation for multiple traits make these families ideally suited for field-based population studies and fine mapping. we are currently using the framework map for genetic analysis of metabolic and developmental traits, and see potential for supporting genome sequencing of onion. reduced representation sequencing of the gene space of a dh line such as ‘cudh2150’ using cot-based methods  <cit>  or methyl filtration  <cit>  is likely to be the first phase of developing an onion genome reference sequence. these new mapping and marker development resources will support the bin mapping and fine mapping strategies required to align contigs with the genetic and physical maps of allium.

