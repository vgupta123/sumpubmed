BACKGROUND
cross-species comparisons have been shown to be effective in locating genes and predicting gene structures. de novo gene finders such as sgp <dig>  <cit> , twinscan  <cit> , nscan  <cit> , slam  <cit> , saga  <cit> , dogfish  <cit> , exoniphy  <cit> , shadower  <cit> , contrast  <cit>  have improved upon ab initio gene finders through comparison with genomic sequences of reference species, capturing phylogenetic footprints, as coding sequences tend to be relatively highly conserved. reference-based gene finders such as dps  <cit> , rosetta  <cit> , procrustes  <cit> , genomescan  <cit> , projector  <cit> , genewise  <cit> , genemapper  <cit>  and exonhunter  <cit>  have sought to predict genes in target species through alignment with genes or proteins from reference species, modeling substitution patterns, gaps, exon/intron length distribution, signals, and other potentially conserved features. augustus+  <cit>  extends augustus  <cit>  by incorporating alignments with genes and proteins of reference species into its ab initio gene model. fgenesh++  <cit>  also extends an existing ab initio prediction model with comparative evidence. broadly speaking, all of these gene finders employ the strategy of adding comparative side-information to an existing ab initio model; genome annotation pipelines such as ensembl  <cit>  and ucsc known genes  <cit>  add comparative components to ab initio models and expressed-sequence data sources. jigsaw  <cit>  employs a somewhat different strategy where ab initio and orthologous proteins are treated as sources of evidence and integrated. all of these gene finders effectively incorporate cross-species information, achieving improvement in prediction accuracy over single-species gene finders, although doing so often requires significant effort in model and algorithm design and implementation to cast comparative information into a form compatible with the existing gene models.

we have developed a simple, yet effective, reranking approach for incorporating cross-species information as a post-processing step after initial gene prediction, obviating the need to build a new gene finder or laboriously modifying an existing one to incorporate comparative information. reranking the k best hypotheses has been an effective technique in natural language processing systems  <cit> . for example, in speech recognition, it is a widely adopted practice to generate the k best recognition hypotheses with a fast one-pass recognizer, and then rerank them based on probabilities given by a more powerful language model  <cit> . the gene finder evigan  <cit>  integrates diverse sources of evidence, yielding a ranked list of the top k candidate gene models, which may then be reranked by comparing them with reference genes from closely related species. gene models with good  probabilities defined by evigan that also exhibit strong similarity to reference genes may thus be selected as most likely.

RESULTS
to assess the feasibility and accuracy of reranking candidate gene models based on cross-species comparison, we conducted an experiment seeking to identify gene models in the genome of drosophila melanogaster , using d. pseudoobscura as reference species. d. melanogaster was selected because the extensive effort that has been devoted to gene annotation in this species provides a "gold standard" for assessing performance.

all data used in this experiment were downloaded from flybase  <cit> , including:

• whole genome sequence for d. melanogaster , used as the target genome for gene model predictions.

• ab initio gene model predictions from five gene finders , used as the input data for evigan gene model predictions  <cit> .

• annotated gene models of d. pseudoobscura , used as reference for reranking candidate gene models in d. melanogaster.

• annotated gene models of d. melanogaster, used as training set for estimating reranker parameters, and also as a standard for evaluating prediction accuracy.

evigan is a recently developed gene finder that integrates diverse sources of evidence, including predictions from multiple other gene finders. using a dynamic bayesian network to create consensus predictions based on the patterns of agreement and disagreement between the evidence sources, evigan produces more accurate calls than any of the individual gene finders used as sources  <cit> . as output evigan provides a list of the k gene models with the highest probabilities according to its evidence integration network.

among the five source gene finders used as input for evigan, four  predict genes by examining the d. melanogaster genomic sequence and modeling the nucleotide composition surrounding start, stop, splice donor and splice acceptor sites, codon usage and coding potential, exon length distribution, and other sequence features. the contrast  <cit>  gene finder predicts d. melanogaster genes based on conservation with a reference species genome, motivated by the assumption that coding sequence is more likely to be conserved than non-coding sequence. although contrast uses genomic nucleotide sequence information from another species, none of the source gene finders uses gene models or proteins to improve gene model predictions.

using the source gene finders' prediction sets, evigan identified  <dig>  gene loci in the d. melanogaster genome . for each locus, evigan was then used to generate the k best candidate models , along with the probability for each model  <cit> . figure  <dig> shows the number of candidate models identified per locus, and the number of exons per gene. fewer than  <dig> candidate gene models were identified for 83% of the loci, although some loci contain as many as  <dig> competing models. in general, the number of plausible candidate models at a locus is a function of the number of exons for this gene: for loci exhibiting an average of <  <dig> exons per gene, evigan identified a median number of  <dig> candidate models per locus; a median of  <dig> candidate models were identified for loci having an average of ≥  <dig> exons per gene. the number of candidate models per locus identified by evigan is based on the agreement among available evidence sources . disagreements about exon call multiply out for multi-exon genes, explaining the abundance of candidate models for those genes.

to identify genes where cross-species comparison might permit reranking of alternative gene models, d. melanogaster loci predicted by evigan were filtered to identify those where:  evigan suggested multiple candidate gene models, and  putative orthologs  were identified in d. pseudoobscura. as indicated in table  <dig>  evigan identified  <dig>  genes in the entire d. melanogaster genome . multiple candidate models were identified for  <dig>  genes , and  <dig> genes  were paired with d. pseudoobscura genes as putative orthologs based on reciprocal best blast hits  <cit> ;  <dig> loci exhibited both multiple candidate models and putative orthologs. a small sample  of these genes were randomly selected as a training set for estimating reranking parameters, and the remainder  were used to test the reranking algorithm. note that the five source gene predictors were trained on their specific training sets, but it is not very likely that they significantly overlap with the  <dig> loci randomly selected for estimating reranking parameters; otherwise the reranking parameters estimated from the training set would be biased and result in poor performance.

the performance of evigan-5g  and of reranker-5g , were compared against curated annotation of the d. melanogaster genome . performance metrics include sensitivity and specificity on the gene, transcript and exon level , and the evaluation software eval  <cit>  was used. as indicated in the top section of table  <dig>  reranker-5g always performs better than evigan-5g, in terms of both sensitivity and specificity, at the exon, transcript and gene levels for the genome, improving on the advantage that evigan typically shows over any of the sources of evidence it integrates  <cit> . reranker-5g selected the highest probability evigan-5g model for  <dig> loci ;  <dig> of these , agree with the d. melanogaster genome annotation. of the remaining  <dig> loci where reranker-5g selected a lower probability evigan-5g model, the highest probability evigan-5g model was correct in only  <dig> cases  whereas gene models selected by reranker-5g were correct for  <dig> cases , indicating much better performance of reranker-5g than evigan-5g. results on these  <dig> loci are shown in table  <dig>  the performance of evigan-5g is relatively poor on these loci where genes contain relatively more exons  reflecting the difficulties that genes of more exons pose to ab initio gene finders. reranking candidate evigan models based on sequence homology with d. pseudoobscura, however, significantly increases performance for these genes. when offered a selection of alternative gene models, cross-species comparison frequently allows reranker to select the correct models.

performance on the entire d. melanogaster test set of  <dig> loci . augustus, contrast, geneid, genie and genscan are ab initio predictors used as evidence sources for evigan-5g. reranker-5g selects among k-best gene models produced by evigan-5g with cross-species information. genewise, augustus+ and evigan-6g are other comparative gene predictors or approaches. bold indicates where reranker-5g outperforms evigan-5g; italics indicates where other comparative approaches outperform reranker-5g .

performance on the  <dig> loci where reranker-5g selected a lower probability evigan-5g model based on cross-species comparison. note that reranker-5g improves on evigan-5g acrosss the board; italics indicates where other comparative approaches outperform reranker-5g .

when reranker selects an alternative model, does it always choose the next most probable candidate from the list of possibilities defined by evigan? figure  <dig> presents the frequency and performance of reranker selections, as a function of evigan rank. reranker selected the second to the fifth most probable evigan model in  <dig> genes, the sixth to the tenth most probable model in  <dig> genes; and even lower probability models for  <dig> genes. comparison with the annotated d. melanogaster genome indicates that even when relatively low ranking models were selected by the reranking algorithm, these are more likely to be correct than the top probability evigan model: the red lines  are higher than blue lines  in figure  <dig> for all exon, transcript and gene levels.

incorporating genie's prediction into reranker-5g  could have introduced a circularity, because reranker's performance was evaluated on d. melanogaster annotations, which were developed with the help of genie. however, this does not appear to be the case, since both reranker-5g and evigan-5g significantly outperform genie for sensitivity and specificity on the gene, transcript and exon level, as shown in table  <dig>  in fact, reranker-5g and evigan-5g significantly outperform all of the five ab initio predictors used as evidence sources for evigan-5g .

another factor that migh raise concerns of circularity in our evaluations is reranker's use of d. pseudoobscura as a reference for gene prediction on d. melanogaster, since the former was annotated based on the latter. to address this, performance of reranker-5g and evigan-5g were evaluated on  <dig> d. melanogaster loci whose putative orthologs on d. pseudoobscura have est support. over  <dig>  est sequences for d. pseudoobscura were obtained from dbest  <cit>  and aligned to d. pseudoobscura annotated transcripts that were identified as the putative orthologs of the entire test set , using blast . the transcripts where the aligned length covers more than half of the transcript length were retained as a subset having independent experimental support, resulting in  <dig> transcripts. on the d. melanogaster loci which are these transcripts' putative orthologs, performance of reranker-5g and evigan-5g were evaluated and presented in table  <dig>  reranker-5g outperforms evigan-5g for sensitivity and specificity at the gene, transcript and exon level. the evaluation on the subset with independent experimental evidence suggests that reranker's improved performance is not likely to be attributed to the two species' related annotation process.

performance on the  <dig> d. melanogaster loci whose putative orthologs on d. pseudoobscura are supported by est sequences . note that reranker-5g improves on evigan-5g across the board .

a widely used alternative approach for using cross-species information in gene prediction involves aligning reference gene models  to the target genome, and using these alignments to either build new gene finders, or modify existing ab initio ones by explicitly modeling alignments. genewise  <cit>  aligns protein sequences to target genome sequences and uses the alignments to hypothesize introns, amino acid mutation patterns, sequencing errors, exon length statistics, and other gene prediction signals.

augustus+  <cit>  extends the ab initio gene finder augustus  <cit>  by considering transcript or protein alignments as extrinsic hints, up- or down-weighting ab initio gene parses based on consistency with the alignments. the bottom half of tables  <dig> and table  <dig> compares the performance of reranker-5g with genewise and augustus+ on the complete d. melanogaster test set, and the subset of genes where evigan-5g and reranker-5g chose different models. genewise was employed to align d. pseudoobscura proteins to their putative orthologous loci in d. melanogaster . genewise predictions of cds, donor, acceptor, start and stop information were then provided as extrinsic hints for augustus+ . evigan was also run to integrate genewise models with the five ab initio source gene finders described above, yielding evigan-6g.

augustus+, genewise and some other comparative predictors do not need ortholog detection; rather they align reference genes or proteins to a target genome and then refine signal predictions for significant hits. this strategy tends to identify relatively more target genes and thus enjoy higher sensitivity. for reranker, where putative ortholog detection is needed, if ortholog detection for a gene fails, reranker misses the opportunity to locate the gene and will thus show lower sensitivity. however, reranker's main goal is to improve specificity by improving the prediction of exact structures for genes whose existence and rough locations have been reasonably validated.

on the whole d. melanogaster test set , reranker-5g outperformed genewise and augustus+ in terms of both sensitivity and specificity, at the exon-, transcript-, and gene-level . reranker-5g also outperformed evigan-6g as assessed by all criteria except for overall and internal exon sensitivity. in cases where reranker-5g and evigan-5g make different choices , reranker-5g outperforms genewise and evigan-6g, but performs worse than augustus+ in most categories. the better performance of augustus+  may arise from increased sensitivity by using homology information in its ab initio model used to search for gene segments. the relatively poor performance of reranker-5g would then follow from a relative lack of candidates in the source evidence: reranker-5g is constrained to select from among the potential models suggested by evigan-5g, which performs relatively poorly on this subset. these observations highlight the extent to which evigan and reranker are limited by available sources of evidence, in particular the source gene finders, but it is important to note that the inclusion of additional gene predictions in the mix is likely to improve the performance of evigan and thus reranker.

CONCLUSIONS
we have demonstrated that reranker leads to improvement in prediction accuracy through a simple strategy of incorporating additional evidence. there are many directions along which the work can be extended or improved. the first step of the reranking strategy is to identify single-gene loci on a target species. if this step finds incorrect loci, such as loci that contain more than one gene, partial genes or pseudo genes, it could mislead reranker, which assumes that a locus contains a single gene. in the ortholog identification step, most of those wrong loci will be removed because they tend to not be associated with orthologs from a reference species. but it would be very useful to devise an additional step before reranking, to identify problematic loci and even recover correct locus information. the reranking strategy is sufficiently general, in the sense that it is neither specific to evigan candidate gene models, nor limited to incorporating information from cross-species comparisons. the same conceptual strategy could readily be applied to candidate gene models produced by other annotation pipelines as well as accommodate diverse sources of evidence in place of or in addition to comparative genomics data. for example, one can easily envision further improving gene models selection by reranking based on protein sequence motifs or signals, transcript or protein expression data, etc. in addition it is natural to relate evigan's k-best gene models to alternative transcripts, which might allow us to extend reranker for predicting multiple transcripts on a target species, if the putative ortholog on a reference species exhibits alternative transcripts.

