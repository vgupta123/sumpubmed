BACKGROUND
networks provide a natural representation for the complex interactions of heterogeneous entities in complex systems. many complex networks have been studied in recent years, for example in the fields of biology, sociology, and ecology  <cit> . as high-throughput techniques have advanced, biological networks have become increasingly complex, and it has become more challenging to interpret them accurately and clearly by extracting and representing the knowledge embedded in the networks.

the concept of modularity has a long history in biology; for example, it has been proposed that biological processes within individual cells are modular  <cit> . module-level studies have accelerated the progress of system biology, e.g., modular organizations of cellular networks, module-level analyses in gene networks, and modular network models of aging  <cit> . one common approach to mining complex networks based on modularity is first to identify modules as knowledge building blocks, and then to use their organization to depict the knowledge contained in the networks. however, most module organizations are limited to either a "vertical" or "horizontal" representation. a vertical relationship is represented by a multilevel dendrogram that only describes the inclusion/part-of relationships between modules at different hierarchical levels  <cit> , and the horizontal relationship is a single-level graph that only shows how modules are connected  <cit> . neither of them provides an integrated view of the complex systems they represent; consequently, it is difficult to further explore these complex domains. in this work, we combine vertical and horizontal relationships in order to organize the modules into a multilevel pyramid, as illustrated in figure  <dig>  at each level, we describe the horizontal relationships by a network of modules that is by itself the abstraction of the network at a lower level  <cit> . in contrast, the vertical relationships, shown as links between layers, represent the inclusion relationship between modules at different levels. using an abstraction pyramid, not only can domain experts gain a global multilevel view of a complex system from two different perspectives , but they can also investigate the interconnection of the modules at a particular abstraction level of interest in the hierarchy.

our approach, named pyramabs , identifies the modules and simultaneously constructs the pyramid based on the network topology. prior domain knowledge is not used. we tested pyramabs on artificial random networks, a protein-protein interaction network, and a metabolic network. we compared pyramabs with other methods and verified our results based on those published in the literature and public databases.

RESULTS
the two overarching goals of our work are to  propose an alternative knowledge representation for improved network interpretations, and  introduce a novel approach for extracting knowledge from networks and describing it using the new representation. the abstraction pyramid discovered by pyramabs does not replace the known structure of ontology ), but instead provides other information that may be missing. for example, an abstraction pyramid identified from a protein-protein interaction network could illuminate the protein interactions at various levels. some vertical or horizontal relationships can provide additional biological meaning that may not be characterized in the go's directed acyclic graph  structure.

we divide the analysis of complex networks into two tasks: module discovery and module organization. the novelty of our two-way approach is derived from the synergy of top-down and bottom-up clustering algorithms. this method identifies modules in a top-down fashion and constructs a hierarchy implied in a complex network from the bottom up. in addition, it produces an abstraction of the network to different degrees at different levels in the hierarchy. our method can be divided into three procedures:  computing the proximity between nodes;  extracting the backbone from the network, represented by a spanning tree, and then partitioning the network based on that backbone; and  generating an abstract network. by iteratively applying the same procedures to a newly generated abstract network, we can disclose an abstraction hierarchy implied in a complex network. the pyramabs flowchart provided in figure  <dig> includes the following steps:

step  <dig>  input a given network of nodes to pyramabs.

step  <dig>  calculate the proximity between all pairs of nodes and use as the link weights.

step  <dig>  normalize the proximity by computing the z-scores; then discard the links with a z-score below a specified threshold to reduce the search space of the network.

step  <dig>  obtain the maximum-weight spanning tree from the network and use as the backbone.

step  <dig>  partition the network into modules based on its backbone.

step  <dig>  construct a network of the modules found in step  <dig>  this network forms a hierarchical level of a pyramid.

step  <dig>  if the network produced in step  <dig> contains more than one node , go to step  <dig> to find a higher hierarchical level.

step  <dig>  otherwise, return the pyramid.

we conducted a series of experiments that applied our approach to datasets from various domains, including artificial and real-world data. following sales-pardo et al.  <cit> , we first tested our approach on hierarchically nested random networks with a hierarchical structure. since the theoretical partition is known in these networks, we can use the results to validate our method's ability to identify the inclusion hierarchy implied in the network. furthermore, to evaluate the method's generality and its applicability to real-world problems, we tested it on several real-world datasets with different characteristics: protein-protein interactions, metabolic pathways, and social networks . the experimental results indicated that this new method could not only uncover the inherent hierarchy and the significant modules in a complex network, but could also provide different degrees of abstraction of the network.

hierarchically nested random networks: inclusion hierarchy
we verified the ability of pyramabs to uncover the inclusion hierarchy within an ensemble of random networks proposed by sales-pardo et al.  <cit> . there are three levels in the hierarchy, illustrated in figure  <dig>  the top level  comprises four modules of  <dig> nodes each. each top-level module is organized into four sub-modules of  <dig> nodes each . every level- <dig> module is further divided into four level- <dig> modules of  <dig> nodes each. after assigning the nodes to modules, following sales-pardo et al., we drew an edge between pairs of nodes that have a larger probability of both nodes being assigned to a higher-level module. the probability thus implied a horizontal relationship between nodes. an example random network is shown in figure  <dig>  when tested on  <dig> randomly generated three-level 640-node artificial networks, pyramabs performed as well as box clustering  <cit> , and better than a standard module-finding algorithm based on the edge betweenness and modularity measure  <cit>  ). the density of the random networks tested was  <dig> . to investigate the effect of density on the performance of pyramabs, we varied the network density by randomly removing links; these results are shown in figure  <dig>  as the density decreased, the mutual information decreased as expected. nevertheless, pyramabs could still find the correct hierarchy from the random networks with densities between  <dig>  and  <dig> . the mutual information did not drop noticeably until the graph density fell below  <dig> .

to increase efficiency, pyramabs reduces the search space using a z-score threshold to filter out "weak" links; the tradeoff is a loss of information. we conducted a series of experiments on random networks, using z-score thresholds ranging from - <dig> to  <dig>  to evaluate their effect on the results. pyramabs identified the correct hierarchy with threshold values of - <dig>  - <dig>  - <dig> , and  <dig> ). as we further increased the threshold, some supernodes became isolated due to their limited number of links. these experiments illustrated a limitation of pyramabs that the information loss caused by a low network density or a high z-score threshold has greater influence at the higher levels in the hierarchy, as seen in figure  <dig> and  <dig>  based on these test results, we set the z-score threshold to zero for the remaining experiments. because the optimum threshold balancing efficiency and accuracy will vary depending on the network and may not be known beforehand, we made the threshold a user-specified parameter in pyramabs, with a default value of zero.

analysis of a protein-protein interaction network
we tested pyramabs on the yeast core protein interaction network previously investigated in  <cit> . the network consists of  <dig> proteins connected by  <dig> links. as a result of running pyramabs, we discovered a hierarchy of five abstraction levels. the numbers of modules at each level were  <dig>   <dig>   <dig>   <dig>  and 1; for the 5th  level to the 1st  level, respectively. we evaluated the biological significance of the identified modules based on the gene ontology  biological process annotations, using the go term finder of sgd . the go term finder calculates a p-value that reflects the probability of observing the chance co-occurrence of proteins with a given go annotation in a certain module. the smaller the p-value, the more consistent the module is with the go annotations. we used a random assignment of the pool of proteins in the ppi network as the null model. the p-value results are presented in table  <dig>  we included the results of luo et al.  <cit>  and raddichi et al.  <cit>  for reference only, as neither study was capable of extracting a hierarchy from a complex network. to compare the hierarchy detection, we tested the same network using sales-pardo et al.'s box clustering  <cit> .

pyramabs
pyramabs
pyramabs
pyramabs
sales-pardo et al.
sales-pardo et al.
sales-pardo et al.
sales-pardo et al.
aboth luo et al.'s and raddichi et al.'s methods could only identify single-level modules.

bin sales-pardo et al.'s method, a higher-level module will not necessarily be further partitioned into lower-level sub-modules. thus, the number of modules does not necessarily increase as the level goes down .

from table  <dig>  it is seen that the average p-value decreased at higher levels. this suggested that the vertical relationships in the hierarchy identified by pyramabs correctly corresponded to the go hierarchy, since the modules at lower levels correctly merged into larger modules at higher levels. note that the average cluster sizes at levels  <dig> and  <dig>  in our pyramid are much greater than the average level  <dig> cluster size using box clustering . with a closer examination of our level  <dig> compared with level  <dig> in box clustering, we found that the total number of clusters was similar , as was the average cluster size . we further compared these  <dig> modules with the  <dig> modules, and found there were a significant number of common module member proteins. the average overlap was over 80%. based on these findings, pyramabs was proven to be more useful for disclosing higher-level module organizations than was box clustering. on the other hand, when comparing the bottom level in both hierarchies, our average cluster size was larger . this suggests that box clustering has a greater tendency to partition modules into smaller ones than does pyramabs.

we also analyzed the horizontal relationship in the abstract network at each level to ascertain its ability to characterize biological meaning. the proximity between two supernodes  in an abstract network, as defined in eq.  <cit>  , reflects the significance of the relationship between the nodes. for example, assume there are two pairs of nodes in the abstract network,  and , for which there is greater proximity between a and b  than there is between c and d . thus, pab >pcd, and a and b have a closer relationship to each other than c and d. we assume that if a and b are related biologically, then the p-value calculated by the go term finder will decrease after we merge a and b. therefore, if a and b are closer to each other biologically than c is with d, then the ratio of decrease in the p-value calculated by the go term finder after merging a and b would be larger than that after merging c and d. the ratio of decrease in p-value is defined as:

 p−decreaseratio=min−pvabmin, 

where pva and pvb are the p-values of nodes a and b calculated by the go term finder, and pvab is the p-value of the new node consisting of a merged with b. we used min in the definition, so a positive p-decreaseratio indicates that pvab is smaller than both pva and pvb, i.e., the merge of a and b is more biologically significant than either a or b.

in our analysis of protein-protein interactions, we verified whether a and b actually had a closer biological relationship than c and d when pab >pcd; this was accomplished by evaluating the change in p-value calculated by the go term finder before and after the node  merging. we ran a sign test on the abstract network at each level in the hierarchy, and we found a significantly greater number of positive cases in which the ratio of the p-value decrease after merging a and b was larger than that after merging c and d, when pab >pcd . these results demonstrated the feasibility of applying a horizontal relationship measured by proximity to the characterization of closeness in biological functions.

due to the complexity of figure  <dig>  we show the backbone of the abstract network at levels  <dig> and  <dig> in the hierarchy instead of the complete abstract networks. the biological meaning behind the pyramid structure represents how these proteins relate and interact at different hierarchical levels. one example, marked by two red circles of the vertical relationship, was selected for further study, and involved one level- <dig> module and five level- <dig> modules, as detailed in figure  <dig>  we also selected one example of the horizontal relationship for further analysis, marked by a red rectangle. this included four level- <dig> modules, described in figure  <dig>  the vertical relationships corresponded correctly to the go hierarchy, and the strength of the horizontal relationships provides a good indication of the functional closeness between protein modules.

analysis of a metabolic network
thousands of components in a living cell are dynamically interconnected within a complex network that determines the cell's functional properties  <cit> . one of the primary examples is cellular metabolism arising from sophisticated biochemical networks, in which numerous metabolites are integrated through biochemical reactions. to facilitate the identification and characterization of system-level features in biological organizations, we can partition cellular functionality into a collection of modules and organize them in a hierarchy  <cit> . we tested pyramabs on the metabolic network of e. coli that was used previously  <cit> . this network contained  <dig> nodes and  <dig> links, where each node represented a metabolic substrate, and each link described a reaction.

in kegg  <cit> , metabolic pathways are classified into  <dig> categories: carbohydrate, energy, lipid, nucleotide, amino acid, other amino acid, glycan, pk/nrp, cofactor/vitamin, secondary metabolite, and xenobiotics. each category consists of several sub-categories . in addition to the kegg pathway classifications, kegg also provides pathway modules that are specifications of sub-networks corresponding to tighter functional units. following previous work  <cit> , we evaluated the biological relevance of a module by conducting an enrichment analysis based on the kegg annotation categories. likewise, we used the hypergeometric distribution to obtain a p-value for the fraction of metabolites in each module associated with an annotation category of kegg; this was used to measure the within-module consistency of metabolic pathway classification. the p-values were calculated according to the kegg pathway category, pathway sub-category, and pathway module, respectively. the results are summarized in table  <dig>  for comparison, we tested the same network using box clustering  <cit> , with results shown in table  <dig>  from these results, we noted that both the total number of clusters and the average cluster size were similar between the pyramabs level  <dig> and the box clustering level  <dig> . however, the average cluster size in the pyramabs level  <dig> was much larger than that in the box clustering level  <dig> . this demonstrated that pyramabs identified one additional higher level in the module organization than did box clustering. we also observed that the average cluster size for levels  <dig>   <dig>  and  <dig> for the box clustering was smaller than that for pyramabs' bottom level . similar to the findings in the ppi network, these results suggest that box clustering is more likely to produce organizations of smaller modules in the hierarchy compared with pyramabs. this analysis suggests the possibility of combining the two complementary approaches to identify more detailed module organizations.

sub-category
module
we do not show level  <dig>  which has only one cluster.

cluster
sub-category
module
we do not show level  <dig>  which has only one cluster.

discussion
one widely used method for finding the organization within data is hierarchical clustering  <cit> . hierarchical clustering techniques group data into a sequence of nested clusters, either by treating each singleton as a cluster and merging them into larger clusters , or by dividing an initial single cluster into successively smaller clusters . both techniques organize data into a hierarchical structure, typically depicted as a dendrogram. both agglomerative and divisive clustering techniques produce a hierarchical tree allowing the visualization of the internal hierarchical structure within data, regardless of whether or not the data are actually organized hierarchically. it can be argued that a "height threshold" in a dendrogram can be judiciously selected according to some metric, above which any clusters and their hierarchical relationships are regarded as genuine. nevertheless, it is debatable if any post-clustering analysis that is independent of the clustering process will be effective. box clustering has been proposed as a variant of divisive unsupervised clustering  <cit> . this method iteratively identifies the modules at each level in the hierarchy until no further hierarchical levels can be found through module division. although it visualizes the final clustering result by a box-model clustering tree, it only shows vertical relationships between different hierarchical levels.

the quality of the network interpretation depends on the completeness of the knowledge extracted and the expressiveness of the knowledge representations. the present paper provides two contributions to this area. first, we proposed the abstraction pyramid, a new representation that combined vertical and horizontal viewpoints and is capable of interpreting a complex biological network at different degrees of abstraction. interpretations in this form are more accurate and more meaningful than multilevel dendrograms or single-level graphs. second, we developed pyramabs, a two-way approach combining top-down and bottom-up clustering techniques to detect modules and organize them into a multilevel pyramid. as an improvement, the abstraction pyramid gives us the opportunity to achieve a new perspective on cellular organization, by traversing the pyramid freely through the links vertically and horizontally. for example, in one pyramid, we can learn how the metabolites in the metabolic pathways at the bottom level are merged into functional modules through vertical links. we can also verify if the higher-level modules connected by the horizontal links show any topological property, e.g., scale-free connectivity, that is shared by natural and social networks  <cit> . with a macro view, we can investigate the changes in topological properties and the biological meanings from one abstraction level to another. in contrast, with a micro view, we can analyze all possible routes going through the modules across levels, to identify interesting attributes or patterns. the modularity and hierarchy concepts have long been popular in various fields, e.g., biology, psychology, sociology, and digital system design  <cit> . our abstraction pyramid combines these two concepts. it allows the details of each module to be dealt with in isolation, or the overall characteristics of a coherent system to be dealt with at different levels. this integrated concept is similar to a computer architecture design or system engineering, in which computing modules are organized in a hierarchy according to functionality and implementation details. we expect that future studies in these directions will shed light on new research topics within these fields.

CONCLUSIONS
to evaluate the interpretations made on complex biological networks by pyramabs, we experimented on ppi and metabolic networks. the experiments showed that the abstraction pyramids were biologically meaningful. the vertical relationships successfully characterized the inclusion relationship according to the go and kegg category hierarchy, and the strength of the horizontal relationships correctly reflected the functional closeness according to the go and kegg annotations. in addition, we tested pyramabs on two social networks to demonstrate its generality: zachary's karate club network and an ncaa college football network . these results were encouraging.

we can extend this work in several directions. one future improvement of pyramabs is to identify overlapping modules. currently the modules at the same level are not allowed to overlap, although overlapping modules exist in some real-world domains. second, although the performance of pyramabs has been demonstrated in real-world domains, we can refine the proximity measure and utilize domain knowledge to improve its robustness for situations in which networks may contain spurious links and nodes, or may be missing crucial links or nodes. pyramabs currently assumes that the given network is correct when it extracts the abstraction pyramid from the complex network. third, we can characterize an algorithm for network community analysis, using the proximity measure applied to evaluate the association between nodes, and using the construction procedure it takes to organize the communities. a more thorough comparative study of pyramabs with other methods provides the opportunity to integrate various complementary algorithms to increase its applicability to various domains and its accuracy in interpreting the networks.

