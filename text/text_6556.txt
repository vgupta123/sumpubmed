BACKGROUND
understanding the mammal transcriptome architecture has proven to be a complex task  <cit> . the advent of high throughput sequencing technologies, such as rna-seq, has, yet, substantially improved our comprehension of its structure and expression patterns. by deep sequencing the poly-a rna fraction, it is possible not only to better characterize isoforms from known genes , but also to improve the annotation by discovering novel predicted coding genes and polyadenylated processed transcripts such as long intergenic non-coding rnas  <cit> . although several surveys of the transcriptome from different tissues have been conducted in humans and model species  <cit>  our knowledge of livestock species remains limited. for instance, the relation between extreme phenotypic differences and their transcriptome patterns is poorly studied. the transcriptome of livestock species is, by comparison to model species, much less known despite its economic and social interest.

in this study, we used high-throughput transcriptome sequencing in two pigs from extreme breeds. our aim was to discover and characterize novel expressed transcripts and to identify differentially expressed genes that may explain some of the phenotypic variation. we sequenced the male gonad transcriptome of a large white and an iberian pig, two highly divergent phenotypic breeds in terms of production traits, e.g., growth, fatness and reproductive performance. to limit the effect of enviromental influences on gene expression pattern, both pigs were housed and fed with the same conditions and were prepubescent at slaughter time. furthermore we compared the results obtained with rna-seq with microarray data published in a previous study  <cit> . finally, we also identified polymorphic sites and genes that potentially showed allele specific expression.

RESULTS
mapping
we obtained about  <dig> m of  <dig> bp paired-end reads from one lane of an illumina gaiix machine, about  <dig> m was derived from each sample  under accession srp008516). after ambiguous mapping  with tophat  <cit>  a total of  <dig> m reads for each sample were mapped against the reference pig genome , although only  <dig> m were classified as proper pairs. the rest  fell into either one of these categories: reads without a mapped mate pair, mate is mapped on the same strand or mates overlap. the most likely explanations of the large amount of improperly mapped reads are the poor quality of the current pig genome assembly and the stringency of the version of tophat used here, as this version does not allow gaps for the mapping. in addition, any situation where the distance between the mates is larger than the confidence interval of the insert size distribution, could be interpreted as trans-splicing events  <cit> , structural variants or simply mapping artifacts  <cit> . the total number fragments mapped with unambiguous mapping  were  <dig> m for each sample; out of these,  <dig> m were classified as proper pairs. a comparison between ambiguous versus unambiguous mapping results obtained with tophat is shown in additional file  <dig> 

annotation of reads and transcripts assembly
to calculate the proportion of reads mapping to annotated exons, we run s-mart . surprisingly, with a minimum overlapping of  <dig> nucleotide, less than half of the reads  mapped to annotated exons; a figure that drops even further  when considering a minimum overlapping of  <dig> bp . the rest of reads mapped to annotated introns , or either  <dig> kb 5'upstream or 3'downstream of the annotated gene  . the poor quality of the annotation of the pig genome probably explains why a majority of the mapped reads  do not overlap with any known exons.

number of reads with at least one overlapping nucleotide mapping to either exons, introns or within  <dig> kb of gene boundaries.

moreover, after assembling the short reads into transcripts by cufflinks  <cit> , only  <dig> % of them matched exactly with annotated exons. the remaining reads were classified as intergenic transcripts , intron retention events , contained in known isoforms , pre-mrna molecules , polymerase run-on fragments , putative novel isoforms of known genes  and others . these results unfortunately underline the incompleteness of the current annotation of the pig transcriptome and of its complexity.

the number of transcripts assembled with cufflinks and the percentage they represent in each sample. the high number of assembled transcripts is probably an artifact due to truncated cufflinks assemblies. class codes described by cuffcompare: "=" exactly equal to the reference annotation, "c " contained in the reference, annotation, "e" possible pre-mrna molecule, "i " an exon falling into a intron of the reference, "j " new isoforms, "o" unknown, generic overlap with reference, "p" possible polymerase run-on fragment, "u" unknown, intergenic transcript.

annotating orthologs
a total of  <dig>  novel transcripts  were identified in intergenic regions . to investigate which of these transcripts actually encode a protein, we used augustus  <cit>  and found  <dig> novel putative proteins. we identified homologous dna sequences  in bos taurus and homo sapiens genomes for most  of these novel proteins:  <dig> were orthologs with both cow and human,  <dig> with human only and  <dig> with the cow genome only. this result is consistent with bos taurus being closer to sus scrofa than human  <cit> . interestingly, when we looked for homologous dna regions within the sus scrofa genome,  <dig> paralogous regions were detected .

to find out whether the predicted proteins from the homologous regions were already annotated, we ran blastp against the homo sapiens, bos taurus and sus scrofa protein databases . overall, we identified  <dig> novel computationally predicted and  <dig> known proteins for the human,  <dig> novel predicted and  <dig> known proteins for the cow and  <dig> novel predicted and  <dig> known proteins for the pig. the novel computationally predicted proteins found in the pig are now experimentally confirmed by rna-seq. see additional file  <dig> for the coordinates of orthologous and paralogous genes.

transposable elements
as many previous studies reported high activity of transposable elements  in germlines  <cit> , we ran repeatmasker to identify repetitive elements in the pig genome and in the transcriptome of the testicles. the fraction of transposable elements expressed in male gonads , compared to the total number detected in the pig genome, is less than 3%. however, approximately 20% of the expressed transcripts units harbor at least  <dig> transposable element . the type of te being more active in both breeds, in terms of number of elements expressed divided by the total number present in the genome, is dna transposons, but accounting just for the number of elements expressed is sine family for large white and the line family for iberian. line <dig> elements also have been reported to contribute to the transcriptome in human somatic cells  <cit> . it is interesting to mention that 16% of protein-coding transcripts contain transposable elements in their sequence and they are transcribed in the same transcript unit. apart from these interspersed repeats, hundreds of small rna  and thousands of simple and low complexity repeats were also identified in the transcriptome. the presence of non-polyadenylated rna could be a remaining contamination as they are highly expressed molecules and difficult to remove completely. another possible explanation is the presence of small functional rnas embedded in the introns of polyadenylated molecules of pre-mrna  <cit> . detailed results of the repetitive elements detection with repeatmasker are shown in additional file 3a and 3b.

lncrna annotation
in order to define a set of putative lncrnas in the pig transcriptome, we applied several filtering criteria. using the procedure in  <cit>  for the definition of lncrna in humans, we excluded all transcripts mapping within  <dig> kb of an annotated protein-coding gene in the pig genome. this makes it less likely to consider the 5' or the 3' utr of a protein-coding gene as a non-coding rna. yet, this filtering may not be stringent enough when dealing with insufficiently annotated genomes. for that reason, we further refined our analysis by excluding all transcripts coding for a complete proteins . a third filter was applied by removing all transcripts having a hit against nr , against pfam  or against rfam  <cit>  . the final filter was applied mapping all the resulting transcripts onto the human genome , and removing any transcript strongly overlapping with a protein-coding gene. the result is a dataset made of  <dig> transcripts and referred in the rest of this text as the lncrnas.

the main problem when dealing with ncrnas is to distinguish between spurious transcripts resulting from promoter leakiness and biologically functional transcripts. in order to do so, we assessed the level of evolutionary conservation of each lncrna across the  <dig> available mammalian genomes. as shown in previous work, this conservation cannot be directly inferred from reference multiple genome alignment  <cit> . we therefore used a standard gene discovery strategy that relies on a combination of blastn  and exonerate  <cit> . blastn allows a rough identification of the location of each transcript in the considered genome while exonerate is used to precisely delineate the corresponding gene structure. we only considered as potential homologues hits for which exonerate alignments yield more than 70% coverage with the pig transcript. the results of this extensive homology based analysis are displayed on a heatmap .

in the context of this analysis, we managed to map  <dig> transcripts in at least one other mammal species. a sizeable number of transcripts  were excluded because they contain pig repeats . the rest of the transcripts roughly fall in three categories. the first one is made up of genes apparently conserved across most tested mammals, including human. these make up a group of  <dig> genes . in this group,  <dig> transcripts map onto human genomic regions with no annotation. the rest either overlap with protein-coding genes , with known lncrnas  or pseudogenes . it is important to note that an overlap with a pcg is not incompatible with a transcript being a lncrna. the second category is made up of a group of  <dig> transcripts conserved among artiodactyla  but not found in human. the last group encompasses all the putative lncrnas for which no homologue was found in other species. while these may be pig specific, further analysis would be needed to confirm their biological relevance .

it is worth mentioning that the transcripts thus identified have a gene structure significantly different from their human counterparts. 97% are single exon genes and  <dig> % bi-exonic, a figure significantly different from human where a much higher portion is bi-exonic. this finding may simply reflect insufficient coverage in the rna-seq experiment resulting in truncated cufflinks models and thus should not be taken, so far, as strong evidence of distinct lncrna organization between species.

it is in agreement with our observation that the lncrna we observe in pig are roughly half the size of those reported in human . as a consequence, the number of independent transcripts reported here is quite likely to be an over estimation.

gene expression analysis
in total,  <dig>  annotated genes were expressed in gonads. less than 1% of these genes were expressed more than  <dig> fpkm; around 5% were expressed between  <dig> - <dig> fpkm, 50% between 10- <dig> fpkm, 40% between 10- <dig> fpkm and 3% between 1- <dig> fpkm . the rest were expressed below  <dig> fpkm. the maximum expression level of an annotated gene was  <dig>  and  <dig>  fpkm in large white and iberian, respectively. the gene ontologies of the  <dig> most expressed genes  in both samples were related with transcription and translation, protein folding, lipid and cholesterol metabolism , induction of apoptosis and response to stress. these results are consistent with those observed in other mammalian species with rna-seq  <cit> .

the correlation of gene expression levels between both samples  was very high , which suggests that a large fraction of the transcriptome is conserved across individuals. this is consistent with our previous results which showed that the largest source of variability was tissue rather than sex or breed  <cit> .

gene expression was quantified using two different approaches: degseq  <cit> , which uses raw fragment counts per gene as a measure of expression, and cufflinks  <cit> , that uses an estimation of fragments per kilobase of exon per million reads mapped . degseq's protocol recommends working only with the uniquely mapped fragments, whereas cufflinks can deal with multiple mappable fragments. in this study, the correlation of the log <dig> of the fold change between both methods was  <dig>  when discarding infinite values and taking expressed genes in both methods into account . nevertheless, fragments mapping to homologous genes, which constitute 15%-20% of the expressed genes, are lost when considering fragments that map only once in the transcriptome, so it is arguable how to actually compare expression levels measured with these two programs.

we also compared the rna-seq expression results with affymetrix microarray data obtained in a previous study  <cit> . as many microarray probes may map to the same gene, the average probe value per gene was calculated. a total of  <dig>  ensembl id genes could be retrieved from microarray probes data for rna-seq comparisons. the correlation between the individual microarray signal intensity difference and the log <dig> of the fold change from rnaseq was quite high . from the microarray study, we also had a bayesian standardized breed score  available for each gene. when comparing the microarray breed z-score and the log <dig> of the fold change in rna-seq, the correlation was also moderately high .

differential expression analysis
we compared the performance of cufflinks and degseq to detect differential expression between both samples . cufflinks identified  <dig>  differentially expressed genes with multiple mappable fragments and degseq  <dig>  with uniquely mapped fragments; there was a reasonable agreement between softwares,  <dig>  genes . but, to be more conservative, and to try to get only differential expression due to breeds and not merely to stochastic reasons, we extracted differentially expressed genes from breed effects data, with absolute z score threshold >  <dig> . then we selected the intersection of rna-seq  and microarrays reducing the number of differentially expressed genes to  <dig> . out of these,  <dig> genes were over expressed in large white and  <dig> in iberian. among differentially expressed genes, spermatogenesis, response to steroid hormone stimulus and sensory organ development were significantly over-represented children gene ontologies . doing the same analysis but considering the goslim of the pig described in the methods section, we obtained an enrichment of reproduction, developmental process and fatty acid metabolic process parental gene ontologies . interestingly, among the significant kegg-pathways represented, we found many differentially expressed genes in the ppar signaling pathway, which is involved in lipid metabolism and, specifically, it has been shown to have a role in mice gonads fat deposition  <cit> .

expression differences of coding and non-coding genes
we also compared the expression level of the annotated coding genes, novel coding genes, lncrna and transcripts containing at least one transposable element . the median expression level of annotated coding genes  was slightly lower than of the novel-coding genes . the range of expression levels of the annotated coding genes is, however, broader than that of the novel coding. we were able to detect annotated coding genes with very low expression levels, which highlights that fact that providing the reference gene models, it is easier to detect genes even at low coverage. simultaneously, the expression median of transcripts units with at least one te  and lncrnas  is more than 50% lower than those of coding regions. as non-coding transcripts are probably involved in gene regulation, less number of copies is needed  <cit> . the annotated coding genes are on average longer than the novel coding . this may be due to several reasons, first a higher coverage is needed to fully assemble a novel gene, but, it is has been also described than novel genes tend to be shorter than annotated ones. overall we found that the average transcript length for protein-coding gene is  <dig> bp, roughly half the size of transcripts in the human transcriptome . interestingly, we observed a similar ratio when comparing the average size of lncrnas in our experiment  with that observed in human . this fairly constant ratio suggests a homogenous bias, most likely the result of a lack of connecting paths between exons of the same transcript unit.

the gc content median of the coding genes  was the same but higher than the lncrna  and transcripts harboring at least one te  because coding genes tend to be rich in gc  <cit> . important to notice is the fact that gc content of annotated genes differs depending on whether we provide to cufflinks the reference gene annotations  or not . in the former, the gc content is much higher  than the latter , pointing to a possible bias towards at during illumina library preparation and sequencing workflow. recently, a new amplification protocol has been published that solves this problem  <cit> .

snp identification
we divided the snps in two classes, fixed, i.e. differences with respect to the assembly, a duroc pig, and segregating when the individual was heterozygous. the number of snps found per bp sequenced is shown in table  <dig>  in autosomes, approximately the same amount of fixed snp with respect to the duroc genome reference is found in both breeds, but around 30% less divergence is found in iberian on × chromosome. regarding the segregating snp, in autosomes, we found 30% less variability in iberian than in large white and almost 50% less variability in the × chromosome. this result is in agreement with the high inbreeding level of the iberian strains. fixed snp and segregating snp annotation is shown in table  <dig> introns and 3' downstream regions of annotated genes were the most polymorphic, a result of less evolutive constrains than exonic and 5'upstream regions of the genome; 3'utr was also more variable than 5'utr regions. as expected, more snp were synonymous than non-synonymous in cds.

number of fixed snp with respect to the reference genome and number of segregating snp within each breed. within brackets, the number of snp per kb assembled.

the number of snp is degenerated; each snp can have more than one annotation.

allele specific expression
a beta binomial model was applied to detect allele specific expression ase . a total of  <dig> snp  with average coverage of  <dig> × and  <dig> snp  with average coverage  <dig> × showed allelic imbalance in large white and iberian samples, respectively. coordinates and annotation of snps with significant results are listed in additional file  <dig>  figure  <dig> shows the relation between coverage and the posterior mean of allele specific expression p . figure 6a indicates how, although very extreme values of p are always significant, intermediate values  are significant only if enough coverage exists. this is a result of how the prior  is dominated by empirical evidence as data increases. figure 6b was plotted to show that an increased coverage does not result in an average higher ase and therefore significance is not a statistical artifact. further, we did not observe either any consistent higher expression of the reference vs. the alternative allele  and therefore it is not an alignment artifact either.

several snp with significant ase are located contiguously within intergenic regions, suggesting the presence of putative functional units not yet annotated in the pig genome. there were not many genes with ase shared between the two samples, likely due to different genotypes at the regulatory motif of the two breeds. there were only  <dig> common snps exhibiting ase in both animals, but in three of the snps we observed over expression of different alleles in each breed. logically, these results should be taken as statistical evidence, genotyping or sequencing the cis-regulatory motives and linkage disequilibrium information are, however, needed to confirm whether these snps show genuine ase.

general discussion
we present the first, to our knowledge, comprehensive exploration of the pig gonad transcriptome carried out with rna-seq, a technology that offers critical advantages over microarray. importantly, rna-seq allows us to improve dramatically the annotation of the species and the discovery of new splicing events. here, we have confirmed that a large part of the transcription effort in the cell is spent on te sequences. a recent rna-seq study in human and primate brain transcriptomes also found high proportion of reads mapping to repetitive elements, mainly from the alu family  <cit> . previous works in mice also indicated high expression of te in germlines. the number of te is probably an over-estimation as we did an ambiguous mapping reporting only the best alignments. on the other side, cufflinks down weights the expression level taking into account mapping uncertainty  <cit> .

unfortunately, we also confirm that current porcine annotation is incomplete, as evidenced by read mapping annotation: more than 50% of the fragments do not map to annotated exons. the fact that many reads map to introns could be explained either by intron retention  or pre-mrna presence. reads mapping outside the boundaries of annotated genes could be explained either by polymerase run-on fragments or a bad annotation of the gene endings. many intergenic reads have been mapped to putative novel coding transcripts, some of them presenting orthology with related species. the poor status of the annotation is confirmed by the presence of  <dig> highly conserved transcripts, that would have been annotated as lncrnas if we had only considered the pig annotation, but whose homologues in human show a perfect overlap with protein-coding genes.

given that we had previously analyzed the transcriptome of a wider collection of pig and tissues with affymetrix microarrays  <cit> , we were able to compare both technologies. the correlation within individuals was rather high  and comparable to other reported studies  <cit> . furthermore, the correlation of expression between iberian and large white obtained with microarray  and the individuals  was also moderately high , suggesting that transcriptome patterns are relatively stable. among the most differentially expressed genes, those involved in spermatogenesis and lipid metabolism are over-represented, which may be a result of targeted tissue selection. it is noteworthy that large white and iberian breeds are phenotypically extreme for both reproduction and fat deposition traits so these data would suggest a correlated effect on the regulation of genes involved in these traits.

in general, cufflinks has a better performance to map fragments to genes or isoforms that are physically overlapping or very similar in sequence, as it uses a statistical model to deal with multiply mapping fragments. degseq works with uniquely mapped reads, thus underestimating gene expression levels of homologous genes but also discarding those reads belonging to two overlapping genes; a bias in expression level is thus introduced in these cases. the algorithm behind cufflinks is rather naïve, though. recently, new approaches that implement improved algorithms to deal with ambiguously mapped reads data and avoid bias in downstream analysis have been published  <cit> .

although not the main purpose of the work, we also found a lower rate of heterozygosity in iberian than in the large white animal, in agreement with the fact that iberian pigs are normally inbred. finally, we also explored ase, a topic that has received a renewed interest recently. in this study, ~ 4% of the segregating snp presented allelic imbalance. from these, around 40% were located inside annotated genes, the rest were located in blocks in intergenic regions, pointing to putative functional transcripts. to be able to confirm ase, more animals should be tested because the majority of the snps with ase were not common between large white and iberian pigs.

CONCLUSIONS
we provide a complete survey of the pig male gonad transcriptome and identified many novel elements. however, to further improve the annotation of the pig genome, a large effort from the community will be necessary by sequencing more tissues at different developmental stages. in order to detect novel splicing events and to reconstruct novel isoforms, rna-seq studies with very high coverage are required. here, we also have shed some light on the dark matter of the transcriptome; in particular, we remark the discovery of novel long non-coding transcripts and the fact that te expression seems to take a large fraction of the transcriptome. their precise roles need to be elucidated in future studies. we also show that correlation between microarray and rnaseq expression data are reasonably high . finally, large white and iberian pigs seem to have diverged most for genes involved in spermatogenesis and lipid metabolism, not only in terms of gene expression but also phenotypically. interestingly, it is well known that genes related to gametogenesis are subject often to a positive selection rate  <cit> . more work is required to investigate whether the differences in expression in these genes are adaptive.

