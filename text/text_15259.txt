BACKGROUND
translation initiation in eukaryotic mrna molecules typically follows the basic mechanism postulated by the scanning hypothesis  <cit> , according to which the 40s ribosomal subunit binds to the 5'-cap of an mrna, scans in the 5' → 3' direction until the first aug is encountered, stalls to recruit the 60s subunit, and forms the 80s ribosomal particle, which then proceeds unencumbered with translation to render a protein product . roughly 10% of eukaryotic transcripts are subject to so-called leaky scanning  <cit> , in which the ribosome continues scanning beyond the first aug codon until it encounters one in a more favorable context  <cit> . alternative methods to initiate translation from certain rnas of viral origin exist, including, one, the formation of kissing stem-loops to facilitate translation initiation from a 5'-proximal methionine codon  <cit>  and, two, usage of internal ribosomal entry sites  <cit> . efficient translation initiation from non-methionine codons is also possible in eukaryotes  <cit> . in the present work, we are concerned only with modeling 5'-cap-dependent translation initiation occurring at aug codons in eukaryotic protein coding genes of non-viral origin.

a variety of approaches to in silico translation initiation site  detection in nucleotide sequences have been previously considered, including perceptrons  <cit> , single, multilayer artificial neural networks   <cit> , multiple, multilayer anns  <cit> , linear discriminant analysis  <cit> , mixture gaussian models  <cit> , unsupervised clustering algorithms  <cit> , support vector machines  <cit> , expectation maximization  <cit> , and hidden markov models  <cit> . unfortunately, none of these methods are conveniently available in the form of open source, distributed software. in part, our motivation for this work is to provide a software framework for the implementation and testing of a variety of different algorithmic approaches to tis identification. software systems such as estscan  <cit>  and diogenes  <cit> , originally developed for detecting significant open reading frames in  cdna sequences, have also been used to identify tiss, although empirical results suggest that these methods are inappropriate for the task  <cit> . one strategy for integrating tis detection methods into computational gene finding pipelines, as opposed to predicting tiss in mrna sequences per se, is to refine results produced from a separate gene finding tool. for example, the tico tool  <cit>  was developed to refine prokaryotic gene structure annotations generated by the glimmer program  <cit> . the mechanism of translation initiation in prokaryotes differs considerably from that of eukaryotes  <cit> . here, we describe the metwamer system, developed primarily for post-processing spliced alignment-based eukaryotic gene annotation results provided in the gthxml format  <cit> . a variant of the metwamer code is abstracted from any specific gene prediction system and allows tis prediction in eukaryotic reading frames as generated by any procedure, thus facilitating integration into other gene prediction software and workflows.

in the following we first describe metwamer and its incorporated tis-finding algorithms and then discuss applications to annotating transcripts from the model plant arabidopsis thaliana. metwamer currently implements five distinct methods for tis detection. among these, the best performer is the perceptron-based flank-contrasting weighted log-likelihood ratio routine , which combines local tis feature scores and scores probing the contrast in coding potential of sequences flanking a site. metwamer allows the user to develop and apply stratified parameter sets for an arbitrary number of data clusters. we demonstrate the potential for stratified parameter deployment to yield considerable increases in tis prediction accuracy relative to a homogeneous parameter strategy. also discussed are strategies for parameter selection in practice, depending on prior assessment of the likelihood that the transcript under consideration is or is not 5'-complete. source code implementing this package is released under the isc license, and is available for download from  <cit> . it is also registered as additional file  <dig> in this report.

implementation
in the following subsection, we briefly describe the components of the metwamer software. then we discuss the distinct algorithms implemented for tis-identification and report our training and testing approaches for arabidopsis data.

the metwamer system
the metwamer code, written in the c programming language, implements the executable files metwamer.cds and metwamer.gthxml. metwamer.cds is the generic application for tis prediction in eukaryotic open reading frames, as derived via any computational procedure. metwamer.gthxml is a special-purpose variant of the software, specifically tailored to refine gene structure predictions generated by the genomethreader  <cit>  and geneseqer  <cit>  programs for spliced alignment-based gene structure annotation. genomethreader and geneseqer, like most other spliced-alignment tools, do not make explicit predictions concerning translation initiation sites, but rather are restricted to the identification of reading frames in genomic sequences for which transcript evidence or homologous sequences suggest a protein coding function. metwamer.gthxml extends the 5'- and 3'-most termini of these annotated reading frames such that a maximal  open reading frame  is realized.  metwamer scans for methionine-encoding sites in this maximal reading frame, considering their potential as translation initiation sites under a variety of scoring schemes, described below, in an attempt to identify a tis for the gene structure under consideration. at most one prediction per maximal orf is made, if and only if the optimal solution rendered exceeds some method-specific quality threshold.

common to all detection methods implemented in metwamer is utilization of a start-methionine signal-specific weight array matrix  that records position-specific base transition frequencies proximal to methionine codons in protein coding sequences. here, wams characterize position-specific dinucleotide abundances; see the stratified training and testing section below for a more detailed description. the train_metwam utility from the metwamer package can be used to develop such a wam, given appropriate training data. the first in-frame methionine codon encountered, subsequent to a specified offset in the training sequence, is considered to be the true tis for that sequence. training of the methionine weight array matrix proceeds by tabulating dinucleotide frequencies from five positions upstream of the adenine through three positions downstream of the guanine residue of the pertinent methionine codon. next, the system advances  <dig> bases in the training instance, to resume scanning for in-frame methionine codons, each of which will be classified as a false tis; dinucleotide frequencies proximal to these false tiss are tabulated in the same manner as true tiss . following tabulation of dinucleotide frequencies at true and false tiss in training data, these are converted to relative frequencies, yielding the wam, which enables calculation of the likelihood that a site in question is a true or false tis.

methionine log-likelihood ratios
the log-likelihood ratio  approach to tis prediction functions by scanning the orf for in-frame atg codons.  a constraint is imposed on the protein length implied by any potential start-methionine such that if the atg served as a true translation initiation site, the resulting protein must exceed  <dig> amino acid residues. using the trained methionine-wam, the method scores each such feasible site by calculating the likelihood that it is a true initiation site and taking the ratio of this value relative to the likelihood that it is not a true start site. the system identifies the methionine codon yielding the optimal value among such likelihood ratios, and provided the log of this ratio is non-negative, the llkr routine returns it as the predicted start-methionine. the non-negativity constraint implements a classification threshold, imposed because we require the likelihood of the potential start site to favor its actually being a true tis. if the system fails to identify any in-frame atg codons, or the best-scoring site's score is negative-valued, then llkr returns no prediction for the maximal orf being surveyed.

weighted methionine log-likelihood ratios
the weighted log-likelihood ratio approach  is identical to llkr, but each in-frame atg's log-likelihood ratio score is scaled as a function of the induced protein product's coverage of the maximal orf. precisely, coverage x is defined as the ratio of the length of the implied amino acid chain starting from the tis under consideration over the length of the maximal orf. for a true tis, we expect the coverage value to be close to unity, as it would be unusual for a long, uninterrupted reading frame to be evolutionarily maintained in a genome, yet not be encoding an expressed, functional protein product. empirically, we settled on weights calculated as w = x <dig> . the wllkr routine optimizes over weighted log-likelihood ratios for all in-frame atg codons, returning a predicted start-methionine if and only if the optimal such value is non-negative.

multiplicative-based flank-contrasting with weighted methionine log-likelihood ratios
metwamer also implements an approach to start-methionine prediction that considers two descriptive features of potential tiss: weighted methionine log-likelihood ratio scores as used by the wllkr routine  and the ratio of coding potential in a swath of sequence downstream from the site to that of a swath upstream of it, evaluated under a coding hypothesis . intuitively, we expect that the coding potential of the sequence downstream from a true site – which is, by definition, coding – would exceed that upstream of it – which is, by definition, non-coding – and that the ratio of the former to the latter should be greater in true sites as opposed to false. coding probabilities of sequence swaths  are computed using a fifth-order χ2-interpolated markov chain model  <cit>  as implemented in the immpractical library  <cit> . the idea of integrating both content- and signal-based features into tis prediction has been explored before  <cit> , although the methodologies used here are distinct from previous studies.

for the multiplicative-based flank-contrasting with weighted methionine log-likelihood ratios  method, the signal- and content-based scores, expressed in log space, are added. the system optimizes over these scores at viable, in-frame start-methionine sites, and if the best-scoring site's score is non-negative, it is returned by the routine as its tis prediction.

perceptron-based flank-contrasting with weighted methionine log-likelihood ratios
the perceptron-based flank-contrasting with weighted methionine log-likelihood ratios  routine considers the same descriptive features as mfcwllkr, but uses a perceptron as a multivariate utility function, as opposed to the multiplication operator. perceptrons implement linear discriminants, and as such require linearly  separable data sets to provide good classification performance . intuitively, we expect that the two dimensions corresponding to the signal- and content-based features exhibit linear  separability: both weighted log-likelihood ratios of methionine sites and log-likelihood ratios of the coding potentials of downstream to upstream content swaths should be greater-valued in true start methionines as opposed to false, non-start ones. linear and sigmoid units are used to implement perceptrons in the metwamer system; each of these neural elements can learn a continuous-valued function that can be thresholded to enable discrete, binary classification; excellent discussions of these methods can be found in § <dig> . <dig> of  <cit>  and § <dig>  of  <cit> . thus, linear and sigmoid units can be used to optimize over viable candidate start-methionine codons.

pfcwllkr returns the best such potential tis if and only if it is classified as being a true site by the perceptron. although stormo et al. used a perceptron to classify translation initiation sites in bacteria in a pioneering study  <cit> , they considered an entirely distinct feature set.

bayesian tis prediction
lastly, we also considered a bayesian approach  to predicting tis sites. each viable start-methionine in the maximal reading frame is considered under two separate models, one that the atg is a true translation start codon and the other that it is not. the maximum a posteriori  hypothesis among this set of possibilities is computed, and if the site it denotes is represented as being a true tis, bayes returns this result as its tis prediction. otherwise, the method refrains from making any predictions. calculation of the map hypothesis is formulated as follows. a prior distribution is derived for each maximal reading frame being surveyed: each in-frame atg, under the model of its being a true initiation site, is given a prior probability proportional to the relative length of the peptide it induces compared with that of the maximal reading frame. similarly, under the model of not being a tis, each such site is assigned a prior probability proportional to the complement of its prior probability of being a true one. these values are normalized so as to collectively represent a valid probability mass function over all putative start-methionine sites, under both models. the likelihood of data is modeled using log-likelihood scores computed with the methionine-wam.

data sets
only gene annotations marked as curated in the current arabidopsis thaliana annotation made available by tair  were used for developing methionine-weight array matrices. in tair, a curated status implies that these structures have been either manually inspected or are supported by full-length cdna evidence. training instances were further required to encode protein products at least  <dig> amino acid residues long, whose initial codon was atg. for annotations satisfying these criteria, coding sequences were extracted from genomic templates using supplied reference coordinates. because the tair annotation contains deliberate indel mutations in certain coding sequences with respect to genomic templates , and these modifications are not reflected in genomic reference coordinates, only parsed coding sequences having lengths divisible by three were retained for analysis. this overall process is implemented in the parse tigr codseqs utility from the metwamer package, which processes documents provided in the tigr xml format  <cit> .

these data were then post-processed to purge transposable elements and curtail redundancy. all coding sequences with significant matches  to a sequence present in the tigr plant repetitive element database  <cit> , calculated using blastn  <cit> , were eliminated. to limit redundancy in the remaining data, the blastclust utility  <cit>  was used: sequence pairs having ≥ 80% nucleotide identity covering ≥ 80% of the longest sequence's length were clustered. any sequence that clustered with one or more others was eliminated from the data set, i.e., we retained only one gene from each cluster. this resulted in  <dig>  tis-containing genes being retained for analysis.

a non-tis-containing data set was compiled also, for testing the methods' abilities to not predict a tis when none is present. the tis-containing gene set was used as a starting point, from which we excluded single-exon genes. of the remaining structures, the first coding exons  were ablated from the conceptually spliced mrnas; either  <dig>   <dig>  or  <dig> bases were clipped from the 5'-terminus of these second exons in order to preserve the original reading frame. next, sufficient flanking genomic sequences upstream of these exons were prepended, to facilitate the flank-contrasting methods – we remain neutral as to whether these are contributed entirely from the first orf-disrupting intron of the gene, or if they might also include fragments from one or more upstream exons, 5'-utr introns, or intergenic sequences. in total,  <dig>  non-tis-containing instances were retained for analysis.

stratified training and testing
in addition to homogeneous training, which does not address the possibility of characteristic features of potentially distinct biological classes of translation initiation sites, the calc_medoids utility of metwamer implements a method for developing stratified training data sets, which can be used to parameterize metwamer for cluster-specific tis prediction behavior. the k-medoids algorithm, as implemented in the c clustering library  <cit> , is used to calculate medoids , using a non-redundant set of translation initiation site sequences . the hamming distance is used to measure pairwise similarity of such instances.

metwamer implements a total of six possible methods for utilizing cluster-specific information during the prediction phase, when the true class of the sequence's tis is unknown beforehand: three distinct measures of a site's "closeness" to those in a given cluster are defined, and each measure can be used either by selecting the best parameter set for every site encountered during scanning  or by choosing the best set on the basis of the first in-frame atg encountered, and committing to the exclusive use of it for scoring any remaining putative tiss in the reading frame . thus, these combinations comprise a collection of parameter set indexing strategies, which allow for lookup of those partition-specific parameters most appropriate for scoring a site.

the first measure considered is the hamming distance, which lends itself to an indexing strategy in which, for a putative tis, its distance is computed relative to the k medoids identified in the clustering step; cluster-specific parameters corresponding to the medoid whose hamming distance is minimal to it, are used to score. the pwm-based indexing method utilizes cluster-specific position weight matrices for measuring the site's similarity to known clusters, and the parameter set whose representative pwm renders the putative tis most likely is used for scoring. specifically, a pwm characterizes position-specific mononucleotide distributions at genetic elements such as promoter sites, splice sites, or translation initiation sites  <cit> . here, the likelihood of a potential tis as having been generated by the  pwm is given by

 lkpwm=∏i=− <dig> ..+5fbi, 

where i indexes each position in the site , and fbi is the relative frequency of base bi ∈ {a, c, g, t} in position i of the aligned training sequences. finally, a wam-based indexing method is implemented, which is analogous to the pwm-based strategy, though  weight array matrices are used for computing likelihoods, rather than pwms. for a potential tis site, the likelihood of its having been generated by the wam is computed by metwamer as

 lkwam=∏i=− <dig> ..+4fdi,i+ <dig>  

where i indexes each position in the site, and fdi,i+1∈{aa,ac,ag,...,tt} is the relative frequency of the observed dinucleotide di,i+ <dig> occurring at position i in aligned training data.

test design
a five-fold cross-validation strategy was used to assess the methods on the task of translation initiation site detection competency. because the tis-containing instances consist only of known coding sequences from gene structures, and in practice metwamer scans for potential tiss across a maximal orf, we extended the coding sequences at their 5'-termini to achieve a maximal, non-stop reading frame, thereby presenting the system with the challenge of disambiguating spurious  methionine codons in the extended reading frame from true start codons – we make no considerations as to whether these extended sequences are derived from 5'-utrs, introns in 5'-utrs, or intergenic sequences. methionine-wams and markov chains were trained on each cross-validation replicate and then used to train a sigmoidal perceptron, using a learning rate of  <dig> × 10- <dig>  sigmoid units outperformed linear units in all experiments we conducted , so we do not consider the latter further. as a baseline for comparison of the implemented models, we consider also the 1st-atg method, which predicts the first in-frame atg it encounters in the maximized reading frame as a tis. tests using non-tis-containing instances were conducted similarly, though reading frames were not maximally extended at their 5'-terminus. the testing procedure is shown pictorially in figure  <dig> 

to assess the performance of metwamer relative to prior art in translation initiation prediction, we compared our system with the netstart  <cit> , tis miner  <cit> , tishunter  <cit>  and atgpr  <cit>  programs.

RESULTS
computational tis identification in tis-containing orfs
 <dig>  tis-containing instances were used in three separate five-fold cross-validation experiments. results are shown from applying a non-stratified parameter set , a priori-known cluster-specific parameter sets for k =  <dig> , and group-specific parameter sets for a random three-way split of the data . tp represents the number of instances for which the method correctly identified a tis; fp for which a prediction was made, though incorrect; and fn for which no prediction was made, but should have been . sn=tptp+fp+fn, and sp=tptp+fp.

cluster-specific parameter results were produced by first stratifying the data with respect to the clusters identified by k-medoids, for k =  <dig>  conducting five-fold cross-validation analyses independently for each cluster, and averaging the results. thus, we explicitly leveraged information concerning the true cluster to which a test sequence's tis belongs. all methods increased markedly in tis prediction performance. to demonstrate that this observation is not simply an artifact due to potentially over-fitting the models to smaller training set sizes, we randomly split the data into three separate partitions and repeated the analysis. the random split results are essentially indistinguishable from those obtained using homogeneous deployment, and thus we may conclude that the performance gains from cluster-specific parameter training reflect non-random effects.

computational tis identification in transcripts undergoing leaky scanning
 <dig>  instances from the tis-containing data set are known to contain in-frame atgs upstream from the true tis. table  <dig> provides tis prediction statistics derived exclusively from these cases. by definition, 1st-atg is a complete failure in this scenario. pfcwllkr has greater sensitivity than all other methods under all parameter deployment strategies with the exception of cluster-specific, in which mfcwllkr bests it by roughly  <dig> %. wllkr strictly dominates all methods in terms of specificity, outperforming the second-best method, pfcwllkr, by under four percent for any parametrization strategy.

tis identification statistics are reported exclusively for the  <dig>  maximal reading frames containing in-frame atg sites upstream from the true tis, under three distinct parameter utilization approaches: homogeneous, a priori-known cluster-specific with k =  <dig>  and three-fold random split. tp represents the number of instances for which the method correctly identified a tis; fp for which a prediction was made, though incorrect; and fn for which no prediction was made, but should have been . sn=tptp+fp+fn, and sp=tptp+fp.

pfcwllkr should be more prone to false positive prediction on these sequences because the upstream atgs would typically have better coding potential contrast than the true tis.

method performace on non-tis-containing transcript fragments
 <dig>  non-tis-containing instances were used in three separate five-fold cross-validation experiments. results are shown from applying a non-stratified parameter set , a priori-known cluster-specific parameter sets for k =  <dig> , and group-specific parameter sets for a random three-way split of the data . tn represents the number of instances for which the method  refused to predict a tis, and fp denotes the number for which some prediction was made, though always incorrect . sn=tntn+fp.

comparison with other tis prediction tools
based on results shown in tables  <dig>   <dig>   <dig>  we identify pfcwllkr as the superior method currently implemented in metwamer, and therefore used it as a benchmark for comparison with other tis prediction tools. specifically, we consider pfcwllkr used under the homogeneous parameter deployment approach. we compare this method with the netstart  <cit> , tis miner  <cit> , tishunter  <cit>  and atgpr  <cit>  programs. because netstart is a tis classifier, and not a tis prediction system, we interpreted its results as follows. for all potential tiss scored by the program, we ranked each instance on the basis of its score. if the best-scoring instance was classified as a true tis , it was selected as the program's single tis prediction; else, we interpreted the result as the system's decision to make no tis prediction at all. we used the web interface to the program available at  and used its arabidopsis-specific parameters. the tis miner program, available at  was used with default paramters, with the number of predictions set to  <dig>  we used a classification threshold of  <dig>  for this program, such that if the tis prediction it returned was at least  <dig> , it was selected as the system's prediction, while if not, this was interpreted as its decision not to return a tis prediction. this threshold setting performed best over a range of values tried . finally, the tishunter and atgpr programs, available at  and , respectively, were used with default settings. all raw output generated by these tools on our test data is available as supplementary information at  <cit> .

as depicted in table  <dig>  pfcwllkr handily outperforms the netstart system, though it is bested by the tis miner , tishunter and atgpr programs on these tis-containing instances. in no case are the competing programs able to outperform 1st-atg. table  <dig> demonstrates that pfcwllkr is considerably better than the competing methods at identifying a true tis when an in-frame site occurs upstream from it, however. finally, table  <dig> shows that pfcwllkr is far better at declining to predict a tis when none are present than any of the four competing programs.

performance gains by parameter set indexing
based on the results shown in tables  <dig>   <dig> and  <dig>  we decided to focus on the pfcwllkr method in the following. indeed, although we assessed all the methods in the experiments described below, pfcwllkr was superior in all cases .

as shown in tables  <dig> and  <dig>  all parametric methods exhibited an increase in successful tis identification when using stratified parameter sets, suggesting that considerable improvements in statistically-based models for tis prediction can be achieved by taking the appropriately defined class of each potential start-methionine into account. this motivated the development of a lookup method for indexing appropriate parameter sets when the class of a test sequence's true tis is not known beforehand. table  <dig> provides results obtained using pfcwllkr on tis-containing data, under the six parameter indexing schemes described in the implementation subsection stratified training and testing. for any given value of k ∈ { <dig>   <dig>  10}, static wam-based indexing performs best overall. additionally, increasing values of k resulted in increased performance on these data. all indexing approaches improved under static parameter lookup relative to modulating, for all deployment strategies. this can be explained given the observation that in-frame atgs upstream from true tiss are relatively rare, e.g., they occur with a frequency of roughly  <dig> / <dig>  ≈6% in arabidopsis, and thus, provided the similarity measure used can recover the site's corresponding class with good fidelity, performance should closely approximate that obtained under a priori-known cluster-specific parameter usage.

 <dig>  tis-containing instances were used in five-fold cross-validation experiments, in which parameter sets were selected for putative tis evaluation according to best cluster fit established by either the hamming distance relative to cached medoids , position weight matrix scores , or weight array matrix scores . parameter indexing was tested under both modulating  and static  approaches. k denotes the number of clusters considered. tp represents the number of instances for which the method correctly identified a tis; fp for which a prediction was made, though incorrect; and fn for which no prediction was made, but should have been . sn=tptp+fp+fn, and sp=tptp+fp.

 <dig>  non-tis-containing instances were used in five-fold cross-validation experiments, in which parameter sets were selected for putative tis evaluation according to best cluster fit established by either the hamming distance relative to cached medoids , position weight matrix scores , or weight array matrix scores . parameter indexing was tested under both modulating  and static  approaches. k denotes the number of clusters considered. tn represents the number of instances for which the method  refused to predict a tis, and fp the number for which some prediction was made, though always incorrect . sn=tntn+fp.

metwamer as a tis classifier
although metwamer is not a tis classifier per se, each tis prediction method utilizes some form of discriminant technique with which to evaluate whether the best-scoring in-frame atg  is a true or false site. figure  <dig> shows receiver operating characteristic  curves for the sigmoidal perceptron element of pfcwllkr, which was assayed on the task of labeling atg codons as true or false tiss under distinct parameter deployment strategies. five-fold cross-validation was used to classify  <dig>  instances,  <dig>  of which were known tiss from the tis-containing gene set and  <dig>  of which were the first in-frame atg codons  from the non-tis-containing set . the roc plots demonstrate that utilization of a priori-known cluster-specific parameter sets yields a classifier superior to that obtained using a single, homogeneous set. however, wam-based indexing yielded a classifier worse than both the others. this seems due to the comparatively worse performance of the parameter set lookup strategies in general at rejecting false tiss .

biological interpretation of tis classes
given the improved performance of the methods under the a priori-known cluster-specific parameter deployment strategy, we wondered if any underlying biological basis for the grouping obtained by k-medoids, for k =  <dig>  may exist. clustering was performed using a non-redundant set of tiss, and the cluster-specific consensus sequences derived from position-specific mononucleotide distributions perfectly recovered each cluster's associated medoid . while these consensus sequences were fairly weak – as evidenced by the high degree of entropy at each position in the tis alignment – the observation nevertheless indicates that the clustering algorithm's results are meaningful, and also suggests the possibility of at least three distinct groups of tiss in arabidopsis. the possibility that these could correspond to distinct gene classes was explored using a non-parametric statistical test on ontological annotations, in which the significance of cluster-specific distributions of goslim  terms  <cit>  was determined by sampling same-size sets from the full population of terms. we labeled a cluster as being over- or underrepresented with respect to a particular goslim term if its frequency in the class was in the top or bottom five values in comparison with  <dig> randomly-sampled sets, respectively. clusters  <dig> through  <dig> contained  <dig> ;  <dig> ; and  <dig>  instances having associated goslim terms, respectively, with the overall population containing  <dig>  terms. our results, presented in table  <dig>  suggest that cluster  <dig> is largely depleted of plastid and ribosomal genes, while cluster  <dig> is enriched for these; cluster  <dig> is enriched for plastid and cytosolic genes. however, these observations should perhaps be deemed inconclusive, as many genes in our data set do not yet have associated goslim terms, and for those that did, such annotations should typically be considered tenuous at present.

arabidopsis transcripts were clustered into three sequence clusters based on tis similarity. within these clusters, the numbers of gene models with associated goslim terms are, respectively,  <dig> ,  <dig> , and  <dig> . clusters denoted as being "high" for a specific term were determined to be enriched in genes labeled as such, relative to the full population of terms, by a randomization test. those labeled "low" were found to be relatively impoverished in genes labeled with the associated term, and "normal" as being neither significantly over- nor underrepresented.

discussion
our results on the tis-containing data set suggest that, compared with the methods implemented in metwamer, a policy of labeling the first atg as tis in a maximal orf wil achieve quite good  results. however, in practice we cannot always assert whether a maximal orf has sufficient 5'-coverage so as to include the gene's true tis, or whether a spurious in-frame atg occurs upstream from it. in such cases, the 1st-atg strategy fails, as it does in cases of leaky scanning, thus sustaining the importance of further development of statistical tis prediction methodologies that capture the sequence features recognized by the ribosome in translation initiation. in this work, we present a number of distinct models for tis prediction, the most successful of which mixes content- and signal-based features of putative tiss using a perceptron . furthermore, we demonstrate that, in the model plant arabidopsis, tis prediction can be enhanced by integration of class-specific parameter sets, regardless of the prediction method utilized.

we attribute the well-balanced performance of pfcwllkr to the biological plausibility of the features provided to it as inputs. as a signal-based feature, weighted log-likelihood ratios considerably improve the specificity of tis prediction  = x <dig> for induced protein length to maximal orf coverage x, appears to empirically approximate the epistemology of eukaryotic translation initiation fairly well: according to the  ribosomal scanning hypothesis  <cit> , one would expect that more upstream aug sites – especially those occurring in a favorable signaling context – in a maximal reading frame would be more likely to function as bona fide translation initiation sites. also, it is unusual for a long, uninterrupted reading frame to be maintained, yet not expressed as part of a functional protein product. our weighting scheme has been explicitly designed to reflect these biologically-informed biases.

during the post-scanning phase of translation initiation, the small ribosomal subunit stalls at a tis to recruit the large subunit, thereby forming the 80s ribosomal particle. the scanning process, as conducted by the small ribosomal subunit in concert with various eukaryotic initiation factors, does not appear to take more global nucleotide compositional features of the mrna molecule into account, notwithstanding the possibility of secondary structures causing steric interference with scanning itself. that we might utilize contrast in coding potential of sequences flanking a tis for modeling purposes is a consequence of the fact that sequences upstream of a tis are non-coding, and those downstream, coding, though this plays no known role in the recognition of tiss in vivo. the use of markov chains in a classification setting was shown to distinguish exons from introns with good accuracy in plant systems  <cit> , and our expectation that these content-sensing tools could be gainfully transferred to the tis prediction domain was born out by the performance results shown. similar inclusion of coding potential contrast has also been employed to increase splice site prediction accuracy  <cit> .

our data set was developed from gene models flagged as curated in the current arabidopsis annotations, though it should not be overlooked that potential errors in these structures might have distorted our results. manual inspection of several genes whose tiss were predicted incorrectly by the pfcwllkr routine indicate possible problems with existing annotations. for example, in gene model at4g <dig>  , our system predicted the tis as that from the tair version  <dig> gene annotation, rather than that of version  <dig>  which occurs downstream. similarly, we predict the version  <dig> tis of gene model at5g <dig>   as correct, rather than the revised tis from the version  <dig> model. partial protein sequencing using edman degradation could potentially resolve such ambiguities in the annotations , as might consideration of homologous proteins with matching n-termini whose translation initiations sites had previously been determined; such efforts are beyond the scope of this work, however.

although we were unable to achieve the performance levels of a priori-known cluster-specific parameter deployment with our parameter set indexing schemes, stratified parameter deployment can nevertheless be used effectively in practice, pending certain characteristics of the test data: if these are expected to be moderately enriched for 5'-complete sequences, then static wam-based indexing should recover a larger fraction of true tiss than would homogeneous deployment. however, if complete 5'-coverage is expected to be quite sparse, homogeneous parameter deployment should be utilized instead. this affords a complete prescription of how to most effectively identify tiss in transcript data: 1st-atg would be the best method for use in data sets with a high degree of 5'-completeness, static wam-based pfcwllkr in moderately enriched data sets, and homogeneous deployment of pfcwllkr in data sets likely to contain few 5'-complete sequences.

we have replicated our experiments using a data set based on the most recent genbank annotations for the nematode caenorhabditis elegans , the results of which are similar to those presented here for arabidopsis , suggesting that our method is not specific to plant taxa, and can be used for eukaryotic tis prediction in general. also available as supplementary material are homogeneous parameter deployment-based results for a small set of tis-containing human genes culled from the consensus cds project  <cit> ; these results imply that the system can be utilized for vertebrate taxa, as well.

as a demonstration of metwamer's applicability for post-processing gene structures predicted by separate tools, we refined maize gene annotations generated by the geneseqer spliced alignment program  <cit> .  <dig>  full length maize cdna sequences were obtained from the maize full length cdna project  <cit>  and aligned via geneseqer to a set of  <dig>  bac sequences downloaded from plantgdb  <cit> . these results were post-processed with metwamer's pfcwllkr routine under homogeneous parameter deployment, using parameters trained with arabidopsis data. we considered only predicted protein sequences such that at least one full length cdna supporting its annotation exhibited an overall geneseqer alignment score of at least  <dig>  and the predicted tis occurred in or upstream from the first exon identified by spliced alignment. the resulting set of  <dig>  proteins was aligned against a collection of  <dig>  annotated sorghum proteins downloaded from the phytozome project  <cit>  using blastp. blastp output was inspected using the museqbox program  <cit>  in order to select only those inferred maize proteins of at least  <dig> amino acids in length whose best hit in the sorghum data, also at least  <dig> amino acids long, shared high-scoring segment pairs  of at least 20% identity apiece such that the sum of these non-overlapping hsps was not less than 90% of the length of either sequence. furthermore, at most five amino acids at both the n-and c-termini, for both sequences, were allowed to be disjoint from an hsp. these  <dig>  proteins were then made non-redundant using blastclust with default settings. in summary, the resultant set of  <dig>  maize proteins on  <dig>  distinct bacs identifed by geneseqer in concert with metwamer represents a reliable collection of high-quality, non-redundant full length maize proteins that could not have been identified by geneseqer alone, thereby demonstrating the practical utility of this approach to modern genome annotation projects. our results are available as supplementary data at  <cit> .

we compared annotation results of our pipeline with those achieved by a current state-of-the-art ab initio gene prediction tool, augustus  <cit> . the bac sequences containing our annotated maize genes were fed to the program and processed using its maize-specific parameters. we note that a fair comparison between the two approaches is basically impossible, since the search space probed by pure ab initio gene finders is quite distinct from that explored by spliced alignment annotation systems such as geneseqer+metwamer, so we disregard false positive predictions generated by augustus. in summary, of the  <dig>  maize proteins we identified, augustus correctly predicted  <dig>   tiss and  <dig>  complete gene structures. these results underscore the necessity that a complete and robust gene annotation pipeline should integrate evidence from multiple data sources, gene prediction software and even manual gene curation results, as is achieved by various higher-order systems including augustus+  <cit> , the ensembl pipeline  <cit> , eugéne  <cit> , and jigsaw  <cit> . our efforts to integrate a variety of retrained, state-of-the-art gene finding tools using such systems in the context of various plant genomes will be presented in a forthcoming report.

CONCLUSIONS
metwamer performance results, particularly for pfcwllkr, suggest that the method can be used with good success for the task of annotating tiss in eukaryotes. however, our data are not precisely comparable with those provided by a number of previous studies, e.g.,  <cit> , just as results between those papers are essentially incomparable, as well. this is due to differing experimental designs  and different data sets .

comparing these published methods with our own, using our data and experimental design, was often not practical: the availability of software implementing methods developed for eukaryotic tis prediction per se is very limited at present. among the papers addressing intrinsic tis detection methods, only the atgpr  <cit> , startscan  <cit> , diana-tis  <cit> , tishunter  <cit> , netstart  <cit> , and tis miner  <cit>  systems are described as "available" software. we were only able to utilize the netstart, tis miner, tishunter and atgpr systems to compare against our software system, though we note that it is impossible to re-train any of these programs. startscan is available via a web interface , but an important distinction from our tool is that startscan is for tis recognition in genomic sequences, a much different task than that addressed by metwamer. although not mentioned in its reference paper,  <cit> , we were able to locate a web interface to the diana-tis system at the author's web page . however, documentation for the interface is unavailable, and most prohibitive is that it only allows a pictorial representation of its predictions, which is unrealistic for processing data sets of the scale used in this study. genehackertl is mentioned in  <cit> , but it is not described as being publicly available, nor were we able to locate it in any web-accessible forum.

the paucity of freely available, functioning programs for tis prediction comprises an important gap in the software infrastructure for computational biology. our metwamer package represents a well-documented, extensible, and open source software system that can be modified for differing applications and extended with existing and novel tis prediction methods to support further research in this area; this is, to our knowledge, the first such contribution made to the eukaryotic tis prediction community at-large. there are certain limitations to the existing scope of metwamer, however, which may present opportunities for future work. we have explicitly ignored the possibility of non-aug start codons, although these are known to occur in various eukaryotic organisms  <cit> . also, the system does not explicitly integrate extrinsic information, such as homologous proteins, which is reportedly successful  <cit> ; however, due to evolutionary forces operating on homologous genes, it is possible that translation initiation sites differ, and the use of such information for prediction could be misleading. we have explicitly ignored the possibility of translation initiation proceeding by a re-initiation mechanism, whereby a short orf upstream of the more significant orf is translated, and the ribosome resumes translation at a downstream aug  <cit> . for metwamer, however, this is not a potentially obfuscating phenomena: because the system scans for tiss in a maximal reading frame, there is no possibility to predict a start codon upstream of the significant orf that is succeeded by a stop codon a short distance thereafter. another open problem is the prediction of alternative tiss in various gene structures  <cit> .

the ability to train tis models in a species-specific manner is an important strength of metwamer, because differences in translation initiation processes among distinct taxa are known to occur  <cit> . to the extent that cross-specific tiss are representative of some target species, these could in principle be used as a proxy if species-specific data are not available; the performance of our system in such a scenario will be reported in a forthcoming study in which we refine gene structure annotations of a variety of cereal crop genomes. results presented here also indicate that improvements in tis prediction accuracy are possible when taking the class of potential start-methionines into account. our software readily accommodates these needs, and can be integrated into other gene annotation programs and/or pipelines with straightforward modifications.

availability and requirements
• project name: metwamer

• project home page: 

• operating system: platform independent

• programming language: c

• other requirements: libxml <dig> version 2-6- <dig> or later , and immpractical version  <dig>  or later  – see the metwamer manual page for details.

• license: isc license

• restrictions to use by non-academics: none

authors' contributions
vb suggested the project and advised on the models, experimental design, and manuscript. mes co-designed the models with vb, implemented the software, conducted experiments, and wrote the manuscript.

supplementary material
additional file 1
metwamer.v <dig> . source code for the metwamer package. this version was used to generate data reported in this study.

click here for file

 acknowledgements
this work was supported in part by nsf grant dbi- <dig>  we thank three anonymous reviewers whose comments improved this manuscript.
