BACKGROUND
a primary objective in food microbiology is to identify, quantify, and know the behaviour of foodborne microorganisms. however, the inherent inaccuracies in the enumeration process and the natural variation found in all bacteria populations complicate these tasks  <cit> . in the 1980s, the increase in the incidence of foodborne outbreaks led to a major demand of a safe food supply. at the same time many microbiologists were beginning to accept that traditional microbiological methods to determine food quality and safety were limited by the time needed to obtain results. an alternative is predictive microbiology, which relies upon the development of mathematical models that can predict the growth or decline rates of microorganisms under a given set of environmental conditions  <cit> . in a general sense, a model simplifies a system by using a combination of descriptions, mathematical functions or equations, and specific starting conditions. there are two general classes of models in this context: descriptive and explanatory  <cit> . descriptive, observational, or empirical models are data-driven, and it is difficult to make true predictions from them because they cannot be extrapolated beyond the data used to build them. explanatory, or mechanistic models aim to relate the given data to fundamental scientific principles. many predictive microbiology models have parameters that are related to observed phenomena. excellent reviews and extended discussions about the potential benefits of predictive models can be found in the literature  <cit> . many growth models have been proposed since  <dig>  the classical sigmoid growth functions, especially the modified logistic and gompertz equations, must be mentioned  <cit> . over the last decade, a new generation of models have been developed: baranyi model  <cit> , hills model  <cit> , buchanan model  <cit> , and the heterogeneous population model  <cit> .

current available approaches  reduce the bacterial growth variability to a single curve, and  sometimes, under different environmental conditions, the models offer poor fits in some regions of the growth curve. instead of using standard primary models, the method presented in this paper relies on nonparametric estimation of the trend of the growth curve that incorporates random fluctuation in time as well as biological variability of microorganisms. nonparametric methods do not assume a prespecified functional form  for the viable count or absorbance. the predictions based on these methods are model-free, in the sense that there is no need to build a different mathematical model for each specific setup. a method for constructing simultaneous prediction bands  for the bacterial growth is proposed. this method accounts for random fluctuation in time as well as for biological variability. this is done without imposing inflexible parametric restrictions used in parametric models. the method lets the data speak by themselves. it provides a nonparametric estimation of the best-fit line and nonparametric prediction bands, constructed using the bootstrap. these bands are designed to contain all the points of a future growth curve with a prescribed high probability, typically 95%. nevertheless, the interest here is on bacterial growth prediction, rather than in bacterial growth modelling. on the other hand the traditional effect of secondary models could be incorporated into the proposed method via some extension of it.

it is not the purpose of this paper to model the growth of a microorganism along a wide range of environmental conditions. that work can be done using available databases. the objective is to propose and apply a new model to any sigmoid curve . to our knowledge, the procedure proposed in this paper has not been considered before for these purposes. schaffner  <cit>  used a statistical bootstrapping technique  to simulate growth rate measurements from a single set of experiments, with the objective of estimating their variance. oscar  <cit>  used a prediction interval to model the variation of the growth of salmonella in different chicken samples. within this context, the aim of the present study was to apply a random effect multiplicative heteroscedastic model to show its behaviour with absorbance or viable count data, and also to explain the dynamics of bacterial growth of listeria monocytogenes under different conditions of temperature, ph, and nacl. the bootstrap method and an iterative procedure are also proposed. the concept of a prediction band for microbial growth is used.

methods
microorganism and inoculum preparation
the strain used in this study was a listeria monocytogenes strain previously isolated from poultry meat . the strain was reconstituted in brain heart infusion  and incubated at 37°c for  <dig> h.

determination of growth curves and linear range
bottles with  <dig> ml of bhi were prepared. combinations of different values of ph and percentages of nacl were considered. the ph value was adjusted in each bottle to  <dig> ,  <dig> ,  <dig>  and  <dig>  with hcl and naoh. the percentage of nacl was adjusted to  <dig> ,  <dig> ,  <dig> , or  <dig> . nine ml from each bottle were transferred to tubes and sterilized by autoclaving at 121°c for  <dig> min. these tubes were used to dilute the inoculum of the microorganism previously activated in bhi at 37°c for  <dig> h . two hundred μl from dilution 10- <dig>  were distributed into 96-well micro-titer plates and immediately incubated at  <dig>   <dig>   <dig>  or 42°c on a microplate reader  for 15- <dig> h. twenty replications of each combination of temperature, ph, and nacl were done. two hundred μl of bhi as control test was also distributed into the microplate wells and incubated at the same conditions. the absorbance measurements were done at a wavelength of  <dig> nm and taken every  <dig> min. the cultures were inoculated from the stationary phase because more reproducible results can be obtained than from the log phase  <cit> .

the linear range was determined by plotting absorbance vs. cfu/ml. the population of l. monocytogenes from bhi cultures was enumerated in pca  at 31°c for  <dig> h , and it was diluted in bhi at 1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>  and 1/ <dig>  aliquots of  <dig> μl from each bacterial dilution were inoculated into  <dig> wells of the 96-well microtiter plates to measure their absorbance. non-inoculated bhi was placed in  <dig> wells of the same microtiter plate. absorbance was read in the microplate reader  at  <dig> nm. the threshold of detection, corresponding to the bacterial concentration that involves a significant change of the absorbance, was observed when the measured values exceeded  <dig> , which corresponded to ca.  <dig>  ×  <dig> cfu/ml. this value was in the linear range of the calibration curve.

statistical methods
in view of the shapes of the bacterial growth curves, an experimental design model has been considered. some simple method for parameter estimation has been used. a bootstrap resampling plan has been designed in order to construct simultaneous prediction intervals for the bacterial growth curves.

random effect multiplicative model
the following random effect multiplicative heteroscedastic linear model has been considered:   

where i is the number of wells, j is the number of sampled instants along the time range and yij is the absorbance for well i at time j. the basic assumptions for this model are the following. the terms of the well component, αi, account for a random fluctuation factor, with mean  <dig>  the actual value of αi accounts for an overfitting or an underfitting of the mean absorbance curve along time. its variance is  and its distribution is assumed to be normal. the time mean effects, μj, are unknown values that model the overall well mean absorbance along time. the positive constants  are the absorbance variances for the j-th time instant and the errors, εij, are standard normal random variables that account for experimental error. as a consequence the yij are normally distributed with mean μj and variance . model  is an extension of a principal mixed effect model .

parameter estimation
a very simple approach has been adopted for parameter estimation. the method of moments has been used to obtain estimators for the mean  and the variance () time effect, as well as for the variance of the well random effect ():  

where • denotes average along the pertaining index,  

in practice, outliers may seriously affect the estimators  and  above. for this reason, robust versions of these have been used:  and , where mad = median  and me = median  and Φ is the standard normal cumulative distribution function. these robust versions are based on the fact that, for a normal distribution with mean μ and standard deviation σ, the following relationship, between its dispersion and its mad, holds: σ = mad·Φ- <dig> .

boostrap resampling plan
in order to construct simultaneous prediction intervals a bootstrap resampling method  has been considered to mimic the joint probability distribution of the random vector . to that aim, the following procedure has been designed:

 <dig>  given the original absorbance sample, yij , compute the estimations ,   and  detailed in the previous subsection.

 <dig>  fix the number of bootstrap resamples, b, typically a large number .

 <dig>  for every b =  <dig>   <dig> ..., b, draw bootstrap random well effect replications, , from a normal distribution with mean  <dig> and variance , and the bootstrap version of the experimental error, ,  from a standard normal distribution.

 <dig>  using the bootstrap analogue of the well effect (), the bootstrap random errors () and the estimators from the original sample , the bootstrap version of the absorbance is easily defined via :  

the sample of simulated vectors   can be used to approximate the joint distribution of the random vector , which is needed to construct the prediction band.

bootstrap prediction band
since the number of sampled time instants is usually moderate or high, correction for multiple prediction intervals is an important issue. given an initial prediction level,  <dig> - α, for a small α , marginal -prediction intervals, , for every time instant j =  <dig>   <dig> ..., j can be easily constructed. their endpoints, ℓj and uj, are the th and th ordered statistics of the resample , where ⌈x⌉ denotes the integer part of x. in other terms, ℓj and uj, are the values that are in positions  and , when sorting the bootstrap resample in an increasing order.

individual prediction intervals have approximately the nominal coverage probability  when they are considered separately . however, the probability that the whole growth curve is included in the band depicted by the whole set of intervals is much smaller. this is known as the multiple range testing problem  or the false discovery rate in high dimensional statistical problems .

a classical way to correct for multiple testing is the popular bonferroni approach . in a hypothesis testing context, the idea behind this approach is to consider a new significance level, , and compute individual tests using this new level. the resulting multiple test has a multiple level which is much closer to the desired α. however, it is well known that the bonferroni approach is a conservative procedure. in our context, this means that the joint coverage probability of the prediction band would be larger than the desired  <dig> - α.

starting from the conservative bonferroni approach and the anticonservative individual testing approach, the following algorithm finds an approximate -prediction interval, with a given approximation error δ :

 <dig>  fix  and . fix the iteration number, k =  <dig> 

 <dig>  compute 

 <dig>  use the bootstrap resamples to compute individual predictions intervals with ,  and  prediction levels.

 <dig>  compute with the same bootstrap resamples, the proportion of simulated growth curves that are included in each of these confidence bands. these proportions satisfy ,  and 

 <dig>  if , then define  and . otherwise define  and .

 <dig>  stop at step k if . otherwise increase k in one unit and repeat steps 2- <dig> 

the final approximate  simultaneous prediction intervals are those obtained for level  in the last iteration.

RESULTS
absorbance results from the combination of ph  <dig>  and  <dig> % of nacl at all temperatures were eliminated for subsequent calculations, since no growth curve was observed along the study period. in order to show the prediction bands, several scenarios for the temperatures have been considered. temperatures of  <dig> and 26°c could be defined as "room temperatures", and  <dig> and 42°c were selected as "highly abusive temperatures".

the robust version of the prediction bands, presented in the previous section, for ph  <dig>  and  <dig> % of nacl at  <dig> and 42°c with α =  <dig>  are shown in figure  <dig>  experimental absorbance data obtained under different environmental conditions are shown. as expected with the selected confidence , the inclusion of the vast majority of the absorbance curves within the bootstrap prediction bands was observed. the bands for absorbance sigmoid curves are narrower during the first part of the curves , that is, between  <dig> and  <dig> h at 22°c, and between  <dig> and  <dig>  h at 42°c, approximately; and they are wider to the right of the inflection point: from  <dig> h onwards at 22°c, and from  <dig> h onwards at 42°c. a wider band was observed at 42°c than at 22°c over the inflection point. similar patterns have been obtained for  <dig> and 38°c . the narrow initial zone of the band is between  <dig> and  <dig> h at 26°c and between  <dig> and  <dig>  h at 38°c. from  <dig> h onwards at 26°c and from  <dig> h onwards at 38°c, the bands are wider and arrive to the upper horizontal asymptote.

automated measures are commonly used to estimate bacterial growth parameters. unfortunately, little information is obtained on the lag phase because the change in the physical properties of a culture is detectable only at high cell concentrations  <cit> . in the present study the new model has been applied to sigmoid absorbance  curves. however, this technique could be equally applicable to viable count data or any other unit of measure. thus, showing the applicability of the model, the previously used absorbance data has been transformed into viable counts using the linear range formula . baranyi and roberts  <cit>  suggested that the linear calibration function has to be established over a complete matrix of environmental variables. however, a calibration linear range obtained under optimal conditions gives enough information for its application to a complete range of environmental variables. in order to study properly the characteristics of the microorganisms, there is a need to know their general behaviour. to study the correlation between an automatic measure and the viable count every time the conditions change requires a big effort. following the results of robinson et al.  <cit> , the cells were initially in a similar physiological state. therefore, baranyi and roberts  <cit>  stated that for cultures having identical physiological states at inoculation and being cultivated under constant  temperatures, the relationship between the lag time and the maximum specific growth rate is maintained. since the purpose of the present work is to show the prediction bands rather than to study in depth the modelling of the data , a linear relationship was used from the optimal conditions for l. monocytogenes at 31°c. the transformation implies that some of the first points from the absorbance curve gives negative values that, obviously, represent points out of the linear range. as it has been stated before, the linear range starts with an absorbance value of  <dig> . this value corresponds with the end of the lower horizontal asymptote , so little data has been lost in the transformation from absorbance to viable counts. those points have not been considered for further calculations. all positive values  have been introduced in the model and it has been rerun.

the viable count prediction bands for ph  <dig>  and  <dig> % of nacl at  <dig> and 42°c, and for ph  <dig>  and  <dig> % of nacl at  <dig> and 38°c are shown in figures  <dig> and  <dig>  respectively. as expected the vast majority of the growth curves were inside the bootstrap prediction bands. the difference between both temperatures  <dig> and 42°c is very clear because the same band width is observed after  <dig> h at 22°c and after  <dig> h at 42°c . the variability of viable count curves increases at the end of the experiment. prediction bands reflect the variability increasing the width in that area. the same situation would be observed during the first part of the curves if the variability was greater. since the original data come from turbidimetric technique, the variability is lower that it would has been from plate counts. the band width is greater at 42°c suggesting that under less favourable environmental conditions the prediction bands reflect the increasing variability derived from that conditions. under more favourable conditions  the band width is smaller. obviously the adverse conditions have an influence on the microorganisms, and it is reflected in the absorbance curves and, of course, in the viable count curves. the prediction bands reflect those influences and trends, helping in the interpretation of the biological meaning of the curves obtained experimentally.

discussion
no standard primary model has been applied to the experimental data. it is not the aim of this study. multiple parametric models for l. monocytogenes and l. innocua in different media under several environmental conditions have been published  <cit> . moreover, the behaviour of this microorganism under different environmental conditions can be searched with the combase , a database of microbial responses to food environments. this database was preceded by two independent, but similar initiatives: the food micromodel  , and the pathogen modeling program   <cit> . the fmm is no longer in operation, but the pmp can be consulted and downloaded from its web page. it provides the upper and lower confidence limits indicating the variation in the predictions at a confidence level of 95%. on the other hand, well-known curve fitting software tools are the microfit software tool  and the dmfit dynamic modelling excel add-in  <cit> . moreover, the seafood spoilage predictor  software  <cit>  includes microbial growth models for seafood products.

it is important to note that the exponential phase of growth curves is included within the prediction band of microbial growth. lag and exponential phases are the most studied in food microbiology, and the most used in predictive microbiology research. their biological significance is determined by the time needed by the microorganisms to adapt their metabolism routes to the surrounding media and to start the exponential growth until the maximum population is reached in that environment. so, it is extremely important that these growth phases are included within the prediction band of microbial growth.

unfortunately, the use of absorbance makes difficult the investigation of the lag time. moreover, the transformation of absorbance data to viable count data eliminated the first points since they are not in the linear relationship range between optical density and viable counts. however, a good view from the inflection point onwards can be obtained. if a complete viable count curve were introduced in the model, all phases of the growth curve would be obtained and included within the prediction band.

microbiological data provides little insight into the relationship between physiological processes and growth, and the use of mathematical models is a way to link them. in its simple form a mathematical model is just a mathematical description of a process  <cit> . many growth models have been proposed since  <dig>  they generally differ on how precisely they describe the microorganism growth phases.

sigmoid models were used to describe the increase of the bacterial cell density vs time. the logistic model and the modified gompertz model should be mentioned among them  <cit> . these two models were not initially formulated for describing the microbial growth, but they were adapted and reparameterized. baranyi et al.  <cit>  proposed a less empirical growth model based on a differential equation. a new version of the model was later developed  <cit> .

hills and wright  <cit>  proposed a compartmental model. the first compartment describes the evolution of all chromosomal material vs time, and the second compartment describes the evolution of all nonchromosomal material vs time. buchanan et al.  <cit>  discussed that the transition between the lag phase and the exponential phase is due to the inter-cell variability, and they assumed that this variability is small. they proposed a model with an abrupt transition between those growth phases. mckellar  <cit>  proposed a compartmental model based on the assumption that within a bacterial population freshly inoculated in a rich medium, some cells will grow and some will never grow.

baranyi  <cit>  published a population-structured model assuming that the bacterial population could be divided into cells still in the lag phase and cells in the exponential phase. the author assumed that cells transform from the lag to the exponential phase at a constant rate. recently, mckellar and knight  <cit>  and mckellar  <cit>  developed two other models.

baty and delignette-muller  <cit>  compared some of these models in terms of biological meaning, mathematical definition and statistical fitting properties. lópez et al.  <cit>  evaluated the suitability of several mathematical functions  for describing microbial growth curves. van impe et al.  <cit>  proposed a novel class of microbial growth models in contrast with the currently used logistic type models. the novel model class explicitly incorporates nutrient exhaustion and/or metabolic waste product effects.

each microorganism can have different behaviour under the same environmental conditions, but it has different ways to survive depending on  the surrounding media and its nutrients,  the number of microorganisms that constitute the initial population,  the communication among the individual members of the population , and finally,  the probability that the microorganism has to survive alone in a favourable or unfavourable environment.

primary models do not explicitly incorporate the biological variability. when applied to a set of bacterial curves these models reduce to a single curve defined by some kinetic parameters. if more experiments are carried out under the same environmental conditions, the new curves will never adjust perfectly to the primary model. the different behaviour of each cell of listeria monocytogenes inside a well has its own influence on the growth kinetics of the population. thus, the growth curve obtained from each well is different because of that biological variability. however, we used nonparametric methods  and developed a prediction band  with the property that the 100·% of the new curves will be inside this band. obtaining a prediction band using a primary model has been the aim of this study. the variability has been included in the model  with the well random effect and the experimental error. the combination of non-parametric methods with bootstrap techniques has been applied. we used a prefixed coverage of 95%, although different levels could be used. a 95% prediction band means that with a probability of  <dig>  a new whole curve  would be within it. this is acceptable from a microbiological point of view, because the inherent biological variability will never permit the inclusion of all growth curves within a band. obviously, the narrower the band  and the higher the coverage probability, the better. unfortunately, those two variables  work in reverse order. that is, if the coverage is increased , the band is going to be wider , and vice versa. 

provided by the prism program , oscar used a 95% prediction interval to model the variation of salmonella typhimurium dt <dig> growth in heterogeneous food matrixes: ground chicken breast meat  <cit> , chicken frankfurters  <cit> , and chicken skin  <cit> . the intervals were used succesfully to capture experimental error, the uncertainty of the curve fit, and the scatter of the growth data around the curve  <cit> . this author developed primary, secondary, and tertiary models for predicting the growth of the microorganism. model verification and validation was done using 95% prediction intervals. these intervals are construted in order to contain 95% of future cfu data . however, no secondary or tertiary models were used in the present work because it was not the aim of this study. moreover, the target of our approach is different to that of the prediction intervals computed in those papers. our prediction band would include 95% of future new experimental growth curves .

it is important to note that a prediction band with a coverage probability of  is not the band obtained by joining the corresponding  prediction intervals at observed times, because the probability that a new whole curve is within such a band would be smaller that . there are several methods in the literature trying to correct this problem and to obtain a band with coverage probability , for example  <cit> . however, it has been demonstrated that bonferroni correction does not work properly, because it is too conservative . in the present paper, a new iterative technique is proposed to achieve an almost exact  prediction band. this technique was previously described in detail in the bootstrap prediction band subsection. we performed an experiment to compare our approach with the one using the band obtained by joining the corresponding  confidence intervals at observed instants. the coverage probabilities in each of the individual intervals and the simultaneous coverage probability for the band have been computed when using pointwise 95% prediction intervals without any further correction. we also computed the simultaneous coverage probability of the bands proposed in this paper with the new method. it is worth noting that these percentages are estimated with low accuracy, since these estimations are only based on  <dig> observed curves. the conditions are those shown in figures  <dig>   <dig>   <dig> and  <dig>  it was clearly observed that, although the coverage probabilities of the individual intervals are close to 95%, the simultaneous coverage of the band is drastically reduced if no multiple range correction is performed. however, the prediction bands proposed in this paper exhibit simultaneous coverage probabilities much closer to 95%.

the preceding estimation procedure and bootstrap simultaneous prediction intervals algorithm have been applied to a sample of bacterial growth curves corresponding to listeria monocytogenes, and a prediction band for microbial growth has been computed. listeria monocytogenes has been recognized as an important foodborne pathogen that causes listeriosis. outbreaks of listeriosis have been associated with milk, cheese, vegetables and salads, and meat products  <cit> . the microorganism is particularly problematic for the food industry because it is widespread in the environment  <cit> . foods are heterogeneous systems because of  the wide range of types  and  their internal differences. a band of microbial growth provides a safer estimation than a curve for the bacterial behaviour under different conditions. this fact could be very useful from the public health point of view. with the application of this technique, the biological variability of the microorganism would be considered in the elaboration of the band, a safer knowledge of the microorganisms' behaviour could be obtained, and the risks of wrong microbial parameters is minimized. the risk increases when the result of this application is an underestimation of the kinetic growth parameters. it has to be also noted that the prediction bands obtained must be only considered for the environmental conditions used in the study. the same argument is applied to other primary models.

from the statistical viewpoint, the normality assumption made on the random effect  and the error  can be relaxed using semiparametric models that incorporate adaptive estimation of the parameters using preliminary nonparametric density estimation  <cit> . this very time consuming approach will be the object of future research.

a matlab function called remhm.m, implementing the estimation for the random effect multiplicative heteroscedastic model and the bootstrap algorithm for constructing simultaneous prediction intervals can be found in additional file  <dig>  a file containing some information about the program remhm.m is in additional file  <dig>  moreover, files with the absorbance data used in this paper can be found in additional file  <dig>  all these files are also available at the web page http://dm.udc.es/modes/?q=en/node/ <dig>  

additional effects, as those coming from ph or temperature, could be added directly to the model presented in . this would be a hybrid approach incorporating the roles of classical primary and secondary models at a time. although this approach may be useful for modelling bacterial growth as a function of time, biological variability and environmental variables, it seems not appropriate for prediction bands. when constructing a prediction band the interest is in finding some limits for the growth curve, with high probability, for some particular values of environmental variables, as ph or temperature. this is the reason why this hybrid model is not analyzed in this paper, focused on prediction bands.

for a semiparametric approach, like the one presented in this paper, it is not obvious to define the analogue of the classical parameters used in bacterial growth: inoculum, lag, maximum growth rate and maximum population density. the definition of these values is more or less straightforward in many parametric models like gompertz, due to the restrictions imposed by the model. extension of this definitions to nonparametric or semiparametric models like the one presented in this paper will be the object of future research.

CONCLUSIONS
in this article, we proposed a random effect multiplicative heteroscedastic model to explain the dynamics of bacterial growth of listeria monocytogenes under different conditions of temperature, ph, and nacl. instead of using standard primary models, based on parametric fits, like the gompertz model, for example, the method presented in this paper relies on nonparametric estimation of the trend of the growth curve that incorporates random fluctuation in time as well as biological variability of microorganisms. using a bootstrap resampling method and an iterative algorithm, a procedure for constructing simultaneous prediction bands for the bacterial growth is proposed. the basic steps to construct these bands are the following.  use the observed bacterial data to estimate the unknown parameters in the random effect multiplicative heteroscedastic linear model given in .  simulate several thousands of artificial bacterial growth curves  from model  with estimated parameters.  use these boostrap resamples to obtain a monte carlo approximation of the 95% simultaneous prediction band. classical approaches in this context reduce the bacterial growth variability to a single curve and sometimes offer poor fits in some regions of the growth curve. the method considered in this paper gives more flexiblity and the prediction bands incorporate the biological variability of the microorganism. the procedure can be applied to any sigmoid curve  and to different microorganism. a matlab program implementing this procedure has been developed by the authors.

authors' contributions
all authors conceived the project. ejq carried out the laboratory studies and the preparation of the microbial data. rc and mff designed the model and the algorithms presented in the manuscript. mff implemented the algorithms and performed the computational experiments. all authors analyzed the results and were involved in manuscript preparation. all authors read and approved the final document.

supplementary material
additional file 1
program for computing the prediction bands. program for computing the prediction bands with the method described in the paper 

click here for file

 additional file 2
information about matlab program remhm.m. file containing some information about the program remhm.m

click here for file

 additional file 3
absorbance and viable count data. compress file, containing the data  to obtain the bands shown in figures  <dig>   <dig>   <dig> and  <dig> 

click here for file

 acknowledgements
this work was partially supported by mec grant mtm2008- <dig>  for the first two authors and by xunta de galicia grant pgidit07pxib105259pr for the second author. ejq was supported through the program of support for the professors's research activity, uab. the authors thank two referees for constructive comments that improved the presentation of this article.
