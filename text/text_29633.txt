BACKGROUND
in its quest for survival the bacterium staphylococcus aureus secretes α-hemolysin monomers that bind to the outer membrane of susceptible cells, where seven such units can oligomerize to form a water-filled transmembrane channel  <cit> . the channel can cause death to the target cell by rapidly discharging vital molecules  and disturbing the membrane potential.

suspended in lipid bilayer  the α-hemolysin channel becomes a sensor when large molecules interact with the nanopore and modulate uniform ionic flow through the channel. driven by transmembrane potential, single stranded dna or rna molecules translocate through the nanopore  <cit> , while more complex hairpins either unzip and translocate  <cit>  or toggle in the channel's vestibule  <cit>  . the durations of ionic flow blockade events in these experiments are important signatures of interacting nucleic acid fragments composition  <cit>  or in certain cases characterize the molecular length  <cit> .

two distinct approaches of duration modelling have been proposed for hmm framework by speech recognition community, based on explicit duration modelling, which is normally implemented with histograms or parametric distributions, and implicit modeling based on set of geometrically distributed self-recurring nodes  <cit> . the most common way of implementing explicit duration model is generalized hidden markov model , where each state can emit more than one symbol at a time  <cit> . following  <cit> , the optimal ghmm parse could be expressed by the following equation

 φoptimal=arg⁡max⁡φp=arg⁡max⁡φpp=arg⁡max⁡φp=arg⁡max⁡φpp=arg⁡max⁡φ∏i=1npeptpd
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaeqbdaaaaeaaiigacqwfgpgzdawgaawcbagaem4ba8maemicaanaemidaqnaemyaakmaemyba0maemyyaemaemibawgabeaaaoqaaiabg2da9aqaamaaxababagagiyyaemaeiocainaei4zacmagiyba0maeiyyaemaeiieaghaleaacqwfgpgzaeqaaogaemiuaalaeiikagiae8nxdymaeiifawnaem4uamlaeiykakcabaaabagaeyypa0dabawaacbeaeaacygghbqycqggybgccqggnbwzcyggtbqbcqgghbqycqgg4baeasqaaiab=z8ambqabagcdawcaaqaaiabdcfaqjabcicaoiab=z8amjabcycasiabdofatjabcmcapaqaaiabdcfaqjabcicaoiabdofatjabcmcapaaaaeaaaeaacqgh9aqpaeaadawfqaqaaigbcggahjabckhayjabceganjgbc2gatjabcggahjabciha4bwcbagae8nxdygabeaakiabdcfaqjabcicaoiab=z8amjabcycasiabdofatjabcmcapaqaaaqaaiabg2da9aqaamaaxababagagiyyaemaeiocainaei4zacmagiyba0maeiyyaemaeiieaghaleaacqwfgpgzaeqaaogaemiuaalaeiikagiaem4uamlaeiifawnae8nxdymaeiykakiaemiuaalaeiikagiae8nxdymaeiykakcabaaabagaeyypa0dabawaacbeaeaacygghbqycqggybgccqggnbwzcyggtbqbcqgghbqycqgg4baeasqaaiab=z8ambqabagcdaqewbqaaiabdcfaqnaabaaaleaacqwglbqzaeqaaogaeiikagiaem4uam1aasbaasqaaiabdmgapbqabagccqgg8bafcqwgxbqcdawgaawcbagaemyaakgabeaakiabcycasiabdsgaknaabaaaleaacqwgpbqaaeqaaogaeiykakiaemiuaa1aasbaasqaaiabdsha0bqabagccqggoaakcqwgxbqcdawgaawcbagaemyaakgabeaakiabcyha8jabdghaxnaabaaaleaacqwgpbqacqghsislcqaixaqmaeqaaogaeiykakiaemiuaa1aasbaasqaaiabdsgakbqabagccqggoaakcqwgkbazdawgaawcbagaemyaakgabeaakiabcyha8jabdghaxnaabaaaleaacqwgpbqaaeqaaogaeiykakcaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgubgba0gaey4diunaaaaaaa@c4a1@ 

where ϕ is a parse of the sequence consisting of a series of states qi and state durations di,  <dig> ≤ i ≤ n, with each state qi emitting subsequence si of length di, so that the concatenation of all s0s <dig> ... sn produces the complete output sequence s. pe denotes the probability that state qi emits subsequence si of duration di. pt is ghmm transition probability from state qi- <dig> to state qi and pd is the probability that state qi has duration di. the primary objective, expressed in , is to combine probability returned by content probabilistic model  with duration probability for optimal parse. the ghmm implementation, as well as hmm-with-duration approach mentioned in  <cit> , require explicit assignment of duration histogram to run viterbi decoding.

when we try to classify single dna base pair by nanopore ionic flow blockade signal processing  <cit> , we frequently have to deal with a sequence of blockades resulting from complex molecular interactions with unknown states. for this reason, we are interested in de novo learning of emission content and duration distributions corresponding to these stationary blockade states. in this study we research several approaches to the problem of duration and content sensor learning in the context of nanopore ionic flow blockades analysis.

RESULTS
explicit duration model learning experiment
the objective of this experiment was to evaluate the ability of a randomly initialized explicit duration hmm , as described , to learn the original duration phenomena present in artificial data. we use the expectation maximization  training procedure, as discussed , to iteratively reinforce the network structure to match the test data set topology. for the model training purposes we have generated  <dig> sequences of  <dig>  emissions each with the maximum state durations of  <dig> according to protocol discussed .

first, we learned randomly initialized geometric model, as described , for  <dig> iterations to reliably recover the two major gaussian emitting components and roughly estimate the average duration for two states. an accuracy of  <dig> % has been achieved by viterbi decoding  on the learned geometric duration model for the test set, which constitutes  <dig> % performance of the original explicit dhmm run on the same test set. here and further we identify accuracy as the ratio of correctly decoded emissions to the entire number of emissions in the given time series

 accuracy=tp+tntp+fp+tn+fn,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgbbqqcqwgjbwycqwgjbwycqwg1bqdcqwgybgccqwghbqycqwgjbwycqwg5bqecqgh9aqpdawcaaqaaiabdsfaujabdcfaqjabgucariabdsfaujabd6eaobqaaiabdsfaujabdcfaqjabgucariabdaeagjabdcfaqjabgucariabdsfaujabd6eaojabgucariabdaeagjabd6eaobaacqggsaalaaa@4aa0@ 

where true positives , true negatives , false positives  and false negatives  are among the classified data points.

we use the recovered gaussian emissions and initial probabilities to initialize the explicit dhmm, and we use learned average state duration as the expected prior for the explicit duration histogram initialization. we freeze the emission gaussian probability density functions  so that they don't change. upon convergence of the explicit dhmm to a local likelihood maximum we record  <dig> % viterbi decoding accuracy on the test set, which is  <dig> % of the original explicit dhmm performance, i.e. we were able to recover the duration phenomena with performance almost identical to the original explicit dhmm. figure  <dig> shows histograms obtained for the state durations. although their shape approximates the original duration pdf pretty well, the recovered histograms experience substantial abrupt and unwanted variations. another shortcomings of this duration learning strategy is that it is extremely slow and requires simultaneous estimation of large number of parameters. therefore, in the next section we present an approach based on a convolution chain of geometric duration states.

convolution of states learning experiment
in this experiment we construct aggregate model states as convolution chain of three geometric distributions. the convolution chain for identical geometric distributions can be represented as a bell-shaped negative binomial discrete pdf, as discussed .

the resulting convolution model trained with em algorithm  on an artificial nanopore signal with maximum state duration of  <dig> of  <dig> sequences  <dig>  emissions each, generated according to protocol discussed , is shown in figure  <dig>  in this learning experiment we use known emissions n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaat0uy0hwztfgdpnwy1egaryqthrhal1wy0l2yhvdaiqaacqwfnevtaaa@383a@ and n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaat0uy0hwztfgdpnwy1egaryqthrhal1wy0l2yhvdaiqaacqwfnevtaaa@383a@, that do not change in the process of learning, and initialize the prior probabilities and transitions with the expected state durations. interestingly, direct use of the learned convolution model in viterbi decoding produces reconstruction fidelity substantially inferior to the simple geometrically-distributed model. the convolution chain has full power only for forward-backward procedure  <cit>  for likelihood estimation  and does not work for representing duration phenomena in case of viterbi decoding. therefore, we use the histograms shown in figure  <dig> to initialize explicit dhmm transitions. such hybrid explicit dhmm achieves on viterbi decoding accuracy of  <dig> %, which is  <dig> % performance of original explicit dhmm on the same test set. therefore, by learning chains of convolving geometrically-distributed components we achieve similar or better performance as compared to direct learning of explicit dhmm, in much shorter time period. the experiment clearly demonstrates the ability of a convolution chain to learn the complex duration phenomena in the data, outperforming the simple geometric duration model. convolving states cannot generate or model duration phenomena shorter than the chain length , therefore the number of convolving states should be used conservatively.

performance of viterbi decoding depending on blockade maximum duration
we run viterbi decoding for the original models presented  with results shown in table  <dig>  in case of the geometric model we used transitions assigned according to simple maximum likelihood formula  estimated on the test set emissions of the original explicit dhmm.

the geometric distribution model runs faster, but decoding performance is always inferior compared to the explicit dhmm. the geometric hmm appears to be simple and crude approximation to the duration signal. explicit dhmm runs d times slower than simple geometric model, but produces superior results to any other types of implementations, given the exact duration histogram. the higher the maximum state duration d and the longer the average phenomena duration is, the better decoding quality we can obtain for all the models.

learning durations on the real blockade signal
here we analyze the ionic flow blockade signal resulting from the nine base pair "upper level toggler" hairpin dna molecule cgtggaacgttttcgttccacg, generated according to protocol described in  <cit>  . due to its unique sequence in the stem region and its interactions with the channel's vestibule it produces a rich signal   <cit> .

from the physical perspective the hairpin molecule can undergo different modes of capture blockade, such as intermediate level , upper level , lover level  conductance states and spikes   <cit> . when a  <dig> bp dna hairpin initially enters the pore, the loop is perched in the vestibule mouth and the stem terminus binds to amino acid residues near the limiting aperture. this results in the il conductance level. when the terminal basepair desorbs from the pore wall, the stem and loop may realign, resulting in a substantial current increase to ul. interconversion between the il and ul states may occur numerous times with ul possibly switching to the ll state. this ll state corresponds to binding of the stem terminus to amino acids near the limiting aperture but in a different manner from il. from the ll bound state, the duplex terminus may fray, resulting in extension and capture of one strand in the pore constriction resulting into short term s state. the allowed transition events between these levels il ⇔ ul ⇔ ll ⇔ s can happen at any time during the analysis procedure.

for the purposes of de novo emission levels detection we have learned the mixture of six gaussian  components  on the raw ionic flow blockade signals. em learning step converged to the following mixture of six gaussian components

 p= <dig> ×n+ <dig> ×n+ <dig> ×n+ <dig> ×n+ <dig> ×n+ <dig> ×n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaegadaaabagaemicaanaeiikagiaemieagnaeiykakcabagaeyypa0dabagaegimaajaeiola4iaegomaijaegomaijaegioagjaey41aq7enfgdovwbhrxajfwnhbqeg0uy0hwztfgdpnwy1aaceagae8xdx7kaeiikagiaemieagnaeiifawnaegynaujaegomaijaeiola4iaegomaijaegonayjaeiilawiaegymaejaeiola4iaegymaejaegioagjaeiykakiaey4kasiaegimaajaeiola4iaegimaajaegioagjaey41aqrae8xdx7kaeiikagiaemieagnaeiifawnaegonayjaegomaijaeiola4iaeg4mamjaegynaujaeiilawiaegymaejaeg4mamjaeiola4iaegynaujaeg4nacjaeiykakiaey4kasiaegimaajaeiola4iaegymaejaegioagjaey41aqrae8xdx7kaeiikagiaemieagnaeiifawnaegynaujaegynaujaeiola4iaegimaajaegynaujaeiilawiaegonayjaeiola4iaegymaejaeg4mamjaeiykakcabaaabagaey4kascabagaegimaajaeiola4iaegimaajaegyoakjaey41aqrae8xdx7kaeiikagiaemieagnaeiifawnaeginaqjaegomaijaeiola4iaegomaijaegyoakjaeiilawiaeg4mamjaeiola4iaegyoakjaegomaijaeiykakiaey4kasiaegimaajaeiola4iaegomaijaegioagjaey41aqrae8xdx7kaeiikagiaemieagnaeiifawnaeg4mamjaegioagjaeiola4iaegioagjaegomaijaeiilawiaegymaejaeiola4iaegonayjaegioagjaeiykakiaey4kasiaegimaajaeiola4iaegymaejaeginaqjaey41aqrae8xdx7kaeiikagiaemieagnaeiifawnaegynaujaegyoakjaeiola4iaegioagjaeg4nacjaeiilawiaegymaejaeiola4iaegioagjaeg4mamjaeiykakcaaaaa@c4c3@ 

as could be seen in figure  <dig>  where n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaat0uy0hwztfgdpnwy1egaryqthrhal1wy0l2yhvdaiqaacqwfnevtaaa@383a@ is normal pdf.

we took four primary components from the recovered mog  and applied them as emissions to the convolution model  for four aggregate states. we learn the model on the ionic flow blockade signal of size  <dig>  samples with the recovered topology shown in figure  <dig>  the graph of transition nodes connecting the learned aggregate states appears to be sparse with nonzero transitions . this analysis shows that not all transitions between molecular interaction states are allowed. interestingly enough, the second state has transitions to other three states. according to the interaction physical model discussed above the molecule should bounce back and fourth between the deeper blockade levels, thus components n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaat0uy0hwztfgdpnwy1egaryqthrhal1wy0l2yhvdaiqaacqwfnevtaaa@383a@ and n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaat0uy0hwztfgdpnwy1egaryqthrhal1wy0l2yhvdaiqaacqwfnevtaaa@383a@ dominate. the recovered geometric distribution of the blockade events , indicate that upper level toggler molecule has constant state-dependent probability to dissociate from one interaction state and transit to another physically feasible conformation.

aggregate states  <dig>   <dig> and  <dig> converged to pure geometric distributions with no apparent bell-shaped duration phenomena, as could be seen in figure  <dig>  however, as could be seen in figures  <dig> and  <dig>  the long-tailed distribution does not fall nicely in the framework of geometric duration. the geometric durations learned on these long-tailed distributions does not approximate well neither the initially sharp peak nor the long tail in duration histograms and therefore should really be treated as multimodal distribution approximated by mixture of geometric components. on the other hand, the histograms shown in figures  <dig> and  <dig> fall perfectly into framework of geometric pdf.

we improve the histograms for multimodal long-tailed distributions by training the mixture of two convolution chains. resulting convolution mixture generative histograms present the original phenomena much better as could be seen in figure  <dig>  upon introduction of convolution mixture the model logarithmic likelihood , given training sequence, has increased from - <dig>  to - <dig>  for the fully trained topologies which indicated better model fit to data. mixing more than two components per aggregate state did not provide apparent improvements and unnecessarily complicated the model.

system performance on the 9cg versus 9ta data
we took  <dig>  ms ionic flow blockade signals for 9gc and 9ta molecules, recorded according to protocol described in  <cit> , and automatically learned the convolution topology according to the strategy . the remaining sequences, generated the same day, were used as a test set. we have split the test set sequences into chunks of  <dig> ms each to investigate short-term classification performance, resulting into  <dig>  test fragments for 9ta signal and  <dig>  9gc test fragments as could be seen in figure  <dig>  we run both 9gc and 9ta learned hmm profiles on the test sequences and classify them according to maximum likelihood. we achieve classification accuracy of  <dig> % on the 9gc test set and  <dig> % on the 9ta test set.

CONCLUSIONS
although running slowly, the explicit dhmm design has many advantages over other duration representation methods for hmms, such as using unmodified viterbi decoding algorithm and possibility for exact representation of any duration phenomena. original explicit dhmm produced the best results in all artificial test categories. however, learning of such topology can quickly turn into a grim experience, since too many parameters need to be learned with noisy data.

the geometric duration distribution hmm is simple, but is not well suited to complex duration data analysis . convolution of geometric states, especially a mixture of such aggregate states, is a much more robust and powerful method of interpolating noisy multimodal duration phenomena encountered in ionic flow blockade time series analysis. the software used to conduct experiments in this report is freely available at .

