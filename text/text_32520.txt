BACKGROUND
the popularisation of high-throughput technologies such as dna microarrays has lead to a parallel demand of methods for data analysis. in particular, the necessity of providing a functional interpretation at molecular level that accounts for the macroscopic observations in high-throughput experiments has promoted the development of different methods for the functional profiling of this type of experiments during the last years  <cit> .

it is widely accepted that genes do not operate alone within the cell, but they carry out their functions through a complex interplay whose most obvious experimental evidence is the intricate network of protein interactions that we only just have started to decipher  <cit> . most of the biological functionality of the cell arises from complex interactions between their molecular components that define operational interacting entities or modules  <cit> . functions collectively performed by such modules can conceptually be represented in different ways, being possibly gene ontology   <cit>  and kegg pathways  <cit>  the most popular and widely used ones. for practical purposes, functional modules are defined as sets of genes sharing go or kegg annotations. there are, obviously, many other categorizations of gene modules in different domains; for example reactome pathways  <cit> , biocarta pathways , etc.

in an attempt to understand the functional basis of high-throughput experimental results different functional profiling methods have been proposed  <cit> . depending on the way the experimental data are selected and used two main families of methods, generically known as functional enrichment methods and gene set methods, can be distinguished. functional enrichment methods have been implemented in several programmes such as gominer  <cit> , fatigo  <cit>  and others. these are used to study whether a previously selected list of genes of interest is significantly enriched in one or more functional modules. typical criteria for the selection of such gene lists in microarray experiments are differential expression between two classes, co-expression across experiments, etc. thus, by means of this simple two-step approach, a reasonable biological interpretation of a microarray experiment can be achieved. gene set methods were proposed more recently and directly aim to detect sets of functionally related genes  with a coordinate and significant over- or under-expression across a list of ranked genes. gene lists are ranked by differential expression between two classes, compared in microarray experiments  <cit> . in that way, the first step, in which genes are selected according to thresholds that ignore its cooperative behaviour, was avoided.

however, all these methods use functional modules as categorical variables. this fact, in the most typical microarray experimental designs  or in other types of genomic experiments , leads to the implicit assumption that such functional modules must be composed by sets of genes with a strong level of co-expression . nevertheless this assumption might not be necessarily true for all these modules. in fact, early attempts to deduce gene functionality  from gene co-expression revealed that many functional modules did not even show a detectable degree of internal co-expression  <cit> . therefore, if a non-negligible number of functional modules cannot be considered to be discrete categories there are two potential problems that affect all the methods for functional profiling: there is, on one hand, a problem of power in the statistical tests used, given that a number of functional modules tested will never be found simultaneously activated or deactivated, but are taken into account in the p-value adjustment procedures. on the other hand there is a potential problem of sensitivity, because many functional modules include genes with different degrees of intra-module co-expression, while the methods are many times applied to datasets in which the complete module is assumed to be over- or under-expressed as a whole. since functional profiling methods do really produce results, one may conjecture that the results that are being obtained under the present unrealistic assumptions are only an underestimation of the results that could be really obtained if functional classes were properly tested.

surprisingly, there are no systematic studies on the extent of this lack of internal co-expression within the most commonly used functional module definitions. the aim of this study was to produce a detailed survey on the go and kegg functional module definitions so as to determine which ones among them can be considered coherent modules of co-expression across a wide range of representative human samples. in principle, such coherent functional modules will define the subset of go and kegg functional modules susceptible of being detected using common strategies for functional profiling. in order to do so, we have derived, for each functional module as defined in go and in kegg, a co-expression  index which could be used to assess the strength of its internal correlation. this index has been further used to filter for functional modules with a weak internal degree of co-expression. the index was derived from a gene pairwise correlation matrix representing the overall correlation structure of the human transcriptome as estimated from microarray expression measurements of  <dig> samples collected under the most diverse biological conditions. in addition, a second main aim of this work was to use this information to re-define the functional modules as non-discrete entities. even in the case of the functional modules with a high degree of internal coherence, these cannot be considered as co-expression modules but rather as entities with a core of co-expressed genes along with a variable number of genes with lower correlation . in other words, not all the genes need to be expressed at the same time for the function to be activated. then, for each gene annotated within a functional module, we estimate its degree of correlation with the main bulk of genes annotated under such module. in this way we provide an index which is useful for quantifying how essential each gene is in the activation of the functional module. at the same time, we introduce a framework within which functional modules can be treated as non-discrete entities. under the prism of this new vision of gene function, we propose a simple modification of the functional profiling methodologies in order to enhance the use of biologically relevant information as described in the functional modules. finally, we present some examples about how these modifications can enhance the detection of biologically meaningful functions which would have remained unnoticed using currently available techniques for functional enrichment.

RESULTS
coherence index applied to functional modules defined by go and kegg annotations
a coherence index that gives an idea of the internal correlation of the genes belonging to a functional module has been proposed and estimated for all the go terms and kegg pathways. this coherence index may have several interpretations but certainly the most direct one is its understanding as the complement of a p-value. we firstly calculate the all-against-all correlation matrix for all the  <dig> transcripts across the  <dig> arrays used , which is available as online supplementary material . when the median correlation between the transcripts of a functional module is compared to the empirical distribution of correlations, estimated over randomly sampled sets of genes, we are assessing how strong the departure of our estimate from the null hypothesis of module correlation is. in other words, we can test if the internal correlation of such module is significantly higher than the correlation observed in a similar number of functionally unrelated genes. the coherence index proposed is the percentile represented by the module correlation within the random distribution. this index accounts for the complement of the probability of observing, under the null hypothesis, a value as extreme as the observed median. the cut-off of  <dig>  usually chosen to reject a null hypothesis when the observed p-value is lower would be represented, in this case, by the level  <dig> of our coherence index. we would reject the null hypothesis for a functional module when its estimated index is higher than such value.

the application of the coherence index to the functional modules as defined by kegg pathways showed that only 57% of them presented a correlation index greater than  <dig> . that is, if we were performing statistical analysis searching for kegg pathways having internal correlation stronger than the overall correlation of the transcriptome, we would find no evidence of significant strong internal correlation in 43% of the cases. thus 43% of the kegg pathways do not co-express more than they would do if they were composed of functionally unrelated genes. supplementary dataset s <dig> contains the list of the kegg pathways with their corresponding coherence index and median correlation values. even more drastic are the results obtained for the go terms. only 32%  of the functional modules defined by go showed a correlation index greater than  <dig> . supplementary datasets s <dig>  s <dig> and s <dig> contain the list of the go terms corresponding to the "biological process", "molecular function" and "cellular component" ontologies respectively, along with their corresponding coherence indexes and median correlation values.

it is also worth pointing out that for many functional modules correlation indexes below  <dig> were observed. this means that for those modules the internal correlation is even lower than the overall genome correlation, which suggests the existence of a pattern of negative correlations among a significant amount of genes in the modules.

as expected, large functional modules  tend to have a strong internal correlation whereas small modules show more variability . this was also observed for the three ontologies  of go 

not surprisingly it was found that, in general, when the internal median correlation of a functional module was low  its estimated standard deviation was high . more interesting is the finding that many functional modules with high internal correlation had also high standard deviations. this last observation makes it clear that, even within the functional modules which have a strong internal co-expression, there exist a non-negligible number of genes which do not co-express with the main bulk of genes of the module. we may conclude that, while a number of go terms or kegg pathways are defining true functional modules of genes which need to be co-ordinately expressed in order to activate their corresponding functional roles, most of the currently used functional modules are not formed by sets of co-expressing genes.

coherence index and the level of annotation in go
in the particular case of go, where functional terms are related to each other following a special type of hierarchical structure called directed acyclic graph   <cit> , we have studied the relationship between the proposed coherence index and the level of annotation of each term. here, the level of annotation of a go term is defined as the maximum number of nodes that can be found in the dag between the term and the root of the corresponding ontology. under this definition, high levels in the ontology represent more specific go terms. our findings show  that there is not a direct relationship between the degree of internal correlation of a go term and its level in the ontology hierarchy. it is interesting to remark that, contrarily to what it was expected, more specificity in a go term does not imply a tighter co-expression. this is probably a reflection of the fact that many definitions in the ontology are not accounting for simple cooperative processes such as the ones carried out for example, by a complex of proteins.

using gene-to-function information to best detect functional modules
in the following examples we show how to use this gene-to-function inter-dependence in order to incorporate the non-discrete nature of the membership of a gene to a functional module in the context of functional enrichment analysis.

case example 1: functional profiling of genes differentially expressed in patients infected with human papillomavirus
a study of  <dig> head and neck squamous cell carcinoma  tumour samples,  <dig> of them corresponding to patients infected with human papillomavirus  and the remaining  <dig> to non infected patients   <cit>  was used to illustrate the application of the proposed methodology. the authors assessed differential gene expression between hpv+ and hpv- tumours using affymetrix  <dig> plus  <dig>  chips, and reported  <dig> genes over-expressed in the hpv+ group of tumours. a significant number of such genes were cell cycle regulators and transcription factors. the affymetrix ids for these  <dig> genes can be found in the supplementary material provided by the authors. the gene expression data are available in the geo database  <cit>  under the accession number gse <dig>  in this case, raw files  were not available and consequently these were not used in our estimation of the correlation between genes. therefore, weights used in the analysis were obtained independently from the analyzed data set. the internal correlation value of any transcript to the rest of the transcripts in a functional module is used to assign a weight to it . transcripts positively correlated to the rest of the module are given a weight of  <dig> , while negative correlations are penalised with a weight of  <dig>  . for the rest of genes a weight of  <dig> is used. a logistic regression model, which allows the use of weights, is utilised here instead the classical fisher's test of equivalents .

we have systematically explored the go and kegg functional annotations of these  <dig> genes over-expressed in hpv+, testing for differences against the whole genome, that is, the remaining genes represented in the affymetrix chip. a total  <dig> go biological process terms and  <dig> kegg pathways  were tested as described in the methods section.

a total of four go terms were found as significantly over-represented in the group of over-expressed genes by the application of a standard, un-weighted test for functional enrichment with the permutation correction . in agreement with the discussion of the authors on the functionality of the genes differentially expressed  <cit> , the terms related to dna metabolism/replication  were found. also srp-dependent cotranslational protein targeting to membrane , probably accounting for the production of viral proteins is found. finally, a term with no clear interpretation, regulation of smooth muscle contraction, was also found.

go name
the application of the alternative weighted analysis proposed here detects a new term: negative regulation of protein kinase activity , while regulation of smooth muscle contraction disappears. it is long known the relationship between map kinase and growth factor activity, two terms descendant of negative regulation of protein kinase activity and hpv infection  <cit>  .

in the equivalent analysis of functional modules defined using kegg, the pathway heparan sulfate biosynthesis  was found to be significantly over-represented in the genes over-expressed in hpv+ by the weighted test significant. it has recently been reported that human papillomavirus infection requires cell surface heparan sulfate  <cit> . urea cycle and metabolism of amino groups is significant in both the weighted and the unweighted analysis.

case example 2: functional differences between two types of cancers
a second example on a matched-pair analysis of  <dig> breast tumours to study the transition between in situ ductal carcinoma  and invasive ductal carcinoma   <cit>  was analysed. in the study affymetrix hg u133a and hg u <dig> plus  <dig>  chips were used to assess gene expression differences between these two conditions. the authors reported  <dig> affymetix probe-sets up-regulated in idc and  <dig> down-regulated in idc. in their analysis authors also indicate cell-to-cell signalling and interaction as being the more significant functions of the differentially expressed genes. as in the previous example, affymetrix ids of the differentially expressed probe-sets where provided and gene expression data are available in the geo database  <cit>  under the accession number gse <dig> 

we have tested for enrichment in go and kegg terms in the up-regulated genes and in the down-regulated genes. a total of  <dig> go terms of biological process and  <dig> kegg pathways of sizes comprised between  <dig> and  <dig> genes where included in this study.

using a standard, un-weighted test for functional enrichment with the permutation correction two kegg pathways:, focal adhesion  and ecm-receptor interaction , as well as two go terms: transmembrane receptor protein tyrosine kinase signaling pathway  and regulation of cell shape , all of them related with the maintenance of cellular structures and cell motility, were found as differentially expressed. again, the application of the alternative weighted analysis proposed here detects a new term: proteoglycan metabolism . proteoglycans are known to determine mitogenic responses of breast carcinoma cells to fibroblast growth factors, mediated by tyrosine kinase-signaling receptors  <cit> .

discussion
functional annotations, such as go or kegg pathways, have been used for the definition of modules of genes in functional enrichment methods  <cit> . the detection of such functional modules within lists of genes by means of different tests relies upon the implicit assumption that common functionality implies a high degree of co-expression among all the members of each module  <cit> . while this assumption can be considered true as a general observation, it does not necessarily imply that the conventional definitions of functional classes used for this purpose  do all correspond to co-expressing sets of genes. it was previously reported that a large number of functional modules showed a low degree of internal co-expression, contradicting thus the expected cooperation among the genes to carry out their functions together  <cit> . despite this observation, a systematic study on the degree of internal co-expression of the most commonly used functional modules and the impact of this bias on real biological data has not been carried out to date. here we aimed a redefinition of functional modules, understood as groups of genes carrying out, cooperatively, a function in the cell. it is widely recognized that the biological circumstance of coexpression of two genes is properly defined by the coefficient of correlation among them  <cit> . so, we use it here to measure gene coordinate activity within a functional module. in this paper we present a general methodology to quantify the strength of the internal correlation of a functional module and we propose a simple way of using this information for functional profiling purposes that allows finding functional modules activated or deactivated that would remain otherwise unnoticed.

we have derived the correlation structure of the largest possible fraction of the human transcriptome, estimating its parameters from measurements from  <dig> dna microarrays stored in public data repositories. one of the strengths of the present study is, precisely, the big sample size  on which all estimations relay on. of not less importance is the wide range of biological conditions considered in the study which includes several types of normal tissues, different kinds of cancer cells, male and female individuals as well as different cell lines. in order to ensure as much as possible the compatibility of the data gathered for the analysis, we have used one of the more extensively used expression arrays currently available . for the same reasons, we have only collected datasets for which raw data were available so we could normalize and pre-process all of them together with the same method. this collection of samples constitutes a large dataset that allows us to perform a robust profiling of a large fraction of the human transcriptome, covering an ample spectrum of clinically and biologically relevant conditions.

the correlation structure of the transcriptome has been used to derive a coherence score which measures the internal co-expression of  <dig> kegg pathways and  <dig> go terms. our estimations indicate that only 57% of the kegg pathways and just 32% of the go terms can be considered to have internal correlation stronger than random modules of functionally unrelated genes of the same size. we also provided separate estimates for each of the gene ontologies , showing that, in general, go biological processes or molecular function have a weaker internal correlation than kegg pathways or go cellular component. another interesting finding was the fact that many modules have high internal correlation but also high variability.

different reasons may account for these observations. in some cases there are functional modules defined in go that are composed by independent or even antagonistic sub-modules and, consequently, their genes will never be found co-expressing in any experiment. examples are transporters, which are composed by different independent types of sub-modules or any go term starting by "regulation of", which usually has two antagonistic descendants called "positive regulation of" and "negative regulation of". in other cases, there are functional modules that require of a core of genes for properly carrying out the function and other genes of the module are only activated under particular physiological conditions, stresses, etc., displaying a lower degree of correlation. modules composed by sub-modules can also exist, and many other situations can be imagined. in any case, the vision of a functional module as a discrete class, to which genes belong or do not belong to, is definitively not supported by the observations made. thus, it is urgent to take a new approach that accounts for the non-discrete nature of the functional modules as defined by the most commonly used functional annotations .

in addition we highlighted how the level of annotation of a go term in the ontology structure may not be the most suitable indicator, at least in terms of co-regulation, of the described function, despite being often used as a measure of its specificity.

under the above mentioned considerations, most currently used functional profiling methods which model functional modules as groups of co-expressing genes, seem clearly inappropriate. the need of new methodologies for functional profiling and, above all, the essential requirement of a new notion of membership of a gene to a functional module is still an open issue. the proposed coherence score can be used in a first instance as a filtering criterion when the aim is to relate functionality to gene expression by discarding functional modules that will never be found as co-expressing units. beyond this obvious use, this index can also be used to derive a weighting scheme that introduces the idea of non-discrete functional modules within the context of functional profiling methodologies in a straightforward manner. the proposed weighting scheme has the desirable property of using information on gene coexpression in the algorithm when such information is available but not introducing any bias when the information is missing. relying on this new concept and using gene expression correlation information, we have shown with two examples how the proposed weighted approach discovers go terms and pathways unnoticed under the equivalent standard un-weighted functional profiling method.

the approach shown here is quite general and could easily be extended to any other species or different platforms just by calculating the corresponding correlation matrix in a straightforward manner. the methodology could also be easily extended to any other types of modules defined by functionality, regulatory motifs, etc. obviously, the use of newer strategies for functional profiling such as the different versions of gene set enrichment analysis  <cit> , would benefit of considering this weighted definition of functional modules instead of using the classical categorical, un-weighted definitions.

although the weighting schema proposed is quite simple, it proves efficient in finding functional modules in a standard functional enrichment analysis framework  <cit> , as shown by the examples. obviously, these examples have only an illustrative purpose of the application of the method that uses information on gene coexpression to improve functional module detection. however, in the worst scenario in absence of such information, this approach would be strictly equivalent to a conventional functional enrichment test and, therefore, its application would be equally valid. the use of most sophisticated weighting schemes, in which the continuous distribution of values of co-expression of all the genes in the module  were taken into account, would probably improve even more the results. also, a similar philosophy could also be applied to improve the detection of modules in gene-set enrichment methods although it falls beyond the scope of this manuscript.

CONCLUSIONS
the aim of the manuscript was, on one hand to show the discrepancy between functional modules as defined in some popular repositories  and real co-expressing modules and, on the other hand, to propose a new vision of such modules that combines the original definition of the function with the actual dynamics of co-expression. in this more realistic scenario, functional modules with a coherence index that makes them undistinguishable from functionally unrelated gene modules would be excluded from a functional analysis, thus increasing the power of any test in the process of adjustment for multiple testing. in the remaining functional modules to be tested, more importance will be given to the core of co-expressing genes while uncorrelated genes and negatively correlated genes  will be penalised in the analysis.

despite functional profiling of genome-scale experiments is an active field in which new proposals arise continuously  <cit> , the concept of functional modules as binary discrete classes has remained unchanged along the last years. with the coherence index and the weighted schema proposed here we have introduced a conceptually new operative definition of functional module, biologically more meaningful, that clearly increases the sensitivity of functional profiling methods.

