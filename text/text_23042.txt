BACKGROUND
a growing body of evidence is supporting the idea that horizontal gene transfers  have played a significant role in prokaryotic genome evolution  <cit> . although these observations have stimulated researchers to develop a new paradigm of hgt-driven reticulate evolution that challenges the traditional tree-based phylogeny concept  <cit> , it can be argued that prokaryotic phylogeny can still be inferred using a certain subset of genes  that have mainly transferred vertically throughout evolution  <cit> . in fact, the genes constituting a prokaryotic genome appear to be divided into two classes: a "core gene pool" that comprises intrinsic genes encoding the proteins of basic cellular functions, and a "flexible gene pool" that comprises hgt-acquired genes encoding proteins which function under particular conditions, such as genomic islands  <cit> . therefore, the identification of the genomic core conserved among each taxonomic group is crucial, not only for establishing the identity of each taxonomic group, but also for understanding prokaryotic diversity and evolution. moreover, in a practical sense, the genomic core concept should also play a key role in summarizing genomic databases, which continue to grow explosively  <cit> .

however, the best way to define core genomes is yet to be established. although the term "core genome" has been used in various contexts, in the context of intraspecific comparisons, "core genome" is typically defined as a set of genes shared by all strains, while "pan-genome" is defined as the union of genes contained in all the strains considered  <cit> . this definition of "core genome" can also be applied to genus-level comparisons  <cit> , and actually, similar types of analyses have been conducted for comparisons of even more distantly related genomes  <cit> . however, with such strict criteria, the number of core genes often decreases excessively as the number of target genomes increases  <cit> , since the sets of genes required for life can vary between organisms living in different environments. the problem can be avoided by using a relaxed conservation criterion rather than strict universality  <cit> , but the problem of how to define a biologically meaningful core still remains. moreover, despite several studies on how to establish plausible orthologous groups  <cit> , the problem of identifying genuine orthologs is still difficult, especially for the comparison of prokaryotic genomes where horizontal transfers are common. in fact, in a strict sense, "genuine ortholog" is only meaningful when the genes have been transmitted vertically, and in that sense, "core genome" and "genuine ortholog" are closely related concepts.

due to the accumulation of microbial genomic data, we can now compare genomes at various levels of relatedness  <cit> . in this work, we focused on comparisons of moderately related genomes , which we consider to be key for understanding prokaryotic evolution since they bridge the gap between the knowledge of short-term evolution and that of long-term evolution. among such genomes, typically the gene orders are partially conserved, and this information can be used to identify genuine orthologs .

here, we consider the structural core gene set, or simply the core structure, of moderately related genomes; this core gene set is defined as the set of sufficiently long consecutive genomic segments in which gene orders are conserved among multiple genomes so that they are likely to have been inherited from a common ancestor mainly through vertical transfer . for this purpose, we developed a graph-based algorithm for aligning conserved regions of multiple genomes, which finds the order of pre-identified gene families that retains to the greatest possible extent the conserved gene orders . to confirm that our definition of the core structure is indeed biologically meaningful, we applied our method to genome comparisons of two well-characterized families, bacillaceae and enterobacteriaceae, and characterized the resulting core structures in terms of gene functions, essentiality, g+c content homogeneity and phylogenetic congruence.

RESULTS
corealigner: procedure for constructing a core genome alignment
our program for constructing core structures, named corealigner, requires a set of well-conserved orthologous groups . here, we compiled a set of ogs using the domclust algorithm  <cit>  on the mbgd server  <cit> , and considered an og as "conserved" when it was present in at least half of the genomes . next, conserved neighborhood pairs were extracted from the pairs of conserved ogs. we considered that two ogs are in a neighborhood in a given genome if they are located within  <dig> genes  in that genome, and that the og pair is conserved if the two ogs in that pair are in the same neighborhood in at least half of the genomes . a neighborhood graph, g <dig> = , was then constructed with the set of conserved ogs, v, and the set of conserved neighborhood relationships, e.

our algorithm for constructing the alignments of the core genome structures is based on finding the longest path of the conserved neighborhood graph . a similar algorithm has been previously developed  <cit>  mainly for identifying much shorter but more widely conserved gene clusters such as operons and über-operons  <cit> , but unlike their method, our method considers not only genes in the same direction but also those in the opposite direction as neighboring genes, and thereby generally generates longer alignments. in addition, our method uses the dynamic programming  algorithm for calculating the longest path. to apply the dp algorithm, we devised a heuristic scheme comprising a series of preprocessing procedures to convert the initial conserved neighborhood graph, g <dig>  into a directed acyclic graph, g <dig> . after that, the extracted longest path is added to the core structure when the path consists of more than  <dig> ogs  and at least half of the genes  in that path are present in every genome . the procedure is repeated to find the next longest path in the remaining graph and the iteration is continued until all such paths are found.

core genome structure of bacillaceae and enterobacteriaceae
we used two sets of moderately related genomes: eight species belonging to the family bacillaceae and eight species belonging to the family enterobacteriaceae , among which gene orders are partially conserved . in addition, we used staphylococcus aureus and vibrio cholerae as outgroup species. we excluded endosymbionts with extremely reduced genomes such as buchnera and wigglesworthia from the enterobacteriaceae set, although we included in the analysis an endosymbiont, sodalis glossinidius, that has a chromosome of more than  <dig> mb containing  <dig> open reading frames   <cit> . on the basis of the pairwise comparisons among these genomes , we considered that two pairs of genomes  in the bacillaceae set and a set of three genomes  in the enterobacteriaceae set are related sufficiently closely that they can be counted only once . consequently, the effective number of genomes was six in both sets.

in the group column, organisms with the same number are those considered to be so close that they are counted only once; organisms with an asterisk are representative genomes for each of the closely related genome groups, which were used in the robustness test and the phylogenetic congruence test. in the abbrev column, the abbreviated names used in this paper are shown in italic; the names in parentheses are the abbreviated names used in kegg and mbgd.

by applying the corealigner program to these datasets, we obtained the alignments of the core structures of the bacillaceae and enterobacteriaceae genomes comprising  <dig> and  <dig> ogs, respectively . the number of bacillaceae core genes is about a third of the number of genes in the b. subtilis genome , and the number of enterobacteriaceae core genes is about half of the number of genes in the e. coli genome , although the actual numbers of core genes and total genes are different among the organisms.

the chromosomal arrangements of the core structures are somewhat different between these datasets . especially, a remarkable conservation was observed in the chromosomal arrangement of the bacillaceae core structure: the core genes are highly clustered and their overall arrangements are well conserved, except some symmetrical inversions near the replication terminus, a typical pattern of bacterial chromosomal rearrangement  <cit> . in contrast, the sizes of the gaps between the core regions vary substantially among genomes, and most of the species-specific genes are inserted in these flexible regions. on the other hand, the core genes of enterobacteriaceae are less clustered and more highly shuffled, although from the sequence comparisons they generally appear to be more closely related to each other than the bacillaceae genomes . nonetheless, they also primarily show the typical symmetrical inversion pattern around the replication origin.

functional characteristics of the structural core gene sets
next, we examined what kinds of genes are included in the core gene sets. we considered the b. subtilis and e. coli genomes as reference genomes and characterized each gene in these genomes using the functional categories defined in the kegg orthology database  <cit> . we also categorized each gene in these genomes into the following six classes: a) universal core, b) conserved core c) universal non-core, d) conserved non-core, e) non-conserved and non-unique, and f) unique, where "universal" means that the genes are conserved in all the genomes tested, "conserved" means that the genes are conserved in at least half of the genomes examined , and "unique" means that the genes are unique to the reference genome ; thus, "universal non-core" genes, for example, are genes conserved in all genomes but not included in the core set .

to see to what extent the core gene sets cover the functionally important genes, we examined the existence of the essential gene sets that were identified from the systematic gene deletion experiments in b. subtilis  <cit>  and e. coli  <cit> . in total,  <dig> out of  <dig> essential genes  were included in the b. subtilis core gene set, and  <dig> out of  <dig> essential genes  were included in the e. coli core gene set . therefore, most of the essential genes were included in our core gene sets in both cases. in effect, the coverage of the essential genes in the core gene sets might be even larger, because most of the non-core essential genes are not universally conserved. for example, among the b. subtilis essential genes that are not included in the core gene set are the cell-wall teichoic-acid biosynthesis genes , the lack of whose orthologs in g. kaustophilus genome has been previously reported  <cit> , suggesting that the essentiality of this system is not universal. a similar conclusion can be drawn from the comparison of the two independently identified e. coli essential gene sets  <cit> . when we consider the intersection of the essential gene set of baba and that of kato, the coverage increases up to  <dig> % .

actually, the core gene sets of bacillaceae and enterobacteriaceae share some common orthologs. to visualize this, we identified the orthologous relationships between these datasets by applying the domclust program to the combined dataset . the two core gene sets share  <dig> combined ogs that contain  <dig> and  <dig> ogs in bacillaceae and enterobacteriaceae, respectively , where the increase in the number of ogs in each set is primarily due to lineage-specific duplications in each family. on the other hand,  <dig> and  <dig> core ogs in bacillaceae and enterobacteriaceae, respectively, have some orthologs in the counterpart families that are not included in the core og set , and  <dig> and  <dig> core ogs, respectively, are specific to each family . as expected, the majority of the essential genes  are included in the cc class. to further examine the difference among these types, we studied the proportions of the kegg functional categories . the "core functional" characteristics of the core genes described above appear to be mainly linked to the cc class. in fact, most of the genes involved in primary metabolism and information processing are included in the cc class . on the other hand, one prominent feature of the cn class in the bacillaceae core is the larger proportion of the sporulation function, an obvious bacillus-specific function. in the cn class, the majority of ogs are uncategorized, while in the cc class the proportion of uncategorized ogs is around 30%.

parameter dependency and robustness of the method
our method of core structure extraction includes some arbitrary parameters, among which the two most important ones are cons_ratio and max_gap, which define the degree of conservation required for core genes and the neighborhood of each gene, respectively . here, we examined the dependency of these parameters on the results of the core extraction in terms of the total number of genes in the core set and the number of essential genes contained in the core set .

when the cons_ratio parameter was tightened from  <dig>   to  <dig>  , the number of the resulting core gene set decreased from  <dig> to  <dig> in bacillaceae and  <dig> to  <dig> in enterobacteriaceae . thus, the size of the core gene set can be greatly influenced by the cons_ratio parameter. on the other hand, the effect of the max_gap parameter was relatively small . the number of essential genes included in the core gene set generally increased as the number of core genes increased, but this number appeared to almost reach the maximal value with our default parameter set . thus, we can very roughly say that, by using our default parameter set, we were able to obtain the smallest core gene set that almost maximally covers the essential genes.

next, we examined the robustness of the resulting core structures when changing the set of input genomes. in this test, we extracted six genomes for each family by choosing a representative genome from each set of closely related genomes , and generated all the possible subsets containing two to five genomes. then, using each of these subsets as the input genome, we ran the corealigner program to define the core structure and counted the number of resulting core ogs. we also examined the numbers of universal  and conserved  ogs  that were counted using the same subsets of genomes. figure 6b shows the average number of the core, universal and conserved gene sets for each number of input genomes. as expected, the number of universal genes decreases monotonically as the number of genomes increases. in contrast, the number of conserved genes fluctuates widely with the change in the number of genomes, probably because the actual cons_ratio values fluctuate due to the rounding-up effect even when a constant cutoff value  is used. curiously, the distributions of these average values appear to be very similar between bacillaceae and enterobacteriaceae, although the latter has much larger variances than the former. on the other hand, the number of core genes is quite different in the two families, as already mentioned in the previous sections. this clearly indicates that our criterion based on syntenic conservation defines a quite different set of core genes than the criterion based only on the presence of genes in each genome. moreover, the number of core genes shows a relatively stable pattern in both families . in fact, although similar fluctuations, probably due to the rounding-up effect, are again observed, the magnitude of fluctuation is much smaller than that for the conserved genes described above. these observations suggest that the use of synteny information with a relaxed conservation criterion  helps the corealigner program to identify robust and reliable core gene sets, although the setting of the cons_ratio parameter still remains somewhat arbitrary.

g+c content of the third codon positions
our main working hypothesis is that the core structure extracted here is mainly inherited through vertical transfers throughout evolution. several methods have been developed for identifying horizontally transferred genes  <cit> , and detecting anomalous nucleotide compositions is a common approach for identifying them using a target genomic sequence alone  <cit> . among them, the g+c content of the third codon positions  is the most basic but still an effective characteristic, although the "amelioration" process unfolding in the course of genomic evolution may diminish its effectiveness  <cit> . since it is known that highly expressed genes such as ribosomal proteins also have specifically biased codon usage that generally correlates with trna abundance  <cit> , we predicted highly expressed genes based on the codon usage of ribosomal proteins  <cit>  and eliminated them from the analysis.

we calculated the gc <dig> values of the genes in each genome and examined their distribution for each of the six classes, a-f, defined above . the gc <dig> values of the class-a genes  show bell-shaped distributions with relatively sharp peaks. similar distributions can be seen in classes b , c  and d , but their shapes and sizes are different depending on the organism. the distributions of classes e  and f  are generally broader and of a more irregular shape. the range of each distribution can be seen more clearly in the box plots , which show that, generally, the core genes  are distributed within smaller ranges than the non-core genes. to examine the relationship in a more quantitative manner, we calculated the mean and the standard deviation for each distribution and compared the results . we can confirm that the standard deviation generally increases in the order of a to f, and more specifically, that the relationship a, b < c, d < e, f holds in all of the  <dig> genomes, except that the latter inequality does not hold in the s. glossinidius genome where the number of non-core genes is extremely small. the smaller variance of the gc <dig> percentage of the core genes appears to support our working hypothesis that the core structure is generally indigenous to each genome.

from the box plots in figure  <dig>  we can see that there are some outliers in the core classes, and in some cases the number of outliers in the core classes is even larger than that of outliers in the non-core classes. however, we should notice that the number of genes and the distribution shapes are quite different among the classes, and thus a direct comparison of the number of outliers in these plots is meaningless. to understand this point more precisely, we identified the genes with significantly biased gc <dig> values using the condition |x-μ|/σ >  <dig> , where μ and σ are the mean and the standard deviation, respectively, of the gc <dig> values of the core genes , and the cutoff value corresponded to p <  <dig>   when normal distribution was assumed. then, we compared the ratios of genes with biased gc <dig> values to the total number of genes between classes . the result indicates that the ratios of the biased genes again generally increase in the order of a to f. especially, the ratios are less than 1% in class a for all species and class b for most of the species, which is again consistent with our working hypothesis.

phylogenetic analysis
if the core structure in each genome indeed shares the same evolutionary history, we can construct a very reliable phylogenetic tree by using a long concatenated sequence comprised of the core genes. for this purpose, we collected the universally conserved, one-to-one correspondence core og sets comprising  <dig> and  <dig> ogs for bacillaceae and enterobacteriaceae, respectively, and constructed phylogenetic trees using the concatenated alignments of the conserved blocks in these sequences comprising  <dig> and  <dig> residues, respectively. using the neighbor-joining  method  <cit>  and the maximum likelihood  method  <cit> , we were able to obtain highly resolved phylogenetic trees in which most of the branches, except some very short branches in the nj trees, had bootstrap values of 100%, but the tree topologies constructed by different methods did not exactly coincide with each other . in fact, such high confidence levels can be attained simply because of the extremely large sample sizes  and do not necessarily indicate the true reliability if there exists a systematic bias  <cit> . to examine whether the data indeed support tree-like phylogeny, we also constructed phylogenetic networks using the neighbornet algorithm  <cit>  . the results showed that some internal branches exhibited a network-like  structure that generally indicates a reticulate event such as horizontal transfer  <cit> . especially, in the enterobacteriaceae phylogeny, a network-like structure was found around the center of the phylogenetic radiation where the internal nodes were concentrated. although the degree of incongruence appears not to be so large, this structure can obscure the phylogenetic relationship among organisms branching from there, and probably caused the above discrepancy of phylogeny.

to further investigate the congruence among the core gene phylogenies, we constructed ml trees of individual core ogs and compared them. as a result, we found  <dig> and  <dig> distinct topologies in the bacillaceae and enterobacteriaceae datasets, respectively, which are fairly large considering that there exist only  <dig> possible topologies among the  <dig> taxa examined here; the majority-rule consensus trees of these individual trees showed the same or a similar topology to the concatenated ml trees  . we visualized the set of the resulting tree topologies using multidimensional scaling  analysis based on the robinson-foulds topological distance  <cit>  . the results were again contrasting: there are three distinct major topologies that correspond to the alternative topologies of the ambiguous relationship in the bacillaceae dataset , whereas a more dispersed distribution can be observed in the enterobacteriaceae dataset . these observations clearly indicate that there is a severe limitation when inferring phylogeny using only a single or very few genes. the problem cannot be avoided even when using some "gold standard" genes; the phylogenetic topologies of the 16s and 23s rrna sequences, the genes most conventionally used for inferring phylogeny, are located far from the representative topologies in our mds plot  .

unfortunately, the observed topology dispersion  also appears to challenge our working hypothesis that all core genes share the same evolutionary history. however, we should consider the effect of the statistical fluctuation behind the variation of tree topology. to examine this, we performed a shimodaira-hasegawa  test  <cit>  for each of the core ogs and estimated the number of ogs whose individual ml tree topologies are significantly different from that of the representative genomic tree topology taken from the ml tree of the concatenated core sequences . in this test, we also performed the same test using the non-core ogs that have a one-to-one correspondence; here, we considered non-universal ogs as well as universal ones because there are only a few universal non-core ogs, and summed up the results for each of the effective number of genomes  contained in the ogs . when using a significance level of 5%, we found that  <dig> %  and  <dig> %  of the core ogs of bacillaceae and enterobacteriaceae, respectively, with n =  <dig> had significantly different topologies from the representative one . in other words, the observed number of significantly different cases was within the expected value . therefore, the number of incongruent cases may not be as large as it appears to be in figure 8c. in contrast, in total, around 20% of the tested non-core ogs had significantly different topologies at the 5% level . fisher's exact test showed that the number of incongruent cases of the non-core ogs was significantly larger than that of the core ogs, except in the case of n =  <dig> in enterobacteriaceae, where the sample size of the non-core cases was extremely small . therefore, we can conclude that the core genes indeed have a greater tendency to exhibit congruent phylogenies, at least in comparison with the non-core genes. note that a greater congruency of the core than that of the non-core is observed in virtually every group of effective number of genomes , indicating that the issue of whether it is the core or not is more directly connected to phylogenetic congruency than the universality of genes. note also that the dataset used to construct the reference tree of this test is included in the cell of  in table  <dig>  which means that the comparison at n =  <dig> may be somewhat unfair but the comparisons at other n are not.

the sh test was performed for all ogs  that have a one-to-one correspondence using the tree-puzzle program with the ml topology  of the concatenated core sequences  as a reference tree, and the numbers of rejected  cases were compared between core and non-core classes using the fisher's exact test. the first column  indicates effective number of genomes where genomes of closely related species were counted only once. the column "rejected" indicates the number of cases rejected by the sh test at a significance level of  <dig> ; the number in parentheses is the percentage of rejected cases. the last column indicates the p-value of a one-sided fisher's exact test.

discussion
in this work, we developed a method for identifying the core structure among moderately related microbial genomes by constructing a genome alignment based on the consensus gene order. we applied the method to the genome sets of the families bacillaceae and enterobacteriaceae and characterized the resulting core structures in terms of gene function, essentiality, nucleotide content and phylogenetic relationship. the results showed that the core structures covered functionally important genes , including most of the essential genes , and generally had more homogeneous gc <dig> values  and phylogenetic tree topologies  than the non-core genes. all of these characteristics are to be expected in light of the core genome concept. we also examined the parameter dependency and robustness of our method, and found that it can offer a more robust core genome definition than simpler approaches that consider only universality or a fixed conservation ratio as the criterion . this robustness enabled us to define plausible core structures even when some of the genomes have degenerated due to changes in environmental conditions such as those arising from symbiosis  that have made the existence of certain core genes unnecessary . on the other hand, our method is dependent on the conservation ratio parameter . although we believe that the parameter setting used here is better for defining plausible core gene sets in terms of coverage of the core functions for both bacillaceae and enterobacteriaceae, we might need to use different parameters when we consider different taxonomic groups. in fact, it might be better to use more relaxed conditions when we analyze genomes whose core structure is subject to substantial disruption. another related issue is the size of the core, which is likely to decrease when the diversity of the group for which the core is determined increases. here, we showed that the core of enterobacteriaceae  is larger than that of bacillaceae , and that bacillaceae is indeed more diverse than enterobacteriaceae, at least in terms of sequence diversity . however, the relative frequencies of genomic rearrangement and nucleotide mutation may be different among different lineages, and to investigate this issue in a more quantitative manner, we need to extend the analysis to a broader range of taxonomic groups. applying our method to more varied taxonomic groups is an important future task.

in this work, we used the coverage of the essential genes as an indicator for evaluating the core gene sets. consequently, most of the functionally important genes are included in the resulting core gene sets, especially in the intersection of the two core gene sets . on the other hand, the resulting core gene sets also include substantial uncharacterized genes, and many of the taxon-specific core genes are still functionally uncharacterized . it is natural to think that such taxon-specific core genes have some important but to date uncharacterized functions that are related to taxon-specific features, since they are likely to have been inherited in that taxon throughout evolution, although we generally need more extensive analysis with a greater variety of genomes to claim taxon specificity. however, we should also note that the significance of the gene order conservation of individual core genes can vary from gene to gene, and that some of them could be less important but co-inherited simply as "hitchhikers."

the rationale behind our definition of "core genome" as an indigenous, vertically transmitted structure based on syntenic conservation is that horizontally transferred genes are unlikely to insert themselves at the same chromosomal position. although both the gc <dig> analysis and the phylogenetic analysis generally support the hypothesis that the extracted core genes are indigenous and share the same evolutionary history, there are some exceptional cases. for example, several genes with extremely biased gc <dig> values were found in the core genes  and some core genes appear to have significantly different phylogenetic tree topologies from that of the concatenated core sequences . although the sh test showed that the number of incongruent cases may not be as large as it appears to be , it should be noted that the sh test has been suggested to be too conservative  <cit> .

actually, we used a relaxed criterion for syntenic conservation  in our core genome alignment procedure. therefore, some of the exceptional cases could have arisen due to this relaxed criterion. notable examples are shown in figure  <dig>  where two possible operons related to the histidine and tryptophan biosynthesis pathways, respectively, contain genes with significantly incongruent phylogeny identified by the sh test . in both cases, the operonic structures are apparently translocated in the b. anthracis, b. cereus and o. iheyensis genomes from the conserved core arrangement , and genes in the same set of genomes also form a cluster distinct from the other bacillaceae genes in the phylogenetic tree of each family , suggesting that these operonic structures were likely to be replaced with horizontally acquired ones in these organisms. although only a limited number of significantly incongruent cases were found in the core by the sh test here, this phenomenon might be more common because we can find similar small local rearrangements in the resulting core structure . nevertheless, we dot not consider it a serious problem, since it is an expected consequence of our definition of the core, where genes are inherited "mainly" rather than "exclusively" through vertical transfer. on the other hand, a more serious concern may arise if the gene order in the resulting core structure is only very poorly conserved, especially when one uses too large a max_gap: the similarity of the relative gene location rather than the conservation of the exact gene order might be a result of convergent evolution, which is not what we expect. although we think that the resulting core structures presented here are so well-ordered that they are unlikely to suffer from this problem, in order to avoid the problem in more general cases, we may need to introduce some solution, such as a statistical measure, to give guideline to users who must choose appropriate parameter values.

in addition to the problems arising from the relaxed conditions, there are more fundamental exceptions to the above rationale. one such exception occurs when horizontally transmitted segments insert themselves into the same  target sites. in fact, we encountered such a case during the experimental construction of the enterobacteriaceae core structure , where the region is conserved in only four genomes, but in three of the four cases the region is located at the same site . this region in the s. enterica genome indeed corresponds to the genomic island named "stic134f" defined in the islander database  <cit> , and there are phe-trna genes at both ends of each of these regions, which are likely to have been a common integration site of this island. we eliminated these regions by introducing a procedure to identify locally non-conserved regions in each genome . however, the current procedure depends on the somewhat ad hoc assumption that inserted segments exceed a certain length. therefore, although we believe that the procedure worked at least for the dataset of this study, additional evidence, such as genes  or repetitive elements related to some mobile elements, might be needed to correctly identify such regions in more general cases, and one may need other tools  for such tasks.

homologous recombination is another factor that can disrupt the evolutionary homogeneity of the core genes defined through synteny. although the importance of recombination within a bacterial population has been demonstrated in several species  <cit> , direct genetic exchange among the genomes compared here is very unlikely, because here we compared only moderately related genomes where nucleotide identities between orthologs are in many cases only 60–70% and hence there is little chance of having the sufficiently long identical segments required for successful homologous recombination  <cit> . however, we cannot exclude the possibility that recombination occurred frequently during a certain period after speciation, which might explain the observed network-like phylogeny . in addition, a successive chain of recombination events between closely related sequences could result in genetic exchange between more distantly related genomes, and the recombination rate might have been elevated by inactivation followed by the reacquisition of mismatch repair proteins, as suggested for e. coli strains  <cit> . on the other hand, there are some exceptions to the above nucleotide identity range, among which the most notable ones are the rrna genes; the identities between the rrna genes are generally more than 90%. this might give a plausible explanation why the topologies of the rrna gene trees are so different from those of the concatenated trees , as pointed out previously  <cit> . in any case, the possibility of homologous recombination across a species boundary, if any, should be an inherent feature of prokaryotic genome evolution, and could have been involved in the core genome formation. therefore, the extraction of core structures among genomes at various levels of relatedness can provide a basis for further studies of this phenomenon.

although we have focused on the problem of identifying the genomic core among moderately related prokaryotic genomes throughout this work, our genome alignment method itself does not assume any particular prokaryote-specific features, and thus, in principle, can be applied to more general purposes, including eukaryotic genome comparison. there have been numerous studies on multiple genome comparison, which we think can be primarily classified into the following categories:  nucleotide sequence alignment among closely related genomes  <cit> ;  gene order comparison among moderately related genomes for investigating the genomic rearrangement history  <cit> ;  finding conserved gene clusters among distantly related genomes for identifying operons and über-operons  <cit> . at first glance, the problem of the present study may appear to be most similar to . in fact, the problem of finding consensus gene orders considered here can also be formulated as a median breakpoint problem assuming a star-like phylogeny  <cit> . however, here we used a strategy similar to that of rogozin et al.  <cit> , mainly because the core genome identification problem has a "local alignment"-like nature, in that its goal is to extract well-conserved genomic segments, in contrast to the general median problem whose goal is to find a consensus order that spans the entire genome. we think that our approach has a practical advantage especially for the bacterial core genome extraction described here, but possibly also for eukaryotic genome comparison when well-conserved regions are limited. one drawback of our current approach is that it assumes star-like phylogeny and cannot treat hierarchical phylogenetic relationships among genomes. one way of incorporating such relationships is to introduce a weighting scheme, which has been investigated in the field of multiple sequence alignment . another more interesting approach is to consider the evolutionary scenario more explicitly when constructing an alignment . in any case, the incorporation of phylogenetic relationships is crucial for investigating the evolution  of the core structure, which is an important next step toward understanding prokaryotic genome evolution.

CONCLUSIONS
the present study demonstrates that the procedure  for multiple genome alignment based on gene order conservation can provide an effective approach to identify the genomic core among moderately related microbial genomes. identifying the genomic cores among various taxonomic groups will provide a basis for further comparative studies utilizing the rapidly accumulating genomic data for understanding microbial diversity and evolution.

