BACKGROUND
array-based comparative genome hybridization  is applied frequently to study the genomic content of closely related micro-organisms  <cit> , microbial taxonomy and species determination  <cit> , and the presence of microbial pathogenicity factors  <cit> . the differences in acgh signals depend on systematic errors , copy number variation, and sequence divergence between the analyzed samples  <cit> . since prokaryotes generally show lower genomic conservation than eukaryotes, normalization of bacterial acgh data is difficult.

over the years, the following normalization methods have been described for acgh data: total signal normalization  <cit> , lowess  <cit> , normalization using background signals  <cit> , spatial normalization  <cit> , and mixed models of lowess and spatial normalization  <cit> . furthermore, tools have been developed for detecting gene duplications/deletions  <cit>  and for the graphic exploration of acgh data  <cit> . none of the above-mentioned methods take into account sequence divergence and thus only partly can correct for the systematic errors that occur in acgh data. consequently, these methods result in lower discovery of genome variations, like gene deletions or duplications .

to solve this problem we first select a subset of array features corresponding to genes with minimal sequence divergence between the strains used for an acgh hybridization. we term this subset of features likely conserved genes . lcgs can be determined with certainty when both bacterial strains used for the acgh experiment have been sequenced, or approximated by inference if one of the strains has not been sequenced, but sequences of closely related strains  are available. also, from ortholog databases one can select the most conserved gene sequences and use these as an lcg set. with subset lowess, correction factors for systematic effects occurring in acgh data are derived for lcgs. these correction factors are subsequently used to normalize all array features. on basis of these considerations, we developed supervised lowess  which has been implemented in user-friendly web-based software. in a controlled acgh experiment, labeled genomic dna of lactococcus lactis il <dig> and l. lactis mg <dig>  of which the genome sequences are known, was hybridized to l. lactis il <dig> dna microarray slides. we show that s-lowess clearly outperforms existing implementations of acgh normalization methods in detecting gene deletions with a low number of false-positives .

RESULTS
supervised lowess
for normalization of bacterial acgh data, we evaluated the application of subset lowess  <cit>  using a subset of conserved genes  which are considered to be homologous in the strains-of-interest. we propose that the sequence divergence of lcgs between the samples analyzed is minimal; enabling a more robust estimation of systematic errors in the acgh data using the lcg array features. below we show that after application of s-lowess on microbial acgh data, genome variations  can more reliably be determined.

the s-lowess procedure is outlined in figure  <dig>  first, an lcg set is selected from sequence comparisons between those of the microarray features and the genes in the genomes of related species. the features which demonstrate a high sequence identity with the genomes of related organisms are considered to be conserved and are selected. in the second step, the acgh dataset is normalized by applying lowess to the lcg features, i.e. s-lowess. during this normalization, at first correction factors for the lcg features are determined by robust curve fitting. then, the signals of all array features are normalized using these correction factors.

the lcg set
an important step in the s-lowess procedure is selection of array features for the lcg set. lcg were selected based on various parameters: i.e. sequence identity, length of identical sequence, etc. a detailed description is available in the methods section. in general, when less stringent sequence identity cut-offs are applied during lcg selection, more robust lowess curve fits are obtained at the expense of estimation of systematic errors in the acgh data. subsequently, this results in less accurate detection of genomic deletions or duplications. in addition, the systematic errors in dna microarray data are better determined by performing curve fits on grids  rather than on the whole slide . as a rule of thumb, we have observed  or  <dig> spots  lead to satisfactory results.

the genes selected in the different lcg sets  are shown in figure s <dig>  <cit> . in general, for both the percentage nucleotide identity cutoff and the e-value cutoff, more stringent parameters lead to lower numbers of lcgs selected. genes selected on the basis of blat e-value cutoffs were quite different from those selected by the percentage of nucleotide identity. as shown below, normalization using the lcg sets by applying these different cutoffs leads to different end results.

different normalization methods lead to different data distributions
in order to evaluate various normalization methodologies, we generated acgh data in experiments in which we compared the genomic content of two sequenced lactococcal strains. a visual inspection of the comparison of s-lowess normalized data with the data obtained from other normalization methods reveals clear differences in the distribution of spot intensities . ideally, for the acgh comparison of l. lactis il <dig> and l. lactis mg <dig>  one would expect that the bulk of ratios reside above the x-axis , since labeled l. lactis il <dig> dna will, for most array features, hybridize more efficiently than those of l. lactis mg <dig> 

grid-based lowess normalization of the acgh data results in an even distribution of data points along the m =  <dig>  axis , which is not according to the expectation described above. after s-lowess normalization of the acgh data with the limited lcg set  or the realistic test case , the bulk of ratios is above the m =  <dig> axis, as expected.

s-lowess outperforms other methods in predicting genomic deletions
the performance of different normalization procedures on acgh data in predicting genome variations was determined by comparing these to the known deletions in the genome sequence of l. lactis mg <dig> compared to that of l. lactis il <dig> 

in general, the s-lowess normalization yielded a higher number of correctly detected deletions in the l. lactis mg <dig> genome  compared to lowess or total signal normalization, and non-normalized data. application of the gencom method  <cit>  to the l. lactis mg <dig> and l. lactis il <dig> acgh dataset results in a poor performance: only  <dig> of the over  <dig> genes are divergent and the differences between both strains reported by gencom are approximately evenly distributed  <cit> .

the number of false-positively scored genes being present, ranged from 37% by s-lowess  to 3%  and for the non s-lowess methods from 73%  to 45% . clearly, the use of s-lowess with lcg sets determined on the basis of blat e-values gives poorer performance than using the percentage identity cut-off as basis for lcg selection . normalization of acgh data with the lcg set selected on the basis of comparison of l. lactis il <dig> array feature sequences to the orfs of three streptococcus strains gave the same number of correctly identified deletions as the lcg set based on 90% sequence identity over  <dig> bp with less missing genes scored as being present. it is slightly outperformed by the best case, using the lcg set based on a 99% nucleotide identity cutoff.

in this study, we focus on the genes that are absent in the genome of l. lactis mg <dig>  the lactococcal genomes have limited sequence identity . therefore, many l. lactis mg <dig> orfs have a low sequence identity with l. lactis il <dig> counterparts. due to the limited sequence identity of these mg <dig> orfs, they should be recognized as being absent in the acgh experiment . furthermore, only for the s-lowess normalized data and not for the non-normalized or lowess grid-based normalized data a distinct pattern of clusters of large differences across the genome of l. lactis mg <dig> is apparent .

nucleotide identity and fold ratio are highly correlated in s-lowess normalized data
the comparison of two bacterial strains with known genome sequences allowed determining the concordance of the ratio obtained in an acgh experiment and the actual sequence identity between the genes in these strains. at a 100% sequence identity of l. lactis il <dig> array features compared to the l. lactis mg <dig> gene sequences identical signals should be obtained, resulting in log <dig> ratios of  <dig>  normalization of of the acgh data using the lcg features selected should therefore yield a better correspondence of fold change versus nucleotide identity. figure  <dig> shows the fold ratio of a number of different normalization methods as a function of sequence identity. based on the lower r <dig> value the lowess normalized data is noisiest . the s-lowess normalized acgh data using a stringent lcg set  performed as expected since the intersection with the x-axis of the regression line through the data at a log <dig> transformed ratio of  <dig>  is at 100% identity. lower performance of the other methods is visualized by the intersection of their regression lines at lower percentages identity, in particular by total signal normalization and lowess normalization .

discussion
s-lowess outperforms existing normalization methods in correctly predicting the absence of genes in dual-dye acgh data. this result is achieved by a more accurate estimation of the systematic errors occurring in acgh data by using genes that are likely to be conserved. existing methods do not take differences in sequence identity into account resulting in "over fitting", which is clear from data points centered on the m-axis . for s-lowess, the application of multiple genomes of related strains could increase the number of lcgs, which in turn results in an even better estimation of the systematic errors. bacterial strain typing and detection of duplications and deletions can thus be performed more accurately by using s-lowess.

dong and coworkers  <cit>  observed that, based on  <dig> genes, a negative trend exists between percentage sequence identity and fold-ratio between klebsiella pneumoniae and escherichia coli k <dig>  they fitted two regression lines through the non-normalized data:  for genes with  <dig> – 75% nucleotide identity and  for genes with  <dig> – 100% nucleotide identity. we also observed that lower sequence identity results in higher deviant ratios and more noise  and, therefore, decided to only focus on curve fits for  <dig> – 100% sequence identity. possibly, hybridization of dna with lower sequence identity is less predictable and depends strongly on the length and composition of the homologous dna sequence. the curve fits of dong and coworkers intersect at m =  <dig> and 88% sequence identity, which lies well between the values we observed for total signal normalized  and non normalized  data . one would expect the curve fit to intersect at m =  <dig> and 100% nucleotide sequence identity. this is only the case for s-lowess normalized data with a stringent lcg set .

a difference in signal between samples in an acgh experiment is due to systematic errors in the data, a difference in gene sequence identity, or the absence/duplication of a gene. in a non-isogenic transcriptome experiment, mrna profiles of different strains are obtained by dna microarrays. in this case, a difference in signals between samples could additionally be due to a difference in gene expression level. the s-lowess concept could also be used to normalize such non-isogenic transcriptome data as a difference in signal for lcgs is very likely to be due to differential expression and not to difference in sequence identity. the lowess assumption, namely that for a significant number of genes the expression is not altered, will probably hold for the lcg set, provided that the different organisms were grown and treated similarly. performing subset lowess normalization with a stringent lcg set should therefore produce a robust estimation of the systematic errors. for acgh data a large fraction of the lcgs should have hybridization ratios close to  <dig>  for non-isogenic transcriptome experiments, a fraction of the lcgs could be differentially expressed and, therefore, the curve fits should be performed with lower fractions of genes . this means that slide-based s-lowess will probably be preferred for non-isogenic transcriptome normalization.

the performance of s-lowess in a realistic worst-case scenario was estimated from normalizing acgh data of l. lactis il <dig> and l. lactis mg <dig> with a lcg set determined from taxonomically relatively close bacterial species. in this realistic case, s-lowess clearly performed better than convential normalization methods. we also tested the performance of s-lowess on a shigella acgh dataset  <cit>  . the genome sequence of this strain is as of yet unknown, which makes a comparison of the acgh data to actual genome sequence data not possible. therefore, the properties of the shigella dataset after treatment with different normalization methods were compared. clearly, the data properties for the shigella dataset benefit strongly from the application of s-lowess as we also demonstrated for the l. lactis acgh dataset .

the power of s-lowess is that it can be applied to any two-dye acgh dataset. since acgh experiments are performed with unknown strains, one cannot make strong assumptions as to the genetic content of these strains, making s-lowess the method of choice to normalize data from any prokaryote acgh experiment. the number of genome sequences is growing rapidly  <cit>  and a further acceleration is anticipated with the use of new techniques  <cit> . therefore, even better performance of s-lowess is expected when higher numbers of more similar reporter genomes are used for the selection of conserved genes.

CONCLUSIONS
supervised lowess is a new application of the subset lowess normalization technique to microbial array-based comparative genome hybridization  data. in particular but not exclusively, when the strains hybridized are relatively distant, no strong a priori assumptions can be made as to the data distribution of microbial acgh data. a difference in signal might be due to systematic errors in the microarray data  but could also be due to a difference in sequence between the two samples hybridized. presently used acgh normalization methods do not take into account this source of variation: sequence divergence between the genes of the strains hybridized. s-lowess is unique with the property that it uses the signals of likely to be conserved genes  to estimate the systematic errors in acgh data. we demonstrate on an acgh dataset of two distant l. lactis strains that s-lowess performs superior compared to existing normalization techniques used for microbial acgh data.

