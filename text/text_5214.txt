BACKGROUND
accurate sequence alignments for homologous proteins are essential for constructing accurate motifs and profiles, which are used in motif- or profile-based protein function search models  <cit>  and in building homology models <cit> . when sequence similarity is low, however, it is difficult to obtain the correct sequence alignment based on sequence similarity alone  <cit> . since it is well known that proteins can have similar structures even in the absence of any detectable sequence similarity, structural alignments have been used to guide sequence alignments and are used as the gold standard for sequence alignment evaluation  <cit> .

many pairwise structure alignment programs have been developed, but their performance has often been measured by how well the programs reproduce an expert-curated structure classification, such as scop or cath  <cit> . it has been shown that some programs do not produce high quality individual alignments, as measured by geometric match measures such as sas or gsas, even when they perform well in classification tests  <cit> . it is also known that structure-based sequence alignments produced by different programs can be different even when the superimposed structures are similar  <cit> . nonetheless, as far as we know, there is no report of a systematic evaluation of commonly used structural alignment programs in terms of the sequence alignment accuracy, perhaps because it has been difficult to find a fully human-curated and reasonably difficult reference alignment set  <cit> .

there are a number of sequence alignment databases that are augmented by structural alignments, including campass <cit> , homstrad <cit> , pali <cit> , dbali <cit> , pass <dig> <cit> , cdd <cit> , supfam <cit> , balibase <cit> , oxbench <cit> , prefab <cit> , sabmark <cit>  and s <dig> <cit> . the extent of similarity of the structures in these databases varies and so does the degree with which the alignments were curated by human experts after they were initially generated by automatic methods and/or imported from outside sources.

zhu and weng <cit>  used homstrad database to measure the performance of their structure alignment program, fast, and reported an average accuracy of 96%, measured as the percentage of correctly aligned residues among all aligned residues in the reference alignment. but our study reported herein indicates that such high accuracy is generally not obtained unless the structures are highly similar.

in this study, we evaluate the accuracy of structure-based sequence alignments produced by seven pairwise structure alignment programs, using the human-curated sequence alignments from ncbi's cdd  <cit>  as the standard of truth. this is an expert-curated database, built by importing sequence alignments from outside sources, which are manually modified by considering structure-based alignments. in addition to the family-level alignments, where protein sequences are highly similar, it also provides fully curated superfamily-level alignments, where sequence similarity is not so high <cit> .

RESULTS
average performance of each method
we prepared two reference alignment sets from cdd database as described in the methods section: the root node set and the terminal node set. figure  <dig> shows the distribution of alignments in these reference sets according to the sequence similarity . the alignments in the terminal node set are distributed over the entire similarity range. the root node set shows narrower distribution, with the peak at about 20% of sequence identity. both cover all four major scop classes .

† other than the four major classes.

we use "correctly" aligned fraction of residues  as a measure of alignment quality. this measure is defined as the ratio of the number of residues that are aligned correctly, within a specified shift error, to the total number of aligned residues in the reference alignment . since there is a large variation in the number of alignments in the cd nodes, , we use the node-wide average of fcar, which we denote as fcar. in order to compare the performance of different structure-alignment programs, we take the average of fcar  over all nodes within each node set.

with the terminal node set, the different structure comparison methods correctly aligned 93% to 97% of the residues, on average, without shift error . as the allowed shift error is increased up to  <dig> residues, the fcar value increases by about 2% for all methods. thus all methods work well for this dataset. we used the root, rather than the terminal, node set in the analysis of the results reported below. the results with the terminal node set are given in the supplementary material . we will often refer to each root node as a superfamily.

in contrast to the terminal node set, the fcar values without shift error are only  <dig>  to  <dig>  for the root node set. about 6% to 14% of the residues, on average, are aligned with some shift error  and an additional 4% to 9% of the residues are either not aligned or aligned with shift error of more than  <dig> residues. the best performance was achieved by dalilite, whether shift error was allowed or not. ce was the most dependent on allowed shift error; it ranked the lowest when shift error was not allowed but the second best, after only dalilite, if a shift error of up to  <dig> was allowed.

a couple of examples of such shifted alignments are shown in figures  <dig> and  <dig>  the former shows an α-helical protein pair from cd <dig>  for which the dalilite alignment has two of the four helices shifted by one helix turn compared to the cdd alignment. the latter is a pair of immunoglobulin folds from cd <dig>  for which the dalilite alignment is shifted by one beta-strand pitch for the entire structure.

dependence of performance on sequence similarity and distance between homologous residues
it is reasonable to expect that the alignment accuracy depends on the degree of similarity of the two structures compared. since proteins with high sequence similarity tend to be structurally similar, the alignment accuracy is expected to depend also on the sequence similarity. figure  <dig> shows the average fcar and fcar values in different sequence similarity ranges for different methods. as expected, both measures of alignment accuracy fall as the sequence similarity decreases for most methods. different methods perform similarly well when the sequence similarity is high but their differences become more apparent at the low sequence similarity ranges. dalilite gives the best average fcar values. at the low sequence similarity ranges , ce gives the worst average fcar values, but the second best average fcar. we have included in figure  <dig> for comparison the alignment accuracy obtained by ssearch  <cit> , which is a pure sequence alignment procedure. not surprisingly, all structure-based alignment methods perform much better than the pure sequence alignment method unless the sequence similarity is very high .

the dependence of the average fcar values on structural similarity is shown in figure  <dig>  where the degree of structural dissimilarity is measured by means of the rmsd. this is the root-mean-square of the distances between the cα atoms of the residues aligned and superposed according to the reference alignment. as expected, average fcar decreases as rmsd increases and fcar decreases more sharply than fcar. even the best performing method correctly aligns only about 80% of the residues without shift error, on average, as the rmsd approaches  <dig> Å, while the same method correctly aligns as much as 95% of the residues at this rmsd range if shift error is allowed.

since rmsd values can be heavily influenced by a small number of long distance pairs in the superimposed structures, we also measured the fraction of correctly aligned residues within each range of the cα distance between aligned residue pairs in the reference alignment . the distances are mostly less than  <dig>  Å, but there are still a significant number of residue pairs that are more than  <dig>  Å apart. the figure shows that correctly aligned residue fraction without shift error sharply decreases as the distance increases beyond  <dig>  Å while the equivalent fraction with shift error decreases rather slowly. thus, while there are relatively few residues aligned at distances larger than  <dig> or  <dig> Å, a large fraction of these residues are misaligned.

we note in passing an easily discernible feature on the length of the alignments that different structure alignment programs produce . as expected, all programs produce longer alignments than the reference alignment, since cdd alignments are those of the conserved core regions in a set of multiple alignments whereas test alignments are pair-wise alignments that may include residues outside of the conserved core. but ce, dalilite and matras produce relatively long alignments on average, fast, vast and sheba produce relatively short alignments and lock <dig> is in between.

variations within and between superfamilies
the results described in the previous sections  were given in terms of the fcar values averaged over all protein pairs and over all cdd superfamilies. however, each method gives alignment accuracies that vary greatly over different protein pairs and over different superfamilies.

the box plots in figure  <dig> give the distribution of fcar and fcar values over the cdd superfamilies for each method. dalilite has the narrowest distribution of fcar values with the highest mean and median while ce has the widest distribution with the lowest mean and median. all methods give fcar values less than  <dig>  for a number of superfamilies and completely fail for at least one superfamily. the distribution for fcar is much tighter in comparison.

the existence of superfamilies for which different methods give zero fcar value raises the possibility of systematic deviation of the result from human curation for some superfamilies. in order to identify such superfamilies, averages of fcar values were calculated over all methods for each superfamily. figure  <dig> shows the method-averaged fcar and fcar values for superfamilies sorted in the order of increasing fcar value. the distribution of the method-averaged fcar values over the superfamilies follows exponential decay except for five superfamilies with the lowest method-averaged fcar values . these superfamilies are listed in table  <dig>  all the methods give low fcar values for these five superfamilies .

† membrane and cell surface proteins and peptides

‡ number of pairs in the root node set in each superfamily

§ number of immediate subfamilies contributing structure pairs to the root node set

included in figure  <dig> are the rmsd values averaged for each superfamily. they generally decrease as the fcar value increases, although there are a couple of exceptions, as indicated by the red inverted triangles. none of the  <dig> superfamilies identified above has an exceptional rmsd value. this indicates that there is no gross error in the reference alignments for these superfamilies.

some members of these superfamilies were visually examined. the poorest results were obtained for the cd <dig> superfamily. this superfamily consists of the outer membrane porins, which are large β-barrel structures. two such barrels can be aligned in many different ways if sequence information is not used. for the four alignments in cd <dig>  all the methods produced similar alignments, where most of the residues were shifted by  <dig> residues in β-strands and/or by  <dig> residues in α-helices from the cdd alignments. similarly shifted alignments were observed in up to 20% of the alignments in cd <dig> . for the cd <dig> and cd <dig> superfamilies, the reference alignments look unusual in that some β-strands are out of phase or two residues off, according to our visual inspection of the structures superposed according to the cdd alignment .

one notable feature is that ce produces more one-residue shifted alignments than other methods for  <dig> of the  <dig> superfamilies , as well as for cd <dig> included here for reference as a typical superfamily.

in general, fcar values also vary within each superfamily for all methods . relatively large variation of fcar compared to fcar implies that there will be correspondingly large number of inconsistencies among the alignments of the superfamily members. for the largest superfamily, cd <dig>  all methods produced 5%  to 20%  of alignments wherein all the residues are shifted. some of these shifted alignments are as good as the reference alignments in terms of the rmsd and the number of aligned residue pairs, but are clearly wrong because the conserved cysteine residues that form the disulfide bond are not correctly aligned . this kind of incorrect alignments in immunoglobulin were discussed by gerstein and levitt in the category of "hard to align" pairs  <cit> .

architecture dependence of performance
it is known that some structure alignment programs show weakness in some specific architecture of the proteins in structure classification  <cit> . in order to examine possible such dependence in sequence alignments, the alignments were grouped by their scop class. the main four classes, α, β, α/β and α+β, were separately considered and the remainder were combined into the "others" class. for this study, we excluded the  <dig> outlier superfamilies of figure  <dig> 

each method shows a different pattern of relative weaknesses for different scop classes . ce gives relatively poor results for β-sheet-containing structures , dalilite for "others" class, and lock <dig> and vast for all-β and "others" classes. fast, matras, and sheba do not show such significant weakness in any particular class. interestingly, secondary-structure-independent methods such as ce, fast and sheba show good performance for the "others" class. inclusion of the five outlier superfamilies gives substantially similar results  except that the average fcar is lower for the "others" class for all methods because of the cd <dig> superfamily in this class.

discussion
performance difference of the methods
a significant observation in this study is that dalilite produces the most accurate structure-based sequence alignment, while ce is clearly not as good when shift error is not allowed . this result contrasts with an earlier evaluation study <cit>  wherein dalilite was found to produce worse alignments than ce in terms of geometric measures, which include rmsd. our result is more consistent with sierk and pearson's work <cit> , in which dalilite was found to be the best followed by matras, although they measured classification ability rather than alignment accuracy, using cath database as the gold standard.

dalilite, matras and fast, which are relatively good performers in our analysis, are based on the comparison of intra-molecular distance matrices without resorting to rigid body rotation during structural alignment  <cit> . thus, structural superposition is not necessary to obtain a good sequence alignment. also, different algorithms give different performances depending on how much shift error is allowed and on the secondary structure content of the structure. dalilite, lock <dig> and vast probably depend more on secondary structures than other programs and perform less well for "others" class of structures. ce tends to give inaccurate alignments for β-containing structures but performs well when some shift error is allowed, which makes it more suitable for homology detection and structure classification tasks. ce, dalilite, and matras produce long alignments . matras produces longer alignments on average than dalilite, but performs less well.

such differences among the methods were not observed with the terminal node set . fast was evaluated by its own authors using the overlap score, which is the same as fcar, and homstrad as the gold standard <cit> . the reported accuracy of 96% is consistent with our observation using the terminal node set. this suggests that the sequence similarity of the proteins in the homstrad dataset is perhaps similar to that of our terminal node set, which is made of "easy" cases for which all methods perform similarly well. the present study shows the advantage of using the root node set for evaluation since it has a higher discrimination power than the terminal node set .

alignment accuracy measures
we used fcar and fcar values almost exclusively as the measures of accuracy of alignments. these are the fraction of residues that are correctly aligned within the specified alignment shift error. as mentioned above, fcar values are the suitable measures when accurate alignment is essential as in building profiles. on the other hand, for the purposes of finding structurally similar proteins and for the structure classification, fcar may be a better measure to use. measures such as fcar is probably preferable over a quantity that measures how well the program reproduces an existing structure classification dataset such as scop or cath; the latter test brings in a set of issues, such as the human classification versus machine comparison and the effect of clustering , which are only peripherally related to the performance of the pair-wise structure alignment program itself.

the fcar measures can be used only when one has a reliable set of alignments that can be considered to be true. we used the ncbi's cdd alignments for this purpose. when such standard is not available, one has to use some absolute measure of the goodness of the alignments. authors of sheba, for example, which include one of us , used the number of residue pairs aligned within a given distance as the measure of goodness. kolodny et al.  <cit>  define four different measures, each of which is some combination of the number of aligned residues and the rmsd. as mentioned above, use of these measures results in a different ranking of the programs. it is easy to understand why the rmsd is included in the goodness measure that is basically based on how many residues a program aligns; the alignment length can be increased arbitrarily until it encompasses the whole protein if rmsd is not considered. however, as can be seen in figures  <dig> and  <dig>  our reference alignments include a significant number of conserved core residue pairs that are rather far apart. simply discouraging the alignment of such pairs is not necessarily the desired characteristic of a good structure alignment program and it may not be easy to find the proper combination of the number of aligned residues and the rmsd that will correctly assess the accuracy of a structure alignment program.

cdd as reference alignments
there are advantages to using the alignments from cdd as the reference dataset since they are human-curated and include sequences of both high and low sequence similarities. although vast alignment results are consulted by the ncbi curators of cdd, there does not seem to be a vast-specific bias since vast does not perform particularly well among the tested methods .

an obvious drawback is that cdd gives alignments of only the conserved core region from multiple alignments. a pairwise alignment will generally align more residues outside of the conserved core, but the accuracy of these alignments cannot be assessed using this reference set of alignments. our assumptions are that any good alignment program should do well for the conserved core residues and that a program that aligns the conserved core residues well will also align the non-core residues better than other programs.

imperfectness of alignments
although we investigated only the conserved core regions of the alignments, it is clear that all structure alignment programs often produce alignments with all or part of this core region of the structures misaligned . the correctly aligned fraction never reaches 95% even after shift error is allowed for up to  <dig> residues  and it decreases rapidly as the sequence similarity decreases or as the rmsd increases .

a possible reason for such discrepancy is the potential errors in the human-curated reference alignments. it was pointed out in the results section that some of the cdd alignments were unusual from the point of view of purely structural alignment. however, we believe that this is not the major contributor to the observed discrepancy according to two limited investigations we made as described below.

if the problem is in the reference alignment, all methods are likely to score poorly. but, as shown in figure  <dig>  there are only  <dig> superfamilies that are exceptionally poorly aligned by all methods and inclusion or exclusion of these superfamilies had little effect on the overall alignment accuracies.

a related possibility is that there are equally good alternate alignments for many of the structure pairs, as was pointed out by many authors  <cit> . the alternate alignments can affect the whole structure or only a part of the structure. the possibility of such alternates will increase for evolutionarily distant pairs as the sequence similarity becomes low and the structures acquire distinct differences. the fact that residue pairs that are more than  <dig>  Å apart in the reference alignment are heavily misaligned in the test alignments  suggests that this could be a significant contributor to the overall discrepancy between the test and reference alignments. in such circumstances, even structure-based sequence alignment can benefit from multiple alignments and from including the evolutionary relation between sequences.

a third possibility is of course the imperfection of the pair-wise structure alignment programs. the fact that different programs behave differently for the same set of data indicates that they are not yet perfect. we have observed that different programs totally fail for different sets of protein pairs. we have observed many instances wherein all or part of the structure is shifted by  <dig> or  <dig> residues compared to the reference alignment. in the example shown in figure  <dig>  the dalilite alignment is clearly wrong because the cysteine residues do not align. we are also surprised by the large number of cases wherein the alignment is shifted by an odd number of residues for all or part of the structure. it is definitely our impression that there is room for improvement in the structure alignment programs.

CONCLUSIONS
the accuracy of the sequence alignments produced by  <dig> commonly used structure alignment programs was evaluated using the sequence alignments from ncbi's human-curated conserved domain database as the standard of truth and the "correctly" aligned fraction of residues as the alignment quality measure. these programs mis-align 11–19% of the conserved core residues on average for structure pairs in the same cdd root node but not in the same child node. dalilite gave the best results among the programs tested. the alignment quality varied depending on the program used, on the protein structural type , and on the degree of sequence and structural similarity.

