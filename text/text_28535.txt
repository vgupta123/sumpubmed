BACKGROUND
in recent studies, gene flow – the process by which genetic material is exchanged between different populations and/or species existing at the same point in time – has been shown to have played a major role in the evolution of a diverse array of metazoans, including humans and ancient hominins  <cit> , mice  <cit> , and butterflies  <cit> . each of these organisms  has a phylogeny, or evolutionary history, which cannot be represented as a tree, where a branching event reflects strict bifurcating and/or multifurcating speciation/splitting and subsequent genetic isolation of the resulting species/populations. in these cases, the phylogeny takes the more general form of a directed acyclic graph known as a phylogenetic network  <cit> . phylogenetic networks are categorized as either explicit or implicit networks. reticulations in explicit networks are ascribed to specific evolutionary processes . in contrast, graphical structure in an implicit network summarizes conflicting phylogenetic signal but lacks a specific biological interpretation. for this reason, we focus our attention on explicit phylogenetic networks and we hereafter omit the “explicit” qualifier for brevity.

similar to phylogenetic trees, phylogenetic networks are typically inferred using computational analyses of multi-locus biomolecular sequence data. the most widely used approach is a concatenation analysis which estimates a single phylogeny for all loci  <cit> . in the context of species tree inference, methods used for concatenation analysis typically only account for sequence mutation  <cit> . representative examples of concatenation-based network inference methods include neighbor-net  <cit>  and the least squares method of schliep  <cit> , which we refer to here as splitsnet. a primary complication with the concatenation approach is that different loci in a genome commonly exhibit local genealogical incongruence  due to the complex interplay of different evolutionary processes that shaped the genomes. these include gene flow, sequence mutation, gene duplication and loss, recombination, and incomplete lineage sorting . ils occurs when lineages from two genetically isolated populations coalesce at a time more ancient than their most recent common ancestral population, and is known to play a crucial role in the evolution of much of the tree of life  <cit> . under neutral evolution, genetic drift – the outcome of purely stochastic inheritance over successive populations – can cause ils; other factors contributing to the maintenance of ancestral polymorphisms and ils include balancing selection.

in contrast to concatenation analysis, multi-locus methods infer species phylogenies in the presence of these evolutionary processes acting in combination. the most widely used multi-locus methods perform inference that account for a broad set of evolutionary processes, including sequence mutation, gene flow, and ils . multi-locus methods are broadly classified by whether or not they impose the requirement that a phylogenetic hypothesis be specified a priori.

the main focus of our study is the category of methods that perform full inference by searching among all possible phylogenies defined on a set of taxa. many of these methods utilize a gene-tree/species-phylogeny reconciliation approach , where local trees estimated from different loci – referred to as gene trees – are used as input rather than sequence alignments from the loci . the full inference procedure therefore requires two phases: a first phase where a set of gene trees is estimated from biomolecular sequence alignments, and a second phase where the gene trees are used to estimate a species phylogeny. the multi-locus methods are further classified by the optimization criterion used for inference. earlier parsimony-based approaches  utilize the minimize deep coalescence  criterion proposed by maddison  <cit> , which seeks the species phylogeny that minimizes the number of deep coalescences necessary to explain a given set of gene trees. more recently, probabilistic approaches perform phylogenetic network inference under an explicit evolutionary model that combines the coalescent model with biomolecular substitution models. examples include two different methods proposed by yu et al.  <cit>  that are implemented in the phylonet software package  <cit> , which differ primarily in their use of branch length information: one method uses the approach of degnan and salter  <cit>  to calculate model likelihood using only gene tree topologies, and the other method substitutes an alternative approach to calculate model likelihood using gene tree topologies and branch lengths. we therefore refer to these methods as mle  and mle-length, respectively. these probabilistic approaches have been noted to have high computational requirements, and model likelihood calculations were found to be a major performance bottleneck  <cit> . for this reason, pseudo-likelihood approximations to full model likelihood calculations have been proposed, including the method of yu et al.  <cit>  , which substitutes pseudo-likelihoods in the optimization criterion used by mle, and snaq   <cit> , which combines the use of pseudo-likelihoods under a coalescent-based model with quartet-based concordance analysis  <cit> . as suggested by yu et al.  <cit> , the techniques used by bryant et al.  <cit>  to infer a species tree directly from an input sequence alignment – effectively integrating over gene tree distributions at different loci – would provide an alternative to reconciliation-based species network inference, but scalable inference methods using this alternative approach have yet to be proposed and remain for future work as of this writing; preliminary experiments by yu et al.  <cit>  suggest that the scalability challenges of this approach will be greater than with state-of-the-art reconciliation-based approaches. all of these multi-locus methods address problems that are either known or suspected to be np-hard  <cit> . for this reason, heuristics are necessary to enable efficient inference under the optimization criteria associated with these methods. the practical design of the heuristics are essential to accuracy and computational efficiency.

a second category of methods requires a phylogenetic hypotheses to be provided a priori. methods in this category are typically used to address high-level questions such as detecting gene flow , inferring ancestral population sizes and other population genetic quantities  to capture within-genome sequence dependence), and detecting genomic loci involved in gene flow . we note that these inference problems are contained within the general phylogenetic inference problem. since the primary focus of our study is the general phylogenetic network inference problem rather than special cases thereof, we do not consider these methods further.

thanks to rapid advances in genome sequencing and related biotechnologies  <cit> , large-scale phylogenetic studies involving many dozens of genomes or more are now common . these developments pose two primary scalability challenges:  the number of taxa in a study, and  sequence divergence, which reflects the evolutionary divergence of the taxa in a study.

for the special case of phylogenetic tree inference from phylogenomic data, recent studies have examined these scalability challenges  <cit>   and proposed new methods for large-scale analysis  <cit> . in contrast, for the more general case of phylogenetic network inference, the limits of scalability on inputs with more than a few dozen taxa as well as performance at these limits have yet to be established. what are the computational requirements of state-of-the-art methods, and what is their accuracy on large-scale inputs with dozens of taxa or more?

to resolve these open questions, we conducted a scalability study of state-of-the-art phylogenetic network inference methods on both simulated and empirical datasets. to our knowledge, our study is the first to address these open questions. we chose representative methods from the different categories discussed above: neighbor-net and splitsnet , mp , mle and mle-length , and mpl and snaq . following the practice of prior simulation studies  <cit> , our performance comparison focuses on the simpler case of search among phylogenetic networks with the correct number of reticulations. the more general case of search among network hypotheses with differing numbers of reticulations necessitates the use of model selection techniques to balance model fit versus complexity, and is suspected to be more difficult for this reason  <cit> . furthermore, our performance study focuses on a constrained class of phylogenetic networks with at most a single reticulation, which are a subset of other widely studied classes of phylogenetic networks ; the undirected version of a phylogenetic network with one reticulation  is referred to as a unicyclic network  <cit> . our findings therefore provide a bound on the performance of the methods in our study, since more complex networks are anticipated to present even greater scalability challenges  <cit> . our performance study utilized empirical data from past studies of natural mouse populations and synthetic data which were simulated to capture a range of evolutionary scenarios involving a single reticulation. the performance of the phylogenetic network inference methods on the empirical and synthetic data was evaluated using three performance measures:  computational time,  memory usage, and  topological accuracy.

methods
simulation study

generation of random model networks. the random model networks used in our simulation study were generated by first sampling random model trees using r8s version  <dig>   <cit> . the following script was used to simulate random birth-death model trees for  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> taxa:





using a custom script, the branches of each random model tree were scaled to obtain height h. we examined two different h settings: a height of  <dig> was used throughout the study, except for experiments involving inferred gene trees where a height of  <dig> was used. this range of heights correspond to moderate to high levels of ils based on the classification scheme of vachaspati and warnow  <cit> . we then added a single reticulation to each random model tree using the following procedure:  choose a random time unit t
m such that  <dig> ≤tm≤h <dig>  and  add unidirectional migration, with a rate of  <dig>  between two taxa or subpopulations such that migration occurs from t
m− <dig>  to t
m+ <dig> . a single outgroup was added for each model network at coalescent time  <dig> h.


simulation of coalescent histories and gene trees. we simulated  <dig> gene trees for each random model network using ms  <cit> . the following ms command was used:





the -t parameter outputs the gene trees that represent the history of the sampled taxa. the -i parameter is followed by k that represents the number of populations. the list of integers  represents the number of taxa sampled for each population. we sampled one taxon per population. the -ej parameter specifies to move all lineages in population i to population j at time t
 <dig>  the first -em parameter sets migration at time t
 <dig> from population j to population i to  <dig> . the second -em parameter sets migration at time t
 <dig> from population j to population i to zero.


simulation of sequence evolution. the gene trees output by ms were used as input to seq-gen  <cit> , a sequence evolution program, which can simulate the evolution of sequences according to a finite-sites model. for each local genealogy simulated by ms, we simulated dna sequence evolution using the jukes-cantor mutation model  <cit> . the total length of the simulated sequences was  <dig> kb distributed equally across all the local genealogies . the following command was used to simulate the evolution of sequences:





the -mhky parameter specifies the jukes-cantor mutation model. the -s parameter specifies mutation rate θ of  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , or  <dig> . the -l parameter specifies the length of a sequence in base pairs.


replicates. each model condition in our study consisted of a distinct set of choices for the simulation parameters listed above. for each model condition, the simulation procedure was repeated to obtain twenty replicates.


multi-locus methods for phylogenetic network inference. a single pipeline with two stages was used to infer a species phylogeny. the first stage consists of obtaining gene trees, where either true gene trees were used or fasttree was used to infer gene trees using the sequence alignments for the loci. the second stage uses the gene trees from the first stage to infer a species phylogeny.

to obtain estimated gene trees in the first stage, fasttree  <cit>  under the jukes-cantor model was used to infer the maximum-likelihood unrooted gene tree for each sequence alignment generated by seq-gen. using a custom script, we converted the branch lengths from expected number of substitutions to coalescent time using equation  in  <cit> . we applied two techniques to root the gene trees. the first technique  involves rooting the gene trees based on an outgroup using paup*  <cit> . each unrooted gene tree was used as a backbone and the outgroup was added to root each gene tree under the maximum-likelihood criterion. after rooting each inferred gene tree, the outgroup taxon and its pendant edge were pruned. the second technique  involves including the outgroup in the local gene tree inference using fasttree, and then rooting the maximum-likelihood unrooted gene tree generated by fasttree using the outgroup. the outgroup taxon and its pendant edge are then dropped.

in the second stage, the gene trees from the first stage were used as input to the following phylogenomic inference methods: mle-length, mle, mpl, mp, and snaq. mle-length, mle, mpl, and mp are implemented as part of the phylonet package  <cit> . the following is a sample nexus script file that was used to execute the phylonet commands:





the commands located in the trees block contain the gene trees. the commands located in the phylonet block contain the inference methods and parameters used to infer a species network. the infernetwork_ml command infers a species network with one reticulation node using maximum likelihood. the -bl parameter specifies the use of branch lengths of gene trees in the inference. in the absence of -bl, only the topologies of gene trees are used in the inference. the infernetwork_mpl command infers a species network with one reticulation node using maximum pseudo-likelihood. the infernetwork_mp command infers a species network with one reticulation node using a parsimony-based method under the mdc criterion.

the following is a sample script used to execute the snaq commands:





the gene trees are summarized as quartet concordance factors using the readtrees2cf function. the readtopology reads the tree used as a starting point for the search. the starting tree was estimated using the mdc criterion. the snaq! command estimates a network using the input quartet concordance factors t and starting from tree d. hmax specifies the number of reticulation nodes. outgroup specifies the outgroup taxon used to root the inferred network.


concatenation methods for phylogenetic network inference. for the concatenation analyses, we inferred species networks using two distance-based methods implemented in the phangorn software package  <cit> :  neighbor-net  <cit> , a clustering method that extends the neighbor-joining algorithm, and  the least squares method of schliep  <cit> . throughout this manuscript, we refer to the latter as splitsnet. the logdet distance  <cit>  was used to calculate a distance matrix for use as input to the distance-based concatenation methods.


performance measures. we evaluated the inference methods based upon their topological accuracy and computational requirements. topological accuracy was evaluated by comparing the inferred phylogeny to the model phylogeny using the tripartition distance metric  <cit> , which finds the proportion of tripartitions that are not shared between the model and inferred networks. we compare trees using the normalized robinson-foulds  distance  <cit> . the rf distance counts the number of false positive bipartitions  and false negative bipartitions . finally, we used the splits distance, which measures the proportion of bipartitions found in the trees encoded by the inferred species network but not in the trees encoded by the true species network and vice versa. the second evaluation criterion used was the computational requirements of the inference methods, which was measured in terms of cpu runtime and memory usage. each analysis was run on a  <dig>  ghz intel xeon e5-2670v <dig> processor with  <dig> gib of main memory.

empirical study
we used genomic sequence data sampled from natural mouse populations. a recent study has highlighted historical gene flow between some of the populations in our study  <cit> . the samples were collected in previous studies . the collected sample information contained  <dig> haploid mouse genomes that are either wild or wild-derived samples. the procedure that was used to generate the sequence data is described in the study of liu et al.  <cit> . the sequences were filtered to  <dig>  snps that were genotyped across all samples.

datasets were constructed from the empirical samples using the following sampling procedure. for each dataset, we randomly selected one sample from each of the following mouse species or subspecies: mus musculus domesticus, m. musculus musculus, m. musculus castaneus, m. spretus, m. spicilegus, and m. macedonicus. the sampling was repeated twenty times to obtain twenty datasets.

we estimated recombination-free intervals for use as the input loci to the phylogenetic network inference methods. this required inferring recombination breakpoints. we obtained breakpoints using rechmm, a hidden markov model-based method  <cit> , resulting in  <dig> recombination-free genomic regions. for each recombination-free genomic region, fasttree was used to infer a gene tree with maximum likelihood under the generalized time-reversible model  <cit> , resulting in  <dig> gene trees. we used rat  as an outgroup to root each gene tree generated by fasttree.

mle-length, mp, and snaq were used to infer species networks with zero or one reticulation nodes. for inferred networks with zero reticulation nodes, we measured the topological distance between inferred trees using the robinson-foulds distance. for inferred networks with one reticulation node, the tripartition distance was used to compute the topological distance between inferred networks. we further compared the reticulations inferred by the inference methods to previous studies which detected two cases of gene flow: one among the m. musculus subspecies  <cit> , and the other between m. musculus domesticus and m. spretus  <cit> . inference accuracy was evaluated by computing the proportion of replicates for which the inferred phylogeny was consistent with either of the two known instances of gene flow. finally, we compared the inferred networks to the consensus mus phylogeny proposed by guénet and bonhomme  <cit> . dendroscope  <cit>  was used to visualize the empirical phylogenies.

RESULTS
performance evaluation on simulated datasets

runtime and memory usage. we began by assessing the effect of dataset size on computational time and memory requirements. figure  <dig> shows results for the multi-locus methods, which were the most accurate methods in our study .
fig.  <dig> the impact of dataset size on the computational requirements of multi-locus methods. the model conditions had dataset sizes ranging from  <dig> to  <dig> taxa. results are shown for mle, mle-length, mpl, mp, and snaq analyses using true gene trees as input. a average runtime  and b main memory usage  are shown with standard error bars . the analysis of mle on  <dig> taxa, mle-length on  <dig> taxa, and mpl on  <dig> taxa did not complete after ten days of runtime




for all methods except mp, runtime became impractical on datasets with more than a few dozen taxa. of the full likelihood methods, mle-length was consistently faster than mle; the comparison of pseudo-likelihood-based methods revealed that snaq was consistently faster than mpl. overall, we found that snaq was the fastest probabilistic multi-locus method. given a maximum runtime of ten days, the fastest full likelihood method  and pseudo-likelihood-based method  were able to analyze datasets with  <dig> and  <dig> taxa, respectively. however, mle-length and snaq required more than ten days of runtime on datasets with  <dig> and  <dig> taxa, respectively. the other multi-locus methods were slower: after ten days of runtime, mle did not complete analyses of datasets with  <dig> taxa and mpl analyses did not complete on datasets with  <dig> taxa. we also attempted analyses of datasets with  <dig>   <dig> and  <dig> taxa; none of these analyses  had finished after ten days of runtime and, in fact, are still running as of this writing after several months of cpu runtime. for the dataset sizes shown in fig.  <dig>  the full likelihood methods  had runtime and memory usage that were strictly greater than the pseudo-likelihood-based methods . for all methods except mp, runtime grew super-linearly as dataset size increased. the observed growth in runtime is similar to previous performance studies  <cit> , which suggest an increase in runtime as sampled dataset sizes grow.

relative to runtime performance, the main memory requirements of the different methods contrasted to a greater degree. on datasets with more than seven taxa, the full likelihood methods exhibited a super-linear growth in main memory usage, similar to its performance in terms of runtime . the full likelihood methods’ main memory requirements are projected to become prohibitive on datasets with more than a few dozen taxa. mle-length generally had lower memory requirements than mle. in contrast, mp, mpl, and snaq had memory usage that was largely constant at around a few gib on datasets with up to  <dig> taxa. mp and mpl had memory usage below  <dig> gib on datasets with up to  <dig> taxa. snaq’s memory usage was flat at around  <dig> gib as dataset size increased from  <dig> to  <dig> taxa, and increased by just a few gib as dataset size increased from  <dig> to  <dig> taxa. overall, snaq’s memory usage was the smallest among all multi-locus methods across all of the dataset sizes in our study.


topological accuracy. we next examined the topological accuracy of the inference methods as dataset scale grew in two ways: the number of taxa and sequence divergence. we evaluated the topological accuracy of the inferred phylogenetic networks using tripartition distance  <cit>  .

on sufficiently small datasets where analyses terminated, the probabilistic multi-locus methods returned improved topological accuracy compared to the parsimony-based multi-locus method . furthermore, the full likelihood methods  were more accurate than the pseudo-likelihood-based methods. thus, the methods fell into four categories based upon topological accuracy. across all model conditions,  mle-length was the most accurate,  mle was the second most accurate,  snaq and mpl were the third most accurate, and  mp was the least accurate method. note that, for each replicate, the same set of gene trees was provided to each multi-locus method as input.
fig.  <dig> the impact of dataset size on the topological accuracy of multi-locus methods. the model conditions had dataset sizes ranging from  <dig> to  <dig> taxa. results are shown for mp, mle, mle-length, mpl, and snaq using true gene trees as input. the tripartition distance between an inferred network and the model network was used to measure topological accuracy. average distance and standard error bars are shown 




overall, topological accuracy degraded as the number of taxa increased . the accuracy of each method was generally smallest on the largest datasets in our study. three exceptions to this observation were noted:  mp was consistently less accurate than the other methods but otherwise did not show a clear trend of change as dataset size increased,  mle, mle-length, mpl, and snaq’s topological accuracy decreased as dataset size increased from  <dig> to  <dig> taxa, and  snaq’s topological accuracy decreased as dataset size increased from  <dig> to  <dig> taxa.

we further examined the topological accuracy of the most accurate multi-locus inference method  as sequence divergence grew. we observed that the topological accuracy of mle-length generally degraded as sequence divergence increased due to larger mutation rate θ , with the exception of a relatively small improvement in accuracy as θ increased from  <dig>  to  <dig> . compared to the rest of our simulation study, the seven-taxon model condition with mutation rate θ= <dig>  was unique because it returned the highest topological error observed in our simulation study.
fig.  <dig> the impact of mutation rate on the topological accuracy of mle-length. we assessed the performance of mle-length to characterize the accuracy of multi-locus inference methods since mle-length was generally more accurate than mle, snaq, mpl, and mp . the seven-taxon model conditions had mutation rate θ ranging from  <dig>  to  <dig> . the tripartition distance between an inferred network and the model network was used to measure topological accuracy. average distance and standard error bars are shown 




performance evaluation on empirical datasets
our performance study utilized empirical samples from natural populations of mus musculus subspecies and sister species . prior studies detected gene flow between the m. musculus subspecies  <cit>  and between m. musculus domesticus and m. spretus  <cit> . we focused our comparison on the most accurate methods from each category of multi-locus methods: mle-length from the full likelihood methods, snaq from the pseudo-likelihood-based methods, and mp. we omitted the concatenation methods from our comparison since they were among the least accurate of all methods in our simulation study .

at a coarse level, probabilistic inference using mle-length was able to accurately detect gene flow in the empirical datasets. specifically, the model selection criterion used by mle-length consistently chose solutions with gene flow  as opposed to solutions without gene flow .

as shown in table  <dig>  all of the methods inferred an identical species tree topology when constrained to infer a solution involving zero reticulations. for the inferred phylogenetic networks, greater topological similarity was observed among phylogenies inferred using the same method as opposed to phylogenies inferred using different methods. furthermore, greater topological agreement was observed when solutions were constrained to have no gene flow, as opposed to solutions involving gene flow. based on intra-method comparison of inferred networks, the greatest topological agreement was observed among mle-length, followed by snaq, and then mp. topological comparison of the different methods  yielded topological distances which were the highest observed in our empirical study, and comparable disagreement was observed between the different pairs of methods as measured by average topological distance.
phylogenies were inferred using a representative method from each category of multi-locus methods: mle-length , mp , and snaq . the normalized tripartition distance between solutions that included gene flow  is shown as an average  across replicates . when constrained to infer a phylogenetic tree rather than a phylogenetic network, all methods inferred an identical species tree across all replicates. each replicate dataset consists of randomly selecting a sample from the following mouse species and subspecies: mus musculus domesticus, m. musculus musculus, m. musculus castaneus, m. spretus, m. spicilegus, and m. macedonicus





we further evaluated whether the methods detected known instances of interspecific and intersubspecific gene flow: the former involving gene flow between m. musculus domesticus and m. spretus and the latter involving gene flow between the m. musculus subspecies. mp, snaq, and mle-length inferred a phylogenetic network consistent with gene flow between m. musculus domesticus and m. spretus in  <dig>   <dig>  and  <dig> replicates, respectively ; the three methods inferred a network consistent with intersubspecific gene flow among the m. musculus subspecies in  <dig>   <dig>  and  <dig> replicates, respectively.

we also compared the phylogenetic networks inferred by mle-length, snaq, and mp to a consensus mus species tree obtained from prior literature studies  <cit> .  the bipartitions in the consensus tree were consistently inferred by the different methods. compared to mp, the probabilistic multi-locus methods more frequently inferred reticulations that were consistent with known interspecific/intersubspecific gene flow; however, the methods largely disagreed on the exact location of reticulation within the phylogeny.

discussion
the probabilistic multi-locus methods were the most accurate methods in our study, but they were also among the most computationally intensive methods in terms of runtime. snaq was the fastest probabilistic multi-locus method in our study, but was not generally more accurate than the full likelihood methods; our findings are consistent with the observations of solís-lemus and ané  <cit> . however, given ten days of runtime, none of these methods completed analyses of datasets with more than two dozen taxa. our finding resolves an open question in the literature: can state-of-the-art phylogenetic network inference methods scale to dataset sizes typically seen in today’s phylogenomic studies? our study has shown that the answer is no, despite the methodological tradeoffs made by some of the methods. for example, the pseudo-likelihood-based methods use an approximation to full likelihood calculations under the coalescent model to improve scalability. based on the discussion in the study of solís-lemus and ané  <cit> , we expected that the tradeoff would yield at least several factors of runtime improvement compared to full likelihood methods, at the cost of reduced topological accuracy. instead, the tradeoff only scaled up analyses of around  <dig> to  <dig> taxa. on datasets with more than  <dig> taxa, the computational requirements of the probabilistic multi-locus methods are projected to be nearing the limits of the most powerful computational clusters available to us. this dataset size is the largest in our study and yet is not considered large in the context of today’s phylogenomic studies. we expect that, like the full likelihood method, the pseudo-likelihood-based methods’ memory requirements will grow super-linearly as dataset sizes increase past an inflection point. finding the inflection point will require additional experiments using dataset sizes larger than those explored in our study.

our study generally shows that the performance comparison between the different classes of methods holds as dataset size and divergence increases, and further quantifies the impact upon topological accuracy. increasing either of the two dimensions of scale – the number of taxa and sequence divergence – generally reduced the topological accuracy of each method. both observations are consistent with related studies of phylogenetic tree inference in the presence of gene flow  <cit> ; the studies also suggest other factors impacting scalability . the heuristic approaches necessary for analysis of np-hard optimization problems contribute to the methods’ scalability; practical issues such as local optima in the search space can pose major challenges to the performance of these heuristics. we observed a u-shaped trend where topological accuracy improved slightly as the mutation rate θ increased from  <dig>  to  <dig> , and accuracy rapidly degraded as the mutation rate increased past  <dig> . the trend is likely due to two factors. first, we conjecture that the model condition with the smallest mutation rate in our study had relatively low sequence variation and therefore offered little phylogenetic signal. second, increased sequence divergence due to increasing mutation rates reduced the accuracy of inferred gene trees, which is consistent with theoretical expectations and empirical observations about long branch attraction in other phylogenetic studies  <cit> . the inferred gene tree error observed in our study  was comparable to that of other performance studies  <cit> , ranging from  <dig>  to  <dig>  as θ grew from  <dig>  to  <dig>  for the seven taxon model.

our study included probabilistic multi-locus methods that either accounted for or ignored branch length information in input gene trees. in particular, mle-length and mle were identical methods with one major exception: the former calculated model likelihood using gene tree topologies and branch lengths  <cit> , whereas the latter substituted the approach of degnan and salter  <cit>  which calculates model likelihood using only gene tree topologies. we found that mle-length returned greater topological accuracy than mle, which is consistent with the prevailing opinion that models incorporating branch length information will be generally more accurate than inference under related models that ignore branch length information  <cit>  . the pseudo-likelihood-based methods  were less accurate than the full likelihood methods. this is expected as pseudo-likelihood-based methods were designed to tradeoff inference accuracy for computational efficiency. consistent with other performance studies examining the related problem of scalable phylogenetic tree estimation  <cit> , the parsimony-based multi-locus method were not as accurate as the most accurate probabilistic multi-locus method. the topological accuracy of mp improved somewhat as dataset size increased from  <dig> to  <dig> taxa. we attribute this finding to long branch attraction, where increasing numbers of taxa and constant model phylogeny height resulted in denser taxon sampling. the impact of long branches on parsimony-based phylogenetic inference is well understood  <cit> , and may cause it to be more vulnerable to long branch attraction issues compared to the other probabilistic methods in our study. we also compared the most accurate multi-locus inference method  to two concatenation methods . the concatenation methods were less accurate than mle-length as dataset size increased from  <dig> to  <dig> taxa. these results are supported by other performance studies focusing on the problem of phylogenetic tree estimation  <cit> .

using an information theoretic approach for model selection, mle-length consistently inferred historical gene flow between the sampled mouse populations in our study, which is consistent with prior studies  <cit> . mle-length was the most accurate method in terms of detecting gene flow supported by literature evidence. similarly, mle-length was the only tested inference method that detected the two gene flow events supported by the literature . snaq was the second most accurate method, and detected gene flow among the m. musculus subspecies but not between m. musculus domesticus and m. spretus. mp was least accurate and detected gene flow between m. musculus domesticus and m. spretus but not among the m. musculus subspecies. these findings support the observations in our simulation study, where full likelihood-based methods returned improved accuracy compared with pseudo-likelihood-based and parsimony-based methods. for inferred networks, none of the methods were robust to the choice of sampled taxa. this suggests low support which could be due to several causes, including the impact of dataset size and sequence divergence on inference error  and/or a soft polytomy due to a short branch involving m. musculus subspecies . furthermore, except for mp, the topological distances observed in the empirical study were larger than the topological errors observed in comparable datasets from our simulation study. even assuming that a species phylogeny inferred on one of the replicates was correct , the topological distances between inferred phylogenies imply that inferences on many of the other replicates would have error comparable to or greater than those observed in the simulation study. one contributing factor is that the empirical datasets may pose a more difficult inference problem since they reflect a broader array of evolutionary processes than those involved in the simulation study. for example, positive selection and recombination have been shown to play significant roles in the evolution of the natural house mouse populations that were sampled in our study  <cit> .

CONCLUSIONS
in this study, we have evaluated the scalability of state-of-the-art methods for inferring phylogenetic networks from multi-locus sequences that evolved under genetic drift/ils, gene flow, and point mutations, where much of the difficulty of this inference problem is due to the complex interplay of all three evolutionary processes. . we quantified the performance of the methods in terms of computational runtime, main memory usage, and topological accuracy on datasets that varied along two separate dimensions of scale: the number of taxa and sequence divergence.

the methods in our study face tremendous scalability challenges on datasets that are well within the scope of today’s phylogenomic studies. in terms of accuracy, the probabilistic multi-locus methods outperformed the other methods, which is consistent with the state of the art of phylogenetic tree inference. for this reason, we generally recommend using the former – particularly mle or mle-length, a full likelihood-based approach – rather than the latter. the latter included concatenation methods – the predominant approach used in today’s phylogenomic studies. more taxa and greater sequence divergence degraded the topological accuracy of all methods. while the probabilistic multi-locus methods retained a performance advantage in terms of topological accuracy, their computational requirements were excessive. on datasets with fewer than  <dig> taxa, the pseudo-likelihood-based multi-locus method  generally completed analysis within a day using around a few gib of main memory or less; the full likelihood multi-locus method  was able to analyze datasets with around  <dig> taxa within a day and required around  <dig> gib of main memory; the full likelihood multi-locus method  was able to analyze datasets with around  <dig> taxa within a day and required around  <dig> gib of main memory. the computational requirements of the probabilistic multi-locus methods grew rapidly as the number of taxa increased and became prohibitive on datasets with more than  <dig> taxa. we note that, in a sense, the two dimensions of scale act in opposition: increasing taxon sampling can help reduce individual branch lengths and mitigate the negative effect of long branch attraction on inference accuracy, but comes at the cost of increasing the number of taxa which increases runtime requirements and can also increase inference error as well.

we highlight several aspects of our study for future work. most importantly, our study has highlighted the clear need for new phylogenetic inference methods that can cope with the scale of current phylogenomic studies, involving as many as hundreds of genomes; the near future will bring studies that are orders of magnitude larger. we anticipate that our study foreshadows new methodological development on the topic of large-scale phylogenetic network inference. an expanded empirical study with larger datasets will be possible as future studies follow up on initial reports of gene flow among natural populations  and perform additional sequencing. finally, we propose that the dichotomy between the different categories of methods in our study represents an algorithmic engineering opportunity. by synthesizing these approaches, advantages in one category of methods can help offset disadvantages in the other.

additional file

additional file  <dig> appendix with supplementary material. appendix, including text, tables, and figures for supplementary experiments. 

 


abbreviations
hmmhidden markov model

ilsincomplete lineage sorting

mdcminimize deep coalescence

mlemaximum likelihood estimation

mplmaximum pseudo-likelihood

mpmaximum parsimony

rf distancerobinson-foulds distance

snaqspecies networks applying quartets

the authors would like to thank several anonymous reviewers for their detailed comments which helped to improve the manuscript. faculty startup funds from michigan state university to kjl were used to pay for publication costs. this work has been partially funded by support from the national science foundation  and michigan state university .

funding
publication charges for this article were funded by faculty startup funds from michigan state university to kjl.

availability of data and materials
all software implementations and datasets are publicly available under open license. more information and download urls can be found at https://gitlab.msu.edu/liulab/network-inference-scalability-study/.

authors’ contributions
conceived and designed the experiments: hah kjl. implemented software tools: hah. performed the experiments: hah. analyzed the data: hah kjl. wrote the paper: hah kjl. both authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
