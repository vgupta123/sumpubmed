BACKGROUND
the identification and characterization of susceptibility gene variations relevant to common complex diseases is one of the central goals of human genetics. recent advances in genetic technology, such as high-throughput genotyping techniques based on microarrays, have presented not only substantial opportunities but also unprecedented challenges for resolving the genetic architecture of complex diseases. for example, genome-wide association studies  have recently been established, in which a huge number of single-nucleotide polymorphisms  across the whole genome are examined in a sample of cases and controls to determine which snps are associated with a specific disease  <cit> . while gwas have already achieved a certain degree of success in newly detecting disease-associated snps, a large proportion of the genetic factors involved in complex diseases has yet to be uncovered. this might be partly because current gwas have primarily focused on testing association of only a single snp at a time. because of the sophisticated regulatory mechanisms encoded in the human genome, complex diseases are speculated to be caused by multiple variations and their interactive effects, which are referred to as epistatic interactions. these variations possibly contribute to a certain disease only by pure interactions whereas they may show little effect individually. such variations would not be detected in single-variation association analyses. identifying the epistatic interactions will therefore likely be key to further understanding the pathogenesis of complex diseases.

identifying epistatic interactions between multiple snps remains both statistically and computationally challenging in large-scale association studies. the challenges include the high-dimensionality problem, computational capability, the absence of marginal effects, the multiple testing problem, and genetic heterogeneity. some computational methods have been proposed to address this problem, other than traditional parametric statistical methods such as logistic regression. they can be roughly divided into three categories on the basis of their optimization strategies: brute-force search methods, greedy search methods, and stochastic search methods. brute-force search methods, such as the multifactor-dimensionality reduction , basically rely heavily on exhaustively verifying all possible snp combinations. greedy search methods, such as the set association approach  <cit> , select snps one by one such that selected snp combinations have maximum interactive effects. since the first snp is selected on the basis of a univariate test, these methods will fail to detect snp combinations when marginal effects of each snp are weak or absent, even if they do have effects caused by interaction. most methods suffer from the multiple testing problem. adjusting for multiple testing results in a decrease in power to detect weaker associations of susceptibility snps. furthermore, an additional concern that previous methods have confronted is the presence of genetic heterogeneity; that is, there might be multiple different genetic factors that are independently associated with the same disease. methods that lump an entire sample into a single group to assess the average effects will likely degrade their power to detect associations.

recently, interest has grown in applying machine learning techniques to analyzing genetic association studies due to their ability to thrive on large-scale and high-dimensional data. in one recent study, bayesian epistasis association mapping  designed a form of bayesian model selection and used a markov chain monte carlo sampling strategy to estimate the model parameters. a recent approach called snpharvester  <cit>  searches for snp groups with significant associations on the basis of an enhanced variation of the genetic programming algorithm. these methods perform reasonably in certain model cases. however, not all the concerns have been fully addressed: the detection power of susceptibility snps is still not sufficient and the effectiveness in the presence of genetic heterogeneity has not been validated; in addition, they all partly utilize statistical association tests with adjustments for multiple testing applied. thus, further high-performance methods are still desired from different perspectives.

in this study, to identify epistatic interactions in large-scale association studies, we propose a new method that uses an ensemble learning technique called random forest  <cit> . the random forest technique is a tree-based predictive method, which produces a series of classification trees using a large set of predictor variables. it was proposed as a way to discover the snps that are most predictive of the disease status in large-scale association studies . the technique can detect snps that are likely to affect disease susceptibility from among a large number of snps, taking into account the effects of interactions among them at some level. it has, however, some limitations for identifying epistatic interactions. first, it may perform poorly in detecting snps that have little marginal effect. furthermore, it does not natively exhibit information on interaction patterns of susceptibility snps. we extend the random forest framework to overcome the limitations and establish an applicable method for identifying epistatic interactions. having been developed with all the above-mentioned concerns taken into consideration, this method avoids many of the difficulties previous approaches have faced and proves to be very effective in a wide range of simulations reflecting practical disease models that incorporate the absence of marginal effects and also genetic heterogeneity.

RESULTS
analysis using simulated data
models of epistatic interactions with weak marginal effects
we considered three disease models with different characteristics: an additive model that contains two snps that independently contribute to the disease risk, a multiplicative model that involves interactions of two snps with multiplicative effects, and a threshold model that involves interactions of two snps with threshold effects. the marginal effect size was set to Î» =  <dig> . for r <dig>  two values  were used for data simulation; for the maf, four values  were considered. there were thus eight parameter settings for each disease model.

by using snpinterforest, the importance of the snps concerned was found to be clearly distinguishable from that of the others by the importance score derived in this method. besides, the interaction score using the number of simultaneous appearances in tree branches in the random forest is shown to be able to correctly identify the interaction of these snps. figure  <dig> compares the simulation results of snpinterforest with those of boost  <cit>  and snpharvester  <cit> . for reference, power of the single-locus chi-square test to detect both loci in the interaction with a rather liberal threshold of  <dig>   is also given in the figure. the results show that snpinterforest outperforms both boost and snpharvester for all three models. in practice, the performance of boost is significantly low in the cases with low maf for the additive model, and in the cases with high maf for the multiplicative and threshold models. as discussed in  <cit> , maf at disease-associated snps strongly influences the detectability of those snps. since boost is based on statistical tests through an exhaustive search strategy, correction for multiple testing might become a severe burden where multilocus information is not so large as to negate its cost; the interaction-based search involves  <dig> times as many tests as the single-locus search does. snpharvester also utilizes in part statistical association tests. on the other hand, snpinterforest achieves better or even considerably higher performance even in these parameter settings. as for precision, snpinterforest and snpharvester do not detect any spurious associations, whereas boost falsely detects five interactions among these datasets.

models of pure epistatic interactions without marginal effects
first of all, we studied simple models where two snps are involved in the etiology of disease by a pure epistatic interaction; these are the original models of velez et al.  <cit> . here, six models with the parameters set to practical values were considered .

the proposed method was further examined to test whether it can identify interactions involving more than two snps. for this purpose, we considered a disease model that contained three snps interactively associated with disease: two that are moderately associated with disease by a pure epistatic interaction and another with a weaker effect that amplifies the interactive effect in collaboration with the other two. five simulated datasets reproducing this model were constructed by redesigning the above two-snp interaction model for moderate association  such that one of the non-associated snps was realigned to interactively affect disease susceptibility with the two associated snps. the interaction score was computed for combinations consisting of three snps. the three interacting snps are successfully captured by the interaction score for all five datasets . the results suggest that the proposed method can be directly generalized to identify higher-order interactions. these interactions are not identified by snpharvester. boost cannot identify interactions with more than two snps.

second, we explored the case where multiple epistatic interactions affect disease susceptibility, which is likely to happen especially in the pathogenesis of complex diseases. here, we considered six hybrid models, which included five interactions each involving two snps. for each hybrid model, we constructed simulated datasets by mixing five datasets from each of the above single two-snp interaction models, respectively . furthermore, we extended the simulation studies to incorporate genetic heterogeneity. to mimic heterogeneous causal interactions, we constructed simulated datasets for heterogeneous models again using the single two-snp interaction models, but in this case by simply combining two datasets from each of the models. that comes to six heterogeneous models containing  <dig> cases and  <dig> controls, which include two interactions that independently predispose respective halves of the patients to the same disease.

it was found that snpinterforest can simultaneously detect snps that affect disease susceptibility in multiple ways. of particular importance is that it can automatically identify the interacting snp combinations by the interaction score. tables  <dig> and  <dig> summarize a comparison of the number of interacting snp pairs detected in the simulation by snpinterforest, boost, and snpharvester for hybrid models and heterogeneous models, respectively. snpharvester identifies only a portion of the multiple interacting snp pairs in each dataset. boost considerably outperforms snpharvester. however, it also suffers to some extent from false positives. snpinterforest performs comparably to boost in most cases, keeping false discovery rates lower. the results suggest that the new method can effectively contribute to concurrently identifying multiple interactions, even under the existence of genetic heterogeneity.

false discovery rates evaluation on null simulations
as already mentioned in previous subsections, snpinterforest is not affected by deleterious rates of spurious detection in contrast to achieving high recall rates. on the other hand, the tradeoff between power and precision has been classical suffering . to further approximate the precision, we simulated datasets without any disease-associated snps. we constructed  <dig> datasets containing  <dig>  snp markers genotyped for  <dig>  cases and  <dig>  controls, where the snps were generated independently with maf uniformly distributed in . the running parameters for the programs were set in the same way as for the disease models. in the null simulations, snpinterforest did not report any false positives.

analysis using real gwas data
we performed snpinterforest on real gwas data of rheumatoid arthritis  from the wellcome trust case control consortium , which consisted of about  <dig> k snps and  <dig>  individuals . the wtccc distributes two control samples , each of which contains  <dig>  individuals. because the latter sample cannot be accessed by commercial organizations, we used only the former. we narrowed the search down to the top  <dig>  snps selected by single-locus association study to accommodate computational requirements. it took about  <dig> hours for snpinterforest to handle it on a linux system with a single cpu  and a memory of  <dig> gb. the running time of snpinterforest, snpharvester, and boost on this dataset is summarized in table  <dig>  we note that snpharvester requires substantial memory space and its running time is highly sensitive to the size of memory. snpinterforest identified two novel interactions from this dataset, which are summarized in table  <dig>  information on genes related to the snps in these interactions is also provided in table  <dig>  although biological interpretation of the interacting snps is yet unclear, there are some functions in these genes that seem to have possibility to relate with ra, such as inflammatory response in the gene prok <dig>  these interactions were also identified by boost. boost detected a dozen of other interactions, which were not detected by snpinterforest.

angiogenesis, cell proliferation, chemotaxis
inflammatory response
positive regulation of smooth muscle contraction
germ cell development
CONCLUSIONS
we proposed a new effective method, named snpinterforest, for identifying epistatic interactions in large-scale association studies by extending an ensemble learning technique called random forest. snpinterforest, which introduces a new procedure to capture snp interactions on the basis of the tree structure in the random forest and modifies the construction method of a random forest, offers an efficient means to detect epistatic interactions without statistical analyses. although it is relatively computationally expensive, the effectiveness of the proposed method was verified in extensive simulation studies under a wide spectrum of disease models. this method achieved considerable improvements compared to the original random forest in identifying pure epistatic interactions, and outperformed the existing methods in high recall rates while keeping low false discovery rates. encouraged by the success in detecting multiple snp interactions, we plan to extend our current method in the future to infer the overall genetic network involved in the pathogenesis of complex diseases. the software is available at: https://gwas.lifesciencedb.jp/snpinterforest/index.html.

