BACKGROUND
ready access to vast sequence databases and new data emerging from large-scale sequencing efforts is transforming efforts to infer the phylogenetic history of species. efforts to build ever larger subtrees of the "tree of life" are pushing the field to grapple with highly species-rich data sets . at the same time, some recent studies exploiting complete genome sequences or genomic libraries include 100s - 1000s of loci  <cit> . the former tend to be data sets with many taxa and few loci; the latter few taxa and many loci. however, the distinction is blurring as larger data sets of both kinds have been constructed using semi-automated assembly pipelines  <cit>  and high performance phylogenetic inference packages .

although such vast data sets have effectively solved certain phylogenetic problems, such as the broad outline of yeast phylogeny  <cit> , in other taxa they have uncovered a surprisingly high level of incongruence and uncertainty . case studies in drosophila  <cit> , rice  <cit> , house mouse  <cit> , and primates  <cit>  document processes generating incongruence among gene trees in different parts of the genome that contribute nearly as much to the signal as the true species history does. phylogenetic methods are struggling to keep pace with inferential complications arising from these processes, such as the potential for statistical inconsistency when sequences are concatenated  <cit> . indeed, a minor paradigm shift appears to be occurring toward retaining the individuality of signals associated with small genomic regions  rather than simply concatenating all sequence data into an overall analysis  <cit> . this approach comprises so-called "supertree" methods  <cit>  in the broadest sense of that term. in phylogenomic contexts this includes methods that explicitly try to build species trees while reconciling gene trees by modeling processes at the interface between phylogenetics and population genetics, such as lineage sorting  <cit> , recombination  <cit>  and hybridization  <cit> .

in addition to biological processes which evidently confound phylogenomic inference are complexities that stem from the origin of the data themselves. one of the hallmarks of typical phylogenomic data sets is partial taxon coverage among loci–by which we mean not merely missing nucleotides within an alignment but loci for which an entire sequence is missing for some taxa . missing data arise from causes including biases in sequence databases, the technicalities of sequencing strategies, and real evolutionary processes of sequence divergence or gene loss. whenever sequences from genomic libraries such as ests or bac-ends provide only partial coverage of a genome, the mismatch between regions covered in different species will generate missing data. whole genome shotgun sequencing using technologies that assemble at low coverage values will likewise entail missing data, especially at broader phylogenetic scales. even finished whole genomes can fail to have homologs in a collection of species for various reasons ranging from accelerated sequence divergence to gene loss  <cit> . it is not unusual for finished genomes to have numerous genes with no detectable homologs in any other taxon .

the consequences of missing data for phylogenetic inference were first studied in the context of integrating fossil taxa, in which there are typically large subsets of missing morphological data, with more complete extant taxa  <cit> . more recently the impact of missing data on accuracy of inferred trees has been examined in the more general context of molecular and phylogenomic data sets  <cit>  where missing data arises for a variety of reasons. collectively this body of work treats missing data at the scale of individual cells in a taxon by character data matrix or sequence alignment up to entirely missing sequences for some taxa in a supermatrix or supertree setting, which is the phylogenomic context we consider here. conclusions about the negative impact of missing data on accuracy have ranged from optimistic  <cit>  to somewhat more cautious  <cit> ; it is possibly fair to say that many empirical studies have argued that the impact of missing data tends to be unbiased and can be ameliorated by sufficient overall quantity of data , and most simulation work agrees . however, there has been frequent speculation about the distribution of missing data in the matrix . general conclusions have remained elusive both because of lack of characterization of this distribution and the difficulty of separating the usual problems of phylogenetic inference–error and bias caused by the data–from the simple absence of data.

in the phylogenomic context of multiple loci, a natural question is when can phylogenetic information from different loci be combined to produce a good tree with all taxa present, even when taxa are missing for some loci? ideally this question should be abstracted away from the details of tree reconstruction methods. we derived some formal results recently for a relatively simple notion of combinability - "decisiveness" . a pattern of taxon coverage is decisive for some tree on all the taxa in a multi-locus data set if that tree is uniquely defined by combining the  trees from the separate loci. our previous paper  <cit>  focused on a strong sense of decisiveness: decisiveness for all trees. in this paper we also consider weaker notions of decisiveness, derive further results on decisiveness in the important context of sampling from genome-scale data, and examine the utility of the concept in real phylogenomic data sets. the theory will permit us to make relatively precise statements about matters such as the amount and distribution of missing entries, at least within bounds. the scale of phylogenomic data sets and the sampling properties of genomic sequencing protocols is likely to increase the relevance of our mathematical theory.

methods
overview
this section outlines several mathematical results, so we begin with an intuitive description of its main point. we assume a phylogenomic data set consists of k loci  and n taxa. loci with data present for fewer than n taxa have "missing data". missing data across the entire data set can thus be characterized by the pattern of "taxon coverage", the set of sets of taxa present for each locus or tree . the basic idea of the paper is that we would like taxon coverage to be "decisive" for the true tree of all n taxa. this means that, taken together, all the subtrees of the true tree corresponding to the partial taxon sets at the different loci should be sufficient to uniquely define the true tree. surprisingly, this is not true for many patterns of partial taxon coverage. this goal is independent of the sequence data, i.e., whether the loci agree on one tree or contain sufficient data to infer any tree. setting those issues aside lets us isolate the effects of taxon coverage itself. without sufficient coverage, even the best data will fail to recover a tree even if the underlying data themselves are of impeccable quality.

questions about taxon coverage arise in at least two contexts. in the first, taxon coverage is given a priori. this might happen when a data matrix has already been assembled from genbank, or in an examination of a data set from the literature. in this case, the true tree is unknown, and the key question is whether the data set is decisive for all trees, some trees, or no trees. in the second context, taxon coverage can be modeled as the outcome of a sampling process. this might result from a sequencing strategy, for example, that induces a certain quantity of missing data, but for which those data are more or less randomly distributed. here the pertinent question is how many loci must be sampled to guarantee decisiveness for the unknown true tree.

definitions
we begin by recalling some basic definitions from phylogenetic theory. following semple and steel  <cit> , given a set x of taxa, a phylogenetic x-tree is a  tree t in which the leaves, or terminal taxa, of t consist of the label set x  and all the remaining vertices  of t are unlabelled and have at least three incident edges. t is binary  if every internal vertex has exactly three incident edges. for a phylogenetic tree t and a subset y of x, let t|y denote the induced phylogenetic tree on leaf set y . we will let n = |x| throughout. a quartet tree is a binary phylogenetic tree on four leaves. for such a tree with leaves a, b, c, d, we write ab|cd if the internal edge of the tree separates the pair a, b from c, d.

a rooted phylogenetic tree is a tree obtained from a phylogenetic tree by deleting some leaf and its incident edge and regarding the other endpoint of that edge as a root vertex. rather than defining the notions that follow for both rooted and unrooted phylogenetic trees separately, we will define them just for unrooted trees; the analogous definitions for rooted trees follow immediately by regarding any rooted tree on a set of n taxa as an unrooted phylogenetic tree on n+ <dig> taxa, the additional taxon being some fixed reference outgroup .

we now define some key concepts. let y be the  set of taxa with nonmissing data for some locus .

• whenever y ⊆ x, we say that a binary phylogenetic x-tree t displays a binary phylogenetic y-tree, t' if t|y = t'. more generally, for y ⊆ x, we say that a phylogenetic x-tree t displays a phylogenetic y-tree, t' if t|y either equals t' or is a resolution of that tree .

• we say that a collection of phylogenetic trees t <dig> ...,tk defines a phylogenetic x-tree t if x is the union of the leaf sets of the trees t <dig> ...,tk and there exists one, and only one phylogenetic x-tree that displays these trees, and this tree is t. this implies t that must be binary.

• an internal edge e of a binary tree t is said to be distinguished by some other tree if both trees display a quartet tree xy|wz but the tree t/e  does not display this quartet . there is an analogous notion of 'distinguished' for rooted trees based on rooted triples rather than quartet trees. for example, in figure 2a the internal edge below the clade c, d of the original tree  is not distinguished by either of the two subtrees  shown; however in figure 2b all three interior edges of the original tree  are distinguished by the subtrees .

• for a collection s = {y <dig>  ..., yk} of subsets of x, we say that s is the pattern of taxon coverage or just taxon coverage . any taxon found in all k subsets is called a reference taxon. the taxon coverage density is .

• we say that s is decisive for a phylogenetic tree t provided t|y <dig> ...,t|yk defines .

• we say that s is phylogenetically decisive for all trees if it satisfies the following property: if t and t' are binary phylogenetic x-trees, with t|y = t'|y for all y ∈ s then t = t'. in other words, for any binary phylogenetic x-tree t, the collection of induced subtrees {t|y:y ∈ s} defines t.

these last two definitions are from  <cit> , although we now adopt the convention of saying "decisive for all trees" instead of merely "decisive". notice that a pattern of taxon coverage that is decisive for a given tree can involve far fewer loci than any pattern of taxon coverage that is decisive for all trees; for instance, for every binary phylogenetic tree t, there is a set s of just n -  <dig> quadruples  for which s is decisive for t  <cit>  but any set of quadruples that is decisive for all trees must have size that is at least cubic in n .

notice that there is a subtle but fundamental distinction between questions about whether an arbitrary collection of input trees, t <dig> ...,tk, defines a unique tree, t, on the one hand, and whether a pattern of taxon coverage, s = {y <dig> ...,yk}, together with a tree, t, induces a set of subtrees, t|y <dig> ...,t|yk, that uniquely defines t. intuitively, in the first case the focus is on the subtrees, whereas in the second the focus is the pattern of taxon coverage. the term "define" refers to the first context; "decisive" to the second. what does it mean when taxon coverage is not decisive for all trees? then there exists two or more distinct trees which cannot be differentiated from one another based only on the subtrees induced by the taxon coverage pattern, because these trees induce the same set of subtrees. of course, these may or may not include the "true tree" for any given problem in phylogenetic inference, but surely it is risky to be unable to distinguish among possibilities in case the true tree is involved.

context 1: taxon coverage is fixed a priori
in this context, we assume s is given. steel and sanderson  <cit>  established exact conditions for when a pattern of taxon coverage, s, is decisive for all  trees. briefly, for every four-element partition of the label set, there must be a quadruple of taxa in some set in s such that each element of the quadruple is found in a different element of the partition. in general testing this "four-way partition" condition is computationally expensive, as the number of four-way partitions is exponential in the size of the label set. easier to compute are  a necessary condition, which is that for each triple  there must be at least one taxon set in s containing that triple  <cit> , and  a sufficient condition, which requires that, assuming a reference taxon exists, every quadruple containing that reference taxon has at least one taxon set in s containing this quadruple. see figure  <dig> for some simple examples. the necessary condition can be quickly used to determine when taxon coverage is not decisive for all trees, and the fraction of triples present may provide an indication of the impact of low taxon coverage. below we give several empirical examples.

it is also possible to derive some lower bounds on the number of loci required for phylogenetic decisiveness for all trees. we begin with the simpler case of subtrees defining a tree. a necessary condition for an arbitrary collection of subtrees to define a tree is given by  <cit> : if t <dig> ...,tk define a phylogenetic tree with n leaves then:   

where ι refers to the number of internal edges of tj. for example, at least n- <dig> quartet trees are needed to define a tree with n leaves. a similar necessary condition holds for decisiveness for a given tree. since ι is at most the number of leaves of tj minus  <dig> it follows that if s = {y <dig> ...,yk} is phylogenetically decisive for t then:   

 <cit> , where nj = |yj |. as noted in this last paper, inequality  is not tight in the following sense: certain nine-leaf binary trees cannot be defined by any two six-leaf subtrees, even though inequality  is satisfied since  + ≥ .

a consequence of inequality  is that if the sets y <dig>  ..., yk each have size at most m then a lower bound on the number of loci required for decisiveness for a given tree is:   

similar bounds can be obtained for phylogenetic decisiveness for all trees.

theorem  <dig> if a collection s = {y <dig>  ..., yk} of subsets of x is phylogenetically decisive for all trees then:.

where nj = |yj|. in particular, if each of the sets in s has size at most m then:  

. this provides a necessary condition, or lower bound, for phylogenetic decisiveness for all trees. roughly speaking, if some fraction of taxa, f = m/n, is present for each locus, then we need at least  <dig> loci for decisiveness for all trees, while at least  loci are required for decisiveness for a given tree.

partial decisiveness
if we knew t, it would be sufficient to use results on defining trees to describe the taxon coverage needed to define t from subtrees. in practice we do not, and to play it safe, we require sufficient taxon coverage for all t . this may be too strong a requirement. perhaps it is sufficient for taxon coverage to be decisive for most trees, assuming then that the true tree is likely among this set of trees. figure  <dig> shows an example in which taxon coverage is not decisive for all trees , but is decisive for  <dig> out of  <dig> possible rooted trees for  <dig> taxa. this example suggests it would be useful to enumerate or estimate the fraction of trees for which s is decisive.

determining when taxon coverage is decisive for only some trees involves an important open question. when exactly does a set of subtrees define a tree? the bound stated earlier does not specify how to tell if some set of n- <dig> or more quartet trees defines a tree. the answer is known for rooted  <cit> , but not for unrooted trees. a collection of rooted trees defines a tree if two conditions are met: each subtree is displayed by the tree, and each internal edge of the tree is distinguished by an internal edge of at least one of the input trees . in contrast to the rooted setting, distinguishing all the edges of an unrooted tree is only a necessary  condition for a collection of unrooted trees to define that tree. to proceed, we therefore restrict attention to the rooted case, which is equivalent to assuming there exists in the data set a reference taxon which can provisionally be used to root the input trees .

for rooted trees, the fraction of trees, ∏d, that are decisive for a given pattern of taxon coverage could be determined by checking these conditions for all possible trees. for small sets of taxa complete enumeration is feasible. for larger data sets, the true fraction of trees for which the taxon coverage is decisive can be estimated from the fraction in a large random sample of trees .

however, the condition of distinguishability of edges suggests a potentially more sensitive measure of "partial" decisiveness: the probability of an edge being distinguished on a tree for a given pattern of taxon coverage, ∏d. this is the fraction of edges on the tree that are distinguished by subtrees induced by the taxon coverage pattern, averaged across all trees, or a random sample of trees. we examine these measures of partial decisiveness in empirical examples below.

context 2: taxon coverage is the product of a random sampling process
in this context the taxon coverage is not fixed but instead is determined by a random process of sampling. this might be a reasonable model for data assembled from partial genomic coverage, for example. the question we want to address is how many loci must be sampled to guarantee with some high probability that the taxon coverage will be decisive for some unknown tree t. in this context we need not require that it be decisive for all trees, because the results we derive will hold for any tree t and the true tree will be one of these. this is a subtle difference compared to the first context of a fixed taxon coverage pattern, where it made sense to require decisiveness simultaneously for most if not all trees. one way to understand this is to realize that because the sampling scheme is generating random patterns of taxon coverage, there is a chance that they are decisive for any particular true tree, and the probability calculations will be derived on this assumption. 

let t be an unknown binary phylogenetic x-tree, and suppose we independently sample k random subsets s <dig> ...,sk of x according to the following process: for each i, taxon x is included in si with probability p, independently of other taxa. we will first consider two cases:

• uniform coverage : p = p for all taxa x in x;

• uniform  coverage: p =  <dig> for one taxon y in x, and p = p for all other taxa x in x. this is the case in which a reference taxon is present. later we will discuss possible extensions of this model to allow variable taxon coverage probabilities across a tree.

recall that taxon coverage pattern leads to a set of induced subtrees for each locus, t|s <dig> ...,t|sk. previously we assumed there was no conflict among these induced trees–they could be reconstructed accurately, but here we can obtain some results even if these induced trees are not fully resolved. we use a simple random model for lack of resolution in the induced trees. it does not explicitly model the possible sources of this loss of resolution, such as multiple hits in sequence data, but it provides a tractable starting point. assume for some fixed probability q that each edge in t|si  is retained with probability q or collapsed with probability 1-q, and this is done independently across the edges of t|si, and across the different induced trees. let  denote the resulting set of partially-resolved induced subtrees of t. let ek be the event that  defines t.

we are interested in computing bounds on the probability p) of this event that depend just on p, q and the total number of taxa n =|x|. it is useful to distinguish two further cases:

• rooted: t  are rooted trees;

• unrooted: t  are unrooted trees.

let r denote the set of rooted binary trees on n leaf taxa, and u the set of unrooted binary trees on n leaf taxa. note that by rooting a tree on an arbitrary taxon we can view u as equivalent to r. moreover, in what follows the uc condition applied to r is essentially equivalent to the uc+ <dig> condition applied to u.

theorem  <dig> . for any rooted tree t in r, under uc  under uc+1) we have: p)≥ 1- · k. consequently, for ε >  <dig>  if .

moreover, for any unrooted tree t in u under uc, p) ≥  <dig> - ε holds if the term p <dig> in the above inequality is replaced by p <dig> 

. conversely, for any ε >  <dig>  if  then there exist  choices of t ∈ r under uc  under uc or uc+1) for which p) <  <dig> - ε .

together these conditions give  upper and lower bounds on the number of loci needed for decisiveness relative to a single  tree. the precise number depends on the shape of the tree.

remarks
when q =  <dig> the event ek is equivalent to the event that s = {s <dig> ...,sk}is phylogenetically decisive for t, but for q <  <dig> the event is a stronger condition. also, theorem  <dig> readily extends to allow the probabilities of taxon coverage to vary across the tree, albeit at the expense of more complicated formulae. however, there is one simple case where the same formulae apply: part  holds as stated if, in the uniform coverage conditions, the equality p = p for all taxa x is weakened to p ≥ p for all x  holds if we impose an inequality in the reverse direction).

we can also consider models that explicitly reflect how taxon coverage is often much more thorough within a clade than across the entire tree, by considering the following clade-specific condition:

• variable coverage : p ≥ p for all taxa x in clade c, and p ≥ p' for any taxon x not in c .

suppose that we have a rooted tree t in r, and for each of its n- <dig> nontrivial clades, we independently generate at least r taxon sets, where each taxon is included or not in each taxon set indepedently with a probability p that satisfies the vc condition for that clade. repeat this independently for all the n- <dig> clades of t ). then the proof of theorem  <dig> easily modifies to show that p) ≥ 1- ε provided that .

empirical examples
we explore these theoretical results in several data sets derived from a diversity of phylogenomic data. we assess whether necessary and sufficient conditions for decisiveness for all trees are satisfied using our theoretical results. we also estimate the partial decisiveness quantities ∏d and ∏d using simulations, because no analytical results are known. we estimated these quantities for each data set using  <dig> replicate simulated random trees generated using paup*'s equiprobable option  <cit> . since the two measures of partial decisiveness can only be estimated on rooted trees, we estimate these quantities in a "reference subset" of the original data set. a reference subset is found by first identifying the taxon with the most loci present in the taxon coverage pattern, pruning all loci not present in this taxon from the entire matrix, and then removing any taxa that have been rendered data-less by this operation. this generates a data set with a reference taxon in the sense defined earlier, which can then be used to artificially "root" the analysis. finally, we assess the bounds on data set size implied under random sampling of loci. in those analyses we assume the unrooted case without a reference taxon and require an error probability no greater than 5%.

data mining examples
driskell et al.  <cit>  mined genbank to build a sparse data set of  <dig> loci and  <dig> green plant taxa with a coverage density of 15% . a necessary condition for decisiveness for all trees is the presence of all triples: since only 84% are present, the taxon coverage cannot be decisive for all trees. indeed for the reference subset the coverage is only decisive for 2% of trees, so the probability of decisiveness for the true tree is quite low. however, on average 95% of internal edges across all trees can be distinguished by the taxon coverage. thus, the coverage is likely inadequate to build the complete binary tree, but there is reason to be optimistic about most of it, at least from the perspective of missing data.

a three phylogenetically uninformative loci removed from original data set of  <dig> loci b phylota database  <cit> 

values in parentheses correspond to the reference subset of taxa. fraction of triples is the fraction of all possible triples of taxa that are present for at least some locus  of the taxon coverage pattern. ∏d is the probability the taxon coverage is decisive for the reference subset on a random binary tree. ∏d is the average number of edges distinguishable on a random binary tree .

we also examined three data sets extracted from the phylota database  <cit> , a tool for phylogenomic data mining of genbank. these were pleurodira , cactaceae , and amorpheae , all based on data from genbank release  <dig> . none of the three were phylogenetically decisive for all trees, because none exhibited all possible triples of taxa. the probability of the taxon coverage pattern being decisive for a random tree for their reference subsets was quite small, ranging from  <dig> to  <dig> %. on the positive side, the fraction of edges that can be distinguished on average for a random tree is quite high, ranging from 61% to 95%.

however, the structure of the largest matrix, for cactaceae is sobering. if we were to continue sampling loci with the same coverage density  in the hopes of constructing a data set with high probability of being decisive for the true tree ,  <dig> loci would be minimally necessary, and  <dig>  would suffice. of course, these results presuppose something like a uniform distribution of sampling effort across taxa, which is more likely to be found in genomic data sets than database mining studies. nonetheless, these bounds are suggestive.

finally, in this category we turn to several studies with very large taxon sets, for which we can only apply some of the simple results in theorem  <dig>  goloboff et al.  <cit>  assembled a supermatrix of  <dig> loci and  <dig>  taxa. the locus with largest taxon coverage included ~ <dig>  taxa. by theorem  <dig> the number of loci would have had to exceed  <dig> for phylogenetic decisiveness for all trees. since most of the loci were sampled for far fewer than this number of taxa, a more accurate lower bound is probably higher.

this analysis, with coverage density of 8%, may be characteristic of taxon rich phylogenetic analyses published recently in which overall density is low, but a few loci have high coverage densities. for example, in  <cit>   and  <cit>   the locus with best coverage, nuclear ribosomal its, actually covered more than 73% and 84% of the label sets respectively, such that by theorem  <dig> the lower bound on the number of loci is small, less than  <dig>  however, in both cases, the its sequences were aligned by relatively "heroic" methods, and a more conservative procedure might have kept many separate taxonomically overlapping its alignments instead of one large one. we reported results from such an analysis  that ultimately included  <dig> taxa in  <dig> loci. by theorem  <dig> the lower bound for decisiveness for all trees in this case, assuming n/m = 1794/ <dig>  where  <dig> is the largest cluster , would have been  <dig> loci, far more than we had.

partial genome sequences from shallow libraries
hejnol et al.  <cit>  constructed a large, sparse phylogenomic matrix of  <dig> taxa and  <dig> loci derived mainly from ests. this is an expanded analysis of the widely cited phylogenomic study of  <dig> metazoan taxa  <cit> . mean taxon coverage density is 18% across all loci, with the maximum density of 83% in one locus and a long tail of very low coverage loci. the given taxon coverage is not decisive for all trees, because it only includes 96% of possible triples . homo sapiens is present in  <dig> of the loci. if we restrict the data to this reference subset, we can "root" the analysis with homo as a reference taxon and test for a sufficient condition for decisiveness for all trees . for these loci there are still  <dig> taxa and 96% of possible triples are present. this fraction might have increased to  <dig> if the number of taxa in the new matrix had been less. this data set stands out by having a relatively high probability of decisiveness for random trees , and a 99% chance of distinguishing a random edge in a tree. under random taxon coverage , by theorem  <dig> the lower and upper bounds on loci are  <dig> and  <dig>  which spans the actual data set.

partial genome sequences from deep genomic libraries
some genomic libraries are "deep", providing 10s to 100s of thousands of sequences, but still only partially cover a genome. cranston et al.  <cit>  analyzed data from bac-end sequences from  <dig> species of oryza including the complete genome of o. sativa and nine deep libraries averaging ~ <dig>  sequences per species. collectively, these covered 44% of the cds  in o. sativa, but because of the random nature of library construction, of course, the pattern of overlap varied from species to species. the data were further filtered to include only single copy exonic regions with homology to o. sativa and having taxon coverage of at least four taxa, a total of  <dig> exonic regions.

a posteriori the pattern of taxon coverage is trivially decisive for all trees because there are  <dig> loci  that have complete coverage–which automatically satisfies the four-way condition described earlier. an additional  <dig> loci are only missing one taxon. however, on average the taxon coverage among these exons averaged  <dig> %. by theorem  <dig> this value under random sampling and full resolution implies lower and upper bounds of  <dig> and  <dig> loci for decisiveness. however, if we consider partial resolution and if only one internal branch is present on average out of the  <dig> internal branches, the bounds increase to  <dig> and  <dig>  among a subset of loci most relevant for  <dig> of the species  fully one quarter produced completely unresolved trees , so this is clearly an issue.

complete genome sequences
phylogenomic data sets constructed from complete genome sequences should suffer least from taxon coverage problems. we used hahn et al.'s  <cit>  analysis of gene families constructed from the  <dig> drosophila complete genome sequences then available. data were downloaded from hahn's frb database http://www.indiana.edu/~hahnlab/fly/dfamdb/drosophila_frb.html and parsed to quantify taxon coverage. loci for which there was at most a single copy of a gene present were retained. of these  <dig>  loci,  <dig> had some taxa missing. the average taxon coverage was  <dig> %. note that this number is somewhat inflated because all loci that had only one taxon sampled  were excluded . clearly with  <dig> loci having complete taxon coverage, there is no problem with phylogenetic decisiveness for all trees. moreover, at this rate of taxon coverage on average, by theorem  <dig>  the number of randomly sampled loci needed for decisiveness for the true tree is bounded by  <dig> -  <dig> loci for  <dig> taxa, and even if resolution among trees were dismal  we would have bounds of  <dig> and  <dig> loci. thus if one were setting out to build a phylogenomic matrix with these data, this simple analysis suggests there are plenty of loci available. interestingly the fractional taxon coverage is so high that even were one able to do this across  <dig> species of drosophila, the number of loci is still bounded by  <dig> -  <dig> 

RESULTS
impact of missing data on multi-locus phylogenetic inference
assessing the effect of missing data on phylogenetic inference has received substantial attention from phylogeneticists over many years , but unambiguous conclusions have been elusive. for some amounts and patterns of missing data, simulation and empirical studies support the conclusion that its impact can be reduced to tolerable levels  <cit> ; for other cases, significant problems remain  <cit> . properties of the data themselves, such as rates of evolution, stationarity, etc., can have a strong impact on the accuracy of inference, irrespective of the amount or pattern of missing data, so attempts to understand the problem at a comprehensive level taking all impacts into account have had poor predictive success.

our results relate the taxon coverage–the amount and pattern of missing data–to the ability of data to define an unambiguous phylogenetic tree for all the taxa in the input, by separating the impact of missing data from tree reconstruction errors per se. to simplify the problem, we have defined a notion of phylogenetic decisiveness  <cit> , which is separate from any notion of correctness of the individual gene trees based on individual loci.

we infer limits  on decisiveness. in both the context of a fixed pattern of taxon coverage and a random pattern generated by sampling, there are lower bounds to how many loci must be included for a given fraction of missing data. for the sampling case it is also possible to identify upper bounds so that it is clear when sufficient data are present. for a fixed  taxon coverage pattern, it is possible to characterize whether it is decisive for some or all possible trees, but computing the latter is nontrivial.

our results may help clarify why some arguments in the literature appear at odds with each other. on the one hand, wiens  <cit>  has suggested that it is not the fraction of missing data that is most important, but the overall amount of character data present. the most direct support from this in our results is seen in the random sampling context. according to theorem  <dig> , for any fraction of missing data , there will be a number of loci that is sufficient to guarantee decisiveness. another suggestive bit of evidence is seen in table 1: cactaceae and metazoa have about the same fraction of missing data overall, but because metazoa have so many more loci, the fraction of triples seen in that coverage pattern is much closer to the minimum level necessary for decisiveness . a caveat is that the number of loci required can be quite large if the fraction of missing data is large or the number of taxa large   in a taylor series approximation)).

on the other hand, hartmann et al.  <cit>  and lemmon et al.  <cit>  discuss cases in which missing data are more problematic. both studies simulated missing data at the sequence level occurring in blocks, which in our context we can think of as "loci". both attributed errors in phylogenetic inference in part to these patterns of taxon coverage, often in combination with other factors. our results on phylogenetic decisiveness for a fixed pattern of taxon coverage make it clear that some patterns of taxon coverage can be pathologically bad. once we cannot count on random taxon coverage to ultimately sample all 4-way partitions, it is easy to imagine patterns in which certain important 4-way partitions are never seen and thus ambiguity remains a real possibility even as the number of loci gets arbitrarily large. the obvious case is just to suppose that we sample many loci but all of them either have {a, b, c, d} or {a, b, c, f} taxon coverage. this will never be decisive according to the 4-way partition condition. some of hartmann et al.'s  <cit>  est-like patterns of missing data are reminiscent of this case because of blocks of missing data at the ends in many alignments.

implications in the context of gene tree discordance
evidence is mounting that high levels of gene tree discordance is driven in part by real biological processes of lineage sorting, hybridization and recombination  <cit> . our analyses have by design set aside the latter issue, and by necessity the former, but incongruence is obviously real. intuitively, since the lower bounds on the number of loci needed to infer a single tree decisively under random taxon coverage were derived assuming just one tree , we expect it would require many more loci to simultaneously be able to recover more than one tree. interestingly in the cranston et al.  <cit>  analysis of rice phylogenomics,  <dig> out of  <dig> possible rooted 5-taxon trees were found among the collection of gene trees . if lineage sorting is this rampant in a data set, we would need to know bounds not on decisiveness for one tree under random sampling but decisiveness for all trees. in an a posteriori analysis of a given pattern of coverage , we can check decisiveness for all trees after the fact, and gene tree discordance provides a strong motivation for requiring this property.

implications for next-gen sequencing strategies
next generation sequence technologies are currently characterized by assembly of a large number of small reads. in phylogenomic analyses in which de novo assembly  with limited coverage may be unavoidable, partial taxon coverage in the final data set may be the rule rather than the exception  <cit> . for example, the 1kp project  <cit>  aims to use a short-read high-throughput approach to sequence transcriptomes of  <dig> green plant species across  <dig> billion years of evolutionary history. a combination of partial transcriptome coverage in the final assemblies and lack of homology across such deep divergences will certainly limit the overall taxon coverage densities. given estimates of this fraction derived from pilot studies it should be possible to use theorem  <dig> to predict how much of the transcriptome is needed to anticipate a decisive analysis.

does conflict hurt or help?
a particular consequence of inequality  is that a binary phylogenetic tree t for a large number of species cannot be defined by a small number of poorly resolved trees. for example, if t has  <dig> leaves, then we require a total of  <dig> or more internal edges amongst any set of trees that defines t. now suppose we use a supertree method like mrp  on these input trees. an interesting question is whether inequality  might still hold if we replace the condition that the trees "t <dig> ...,tk define t" by "t <dig> ...,tk have a unique mrp tree t".

this seems plausible since the two notions are equivalent when the input trees t <dig> ...,tk are compatible, and it might be supposed that conflict-free data is in some sense 'optimal'. however, it turns out that such a modification to inequality  fails. for example, there is an incompatible set of six trees for  <dig> taxa, each with just one internal edge, that has a unique mrp tree t on those  <dig> taxa ; by contrast if we wished to additionally require the input trees to be compatible, we would require at least nine trees , not six. in other words, allowing the trees to conflict can in some cases actually 'help' reduce the amount of data required to determine a unique supertree by a method such as mrp.

relation to phylogenetic "groves"
decisiveness for all trees is a strong condition. it is sometimes possible to glean information about a tree that includes all taxa even when the taxon coverage pattern is not decisive for any such tree. a weaker sense of decisiveness is embodied in the notion of a "grove" of phylogenetic trees . figure  <dig> illustrates a taxon coverage pattern that is not decisive for any tree. however, for some tree it exhibits the property that the collection of trees that display the subtrees induced by the taxon coverage pattern agree on parts of the tree. in the example it is only the position of one taxon that is variable among the trees consistent with the induced subtrees. the induced subtrees in this case are said to form a grove, because the trees discovered have information in them that is not contained in any of the induced subtrees alone.

future work
several problems are suggested by this work and its application to empirical studies. first, many real taxon coverage patterns are sparse enough that they are not decisive for all trees. it would be useful to know what data should be obtained to convert an indecisive to a decisive data set, or to convert one that is decisive with low probability to one that is decisive with high probability. in both cases there are natural optimality problems that could be stated that would try to minimize the cost in additional sequencing. second, along the lines of phylogenetic groves, when a taxon coverage pattern is not decisive for the entire label set, it might well be decisive for a large subset of it. what is the size of the largest label set for which a given pattern of taxon coverage is decisive? in some sense this conveys the "effective tree size" which a taxon coverage pattern can address.

CONCLUSIONS
we have characterized the impact of partial taxon coverage in multilocus phylogenomic data sets in the context of both fixed and random patterns of coverage. for fixed coverage patterns we have determined lower bounds on the number of loci needed for a coverage pattern to be phylogenetically decisive for all trees–that is to allow reconstruction of a unique tree on all taxa irrespective of what the tree is. most real data sets having reasonably large numbers of taxa are not decisive for all trees, but in these cases we developed methods for assessing the fraction of trees for which they are decisive and the fraction of edges in those trees that can be distinguished. in general, the first measure is still low, but the second can be quite high. for random taxon coverage patterns, such as might be seen in data sets derived from est or bac libraries, upper and lower bounds on the number of loci needed for decisive tree inference were obtained. some real data sets required relatively few loci for decisiveness, particularly those with few taxa and modest levels of missing data, whereas other data sets required tens of thousands of loci when the number of taxa and fraction of missing data was high. clearly, the pattern of taxon coverage is a factor in large scale phylogenetic inference, regardless of the details of the sequence data themselves or tree reconstruction method.

authors' contributions
mjs, mmm, and ms conceived the initial problems, which were then formalized as theorems and proofs by ms. mjs and mmm designed and analyzed the empirical studies and formulated implementations of partial decisiveness measures. mmm wrote code to support the latter. mjs and ms wrote the manuscript, with editing by mmm. all authors read and approved the final manuscript.

appendix: proofs
proof of theorem  <dig>  if s is phylogenetically decisive for all trees then:  

in other words, all three-taxon subsets of must be present as a subset of some element y of s . thus:  

from which the results stated now follow.

proof of theorem 2: part . first suppose that t is in r. for each internal edge e of t let ae be the event that e is distinguished by at least one of the trees  . let be,ibe the event that edge e is distinguished by t|si. by theorem  <dig> of  <cit> t|s <dig> ...,t|sk defines t precisely if each internal edge of t is distinguished by at least one of these induced trees. consequently:   

where eint is the set of internal edges of t, and   

by the bonferroni inequality:   

where overline denotes the complementary event. now, by , we have:  and for fixed e, the events  are independent events of equal probability; consequently:   

now, if n <dig>  n <dig>  n <dig> denotes the number of leaves  in the three subtrees of t that are incident with e but which do not contain the root of t then:  

where the inequality arises because n <dig>  n <dig>  n <dig> ≥  <dig>  applying this inequality to  we obtain:  and so, by :  

since a tree in r has precisely n -  <dig> internal edges, as required. the resulting bound involving k now follows by routine algebra.

turning to the case of an unrooted tree t ∈ u, if condition uc+ <dig> holds then we can directly apply the result for rooted trees under uc. however if the weaker condition uc holds for t ∈ uthen we use the result  that t is defined by any set of quartet trees that distinguishes every edge of t provided that each quartet contains a fixed leaf. we can then repeat the above argument but at the penalty of increasing the exponent on p from  <dig> to  <dig> 

proof of part : let m = ⌊n/3⌋, and let t <dig> be any tree in r. identify each leaf of t <dig> with the root of a separate 3-leaf binary tree to obtain a tree in t <dig> in r. consider the set e' of the m newly-created internal edges of this tree. if n > 3m then form an arbitrary rooted tree from the remaining n - 3m leaves, adjoin its root, and the root of t <dig> to a new root to obtain a tree t ∈ r . now each edge e ∈ e' has just one leaf in the three subtrees that are incident with the edge and that do not contain the root of t. thus, for each of these m internal edges we have:  

and so, by , and the independence of be, j for different j, we have:  

now, although for a general tree the events ae are not independent, for this particular tree, and for this set e' of m internal edges, these events are independent. consequently, by ,  

from which part  follows upon applying the inequality:  this completes the proof.

