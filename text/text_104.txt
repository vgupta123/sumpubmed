BACKGROUND
a key aim of evolutionary biology is to understand the processes that give rise to novel traits. what is the nature of the genetic changes underlying adaptation? how are new alleles introduced into a population, and how are they maintained in the face of varying types of selection? one way of solving these questions is to study polymorphic species – the genetic control of a polymorphism within species can be used to test hypotheses regarding modification of developmental processes at broader taxic scales  <cit> . to find the genes responsible, we can study nucleotide variation and search for characteristic signatures that selection will leave in the diversity of alleles in a species  <cit> . such ‘signatures of selection’ can corroborate the role of the genes in determining the polymorphism. the identity of these genes will contribute to our understanding of the processes generating and maintaining evolutionary diversity.

another key question underlying studies of phenotypic evolution is how complex phenotypes come under precise genetic control. locally polymorphic species pose a particular challenge: multiple phenotypic optima are occupied by individuals from a single population requiring precise determination of the various discrete phenotypes despite mating between individuals of different morphs. such situations can lead to the evolution of supergenes  <cit>  where a single genetic locus comes to determine the polymorphism. whatever the exact genomic architecture of the supergene, it seems likely that switching between alternate phenotypes is accomplished by differential regulation of effector genes. the ‘cis-regulatory’ hypothesis for morphological adaptation states that the regulatory regions of genes can evolve at a higher rate  than the protein-coding regions of genes  <cit> . this hypothesis predicts that morphological evolution will tend to arise through regulatory changes, often in cis-regulatory control of conserved genes involved in developmental processes  <cit> .

lepidopteran wing patterns are some of the best known examples of adaptive colouration and include some textbook examples of natural selection in action, including industrial melanism in biston betularia and müllerian mimicry in heliconius butterflies . these systems have revealed that wing pattern diversification is controlled by a small number of genes with alleles of large effect . when the genomic regions containing these genes are analysed phylogenetically, they often display an evolutionary history that is discordant with that of the rest of the genome, producing topologies that group similar phenotypes together irrespective of species boundaries and geographic structure  <cit> . in some cases these patterns have resulted from adaptive introgression, or collateral evolution by allele sharing  <cit> . reconstructing phylogenies of genomic regions that control phenotypic diversity can therefore be a powerful method for verifying their involvement in generating and maintaining phenotypic diversity, and in increasing our understanding of the processes giving rise to novel and adaptive phenotypes . recent advances in unpicking the supergene underlying batesian mimicry in papilio polytes
 <cit>  offers insight into the nature and function of supergenes. in this case, a single coding region, doublesex, was found to determine female polymorphism, possibly through differential expression of isoforms of doublesex. high levels of synonymous and non-synonymous polymorphism were found in the doublesex coding region and alternative alleles were found to be highly divergent.

the african mocker swallowtail papilio dardanus is a polymorphic female-limited batesian mimic. at least  <dig> different female wing pattern morphs can be distinguished in p. dardanus . wing pattern determination in females of p. dardanus maps to a single supergene locus, termed h
 <cit> . dominance of colour morphs is complete for most crosses between sympatric individuals, although there is partial breakdown of dominance when butterflies from different subspecies are crossed .figure  <dig> 
phenotypic variation in p. dardanus and the organisation of the h locus.
 female forms of p. dardanus  and examples of their model species in a number of african mimicry rings. the p. dardanus male pattern is shown boxed at the left along with male-like female forms.  genomic organisation of the h locus showing the extent of exons  and introns  of the en and inv genes along the known sequence of the region. the bottom panels show the significance level for associations of snp in the respective exons with three dominant morphs. the shading indicates the significance threshold for association. note that significant association is found only in en . the figure is reproduced in an altered form from  <cit> .



the h locus has been mapped to a  <dig>  cm linkage group and shown to co-segregate with the gene coding for the transcription factor invected and possibly its paralogue engrailed that maps to the same genomic region  <cit> . more recent work has used a comparative genomic approach to physically map this candidate region and carry out further recombination and snp-association analyses to test for differences among morphs in this region  <cit> . around  <dig> genes co-segregate with h and are broadly syntenic with previously sequenced lepidopteran genomes. despite the lack of resolution in positional cloning of h using pedigree information, this study furthermore demonstrated that the forms f. cenea, f. poultoni and f. planemoides showed significant association with snp variants in engrailed
 <cit>  . none of the other  <dig> genes showed these snp associations with all three phenotypes, leading to the conclusion that engrailed alone is the prime candidate for the mimicry switch locus, h. additionally, linkage disequilibrium in the region was found to be relatively low, but was high for snps within engrailed, as would be expected if this locus is a supergene harbouring multiple allelic sites which determine alternative phenotypes and which need to be maintained without recombination to avoid the formation of maladaptive intermediates. finally, the comparative genomics analysis also revealed evidence for balancing selection based on the non-neutral distribution of snp variation in the engrailed coding region  <cit> .

these results indicate that engrailed and possibly invected are strong candidates for the p. dardanus mimicry switch. these genes are highly conserved developmental regulatory genes present in all hexapods  <cit> . if these genes do indeed determine the wing pattern, nucleotide variation will be affected by selection on the phenotype and therefore may have an evolutionary history discordant with that of unlinked markers, which were shown to follow a predominantly geographic structure  <cit> . specifically, phylogenetic analysis of mitochondrial markers in p. dardanus has revealed deeply diverging lineages comprising eastern and western mainland african clades and an indian ocean clade, but no comparable separation has been detected in nuclear markers including the invected gene and two linked aflp loci  <cit> . we additionally predict that similar phenotypes will share alleles at h regardless of their geographic origin; individuals of a given morph are therefore expected to be phylogenetically closely related at loci determining the phenotype .

here we use gene phylogenies for coding regions of engrailed and invected to study the phylogenetic history of these regions within p. dardanus and across the genus papilio. previous work has also demonstrated that p. dardanus forms hybrids in the wild with other papilio species  <cit>  and gene flow from other species may be a significant source of evolutionary novelty  <cit> . we therefore test the monophyly of p. dardanus alleles and the possibility that divergent alleles have undergone introgression, while also establishing a baseline of divergence in these loci beyond the p. dardanus clade. a phylogenetic approach will also be useful for the analysis of engrailed and invected alleles within the p. dardanus lineage to characterise the kind of nucleotide divergence distinguishing the various morphs. given the known ld in the engrailed coding region the phase of snp variation can be computationally inferred to obtain distinct alleles whose variation may be tree like and amenable to phylogenetic inference. variation at these loci within p. dardanus is then further investigated, relative to population divergence in mitochondrial markers. finally, tests for selection are applied to reveal associations of haplotypes in engrailed and invected with wing pattern and to give insight into the molecular evolution of this region.

materials and methods
papilio dardanus specimens were chosen to maximise overlap with previously published taxon sets  <cit> , whilst also adding samples from additional populations from either side of the documented mitochondrial lineage break . specimens were taken from existing collections of the natural history museum , the afrotropical butterfly research institute kenya  and stratford butterfly farm . additional sampling was carried out in ghana and south africa, with further specimens of p. dardanus dardanus from western kenya  provided by s. c. collins . sampling locations are plotted in figure  <dig>  in addition, p. phorcas, p. constantinus and other outgroups from the genus papilio were purchased from stratford butterfly farm. a full list of samples used is presented in additional file 1: tables s <dig> figure  <dig> 
sampling locations of
p. dardanus
used in this study. dotted gray lines separate the eastern, western and indian ocean lineages. the shaded area is p. dardanus meseres, believed to be a contact zone between the eastern and western mainland lineages.



dna was extracted from legs of fresh or frozen specimens using a qiagen dneasy kit. for dried museum collections material  the protocols of thomsen et al.  <cit>  were followed. briefly, this involves removal of a leg of the butterfly, incubation overnight in a buffer with protease and a purification step using a qiagen qiaquick pcr cleanup kit. primer sequences  <cit>  are provided in additional file 2: table s <dig>  pcr products were bi-directionally sanger sequenced using abi technology. sequences were checked and edited using geneious  were calculated for each alignment in sites  <cit> .

to improve the accuracy of haplotype inference, allelic phase data was directly obtained for  <dig> individuals per morph through cloning of engrailed-derived pcr amplicons with invitrogen topo ta vector and invitrogen chemically competent e. coli grown on kanamycin/lb agar. pcr was performed on picked colonies directly prior to sanger sequencing . in addition, haplotypic phase data was obtained by sequencing h-linked pcr amplicons for  <dig> specimens  on a illumina miseq . resulting reads were trimmed in geneious version  <dig>   <cit>  using default settings and mapped to a bac reference  using geneious read-mapper . paired-end information was used to improve the quality of the mapping, using only matches mapping nearby and ignoring multiple matches. the mapping resulted in coverage for each targeted region in excess of 100x, files of reads mapping to the bac reference have been submitted to sra . the resulting pileups were used to call haplotypes using gatk read-backed phasing . only those haplotypes obtained through cloning or illumina amplicon sequencing were used to represent p. dardanus in the genus-level phylogenies . individuals of p. dardanus f. lamborni were excluded from the present study due to the existence of a duplication of the engrailed/invected genome region in this morph  <cit> , potentially confounding phylogenetic or haplotype-level analyses.

tree searches
nucleotide substitution models were obtained from jmodeltest  and using the corrected aic criterion  to find the best fitting model. tree searches were performed under the selected model using phyml  with support values assessed using  <dig> replicates and other settings set to default. tree statistics  were calculated in paup*  <dig>   <cit> .

haplotype analysiswithin p. dardanus
sequenced haplotypes from cloned pcr products and illumina amplicon sequencing were added to p. dardanus genotypic data to assist in inferring phase in the remaining specimens using the program phase , with settings  <dig> iterations, thinning interval =  <dig> and a burn-in of  <dig>  haplotypes that were not inferred with certainty  were discarded. a list of samples for which engrailed and invected haplotypes were successfully inferred is presented in additional file 4: table s <dig>  unrooted phylogenetic trees of p. dardanus engrailed and invected inferred haplotypes were produced using phyml as described above. the branch-lengths of these trees were rescaled to reflect the numbers of synonymous and non-synonymous substitutions in hyphy . monophyly of the morph-associated engrailed alleles was assessed using the shimodaira-hasegawa test for tree selection based on constrained trees  that keep target alleles as monophyletic against the unconstrained tree using paup*  <dig> b <dig>  <cit> ; heuristic search performed under likelihood criterion with  <dig> random stepwise addition replicates and tree bisection-reconnection branch swapping, using nucleotide substitution model given by jmodeltest).

mcdonald-kreitman tests were performed in dnasp  using 405 bp amplicon engrailed haplotypes inferred with phase from a population sample of  <dig> wild-caught specimens of p. dardanus subspecies cenea . the mcdonald-kreitman test requires a sufficiently divergent outgroup, such that there is little or no shared polymorphism, so we used a specimen of p. rex, rather than the more closely related p. phorcas or p. constantinus.

RESULTS
phylogeny ofengrailed andinvected exons across the genuspapilio
to study the evolution of the candidate wing-pattern switch genes, we inferred the phylogeny of engrailed and invected coding sequences across the genus papilio . for engrailed, we used  <dig> terminal taxa  of exon- <dig> resulting in an alignment of 479 bp of coding region. the analysis places all haplotypes of p. dardanus in a clade as sister to its two closest relatives, p. constantinus and p. phorcas, and reveals a large diversity of alleles within p. dardanus. in particular, alleles from individuals of f. planemoides and f. poultoni represent highly-divergent sequences derived from within a cluster of alleles associated with the other morphs. monophyly of p. dardanus alleles indicates that these alleles have evolved within p. dardanus, rather than through introgression from a related species.figure  <dig> 
ml phylogeny of 5’
engrailed
across the genus
papilio
, with a
battus
outgroup.
papilio dardanus individuals are represented by haplotypes from either cloning or miseq amplicon sequencing. blue dots indicate nodes with bootstrap support >70%. bootstraps at intraspecific nodes are ignored.
maximum likelihood tree with  <dig> bootstrap replicates for
papilio
5’
invected
.
papilio dardanus individuals are represented by haplotypes from miseq amplicon sequencing. note that p. demodocus and p. memnon are paraphyletic. blue dots indicate nodes with bootstrap support >70%. bootstrap support at intraspecific nodes is not presented.



outside of the p. dardanus clade, the overall topology is largely consistent with previous findings  <cit>  with the included subgenera, principally princeps, druryia and menelaides recovered as monophyletic. within the subgenus menelaides, the species p. memnon and p. rumanzovia are not reciprocally monophyletic with one specimen of each species in an unresolved position at the base of this clade. consistent with previous analyses  <cit>  our tree places p. rex within subgenus princeps; p. rex is therefore corroborated as sister to the clade .

the dataset for invected consisted of  <dig> terminals  within papilio and an alignment of 332 bps. the resulting tree also reveals a monophyletic p. dardanus group, with p. rex as sister, and is composed of highly divergent alleles that separate the monophyletic p. dardanus from its closest relatives p. phorcas and p. constantinus. the divergences within p. dardanus are more uniform than in the engrailed locus and there is no association of haplotypes with particular phenotypes.

intraspecific variation inp. dardanus engrailed haplotypes
haplotype inference for p. dardanus engrailed resulted in  <dig> unique haplotypes from  <dig> individuals inferred successfully for a 712 bp 5` region of engrailed from a sample of  <dig> individuals. the haplotype phylogram  shows highly divergent engrailed alleles that were associated with the dominant morphs f. planemoides and f. poultoni. out of nine individuals of f. poultoni sequenced, eight share two very closely related haplotypes. all six f. planemoides sequenced have one allele in common, which is also shared with the single f. poultoni specimen lacking the f. poultoni-associated allele . this individual may represent a ‘synthetic niobe’, i.e. the heterozygote between the f. planemoides and f. trophonius h alleles known to produce a phenotype similar to that of f. poultoni
 <cit> , or it may be f. salaami, a form with a similar, but distinguishable phenotype which may be specified by a different allele. unfortunately the wings of this specimen are too damaged to be certain in its morph assignment. one individual  of f. poultoni was found to be a heterozygote of the two divergent alleles in agreement with the documented dominance of the f. poultoni allele over f. planemoides
 <cit>  and the pattern of snp association observed for this specimen  <cit> . all individuals of these morphs possess another allele in addition to the divergent and morph-associated allele, indicating heterozygosity at h and consistent with the fact that f. planemoides and f. poultoni are dominant alleles.figure  <dig> 
maximum likelihood phylogeny of inferred 712 bp haplotypes of
engrailed
in
p. dardanus
, labelled by either the morph  or the population  the haplotypes were sampled from. divergent alleles are associated with the dominant forms f. poultoni and f. planemoides, whilst there is no geographic structure. percentage bootstrap support values above 50% are labelled in red.



the haplotypes can also be labelled according to the population from which they were sampled . all of the haplotypes from western africa  can be found within a single clade, however this lineage also contains a few eastern african haplotypes from p. d. polytrophus. subspecies p. d. meseres is treated separately as this has been suggested to be a ‘transitional’ or hybrid race where the eastern and western lineages meet around lake victoria . consistent with this hypothesis, individuals from this region are found to possess haplotypes of both eastern and western groups . finally, the f. planemoides-associated allele is found in individuals from both eastern and western african populations, possibly demonstrating a history of this allele independent of the population-level biogeography  <cit> . in summary, there is some geographic structure within our sampling of engrailed alleles, but allelic divergence within p. dardanus is deeper than any geographic structure.

p. dardanusinvected haplotypes
intra-specific haplotype inference for the 5` region of invected  was successful for  <dig> out of  <dig> individuals, yielding  <dig> unique haplotypes. the unrooted phylogram  is similar to that for engrailed , in that there is variation within the sampled population and there is no geographic structure. however, variation is overall lower than engrailed with only  <dig> variable sites in the nucleotide alignment of  <dig> positions.figure  <dig> 
phylogeny of inferred haplotypes for
p. dardanus invected
, labelled by either the morph  or the population  the haplotypes were sampled from. percentage bootstrap support values >50% are labelled in red.



nature of changes
haplotype trees for engrailed exon  <dig> with synonymous and nonsynonymous changes mapped demonstrate that much of the divergence of the morph-associated alleles from the rest of the p. dardanus alleles is at non-synonymous  sites . the f. poultoni and f. planemoides alleles are characterised by multiple unique changes, primarily at replacement sites . additionally, the f. poultoni and f. planemoides alleles share  <dig> non-synonymous and  <dig> synonymous changes. to test for a shared origin of the two divergent alleles, we compared the best tree with an alternative topology in which f. poultoni and f. planemoides were constrained to monophyly. the likelihood of the constrained tree  was only  <dig>  lnl units lower than in the unconstrained tree. this was not a significantly worse  fit to the data in the sh test, indicating that we cannot rule out a shared origin for these alleles. unlike the extensive non-synonymous changes in engrailed, all changes within the p. dardanus complex in invected were synonymous.figure  <dig> 
the structure of genetic variation in invected and engrailed. gene trees were established by maximum likelihood for invected  and engrailed  haplotypes, separately from non-synonymous and synonymous nucleotide changes. branch lengths correspond to the number of changes. the area of each pie is scaled in proportion to the frequency of that haplotype among the morphs sampled, and colours of pies reflect proportion of haplotypes recovered from each morph, labelled as in figure  <dig>   unique snps in the two morph-associated alleles relative to the consensus sequence for all other inferred p. dardanus alleles.



to test for non-neutral coding evolution within p. dardanus engrailed, the mcdonald-kreitman test  <cit>  was applied to inferred engrailed haplotypes from a south african p. d. cenea population . we used this population as it was the largest wild-collected sample from a single locality and time point available to us. this population has neither of the dominant morphs f. poultoni and f. planemoides, but is polymorphic for f. hippocoonides, f. cenea, f. natalica and f. trophonius. haplotypes were inferred for a 405 bp region , yielding  <dig> unique haplotypes from  <dig> individuals. haplotypes were also inferred for the same region in the outgroup species p. rex . the test values  indicated a significant departure from neutrality, due to a large excess of non-synonymous polymorphisms within p. dardanus , suggestive of diversifying selection acting on the engrailed coding sequence.table  <dig> 
segregating and fixed synonymous and non-synonymous differences in the comparison p
. dardanus cenea - p. rex



p. dardanus cenea – p. rex

fixed

polymorphic


discussion
we show here that phased haplotypes of engrailed associated with wing pattern forms are highly divergent phylogenetically. it has recently been shown that sets of snps across engrailed show strong association with the wing patterns of f. poultoni and f. planemoides and that this region shows elevated linkage disequilibrium . the presence of multiple linked snps is a prerequisite for the recognition of phylogenetically distinct lineages, and we show here that these morph-associated snps define a small number of morph-associated haplotypes. each individual of these two morphs possesses at least one of these haplotypes, which occupy exceptionally long branches in the haplotype tree, even by comparison to the corresponding sequences across distantly related species of papilio . the divergence of the morph-associated haplotypes is contributed disproportionately by non-synonymous changes. the allele diversity does not follow the strong geographic structure suggested by the mtdna, which splits the populations in eastern and western branches  in roughly the same way as genitalic characters  <cit> , although other nuclear markers also show only weak subdivision . taken together, these findings strongly suggest that the genomic region around the first exon of engrailed diverges from patterns of neutral variation at phylogenetic and genetic levels, which further supports a role of this region for controlling wing pattern variation in p. dardanus.

the phylogenetic analysis revealed several details about the evolutionary history of engrailed and the adjacent invected loci. first, the higher-level analyses of the genus papilio  did not yield many surprises; expected subclades were largely recovered for both loci, albeit with generally poor support due to the short  fragment length and high homoplasy . hence it can be concluded that the engrailed and invected loci are useful to track the lineage history, and are not generally distorted by selection outside of p. dardanus. another key result is that p. dardanus is recovered as monophyletic in the engrailed phylogeny, despite the inclusion of the divergent haplotypes, arguing against an origin for divergent alleles in other species. the intraspecific trees of p. dardanus alleles were characterised by a largely unresolved polytomy at the base in both loci, with very little internal structure related to geography, confirming the conclusions of  <cit>  based on a more limited sample. additionally, there is no obvious phylogenetic structure beyond the divergent alleles associated with f. poultoni and f. planemoides in the sequenced region of engrailed . hence, aside from these divergent alleles, the phylogenies corroborate the findings from the snp associations  <cit> , that did not relate the recessive morphs to particular snps.

the existence of multiple fixed differences in the two divergent alleles is likely a result of recurrent fixation of novel mutations. the two groups of morph-associated alleles may share some changes due to a common ancestry or alternatively, if these non-synonymous changes have a direct functional role, this might represent convergence between the two alleles. indeed, all of the changes that unite the f. poultoni and f. planemoides alleles are non-synonymous, consistent with the second hypothesis. however, the observation of an elevated level of non-synonymous intraspecific polymorphism in p. dardanus engrailed is not limited to the obvious cases of the morph-associated alleles. the results of the mcdonald-kreitman test provide strong evidence for non-neutral evolution in this gene. this has been observed with the snp variation in the highly polymorphic kenyan population used for the initial association studies  <cit> , and is confirmed here for a second population from a different region  that does not even include the most divergent alleles. the engrailed locus in p. dardanus therefore shows a pattern of evolution that differs from the remainder of the genus papilio and also from the adjacent invected locus, in that non-synonymous changes have accumulated at a much increased evolutionary rate.

it is highly surprising to find such rapid coding sequence evolution in a gene that is so highly conserved across the arthropods. in particular, one of the changes unique to f. planemoides occurs in the conserved eh <dig> domain of the engrailed protein, changing the core motif from fsisnil in all other p. dardanus to ysisnil which confers a change in the otherwise conserved core of fxixxil  <cit> . given this conserved sequence it seems likely that this change may affect binding of engrailed to the transcriptional repressor groucho  <cit> . whether or not the coding changes in the two divergent alleles affect the function of the engrailed protein remains an open question. similarly, we cannot be certain whether these variant sites are themselves the focus of selection, or whether their fixation is the result of hitchhiking due to linkage with other changes. in the latter case, we hypothesise that favourable selection due to a novel mimetic resemblance outweighs the negative effects of a linked genetic load; selection coefficients for mimicry are likely to be very high  <cit> .

theory predicts that alleles with a high linked genetic load, as might be conferred by the amino acid changes in the eh <dig> domain, are likely to be under selection to increase in dominance: linked genetic load is ‘sheltered’ in rare dominant alleles as individuals will nearly always be heterozygous for these alleles  <cit> . in the batesian mimicry system of p. dardanus, the equilibrium frequency is the abundance of the mimic relative to their model at which fitness is maximised, without predators associating a pattern with palatability rather than toxicity  <cit> . the equilibrium allele frequency will therefore be on average lower for a dominant allele as compared to alleles further down the dominance hierarchy. hence, we speculate that whether the coding sequence changes at engrailed are in any way functional or not, their likely negative pleiotropic effects may be shielded from selection by the recessive-morph alleles at engrailed. this shielding of deleterious mutations through heterozygosity may therefore explain why it is especially the dominant morphs which show such a large excess of non-synonymous mutations.

finally, we may ask what these results contribute to our understanding of the evolution of the supergene that was hypothesized to underlie the phenotypic variation in p. dardanus. the evolution of linkage disequilibrium to maintain co-adapted alleles is a core facet of classical supergene theory  <cit>  and other supergene systems have been shown to possess complex genomic architectures that may act to reduce recombination between supergene alleles . here we show that the genomic signature of selection evident from the phylogenetic trees and increased rates of non-synonymous changes does not extend beyond engrailed; we find little evidence for morph-associated variants at linked genes such as invected. a similar pattern was seen in the snp analysis  <cit> , along with the low level of linkage disequilibrium observed elsewhere in the h region. the high level of diversity uncovered in a population sample of p. dardanus is indicative of negative frequency-dependent selection, as would be expected for a locus underlying polymorphic batesian mimicry, as selection against over-abundant phenotypes results in a balanced polymorphism, which can be detected by a signature of increased diversity. the existence of multiple fixed changes in these alleles could be the result of recurrent selective sweeps fixing the variants, with either the coding region sites under selection themselves or hitchhiked to fixation as the result of selection on linked variants. the changes might also reflect the build-up of genetic load due to a reduction of recombination as predicted by classic supergene theories of polymorphic mimicry. the previous observation of low linkage disequilibrium beyond the engrailed locus  <cit>  means that this predicted effect only affects a single gene which, however, spans a large genomic region of ~70 kb  <cit> .

the findings of high levels of non-synonymous diversity, potentially affecting protein structure, are similar to patterns observed in the doublesex coding region in p. polytes
 <cit> . both the p. dardanus engrailed locus and p. polytes doublesex have alternative alleles associated with different female mimetic morphs and these alternative alleles differentiated by multiple changes with a high ratio of non-synonymous to synonymous snps in the coding regions. these two mimetic butterflies have evolved similar systems of batesian mimetic polymorphism through a complex sequence of changes in single developmentally important genes, although the genes involved are very different.

CONCLUSIONS
the gene engrailed is a well-supported candidate for the mimicry switch locus in p. dardanus. following the comparative genomics work of  <cit> , we here investigated the evolutionary genetics of the engrailed and adjacent invected genes using phased alleles within the p. dardanus lineage and also provided the wider geographic and phylogenetic context by including additional populations of p. dardanus and other members of the genus papilio. we also expanded the tests for non-neutral variation to a geographically distinct population, along with the use of a less divergent outgroup. these analyses revealed that dominant morphs are associated with highly divergent haplotypes of this gene in p. dardanus, with a large proportion of the divergence occurring at non-synonymous sites, but not in other species. in addition, there is no evidence for introgression from other species to explain the high level of divergence from other p. dardanus haplotypes. furthermore, the high levels of non-synonymous polymorphism observed in p. dardanus engrailed are consistent with long-term balancing selection, mirroring similar findings in p. polytes
 <cit> 
. the study provides new insights into the fascinating evolution of mimetic polymorphisms in the genus papilio and shows that, while the polymorphism is generated by different genomic regions, the evolutionary processes that build up the phenotypic diversity at the genome level are similar between species of papilio.

availability of supporting data
dna sequences are in genbank under accession numbers given in a supplemental table.

electronic supplementary material
additional file 1: table s1: table of samples of papilio used for phylogenetic analysis of engrailed and invected.


 additional file 2: table s2: table of pcr primers. 

 additional file 3: table s3: table of samples used for illumina miseq amplicon sequencing to infer haplotypes. 

 additional file 4: table s4: table of samples of p. dardanus used for phylogenetic and haplotype-level analysis. 

 additional file 5: table s5: table of samples of p. dardanus cenea from mpaphuli cycad reserve population used in population genetic analyses. 

 additional file 6: figure s1: maximum likelihood phylogeny of cytohrome b amplicon within the p. dardanus species group. p. dardanus is presented as sister to a clade of p. phorcas and p. constantinus, consistent with the engrailed phylogeny in figure  <dig>  this phylogeny recovers  <dig> deeply-coalescing lineages within p. dardanus, consistent with the mitochondrial phylogenies of clark and vogler  <cit> . 

 additional file 7: table s6: table of summary statistics for alignments, details of nucleotide substitution models used in maximum likelihood tree searches and summary statistics for the resulting phylogenies. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

mjt conceived of the experiments, performed dna extractions, amplification of target regions, cloning of haplotypes, performed the alignment, haplotype inference, population genetic and phylogenetic analyses. mjtnt conceived of the experiments, performed dna extractions and amplification of target genes, cloning of haplotypes, contributed to analysis and interpretation of the results. cdj assisted with choice of appropriate techniques, interpretation of results. apv conceived of the experiments and assisted with choice of appropriate techniques, interpretation of results. all authors participated in the writing of the manuscript.

