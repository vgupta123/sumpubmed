BACKGROUND
metagenomes are analyzed through simultaneous sequencing of all species in a microbial community without prior cultivation under laboratory conditions. the result is usually a large collection of sequencing reads from many species, and the phylogenetic origin of each read is unknown. a major goal in all metagenomic studies is the identification of potential protein functions and metabolic pathways. reliable gene predictions are the basis for correct functional annotation, and for the discovery of new genes with their functions.

several gene prediction methods have been developed for the ab initio identification of protein coding genes in complete microbial genomes . these methods require an initial training phase on some data from the target genome, or training on the genome of a closely related species. such conventional gene finders can in principle be applied to metagenomic data, given that single sequencing reads can be assembled into longer contigs in order to provide sufficient training data. the applicability of conventional gene finders to metagenomic contigs can be improved by binning contigs and reads into separate phylogenetic scaffolds, e.g. by their oligonucleotide signature  <cit> . however, the assembly of metagenomic sequencing reads is problematic. mavromatis et al.  demonstrated on artificial metagenomes that assembly quality highly depends on the sequencing coverage of single species within the metagenome  <cit> . they also showed that short contigs are at high risk of chimerism, i.e. a read from species a is joined with a read of species b, which limits the use of contigs for further analysis. some proportion of most metagenomes remains in single unassigned sequencing reads after assembly and binning, and in some cases, metagenome assembly fails completely, e.g. for the hypersaline microbial mat metagenome  <cit> . for this reason, the ability of predicting genes in single and anonymous sequencing reads is essential to fully explore a metagenome.

this problem can be solved by two strategies. one possibility is the identification of protein coding regions through sequence similarity. an example is to conduct a blast search  <cit>  with metagenomic sequences against a database of known proteins. annotation success is here limited to already known genes and their close relatives. this problem is particularly prominent for viral sequences that are poorly represented in databases  <cit> . clustering of open reading frames  in principle enables sequence similarity based methods to identify novel genes that are conserved within the metagenomic sample  <cit> . considering the size of most metagenomes, computational cost is a limiting factor for these methods.

a different strategy is based on gene prediction with statistical models. genemark with heuristic models  <cit> , metagene  <cit> , orphelia  <cit>  and metageneannotator  <cit>  fall into the category of model-based metagenomic gene prediction tools. the common advantage of these tools is the capability to predict known and novel genes at a lower computational cost. their mostly unexplored disadvantage is the susceptibility to sequencing errors - which methods that are based on sequence similarity may automatically compensate to a certain extent.

the possible effect of sequencing errors on model-based metagenomic gene prediction depends on the actual error rates. the two major sequencing techniques that are commonly used in metagenomics have different sequencing accuracy. chain termination sequencing  <cit>  was the first method to be used for metagenome sequencing. it produces an average read length of ~ <dig> nucleotides . the error rates reported for sanger sequencing vary from  <dig> %  <cit>  to more than 1%  <cit>  and seem to depend on the software that is used for post processing of reads. pyrosequencing, also known as " <dig> sequencing", produces shorter reads  <cit> . in the beginning, read length was about  <dig> nt and has now increased to more than ~ <dig> nt. huse et al.  reported an error rate of  <dig> % for reads of the length 100- <dig> nt  <cit> , the read simulation software metasim  <cit>  produces reads with an error rate of  <dig> % with parameters that are adjusted according to an original  <dig> publication  <cit> . pyrosequencing is still subject to constant research. in the near future, a further increase in read length can be expected.

for all techniques, sequencing accuracy is high at the beginning of a read and decreases with read length. three error types can occur:  substitution errors, that means a wrong nucleotide is read out,  deletion errors, in which one or more nucleotides are omitted, and  insertion errors, where one or more nucleotides are falsely added to the sequence during the reading process.

all statistical gene prediction tools utilize codon usage as an important feature to identify protein coding genes. if a nucleotide is deleted or inserted into the sequence, this causes a shift in the reading frame. methods that do not compensate for frame shifts cannot predict affected genes accurately. substitution errors will only affect one codon and their influence on gene prediction accuracy is therefore generally smaller. all types of errors may also result in additional stop codons. false stop codons may have an even more severe effect on gene prediction than a frame shift because they will definitely terminate a predicted gene.

the robustness with respect to sequencing errors in sanger reads has been investigated and discussed for metagene and orphelia  <cit> , other tools have not been evaluated with regard to this property. in particular, no studies about the effect of sequencing errors in  <dig> reads on metagenomic gene prediction are available. three benchmark data sets that were supposed to facilitate the accuracy evaluation of metagenome analysis tools on real data were introduced  <cit>  but so far, metagenomic gene prediction tools have not been evaluated on these data sets.

in this work, we demonstrate the extent to which typical errors in sanger and pyrosequencing reads affect metagenomic gene prediction. the effect strongly depends on the actual error rate. for investigation, we utilize sequences simulated with metasim, a metagenome simulator  <cit> . gene prediction quality on the metagenomic benchmark data sets is also shown and discussed. estscan  <cit> , a tool for the curation of expressed sequence tags , was trained for the application to metagenomes, and gene prediction accuracy results of estscan lead us to the conclusion that the integration of error compensating methods into metagenomic gene prediction tools might significantly improve their performance, and with this metagenome annotation quality.

RESULTS
simulated reads
the evaluation of metagenomic gene prediction tools is complicated by a lack of reliably annotated metagenomic reads. the annotation quality of complete genomes can be expected to be much better. for this reason, we used simulated reads from annotated genomes for the evaluation of metagenomic gene prediction tools.

the models underlying all metagenomic gene prediction tools were built on the basis of genomes from selected training species. generalization capabilities of those models can only be analyzed if training species and their close relatives  are excluded from the evaluation setup. in this study, we did not aim at the simulation of realistic microbial communities, but instead, we wanted to encompass a wide range of phyla. therefore, a set of prokaryotic microorganisms was selected according to this criterion . none of these species has a genus relative in the training data of metagenomic gene predictions tools investigated in this study.

sanger sequencing reads with the average length of  <dig> nt were simulated with error rates ranging from  <dig> to  <dig> %, and  <dig> reads that are on average  <dig> nt long were simulated with error rates ranging from  <dig> to  <dig> %. all simulated reads are available at http://metagenomic-benchmark.gobics.de.

estscan matrix
estscan is a tool that was originally developed to detect coding regions in eukaryotic ests and simultaneously correct sequencing errors  <cit> . in contrast to metagenomic gene prediction methods, estscan cannot detect overlapping coding regions as they frequently occur in prokaryotic genomes. we were interested in estscan's sequencing error correction capabilities. in order to test if estscan would also compensate errors in coding regions on metagenomic sequencing reads, we trained an estscan scoring matrix on prokaryotic genomes that were also used for training metagene and orphelia. the matrix is availabe at http://metagenomic-benchmark.gobics.de.

accuracy on unassembled simulated reads
gene prediction accuracy can be estimated by measuring the overlap of predicted and annotated genes in the same reading frame. a comparison on amino acid sequence level reflects overlap and reading frame if the basic requirement that the sequences are highly similar  is fulfilled. an amino acid sequence alignment with only few missmatches and gaps shows this kind of similarity. we used blat  <cit>  alignments of predicted and annotated genes to assess gene prediction accuracy. three classes of genes were defined:  predicted genes that had a blat alignment of at least  <dig> amino acids  length and at least 80% sequence identity were called true positives,  annotated genes that did not fall into the first category were counted as false negatives, and  predicted genes that did not have a match with the annotation according to the first criterion were counted as false positives. with these counts, we measured the proportion of annotated genes that were predicted  and the proportion of predicted genes that match genes in the annotation . further details are given in section methods.

on simulated sanger sequencing reads, metagene and metageneannotator show the highest gene prediction sensitivities  while orphelia has the best specificity values with ~96% on error free reads and ~92% on reads with the highest error rate . this result is in agreement with previous publications  <cit> . to estimate overall gene prediction accuracy, sensitivity and specificity were combined in a harmonic mean. results are visualized in figure  <dig>  generally, the metageneannotator shows the highest accuracy. the accuracy of all tools decreases only very mildly  on reads from  <dig> % to  <dig> % errors. also common to all tools is a drastic drop in accuracy of ~10% from reads with  <dig> % errors to reads with  <dig> %. for a concise picture, we also measured amino acid prediction accuracy. for this, all amino acids that were captured into a blat alignment of prediction and annotation were counted as true positives. all amino acids in the annotation that were not predicted by the true positive criterion were counted as false negatives, and the remaining predicted amino acids were counted as false positives.

the gene prediction accuracy  results of four metagenomic gene prediction tools genemark, metagene, metageneannotator  and orphelia, and of the est processing tool estscan on simulated sanger reads is shown.

all tools have an amino acid sensitivity of ~ <dig> to 96% on error free reads. orphelia and metageneannotator have with 97% the highest specificity . these values are higher than the corresponding gene prediction accuracy, indicating that long genes on error free reads are more likely to be predicted correctly than short genes. on reads with high error rates , we observed that gene prediction rates were higher than amino acid prediction rates. the reason is that long open reading frames are likely to be affected by sequencing errors in form of in frame stop codons. consequently, only shorter genes can be predicted, which is also confirmed by length boxplots of genes predicted in reads with different error rates .

estscan had with ~87% a lower harmonic mean  than metagenomic gene prediction tools on reads with few errors . interestingly, the decrease in performance on reads with  <dig> % errors to  <dig> % errors was only  <dig> %, which is smaller than the decrease observed for metagenomic gene prediction tools . from reads with  <dig> % to  <dig> % errors, a decrease in accuracy of 9% was observed, which is also a smaller accuracy drop than measured for metagenomic gene prediction tools.

on error free  <dig> nt pyrosequencing reads, gene prediction sensitivity and specificity of all tools is similar to accuracy on sanger reads . also here, metageneannotator has the highest gene prediction harmonic mean  as depicted in figure  <dig>  from error free reads to reads with  <dig> % errors, a drop in harmonic mean of ~9% is observed for all gene prediction methods . opposed to this, estscan again showed a smaller decrease of 7%. continuing to reads with an error rate of  <dig> %, a further accuracy decrease of ~ <dig>  to ~42%  follows. on amino acid level, we observe the same effects as for sanger reads .

the gene prediction accuracy  of four metagenomic gene prediction tools genemark, metagene, metageneannotator  and orphelia, and of the est processing tool estscan on simulated  <dig> reads is shown.

on the example of  <dig> reads with an error rate of  <dig> %, we further investigated to which extent the gc-content of a read influences gene prediction accuracy.  table  <dig> shows that genemark has a higher gene prediction accuracy on low-gc species than on species with a high gc-content. for metagene and metageneannotator, this effect is smaller, and for orphelia and estscan, we can not find an obvious difference. on the same dataset, we also measured gene prediction sensitivity and specificity for different gene lengths. for measuring sensitivity, we evaluated predicted genes with all lengths against annotated genes of certain length categories .

the gene prediction accuracy  of four metagenomic gene prediction tools genemark, metagene, metageneannotator  and orphelia, and of the est processing tool estscan on pyrosequencing reads  with  <dig> % errors.

specificity was measured by evaluating predicted genes of the length categories against annotated genes of all lengths. all tools most accurately predict genes of  <dig> aa length or longer . metagene and metageneannotator have the highest sensitivity on shorter genes while orphelia has the highest specificity among gene prediction tools on shorter genes .

accuracy on fames reads
the "fidelity of analysis of metagenomic samples"  benchmark data sets consist of sequencing reads from single species genome projects  <cit> . the benchmark data sets were designed to measure the accuracy of assemblers, binning methods and gene prediction methods. particularly for assessing assembly and binning accuracy, the reads were combined into three sets with different degrees of representation for each species. the low-complexity data set  consists of reads from mostly one species with a few reads from less abundant species. the medium-complexity data set  resembles a moderately complex community with more than one dominant population and also has few reads from less abundant species. the high-complexity data set  lacks dominant populations. however, detecting a difference in gene prediction accuracy between the three different sets will only show that a tool is better for predicting genes in one species than in others. we used the unassembled reads of all fames data sets to test gene prediction accuracy of tools that were mainly designed for the application to single reads or short contigs. regarding the results, one must consider that the sequence quality of fames raw reads is rather low because the reads are untrimmed, meaning that their low-quality ends have not been removed. on all three data sets, genemark shows the highest harmonic mean  . the most sensitive method on all data sets was metagene , and the highest specificities were observed for genemark .

the gene prediction accuracy of four metagenomic gene prediction tools genemark, metagene, metageneannotator  and orphelia, and of the est processing tool estscan on fames reads  <cit>  is shown.

interestingly, estscan performs almost as good as genemark on fames reads .

discussion
the major question of this study was how sequencing errors affect metagenomic gene prediction accuracy. on sanger reads, prediction accuracy is only mildly affected by error rates of up to  <dig> %. sequencing accuracy in this range is realistic for most combinations of chain termination sequencers and read postprocessing software. in general, all tools are therefore applicable to metagenomic sanger sequences. the fames data set gives an example for low quality sanger sequences. on those reads, the accuracy of specialized metagenomic gene prediction tools is not much higher than the performance of conventional gene prediction tools . the quality of these reads is very likely to be improved by read postprocessing steps, e.g. by trimming read ends. the results on the fames data set demonstrate that such postprocessing steps are important to ensure a high gene prediction accuracy.

in  <dig>  wommack et al. showed that a read length of  <dig> nt significantly weakens blast analysis results from metagenomic data  <cit> . for gene prediction tools that use statistical models, our findings on simulated  <dig> nt pyrosequencing reads suggest that the actual read length of  <dig> nt has almost no impact on gene prediction accuracy results when compared to accuracy on  <dig> nt sanger reads . sequencing errors lead to a decrease in gene prediction accuracy, though. on reads with a realistic error rate of  <dig> % for pyrosequencing, the harmonic mean is around 82%, which leaves much room for improvement. the identification of short gene fragments, particularly gene fragments shorter than  <dig> aa , is a major shortcoming of metagenomic gene prediction tools. therefore, gene prediction in pyrosequencing reads would benefit from further development of models specialized on the accurate detection of short gene fragments.

another interesting question is whether metagenomic gene prediction tools that were trained on a limited set of species genomes are able to predict genes in reads from distantly related species, and whether it is possible to name a 'best tool' for this purpose. the simulated reads used in this study were sampled from species that belong to many different phyla. members of some phyla were used for training of all tools, other phyla were not represented by a training species. we show that gene prediction accuracy varies over reads from different test species but we believe that this variation is independent from the degree of relatedness to training species. dictyoglomus thermophilum is an example whose phylum was excluded from training of all tools. no significant drop in accuracy can be observed for reads from this species .

on the simulated reads here, it looks like metageneannotator is the best tool. in contrast to this, genemark has the highest accuracy on fames reads - which are constituted from different species than the simulated data set. also the results of hoff et al.  demonstrated a high prediction accuracy for genemark on a different simulated data set  <cit> . from the presented data, it is not possible to conclude whether metagenomic gene prediction tools work better or worse for reads from particular phyla because most phyla are represented by only one species. however, it seems that gene prediction accuracy of single tools depends on the species contained in a metagenome.

the accuracy of metagenomic gene prediction tools on real sequencing reads affects further steps of metagenome analysis that generally depend on the predictions. for example, the functional annotation of genes is often achieved by using hmmer  <cit>  or fast tools like ufo  <cit>  for sensitive protein domain database search, e.g. to detect pfam domains . the profile hidden markov models for hmmer or the ufo algorithm cannot detect domains correctly if the predicted genes that are used for database search are affected by frame shift errors within the domain region. in addition, gene prediction sensitivity directly influences the number domains that can potentially be detected. a high gene prediction accuracy ensures that such gene prediction dependent steps of analysis can also be carried out with high accuracy. we showed that estscan, although not designed for metagenomic gene prediction, is in principle capable of compensating for frame shift errors in metagenomic data to some extent. therefore, metagenomic gene prediction accuracy could be greatly improved by the integration of methods that are robust with respect to sequencing errors.

CONCLUSIONS
in conclusion, the integration of error compensating methods into metagenomic gene prediction tools as well as the development of suitable models specialized on the accurate detection of short gene fragments would be beneficial to improve metagenome annotation quality.

