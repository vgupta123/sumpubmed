BACKGROUND
tandem mass spectrometry  is a dominant technique nowadays for peptide sequencing  <cit> . a typical ms/ms experiment usually includes the following steps: protein mixtures are first digested into suitably sized peptides, and then the peptides are ionized via an ionization process. after that, selected peptides  are further broken into fragment ions using different fragmentation techniques, and their tandem mass spectra  are output  <cit> . ms/ms spectra usually contain two kinds of information of each ion detected, the mass-to-charge  value and the intensity.

in ms/ms experiments, precursor ions are broken into various kinds of fragment ions, among which, the commonly observed ones are named a-, b-, c-, x-, y-, and z-ions according to the cleavage sites on the peptide backbones. different fragmentation techniques used in ms/ms yield differing dominant types of fragment ions. collision-induced dissociation  and higher-energy collisional dissociation  yield b-ions and y-ions as dominating ions. electron capture dissociation  and electron transfer dissociation  preferentially produce variants of c-ions and z-ions, and occasionally a-ions .

different kinds of computational methods including database search, de novo sequencing, and spectra library search have been developed for peptide sequencing using various ms/ms data. in database search, theoretical peptide spectra are computed from an existing protein database and peptides are identified by matching the theoretical spectra to experimental spectra. spectra library search is a relatively new method that uses pre-build spectra libraries instead of protein database as the reference for matching. spectra libraries contain annotated experimental spectra. this kind of method is claimed to be superior in speed and sensitivity, compared to the database search  <cit> . the limitation of these two kinds of methods is obvious that they can only identify peptides that are included in protein database or spectra libraries. de novo sequencing, on the other hand, interprets spectra directly using the masses of amino acids . no prior database nor library is needed. therefore, this kind of method has the potential to identify peptides that are not included in protein database and spectra libraries. the development of de novo sequencing used to be limited by insufficient information from an ms/ms spectrum itself, especially when the spectrum quality is low. however, with the recent development of high mass-accuracy ms/ms, alternative fragmentation techniques, and the idea of using multiple spectra from the same peptide for sequencing  <cit> , de novo sequencing has shown promising developments. therefore, this study focuses on de novo peptide sequencing methods.

a recent popular way of peptide sequencing is to combine different kinds of methods properly in order to achieve superior performance, for example, tag based searching methods  <cit>  can be viewed as a combination of de novo sequencing and database search. this kind of methods usually first produce partial sequences using de novo sequencing, called tags, from an ms/ms spectrum, and then use these tags to search against a protein database. the use of tags can dramatically reduce the search space and time needed.

nowadays, with large amount of ms/ms spectra produced and sequenced, spectra libraries are expending. information extracted from these experimental spectra in libraries can be used to enhance de novo sequencing performance. previously, we have produced a series of de novo sequencing methods for alternative spectra including hcd and ecd/etd spectra, and for multiple spectra generated by the same peptide . we believe that information extracted from spectra libraries could help with these existing de novo sequencing methods. in this study, we use spectra libraries as training datasets to improve our previously proposed method for hcd and etd spectra pairs.

our previously proposed method for hcd and etd spectra pairs  <cit>  is based on the widely used spectrum graph model with proper modifications. in this method, a pair of spectra are first merged into one spectrum , and a new spectrum graph with multiple types of edges is built on the merged spectrum. then, the method uses peptide tags to separate the whole sequencing into small regions, and integrates amino acid composition  information into the graph model. partial candidate sequences inferred from the graph are assembled together to be final candidates, and a ranking scheme is applied at last to find the best match. several spectrum-specific features are applied to the graph model for sequencing. since spectra libraries consist of annotated experimental spectra, features extracted from them are expected to reflect properties of real ms/ms spectra, and have the potential to improve our previous method. in this study, we propose an improved de novo sequencing method with the use of spectra libraries.

methods
spectra merging improvement
in our previously proposed method, in order to merge a pair of hcd and etd spectra to be one spectrum for sequencing, peaks from both spectra satisfying certain criteria are selected. having spectra libraries, we can evaluate these criteria and assign significant scores to them. therefore, a new dimension of information, the significant score of each selected peak, can be added into the sequencing method. that is to say, previously we just decide to select a peak i into the merged spectrum  or not; but now, each selected i has a score associated with it, denoted as s
s
i, indicating the confidence level that it is a real fragment ion rather than a noisy peak. this score can be used as additional information in the following sequencing and candidate ranking steps. next, we introduce the peak selection criteria and significant score calculation in details.

two major selection criteria used in the spectra merging step are amino acid mass difference and ion complementarity. for the amino acid mass difference, a peak v in an experimental spectrum s is selected if there are two peaks u and t in s, one of the masses is smaller than v and the other is larger than v, and both u and t have mass difference to v equal to one of the  <dig> amino acid masses. for the ion complementarity, ions u and v in an experimental spectrum are both selected if masses of u and v satisfying the complementary ion relationship. since ions may loss small molecules and contain various charge values, these variations are considered during the selection.

in order to evaluate the selection criteria and assign significant scores, spectra libraries are used as training datasets to calculate accuracies of the criteria. to be specific, on each spectrum in a spectra library, denoted as s
l
k, we apply the above selection criteria and then check how many of the selected peaks are real fragment ions . the average accuracy on all s
l
k in the library is used as the significant score of such selection criterion.

to describe the selection and score calculation clearly, we denote a as the set of  <dig> amino acids, and a
i∈a as a certain amino acid. a
i is also used to represent its residue mass. s
e represents an etd spectrum and s
h represents a hcd spectrum. m
loss is defined to be the mass of some small molecules or groups lost from fragment ions, which include h
2
o and n
h
 <dig>  u
+,v
+, and t
+ are the m/z values of u,v, and t in charge state + <dig>  θ is a given threshold; and m
p is the parent peptide mass. relationships for selection and score calculation are summarized in table  <dig>  in the table, nionselect and nionreal are the number of selected ions using the selection criteria and real fragment ions in all selected ones, respectively. ncompselect and ncompreal are the number of selected complementary ions using the selection criteria and real fragment ions in all selected ones, respectively. a
i,a
j∈a, and σ can be  <dig> or m
loss .
l
k
∣−a
i±σ∣≤θ
v
skaa=nionrealnionselect
and ∣−a
j±σ∣≤θ
∣m
p+2m
h−±σ∣≤θ
v and u if u,v∈s
c
skcomp=ncomprealncompselect
∣m
p+3m
h−±σ∣≤θ
v and u if u,v∈s
e



in the above selection, u,v, and t in multiple charges up to n− <dig> are considered, where n is the precursor ion charge. in a spectrum from a charge n precursor ion, typically the highest charged ion is the precursor ion itself, and fragment ions are in lower charge states . since the purpose here is to select real fragment ions, ion charges up to n− <dig> is considered. basically, n− <dig> assumptions of charge values for each ion are built during the calculation, and the m/z values in charge state + <dig> is used for selection.

finally, we summarize all scores calculated from spectra libraries in table  <dig>  we denote the total spectra number in a library is l. if a peak v in an experimental hcd or etd spectrum satisfies multiple selection criteria, its final score s
s
v is the sum of the all scores from the selection.

sslaa=1l∑k=1k=lskion
sslcomp=1l∑k=1k=lskcomp



here, we give a simple example to show the spectra merging and score assignment. we use the same example spectra as the ones in  <cit>  with addition of significant scores. assume the m/z values of two experimental spectra are s
c={ <dig> , <dig> }  and s
e={ <dig> ,234} . the parent mass is m
p= <dig>  the charge states of s
c and s
e are + <dig> and + <dig>  respectively. the lost small molecule is h
2
o, and m
loss= <dig>  integer values are used for all masses here to simplify the calculation and focus on the method process.

in the above selection, ions in multiple charges up to n− <dig> are considered, where n is the precursor ion charge. therefore, we build n− <dig> assumptions of each spectrum and convert all ions to charge state + <dig>  for the two spectra in the example, three associated spectra are generated. a spectrum with subscripts i
t
o <dig> represents the spectrum with charge + <dig> m/z values of the ions when assuming all ions are in charge state i. different fonts and underlining of values are explained in later context. 
 s1to1c={ <dig> ̲,277̲,346},s1to1e={132̲, <dig> },s2to1e={ <dig> ̲,467}. 


we first deal with s1to1c. from the calculations in table  <dig>  we get that values  <dig>   <dig>  and  <dig> satisfy ∣−a
s+18∣= <dig> and ∣−a
e−18∣= <dig>  where a
s= <dig> and a
e= <dig> are the masses of serine and glutamine, respectively. then we infer that the ion having m/z value of  <dig>  is a charge + <dig> fragment ion having a molecular of water loss, and score ss199=ssl−hcdaa, where ssl−hcdaa is the amino acid difference score calculated on a hcd spectra library. in addition, we get that values  <dig> and  <dig>  satisfy ∣492+2m
h−−18∣= <dig>  then we infer that these two ions are complimentary ions in charge state + <dig>  s
s
 <dig> is updated to be ss199=ssl−hcdaa+ssl−hcdcomp, and ss277=ssl−hcdcomp, where ssl−hcdcomp is ion complementarity score calculated on a hcd spectra library.

we now deal with s1to1e and s2to1e. values  <dig> and  <dig>  satisfy ∣492+3m
h−∣= <dig>  then we infer that these two ions are complimentary ions, and the ion having m/z value of  <dig> is in charge state + <dig> . ion complementarity score calculated on a etd spectra library, ssl−etdcomp, is assigned to both ions.

at this point, no more ions can be found satisfying the relationships described in table  <dig>  therefore, the final merged spectrum s
m is sm= <dig> ssl−etdcomp, <dig> ssl−etdcomp, <dig> ssl−hcdaa+sl−hcdcomp, <dig> ssl−hcdcomp.

de novo sequencing modification
in the sequencing part, we first extend the peptide tags and re-rank them. the previously used tags are partial sequences consisting of three amino acids. if two tags t
i,t
j∈t  have two successive amino acids overlap and m/z values associated with the two tags have overlap, then a new tag t
ij consisting of four amino acids is generated and added into t. let us say t
i=t
a
g and t
j=a
g
t where the overlapped amino acids are a
g,t
i is generated by peaks i
 <dig> i
 <dig> i
 <dig> i
 <dig>  and t
j is generated by peaks j
 <dig> j
 <dig> j
 <dig> j
 <dig>  i
x and j
x are also used to represent their m/z values, where x= <dig> , <dig> . if ∀|i
x−j
x−1|≤θ, where x= <dig> , <dig>  then a new tag t
ij=t
a
g
t is generated, and t⇐t
ij∪t. if there is another tag t
p=g
t
a where t
p∈t, and the m/z of the ions generating t
ij and t
p satisfying the above relationship, a new tag t
ijp=t
a
g
t
a is generated, and t⇐t
ijp∪t. this process continues until no more new tags can be generated. for each tag t∈t with length l
t, it is generated by l
t+ <dig> peaks in an experimental spectrum. typically, amino acids in the middle of a tag, for example, the at in t
ij, tend to be more reliable than the amino acids in the ends, for example,the two ts in t
ij. since each peak has a score calculated from above subsection, the score of t, denoted as s
t, is a sum of the l
t+ <dig> peaks with proper weights to all peaks. s
t is calculated using eq.  <dig>  here, s
s
l is the score of l
th peak in tag t.  is the weight assigned to the l
th peak. with this calculation, peaks in the two ends have lower weights and peaks in the middle parts have higher weights. 
  <dig> st=1lt+1∑l=1lt+1ssl1+ <dig> ×min{l,lt−l} 


all the tags t∈t are then ranked according to s
t, and sel tags with highest ranking are selected for the following sequencing. the set of the selected tags is denoted as ts.

having a tag t
s∈t
s, the graph model with multiple types of edges are applied to find candidate peptide sequences. since each peak has a score, the algorithm searches from the highest scored peak to extend paths, and a threshold is used here to stop the searching. here, when k paths are successfully found, the searching stops. here k is a user defined threshold.

candidate ranking
each candidate peptide p
cp is generated by finding a proper path in the graph model. since each vertex on the path represents a peak in the merged spectrum, the score of p
cp, denoted as c
s
cp, is defined as the peaks’ score sum of all the peaks on the path generating p
cp. when all candidate peptides are generated, we rank them with their score p
cp, and output highest c candidates and their scores. here, c can be defined by users.

RESULTS
in this section, we use two spectra libraries, one containing hcd spectra and the other containing etd spectra, as training datasets to calculate significant scores introduced above. two pairs of hcd and etd spectral datasets are used to test the performance of the proposed de novo sequencing method. the comparison to our previous method and results analysis are given as well.

spectra libraries and ms/ms data
in this study, two spectra libraries consisting of annotated hcd and etd spectra respectively are used. the first library of hcd spectra is from the national institute of science and technology  website . nist has built ms/ms spectra libraries for several model organisms and made them publicly available  <cit> . we use the human peptide spectral library  containing  <dig>  spectra measured with orbitrap-hcd. the other library is a peptide library of over  <dig>  synthetic, unmodified peptides and their phosphorylated counterparts, and they were analysed by both hcd and etd fragmentation of ms/ms  <cit> . among them, the etd spectra of unmodified peptides are used in this study. the annotated peptide associated with each spectrum in these libraries was used as the correct sequence of such spectrum.

experimental ms/ms spectra used here are similar as the ones in our previous study  <cit> . two pairs of hcd and etd spectral datasets, scx _hcd_decon and scx _etd_decon, plus scx _hcd_no_decon and scx _etd_no_decon, are used here. these pairs of datasets are from the same research paper  <cit> . the latter dataset pair  contains raw data without deconvolution of spectra while the other pair contains spectra with deconvolution  <cit> . the original datasets contain spectra analysed by cid, hcd, and etd fragmentation. each spectrum has a sequence associated with it. the hcd and etd spectra pairs having the same peptide sequences were selected first, and those pairs that can be successfully sequenced using only single spectrum separately are filtered out. methods used in this filtration are novohcd  <cit>  and novogmet  <cit> , respectively. the reason for this filtration is that the focus of de novo sequencing using multiple spectra is for those ones that can not be sequenced by using just one spectrum. the number of spectra, the charges of spectra, and the number of selected pairs of spectra for experiment are summarized in table  <dig> 
scx _h
c
scx _e
t
scx _h
c
d_n
scx _e
t
d_n



parameters
there are several parameters usesd in the proposed method, and the values applied in the experiments are listed in table  <dig>  θ, number of tags generated for each experimental spectrum, and number of output candiates are set according to our previous study and experiments  <cit> . the number of tags is chosen to be  <dig> because the tags ranked lower than the top  <dig> tags are most likely to be wrong tags according to our previous study  <cit> .
threshold θ
stop threshold k
output number c



score calculation
when using spectra libraries to calculate significant scores of the selection criteria, we investigate the score variation on different peaks in a spectrum. the results show that for the ion complementarity score on hcd spectra, the peak pairs in the middle of a spectrum tend to generate lower significant scores than the pairs in the two ends of a spectrum. therefore, for a spectrum s
l
k in nist-hcd library, we divide the peaks on s
l
k into four parts evenly according to the highest m/z valued peak. then, sslcomp calculated using peak pairs in the middle two parts and the end two parts, denoted as sslcompm and sslcompe respectively, are shown in table  <dig> 

sslcompm

sslcompe

sslaa



from table  <dig> one can see the scores of peak pairs on different positions on a spectrum are distinguishable, and it is necessary to use two scores to represent them. we then investigate the same score on synthetd library. however, the score variation is slight on it . therefore, we use just one sslcomp score for etd spectra.

for the score sslaa, preliminary results show that this change is not significant as well . in addition, considering that there will be  <dig> slightly different scores if we distinguish the  <dig> amino acids, we just use one score, sslaa, to describe the significance of the amino acids differences. the values of sslaa calculated on the two spectra libraries are shown in table  <dig> 

de novo sequencing performance
we first investigate the full length sequencing accuracy of the proposed method and our previous method. our previous method output the three highest ranked peptide candidates for each spectra pair, and if any one of them matches the correct sequence, we say that this pair of spectra are correctly sequenced. here, the same criterion is applied to the proposed method. the accuracy comparison of the proposed method and previous method using two pair of hcd and etd datasets is shown in table  <dig>  results on the previous method are from the orignal research paper presented them  <cit> .



one can see from the results that the proposed method has similar accuracy compared to the previous method. this indicates that with the use of longer peptide tags and stop criterion , the proposed method maintains the performance without any drop of accuracy. the proposed method does has a slight accuracy increase on these two pairs of datasets. after further investigating the results, it shows that the increase is because of the new ranking score of candidate peptides. correct sequences are ranked higher  using the new ranking scores for those newly sequenced spectra, compared to the previous method, which are ranked out of the top three.

we then further analyse the rankings of candidate peptides sequenced from the proposed method since that it is a major difference between the proposed method and the previous method. one situation in the previous method is that often, several top ranked ones have very similar ranking scores. . the correct sequence may not always be the highest scored one , but second or third ranked ones who has similar ranking scores as the highest one. so the previous method outputs all  <dig> highest ranked candidates. in this study, we would like to improve the ranking scheme with the significant scores calculated from spectra libraries. in the following, in order to show the contribution of the new ranking scheme, we compare the accuracy differences of the following three cases: output only the highest ranked one, the top two ranked ones, and the top three ranked ones. results of the previous and proposed method on two different dataset pairs are shown in tables  <dig> and  <dig> 




from these figures one can see that the new ranking scheme has better performance than the one used in the previous method. with this new approach, more of the highest ranked candidates are the correct sequences, with an increase up to 11% compared to the previous method, if only outputting the first ranked candidates.

finally, the computational time of the proposed method and our previous method is compared in table  <dig>  both algorithms were written using matlab  and run on a pc with a  <dig>  ghz quad-core cpu and ms windows  <dig> operating system. since the proposed method uses longer tags and limits the number of paths in the graph model, it uses less computational time for calculation compared to the previous method. the time saving is about  <dig> and 40% on the two pair of hcd and etd datasets.



CONCLUSIONS
in this paper, an improved de novo sequencing method assisted with spectra library for hcd and etd spectra pairs is proposed. it is a development of our previous proposed method for the same problem  <cit> . the proposed method uses spectra libraries as training datasets and introduces significant scores to the spectra merging criteria of the previous method. in addition, the use of tags is improved; the original length-three tags  are extended to be longer tags in this method.

two spectra libraries, one of hcd and the other of etd spectra, were used to generate signigicant scores. to investigate the performance of the proposed method, two pairs of hcd and etd spectral datasets were used for test and compared with our previous method. when outputting top three ranked candidates, the proposed method has a slight increase in terms of sequencing accuracy compared to the previous method. but the accuracy differs significantly when outputting only top one ranked candidates. in the latter case, the proposed method achieved higher accuracy up to 11% increase, compared to the previous method. in addition, with longer peptide tags used, the proposed method uses less computational time than the previous method, with a time saving up to  <dig> and 40% on the two pair of experimental spectral datasets. to summarize the advantages of this proposed method, it achieves better de novo sequencing accuracy with higher ranked correct sequences and less computational time.

in future, we would like to evaluate the proposed method on more ms/ms datasets, and further study the spectra library to integrate more information to the de novo sequencing methods for enhanced performance.

not applicable.

declarations
this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2016: proceedings of the 27th international conference on genome informatics: bioinformatics. the full contents of the supplement are available online at http://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-17-supplement- <dig> 

funding
this work and the publication cost of this paper are supported by a discovery research grant and a discovery accelerator supplements grant from natural sciences and engineering research council of canada .

availability of data and material
the experimental datasets analysed during the current study are included in the published articles in references  <cit> . the spectra libraries are from reference  <cit>  and chemdata.nist.gov.

authors’ contributions
yy developed the proposed method, conducted the experiments and wrote the manuscript. kz provided comments and suggestions on the method development, and reviewed the manuscript on revision. both authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
