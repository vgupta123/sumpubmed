BACKGROUND
protein structure validation methods like molprobity  <cit>  and procheck  <cit>  help crystallographers to find and fix potential problems that are incurred during fitting and refinement. these methods are commonly based on a priori chemical knowledge and utilise various well tested and broadly accepted stereochemical paradigms. likewise, template based structure prediction and analysis packages  <cit>  and molecular dynamics force fields  <cit>  are customarily built on such paradigms. among these, the ramachandran map  <cit>  has a central role. it is widely deployed both to various analyses of the protein structures, and as a tool in protein visualisation. the ramachandran map describes the statistical distribution of the two dihedral angles φ and ψ that are adjacent to the cα carbons along the protein backbone. a comparison between the observed values of the individual dihedrals in a given protein with the statistical distribution of the ramachandran map is an appraised method to validate the backbone geometry.

in the case of side chain atoms, visual analysis methods like the ramachandran map have been introduced. for example, the janin map  <cit>  can be used to compare observed side chain dihedrals such as χ <dig> and χ <dig> in a given protein, against their statistical distribution, in a manner which is analogous to the ramachandran map.

crystallographic refinement and validation programs like phenix  <cit> , refmac  <cit>  and others, often utilize the statistical data obtained from the engh and huber library  <cit> . this library is built using small molecular structures that have been determined with a very high resolution. at the level of entire proteins, side chain restraints are commonly derived from analysis of high resolution crystallographic structures  <cit>  in protein data bank   <cit> . a backbone independent rotamer library  <cit>  makes no reference to backbone conformation. but the possibility that the side-chain rotamer population depends on the local protein backbone conformation, was considered already by chandrasekaran and ramachandran  <cit> . subsequently both secondary structure dependent  <cit> , see also  <cit>  and  <cit> , and backbone dependent rotamer libraries  <cit>  have been developed. we note that the subject remains under active investigation  <cit> .

the information content in the secondary structure dependent libraries and the backbone independent libraries essentially coincide  <cit> . both kinds of libraries are used extensively during crystallographic protein structure model building and refinement. but for the prediction of side-chain conformations, for example in the case of homology modeling and protein design, there can be an advantage to use the more revealing backbone dependent rotamer libraries.

in x-ray crystallographical protein structure experiments, the skeletonisation of the electron density map is a common technique to interpret the data and to build the initial model  <cit> . the cα atoms are located at the branch points between the backbone and the side chain. as such they are subject to relatively stringent stereochemical constraints; this is the reason why model building often starts with the initial identification of the skeletal cα trace. the central role of the cα atoms is widely exploited in structural classification schemes such as cath  <cit>  and scop  <cit> , in various threading modeling techniques such as i-tasser  <cit>  and homology base approaches including swiss-model  <cit>  and other related methods  <cit> , in de novo approaches  <cit> , and in the development of coarse grained energy functions for folding prediction  <cit> . as a consequence the so-called cα-trace problem has become the subject of extensive investigations  <cit> . the resolution of the problem would consist of an accurate main chain and/or all-atom model of the folded protein, based on the knowledge of the positions of the central cα atoms only. both knowledge-based approaches such and maxsprout  <cit>  and de novo methods including pulchra  <cit>  and remo  <cit>  have been developed, to try and resolve the cα- trace problem. in the case of the backbone atoms, the geometric algorithm introduced by purisima and scheraga  <cit> , or some variant thereof, is commonly utilized in these approaches. for the side chain atoms, most approaches to the cα trace problem rely either on a statistical or on a conformer rotamer library in combination with steric constraints, complemented by an analysis which is based on diverse scoring functions. for the final fine-tuning of the model, all-atom molecular dynamics simulations can also be utilised.

in the present article we introduce and develop new generation visualisation techniques that we hope will become a beneficial complement to existing methods for protein structure analysis, refinement and validation. we use the cα frenet frames  <cit>  to visualise the side chain. the output we aim at, is a 3d “what-you-see-is-what-you-have” type visual map of the statistically preferred all-atom model, calculable in terms of the cα coordinates. as such, our approach should have value for example during the construction and validation of the initial backbone and all-atom models of a crystallographic protein structure.

our approach is based on developments in three dimensional visualisation and virtual reality, that have taken place after the ramachandran map was introduced. in lieu of the backbone dihedral angles that appear as coordinates in the ramachandran map and correspond to a toroidal topology, we employ the geometry of virtual spheres that surround each heavy atom. we visually describe all the higher level heavy backbone and side chain atoms on the surface of a sphere, level-by-level along the backbone and side chains, exactly in the manner how they are seen by an imaginary, geometrically determined and cα based miniature observer who roller-coasts along the backbone and climbs up the side chains, proceeding from one cα atom to the next. at the location of each cα our virtual observer orients herself consistently according to the purely geometrically determined cα based discrete frenet frames  <cit> . thus the visualisation depends only on the cα coordinates, and there is no reference to the other atoms in the initialisation of the construction. the other atoms - including subsequent cα atoms along the backbone chain - are all mapped on the surface of a sphere that surrounds the observer, as if these atoms were stars in the sky.

at each cα atom, the construction proceeds along the ensuing side chain, until the position of all heavy atoms have been determined. as such our maps provide a purely geometric and equitable, direct visual information on the statistically expected all- atom structure in a given protein.

the method we describe in this article, can form a basis for the future development of a novel approach to the cα trace problem. as a complement to the existing approaches such as maxsprout  <cit> , pulchra  <cit>  and remo  <cit> , the method we envision accounts for the secondary structure dependence in the heavy atom positions, which we here reveal. a secondary-structure dependent method to resolve the cα trace problem should lead to an improved accuracy in the heavy atom positions, in terms of the cα coordinates. in particular, since rotameric states do display clear secondary structure dependence, a fact that is sometimes overlooked in the development of rotamer libraries. the present article serves as a proof-of-concept.

method and 
RESULTS
cα based frenet frames
let ri  be the coordinates of the cα atoms. the counting starts from the n terminus. at each ri we introduce the orthonormal, right-handed, discrete frenet frame   <cit> . as shown in figure  <dig> the tangent vector t points from the center of the ith central carbon towards the center of the st central carbon,  <dig> ti=ri+1−riri+1−ri figure  <dig> 
discrete frenet frame.  discrete frenet frame vectors ,  and .



the binormal vector is  <dig> bi=ti−1×titi−1×ti 

the normal vector is  <dig> ni=bi×ti 

we also introduce the virtual cα backbone bond  and torsion  angles, as follows ,  <dig> cosκi+1=ti+1⋅ti   <dig> cosτi+1=bi+1⋅bi 

we identify the bond angle κ ∈  with the latitude angle of a sphere which is centered at the cα carbon. we orient the sphere so that the north-pole where κ =  <dig> is in the direction of t. the torsion angle τ ∈  is the longitudinal angle. it is defined so that τ =  <dig> on the great circle that passes both through the north-pole and through the tip of the normal vector n. the longitude angle increases towards the counter-clockwise direction around the vector t. additional visual gain can be obtained, by stereographic projection of the sphere onto the plane. the standard stereographic projection from the south-pole of the sphere to the plane with coordinates  is given by  <dig> x+iy≡x2+y2eiτ=tanκ/2eiτ 

this maps the north-pole where κ =  <dig> to the origin  = . the south-pole where κ = π is sent to infinity; see figure  <dig>  the visual effects can be further enhanced by sending  <dig> κ→fκ where f is a properly chosen function of the latitude angle κ. various different choices of f will be considered in the sequel.figure  <dig> 
stereographic projection. standard stereographic projection of two-sphere on the plane, from the south- pole.



the cα map
we first describe, how to visually characterize the cα trace in terms of the cα based frenet frames -. we introduce the concept of a virtual miniature observer who roller-coasts the backbone by moving between the cα atoms. at the location of each cα the observer has an orientation that is determined by the frenet frames -. the base of the ith tangent vector ti is at the position ri. the tip of ti is a point on the surface of the sphere  that surrounds the observer; it points towards the north-pole. the vectors ni and bi determine the orientation of the sphere, these vectors define a frame on the normal plane to the backbone trajectory, as shown in figure  <dig>  the observer uses the sphere to construct a map of the various atoms in the protein chain. she identifies them as points on the surface of the sphere that surrounds her, as if the atoms were stars in the sky.

the observer constructs the cα backbone map as follows  <cit> . she first translates the center of the sphere from the location of the ith cα, all the way to the location of the st cα, without introducing any rotation of the sphere, with respect to the ith frenet frames. she then identifies the direction of ti+ <dig>  i.e. the direction towards the site ri+ <dig> to which she proceeds from the next cα carbon, as a point on the surface of the sphere. this determines the corresponding coordinates . after this, she redefines her orientation to match the frenet framing at the st central carbon, and proceeds in the same manner. the ensuing map, over the entire backbone, gives an instruction to the observer at each point ri, how to turn at site ri+ <dig>  to reach the nd cα carbon at the point ri+ <dig> 

in figure  <dig>  we show the cα frenet frame backbone map. it describes the statistical distribution that we obtain when we plot all pdb structures which have been measured with better than  <dig>  Å resolution, using the stereographic projection ; in the sequel we then consider a subset with resolution better than  <dig>  Å. there are presently  <dig> entries measured with better than  <dig>  Å resolution in pdb, and  <dig> entries with resolution better than  <dig>  Å.figure  <dig> 
c
α
stereographical projection map and ramachandran map.  top: the stereographically projected frenet frame map of backbone cα atoms, with major secondary structures identified. also shown is the direction of the frenet frame normal vector n; the vector t corresponds to the red circle at the center, and it points away from the viewer. the map is constructed using all pdb structures that have been measured with better than  <dig>  Å resolution. bottom: standard ramachandran map, constructed using our  <dig>  Å resolution pdb subset. major secondary structures have been identified.



for our observer, who always fixes her gaze position towards the north-pole of the surrounding sphere at each cαi.e. towards the red dot at the center of the annulus, the color intensity in this map reveals the probability of the direction at position ri, where the observer will turn at next cα carbon, when she moves from ri+ <dig> to ri+ <dig>  in this way, the map is in a direct visual correspondence with the way how the frenet frame observer perceives the backbone geometry. we note that the probability distribution concentrates within an annulus, roughly between the latitude angle values κ ~  <dig> and κ ~ 3/ <dig>  the exterior of the annulus is a sterically excluded region while the entire interior is in principle sterically allowed but not occupied in the case of folded proteins. in the figure we identify four major secondary structure regions, according to the pdb classification. these are α-helices, β-strands, left-handed α-helices and loops. in this article we will use this rudimentary level pdb classification thorough.

we imagine surrounding cα,i with sphere, with cα,i at the origin, we may choose the radius of the sphere to coincide with the  virtual covalent bond length value which is  <dig>  Å in the case of cα atoms, excluding the cis-proline. see  <cit>  for a recent statistical analysis of various virtual and non-virtual variables in protein structures. the variations in the covalent bond lengths are in general minor, and in this article we do not account for deviations in covalent bond lengths from their ideal values.

we note that the visualisation in figure  <dig>  resembles the newman projection of stereochemistry: the vector ti which is denoted by the red dot at the center of the figure, points along the backbone from the promixal cα at ri towards the distal cα at ri+ <dig>  this convention will be used thorough the present article.

for comparison, we also show in figure  <dig>  the standard ramachandran map. the sterically allowed and excluded regions are now intertwined, while the allowed regions are more localized than in figure  <dig> . we point out that the map in figure  <dig>  provides non-local information on the backbone geometry, it extends over several peptide units, and tells the miniature observer where the backbone turns at the next cα. as such it goes beyond the regime of the ramachandran map, which is localized to a single cα carbon and does not provide direct information how the backbone proceeds: the two ramachandran angles φ and ψ are dihedrals for a given cα, around the n - cα and cα - c covalent bonds. these angles do not furnish information about neighboring peptide groups.

backbone heavy atoms
consider our imaginary miniature observer, located at the position of a cα atom and oriented according to the discrete frenet frames. she observes and records the backbone heavy atoms n, c and the side-chain cβ that are covalently bonded to a given cα, and the o atom that is located in the peptide plane which is located after the given cα along the backbone. in figure 4a) - d) we show the ensuing density distributions, on the surface of the cα centered sphere. these figures are constructed from all the pdb entries that have been measured using diffraction data with better than  <dig>  Å resolution.figure  <dig> 
distributions of c
β
, c, n, o atoms in frenet frames.  a) distribution of cβ atoms in the cα centered frenet frames in pdb structures that have been measured with better than  <dig>  Å resolution. the three major structures α-helices, β-strands and left-handed α-helices have been marked, following their identification in pdb. b) same as a) but for backbone c atoms. note that c atoms that precede a cis-proline are clearly identifiable. c) same as a) and b) but for backbone n atoms. d) same as a), b) and c) but for backbone o atoms. as in b) the atoms preceding a cis-proline are clearly identifiable.



we note clear rotamer structures: the cβ, c, n and o atoms are each localised, in a manner that depends on the underlying secondary structure  <cit> . both in the case of cβ and n, the left-handed α-region  is a distinct rotamer which is detached from the rest. in the case of c and o, the l-α region is more connected with the other regions. but for c and o, the region for residues before cis-prolines becomes detached from the rest. in the case of c and cβ we do not observe any similar isolated and localised cis-proline rotamer.

the c and o rotamers concentrate on a circular region, with essentially constant latitude angle with respect to the frenet frame tangent vector; for the o distribution, the latitude is larger. the n rotamers form a narrow strip in the longitudinal direction, while the map for cβ rotamers form a shape that resembles a horse shoe.

for comparison, in figure  <dig> we visualise the cβ and n distributions in the coordinate system that is utilised in remo  <cit> . in these frames, the secondary structures can be identified. but the rotamers are clearly much more delocalised than in the case of the frenet frame map, shown in figure 4a) and c). this delocalisation persists in the case of backbone c and o atoms . similarly, we have found that in the case of the coordinate system of pulchra  <cit> , the rotamers are similarly clearly more delocalised than in the frenet frames .figure  <dig> 
distributions of c
β
, n atoms in remo frame.  distributions of cβ atoms  and backbone n atoms  in the frames of remo  <cit>  are shown.



one may argue that the stronger the localisation of rotamers, the more precise will structure analysis, prediction and validation become: strong localisation enables a more precise identification of both outliers and misplaced atoms. from this perspective, the frenet frames used here, appear to have a definite advantage over the frames used e.g. in pulchra and remo.

apparently, the secondary structure dependence of the distribution of the n, c and cβ atoms is mainly due to the discrete frenet frame. however, we have to emphasize the secondary structures also deform the very local sp3-hybridized tetrahedron structure centered on cα with the n, c and cβ atoms at corners. we consider the three bond angles  <dig> ϑnc≡n−ca−c   <dig> ϑnβ≡n−ca−cβ   <dig> ϑβc≡cβ−ca−c 

the ϑnc angle relates to the backbone only, while the definition of the other two involves the side chain cβ. in figure  <dig> we show the distribution of the three tetrahedral bond angles - in our pdb data set. we find that in the case of the two side chain cβ related angles ϑnβ and ϑβc, the distribution has a single peak which is compatible with ideal values; the isolated small peak in figure 6b) is due to cis-prolines. but in the case of the backbone-only specific angle ϑnc we find that in our data set this is not the case. the pdb data set we use and display in figure 6a) shows, that there is a correlation between the ϑnc distribution and the backbone secondary structure. see also table  <dig> figure  <dig> 
distribution of the three bond angles  - , according to secondary structures.  blue are α-helices, red are β-strands and yellow are loops; the small  peak in n-cα-cβ with angle around 103° is due to prolines. see table  <dig> for the average values for α-helices, β-strands and loops in figure a). see also table  <dig> for the average values in figures a), b) and c) with no regard to secondary structure. finally, see table  <dig> for the average values.
average values of the angle ϑ
nc
for different secondary structures in figure 
6
a)



structure
ϑ
nc


we note that in protein structure validation all three angles - are commonly presumed to assume the ideal values, shown in table  <dig> table  <dig> 
average values of the angles in figure 
6
reported by various authors



residue
eh-1
eh-2
ak
tv

ϑ

ϑ

ϑ
cβ

ϑ
βn


for example, the deviation of the cβ atom from its ideal position is among the validation criteria in molprobity  <cit> , that uses it to identify potential backbone distortions around cα. but several authors  <cit>  have pointed out that certain variation in the values of the ϑnc can be expected, and is in fact present in pdb data. accordingly, the protein backbone geometry does not appear to obey the single ideal value paradigm  <cit> ; we refer to  <cit>  for extended analysis.

we remind that ϑnc pertains to the two peptides planes that are connected by the cα. the ramachandran angles  are the adjacent dihedrals, but unlike ϑnc they are specific to a single peptide plane; the ramachandran angles describe the twisting of the ensuing peptide plane. if the internal structure of the peptide planes is assumed to be rigid, the flexibility in the bond angle ϑnc remains the only coordinate that can contribute to the bending of the backbone. consequently a systematic secondary structure dependence, as displayed in figure  <dig>  is to be expected. it could be that the lack of any observable secondary structure dependence in ϑnβ and ϑβc suggests that existing validation methods distribute all refinement tension on ϑnc.

cβ atoms
the side chains are connected to the cα backbone by the covalent bond between cα and cβ. consequently the precision, and high level of localisation in the cβ map as shown in figure 4a) becomes pivotal for the construction of accurate higher level side chain maps.

cβ at termini
we have analysed those cβ atoms that are located in the immediate proximity of the n and the c termini in the pdb data. for this, we have considered the first two cβ atoms starting from the n terminus, and the last two cβ atoms that are before the c terminus. note that in the data that describes a crystallographic pdb structure, these do not need to correspond to the actual biological termini of the biological protein. in case the termini of the biological protein can not be crystallised, the pdb data describes the first two residues after the n terminus resp. the last two residues prior to the c terminus that can be crystallised. here we consider the termini, as they appear in the pdb data.

recall, that the termini are commonly located on the surface of the protein. as such, they are accessible to solvent and quite often oppositely charged. it is frequently presumed that the termini are unstructured and highly flexible. they are normally not given any regular secondary structure assignment in pdb. but the figure  <dig> shows that in the cα frenet frames the orientations of the two terminal cβ atoms are highly regular. their positions on the surface of the cα centered sphere are fully in line with that of all the other cβ atoms, as shown in figure 4a). in particular, there are very few outliers. moreover, the few outliers are  concentrated in a small region which is located towards the left from the β-stranded structures.figure  <dig> 
distribution of c
β
atoms for terminal residues.  the distribution of cβ directions in the first two and last two residues along pdb structures that have been measured using diffraction data with better than  <dig>  Å resolution. there is no visible difference to the figure 4a). in particular, there are very few clear outliers, and they are located mainly in the region left of the main region.



cβ and proline
proline is different from the other amino acids, as its side chain connects to the backbone nitrogen atom n. there is an increased propensity to form trans-peptide planes. thus, we analyze the distribution of proline and those amino acids that are its nearest neighbors separately, in detail.

in figure  <dig> we compare the individual proline contributions in our data set with the cβ background in figure 4a). in figure 8a) we show the trans-proline, and in figure 8b) we show the cis-proline. the trans-proline has a very good match with the background. there are very few outliers. these outliers are predominantly located in the same region as in figure  <dig>  towards the left from the main distribution i.e. towards increasing longitude. we observe that all the cis-prolines are located outside of the main cβ distribution, towards the increasing longitude from the main distribution.figure  <dig> 
the distribution of c
β
in prolines.  figure a) is trans-pro and figure b) is cis-pro. the grey background is given by figure 4a).



in figure 9a)-d) we display the cβ carbons that are located either immediately after or right before a proline. we observe the following:figure  <dig> 
distribution of c
β
atoms immediately after and right before a proline.  the grey-scaled background is determined by the high-density region of figure 4a). in figure a) immediately after trans-pro and in figure b) immediately after cis-pro. in figure c) right before trans-pro and in figure d) right before cis-pro.



in figure 9a) we have the cβ that are immediately after the trans-proline. the distribution matches the background, with very few outliers that are located mostly in the same region as in figures  <dig>   <dig> i.e. towards increasing longitude. but there is a very high density peak in the figure, that overlaps with the α-helical region: we remind that proline is commonly found right before the first residue in a helix.

in figure 9b) we display those cβ atoms which are immediately after the cis- prolines. there is again a good match with the background. the cis-proline is relatively rare. nevertheless, we observe an apparent increase in the number of points located in the β-stranded region. there are very few outliers, again mainly towards increasing longitude.

in figure 9c) we have those cβ that are right before a trans-proline. there is a clear match with the background distribution. but there are relatively few entries in the α-helical position: it is known that helices rarely end in a proline. the intensity is very large in the loop region overlapping the β-strand region ; we always use the classification of the secondary structure of an entry, following pdb. there are also a few outliers. again, the outliers are mainly located in the region towards increasing longitude.

in figure 9d) we show the cβ distribution for residues that are right before a cis-proline. there are no entries in the background region of figure 4a). the distribution is almost fully located in the previously observed outlier region, towards the left of the background in the figure. in addition, we observe an extension of this region towards increasing latitude, reaching all the way to the south-pole.

finally, we demonstrate the effect of proline on the covalent tetrahedron which is centered on cα atom. for this we recall that in figure 4b) the region that corresponds to the effect of cis-prolines in the preceding c rotamer, is clearly visible. but in the case of cβ and n atoms, we do not observe any similar high density isolated cis-region.

in figure  <dig> we show the distribution of the three angles; see also table  <dig>  we observe a small deviation in the angle n - cα - c. in comparison to proline values in table  <dig>  the value we find in our data set is smaller.figure  <dig> 
distribution of the three bond angles - in 
cis
-proline.  distribution of the three heavy atom related angles  in the cα centered covalent tetrahedron, in the case of cis-proline. the numerical average values together with the one standard deviations are given in table  <dig> 
average values of the angles in figure 
10



angle
ϑ
nc
ϑ
cβ
ϑ
βn
6
computed from our pdb data set



angle
ϑ
nc
ϑ
cβ
ϑ
βn
the values are calculated without subdivision according to secondary structure. we also show the one-σ standard deviations. see also table  <dig> 



cβ and histidine
histidine has a side chain with pka around physiological ph. but we find that its cβ distribution is not affected by this property .

level-γ rotamers
standard rotamers
we proceed upwards along the side-chain, to the level-γ heavy atoms that are covalently bonded to cβ. conventionally, these atoms are described by the side-chain dihedral angle χ <dig>  this angle is determined by the three covalently bonded heavy atoms cα, cβ and n. the angle χ <dig> determines the dihedral orientation of the level-γ carbon atom, in terms of these three atoms.

we remind that ala and gly do not contain any level-γ atoms. in the case of ile and val we have two cγ while in the case of cys there is an sγ atom.

we first define a χ1-framing, where the rotamer angle χ <dig> appears as a dihedral coordinate. for this we introduce the following cα based orthonormal triplet  <dig> tx1=rβ−rarβ−ra   <dig> nx1=s−tx1s⋅tx1s−tx1s⋅tx1wheres=ra−rβ   <dig> bx1=tx1×nx <dig> with rα, rβ and rn the coordinates of the pertinent cα, cβ and n atoms, respectively. this constitutes our χ1-framing, with cα at the origin. we introduce a sphere around cα, oriented so that the north-pole is in the direction of tx <dig>  now the dihedral χ <dig> coincides with the ensuing longitude angle.

in figure  <dig> we show the distribution of level-γ carbon atoms. the figure 11a) shows the distribution on the surface of the cα centered two-sphere. in figure 11b) we use the stereographic projection  with the choice  <dig> fκ=11+expκ <dig> in equation . the three rotamers gauche ±  and trans  have been identified in this figure. the prolines are also visible, as rotamers. in addition, in figure 11b) we have a circle that shows the average distance of the data points from the north-pole  on the stereographic plane. a number of apparent outliers are visible in figure 11b).figure  <dig> 
c
γ
atoms in the χ
1
frames and its stereographic projection.  a) cγ atoms in the χ1-frames -  on the cα centered two-sphere. b) stereographic projection of a) using . the three rotamers and proline are identified.



we note that the underlying secondary structure of the backbone is not visible in figure  <dig>  this is a difference between figures  <dig> and  <dig>  in the former the underlying backbone secondary structure is visible in the density profile.

in figure  <dig> we show how the cγ atoms are seen by the observer who is located at the cα atom, and oriented according to the backbone frenet frames; these are the frames used in figure  <dig>  now both the rotamer structure and the various backbone secondary structures are clearly seen.figure  <dig> 
distribution of c
γ
atoms in frenet frame for different structures.  frenet frame view of the level-γ carbons, separately for the three rotamer states g ± and t  and for α-helices, β-strands and prolines .



secondary structure dependent level-γ rotamers:
in the cα frenet frame figure  <dig> the secondary structure dependence is visible. but unlike figure 11a) the cα frenet frame figure  <dig> lacks an apparent symmetry. this complicates the implementation of the stereographic projection, such as the one shown in figure 11b). we proceed to introduce a new set of frames, that enables us to analyse the secondary structure dependence of the γ-level atoms in terms of the stereographic projection:

we want this frame construction method to also remain valid for higher levels of side chains. for this we introduce the following notation. suppose our observer is located at a generic atom x. she inquires about the distribution of another atom y. she introduces an x centered frame as follows: with z the atom where the observer made her previous observations, we set  <dig> tx=rx−rzrx−rz   <dig> nx=tx×tatx×ta   <dig> bx=tx×nx where rz, rx are the coordinates of atom z and x and tα is the tangent vector in the discrete frenet frame.

in the case of cγ level side chain, the atoms z, x take cα and cβ, respectively. we may choose either cα or cβ to coincide with the origin; the cα centered coordinate system is the original roller coasting observer while the cβ centered coordinate system corresponds to an observer who has climbed “one-step-up” along the side chain. we map the level-γ atoms on the surface of the pertinent, surrounding two- spheres. we note that the difference between the cα and cβ centered distributions appears mainly in the latitude i.e. in the distance from the north-pole .

in figure  <dig> we have stereographically projected the distribution on the sphere, in combination with the map . the distribution displays clear localization, both in secondary structure and rotamer structure. the individual distributions for α-helices, β-strands and prolines are shown in additional file 1: figure s <dig>  where a few outlying prolines are highlighted as examples. there are also outliers that are outside of the range of the stereographic projection in figure  <dig>  the projection - to the extent it has been plotted - covers a disk-like region around the north-pole i.e. around the tip of vector t in the figure. the far-away outliers can be visualised by properly rotating the sphere .figure  <dig> 
stereographic projection of level-γ rotamers in frames -.  stereographic projection of level-γ rotamers in cβ frame in combination with  is shown.



finally, we notice the fact that starting from γ-level atoms, the non-carbon heavy atoms appear in the side chain for some amino acids. however, it seems that these non-carbon heavy atoms obey the similar distributions as carbon atoms .

level-δ rotamers
standard dihedral angle
we proceed upwards along the side-chain, to describe level-δ atoms. we start with a coordinate frame which is centered at the cγ atom. we note that in the case of ile, two alternatives exist and we choose the cγ carbon which is covalently bonded to the cδ atom. we start with the standard way to describe the distribution of cδ atom. it uses the dihedral angle χ <dig> defined in terms of the atoms cα, cβ, cγ and cδ. correspondingly, a frame can be defined as  <dig> tx2=rγ−rβrγ−rβ   <dig> nx2=tx2×tatx2×ta   <dig> bx2=tx2×nx <dig> 

in figure  <dig> we show the distribution of heavy atoms in level-δ, after stereographic projection . the longitude in these figures coincides with the standard χ <dig> dihedral angle, modulo a global π/ <dig> rotation around the center. in addition, we introduce the following version of   <dig> fθ=11+θ <dig> figure  <dig> 
distribution of aromatic and non-aromatic level-δ c atoms in χ
2
frames.  a) distribution of aromatic and b) non-aromatic level-δ c atoms, in the stereographic projection of the unit two-sphere centered at the cγ atom. in a) the  blue is cδ <dig> and  green is cδ <dig>  some outliers have been encircled, as examples. the  circles around the center denote the average distance of the distribution.



in figure  <dig>  we have separately displayed the distribution of the aromatic  and the non-aromatic  amino acids; we find that starting at level-δ this is a convenient bisection. we observe that the distributions in the case of aromatic and non-aromatic side chains are different. a clear trimodal rotamer structure is present in figure 14b). some outliers have been highlighted with circles, as generic examples. the individual distributions for pro and o atoms at δ-level are shown in additional file 1: figure s <dig> 

finally, as in figure  <dig> there is no visible sign of secondary structure in figures 14: the standard χ <dig> dihedral is backbone independent.

however, as in figure  <dig>  in the backbone frenet frames where the cα is located at the center of the sphere, the secondary structure dependence becomes visible in the level-δ rotamers. as an example, we show in figure  <dig> how some of the regions in figure  <dig> are seen on the surface of the ensuing cα centered sphere, by the roller coasting observer. the examples we have displayed are the overlap of the α-helical structures with the g − rotamer  and t rotamer , and the overlap of the β-stranded structures with the g − rotamer  and t rotamer . a secondary structure dependent trimodal rotamer structure is clearly present, in each of the distributions.figure  <dig> 
level-δ frenet frame distributions corresponding to the level-γ distributions in figure 
12
.  the labeling is as follows: α-g − stand for α-helical backbone secondary structure in g − rotamer in figure  <dig>  α-t stand for α-helical backbone secondary structure in t rotamer in figure  <dig>  β-g − stand for β-stranded backbone secondary structure in g − rotamer in figure  <dig> and β-t stand for β-stranded backbone secondary structure in t rotamer in figure  <dig> 



secondary structure dependent level-δ rotamer angles
following - and figure  <dig> we proceed to visually inspect secondary structure dependence in the level-δ rotamers. in equations -, the z, x now correspond to the cβ and cγ atoms, respectively.

we start with the non-aromatic amino acids. in figure  <dig> we show the distribution of all the cδ non-aromatic atoms in our data set. in this figure we have also identified those apparent rotamers that are classified either as α-helical or β-stranded in pdb. the figure shows that there is clear secondary structure dependence in these rotamers. the three corresponding level-γ rotamer subsets are also labeled in figure 16a). to see it more clearly we draw the individual distributions for the three level-γ rotamer subsets and prolines . far-away outliers also exist , these can be located and visualised by rotating the original sphere as in additional file 1: figure s <dig>  for the aromatic amino acids, we show all level-δ aromatic carbons  in additional file 1: figures s <dig> and s <dig>  again, the distributions of the secondary structures are localized well.figure  <dig> 
the level-δ stereographical distribution of non-aromatic c atoms in frames -.  in figure a) we show the entire background, and in b) and c) those that have been classified as α-helical and β-stranded, respectively. some outliers have also been marked.



levels ε, ζ and η
finally, we proceed to the ε, ζ and η levels. following the analysis of cγ and cδ distributions, we use the frame - to visualise the secondary structure dependent distribution of these levels. for this, we introduce the analogous cδ, cε and cζ frames to display the distributions of atoms at the corresponding levels.

for the cδ frame, we choose the atoms z, x in equation - to coincide with the cγ and cδ, respectively. note that in the case of phe and tyr two essentially identical choices can be made. in the case of trp there are also two choices, and we choose the one denoted cd <dig> in pdb, it is covalently bonded to the higher level c atoms. in the case of his a framing could also be based on the level-δ n atom, but here we select the level-δ c atoms that are denoted cd <dig> in pdb.

in figure 17a) - f) we show various examples of level-ε atoms. we observe that in addition of rotamers in the longitude, there are also rotamer-like variations in the latitude angle, as shown in black circles in each figure.figure  <dig> 
examples of rotamers in level-ε atoms.  the black circles have the same radius in a) and b), in c) and d), and in e) and f). in figure a) the α-helix and in b) the β-strand rotamers for for ce in met and lys; the structures outside the circle are lys, those inside are met. in figure c) the α-helix and in d) the β-strand rotamers for ce <dig> in phe and tyr. in figure e) the α-helix rotamers for oe <dig> in glu and gln, and in f) the α-helix rotamers for oe <dig> in glu .



similarly, we observe ζ-level atoms in cε frame, where z and x atoms in equations - take atoms cδ and cε, respectively. as an example, in figure  <dig> we identify one rotamer. in the case of β-stranded structures we observe three rotamers. we observe that the β-stranded rotamers are not distributed evenly. the rotamers are not related to each other by  120° rotations.figure  <dig> 
example of level-ζ rotamers.  in figure a) we have all the cζ carbons in phe and tyr. in figures b) and c) we show the subsets that correspond to α-helical and β-stranded secondary structures, respectively.



finally, we use cζ frame to observe η-level atoms with z and x taken as cε and cζ in the definition -. as an example, the nη <dig> distribution in arg is shown in figure  <dig>  now there is a very strong two-fold localisation of the distribution, shown in figure 19a). some of the outliers are encircled, as examples, in a).figure  <dig> 
example of level-η rotamers.  in figure a) we have all the nη <dig> atoms in arg. there are two very close rotamer states, which have been encircled. some outliers have also been encircled. in figures b)-d) we show the subsets that correspond to loops, β-stranded and α-helical secondary structures, respectively. comparison of the figures reveals that the two very close-by rotamers in a) correspond to loops and α-helices.



discussion
we have utilised modern 3d visualisation techniques and advances in virtual reality to describe how to construct an entirely cα geometry based visual library of the backbone and side chain atoms: there has been substantial progress in visualisation techniques, since the inception of the ramachandran map. in lieu of a torus, our approach engages the geometry of a sphere and as such it has a direct “what-you- see-is-what-you-have” visual correspondence to the protein structure. in particular, we utilise the geometrically determined discrete frenet frames of  <cit> . we propose the concept of an imaginary observer, chosen so that the discrete frenet frames determine the orientation of the observer when she roller-coasts along the backbone and climbs up the side chains. she maps the directions of all the heavy atoms on the surface of a two-sphere that surrounds her, exactly as these atoms are seen in her local frame like stars in the sky.

since the discrete frenet frames can be unambiguously determined in terms of the cα trace only, we can analyse both the backbone atoms and the side chain atoms on equal footing, in a single geometric framework. this is not possible in the conventional ramachandran approach, that assumes a priori knowledge of the peptide planes, to define the dihedral angles.

as examples of the approach, we have analysed the orientation of various heavy atoms that are located both along the backbone and in the side chains. our approach also enables a direct, visual identification of outliers.

in particular, we have found that in terms of the discrete frenet frames, the secondary structure dependence becomes clearly visible in the rotamer structure, both in the case of the backbone atoms and in the case of the side chain atoms. apparently this is not always the case, in conventional approaches such as  <cit> :

according to  <cit>  conventional secondary structure dependent rotamer libraries do not provide much more information than backbone-independent rotamer libraries. but by using the frenet frame coordinate system chosen here, we observe that there is a clear correlation between secondary structures and rotamer positions. thus the approach we have presented, can form a basis for the future development of a novel approach to the cα trace problem. as a complement to existing approaches  <cit>  the one we envision accounts for the secondary structure dependence in the heavy atom positions that we have revealed, which should lead to an improved accuracy in determining the heavy atom positions.

CONCLUSIONS
in this paper, we introduced a new method to visualise the heavy atom structure of a protein. in particular, our method easily detects those atoms in a crystallographic protein structure which are either outliers, or have been likely misplaced. our approach can form a basis for the development of a new generation, visualisation based side chain construction, validation and refinement tool. since the heavy atom positions are identified in a manner which correlates strongly with the secondary structure environment, this could lead to an improved accuracy, in particular when used in combination with existing methods.

additional file
additional file 1: 
some additional distribution examples for side-chain atoms.




competing interests

the authors declare that they have no competing interests.

authors’ contributions

xp and an conceived and designed the study. xp and sh developed the analysis method. xp, ac, yz and an analysed the pdb data. xp and an wrote the article. all authors read and approved the final manuscript.

