BACKGROUND
in nature, the majority of bacteria grow as biofilms in mixed consortia that use mutualistic, syntrophic, commensal or antagonistic strategies to compete for and efficiently utilize available nutrients . microbial biofilms are critically important in medical, environmental and engineered biological systems. for example, the human gut microbiome has emerged as a major focus for biomedical research with mounting evidence suggesting unhealthy gut flora biofilms are associated with illnesses including autoimmune diseases, colorectal cancer and inflammatory bowel disease . environmental microbial biofilm consortia form the basis of global nutrient cycles from nitrogen fixation to carbon fluxes  <cit> . additionally, the study of natural biofilms has gained in popularity recently due to their efficient organization and ability, through synergistic interactions, to optimize multiple tasks simultaneously like the deconstruction of complex, recalcitrant plant materials into simple sugars. a major goal of current biofuels research is to engineer synthetic microbial communities that mimic these naturally occurring biofilms for biomass conversion to renewable liquid fuels  <cit> . while foundational to the vast majority of microbial life on the planet, the basic design principles of consortial biofilms are still poorly understood due largely to the complexity of naturally occurring systems  <cit> .

chronic wounds are defined as a host-pathogen environment that has failed to proceed through a timely healing process. an estimated 2 % of the u.s. population  have a non-healing chronic wound with treatment costing more than $ <dig> billion per year . chronic wounds are often colonized by microorganisms growing as biofilms on a complex mixture of wound exudate . microbes residing in biofilms exhibit phenotypes distinct from planktonic growth, making treatment a major challenge. for instance, bacteria in biofilms can tolerate antimicrobial agent concentrations  <dig>  times higher than the same microbes grown planktonically  <cit> . chronic wounds are typically colonized by consortia comprised of different microbial species . polymicrobial infections have been reported to have elevated mortality rates relative to monocultures  <cit> , and in vivo rabbit model systems demonstrated that consortia prevented wound healing compared to their respective monocultures  <cit> .

the aerobe pseudomonas aeruginosa and the facultative anaerobe staphylococcus aureus are two bacteria commonly isolated from chronic would biofilm infections  <cit> . the same two bacteria are often key contributors to multispecies infections that occur in the lung mucous of cystic fibrosis patients  <cit> . p. aeruginosa is known to exhibit much lower growth rates than s. aureus and other facultative anaerobes in anaerobic environments common in chronic wound and mucoid biofilms  <cit> . perhaps partially in response to this metabolic disadvantage, p. aeruginosa has evolved a number of mechanisms to enhance its competitiveness in multispecies biofilm communities. the most widely studied mechanism is growth inhibition and lysis of competing bacteria through the secretion of an arsenal of small molecule  and protein  toxins. the consumption of metabolic byproducts secreted by other bacteria through cross feeding mechanisms also has been proposed to enhance p. aeruginosa competitiveness  <cit> . another putative mechanism is p. aeruginosa chemotaxis towards high oxygen niches  where it is metabolically competitive.

multispecies biofilms are sufficiently complex to preclude detailed understanding through traditional experimental techniques developed for planktonic cultures. a primary challenge is the complex interactions between the biofilm species and the extracellular environment  <cit> . most naturally occurring microbial consortia exist in spatially heterogeneous environments that also exhibit temporal variations. the presence of spatial heterogeneity plays an essential role in the evolution and function of microbial species  and has profound effects on biofilm formation and development  <cit> . concentration gradients in key nutrients due to limited diffusion establish metabolic niches within the biofilm that can produce spatial variations in biomass density  <cit>  and additionally spatial partitioning of species in the case of multispecies biofilms  <cit> . quantitative understanding of the relationships between spatial and temporal variations in the extracellular environment and community metabolism is critical to systematically analyze and rationally manipulate biofilm consortia. while spatiotemporal metabolic models that account for both spatial and temporal variations in the extracellular environment have been constructed, these models rely on table lookups of precomputed flux balance solutions  or lattice based descriptions of nutrient diffusion  <cit> .

we recently proposed a general methodology for spatiotemporal metabolic modeling based on combining genome-scale reconstructions with fundamental transport equations that capture the relevant convective  <cit>  and/or diffusional  <cit>  processes. in this paper, we applied this methodology to develop biofilm metabolic models that predict the complex spatiotemporal behavior of a p. aeruginosa/s. aureus two species system. the biofilm models were formulated by combining genome-scale reconstructions of p. aeruginosa and/or s. aureus metabolism with uptake kinetics and reaction-diffusion type equations for extracellular substrates and metabolic byproducts. to avoid complications associated with solving a moving boundary problem, the biofilm was assumed to have a fixed thickness over which metabolites diffused and cell growth occurred. therefore, the models were most appropriate for predicting the metabolism of biofilms of a specified thickness. we developed an effective computational method for solving the biofilm models, which consisted of a set of partial differential equations with mixed boundary conditions constrained by embedded linear programs. the models were used to analyze the metabolic differences between single species and two species chronic wound biofilms and to investigate putative factors that could impact the physiology of the two species biofilm, including nutrient diffusion, metabolite cross-feeding, p. aeruginosa motility and p. aeruginosa mediated lysis of s. aureus.

methods
model formulation
biofilm models were formulated by combining genome-scale reconstructions of p. aeruginosa and/or s. aureus metabolism with uptake kinetics for available nutrients and reaction-diffusion type equations for species biomass, supplied substrates and synthesized metabolic byproducts. single species biofilm models were formulated with either the p. aeruginosa or s. aureus reconstruction, while the two species model used both reconstructions. diffusion was assumed to occur only in the axial direction of the biofilm such that spatial variations could be captured with a single variable z . for simplicity, the biofilm was assumed to have a fixed thickness w over which the nutrients diffused and cell growth occurred. therefore, the models were most appropriate for predicting the metabolism of biofilms of a specified thickness. both strains were assumed to consume glucose as the primary carbon source  <cit> . glucose was supplied at the tissue-biofilm interface at the assumed concentration of the wound exudate, while oxygen was supplied at the biofilm-air interface at a concentration for an aqueous solution in equilibrium with atmospheric oxygen.fig.  <dig> formulation and solution of the multispecies biofilm metabolic model. a schematic representation of the chronic wound biofilm model of constant thickness w with glucose provided at the tissue-biofilm interface , oxygen supplied at the biofilm-air interface  and the metabolic byproducts acetate, succinate and lactate removed at the tissue-biofilm interface. b schematic representation of the biofilm metabolic model solution procedure. the multispecies biofilm with temporal and spatial variations is described by a spatiotemporal model that accounts for the diffusion of nutrients and byproducts. pdes are written with respect to the bacterial species concentration  and the metabolite concentrations  assuming that spatial variations are limited to a single direction z. lexicographic linear program solution of the genome-scale reconstruction of each species is performed to predict the growth rate, nutrient uptake rates and byproduct secretion rates. the pdes are spatially discretized to yield a large-set of odes with embedded lps that are integrated with the matlab code dfbalab  <cit>  to generate time and spatially resolved predictions



the p. aeruginosa pa <dig> imo <dig> reconstruction accounts for  <dig> genes,  <dig> enzymes,  <dig> intracellular reactions and  <dig> exchange reactions  <cit> . this reconstruction has been shown to provide good agreement with experimentally determined biomass yields for aerobic growth on glucose and anaerobic growth on glucose with nitrate as an electron acceptor. our preliminary flux balance calculations with a maximum growth objective showed the primary metabolic byproducts to be acetate and l-alanine. the secretion fluxes of other minor byproducts were approximately an order of magnitude less than for acetate and l-alanine. p. aeruginosa is known to secrete acetate, lactate and succinate  <cit> , while the secretion of l-alanine has not been reported. to obtain byproduct distributions in better agreement with  <cit> , we constrained the l-alanine secretion flux to zero. this modification resulted in a redirection of flux from l-alanine to succinate with little effect on the secretion fluxes of acetate and minor byproducts. furthermore, we enforced a minimal non-growth associated atp maintenance flux of 5 mmol/gdw/h, the same value as in the s. aureus reconstruction, to reduce the p. aeruginosa anaerobic growth rate for consistency with experimental studies  <cit> . the imo <dig> reconstruction contained succinate, lactate and acetate uptake fluxes that allowed the investigation of putative cross feeding of metabolic byproducts. secretion of the small molecule inhibitor pycoyanin was included by adding an exchange flux with an adjustable lower bound that forced pycoyanin synthesis, which was in opposition to growth rate maximization.

the s. aureus n <dig> imh <dig> reconstruction accounts for  <dig> genes,  <dig> enzymes,  <dig> intracellular reactions and  <dig> exchange reactions  <cit> . this model correctly reproduces byproduct secretion patterns under aerobic conditions with glucose limitation and under anaerobic conditions with glucose excess . our flux calculations showed that the primary byproducts were acetate and lactate. the imh <dig> reconstruction contained lactate and acetate uptake fluxes that allowed reassimilation of secreted metabolic byproducts. to explore the possibility of succinate cross feeding, the s. aureus model was modified to allow succinate uptake through a putative proton dependent symport mechanism.

uptake kinetics were specified for the supplied substrates glucose and oxygen as well as for the possible cross-fed metabolites lactate, succinate and acetate. although both p. aeruginosa and s. aureus are well known for their ability to perform anaerobic respiration using nitrate as an electron acceptor in place of oxygen, we have neglected the possible role of denitrification in this study. uptake kinetics were assumed to follow standard monod expressions of the form,  <dig> vi=vmax,isi—————km,i+si 

where vi is the uptake rate  of the i-th substrate, si is the extracellular concentration  of the i-th substrate, vmax,i is the maximum uptake rate and km,i is the half saturation constant. equation  was used to establish transport bounds on the uptake rates with the actual uptake rates being determined by solution of the intracellular flux balance problem. both vmax,i and km,i were important parameters due to the large nutrient spatial gradients induced by diffusion through the biofilm.

mass balances on the two species had the form,  <dig> ∂x∂t=μxx−kdxx+ka∂∂z,∂x∂z= <dig> ∂x∂z=0∂y∂t=μyy−kdyy−klpy,∂y∂z= <dig> ∂y∂z= <dig> 

where x and y are the biomass concentrations  of p. aeruginosa and s. aureus, respectively, z = x + y is the total biomass concentration, and μx and μy are the corresponding growth rates  obtained from the flux balance calculations. if local nutrient concentrations became too small to meet the atp maintenance demand of a species, then the flux balance problem for the species became infeasible at that location. once an infeasibility was detected, the death rate constant kdx or kdy was rapidly increased exponentially from zero to a fixed, non-zero value to simulate that the species would begin to die at that location. this approach ensured that the model equations remained smooth and could be integrated. p. aeruginosa has flagella for motility and can aerotaxis towards higher oxygen levels  <cit> . this capability was captured in the model by including a typical chemotaxis term  <cit>  where o is the oxygen concentration  and ka is the aerotaxis rate constant. cell growth was restricted to a maximum cell concentration zmax to account for cell crowding effects within the biofilm. no flux boundary conditions were imposed at the tissue-biofilm  and biofilm-air  interfaces under the assumption that cells could not leave the biofilm via mechanisms such as dispersal.

p. aeruginosa secretes pyocyanin and other small molecules that are known to inhibit and lyse of competing bacteria such as s. aureus  <cit> . this lysis mechanism was included in the model through a pyocyanin concentration  dependent death term with rate constant kl in the s. aureus mass balance in eq. . pyocyanin synthesis by p. aeruginosa and diffusion through the biofilm was captured with the mass balance,  <dig> ∂pzt∂t=vpx+dp∂2p∂z <dig> −dp∂p0t∂z=kmppb−p0t,∂pwt∂z= <dig> 

where vp is the specific pyocyanin synthesis rate obtained from the flux balance calculation and dp is the pyocyanin diffusion coefficient. a no flux boundary condition was imposed at the biofilm-air interface assuming that the pyocyanin was non-volatile. by contrast, a robin type boundary condition was imposed at the tissue-biofilm interface to describe possibly mass transfer limited removal of pyocyanin, where kmp is pyocyanin mass transfer coefficient and pb is the bulk pyocyanin concentration in the tissue.

the glucose and oxygen mass balances were formulated under the assumptions that oxygen gas-liquid mass transfer was fast compared to oxygen uptake and that metabolites had negligible volatilities:  <dig> ∂gzt∂t=vgxx+vgyy+dg∂2g∂z2−dg∂g0t∂z=kmggb−g0t,∂gwt∂z=0∂ozt∂t=voxx+voyy+do∂2o∂z2−do∂o0t∂z=kmoob−o0t,−do∂owt∂z=kmooa−owt 

where g is the glucose concentration , the p. aeruginosa uptake fluxes vgx and vox and the s. aureus uptake fluxes vgy and voy were obtained from the flux balance calculations, and dg and do are the glucose and oxygen diffusion coefficients. for glucose, a no flux boundary condition was imposed at the biofilm-air interface assuming glucose was not volatile and a robin type boundary condition was imposed at the tissue-biofilm interface to model possibly mass transfer limited transport of glucose into the biofilm. here kmg is the glucose mass transfer coefficient and gb is the bulk glucose concentration in the wound exudate. for oxygen, robin type boundary conditions were imposed at both interfaces with oxygen mass transfer coefficient kmo, oxygen concentration ob at the tissue-biofilm interface and oxygen concentration oa at the biofilm-air interface.

mass balances on the three primary metabolic byproducts had the form,  <dig> ∂mjzt∂t=vmjxx+vmjyy+dmj∂2mj∂z2−dmj∂mj0t∂z=kmmjmj,b−mj0t,∂mjwt∂z= <dig> 

where mj is concentration  of the j-th byproduct , the secretion  fluxes vmjx and vmjy were obtained from the flux balance calculations, dmj is the diffusion coefficient, kmmj is the mass transfer coefficient at the tissue-biofilm interface, and mj,b is the bulk concentration of the wound exudate. no flux boundary conditions were imposed at the biofilm-air interface assuming the byproducts were not volatile, while a robin type boundary condition was imposed at the tissue-biofilm interface to allow removal of the byproducts from the biofilm.

the biofilm diffusion coefficients were assumed to depend on the total biomass concentration z such that diffusion was reduced in more dense regions of the biofilm  <cit> ,  <dig> dmk=dwmk1−amkz <dig> .19+ <dig> z <dig> , 

where dmk is the biofilm diffusion coefficient of the k-th species , dwmk is the aqueous diffusion coefficients at 37 °c and amk is an adjustable parameter. these relations were obtained using a previously proposed empirical equation  <cit>  by adjusting amk such that the biofilm diffusion coefficient was equal to the aqueous value when z =  <dig> and equal to biofilm values reported elsewhere  <cit>  when z = zmax. because pyocyanin has a comparable molecular weight to glucose, the inhibitor diffusion coefficient was chosen to follow the same relation.

model parameters
we found a dearth of literature for determining species specific values for the  <dig> parameters needed to calculate uptake rates with respect to the five possible nutrients . consequently, the two species were assumed to have the same uptake parameter values. we used representative glucose  <cit>  and oxygen  <cit>  uptake parameter values reported for the model bacterium escherichia coli under the assumption that p. aeruginosa and s. aureus should have similar values. because we were not able to find reliable uptake parameter values for succinate, lactate and acetate, the associated vmax and km values were assumed to be equal to those for glucose . therefore results focused on differences in metabolic network structure of the two species and not on differences in uptake properties.table  <dig> nominal nutrient uptake parameters

p. aeruginosa or s. aureus

v
k


other parameter values for the biofilm model were obtained from the literature to the extent possible . we utilized a typical biofilm thickness w and assumed wound exudate concentrations consistent with published values. the air oxygen concentration oa was derived from the oxygen content of atmospheric air. p. aeruginosa and s. aureus cell death were implemented by exponentially increasing the death rate constants from zero to the values listed in table  <dig> when local nutrient concentrations were not sufficient to meet atp maintenance demands. the lower bound on the p. aeruginosa pyocyanin synthesis flux vp,min was tuned such that the average pyocyanin concentration within the biofilm was the same order of magnitude as that observed experimentally in  <cit> . the s. aureus inhibitor-mediated death constant kl was tuned to achieve reasonable spatial distributions of the two species, which included p. aeruginosa dominance in the aerobic region of the biofilm, s. aureus dominance in the anaerobic region and a sharp spatial division between the two species .table  <dig> nominal model parameter values


w

g
b

o
a

o
b

a
b

s
b

l
b

p
b

kdx
,
kdy

k
l

k
dp

z
max

km
g
, km
a
, km
s, km
l
, km
p

d
wg

d
wo

d
wa

d
ws

d
wl

d
wp

a
g, a
s, a
l, a
p

a
o

a
a

x
0
, y
0

k
a

km
o


the maximum achievable biomass concentration zmax was chosen to be within the large range of published values  <cit> . we established reasonable metabolite concentrations within the biofilm by adjusting a single mass transfer coefficient for glucose, acetate, succinate, lactate and pyocyanin such that their average concentrations were the same order of magnitude as those observed experimentally in  <cit>  and  <cit> . the p. aeruginosa aerotaxis rate constant ka was chosen such that p. aeruginosa was dominant in the aerobic region of the biofilm and a sharp spatial division between the two species was established as the biofilm matured towards a steady-state condition  <cit> . initial conditions for each simulation were generated by first running a simulation with each species biomass concentration constrained to be 1 g/l and capturing the resulting steady-state solution. these initial conditions reflected a newly developed, nearly spatially homogeneous biofilm with small cell densities, high nutrient levels and low byproduct concentrations.

model solution
the two species biofilm model consisted of a set of partial differential equations  with mixed boundary conditions and embedded linear programs . the efficient and stable solution of such models is a challenging problem at the forefront of microbial metabolic modeling  <cit> . as described in our previous publications  <cit> , we pursued a spatial discretization approach based on converting the pdes into a large set of ordinary differential equations  in time with embedded lps . the spatial domain  was discretized using n =  <dig> node points at which the diffusion terms in eqs.  –  were discretized using central difference approximations with second-order accuracy. the specified boundary conditions were incorporated into the central difference approximations at the boundary node points. this procedure yielded a set of  <dig> odes at each node point for the local concentrations of p. aeruginosa and s. aureus biomass, glucose, oxygen, acetate, succinate, lactate and pyocyanin.

this ode system was solved using dfbalab  <cit> , a matlab tool that explicitly addresses problems associated with lp alternative optima and possible infeasibilities  <cit> . dfbalab employs a lexicographic optimization strategy in which a series of lp problems are sequentially solved to ensure the determination of unique exchange fluxes necessary for a well-defined dynamic system. each lp is solved subject to constraints that the previous objectives are equal to their optimal values, with the required number of lps equal to the number of exchange fluxes. we specified the lexicographic optimization objectives to reflect known or anticipated physiology of the two species biofilm community . we found that reordering these objectives had no noticeable effect on simulation results. each node point was represented by  <dig> odes for the local species and metabolite concentrations and  <dig> lps for lexicographic optimization. we employed  <dig> node points such that the discretized biofilm model consisted of  <dig> odes and  <dig> lps.table  <dig> lexicographic objective functions



all simulations were performed with matlab  <dig>   using dfalab, the stiff matlab integrator ode15s for dynamic flux balance model solution and gurobi  <dig>  for linear program solution. a typical 1000-h dynamic simulation for determining a steady-state solution required about 25 min running on an asus computer with intel core i7- <dig> processor and 24 gb ram. as compared to alternative computational methods for spatiotemporal metabolic modeling based on table lookups of precomputed fba solutions combined with integration of the pdes on a coarse spatial grid  and real-time fba solution combined with lattice-based descriptions of metabolite diffusion  <cit> , we believe our approach offers several important advantages including the use of dfbalab, the ability to directly embed lps within the discretized odes, and the flexibility to solve the ode-lp system using stiff integrators with variable step size and error control.

RESULTS
flux balance analysis of single species metabolism
flux balance analysis  was performed on the single species, genome-scale reconstructions to investigate p. aeruginosa and s. aureus growth rates in different metabolic niches consistent with the bottom, middle and top of the biofilms. more specifically, fba was used to predict growth rates at three different glucose and oxygen uptake rates. we also performed fba at three different acetate and lactate uptake rates to investigate the effect of byproduct uptake on growth rates. the growth rate of s. aureus was predicted to equal or exceed that of p. aeruginosa for all combinations of glucose and oxygen uptake rates, with the difference most pronounced under anaerobic conditions expected at the bottom of the biofilm . no growth was predicted for either species under anaerobic, low glucose conditions which may prevail in mature biofilms of sufficient thickness. when acetate was used as the carbon source, p. aeruginosa was predicted to have low growth rates that depended only on the acetate uptake rate until oxygen became limiting. s. aureus was not able to grow on acetate at any oxygenation level, as has been observed experimentally  <cit> . as compared to glucose, the absolute growth rates and differences between species growth rates was relatively small for growth on lactate. collectively, these results suggest that s. aureus has a distinct growth rate advantage over p. aeruginosa for all conditions anticipated in the simulated two species biofilm.table  <dig> flux balance analysis of p. aeruginosa  and s. aureus  single species metabolism. growth rates  are shown for different combinations of substrate uptake rates 

representative uptake rates at the top, middle and bottom of a typical simulated two species biofilm are colored coded



metabolism of single species biofilms
dynamic simulations were performed for single species biofilms consisting of only p. aeruginosa or s. aureus with glucose and oxygen as the only substrates. simulations were performed over a time window of 1000 h to capture a steady-state solution, although near steady-state behavior was typically established in <100 h. for each species, biofilms of different thicknesses were simulated to determine the maximum thickness wmax that could be sustained under the given environmental conditions. if the biomass concentration dropped below 10 g/l  anywhere in the mature biofilm obtained after 1000 h of simulation, the thickness was deemed too large and reduced. these simulations predicted that s. aureus could grow much thicker biofilms with wmax = 90 μm compared to p. aeruginosa with wmax = 30 μm.

spatially resolved predictions obtained after 1000 h showed that the p. aeruginosa biofilm  were characterized by high biomass concentrations throughout the biofilm, low oxygen concentrations near the bottom of the biofilm furthest from the oxygen source, low glucose concentrations near the top of the biofilm furthest from the glucose source, and acetate and succinate as the primary metabolic byproducts. if the biofilm thickness was chosen larger than wmax = 30 μm, the p. aeruginosa biomass concentration dropped below 10 g/l at the bottom of the biofilm due to the combination of low oxygen penetration and very small anaerobic growth rates . the s. aureus biofilm model predicted much deeper oxygen penetration  due to more efficient use of oxygen for glucose oxidation . superior anaerobic growth allowed s. aureus to produce much thicker biofilms under the same environmental conditions. otherwise, the predictions were similar to those obtained with p. aeruginosa with lactate replacing succinate as a primary byproduct. if the s. aureus biofilm thickness was chosen larger than wmax = 90 μm, the biomass concentration dropped below 10 g/l near the top of the biofilm due to inadequate glucose penetration. the effect of the metabolite mass transfer coefficients on concentration gradients within the s. aureus biofilm are shown in additional file 1: figure s <dig> fig.  <dig> spatially resolved predictions for single species biofilms. a
p. aeruginosa with a maximum biofilm of thickness w = 30 μm. b
s. aureus with a maximum biofilm of thickness w = 90 μm



metabolism of two species biofilms
dynamic simulations were performed for two species biofilms consisting of p. aeruginosa and s. aureus using eight different hypothetical scenarios. scenario  <dig> was the base case where the two bacteria competed for glucose and oxygen in the absence of byproduct crossfeeding, p. aeruginosa aerotaxis or pyocyanin-mediated lysis of s. aureus. we found the two species wmax = 80 μm, which was slightly less that the s. aureus wmax = 90 μm but substantially larger than the p. aeruginosa wmax = 30 μm. the two species wmax was a linear combination of the single species wmax values weighted by the average biomass concentrations in the two species biofilm:  <dig> wmax=90μm165gl+30μm35gl165+35gl= <dig> μm 

if the two species biofilm thickness was chosen larger than wmax = 80 μm, the biomass concentration dropped below 10 g/l near the top of the biofilm due to inadequate glucose penetration. the relationship between the two species was interpreted to be antagonistic with the incorporation of p. aeruginosa into a s. aureus biofilm reducing the achievable thickness for a given set of conditions.

when the two species biofilm thickness was set equal to wmax = 80 μm, pseudo steady-state solutions were obtained after only 50 h of simulation . oxygen was quickly depleted throughout most of the biofilm, except near the biofilm-air interface where an aerobic region was established as observed experimentally  <cit> . similarly, glucose was rapidly depleted in all regions except near the tissue-biofilm interface where a glucose rich region was maintained. s. aureus was predicted to quickly establish dominance throughout the biofilm due to its higher local growth rates, especially in the anaerobic region. initially acetate and succinate levels increased but thereafter they were predicted to decrease due to metabolite removal at the tissue-biofilm boundary. lactate levels were predicted to remain high throughout the biofilm due to s. aureus synthesis in the anaerobic region and diffusion into the aerobic region. as in the single species biofilms, multispecies biofilm spatial profiles obtained after 1000 h of simulation  were characterized by the presence of a glucose rich, anaerobic region near the tissue-biofilm interface and a glucose depleted, aerobic region near the biofilm-air interface. s. aureus was predicted to be dominant throughout the biofilm, especially in the anaerobic region, while p. aeruginosa was predicted to be present only in the aerobic region. byproduct profiles were similar to those obtained for the s. aureus single species biofilm  with high lactate levels, low acetate levels and no succinate production. we attributed this behavior to partitioning of p. aeruginosa to the aerobic region where the synthesis of byproducts was substantially reduced.fig.  <dig> predictions for a two species biofilm of thickness w = 80 μm . a time resolved predictions over the first 50 h at the bottom, middle and top of the biofilm. b spatially resolved biomass and metabolite concentration predictions after 1000 h. c spatially resolved effective growth and uptake rate predictions after 10 h



to further analyze how multispecies metabolism depended on position in the biofilm, local effective growth rates and nutrient uptake rates were determined from the base case  simulation data. for species i, the local effective growth rate was calculated as the difference between the biomass restricted growth rate μi and the energy associated death rate kdi at a given position z. consequently, the effective growth rate could be negative in nutrient lean regions. the calculations were performed using data collected at t = 10 h because these initial rates offered insights into biofilm physiology. s. aureus growth rates exceeded p. aeruginosa growth rates at all positions, especially in the anaerobic region near the bottom of the biofilm where p. aeruginosa death was predicted . both species were predicted to have constant growth rates in the upper aerobic region. the p. aeruginosa growth rate decreased rapidly in the lower half due to decreasing oxygen availability such that death occurred in the first 35 μm. by contrast, the s. aureus growth rate increased rapidly in this region due to the increasing availability of glucose to support anaerobic growth. as time progressed, these local growth rates resulted in s. aureus dominance throughout the biofilm and p. aeruginosa presence only in the aerobic region . the glucose uptake rate increased monotonically from bottom to top of the biofilm, while the oxygen uptake rate was predicted to exhibit a maximum near the center because that location offered the optimal combined availability of glucose and oxygen to support consortium growth.fig.  <dig> predictions after 1000 h for two species biofilms of thickness w = 80 μm with different species interaction mechanisms. base case : competition for the nutrients glucose and oxygen. cross-feed : nutrient competition plus cross feeding of lactate, succinate and acetate. lysis : nutrient competition plus p. aeruginosa mediated lysis of s. aureus. aerotaxis : nutrient competition plus p. aeruginosa chemotaxis towards oxygen. a-d spatially resolved biomass concentrations and e
p. aeruginosa , s. aureus , total biomass concentrations averaged across the biofilm and maximum thickness for the eight considered scenarios



we also performed simulations assuming additional oxygen was available at the biofilm-tissue interface at a blood plasma concentration of  <dig>  mmol/l  <cit> . this oxygen source allowed p. aeruginosa growth near the biofilm-tissue interface and therefore reduced spatial partitioning of the two species . however, s. aureus still dominated throughout the biofilm due to it higher aerobic and anaerobic growth rates.

byproduct cross feeding
we hypothesized that cross feeding of secreted metabolic byproducts  would enhance the competitiveness of p. aeruginosa in the aerobic portion of the biofilm. except for the inability of s. aureus to consume acetate, experimental studies as well as our fba results  show that the two species are capable of metabolizing these byproducts in the presence of sufficient oxygen. therefore, we investigated the impact of putative cross feeding by allowing each species to enhance its growth through uptake of the three byproducts . the two species were assumed to uptake each byproduct with the same kinetics  due to lack of data on species and substrate specific uptake parameters.

the cross-feed scenario model predicted that wmax remained 80 μm when byproduct cross feeding was incorporated. because glucose was the more energetically favorable carbon source, most of the available oxygen was used for glucose oxidation and little oxygen remained for lactate oxidation. contrary to our hypothesis, cross-feeding reduced the region where p. aeruginosa was present and did not substantially increase the p. aeruginosa biomass concentration within this region . to succinctly quantify this behavior, the p. aeruginosa and s. aureus biomass concentrations were averaged across the biofilm and compared to average concentrations obtained for the base case scenario without cross feeding. while the total biomass concentration was not affected, cross-feeding increased the fraction of s. aureus relative to p. aeruginosa . since lactate was the primary byproduct of the two species biofilm, we attributed this behavior to s. aureus having more efficient lactate metabolism. single species fba results show that s. aureus has higher growth rates on lactate under oxygen sufficient and oxygen limited conditions . because similar behavior was observed for glucose metabolism in single species biofilms, the addition of lactate consumption was predicted to further increased s. aureus dominance in the aerobic region where sufficient oxygen was available for lactate oxidation.

p. aeruginosa inhibition of s. aureus
p. aeruginosa is known to secrete a number of small molecules including pyocyanin which inhibit and lyse competing bacteria such as s. aureus. additional simulations were performed to explore the impact of a putative pyocyanin-mediated lysis mechanism on the two species biofilm. when this mechanism was combined with nutrient competition , the model predicted that wmax was slightly increased to 90 μm. reduction of s. aureus biomass in the anaerobic region resulted in slightly higher glucose levels throughout the biofilm, allowing increased p. aeruginosa growth in the upper aerobic region and a greater biofilm thickness.

to allow direct comparison with the other species interaction scenarios, simulations also were performed for an 80 μm thick biofilm. spatial profiles showed sharp partitioning of the two species with p. aeruginosa dominant in the upper aerobic region of the biofilm . this effect was achieved at the expense of the s. aureus biomass concentration, which was substantially reduced in the lower anaerobic region and dropped to zero at 40 μm. while the oxygen profile was largely unaffected, reduction of s. aureus biomass in the anaerobic region resulted in slightly higher glucose levels throughout the biofilm. pyocyanin levels were highest in the aerobic region due to diffusion and removal at the tissue-biofilm interface. the metabolic burden of synthesizing pyocyanin was predicted to have a minimal effect on p. aeruginosa growth due to the small enforced bound of  <dig>  mmol/gdw/h. at a maximum glucose uptake rate of 10 mmol/gdw/h, only  <dig>  % of available carbon was used for pyocyanin synthesis.fig.  <dig> spatially resolved predictions after 1000 h for a two species biofilm of thickness w = 80 μm with pyocyanin mediated lysis of s. aureus. a biomass and metabolite concentration predictions after 1000 h. b effective growth and uptake rate predictions after 10 h



as before, local effective growth rates and nutrient uptake rates were calculated at t = 10 h to investigate how pyocyanin affected multispecies metabolism as a function of position in the biofilm. in this case, the effective local growth rate of s. aureus was calculated by subtracting the maintenance energy associated death rate and the pyocyanin associated death rate from the biomass restricted growth rate at a given point z ). in the upper aerobic region, pyocyanin release caused the s. aureus death rate to exceed the growth rate  such that s. aureus was eventually eliminated from this region. this balance was reversed in the anaerobic region, although s. aureus growth was substantially reduced. by contrast, the p. aeruginosa growth rate was very similar to the pyocyanin-free case . the long-term effects of these local growth rates were a sharp spatial partitioning of the two species and reduced s. aureus biomass concentrations in the anaerobic region. as a result, slightly higher glucose uptake rates were predicted across the biofilm while the oxygen uptake rates were similar to the pyocyanin-free case . when biomass concentrations were averaged across the biofilm, the pyocyanin-mediated lysis mechanism was predicted to substantially increase p. aeruginosa competitiveness at the expense of both s. aureus and total biomass .

combining byproduct cross feeding and the lysis mechanism  did not change wmax from the pyocyanin-free case  but did increase s. aureus competitiveness by shifting the location where the species partitioned approximately 15 μm towards the biofilm-air interface . the addition of cross feeding resulted in average biomass concentrations that were roughly equal, while total biomass was reduced . we hypothesized that this unexpected effect was due to increased oxygen utilization by s. aureus for lactate oxidation. although s. aureus biomass was simultaneously reduced by pyocyanin- mediated lysis, the oxygen used for s. aureus growth was not available for p. aeruginosa oxidative growth and total biomass decreased. therefore, the pyocyanin mechanism was interpreted as an antagonistic mechanism by which p. aeruginosa increased its own competitiveness.

p. aeruginosa aerotaxis
p. aeruginosa has a single flagellum that may allow motility in complex, heterogeneous environments such as biofilms  <cit>  while s. aureus is generally viewed as non-motile  <cit> . more specifically, p. aeruginosa has been observed to chemotax towards higher oxygen environments, a process known as aerotaxis, which offer more favorable growth conditions  <cit> . to explore the impact of this putative aerotaxis mechanism on two species biofilm metabolism, the p. aeruginosa biomass equation included a chemotaxis term  and simulations were performed with both nutrient competition and aerotaxis . the energy requirements for chemotaxis were assumed negligible compared to growth. when aerotaxis was combined with nutrient competition, the model predicted that wmax was increased to 120 μm. aerotaxis increased spatial partitioning of the two species  such that p. aeruginosa had access to more oxygen for lactate respiration, resulting in a thicker biofilm.

spatial profiles generated for an 80 μm biofilm show almost complete partitioning of the two species, with p. aeruginosa dominating in the upper aerobic half, only s. aureus present in the lower anaerobic region, and the two species coexisting for about 10 μm near the middle of the biofilm . aerotaxis allowed p. aeruginosa to substantially improve its competitiveness by increasing its concentration in the upper portion of the biofilm rather than by moving the transition region between the two species . when averaged across the biofilm, the biomass concentrations of the two species were approximately equal while total biomass was unaffected compared to the aerotaxis-free case . unlike pyocyanin-mediated lysis, aerotaxis could be viewed as an antagonistic mechanism by which p. aeruginosa increased its own competitiveness without reducing total cell densities.fig.  <dig> spatially resolved predictions after  <dig> h for a two species biofilm of thickness w =  <dig> µm with p. aeruginosa aerotaxis. a biomass and metabolite concentration predictions after  <dig> h. b effective growth and uptake rate predictions after  <dig> h



when byproduct cross feeding was added to p. aeruginosa aerotaxis and nutrient competition , the model predicted wmax = 120 μm, the same value obtained in the absence of cross feeding. when simulations were performed for an 80 μm thick biofilm, the addition of cross feeding substantially increased s. aureus biomass in the biofilm while having a small negative impact on total biomass . of the eight scenarios investigated, a maximum wmax = 130 μm was predicted when nutrient competition and aerotaxis were combined with pyocyanin-mediated lysis of s. aureus . in this case, p. aeruginosa had access to increased glucose due to s. aureus death in the anaerobic region and increased lactate due to the absence of s. aureus in the aerobic region, which combined to enhance p. aeruginosa growth and allow a thicker biofilm. for a nominal biofilm thickness of 80 μm, only p. aeruginosa was present in the upper 50 μm of the biofilm and the amount of s. aureus was relatively small in the lower anaerobic region . the further addition of byproduct cross feeding did not affect wmax but did increase s. aureus competitiveness  . collectively, these predictions suggest that both pyocyanin-mediated lysis and aerotaxis are potentially powerful mechanisms for p. aeruginosa to enhance its competitiveness in multispecies biofilms with the faster growing facultative anaerobe s. aureus.

discussion
we hypothesized that the tendency of bacteria to self-organize into complex biofilm structures is at least partially driven by the appearance of metabolic niches  <cit> . to test this hypothesis, we developed spatiotemporal metabolic models of chronic wound biofilms consisting of the aerobe pseudomonas aeruginosa and/or the facultative anaerobe staphylococcus aureus. the models were comprised of genome-scale metabolic reconstructions combined with partial differential equations  for the diffusion and consumption/synthesis of nutrients/byproducts within the biofilm. both single species and two species biofilms were simulated by supplying glucose at the tissue-biofilm interface  and oxygen at the biofilm-air interface .

simulations of single species biofilms were performed to compare the metabolic behavior of each species and to provide a basis for comparing the two species biofilm simulations. although the biofilm thickness was specified a priori for each simulation, we gained insights into the collective biofilm substrate utilization efficiency as quantified by the maximum achievable thickness wmax under the specified environmental conditions. by assuming that the thickness was too large if the biomass concentration dropped below 10 g/l  anywhere in the mature biofilm, the models predicted that s. aureus could grow much thicker biofilms with wmax = 90 μm compared to p. aeruginosa with wmax = 30 μm. other differences predicted by the single species models were that s. aureus allowed much deeper oxygen penetration and produced much larger amounts of its primary metabolic byproduct lactate, a putative cross-fed metabolite. we attributed these differences in biofilm phenotypes to s. aureus having more efficient oxygen utilization in the upper aerobic region as well as substanially high growth rates in the lower anaerobic region. these model predictions could be experimentally tested by measuring metabolite concentration profiles using spatially resolved metabolomics  and gene expression profiles using spatially revolved transcriptomics  <cit> .

two species biofilm simulations were performed for eight different scenarios to investigate the impact of putative mechanisms for interspecies interactions. for the base case involving only competition for the two nutrients glucose and oxygen, we found a maximum thickness wmax = 80 μm for the two species biofilm. this value represented a linear combination of the single species wmax values weighted by the average biomass concentrations in the two species biofilm. dynamic simulations for an 80 μm thickness predicted that the two species would form a nearly mature biofilm in approximately 50 h, the time frame of many experimental studies  <cit> . two metabolic niches were quickly established in the simulated biofilm: an anoxic, glucose rich region in the lower half and an aerobic, glucose lean region in the upper half. due to its superior anaerobic growth and more efficient oxygen utilization, s. aureus quickly established dominance throughout the biofilm. steady-state spatial profiles demonstrated that this short-term behavior was maintained over long time periods, with p. aeruginosa only present in the aerobic region and lactate synthesized by s. aureus in the anaerobic region being the main byproduct. the experimental determination of spatially resolved biomass concentrations  <cit>  would be beneficial in this context.

cross feeding of secreted metabolic byproducts is common in bacterial communities  <cit>  and multispecies biofilms  <cit> . for example, a cross feeding mechanism has been proposed for a polymicrobial infection system consisting of the two facultative anaerobes aggregatibacter actinomycetemcomitans and streptococcus gordonii  <cit> . to explore the hypothesis that cross feeding would enhance p. aeruginosa competitiveness , we allowed each species to uptake all possible carbon sources  with the same uptake kinetics. therefore, the results reflected differences in carbon metabolism efficiency and not differences in uptake properties. the model predicted that cross feeding would not increase wmax but would further enhance s. aureus competitiveness by reducing the region where p. aeruginosa was present. this prediction, which was consistent across all cross feeding scenarios investigated, was attributed to s. aureus having more efficient oxidative metabolism for the primary byproduct lactate. byproduct cross feeding in p. aeruginosa/s. aureus chronic wound biofilms has not been experimentally studied to our knowledge and represents a promising area of research.

cross feeding predictions were obtained assuming identical parameters for lactate uptake kinetics and non-growth associated atp maintenance for the two species. experimental studies with p. aeruginosa biofilms in the cystic fibrosis lung show that lactate actually can be a preferred carbon source to glucose  <cit> , suggesting enhanced lactate uptake capabilities. this environmental dependence emphasizes the importance of conducting uptake experiments and studying cross feeding under chronic wound relevant conditions. well controlled planktonic growth experiments are needed to accurately estimate atp maintenance demands of the two species, since lactate oxidation might confer a growth advantage to p. aeruginosa if the energetics are more favorable than those modeled.

p. aeruginosa secretes a wide variety of inhibitory compounds that have been shown to enhance its competitiveness against competing bacteria in multispecies biofilm communities . to quantify the impact of a representative small molecule inhibitor, p. aeruginosa was forced to secrete pyocyanin and s. aureus was lysed by pyocyanin diffusing from high concentration regions. when combined with nutrient competition, the pyocyanin-mediated lysis mechanism produced a slightly larger wmax = 90 μm and substantially increased p. aeruginosa competitiveness by inducing s. aureus death in the aerobic region. while we tuned our model to obtain reasonable extracellular pyocyanin concentrations  <cit> , key parameters  associated with the mechanism are unknown and need to be experimentally determined to accurately quantify the effect in chronic wound environments.

the motility of p. aeruginosa allows coordinated movement of cells towards higher oxygen levels through a chemotactic response known as aerotaxis  <cit> . when putative p. aeruginosa aerotaxis was combined with nutrient competition , our biofilm model predicted substantially thicker biofilms  and nearly complete species partitioning as observed experimentally  <cit> , with p. aeruginosa dominant in the upper aerobic half and only s. aureus present in the lower anaerobic region. while not producing as dramatic increase in the p. aeruginosa/s. aureus ratio as the pyocyanin mechanism, aerotaxis did not negatively impact total biomass within the biofilm. therefore, we interpreted aerotaxis as a less antagonistic mechanism than pyocyanin secretion by which p. aeruginosa could enhance its own competitiveness. however, p. aeruginosa aerotaxis within biofilm environments has not been demonstrated to our knowledge. therefore, biofilm reactor experiments aimed at demonstrating and quantifying the aerotactic response would be highly beneficial. experimental testing could be achieved through a combination of traditional and spatially resolved omics technologies  <cit> .

CONCLUSIONS
chronic wounds are often colonized by bacteria consortia growing as biofilms on a complex mixture of wound exudate. improved understanding of these complex multispecies systems is required to develop more rational and effective antibiotic therapies for biofilm eradication. we developed genome-scale spatiotemporal models of a two species consortium comprised of the chronic wound isolates pseudomonas aeruginosa and staphylococcus aureus to investigate the impact of putative species interaction mechanisms on biofilm physiology. the models were used to analyze the metabolic differences between single species and two species biofilms and to investigate the impact of nutrient competition, byproduct cross feeding, p. aeruginosa inhibition of s. aureus growth and p. aeruginosa aerotaxis on the relative abundance and spatial distribution of each species. the key predictions of our computational modeling study were:the two species system was predicted to support a maximum biofilm thickness much greater than p. aeruginosa alone but slightly less than s. aureus alone, suggesting an antagonistic metabolic effect of p. aeruginosa on s. aureus.

nutrient gradients imposed by supplying glucose at the bottom and oxygen at the top of the biofilm induced spatial partitioning of the two species, with s. aureus most concentrated in the lower anaerobic region and p. aeruginosa present only in the upper aerobic region.

when each species was allowed to enhance its growth through consumption of secreted metabolic byproducts assuming identical uptake kinetics, the competitiveness of s. aureus was further enhanced due to its more efficient lactate oxidative metabolism.

lysis of s. aureus by the small molecule inhibitor pyocyanin secreted from p. aeruginosa and/or p. aeruginosa aerotaxis towards high oxygen levels were predicted to enhance spatial portioning of the two species and to increase p. aeruginosa competitiveness in the aerobic region.



these model predictions require further validation through the execution of targeted experiments that augment existing results in the literature that support our conclusions. we believe that p. aeruginosa lysis of s. aureus combined with nutrient competition is a particularly relevant scenario for which model predictions could be tested experimentally.

additional files
additional file 1: figure s <dig>  spatially resolved byproduct  concentration predictions after 1000 h for a two species biofilm of thickness w = 80 μm with three different values  of the metabolite mass transfer coefficient. 

additional file 2: figure s <dig>  spatially resolved predictions after 1000 h for a two species biofilm of thickness w = 80 μm when oxygen was supplied from both ends of the biofilm. oxygen was supplied at the tissue-biofilm interface at a blood plasma concentration of  <dig>  mmol/l. oxygen was supplied at the biofilm-air interface at a concentration of  <dig>  mmol/l for an aqueous solution in equilibrium with atmospheric oxygen. the effect of oxygen from the blood plasma on biofilm species organization is studied. the species partitioning is obeserved between w = 18–32 μm and two species coexist in rest of the biofilm. 



abbreviations
dfbalabdynamic flux balance analysis laboratory

fbaflux balance analysis

lplinear program

odeordinary differential equation

pdepartial differential equation

