BACKGROUND
taxonomic assignments are crucial for effective communication of biological research, enabling comparability between studies. yet, the ability to categorize biodiversity effectively and accurately is hampered by a lack of taxonomic experts  <cit> . dna barcoding has been proposed as a method capable of partially alleviating this "taxonomic impediment" by enabling accurate species identifications by non-specialists using nucleotide comparisons across a standard gene region  <cit> .

in a typical scenario, a specimen of unknown species affinity is encountered, the dna barcode of the query is sequenced and then compared with a reference library of dna barcodes  <cit>  to establish a species match for the query. however, just as morphological identification keys cannot provide accurate binomial names for queries from species not included in the key, dna barcoding cannot assign a species identification when there are no barcode records for conspecifics in the reference library. consequently, barcoding appraisal studies usually require a priori knowledge that the species of the query is present in the reference library . in real life, a consequence of widespread routine use of dna barcoding is that failed species matches  are frequently encountered . in such situations it may be tempting to attempt assignment to a higher taxonomic level . for example, armstrong and ball  <cit>  suggested their query barcode sharing  <dig> % similarity with the closest library match  was a likely congener but not conspecific of the reference library barcode. there is considerable disagreement over the likely accuracy and appropriateness of such assignment attempts , which is not surprising given the different purposes and criteria employed.

dna barcoding assignment to higher taxa
hebert et al.  <cit>  expressed optimism for barcode-based assignments to higher taxa in animals. such assignments are useful as shorthand for phylogenetic hypotheses from which biological characteristics of organisms can be predicted. for example, by assigning a specimen to the genus aellopos one can predict that as a caterpillar it most likely fed on plants of the family rubiaceae  <cit> . the capacity to make predictions based on taxon membership is especially pertinent where fundamental impediments, e.g. an egg or an incomplete specimen, preclude morphology-based detection of characteristics. while assignment to pre-determined taxa is an operation distinct from the description of taxa, assignment accuracy is related to the ability of the character system used as the basis of assignment to track organismal phylogeny . this operation is confounded by the fact that many currently recognized supraspecific taxa are not natural  <cit> . in such cases, the failure of a character system to provide accurate assignments can reflect "imperfect" taxonomy rather than the lack of phylogenetic signal.

in this study, we test the ability of dna barcodes to enable accurate higher taxon assignments. specifically we ask: if species coverage in the dna barcode library is incomplete, can the barcode from a sphingid species not represented in the library be assigned to the genus it belongs to, or, recognised as being from a sphingid genus missing from the library? likewise, can the barcode from a sphingid genus not represented in the library be accurately assigned at the tribe and subfamily level? we address these questions using the moth family sphingidae because a comprehensive global reference barcode library is available  containing relatively stable and well-studied taxa . this enables us to assemble sub-libraries with a wide range of different species completeness and also provides a robust taxonomic framework against which to judge assignment accuracy. we evaluated assignment accuracy using concordance with the current classification of sphingidae  <cit>  while recognising that morphologically derived taxonomy represents falsifiable hypotheses. consequently, we also examined the assignments a posteriori in light of a more recent phylogenetic study of the family  <cit> . sphingidae is the target of a global barcoding campaign  <cit>  and shows high success for species-level barcode identifications .

assignment criteria
since hebert et al.  <cit>  proposed that dna barcoding could be used to assign queries to higher taxa, researchers have performed higher taxa assignments using ad hoc criteria based on the frequency of best hits, degree of sequence similarity, bootstrapping or blast scores . however, these studies usually involved fragmentary tissues of unknown taxonomic origin and consequently assignments could not be independently confirmed . therefore, both the accuracy and optimal approach for such assignments remain unclear. in this study, we test the extent to which assignment accuracy depends on assignment criteria applied by comparing the performance of several approaches employed in prior studies.

tree-based assignment criteria
while some consider the use of tree-based assignment approaches controversial  <cit> , we consider it justified for supraspecific taxa sharing phylogenetic as opposed to tokogenetic affinities. using tree-based criteria, queries are successfully assigned when they cluster with barcodes from their correct taxon  <cit> . meier et al.  <cit>  use the following example where they imagine a reference library containing a chimp barcode but no human barcode to illustrate the difficulty with such an approach: "imagine a query clustering with a chimp barcode. based on the query's position, one cannot decide whether it comes from homo sapiens or another chimp, i.e., forming a cluster on a tree is logically insufficient for assigning a sequence." we address this concern by establishing objective rule sets for our tree-based assignment criteria based on topology . we include assignment criteria that require a taxon to be "monophyletic" or "exclusive" for a query to be assigned to that taxon . this requires that we overlook the fact that trees based on coi do not perfectly track organismal phylogeny at deeper levels  <cit>  and that many "traditional" taxa are not monophyletic  <cit> . ekrem et al.  <cit>  suggest the inability of coi analysis to reconstruct monophyletic taxa prohibits the use of barcodes for higher taxon assignments.

a the first four criteria are tree-based criteria, the last two are non-tree-based criteria.

b when the requirements for a positive assignment were not met, then q was unassignable .

c the examples given refer to genus assignments but were extended to tribe and subfamily using the exact same requirements.

previous barcoding studies employed neighbor-joining  algorithms  <cit>  to produce "taxon id trees" since the goal of dna barcoding is species assignment and species discovery and not phylogenetic reconstruction  <cit> . in this study we used nj as an approximation to phylogenetic analysis due to computational constraints and the large number of replications undertaken. nj provides additional comparability as both bold  <cit>  and genbank  <cit>  use nj in their tree-based identification options. our tree-based assignment criteria are equally applicable regardless of tree construction method although use of trees selected with a different optimality criterion may produce different results.

direct sequence comparison assignment criteria
in addition to tree-based assignment we used criteria based on direct sequence comparison. we chose not to consider "character-based" approaches  because nucleotide synapomorphies are unlikely to be pure  and compound diagnostics have proven unwieldy  <cit> . of the two assignment criteria we use, both based on k2p  <cit>  genetic distance , the least stringent is "best match". a query is assigned the taxon of the reference barcode that it most closely matches irrespective of how similar the query and library barcodes are. under this criterion some false assignments are inevitable. a "false-positive" result, where a query barcode is matched to a reference barcode despite significant divergence, is a frequent consequence of using the blast algorithm by itself  <cit> . for example, the query dataset used here contained five monobasic genera. for these barcodes the only possible result for a genus assignment using "best match" are "false-positive". these errors can be avoided by using the modified assignment criterion, "best close match". with "best close match" the best-matching reference barcode is identified, but the query is only assigned the taxon name of that barcode if the barcode is sufficiently similar . otherwise, the query remains unassigned . in our case, the threshold value can be selected by plotting the number of "true-positives" and "false-positives" against the k2p distance from the query to the "best match". we then determine a threshold that maximizes the number of "true-positives" while minimizing the number of "false-positives". it remains unclear why one would expect that there should be a common threshold across taxonomic groups of the same rank or how this could be implemented in a real-life scenario. many studies have shown a universal threshold of genetic distance to distinguish taxa cannot be determined  <cit> . however, in the absence of better strategies, this method at least provides a rigorously derived threshold value  <cit> .

library species completeness
based on their study of species in one family of diptera, ekrem et al.  <cit>  concluded that assigning a barcode record to the correct genus or species-group was unlikely unless a "near perfect" match is present in the reference library with the further prediction that a "comprehensive" library is also essential for accurate assignment to family or even order. furthermore, ball and armstrong  <cit>  suggested that the failure of a lymantriine barcode to group with other members of its subfamily was attributable to low taxon sampling in their reference library . considering that growth of the dna barcode library will take time, a key issue concerns the effect of completeness of the reference library on the accuracy of higher taxon assignments. by using a global and comprehensive barcode reference library of considerable phylogenetic breadth , the sphingidae, we addressed this uncertainty through simulating different levels of species completeness of the reference library and examining the effect on assignment accuracy.

methods
query dataset, 100% reference library and sub-libraries
using barcode records assembled as part of the global barcoding campaign on sphingidae  <cit> , we selected one barcode from each species to act as a reference barcode for that taxon. reference barcodes were available for  <dig> of the  <dig> described species listed in kitching and cadiou  <cit>  and for an additional seven costa rican species described or revalidated since  <dig> . barcode sequences were selected to maximize length and quality and ranged from 267- <dig> bp, with 77% being  <dig> bp and 93% >  <dig> bp. the sample comprised  <dig> genera with all the currently recognised tribes and subfamilies  represented. three saturniid barcodes  were also included as this family represents the putative sister family to the sphingidae  <cit>  taking the full reference library to  <dig> barcodes .

barcodes from  <dig> sphingid species collected in area de conservacion guanacaste, northwestern costa rica, were used as query barcodes . dna was extracted following automated protocols  <cit>  and the dna barcode amplified and sequenced  <cit> . these costa rican sphingids comprised a well-documented  <cit> , diverse subset of the family, with each of the tribes and subfamilies represented among  <dig> genera. all the queries were correctly assigned to species when using the full reference library and a "best match" assignment criterion.

for the purposes of this study the following were considered libraries of 100% completeness: for genus assignment attempts, the representative from the same species as that of the query was the only barcode removed from the reference library; for tribe and subfamily assignment attempts, the barcodes from all the representatives of species in the genus of the query were removed from the reference library. all contribal genera were not removed in the case of subfamily tests, due to the increased level of uncertainty regarding naturalness of these taxa.

we subsequently created sub-libraries from the full reference library with different levels of species completeness. in an approach termed here "random sampling" barcodes were chosen at random to construct sub-libraries comprising  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and 90% of the full reference library. sub-sampling at each species richness level was repeated  <dig> times. a different approach termed here "constrained sampling" limited the random selection of species to ensure a minimum of one species per genus in the sub-library. this approach was reiterated to construct sub-libraries comprising  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and 90% of the full reference library and was repeated  <dig> times at each species completeness level. for the sub-libraries as with the 100% library, for genus assignment attempts, we removed the reference barcode for the species of the query from the sub-libraries. for tribe and subfamily assignment attempts we removed the reference barcodes for the genus of the query.

query assignment criteria
in each assignment attempt we allowed two possible outcomes:  a "positive" assignment  or  an "ambiguous" assignment . a "positive" assignment was either true  - it matched with the morphology-based identification, or false  - it disagreed with the morphology-based identification  <cit> . an "ambiguous" assignment was either true  - the true taxon based on morphology was not represented in the reference library/sub-library ), or false  - the true taxon based on morphology was represented in the reference library/sub-library )  <cit> .

the requirements for a "positive" assignment depend on the different criteria employed as detailed in table  <dig>  note, the number of "potential tp" will not always be equal to  <dig>  because the taxon of the query may not be present in the sub-library. for example, the number of "potential tp" at the genus level with the 100% library and the "liberal" criterion is  <dig>  due to  <dig> queries being members of monobasic genera.

we developed software in c++ to automatically construct sub-libraries, perform assignments according to four tree-based criteria and evaluate assignment success. the main tool took as input the queries, the outgroups, the complete reference library , the sampling strategy, and an integer  indicating the percentage of the reference library to sampled. the software automated the analytical process as follows:

for each query:

for each replication:

remove query species  from reference library.

randomly select × percent of reference library without replacement according to input sampling strategy.

combine query, outgroups, sampled reference library into a single file.

construct nj tree from file using clustal w v. <dig>  <cit> .

for each of four criteria:

read tree, assign query a taxon or not according to criterion.

evaluate accuracy of assignment .

the four tree-based methods were "liberal"   <cit> , "strict"   <cit> , "liberal & exclusive" and "strict & exclusive". we also performed "best match" for all taxon assignments and "best match" and "best close match" for assignment to genus  where assignment was based only on the most similar reference library barcode . for "best match" only a "positive" assignment is possible  . for "best close match" the query was assigned to the taxon of the most similar library barcode based on k2p distance, provided it was within a certain threshold. if there were no barcodes in the library within the threshold, the assignment was "ambiguous". in order to select a threshold we looked at the results of the "best match" criterion and plotted the number of "true-positives" and "false-positives" against the k2p distance from the query to the "best match". the distance that maximized the number of tp  was selected as the threshold.

measures of accuracy were calculated as follows:  <dig>  precision, the fraction of barcodes placed in a taxon that belongs there, tp/; and  <dig>  overall accuracy, the proportion of barcodes placed without any error, /  <cit> . note, for 'best match" due to the absence of the "ambiguous" category overall accuracy equals precision. the results are discussed below in terms of these measures.

RESULTS
the results of all the experiments are provided in additional file 3: results of all experiments.

correct assignments to genus, tribe and subfamily 
the overall accuracy of assignment to genus was  <dig>  using the "liberal" and  <dig>  using the "strict" criterion. the precision of assignment to genus was  <dig>  using the "liberal" and  <dig>  using the "strict" criterion. a number of query species were consistently assigned to the wrong genus across all analyses resulting in fp. even though these fp were technically incorrect assignments table  <dig> details how in many cases the assignments made some sense considering the taxonomic structure and phylogeny of the family. these included four species in monobasic genera: pachylioides resumens, phryxus caicus, pseudosphinx tetrio, and neococytius cluentius, for which the only possible outcomes were fp or ta, since a query belonging to a monobasic genera cannot be a tp. a second group of fp were query barcodes  assigned to monobasic genera in the reference library . queries belonged to species not present in the reference library, monobasic genera have only a single species that was present in the library, therefore, this group could more correctly be interpreted as ta or fa assignments. two fp, xylophanes godmani and xylophanes turbata, were queries from an exceptionally species-rich genus . the overall accuracy of assignment to genus in this study was similar to that reported by elias et al.  <cit>  who found 69-81% of their ithomiinae queries were assigned to the correct genus using tree-based criteria.

species and genus names are followed by a number in brackets which gives the number of species in the genus in the 100% reference library, e.g. neococytius cluentius  is the sole member of neococytius in the 100% reference library.

overall accuracy of assignment to tribe was  <dig>  using the "liberal" and  <dig>  using the "strict" criterion . precision of assignment to tribe was  <dig>  using the "liberal" and  <dig>  using the "strict" criterion. many of the query barcodes placed in the wrong tribe belonged to genera that are positioned as paraphyletic or polyphyletic with respect to their current tribal designations, according to recent phylogenetic study , or were on long branches in a basal position  within their tribe. an instructive example is eumorpha, a genus currently placed in the tribe philampelini. query barcodes belonging to eumorpha were assigned to tribe macroglossini. this is consistent with the placement of eumorpha  as sister to a clade comprised of macroglossini on the phylogeny of kawahara et al.  <cit> .

overall accuracy of assignment to subfamily was  <dig>  using the "liberal" and  <dig>  using the "strict" criterion with "best match" having the highest overall accuracy for this taxonomic level  . precision of assignment to subfamily was  <dig>  using the "liberal" and  <dig>  using the "strict" criterion.

success of tree-based assignment criteria
considering figures  <dig> and  <dig>  it is clear that different criteria produced contrasting results. for example, "liberal" was frequently the highest scoring criteria in terms of overall accuracy , but performed less well in terms of precision with an average of 18% of assignments to genus being fp . "strict" had lower overall accuracy across all sub-libraries, but higher precision with an average of only 2% of assignments to genus being fp .

the criteria requiring exclusivity resulted in an overwhelming number of fa assignments  and produced very low overall accuracy and precision despite their lower incidence of fp . note that the success rate for criteria without the exclusivity requirement are higher, because they did not require "monophyly"; i.e. queries can be assigned on trees with congeneric  barcodes found in two different "clades" as long as the rules of the criterion are met.

success of sequence comparison assignment criteria
success under "best match" was similar to "strict" at the tribe level but very similar to "liberal" at the subfamily level , where it actually had the highest overall accuracy but was still behind the "strict" criteria in terms of precision .

in order to be able to use "best close match", we first determined the optimal threshold to be  <dig>  k2p distance  and this value was used to decide whether a query had a close enough barcode match be given a "positive" assignment. "best close match" successfully reduced the high number of fp seen with "best match" , but, like the "strict" criterion resulted in a large number of fa. success under "best close match" was very similar to "strict" but it produced a much lower number of tp with the larger sub-libraries .

effect of library completeness
the "liberal" and "strict" criteria were generally the highest-scoring criteria in terms of overall accuracy and precision across all taxonomic levels and all sub-libraries . an exception was the high precision observed for the "strict & exclusive" criterion that was matched by extremely low overall accuracy . precision was consistently high for the "strict" criterion  for all sub-libraries and for assignments to all taxonomic levels. precision was lower using "liberal" but conversely overall accuracy was higher .

the effect of library completeness was visible in assignment to genus using "liberal" with overall accuracy increasing from  <dig>  with the 10% sub-library to  <dig>  with the 100% library . using "strict" however, overall accuracy although generally lower was relatively stable regardless of library completeness, increasing only  <dig>  between the 10% and 100% libraries. the opposite pattern was seen in overall accuracy of assignments to tribe and subfamily with "liberal" being more stable across sub-libraries, and "strict" being more variable .

results for assignment to genus using random versus constrained sampling of sub-libraries were very close in terms of overall accuracy, with constrained having slightly lower overall accuracy across all completeness levels . conversely, constrained sub-libraries resulted in assignments with slightly higher precision across all completeness levels.

discussion
we present the results from an in-depth study of higher taxon assignment using dna barcoding. the reader of dna barcode literature may be surprised by the assignment accuracy reported here, values that may contrast with the expectation of authors like ekrem et al.  <cit> . this may be explained largely by differences in study design. our experimental design measures the relative precision and overall accuracy of different assignment criteria across reference libraries of different levels of completeness and structure. no single assignment criterion was superior across the range of taxonomic scenarios examined and there was often a conflict between overall accuracy and precision. our results discussed below, together with implications for criterion selection, indicate a clear requirement for species to be in taxa that are well-differentiated clades to maximize the number of correct assignments. whether these success rates are high enough to be useful remains a judgment call for the end-user.

assessing barcoding accuracy with taxonomic classifications
in this study we have presented simplified examples where the species of the query barcode is missing from reference libraries  to ensure we were solely addressing the question of assigning the query to the next least inclusive taxon. by excluding the possibility of a species  match, which would effectively provide the higher taxonomy of the query, this study was a rigorous test of the effect of assignment criteria and species completeness of the reference library on higher taxon assignments. the arbiter of success was necessarily a classification  <cit>  that is already considered "out of date"  <cit> . as such, a pertinent issue to dna barcoding success is taxonomy/species tree incongruence as well as species tree/gene tree incongruence  <cit> . this is especially the case for the large species-rich genera e.g. xylophanes, manduca, where generic boundaries may need to be revisited  <cit>  . the effect of using an "old" classification was perhaps particularly apparent when considering the results of the tribe experiments, although adoption of a new classification did not appear to improve assignment accuracy . fp at the tribe and subfamily level often reflected new knowledge of sphingidae phylogeny  <cit> , and therefore reflect real phylogenetic signal among barcode sequences.

the sphingidae has received a relatively extensive treatment by taxonomists. this raises a concern for other less-well-studied groups; how accurately can barcoding be expected to assign queries to taxa that are most likely not natural  <cit> ? while this study provided few examples where the barcode assignment was clearly at odds with current taxonomic understanding, it would be much more difficult to assess in other moth families. despite most systematists adhering to cladistics since hennig  <cit> , many "good" lepidoptera taxa, including those within sphingidae  <cit> , lack reliable  morphological synapomorphies which would enable rapid assignment of species to higher taxa. it is difficult to assess how our results would compare with morphological assignment accuracy by a non-specialist. however, it is clear that even a specialist taxonomist would have difficulty in assigning an egg to a genus, while dna barcoding can be used with any tissue sample from any life stage. there are groups of species e.g. from microlepidoptera, pyralidae, that are far more difficult to assign morphologically to taxa and lack of morphological synapomorphies may reflect the instability of the current classification. the results presented here echo the relative stability of subfamilial and generic taxa compared to the tribes  <cit>  suggesting the real challenge in taxonomy is to build new, robust phylogenies, and ensure that these are reflected in the classification.

another challenge highlighted by our study is the lack of equivalency of taxonomic ranks  <cit>  in terms of genetic distance  <cit> . this is clear through our inability to increase success of sequence comparison criteria through the use of "best close match". an optimal threshold will always be taxon specific and even within a relatively small group a universal threshold is unlikely to be effective. avise and john  <cit>  proposed a temporal scheme to standardize taxonomic ranks. however, an obvious objection is that the scheme would require significant revisions of all groups. instead of speeding up taxonomic work, to be effective, large-scale employment of a distance-based assignment criterion would have to start with the redefinition of most taxa. like kelly et al.  <cit> , we furthermore found that tree-based criteria outperform the direct sequence comparison methods, thereby rendering threshold values for "taxon-level" divergences unnecessary.

effect of library structure and completeness
when the query's taxon was not in the reference library, only "strict" was relatively immune to fp, and consequently was the best scoring criterion in terms of precision. given this ability to limit fp, "strict" was also the criterion for which overall accuracy was least affected by reference library completeness.

it seems intuitive that "best match" would perform better in libraries where taxon matches are always available. however, in real-life, it is impossible to know whether a query is from a "new" taxon or from a taxon that is already represented in the reference library. considering the problems with direct sequence comparison methods, relying solely on distances, we do not believe they are promising tools although arguably these are the most practical. interestingly, "best match" had highest overall accuracy, beating tree-based criteria at the highest taxonomic level investigated in this study - subfamily.

we tested criteria that allow for "ambiguous" assignments and found library completeness had a weak effect and high overall accuracy and precision was seen at low completeness. our comparison of constrained and randomly selected reference sub-libraries showed that accuracy is not compromised by the absence of taxa in the reference library. we found that whether the library was incomplete or all species were present in the library, the criteria selected to provide an assignment was still a factor determining success.

strategies for higher taxonomic level assignment
techniques for assigning sequences to a higher taxon are still in their infancy, but new methods are appearing more frequently . based on our results, we suggest a conservative approach that initially uses a "strict" tree-based criterion in large-scale assignment systems. although a large number of queries would remain ambiguous due to the more conservative nature of the criterion, we nevertheless consider this result with its higher precision to be preferable to an assignment criterion like "best match", which yields marginally more tp but also a large number of fp. criteria requiring exclusivity were the most conservative, but given their very low overall accuracy and precision they would probably only be justifiable for forensic purposes  <cit> .

tree-based criteria could be easily incorporated into the current library set-up , by providing higher taxonomy alongside the species name attached to barcodes on a taxon-id tree. the current approach offered by bold uses a similarity search to collect the top  <dig> hits in the reference library and then constructs a nj tree to allow the attachment of a query barcode to this  <dig> best backbone tree  <cit> . from this tree an attempt can be made to assign the query to genus using "strict". however, if no "positive" genus assignment can be made, an attempt could be made at assignment to tribe, etc. alternatively, an assignment can be attempted to a taxonomic level determined by the taxonomic sufficiency requirements of the investigators. for example, water monitoring using invertebrate diversity indices may only require samples be identified to family to be useful. some could argue that heuristic taxonomic groupings  based on barcodes are better than no taxonomic hypothesis at all, and certainly superior to heuristic morphology-based equivalents, being rooted in a standardised, objective, consistently coded character set.

CONCLUSIONS
our empirical test of higher taxonomic assignments reveals that a tree-based assignment system would successfully assign most queries to a higher taxon at some level. a conservative approach using the "strict" tree-based method should be used initially in large-scale identification systems. the failures we observed do not make us question the usefulness of barcode libraries for generic and suprageneric assignments. they indicate imperfect taxonomy and suggest that the barcodes themselves could aid our ability to revise non-natural taxa. an advantage of any dna-based system is that the data are readily available for further analysis with alternative models or approaches. discounting dna barcoding as a tool for providing taxonomic assignments because the library is not yet complete is pusillanimous.

authors' contributions
jjw, rr, js, pdnh conceived of the project and designed experiments. jjw, dhj, wh, mh assembled the query dataset. rr, ijk, jh assembled the sphingid reference library and made it available for this study. jjw, rr, js performed the experiments and analyzed the data. jjw, rr, js drafted the manuscript. dhj, wh, mh, ijk, pdnh assisted in writing the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
full reference library. excel worksheet containing a list of coi sequences used in the full reference library in this study, including the species name attached to the barcode and bold  sample ids and process ids.

click here for file

 additional file 2
query dataset. excel worksheet containing a list of coi sequences used as the query dataset in this study, including the species name attached to the barcode and bold  sample ids and process ids.

click here for file

 additional file 3
results of all experiments. excel worksheet containing the summarized results of all the experiments performed.

click here for file

 acknowledgements
this study was funded by grants from nserc and genome canada through the ontario genomics institute to pdnh. acquisition of the  <dig> species of query sphingids was supported by usa nsf grants deb  <dig> and  <dig> to dhj and the staff of acg. the sphingid reference library includes contributions by sam adams, philippe annoyer, patrick basquin, robert beck, alex borisenko, ron brechlin, philippe darge, ulf eitschberger, yves estradel, axel hausmann, john janovec, jean-françois landry, tomas melichar, scott j. miller, joël minet, kim mitter, jacques pierre, chris schmidt, james tuttle, thierry vaglia, evgeny zakharov; many taxa were only accessible within the collections of the following institutions: the australian national insect collection , the smithsonian institution , the muséum national d'histoire naturelle , the canadian national collections of insects and arachnids , the bavarian state collection of zoology . jjw would like to thank the staff and visitors to bio and the hanner lab for helpful discussions and encouragement over the course of this study. massimiliano virgilio and an anonymous reviewer significantly improved the manuscript through their comments.
