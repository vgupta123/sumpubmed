BACKGROUND
chromatin immunoprecipitation combined with next generation sequencing technology  has been swiftly adopted as a standard technique for studying genome wide protein-dna interaction patterns during the past four years. it is applied in gene regulation studies for identifying transcription factor targets and binding motifs, as well as in epigenetics research towards the characterization of chromatin states using various histone marks and rna polymerase ii   <cit> .

polii plays an essential role in gene transcription. during transcription, it is responsible for the synthesis of nascent messenger rna molecules  for protein-coding genes and micrornas  <cit> . the nascent mrnas then go through a series of processing steps including splicing to form mature mrnas. to transcribe a gene, polii will undergose several steps including recruitment, initiation, elongation, and dissociation  <cit> . in addition, polii pausing and pre-mature dissociation will cause stalling of the transcription process  <cit> . thus, accurately characterization of polii binding patterns over the entire genome is of great importance in studying the dynamics of transcription as well as contributing to the characterization of nascent mrna, which cannot be directly inferred from gene expression microarray or regular rna-seq technologies since they focus on mature mrna. however, since during transcription polii elongates along the entire gene, the polii binding pattern over a gene is usually not just a single peak but forms elongated regions as manifest in chip-seq data. polii enriched regions can stretch to several thousands of basepairs . traditionally, chip-seq data analysis methods rely on peak region detection algorithm to delineate genomic regions with enriched protein bindings. however, the binding pattern of polii poses a very different paradigm of computing and in turn significant challenges. several peak detection algorithms were developed for delineating transcription factor binding sites and the anticipated regions are short   <cit>  thus rendering such algorithms inadequate for studying proteins with prevalent binding over the entire genome such as polii.

while chip-seq data can be considered a 1-d signal over the entire genome, only a few studies explicitly take advantage of signal denoising and detection methods developed in the engineering community. for instance, in  <cit> , wavelet denoising technique was applied to filter the chip-seq data to identify nucleosome distribution patterns. for histone marks, a method called sissr was recently developed  <cit> , which takes a multiscale approach to analyze chip-seq data. this approach first identifies potential regions with enriched histone patterns and then links proximal regions which are separated by short intervals as a contiguous large region. the short intervals can be considered "noise" in the genome-wide signal that can be filtered out at coarser scales.

in this paper, we also consider a chip-seq dataset a noisy 1-d signal stretched over the genome and apply signal processing techniques combined with statistical analysis for identifying large enriched regions in chip-seq data. our approach includes three main steps. first we directly apply a signal denoising algorithm to process histogram of chip-seq data. noise in chip-seq data originates from multiple sources including non-specific binding to the antibody, artifacts in amplification , and sequencing reads mapping errors. these confounding noises are usually modeled as spike noise with an underlying poisson distribution. recently it has been shown that the non-local means  algorithm is highly effective in signal denoising compared to other commonly used algorithms such as median filter, low-pass filtering and wavelet denoising  <cit> . it should be noted that our proposed method is based on the nl-means denoising algorithm. since the nl-means algorithm is optimal for gaussian noise, we apply the anscombe transformation to the binned chip-seq  <cit> . consequently, the underlying noise distribution model is now approximated by a gaussian distribution. subsequently, we apply the nl-means algorithm followed by inverse anscombe transform. the denoised data is then compared against random model to determine the threshold for region selection based on a false discovery rate  approach. finally, regions are selected based on the threshold, the region length, and the ratio between the peak value and the threshold.

to evaluate our method, we first test our method using a public polii chip-seq dataset and compare the results with published results obtained using the published algorithm hpeak  <cit> . then, we apply our proposed method on polii chip-seq data generated in our own study on the effects of hormone on breast cancer cell line mcf <dig>  we compare the long segments obtained when tested against both mcf <dig> cell line and the mcf <dig> cells treated with 17-estradial  hormone. the results demonstrate that our method can effectively identify both long enriched regions in chip-seq datasets and complement existing peak finding algorithms for a variety of potential wide applications such as histone mark binding pattern study.

methods
data selection and pre-processing
to test our method, we first downloaded a chip-seq dataset for polii on a prostate cancer cell line  after treatment with an androgen receptor agonist r <dig>  from ncbi gene expression omnibus . the dataset was generated using illumina genome analyzer ii  sequencer and was analyzed using the hpeak algorithm  <cit> . in addition, we apply our algorithm in polii chip-seq data generated in our research on breast cancer using mcf <dig> cell line. the accession numbers are gsm <dig> , and gsm <dig> ). for all the datasets, we downloaded the sequence mapping results  and then generated histogram with selected bin size.

introduction of nl-means algorithm and parameter selection
the nl-means algorithm was originally developed for image denoising  <cit>  and was also applied to 1-d signals   <cit>  and video  <cit> . the details of the original nl-means algorithm are given in  <cit> . here we briefly describe the essential formulation and the salient parameters. basically, for each data point, its value is replaced by a weighted average of data points over the entire signal such that points with similar neighbourhoods are given higher weights. it has been shown that the nl-means algorithm is optimal for gaussian noise. in addition, using weighted averaging for points with similar neighbourhoods is suitable for chip-seq experiments since the pattern of protein binding are considered similar across many regions of the genome.

formally, given a signal with data points x={xi,i =  <dig> ...,n}, the filtered value at xi is defined as nlxi= ∑j=1nwi,jxj, where is a difference measure between xi and a neighbouring point xj under the constraints w≥ <dig> and ∑j=1nw= <dig> specifically, wi,j=exp)z, where is the normalizing factor, zi= ∑jexp, and nxi denote a fixed-size neighbourhood centred at the position i. in practice, searching for similar neighbourhood patterns over the entire genome is not feasible. instead, a parameter specifying the range of search is needed. in summary, the nl-means algorithm requires three parameters, the size of neighbourhood the range of search and the weight parameter we evaluated a series of parameter combinations  and in this study we use r =  <dig> l =  <dig>  and σ = 10

anscombe transformation
since nl-means algorithm is optimal for gaussian noise while the noise in chip-seq data is usually modelled using poisson distribution, we apply anscombe transform to the data first. anscombe transform is a commonly used variance-stabilizing transformation that transforms a poisson distribution random variable into one with that is close to a gaussian distribution  <cit> . the anscombe transformation on data point is defined as follows: y=2x+3/ <dig> and the inverse anscombe transform is given by x=2-3/ <dig> 

fdr based approach
to select a threshold for region selection, we designed a fdr approach based on b random simulations. given the histogram of the chip-seq data with m bins and the reads over each bin as ri , we take the following steps:

 <dig>  in the b-th round of simulation , we randomly  position the same amount of sequencing reads for each chromosome as in the original data and then apply the nl-means algorithm. the reads over the i-th bin is denoted as rib*.

 <dig>  then for the i-th bin in the histogram, the ratio that the observed data is less than simulated data is recorded as pi= ∑b=1bi. i takes value  <dig>  if a is true .

 <dig>  for the b-th round of simulation, we treat it as a "true" signal and compare it with rest of simulated data. for the i-th bin, we compute pib*= ∑b′=1birib*<rib′*then for a threshold pcut, the number of false peaks in this round of simulation is db= ∑i=1mi

 <dig>  the false discovery rate for the cutoff pcut is fdrpcut=b- <dig> ∑b=1bdb∑i=1mipi≤pcut.

since pcut is a function of the region height, we obtain the fdr for selected threshold on height. then for each detected region based on the fdr approach, we also calculate the ratio between the peak value and the threshold.

RESULTS
comparing with hpeak for detecting polii enriched regions in prostate cancer
we first apply our method to a published polii chip-seq data in prostate cancer model . we compare our results with the published  <dig>  polii enriched region detected using hpeak  <cit> . as shown in table  <dig>  when fdr =  <dig> , our method show a high overlap with published results with overlap ratio  of 80-100%. we then inspected many of regions that were detected using our method but were missed by hpeak. we found many of them correspond to potential transcription starting sites  for unknown genes or non-coding rna genes. figure 3a-b show examples of regions detected using our method using  <dig>  for fdr and  <dig>  for peak-to-threshold ratio but were missed by the hpeak algorithm even though they imply the potential transcription activity for the covered genes. one of them is a snorna gene . figure 3c shows examples of regions that were detected by hpeak but were missed by our method. in fact, using this setting, all regions missed by our method contain narrow peaks . this observation suggests that the regions detected using our method can provide addition information regarding gene transcription and annotation. further detailed annotation on these new regions is currently being carried out by integration with other information including cpg island distribution, dnase i hypersensitivity, and h3k4me <dig> binding .

detecting large regions with polii enrichment in breast cancer cell line mcf7
we then applied our method in the polii chip-seq datasets for the breast cancer cell line mcf <dig> using large bin size . as shown in table  <dig>  pertaining to mcf <dig> control samples we identified  <dig>  segments with length of at least  <dig> k bp ; and in mcf <dig> treated with e <dig> samples, we identified  <dig>  such segments . some examples of the long regions detected in mcf <dig> control samples are shown in figure  <dig> 

discussion
identification of long segments for polii binding are important for further investigation for understanding gene transcription regulation as well as potentially discovery novel transcripts and alternative promoters. for gene transcription, while polii binding density at promoter around the tsss was considered to determine gene transcription levels, recent studies show that the density of polii binding on gene body is also critical  <cit> . we also observed such phenomena using the above identified segments. for instance, as shown in figure  <dig>  a segment of  <dig>  bp has been identified over the transcript of the gene plk <dig> on human chromosome  <dig>  the mcf <dig> control sample has more sequencing reads over this region than the mcf <dig> sample treated with e <dig> sample . although, the height of the "peak" at the tss region in the mcf <dig> control sample is lower than that in the mcf <dig> e <dig> treated sample, the total transcription level  is still higher in mcf <dig> control by a factor of  <dig> -fold .

the above observations suggested that chip-seq technology can reveal potential new insights and principles in biology. the method presented in this paper will contribute to such discovery efforts. nevertheless, this method can be improved in several aspects. first, currently the parameters for nl-means algorithm are fixed. in practice, the user may focus on enriched regions of certain length and this could lead to the change of these parameters. therefore, a multiscale approach is preferred. second, an important utility of chip-seq data analysis is to compare enriched regions between different samples such as chip sample versus its input control or control sample versus drug treated sample. currently we are implementing a fisher's exact test based approach to enable such comparison. last but not the least, this method can be applied not only to polii chip-seq data but can also be used for analyzing other data such as histone mark chip-seq data for integrative genomic analysis. currently we are also expanding our study to integrate chip-seq data for important histone marks including h3k4me <dig> and h3k27me <dig> in an epigenetic study.

CONCLUSIONS
in this paper, we propose an enriched region detection method for chip-seq data to identify long enriched regions by combining a signal denoising algorithm with a fdr approach. our method complements existing peak detection algorithms for chip-seq experiments. we demonstrated the effectiveness of this method by studying the binding patterns of polii in cancer cell lines which enables further deep analysis with applications in transcription regulation and epigenetics.

competing interests
the authors declare that they have no competing interests.

authors' contributions
zh implemented the algorithm and carried out all tests. lt designed the fdr test. tp advised on the implementation of nl-means algorithm. th provided the breast cancer polii data. rm conceived the idea of using nl-means for chip-seq denoising. kh led the project including development of the idea of signal processing approach, design of all experiments, interpretation of the results and writing of the manuscript. all authors edited the manuscript.

