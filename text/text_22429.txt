BACKGROUND
species complexes or aggregates consist of a set of closely related species often of different ploidy levels, whose relationships are difficult to reconstruct. such species complexes are common in angiosperms  <cit> . rapid genetic, phenotypic and ecological differentiation on one hand, and hybridization/polyploidy on the other, play important roles in their evolutionary bursts  <cit> . the temperate n hemisphere common yarrow taxa form such a complex, i.e., the achillea millefolium aggregate. centered in se europe and sw to c asia, its diploid species are limited to eurasia, whereas the polyploids have spread throughout the n hemisphere  <cit> . in n america, the 4x and 6x cytotypes form a complex of ecological races adapted to many different niches with marked genotypic diversification  <cit> . by cultivation in experimental gardens, clausen et al.  <cit>  documented local adaptation of a. millefolium populations to environments along an altitudinal transect in california from sea level to alpine regions. this has become a classic example of rapid adaptive divergence of plant populations  <cit> .

our earlier aflp data have characterized the achillea millefolium complex as a clade  <cit> . the inferred species relationships of the diploid members conformed to a binary bifurcating tree and generally agreed with traditional species delimitations and taxonomic arrangements. the polyploid members appeared to be polytomic and polyphyletic although geographic patterns can be recognized  <cit> . available data show that frequent exchange of genetic materials have been involved in the origins of many polyploidy taxa. meanwhile, it seems also to have occurred during the divergence of the diploid species  <cit> . so far, we are still uncertain about the demographic history of a. millefolium agg. and the progenitors of many polyploid taxa.

due to their dominant nature, aflp markers are difficult to use for inferring genetic parameters of populations, particularly ancestral population sizes, split times, and migration rates. in principle, this can be accomplished better with dna sequences either from organelles or from the nuclear genome  <cit> . yet, we still meet challenges in practice: plastid dna variation is often too low to infer relevant gene trees with confidence. in addition, despite the lower effective population size of plastids, plastid gene trees may still not reflect the species tree due to incomplete lineage sorting. with nuclear genes, frequent birth and death of gene copies, less lineage sorting due to higher effective population size, secondary introgression among split species as well as intragenic recombination tend to hamper interpretation of the patterns of polymorphism  <cit> .

here, we survey dna sequence variation sampled at two nuclear loci and three plastid fragments from populations across diploid, tetraploid, and hexaploid species throughout the natural distribution range of a. millefolium agg. and from three diploid congeneric species outside the aggregate. on the diploid level, we infer the demographic history among species and populations using the newly generated dna sequence data in comparison to the relationships inferred from the previous aflp data. to this end, we also apply a probabilistic model   <cit>  to three widespread diploid species to shed light on the key parameters, i.e., ancestral effective population sizes, time of speciation, and rates of gene flow. for the polyploid populations, we try to untangle their polytomic and polyphyletic relationships which are probably complicated by gene flow on the same and between different ploidy levels using the co-dominant single-gene haplotype data.

methods
plant sampling
we sampled thirty populations of seven diploid, seven tetraploid and four hexaploid taxa or cytotypes of the achillea millefolium aggregate throughout the temperate n hemisphere . on average, two to three individuals from each population were analyzed. broadly the same individuals were sequenced for the two nuclear loci and three cpdna fragments; minor exceptions were due to repeated failures in sequencing a certain locus from a certain individual . three diploid species, taxonomically outside the a. millefolium aggregate but included in previous aflp analyses  <cit> , were also sampled for this study. they are the w-eurasian a. nobilis-2x, the c-mediterranean a. ligustica-2x and the east asian a. acuminata-2x . in addition, sequences of two cpdna regions, trnh-psba and trnc-ycf <dig>  of  <dig> north american populations available from the ncbi data base   <cit>  are incorporated into our plastid haplotype network analysis.

c ploidy level checked by chromosome counting; f ploidy level checked by flowcytometry; i ploidy level inferred from fe's previous studies or from literature.

names of collectors: at = a. tribsch; dk = d. kharazishvili; fe = f. ehrendorfer; gr = g.-y. rao; hg = h. greger; je = j. ehrendorfer; js = j. saukel; kt = k. tremetsberger; le = l. ehrendorfer-schratt; lk = l. klimes; ms = m. staudinger; oa = o. alexandrova; ps = p. schönswetter; yg = y.-p. guo

to check ploidy levels of the populations studied, two methods, either chromosome counting or dna ploidy level determination, were applied using young flower buds or fresh or silica gel-dried leaves, respectively. young flower buds were collected in the field and fixed in carnoy's fluid . to count the chromosome number, fixed flower buds were stained and squashed in 4% acetocarmine and observed under the microscope. dna ploidy levels were investigated with propidium iodide flow cytometry  <cit>  from the prepared leaves. information for ploidy levels obtained with the above two methods are marked in table  <dig> by c and f, respectively, while those inferred from previous studies  are marked by i.

voucher specimens are deposited in the herbaria of the institute of botany  and the department of pharmacognosy , both at the university of vienna, austria, and of the college of life sciences, beijing normal university .

data sampling
total genomic dna was extracted from ca.  <dig>  g silica gel desiccated leaf materials following the  <dig> × ctab protocol  <cit>  with slight modifications: before the normal extraction process, sorbitol washing buffer was used to remove polysaccharides in the leaf materials .

two nuclear genes were sampled and partially sequenced for this study. they are the chloroplast-expressed glutamine synthase gene  and the sedoheptulose-bisphosphatase  gene. the ncpgs gene has been used in many plant phylogenetic studies and shown to be single-copy in all angiosperm species so far studied  <cit>  and especially in achillea  <cit> . we sequenced part of its coding and noncoding regions from exon  <dig> through to exon  <dig>  the sbp gene has been studied in representative taxa of the family asteraceae  <cit> . it was shown to be single-copy by our preliminary analyses in several diploid species of achillea. readers are referred to ma et al.  <cit>  for primers used for amplifying the ncpgs locus and to chapman et al.  <cit>  for the sbp locus .

three noncoding chloroplast dna regions, trnh-psba, trnc-ycf <dig>  and rpl <dig> were sequenced. pcr reactions were conducted with universal primer pairs  <cit> .

the amplification was carried out in a volume of  <dig> μl with final concentration of  <dig> × pcr buffer,  <dig>  u extaq  or hifi ,  <dig> μm of each dntp, 1% dmso,  <dig>  μm of each primer, and with  <dig> μl template dna and ddh2o added to the final volume. the amplification was conducted on a peltier thermocycler  initiated with  <dig> min of pre-denaturing at 94°c followed by  <dig> cycles of  <dig> min at 94°c, 30s at 48-55°c, and  <dig>  min at 72°c. a final extension was then taken at 72°c for  <dig> min followed by a hold at 4°c. the pcr products were electrophoresed on and excised from the  <dig> % agarose gel in tae buffer. they were then purified using a dna purification kit . the purified pcr products were either used for direct sequencing  or ligated into a pgem-t vector  with a promega kit . for sequencing the nuclear genes, about five to eight positive clones from each diploid and ten to fifteen from each polyploid individual were randomly selected for sequencing. the plasmid was extracted with an axyprep kit . cycle sequencing was conducted using abi prism® bigdye™ terminator. the same primers used for amplification  or the vector primers t7/sp <dig>  were applied here. the sequenced products were run on an abi prism™  <dig> dna sequencer .

data analyses
sequences were assembled with the contigexpress program , aligned with clustalx  <dig> , and then manually improved with bioedit version  <dig> . <dig>  to prevent possible sequencing errors, single mutations in the nuclear gene data sets likely generated by the cloning sequencing method were excluded from the analyses. furthermore, unique sequences in the nuclear gene data matrix, which do not fall into any majority-rule consensus sequence group  <cit>  or show inconstant branch positions in trees based on different subsets of data, i.e., with partial characters or randomly selected sequences, during the initial analyses were eliminated to avoid influence of pcr-mediated recombination  <cit> . the final numbers of individuals/clones analyzed at each locus for each population are listed in table  <dig>  all the sequences analyzed were submitted to the ncbi genbank under accession numbers hq601971-hq <dig>  and hq450864-hq <dig> .

the allelic data sets of the two nuclear genes, ncpgs and sbp, were analyzed separately, whereas sequences of three cpdna fragments were combined as one locus.

gaps in the nuclear data sets were treated as missing data, whereas each indel position  of the plastid data set was coded as a binary character  using the program gapcoder  <cit> .

as a. millefolium agg. consists of species with short evolutionary history  <cit> , neighbor joining , maximum parsimony  and median-joining network were applied to the present data. for the nuclear sequences, neighbour joining and parsimony analyses were performed with mega  <dig>  and paup*  <dig> b10a, respectively. all nucleotide substitutions were equally weighted. gaps were treated as missing data. we first analyzed data of the diploid species to show diversification of the gene lineages, and then of all the taxa to investigate relationships among the polyploids and diploids within a. millefolium agg. the nj analysis was conducted with kimura's 2-parameter distances  <cit>  and bootstrapped with  <dig> replicates. for the mp method, heuristic searches were performed using  <dig> random taxon addition replicates with acctran optimization and tbr branch swapping. up to  <dig> trees with scores larger than  <dig> were saved per replicate. the stability of internal nodes of the mp tree was assessed by bootstrapping with  <dig> replicates .

median-joining network analysis implemented in network ver.  <dig> . <dig>  available at http://www.fluxus-engineering.com/sharenet.htm <cit>  was applied to the cpdna data set. all variable sites were equally weighted and the homoplasy level parameter  was set to zero given that variation rates of the closely related species is low, especially in their plastid dna.

to understand the population demography at the time of speciation of the diploid species of a. millefolium agg., we applied a probabilistic model, the isolation with migration model for multiple populations implemented in ima <dig>  <cit> , to three widespread and closely related species a. asplenifolia-2x and a. setacea-2x and a. asiatica-2x. these species are here regarded as three diverged populations which share nuclear sequence variation. shared alleles could reflect ancestral polymorphism or gene flow after separation of the populations or species. assuming neutrality, retention of ancestral polymorphisms is likely if speciation is fast relative to drift, which is inverse in intensity to the effective population size. as a rule of thumb, species are well separated with little ancestral polymorphism and thus almost complete lineage sorting, if the time of separation is at least as long as four times the effective population size  <cit> . secondary genetic exchange between the diverging species can also lead to shared alleles observed  <cit> . the multipopulation model ima <dig> allows both ancestral polymorphism and gene flow subsequent to divergence. it assumes a known history of the sampled populations, which can be represented by a rooted bifurcating tree. in earlier analysis using aflp data  <cit> , we inferred the rooted species tree as: , a. setacea). we note that ima <dig> provides posterior distributions of parameters, such that the confidence in the inference of each parameter can be obtained from observing the spread of the posterior distribution. the im model also assumes neutral genetic variation, freely recombining unlinked loci and no intragenic recombination or gene conversion  <cit> . sequences of the two nuclear loci, the ncpgs and the sbp genes, and of three plastid fragments were used for this analysis. the polymorphic sites of the sequenced nuclear and plastid loci are mostly of introns or intergenic spacers and thus should fit the neutral variation model. using the four-gamete criterion  <cit> , we do not find intragenic recombination in the nuclear sequences among these three species. the data of the three plastid fragments were combined because the chloroplast genes are generally linked and no evidence of recombination between the three regions is found.

to run ima <dig>  one random haplotype per plant individual was chosen for the nuclear gene data sets, and the plastid data set was composed of sequences from the same plant individuals. this avoids bias but decreases the amount of information and thus leads to broader posterior distributions. the is  model  <cit>  of sequence evolution was chosen for the plastid locus, whereas, the hky model  <cit>  which allows for multiple substitutions was selected for the two nuclear loci because double mutations were found for a few polymorphic sites at both loci. the inheritance scalar was set to  <dig>  for the nuclear and to  <dig>  for the plastid loci, respectively.

to set upper bounds on the prior distributions of the parameters, we estimated for each of the three species the geometric means of the population mutation rate 4nu across all three loci using watterson's estimator θ . the largest mean value was found with a. asiatica-2x , and this was used to set the upper bound on uniform prior for each of the three population demographic parameters: population size , splitting time  and migration rates . the priors were finally set as follows: the upper bound of population sizes q =  <dig>  splitting times t =  <dig> and migration rates m =  <dig> , respectively. we ran the markov-chain monte carlo  simulations with  <dig> , <dig> burn-in steps and  <dig>  genealogies sampled per locus. the analysis was done with  <dig> independent runs in the m mode, each using identical priors and  <dig> metropolis-coupled chains with different random number seeds. the genealogies sampled from the m mode runs were combined in an l mode run to build an estimate of the joint posterior probability of the parameters  <cit> .

RESULTS
nuclear gene trees with allelic haplotype sequences
amplification of the partial ncpgs and sbp genes produced a single clear band for each amplification. this and the results from earlier work  suggest sequences of the two nuclear loci obtained here each as belonging to a set of orthologs.

after eliminating some sequences likely containing pcr-recombination ,  <dig> sequences  of the ncpgs and  <dig> of the sbp gene from broadly the same  <dig> individuals of  <dig> populations belonging to a. millefolium agg. were used for the data analyses . in addition,  <dig> ncpgs and  <dig> sbp sequences from five populations of three congeneric species outside the a. millefolium agg., a. nobilis-2x, a. ligustica-2x and a. acuminata-2x, were also analyzed here. the ncpgs alignment contains  <dig> nucleotide positions with sequence length varying from  <dig> to  <dig> bps. the sbp alignment contains  <dig> nucleotide positions with sequence length varying from  <dig> to  <dig> bps.

prior to the analyses of all the diploid and polyploid taxa, we present the gene trees at the diploid level first .

the diploid-only ncpgs data come from seven species within and three outside a. millefolium agg.. they contain  <dig> haplotypes with  <dig> substitution sites from  <dig> sequences . out of the  <dig> polymorphic sites,  <dig> are in introns. intragenic recombination among some samples is likely: a discordance in the alignment can be resolved by postulating a recombination in three of the four ncpgs haplotypes of a. nobilis-2x around the 89th polymorphic site . another discordance can be resolved in the two haplotypes of a. cuspidata-2x  by postulating a recombination around the 26th polymorphic site between haplotype groups of a. millefolium agg. and of a. ligustica-2x .

the diploid-only sbp data also include seven species within and three outside a. millefolium agg. they contain  <dig> haplotypes with  <dig> substitution sites based on  <dig> sequences. out of the  <dig> polymorphic sites,  <dig> belong to the intron regions. the alignment of the sbp sequences does not show obvious intragenic recombination . the topology of the nj tree is broadly comparable with that of the mp tree and thus only bootstrap values from the mp analysis are presented . the sbp gene tree  is remarkably incongruent with the ncpgs tree  and with the aflp tree . in figure  <dig>  haplotypes belonging to members of a. millefolium agg. do not group together. some of a. asiatica-2x, all of the caucasus a. latiloba-2x and the himalayan a. cuspidata-2x  are distantly related to the others of a. millefolium agg. surprisingly, sequences of the c european a. nobilis-2x are close to the asian type, whereas, haplotypes of the e asian a. acuminata-2x are close to the major haplotype group of a. millefolium agg., which is mostly of the european members. we thus observe little sorting of ancestral polymorphisms of the sbp gene during the speciation processes of the diploid species of achillea.

the date set of sbp gene of all the diploids and polyploids contains  <dig> haplotypes generated from  <dig> sequences with  <dig> polymorphic substitution sites. due to the severe conflicts between the sbp gene tree and the species tree inferred from the aflp and morphological data, sequences of this gene are not suitable for the phylogenetic inference, but could provide some clues about the progenitors of the polyploid taxa. we therefore only present the sbp gene tree of all the diploid and polyploid samples in the supplementary materials as additional file 3: s-figure  <dig> 

phylogenetic networks based on plastid haplotypes
thirty populations with broadly the same  <dig> individuals analyzed with the nuclear genes were sequenced at three plastid loci, trnh-psba, trnc-ycb <dig> and rpl <dig>  the length variation and number of polymorphic sites of each fragment are listed in table  <dig> 

* indels were coded as binary characters  using software gapcoder  <cit> 

for the diploid members of a. millefolium agg. together with their sister species a. ligustica, three plastid fragments from  <dig> populations and  <dig> individuals generated a combined matrix with  <dig>  nucleotide positions and  <dig> variable sites. out of the  <dig> variable sites,  <dig> are substitution sites and  <dig> are indels . the polymorphic sites allow the identification of  <dig> plastid haplotypes named as dh1- <dig>  where "d" stands for diploids to be distinguished from those used for the diploid- polyploid combined data as described below. as shown in figure  <dig>  polymorphic plastid haplotypes are found within each of the three relatively widespread species a. setacea-2x, a. asplenifolia-2x and a. asiatica-2x. furthermore, distribution of the plastid polymorphism is not even among the diploid species. among the three widespread species, the european a. setacea and a. asplenifolia each harbours a relatively frequent haplotype, dh <dig> and dh <dig>  respectively, whereas a. asiatica-2x in asia exhibits  <dig> haplotypes.

to illustrate the formation of the polyploids and their worldwide migration, we incorporated the plastid trnh-psba and trnc-ycf <dig> sequences obtained by ramsey et al.  <cit>  from the 4x and 6x n american a. borealis populations available from the ncbi data base  into our diploid-polyploid combined data. our rpl <dig> intron sequences were left out because this gene was not sequenced for the populations analyzed by ramsey et al.  <cit> . the resulting data matrix thus contains  <dig> individuals and  <dig> nucleotide positions . this allows identification of  <dig> haplotypes  on the basis of  <dig> variable characters, of which  <dig> are nucleotide substitutions and  <dig> are indels . relationships among these haplotypes are shown in figure  <dig> 

h <dig> is the most frequent haplotype in eurasia. it is shared by three out of four european diploid species and is spread among most of the eurasian polyploid taxa at all ploidy levels . the rare h <dig> in europe  is related to the eurasian h <dig>  to most of the asian types h 6- <dig> & <dig>  and even to h <dig> which is the most frequent in n america. the european polyploid specific h <dig>  and h <dig>  are directly or indirectly related to h <dig> found in a. asiatica-2x & -4x. the n american frequent h <dig> has been derived most probably from the e asian h <dig> and evidently gave rise within n america to several rare and more local haplotypes .

the  <dig> plastid haplotypes are mapped associated with the general distribution of populations studied here in the additional file 4: s-figure  <dig> 

demography of major diploid lineages
in contrast, all ancestral population sizes are large compared to the current ones: q <dig>  the ancestral effective population size before the split of a. asiatica-2x and a. asplenifolia-2x, and q <dig>  the ancestral population common to all three species are bounded away from zero. the distributions of the migration parameters  are broad and quite similar to the equal prior distributions, such that we conclude that there is little information for inference of these parameters in the data. setting wider maximum priors for m did not result in convergence. we note that differentiation of subdivided populations that exchange few migrants and populations that split and afterwards do not exchange migrants lead to rather similar molecular variation patterns. therefore, differentiating between migration and drift and temporal population subdivision is difficult. this likely explains the broad posterior distribution of the inferred migration parameters.

discussion
within the achillea millefolium aggregate, diploid species are usually well separated and their relationships conform to a binary bifurcating tree according to the aflp data  <cit> . at the polyploid level, species are difficult to define either by morphology or by molecular data. previous aflp data show the polyploid taxa mostly polytomic and polyphyletic  <cit> . with the haplotype sequence data from both nuclear and plastid genomes available here, we try to infer population history and demography of the diploid species and to untangle the complex relationships among the polyploids.

gene trees versus species trees of the diploids
the gene trees from the nuclear and the plastid loci of the diploid populations of a. millefolium agg. are incongruent with each other and with the previous aflp species tree. none of the gene trees corresponds well with the morphological and cytogenetical differentiation of the diploid species, whereas the aflp tree does . for the ncpgs gene, haplotypes of each of the widespread a. asplenifolia-2x and a. asiatica-2x belong to two groups, iia and iib . relevant ncpgs sequences indicate intragenic recombination . the sbp gene tree conflicts more severely with the aflp tree and the species delimitation . even the plastid sequences show polymorphic haplotypes within each of the three widespread species a. setacea-2x, a. asplenifolia-2x and a. asiatica-2x . as the phylogenetic relationships of these three species indicated by the aflp tree  are in line with the morphological and biogeographical information, we suggest that the gene tree incongruence as well as their discordance with the inferred species tree  are due to a lack of sorting of ancestral polymorphic alleles and/or due to introgression after the split of the species. assuming neutrality, retention of ancestral polymorphism is likely if speciation is fast relative to drift within the populations  <cit> . the quantitative results from the im model  show large ancestral effective population sizes, short splitting time between them and some migration. this corroborates our inference from the discordant nuclear gene trees and suggests rapid speciation and/or occasional exchange of migrants at the diploid level within a. millefolium agg..

the same pattern apparently also characterizes the more distantly related congeneric species, e.g., a. nobilis-2x, a. ligustica-2x and a. acuminata-2x . in a. nobilis, a diploid species relatively close to a. millefolim agg., we find intra-locus recombination in the ncpgs gene, indicating its hybrid origin or introgression involving a diploid donor from a. millefolim agg. .

phylogeography and rapid speciation
throughout the n hemisphere, gene flow between divergent lineages through periods of climate changes has shaped the extant geographical distribution and patterns of genetic variation of many plant species  <cit> . rapid speciation resulted from post-glacial hybrid contacts and polyploidy during population migration have often been reported and documented. for example, brysting et al.  <cit>  has untangled the complex history of the polyploid cerastium alpinum group in the circumpolar arctic flora. complexity is also evident in the evolutionary radiation of a. millefolium agg  <cit> .

the diploid taxa of a. millefolium agg. are limited to eurasia, following an eco-geographical vicariance pattern but appear to be disjunctive and regressive evidently under the pressure of their more expansive polyploid descendants: a. ceretanica-2x, a relict endemic in subalpine grassland of the e pyrenees; a. asplenifolia, an endemic relict of humid lowland grasslands in the pannonian plains from bulgaria, hungaria, e austria and the adjacent czech rep.; a. roseoalba-2x, a variable taxon of mesic forest margins and anthropogenous meadows in the geologically recent n italian plains and foothills with populations in adjacent switzerland, austria, and locally even in bavaria and slovenia where it is in close contact with a. asplenifolia-2x; a. setacea in steppes from sw asia and se europe to continental areas of c europe and the alps; a. latiloba, today a subalpine relict in the mountains of ne turkey and sw georgia; a. asiatica-2x in montane to alpine grassland from the altai to mongolia and n china; and a. cuspidata-2x, a relict in the w himalayas.

the previous aflp data  <cit>  indicate that a. setacea-2x branches early within the a. millefolium agg. the present sequence data partly show compatible patterns of relationships, i.e., the european species a. ceretanica-2x, a. roseoalba-2x and a. asplenifolia-2x are more closely related to each other and to the asian a. asiatica-2x than to a. setacea-2x . the morphology, distribution and habitat preferences suggest that a. roseoalba-2x might have originated from introgression into a. asplenifolia possibly by the a. ceretanica-like populations  <cit> . compared to its european sister species, a. asiatica-2x represents a wide geographic extension of a. millefolium agg. into c and e asia and harbors the richest plastid variation among all the diploid taxa . it could have survived the cold periods of the late pleistocene in refugia not far from its present occurrence in or near the asian mountain areas. in spite of the large distributional range, we find little evidence for isolation by distance: the easternmost a. asiatica-2x and the westernmost a. ceretanica-2x share as much genetic variation as each with the geographically intermediate a. asplenifolia-2x and a. roseoalba-2x .

in contrast to the diploid species that show phylogenetic structuring and are limited to eurasia, the polyploid taxa of a. millefolium agg. exhibit practically continuous and interrelated relationships and have extended their range to n america. with the available nuclear ncpgs and spb sequence data alone, it is often hard to decide whether a polyploid taxon studied here is auto- or allopolyploid because even the diploids share polymorphic alleles likely due to incomplete lineage sorting and/or secondary introgression. only combined with the previous aflp profiles  <cit> , the autopolyploid nature of some may become clear, but most are influenced by hybridization.

in europe, a. ceretanica-4x in central france exhibits some ncpgs correspondence  with a. roseoalba-4x and aflp affinities with a. ceretanica-2x  <cit>  but otherwise little affiliation with its diploid cytotype. in populations of a. roseoalba-2x, 4x-individuals occur with a new plastid haplotype  and corresponding ncpgs alleles . a. styriaca-4x, an endemic from e austria and the czech rep., is ecologically distinct but shares ncpgs and sbp alleles with a. roseoalba-4x and the plastid haplotype h <dig> with a. asplenifolia-2x and so on. a. setacea-2x and a. asplenifolia-2x have been involved in the origin of the widespread and expansive c to e european allotetraploid a. collina-4x  <cit> . all the 4x-taxa mentioned above are connected by occasional intermediates, can be easily hybridized in crossing experiments and produce viable progeny with more or less normal meioses  <cit> . further to the east in ukraine, a. inundata-4x is linked to a. setacea-2x and also to a. asplenifolia-2x etc. .

the diverse 4x-cytotypes from c and e asia are provisionally called a. asiatica-4x. they are particularly linked to a. asiatica-2x, but also to a. cuspidata-2x . plastid h <dig> and h <dig> also demonstrate links of a. asiatica-4x with the european 2x- and 4x-taxa . how complex the relationships of higher polyploids in a. millefolium agg. are is shown by the recently described altai endemic a. schmakovii-6x: it shares nuclear haplotypes with a. setacea-2x, a. asplenifolia-2x, a. inundata-4x, a. asiatica-4x and has the rare plastid haplotype h <dig> from a. asiatica-2x.

the pleistocene extension of a. millefolium agg. into n america  <cit>  with populations called a. borealis s.lat. and two main cytotypes  is of particular interest. they have developed ecotypes in most habitats from the sand dunes of the pacific to the peaks of rocky mts. and the east coast forests. their rapid adaptive differentiation has been well documented by clausen et al.  <cit>  and ramsey et al.  <cit> . the molecular genetic data from guo et al.  <cit>  and ramsey et al.  <cit>  have shown that all these native n american populations differ from those in eurasia, are monophyletic and most likely linked to a. asiatica-2x/4x , but can not be resolved in more details. in the ncpgs and sbp gene trees , they share alleles with a. asiatica-2x and -4x, but also with a. millefolium-6x  in subarctic russia and even with a. inundata-4x, a. ceretanica-4x and a. asplenifolia-2x. considering plastid haplotypes, the most frequent h <dig> is likely the ancestral, from which h18-h <dig>   <dig>   <dig> have originated . all these and additional fossil data  <cit>  support the assumption that the ancestors of the n american populations might have survived in ne asian/alaskan refugia  during the middle or late pleistocene cold periods  <cit> . apart from the westward extension through siberia to subarctic europe , their main migrations might have been east- and southward into n america. there, without the competition of closely related taxa, they underwent a radiation and formed the 4x and 6x racial complex of a. borealis s.lat.. this can be regarded quasi as a model for the early phase of the eco-geographical radiation of a. millefolium agg. in se europe and adjacent sw asia, and a second phase with a. asiatica-2x+4x, a. alpina-4x and a. schmakovii-6x in c and e asia  <cit> .

CONCLUSIONS
nuclear and plastid haplotype data analyzed in this study suggest rapid diploid and polyploid speciation in the temperate n hemisphere achillea species, especially those within a. millefolium agg.. hybridization and polyploidy seem to have promoted the recent lineage radiation, shaped the concurrent patterns of genetic variation, and contributed to the wide distribution of this species complex.

the sequence data from two nuclear genes and chloroplast dna employed in this study result in incongruent trees, obviously due to lack of lineage sorting and/or secondary hybridization, and thus cannot resolve the species phylogeny. this lack of lineage sorting apparently extends to other congeneric taxa. to date, the aflp tree  <cit>  is the only molecular tree that can be brought into accordance with species delimitations, morphology and traditional taxonomy of a. millefolium agg.. this is likely due to the averaging effect of the genome-wide sampling of aflp polymorphism.

with little lineage sorting and frequent gene flow, the species tree can only be recovered using data from many unlinked dna regions. despite the development of new techniques such as the rad tag technology  <cit> , traditional molecular methods, such as aflp genome screening, are still useful for non-model species, especially if complemented by likelihood-based bayesian analytical methods  <cit> . on the other hand, even if sequence data from the nuclear and chloroplast genomes can not override the aflp data in resolving recent species divergence, they do help to understand population demography and speciation processes, and to demonstrate that shared ancestral polymorphisms are more common than fixed alleles in young radiating species. therefore, for the phylogeographic surveys of non-model organisms, we advocate the use of dna polymorphisms from multiple unlinked loci, e.g., aflp markers, combined with sequence data from some single genes, as such a combination appears useful and cost and time efficient.

authors' contributions
ypg conceived the project, collected part of the plant samples, conducted the data analysis and led the writing; szw performed the lab work and collected the sequence data; cv helped on conceiving the ideas and manuscript drafting; and fe collected and identified most of the plant materials, contributed phylogeographic aspects and helped with manuscript writing. all authors read and approved the final manuscript.

supplementary material
additional file 1
the aligned polymorphic sites among  <dig> haplotypes of the sequenced ncpgs gene. these haplotypes are generated from  <dig> substitution sites among  <dig> clones  from  <dig> individuals of  <dig> populations of  <dig> diploid achillea species . abbreviations of the species:  of a. millefolium agg.: asi = a. asiatica, asp = a. asplenifolia, cer = a. ceretanica, cus = a. cuspidate, lat = a. latiloba, ros = a. roseoalba and set = a. setacea;  of other species: acu = a. acuminata, lig = a. ligustica and nob = a. nobilis. title of each haplotype sequence includes: abbreviation of species . note: three haplotype of a. nobilis  except the first one contain a recombination around the 89th polymorphic site between two or three haplotype groups of a. millefolium agg. . the sequences of a. cuspidate  seems also containing a recombination around the 26th polymorphic site between those of a. ligustica  and some of a. millefolium agg. .

click here for file

 additional file 2
the aligned polymorphic sites among  <dig> sbp haplotypes. these haplotypes are generated from  <dig> substitution sites among  <dig> clones  from  <dig> individuals of  <dig> populations of  <dig> diploid achillea species . abbreviations of the species:  of a. millefolium agg.: asi = a. asiatica, asp = a. asplenifolia, cer = a. ceretanica, cus = a. cuspidate, lat = a. latiloba, ros = a. roseoalba and set = a. setacea;  of other species: acu = a. acuminata, lig = a. ligustica and nob = a. nobilis. title of each haplotype sequence includes: abbreviation of species .

click here for file

 additional file 3
unrooted neighbour joining cladogram of the sbp gene of all the diploid and polyploid taxa analyzed in this study. the tree contains  <dig> allelic haplotypes generated from  <dig> sequences with  <dig> substitution sites. topology of the mp tree on the same data set is broadly comparable with that of the nj tree. bootstrap supports  from nj/mp analyses are shown next to the branches. label of each terminal branch is written as "taxa abbreviation ". for taxa abbreviations, see table  <dig>  diploid taxa are in black, polyploid taxa in different colors.

click here for file

 additional file 4
map showing the approximate distribution the  <dig> plastid haplotypes  recognized across the temperate n hemisphere. pies indicate the proportion of haplotypes registered for individual taxa/cytotypes and the size of each pie correlated to the sample size from their generalized sampling areas.

click here for file

 acknowledgements and funding
this work is supported by the national natural science foundation of china . we are grateful to e. temsch, j li and m. lambrou for providing technical instructions on dna ploidy level determinations and chromosome counts. we also thank l. ehrendorfer-schratt, a. tribsch, m. staudinger, g.-y. rao, d.-y. tan, and r. cao for collecting part of the plant samples. particular thanks are due to j. ramsey  for important additional information on their achillea research and valuable discussions.
