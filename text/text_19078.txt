BACKGROUND
no two laboratories produce the same expression data when performing seemingly identical dna microarray experiments. this is simply due to the fact that experimental conditions and factors such as growth media composition, rna sampling methodology and scanner calibration are never exactly identical  <cit> . even within one and the same laboratory differences in the outcome of experiments executed by different laborants can be observed  <cit> . these and many other factors lead to sometimes unexpected gene expression variations that can occur at several levels. figure  <dig> shows a schematic and simplified overview of those levels in dual-color dna microarray data  as well as the effect of some of these levels on the composition of the expression signals .

it is obvious that knowledge about the properties that gene expression signals hold as shown in figure  <dig> is very important to any researcher. this knowledge can be used to design an optimal new dna microarray experiment and to carry out the best analysis of that generated data set. to this end, real and simulated data has been used for a long time in data analysis workshops. and in case it is not  obvious for a novice in the field, the visualization as shown in figure  <dig> can be of educational value. in all three cases – design, analysis and education – the availability of simulation software would be very helpful. it is of eminent importance that the simulated data resembles experimental data as much as possible  <cit>  and, therefore, there is a need for software that can  estimate levels of variation.

various software packages for simulating dual-color dna microarray data have been described in the literature . some of these packages aim at validating image analysis and spot quantification and simulate tif-images of the visualized spots. other software focuses on gene networks. in this paper, we present new software that fits in between these two categories: we simulate the gene expression data as it is tabulated after image analysis. in addition, we provide software that can be used to roughly estimate the levels of variation in real data. these computer programs, named simage, are freely available via a web-resource.

implementation
software overview
the simage web site  <cit>  consists of three parts:  a start page where the user may upload parameters for a simulation;  a web-page where the user specifies a number of parameters, after which  the results, namely simulated data , are presented. each run is assigned a unique session, which allows the user to inspect the results at any given time. simage provides the user with three types of text files containing:  the parameters used for the simulation. this file can, in turn, be provided to simage for future simulations;  the  gene expressions, which are obtained after applying only the gene-layer; and  the observed signals  after applying the layers explained in the following paragraphs. the estimates from a provided dataset are determined by a self-explanatory web site which is linked from the simage web site.

simage was written in pascal and compiled by freepascal version  <dig> . <dig>  <cit> . estimates for parameters, based on real data, are provided by a script developed in r  <cit> . the software requires an apache web-server and is integrated with a php web-interface.

the general model
dimensions and notation
a dna-microarray slide consists of a number of spots arranged in a two-dimensional matrix, which, in turn is divided into nrow × ncol square grids . each grid contains nspot2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdaqhaawcbagaem4camnaemicaanaem4ba8maemidaqhabagaegomaidaaaaa@34e0@ spots , amounting to a total number of nrow × ncol × nspot2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdaqhaawcbagaem4camnaemicaanaem4ba8maemidaqhabagaegomaidaaaaa@34e0@ spots per slide. in total, nslide slides are simulated with each spot providing a measure of the green  and the red  signal. the simulated log expression at spot  of array l and channel k is denoted by yijkl.

gene expressions
to distinguish between non-regulated and regulated genes, the log ratio is considered. assuming absence of other systematic deviations, the log ratio of the cy <dig> and c <dig> channel signals log = log - log, is zero for non-regulated genes , positive for up-regulated genes, and negative for down-regulated genes. the part of yjikl that is affected in this gene expression layer will be called yijkl*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaemyaakmaemoaaomaem4aasmaemibawgabagaeiokaocaaaaa@34a8@. this yijkl*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaemyaakmaemoaaomaem4aasmaemibawgabagaeiokaocaaaaa@34a8@ will be the same on all spots where the same gene g is spotted , hence we can use the notation yg*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaem4zacgabagaeiokaocaaaaa@3087@. we split yg*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaem4zacgabagaeiokaocaaaaa@3087@ into two parts: gg;k, which is concerned with the 'true' expression of gene g on channel k before any other layer is applied, and dg;k, which is a  deviation due to up- or down-regulation of gene g. the modeling of yg*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaem4zacgabagaeiokaocaaaaa@3087@ is done via yg;k*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaem4zacmaei4oasjaem4aasgabagaeiokaocaaaaa@32e4@ = gg;k + dg;k. to start with gg;k, we assume that this latent  variable is distributed as gg;k ~ n. here, μ is the average expression value, and σg2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4raceabagaegomaidaaaaa@30ac@ can be interpreted as the variation in gene expression. hence, the expressions of non-differentially expressed genes are distributed symmetrically around μ, according to a normal distribution. for a comment on the normality assumption of gg;k, see the end of this paragraph. in most dna-microarray data gg; <dig> and gg; <dig> are not statistically independent  <cit> , which can be observed by considering a plot of cy <dig> versus cy <dig> signals. therefore the covariance cov = ρσg2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4raceabagaegomaidaaaaa@30ac@ is introduced, where ρ is the correlation coefficient between the signals from the two channels.

for each gene we model the probability of being up-, down- and non-regulated π+, π-, and π0=  <dig> - π+ - π-, respectively. for up-regulated genes the log ratio is increased by 2μd and for down-regulated genes the log ratio is decreased by 2μd. the effect of regulation is modeled via dg;k:

=μd, where ={if gene g is downregulated;if gene g is nonregulated;if gene g is upregulated.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaauaabeqaceaaaeaacqwgebardawgaawcbagaem4zacmaei4oasjaegymaedabeaaaoqaaiabdseaenaabaaaleaacqwgnbwzcqgg7awocqaiyagmaeqaaaaaaogaayjkaiaawmcaaiabg2da9maabmaabaqbaeqabiqaaaqaaiabdugarnaabaaaleaacqaixaqmaeqaaagcbagaem4aas2aasbaasqaaiabikdayaqabaaaaagccagloagaayzkaaaccigae8hvd02aasbaasqaaiabdseaebqabagccqqgsaalcqqggaaicqqg3bwdcqqgobaacqqglbqzcqqgybgccqqglbqzcqqggaaidaqadaqaaiabdugarnaabaaaleaacqaixaqmaeqaaogaeiilawiaem4aas2aasbaasqaaiabikdayaqabaaakiaawicacaglpaaacqgh9aqpdagabaqaauaabaqadiaaaeaadaqadaqaaiabgkhitiabigdaxiabcycasiabigdaxagaayjkaiaawmcaaaqaaiabbmgapjabbagamjabbccagiabbeganjabbwgaljabb6gaujabbwgaljabbccagiabdeganjabbccagiabbmgapjabbohazjabbccagiabbsgakjabb+gavjabbeha3jabb6gaujabbkhayjabbwgaljabbeganjabbwha1jabbygasjabbggahjabbsha0jabbwgaljabbsgakjabbuda7aqaamaabmaabagaeeimaajaeeilawiaeeimaadacagloagaayzkaaaabagaeeyaakmaeeozaymaeeiiaaiaee4zacmaeeyzaumaeeoba4maeeyzaumaeeiiaaiaem4zacmaeeiiaaiaeeyaakmaee4camnaeeiiaaiaeeoba4maee4ba8maeeoba4maeeocainaeeyzaumaee4zacmaeeydaunaeeibawmaeeyyaemaeeidaqnaeeyzaumaeeizaqmaee4oasdabawaaewaaeaacqqgxaqmcqqgsaalcqghsislcqqgxaqmaiaawicacaglpaaaaeaacqqgpbqacqqgmbgzcqqggaaicqqgnbwzcqqglbqzcqqgubgbcqqglbqzcqqggaaicqwgnbwzcqqggaaicqqgpbqacqqgzbwccqqggaaicqqg1bqdcqqgwbaccqqgybgccqqglbqzcqqgnbwzcqqg1bqdcqqgsbabcqqghbqycqqg0badcqqglbqzcqqgkbazcqqguaglaaaacagl7baacawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaaa@c919@

although μd is a fixed number, because of the sum yg;k*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaem4zacmaei4oasjaem4aasgabagaeiokaocaaaaa@32e4@ = gg;k + dg;k that is 'measured' this layer behaves as if regulated genes get a random sized shift up or down. note that gg;k, as well as almost all other stochastic variables are modeled in simage as outcomes of normal distributions. although this brings about some oversimplification, we consider this not really an issue or, in the words of wit and mcclure   <cit> , 'the misspecification made by using a normal approximation is typically negligible'. in addition, the superposition of the various normally distributed layers does not imply that the generated expressions levels themselves are normally distributed. furthermore, modeling of yg*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaem4zacgabagaeiokaocaaaaa@3087@ as a combination of three  densities  enables estimating the model parameters . a more extensive modeling of the gene expressions, although biologically somewhat more correct, will result in a significantly more complex estimation of parameters compared to the parameters described in this study.

replication variation
spotting , hybridization , and quantization  introduce variation in yijkl in addition to the 'natural biological variation'. this natural variation is modeled as follows. when a simulated gene g is spotted on spot ijkl, random errors εij1l and εij2l are drawn from n and are added to the two replicated measurements yij1l*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaemyaakmaemoaaomaegymaejaemibawgabagaeiokaocaaaaa@3439@ and yij2l*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg5bqedaqhaawcbagaemyaakmaemoaaomaegomaijaemibawgabagaeiokaocaaaaa@343b@. each gene will be replicated nrep times.

background surface variation
the signal distribution over the surface of the dna-microarray glass-slide is affected by various factors, e.g. slide surface chemistry and hybridization effects, leading to an irregular distribution of the labeled probe on the slide  <cit> . the most simplistic way to model such gradient signals is by using a tilted plane, such that the signals on one side of the slide are higher than on the other. a more sophisticated method is that of balagurunathan and coworkers   <cit>  where a quadratic function is implemented. such a function, however, is limited in the sense that it has only one local extreme .

we use a method that allows for a number of local extremes to exist. a number nbg of bivariate normal densities with random parameter settings identifying the location and size on the slide are computed and subsequently multiplied by a random amplitude i . each density is computed by:

fm=im2πσbgx2σbgy21−ρbg2e,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdawgaawcbagaemyba0gabeaakmaabmaabagaemyaakmaeiilawiaemoaaogacagloagaayzkaagaeyypa0zaasaaaeaacqwgjbqsdawgaawcbagaemyba0gabeaaaoqaaiabikdayggaciab=b8awjab=n8aznaadaaaleaacqwgibgycqwgnbwzcqwg4baeaeaacqaiyagmaagccqwfdpwcdaqhaawcbagaemoyaimaem4zacmaemyeakhabagaegomaidaaowaaoaaaeaacqaixaqmcqghsislcqwfbpgcdaqhaawcbagaemoyaimaem4zacgabagaegomaidaaaqabaaaaogaemyzau2aawbaasqabeaadawadaqaaiabgkhitmaalaaabagaegymaedabagaegomaizaaewaaeaacqaixaqmcqghsislcqwfbpgcdaqhaaadbagaemoyaimaem4zacgabagaegomaidaaawccagloagaayzkaaaaamaabmaabawaasaaaeaadaqadaqaaiabdmgapjabgkhitiab=x7atnaabaaameaacqwgibgycqwgnbwzcqggsaalcqwg4baeaeqaaawccagloagaayzkaawaawbaawqabeaacqaiyagmaaaaleaacqwfdpwcdaqhaaadbagaemoyaimaem4zacmaeiilawiaemieaghabagaegomaidaaaaaliabgkhitiabikdayiab=f8aynaalaaabawaaewaaeaacqwgpbqacqghsislcqwf8oqbdawgaaadbagaemoyaimaem4zacmaeiilawiaemieaghabeaaasgaayjkaiaawmcaamaabmaabagaemoaaomaeyoei0iae8hvd02aasbaawqaaiabdkgaijabdeganjabcycasiabdmha5bqabaaaliaawicacaglpaaaaeaacqwfdpwcdawgaaadbagaemoyaimaem4zacmaeiilawiaemieaghabeaaliab=n8aznaabaaameaacqwgibgycqwgnbwzcqggsaalcqwg5bqeaeqaaaaaliabgucarmaalaaabawaaewaaeaacqwgqbgacqghsislcqwf8oqbdawgaaadbagaemoyaimaem4zacmaeiilawiaemyeakhabeaaasgaayjkaiaawmcaamaacaaameqabagaegomaidaaawcbagae83wdm3aa0baawqaaiabdkgaijabdeganjabcycasiabdmha5bqaaiabikdayaaaaaaaliaawicacaglpaaaaiaawufacagldbaaaagccqggsaalcawljagaaczcamaabmaabagaegomaidacagloagaayzkaaaaaa@b5c9@

where the parameters are provided by the user. these densities are summed, together with a linear gradient with a random tilt lower than s, to constitute the background surface signals . an additive modeling of the background effect is chosen over a multiplicative model. as to the reasons why, see the supplementary document.

channel deviations, gene-dye interactions and spot pin deviation
the rationale behind the modeling of these three layers is the same: for each of the layer values a deviation, drawn from a normal distribution, is added to  the cy <dig> / cy <dig> signals.

in some actual dna-microarray experiments, the average cy <dig> signal is significantly different from the average cy <dig> signal obtained for a spot; reasons are: gene-to-gene variation in dye incorporating efficiencies, global differences in cy <dig> and cy <dig> abundance in the dna preparations, and bleaching of the dyes . this effect is incorporated in the model by a random deviation c <dig> for n to all cy3-measurements and another random deviation c <dig> from this distribution to all cy5-measurements.

differential incorporation of dyes in dna occurs due to  the preference of reverse transcriptase for the physically smaller cy <dig> label in case of direct labeling and  differential hybridization because of the physically larger cy <dig> label. the effects differ between genes as a consequence of dna size and the distribution of the labeled nucleotides in the dna molecule  <cit> . gene-dye interactions are embedded in the model similarly to the channel effect: for all measurements belonging to gene g and dye d a random deviation xgk from n is added to the signal.

spot pins show systematic deviations in the amount of probe delivered to the glass surface. the signals measured of targets spotted with one spot pin might differ significantly from those spotted with another spot pin. the npin drawings spin from n are used to model these effects. spot pin effects are equal for both channels.

non-linearity
 plots  <cit>  from experimentally obtained dna-microarray data often look somewhat curved  and / or tilted, generally with higher deviations for lower a values . the simage model allows for non-linearity using a transformation fnl based on two parameters: α <dig>  specifying the maximum amount of curvature to be allowed, and α <dig>  which specifies the maximum amount of linear tilt. although the transformation is relatively simple, the resulting data mimics experimental data closely enough with respect to non-linearity. the exact definition of the modeling of this layer and some examples of the resulting curvature is presented in the supplementary document.

fishtails
a common artifact of dna-microarray data is that genes with a lower expression tend to be noisier. this is apparent in the 'fishtail' appearance of  graphs. the main reason for this artifact is mainly that spots with a lower signal are quantified with larger errors than spots with higher signals  <cit> . another reason could be the 'over-transformation' of data due to the log-transformation, and that a less influential power transformation would be more appropriate to obtain normally distributed gene expressions. it would, however, be extremely complicated to use another transformation, since the property of logarithms that it turns multiplicative effects into additive effects is used throughout the complete simage model. we have to content ourselves with this approximation.

the fishtailing behavior is incorporated in simage by a parameter δ that inflates the log ratio for spots with an average expression aijl below μ by a factor 2)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaaiabigdaxiabgucarggaciab=r7akjab=n8aznaadaaaleaacqwgnbqtaeaacqghsislcqaiyagmaagcdaqadaqaaiabdgeabnaabaaaleaacqwgpbqacqwgqbgacqwgsbabaeqaaogaeyoei0iae8hvd0gacagloagaayzkaawaawbaasqabeaacqaiyagmaaaakiaawicacaglpaaaaaa@4154@. a higher value of δ will result in a stronger effect and δ =  <dig> indicates no fishtail effect. the parameter σm2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyta0eabagaegomaidaaaaa@30b8@ will be introduced below . our model mimics biological replicates by randomizing the effect of δ for non-regulated genes. for each slide these genes have a probability of 1/ <dig> of being influenced by fishtailing. in this way, the expressions of non-regulated genes are seldom distributed in such a way that they appear differentially regulated in a simulated experiment with replicated slides.

quantization and saturation
slide scanning introduces another non-linearity artifact. the scanning device uses  <dig> bits to describe signal strength, i.e. signals are always between log =  <dig> and log =  <dig>  furthermore, some dna-microarray data scanners tend to over-measure low values, and under-measure high values  <cit> . when no over- or under-measurement occurs, the signal transformation l <dig> = min,16) on y will be used to incorporate the cutoff at log =  <dig> and log =  <dig>  a maximal over- or under-measurement effect will result in the signal transformation l1=16/)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbabdawgaawcbagaegymaedabeaakmaabmaabagaemyeakhacagloagaayzkaagaeyypa0jaegymaejaegonayjaei4la8yaaewaaeaacqaixaqmcqghrawkcygglbqzcqgg4baecqggwbacdaqadaqaaiabikdayiabgkhitmaaleaaleaacqwg5bqeaeaacqai0aanaaaakiaawicacaglpaaaaiaawicacaglpaaaaaa@439b@. this transformation inflates low signals, deflates high signals, and leaves medium signals unchanged.

via a parameter w  the simage model is instructed on the severity of the bias. the transformation gnl used is a weighted average of l <dig> and l <dig>  namely gnl = l <dig> + wl <dig>  the supplementary document provides a visualization of the effect of different choices of w.

missing data
in actual dna-microarray data measurements may be missing. reasons are: slide surface imperfections, hybridization effects, no dna delivered to the glass surface during the spotting process or presence of fibers or dust particles. our simulation model implements three types of missing data :  line-segments mimic 'hairs',  'donuts' comprising multiple spots mimic dirty areas and  missing spots. the implementation of the model allows specifying the number of occurrences of these types of missing data as well as their maximum size and shape.

the simage model
in the simage model  <dig> parameters have to be specified , of which  <dig> are known constants . the model, which results from the components described above, is defined as follows: the simulated log expression at spot  of array l and channel k is denoted by yijkl as:

yijkl=gnl))⋅mijl, withzijkl=ggene;k+dgene;k+ck+spin+xgene;k+εijkl     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqaabeqaaiabdmha5naabaaaleaacqwgpbqacqwgqbgacqwgrbwacqwgsbabaeqaaogaeyypa0jaem4zac2aasbaasqaaiabd6gaujabdygasbqabagcdaqadaqaaiabdsha0naabaaaleaaiigacqwf0oazaeqaaowaaewaaeaacqwgmbgzdawgaawcbagaemoba4maemibawgabeaakmaabmaabagaemoyaimaem4zac2aasbaasqaaiabdmgapjabdqgaqjabdygasbqabagccqghrawkcqwg6bgedawgaawcbagaemyaakmaemoaaomaem4aasmaemibawgabeaaaogaayjkaiaawmcaaagaayjkaiaawmcaaagaayjkaiaawmcaaiabgwsixlabd2gatnaabaaaleaacqwgpbqacqwgqbgacqwgsbabaeqaaogaeiilawiaeeiiaaiaee4dacnaeeyaakmaeeidaqnaeeiaaggabagaemoeao3aasbaasqaaiabdmgapjabdqgaqjabdugarjabdygasbqabagccqgh9aqpcqwghbwrdawgaawcbagaem4zacmaemyzaumaemoba4maemyzau2aaewaaeaacqwgpbqacqwgqbgacqwgsbabaiaawicacaglpaaacqgg7awocqwgrbwaaeqaaogaey4kasiaemiraq0aasbaasqaaiabdeganjabdwgaljabd6gaujabdwgalnaabmaabagaemyaakmaemoaaomaemibawgacagloagaayzkaagaei4oasjaem4aasgabeaakiabgucariabdoeadnaabaaaleaacqwgrbwaaeqaaogaey4kasiaem4uam1aasbaasqaaiabdchawjabdmgapjabd6gaunaabmaabagaemyaakmaemoaaogacagloagaayzkaaaabeaakiabgucariabdifaynaabaaaleaacqwgnbwzcqwglbqzcqwgubgbcqwglbqzdaqadaqaaiabdmgapjabdqgaqjabdygasbgaayjkaiaawmcaaiabcuda7iabdugarbqabagccqghrawkcqwf1oqzdawgaawcbagaemyaakmaemoaaomaem4aasmaemibawgabeaakiaaxmaacawljawaaewaaeaacqaizawmaiaawicacaglpaaaaaaa@b3f0@

where

gene the gene spotted at location  ;

pin the spot pin used to spot location ;

gnl a transformation due to quantization and saturation;

tδ a transformation due to 'fishtailing';

fnl a transformation due to non-linearity in measurements;

mijkl equals  <dig> if the spot at location  is 'missing', and  <dig> otherwise ;

bgijl the background gradient level ;

gg;k the expression level of gene g in channel k;

dg;k the change in expression due to up-/down-regulation;

ck the channel effect;

spin the spot pin effect;

xgene;k the gene × dye interaction;

εijkl the replication error.

datasets used and estimation of the parameters
in order to estimate the parameters for a number of slides hybridized at the department of molecular genetics , dna-microarray data from  <dig> lactococcus lactis il <dig> slides from molgen  <cit>  were used . these datasets specify, for each spot:  the annotated gene names,  the raw expression values for both channels, and  an estimated background signal. parameters were determined from the net intensity values of the slides .

besides molgen slides, several slides from the public domain were analyzed. datasets gds <dig>  gds <dig>  and gds <dig> were obtained from the gene expression omnibus from ncbi  <cit> . the dataset mexp- <dig> was obtained from ebi's arrayexpress  <cit> . in the supplementary web site  <cit> , the exact slides used for the parameter estimations are listed.

the simage web site provides a tool for the estimation steps described in the following sections. in order to obtain robust estimates for the slides, some slides yielding obviously outlying estimates, i.e. when σchannel2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4yammaemiaagmaemyyaemaemoba4maemoba4maemyzaumaemibawgabagaegomaidaaaaa@3906@ was larger than μ, were discarded. only those experiments were used for which at least  <dig> slides with acceptable estimates were obtained. the estimates of the molgen "experiment" were determined by the median of the "experiment" slides, while the molgen "validation" estimates were determined by the median of the estimates of the validation slide data  <cit>  . for each of the  <dig> experiments, dna-microarray data obtained from the same slide batch were used to estimate the experiment-specific parameters . this was done to minimize slide batch-specific bias in parameter estimation. the median, rather than the mean, of the estimates for each parameter is used as input in simage simulation interface because of the nonsymmetrical distribution of the estimates.

background gradient and densities
spot background signals for the molgen slides were determined as described  <cit> . estimates for the number of background densities to be estimated, as well as their average standard deviations, were obtained by visually inspecting a number of experimentally obtained background densities. furthermore, estimates for the average horizontal and vertical linear tilt were obtained by fitting a regression plane through the background signal distribution.

non-linearity, quantization and saturation
a direct way to estimate the scanning device bias parameter w is not feasible since this parameter is confounded within the other variables in the simage model. one could assume absence of scanning device bias . we used an alternative method to estimate this parameter . the estimation of the non-linearity parameters α <dig> and α <dig> is done as follows: in the  plot for background-corrected data , a lowess curve  <cit>  is fitted. then a second degree polynomial is fitted to this lowess curve, and the parameters α <dig> and α <dig> are directly derived from the parameters of the polynomial .

spot pin effects, channel effects, fishtails and replication variation
after subtracting the estimates for the background signals and the non-linearity effects from yijkl  we obtain zijkl, where zijkl = ggene;k + dgene;k + ck + spin + xgene;k + εijkl. the estimation of the gene layer factors g and d is discussed in the following paragraph. for all other factors, the estimation of their parameters is a matter of calculating a variance components model.

the gene-dye interaction is strongest when direct labeling of rna is applied. an analysis by anova of indirectly-labeled rna used in self hybridization slides  <cit>  and dye-swapped replicated slides  performed at molgen showed that the gene-dye interaction effects did not differ significantly. note that the factor xgene;k can only reliably be estimated in case dye-swaps are performed with the same rna.

the fishtail parameter δ was estimated by fitting a quadratic curve through the data points  with aijl <μ .

gene expressions
after correcting zijkl for all factors except g and d, the parameters for g and d are estimated as follows: define y˜g,k
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgzbqwgaacamaabaaaleaacqwgnbwzcqggsaalcqwgrbwaaeqaaaaa@31b8@ as the average value of the nrepreplications yijkl with gene = g : y˜g;k=1nrep∑ijl|gene=gyijl
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgzbqwgaacamaabaaaleaacqwgnbwzcqgg7awocqwgrbwaaeqaaogaeyypa0zaasaaaeaacqaixaqmaeaacqwgubgbdawgaawcbagaemocainaemyzaumaemicaahabeaaaagcdaaeqbqaaiabdmfaznaabaaaleaacqwgpbqacqwgqbgacqwgsbabaeqaaaqaaiabdmgapjabdqgaqjabdygasjabcyha8jabdeganjabdwgaljabd6gaujabdwgalnaabmaabagaemyaakmaemoaaomaemibawgacagloagaayzkaagaeyypa0jaem4zacgabeqdcqghris5aaaa@543c@. given the distributional assumptions outlined in "gene expressions" above, standard statistical theory provides that both the average log ratio  of the gene and the average intensity 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgbbqqgaacamaabaaaleaacqwgnbwzaeqaaogaeyypa0zaasqaasqaaiabigdaxaqaaiabikdayaaakmaabmaabagafmywaklbagaadawgaawcbagaem4zacmaei4oasjaegymaedabeaakiabgucariqbdmfazzaaiawaasbaasqaaiabdeganjabcuda7iabikdayaqabaaakiaawicacaglpaaaaaa@3e58@) of the gene are independently normally distributed, with variances σm2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyta0eabagaegomaidaaaaa@30b8@ and σa2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyqaeeabagaegomaidaaaaa@30a0@, respectively. the distribution a˜g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgbbqqgaacamaabaaaleaacqwgnbwzaeqaaaaa@2f49@ does not depend on whether gene g is up-, down- or non-regulated, and the parameters μ and σa2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyqaeeabagaegomaidaaaaa@30a0@ involved, as well as the variance σε2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagae8xtdugabagaegomaidaaaaa@3137@, are estimated in a straightforward way. the mean of the distribution of m˜g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbqtgaacamaabaaaleaacqwgnbwzaeqaaaaa@2f61@ depends on whether the gene is up-, down- or non-regulated. the parameters π-, π+, μd and σm2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyta0eabagaegomaidaaaaa@30b8@ are estimated using the em-algorithm  <cit>   with some restrictions . note that for self-self hybridizations π- = π+ =  <dig> and the estimation of σm2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyta0eabagaegomaidaaaaa@30b8@ is straightforward . furthermore, fishtailing does not affect the spots with above-average intensities , nor the a-values. for all spots with average intensities higher than the overall average intensity, the a- and m-values are used to estimate parameters.

the estimates for σg2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4raceabagaegomaidaaaaa@30ac@ and ρ , required for the simage model, are calculated from the estimates for σa2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyqaeeabagaegomaidaaaaa@30a0@ and σm2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyta0eabagaegomaidaaaaa@30b8@.

RESULTS
to illustrate the use of simage in drawing meaningful conclusions about the design and analysis of dna microarray experiments we show a number of examples based on dna microarray data generated within the molgen department. simage is used as follows:  define parameters based on real dna microarray data that are laboratory / experiment-specific,  these parameters are roughly estimated by our estimation procedure,  using these estimated parameters dna microarray data is simulated mimicking real dna microarray data as close as possible.

the parameter estimation
on the basis of a number of experiments that were performed at the molgen department, the "molgen experiment" parameters,  <dig> slides were simulated using simage. for each simulated slide, the model parameters were estimated using the estimation web-interface. deviations of the mean and median of the estimated parameters from the original parameters are shown in table  <dig> and figure  <dig> 

the estimation of μ, σchannel and σε are good . parameter σpin is somewhat systematically overestimated . the parameters σg2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4raceabagaegomaidaaaaa@30ac@ and ρ tend to be systematically mildly underestimated. this is likely because of the nonsymmetric estimation of ρ , which influences σg2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaem4raceabagaegomaidaaaaa@30ac@ which is calculated from the estimate of ρ. the performance of the estimations of δ, α <dig>  α <dig> and w depends highly on the actual values of these parameters. for low values of these parameters, they tend to be overestimated, while they are for high values underestimated. however, the estimation is rather good. as an indication, based on  <dig> slides with δ, α <dig>  α <dig>  and w all zero, the maxima of the  <dig> estimates for these parameters are  <dig> ,  <dig> ,  <dig> , and  <dig>  respectively.

the quality of the estimations of μ-, μ+, π-, π+ is highly experiment-dependent. table  <dig> and figure  <dig> show results for the choice of μ- = - <dig>  μ+ =  <dig>  π- = π+ = 10%, hence when the proportions of regulated genes and their average shifts in log ratio are considerable. the theory of dempster and coworkers   <cit>  indicates that the estimates of μ-, μ+, π-, π+ are unbiased: provided the correctness of our underlying statistical assumptions, no other estimators perform better. this is in concordance with the deviations listed in table  <dig>  in some cases where the true values of μ-, μ+, π-, and π+ are small their estimates are rather poor . the user of the web-interface is suggested to 'tweak' these gene-expression estimates somewhat, if necessary.

within-laboratory experiment-dependency of estimated parameters
in order to investigate whether parameter estimates for different experiments from the same laboratory are significantly different, two profiles were generated:  "real" experiments  <cit>  and  validation experiments  <cit> . a bonferonni-corrected mann-whitney test  showed that only parameters μ and ρ differ between the dna-microarray data simulated using both profiles . within the various "real" experiments, only the parameters describing regulation  differ significantly . parameters concerned with technical aspects of the dna microarray spotter and scanner are, as expected, not significantly different, since the same equipment in one laboratory was used. future studies on datasets obtained in other laboratories may implicate other parameters than those described above.

between-laboratory experiment-dependency of estimated parameters
the model parameters were estimated from five different datasets, obtained by different laboratories and querying the mrna levels of different organisms. the cvs of the model parameters obtained for individual datasets are, in general, lower than those obtained for the combined experiments . parameters which differ strongly between the datasets  are: average expression , tail behavior , gene variance , and the general error . for a few datasets the estimation of the parameters is quite "noisy", e.g. the cv for the non-linearity of scanner parameter  of the gds <dig> dataset . anova shows that the estimated parameters, with the exception of the spot pin variation σpin and the covariance ρ, are strongly experiment-dependent . in particular the gene variance  is strongly influenced by the experiment .

graphical features of the simulated data
to ensure that the simulated data contains similar properties as experimentally obtained data, several aspects of the simulated slides were inspected. in supplementary figure s <dig> three simulated and three "real" slides are visualized via an -plot and by grid-based box plots. several properties of the experimental slides are clearly present in a similar way in the simulated slides. figure  <dig> shows a graphical representation of the net and background spot signals of a simulated slide.

the modeled differentially expressed genes
simage allows modeling differentially expressed genes as is demonstrated in an in silico simulated experiment . in almost all cases the p-values and ratios of the  <dig> modeled differentially expressed genes  are significantly lower than those of the non-modeled genes . relatively few of the known differentially expressed genes had signals that were close to the background signals: these genes get p-values close to  <dig>  the inset in figure  <dig> clearly demonstrates the signal dependency of the p-values: differentially expressed genes with higher expression levels are assigned lower p-values. this is in concordance with the p-value distributions in "real" dna-microarray datasets.

discussion
as various factors, of both technical and biological nature, affect the quality of dna-microarray data, it is essential to use a proper experiment design and sophisticated statistics and bioinformatics methods to deal with these variables. since the factors involved, as well as their relative influence on data quality, vary between dna-microarray laboratories and differ even between experiments executed in the same laboratory, the question as to which design and analysis method is best, cannot be answered in general terms. simage, a model and web-implementation to simulate gene expressions, requires the specification of up to  <dig> parameters. it allows simulating data that resemble experimental dna-microarray data. to determine the relative contribution of the various parameters in dna-microarray data is a knowledgeable task. a second web-implementation is provided to easily provide rough but reasonable estimates of most of these parameters from experimental dna-microarray datasets. there is an important educational aspect about the simulation of dna-microarray data, which is clearly illustrated in figure 1b: it provides clear insights in the contribution of each background layer of the model to the measured signal.

almost all parameters in the model are strongly dependent on the experiment performed . this holds both for biological parameters in several different experiments from the same laboratory and for technical and biological parameters in experiments from different laboratories. the experiment-dependency of the μ estimations  is obvious from the fact that the average signals in the prokaryote datasets are higher than those in the eukaryote datasets. this is due to the fact that prokaryotes generally express a larger complement of their genes. the experiment-dependency of the gene variance  might also be attributed to differences in gene expression in the different organisms interrogated in the dna-microarray experiments discussed above. the latter is also clearly reflected by the high significance of the σ2gene parameter obtained by anova.

any method for simulation of dna microarray data can be questioned and criticized, mainly because there is neither established theory for the relation between expression  and factors involved , nor for the statistical distribution of differential expression given by various causes across genes. choices about the statistical aspects of the data need to be made when building a simulation model such as simage. different choices would lead to  different models with other 'optimal parameter estimation methods'. we have compared the distribution of simulated data  with that of experimentally obtained data and adapted our model to be able to mimic experimental data as much as possible.

creating a simage-like model to simulate data from other than dual-dye dna microarray platforms might be interesting for future work. our approach, using layers to model the factors involved, could be universally applied to simulate such data. this is, however, quite a task, since each type of dna microarray platform has its own specific properties. affymetrix, for instance, employs single-dye chips. the model of the synthesis of oligonucleotides on the chip surface and the different signals obtained for multiple probes would have to be quite sophisticated. another interesting approach would be to expand simage to incorporate gene-regulatory interactions or genes involved in documented pathways. the use of simulated gene-regulatory networks would provide a powerful tool to estimate the efficiency of network reconstruction algorithms.

CONCLUSIONS
a number of models for dna microarray data simulation have recently been developed . the question how to simulate dna microarray data in the best way is not easily and straight-forwardly answered. there are many considerations that pose a researcher wanting to simulate dna microarray data for difficult choices. we have developed simage: software that simulates dual-dye dna microarray data. the model that we employ, although more advanced than existing models, is still a simplification of reality. to ensure that the simulated dna microarray data mimics real data as close as possible the model is "fitted" onto "real" dna microarray data.

availability and requirements
project name: simage

project home page: 

operating system: runs on any javascript enabled web-browser.

programming languages: php, pascal, r, and shell scripting.

other requirements: additional files and figures are contained in the supplementary web site which is accessible from the above-mentioned web site.

license: the web-resource is freely accessible. details concerning the conditions for using simage are available from the above-mentioned web site.

authors' contributions
svh and ca conceived the simage concept and methodology. svh programmed simage including the web-interface and ca programmed the estimator script. ca and svh drafted the manuscript and generated the figures and tables. rj, jk and ok critically read and revised the final manuscript. all authors read and approved the final manuscript.

