BACKGROUND
transcriptional responses are modulated by dna-binding proteins known as transcription factors, which typically bind sets of similar dna sequences . cognate binding sites for a transcription factor exhibit position-specific variation. critical residues that mediate transcription factor binding are constrained, while the other residues are free to drift neutrally  <cit> , leading to highly degenerate cis-regulatory elements that are often hard to detect computationally.

the de novo computational identification of cis-regulatory elements is an extensively studied problem. numerous motif-finding algorithms have been developed over the years .

nearly all motif-finding algorithms fall into three general classes: pattern-based, profile-based and combinatorial. each class of algorithm uses a different mathematical model  to represent a set of cis-regulatory elements. pattern-based methods employ a consensus motif model in which cis-regulatory elements are represented by short words using the iupac alphabet. these methods seek to enumerate all possible words in the set of upstream sequences of coregulated genes in order to identify conserved  motifs. profile-based methods, on the other hand, are based on a position weight matrix motif model. these methods try to identify statistically overrepresented motifs by comparing upstream sequences  and seeking out local similarities. combinatorial motif-finding programs employ a position-independent mismatch motif model, where the motif is typically represented as a word of length l with at most k mismatches. these methods seek to identify cis-regulatory elements by clustering closely related groups of words.

each motif model has its limitations when searching for highly degenerate cis-regulatory elements. consensus-based algorithms typically struggle with highly degenerate motifs, in part because of their motif model. exhaustive enumeration of degenerate motifs over the 15-letter iupac alphabet causes an explosion of the search space from 4l to 15l   <cit> . further, the limited expressiveness of the consensus model implies that motifs represented via this model are at best crude approximations of the actual cis-regulatory elements. the position weight matrix model is more expressive, but is also prone to local maxima due to the enormous size of its search space. highly degenerate cis-regulatory elements that fit the position-independent mismatch model are difficult to find in published databases of cis-regulatory elements  <cit> . all of these models fail to account for inter-position dependencies. barash et al. showed that modeling a collection of binding sites as a mixture of two position weight matrices can account for some positional dependencies  <cit> , while king and roth present a nonparametric, pwm-based method that can account for arbitrary dependencies  <cit> .

in this paper we present a novel approach to the discovery of highly degenerate cis-regulatory elements that combines aspects of all three motif models. our approach starts with the most overrepresented non-degenerate words in a set of upstream regions. for each word, we explore the mismatch space immediately surrounding it, generalizing the word to a degenerate consensus that is more significantly overrepresented than the original word. we then construct a position weight matrix based on the actual occurrences of the consensus in the given set of upstream regions. this approach leverages the representational accuracy of the position weight matrix model while reducing the problem of local maxima through discretization. implicit in the approach is the assumption that a set of binding sites described by an overrepresented degenerate cis-regulatory element has at least one element within it that is itself overrepresented. in this paper, we prove that the statistical significance of a degenerate motif is bounded by the sum of the significance of the non-degenerate motifs it describes. this bound validates our assumptions and provides leverage for efficient identification of degenerate motifs. we demonstrate that our method is effective at finding highly degenerate cis-regulatory elements that are best described using the full iupac alphabet in s. cerevisiae. when tested on biological datasets, our approach outperforms nine other motif-finding programs based on each of the three motif models described above.

RESULTS
statistical overrepresentation is often used in motif-finding programs as a surrogate for biological significance. a natural measurement of overrepresentation is the probability of observing at least k occurrences of a motif given its frequency in the genome. we estimate this probability using the poisson distribution, which is -transformed and bonferroni-corrected to yield a sig score similar to the binomial-based sig score described by  <cit> . the sig score is easily extended to degenerate motifs when we consider that such a motif describes a collection of non-degenerate motifs. for this reason, we use the terms composite motif and instantiation to respectively refer to a degenerate motif and the non-degenerate motifs it describes. as shown in the methods, a useful property of the sig score is that the sig score of a composite motif is bounded by the sum of the sig scores of its instantiations.

sig score is bounded
previous methods have taken the approach of identifying the highest scoring non-degenerate motifs, then merging those that have a significant amount of textual overlap  <cit> . implicit in this approach is the assumption that significant degenerate motifs describe a set of significant non-degenerate motifs. to directly investigate the relationship between the sig scores of two motifs m <dig> and m <dig> and the sig score of the composite motif m = {m <dig>  m2}, we performed the following experiment. we randomly chose values for k  and λ  for the two motifs and plotted sig + sig against sig. as we demonstrate in methods, if we consider m <dig> and m <dig> to be the same motif, the resulting combined motif has expected count λ <dig> + λ <dig> and observed count k <dig> + k <dig> in the group. this experiment thus investigates the relationship between the sig scores of two motifs that differ by one mismatch and the sig score of the degenerate motif that describes exactly those two motifs. when we randomly choose k and λ from  <cit>  and compute sig + sig, we find that it almost exactly equals sig . when we generalize the experiment to vary k and λ between the two terms, we find sig ≤ sig + sig. thus, it appears that sig + sig bounds sig and that this bound is extremely tight when k <dig> ≈ k <dig> and λ <dig> ≈ λ <dig>  this bound also holds when known motifs and regulons taken from the scpd database  <cit>  that differ by one mismatch are merged . a proof of this bound is given in methods.

validation of hill climbing algorithm
in order to leverage the bounded sig in a practical context, we developed an algorithm capable of generalizing the degree of overrepresentation of composite motifs from a single instantiation. this algorithm, referred to as the hill climbing algorithm and described in methods, attempts to generalize a single non-degenerate motif by exploring the space of motifs that differ by one mismatch from the original motif, and iteratively adding those motifs that maximally improve the sig score. thus, given a single, non-degenerate motif m, hc returns a high-scoring degenerate  motif of any number of instantiations.

in order to validate the hill climbing algorithm in a biological context, we tested the algorithm against the set of s. cerevisiae regulons defined in the scpd database  <cit> . for each regulon with experimentally verified binding sites, we ran the hill climbing algorithm on each binding site, comparing it with the resulting composite motif via the Φ score metric  <cit> . the Φ score of a motif measures the nucleotide-level overlap between the sites in a regulon that a motif matches and the scpd reported binding sites. if the hill climbing algorithm improved the description of the binding sites, this would be reflected in an increase in the Φ scores.

identifying motifs ab initio
as shown in the previous section, given a single non-degenerate instantiation of a biologically relevant motif, the hill climbing algorithm is capable of returning a composite motif that is a more accurate descriptor of the experimentally determined binding sites. of course, in practical motif-finding situations, this non-degenerate instantiation is not available to the algorithm. however, theorem  <dig> states that a composite motif with n instantiations and sig score σ must include at least one instantiation with sig score at least σ/n. thus, if we are searching for a highly overrepresented degenerate motif, it is reasonable to start with a list of overrepresented, non-degenerate motifs, each of which is used as a seed from which to begin our search.

we therefore performed the following experiment to determine the practical benefit of the hill climbing algorithm in the ab initio discovery of degenerate motifs of variable length. we identified candidate motifs for each regulon, using the oligo-analysis tool from the regulatory sequence analysis tools website   <cit> . rsat was set to identify the  <dig> most significant hexamers, then to assemble textually related hexamers into longer motifs. each motif reported by rsat was run separately on the hill climbing algorithm, resulting in a set of degenerate motifs. all motifs reported by rsat were scored for their overlap with the biologically relevant list of binding sites via the Φ score metric. these Φ scores were compared against the Φ scores obtained from the motifs generated by the hill climbing algorithm  and  in table 2). after sinha and tompa  <cit> , the Φ score for a regulon is computed by sorting the reported motifs by sig, then reporting the highest Φ score from the top  <dig> motifs.

the top  <dig> motifs are examined to account for the possibility that unknown binding sites may exist in these sequences. surprisingly, while hc improves the performance of rsat on two regulons, on average, the output of hc decreased the average Φ score by 9% . one possible explanation for this is that rsat finds small fragments of binding sites that, when generalized, include a high number of false positives. this is supported by the observation that the average ΔΦ for those regulons in which the highest scoring motif is a hexamer is - <dig> , while the average ΔΦ for those regulons in which the highest scoring motif is longer than  <dig> bases is + <dig> . this may be due to the method rsat uses to identify motifs longer than  <dig> bases. in order for such a motif to be reported, a strong linearity assumption is made: both the 6-base prefix and the 6-base suffix must be among the most overrepresented hexamers. conversely, if any two overrepresented hexamers overlap textually, they will be combined to yield a long motif, regardless of the degree of overrepresentation of the longer motif. this assumption is likely to be violated in practice. to address this, we developed a motif finder specifically aimed at non-degenerate motifs. this algorithm, called beam, employs a linearity assumption that is broadly similar to the bound used by the hill climbing algorithm to aggressively limit the search space of motifs. using a bounded breadth-first  search, beam first enumerates all motifs of length  <dig>  then iteratively expands each motif in either direction by concatenating a single nucleotide at either end. in each iteration, beam computes the sig score of each motif, then expands only the highest scoring motifs. the linearity assumptions and error bounds for the beam algorithm were previously explored, and the algorithm was shown to be efficient with bounded error  <cit> . in brief, iteratively expanding motifs works because overrepresented strings are likely to contain overrepresented substrings. thus, the space of all unambiguous motifs can be efficiently searched by iteratively expanding the most overrepresented motifs. the  <dig> highest scoring motifs returned by beam were used as input to the hc algorithm.

when run alone, beam performs comparably to rsat on these regulons. however, computing hc on each motif reported by beam yields a 15% improvement over rsat . for ease of discussion, we named the program that results in running the hill climbing algorithm on the results of beam prism . comparing prism and rsat directly on each regulon reveals that prism clearly outperforms rsat on  <dig> of  <dig> regulons where one program outperforms the other by at least  <dig>  .

to place prism's performance in context, we ran prism, rsat, and eight other popular motif finders on all  <dig> s. cerevisiae regulons from the scpd for which binding sites have been experimentally characterized 2cys <dig> family of transcription factors, which bind dna as homodimers with gapped cores). all programs were run from their web servers with default values selected. where the option was offered, an s. cerevisiae background model was specified. prism has no adjustable parameters, and hence was not specifically optimized for performance on this dataset. the results are summarized in table  <dig> in the format used in sinha and tompa  <cit> . on average, prism scores higher than all other programs and, with rsat and ymf, has the highest number of regulons for which a recognizable portion of the binding sites were discovered . in head-to-head comparisons between prism and the other programs, prism had 81% of clear wins. prism has near-complete descriptions of more cis-regulatory elements than any other program, as measured by the number of regulons for which prism's Φ score was at least  <dig> .

evaluating prism in the presence of noise
input sequences for motif-finding programs typically consist of a set of coordinately expressed genes derived from microarray data. parallel regulation and rapid serial response of downstream genes are both capable of generating coordinated expression patterns in the absence of coordinate regulation. in addition, errors in clustering may lead to the inclusion of extraneous upstream sequences.

to test the robustness of prism to increasing levels of extraneous upstream sequences in the dataset, we performed the following experiment on five randomly selected regulons. for each regulon, we added a number of randomly selected upstream regions, corresponding to  <dig> ,  <dig>   <dig> and  <dig> times the number of sequences in the original regulon. we ran prism on each of these data points and assessed its accuracy using the Φ score metric. the results are summarized in figure  <dig>  as can be seen, prism is robust in the presence of extraneous genes. in the presence of twice as many extraneous upstream sequences as real ones, the average Φ decreases from  <dig>  to  <dig> . prism's robustness in the face of noisy gene sets makes it a practical solution for motif-finding from microarray experiments.

as a separate test, we looked at prism's performance in the presence of randomly selected gene sets with no coregulated genes present. to test this, randomly selected genes were assembled into regulons of size  <dig>   <dig>   <dig> and  <dig> . prism was run on these regulons, and the sig score of the top-scoring motif was reported. the results were compared to the sig scores obtained on the scpd regulons. the mean sig score from the random regulons was  <dig>  while the mean sig score of the scpd regulons was  <dig>  58% of the scpd regulons and 10% of the randomly generated regulons had a sig score of  <dig> or above, .

creating sequence logos from degenerate consensus motifs
our results suggest that, for s. cerevisiae regulons, using the consensus model to arrive at degenerate motifs is more accurate than using a position weight matrix for the same purpose. of the motif-finding programs tested, alignace, motifsampler, bioprospector, meme and consensus all use position weight matrices, and all were outperformed by all three consensus programs . these results are broadly consistent with other performance comparisons  <cit> . however, the representational power of the final output may be improved somewhat by converting the consensus sequences into position weight matrices based on the sequences in the regulon that match the consensus. figure  <dig> compares the predicted sequence logos from  <dig> regulons  to the sequence logos from the binding sites as reported by scpd. we also generated predictions for four transcription factors whose binding sites have not yet been experimentally characterized. the regulons for these transcription factors were identified from data generated using chromatin immunoprecipitation   <cit> . we selected regulons where all regulator-gene interactions had a p-value of at most  <dig>  in the chip analysis and were confirmed by gene-specific pcr.

using prism to generate hypotheses
we now show that prism is capable of generating directly testable mechanistic hypotheses. as an example, it is known that the transition from g <dig> to s-phase during the yeast cell cycle is dependent on two heterodimeric complexes, sbf  and mbf . these complexes have the same regulatory subunit swi <dig>  but have unique dna-binding proteins, swi <dig> and mbp <dig> respectively  <cit> . these two proteins share 50% identity in their dna-binding domains, and there is a 31% overlap between the in vivo targets of mbf and sbf, as determined by chip data  <cit> . however, at the nucleotide level, the Φ score for the scb and mcb cis-regulatory elements is only  <dig> . clearly, the functional overlap between these genes is greater than the overlap at the nucleotide level of their binding sites.

one possible explanation for this apparent contradiction is the involvement of a third protein. a likely candidate for mediating the functional overlap is stb <dig>  a swi6-associated protein that has been shown to be involved in the transcriptional regulation of g <dig> to s-phase transition  <cit> . in order to address the potential role of stb <dig> in mbf- and sbf-mediated transcription, we used prism to look for overrepresented motifs upstream of genes that were identified as being bound by stb <dig>  <cit> . the cis-regulatory element identified by prism  for stb <dig> overlaps the mbf binding sites with a Φ score of  <dig> , and overlaps sbf binding site with a Φ score of  <dig> . thus, it is possible that stbl mediates the functional overlap between mbf and sbf. the association of stb <dig> with swi <dig>  a common subunit of both sbf and mbf, supports this hypothesis.

discussion
we have shown that the degree of statistical overrepresentation of a degenerate motif is bounded by the sum of the degree of overrepresentation of its non-degenerate instantiations. this deceptively simple relationship sets a lower bound on the sig score of the most overrepresented instantiation of a highly degenerate motif, since overrepresented motifs will possess one or more instantiations that are themselves overrepresented, albeit to a lesser degree. prism leverages this bound to provide a rapid, effective means of identifying highly degenerate overrepresented motifs, starting from non-degenerate motifs. while we have demonstrated prism on co-regulated sets of genes, it is relatively straight forward to apply the bound for phylogenetic footprinting, an orthogonal approach to motif finding that leverages the evolutionary conservation of transcription factor binding sites  <cit> .

comparing the performance of prism to motif finders based on other motif models reveals a consistent pattern. on this dataset, using the Φ score metric, prism outperforms pwm-based motif finding programs  by large margins, ranging from  <dig> to 200%. on the other hand, the difference between prism and programs based on word counting  is much smaller, ranging from  <dig> to 30%. in general, motif finders perform best on synthetic data generated according to their motif model  <cit> . thus, this observation provides some hints at the mechanism of the underlying dna-protein interaction: if the free energy of binding of a protein to a cis-regulatory element is very tightly correlated with the additive overrepresentation of each position, programs based on word counting would be expected to perform poorly compared to programs based on the more flexible pwm-based search, which emphasizes position independence. this is because pwm search algorithms can directly optimize the contributions of individual bases even in the absence of overrepresented words that connect adjacent positions. thus, prism's superior performance relative to pwm-based programs may be indicative of the limitations of the additivity assumption inherent in pwms and their optimization algorithms. these limitations are demonstrated by experimental results that suggest that the simple additivity assumption in protein-dna binding encoded in the pwm is little more than a first approximation  <cit> . a number of groups have extracted common principles to identify underlying mechanisms in protein-dna recognition from the solved structures of protein-dna cocrystals, which contain hundreds of examples of binding contacts. these analyses have demonstrated that interactions often occur between multiple dna bases and amino acid side chains. for instance, the widespread zif268-like zinc finger transcription factors consist of three domains, each of which recognizes overlapping trinucleotides  <cit> . in this case the protein-dna contacts are clearly neither position independent, nor additive. a broad study of protein-dna binding contacts has shown that, although the chemical properties of the base-amino acid contacts might be additive and position-independent in some cases, the same is not true for the stereochemical effects of adjacent residues on a dna double helix  <cit> .

not surprisingly, models of protein-dna binding that include position dependent effects more accurately model the true binding sites of a transcription factor than do simple pwms, though at the expense of more free parameters  <cit> . our solution to this problem is to use the pwm representation in the final output, but to restrict the independence assumption by using a word-based search strategy that assumes the presence of overrepresented instantiations. the experimental results validate this decision. there is a second potential explanation for the performance difference between pwm-based programs and consensus-based programs on this dataset. pwms search a much larger parameter space than consensus models, as each position has three free parameters , each of which is a real number between  <dig> and  <dig>  in contrast, every position in a consensus model is represented with one parameter, which can take on one of  <dig> values. thus, employing a position weight matrix representation during the motif search frames the problem in more complex terms than employing a consensus representation. this added complexity leads to search strategies that are more prone to local maxima and that often over fit to include noise when learning novel cis-regulatory elements that occur only a handful of times in the group. for instance, gibbs sampler  is very sensitive to noise. the dilution of ten target sequences containing a planted motif with five random sequences reduces the accuracy of gibbs sampler from 90% to 30%  <cit> . motifsampler, a derivative of gibbs sampler, does not perform well on the scpd datasets.

although prism outperforms the other programs by a substantial margin on this randomly selected dataset from s. cerevisiae , it is formally possible that a performance comparison on other datasets will lead to a different result. since motif finders are classifiers, the "no free lunch" theorem of machine learning states that, for any given motif finder, there must exist a dataset for which that motif finder outperforms prism  <cit> . however, such datasets that are also biologically relevant may be rare, as evidenced by the small number of clear losses. since our test set was fairly large , we believe that the results reported here will generalize to most yeast regulons. we wish to emphasize that the dataset  presented here have been used in previous published performance comparisons  <cit> . it is also interesting to note that our comparison of ten motif-finding programs on  <dig> regulons is larger than any previously published comparison of motif finders except tompa et al.  <cit> , which takes a philosophically different approach.

we wish to place special emphasis on the fact that our algorithm has no nuisance parameters. this is significant as it makes prism robust to use by non-experts and enables blind testing to be performed in a fair way on regulons with known binding sites. it is circular to attempt to tune the parameters of motif-finding programs in tests involving ab initio motif discovery, unless the tuning is performed on a separate training set of data. to our knowledge, there has been no publication to date involving motif-finding programs with tunable parameters that demonstrates error rates on separate training and test sets. in some cases, performance comparisons have been performed with methods tuned for optimal performance on each individual regulon, clearly violating notions of circularity and overfitting  <cit> . thus, the generalizability of tunable parameters in the field of motif-finding remains an open question. we have assumed that the web-based interfaces of the other programs tested here contain reasonable parameter estimates for a naive user interested in motif finding. the fact that prism has no tunable parameters enables a fair comparison to be made. however, we acknowledge that it may be possible for expert users running the other programs to obtain higher scores than were obtained here. such improved performance would best be demonstrated in a rigorous resampling framework.

the chief limitation of the algorithm presented here is that it is not likely to work for cis-regulatory elements that contain widely spaced critical residues. an example of this is the zn2cys <dig> binuclear cluster transcription factor family in yeast and other fungi . the binding sites of members of this family consist of two sets of critical residues separated by a long spacer region. we are developing a separate algorithmic approach to this problem that leverages the bound shown here .

finally, the bound stated in theorem  <dig> holds for all -transformed probability distributions. while overrepresentation has proved to be a useful approximation to biological significance, it clearly has its limitations, as evidenced by the regulons for which all the tested motif finders failed to find a plausible match. by dramatically reducing the search space, we anticipate that prism, like its predecessor beam  <cit> , will be able to leverage complex statistical measures that more closely approximate biological significance. we are currently exploring such metrics.

CONCLUSIONS
we have shown that the statistical overrepresentation of a collection of binding sites is bounded by the sum of the overrepresentation of each distinct sequence. this bound lead to a simple hill climbing algorithm, which we showed outperforms a wide variety of commonly used motif finding programs. prism's success highlights the limitations of assuming independence between nucleotide positions and supports the growing body of evidence that protein-dna binding is best modeled when dependencies are considered. in this light, prism's main contribution is the demonstration that a simple linear approach can account for potential dependencies and can identify a likely set of binding sites from which more descriptive models can be inferred. while the prism method is limited in its generality, as it cannot handle gapped binding sites, the theorem proved here is guiding the algorithmic development of a program that identifies such binding sites.

