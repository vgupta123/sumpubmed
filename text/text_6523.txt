BACKGROUND
the dysregulation of the human metabolism is closely related to human diseases. many human diseases are metabolic diseases, which are directly caused by a deficiency of metabolic enzymes and the subsequent accumulation of toxic substances or the lack of essential metabolites. many common diseases such as cardiovascular disease, cancer and diabetes are related to a malfunction of the human metabolism. the statistics from omim show that around 23% of the metabolic genes are disease-related genes and more than 48% of the metabolic reactions are affected by disease-related genes  <cit> . the emergence of metabolic diseases has stimulated research in human metabolism and its regulation to discover the mechanism of drug-target interactions. enzymes catalyze reactions, which produce metabolites in the metabolic network of an organism. enzyme malfunctions can cause the accumulation of certain compounds that may result in diseases. in fact, many enzymes have already been selected as drug targets  <cit> . an effective drug may target the enzymes to recover the concentration of signal metabolites that are in abnormal states. thus, it is important for drug development to identify more enzyme targets.

recently, significant work has been gradually done to reconstruct human genome-scale metabolic network, which provides a unified platform to integrate the experimental data for genes, proteins, drugs, drug targets, metabolites and metabolic reactions in the same system for the study of human metabolism and the identification of novel drug targets. currently there are two high quality human metabolic networks developed independently: ehmn reconstructed by ma et al.  <cit>  and human recon  <dig> reconstructed by duarte et al.  <cit> . note that human recon  <dig> has been adapted for flux analysis while ehmn has not. in our study, we use human recon  <dig> since our method is based on flux analysis. a metabolic network consists of three parts of metabolic information: 1) stoichiometry; 2) the relationships between enzymes and metabolic reactions; and 3) flux capability of each metabolic reaction. stoichiometry provides the quantitative relationships between reactants and products for all metabolic reactions, and the relationships between enzymes and metabolic reactions identify enzymes that catalyze each reaction. in the human recon  <dig> metabolic network,  <dig>  of the total  <dig> metabolic reactions are catalyzed by enzymes, which we call enzymatic reactions.

one traditional approach to analyze a metabolic network is constraint-based flux distribution prediction, which employs stoichiometric, thermodynamic, flux capability and other constraints to determine the space of flux distributions. one commonly used constraint-based approach is flux balance analysis , which utilizes stoichiometries to predict a network's ability to produce pseudo-steady state conditions <cit> . recently, shlomi et al.  <cit>  proposed a computational constraint-based method for systematically predicting human tissue-specific metabolic behavior in ten human normal tissues by integrating the human metabolic network with tissue-specific gene and protein-expression data. although their work was focused on gene activity prediction in a specific tissue, their method provided a way to connect the states of metabolic reactions in the metabolic network with specific cellular environments. this motivates us to profile each metabolic reaction by analyzing its fluxes in different cellular environments such as nci- <dig> cancer cell lines. thus, each reaction can be represented as its reaction fluxes in the different cells. this is the reaction representation method what we call reaction profiling. by this method, we can construct the flux similarity between the reactions and then further use the machine learning methods to analyze their properties in the metabolic network.

a promising approach in drug target discovery involves the integration of available biomedical data through mathematical modeling and data mining. significant work  <cit>  has been done on drug discovery by integrating different data sources including gene expression data, protein sequence, mass spectrum, chemical structure, drug response and side effects. however, few papers discussed the integration of these data with the human metabolic network. almaas et al.  <cit>  applied flux-balance analysis to identify a set of metabolic reactions forming a connected metabolic core and found that the enzymes catalyzing the core reactions display a considerable higher fraction of phenotypic essentiality and evolutionary conservation than those catalyzing noncore reactions. this implies the importance of understanding the properties of metabolic reactions. they also found that most current antibiotics interfering bacterial metabolism target the core enzymes and implied that metabolic reactions play an important role in drug-target discovery. sridhar et al.  <cit>  formulated an optimal enzyme combination identification problem on metabolic networks, but the focus was to select a subset of enzymes that can reduce the amount abnormally accumulated metabolites. in this paper, we proposed a supervised method by integrating the human metabolic network and gene expression to predict new related reactions for old drugs. we first constructed several similarity measurements for enzymatic reactions , and then applied machine learning approaches to predict novel drug-reaction interactions based on their known interactions, which are obtained from known drug-target interactions. we also constructed a drug-reaction network  based on these known interactions to get a deeper understanding of the influences of drugs on the metabolic network. thus our drug-target prediction procedure is mainly that we first did reaction profiling and meanwhile extracted known drug-reaction interactions, and then used machine learning approaches to predict new drug-reaction interactions. there are two innovations in our method. the first is that we constructed the drn and predicted drug targets by predicting the interactions between drugs and metabolic reactions. drugs are considered to influence several enzymatic reactions, since they can interact with enzymatic reactions through their targets as enzymes. thus, a bipartite network between drugs and enzymatic metabolic reactions  can be constructed. this network shows the influences of drugs on the metabolic reactions and the metabolic pathways from a global view. the second innovation of our method is the new concept of reaction profiling for each metabolic reaction and the new measurement for reaction similarity in the context of a specific disease, such as cancer. by this method, each reaction can be represented quantitatively as its flux states in nci- <dig> cell lines, and thus computational models can be used to predict novel drug-reaction interactions for cancer drugs, which leads to the discovery of their novel drug targets. we also further improve the performance by integrating target sequence data with the reaction profiling, and the results show the synergism of structural similarity and functional similarity between reactions for drug reaction/target interaction prediction.

methods
data and softwares
the genome-scale human metabolic network reconstructed by duarte et al. <cit>  consists of  <dig> metabolites,  <dig> reactions and  <dig> genes. we downloaded the data from the bigg database http://bigg.ucsd.edu/. the cobra toolbox  <cit>  developed by palsson's group was then used to parse the data. gene expression data  in nci- <dig> cell lines conducted by shankavaram et al.  <cit>  was downloaded from nci website. in fact, only  <dig> cell lines have available gene expression data. we also downloaded protein sequence data from kegg database  <cit> , and computed the protein sequence similarities using smith-waterman method by matlab. drug-target association data was downloaded from drugbank. in the process of constraint-based flux analysis, we used the freely available software, glpk solver, to solve lp/milp problems. in the following subsections, we will discuss the details of the two models: the linear programming  model for flux analysis and the kernel knn model for drug-reaction interaction prediction.

linear programming model for flux analysis in nci- <dig> cell lines
a network-based method is proposed by shlomi et al.  <cit>  to predict human tissue-specific metabolic behavior in ten tissues by integrating tissue-specific gene and protein expression data with the global human metabolic network, and their work reveals a central role for post-transcriptional regulation in shaping tissue-specific metabolic activity profiles. this inspires us to analyze cell line-specific metabolism based on gene expression data in nci- <dig> cancer cell lines. by integrating the metabolic network and the cell line-specific gene expression, we can predict reaction flux and activity for all the reactions in each cell line by our proposed linear programming model. thus, each metabolic reaction in the metabolic network has  <dig> flux levels in  <dig> cell lines. reaction profiling is the procedure to represent each reaction as its flux values in nci- <dig> cell lines.

for a specific cell line, we first identify highly/lowly expressed genes based on the gene expression data in this cell line. then for each metabolic reaction, if one of its enzyme genes is highly expressed, the reaction is considered as highly expressed. if all of its enzyme genes are lowly expressed or undetermined, the reaction is considered as lowly expressed or undetermined, respectively. the boolean gene-to-reaction mapping can be obtained from the metabolic network model. thus, based on the expression states of the corresponding genes, all the reactions are classified into a highly expressed subset rh, a lowly expressed subset rl and an undetermined subset. we revised shlomi's mixed integer linear programming  model to a linear programming  model by relaxing the integer variables yi+ and yi- to be continuous. the reasons for the relaxation are twofold. first, the relaxation allows the activity score of reactions to be continuous rather than binary value, which is more reasonable and flexible. second, lp model is much easier to handle than milp model. the lp model is presented as follows:

s.t.

where v is the flux vector in the considered specific cell line for all reactions, s is the stoichiometric matrix obtained from the metabolic network, and ε is a flux threshold. the flux threshold is to control the distribution of the likelihoods yi+ and yi- from the constraints of  and . a highly expressed reaction is considered to be more likely to be active if it carries a significant positive flux that is greater than a positive threshold ε or a significant negative flux < -ε. lowly expressed reactions are considered to be more likely to be inactive if they carry almost zero metabolic flux. flux threshold ε =  <dig> is used throughout the experimental analysis although its changes did not make a big difference in the results. for a highly expressed reaction i, yi+ and yi- are the likelihood that reaction i is active in either direction. their closeness to one means i is likely to be active, while the closeness to zero means it is likely to be inactive. for a lowly expressed reaction i, yi+ represents the likelihood that it is inactive. we first apply lp model in each of nci- <dig> cancer cell lines to predict flux distribution for all the metabolic reactions, and then, we can obtain for each reaction its flux profile in these  <dig> cancer cell lines.

reaction flux similarity
we denote the set of considered reactions as r, and define Γrdr and Γrer as follows: Γrdr/rer = { ∈ r × r| i, j are associated with same drugs/enzymes}. Γrdr includes all reaction pairs that are associated with the same drugs, while Γrer includes all reaction pairs associated with the same enzymes. based on any reaction similarity metric s, we can define the conditional probability:

where |s| is the number of elements in set s, and s is the similarity between reaction i and j. pe is defined in the same way. pd/pe are conditional probabilities that a pair of reactions share the same drugs/enzymes if their similarity score is larger than t. an ideal similarity metric s makes pairs of reactions with larger similarity score share the same drugs/enzyme with higher probability. this means the s-based conditional probabilities pd/pe should be increasing functions of t.

we now define a similarity metric based on reaction flux profiles and then check whether it's a possible ideal metric. the flux of reaction i in jth cell line, fij, can be obtained from the optimal solution v of the above linear programming model for jth cell line. we represent the profile for reaction i as fi = t. each reaction is thus profiled using its  <dig> flux values in nci- <dig> cell lines, and can be considered as a data point in 59-dimensional flux feature space. we use cosine similarity  of reaction flux profiles to measure the similarity among metabolic reactions: . this is called reaction flux  similarity between reaction i and j. it turns out in the results section that, srf-based probabilities pd/pe are increasing with t, thus the similarity metric srf is likely to be an ideal metric for drug-reaction interaction prediction.

reaction structure similarity
denote the set of target enzymes for reaction i by mi. target sequence  similarity for protein s and t is denoted by sts  . then the reaction similarity for reaction i and j based on target sequence is defined as the maximum, average or minimum of all the possible enzyme target sequence similarities , , and . for simplicity, this is called reaction structure  similarity srs since it is defined based on enzyme targets' structure.

srf measures the functional similarities among reactions, while srs measures their similarity based on enzyme targets' structural information. the integration of srf and srs may provide an optimal measurement. thus we define a new reaction similarity sr as the weighted sum of reaction flux similarity and reaction structure similarity: sr =λsrf  +  srs for any reaction i and j.

kernel knn model
for a specific drug, we can obtain its true interactions with m reactions from known drug-target interactions. we aim to predict whether a new metabolic reaction interacts with the drug or not. here we propose a kernel knn  method for this binary classification problem using the similarities between reactions. we denote xi =  <dig> if the drug has interaction with the reaction i, xi =  <dig> otherwise, for i =  <dig> ...,m. then, for a new metabolic reaction, we predict its interaction with all drugs as , where s is a reaction similarity metric, s represents the similarity between the new reaction and reaction i and n{k} is the set of k reactions nearest to the new reaction under the meaning of the metric s. s can be srf, srs or their integration sr. here xnew is called the association score of the new reaction and the specific drug. higher association score indicates a higher probability of the reaction interacting with the drug. kernel knn is a kernel version of knn classification method. note we still call this model as kernel knn method even if s may not be positive semi-definite. both knn and kernel knn classify a new point simply through its nearest neighborhood. however, kernel knn considers the weight of voting from different individuals in the neighborhood.

RESULTS
drug-reaction network construction
the flow chart of the whole task of drug reaction/target prediction using reaction flux similarity is shown in figure  <dig>  this task involves four stages including flux analysis, reaction profiling, drug-reaction interaction prediction and drug-target prediction. in the first stage, metabolic reactions in the metabolic network are first classified as highly or lowly expressed based on the expression levels of the genes which encode the enzymes catalyzing the reactions. integrating the classified reactions with metabolic stoichiometry, the lp model is used to predict the flux distribution for metabolic reactions in the different cellular environments of  <dig> cancer cell lines. after generating reaction profiles in stage two by putting reaction fluxes of  <dig> cell lines together, reaction flux similarity is constructed to measure the similarities among reactions functionally. with reaction flux similarity and their known interactions with drugs, stage three applies the proposed kernel knn model to predict novel drug-reaction interactions. the last stage is to obtain novel drug targets using the hints from drug-reaction interactions. in this section, we discussed how to construct the drug-reaction network based on the known drug-target interactions, and then reported some results from the analysis of this network.

although relationships between drugs and targets have been depicted in a global view  <cit> , the relationship between drug and enzymatic reactions remains uncharacterized. the effect of a drug on human metabolism takes place through its target protein, which, as an enzyme, can catalyze its corresponding metabolic reactions directly. thus, if any target of a drug catalyzes a reaction as an enzyme, the drug can interact with the reaction through the enzyme target and the reaction is considered to be a target reaction of the drug. an illustrative example is shown in figure  <dig>  the green circle, yellow rectangle and red triangle represent drug, protein and reaction, respectively. black edges and green edges indicate drug-target relationships and reaction-enzyme relationships. we consider two approved anti-cancer drugs db <dig>  and db <dig> . from the figure  <dig>  we can see that db <dig> interacts with reaction r_dhord <dig> through the enzyme target dhodh, and db <dig> interacts with r_alox <dig> through the enzyme target alox <dig>  both drugs interact with r_alox <dig> and r_al0x <dig> through alox <dig>  the blue solid edge between two reactions in figure  <dig> indicates that two reactions interact with the same drug through different enzyme targets, while the blue dashed edge means that two reactions interact with the same drug through the same enzyme targets.

we constructed a drug-reaction network  to depict the interactions between the approved drugs and metabolic reactions. we used cytoscape  <cit>  to show the network in figure  <dig>  the nodes in drn include drugs and enzymatic reactions, and the edges between drugs and reactions indicate their interactions. two kinds of data are required to construct this bipartite graph: drug-target interaction data, which was obtained from the drugbank  <cit>  database, and gene-to-reaction mapping data, which was obtained from metabolic network human recon  <dig> reconstructed by duarte et al.  <cit> . all drug-reaction interactions and the corresponding enzyme targets are listed in additional file  <dig>  table s <dig>  the resulting drug-reaction network includes  <dig>  of  <dig> whole approved drugs,  <dig>  of  <dig> enzymatic metabolic reactions,  <dig> enzyme targets and  <dig> interactions between drugs and reactions. figure  <dig> shows the degree distribution in drn. we report the numbers of nodes  with different degrees from  <dig> to  <dig>  which are the network degree distribution, reaction degree distribution and drug degree distribution, respectively. there are 80% of the drugs and 95% of the reactions in drn with a degree less than  <dig>  maximal degree of the drugs and reactions are  <dig> and  <dig>  respectively.

we also colored all the drug nodes in figure  <dig> according to the anatomical therapeutic chemical  classification of drugs. detailed classification information for each drug and statistics in drn is shown in additional file  <dig>  table s <dig> and table s <dig>  respectively). we found that around half of the approved drugs in drn are for metabolic diseases, cardiovascular diseases and antineoplastic drugs. this implies that among all  <dig> classes of drugs, these three classes are related to metabolic network most closely. we also found that drn has  <dig>  approved drugs for musculoskeletal diseases,  <dig>  approved drugs for cardiovascular diseases,  <dig>  approved metabolism drugs,  <dig>  approved drugs for blood diseases and  <dig>  approved antineoplastic drugs. large percentage of these drugs in drn shows that it may be a good way through drn to get deep understanding of the mechanism of these drugs. particularly, for metabolism drugs, we found that targets of the remaining are related to metabolism by their own specific protein function, but not by catalyzing metabolic reactions as an enzyme, thus this part of metabolism drugs are not involved in drn. in order to illustrate which pathways the drugs interact with, we also colored metabolic reactions according to their pathways. the most frequent pathway in drn is transport.  <dig> metabolic reactions of total  <dig> reactions in drn are related to transport pathways. note that in the bigg database, there are six types of transport pathways: lysosomal transport, mitochondrial transport, endoplasmic reticular transport, extracellular transport, nuclear transport and golgi apparatus transport. for simplicity, we combine all these six transport pathways to one pathway as transport in figure  <dig>  the less frequent pathways are carnitine shuttle , keratan sulfate , folate metabolism , tyrosine metabolism , nucleotides  and steroid metabolism . thus, figure  <dig> illustrates not only the interactions between the cancer drugs and enzymatic reactions, but also the pathways each drug interacts with.

from figure  <dig>  we can see that the resulting network is naturally clustered by major therapeutic classes and major pathways, although drn layout is generated without the knowledge of drug classes and reaction classes. the clustering of drugs may be mainly because they have the same targets. the most obvious cluster of drugs is the tightly connected drugs for the nervous system. antineoplastic drugs, drugs for blood diseases, metabolic diseases, cardiovascular diseases, respiratory diseases and musculoskeletal diseases are also clustered together, although less distinct than the cluster of drugs for nervous system. reactions are clustered less obviously than drugs. the most obvious cluster of metabolic reactions is reactions related to folate metabolism and vitamin metabolism. further observation from figure  <dig> is the relationship between drug classes and reaction pathways. most of the neurological drugs, blood drugs and cardiovascular drugs are connected with transport reactions. many cancer drugs and some of cardiovascular drugs are related to the nucleotides reactions.

reaction profiling
reaction profiling we propose here is a method to quantify metabolic reactions. using this method, the profile for each metabolic reaction is identified by its flux states in different cellular environments. compared with the traditional equation representation of metabolic reaction, this new representation makes quantitative analysis of reactions obviously easier. in each of nci- <dig> cell lines, lp model was used to predict metabolic flux distribution for all the metabolic reactions based on gene expression data in the cell line. thus, each metabolic reaction was only designated one profile as its signature, which was used to quantitatively measure the similarity among reactions and thereby for prediction of novel drug-reaction interactions. we only focused on enzymatic reactions since only enzymatic reactions have direct interaction with drugs through enzymes. around  <dig> of total  <dig> metabolic reactions in the human metabolic network can be catalyzed by enzymes. some of the enzymes in metabolic network have been identified as drug targets. among the  <dig> enzymatic reactions in drn, the flux analysis shows that  <dig> reactions are inactive  in nci- <dig> cancer cell lines. we only consider  <dig> reactions that are active in at least one cancer cell line. we report, in figure  <dig>  the heat map of these reaction profiles using cosine similarity and complete linkage algorithm. red and green indicates different directions of metabolic reactions, while black indicates a flux value very close to zero. from the figure, we can see that both the enzymatic reactions and cancer cell lines cluster as two major groups. especially, for enzymatic reactions, one group involves reactions with many positive fluxes , while the other group involves reactions with many negative fluxes . note that very few differences between cell lines can be seen in some metabolic reactions, which may be due to the common biological properties of cancer cell lines, for example, uncontrolled growth, invasion, and sometimes metastasis. although the two groups of cell lines are not as distinct as reactions due to these common properties, they may imply further study for these cancer cell lines.

to understand more about the relationship between reactions, enzyme targets, and drugs, we listed a table  with reaction pairs in drn that share the same associated drugs, their reaction flux similarity scores, their common enzymes, and their common associated drugs. different reactions can interact with the same drugs in two ways. one is through the same enzymes, while the other is through different enzymes that are targets of the same drugs. denote the set of the  <dig> considered reactions as r. the analysis shows that  <dig> pairs of reactions Γrdr share the same drugs while  <dig> pairs  share the same enzymes.  is defined to represent the percentage of reaction pairs that are associated with the same drugs through the same enzyme targets. β = 670/ <dig> =  <dig>  indicates that around 18% reaction pairs interact with the same drugs because they are catalyzed by common enzyme targets, while the remaining 72% pairs interact with the same drugs through different enzyme targets. we also found that if reaction flux similarity is larger than  <dig> , more than 50% of reactions interact with same drugs through the same enzymes. figure 6a shows β increases as the cutoff value of reaction flux similarity increases. this means that if the reactions are more similar, they are more likely to interact with same drugs through same enzymes rather than through different enzyme targets.

drug-target interaction prediction by reaction flux similarity
we used two kinds of information for drug target prediction: 1) target similarity and 2) known drug-target interactions. machine learning algorithms were first used to predict drug-reaction interactions, which then lead to novel drug-target interactions. the basic assumption is that if a drug is predicted to interact with a reaction, the enzyme catalyzing the reaction is likely to be the target of the drug. for the metabolic reactions, the constraint-based flux analysis in nci- <dig> cell lines were first applied to obtain reaction profiles. reaction flux similarity is then defined as the cosine similarity among reaction flux vectors. all the known drug-reaction interactions are obtained from the drugbank database. since we represent each metabolic reaction based on nci- <dig> cancer cell lines, we focused on  <dig> cancer drugs in drn to perform cross validation of the prediction method. we eliminated the reactions that have inactive flux states  in all the  <dig> cell lines. training set includes  <dig> metabolic reactions. we denote this dataset as set-i, which contains  <dig> cancer drugs,  <dig> metabolic reactions in drn and their ground truth interactions. we also generated the dataset, set-ii, which includes  <dig> cancer drugs, available expression in nci- <dig> for genes encoding  <dig> targets and their ground truth interactions. set-i was used to predict drug targets through target reaction classification based on target reaction similarity, while set-ii was through target gene classification based on target gene similarity. in the process of classification, both proteins and reactions are considered as drug targets.

different classification methods were performed on both set-i and set-ii, such as nearest profile, bipartite graph model  <cit> , support vector machine , k-nearest neighbor  and kernel knn. nearest profile simply assigns new target to the drug class labels of its nearest neighbor. bipartite graph model first measures the similarity among all nodes in the bipartite network by their shortest paths, then maps all the nodes into a common space preserving the distances among all nodes. a new reaction target is mapped to the common space first, and then correlation with all drugs is calculated. large correlation indicates high probability of drug-target interaction. for svm, we used a radial basis function  as kernel.

integration with target sequence data
in figure  <dig> we report the prediction performances of the three reaction structure similarities  and  using kernel knn method. we can see that among the three similarity measurements,  performs the best. we then further evaluated the prediction performance by integrating reaction flux profiles with target sequence. figure  <dig> reports the prediction accuracy of kernel knn method using the integrated reaction similarity sr = λsrf + srs, where . we performed  <dig> times 10-fold cross validation of kernel knn for each combination of k =  <dig> ~  <dig> and λ =  <dig> . <dig> . <dig> ..., <dig>  where k is the parameter in kernel knn method and λ is the weighting of reaction flux similarity mentioned in the section of methods. figure 8a is a heat map for all the mean aucs by corresponding k and λ. it shows that the maximum prediction accuracy is obtained around k =  <dig> and λ = <dig>  ~  <dig> . in fact, the best auc can reach  <dig>  and the worst auc is around  <dig> . figure 8b further plots the λ-paths of the heat map. when λ =  <dig>  only enzyme target sequence is used for classification, while when λ =  <dig>  only reaction flux profile is used. from the figure of λ-paths we can see that λ-paths for λ =  <dig>  ~  <dig>  are almost always higher than λ-path for λ =  <dig>  this means the integration of reaction flux with target sequence makes the classification performance better, for almost all k =  <dig> ~  <dig>  we also performed the t-test on the respective  <dig> aucs of λ =  <dig> and λ =  <dig>  when k =  <dig> is chosen, the resulting p-value of  <dig>  e- <dig> shows the difference is statistically significant. the synergism of reaction flux profiles and enzyme target sequences further supports that reaction flux similarity obtained by reaction profiling does help for exploring the associations between drugs and reactions or targets. figure  <dig> shows that λ =  <dig>  ~  <dig>  are best choice for the classification model. from the figure of λ-paths of the prediction performance, we can also see that the changes of the performance by k at around λ =  <dig>  ~  <dig>  is much less than λ =  <dig> and λ =  <dig>  this means the prediction becomes more stable after the integration of two data sources.

we also further compare the prediction results of the methods using λ =  <dig> and λ =  <dig>  by removing metabolic reactions one after another from the training data and then predicting its associations with all the drugs. this is the leave-one-out method. we chose k =  <dig> for the validation. the prediction auc by the methods using λ =  <dig> and λ =  <dig>  is  <dig>  and  <dig> , respectively. this shows that the integration of flux information can improve the prediction accuracy. for each reaction, we further reported in additional file  <dig> its related drugs with association score larger than the cutoff value  <dig> . there are  <dig> and  <dig> predicted drug reaction pairs for the methods with λ =  <dig> and λ =  <dig> , respectively. although the two methods have  <dig> common predicted drug-reaction pairs, with  <dig> true positives and  <dig> false positives, their results have some differences. by the method with λ =  <dig> , we can get  <dig> other true positives and only  <dig> false positives, while with λ =  <dig> we can get  <dig> other true positives and  <dig> false positives. specifically, the method with reaction structure similarity cannot identify the targets ampd <dig>  ampd <dig>  ampd <dig>  gmpr, gmpr <dig>  gmps, hprt <dig>  imph <dig> and imph <dig> of azathioprine and mercaptopurine, and the target abcc <dig> of daunorubicin, while the integration of the reaction flux similarity can identify the relationships by leveling up the their association scores. for example, abcc <dig>  the multidrug resistance protein  <dig>  is one of the approved targets  <cit>  of daunorubicin. it can be re-identified if we integrate reaction flux information and reaction enzyme structure information. belonging to the atp-binding cassette  superfamily of transport proteins, abcc <dig> can confer resistance to daunorubicin in human tumor cells. mrp <dig> is expressed in normal tissues acting as an efflux pump for glutathione, glucuronate, and sulfate conjugates and may thus influence the pharmacokinetic properties of many drugs. the intracellular accumulation of daunorubicin is decreased and the efflux of daunorubicin is increased in the transfectant. furthermore, the reaction flux similarity can also avoid the false positives produced by reaction structure similarity by depressing corresponding association scores.

we then predict new reactions and enzyme targets for the cancer drugs by kernel knn of k =  <dig> and λ =  <dig> . the results show that for four cancer drugs daunorubicin, cladribine, mercaptopurine and azathioprine, some new related reactions are identified with high association scores. we report all the predicted reactions and enzymes for these  <dig> drugs in additional file  <dig>  figure  <dig> shows these new related reactions for the four cancer drugs.  <dig> reactions are predicted to be associated with both mercaptopurine and azathioprine, other  <dig> reactions are for both daunorubicin and cladribine, and the remaining  <dig> reactions are for only cladribine. it is reasonable that mercaptopurine and azathioprine are predicted to interact with exactly same reactions since the two drugs have the same known targets. these predictions may lead to further biological research.

daunorubicin is an aminoglycoside of the anthracycline class that is mostly used in the treatment of leukemia. the cytotoxic activity of daunorubicin is through intercalation between dna base pairs, which results in dna strand breakage. the drug also inhibits topoisomerase ii and polymerase. daunorubicin is the substrate of atp-binding cassette proteins . studies indicate that daunorubicin is effluxed through these transporters together with glutathione <cit> . the stoichiometry of the co-transport is approximately 1: <dig>  cancer cells typically overexpress multidrug resistance proteins and also have high levels of glutathione. glutathione confers survival advantage to cancer cells not only by increased resistance to oxidative stress and apoptosis, but potentially also by increased efflux of anticancer drugs. the other three identified glutathione peroxidases  all catalyze the reduction of reactive oxygen species by reduced glutathione, and therefore protecting cancer cells from oxidative damage. studies have demonstrated that chemotherapy leads to a decrease of glutathione peroxidase activity. the prediction of the glutathione peroxidases as potential targets of daunorubicin provides a plausible explanation of this phenomenon.

cladribine is a synthesized analog of the nucleoside adenosine. it interferes with synthesis and repair of dna by inhibiting adenosine deaminase, and therefore has a strong inhibitory effect on the rapidly-replicating leukemia cells. the in vivo phosphorylated derivative of cladribine is incorporated into dna and leads to dna strand breakage. cladribine and some of its analogs have also been shown to be substrates and inhibitors of e. coli. purine-nucleoside phosphorylase, although they do not react with mammalian purine nucleoside phosphrylase  <cit> . some analogs, however, are active against leukemia cells  <cit> . the gpx peroxidases are also predicted as targets of cladribine. it is likely that the drug may also inhibit these enzymes, weakening their protective role in leukemia cells.

mercaptopurine is a purine analogue which interferes with nucleic acid biosynthesis by inhibiting purine metabolism and has been found active against human leukemias. it is usually used in the treatment of or in remission maintenance programs for leukemia. our prediction suggests that the mechanism of action of mercaptopurine may be related to 5'-nucleotidase . this reaction preferentially hydrolyzes inosine 5-prime-monophosphate  and other purine nucleotides, and is allosterically activated by various compounds, including atp. the enzyme gmp, also known as nt5c <dig>  is exclusively located in the cytoplasmic matrix of cells and may have a critical role in the maintenance of a constant composition of intracellular purine/pyrimidine nucleotides in cooperation with other nucleotidases. besides nt5c <dig>  ggh and fpgs are also suggested to be targets of mercaptopurine. these two enzymes are both in the pathway of folate biosynthesis. folic acid is especially important during periods of rapid cell division and cell growth. mercaptopurine may inhibit the tumour cell growth by interfering folate biosynthesis. slc25a <dig> and slc25a <dig>  two orinithine transporters for the urea cycle in liver, are also predicted as targets of mercaptopurine. the two transporters are responsible for removing ammonia from blood. besides the predicted reactions and targets listed in table  <dig>  table s <dig> in additional file  <dig> lists other possible targets. enzyme ctps for ctp synthase , and nt5c <dig> for 5'-nucleotidase  are possible targets. although they have not been approved as targets of mercaptopurine, these reactions and related pathways are known to act closely to mercaptopurine. for example, some mercaptopurine is converted to nucleotide derivatives of 6-thioguanine  by the sequential actions of inosinate  dehydrogenase and xanthylate  aminase, converting timp to thioguanylic acid . besides, the reaction xanthine oxidase with its enzyme xdh is also a promising target since studies  <cit>  have shown that mercaptopurine is inactivated by xanthine oxidase.

like mercaptopurine, azathioprine is also an immunosuppressive agent which works by suppressing the body's immune response. azathioprine is a prodrug which is converted to 6-methyl-mercaptopurine by thiopurine methyl transferase  and then metabolised to the active metabolite 6-thioguanine. thus it's reasonable to predict the same reactions/targets for mercaptiopurine and azathioprine.

the activity of these four cancer drugs against the predicted enzymes can be tested by direct enzyme activity assays. considering some drugs may need in vivo activation , enzyme activity is best measured after administration of the drugs both in vitro and in vivo . if there are known mutations that affect enzyme structure or activity, these may be taken advantage of to see if the mutations also alter effect of the predicted drugs on the enzyme.

CONCLUSIONS
in this study, we first construct a drug reaction network to show their relationships in a unified context, and then present a reaction profiling method to depict systematically the metabolic reactions in a quantitative way. reaction flux profiling makes it possible to measure the similarity of metabolic reactions functionally, which is a key step in many kinds of data analysis techniques such as clustering and classification. the comparison of target gene classification with target reaction classification shows the effectiveness of the indirect method to predict drug targets, and implies the important contribution of reaction flux similarity in drug target prediction. we also integrate the reaction structure similarity with this reaction flux similarity, and the results show the synergism of the structural similarity and functional similarity. we also notice that the integration of two similarity metrics makes the prediction more stable. this further implies the effectiveness of reaction profiling for drug target prediction. we thus predict some related reactions and possible targets for four cancer drugs for further biological research.

note that one limitation of reaction profiling lies in that proteomics and phorsphoproteomics are not involved. it may decrease to some extent the impact in the understanding of the multitude of interactions between drugs and entire metabolic network. in the future work we will address it when proteomics and phorsphoproteomics data become available. metabolic reaction profiling has more applications than what we have discussed in this work. besides nci- <dig> cancer cell lines, other disease cell lines can be used to discuss the related metabolic reactions. the statistics of the drugs in drn show that drugs for metabolic diseases, cardiovascular diseases or antineoplastic drugs are the most related to metabolic networks. this gives us a hint that these three diseases may also be discussed using metabolic network. we also note that our flux analysis is based on the mrna content in the context of transcription, thus further flux analysis using metabolomic data may be developed to explore the underlying mechanism of interactions between drugs and metabolic reactions. another possible application is metabolic biomarker discovery, which attempts to explore significant metabolites, metabolic reactions and enzymes. a biomarker discovery method involving gene expression and protein-protein interaction has been developed by ideker et al.  <cit> . it compares the gene expression over particular subset of conditions to identify active sub networks. this idea can be integrated with reaction flux profiling to identify significant metabolic reactions. we can first predict the metabolic states of cells before and after the absorption of drugs based on the gene expression data, and then compare the reaction flux over different conditions to identify significant metabolic reactions, from which the related metabolites biomarkers can also be identified.

authors' contributions
ll and xz conceived the idea and designed the research. ll acquired and processed the data. ll performed the research and analyzed the results. ll, xz and wc wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
different reaction measure of similarity. the file gives the comparison of performance using different reaction measure of similarity in kernel knn

click here for file

 additional file 2
drug-reaction network. this file lists the detailed information in drug-reaction network

click here for file

 additional file 3
reaction flux similarity score this file lists the reaction flux similarity and the common drugs between each pair of metabolic reactions.

click here for file

 additional file 4
the performance for the integration of reaction flux similarity and reaction structure similarity. this file lists the performance for the integration of reaction flux similarity and reaction structure similarity.

click here for file

 additional file 5
the predicted reactions and targets for cancer drugs. this file lists the predicted reactions and targets for cancer drugs.

click here for file

 acknowledgements
we would like to thank all the members in bioinformatics group for discussion. we thank the anonymous referees for their very helpful comments and suggestion. this work was supported by ibsi grant , hkrgc grant no. 7017/07p, hkucrgc grants, hku strategy research theme fund on computational sciences, hung hing ying physical research sciences research grant, national natural science foundation of china grant no.  <dig> and guangdong provincial natural science grant no.  <dig> 
