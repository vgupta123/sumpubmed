BACKGROUND
transitions from cross-fertilization to self-fertilization can have profound effects on population genetic structure and patterns of molecular evolution across the genome  <cit> . most importantly, homozygosity increases with more intense selfing, which decreases effective population size  and reduces opportunities for crossing over between heterozygous sites, resulting in elevated linkage disequilibrium  <cit> . effective population size is also reduced around selected regions by the effects of genetic hitchhiking, including selective sweeps of beneficial mutations and background selection against deleterious mutations . linkage among weakly selected sites with opposing selective forces can also interfere with the ability of selection to act efficiently  <cit> .

estimates of ne in selfers are often lower than the expected two-fold decrease based on selfing alone. this result presumably occurs because life-history characteristics associated with selfing promote population subdivision, isolation, and frequent genetic bottlenecks  <cit> . thus, both genetic and demographic processes in selfing populations should lead to a decrease in the efficacy of natural selection and an increase in the fixation of slightly deleterious mutations, with important consequences for genome evolution. the accumulation of deleterious mutations may also be an important factor in causing species extinction  <cit> , and could explain the lack of persistence of selfing lineages over longer time scales  <cit> . however, the extent to which theoretical predictions on the reduced efficacy of selection in selfing populations occur is unclear.

the efficacy of selection depends on the product of ne and the selection coefficient . the reduction of ne due to selfing is expected to result in a higher rate of fixation of slightly deleterious mutations and a lower rate of fixation for advantageous mutations . diverse methods have been developed to detect the footprint of natural selection at the molecular level . one common approach is to quantify the ratio of mutations at non-synonymous sites  versus synonymous or silent sites ; hereafter ω. because selection acts primarily on proteins and not dna sequences, synonymous changes are often treated as selectively neutral  thus enabling measurement of the degree of selective constraint on amino acid sequences. under neutrality ω is expected to equal  <dig>  whereas values of ω less than or greater than  <dig> indicate purifying or positive selection, respectively. the vast majority of functional proteins that have been examined exhibit ω values much less than one indicating that most protein sequences are subject to purifying selection. however, in selfers a reduction in the efficacy of selection may result in elevation of this value as a result of the accumulation of deleterious mutations.

although predictions concerning the effect of selfing on levels of polymorphism have been well documented  <cit> , evidence for a reduction of selection efficacy in selfing populations of diverse plants and animals is equivocal. the only study that we are aware of that has attributed an accumulation of deleterious mutations to selfing was a comparison of the selfing plant arabidopsis thaliana with drosophila melanogaster <cit> . other studies focusing on closely related outcrossers and selfers  <cit>  have failed to detect convincing evidence of reduced selection efficacy leading to several hypotheses to explain the apparent lack of signal in the molecular data. first, the genomic distribution of selection coefficients is poorly known  <cit> , and if there are few weakly selected mutations very little effect of the mating system is predicted  <cit> . another explanation involves the amount of time that has elapsed since the transition from outcrossing to selfing, which in some instances may be too short for substantial changes to have occurred at the genome level  <cit> . finally, no comparisons have been made using genomic data involving very large numbers of loci  and it is possible that larger genomic samples may allow the detection of weak effects of selfing despite the stochasticity and slow rate of mutation accumulation.

the reduced efficacy of selection due to decreased ne is also predicted to diminish the signal of biased codon usage. proportional usage of synonymous codons often differs between high and low expression genes due to selection for higher translational efficiency and accuracy  <cit> . however, the strength of selection on synonymous codon usage is expected to be weak relative to purifying selection against amino acid altering mutations. if this is true, reductions in ne, such as those associated with transitions to selfing, are predicted to reduce the efficacy of selection to the extent that these mutations become effectively neutral  <cit> . thus, in principle the reduced efficacy of selection can be inferred from an increase in the frequency of substitutions  for unpreferred codons, or by less differentiation of codon usage between high and low expression genes. however, because codon bias is eroded by genetic drift this process will occur rather slowly and is dependent on the rate of mutation  <cit> . therefore, to detect the reduced efficacy of selection based on codon usage it may be necessary to include either old selfing lineages, which may be difficult given the relatively recent origin of most selfers  <cit> , or to obtain data from a very large number of loci, to detect the small changes that are possible in codon usage, an approach we use here.

empirical tests of these predictions have included selfing and outcrossing species of brassicaceae  <cit> , caenorhabditis <cit>  and members of the triticeae  <cit> . the results of these studies are mixed, with no evidence of reduced codon bias in selfing species of the triticeae, a slight reduction in codon bias in selfing c. briggsae relative to outcrossing c. sp.  <dig>  and a recent analysis found evidence of an effect of selfing on codon usage in brassicaceae  <cit> . two explanations have been proposed for the lack of a strong effect of selfing on codon usage. first, as mentioned above, many selfing lineages are thought to be of recent origin , and there simply may not have been sufficient time for enough mutations to have drifted to fixation. second, interspecific comparisons introduce confounding effects that are not directly related to selfing because of the independent evolutionary history of the species, thus limiting conclusions about the effect of selfing on codon bias  <cit> . ideally, predictions require contrasts between conspecific selfing and outcrossing lineages with fewer confounding effects; however, this may not be feasible over long evolutionary time spans. the approach we use in this study is to contrast both inter and intraspecific selfing lineages of different ages and to use a large sample of loci in an effort to detect changes in the efficacy of selection on genomes.

here, we investigate patterns of molecular evolution in the floral transcriptomes of three independently derived selfing lineages relative to an outcrossing genotype in eichhornia , a neotropical genus of aquatic plants. our samples include three individuals of e. paniculata, an annual diploid that has been the subject of detailed studies on the ecology and genetics of mating-system variation over several decades . populations of e. paniculata are largely concentrated in n.e. brazil, with smaller foci in jamaica and cuba and isolated localities in nicaragua and mexico. populations in brazil are mostly outcrossing and possess the sexual polymorphism tristyly, which promotes cross-pollination among the three floral morphs . morphological, genetic and biogeographical evidence indicates that tristyly has broken down on multiple occasions in e. paniculata resulting in independently derived selfing populations  <cit> . populations from jamaica are largely composed of selfing variants of the mid-styled morph  in which stamens are elongated to a position adjacent to mid-level stigmas resulting in the autonomous self-fertilization of flowers. in contrast, plants from mexico and nicaragua are selfing variants of the long-styled morph  with a different arrangement of sexual organs . although both variants possess the selfing syndrome, comparisons of molecular variation at  <dig> est-derived nuclear loci indicate a high level of genetic differentiation consistent with their separate origins from different outcrossing ancestors . our analysis included an individual of both selfing variants and an individual of an outcrossing l-morph from n.e. brazil, the likely centre of origin of the species. we also included a selfing individual of e. paradoxa, the sister species of e. paniculata , to serve as a potentially more ancient selfing phenotype, and as an outgroup for inferences on the ancestral dna sequence in our samples. most populations of e. paradoxa are predominantly selfing, although a tristylous population is known from brazil  indicating that, in common with e. paniculata, selfing has likely arisen from the evolutionary breakdown of tristyly.

we used high-throughput dna sequencing technology to generate a set of approximately  <dig> orthologous ests from the floral transcriptomes of the four eichhornia genotypes. using this dataset we investigated the molecular evolution of protein coding genes to address the following specific questions predicted by the hypothesis of reduced selection efficacy in selfers:  is there evidence for relaxation of purifying selection against non-synonymous mutations in selfing lineages?  can we detect biased codon usage in our samples, and if so, does this vary among lineages based on their mating systems?

methods
samples, tissue preparation and sequencing
we selected the four plants used in our study from glasshouse collections maintained at the university of toronto. these were originally obtained by germinating open-pollinated seed collected from field populations at the following localities: outcrossing l-morph b <dig>  fortaleza, ceará, n.e. brazil; selfing m-morph j <dig>  georges plain, westmoreland, jamaica; selfing l-morph n <dig>  rio las lajas, rivas, nicaragua; e. paradoxa, patos, paraíba, n.e. brazil.

we extracted total rna from floral tissue sampled evenly throughout development from bud to flower. we used the illumina  mrna-seq, paired-end protocol on a genome analyzer, gaii, for  <dig> cycles. this resulted in an average of ~ <dig>  ×  <dig> bp of sequence per sample. we performed de novo assembly on each sample separately using the program oases . we then generated a consensus transcriptome by identifying orthologous sequences among the four samples using a reciprocal best blast approach. the consensus sequence of these orthologs was used as a reference on which we aligned the original reads. this approach allowed us to use the frequency of bases at each position to statistically infer each genotype. to call the genotypes we used the method implemented in the software maq and samtools  <cit>  with a quality threshold of q >  <dig> , where q is the phred-scaled probability that the consensus genotype call is wrong. sites for which we could not determine the genotype, with at least this level of confidence, were marked as ambiguous. to detect potential errors in read mapping we assumed that selfing genotypes were largely homozygous, and therefore the presence of the same heterozygous sites in multiple selfing genotypes would indicate errors in read mapping, possibly due to paralogous sequences. we excluded these loci from downstream analyses. read mapping also allowed us to use the abundance of reads derived from each locus to estimate gene expression. we calculated the number of fragments per kilobase per million fragments mapped  with the program cuffdiff from cufflinks v  <dig>   <cit> . full details on the sequencing, assembly, quality assessment and expression analysis can be found in ness et al.  <cit> .

est analysis, filtering and alignments
to assign open reading frames and repair potential indels inserted during transcript assembly we used the pipeline prot4est  <cit> . we started from an extended list of  <dig>  single-copy ests that were assembled in all four genotypes. nucleotide sequences were aligned on the basis of their translated amino-acid sequences with the software muscle  <cit>  using the backalign function of the egglib package  <cit> . we removed alignments with frame shifts and the remaining alignments were confirmed visually. our final dataset was comprised of  <dig> alignments totalling  <dig> , <dig> bp of sequence and these were used for all subsequent analyses. by comparing illumina and sanger data over  <dig> bp of aligned sequence we estimated a conservative error rate of  <dig>  × 10- <dig> errors/site . this error rate is two orders of magnitude lower than the estimate of diversity in our samples, and not likely to influence the inferences presented here.

selection on protein coding changes
we investigated patterns of selection on coding sequence as changes in the proportion of non-synonymous and synonymous derived mutations in each e. paniculata genotype, using the outgroup e. paradoxa to infer the ancestral state by parsimony. misinference of the ancestral state through violations of infinite sites or ancestral polymorphism was unlikely to affect our analyses because we used the ratio of dn /ds to compare among lineages. moreover, there is no reason to expect more or less multiple mutations or ancestral polymorphisms in the selfing or outcrossing lineages and any noise introduced to the analysis should be unbiased. using simple counts relies on few underlying assumptions and alleviates the need for divergence data between lineages, which is required by the dn /ds approach described in the introduction. we then tested for significant differences in the proportion of derived non-synonymous to synonymous mutations in each individual using a χ <dig> homogeneity test with two degrees of freedom. heterozygous sites were taken into account by generating two unphased haploid sequences and taking the average of the counts.

to classify the potential effects of non-synonymous mutations we used the program mapp  <cit> . this method relies on an alignment of translated transcripts to homologous proteins to estimate the physiochemical constraints at positions in the protein. each position in the protein is assigned a list of compatible  or incompatible  amino-acids. to test for an accumulation of deleterious mutations in the selfing lineages we conducted two analyses. first, using e. paradoxa to infer the ancestral state, we tested whether non-synonymous changes along each lineage were classified as deleterious. second, to mitigate any possible problems with ancestral state assignment, we considered all polymorphic sites within e. paniculata and tested whether the allele from each genotype was deleterious. to generate alignments of each of our transcripts we used blastx to identify homologous proteins in the ncbi non-redundant  protein database, keeping only the five best hits. we then conducted a global multiple-alignment using the software muscle. to avoid alignment errors we retained only those with >60% identity at the protein level. we constructed a tree for each alignment using phyml with default parameters and a blosum <dig> substitution matrix for amino-acids  <cit> . the alignments and inferred trees were used as the input for mapp.

assessing selection for codon bias
to measure codon usage bias we calculated the frequency of optimal codon usage  for each gene from all four genotypes. because optimal codons can vary among species we first identified these codons based on the assumption that codon bias is strongest in highly expressed genes . we therefore identified optimal codons as those which differed in their usage between high versus low expression genes using the method of duret and mouchiroud  <cit> . we first calculated the relative synonymous codon usage  for each codon in all genes using the program codonw . from this we contrasted rscu in high expression  versus low expression  as ∆rscu = rscuhigh - rsculow <cit> . we calculated this measure using both the mean expression across samples and with the sample-specific expression values, but the results were the same. we measured expression as the number of sequence reads per kilobase per million reads mapped fpkm,  <cit> . statistical departure of ∆rscu from zero was tested for each codon using a one-way analysis of variance  conducted in jmp v <dig>  and codons with significantly positive values were inferred to be putative optimal codons. we calculated the frequency at which the optimal codon is used across sites  in codonw with a customized optimal codons table. we repeated this procedure for each of the four genotypes to calculate genotype-specific tables. we also defined consensus optimal codons as those that were optimal in all four genotypes and limited this set to include only one codon per amino acid. all analyses presented here are based on the consensus optimal codons, but the results were qualitatively similar using genotype specific estimates.

both selection and the background base composition can influence estimates of fop. we assessed the role of these factors, genotype and mating system to determine their influence on codon usage bias in our four samples. we constructed anova models in jmp v <dig>  where fop was a function of base composition , gene length , gene expression , genotype and mating system . genotype and mating system could not be included simultaneously because there is only one outcrossing genotype  and they were therefore run in two separate models. our models initially assessed the effects of all of these factors and their interactions. terms were excluded from the model by backward elimination  if they did not explain a significant proportion of the variation in codon bias, and they were not involved in any significant higher order interactions. although gc3s was found to be highly significant, we also present the results of an anova that excluded gc3s because we found that all of our putatively optimal codons have guanine or cytosine in the third position, therefore gc3s was not independent of fop.

the statistic Δrscu―+ proposed by cutter et al.  <cit> , measures the strength of selection for codon bias as the mean of all positive values of ∆rscu for a given genotype. because rscu is independent of the amino acid content and ∆rscu controls for base composition, Δrscu―+ provides a useful metric for comparing the degree of codon usage bias across genotypes and species. we calculated Δrscu―+ for each genotype and tested for significant effects of mating system and genotype using two separate one-way anovas of Δrscu―+ among genotypes. we also compared the Δrscu―+ values for mating system  and genotype using the tukey-kramer hsd test. all values of Δrscu―+ were log transformed for these statistical tests so they fitted the normal distribution.

we calculated counts of the number of synonymous mutations that resulted in changes from preferred to unpreferred codons , or unpreferred to preferred codons , using the optimal codons defined in our analysis of ∆rscu and the outgroup e. paradoxa to infer the ancestral state  <cit> . an elevation in the proportion of changes from preferred to unpreferred codons can be interpreted as a relaxation of selection for optimal codons. it should be noted, that p2u changes that may have occurred in the outgroup will potentially increase the measured rate of u2p in the branch shared by all e. paniculata genotypes; however without more outgroup sequences this cannot be quantified. we tested for significant differences among each of our e. paniculata genotypes and each genotype relative to the ancestral branch connecting e. paniculata genotypes to e. paradoxa using a χ <dig> homogeneity test.

RESULTS
our dataset for the four eichhornia genotypes consisted of  <dig> loci  totalling  <dig> , <dig> bp of aligned sequence. there were  <dig>  polymorphic sites among our three samples of e. paniculata and  <dig>  divergent sites between e. paniculata and e. paradoxa . mean non-synonymous polymorphism  was almost an order of magnitude lower than mean synonymous polymorphism . there were a similar number of pairwise differences when comparing jamaican with brazilian  and jamaican with nicaraguan genotypes . the brazilian and nicaraguan genotypes had the fewest number of differences . consistent with theory, in e. paniculata we found a higher frequency of heterozygous sites in the brazilian outcrossing genotype  than in the two selfers .

 the number of aligned sites , the number of polymorphic sites , the number of divergent sites  and watterson’s polymorphism estimator .  number of pairwise differences between the four individuals. note that values are the average of the pairwise comparisons of the unphased haplotypes, thus explaining why in some case the number are not integers.

selection on non-synonymous mutations
the χ <dig> test of homogeneity comparing the ratio of synonymous to non-synonymous mutations in the e. paniculata genotypes was significant  with a slightly higher ratio of non-synonymous to synonymous derived mutations in the selfing genotype of e. paniculata from nicaragua  compared to the outcrosser from brazil  or the selfing genotype from jamaica . although the magnitude of these differences is not very large, the trend suggests a slight elevation of the proportion of non-synonymous changes in the nicaraguan selfing genotype of e. paniculata.

when all non-synonymous changes are categorized as deleterious or neutral, using the program mapp, we found both selfing genotypes of e. paniculata showed a slightly higher proportion of deleterious changes  for the  <dig> genes included in this analysis . when considering all non-synonymous polymorphic sites, we found a significantly higher fraction of deleterious mutations in the two selfers  compared to the outcrosser . when e. paradoxa was used as an outgroup to polarize the direction of mutations the trend was similar but marginally insignificant .

assessing selection for codon bias
codon usage in each of the four genotypes was highly non-random. summary statistics for high and low expression genes as well as all loci combined are presented in table  <dig>  gc content at 4-fold degenerate sites in all genes  was similar across all samples  but was significantly different in high versus low expression genes . as a result, we found that values of rscu for each codon in each genotype differed between high and low expression genes. using ∆rscu analysis we identified  <dig> putative optimal codons  that were found in all four genotypes representing  <dig> different amino acids. all  <dig> of these putatively optimal codons had guanine or cytosine in the third position. each of the degenerate amino acids was represented by at least one putatively optimal codon. the six amino acids for which there were more than one optimal codon included alanine, leucine, proline, serine, threonine and valine. in each of these amino acids with two preferred codons, the codon with a greater ∆rscu value terminated with a cytosine rather than a guanine. this pattern occurred despite the higher proportion of guanine in synonymous third positions sites across all genes.

for each of the genotypes, the genes were divided into two categories based on expression level including the top  and bottom  and 10th percentile of expression. the values for all loci are summarized in the category, ‘total’.

we used these  <dig> putatively optimal codons to calculate codon bias in each gene of each genotype. we found that gc3s had a highly significant effect on measures of codon bias  explaining  <dig> % of the variance in fop. in addition, both length and gene expression had significant effects on fop, but only explained  <dig> % and  <dig> % of the variance in fop, respectively. there was no significant effect of either mating system or genotype on the frequency of optimal codons. however, there was strong differentiation in both gc3s and fop in high versus low expression genes, demonstrating that selection for codon bias is stronger in up-regulated genes. there was also a subtle elevation in the fop of highly expressed genes of the outcrosser relative to all three selfers, although the trend was not significant.

to compare bias in codon usage in each genotype we also used the statistic Δrscu―+ . although no difference was detected in fop among genotypes, there was a significant effect of mating system on Δrscu―+ . the mean for all three selfers combined Δrscu―+selfers= <dig>  was significantly lower than for the brazilian outcrosser Δrscu―+brazil= <dig>  . this pattern appears to have been largely driven by the significant effect of genotype  due to the lower Δrscu―+nicaragua <dig>  relative to the corresponding value of Δrscu―+brazil= <dig>  from brazil .

preferred to unpreferred synonymous changes
we compared the patterns of mutation between preferred and unpreferred codons in each genotype as an additional test for changes in selection on codon usage . there was a slight reduction in the proportion of preferred to unpreferred changes in synonymous codon use in the selfing genotypes relative to the root branch of e. paniculata. both selfers, jamaica  and nicaragua , had a significantly lower proportion of preferred synonymous changes when compared to the ancestral lineage leading to e. paniculata . the ratio of preferred to unpreferred changes in the outcrossing genotype from brazil was not significantly different from the branch connecting e. paniculata to e. paradoxa . however, the ratio u2p/p2u of the outcrossing genotype was intermediate to the selfers and the ancestral lineage and was not significantly different from either selfer.

discussion
large numbers of loci are required to detect significant shifts in patterns of selection across the genome accompanying the transition from outcrossing to selfing. this is largely because the mutational process is inherently noisy and many selfing populations are recently derived. as a result, most studies have failed to detect a significant signature of the effects of a transition to selfing on the efficacy of natural selection  <cit> . here, we sequenced ~ <dig> genes from three independently derived selfing lineages and one outcrosser from eichhornia, a plant genus that illustrates multiple independent evolutionary transitions from outcrossing to selfing. below we discuss the implications of our results in the context of selective constraints on protein sequences and the underlying codon usage during mating system transitions.

our study was based on a small number of genotypes, in part because of the large number of genes that we were interested in sampling. as a result, accurate estimates of polymorphism were not possible and this restricted the types of analyses that we could conduct. however, it is important to appreciate that our sampling scheme involving many loci provides a large sample of the deeper coalescent history of each population because, by definition the coalescent histories of unlinked loci are independent. therefore, the specific identity of individuals sampled in each population is not important. in the case of the outcrossing genotype, this was sampled from a region of brazil dominated by outcrossing populations with little evidence of population structure and higher levels of gene flow than are evident elsewhere in the range, where selfing populations occur more commonly  <cit> . as a result, it seems reasonable to assume, given the absence of any obvious population subdivision in the region from which this individual was sampled, that the loci sequenced provide a reasonable approximation of populations in this region, and thus are representative of outcrossing genotypes in general.

mating system and protein evolution
when analysing the number of non-synonymous mutations we found a trend for a higher fraction of deleterious mutations in the selfing genotypes of e. paniculata . when we considered all polymorphic non-synonymous sites, the two selfing lineages had a significantly higher fraction of sites considered deleterious. this result is consistent with the prediction that selfers are less efficient at purging deleterious mutations from populations. the trend was strongest in the nicaraguan genotype, which also had a significantly higher proportion of non-synonymous to synonymous changes in comparison with the outcrossing genotype from brazil. interpretation of these values should take into account that not all changes observed are necessarily fixed within the respective populations from which the genotypes were sampled. in fact when we excluded heterozygous sites, which by definition are polymorphic, we found a significant elevation in the proportion of non-synonymous to synonymous polymorphisms in both selfing genotypes . because the outcrosser had more heterozygous sites, the removal of these variants is likely to have preferentially removed slightly deleterious polymorphisms from this sample. a recent study of polymorphism in the derived selfer, capsella rubella, detected an excess of rare non-synonymous mutations  and similarly an elevation in potentially deleterious polymorphisms was found in small, marginal population of a. thaliana <cit> . if a similar pattern occurs in the jamaican and nicaraguan genotypes, some portion of the observed non-synonymous mutations could be due to polymorphism. however, our data are consistent with these mutations segregating for a longer time or at higher frequencies in the selfing populations, potentially due to a reduction in the efficiency of selection in purging deleterious mutations. future sampling of more individuals from selfing and outcrossing populations of e. paniculata should allow an evaluation of the generality of our findings.

mating system and selection for codon bias
differentiation of codon usage between high and low expression genes provided strong evidence of codon bias among our four samples. the degree of bias was partially explained by genotype and mating system . the measure Δrscu―+ <cit>  provides a useful way to compare codon bias across species or genotypes and compare the differentiation in codon usage between high and low expression genes. the outcrossing e. paniculata genotype from brazil had a significantly higher Δrscu―+ estimate than the three selfing genotypes combined. moreover, while there was no significant difference between the outcrosser and the selfing genotype from jamaica and e. paradoxa, there was a significant difference between the outcrosser and the nicaraguan genotype. this pattern is illustrated in figure  <dig>  in which the nicaraguan genotype appears less polarized in Δrscu values between optimal and sub-optimal codons. it is possible that a different amount of time has elapsed since the origin of selfing in these lineages, or the effective size of the nicaraguan population may be much smaller than the jamaican population. we found a similar trend in the analysis of protein coding changes where only the nicaraguan genotype had a significantly higher ratio of non-synonymous to synonymous changes, and also had the highest fraction of deleterious mutations. interestingly, the nicaraguan genotype has fewer snp differences in comparison with the outcrosser than the jamaican genotype. this is consistent with a more recent common ancestor between these lineages and could indicate that selfing evolved more recently in this lineage. however, the time since the lineages diverged is not necessarily coincident with the evolution of selfing and we cannot exclude the possibility that the nicaraguan genotype has been selfing longer or at a higher rate than the genotype from jamaica. consistent with this suggestion, the nicaraguan genotype had less than half the proportion of heterozygous sites relative to the jamaican genotype. the nicaraguan genotype originated from one of only four populations of this species reported from central america, unlike jamaica where e. paniculata is more widely distributed and both selfing and outcrossing variants occur  <cit> . therefore, it is possible that the underlying distribution of mutational effects on fitness is such that the reduction in ne in the jamaican population was not sufficient to render deleterious mutations effectively neutral.

we analyzed the fraction of synonymous mutations in each genotype that resulted in either changes to preferred or unpreferred codons. the patterns we obtained are in accord with our other results and suggest a small change in the efficacy of selection on codon usage in the two selfing genotypes of e. paniculata. both had a significantly lower ratio of preferred over unpreferred changes compared to the ancestral branch, and there was no significant decline in the outcrossing genotype . if codon bias is at equilibrium with respect to mutation and selection, the number of preferred and unpreferred substitutions is expected to be equal  <cit> . however, this ratio in our samples, including the root branch, was below  <dig>  . this may be explained by the contribution of mildly deleterious mutations segregating in each population. consistent with this interpretation is the finding that the outcrossing lineage from brazil had more unpreferred changes than the ancestral branch. the ratio of preferred to unpreferred fixations along the ancestral branch was also lower than  <dig> , which may reflect a relaxation of selection in the selfing e. paradoxa. we cannot quantify this effect without another outgroup sequence because when the transition to selfing occurred along this branch in e. paradoxa is unknown. however, even if segregating mutations are contributing to the pattern, the fact that they are contributing more in selfing populations implies that mildly deleterious mutations are at higher frequencies, a pattern predicted by a relaxation of selection in selfing populations.

factors influencing the efficacy of selection in selfers
one explanation for the stronger effect of selfing on codon bias relative to protein evolution is that the underlying distributions of fitness effects  of synonymous and non-synonymous mutations are likely to be different. most models predict an accumulation of deleterious mutations in inbreeders and rely on a large class of slightly deleterious mutations with additive fitness effects  <cit> . however, if a large fraction of non-synonymous mutations are strongly deleterious such that nes remains greater than  <dig> , the rate of fixation may not be elevated. therefore, if the shape of the dfe for synonymous sites differs, so that a large portion of the mutations altering codon usage are very weakly selected, then only a small decline in ne due to selfing would cause nes <  <dig>  weak selection on codon bias seems likely given the relatively low estimates of nes in other species using the same method . these results are what would be expected with the relatively weak effect of selfing we found for the accumulation of non-synonymous mutations and the small reductions in selection for codon bias evident in our data.

models that predict an accumulation of deleterious mutations in selfing populations generally require that mutations are additive in their effects  <cit> . however, if a sizable fraction of slightly deleterious mutations are recessive they will be more effectively eliminated in highly selfing populations through purging  <cit> . barrett and charlesworth  <cit>  reported differences in the intensity of inbreeding depression between selfing jamaican and outcrossing brazilian populations of e. paniculata after five generations of controlled selfing and outcrossing. they interpreted their results as being consistent with the occurrence of natural purging of genetic load in the jamaican population owing to a history of selfing. we may therefore expect that some mutations identified in our outcrossing genotype are polymorphic and that sheltered genetic load may have been purged during the colonization bottleneck associated with long-distance dispersal to the caribbean by e. paniculata. if true, this could lessen the signal of deleterious mutation accumulation in selfers and potentially explain the weaker signal found in the jamaican genotype.

our results suggest that the accumulation and/or segregation of deleterious mutations is different between the two selfing genotypes of e. paniculata. this may be because selfing rates vary considerably within and among jamaican populations  and even low levels of outcrossing are sufficient to allow recombination to lessen many of the predicted consequences of extreme inbreeding . we have no estimate of the selfing rate or amount of nucleotide diversity in the nicaraguan population from which our sample originated. flowers produced by plants from this population are the smallest known in e. paniculata and are very likely to be highly autaogamous given their strong facility for self pollination in the glasshouse. it is possible that the significantly reduced value of Δrscu―+ compared to the outcrosser is a result of a more severe reduction of ne in this population than in the jamaican population, as discussed earlier. a clearer signal for the accumulation of deleterious mutations in e. paniculata may not exist if the transition from outcrossing to selfing occurred recently. it is estimated that the colonization of the caribbean from brazil occurred ~ <dig>  generations ago  <cit> , perhaps leaving insufficient time to reach equilibrium and for ancestral polymorphism to coalesce within selfing populations. our findings indicate a higher fraction of deleterious mutations in selfing lineages of e. paniculata. the effects of these mutations on fitness and how many must accumulate to impact the viability of selfing lineages is unknown.

CONCLUSIONS
here, we use high-throughput sequencing of the floral transcriptome of the aquatic plant eichhornia paniculata, and its sister species e. paradoxa, to investigate whether a transition to self-fertilization is associated with a reduction in the efficacy of natural selection. we observed a small increase in the proportion of non-synonymous mutations in one of the selfing e. paniculata genotypes. however, in both e. paniculata selfing genotypes the proportion of non-synonymous changes inferred to be deleterious was significantly higher than in the outcrossing genotype. a key result from our study is the finding of a reduction in codon bias usage in selfing genotypes, as predicted by a relaxation in selection efficacy. our results are therefore consistent with theoretical expectations, and highlight the value of high-throughput data to investigate long-standing questions in evolutionary genetics.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
rwn and ms were responsible for the sequence assembly, alignment and annotation. rwn was primarily responsible for the analysis of the codon bias and ms for the analysis of protein coding changes. all authors contributed to the preparation of the manuscript and have read and approved the final manuscript.

supplementary material
additional file 1
snp validation and error rate estimation.

click here for file

 acknowledgments
we thank asher cutter, david guttman and stephen wright for advice and melissa hubisz and james wasmuth for providing source code for the programs codonbias and prot4est, respectively. we also received valuable comments from anonymous reviewers. sequencing was conducted at the center for analysis of genome evolution and function  with the help of pauline wang, pauline fung and yunchen gong. the research was supported by grants to schb from the natural sciences and engineering research council of canada  and a premier’s discovery award in life sciences and medicine from the ontario government. rwn was supported by student fellowships from the university of toronto and ms by a post-doctoral fellowship from the canada research chair’s program to schb.
