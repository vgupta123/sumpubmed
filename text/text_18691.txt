BACKGROUND
high-throughput whole-genome expression data generated by microarray and deep sequencing experiments hold great promise for unraveling the genetic logic underlying diverse cellular events and disease. without the application of sophisticated bioinformatics and statistical methods, however, these enormous datasets invariably defy human analysis. for example, microarray experiments generally yield tables of expression data in which rows represent  <dig>  to  <dig>  different gene probes, and columns  generally represent a wide variety of different cellular phenotypes. such massive, high-dimensional datasets are increasingly generated by 21st century research technology, and robust and practical methods for finding natural clusters in complex microarray data will have broad application beyond bioinformatics in in data-intensive fields ranging from astrophysics to behavioral economics.

several methods have come to predominate the clustering of microarray data, none of which is ideally suited for identifying the complex systems-level interactions in genome biology  <cit> . a common approach uses bottom-up hierarchical clustering  to build a dendrogram representing a series of clusters and sub-clusters, with cluster number ranging between one  and the dataset size n . a discrete partitioning in hc requires "pruning" the tree into a known number of clusters. methods for predicting the number of clusters in a dendrogram vary in predictive accuracy and efficiency  <cit> . also, since hc greedily merges all of the data points into a locally connected dendrogram, local decisions about cluster membership can misrepresent global cluster topology  <cit> . another strategy uses k-means clustering to produce a clean partitioning of a large dataset by minimizing the statistical variance within k clusters of d dimensions. the number of clusters, k, is the key parameter for k-means partitioning, and a cluster number prediction algorithm is also important for accurately selecting k without prior knowledge  <cit> . k-means clusters are generally limited to hyper-spherical geometries, and the requirement that all data must belong to some cluster may poorly represent relationships in a dataset containing outlier data points.

over the past decade, many additional unsupervised clustering strategies have been proposed  <cit> . for example, affinity propagation uses an instance of the max-sum algorithm to identify exemplar data points that represent cluster centers in the dataset, but is generally restricted to symmetrical clusters, and requires a 'preferences' parameter that ultimately determines the number of clusters  <cit> . a different approach, non-negative matrix factorization , constitutes a class of matrix multiplication techniques that has shown utility for identifying compact, well-defined clusters in noisy datasets  <cit> . like k-means and hc, nnmf requires an external cluster number prediction method  and manual analysis to select the final partitioning. spectral clustering methods utilize linear algebra to perform an eigenvector decomposition of input data followed by application of a suitable clustering method  to cluster the transformed data points. although spectral clustering methods have a mathematically robust foundation and work well for identifying clusters of diverse shapes, eigenvector decomposition steps are computationally-intensive, and spectral clustering also requires cluster number as input  <cit> . unless data points are represented sparsely, spectral clustering and affinity propagation both require o space for n data points resulting in poor scalability for very large datasets such as whole genome expression data. finally, most modern methods are not sensitive to outlier data points, a potentially critical limitation for cluster analysis of noisy gene expression datasets  <cit> .

a powerful machine learning method widely used for the visualization of high-dimensional data, called the self-organizing map , also has applications in data clustering  <cit> . to identify k clusters, som algorithms randomly initialize a regular lattice of k nodes, and then through an iterative learning process, similar input data points move toward each other in the lattice and dissimilar input data points move away from each other. as commonly applied, som clustering requires a priori knowledge of cluster number and only finds clusters with hyper-spherical geometries. a useful feature of the trained som is the u-matrix, which provides a quantitative description of discontinuity in the map. by liberally allocating nodes in the lattice, u-matrices can be used to identify potential cluster borders  <cit> . two recent methods that exploit u-matrices for clustering include virtual flooding of u-matrix "valleys" to create cluster "islands"  <cit> , and hc of the u-matrix using novel cluster merging criteria  <cit> . these approaches, however, are highly sensitive to critical som parameters such as grid node number  <cit> , or grid topology and cluster shape  <cit> . in addition to novel variants of the som that achieve explicit clustering of the node lattice, traditional clustering algorithms, like k-means, have also been applied to the som node lattice, though the number of clusters present in the trained map still requires external prediction and may not be accurately identified with circular cluster geometries  <cit> . in addition, the stochastic initialization of the node lattice required for proper self-organization leads to significant output variation for som-based clustering strategies. taken together, these problems have limited the utility of som approaches for unsupervised clustering of microarray data.

analysis of data generated by high-throughput biology experiments would greatly benefit from a facile unsupervised clustering method that addresses the drawbacks of traditional and modern clustering methods . here we report a novel som-based method for automatic clustering using density-equalized som ensembles, or autosome. this new method leverages the proven strengths of the som for dimensional reduction and spatial organization of large high-dimensional datasets, while addressing major limitations of general data clustering strategies. after using an som for initial data organization, autosome applies a density equalization technique from cartography  <cit>  to rescale the som output lattice, utilizes a minimum spanning tree approach from graph theory to identify data clusters and outliers, and then employs an ensemble resampling technique over multiple som runs to stabilize the output  <cit> . the performance of autosome is evaluated using several benchmark datasets, including standard machine learning datasets and publicly available cancer and stem cell microarray data. our results demonstrate that autosome benchmarks favorably against other clustering methods with the significant advantage that autosome is able to identify the number of clusters in the input dataset given an intuitive p-value threshold. in addition, when applied to transcriptome analysis, autosome readily identifies global variation in tumor cell gene expression that is missed by other methods  <cit> . a network visualization of the autosome output powerfully illustrates the underlying fuzziness found in these cancer cell transcriptome data. finally, the utility of the new method for gene co-expression analysis is demonstrated by the use of autosome to identify a module of ~ <dig> up-regulated genes in human pluripotent stem cells, including  <dig> genes constituting a large protein-protein interaction network related to pluripotency. these results establish that autosome is a practical and robust new method for clustering the information content of inherently noisy, often high-dimensional, gene expression data, and for visualizing global transcriptome profiles.

RESULTS
algorithm
the autosome strategy is summarized in figure  <dig>  a kohonen som is employed to achieve both a dimensional reduction and an initial organization of the input data that preserves local, but not necessarily global, topology   <cit> . by measuring the similarity between adjacent nodes, an error or dissimilarity surface  is calculated, which is cubically rescaled to accentuate separation of individual data clusters. using the error surface, an aggregation of similar data in the som is achieved by repositioning the som nodes using the density-equalizing cartogram algorithm from geography   <cit> . in this case, the density-equalizing algorithm treats the high error, or high discontinuity, regions in the map as high density, and the low error regions as low density, and uses a diffusion-based approach to globally equalize the density of the error surface across the entire map. discrete data clusters of diverse geometries are then identified from the density-equalized som using the minimum spanning tree from graph theory, as shown in figure 1c <cit> . only minimum spanning tree edges that meet a specified p-value threshold are kept, resulting in the identification of statistically significant node clusters and outliers.

a critical issue inherent in all stochastically initialized clustering methods is output variation. to mitigate output variance generated by the som step, the autosome method uses an ensemble strategy, merging multiple iterations of the clustering scheme to establish fuzzy clusters that are ultimately resolved by sending data points to clusters where they occur most frequently. this is illustrated using a simple yet challenging benchmark dataset consisting of two clusters of 3- dimensional data that form a pair of interlocking rings. the cluster output stabilized at maximum cluster quality with increasing ensemble runs , and the intersecting rings data were clearly resolved within  <dig> iterations . as a consequence of the random initialization of each som, autosome also provides a statistical confidence metric for membership of every data point to its assigned cluster that is a useful filter for improving the signal to noise ratio . all of the important aspects of autosome are detailed in the methods section, and the software is freely available for download .

testing
to evaluate the unsupervised clustering capability of the autosome method, we compared the performance of autosome with a variety of traditional and modern clustering methods using several benchmark datasets. we also tested autosome on microarray datasets, and compared the autosome output to published results obtained using hc, k-means, and nnmf clustering methods. finally, we evaluated the ability of autosome to identify modules of co-regulated genes from a large microarray dataset with over 15k expression profiles, and performed a detailed computational analysis of the biological significance of the largest detected co-expression module.

our benchmarking studies included seven diverse datasets having defined cluster number and geometry, including six datasets widely used by the machine learning community . we compared our new method to several clustering strategies including k-means, hc, and spectral clustering. since autosome, like all som-based methods, performs a dimensional-reduction of input data, we also combined k-means and hc with different dimensional reduction methods for these benchmarking studies , som and density-equalized som). the correct numbers of clusters in each benchmark dataset were provided for spectral clustering and all k-means and hc methods. the accuracy of cluster assignments by each method was assessed with the commonly used f-measure as well as normalized mutual information  metrics  <cit> . over a diverse range of benchmark datasets, autosome clustering, with no a priori knowledge about cluster number, outperformed most hc methods and performed at least as well as k-means, ward's hc, and spectral clustering methods . we note that k-means and hc have previously been applied to the som for clustering  <cit> . importantly, density-equalization of the som node lattice led to a considerable improvement in cluster quality for all tested clustering methods, including k-means, compared to clustering the unscaled lattice .

whole-genome expression data are commonly represented in tabular form, where columns are feature vectors reflecting individual cellular transcriptomes and rows are feature vectors representing the expression of individual genes. clustering methods applied to these data identify distinct cellular transcriptome classes or modules of co-expressed genes or gene variants. we tested the ability of autosome to cluster transcriptome data using a previously "filtered" cancer cell expression dataset representing  <dig> gene probes, and three lymphoma tumor types  lines,  <dig> follicular lymphoma  lines, and  <dig> chronic lymphocytic leukemia  lines)  <cit> . autosome output is effectively visualized using a network diagram in which nodes represent the transcriptome of each tumor line and edges between nodes are weighted by the fraction of times specific cell pairs were co-clustered by autosome over all ensemble iterations. as shown in figure 4a, autosome effectively partitions  <dig> of  <dig> cell lines into three major clusters. the remaining five lines were identified as outliers and clustered into three classes, two fl, two cll, and a singleton dlbcl. in all cases these outlier transcriptomes are most closely related to the large cluster representing the correct tumor types. none of the cell lines were misclassified by autosome. by contrast, as previously shown, when provided the "correct" number of tumor classes, k =  <dig>  k-means forces every transcriptome into one of the three clusters, and makes one misclassification  <cit> . we used hc to construct a dendrogram representing this data , but simple orthogonal slices of this tree are unable to cleanly resolve the three tumor classes . three major trunks on the hierarchical tree, involving  <dig> of  <dig> branches, can be manually identified, while the remaining six branches include all five outlier lines found by autosome and an additional dlbcl singleton. because local distance decisions are used to build hierarchical trees, relationships of outlier lines to the major clusters can be lost. this limitation is illustrated in the dendrogram shown in figure 4b where both singleton dlbcl lines cluster closer to the fl/cll lineage than the dlbcl lines. in contrast, autosome effectively captures the relationships between outlier transcriptomes and the three major tumor types.

a relatively new method, based on non-negative matrix factorization , has shown utility for transcriptome clustering given a pre-specified number of clusters manually estimated using a cophenetic correlation procedure  <cit> . to compare autosome to nnmf clustering, we analyzed the cancer transcriptome dataset used by  <cit> , consisting of  <dig> gene probes representing  <dig> acute myelogenous leukemia  tumor lines and  <dig> acute lymphoblastic leukemia lines, including  <dig> b-cell  and  <dig> t-cell  tumor lines  <cit> . a network visualization of the autosome output  shows that autosome places  <dig> of the  <dig> lines into three major clusters, and identifies outlier data representing a cluster of two all-t lines, and singleton all-b and aml lines. like nnmf, autosome makes two classification errors in clustering these data .

an important drawback of previous som-based clustering methods, as noted in  <cit> , is the instability of cluster assignments , ultimately due to the random initialization of the som node lattice. because autosome merges individual runs with an ensemble averaging approach, the method should, in principle, tackle this limitation for both clean and noisy datasets. to measure output variance, we use pairwise affinity, a co-clustering metric defined as the fraction of times a given pair of cell lines cluster together. pairwise affinities can range from  <dig>  to  <dig> . as expected for an som-based method applied to noisy microarray data, autosome output appears meta-stable. this is illustrated in figure 5b by a heat map representing the pairwise co-clustering of leukemia cell lines over  <dig> ensemble iterations. by combining the discrete output from five separate autosome runs , pairwise affinities demonstrate that autosome robustly resolves fuzzy clusters into discrete classes over independent runs . rather than being a limitation, autosome leverages the random initialization of the som node lattice to sample a larger solution space and effectively capture fuzzy data relationships. in contrast, nnmf like k-means, requires an explicit cluster number a priori and overlooks outlier cell lines that represent the natural fuzziness in whole genome expression data. we also note that the random initialization of the node lattice naturally renders autosome insensitive to the order of input data points.

gene co-expression analysis is used to globally identify sets of genes with similar patterns of expression that underlie important cellular phenotypes. by finding gene modules correlating with differentiation, stress resistance, disease, or pluripotency, for example, co-expression analysis can reveal significant systems-level regulatory networks, and represents another important application of unsupervised clustering. we tested the ability of autosome to identify co-expressed genes by reanalyzing a large, recently published gene expression omnibus  <cit>  dataset  comprised of diverse stem cell and somatic cell phenotypes  <cit> . transcriptome clustering of this dataset using a bootstrapped version of nnmf, followed by a comparison of transcriptome classes for significantly enriched interaction networks, was used to identify plurinet, a protein-protein interaction network consisting of  <dig> genes significantly associated with pluripotency. autosome co-expression clustering of the gse <dig> data identified  <dig> distinct gene co-expression clusters, and one singleton gene. several of the smaller clusters correspond to known phenotypic classes, including umbilical vein endothelial cells, embryoid bodies, and undifferentiated teratocarcinoma cells. the largest cluster contains approximately  <dig> genes that are up-regulated in pluripotent stem cells . based on this co-expression pattern, this gene module is called pluriup.

we further analyzed the pluriup gene set for evidence of biological significance using a variety of approaches. gene ontology enrichment  shows that pluriup genes are significantly enriched for cell cycle, regulation of transcription/translation, and chromatin remodeling functions, consistent with previous studies  <cit>  . gene set enrichment analysis  was also used to compare pluriup genes to other sets of genes reported to be up-regulated in embryonic stem cells   <cit> . as shown in additional file  <dig>  table s <dig>  pluriup genes achieved the greatest enrichment for pluripotent stem cell expression from the gse <dig> dataset. within the context of six additional geo datasets consisting of human fibroblast, induced pluripotent stem cell , and esc lines , the pluriup genes likewise achieved the highest enrichment scores for both ipsc and esc lines .

notably, the pluriup gene module contains 86% of the plurinet genes , a highly significant overlap by fisher's exact test . since plurinet represents only genes whose products compose a large protein-protein interaction network, we examined pluriup for similar network interactions using a database of  <dig>  experimentally verified protein-protein interactions  release july  <dig>   <dig>  <cit> ). within pluriup we identified  <dig> genes that encode an interconnected protein network that we call pluriplus . large fractions of both the pluriplus  and pluriup  genes are known to bind at least one of the esc-specific transcription factors, oct <dig>  sox <dig>  and nanog   <cit>  . in addition, the pluriplus interaction network is significantly enriched in genes involved in the wnt, notch, egfr <dig>  and/or tgf-beta receptor signaling pathways  <cit>  . furthermore, pluriplus genes show the highest levels of up-regulation in es and ips cells, compared to other cellular phenotypes . taken together, these results demonstrate the practical utility of autosome for the identification of robust gene co-expression clusters, such as pluriup, without prior knowledge of data structure or cluster number.

software implementation
the autosome method is implemented as a platform-independent java software tool and is available at  <cit> . in addition to invocation from the command-line, autosome can be launched within an intuitive graphical user interface environment . the gui includes several tools for exploring the cluster output, including the generation of publication-quality heat maps as well as real-time editing and filtration of clusters using the confidence metric . the autosome webpage also contains all datasets analyzed in this paper, supporting documentation, a tutorial, and instructions to make fuzzy cluster network displays using cytoscape  <cit> . for details on how autosome processes input files see input in additional file  <dig>  in addition to simple tabular input, autosome accepts common microarray file formats: pcl  and raw series matrix text files available from the gene expression omnibus  <cit> .

discussion
increasing advances in computing technologies along with methods for rapidly analyzing diverse living and non-living systems are catalyzing a new era of scientific investigation characterized by a pervasive and critical role for unsupervised data-mining methods. in a recently published comparison of forty clustering algorithms applied to gene expression and network analyses  <cit> , the following set of desirable features for unsupervised clustering algorithms were proposed: 1) scale well in memory and running time with increasingly large datasets, 2) detect distant outliers, 3) produce consistent output regardless of the ordering of input data points, 4) require minimal user input, 5) support both numerical and categorical data types, and 6) identify clusters of diverse geometries. we developed a new unsupervised clustering method for "omics" biology, called autosome, to satisfy the above criteria  which remains the subject of future work). we rigorously evaluated the performance of autosome by comparison to other clustering methods including spectral clustering and variations of k-means and hc with and without dimensional reduction. based on two different metrics of cluster quality, autosome, without specification of cluster number, performed at least as well spectral clustering, k-means and ward's hc methods, and achieved better results than three flavors of hc .

autosome has significant advantages over many clustering methods commonly used in bioinformatics research. in particular, autosome identifies clusters of diverse geometries along with outlier singletons without prior knowledge of cluster number, and processes whole genome microarray datasets in practical running time using a desktop computer. autosome is similar in concept to another approach based on moving som nodes during the training process to identify aggregated node clusters using hierarchical tree cutting  <cit> . in contrast to this previous work, however, autosome globally rescales the node lattice after training, identifies clusters using a statistical significance cutoff, and uses ensemble averaging to stabilize results, thus avoiding errors due to local decisions, dendrogram pruning, and stochastic initialization. another recently developed clustering method based on ensemble averaging of k-means clusters also predicts cluster number and shape, but requires n <dig> space for n data points, limiting this method to small datasets  <cit> . in its current form, the autosome method does not identify genes whose co-regulation is restricted to a subset of arrays . this is often accomplished by bi-clustering, a class of techniques that identifies "checkerboard patterns" by the simultaneous clustering of both rows and columns. a bi-clustering extension of autosome is the subject of future work.

interpretation of whole genome expression data generated by microarray or deep sequencing technologies requires a robust method to compare global gene expression patterns. to illustrate the practical utility of autosome for gene expression studies, we re-analyzed several microarray datasets representing gene expression in tumor cell lines and pluripotent stem cells. data shown in figures  <dig> and  <dig> demonstrate that autosome identifies important classes of cancer cells. by combining the fuzzy and discrete components of autosome results, significant variation among cancer cells was readily visualized using an intuitive fuzzy cluster network approach. although the existence of heterogeneity among cancer cells has important implications for cancer biology , such inherent cell variation is not detected by common divisive clustering methods, like k-means, that force all data points, including outliers, into k clusters reported as separate and distinct entities. furthermore, while hc methods, by their nature, show differences within and among clusters, such variation can be difficult to discern in complex dendrograms having numerous branches, although some tree-pruning algorithms are beginning to address this problem  <cit> . in the cancer cell data originally generated by alizadeh et al.  <cit> , for example, hc successfully identifies outlier cell lines , but the three major cell clusters cannot be resolved by horizontally cutting the tree, and the placement of some cell lines on the tree clearly reflects local decisions that distorted the global topology of the data . the visualization of fuzzy cluster networks identified by autosome provides a more comprehensive picture of natural cluster structure than common unsupervised clustering methods, and should be valuable as a general strategy to study global cell-cell variation.

gene co-expression analysis represents another powerful method for elucidating the regulatory logic within genomes, and hc has played a prominent and useful role in unsupervised co-expression clustering  <cit> . unfortunately, common hc algorithms scale, at best, quadratically in time with increasing dataset size  <cit> . thus, to achieve practical computational running times for most hc methods, whole-genome microarray datasets typically need to be reduced in size by filtration of the primary data, often by applying arbitrary differential expression thresholds . a popular alternative to unsupervised clustering identifies co-regulated genes among a predetermined, usually small, number of sample classes using statistical tests, for example student's t-test or anova. like hc, however, these methods also involve filtering genes by arbitrary criteria, such as a statistically significant difference and predetermined minimum fold change . by filtering the primary data before analysis, both approaches can discard thousands of genes, many of which could have biological relevance . further, by averaging across sample replicates to compute fold change between classes, cell samples with stochastic or even meaningful spiking patterns are absorbed and lost, potentially introducing false-positives  <cit> . by contrast, because autosome efficiently clusters whole-genome datasets without any assumptions about class membership, clustering results are determined by natural cluster structure of the entire dataset. this allows autosome to detect and visualize unexpected expression patterns, such as cell subtypes or stochastic noise. autosome co-expression analysis can also detect biologically significant genes with subtle differential expression patterns that might otherwise be missed. after clustering, appropriate class-based statistical tests like student's t-test, anova, or gene set enrichment analysis  <cit>  can be used to evaluate significance.

to demonstrate the capability of autosome for whole-genome co-expression analysis, we reanalyzed a publicly available metadataset  of diverse human cellular phenotypes including  <dig> esc and  <dig> ipsc lines. application of autosome co-expression analysis to the gse <dig> dataset readily revealed prominent clusters of co-regulated genes, one of which contains > <dig> genes primarily associated with pluripotent stem cells. this pluriup cluster is several times larger than previously reported sets of genes up-regulated in human pluripotent stem cells  <cit> , and remarkably, constitutes about 17% of the human genome. a variety of bioinformatics analyses revealed that pluriup is significantly enriched in esc-associated cellular functions and genes bound by esc-associated transcription factors. due to the relative scarcity of ips lines in the gse <dig> dataset, we assembled a new metadataset containing  <dig> fibroblast,  <dig> esc, and  <dig> ipsc lines from multiple reprogramming experiments , and found that pluriup is likewise significantly enriched in ips and es cell types over fibroblast cell lines, suggesting that pluriup genes are indeed, pluripotency-associated, and not likely to be an artifact of the primary gse <dig> dataset. within the pluriup gene set, we also identified a large protein-protein interaction network significantly up-regulated in pluripotent stem cells containing  <dig> genes, or about 6% of the human genome, which substantially expands upon a recently published pluripotent network, plurinet, containing only  <dig> genes  <cit>  . in addition to sharing  <dig> genes with plurinet, pluriplus is significantly enriched in both important esc signaling pathways and genes with esc-associated transcription factor binding sites . taken together, both pluriup and pluriplus were easily identified, suggesting that a comparable workflow based on autosome co-expression analysis coupled with additional bioinformatics tools can readily lead to the discovery of co-regulated genetic networks from myriad cellular systems.

CONCLUSIONS
we have shown through benchmarking and validation using publicly available machine-learning datasets and microarray data that autosome is a robust cluster discovery method for high-throughput biology. autosome exploits the strengths of the som algorithm for unsupervised spatial organization and dimensional reduction of large, unfiltered input datasets while mitigating its shortcomings for data clustering  using a novel combination of density-equalization, minimum spanning tree clustering, and ensemble averaging strategies. in addition to predicting the number of clusters without shape restrictions, autosome identifies outlier data points, a potentially critical feature for modeling natural cluster structure that is unavailable in common methods. further, ensemble averaging reveals the underlying fuzziness of data clusters, which is quantitatively recorded as a cluster confidence metric and usefully visualized by fuzzy cluster networks. transcriptome analysis using autosome consistently and intuitively characterized significant cell-cell variation in cancer cell lines, and gene co-expression analysis revealed thousands of genes up-regulated in pluripotent stem cells, including  <dig> genes composing a large protein-protein interaction network. based on these results, we conclude that autosome should have immediate utility for researchers seeking to discover natural data classes from a variety of large complex datasets in biology and beyond.

