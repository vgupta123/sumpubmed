BACKGROUND
the use of next-generation sequencing  technologies has been increasing dramatically over the past decade  <cit> . due to the technological revolution in ngs, vast amounts of both transcriptome and genome sequences across a wide range of species are accumulating, especially from large-scale projects including genome 10 k  <cit>  and insect 5 k  <cit> . traditionally, model organisms have been chosen largely based on the ease with which they can be reared in the laboratory and used for genetic studies, or their evolutionary relatedness to human. however, in the current “-omics” era, a much greater variety of organisms can be studied at the genomic and transcriptomic level. this revolution in dna sequencing technologies has far-reaching applications for the field of biology, dramatically increasing opportunities to elucidate gene regulatory networks  <cit>  and the genetic basis of complex traits  <cit> . most importantly, ngs allows scientists to investigate biological questions at an unprecedented scale. an exceptional example is a phylogenomic analysis of the origin and diversification of major insect lineages using transcriptome sequencing and genomic data  <cit> . in this study,  <dig> species from all  <dig> extant insect orders have been sequenced. combining genomic data from  <dig> arthropod species with transcriptomic data from  <dig> species, the analysis was able to resolve with high confidence the timing of the origin and diversification  of insects  <cit> , addressing a fundamental question regarding the history of life on earth.

rna-sequencing  is one important ngs technology  <cit> . rna-seq samples the entire transcriptome in great depth under a particular experimental condition. the transcriptome includes all expressed sequences, which is a reduced representation of the genome. rna-seq has many exciting applications  <cit> , including the phylogenomic example mentioned above, single nucleotide polymorphism  discovery, small rna profiling, novel transcript or splice variant discovery and comparison of global transcriptional mrna profiles under distinct environmental conditions, e.g., benign vs. ecologically stressful conditions. rna-seq is a powerful tool to advance these applications for at least three reasons. first, rna-seq is able to capture the expression of  all genes under the specific experimental conditions. second, it does not require any prior genetic information, which is well suited for non-model organisms. third, rna-seq is cost-effective and affordable for most laboratories. for nearly all applications of rna-seq, transcriptome assembly is challenging but a crucial first step for accurate downstream genetic analyses  <cit> .

de novo transcriptome assembly programs, which assemble short rna-seq reads without a reference, are the default choice for organisms without a genome sequence. de novo assembly is particularly suitable for non-model organisms, but can also be a useful assembly strategy for organisms with a genome sequence. this is because de novo assembly programs are not constrained by alignments to a reference genome and can therefore discover novel transcripts and splice variants that are not annotated in the genome  <cit> . however, de novo assembly is usually memory intensive, and requires high sequence coverage compared with reference-based assembly  <cit> . in addition, de novo methods tend to produce fragmented assemblies. genomic resources from closely related species, including genomic scaffolds and protein sequences, can serve as a reference to guide transcriptome assembly for non-model organisms and may lead to less fragmented assemblies. therefore, transcriptome assembly for non-model organisms can potentially benefit from genomic resources of a closely related species, as previously demonstrated . due to the ever-expanding pool of organisms with a sequenced genome, many researchers studying non-model organisms without a genome sequence but with intriguing ecological, evolutionary and public health attributes will soon find closely related genomic resources available.

without a genome sequence for the species of interest , genomic resources  from a closely related species, if available, can serve as reference scaffolds to re-align de novo assembled contigs. for this purpose, our laboratory has developed reference-based re-assembly  <cit> , which is based on scaffolding using translation mapping   <cit> . stm aligns de novo assembled contigs to protein sequences from a closely related species, and subsequently re-assembles the contigs according to the alignment results  <cit> . stm has been demonstrated to reduce redundancy and improve contig length relative to de novo assembly  <cit> . reference-based re-assembly is modified from stm as a two-step process to incorporate both protein sequences and genomic scaffolds from a closely related species, which utilizes not only the protein coding sequences, but also genomic sequences including 5′ and 3′ untranslated regions as well as other non-coding regions  <cit> . reference-based re-assembly has been shown to improve de novo assembly by increasing contig length and reducing redundancy  <cit> . another similar approach to stm is transcriptome post-scaffolding   <cit> , which also utilizes protein sequences from a closely related species in order to re-assemble the de novo contigs according to how they align to the reference protein sequences. in contrast to reference-based re-assembly, transps merges contigs with non-overlapping alignments to the same reference protein  <cit> . however, transps does not utilize genomic sequences from a closely related species. transps reduces the number of contigs to as few as 10 % of the number of de novo assembled contigs, eliminating contigs that are redundant and increasing coverage for the reference protein sequences relative to the de novo assembly  <cit> .

an alternative method that has been proposed to improve transcriptome assembly is genome-guided assembly, which utilizes the genome sequence of the same species as a reference to guide the transcriptome assembly  <cit> . if a high quality reference genome is available, this method usually generates longer contigs and is much less computationally demanding than de novo assembly  <cit> . with a well-annotated genome sequence, genome-guided assembly has been demonstrated to outperform de novo assembly  <cit> . if the genome assembly from the species of interest is not well annotated, and a well-annotated genome assembly from a closely related species is available, researchers may utilize the closely related genome to guide transcriptome assembly. however, few studies have evaluated the efficacy and accuracy of this approach .

the optimal strategy for transcriptome assembly will depend upon the downstream analysis and computational resources available. data associated with extensive transcriptome sequencing in ae. albopictus provide an outstanding opportunity to evaluate multiple methods of transcriptome assembly. rich transcriptomic resources have been established across multiple life stages for ae. albopictus, including developing embryos  <cit> , pharate larvae  <cit>  and adults  <cit> . therefore, the vast majority of all the expressed genes in the genome are included in these data. furthermore, a closely related species, aedes aegypti, has a well-annotated genome  <cit> , which provides protein and genomic reference scaffolds for improving de novo transcriptome assembly with reference-based re-assembly and transps methods. in addition, a draft genome sequence for ae. albopictus has recently been published  <cit> , which allows for a genome-guided assembly. finally, the more completely assembled and annotated ae. aegypti genome assembly provides an excellent opportunity to evaluate the efficacy and accuracy of using a closely related reference genome to guide transcriptome assembly.

no study has thus far compared de novo assembly with both transcriptome re-assembly via protein reference scaffolding  and genome-guided assembly simultaneously. this study utilized a comprehensive transcriptomic database of ae. albopictus to investigate the optimal transcriptome assembly strategy, comparing four assembly methods: a) de novo assembly using trinity  <cit> , b) reference-based re-assembly using proteomic and genomic resources from ae. aegypti, c) transps  <cit>  using the ae. aegypti proteome and d) genome-guided assembly by cufflinks  <cit>  using the recently sequenced ae. albopictus genome and the well-annotated ae. aegypti genome. the quality of the various assemblies was assessed by the number of contigs generated, contig length distribution, percent paired-end read mapping, and gene model representation via blastx  <cit> . we also examined differences between the gene models identified by each assembly strategy to determine whether unique subsets of gene models were identified by each method. in addition, we examined how the amount of data  affected these quality metrics of the assembly. results from this study are particularly relevant to non-model organisms with genomic resources from a closely related species. furthermore, the genome assembly of ae. albopictus is fragmented due in part to its large size  and high composition  of repetitive elements  <cit> . however, this assembly is comparable to other published insect genomes  <cit> , and therefore results from this study can be extended to emerging model organisms with a more fragmented genome assembly compared to traditional model organisms.

methods
rna-seq data
cleaned rna-seq paired-end reads from pooled tissue samples described in previous publications from this laboratory were used for this study. these data include reads from developing embryos  <cit> , pharate larvae  <cit>  and adults  <cit>  of ae. albopictus under diapause and non-diapause conditions . general procedures for generating these rna-seq reads from ae. albopictus have been described previously  <cit> . quality filtering of the rna-seq raw reads was consistent across studies and described in detail in previous publications from this laboratory  <cit> .  <dig> , <dig> cleaned read pairs were obtained from the developing embryos,  <dig> , <dig> cleaned read pairs were obtained from the pharate larvae and  <dig> , <dig> cleaned read pairs were obtained from the adult stage. in order to investigate the effect of data quantity on the quality of the assembled transcriptome, read pairs from the three life stages  were partitioned into three datasets containing increasing number of read pairs. we included reads from all three life stages in each dataset to maximize representation of expressed genes in the analysis. the smallest dataset, termed 180 m, was comprised of  <dig> , <dig> read pairs, taken from one biological replicate from all experimental treatments  in each life stage. in cases where the libraries had been sequenced on different runs, the largest libraries from one lane in each run were included. the amount of data in the 180 m dataset is the yield of approximately two lanes of illumina hiseq  <dig> sequencing. the medium dataset, termed 360 m, was comprised of  <dig> , <dig> read pairs, taken from the remaining biological replicates of each treatment and life stage. the amount of data in the 360 m dataset is the yield of approximately four lanes of illumina hiseq  <dig> sequencing. the largest dataset, termed 600 m, was comprised of  <dig> , <dig> read pairs, taken from all sequencing lanes and runs across all treatments and life stages. the amount of data in the 600 m dataset is the yield of approximately seven lanes of illumina hiseq  <dig> sequencing. the transcriptome assembly strategies utilized in this study and described below were applied to all three datasets .fig.  <dig> flow chart for the experimental design of this study. three datasets, 180 m, 360 m and 600 m, were used for each of the four assembly strategies described in the text. subsequently, all fourteen assemblies were assessed by the metrics contig number and length distribution, percent paired-end reads mapped back to the assembly and gene model representation. de novo stands for de novo assembly, ref-based for reference-based re-assembly, transps for transcriptome post-scaffolding, and g. guided for genome-guided assembly



transcriptome assembly strategies
de novo assembly
trinity  was used for de novo assembly. reads were in silico normalized with the option --normalize_max_read_cov  <dig> . in addition, --min_kmer_cov  <dig> and --min_contig_length  <dig> were used to reduce memory footprint and discard contigs shorter than 200 bp, respectively. in all other respects, default parameters were used. after trinity assembly, redundant contigs with over 99 % identity were eliminated using cd-hit-est  <cit> .

reference-based re-assembly
after de novo assembly by trinity, reference-based re-assembly was performed as described in detail in previous publications  <cit> . the annotated ae. aegypti protein sequences  were used as the protein reference for the reference-based re-assembly, in order to provide a consistent comparison with transps. the ae. aegypti genome scaffolds  and gene annotations  used as the genomic reference were downloaded from vectorbase  <cit> . custom perl scripts for reference-based re-assembly are available upon request.

transcriptome post-scaffolding 
after de novo assembly by trinity, transps re-assembly  <cit>  was performed using default parameters according to the authors’ instructions. the ae. aegypti proteome was selected as the scaffolding reference, because ae. aegypti is in the same sub-genus  as ae. albopictus and the most closely related species with well-documented genomic information. because transps is developed for the assembly of strand-specific rna libraries , contigs in the reverse complement orientation to the protein references were first transformed to the same orientation as the protein references based on blastx results. all correctly oriented contigs were then searched against the protein references using blastx. contigs that matched the protein references  were re-assembled by transps using default parameters.

genome-guided assembly - ae. albopictus reference genome
the genome assembly of ae. albopictus  <cit>  was used as the genomic reference. this assembly is comprised of ~ <dig>  scaffolds, with an n <dig> of ~200 kb  <cit> . the tuxedo suite  <cit> , including bowtie, tophat and cufflinks, was used for genome-guided assembly. for each dataset, reads from distinct life stages were first separately mapped to the genome by tophat , to minimize the frequencies of snps and computational power required  <cit> . mapped reads were assembled by cufflinks , and subsequently merged by cuffmerge. the default parameters were used except in cases specified in parentheses above. to be consistent with the other assembly strategies, only contigs longer than 200 bp were retained. after genome-guided assembly, redundant contigs with over 99 % identity were eliminated using cd-hit-est  <cit> .

genome-guided assembly - ae. aegypti reference genome
using the 180 m dataset, the genome assembly of ae. aegypti  <cit>  was used as the genomic reference. this assembly is comprised of  <dig>  scaffolds, with an n <dig> of ~ <dig>  mb . the tuxedo suite  <cit> , including bowtie, tophat and cufflinks, was used for genome-guided assembly. reads from distinct life stages were first separately mapped to the genome by tophat using recommended procedures , assembled by cufflinks , and subsequently merged by cuffmerge. a reference annotation file for ae. aegypti  was incorporated into cuffmerge  to guide the assemblies, as researchers would likely take advantage of the existing annotations. cuffmerge was also performed without reference annotation. the default parameters were used except in cases specified in parentheses above. to be consistent with the other assembly strategies, only contigs longer than 200 bp were retained. after genome-guided assembly, redundant contigs with over 99 % identity were eliminated using cd-hit-est  <cit> .

comparison between genome-guided assemblies using two reference genomes
using the 180 m dataset, genome-guided assemblies using the ae. albopictus and ae. aegypti  genomes were aligned to both ae. albopictus and ae. aegypti genomic scaffolds via blastn . custom perl scripts were used to calculate percent identity and contig coverage from the alignment results.

quality metrics
contig number and length distribution
fewer and longer contigs lead to more accurate and efficient downstream read mapping. this will in turn optimize subsequent genetic analyses, such as differential gene expression analysis, snp calling, and novel transcript or splice variant discovery. the number of contigs generated by each assembly method was recorded and the contig length distribution was represented by the median contig length. all contigs from de novo assemblies  were aligned against the ae. aegypti gene models with and without multiple isoforms using blastx . contigs with greater than or equal to 70 % identity to the gene models and all isoforms were counted and aggregated for each dataset . unannotated contigs from the reference-based re-assemblies were aligned to the ae. albopictus genomic scaffolds using blastn . custom perl scripts were used to calculate percent identity, alignment length and contig coverage.

read mapping
a high percentage of reads mapping back to the transcriptome assembly is desirable for accurate downstream analyses, such as differential gene expression analysis, snp calling, and novel transcript or splice variant discovery. this is because more reads mapped back to the assembly will result in increased statistical power for performing these analyses. paired-end reads from each dataset and assembly method were mapped back to the corresponding assembly using bowtie  <dig> . the percentage of total reads that mapped back and reads that uniquely mapped back to the assemblies was recorded.

gene model representation
measures of gene model representation described below include the number of gene models identified in the transcriptome, percent identity between the contigs and reference gene models, and percent reference coverage by the contigs.

number of gene models
a higher number of gene models represented in the transcriptome assembly provides a basis for more comprehensive analysis of the transcriptome under a certain experimental condition. to test the representation of gene models by the transcriptome assemblies, contigs were aligned using blastx to the ae. aegypti proteome . to provide a second benchmark and minimize potential bias towards reference-based re-assembly and transps, the assemblies were also aligned using blastx to a non-redundant dipteran protein reference set. this dipteran protein reference set was generated by downloading orthologous protein sequences from ae. aegypti, culex quinquefasciatus, anopheles gambiae and drosophila melanogaster from orthodb  <cit> , version  <dig> , with one single ortholog retained per ortholog group in the order specified above . the final reference set contained  <dig>  protein sequences, and represented a wide range of evolutionary diversity within diptera with little redundancy. the best blastx matches with e-value smaller than 1e- <dig> were retained . custom perl scripts were used to calculate the number of unique gene models represented in the transcriptome assemblies. in order to identify putative orthologs, reciprocal blast was performed for assemblies using the 180 m dataset against the ae. aegypti protein reference set. assemblies were searched against the reference set using blastx  and the reference set was searched against the assemblies using tblastn . the reference gene model identified as the best match for a contig by blastx was designated as a reciprocal best hit , a potential ortholog, if the contig was identified as the best match for the gene model by tblastn. we didn’t include contigs from the genome-guided assembly using the ae. aegypti reference genome because of its bias towards the ae. aegypti genomic scaffolds . we performed reciprocal blast for assemblies using the 180 m dataset against the ae. aegypti protein reference set because we have found that the 180 m dataset is adequate for downstream transcriptome analyses , and the ae. aegypti and dipteran protein reference sets yield similar results .table  <dig> summary statistics for transcriptome assemblies from multiple strategies


genome-guided assembly using ae. aegypti genome + rab

adataset representing approximate number of millions of read pairs used in the corresponding assembly strategy


bra refers to reference annotation



the number of gene models identified by each assembly method using the 180 m dataset from the two reference protein sets was visualized as quadruple venn diagrams, constructed by the venndiagram package in the r software environment . genome-guided assembly using the ae. aegypti reference genome was not included in this analysis because of the above-mentioned bias. the 360 m and 600 m datasets were not used in this analysis because each assembly method generated similar numbers of gene models across all three datasets  for each of the two reference protein sets . the unique gene models identified by de novo and genome-guided assemblies were tested for enrichment of specific gene ontology  terms and kegg pathways using the bioconductor goseq package  <cit>  in r. go terms for the dipteran gene models were obtained from ensembl metazoa  <cit> . kegg pathway assignments for the dipteran organisms in the two reference protein sets were obtained from kegg api  <cit> . because go terms and kegg pathways only correspond to genes rather than specific isoforms, isoforms were consolidated within each gene model in the enrichment analyses.

percent identity
a higher median percent identity  indicates higher confidence in annotating the ae. albopictus contigs as putative orthologs of the reference gene models, which is important for interpreting downstream analyses. custom perl scripts were used to calculate the pid between contigs and their best blastx matches.

reference coverage
a high coverage of the reference gene models by assembled contigs indicates that the annotated gene models are well represented in the ae. albopictus transcriptome, which leads to high confidence in accurate subsequent genetic analyses. custom perl scripts were used to calculate the percent coverage for the protein reference in each match .

RESULTS
due to the substantial computational requirements of performing transcriptome assembly with some of the methods considered in this study and the large rna-seq datasets we analzyed, it was only feasible to perform one assembly for each method and dataset. therefore, we discuss the absolute magnitude of clear differences and/or high similarities between the assembly methods and between datasets  within assembly methods.

contig number
consistently across all three datasets, de novo assembly produced the largest numbers of contigs, followed closely by reference-based re-assembly. genome-guided assembly using the ae. albopictus reference genome produced less than half the number of contigs produced by de novo assembly. genome-guided assembly using the 180 m dataset and the ae. aegypti genome produced similar number of contigs relative to transps, but fewer than other assembly methods . transps produced the smallest numbers of contigs, with over 87 % reduction in the number of contigs relative to de novo assembly . consistently across all assembly strategies performed using three datasets, increasing the amount of input read pairs used in the transcriptome assembly led to an almost two-fold increase in the number of contigs generated, except for transps, where the increase was minimal . the number of contigs aligned to annotated gene models and isoforms did not increase substantially with increasing number of read pairs in the datasets . more than 84 % of the unannotated contigs aligned to the ae. albopictus genomic scaffolds, with high median percent identity  and contig coverage  by the genomic scaffolds, though with short median alignment length .

contig length distribution
with reference annotation, genome-guided assembly using the ae. aegypti genome generated contigs longer than any other assembly method, except for transps . without reference annotation, genome-guided assembly using the ae. aegypti reference genome generated the shortest contigs . consistently across three datasets among all other assembly methods, de novo assembly and reference-based re-assembly generated similar and the smallest median contig lengths. genome-guided assembly using the ae. albopictus reference genome generated median contig lengths more than twice as long as those by de novo assembly and reference-based re-assembly. finally, the transps assembly generated the greatest median contig length with a more than four-fold increase relative to de novo assembly and reference-based re-assembly . within each assembly strategy performed using three datasets, increasing the amount of read pairs used in the transcriptome assembly slightly decreased the median contig length, with the exception of transps, which generated slightly greater median contig lengths with more input read pairs .

paired-end read mapping
consistently across all three datasets, de novo assembly, reference-based re-assembly and genome-guided assembly using the ae. albopictus reference genome produced a similar percentage of paired-end reads mapped back, ranging from  <dig>  to  <dig>  % . less than 80 % of the paired-end reads mapped back to the transps assemblies . genome-guided assembly using the ae. aegypti reference genome had the lowest percentage of reads mapped back . when considering uniquely mapped reads, de novo assembly and reference-based re-assembly had a similar percentage of reads uniquely mapped back and transps had a slightly higher percentage of reads uniquely mapped back . genome-guided assembly using the ae. albopictus reference genome had a much lower percentage of reads uniquely mapped back  and genome-guided assembly using the ae. aegypti reference genome had the lowest percentage of reads uniquely mapped back . within each assembly strategy performed using three datasets, increasing the amount of read pairs used in the transcriptome assembly did not have a large or consistent effect on the read mapping percentage.fig.  <dig> percentage of paired-end reads mapping back to the assembly. datasets  and assembly strategies as described in fig.  <dig>  gg/albo refers to genome-guided assembly using the ae. albopictus reference genome and gg/aeg refers to genome-guided assembly using the ae. aegypti reference genome. +ra refers to genome-guided assembly using the ae. aegypti genome with reference annotation, and -ra refers to genome-guided assembly using the ae. aegypti genome without reference annotation



number of gene models
for all datasets, most assemblies produced similar numbers of gene models from both ae. aegypti and dipteran protein reference sets , with the number of dipteran gene models generated by transps assemblies slightly lower than the other methods . the exceptions were that genome-guided assembly using the ae. aegypti reference genome with reference annotation produced the highest numbers of both ae. aegypti and dipteran gene models and that genome-guided assembly using the ae. aegypti reference genome without reference annotation produced the lowest numbers of both ae. aegypti and dipteran gene models . within each assembly strategy performed using three datasets, increasing the amount of input read pairs led to a very slight increase in the number of ae. aegypti gene models represented in the assembly , although increased input read pairs did not have an apparent effect on the number of dipteran gene models represented in the assembly . the number of gene models discovered from the dipteran protein reference set was smaller than that from the ae. aegypti protein reference set, which is expected due to the closer relationship of ae. albopictus to ae. aegypti relative to the other species in the dipteran protein reference set. using the 180 m dataset, transps generated the highest percentage of rbhs, and the largest number of potential orthologs, amongst all assembly methods, the rest of which performed similarly . genome-guided assembly using the ae. albopictus reference genome had the highest median alignment length when searched against the ae. aegypti protein reference set . the protein reference set had the highest median alignment length when searched against the transps assembly .fig.  <dig> number of gene models identified from the ae. aegypti reference protein set in all assemblies. datasets and assembly strategies as in fig. 2




using the 180 m dataset, reference-based re-assembly and transps identified the same subsets of gene models identified by de novo assembly, with very few exceptions . this result is expected because these two methods are both re-assembly strategies performed after de novo assembly. also using the 180 m dataset, the de novo assembly and genome-guided assembly using the ae. albopictus reference genome identified  <dig>  and  <dig> unique gene models relative to each other from the ae. aegypti reference protein set, respectively . finally, the de novo assembly and genome-guided assembly using the ae. albopictus reference genome identified  <dig>  and  <dig> unique gene models relative to each other from the dipteran reference protein set, respectively, using the 180 m dataset . in all cases, the unique gene models were not enriched for specific go terms or kegg pathways .fig.  <dig> intersection of ae. aegypti gene models identified by all assembly strategies using the 180 m dataset. assembly strategies as in fig.  <dig>  except that g.guided refers to genome-guided assembly using the ae. albopictus reference genome



percent identity
genome-guided assembly using the ae. aegypti reference genome generated contigs with the perfect  median percent identity  to corresponding ae. aegypti and dipteran gene models . consistently across three datasets among all other assembly methods, transps generated contigs with the highest median pid to corresponding ae. aegypti and dipteran gene models, followed closely by reference-based re-assembly, de novo assembly and genome-guided assembly using the ae. albopictus reference genome, the latter three with similar pid values . within each assembly strategy performed using three datasets, increasing the amount of read pairs used in the transcriptome assembly decreased median pid to both ae. aegypti and dipteran gene models.

reference coverage
median reference coverage by ae. albopictus contigs for both ae. aegypti and dipteran gene models was high  and similar across most transcriptome assembly strategies using each dataset . genome-guided assembly using the ae. aegypti reference genome with reference annotation produced the highest median reference coverage . the exception was that genome-guided assembly using the ae. aegypti reference genome without reference annotation produced the lowest median reference coverage .

genome-guided assembly - ae. albopictus genome versus ae. aegypti genome
contigs from the genome-guided assembly using the ae. albopictus reference genome resembled the ae. albopictus genomic scaffolds , rather than the ae. aegypti genomic scaffolds . on the contrary, with reference annotation, contigs from the genome-guided assembly using the ae. aegypti reference genome resembled the ae. aegypti genomic scaffolds , rather than the ae. albopictus genomic scaffolds . this result likely indicates the presence of ancestral polymorphism in the ae. albopictus genome after  <dig>  million years of divergence from ae. aegypti  <cit>  and emphasizes the limitation of using a closely related reference genome for guiding transcriptome assembly with the tuxedo suite workflow.

discussion
transcriptome assembly is a crucial first step for transcriptome analyses using rna-seq data. with the rapid development in the ngs technologies, genomic and transcriptomic resources have accumulated rapidly for a wide range of organisms. however, deciding on the optimal transcriptome assembly strategy for non-model organisms remains a challenge, especially with the large amount of data generated by ngs. this study is the first to compare de novo assembly with genome-guided assembly, reference-based re-assembly and transps, the latter two methods representing transcriptome re-assembly using protein sequences from closely related species. this study is also one of the first to compare genome-guided assembly using a reference genome from the focal study organism and a reference genome from a closely related species. our analysis takes advantage of three datasets with increasing numbers of illumina paired-end reads.

a previous study  <cit>  used genomic contigs from the same species or genomic scaffolds from a closely related species  as a scaffold to re-assemble de novo contigs generated from rna-seq reads. results from this study  <cit>  showed that genomic sequences from the same species or closely related species can improve the representation of full-length reference transcripts by the de novo transcriptome assembly. however, high coverage genomic sequences are often not available together with rna-seq reads, as high coverage whole genome sequencing is still expensive, especially for species with a large genome. in addition, genomic resources from closely related species with higher than 90 % identity are relatively rare. in contrast, this study used protein sequences from a more distantly related species  as the reference scaffolds. this study also considered genomic scaffolds from ae. aegypti with 80–85 % identity at the nucleotide level relative to the comparison noted above. thus, both re-assembly approaches used in this study  are likely to apply to a wide range of organisms. although the optimal assembly strategy will depend upon the purpose and downstream analyses of the specific study, our analysis provides general guidance that is likely to be useful to researchers conducting transcriptome analyses in non-model organisms.

de novo assembly - trinity
trinity, which has been optimized for runtime performance  <cit> , has been demonstrated to be an effective de novo transcriptome assembler  <cit> . trinity de novo assembly performed similarly to genome-guided assembly using the ae. albopictus reference genome in terms of percent read mapping back to the assembly and gene model representation, though not in terms of contig number or length distribution. one of the advantages of de novo assembly is that gene models can be assembled that may not be assembled by a genome-guided method if the reads cannot be mapped back to the current genomic scaffolds due to improper scaffold assembly . it is straightforward and fast  to perform the trinity assembly pipeline using high quality rna-seq reads, though it typically requires a large amount of memory . thus, trinity will usually require a high performance computing cluster or the cloud environment. trinity incorporates all reads simultaneously without the need to separately perform assemblies of reads from different life stages or environmental conditions. the assemblies generated by the trinity de novo method had high read mapping percentage, and represented a substantial number of gene models with high median pid and coverage. identifying more total gene models, including paralogs, can be more beneficial for downstream differential gene expression and enrichment analyses, because most paralogs have similar biological functions and are included in gene ontology and kegg pathways. trinity assemblies had slightly lower unique mapping rates than transps assemblies, but because read mapping programs, such as rsem  <cit> , take into account reads mapped to multiple gene models, total read mapping rates are more informative than unique mapping rates for most downstream analyses. therefore, the trinity assemblies would be suitable for subsequent differential gene expression analysis, snp discovery in coding regions, and also novel transcript or splice variant discovery. however, the trinity assemblies contain more redundancy relative to assemblies generated by genome-guided and transps methods. redundant contigs represent highly similar sequences corresponding to the same reference and are in part due to the fact that rna-seq was performed on mrnas from tissue samples that were pooled from multiple individuals, a common practice in rna-seq studies. the increased redundancy of the trinity assemblies is reflected in the larger number of contigs, but similar number and coverage of reference gene models relative to the other assembly methods. the redundancy within the de novo assembly increased with increasing amount of input read pairs, primarily due to the increase in unannotated rather than annotated contigs . these unannotated contigs align to unannotated protein coding sequences and non-coding sequences, including 5′ and 3′ untranslated regions.

reference-based re-assembly
our previous study  <cit>  has demonstrated that reference-based re-assembly can improve de novo assembly in terms of contig number and length distribution. however, in the current study, reference-based re-assembly performed similarly to de novo assembly using trinity . there are two likely reasons for this result. first, different versions of trinity were used in the previous and the current studies, and the latter is an improved version. second, our previous study only used short rna-seq reads from the adult stage for the de novo assembly, which were then combined with previous contigs from other life stages in a reference-based re-assembly, including contigs assembled from  <dig> sequencing reads. however, the current study assembled short illumina rna-seq reads from all life stages into a de novo assembly. the contigs from this de novo assembly were then used in the reference-based re-assembly, but were not combined with any previously assembled contigs. the advantage of reference-based re-assembly is that it can combine contigs from previous studies under different environmental conditions using different sequencing platforms  <cit> , which makes the re-assembly less computationally demanding and more flexible. furthermore, reference-based re-assembly can incorporate both protein and genomic sequences from closely related species, maximizing the information provided by reference scaffolding. however, reference-based re-assembly is more complicated to perform than the straightforward trinity de novo assembly pipeline because it involves using several custom perl scripts for the re-assembly, generally taking approximately 2 weeks to complete after de novo assembly.

transps
in the current study, we used a reference proteome from ae. aegypti. as mentioned above, ae. aegypti is in the same sub-genus  as ae. albopictus. this is similar to the level of divergence between one of the organisms  and its reference  used in the original study  <cit> . transps reduced the number of contigs by more than 87 %, a result similar to the original description of this method  <cit> . transps also produced the longest contigs with more than a four-fold increase in the median contig length relative to de novo assembly and reference-based re-assembly , with minimal redundancy. thus, the transps assemblies had the lowest number of contigs per gene model among all four assembly methods. moreover, the median coverage for reference gene models by transps assemblies was the highest amongst all methods , except for the genome-guided assembly using the ae. aegypti genome with reference annotation , indicating that transps assemblies had almost complete representation for the reference coding sequences. transps assembly also had the highest percentage of reciprocal best hits . out of  <dig>  ae. aegypti gene models,  <dig>  are at least 70 % identical to other gene models , with median percent identity of  <dig>  % and median coverage of  <dig>  %. because transps generated the longest contigs  by also merging contigs with non-overlapping alignments to the same gene model, the transps contigs can better distinguish small differences between highly similar gene models, thereby identifying the most rbhs . this advantage is reflected in the longest median alignment length when searching the reference set against the assemblies , not when searching the assemblies against the reference set . however, the overall number of gene models and read mapping percentage of the transps assemblies were slightly lower than the other three strategies, which could limit some downstream analyses such as differential gene expression analysis, snp discovery, or novel transcript and splice variant discovery. this result is likely due to the algorithm used by transps to re-assemble the de novo assembly via protein sequences from a closely related species, without the untranslated regions or non-coding sequences in the genomic scaffolds utilized by the reference-based re-assembly or genome-guided assembly. on the other hand, because transps had the highest percentage of reads uniquely mapped back, which enables accurate identification of orthologs, transps may be preferable for other downstream analyses, such as phylogenomic studies. a few thousand complete and orthologous genes from each transcriptome will be sufficient to construct a phylogeny with high confidence . identifying the largest number of potential orthologs via reciprocal blast further strengthens the advantage of using transps for phylogenomic studies. as described in the methods section, transps is developed specifically for assembly of strand-specific libraries, and therefore extra steps are required if the initial assembly  is generated from non-strand-specific sequencing reads. while the transps script took an hour to finish, generating the necessary blastx outputs and the extra steps necessary to handle non-strand-specific sequencing reads took approximately 2 weeks to complete.

genome-guided assembly - cufflinks: ae. albopictus reference genome
the number and reference coverage of gene models generated by the genome-guided method using the ae. albopictus reference genome were very similar to those produced by de novo assembly and reference-based re-assembly. however, genome-guided assemblies using the ae. albopictus reference genome produced less than half of the number of contigs generated by de novo assembly and reference-based re-assembly , indicating that this assembly produced lower redundancy relative to these two methods. in addition, genome-guided assemblies using the ae. albopictus reference genome produced median contig lengths more than twice as long as those produced by de novo assembly and reference-based re-assembly . furthermore, genome-guided assembly is much less computationally demanding than de novo assembly. genome-guided assembly using cufflinks requires the most computational resources during read mapping to the genome. in this study, up to 72gb of ram was used for the read mapping using tophat and up to 36gb of ram was used for the cufflinks genome-guided assembly. it took approximately 1 week to complete read mapping and assembly using the pipeline. another advantage of genome-guided assembly is that transcripts with low sequencing coverage can be assembled if the reads can be mapped to the genomic scaffolds, which can lead to unique gene models assembled relative to de novo assembly . however, genome-guided assembly using the ae. albopictus reference genome performed similarly to those generated by de novo assembly and reference-based re-assembly in terms of percent read mapping back to the assembly and gene model representation, and had the lowest unique mapping rates. this is likely because of the fact that the current ae. albopictus genome assembly is relatively fragmented, largely due to its huge genome size and high composition of repetitive elements in the genome  <cit> . however, the fragmented assembly of the ae. albopictus genome  is similar to other insect genomes. for example, the sand fly genome, phlebotomus papatasi, has  <dig>  scaffolds with an n <dig> of  <dig>  bp  <cit> . therefore, our current results are likely relevant to a wide range of organisms with similarly fragmented genome assemblies. genome-guided assemblies can be suitable for differential gene expression analysis and snp discovery, but may be less desirable for novel transcript and splice variant discovery, because only reads aligned to the known splice junctions can be assembled.

genome-guided assembly - cufflinks: ae. aegypti reference genome
ae. aegypti is a closely related species in the same sub-genus  as ae. albopictus. ae. aegypti has well-annotated genomic resources and a much less fragmented genome assembly, which helps to identify more complete gene models . however, using the ae. aegypti rather than the more fragmented ae. albopictus genome to guide transcriptome assembly can be problematic. genome-guided assembly using the ae. aegypti reference genome produced contigs that resemble the ae. aegypti genomic scaffolds, rather than the ae. albopictus genomic scaffolds . this result is reflected by the low percentage of reads mapped back, perfect median percent identity and reference coverage values of contigs from the genome-guided assembly using the ae. aegypti genome with reference annotation .

combination of de novo and genome-guided assemblies
assemblies generated by the de novo and genome-guided methods identified a small number of unique gene models relative to each other, which is consistent with a previous study  <cit> . therefore, it might be beneficial to combine genome-guided and de novo assemblies, as proposed previously  <cit> . when the genome reference is not well assembled, de novo assembly should be performed first, followed by aligning contigs from the de novo assembly to the genome reference in order to extend and scaffold the contigs  <cit> . however, if the annotation of the genome is not complete, additional annotation based on orthologs will still be necessary. as a proof of concept, we combined de novo assembly and genome-guided assembly using the ae. albopictus reference genome for the 180 m dataset. the combined assembly encompassed almost all ae. aegypti and dipteran gene models from the two separate assemblies . this result indicates that combining the de novo and genome-guided assemblies can generate a more comprehensive transcriptome assembly in terms of number of gene models identified.

effect of the number of reads on assembly quality
the quantity of input read pairs increased the redundancy within the assembly, and decreased both median contig length and pid, whereas it did not have a clear effect on other quality metrics, i.e., percent read mapping and gene model representation. this is likely due to the increasing number of mismatches in the larger datasets caused by snps from the pooled tissue samples and/or sequencing errors. these mismatches caused difficulties for the assembly programs to consolidate highly similar contigs. this in turn increased the number of contigs generated , and reduced both the median contig length and pid. therefore, it will generally be beneficial and cost-effective to use fewer reads . the exception was transps, which generated slightly longer contigs with more input read pairs . this is likely because the algorithm used in transps that assembles contigs that have non-overlapping matches to the same reference, thereby creating longer contigs  <cit> .

CONCLUSIONS
our results emphasize the efficacy of de novo transcriptome assembly using high quality illumina rna-seq reads and the importance of genome assembly and annotation for genome-guided assembly. despite generating a more fragmented transcriptome assembly, de novo assembly performed similarly to genome-guided assembly using the ae. albopictus reference genome in terms of read mapping and gene model representation. with high quality reads, de novo assembly can prove to be effective for organisms without a genome sequence, or for organisms with a fragmented genome assembly relative to traditional model organisms. a recent study points out that even with well curated human and worm genomes, de novo assembly still performs similarly to genome-guided assembly in terms of sensitivity in constructing the transcriptome using simulated data  <cit> . previous studies have demonstrated a better performance by genome-guided assembly than de novo assembly  <cit> . however, this study showed that, if the genome assembly is fragmented and/or genome annotation is incomplete, de novo assembly can perform similarly to or even outperform genome-guided assembly in terms of read mapping back to the assembly and gene model representation. researchers need to be cautious when using a closely related reference genome to guide transcriptome assembly, because the resulting assembly can be biased towards the closely related genome rather than the focal genome. in our analysis, this result occurred when using a reference genome from the same sub-genus with approximately  <dig> million years of divergence . reference-based re-assembly performed similarly to de novo assembly, whereas transps generated the longest contigs with higher reference coverage, least redundancy and largest number of potential orthologs . however, transps also produced assemblies with the lowest percent read mapping and number of gene models identified. our results also reveal that the amount of input read pairs tended to reduce the quality of the resulting transcriptome assembly. thus, 180 m high quality paired-end reads will usually be sufficient to generate a transcriptome assembly appropriate for downstream analyses. the optimal transcriptome assembly strategy is dependent upon intended downstream analyses, but in general, trinity de novo assembly with 180 m high quality read pairs is suitable for most downstream transcriptome analyses, especially for organisms without a genome sequence. if a genome assembly is present, it can be beneficial to combine de novo and genome-guided assemblies when the computational resources are available.

abbreviations
go, gene ontology; ngs, next-generation sequencing; pid, percent identity; rbh, reciprocal best hit; rna-seq, rna-sequencing; snp, single nucleotide polymorphism; stm, scaffolding using translation mapping; transps, transcriptome post-scaffolding.

additional files
additional file 1: similarity of genome-guided assemblies using the 180 m dataset to reference genome assemblies. percent identity to and contig coverage by the aedes albopictus or aedes aegypti genomic scaffolds characterized by blastn searches . a: comparisons between genome-guided assembly using the ae. albopictus genome assembly or the ae. aegypti genome assembly and the ae. albopictus genomic scaffolds. b: comparisons between genome-guided assembly using the ae. albopictus genome assembly or the ae. aegypti genome assembly and the ae. aegpyti genomic scaffolds. albopictus g.guided: genome-guided assembly using the ae. albopictus genome; aegypti g.guided: genome-guided assembly using the ae. aegypti genome with reference annotation; albopictus scaffolds: genomic scaffolds of ae. albopictus; aegypti scaffolds: genomic scaffolds of ae. aegypti. 

additional file 2: number of gene models identified from the dipteran reference protein set in all assemblies. datasets and assembly strategies as in fig.  <dig>  

additional file 3: intersection of dipteran gene models identified by all four assembly strategies using the 180 m dataset. assembly strategies as in fig.  <dig>  except that g.guided refers to genome-guided assembly using the ae. albopictus reference genome. 

additional file 4: alignment to ae. aegypti gene models and ae. albopictus genomic scaffolds by contigs in the de novo assemblies and reference-based re-assemblies with increased number of input read pairs. for de novo assemblies: dataset used, number of contigs, the total number of contigs supporting ae. aegypti gene models with multiple isoforms, the total number of contigs supporting ae. aegypti gene models with a single isoform and the total number of contigs supporting all isoforms. support is characterized as the best blastx match  with percent identity > = 70 %. for unannotated contigs from the reference-based re-assemblies: dataset used, number of contigs, total number of contigs aligning to the ae. albopictus genome , median percent identity of the matches, and median alignment length with the median contig coverage in parentheses. 

additional file 5: total and unique read mapping percentages. dataset used in, percentage of total reads and percentage of reads uniquely mapped back to the transcriptome assemblies generated in this study. 

additional file 6: number and percentage of gene models identified by reciprocal blast and median alignment length. for various transcriptome assembly methods: dataset used, number of ae. aegypti gene models identified by blastx, percentage of ae. aegypti gene models identified by reciprocal blast , median alignment length from blastx and tblastn. all blast matches have e-value < 1e- <dig> and percent identity > = 70 %. 



