BACKGROUND
an understanding of the factors that influence the reproducibility, and therefore the predictability, of adaptation is of fundamental importance to any evolutionary theory of biological diversity. for example, divergence among populations can be caused by adaptation to different environments, or by chance differences in evolutionary history such as mutational order and drift, which may constrain subsequent evolution and promote divergence even when populations evolve in and adapt to the same environment  <cit> . traditionally, these processes were studied by comparing extant populations and attempting to correlate organismal traits with environmental parameters to infer the action of selection  <cit> . experimental studies complement the comparative approach by allowing evolutionary dynamics to be monitored in real time, including controlled tests to examine the effects of environmental conditions on evolutionary processes and outcomes .

in recent years, a number of evolution experiments have been performed with microbes to examine the extent of divergence among replicate populations, often finding evidence of striking parallel evolution at phenotypic and even genetic levels  <cit> . however, most of these studies compared populations adapting to constant and uniform environments. hence, the effects of environmental heterogeneity, an important factor in the evolution of natural populations, were not addressed. those studies that included heterogeneity have tended to focus on its effect on within-population dynamics, particularly on how it influences the evolution of specialist and generalist phenotypes  <cit> . how environmental heterogeneity affects among-population dynamics, in particular the reproducibility of evolutionary trajectories, has received only limited attention .

wright's metaphor of an adaptive landscape provides a framework for considering the adaptation and divergence of populations  <cit> . this landscape is typically visualized as a two-dimensional representation of the highly multi-dimensional genetic space, onto which a fitness surface is projected. the relative height of this surface represents the fitness of an organism with a particular genotype. natural selection, then, typically pushes populations toward peaks with high fitness. in the simplest case, the adaptive landscape has only one fitness peak, such that replicate populations should eventually converge on the same solution . however, if interactions exist between mutations, such that the fitness effect of any one mutation depends on whether or not another one is already present , then the landscape may be more rugged, with multiple peaks separated by valleys  <cit> . in this case, several different local peaks might be accessible to a population starting at a given point in genetic space, depending on the order in which beneficial mutations arise that escape loss by random drift. natural selection inhibits movement of populations between peaks separated by intermediate types having lower fitness; therefore, rugged landscapes increase the probability that replicate populations will diverge toward distinct adaptive peaks.

besides the intrinsic interactions between mutations, a key extrinsic factor that has been suggested to influence the ruggedness of an adaptive landscape is environmental heterogeneity  <cit> . for example, if there are genetic trade-offs in the ability of an organism to adapt simultaneously to two resources, then temporal fluctuations between the resources might create a composite landscape having more fitness peaks than were present in either single resource environment, which would then promote divergence among populations  <cit> . in a related vein, wright's model of "mass selection under changing conditions" invokes temporal changes in the environment as a process that can facilitate the movement of evolving populations between different fitness peaks  <cit> .

here, we aim to extend previous evolution experiments by considering the effect of environmental heterogeneity on the adaptation and divergence of replicate populations, where that heterogeneity reflects both the number  and the presentation  of resources. to this end, we propagated  <dig> populations of escherichia coli for  <dig> generations in  <dig> defined environments differing in resource identity, number, and presentation. after this time, the fitness of each evolved population was measured relative to the common ancestor in several environments, and statistical analyses were performed to determine the effect of the selective environment on the extent of adaptation and degree of fitness divergence among replicate populations.

RESULTS
direct fitness response in different environments
*;one-tailed t-test. the null hypothesis is that the mean fitness equals  <dig> . sem values are based on the  <dig> replicate populations in each treatment group, except for the mal group which had only  <dig> surviving replicates.

†values that remain significant  following sequential bonferroni correction for the four tests performed within each resource set are shown in bold.

‡the glu group is repeated for clarity.

next, we sought to assess whether the average fitness gains differed among the groups evolved in the different environments. to do this, we performed one-way anovas for the glu&mal and glu&lac selection sets, nesting population under the resource environment. this analysis showed that populations that evolved under the different environments varied in the extent to which their fitness had increased . we then performed pairwise comparisons between the treatment groups within each of the two sets . in five of the twelve pairwise comparisons, the difference in the average fitness gains between groups was statistically significant after applying a sequential bonferroni correction. the glu group had the smallest improvement of all groups. the mal and lac groups had larger direct fitness responses than the groups evolved in the corresponding mixed environments containing the same resources, although this difference was only significant for the lac group. fitness increases between alternating and simultaneous presentations of the two resource combinations were not significantly different in either the mal or lac set of environments. it is also interesting to note that in comparisons between the two resource sets, the groups in the glu&lac set tended to have larger fitness increases than the corresponding groups in the glu&mal set .

*two-tailed t-test.

†values that remain significant  following sequential bonferroni correction for the six comparisons performed within each resource set are shown in bold.

extent of divergence among replicate populations
to address whether the replicate populations within each treatment group were evolving toward the same or different adaptive peaks, we first tested whether they had diverged significantly from one another in terms of their fitness levels in the environment in which they had evolved. significant divergence in their direct responses would indicate that the replicate populations had followed different trajectories and would be consistent with them evolving toward different adaptive peaks. for each group, an anova was performed to test the significance of the among-population variance in fitness in their selection environment after  <dig> generations. as shown in table  <dig>  the among-population variation was significant for the glu/mal, lac and glu/lac groups, with the glu/mal and glu/lac groups both remaining significant even after accounting for multiple tests.

*significance of population effect determined by one-way anova.

†values that remain significant  following sequential bonferroni correction for the four tests performed within each resource set are shown in bold.

‡the glu group is repeated for clarity.

variation in fitness in alternative environments
the preceding results indicate that significant among-population divergence evolved in at least two of the seven treatment groups. however, this assessment is based on only one trait, namely fitness in the particular environment in which each group of populations evolved. therefore, we cannot exclude the possibility that populations in the other groups were also evolving toward different adaptive solutions but had similar direct fitness responses. it might be possible to differentiate populations that show similar direct responses by their correlated responses to other environments  <cit> . we therefore measured the fitness of each population in all of the environments making up each section of the experiment; for example, the fitness values of populations in the mal group were measured in the glu, mal, glu/mal and glu+mal environments. the results of all these assays are summarized in figure  <dig>  net declines in fitness were not observed as correlated responses, at least across the range of environments tested, with one conspicuous exception: all six populations that evolved with glucose as the sole resource lost fitness when they were tested in the lactose-only environment. interestingly, the reciprocal tradeoffs were not observed. all six lactose-evolved populations were more fit in lactose than in glucose, but none was significantly less fit than the ancestor in the lactose-only environment. the absence of tradeoffs in the two-resource regimes is less surprising, however, since any mutation that was beneficial for exploiting one resource but detrimental with respect to the second resource would have been disadvantaged relative to any other beneficial mutation accessible that did not impose such a maladaptive pleiotropic effect.

we then performed two-way anovas to determine whether there were significant  main effects of replicate populations across the environments, and  interaction effects between replicate populations and environments . the glu+mal group exhibited a significant population effect, while the lac, glu/lac and glu+lac groups all showed significant population-by-environment interactions; the interaction variation in the glu/lac group was significant even after a bonferroni correction for multiple tests.

*significance of population and population-by-environment interaction effects determined by two-way anova, with population analyzed as a random effect and environment as a fixed effect.

†values that remain significant  following sequential bonferroni correction for the four tests performed within each resource set are shown in bold.

change in population divergence over time
taking all of the direct and correlated responses together, there were three cases of significant variation among replicate populations after adjusting for multiple tests of the same hypothesis within each resource set. all three cases involved the glu&mal and glu&lac treatment groups that experienced temporally fluctuating environments, even though those represented only two of the seven total treatment groups. these results are consistent, therefore, with the hypothesis that fluctuating environments promote evolutionary divergence. however, it is also possible that the populations are converging on the same peak but are doing so at different speeds or by different routes. for example, transient divergence might be caused by stochastic differences in the order and timing of adaptations in replicate populations that would eventually converge to the same adaptive peak  <cit> . to evaluate this possibility, we examined whether the among-population variation in fitness in the selection environment was increasing or diminishing over time. sustained or even increasing divergence would support the hypothesis that replicate populations were approaching different fitness peaks, whereas declining variation would tend to support transient divergence leading to eventual convergence  <cit> .

to that end, we calculated the variance component for fitness for each group's direct response at both generations  <dig> and  <dig> . taking the square root of the variance component, √var w, gives the standard deviation for fitness due to genetic factors  among the populations in each group, and it scales in a manner comparable to relative fitness. the estimated genetic variance in fitness among populations increased between  <dig> and  <dig> generations in the glu/mal group but not in the glu/lac group . this variance component also increased in the glu group, but not in any of the other groups that experienced temporally constant regimes of either single or mixed resources. as is evident in figure  <dig>  the variance in the glu/lac group at generation  <dig> was very strongly influenced by one population for which no measurable fitness gain had yet occurred. if we exclude that outlier population, then the variance component also increased between  <dig> and  <dig> generations for the glu/lac group . these trends, while certainly not definitive proof, are thus consistent with the hypothesis that the replicate populations in the temporally fluctuating resource environments were evolving toward distinct fitness peaks.

*the 2000-generation means and variances were calculated using only the  <dig> fitness assays that were performed in the same experimental blocks as the 1000-generation assays.

†reported as zero because the calculated variance component was negative, whereas the real value must be zero or positive.

‡the glu group is repeated for clarity.

discussion
since its introduction over seventy years ago, wright's metaphor of the adaptive landscape has become one of the most influential concepts in evolutionary biology, yet empirical understanding of the structures of actual landscapes remains elusive. in this study, we monitored the evolution of  <dig> experimental populations of e. coli under  <dig> resource regimes for  <dig> generations in order to investigate the effects of environmental complexity on their dynamics. we were interested, in particular, in whether heterogeneous resource environments would influence the repeatability of evolution by impacting the ruggedness of the adaptive landscape. our results can be summarized as follows.  populations evolved under all experimental regimes exhibited significant increases in fitness.  the magnitude of their fitness gains varied across the regimes, as did their correlated fitness responses to other regimes.  among-population genetic variation for fitness was highest, and most sustained over time, in those groups that had evolved under fluctuating resource regimes. below we discuss these findings in more detail.

extent and specificity of adaptation
after  <dig> generations, the mean fitness of all populations had increased significantly under all seven resource regimes . prior to all fitness assays, ancestral and evolved competitors were both physiologically pre-conditioned in the competition environment. therefore, the fitness gains of the evolved populations are the result of heritable adaptation rather than physiological acclimation. each population had the opportunity to adapt to one of seven different resource regimes, but other aspects of their environment  were common to all of the selection regimes. if genetic adaptation had occurred only in response to those shared aspects of the environment, then the magnitude of fitness gains would have been indistinguishable among the treatment groups. in fact, however, there was considerable variation in the average fitness improvement across the groups, ranging from ~21% in the glu group to ~43% for the lac group, with many of the pairwise comparisons between groups being significant . these results demonstrate that a portion of the overall adaptation was specific to the particular resource regimen under which the populations had evolved.

effect of environment on patterns of divergence
we only found evidence for highly significant divergence among the replicate populations that evolved in the fluctuating resource environments, glu/mal and glu/lac . to address whether this divergence was sustained over time, we also quantified the change in the variance for fitness between  <dig>  and  <dig>  generations . divergence among the replicate populations in the glu/mal group increased over the second half of the experiment, whereas divergence among the populations in the glu/lac group decreased over this period. however, the variation in the glu/lac group at  <dig>  generations was strongly influenced by a single population that showed no fitness gain to that point. when this atypical population was excluded from the analysis, divergence trended higher in this group as well. on the whole, these results indicate that divergence of replicate populations was both significant and increasing over time only in those two groups that evolved in the temporally fluctuating environments. this finding is consistent with the hypothesis that the replicate populations in these treatment groups were evolving toward different adaptive peaks.

in principle, replicate populations could diverge from one another not only by selection acting on different beneficial mutations but also by drift and hitchhiking. divergence by drift could occur through the accumulation of mutations that are neutral in the selective environment, but which might have some fitness effects in other environments. deleterious mutations might hitchhike to high frequency if they become linked with a beneficial mutation  <cit> , which could occur since the bacteria in our experiments are strictly asexual . however, the e. coli strain we used has a very low total genomic mutation rate  <cit> , which should limit the rates of substitution by drift and hitchhiking. indeed, high-coverage whole-genome sequencing of another population founded from the same strain found that only three synonymous mutations achieved detectable frequencies in  <dig>  generations  <cit> . moreover, the patterns of correlated responses in  <dig> populations, again founded from the same ancestral strain, indicate that pleiotropic effects of beneficial mutations have been more important than mutation accumulation by drift or hitchhiking in explaining patterns of phenotypic evolution over  <dig>  generations  <cit> . therefore, it appears unlikely that drift or hitchhiking have contributed much, if at all, to the among-population divergence in our 2000-generation experiment, nor is it evident why any such effects would be stronger in the fluctuating environment treatments than in other treatments that experienced the same resources alone or in combination.

selection can also lead to among-population divergence due to stochastic differences in the timing and order of beneficial mutations  <cit> . if only a single local adaptive peak is available, then this divergence should be transient. however, if mutations interact such that some mutations are beneficial only in combination with other mutations, then this 'sign epistasis' may generate multiple peaks separated by valleys of maladapted intermediates  <cit> . in the latter case, differences in the order in which the mutations arise could cause initially identical populations to evolve to different peaks, resulting in sustained divergence  <cit> . while stochastic differences in the timing and order of mutations might well contribute to population divergence, they cannot alone explain why the extent of variation and its persistence over time should differ between groups. although we cannot rule out the possibility that the divergence in those groups that evolved with fluctuating resources might eventually prove to be transient , this possibility would nevertheless imply differences in the structure of fitness landscapes between the various regimes that contributed to their different early dynamics of divergence. in future work, we intend to identify the genetic bases of the adaptation of these populations and then combine mutations to test directly for the presence of sign-epistatic interactions.

a possible caveat to this interpretation is that, because the benefit of adaptive mutations must be averaged across two different environments, those populations evolved in fluctuating environments may have experienced weaker effective selection than the populations that evolved in constant environments  <cit> . if so, then adaptive mutations would take longer to fix and the period of transient divergence would be extended. however, we did not observe substantially smaller fitness gains for the groups that evolved in the fluctuating environments .

the greater divergence among populations in the fluctuating environments is consistent with the hypothesis that environmental heterogeneity can increase the ruggedness of the adaptive landscape and thereby increase the likelihood that replicate populations will find distinct fitness peaks  <cit> . however, it is less obvious why divergence was more pronounced in regimes with two resources that fluctuated temporally, as opposed to regimes that presented the same two resources simultaneously. temporal fluctuations would presumably have favoured generalists that are well adapted to each of the alternating resources, whereas coexisting specialists might evolve when the resources are simultaneously present. that distinction, while important, still begs the question of whether independently evolved populations would achieve similar or diverse generalist types or admixtures of specialists under those respective scenarios. although the specific adaptations that occurred in the populations are not yet known, we can imagine a scenario where one might well expect greater among-population divergence under the fluctuating resource regimes. consider a mutation that increases fitness in the glucose component of a fluctuating environment, and which becomes fixed in one population. despite conferring a net fitness advantage, this mutation might nevertheless reduce fitness in the lactose component of the environment. . this deleterious side-effect will select for compensatory mutations that alleviate the fitness trade-off in the lactose environment  <cit> . such compensatory mutations are beneficial only in combination with the previous mutation, and they would not evolve without the adaptation to glucose. as a consequence, the spectrum of potential future adaptations will differ from those available to a population that by chance fixed an alternative mutation that did not engender a trade-off, and therefore would not select for a compensatory mutation. by contrast, in those environments where two resources were presented simultaneously, an evolving lineage might, at least in principle, split into two subpopulations that each adapt to one resource while forgoing adaptation to the other. the two subpopulations might then be on different peaks, yet if all of the replicate lineages split into subpopulations in the same way, then the replicate populations per se might not diverge from one another.

a caveat to this conceptual distinction between simultaneous and fluctuating environments is the fact that e. coli typically uses multiple resources  sequentially rather than simultaneously  <cit> . because only one resource is used at a time, the effect is to partition the environment physiologically, thus giving rise to two sequential adaptive landscapes just as in the fluctuating environment. however, in contrast to the externally imposed fluctuating regimes, the physiological separation between these successive landscapes is under genetic control. preliminary results  indicate that four of the six glu+mal populations and all six of the glu+lac populations evolved some change in the activity of catabolite repression , in which case the resources may have been used simultaneously. these changes, if confirmed, might have reduced the among-population variation in those regimes where resources were presented simultaneously rather than sequentially.

finally, a limitation of our analyses of the evolved lines thus far is that they only address variation in fitness. thus, we cannot exclude the possibility that replicate populations might have diverged genetically, and even physiologically, in ways that nevertheless yield similar fitness levels in the assayed environments. some of the potential targets of selection in this experiment include the length of the lag phase following transfer to fresh medium, maximum growth rate and, in mixed resource environments, regulation of substrate utilization preferences. different combinations of changes in these traits might produce similar fitness gains  <cit> . although measurements of additional characters can only increase the likelihood of detecting variation among populations, we see no obvious reason why adding traits would substantially affect the relative among-population variation across the different treatment groups.

by taking advantage of the short generations of bacteria and the ease of manipulating their environments, we have assessed the effect of environmental variation on the reproducibility of evolution, with implications for understanding the structure of adaptive landscapes. this study extends previous work on the effects of environmental heterogeneity  <cit>  by focusing specifically on the effect of temporal fluctuations in resource availability on population divergence. we observed that divergence among replicate populations was greater in environments with alternating resources than in environments with the same resources presented either singly or simultaneously, suggesting that epistatic interactions among mutations were stronger or more influential under the temporally fluctuating regimes. future work will take advantage of the potential for genetic analysis and manipulation of e. coli to examine the molecular and physiological changes that underlie the parallel and divergent trends observed in this study.

CONCLUSIONS
in this study, we sought to test the effect of the number  and presentation  of limiting resources on the adaptation and divergence of replicate populations of e. coli. the fitness of all populations increased relative to their common ancestor following  <dig>  generations of evolution, indicating that all populations adapted to their selective environments. divergence among the replicate populations evolved in each particular environment differed across regimes, with variation tending to be greater in fluctuating environments than in constant environments, including those regimes with two simultaneous resources. these results are consistent with the hypothesis that environmental heterogeneity, including temporal fluctuations, can promote population divergence.

