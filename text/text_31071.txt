BACKGROUND
conformational sampling, as an essential part of the molecular modelling process, is an important prerequisite for many applications in computational chemistry <cit> , especially in drug discovery research <cit> . it has been a research hotspot in the last decades and many computational algorithms have appeared in succession recently <cit> . generally, these methods can be classified into two main categories: systematic methods and stochastic methods. systematic methods exhaustively enumerate all possible torsions at certain discrete intervals <cit> , therefore such approach is usually limited to small molecules and becomes inapplicable for very flexible molecules due to the combinatorial explosion <cit> . to overcome the combinatorial difficulty of systematic search algorithms, many programs, such as caesar <cit> , omega <cit>  and conan <cit>  have adopted the divide-and-conquer strategy to divide the molecule into small pieces and then assemble conformations of the whole molecules from small fragments. however, some of these methods may still be insufficient to restrain the space of accessible conformers due to the limitation of the predefined templates  <cit> . in addition, the more common ways to avoid combinatorial explosion are the stochastic methods, such as random search <cit>  and molecular dynamics <cit> , which rely on certain random perturbations but usually still spend considerable computational time on energy minimization therefore, developing a fast and reliable conformational generation engine is still a challenging task <cit> .

recently, many observations have revealed that the bioactive conformation of a flexible molecule does not correspond to its global energy minimum or even some local minima on the potential energy surface in most cases  <cit> . in essence, flexible molecules often exhibit several conformations or geometries with nearly equal energies, and the one with favoured inter- and intra-interactions is adopted under given conditions, as stated by g. klebe et.al., reliance on just the crystal structures of a ligand itself may not be an infallible or reliable indicator of biologically active conformation <cit> . in addition, the standard algorithms for energy minimization in the commonly available molecular mechanics programs are mainly limited to downhill-energy search <cit> , so some potential conformational space is unavoidable to be neglected unexpectedly. for drug discovery and design applications, such as pharmacophore modelling, we usually have limited knowledge about the binding conformation of the potential drug. all these remind us to consider geometric diversity of conformations or other unrevealed criteria in addition to energy threshold simultaneously when searching conformational space <cit> .

there are some methods to promote geometric diversity, such as poling algorithm  <cit>  used in catalyst. recently, we have introduced a new conformational sampling method named cyndi and its detailed algorithm has been discussed in the previous work  <cit> . cyndi is based on the multiple objective evolution algorithm  and adopts different energy terms and geometric objectives to rationally explore in the conformational space. therefore, it can ensure that the generated conformation ensemble simultaneously meets multiple criteria, such as low energy and geometric diversity instead of only concentrating on one of them <cit> . this gives rise to two requirements on the outstanding prediction of conformational energies and good prediction of molecular geometries when modelling the conformations. force fields, as the most common predictors for energies and geometries of molecules, vary in which they are developed to be applied to different aspects of bioorganic chemistry with specific sets of data <cit> . therefore it is necessary to explore the effect against different force fields adopted on the quality of conformational ensembles during the process of conformational analysis.

in this analysis, cyndi has been updated by implementation of mmff <dig> force field in addition to the default tripos force field in previous version. with two force fields adopted in cyndi, a detailed comparative analysis between force field based method  and multiple empirical criteria based method  is performed without force-field type bias. furthermore, a larger dataset of  <dig> ligands with their bioactive conformations retrieved from pdb is used to validate the performance of both ffbm and mecbm in terms of conformational searching speed and biologically relevant conformations reproduction. in addition, the impact of energy minimization on conformational ensemble quality is also examined in this study. to have more confidence in our findings, we extend this literature with a further comparison on multiple conformational sampling techniques available in cyndi and macromodel integrated in maestro v <dig>  .

methods
validation dataset
the dataset was originally used for the validation work of caesar algorithm <cit> . in this work,  <dig> molecules were removed firstly from the original  <dig> molecules, which contain atoms other than organic elements c, o, n, s, f, cl, br, p and h. secondly, since the pdb data itself has a lot of errors, the molecules were therefore manually checked and the confusing ones whose structures in rcsb website and pdb files are inconsistent were also removed. after removing those structurally duplicated molecules,  <dig> molecules were left and their protonation states were assigned to them using pipeline pilot v <dig>   in default condition . the errors in valence/charge assignment were manually corrected via visual inspection. since the dependence of the conformational ensemble quality on input geometry is a challenge in conformational searching, corina v <dig>  <cit>  was used to generate new 3d conformations for the molecules in the test set as the input conformations in this study. it should be pointed out that corina failed to generate 3d conformations for  <dig> out of  <dig> molecules; therefore, the final dataset involves  <dig> molecules and is available in additional file  <dig> 

conformational sampling with ffbm
in both ffbm and mecbm approaches, the bond lengths and bond angles are fixed as input. only two terms, namely van der waals  and torsion energies are used as the force field objective functions in cyndi for ffbm case. the numbers of population and generation during the evolution process were set to  <dig>  and the epsilon values for the two objectives  in the epsilon multi-objective evolution algorithm  <cit>  were set to  <dig>  kcal/mol and  <dig>  kcal/mol, respectively. the maximum number of the conformations to be generated for each molecule was set to  <dig>  and the maximum iteration for the optional energy minimization was set to  <dig>  all the other parameters were set as default values in cyndi. any structure with energy more than  <dig> kcal/mol above the lowest conformation energy ever identified was discarded.

conformational sampling with mecbm
for mecbm, two more objective functions, 1) geometric dissimilarity  between each new conformation and the input conformation, and 2) the gyration radius  for each conformation, which are directly related to conformation geometries were used. the epsilon values for these two objectives were set as  <dig>  Å and  <dig>  Å, respectively. in order to make a fair comparison, all other related parameters were set to the same values as in ffbm.

energy minimization for ffbm and mecbm
to access the impact of minimization, a series of protocols were repeated using identical settings but with the additional minimization procedure . by using the full force field excluding electrostatic energy term <cit>  and conjugate-gradient algorithm, each initially generated raw conformation was minimized with the same or the other force field complied with mixed force field strategy  up to  <dig> steps or to the final convergence .

conformational sampling with macromodel
several algorithms for conformational analysis are implemented in macromodel. in this work, serial low-mode sampling  <cit> , serial torsional sampling  <cit>  and serial torsional/low-mode sampling were used for the comparison. the torsional sampling option of mcmm and torsional/low-mode was set as "extended" mode. any structure with energy higher than the same energy threshold value as in ffbm and mecbm would be discarded. default values were used for the other parameters related to conformational sampling. after the raw conformers were analyzed, mmffs force field and opls- <dig> force field which are available in macromodel, were selected to minimize these raw conformers in vacuum respectively. the energy minimization was carried out using the steepest descent  method, the minimization step was set as  <dig> and final convergence was set as  <dig>  kcal·mol-1·Å- <dig> 

tools and benchmarks for conformational analysis
the performance of conformational generation methods was evaluated by the quality and efficiency to reproduce the bioactive conformations. the ability to retrieve the bioactive conformation at different levels of sampling can be measured by root mean square deviation  between the best fitting conformation in the conformation ensemble and the corresponding bioactive conformation. moreover, the distributions of conformational energies and gyration radius of the conformation ensemble were also studied in detail. the efficiency was measured by the computational time consumed for each test. all the test runs were performed on intel xeon cpu e <dig>  and the quality and efficiency analyses were performed with an in-house developed protocol using pipeline pilot v <dig> , which is also available in additional file  <dig> 

RESULTS
performance of the conformational search methods
to assess the performance of ffbm and mecbm, the cumulative distributions of rmsds between the bioactive conformers and their best fitting conformers in the generated conformer ensembles for each conformational search methods are presented in figure  <dig> and table  <dig>  the figure shows the percentage of ligands for which there is at least one conformation identified within  <dig> ,  <dig> ,  <dig>  and  <dig>  Å rmsd intervals to the corresponding crystal structure by each searching protocol under evaluation. about 25% of the bioactive conformations can be reproduced by mecbm with rmsd falling within 0- <dig>  Å rmsd interval, while only about 15% of the bioactive conformations can be reproduced by ffbm with rmsd falling within the same interval. for  <dig> - <dig> Å rmsd interval, the recovery rate of mecbm amounts to 29%, while the counterpart of ffbm is lower than 25%, which indicate that adding two more geometric objectives in the conformation sampling can greatly improve the reproduced ratio of bioactive conformations.

another interesting observation in the tests is that the force field type does not seem to play an important role in both mecbm and ffbm. in other words, mmff <dig>  whose efficiency in structure optimization has ever been proved <cit> , seems to be incapable of improving the quality of the conformers generated by mecbm or ffbm as expected. for ffbm case, the difference in retrieval rate with mmff <dig> force field and tripos force field is only  <dig> % within  <dig> Å rmsd interval , and for mecbm case, the retrieval rate with mmff <dig> force field seems slightly lower than that with tripos force field at a lower rmsd cutoff  . at a higher rmsd cutoff within  <dig> Å, mmff <dig> force field also seems to have a slightly positive impact .

the effectiveness of the other three conformational search methods in macromodel was assessed mainly using three different metrics: the ability to identify the bioactive conformers, the average cpu time consumed for each molecule and the average size of conformational ensemble. the impact of force field type on these methods was also considered in this section. to simplify our comparative analysis, the potential dependence of our results on the particular force field used for cooperating with the three methods would be firstly considered. for lmcs, mcmm and torsional/low-mode, the differences in the retrieval rate  with mmffs and opls- <dig> are only  <dig> % ,  <dig> %  and  <dig> %  respectively. these results came to the conclusion that the conformational search methods didn't thoroughly depend on the force field type, and the following comparative analysis would be focused on the abilities of macromodel and cyndi with the same mmff <dig> force field . the recovery rates by mcmm and torsional/low-mode outperform any other remaining methods, and mecbm results in a better quality of conformational ensemble than lmcs in macromodel, undoubtedly, ffbm which only considers the van der waals  and torsion energies of force field terms performed the worst for conformational generation.

an ideal conformational search method must cast a wide net over the potential energy landscape and sample as broad a range of molecular geometries as possible  <cit> . since the rmsd distribution does not provide full information on the diversity of conformational ensembles and can't fully quantize the coverage of low-energy conformational space, two other metrics were used to analyze the conformations, one is the conformation energy and the other is the gyration radius of conformation. to address this question, four representative molecules  with  <dig>   <dig>   <dig> and  <dig> rotatable bonds respectively, were selected from the dataset to be assessed. the distribution of gyration radius and the conformational energy for the four conformation ensembles were presented in the form of heat maps in figures  <dig> and  <dig> respectively , it should be noted that only conformations within  <dig> kcal/mol of the global lowest energy identified by each method were included for analysis in this work. for clarity, all heat maps are scaled according to the range of the energy/gyration radius of all conformations for each specific molecule. figure  <dig> and additional file  <dig>   reveal that mecbm has a bias in favor of geometrically more extensive conformations and spans a relatively wider range of molecular radius of gyration than ffbm, especially when the molecule is more flexible. from figures  <dig>  and additional file  <dig>  we can find a trend that the conformations generated by mecbm tend to stand on the lower states of energy spectrum. the difference of the conformations for the compact and relatively rigid molecule, like 2a6-1h1q, appears to be inconspicuous and some conformers out of the ensemble even tend to stand on higher energy states. in this case, an additional energy minimization refinement can drive them to lower energy space. moreover, the size of the lower energy conformations set generated by mecbm is apparently larger with energies covering a broader region of the energy scale on the heat map, which suggests that the searching engine of the mecbm can greatly expand the range of conformations sampled and cover much broader spectrums of energies and geometric sizes than ffbm. the phenomenon becomes increasingly pronounced as the flexibility of molecule increases, which confirms the previous observation that flexible molecules often exhibit several different conformations but with nearly equal energy values <cit> , that is to say, cyndi can dig out more diverse conformers within certain range of energy scale.

the efficiency of mecbm can be measured by the average cpu time consumed for calculating per molecule. the total numbers of unique conformations generated by mecbm is more than  <dig> times larger than the one generated by ffbm, while the total computational cost increases by only one third . the significant increase of the total number of conformations generated by mecbm methods can be considered as a result of the expanded optimal solutions of pareto frontier with multiple-objective optimization. furthermore, the conformational search methods in cyndi are tremendously faster but has a comparable conformational generation quality  in comparison with any method in macromodel. as shown in table  <dig>  it takes only  <dig> - <dig>  seconds to deal with per molecule by using cyndi, but it takes  <dig> - <dig> seconds to do the same job by using macromodel. on the other hand, the average sizes of the conformational ensembles for each molecule generated by the methods in macromodel are remarkably larger than the ones generated by the methods in cyndi, especially for mcmm and torsional/low-mode in macromodel , and this may be consistent with the higher recovery rates and much more time consumption by macromodel.

influence of energy minimization on reproduction of the bioactive conformation by using ffbm and mecbm
in this work, the effect of the additional refinement by using energy minimization with different force fields has also been explored. as expected, post-refinement with minimization relatively improves the number of conformations which can meet the energy threshold, and this is true for every method examined, especially for mecbm . however, the increased number of conformations doesn't fully indicate that the diversity of conformation becomes more abundant. as shown in figures  <dig> and additional file  <dig>  the minimization seems to work worse when ffbm is used, because the distribution scale of its generated conformers' gyration radiuses becomes narrower and more concentrated, which indicates that the minimization reduces the diversity of conformation ensemble in the case of ffbm. on the contrary, the minimization seems to widen the distribution scale of conformers' gyration radius and therefore improve the diversity of the conformers when mecbm is adopted and the molecule is more flexible. as we know, the final geometric structures of molecules are dependent on their corresponding starting structures in energy minimization process. as mentioned above, the conformations generated with ffbm are lack of diversity when compared with mecbm, which may limit the geometric diversity of the final conformations after energy minimization. additionally, as shown in table  <dig>  compared with the process of conformational sampling without energy minimization, the computational cost will be multiplied several times if the post minimization is performed.

to further examine the dependence on the force field type, the conformational sampling protocols with the above mentioned mixed force field strategy were performed and the corresponding distributions of rmsd between the bioactive conformations and the best fitting generated conformations were graphically summarized in figure  <dig>  it is pretty clear that using different force fields for conformation generation and post-refinement does not lead to an obvious enhancement of conformational generation ability of either mecbm or ffbm, and this therefore again confirmed that both mecbm and ffbm are insensitive to the force field type.

discussion
the results presented in this work indicate that mecbm can explore the low-energy conformational space more efficiently and more robustly than ffbm. through integration with empirical geometric objectives, mecbm significantly increases the diversity of the generated conformational ensembles with the computational cost only increasing moderately. the enhanced diversity and conformational coverage of mecbm lead to a higher rate of reproduced bioactive conformers.

in the comparative study between cyndi and macromodel, the mcmm and torsional/low-mode of macromodel adopting the systematic methods have the advantage of being able to retrieve more bioactive conformations than cyndi which adopts the stochastic methods. however, the cpu time required by them is therfore remarkably larger than that of both mecbm and ffbm in cyndi. besides, in contrast with cyndi, the tremendously large sizes of the conformational ensembles generated by the methods in macromodel weaken their advantages and restrict their usage in the studies of relatively large number of molecules and large libraries. the above observations give us hope that the mecbm is promising for various modelling applications, especially for the high-throughput ones.

moreover, a series of comparative analyses against different force fields reveal the conclusion that the qualities of conformation ensembles are non-sensitive to the force field type adopted neither in cyndi nor in macormodel. this confirmed the observation that it is not sufficient to minimize the raw conformations from any method and expect such improvements <cit> .

CONCLUSIONS
this work provides a series of detailed comparative analysis of the conformational sampling tools available in our in-house soft package cyndi and macromodel. regarding ffbm and mecbm methods in cyndi, to realize a fair and reasonable comparison, we implemented mmff <dig> as the alternative for force field to avoid the bias and then designed a series of protocols against a 742-molecule dataset to answer the questions regarding to i) the capability of reproducing bioactive conformation by using ffbm and mecbm respectively, ii) the influence of the geometric objectives on improving the reproduction of bioactive conformers, iii) the influence of the force fields on conformation generation, and iv) the effect of further energy minimization refinement with different force fields on the quality of conformation ensembles. the mecbm conformational models are distinctive for their enhanced diversity and conformational coverage, leading to a comparatively high rate of reproduced bioactive conformers. due to the compromised mechanism of moea, mecbm can increase the number of conformer candidates remarkably but with nearly constant cpu time consumptions compared with ffbm.

the conformational generation is always a trade-off question between the sampling depth of conformational space and conformational costs with respect to the algorithm method used  <cit> . therefore, the comparative analysis between cyndi and macromodel was focused on the balance between these two aspects. in terms of retrieving the bioactive conformations, the lmcs of macromodel shows comparable performance to mecbm of cyndi, while the mcmm and torsional/low-mode of macromodel show higher recovery rates than that of mecbm. however, in terms of efficiency of the conformational sampling, the mecbm has the largest probability of discovering bioactive conformations at the fastest speed and this means that mecbm is the better choice for the generation of high-throughput generation, mcmm and torsional/low-mode approaches are the better choices for detailed studies of relatively fewer compounds or small libraries.

in summary, conformational sampling is a trade-off problem involving conformation energies and geometric diversity. by using different energy terms and geometric objectives, the moga based method can significantly expand the optimal solutions on pareto frontier and increase the robustness of conformation sampling with more empirical criteria. as far as the conformation diversity and the reproduction of bioactive conformations are concerned, additional energy minimization is not necessary and may even reduce the diversity of conformational sampling. all the results guide us to explore more empirical criteria, which maybe play a pivotal role in the conformational generation of molecules.

authors' contributions
hl, xw and hj conceived the study. fb, xl and hz developed the methods, performed the analysis and drafted the manuscript. xl designed the validation protocol. hl, xl and jl reviewed and revised the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file 1
the validation dataset used in this study. the small molecules of the dataset are in tripos mol <dig> format, and all these  <dig> molecules are stored in this file named "dateset.mol2".

click here for file

 additional file 2
the validation protocol used in this study. the validation protocol was developed with pipeline pilot v <dig>  . the input file is in tripos mol <dig> format, and the output file is in html format which can be explored with the web browser.

click here for file

 additional file 3
heat maps for additional  <dig> molecules whose rotatable bonds vary from  <dig> to  <dig>   <dig> to  <dig>  and  <dig> to  <dig>  this file is the complement to figures  <dig> and  <dig>  which consists of conformational information of additional  <dig> molecules to support the findings observed from figure  <dig> and figure  <dig> 

click here for file

 acknowledgements
this work was supported by the special fund for major state basic research project , the national natural science foundation of china , the shanghai committee of science and technology , the  <dig> hi-tech program of china , the major national scientific and technological project of china , the  <dig> project  and the fund of state key laboratory of phytochemistry and plant resources in west china. honglin li is also sponsored by shanghai rising-star program  and the fundamental research funds for the central universities.
