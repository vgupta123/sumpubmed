BACKGROUND
codon usage bias or cub, a phenomenon in which synonymous codons  are used at different frequencies, is generally believed to be a combined outcome of mutation pressure, natural selection, and genetic drift  <cit> . within any given species, genes often exhibit variable degrees of cubs. moreover, cub for an individual gene is related closely with gene expression for translational efficiency and/or accuracy  <cit> . therefore, the ability to accurately quantify cubs for protein-coding sequences is of fundamental importance in revealing the underlying mechanisms behind codon usage and understanding gene evolution and function in general.

over the past few years, a number of measures have been proposed for the quantification of cub  <cit> , leading to investigations on the pattern of cubs within and across species  <cit> . since cub is primarily shaped by selection and mutation  <cit> , different measures are differentially informative with regard to differentiating causes. for instance, there are purely descriptive measures of cub as caused by the joint effects of mutation and selection, such as, the effective number of codons   <cit>  and the relative synonymous codon usage  <cit> . alternatively, other measures of cub specifically accord with selection on codon usage associated with translation, such as, the codon adaption index   <cit>  and the frequency of optimal codons  <cit> . in addition, a number of studies have attempted to estimate selection on codon usage based on population genetics  <cit> .

these existing measures generally fall into two categories, as they compare the observed codon usage distribution of target coding sequence against the distribution based on a reference set of highly-expressed genes  or the distribution based on a null hypothesis of uniform usage of different synonymous codons . the former measures are highly dependent on their corresponding reference sets  and accordingly are limited by the comprehensiveness and accuracy of reference sets. since reference sets are species-specific, these measures are inappropriate for comparison of cubs across species  <cit> . additionally, they are unreliable in cases where there is inadequate knowledge about the highly-expressed genes for a given species  <cit> , such as for newly sequenced species that have a limited number of annotated genes.

due to these shortcomings, measures that do not require prior knowledge of reference gene sets have been implemented. these measures assume a null distribution of uniform usage of synonymous codons and estimate the departure of the observed codon usage from the expected. among them, nc is one of the most widely used measures  <cit> . its variant, nc'  <cit> , incorporates gc content of coding sequence as background nucleotide composition  into cub estimation. accounting for bnc refines codon usage analysis, providing a comparable metric for analyses within and among species exhibiting various non-uniform bncs. in the context of protein-coding sequences, for instance, bacteria have diverse bncs as their gc contents vary widely - from ~20% to ~80%. even within a single species, genes often differ considerably in background gc content, as in the case of escherichia coli str. k- <dig> substr. mg <dig>  whose genes have gc contents ranging from  <dig> %  to  <dig> % . therefore, it is crucial to measure the departure of codon usage from the corresponding background composition . due to its appropriate consideration of bnc, nc' outperforms other relevant measures  <cit> .

however, all extant measures  still have limitations. first, they give a general estimate of cub, but have not been supplied with straightforward procedures for assessing the statistical significance of the bias in codon usages for any given gene. genes that vary in length and differ in cub may exhibit different levels of statistical significance for their codon biases. assessing statistical significance can strengthen functional relationships ascertained considerably by discounting sampling error in correlated gene sets. second, no previous measure is fully effective at incorporating bnc into cub estimation. although nc' factors gc content as bnc, it does not account for known variation in bncs at three different codon positions  <cit> . in bacteria, for instance, bartonella quintana str. toulouse and clostridium thermocellum atcc  <dig> have very similar gc contents in coding sequences , but their position-specific gc contents are quite different:  <dig> % and  <dig> % at the first codon position,  <dig> % and  <dig> % at the second codon position, and  <dig> % and  <dig> % at the third codon position, respectively. likewise, genes within a given species can also have heterogeneous bncs at the three codon positions; in e. coli, for example, there are two genes, emre and hlye, that are similar in their overall gc contents  but different in positional gc contents:  <dig> % and  <dig> % at the first position,  <dig> % and  <dig> % at the second position, and  <dig> % and  <dig> % at the third position, respectively. such differences in positional bncs reflect the outcomes of diverse evolutionary mechanisms , thus conflating the roles of mutation and selection acting at different codon positions. therefore, incorporation of differential positional bncs into cub estimation promises to increase its effectiveness and reliability.

moreover, gc content is not the sole parameter of bnc. as illustrated in zhang and yu  <cit> , joint use of gc and purine contents effectively models nucleotide, codon, and amino acid compositions. in contrast to a broader variation of gc content, purine content varies within a much narrower range fluctuating around 50%, presumably because purines play a determinative role in physicochemical properties of amino acids  <cit> . similar with gc content, purine content differs not only from one species to another, but also from one gene to another, and even between genes with similar gc contents. for instance, emre and hlye in e. coli, which are similar in their overall gc contents, have entirely different purine contents not only at the overall level , but also at three codon positions . thus, in addition to gc content, purine content is also a significant feature of bnc.

here we present a novel measure, codon deviation coefficient , using it to characterize cub and to ascertain its statistical significance. cdc takes account of both gc and purine contents, comprehensively addressing heterogeneous bncs, not only in sequences but also at three codon positions. it adopts the cosine distance metric to quantify cub and employs the bootstrapping to assess its statistical significance, requiring no prior knowledge of reference gene sets. we describe cdc in detail and provide comparative results in the form of an in-depth evaluation of simulated sequences and empirical data.

methods
expected codon usage
cdc considers both gc and purine contents as bnc and derives expected codon usage from observed positional gc and purine contents. we denote the content of the four nucleotides , gc content, and purine content as a, t, g, c, s and r, respectively. as in zhang and yu  <cit> , position-dependent nucleotide contents can be formulated in the following way:

  ai=ri,ti=,gi=siri,ci=si, 

where si and ri are their corresponding observed contents at codon position i and ai, ti, gi, ci are expected nucleotide contents at codon position i . for any sense codon xyz, where x, y, z ∈ {a, t, g, c}, the expected usage πxyz is defined as the product of its constituent expected nucleotide contents x1y2z <dig>  normalized by the sum over all sense codons, viz.

  πxyz=x1y2z3∑abcwabca1b2c <dig>  

 where wabc= <dig> if abc is a sense codon <dig>  otherwise and a,b,c∈{a,t,g,c}. 

codon usage bias
any coding sequence can be represented as a vector of n dimensions, whose entries correspond to n sense codon usages in the sequence. the dimension n equals  <dig> for the canonical code; although codons atg and tgg could be set aside due to the absence of synonymous codons, calculation based on a vector of  <dig> dimensions instead of  <dig> dimensions makes little substantial difference. to calculate cub for any given sequence, we employ the cosine distance metric  <cit>  based on the cosine of the angle between the two vectors of n dimensions. therefore, when both expected  and observed  codon usage vectors are available for any given sequence, cdc renders a distance coefficient ranging from  <dig>  to  <dig> , to represent cub, expressed by the deviation of π^ from π .

  cdc=1−∑xyzπxyz×π^xyz∑xyzπxyz2×∑xyzπ^xyz <dig> 

statistical significance of codon usage bias
we implement a bootstrap resampling of n =  <dig> replicates for any given sequence to evaluate the statistical significance of non-uniform codon usage. each replicate is randomly generated according to the sequence bnc  and the sequence length. consequently, we obtain a bootstrap distribution of n estimates of cub. a two-sided bootstrap p-value is calculated as twice the smaller of the two one-sided p-values  <cit> . p ranges from  <dig> to  <dig>  by convention, a statistically significant cub is identified by p <  <dig> . cdc features its first application of the bootstrap resampling in estimating the statistical significance of cub. bootstrapping may also be applicable to other related measures.

implementation and availability
cdc is written in standard c++ programming language and implemented into composition analysis toolkit , which is distributed as open-source software and licensed under the gnu general public license. its software package, including compiled executables on linux/mac/windows, example data, documentation, and source codes, is freely available at http://cbb.big.ac.cn/software and http://cbrc.kaust.edu.sa/cat.

RESULTS
comparative analysis on simulated data
to evaluate the performance of cdc and compare it against the most powerful extant measure, nc', as well as nc, we took an approach based on that of novembre  <cit>  to simulate coding sequences specifying different positional bncs and varying sequence lengths. five sets of position-associated compositions were used to generate simulated sequences . it should be noted that cdc ranges from  <dig>  to  <dig> , whereas nc' and nc range from  <dig>  to  <dig> . to facilitate comparisons of cdc with nc' and nc, we use the formula / <dig> and / <dig> to rescale their ranges, denoted as scaled nc' and scaled nc, respectively, from  <dig>  to  <dig> .

a good measure should not deviate much from its expectation as the amount of data approaches infinity or any sufficiently large number. thus, we first simulated sequences with a total of  <dig>  codons using five positional composition sets  . considering the fact that both gc and purine contents govern bnc, we fixed one of them to be uniform at three codon positions and allowed the other to have various positional compositions. we examined heterogeneous positional compositions for gc  and purine  contents, respectively. consistent with expectations, when the pcs was uniform, cdc and scaled nc' performed similarly, both taking a value close to  <dig> . when the heterogeneity of positional composition increased for gc content , cdc continued to perform well for all cases examined, whereas scaled nc' and scaled nc generated biased estimates, especially in cases where there was high heterogeneity in positional bncs. similarly, when purine content had heterogeneous positional compositions , cdc again exhibited much lower biases than scaled nc' and scaled nc. since nc ignores bnc, nc' performed better than nc when the pcs was non-uniform  and they exhibited comparable estimates only in cases where the pcs was uniform . these results agree well with those of novembre  <cit> . in addition, when we set heterogeneous positional bncs for both gc and purine contents, cdc consistently outperformed nc' and nc for nearly all the parameter combinations tested .

sequences with  <dig> codons were simulated. the expected value of codon usage bias is zero so that these estimated values are also the deviations from the expected.

to evaluate cdc in a comprehensive manner, we also examined all possible quantitative relationships among positional gc contents , although there are identified patterns about quantitative relationships among positional nucleotide compositions . on the whole, cdc achieved greater power than scaled nc' and scaled nc across all examined cases. scaled nc' performed better than scaled nc, consisting again with the analysis reported by novembre  <cit> . similar results were also obtained when we considered all possible quantitative relationships among positional purine contents .

sequences with  <dig> codons were simulated. the compositions in the med- <dig> set  were used. gc content was considered non-uniform at three codon positions, whereas purine content was set uniform at three codon positions. the expected value of codon usage bias is zero so that these estimated values are also the deviations from the expected.

sequences with  <dig> codons were simulated. the compositions in the med- <dig> set  were used. purine content was considered non-uniform at three codon positions, whereas gc content was set uniform at three codon positions. the expected value of codon usage bias is zero so that these estimated values are also the deviations from the expected.

to examine the effect of variable sequence length on the integrity of cdc, we considered a wide range of sequence lengths from  <dig> to  <dig>  codons. we set both gc and purine contents to be heterogeneous at three codon position using the four non-uniform pcss . to avoid stochastic errors, we repeated simulations  <dig>  times for each parameter combination and thus each estimate was determined from  <dig>  replicates. overall, cdc performed better than nc' and nc across all sequence lengths examined . when the heterogeneity of bnc increased from low to high, cdc tended to have less biases, whereas nc' and nc produced increasingly biased estimates, especially for the case where there was high heterogeneity in positional bncs . for short sequences , cdc yielded much lower biases and smaller standard deviations  than nc' and nc, although all three measures produced estimates that are somewhat biased. to obtain more reliable estimates of cub, our results suggest that input sequences should have at least  <dig> codons in length. when sequence length was decreased below  <dig> codons, cdc still performed better than nc' and nc, although the biases of nc' and nc were in opposite directions as compared with those of cdc . for long sequences, cdc generated less biased estimates and sds, whereas nc' and nc continued to yield more biased estimates and sds.

to test the influence of different cubs on the power of cdc, we evaluated a range of cubs from low to high. unlike the previous simulations , we generated simulated sequences by randomly setting different synonymous codon frequencies and considering variable cubs with a range from  <dig>  to  <dig> . we repeated simulations  <dig>  times for each case and accordingly each estimate was averaged over  <dig>  replicates. on the whole, cdc exhibited greater power in detecting diverse cubs; compared with nc' and nc, the estimated cubs of cdc were very closer to the expected ones . when the expected cubs varied from low to high, cdc performed consistently to give rise to close estimates. contrastingly, nc' and nc yielded biased cub estimates across all tested cases and these biases became more pronounced when the expected cub was extremely low. when the expected cubs increased from low to high, nc' and nc exhibited increasing power in cub estimation. while they approached the power of cdc when the expected cub was high, cdc remained more powerful than nc' and nc. taken together, our simulation results demonstrated that cdc is superior to nc' and nc.

aeach estimate was averaged over  <dig> replicate simulated sequences that each had  <dig> codons.

bsequences with the expected codon usage bias at  <dig>  were not possible to successfully simulate.

application to empirical data
it is generally acknowledged that cub correlates closely with gene expression level in both unicellular  <cit>  and multicellular  <cit>  organisms. different species may have different heterogeneities in positional bncs. to empirically test cdc and compare it to three popular measures, nc', nc and cai, we collected multiple expression data sets from five different species in this study:  escherichia coli from bernstein et al.  <cit>  ,  saccharomyces cerevisiae from holstege et al.  <cit> ,  drosophila melanogaster from zhang et al.  <cit> ,  caenorhabditis elegans from roy et al.  <cit> , and  arabidopsis thaliana from wuest et al.  <cit>  . we estimated cub by cdc, scaled nc', scaled nc and cai, and correlated their estimates with gene expression levels in these five species .

aexpression data were obtained from 1bernstein et al., 2holstege et al., 3zhang et al., 4roy et al., and 5wuest et al. .

bnumber of genes .

cp <  <dig>  for all values.

on the whole, cdc outperformed scaled nc' and scaled nc in correlating closely with gene expression level. although cdc and scaled nc' produced comparable correlation coefficients in yeast , cdc exhibited larger correlation coefficients than scaled nc' and scaled nc for all the rest cases . when comparing cdc to cai, we found comparable correlation coefficients in e. coli  and yeast, but in general cdc performed better than cai . however, it should be noticed that the values of cai are calculated from expression data , whereas those of cdc are not. when we restricted the above analysis to the top 10% genes referring to their expression levels, cdc continued to perform better than scaled nc', scaled nc, and cai . in addition, considering the correlation coefficients among these five species, we found that the smallest values always belonged to a. thaliana , indicating relatively weaker selection on a. thaliana codon usage by comparison with those of the other four species . such phenomenon was discovered previously in a comparative analysis between a. thaliana and oryza sativa  <cit> . overall, cdc correlated positively with gene expression level, much better than scaled nc', scaled nc, and cai.

as noted, the correlation coefficients produced by cdc and scaled nc' were similar in yeast but different in others . since cdc takes positional gc and purine contents as bnc and nc' considers only gc content as bnc and ignores positional heterogeneity, this result can be probably explained by relatively lower heterogeneity of positional bncs in yeast. to further investigate this possibility, we examined the heterogeneities of positional gc and purine contents in these five species . consistent with our expectation, heterogeneities of positional gc contents were indeed lower in yeast by comparison with other species , especially at the second and third codon positions. in contrast, higher heterogeneities of positional gc contents were apparent in e. coli  and d. melanogaster . these results agree well with the observation that the difference of correlation coefficient between cdc and scaled nc' in yeast was smaller than that in e. coli or d. melanogaster . as a consequence, cdc correlated more closely with scaled nc' in yeast than in e. coli or d. melanogaster . in contrast to gc content, heterogeneities of positional purine contents were relatively smaller and similar among the five species tested, presumably attributable to the fact that gc content ranges more broadly  than purine content   <cit> .

we proceeded to calculate cdc values  for all e. coli genes . cdc values ranged from  <dig>  to  <dig>  and the mean and median values were  <dig>  and  <dig> , respectively . the majority of genes  exhibited cdc values between  <dig>  and  <dig> . the gene with the highest cdc value is trpl, a key component in the attenuation system that controls the expression of the trpledcba operon in response to tryptophan availability  <cit> . however, bootstrap resampling illustrates that the cub value of trpl gene is not statistically significant , most likely due to its short length , consistent with our simulation results that short sequences tend to have biased cub estimates. the gene with the highest cdc value and statistical significance in cub is rpmi , which encodes ribosomal protein l <dig>  in contrast, scaled nc' and scaled nc identified rpll  and eno  genes, respectively, as having the strongest cubs .

ribosomal protein  genes are, in general, both essential and highly expressed, and it is believed that their cub values are greater than those of other genes  <cit> . in the case of e. coli, cdc values for  <dig> rp genes vary from  <dig>  to  <dig> , larger than the mean and median values of all e. coli genes . nearly all rp genes have statistically significant cubs, with three exceptions :  rpme: cdc =  <dig> , p =  <dig> ; encoding rp l <dig>  which may be loosely associated with ribosome  <cit> ,  rpmf: cdc =  <dig> , p =  <dig> ; encoding rp l <dig>  which locates near the peptidyltransferase center  <cit> , and  rpmj: cdc =  <dig> , p =  <dig> ; encoding rp l <dig>  which is non-essential for protein synthesis  <cit> . these results suggest that an accurate measure such as cdc has the potential to illuminate the evolutionary process that has operated on each gene.

CONCLUSIONS
in summary, we have described a novel measure of cub, the codon deviation coefficient. as validated by simulated sequences and empirical data, cdc outperforms other measures by providing informative estimates of cub and its statistical significance. cdc features no necessity for any prior knowledge regarding gene expression or function, properly accounts for bnc, and utilizes a bootstrap assessment to evaluate the statistical significance of cub. therefore, cdc promises a significant advance in raw analysis of codon usage, providing the means to better reveal aspects of the historical evolutionary pressures on gene function without the assumptions of underlying reference data sets.

abbreviations
cub: codon usage bias; cdc: codon deviation coefficient; bnc: background nucleotide composition; pcs: positional composition set; a: adenine content; t: thymine content; g: guanine content; c: cytosine content; s: gc content; r: purine content; ai, ti, gi, ci, si, ri, a, t, g, c, s, r at codon position i, respectively, where i =  <dig>   <dig>   <dig> 

competing interests
the authors declare that they have no competing interests.

authors' contributions
zz designed the algorithm, developed the program, and drafted the manuscript. jl participated in the design of the algorithm and analyzed the simulated data. pc collected expression data and analyzed the real data. fd carried out data visualization. al participated in the software development and testing. jpt helped to draft the manuscript and revised the manuscript. jy supervised the study and revised the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
empirical expression data analysis. correlations between codon usage bias and gene expression level in different expression data sets.

click here for file

 additional file 2
estimates of codon usage bias for all e. coli genes. codon usage biases of all e. coli genes estimated by cdc, nc' and nc.

click here for file

 additional file 3
estimates of codon usage bias for ribosomal proteins in e. coli. codon usage biases of ribosomal proteins in e. coli estimated by cdc, nc' and nc.

click here for file

 acknowledgements
we thank anonymous reviewers for their critical comments and constructive suggestions on this manuscript. we also thank joe yu for helpful comments on this work and george marselis for providing assistance on software hosting. this work was supported by king abdullah university of science and technology , kingdom of saudi arabia, and the national science and technology key project ,  <dig> program , and  <dig> program  from the ministry of science and technology, the people's republic of china.
