BACKGROUND
one of the current challenges of genetics is to identify the genes involved in the major physical, regulatory, and signaling events that direct molecular processes. even for well-characterized genetic pathways, our knowledge about the genes involved is often incomplete. however, new high-throughput datasets make it possible to search for hitherto unclassified genes that display coordinated activity with known members of a pathway.

genes that participate in the same pathway or whose products are part of the same protein complex are often coregulated. for example, genes encoding proteins that bind each other in a complex may be coregulated to maintain its stoichiometry. similarly, gene products that signal to each other in a phosphorylation cascade must be present together to communicate. thousands of dna microarray experiments have been conducted to investigate various cellular processes  <cit> . evidence for functional relatedness may be found by searching this growing body of gene expression data  <cit> .

the clustering of genes according to shared expression patterns across diverse microarray experiments has provided insights into gene regulation and has assigned function to previously uncharacterized genes. clustering methods are successful when the set of conditions is small  <cit> , but are limited when the set of conditions is large  <cit> . as gene expression repositories grow, finding the experimental context in which a pathway is coregulated will be a key step in identifying previously unknown genes in a pathway. biclustering methods such as plaid  <cit>  and coupled-two way clustering  <cit>  identify subsets of experiments and genes simultaneously. however, these methods are unsupervised and do not use existing information about a pathway to guide the search for new members. methods that incorporate such information are needed when a gene may belong to multiple pathways or when a pathway is activated under a small set of experimental conditions.

integrating expression data across organisms is another promising approach to increase the accuracy of pathway discovery. coexpression identified in a single organism may result from inherent biological or experimental noise. if identified in multiple organisms, however, coexpression is more likely to reflect a functional link between genes because the coordinated regulation occurs in completely independent datasets and has survived millions of years of selection.

our goal is to develop a search engine that uses gene expression data to predict new pathway members with high accuracy. given a set of genes as input, called the query, the search engine outputs a search ordering in which all of the genes in the genome are ranked according to their coregulation with the query genes. if the pathway genes are loosely coregulated, or the pathway is coregulated with many other pathways in parallel, the pathway genes may not sort to the top of the search ordering. this complicates the identification of new members because many unrelated genes will instead sort toward the top.

we hypothesized that integrating search results obtained on different organisms would improve our ability to identify pathway members. if a pathway's genes are loosely coregulated in not one, but several organisms, the pathway members and their orthologs may consistently rank higher than unrelated genes in searches across the organisms. a search engine that makes use of this tendency may produce a more accurate result. to test this hypothesis, we developed a search engine, the multiple-species gene recommender , which combines search results obtained by the generecommender  <cit>  run on multiple organisms. the generecommender is a search engine that identifies genes highly coregulated with the query genes using data from a single organism. each microarray hybridization, which contains gene expression measurements for a major fraction of genes in the genome, is scored by the generecommender to reflect the extent to which the expression levels of the query genes are coregulated with each other. high scores indicate significantly coordinated up- or down-regulation. the hybridizations with the highest scores are chosen for the next step. the generecommender then returns a search ordering in which the genes are ranked by their coregulation with the query genes under the chosen hybridizations . genes at the top of the search ordering are considered to have higher coregulation with the query genes. here we show that combining search results across species using the msgr improves our ability to predict gene function for several pathways.

RESULTS
searching single organisms
to identify pathways for which combining multiple searches across organisms could improve search accuracy, we assessed the ability of the generecommender to predict pathway membership using data from only a single organism. we extended the generecommender search engine to scan six organisms, including c. elegans, for which the generecommender was designed. gene expression data were assembled from  <dig> homo sapiens ,  <dig> drosophila melanogaster ,  <dig> caenorhabditis elegans ,  <dig> s. cerevisiae ,  <dig> arabidopsis thaliana , and  <dig> helicobacter pylori  microarray hybridizations. a diverse range of experimental conditions was included for each of these distantly related organisms . we tested the generecommender on  <dig> pathways from the genmapp pathway collection  <cit> , a diverse and approximately nonredundant collection of human pathways derived from gene ontology  <cit>  and kegg  <cit> , and pathways contributed by experts in the field .

to determine the accuracy of the generecommender when searching a single organism, we measured the precision of the search orderings returned for each of the six organisms. precision was computed as the fraction of query genes in a hit list, formed by truncating the search ordering at a cutoff that included half of the original query genes, guaranteeing a 50% recall rate for the hit list. half, but not all, of the query genes were included in the hit list, rendering the estimated precision insensitive to genes erroneously included in the query list or to errors in the microarray data . in the example shown in figure  <dig>  the hit list contains  <dig> genes because three of the five human cell cycle query genes were ranked in the top  <dig> of the  <dig> genes in the search ordering. the precision for the hit list shown in this example is therefore 3/ <dig> .

a search result was considered to be "highly precise" if it attained precision levels of at least 20%. at this level of precision, five genes on average would need to be tested to ensure that a related member of the pathway was tested. a search result was considered to be "moderately precise" if it attained precision levels above 2%. at this level,  <dig> genes would need to be tested to ensure that a related member was tested.

to obtain a conservative estimate of the precision, we used query ranks obtained from cross-validation rather than a single search in which all of the query genes were included. we performed a cross-validation in which 80% of the pathway genes were used as the input query to obtain a search ordering from which the ranks of the remaining 20% were recorded. by iteratively withholding a distinct 20% of the query genes, we collected cross-validation ranks for each of the query genes .

for each genmapp pathway, we constructed a corresponding genmapp pathway by replacing each human gene from the original pathway with its putative ortholog in the target species . of the  <dig> genmapp pathways,  <dig> had the minimum number of five genes, required for use with the generecommender, in at least two organisms. a coexpression score for each pathway was computed as the sum of a pathway's precisions in each of the six organisms. high coexpression scores indicated pathways in which the generecommender identified either a highly precise hit list in one organism or moderately precise hit lists in several organisms.

to identify pathways with significant coexpression scores, we ran the generecommender on  <dig> randomly generated queries of the same size as the input queries . the mean of the coexpression scores for the random queries was  <dig>  ±  <dig>  . a coexpression score of at least  <dig> was significant at the  <dig>  level since only a single random query obtained a better precision .

twelve of the  <dig> genmapp pathways tested had significant coexpression scores . six of these pathways had already been shown to be tightly coregulated in gene expression databases: cytoplasmic ribosomal proteins, glycolysis and gluconeogenesis, electron transport chain, proteasomal degradation, trna synthetases, and fatty acid degradation  <cit> . these pathways contain genes involved in basic cellular processes . pathways that did not score well were involved in specific biosynthetic processes , g-protein coupled receptor pathways, apoptosis, ovarian infertility genes, and blood clotting cascade. the scores may have been low because the current gene expression databases lacked conditions under which the genes in these pathways are coordinately regulated or because these pathways may represent biological processes with high levels of evolutionary divergence.

to assess the ability of the msgr to identify genes involved in pathways specific to animals, we tested it on two high-scoring pathways, calcium channels and collagens. the calcium channels pathway comprises a multifunctional set of genes that regulate intracellular calcium levels  and plays a role in hormone and neurotransmitter release, muscle contraction, and immune cell activation. the generecommender achieved a high coexpression score for the calcium channels category  due to its high-precision searches in both fly  and worm . we therefore chose the calcium channels pathway as a positive control. if a high proportion of the genes that rank to the top of the fly result also rank to the top of the worm result, then the multiple-species approach should perform well on this pathway.

the collagens pathway represents a more challenging test of the msgr's ability than the calcium channels pathway. the genmapp collagens pathway contains  <dig> human genes, including the collagen structural genes and other cell-adhesion genes with important roles in the formation of basement membranes, cytoskeletal structures, and the extracellular matrix   <cit> . the single-species results for the collagens pathway were moderately precise . the pathway's coexpression score of  <dig>  was slightly better than that seen in the random controls . thus, for the multiple-species approach to succeed for the collagens pathway, it must combine multiple weak signals into a more predictive result

combining search orderings across multiple organisms to investigate multicellular pathways
next, we asked whether the search orderings obtained in separate organisms for the calcium channels and collagens pathways could be combined to complement one another and produce a more accurate search ordering. the msgr generates new search orderings by combining two or more of the generecommender's search orderings, using a data structure called a phylogenetic merge tree  to determine which species-specific search orderings to combine . the msgr stores the search ordering for a single organism at an organism node corresponding to the organism's phylogenetic position in the tree. the msgr computes a search ordering for a common ancestor by combining the search orderings stored in all of the organism nodes beneath the ancestral node in the tree. the msgr only produces combinations present in the pmt to allow the search engine to scale to a large number of organisms while still producing evolutionarily coherent merges. nodes in the tree are labeled with an initial uppercase letter to distinguish its use from an organism or ancestor .

each node in the pmt contains a different ranking of genes. figure 3b shows an example of how the msgr combines human, fly, and worm search orderings for a human cell cycle query at the animal pmt node. at such an ancestral node in the tree, genes are ranked according to a joint p value that reflects the degree to which a gene sorted to the top of the search orderings in each of the organisms beneath that node . more significant  p values correspond to genes that are ranked toward the top of multiple search orderings. for example, in figure 3b, hdac <dig> sorts higher than mcm <dig> in the ecdysozoan search ordering because the probability of achieving a rank of  <dig> in fly and a rank of  <dig> in worm is lower than the probability of achieving a rank of  <dig> in fly and  <dig> in worm. rather than simply summing up or multiplying the ranks across different searches, the msgr computes a p value that factors in the number of genes considered in each species and the statistical chance of achieving the observed ranks independently at random . results from fly and worm are combined at the ecdysozoa node of the tree, yielding a search ordering specific to those two molting organisms. results from human, fly, and worm are combined at the animal node in the tree, yielding a search ordering specific to those three multicellular organisms. some combinations of organisms may yield more accurate results than others for a particular pathway. for this reason, the search engine inspects the precision of the search orderings at every ancestral and organism node in the pmt to identify good combinations.

to translate a query from a source organism to a target organism, the msgr uses only genes conserved between the two species. for a gene in the source organism's query, the msgr adds a putative ortholog to the target organism's query. to perform this mapping, we use a single best-matching protein, which we refer to as the best target protein , rather than a collection of related proteins, to avoid including large gene families containing paralogs of possibly diverged function . for the remainder of the discussion, we assume that human is the source organism; however, genes from any one of the included organisms can be used to initiate a search.

multiple-species search for genes involved in calcium signaling
the msgr obtained high precision for the calcium channels query when it combined the search orderings from all three multicellular organisms at the animal pmt node. the human query set supplied to the msgr had  <dig> genes. predicted orthologs in either worm or fly were found for seven of these genes . the remaining  <dig> genes did not have best-target proteins in worm or fly either because they belonged to duplicated gene groups  or because no matching gene could be found in either organism . after combining human, worm, and fly search orderings in the animal node, the msgr identified a hit list with a precision at the 50% recall rate of 50% . of the seven original genes in the pathway, four scored in the top  <dig> of the animal node results , and three received poorer ranks .

inspecting the known functions of the genes returned by the msgr suggested that the search engine identified genes coregulated with a conserved calcium-dependant signaling pathway involved in neuromuscular function. of the top  <dig> hits for calcium channels',  <dig> genes were not included in the original query. out of these,  <dig> had functions related to neuromuscular processes , including six that participate in neural or muscular signaling, three that are involved in muscle contraction, and two that are expressed in neurons but with unknown roles. several genes had no known association with neuromuscular signaling, but were known to be involved in other signaling functions. interestingly, of the three ryanodine receptors, only the neuron-specific ryanodine receptor  <dig>   <cit>  was returned; the two non-neural receptors were excluded from the list. the functions of the known genes are consistent with a core calcium-dependent signaling pathway with a specific role in neuromuscular function .

two of the genes in the list, shoc <dig> and usp <dig>  had no prior association with calcium-dependent signaling. shoc <dig> encodes an ortholog of the c. elegans soc- <dig> gene, which is expressed in neurons and muscle of adult worms. usp <dig> is a ubiquitin-specific protease that removes ubiquitin groups from specific proteins to provide "switch-like" behavior in response to multiple different intracellular events, including signal transduction  <cit> . recent studies in d. melanogaster also link ubiquitin modification with a signal transduction cascade initiated after immune cell activation  <cit> .

to test the hypothesis that the genes returned by the msgr participate in a common signaling pathway implicated in neural function, we looked for putative cis-regulatory control sequences . seven transcription factor binding sites were overrepresented in the upstream regions of  <dig> of  <dig> genes from this group . among the transcription factors with binding sites represented in the msgr's search ordering were the neuronal factors zic <dig> and zic <dig>  the zic family is a group of zinc finger proteins that are expressed in the cerebellum and regulate several brain-specific genes  <cit> . of the top  <dig> hits,  <dig> contained a zic <dig> binding site and eight contained a zic <dig> binding site . from simulations with collections of  <dig> genes drawn randomly from the genome, we expected  <dig>   genes with hits for zic <dig> and  <dig>   genes with hits for zic <dig>  significant hits were also found for the myc-associated zinc finger  protein, which interacts with the neural survival factor netrin- <dig>  <cit> . the upstream sequences of the genes identified in the calcium channels hit list were also enriched for binding sites for the brain <dig> transcription factor. brain <dig> is required for establishing mammalian neural cell lineages  <cit>  and is expressed in various parts of the brain  <cit> .

more calcium channels genes than expected by chance had upstream sequences containing binding sites related to immune system functions. for example, enrichment was found for the binding site of the myeloid differentiation factor mzf <dig>  a transcription factor involved in the differentiation of immune responsive myeloid cells from hematopoietic stem cell progenitors. calcium signaling plays a fundamental role in immune cell signaling and activation  <cit> . for example, t-cell activation triggers calcium release from vacuolar stores  <cit> . this suggests the msgr identified a set of genes regulated by both neural- and immune-related factors. these genes may represent a core calcium-dependent signaling pathway that functions in multiple contexts.

next, we analyzed the upstream sequences of the calcium channels query genes that were excluded from the animal hit list based on their expression patterns. of the three excluded query genes, only one had a hit to any of the seven binding sites enriched for the calcium channels hit list . this finding demonstrates the msgr's ability to divide the query genes into a set of genes that are strongly coexpressed with each other and a set of genes that are not coexpressed with each other, as supported by the independent transcription factor binding site analysis.

multiple-species search for genes involved in cell adhesion
to determine if the msgr could combine the moderately precise search orderings from human, fly, and worm to more accurately predict new members, we used the msgr to scan for new genes with functions related to the collagens pathway. twelve genes from the human collagens query set had putative orthologs in worm  and/or fly  .

the query genes sorted significantly toward the top of the multiple-species search orderings. for example, at the 50% recall rate, combining the search orderings gave a precision of 57% at the ecdysozoa node and a precision of 50% at the animal node. among the top  <dig> genes returned by the msgr, the animal node had the highest recall rate , which was higher than that of the single organism results, including human , worm , and fly  .

to obtain evidence that the search engine identified genes belonging to a coherent functional group, we inspected the top  <dig> genes returned by the msgr . several genes had functions related to cell-adhesion processes. among the  <dig> non-query genes identified were both the α and β subunits of the non-erythrocytic spectrin, which interacts with cell-adhesion molecules to form cell-attachment sites  <cit> ; crystallin alpha- <dig>  which is involved in structural integrity of eye cells and has been implicated in the structural integrity of neurons  <cit>  and muscle cells  <cit> ; and adiponectin, whose protein sequence contains a conserved collagen-like domain and is highly expressed in muscle cells  <cit> . six of the remaining  <dig> genes also had cytoskeletal roles , including limatin, syntaxin, filamin, contactin, integrin, and procollagen-lysine 2-oxoglutarate 5-dioxygenase  <dig> 

six of the  <dig> genes had no known direct involvement in cell adhesion. these genes were ataxin  <dig>  high density lipoprotein binding protein , ampk catalytic subunit family member  <dig> , aminoadipate-semialdehyde synthase, atpase h+ transporting lysosomal accessory protein  <dig>  and calumenin. these findings provide additional evidence to link two of these genes to cytoskeletal roles: the ataxin  <dig> gene associates with t- and l-plastins, which belong to a highly conserved actin binding family  <cit> , and calumenin is a ca2+-binding protein of unknown function that is upregulated during bone healing  <cit> . these genes may be good candidates for future studies to further characterize their relationship to cell adhesion .

to test the hypothesis that the genes returned by the msgr participate in a core cell-adhesion pathway, we searched for potential cis-regulatory control sequences in the hit list returned by the msgr . the genes returned by the msgr for the collagens pathway shared binding sites for transcription factors that regulate members of the collagen family. the upstream sequences of these genes were significantly enriched for motifs corresponding to binding sites recognized by the early growth response family of transcription factors egr <dig>  egr <dig>  and egr <dig>  egr <dig> is a structural gene regulator that increases transcription levels of the α <dig> and α <dig> chains of type i collagen and the a <dig> chain of type ii collagen  <cit> . we found upstream sequences for  <dig> of the top  <dig> scoring genes in the hit list. our transcription factor analysis identified  <dig> putative egr-family transcription factor binding sites  in  <dig> of these  <dig> genes. nine genes had hits to the more general egr binding site. based on random simulation , we found this to be significantly more than the  <dig>  genes expected by chance . when the mean score across all genome-wide upstream sequences was used as the cutoff, six additional genes were found to have hits . thus,  <dig> of the  <dig> genes may be regulated by egr-family transcription factors.

one gene from the original query set, col5a <dig>  was excluded by the msgr algorithm. this gene did not have a hit to either the egr or egr <dig> binding site. this finding is consistent with the msgr's prediction that col5a <dig> is under different regulatory control than the other collagen-related query genes.

to determine if the identified binding motifs localize to areas of high sequence conservation, we used the ucsc genome browser's phastcons track  <cit>  to estimate the probability of conservation for each nucleotide in the human genome based on an alignment of  <dig> vertebrate animals. ten of the  <dig> regions representing the predicted binding sites had high levels of sequence conservation . the conservation of these sites supports the hypothesis that the high-scoring genes returned by the msgr belong to a module under common regulatory control by a known cell-adhesion transcription factor.

systematic evaluation of the msgr
next, we tested the msgr on a large collection of pathways from the genmapp database  <cit> . to measure its specificity, we compared the search engine's performance on genmapp to randomly constructed pathways that matched the sizes of the genmapp pathways. genes unrelated to a pathway should be assigned rank-ratios that are uniformly distributed between  <dig> and  <dig>  we cross-validated both the genmapp pathways and the random pathways and plotted the rank-ratios. the msgr ranked genes from known pathways closer to the top of its hit lists than genes from random pathways . the rank-ratios from the genmapp pathways were shifted significantly to the left  while the random pathways were distributed more uniformly. for example,  <dig> times more query genes from genmapp pathways were in the top 1%, with rank-ratio less than  <dig> , than from random pathways.

to systematically compare the precision achieved in multiple- versus single-species searches, we evaluated the msgr's performance on every pathway that had at least five query genes available for searches in single- and a multiple-species. for each pathway, the average precision across the genmapp pathways at the 50% recall rate at each of the  <dig> nodes in the pmt was plotted . at the 50% recall rate, the opisthokont node achieved the highest precision , followed by the ecdysozoa node , and finally the yeast node . the combination of a set of organisms yielded a higher average precision than any single organism over the majority of recall levels tested. for example, the precision-recall curve for the ecdysozoa node was always above the curves for the fly and worm nodes.

we then asked whether the precision levels of the multiple-species search orderings were significantly higher than those of the single-species searches when all levels of recall were considered. the area under the precision recall curve was computed for each pathway, and the means and standard deviations of these areas for each search node across the pathways was determined. the precision of search orderings of ecdysozoa and opisthokont nodes was statistically higher than the precision of the corresponding single-species search nodes . in other cases, the precision of the multiple-species search was statistically comparable to that of the single-species searches . in such cases, not enough statistical power is available to conclude that the multiple-species search is more precise. using a larger collection of pathways might provide a clearer separation in these cases. when the best precision achieved by any of the multiple-species nodes was compared to the best of the single organism nodes for each pathway, the majority of pathways had higher precision for a multiple-species node. .

the higher performance of the multiple-species searches was robust to several factors. to determine if the particular datasets used in the search significantly affected the collagens search result, we removed  <dig> – 90% of random microarray hybridizations for each organism. the collagens search orderings were highly reproducible. for example, even when 90% of the data was withheld, the search engine found  <dig> – 60% of the original top  <dig> hits . to determine if the higher precision of the multiple-species searches than the single-species searches simply reflected the use of conserved query genes, we repeated the cross-validation analysis for the human node using only query genes that had predicted orthologs in both worms and flies. the precision obtained by the human node using only conserved query genes was comparable to that obtained using the full set of query genes, suggesting that the improvement observed in the msgr search is not simply due to restricting query genes to those genes that are highly conserved .

finally, to determine if the search results were sensitive to errors in the orthology prediction, we randomly shuffled a fraction of the orthology mapping, reran the msgr on the  <dig> genmapp pathways, and recorded the average precision for every level of average recall at the ecdysozoa node. while the accuracy of the search does rely on a good orthology prediction, the search orderings had precision levels comparable to those of single-species searches, even when as many as 25% of the orthology assignments were shuffled. shuffling more than 25% of the orthology assignments led to decreased performance when searches were combined across species .

global prediction of new pathway members
we used the msgr to identify pathways that were significantly coregulated in datasets from two or more organisms, as these are the most promising for identifying new candidates. in addition to the genmapp pathways, we ran the msgr on pathways from gene ontology  <cit> , biocarta  <cit> , and kegg  <cit> . altogether, we collected a total of  <dig> pathways for our search .

in general, the searches combining multiple organisms had higher precision levels for more pathways than the searches conducted on single organisms. the result of cross-validation identified  <dig> pathways with high precision  in at least one organism . over half  of these pathways achieved high precision when searches from multiple species were combined even though no single species achieved high precision;  <dig> had high precision in both multiple- and single-species . of the  <dig> pathways with high precision in one organism, 74%  also had high precision in multiple organisms. thus, the expression data appear to have an appreciable degree of complementary information useful for cross-species inferences about gene function.

pathways with high precision at multiple nodes in the pmt correspond to highly conserved core processes. as expected, several pathways related to the ribosomal subunits and ribosome assembly ranked at the top of the list, as did pathways related to protein degradation, energy generation , and stress response. on the other hand, only five pathways achieved higher precision with results from a single organism than with results from multiple species. these may represent cases where experiments relevant to the pathway were collected only on a single organism or where pathways diverged in a lineage-specific fashion so that different sets of genes are coregulated with one another across the organisms.

discussion
combining search orderings from multiple organisms into a single search ordering using the msgr algorithm improved our ability to predict gene function for several pathways. the msgr ranked more query genes to the top of the search orderings compared to the search orderings returned by the generecommender on the same genmapp pathway. overall, the precision levels were statistically higher for multiple-species searches than for single-species searches. in most cases where a search in an organism yielded a highly precise result for a pathway, the performance could be improved by combining results from at least one other organism, the results were relatively insensitive to the particular experiments included in the gene expression database and to small levels of error in the orthology predictions.

the msgr predicted genes for multifunctional pathways with high precision. for example, combining search orderings across the multicellular animals significantly improved the predictive power for finding genes involved in the collagens pathway. the genes returned in the collagens search may represent a conserved cell-adhesion module. several genes returned by the search engine were not known to function with genes in the query and yet shared cis-regulatory sequences with high-scoring query genes. the gene that encodes calumenin was a high-scoring hit for the collagens query and contains a putative binding site for the collagen-inducing factor encoded by the egr <dig> gene. these results suggest specific follow-up experiments to test calumenin's association with the collagens. for example, one could conduct a chromatin-immunoprecipitation assay  in which egr <dig> binding affinity to the upstream region of calumenin is measured. other high-scoring genes returned by the msgr could also be similarly tested using a dna microarray in conjunction with the chromatin-immunoprecipitation assay.

the higher performance of the combined searches than of single-species searches may reflect the msgr's ability to focus on gene activity that is functionally relevant. coregulation of a pair of genes conserved across large evolutionary distances implies that the coregulation confers a selective advantage. the meta-search strategy implemented by the msgr may be making use of the presence of biologically relevant couplings between such genes.

while the msgr has shown initial promise as a predictive tool, we anticipate future improvements that address several of the msgr's current limitations. the msgr has a limited view of gene function because it uses gene expression data exclusively. researchers can now access other kinds of genome-scale datasets such as protein – protein interaction maps  <cit>  and genome-wide rnai screens  <cit> . however, since the msgr uses only the ranks from different searches, the results of a search engine for a new data type can be incorporated into the msgr. we plan to investigate which combinations of data sources improve the performance for specific pathways.

the msgr is also limited because it attempts to use the entire input pathway without modification. to circumvent this limitation, an algorithm that iteratively adds to and subtracts from the current query set could be implemented. high-scoring genes from one round could be included as query genes in the next round, in an approach analogous to that used by the signature algorithm  <cit> . a given query could also be split into functionally distinct subgroups of genes in a pathway. genes in each subpathway may be more tightly coregulated with each other than with other genes in the pathway. in such cases, the query set could be partitioned by running cross-validation to score each held-out query gene. high-scoring query genes could then be retained as the new set of query genes. repeating this procedure on the remaining unselected queries might identify tightly coupled subqueries for which separate recommendations could be provided.

finally, the msgr uses an orthology prediction based on reciprocal blast comparisons of peptide sequences to link gene expression data across species. the msgr takes a conservative approach by using only btps where no conflicts are present. because some protein families are large, this approach cannot resolve the orthology assignments for many human genes, significantly reducing the number of genes that can be used as queries. adding organisms that are more closely related to human, such as mouse, will help to increase this number for human pathway searches. a future direction is to test alternative orthology prediction sets with the msgr such as inparanoid  <cit>  and orthomcl  <cit> .

CONCLUSIONS
the molecular biology community continues to amass data about complex genetic pathways by using high-throughput technologies. it is critical to the progress of both science and medicine that, in addition to the organization and dissemination of this information, methods for searching the data be developed to further improve our understanding of genetic pathways. our approach aims to help biologists broaden their understanding of molecular mechanisms by enabling them to quickly scan for new genes that are coregulated with a query list of genes. the msgr search engine should allow functional genomics data to be tapped for investigations of a broad range of genetic mechanisms. a user interface and the source code for the msgr are available from our website  <cit> .

materials and methods
given a set of genes that are functionally related, called the query, the msgr scans gene expression data across multiple organisms to identify genes of related function. the msgr combines search orderings from searches in multiple organisms into a single search ordering. the msgr merges the search orderings using a probabilistic scoring method based on order statistics and outputs a ranked list of genes sorted by their scores. genes that rank toward the top of independent generecommender searches in different organisms receive smaller p values  than genes with lower ranks across the organisms.

gene expression datasets
for this study, we incorporated data from six organisms: homo sapiens, drosophila melanogaster, caenorhabditis elegans, saccharomyces cerevisiae, arabidopsis thaliana, and helicobacter pylori . gene expression data from gene expression omnibus was collected on july  <dig>   <dig>  and were combined with the data from our previous study  <cit> . the combined data reflect  <dig> microarray hybridization measurements  in humans,  <dig> in flies,  <dig> in worms,  <dig> in yeast,  <dig> in plants, and  <dig> in bacteria. the number of genes probed was  <dig>  in humans,  <dig>  in flies,  <dig>  in worms,  <dig> in yeast,  <dig> in plants, and  <dig> in bacteria.

all single- and dual-channel hybridization results were compiled into a single compendium for each organism. a log-ratio for the single channel results was calculated before merging with the dual-channel results. we first collected all of the single channel data and computed a virtual reference for every gene as the median expression value of the gene across all of the collected single channel arrays. we then divided each absolute single channel value by the gene's virtual reference and took the logarithm base-two. the dataset for each organism is available from our website  <cit> .

gene pathway datasets
we collected a total of  <dig> human genetic pathways from several pathway databases on august  <dig>   <dig>  these included  <dig> human pathways from kegg  <cit> ,  <dig> from the genmapp collection  <cit> ,  <dig> from biocarta  <cit> , and  <dig> from gene ontology  <cit>  . to define a nonredundant set of pathways from the go database, we restricted the list of the total  <dig> categories to those that occur at level three in the go hierarchy and that contained between five and  <dig> genes . some of the pathways are very similar. for example, three categories represented the cytosolic ribosome: the ribosome kegg category, the cytoplasmic ribosomal proteins genmapp category, and the cytosolic ribosome  go category. we kept this redundancy in our pathway lists because the lists in the different databases often differed, even for well-documented pathways. for example, the proteasome category in the kegg database proteasome had  <dig> genes, while the go category proteasome complex  had  <dig> genes. because such differences could be important for predicting gene function, we chose to be inclusive and investigate all pathways. each gene in a pathway was associated with data in our expression database by using each gene's corresponding entrezgene identifier  <cit> . a summary of the number of genes and the number of pathways is listed in table  <dig> 

search procedure
the msgr takes as input a set of genes, the query, and calls the generecommender  <cit>  to find genes that are highly coregulated with the query genes. the expression data for species s is normalized so that each gene's expression levels are ranked and uniformly arranged on the interval . the generecommender uses the normalized matrix of expression levels to identify informative experiments and then rank genes according to their correlation with the query in those experiments.

identifying informative experiments
a set of query genes may be coactivated in only a subset of the experiments in a database. we expect these experiments to be informative in the sense that they are likely to be the most useful experiments for identifying additional genes with shared function. to identify informative experiments, the generecommender scans for microarray experiments in which the given query genes are either coordinately up- or down-regulated. it scores the eth experiment in species s using the following score:

 e=kesμqesσqes2+13ms <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrcqggoaakcqwglbqzcqggsaalcqwgzbwccqggpaqkcqgh9aqpdagcaaqaaiabdugarnaabaaaleaacqwglbqzcqwgzbwcaeqaaaqabagcdawcaaqaaggaciab=x7atnaabaaaleaacqwgrbqucqwglbqzcqwgzbwcaeqaaagcbawaaoaaaeaacqwfdpwcdaqhaawcbagaemyuaelaemyzaumaem4camhabagaegomaidaaogaey4kasyaasaaaeaacqaixaqmaeaacqaizawmcqwgtbqbdaqhaawcbagaem4camhabagaegomaidaaaaaaeqaaaaakiabcycasaaa@4d05@ 

where kes is the number of query genes with valid data in experiment e, μqes is the mean, σqes is the standard error of the normalized expression levels of the query genes, and ms is the number of total experiments in species s. extreme values of e indicate that an experiment may help predict new genes because several of the query genes obtain either highly positive or highly negative expression levels relative to the rest of the experiments in the database. the generecommender selects a set of experiments, i, with absolute scores exceeding an optimized cutoff, c. to optimize the cutoff, the generecommender tries several different values and chooses the threshold that gives the highest precision at the 50% recall rate.

ranking genes by relevance
the generecommender scores every gene g based on the extent to which its expression profile correlates with the query over the informative experiments identified in the previous step. the generecommender's score for gene g is:

 g=∑e∈iμqesxges13∑e∈iμqes <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwghbwrcqggoaakcqwgnbwzcqggsaalcqwgzbwccqggpaqkcqgh9aqpdawcaaqaamaaqafabaaccigae8hvd02aasbaasqaaiabdgfarjabdwgaljabdohazbqabagccqwgybawdawgaawcbagaem4zacmaemyzaumaem4camhabeaaaeaacqwglbqzcqghiiizcqwgjbqsaeqaniabgghildaakeaadagcaaqaamaalaaabagaegymaedabagaeg4mamdaamaaqafabagae8hvd02aa0baasqaaiabdgfarjabdwgaljabdohazbqaaiabikdayaaaaeaacqwglbqzcqghiiizcqwgjbqsaeqaniabgghildaaleqaaaaakiabcycasaaa@5563@ 

where xges is the normalized expression level of g in the eth experiment of species s. g is a dot-product between gene g's expression profile and the centroid of the query genes scaled by an estimate of the standard deviation of g's expression levels. the msgr sorts all of the genes in decreasing order by g and assigns a rank, vgs, corresponding to g's rank in the search ordering of species s. to compute a combined score for the gene, the msgr uses the ranks obtained for a gene and its orthologs across the six species, .

predicting orthologous genes
the query set may contain genes from any one of the six organisms, which is referred to as the source organism. to scan gene expression datasets from additional organisms other than the source organism, the msgr translates the query genes from the source organism to a target organism by using a sequence-similarity look-up table.

the look-up table containing putative orthologous relations is constructed by finding all best protein matches  for every gene in each of the six organisms. a bpm for each gene from a source organism is found by using the blastp algorithm  <cit>  to compare the gene product's amino acid sequence to that of each gene product in a target organism. a bpm is an ordered pair  recording which gene h in the target organism has the best matching peptide sequence to gene g from the source organism. gene h is found by identifying the gene with the minimum e-value among all of the genes in the target organism's protein sequence database. matches with e-values greater than 1e- <dig> are excluded from consideration.

in many cases, multiple genes from the source organism match the same gene in the target organism. these situations may be the product of gene duplication events, giving rise to one gene that retained the ancestral function and another gene that diverged in function. to avoid matching paralogous genes from a source organism, we include only the highest-scoring gene from a source organism. define the best target protein  for the source query gene g as the gene h in the target organism where  either is the only bpm for gene h or has the highest blastp score of all bpms in the source organism that include gene h. btps for all genes in the query are identified and used as the query for the target organism. genes that lack a btp in a species are excluded from the search ordering in that species. the table of all orthologous assignments can be found on our website . note that the btp defined here is not strictly reciprocal since gene g may not be the btp of gene h .

combining search orderings across organisms
given a query, the msgr scores each gene in the genome based on how similar its expression levels are to the expression levels of the query genes. the msgr is run on the six organisms individually, yielding independent search orderings for each organism having at least the minimum number of genes orthologous to those genes in the query . to construct a query set in fly from a query set in human, orthologous protein sequences in fly are identified by looking for fly proteins associated with the given human proteins in the btp table that translates human proteins to fly proteins. the generecommender is used to rank all of the genes in a single organism's genome in decreasing order of expression similarity to the query set. the expression similarity is computed over a set of informative conditions identified by the generecommender algorithm.

as illustrated in figure  <dig>  there are five branches in the phylogenetic merge tree , corresponding to the five common ancestors shared by the six organisms: the cellular ancestor common to all of the organisms, the eukaryotic ancestor common to all of the organisms except the bacterium h. pylori, the opisthokont ancestor common to the non-plantlike eukaryotes, the animal ancestor of the multicellular eukaryotes, and the ecdysozoan ancestor of the molting organisms from which flies and worms descended. nodes in the pmt are referred to using labels containing an initial uppercase letter: human, fly, worm, yeast, plant, bacterium, cellular, eukaryote, opisthokont, animal, and ecdysozoa. for any given query,  <dig> different search orderings are returned corresponding to the six searches run on the individual organisms plus the five combined search orderings at the ancestral nodes of the tree.

the msgr combines the organism-specific search orderings to produce a new search ordering for each ancestral node in the pmt. fly and worm orderings are merged into a new search ordering at the ecdysozoa node. human, worm, and fly orderings are merged into a single ordering at the animal node. the search orderings of all six organisms are combined to produce a new search ordering at the cellular node. a gene is included in the search ordering of an ancestral node if a btp exists in the search ordering of at least one organism in both the left and right sub-trees beneath the node. for example, a gene will be used at the cellular node if its orthologs appear in search orderings in either human, fly, worm, yeast, or plant nodes and a search ordering in the bacterium node.

the result of an msgr search at a particular node t in the pmt associates a set of ranks to a particular candidate gene. recall that vgs is the rank of candidate gene g in the search ordering of species s. each rank is converted to a rank-ratio, rgs = /, where ns is the maximum rank possible for species s. the rank-ratios range between  <dig>  indicating g is coregulated with the query, and  <dig>  indicating g is not coregulated with the query. the rank-ratios for g at node t are recorded in increasing order in the list denoted rgt. for example, at the animal node, g's ranks might be rganimal =  if rghuman ≤ rgfly ≤ rgworm and g had orthologs with expression data in these three organisms.

the rank-ratios assigned to g at node t are scored to reflect their degree of non-randomness. the p value for the probability of observing a set of n rank-ratios or smaller by chance is computed. small p values correspond to candidates that are more likely to be related to the query pathway. for a gene that is unrelated to the original query set, its rank-ratios are expected to be uniformly and independently distributed between  <dig> and  <dig>  thus, the p value can be computed from the joint cumulative distribution of a set of uniformly distributed order statistics. the following recursive formula gives this quantity:

 p=∑j=1|rgt|p,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqggoaakcqwgsbgudawgaawcbagaem4zacmaemidaqhabeaakiabcmcapiabg2da9maaqahabagaeiikagiaemouai1aasbaasqaaiabdeganjabdsha0bqabagccqggbbwwcqwgqbgacqggdbqxcqghsislcqwgsbgudawgaawcbagaem4zacmaemidaqhabeaakiabcufabjabdqgaqjabgkhitiabigdaxiabc2fadjabcmcapiabdcfaqjabcicaoiabdkfasnaabaaaleaacqwgnbwzcqwg0badaeqaaogaei4waslaeyoei0iaemoaaomaeiyxa0laeiykakcaleaacqwgqbgacqgh9aqpcqaixaqmaeaacqgg8bafcqwgsbgudawgaaadbagaem4zacmaemidaqhabeaaliabcyha8bqdcqghris5aogaeiilawcaaa@62c0@ 

where rgt is the set of ordered rank-ratios, p is the probability of getting rank-ratios equal to or smaller than the ordered rank-ratios in r, r is the jth largest rank-ratio in r, and r  is the set of rank-ratios remaining after removing the jth largest rank-ratio . this is an approximation because the rank-ratios are discrete rather than continuous. however, because the expression datasets contain many genes, the continuous approximation to the discrete distribution is expected to be sufficiently accurate.

measuring the precision and recall of a search
the accuracy of a search is assessed with a cross-validation test in which a measure of precision and recall is computed based on the msgr's ability to rank withheld members of the pathway toward the top of the returned search ordering. given a query q of n genes, we randomly partition the set of genes into five folds. each fold f holds out a set of genes hf from the query and reconstructs a new query set, qf, which has ⌊4n/5⌋ genes, qf = q - hf. the rank percentiles for each left-out gene in hf are collected from all of the folds to obtain ranks for all of the original query genes.

the number of pathway genes a and nonpathway genes b that receive a rank of c or better when withheld in a particular cross-validation fold are counted. by varying the cutoff c, we obtain different values for a and b. the precision is then computed as a/ which reflects the degree to which the query genes rank toward the top of the list in a particular cross-validation fold. the recall is computed as a/k, where k is the total number of pathway genes that were scored by the msgr. the average of the precision and recall is taken across the cross-validation folds to obtain an average precision and an average recall for a single pathway. note that the value of k changes depending on which pmt node is being searched. for example, some genes may not have a btp or may not have any data collected in any one of the organisms beneath a particular node in the pmt. a range of average precisions as a function of the average recall is obtained by sweeping through different values of c.

identifying overrepresented transcription factor binding sites in a hit list
putative binding sites that are significantly overrepresented in the upstream regions of the genes returned in a hit list returned by the msgr are identified by scanning matrices representing  <dig> human binding site models taken from release  <dig>  of the transfac database  <cit> . upstream  <dig> base-pair regions of  <dig>  genes were downloaded from the ucsc genome browser  <cit>  for the human genome   <cit> .

a binding site score between a gene g and matrix m, bgm, is computed with tffind  <cit> , a program that assigns a score, ranging from  <dig>  to  <dig> , for each position in g's upstream region. bgm is defined as the highest position-specific score. because different transcription factors may have different binding specificities, it is unknown what cutoff for bgm to use, above which m is considered a match to gene g. we therefore try a series of cutoffs to identify which cutoff gives the optimal separation between the genes in the hit list and all of the genes in the genome. for each m, the cutoff is varied between αm and  <dig>  where αm is the mean of the best score attained by the matrix across all upstream regions in the genome. for each cutoff, the percentage of background genes that have a best score at least as high as the cutoff is recorded. this value is then used to estimate the p value for the match between m and the hit list using the hypergeometric distribution. the cutoff that achieves the best p value is chosen as cm and used to determine which genes in the hit list have a hit to the matrix. all matrices with a p value of  <dig>  or lower and with at least 25% coverage of the genes in the hit list are reported. we also report an enrichment score, defined as the ratio h/e, where h is the percent of genes in the hit list that have a match to m and e is the percent of genes in the background distribution that have a hit to m.

the significance of the number of genes in a hit list with matches to binding site matrix m is estimated by using a simulation to construct a null distribution for m. k genes are drawn randomly from the genome, where k is the same size as the number of genes in the hit list. each gene's upstream region is scored with matrix m by counting the number of randomly drawn genes that achieve scores equal to or greater than cm. a distribution is constructed from  <dig> random simulations. to obtain the corresponding p value for that matrix, the number of matches to matrix m in the hit list is compared to the mean and standard deviation of this distribution.

determining the conservation of binding site predictions
the degree of conservation of a predicted binding site was determined with the phastodds program  <cit>  and the conservation track of the ucsc genome browser  <cit>    <cit> . this build contains multiple alignments of  <dig> vertebrates, including mammals, amphibians, birds, and fish. a log-odds conservation score for each binding site prediction was determined with phastodds. the phastodds score is a ratio of the likelihood of two phylogenetic models: a positive model to detect conserved sequences and a background model representing nonconserved sequences. regions with scores greater than  <dig> are considered conserved because the observed conservation patterns fit the conserved model better than the nonconserved model. the nonconserved model was estimated from fourfold degenerate sites in coding regions using the phylofit  <cit>  program. the positive model was derived from the nonconserved model except that the model's substitution rate parameter was estimated using phastcons  <cit>  run on multiple alignments of the  <dig> vertebrates produced by the encode consortium  <cit> . before running the conservation analysis, overlapping predictions are merged to avoid over-estimating the number of conserved binding sites.

authors' contributions
cc implemented the algorithm and performed the computational tests. mw performed the transcription factor binding analysis and helped to draft the manuscript. cp developed and wrote the mathematical proofs. az participated in the analysis of the search results. js conceived of the study, and participated in its design and coordination and drafted the manuscript. all authors read and approved of the final manuscript.

supplementary material
additional file 1
appendix. discussion of related work and proof of correctness of order statistics implementation.

click here for file

 additional file 7
table s <dig>  the query list of genes for the calcium channels and collagens genmapp pathways.

click here for file

 additional file 10
table s <dig>  summary of significant cis-regulatory motifs identified in the collagens and calcium channels search results.

click here for file

 additional file 11
table s <dig>  sequences of potential cis-regulatory binding sites of transcription factors identified in the calcium channels search results.

click here for file

 additional file 12
table s <dig>  sequences of potential cis-regulatory binding sites identified in the collagens search results.

click here for file

 additional file 13
table s <dig>  conservation of predicted binding sites in the collagens search result.

click here for file

 additional file 2
figure s <dig>  precision-recall results of the msgr run on the genmapp test pathways. plotted are the same results as shown in figure 5a of the text, but the precision estimates have here been augmented to include standard error bars to show the variability of the msgr's performance across the pathways.

click here for file

 additional file 3
figure s <dig>  robustness of the collagens search result to various fractions of held-out data.

click here for file

 additional file 4
figure s <dig>  performance of single-species search using query sets restricted to conserved genes.

click here for file

 additional file 5
figure s <dig>  performance as a function of orthology prediction error.

click here for file

 additional file 6
table s <dig>  the pathways tested in the study.

click here for file

 additional file 14
table s <dig>  pathways for which accurate predictions with the msgr could be made.

click here for file

 additional file 8
table s <dig>  the top  <dig> genes returned by the msgr search at the animal node for the calcium channels genmapp pathway.

click here for file

 additional file 9
table s <dig>  the top  <dig> genes returned by the msgr search at the animal node for the collagen genmapp pathway.

click here for file

 additional file 15
table s <dig>  list of putative orthologs used in the study.

click here for file

 acknowledgements
we are grateful for the thoughtful comments provided by a. castillo and a. preble. we thank s. ordway for insightful editorial assistance. the work was supported by a grant from the national science foundation's division of biological infrastructure dbi- <dig>  mw was supported by a national institutes of health training grant  <dig> t <dig> gm070386- <dig>  az was supported by an american heart association postdoctoral fellowship 042528y.

figures and tables
athe hugo name for the gene. genes in the original query set are italicized.

bmsgr combined p value. this p value was not adjusted to reflect multiple testing; a bonferroni correction could be applied by multiplying each by  <dig> to account for searches at each node in the pmt.

cinvolved in cell – cell or intracellular signaling.

dneuromuscular function.

epredicted binding site for the zic family of transcription factors.

fpredicted binding site for maz or mazr.

gpredicted binding site for the brain <dig> transcription factor.

ha "y" indicates that a gene had a positive hit for a particular field.

*n/a corresponds to cases where no best target protein could be identified in a particular organism.

athe hugo name for the gene. genes in the original query set are italicized.

bmsgr combined p value. this p value was not adjusted to reflect multiple testing; a bonferroni correction could be applied by multiplying each by  <dig> to account for searches at each node in the pmt.

cinvolved in cell – adhesion.

dpredicted binding site for the egr family of transcription factors.

*n/a indicates that an upstream region could not be obtained for the given gene.

ea "y" indicates that a gene had a positive hit for a particular field.

anumber of genes with btps to a human gene.

bnumber of genes that have btps and have expression data.

ctotal number of genes with available expression data.

dtotal number of pathways with at least five genes.

enumber of human genes with protein sequences available for constructing the btp table.
