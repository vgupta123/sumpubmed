BACKGROUND
introduction
the advent and proliferation of public social media platforms has provided unprecedented access to large streams of information related to drug effects. such data can provide significant insights about drug action at a scale  that far outstrips what can often be considered in clinical trials. consider for example this  twitter message: “prednisone did kill most of my gut microbes & worsened my malnutrition though.” evidently, the tweet contains significant drug effect and adverse side-effect information. furthermore, the information is being provided, possibly in a time-frame that is recent vis-à-vis the described drug-effects. thanks to the “share all” usage promoted on social media, the content of such streams is widely available and may be used for pharmacovigilance and/or for collecting large-scale longitudinal information on therapeutics and their intended as well as side effects. at the same time, it should be noted that in the above tweet, the relevant information is embedded in a very short and noisy stream of conversations.

a particularly important formulation in this context is the identification of adverse drug events/effects . an ade can be defined as “any undesirable effect of a drug beyond its anticipated therapeutic effects occurring during clinical use”  <cit> . ades are estimated to account for  <dig>  % of hospitalizations each year with an additional  <dig>  % incidence rate among already hospitalized patients. significantly, ades are between the fourth and sixth leading cause of death in hospitals  <cit> . ades have led to the withdrawal of several drugs, including rofecoxib  whose long term cardiovascular risks were only later known  <cit> . typically, for a given drug, it is expected that ades would be identified during clinical trials. however, due to a variety of factors including intrinsic polypharmacology of a drug, formulation of the trial criteria, and the limited diversity of the cohort that can be accommodated, ades may only be partially identified. traditionally, aftermarket ade identification is performed as a post-factum analysis of explicit event reports from voluntary post-market surveillance programs such as the us food and drug administration’s adverse event reporting system  which allows clinicians, drug manufacturers and consumers to report potential ades. the shortcomings of such a spontaneous reporting systems  are well documented  <cit> , and include latency, both in the reporting of ades and their analysis. more importantly, because reports are filed voluntarily by the users of the system, it is estimated that less than 10 % of cases involving ades actually get reported  <cit> .

due to these reasons, identification of ades through algorithmic analysis of information from alternative sources such as electronic medical records, search engine query logs, internet forums and social media is increasingly becoming important. at over  <dig> million posts per day, twitter is one of the more commonly used social media platforms. the ubiquity of its day-to-day personal information exchange model makes twitter data  a promising target for ade mining and real time pharmacovigilance. in this paper we describe an analytic framework for the identification of ades in twitter-streams. the proposed approach leverages a graph-theoretic framework to represent drug and side effect information from tweets. this information is enriched using supplemental databases, such as the side effect resource   <cit> , that store ade-related data. information enrichment between the two sources is facilitated by an edge matching strategy.

the benefits of such a framework are threefold: first, it provides a mechanism for hypothesis generation of previously unreported ades. second, the identification of known ades in real-time social media streams can promote timely medical intervention. third, it can supplement current srss for a more accurate representation of ade frequency in the public. the key features and contributions of our work include:
drug-effect knowledge representation framework: a graph-theoretic knowledge representation framework which we call the drug effect graph  is proposed to rigorously integrate and model drug and side effect relationships found in both twitter-streams and static ade databases. our method shows performance gains of up to 8 % over previously published methods.


automated twitter-stream processing: we implement a twitter processing pipeline in two phases. first, we use a machine learned twitter content filter to identify twitter posts that relate a user’s personal experience. we then extract medically relevant terms with the metamap information extraction system.


semantic context of medical terms: we incorporate semantic, conversation level features into the deg model, including sentiment polarity and topic context. this allows the model to consider how the medical terms are being discussed when identifying ades, leading to significant performance gains.


adverse drug effect discovery: the deg model provides a mechanism for hypothesizing implicit ades that are not represented in the source data through edge enumeration and classification. specifically, we identify several instances of ades which, though not present in the sider resource show evidence in both medical literature and the twitter-stream.




prior work
traditionally, ades have been identified through expert review of the event reports. obvious scalability concerns have led to the application of data mining approaches on srs repositories to find abnormally frequent drug-event relationships at scale. the fda has employed gamma poisson shrinking  and multi-item gamma poisson shrinking  algorithms  <cit>  and the world health organization has used bayesian confidence propagation neural networks  at its upsalla monitoring center  <cit> . additionally, empirical bayes screening  <cit> , odds ratios  <cit> , and incidence report ratios  <cit>  have been successfully implemented. association rule mining  <cit>  and biclustering  <cit>  have also been explored to detect pairs of events that occur together with high confidence in a report database. these data sources have also been used to identify novel drug-drug interactions through regression modelling  <cit> . all of these methods, however, rely on the integrity and completeness of the voluntary reporting mechanism and therefore suffer from the issues mentioned previously.

less direct methods of discovery have been explored to overcome the weaknesses of srs analysis. for example, latent ades have been mined from patient electronic medical records  where prescriptions and symptoms are recorded individually, yet correlations between them have not been explicitly noted. emrs contain both structured data  and unstructured data , both of which have been targeted for ade discovery. methods from srs mining have been applied here such as gps, mgps, and bcpnn as well as association rule mining and biclustering approaches  <cit> . information extraction techniques from the field of natural language processing have been used to identify drug-effect pairs in textual patient discharge summaries  <cit>  with a χ
 <dig> test to identify potential ades.

as an alternative to post-factum report analysis, predictive methods have been developed to leverage the content of wider biological resources. the fda approved drug labels include textual pharmacological content such as the known drug side effects and indications. in this context, topic modelling has been applied to find common pharmacological “topics” or distributions of effects amongst the drug labels. these topics allow for drug clustering and prediction of unreported ades through association  <cit> . this method has also been applied to the question of drug repositioning. the mechanistic relationship between drug effects and drug-protein interactions motivated the integration of drug-protein interaction networks with the drug-effect networks implicit in drug labels to predict ades  <cit> . in a similar vein, off target drug interactions were predicted using the molecular similarity between drugs and known ligands. these predicted off-target interactions were shown to explain several known ades  <cit> .

new and non traditional data sources have recently been explored as targets for ade identification. these include search engine query logs, internet forums, and social media messages. with the hypothesis that users search for their symptoms and the drugs they are taking, the search logs of several major search engines were mined for drug-effect associations and drug pair-effect associations in  <cit> . as a proof of concept, the study showed the ability of search logs analysis to correctly correlate the drug pair pravastatin and paroxetine with symptoms of hyperglycemia. unfortunately, access to search engine query logs is not a privilege afforded to most researchers. additionally, association rules have been mined from these new media sources. an association rule is a rule of the form {a
1
,a
 <dig> 
…,a
n} → {c
1
,c
2
,…,c
m} where the occurrence of the antecedents a
i predict the occurrence of the consequents c
j with a given confidence. association rule mining suffers from the lack of a global model so information about entities not present in the rule makes no contribution. also, in the case of sparse data, confidence values may be over estimated. a related notion is that of language templates that represent usage patterns containing ade references, for example “i took , now i feel .” this approach has been applied to text from the medical internet forum dailystrength  <cit> . in addition to limitations related to association rules, the method is sensitive to minor variations in language. furthermore, all ade information are required to be contained within a single sentence precluding identification of ades with long range dependencies, for example across sentences in a user post, or across posts in a user’s history.

twitter constitutes a natural target for ade identification. in  <cit> , a multi stage svm classification pipeline was used in conjunction with an entity extraction system to identify individual tweets containing ades. this and related approaches  suffer from the same assumption as the forum mining method above, namely, that an individual tweet must contain all elements of the ade. to address this issue, a global knowledge structure was proposed in  <cit>  to represent co-occurrences of drug and effect references on social media as a bipartite graph and the ade identification problem was posed as an edge classification problem between nodes in the graph. such a graph representation can be understood as a generalization of the association rule approach for the single precedent – single consequent case, in that, a rule is represented as an edge in the graph. while clearly an advancement in holistic knowledge modeling, the implementation in  <cit>  neither leveraged the inherent transferability of knowledge provided by the graph data structure nor did it attempt to exploit the context in which the drug and effect references were embedded. obviously, the manner in which drugs and effects are discussed can provide valuable information about their relationship. the notion of enriching a relationship graph with semantic context has been successfully employed in the context of biomedical literature mining  <cit> .

the proposed method leverages the global drug-effect knowledge structure of the deg model but does not limit it to the drugs and effects found in one data source. the formal deg structure allows for an implicit mapping between edges in degs constructed from different data sources. we exploit this property by constructing two degs, one from drugs and effects identified in twitter-streams and one from the side effect resource , and leveraging them jointly for ade identification. additionally, we enrich the deg with information about the semantic context in which the drugs and effects are discussed on twitter. overall, the method allows for the identification of ades in social media with long range dependencies. as a framework for general drug – side effect analysis, it is not strictly limited to use on twitter and sider. it may be applied to other social media platforms such as forums and blogs as well as other static knowledge bases. thus, the data sources can be broader and more current than those used in traditional srs and emr based approaches. finally, we use the deg model to hypothesize unrepresented ades by enumerating and individually classifying all potential edges in the deg. in particular, we are able to identify several ades that are not reported in the sider resource.


methods
our method is based on a graph-theoretic framework, which we call the drug effect graph . a deg is a graph that models the relationships between drugs and side effects. properties of deg can be used to distinguish between relationships that represent ades and those that do not. in this work we construct two degs over two datasets and then use them jointly to improve overall performance of ade identification. the first deg is built on the drug - side effect relationships recorded in the side effect resource   <cit>  and the second deg is built by extracting information from the social media network twitter. finally, we use the deg knowledge structure to discover ades that, while explicitly absent in the data source, are otherwise noted in medical literature.

data sources
our work is built on publically available data from two resources, the sider side effect resource and the twitter microblog social media platform. sider is a database of drug and side effect relationships extracted from the text of fda package inserts that list known drug side effects. this database currently contains  <dig>  drugs,  <dig>  side effects, and  <dig>  drug-side effect relationships. drugs are identified by their pubchem compound id, thus individual chemical compounds with multiple trade names are identified by a single id. side effect terms come from the medical dictionary for regulatory activities  list and are provided with concept identifiers that map to the unified medical language system   <cit> .

twitter is a microblog social networking platform that allows users to post “status updates,” or “tweets,” containing up to  <dig> characters of unicode text. users are neither limited in post frequency nor censored on content. twitter data is accessed through two free public apis. the streaming api provides access to the real-time twitter-stream, and the search api allows querying against previously posted tweets. we note that neither of these public apis guarantee completeness of results, and each api provides access to only a sampling of the total posts reported at approximately 1 %.

basic concepts and definitions
this section presents the set of definitions and notations used throughout the paper. drugs refer to chemicals used for therapeutic intervention and are limited here to the set of drugs contained in the sider database and associated synonyms. we understand side effect to be any physiological effect caused by taking the drug, excluding the expected therapeutic effect. side effects are a consequence of drug polypharmacology as well the interplay of bio-molecules and pathways. the set of side effects we consider is limited to those contained in the sider database. a drug effect graph  is a bipartite graph modeling drug-side effect relationships where drugs and side effects are disjoint partite sets of nodes and an edge indicates a drug - side effect relationship. deg
sider is a deg constructed on the sider database. deg
user is a deg constructed out of the drug and effect entities found in the tweet history of an individual twitter user. deg
twitter is a deg constructed out of one or more deg
user graphs by combining their nodes and edges. an adverse edge is an edge in a deg  that connects a drug to an effect known to be adverse in the sider database. a pseudo-non-adverse edge is any edge that is not explicitly considered adverse. the pharmacological neighborhood of a drug node x in a deg is denoted by Γ and is defined as the set of nodes that can be reached within two hops of x. thus, two drugs are considered to be pharmacological neighbors if they share a side effect and vice versa.

we consider a tweet to be experiential if it relates the personal experience of an individual user, as opposed to tweets posted as advertisements, news sources or other non personal tweets. an entity in a tweet is any drug or drug-effect mentioned within the tweet.

method overview
our method consists of the construction of two degs, deg
sider and deg
twitter, that are used in conjunction to identify ade’s in twitter-streams. figure  <dig> provides an overview of the deg construction process. the construction of deg
sider is relatively straightforward; the nodes are all individual drugs and effects in sider and the drug-effect relationships from sider are represented as edges. the construction of deg
twitter is significantly more complex. first, a set of tweets is collected using the twitter streaming api. we filter for tweets that are both experiential and reference a drug from a list of  <dig> commonly prescribed drugs . user tweet histories are then queried using the twitter query api. drug and effect entities are extracted from the user tweet histories with the metamap information extraction system. edges are constructed in the deg
twitter between drug and effect entities that are mentioned within a prescribed time window in an individual user’s history. edges are labeled based on the sider database. these degs are used to build classification models that can, with high accuracy, predict whether a drug-effect relationship is adverse.fig.  <dig> method overview. two degs are constructed from two datasets, sider  and twitter   <dig>  degsider is a graph built from the drug and effect relationships recorded in the sider database, forming a comprehensive deg containing the adverse drug relationships known to sider.  <dig>  degtwitter is constructed by mining twitter posts for mentions of drugs and effects.  <dig>  the live twitter-stream is filtered for tweets that reference drugs and relate an individual user’s experience.  <dig>  from the tweets gathered from the twitter-stream, user’s histories are queried.  <dig>  drug and effect mentions are extracted with metamap.  <dig>  an edge is drawn between a drug and an effect if they are both referenced in a user’s history within a fixed window of time. these edges are labeled as adverse or psuedo-non-adverse based on their presence or absence in sider




constructing degsider
the sider database contains a set of drugs d = {d
1
,d
2
,…d
n}, where n =  <dig> , a set of side effects s = {s
1
,s
2
,…,s
m
} with m =  <dig> , and a set of relationships r = {r
1
,r
2
,…r
k
}, where r
i ∈ d × s and k =  <dig> . because r contains no  or  pairs, we construct a deg by defining a bipartite graph deg
sider = {u, v, e} where u = d and v = s, with the constraint: u ∩ v = ∅ and the edges in e capture the drug-side effect relationships and take the form  with d ∈ u and e ∈ v. figure  <dig> illustrates the construction of deg
sider.

topological features
our goal, is to build a model based on the topological properties of deg
sider that can differentiate between edges that represent adverse effects and those that do not.

the first and simplest feature that we consider in classifying an edge  is the number of edges incident to each node, or the edge degrees. next, we consider the number of common neighbors for each edge, as given by eq. ,  <dig> nde=Γd∩Γe. 


the common neighborhood of an edge  defines a connected sub-graph of deg
sider centered around , where the maximum distance between any two nodes from the same set  is two hops, and the maximum distance between nodes of a different set is three hops. the intuition behind this measure is that the size of this sub-graph indicates a level of relatedness. the larger the neighborhood is, the more drug and effect neighbors the two nodes have in common. for example, an edge that connects a drug that is known to have many gastrointestinal side effects with a gastrointestinal side effect will have a larger common neighborhood than if the drug were connected to a neurological side effect. figure  <dig> shows a portion of the common neighborhood sub network for the drug tamoxifen  and the side effect ovarian cyst.fig.  <dig> a subset of the common neighborhood sub network of the drug tamoxifen and effect ovarian cyst. this network defines a pharmacological neighborhood where every node can reach every other node within a maximum of three hops, tamoxifen and ovarian cyst serve as hub nodes that can connect any two other nodes. the size of a pharmacological neighborhood is used as a measure of relatedness between the two hub nodes




the common neighbor size feature is not normalized and may be highly influenced by the connectedness of the nodes in  and not adequately measure the neighborhood similarity. to account for this fact, we compute another measure that normalizes the common neighborhood size by the size of the combined neighborhoods. this measures the similarity of the two neighborhoods and is computed using eq. ,  <dig> sde=Γd∩ΓeΓd∪Γe 


eq. reflects the proportion of the total neighborhood  that is also in the common neighborhood which is equivalent to the jaccard coefficient. a value of  <dig> implies that Γ = Γ. continuing with this logic, it is apparent that the neighborhood of a node is also influenced by the individual connectedness of the neighborhood member nodes. for example, headache is a very common side effect, and its presence in the neighborhood may be less informative because it is present in many neighborhoods. to address this, we adopt the adamic-adar index  <cit>  defined in eq. :  <dig> ade=∑z∈Γd∩Γe1logΓz 


this equation discounts a common neighborhood node’s importance by the size of its individual neighborhood, this approach has a corollary in the inverse document frequency measure from text analysis. the adamic-adar index formulation implies that the connectedness of individual nodes and by extension edges, is informative in itself. to capture the ‘connectedness’ of an edge, we take the notion of ‘preferential attachment’ from  <cit> . preferential attachment is motived by the property of many biological  networks, that a node is more likely to be linked to a node that already has a large number of links than one with few links. this notion is captured using eq. .  <dig> pade=Γd*Γe 


in sum, the aforementioned topological features form a numerical representation of the graph neighborhood characteristics that surround a given edge in a deg.

constructing degtwitter

deg
twitter is a deg designed to model the drug and side effect relationships as they are expressed by twitter users. the deg
twitter construction is performed in four steps, similar to the method described in  <cit> . first, we identify users whose twitter status updates include drug references. second, we obtain the recent tweet history from these users. third, drug and effect references are extracted from the user histories. finally, edges are drawn between drugs and effects based on temporal proximity.

the user identification step is performed through the twitter streaming api which provides access to a sampling of the live tweets and the option to set filters for specified keywords. we recorded tweets over two weeks between january  <dig>   <dig> and february  <dig>   <dig> filtering for  <dig> of the most commonly prescribed drugs . our filtering led to shortlisting of  <dig>  tweets from  <dig> users. from this set, the most recent tweets from each user were queried, with a limit of  <dig> tweets per user. in the next step, tweet filtering was employed to limit our data set to only those tweets that relate a user’s personal experience, or experiential tweets. we formulate tweet filtering as the binary classification task of labeling a tweet experiential or non-experiential and use a supervised classifier  learned on a dataset of  <dig> tweets manually labeled for this purpose. the features extracted from these tweets are enumerated in table  <dig> and are similar to the features suggested in  <cit> . evaluation of the classification performance is provided in the results section.table  <dig> text features used for tweet classification

table  <dig> the textual features extracted from twitter text for classification. many spam and irrelevant tweets are designed to redirect a user to a desired website, thus the presence of url’s in the tweet text is a strong indicator of spam. spam tweets often contain many hashtags in an attempt to exploit trending topics, this makes the number of hashtags a very informative feature as well




extraction of drug and side effect entities from twitter text is performed by using the metamap biomedical annotator  <cit>  which provides mappings from plain text to terms in the unified medical language system . metamap was designed for use on biomedical research literature. however, language usage in the medical domain can be distinct from usage on twitter, which can result in incorrect mappings. we encountered significant problems with medical acronyms and abbreviations that commonly have different meanings on twitter. for example, the characters “pic” is a common abbreviation of the word “picture” on twitter, but “pic” is also a medical acronym for “punctate inner choroidopathy.” this is one of many such examples that required us to manually curate a stop list of acronyms, abbreviations and terms that otherwise cause frequent erroneous mappings . entities appearing in this stop list were disregarded. an additional difficulty in entity identification is the proliferation of synonyms and trade names that refer to the same chemical compound. for example, there are well over  <dig> trade names for ibuprofen, including advil, motrin, and nurofen, many of these synonyms have unique entries in the umls. to overcome this, we use the drug synonym resources available through the pubchem  <cit>  api which aggregates synonym lists from several sources, including the medical subject heading  vocabulary, depositor supplied terms, and other chemical databases. we use this list to resolve synonymous references to a canonical term.

after the tweet dataset has been filtered for experiential tweets and the medical entities identified, the deg
twitter is constructed in two steps. first individual user histories are used to construct a set of user degs or deg
user graphs. next, this set of deg
user graphs is merged to form the deg
twitter. to begin, individual users’ tweet histories are examined and edges are drawn between citations of drugs and side effects occurring within a fixed time window. this window length is an experimentally-set parameter and we examine its effect in the results section. the edges are weighted by the average time between the drug and effect mentions. this produces a set of deg
user, graphs, users = {deg
user,1
, deg
user,2
,…, deg
user,n} where, in our case, n =  <dig> , deg
user,i = {v
i
,e
i}, and v
i and e
i are the nodes and edges found in the history of user i per the description above. the global deg
twitter is constructed by aggregating the user graphs, deg
twitter 
= {v
twitter
,e
twitter
} where v
twitter = u
v ∈ users
v, e
twitter = u
e ∈ users
e and the temporal edge weights are averaged for common edges. a second edge weight is added to the model for the frequency of the edge in users, or equivalently, t he number of users whose histories contain the same  pair.

case study: constructing degtwitter
to illustrate the above process, we present an example that demonstrates the construction of deg
twitter using  <dig> tweets from our dataset, shown in fig.  <dig>  these tweets were posted by a total of  <dig> unique users. user <dig> posted  <dig> tweets, user <dig> posted one tweet and the rest posted  <dig> tweets each. each of these tweets successfully passed the experiential tweet filter and thus each related a user’s individual experience. references to drug and effect entities were identified with metamap. three unique drugs were found: clonazepam, prednisone, and xanax. furthermore, the following nine effects were identified: depression, pain, confusional state, anxiety, exhaustion, malnutrition, nighmares, hunger, and, tremors. these drug and effect mentions have been used to build the individual deg
user graphs shown at label  <dig> in the fig.  <dig>  user <dig> mentioned clonazepam on feb.  <dig>   <dig> and then mentioned depression, pain, and confusion on february  <dig>   <dig>  each effect was mentioned two days after clonazepam. accordingly, a four node graph is constructed with edges connecting each effect to clonazepam with a weight of two. a similar operation is performed for every user, resulting in  <dig> individual deg
user graphs.fig.  <dig> illustration of degtwitter construction. degtwitter is constructed from the drugs and side effects mentions in user tweet histories.  <dig>   <dig> example tweets from  <dig> individual users from our dataset . the table includes anonymized usernames, tweet text , date the tweet was posted, and the computed sentiment. drug entities extracted from the text are highlighted in blue and effects in red.  <dig>  individual user histories are used to construct a set of deguser graphs. user graphs contain all entities identified in a user history that were posted within a specified distance of an entity of the opposite class . a drug and a side effect have a connecting edge if they were mentioned within the window. edges are weighted by temporal distance .  <dig>  edges are labeled according to the sider database as either adverse  or pseudo-non-adverse .  <dig>  edges are aggregated across all graphs forming the degtwitter which contains all nodes and edges found in deguser graphs, temporal distance edge weights are averaged if two deguser graphs contained the same edge. an additional edge weight reflects the number of deguser graphs that contain the edge




next, the edges in the deguser graphs are labeled per their presence in sider. for example, sider lists depression as a known side effect of clonazepam, so the edge is labeled adverse . edges that do not appear in sider are labeled pseudo-non-adverse . label  <dig> in fig.  <dig> shows both the edge labeling and the beginning of the merging step where drug nodes are merged between deguser instances. the merging step is completed by merging all effect nodes . two edge weights are assigned to each edge to reflect average temporal distance and frequency. in this case, all frequency values are equal to  <dig>  we now have an instance of deg
twitter that represents all of the drug-effect relationships mined from the set of tweets.

extracting semantic context
drugs and effects mentioned in a tweet are embedded within a semantic context consisting of the words contained in the text of the tweet. we look to capture two elements of this context through sentiment analysis and topic modeling. the sentiment analysis of a text attempts to assign it a ‘sentiment polarity,’ that is, whether a tweet expresses positive, negative, or neutral sentiment. such sentiment can help distinguish the role an entity is playing in a sentence. for example, the entity headache may be the symptom being treated when it is mentioned in a positive tweet, for example “i love advil! i no longer have a headache!” however, the sentence “i hate how caffeine always gives me a headache” shows a negative sentiment and indicates that headache is a side effect.

to compute the sentiment context of a given edge, we apply sentiment analysis to all individual tweets contributing to the edge. the sentiment analysis function is provided by the stanford sentiment analysis package  <cit>  which performs a deep syntactic parse of the input text resulting in a grammatical parse tree. a neural network is then applied to recursively predict the sentiment of each node in the tree and node sentiments are aggregated to arrive at the final sentiment assignment of the text. although this package was not designed specifically for use on twitter text, which contains notoriously distinct language usage patterns, it was evaluated on twitter text in  <cit>  and it showed strong performance. this sentiment analysis package identifies a string of text as very positive, positive, neutral, negative, or very negative which we assign the nominal values of  <dig>   <dig>   <dig>  - <dig>  and - <dig> respectively. the analysis thus takes the form f
sentiment : tweet → { <dig>   <dig>   <dig>  −  <dig>  − 2} and the sentiment context of an edge is a tuple . where sd is the average sentiment of the tweets that contribute to the edge and mention drug d, shown in eq. , where tweetse is the set of tweets contributing to the edge and containing the entity e.  <dig> se=∑tweet∈tweetsefsentimenttweettweetse. 


the second element of the semantic context that we consider is the topic context. we do this through latent dirichlet allocation  topic modelling which models a document as a distribution over a set of topics, p, and a topic as a distribution of words, p. lda describes a generative process of document formation, where the words in a document are generated in two steps: first, a topic is chosen from the topic distribution p, where z is the topic. next, a word w is chosen from the word distributions of topic z, p. accordingly, the word distributions in a document are prescribed in eq. ,  <dig> pw|θ=∑zpw|zpz|θ. 


this formalism lets us place entities within the context of topics being discussed on twitter. we use the lda optimization method described in  <cit>  which is based on an online variational bayes algorithm with p and p computed over all tweets containing drug or effect references. we define the topic vector of a tweet θ
tweet to be a k-vector whose indices sum to  <dig>  where k is the number of topics. k is an experimental parameter we have set to  <dig> for our experiments. the entity topic context is the average vector of all tweets containing the entity, eq. ,  <dig> ce=∑tweet∈tweetseθtweettweetse. 


enriching degtwitter with degsider
both deg
twitter and deg
sider capture important, yet potentially distinct aspects of drug effect relationships. to incorporate this information in a single representation, we combine the features as follows. let features denote the function which given an edge generates the aforementioned topological features from deg
sider. similarly, let features generate the features from the deg
twitter including both topological and semantic context features. we define the enriched feature set as the union of deg
sider and deg
twitter features, as described in eq.   <dig> enriched_featuresedge=. as such, we use the deg
sider to hypothesize the existence of unrepresented ades by enumerating all possible edges e
a = d × s where d and s is the sets of drugs and effects in deg
sider respectively. the edges already present in deg
sider are removed from e
a creating the set of all possible hypothetical edges e
h = e
a \ e
s where e
s is the set of edges in deg
sider. each edge in e
h is individually inserted in to deg
sider and then classified.

after classifying the hypothetical edges, we look for evidence in the twitter-stream of the edges that were classified as adverse. we used the twitter query api to perform a search of the twitter-streams for users who mention both the drug and the side effect within a 20-day window. we query the api for  <dig> tweets that mention the drug and then request the  <dig> most recent tweets from each user. the medical entities are extracted from the tweet text to identify the hypothesized ade in question.

RESULTS
in this section, we assess the role of the individual design steps in the construction of the deg
sider
, the deg
twitter and the enriched deg
twitter. we also examine the results of our ade hypothesis generation method. we begin by observing the network characteristics of deg
sider and investigating the ability of our topological features to capture the difference between adverse and pseudo-non-adverse edges. next we look at the construction of deg
twitter and account for the effects of the experimental parameters on its network properties. we then evaluate the overall efficacy of our method’s ability to identify ades in the two degs and we measure the performance gains of our approach over previously published methods. additionally, we identify several ades through our hypothesis generation method that are not present in the sider database, yet of which evidence is found both on twitter and in the medical literature.

degsider characteristics
the topological features described above were chosen for their ability to describe the relationship between a drug and a side effect based on measurements of their pharmacological neighborhood. inherent in this formulation is the hypothesis that the distributions of these features vary between the sets of adverse and non-adverse edges. because sider only provides examples of adverse edges, we generate a set of pseudo-non-adverse examples by randomly drawing edges in deg
sider that are not listed as adverse in sider. we generate a set of pseudo-non-adverse edges equal in size to the number of adverse edges in sider, yielding  <dig>  pseudo-negative adverse edges for a total of  <dig>  edges.

to examine the edge properties of each class of edges, histograms of the three most distinguishing features are plotted in fig.  <dig> , revealing distinct distributions between classes. while there is some overlap between the two classes for each feature, this observation builds confidence in both the existence of topological differences between edge classes and our model’s ability to numerically represent it. we further obtain an aggregate view of the entire feature space through a lower dimensional projection using principal component analysis which is presented in fig.  <dig> . here we have a three dimensional rendering based on the first three components. the trend from the histograms continues and we see distinct distributions, albeit with some overlap, between classes of edges.fig.  <dig> degsider feature distributions. the degsider topological feature distributions for common neighbor size, jaccard coefficient, and preferential attachment . in each case, the shape is distinct between the adverse and pseudo-non-adverse edges. part  <dig> shows all features projected to the three most explanatory pca components. as with individual features, each class takes a distinct shape




adverse drug effect classification in degsider
we cast the ade identification problem as a supervised learning task that requires a binary classification model to identify edges as either adverse or non-adverse based on the topological features derived from deg
sider. the set of adverse and pseudo-non-adverse edges that compose deg
sider create a set of  <dig>  edges evenly balanced between the two types. this set is randomly split into two sets of equal size, which composes our training and test sets. 10-fold cross validation is performed on the training set for parameter tuning. a classifier is then trained on the training set and its performance is measured on the test set. results from these evaluations are provided in the results section.

degtwitter construction
two important steps are involved in the construction of the deg
twitter, pre-processing/tweet-filtering, and estimation of an appropriate time window parameter value. to evaluate our method’s ability to filter out non-experiential tweets, we sample  <dig> tweets from the twitter streaming api that contain drug or effect mentions. these tweets are manually annotated as experiential or non-experiential and the textual features are extracted as described in table  <dig> above. this data set is split into a training and a test set, containing 60 % and 40 % of the tweets respectively. classification is performed with a random forests classifier  and performance is evaluated with 10-fold cross validation on the training set. a classifier is then trained on the entire training set and its performance is evaluated on the test set. three standard measures of performance are calculated, precision, recall and f <dig>  our method shows strong performance of > . <dig> on all measures in the test set. see fig.  <dig>  left. encouraged by these results, we apply this classifier to remove irrelevant, non-experiential tweets from our dataset.fig.  <dig> tweet filtering and degtwitter construction characteristics. left, performance evaluation results for experiential tweet filtering. blue shows average 10-fold cross-validated results on the training set with error bars indicating one standard deviation above and below the mean. orange is the result on the test set. right, top shows growth rate of degtwitter as the window size, t, increases . y axis is number of edges. the number of adverse edges is shown in orange. right, bottom shows the percentage of total edges that are adverse. the arrow indicates t =  <dig> where this value stabilizes and begins to slowly decline




the construction of deg
twitter out of the cleaned dataset is governed by one experimental parameter t, which is the size of the time window used to filter out drug-effect mentions that exceed a temporal distance, measured in days. to determine the proper value, we look at its effect on the percentage of adverse edges in the deg. we expect that as t grows too large, the percentage of adverse edges will at some point begin to drop because the loosening inclusion parameter will allow more spurious edges. in the limit, the ratio would settle to a value specific to the dataset being sampled. figure  <dig>  right, shows plots of the total edges and adverse edges , and of the percentage of total edges that are adverse  as t increases. the percentage adverse edges is relatively stable between t =  <dig> and t =  <dig>  hovering around 34 % with a maximum at t =  <dig>  however, at t =  <dig>  the percentage stabilizes and steadily drops as t increases. accordingly, we set the value to t = 20 days. the set of nodes in deg
twitter is unsurprisingly a subset of those in deg
sider because of the generally non-technical scope of the language and less precise usage found in twitter posts. accordingly, the deg
twitter contains  <dig> unique effects,  <dig> unique drugs and a total of  <dig> edges.

it is worth noting at this point that if the ade identification methods , requiring the drug and effect to occur in the same tweet are employed instead, then the size of the dataset is severely diminished; only  <dig> edges are retained in deg
twitter – a number far too small to conduct analysis with. the proposed method, by contrast, allows accounting for significantly more data.

degsider edge classification performance
classification of the adverse, pseudo-non-adverse edges in the deg
sider was performed with the random forests ensemble classifier . the  <dig>  deg
sider edges set was randomly partitioned into a training and test set of  <dig>  edges each. the standard performance measurements of precision, recall and f <dig> are recorded with results shown in fig.  <dig>  evaluation on the training and test sets both showed very strong performance, indicating that our deg model for ade representation captures significant properties of drug and side effect relationships and that the distinctions between adverse and pseudo-non-adverse relationships are captured in these properties.fig.  <dig> performance evaluation of degsider edge classification. mean  <dig> fold cross validation results shown in blue with error bars indicating one standard deviation above and below the mean. performance on the test set are shown in orange




degtwitter and enriched degtwitter edge classification performance
previous research had considered only the topological features of the deg
twitter. to measure the performance gains of our method over previous research, we evaluate classification performance on topological features alone and then incrementally add our novel features to the model and measure performance gains at each step. in total, four feature sets are evaluated: 1) topological , 2) topological and sentiment features, 3) topological, sentiment, and topic features, and 4) topological, sentiment, topic, and deg
sider enriched features.

a training set of  <dig>  randomly chosen edges in deg
twitter  was used for cross validation and parameter tuning. the remaining edges composed the test set. figure  <dig> summarizes the results. the baseline model demonstrated good performance on our dataset with an f <dig> value of . <dig> in the test set. including the sentiment context in the model provided minor improvement in both precision and recall values in both the training and test sets. this led to an increased f <dig> score in both sets. the inclusion of the topic model features provides a significant gain in precision, with an improvement  over the baseline in both the training and test sets. however, it provides negligible effects on the recall values. enriching the features set further with the topological features from deg
sider shows gains in recall with an increase  over the sentiment and topic feature sets. these evaluations show that the best performing model is the deg
sider enriched model with sentiment and topic context features with an f <dig> score of . <dig> in the test set with a gain  over the baseline model. this result illustrates several points. not only does the content of the discussions around medical entities on twitter help differentiate the relationship, this content can be approximated through sentiment analysis and topic modelling. additionally, these results point to the value of the deg model’s ability to transfer information between degs through edge matching.fig.  <dig> performance evaluation results for degtwitter as new features are added to the model. left: mean 10-fold cross validation results with errors bars indicating +/-  <dig> standard deviation. actual values in table below right: performance results on the test set. performance on the test set steadily increases with the expanding feature set. biggest gains are achieved when adding topic context and enriching the degtwitter with features from degsider





discovering unrepresented ades

deg
sider was used to hypothesize ades that were not present in the sider database. here we investigate whether the inherent topology of the deg can imply the presence of unrepresented information. sider is mined from fda package inserts, however, for various reasons, the data in sider may not reflect the current state of ade knowledge. by enumerating and classifying edges in degsider then mining twitter feeds and medical literature for supporting evidence, we found several unrepresented ades. table  <dig> shows the ade’s that were hypothesized by deg
sider along with the text from twitter posts indicating both the drug and effect. both tweets were posted by the same user within the 20 day window. additionally, a reference from the medical literature is provided that confirms awareness of the ade in the medical community.table  <dig> ades discovered through deg analysis

table  <dig> this table contains ades that were implied by the topology of degsider. evidence for each of these ades was found both in the twitter-stream as well as in medical literature. twitter text is provided with the medical entities in bold . this process of ade hypothesis has potential use in helping fill gaps in the databases like sider, when evidence from the literature is present. it may also be used to hypothesize new and unreported ades for further investigation




this process of hypothesis and evidence gathering has two potential uses. first, it can be used to help identify gaps in sider as well as other side effect databases and assist in filling them in with reports from the medical literature. second, it can be used to hypothesize unknown ades for further investigation.

synopsis and findings
the experiments in this section support the effectiveness of representing drug and drug-induced effects using the proposed network-based deg representation. this conclusion follows from the success in differentiating the adverse and pseudo-non-adverse edges found in the two datasets under investigation. the classification performance was better on the deg
sider, likely because it is built from a relatively clean and curated data source. the noisy environment of twitter that was used to build deg
twitter did indeed impact performance adversely. however, we found that by enhancing the model with features native to twitter and unavailable to sider, namely the semantic context, we were able to improve the model’s performance. additionally, the consistent deg structure employed by both deg
sider and deg
twitter allowed for an information enrichment of deg
twitter through edge matching. thus, we observed the best performance of the deg
twitter model when it included the semantic context features as well as information enrichment.

we also found that through our deg approach, it is possible to hypothesize ades that are implied by the deg structure by enumerating the possible edges and classifying them individually. that we were able to find instances of several of these hypothesized ades in the twitter-stream and medical literature underscores both the efficacy of our deg model and the value of twitter as a resource for ade identification.

discussion
the results from our experiments show that by observing temporally related drug and effect terms we are able to extract signal from the twitter stream. this signal, by its nature, represents effects that are correlative, rather than positing causal relationship. it is true that twitter users makes explicit statements such as “advil gave me a horrible rash” where they ascribe a putative causal relationship between the drug and effect. however, without rigorous biological investigations of the mechanisms of drug action, including clinical trials, an actual causal relationship cannot be established.

social media is also a notoriously noisy data source and the provenance of this noise should be recognized and carefully considered both in the design of methods and analysis of data. the most immediate source of noise in our work is the fact that not all drug and effect terms are expressed in the first person perspective, that is, as the personal experience of the user. for example, the text “my husband was prescribed lipitor” does describe an experience, but not the experience of the user. this only becomes a problem when there is a mismatch between the contexts of the drug and effect terms. it should be noted that even when a drug and an effect are mentioned in the same tweet, they may have different contexts. for example, the text “my husband is loud when he drinks alcohol and he is giving me a headache.” to estimate the significance of this effect, we sampled  <dig>  tweets from the  <dig>  tweets used to construct the deg
twitter. these tweets were manually labeled as either first person experiences or not first person experiences. we found that a strong majority of the tweets did express first person experiences at 77 %. note that this number constitutes a lower bound on the number of relevant tweets because a tweet involving a third-person reference such as “my husband took celexa and is now experiencing exhaustion” contains a valid drug – effect relationship yet it is not a first person experience. in future work, it will be beneficial to design an additional tweet filter that can deconvolute the two cases potentially focusing on proper noun and pronoun use.

an additional source of bias in using social media for ade analysis is that the set of drugs and side effects is limited to what users can articulate. user language is often less precise, less rigorous in usage, and less descriptive than language used in more formal settings resulting in a smaller overall set of drugs and side effects and an intrinsic bias. the limited coverage of drugs and effects found on twitter is precisely the reason that we sought to augment it with the more complete and refined data found in the sider database. even with the incorporation of sider data into the model, the fact remains that many ades may simply not be represented in twitter streams. figure  <dig> shows the relative size of deg
sider and deg
twitter indicating the lack of coverage of drug and effect data on twitter. it would certainly be a worthwhile endeavor in future work to perform a thorough evaluation of the drugs and effects found on twitter and other social media platforms.fig.  <dig> number of unique drugs and unique effects in degtwitter and degsider





CONCLUSIONS
in this paper, we have described a framework based on graph-theoretic modeling of drug-effect relationships drawn from various data sources. we applied this framework to two sources: sider, which is explicit in its purpose of containing these relationships, and twitter, whose wide range of content has been shown to contain these relationships. the deg model is general enough to accommodate these diverse data sources, yet rigorous enough to provide a strong mechanism for classification. we built classification models based on deg
sider and deg
twitter both showed strong performance. the deg model also allows for the incorporation of domain specific information into the model, such as the semantic context provided by twitter, which gave significant performance boosts when added to the model. moreover, the information enrichment ability inherent in the deg structure allowed deg
twiiter to benefit from the strengths of deg
sider.

our results further underscore the value real-time information exchange platforms like twitter’s bring to the field of pharmacovigilance. with a relatively straightforward preprocessing pipeline of tweet filtering and information extraction using freely available tools, a set of drugs and side effects can be extracted from the otherwise noisy stream of twitter posts. we used the proposed deg model to predict ades that were missing from the sider database, and in several cases, we were able to find evidence of these predicted ades in the twitter-stream with further corroboration in the medical literature. this result highlights the potential and value of our method as a tool in the hunt for unknown ades.

additional file

additional file 1: table s <dig>  the list of common drug names used as an initial filter for the twitter-stream. table s <dig>  terms that frequently caused erroneous mappings from the metamap entity extraction system. 




abbreviations
adeadverse drug event/effect

apiapplication program interface

degdrug effect graph

emrelectronic medical record

srsspontaneous reporting system

we would like to thank deeptanshu jha for the annotated twitter datasets.

declarations
this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2016: proceedings of the 13th annual mcbios conference. the full contents of the supplement are available online at http://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-17-supplement- <dig> 

funding
this research and its publication was funded in part by the national science foundation grant iis- <dig> .

availability of data and material
the data files to construct degsider are available through the sider website: http://sideeffects.embl.de/download/.

the data files used to construct degtwitter are available at the singh lab website at http://tintin.sfsu.edu/projects/pharmacovigilance/data.zip.

the list of common drug names used as an initial filter for the twitter-stream is provided in additional file  <dig> 

authors’ contributions
rs proposed the overall idea and refined it with re to arrive at the problem formulation addressed in the paper. the methods and algorithms were developed by re and rs. re implemented the algorithms and conducted the experiments. the experimental data was analyzed by re and rs. the manuscript was written by re and rs. both authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
