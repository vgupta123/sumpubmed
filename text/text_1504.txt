BACKGROUND
the knottin scaffold  <cit>  is spread over about  <dig> distinct disulfide-rich miniprotein families that all share the same special disulfide knot. this knot  is obtained when one disulfide bridge crosses the macrocycle formed by two other disulfides and the interconnecting backbone   <cit> . knottins display a broad spectrum of biological activities and natural members are on the pharmaceutical market or are currently undergoing clinical trials. but knottins also display amazing chemical and proteolytic stabilities, and, thanks to their small size, are amenable to chemical synthesis. knottins therefore also provide an interesting structural scaffold for engineering new therapeutics and somehow bridge the gap between biological macromolecules and small drug molecules  <cit> . any such developments, however, would ideally require proper understanding of knottin sequence-structure-function relationships, or at least availability of large sequence and structure data sets. to this goal, we envisaged to extend the knottin database  <cit>  with quality 3d models of all knottin sequences.

an enormous gap exists between the numbers of sequenced proteins and of solved protein structures  and the ratio between the elucidation rates of sequences versus structures tends to increase. to reduce this gap, systematic homology modeling of all proteins with close homologs of known structures has been performed  <cit> . however, the resulting model databases usually do not cover proteins with weakly related structural homologs and these genome wide approaches do not fully exploit all conserved features specific to each protein family as modeling restraints. and indeed, the well-conserved cystine knot which is the main component of all knottin cores should, in principle, facilitate knottin modeling even at very low sequence identity.

systematically building 3d models for all sequences within a protein family or superfamily could provide additional knowledge for structural or functional analysis and give access to many potential applications  <cit> , but such work has seldom been done  <cit> . structural models can suggest insight on important residues for protein stability, interaction or function. in particular, the comparison between related protein folds can help to better delineate the key physical and geometrical characteristics of a given interaction site. such information helps to better understand the mechanisms of molecular interaction and to design focused mutagenesis experiments  <cit> . another frequent problem concerns the design of chemical compounds that react selectively with only one type of proteins from the whole family  <cit> . to this end, if the structures of all homologs of a given protein target are available, the differential analysis of local environments in different model subgroups can help to design highly selective molecules interacting with one subfamily but not with the remaining proteins of the concerned super-family. homology models can also be useful for the prediction of ligand binding sites  <cit> , for functional annotations  <cit> , or as starting folds for experimental structure determinations  <cit> . of course, the best achievable structural model accuracy is critical to extract reliable information from predicted protein folds and give precise answers to the above issues. for this reason, we have optimized a homology modeling method able to systematically predict the fold of all known knottin sequences.

homology modeling consists in using x-ray or nmr protein structures as templates to predict the conformation of another protein that has a similar amino acid sequence  <cit> . this structural prediction method has always been the more efficient and rapid way of predicting the folding of a new protein sequence and it should be more and more applicable as fold recognition methods become mature and as the universe of protein folds gets fully covered by experimental structures  <cit> . ab initio prediction methods, although achieving spectacular progress in recent years, remain less reliable than homology modeling and are still reserved to proteins that cannot be related to any homologous structure  <cit> .

a typical homology modeling of a protein query involves the following processing steps:

 <dig>  identification of query homologs with known structures from the protein data bank  <cit> .

 <dig>  multiple sequence alignment of the query and templates.

 <dig>  construction of structural models satisfying most spatial restraints derived from the query - template alignment.

 <dig>  model refinement.

 <dig>  evaluation and selection of the best model as structural prediction.

the quality of the final 3d models depends on each modeling step and the observed accuracy decreases when the query - template similarity falls down. homology modeling is efficient because two proteins can have distant sequences but still share very similar folds. but this observation creates also many problems at each step of the modeling when the query and template sequences are weakly similar. a wrong structural template choice might then have a big impact on the query model accuracy. at low sequence identity, query - template alignment is also more ambiguous and any amino acid mismatch will induce important deformations on the resulting structural model. the selection of spatial restraints that should be projected from the templates to the query is another difficult issue when query and templates are only distantly related. in such cases, only a small subset of conserved geometrical features is shared between query and templates, and these can spread over several different structures. then, insufficient or incompatible spatial restraints extracted from the templates may yield important geometrical variations over the generated models and require further refinement steps such as minimization or loop modeling and accurate structure evaluations to select the best models.

analyses of known knottin sequences and structures indicate that roughly half of the knottin sequences have to be modeled relatively to weakly related templates. to address this challenge, we have designed a fully automated modeling procedure whose processing steps have been optimized relatively to a test set of  <dig> known knottin structures. we paid a great attention to the optimal use of the structural information that can be obtained from the available knottin structures. we tried to use the conserved geometrical features derived from the comparative analysis of knottin structures  as bias to select templates closer to query,  as anchors to improve sequence alignments, or  as constraints to guide the modeling and increase accuracy. we have tested different structural evaluation methods and designed a combined scoring function for a better assessment of the accuracy of the 3d models. finally, the models were refined by individual loop modeling and the minimization of the model energy.

methods
algorithm outline
the structural modeling of a knottin query sequence involves four processing steps:

 <dig>  known knottin structures are sorted according to the similarity of their sequences with the query sequence.

 <dig>  the protein query sequence is aligned onto different subsets from the selected knottin templates and is modeled using modeller  <cit>  according to various sequence alignments with the selected knottin templates.

 <dig>  the resulting query 3d models are evaluated using various statistical potentials.

 <dig>  the best model structure is refined by global minimization of the model energy and individual modeling of each of its loops.

test data set
 <dig> knottins with known structures in the protein data bank were extracted from the knottin database  <cit> . the quality of these structures was assessed using the program errat  <cit>  which measures the packing quality of protein structures using atomic-dependent distance statistics derived from the protein data bank  <cit> . knottin structures whose errat scores were below  <dig>  were removed from the initial set. then, to remove data redundancy, the remaining knottin structures were clustered at 40% sequence identity level using the cd-hit software  <cit> . within each resulting cluster, the structure with the best errat score was selected yielding a test set of  <dig> representative knottin structures.

each of the  <dig> selected knottin structures was then modeled from its sequence only at different level of homology using those of the  <dig> knottin templates which shared respectively less than 10%, 20%, 30%, 40% and 50% sequence identity with the protein query. for example, when the chosen threshold of sequence identity was 30%, no template could share more than 30% sequence identity with the query knottin that should be modelled. in this way, we could evaluate the method performance even at different homology levels, independently of the distribution of the template set.

template selection
three different criteria were tested to select the 3d structures used as templates among the  <dig> experimental knottin structures for modeling a given knottin query sequence:

 <dig>  pid criterion:

the templates were sorted according to their sequence identity percentage relatively to the knottin query sequence.

 <dig>  rms criterion:

this criterion is based on the selection of a reference knottin structure either 1) having the same loop lengths as the protein query, or 2) by default with the highest pid relative to the query.

in the condition 1), the loop lengths are defined as the number of residues of each protein segment between two consecutive knotted cysteines i, ii, iii, v and vi. the positions of the knotted cysteines and their connecting loops are derived from the purely sequence-based tool knoter1d  <cit> . knoter1d first checks whether the three knotted disulfide bridges are present using an alignment with homologous knottin sequences detected in the annotated knottin database . then knoter1d provides a standard renumbering of each amino acid of the knottin sequence.

in the condition 2), pid is the sequence identity percentage calculated from the comparison of the query and template sequences aligned using clustalw.

supplementary templates are then selected according to the root mean square deviation of their main chain atoms relatively to this reference knottin structure.

 <dig>  dc <dig> criterion:

templates were sorted according to the pid criterion less a penalty  if cysteines iv in the template and in the query were not aligned.

query - templates alignment
the knottin query sequence was multiply aligned against one or more template structures using two different methods.

 <dig>  alignment method k1d:

the knottin query sequence was aligned using knoter1d  <cit> .

the knottin template structures were aligned using knoter3d  <cit> . knoter3d first searches for the presence of three knotted disulfide bridges from a geometrical analysis of the 3d structure. if this knot is found, the corresponding protein sequence in renumbered such that knotted cysteines i, ii, iii, v and vi have numbers  <dig>   <dig>   <dig>  <dig> and  <dig>  respectively. it is worth noting that cysteine iv does not get a fixed number as its location changes with families  <cit> . then the knottin structural core, i.e. the cystine-stabilized beta-sheet  motif   <cit> , is superimposed onto the corresponding motif of a reference knottin structure, from which the optimal structural alignment and its corresponding amino acid numbering is inferred.

finally, the standard alignment of the knottin query sequence  and of the homologous template sequences  is used for further homologous structural modeling. detailed descriptions of the knoter1d and knoter3d methods can be found in previous publications  <cit> .

 <dig>  alignment method tma:

the  <dig> knottin templates were globally aligned only once using a hierarchical version of tm-align  <cit> . all template structure pairs are first aligned using tm-align. following a decreasing tm-align score order, these template pair alignments were then hierarchically aggregated until all templates were merged into a single multiple sequence alignment. the knotted cysteines that should be aligned are determined by knoter1d for the query sequence and by knoter3d for the templates.

then the query sequence fragment and template profile alignment section located between the n terminus and the first cysteine were multiply aligned using clustalw  <cit>  while keeping the existing indels between templates frozen. this local sequence-profile alignment method was repeated to align the fragments located between the first and second knotted cysteines. this operation was repeated again for all segments connecting the successive knotted cysteines ii, iii, v and vi. the obtained local alignments were then successively concatenated with the knotted cysteines i, ii, iii, v then vi in order to obtain a multiple alignment of the query with the templates.

model construction
the protein query was modeled multiple times by homology using modeller  <cit>  through a global alignment of the query with the best template, then with the two best templates, then up to the  <dig> best templates. the templates were selected using either the pid, rms or dc <dig> criterion and aligned with the knottin query using either k1d or tma method. all known knottin structures were superimposed and hierarchically classified according to their pairwise main chain deviation revealing conserved main chain hydrogen bonds shared by knottins. if more than 80% of the structures of a knottin cluster from the hierarchical tree shared the same hydrogen bond, this bond was said to be "80% conserved". this 80% cut-off was chosen instead of 100% to cope with possible errors or uncertainties in available nmr structures. five 80% conserved hydrogen bonds were evidenced at standard positions n100-o <dig>  n40-o <dig>  n81-o <dig>  n101-o <dig> and n79-o <dig>  four other hydrogen bonds at standard positions n21-o <dig>  n61-o <dig>  n38-o <dig> and n37-o <dig> were 80% conserved over the  <dig> knottin structures with cysteine iv at standard position  <dig>  standard positions were calculated by the global knottin alignment program knoter3d  <cit> . the  <dig> knotted disulfide bridges and these 80% conserved main chain hydrogen bonds were kept semi rigid by adding geometrical restraints in the modeller script. at each modeller run,  <dig> to  <dig> different structural models of the protein query were generated. for example, if the maximum allowed number of templates was  <dig> and if  <dig> models were generated at each modeller run, then  <dig> models were constructed from an alignment with the best template alone,  <dig> models from the two best templates and so on up to the  <dig> best templates, resulting in  <dig> generated models from varying numbers of templates. to remove all minor conformational inconsistencies resulting from the modeller construction, all models were energy minimized with restraints on the backbone atoms using the amber package  <cit> .

model evaluation
the accuracy of the best selected model was measured by the root mean square deviation  between the native and model backbones of the structural segments located between the first and the last knotted cysteines after optimal 3d superposition. when the knottin query corresponded to a pdb entry containing multiple nmr conformers, the first nmr conformation was systematically selected as reference for measuring the model to native structure rmsd.

the similarity between the model and native structure was also assessed using the tm-align score  <cit>  where core conservation is emphasized and long loop moves are scaled down according to the formula:

  tms=1/l.∑i1/)2) 

where

l is the length of the shortest protein sequence,

di is the euclidian distance between the i-th pair of aligned residues,

d <dig> =  <dig> .  <dig>  -  <dig>  is an l-dependant normalization factor.

the quality of each model generated by modeller was predicted using the atomic distance dependant potentials dfire  <cit>  and dope  <cit> , and the knowledge-based potential proqres which is derived from statistical distributions of atomic contacts, residue contacts, surface accessibility and secondary structure classes  <cit> . the individual evaluations obtained from dope, dfire and proqres were then linearly combined yielding a composite score called sc <dig>  the predictive accuracy of this score sc <dig> was optimized by maximizing the correlation between sc <dig> and the native versus model rmsd over a set of known knottin structures using a systematic grid search over the  <dig> dope, dfire and proqres weighting factors. the model with the best sc <dig> score was selected and assessed by calculating its rmsd and tms scores relatively to the actual native structure of the knottin query.

the models were also evaluated using free energy calculations based on molecular mechanics and empirical solvation energies using the mm_gbsa script from the amber suite  <cit> .

model refinement
 <dig>  loopm: after the homology modeling procedure, the best model was selected according to the evaluation score sc <dig> and all atoms but its first loop were frozen.  <dig> new query models are then obtained by ab initio modeling of the free loop using modeller. all loops of the best model constructed so far according to sc <dig> were refined in turn following the same procedure.

 <dig>  loopy: the same refinement procedure as loopm was followed except that all loops were modeled using the loopy prediction program  <cit> .

 <dig>  looph: the last refinement procedure consisted in successive local homology modeling restricted to each individual loop of the obtained knottin model. for each knottin loop of the best model produced so far according to sc <dig>  the best template was selected according to the rms criterion calculated over the given knottin loop only. the selected knottin loop template was then used to locally remodel the given query loop using modeller.

RESULTS
knottin homology distribution
figures  <dig> and  <dig> display sequence identity distributions over the whole knottin data set. figure  <dig> indicates that the vast majority of known structure pairs share between 15% and 40% sequence identity  and  <dig>  to  <dig>  Å backbone deviation after geometrical superposition . this low level of average similarity clearly demonstrates the sequential and structural variability of the knottin superfamily. knottins are indeed very diverse small proteins and the structural core of the whole family is actually limited to a few residues around the three knotted disulfide bridges.

we think that the tiny size of the conserved knottin core associated with the high degree of loop variability could explain the poor correlation between the sequence identity and the structural deviation. one should however note that the degradation of this correlation arises mainly below 40% sequence identity which corresponds anyway to low sequence conservation levels and then to significant structural variations in any protein family. this tendency is probably just amplified in knottins because of a smaller ratio between the size of the conserved structural core and the size of the exposed variable loops.

the comparison of both distributions on figure  <dig> also shows that the templates are, on average, more homologous to each other than the sequences are close to the templates. we expect this tendency to occur for many protein families since, unfortunately, not all homologous sequence clusters have one experimental structure known yet, and also because the pdb entries often correspond to different experimental structures of the same protein. for this reason, our modeling tests were made at various levels of allowed homology between query and templates .

template selection and alignment
analysis of figure  <dig> shows that:

 <dig>  a careful selection of adequate template structures is important for high quality modeling as indicated by the significant rmsd reduction obtained by refining the selection criterion.

 <dig>  the pid criterion is not the optimal template selection method. the sequence identity percentage is a poor indicator of the actual structural similarity between two proteins. the weakness of pid is particularly clear in the context of knottins which form a widespread family and often require modeling at a low sequence identity.

 <dig>  using sequence constraints derived from the analysis of all knottin folds can significantly reduce the average rmsd between the query structure and the selected templates. in the case of knottins, a hierarchical classification tree of all knottins guided by rmsd after pairwise structure superimposition has exhibited two sequential features, not included in the classical pid criterion, but that are directly correlated with the rmsd between knottin structures:  the length of each loop between knotted cysteines , and  the position of cysteine iv .

 <dig>  furthermore, the average rmsd between query knottins and their corresponding template structures can be significantly reduced when the query-templates sequence alignment is improved by using an appropriate alignment method. in the case of knottins, the knoter1d and knoter3d methods initially developed to align the knotted cysteines of knottins resulted in loop alignments that could be improved by the tm-align program which covers all core and loop residues for structural superposition.

model accuracy
the best median query/model rmsds are obtained by selecting  <dig> templates according to the rms criterion, aligning them with the query sequence using the tma algorithm, and producing  <dig> models at each modeller run . with this modeling procedure, the median query/model rmsds are  <dig>  Å and  <dig>  Å when the selected templates share less than 10% and 50% sequence identity with query knottin, respectively. the accuracy of the resulting models must be compared with the rmsds observed between conformers within single nmr knottin structures in the pdb. the calculated average mean and maximum rmsds between such conformers are  <dig>  and  <dig>  Å, respectively. at a 50% level of sequence identity, the accuracy of the models  is therefore very close to the average maximum variation between nmr conformers . it should be also noted that, on figure  <dig>  even at 100% sequence identity experimental knottin structures can diverge by more than  <dig>  Å. native protein flexibility, domain or external interactions, and experimental errors may explain these variations. these comparisons strongly suggest that our procedure is close to the optimum of what can be achieved computationally in knottin modeling.

another interesting observation is that the model versus native main chain rmsd decreases as the number of selected templates per knottin query increases. that multiple templates complement each other could be explained by the observation that the conserved core across all knottins is mainly limited to few residues nearby the three knotted disulfide bridges while the inter-cysteine knottin loops have very diverse conformations. it is therefore often impossible to find one single template carrying inter-cysteine loops compatible with all query loops. as a result, selecting several structural templates, which individually cover the conformations of each query loop, may be required. actually, the exact number of templates selected to build the model with lowest rmsd relatively to the native query structure is randomly varying from one to the maximum number of allowed templates. this variation of the optimal number of templates confirms that the geometrical constraints inferred from the different structures are frequently complementary.

the same statistical analysis was done using tms instead of rmsd as structural similarity criterion. the different modeling procedures were ranked using tms in the same order as rmsd. considering knottins as a small conserved core of knotted cysteines connected by flexible loops of varying sizes, we anticipated tms to be a more accurate measure of the knottin core conservation since tms reduces the weight of loop displacements. apparently, this is not case and the rmsd produces measures comparable to tms, indicating that core and loop variations in knottins are more connected than what we predicted.

the  <dig> knotted disulfide bridges and the  <dig> or  <dig> 80% conserved h-bonds depending on the position of cysteine iv can be observed in all generated models. when the restraints on the 80% conserved hydrogen bonds are removed from the modeller script, only insignificant variation in median query-model main chain rmsd  is observed, but the network of conserved hydrogen bonds is then usually degraded and the computed models frequently miss the main chain bonds present in most experimental knottin structures. furthermore, the packing quality of the models is clearly improved at any homology level by restraining the conserved hydrogen bonds, yielding an average  <dig> % increase of the errat scores of the hydrogen bond constrained knottin models over the non constrained ones. although the improvement is not measurable by a gain in query - model rmsd accuracy, it is important to note that these additional restraints guide the generated models towards better structural packing and conformations more consistent with the knottin consensus fold. this result indicates that useful geometrical restraints can be inferred from the comparative analysis of all experimental structures related the query protein.

the experimental knottin structures from the test set were also evaluated using sc <dig> and the rmsd of each nmr conformer from the pdb file relatively to the first one were calculated. these evaluations, displayed as crosses in figure  <dig>  show that:

 <dig>  although the structures from the pdb files have on average better sc <dig> scores than the corresponding models constructed by our procedure, the best models usually display sc <dig> scores close to or even better than the best experimental structures. this scoring similarity suggests that our procedure achieves a sufficient conformational sampling to build knottin models that are energetically close to the optimum measured on the native structures. as an example, the hydrogen bond network in the gsmtx- <dig> model shown in figure  <dig> is likely responsible, at least in part, for the better scores displayed by many models when compared to the nmr structure . in contrast, the experimental structure of hainantoxin- <dig>  displays all knottin consensus hydrogen bonds and gives good sc <dig> scores. figure  <dig> shows a superimposition of the experimental structure and of structures modelled from templates at different sequence identities. the best scoring model built from templates with sequence identities below 10%  is still reasonably accurate with an rmsd to native of  <dig>  Å).

 <dig>  the rmsd between experimental conformers for the same pdb entry are often comparable to rmsds between the best predicted models and the native structures, indicating that the best models are consistent with the flexibility observed in experimental structures. in other cases, when the inter nmr rmsd is smaller than the model to native rmsd, one can wonder which of the model or of the nmr conformations were flawed. when the inter nmr rmsd is always below  <dig>  Å, one can suspect that, except for the shortest knottins, the loop conformations of the corresponding nmr structures were too constrained or not sufficiently sampled to correctly represent the natural flexibility of the longest and exposed amino acid segments. this may arise from standard nmr refinements that simultaneously apply all nmr constraints and do not take into account the nmr time scale averaging, thus resulting in all conformers lying near an average conformation rather than really sampling the available conformational space.

optimization of the evaluation score sc3
the scores dope, dfire and proqres were linearly combined yielding a composite evaluation score whose weights were optimized by grid search. figure  <dig> displays the variation of the average rmsd between the native structure and the best evaluated model depending on dfire and proqres weight logarithms . models were obtained from the best modelling procedure rms.tma.t <dig> m <dig>  from figure  <dig>  dope =  <dig>  dfire =  <dig> and proqres =  <dig> are the optimal weights for linear combination yielding an average native - model rmsd of  <dig>  Å. this optimal linear weight combination was used for all the evaluations displayed in figures  <dig> and  <dig>  the performances of each score dope, dfire and proqres used individually were respectively  <dig> ,  <dig>  and  <dig>  Å. the improvement due to their linear combination is therefore  <dig>  Å only, indicating a small complementarity of the different evaluation scores.

loop refinement
as indicated in figure  <dig>  the  <dig> loop refinement procedures we have tested failed to improve the accuracy of the best homology models. the median query/model rmsd increases are around  <dig>  and  <dig>  -  <dig>  Å at 10% and 50% sequence identity levels, respectively . it is difficult to interpret the reason of this model degradation. one possible explanation could be that the loops are refined individually while freezing the rest of the protein structure. incorrect loop anchor orientations or wrongly placed interacting loops could then force the refined loop to explore a wrong conformational space yielding a degradation of the query/model rmsd. to solve this problem, we tried to extend the loop boundaries at varying sequential distances of the knotted cysteines but this did not improve the model accuracies significantly . rmsd increase could also be related to the incremental nature of the refinement procedure: if one loop is wrongly refined and accepted by sc <dig> as an improved model then all subsequent loop refinements will be done in a wrong structural context and then biased toward incorrect orientations. we designed the looph procedure to address this latter issue: the best local templates were selected for each loop and an aggregation of these local templates/loop alignments was built to let modeller make a global refinement of the best model obtained so far by freezing the knotted core and using the best local templates to refine all loops at the same time. the accuracy of the models were still degraded using the looph refinement procedure indicating that freezing the loop anchors induces too strong constraints on the conformational space that can be explored by modeller.

minimization of the model energy
model database and server
the  <dig> known knottin sequences were extracted from the latest release of the knottin database  <cit> . a structural model of each knottin sequence was built using the optimized procedure detailed above:  <dig> templates were selected according the tms criterion and without restriction on the query versus template sequence identity. these templates were multiply aligned with the query sequence using the tma procedure. then, using from  <dig> to  <dig> aligned templates,  <dig> structural models of the query were generated at each modeller run after imposing appropriate constraints on the knotted disulfide bridges and the 80% conserved hydrogen bonds. the  <dig> modeller runs resulted in  <dig> structural models per query which were sorted according to the sc <dig> criterion. finally, the energy of the best model was minimized using the sander program of the amber package. restraints were applied on the backbone atoms to avoid large deviations from the initial model and the gbsa implicit solvation scheme was used. further difficulties arise when attempting to automatically model large data sets. since several knottins are macrocyclic, i.e. the n- and c- termini are connected through a regular peptide bond, potentially cyclic knottins  were tentatively modeled as such according to the annotation available in the knottin database  <cit> . in the latter database, the cyclic feature was assessed by manually analyzing the n- and c-termini for the presence of a cyclization site. moreover, a large number of knottins display additional disulfide bridges that supplement the  <dig> disulfides forming the cystine knot. these additional bridges were only imposed in the models when there was no ambiguity regarding cysteine connectivity. in any case, when residues at standard positions  <dig> and  <dig> were cysteines, a disulfide bridge was always imposed whatever the total number of cysteines, since this bridge has been frequently observed in experimental structures . finally, except for knottins with known 3d structure, the resulting knottin structural models are now available from the "sequence" section of the knottin database server at url http://knottin.cbs.cnrs.fr <cit> . new models will be added as novel sequences are discovered and incorporated in the knottin database. by comparing the knottin sequence identity distribution  with the expected model accuracy , the average model versus native structure rmsd over all knottin sequences can be estimated between  <dig>  and  <dig>  Å which should be a sufficient accuracy for many applications.

the homology modeling procedure has also been integrated into the protein analysis toolkit pat accessible at http://pat.cbs.cnrs.fr <cit>  as an independent structural prediction module called knoter1d3d. the whole processing for one knottin structure prediction requires one minute to one hour on this server. this processing time depends linearly on the product of the chosen maximal number of 3d templates and of the number of models generated per modeller run. the best resulting knottin model is saved as pdb formatted data and is accessible from the pat web session manager. by this way, knottin data can be further analysed by interactive data transfer to other analysis tools available in the pat processing environment.

discussion
modeling at low sequence identity can be improved by a structural analysis of template clusters
although continuous improvements in the accuracy of protein modeling techniques have been achieved over the last years, structural predictions at low sequence identity still remain difficult. in this work, we have shown that the optimal use of the structural information available from all members of the query family can lead to notable model accuracy and quality gains, even when the closest templates share less than 20% sequence identity with the protein query. for example, the dc <dig> criterion, which was shown to improve template selection, could be directly derived from the analysis of the disulfide bridges and hydrogen bonds conservation over all knottin structures. using a hierarchical classification of all knottin structures, we could evidence a direct influence of the position of cysteine iv onto the main chain hydrogen bond network. such structural information can be easily translated into a sequence constraint by adding, to the pid criterion, a penalty when template and query cysteine iv cannot be aligned. benchmarks on our knottin test set showed that this modified dc <dig> criterion achieves a better template selection than pid alone. this example demonstrates that generic modeling approaches applicable to any protein are too general for optimally modeling a specific protein family because they are not able to delineate precisely the structural features conserved over related protein subsets. furthermore, in our work, the conserved hydrogen bonds derived from structure superimposition and clustering were used as restraints to force the models to conform to the 80% consensus hydrogen bonding observed over the whole knottin family or a subset of it. this is useful because not all templates satisfy the consensus hydrogen bonds, most likely because hydrogen bonds cannot always be directly inferred from nmr data. consequently correct hydrogen bonding, especially in solvent exposed areas, strongly depend on the structure calculation and refinement methods. moreover, the use of multiple templates in the modeling  may result in averaging and, locally, to the loss or deformation of specific hydrogen bonds. nevertheless, improvements from such specific constraints cannot be easily quantified by rmsd reductions but rather by a better organization and conformation of the main chain, i.e. better quality models as demonstrated by increased errat scores at any homology levels.

modeling at low sequence identity can be improved by combining more templates
another important result of this work was the important reduction of query - model rmsd obtained by combining multiple structural templates for modeling one query. for the best modeling procedure rms.tma.m <dig>  the query - model main chain rmsd reduction was on average  <dig>  Å when sc <dig> was used as model assessor and when up to  <dig> templates were used instead of only one. this result is consistent with what has been observed recently on more diverse structure sets using modeller as model generator and proq as model assessor  <cit> . this improvement might have been reinforced for knottins because the large sequence diversity, the tiny conserved core and the high structural loop variability often imposed the use of many templates to cover the conformational space of each query loop. using multiple templates extends the conformational space explored by the models while the sc <dig> filter is sufficiently accurate to select, on average, better models as their number increases. actually, the number of combined templates resulting in the most accurate model was varying between  <dig> and the maximum allowed number  <dig> over the different knottin queries with a mean value near  <dig>  the optimal models were therefore usually obtained from more than one template, thereby indicating that even the more distant templates help to better capture the target fold.

modeling at low sequence identity can be improved by procedural optimization
modeling at low sequence identity requires a succession of processing steps which can be combined in many ways. the knottin template and model accuracies display important variations when different modeling procedures and parameters are chosen as can be seen from figures  <dig> and  <dig>  in particular, it can be observed that a basic modeling procedure based on a unique template per query is far from optimal, particularly when the templates are weakly homologous to the query. this performance variation stresses the importance of systematically optimizing each processing step, of exploiting in each step the structural constraints specific to the query family and of measuring the impact of each modification on a relevant test set. using the modeling procedure optimized on knottins, it is interesting to note that the resulting query - model rmsd was  <dig>  Å below the smallest query - template rmsd on average . this result is significant since building models closer to native experimental structures than the templates used to build them is usually considered as the major challenge of homology modeling for years to come.

best models could be improved by energy minimization with implicit solvent
implicit solvation schemes can help classical molecular mechanics force fields to better refine and evaluate protein structural models  <cit> . we observed a similar impact on our data set when mm_gbsa was used for refining models close to native fold, but an opposite impact when the models deviated from native for more than ~ <dig>  Å. this trend is consistent with the intuitive observation that energy minimization can be efficient only if the initial conformation lies within the energy basin corresponding to the native minimum. when this condition is met, implicit solvent improves the minimization and the evaluation obtained from the physics-based force fields by refining the assessment of the residues exposed to solvent and by smoothing the rugged energy landscape thereby helping to escape local minima. an important and positive side effect of energy minimization is to optimize the hydrogen-bonding network and to remove any steric clash that could arise when combining incompatible restraints from different templates. unfortunately, the degradation observed for the models with deviation from native state higher than  <dig>  Å was not compensated on average by the improvement obtained on the closer models. recently, notable progress was made on the structural evaluation and correlation coefficients above  <dig>  between the model scores and the model - native main chain deviation were reported  <cit> . if such a reliable model assessor could be designed for knottins, then energy minimization with implicit solvent could be profitably focused on the best predicted models only.

how to model knottin loops
a correct modeling of knottin loops is important since loops constitute a major fraction of the knottin structures. unfortunately, sequential rmsd distribution indicates that the knottin cores are usually accurately modeled while the major fraction of query - model deviation is concentrated in the loops. our various attempts to refine knottin loops failed probably because the explored conformational space was too narrow and because the evaluation criterion sc <dig> was unable to correctly assess these irregular and solvent exposed segments. we showed in previous studies how context-dependent potentials can accurately evaluate the compatibility of a given amino acid with very specific structural environments  <cit> . to improve the structural evaluation of the knottin loops, we have developed knowledge-based potentials dependent on each loop length and anchor geometry. the potentials were calculated as follows: all loops with a number of amino acids identical to the model loop and a relative orientation of the anchoring residues similar to the model loop are extracted from the pdb and a statistical scoring profile is then derived from the positional amino acid and conformation frequencies observed in these selected loops. such statistical profile reflects specifically the conformational propensities of any amino acid segment locally grafted on the considered model. however, the incorporation of these loop dependant potentials into the model evaluation score sc <dig> did not improve its accuracy. nevertheless, many issues remain to be explored about these potentials such as how to normalize the potentials for comparing different loop anchors or how fine should be the loop sampling for a given sequence length and anchoring geometry. in combination with a rapid loop generator such as loopy  <cit> , such loop-specific potentials are promising tools for adding context specific information and guiding the exploration of the loop conformational space.

CONCLUSIONS
in this work, we have optimized a modeling pipeline to build 3d models of proteins with the knottin scaffold. the fully automatic and optimized process allowed us to generate satisfactory models for the  <dig> known knottin sequences which open the way toward applications requiring intermediate resolution atomic coordinates. applications based on the knottin models are beyond the scope of this article. nevertheless, we expect that the exhaustive knowledge of all knottin structures will be useful for refining their classification since sequence identities are sometimes so low that evolutionary relationships can be very ambiguous. other major applications of knottin models might be the prediction of interaction sites for which many approaches with diverse levels of reliability have been developed  <cit> . it would be interesting to apply these tools for delineating the few functionally critical residues and their 3d signatures, or for predicting non-continuous epitopes  <cit> . it has been shown also that antimicrobial peptides often interact with membranes through non-specific sites made of a combination of hydrophobic surfaces and positively charged clusters  <cit> . such features could be systematically searched in knottin 3d models to suggest new potential drug leads.

although this work is specific to a particular small disulfide-rich scaffold, we expect that the improvements obtained here could be transposed to larger and more representative protein family sets. apart from the computational time which will be higher for larger proteins, all methods described here are fully automated and processing other families should be relatively easy. protein families with large structural variability should benefit most from the improved template selection and alignment methods, from the combined use of varying numbers of templates, and from the refined model evaluation scores. furthermore, the structure analyses of the related templates that led to disulfide and hydrogen bond restraints could be applied to other families and even generalized to other structural features such as main chain conformation or amino acid interactions. this type of analysis method could even be refined by automatically delineating template subsets sharing discriminative structural features and corresponding to particular branching nodes in their classification tree. in particular, such discriminant analyses could permit the definition of geometrical restraints specific to different interaction sites in the case of protein superfamilies which cover several functions and binding modes.

authors' contributions
jg and lc designed the project, interpreted the results, implemented the internet server modules and written the manuscript. jg implemented the modeling procedure, processed data and computed result statistics. all authors read and approved the final manuscript.

aknowledgements
we are grateful to conan wang and david craik for a preliminary study and helpful discussions.
