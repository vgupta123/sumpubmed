BACKGROUND
one of the major challenges in biology is to reconstruct phyletic relationships between living organisms. various phylogenetic inference methods have been proposed to unravel this critical problem by using genomic data  <cit> ; different phylogenetic trees have been reconstructed based on the similarity of sequences of genes encoding 16s ribosomal rnas  <cit>  and other marker genes  <cit> .

with the increasing availability of whole-genome sequences, proteomic data, and annotated metabolic reactions, more homologous characters between different organisms can be identified to infer phylogenetic trees. in addition to genomic comparisons, a number of recent studies have begun to explore phylogenetic distance between species based on metabolic properties, either alone or in combination with sequence features  <cit> . conserved metabolic pathways have been used to explicitly derive phylogenetic trees through a variety of approaches. for example, forst et al. measured distances between organisms by iteratively aligning enzymes based on sequence similarities  <cit> . heymans et al. conducted a pairwise comparison of a single common metabolic pathway between organisms to build phylogenetic trees; they created a distance matrix based on topological relationships among enzymes   <cit> . clemente et al. hierarchically compared ec  numbers of a common metabolic pathway among multiple organisms to measure pathway similarity  <cit> . all these studies, however, only compared a single metabolic pathway independently when retrieving metabolic network information.

subsequently, clemente et al. extended the ec-based classification method to compare all the common metabolic pathways between multiple species  <cit> . on the other hand, oh et al. used a machine learning approach for computing a distance metric using an exponential graph kernel based on nine common pathways  <cit> . another way to compare a pair of metabolic pathways between organisms is to use topological properties to define the existence/absence of metabolic pathways among organisms  <cit> ; it is thus a network comparison-based method. mazurie et al. used descriptors of structure and complexity of metabolic reactions to calculate phylogenetic distances  <cit> . borenstein et al. devised a seed approach based on essential metabolites to carry out large-scale reconstruction of phylogenetic trees  <cit> . recently, chang et al. proposed an approach from the perspective of enzyme substrates and corresponding products in which each organism is represented as a vector of substrate-product pairs, and the vectors are then compared to reconstruct a phylogenetic tree  <cit> . furthermore, mano et al. considered the topology of pathways as chains and used the pathway alignment method developed by pinter et al.  <cit>  to classify species  <cit> . although comparison and alignment of metabolic networks have been applied to reconstruct phyletic relationships  <cit> , previous studies only considered pairwise structural comparison of conserved metabolic pathways in a local fashion.

network alignment has become central to systems biology; it can be divided into two types: local and global alignment. local network alignment is defined as an alignment of small subnetworks from one network with one or more subnetworks in another network. because such alignments allow one node to have different pairings in different subnetworks, local network alignment may generate ambiguous results. on the other hand, global network alignment can provide a one-to-one mapping for all nodes between networks. that is, the aim is to find multiple independent regions of localized network similarity. global alignment of multiple networks provides clusters across species that best represent conserved biological functions. therefore, to investigate phyletic relationships from metabolic networks, we selected isorankn  <cit> , a global multiple-network alignment tool that simultaneously integrates sequence information with topological properties to cluster functionally similar proteins across species.

RESULTS
we used isorankn to generate a biologically relevant multipartite mapping between organisms. the clusters of enzymes across the networks in the mapping derived by isorankn represent conserved biological reactions and functions. we adapted an entropy measure  <cit>  as the filtering criterion to remove non-consistent enzyme clusters . to construct a phyletic tree comprising multiple species, we defined a pairwise distance measure between two organisms. data for all the metabolic networks and the enzyme sequences used in this study were retrieved from the kegg database  <cit> . additional file  <dig> lists information for the organisms we tested.

first, we classified  <dig> organisms at the phylum scale and compared our results with recent studies. moreover, the approach was applied to phylogenetically closely related organisms to reconstruct phyletic relationships concerning specific metabolic characteristics, such as the light-harvesting systems between prochlorococcus and synechococcus groups, fermentation types between lactobacillus, and sources of electrons used for photosynthesis between green sulfur and green nonsulfur bacteria.

phylum-scale classification
following recent work through the pathway comparison-based approach  <cit>  and substrate-product relationships  <cit> , we chose  <dig> prokaryotes belonging to four categories: archaea, gram-positive bacteria, obligate parasites/symbionts, and proteobacteria . our method correctly divides the  <dig> organisms into the four groups . in general, the classification result is similar to that derived from each of the two recent approaches . upon detailed comparison of tree topologies, the different relative positions can be explained as follows. to clarify the differences between our reconstruction and that generated by the network comparison-based approach of zhang et al.  <cit> , we consider the three organisms buchnera aphidicola aps , campylobacter jejuni subsp. jejuni nctc  <dig> , and helicobacter pylori  <dig> . with our method, hpy and cje were appropriately grouped together in the same subtree of the category proteobacteria as in the ncbi taxonomy  <cit>  . on the other hand, hpy and buc were grouped together in the category obligate parasites/symbionts in zhang et al.'s reconstruction   <cit> . because the pathway comparison-based method only considers the diameter of pathways and the average length of the shortest paths within pathways as topological features, the approach lacks sufficient network information and therefore cannot reveal all of the relevant metabolic properties.

the above result shows that our method can correctly classify organisms into main categories. for the cases shown below, we tested our method with consideration of specific metabolic features.

lactobacillus
we assessed  <dig> species of lactobacillus, which is a genus of gram-positive lactic acid bacteria that have limited biosynthetic capacity and thus are restricted to environments in which sugars are present. with reference to known sugar fermentation patterns  <cit> , our approach could successfully divide  <dig> lactobacillus species into two broad metabolic categories: obligately homofermentative and obligately heterofermentative metabolism . this classification is similar to previous studies based on proteomics  <cit> , a rrna dataset  <cit> , and marker genes  <cit> . the difference between these two categories at the enzyme level possibly comes from the presence or absence of key cleavage enzymes in the glycolysis pathway and phosphoketolase pathway  <cit> .

prochlorococcus and synechococcus
next, we selected  <dig> organisms from prochlorococcus and synechococcus. these two genera show greater than 96% similarity in their 16s rrna sequences; however, they have different light-harvesting systems. prochlorococcus has divinyl chlorophyll a , monovinyl and divinyl chlorophyll b  as its major photosynthetic pigments, but synechococcus has chlorophyll a  and phycobiliproteins that are typical of cyanobacteria  <cit> . in addition to these differences in light-harvesting systems, their utilization of nitrogen sources also differs  <cit> . compared with conventional reconstruction methods based on 16s rrna information, our method could more correctly divide them into two groups and revealed differences in their metabolic features .

green sulfur and green nonsulfur bacteria
in our final experiment, we tested our method on green sulfur and green nonsulfur bacteria from anaerobic photoautotrophic bacteria. these organisms use two different sources of electrons in photosynthesis. green sulfur bacteria use sulfide ion as the electron donor, whereas green nonsulfur bacteria do not  <cit> . we reconstructed a phyletic tree for  <dig> species ; our classification result clearly reflects this metabolic characteristic. the green sulfur and green nonsulfur species were classified into two different groups; phylum chloroherpeton, pelodictyon, prosthecochloris, chlorobaculum and chlorobium are in green sulfur group, whereas the other nine strains in different phyla are classified into green nonsulfur group. the result implies that the proposed method can identify unique metabolic features.

based on global alignment of multiple metabolic networks, our approach can classify organisms into main categories that reflect living style and phenotypes. the above cases clearly show that the resulting phyletic trees reflect specific metabolic characteristics among species. thus, our approach can provide phyletic reconstructions at high resolution and characterize differences in metabolic features between phylogenetically closely related organisms.

methods
we employed isorankn to explore functional similarities and differences in multiple metabolic networks. the key idea of isorankn is briefly introduced , and a detailed description has been published in  <cit> . isorankn is a global multiple-network alignment tool based on spectral clustering methods. given several metabolic networks, in which the enzymes and metabolites are represented as nodes and the reactions catalyzed by enzymes are represented as edges in each network, the algorithm first computes pairwise functionally similar scores between all the cross-species enzymes  <cit> . the next step uses the concept of the star alignment approach and personalized spectral clustering. in addition, we also used the functional consistency measure  <cit>  to further refine the clusters obtained by isorankn.

to remove non-consistent enzyme clusters, we adapted an entropy measure sv is used as the consistency measure, which represents the degree of functional uniformity of enzymes in each cluster.

 h=hp <dig> p <dig> ⋯pd0=-∑i=1dpilogpi 

where pi is the fraction of sv with kegg group id i. a cluster with lower entropy implies greater within-cluster consistency with respect to kegg annotations, and thus we select the clusters with lower entropy to extract a greater amount of information on the phylogenetic relationships between the test organisms.

a phyletic tree comprising multiple species is reconstructed based on a distance measure defined by the fraction of the identified clusters in which the constituent enzymes appear in the two organisms. the distance between two organisms a and b is defined as follows: sa∩bsa∪b where |sa∩b| denotes the number of clusters that contain enzymes in both organisms a and b, and |sa∪b| denotes the number of clusters in which the constituent enzymes are in either organism a or b. we remark that only the clusters with lower mean entropy are considered. the mean entropy of a cluster measures its functional consistency, and as noted above, lower entropy implies greater within-cluster consistency with respect to kegg annotations. thus, to obtain consistency with respect to sequence-based kegg annotation and topological features, we select the clusters having entropy no larger than  <dig> .

based on the above process, a distance matrix can be obtained. we then used phylip  <cit>  to build a phyletic tree based on the distance matrix. the visualization tool, dendroscope  <cit> , was used to display the phyletic trees. all experiments were performed on a platform consisting of intel xeon cpu e <dig>  machines running the linux system.

discussion
establishing network alignments is critical in evolutionary and systems biology  <cit> . several approaches to multiple network alignment have been developed to infer the global homologous characters between complete networks; these approaches include græmlin  <cit> , networkblast-m  <cit> , isorank  <cit> , isorankn  <cit> , graal  <cit> , and submap  <cit> . græmlin is a machine learning approach implemented by initially using sequence features and then incorporating local network information. however, it is difficult to select training data for reconstructing phyletic relationships between close organisms  <cit> . networkblast-m is a local network alignment tool, which cannot reveal complete topological information. kuchaiev et al. developed the pairwise sequence-free global network alignment tool, graal, with which they defined a distance metric between two species by using the edge correctness ratio of pairwise metabolic network alignment results and reconstructed phylogenetic trees  <cit> . because the tool only considers topological information of metabolic networks, the sequence features that are ignored may play important biological roles in phylogeny. the first global network alignment algorithm, isorank, uses a spectral graph algorithm to measure an alignment between two networks based on both sequence similarity between nodes and topological similarity of their neighborhoods. ay et al. extended the idea of the isorank algorithm for pairwise network alignment to metabolic networks but did not consider multiple network alignment  <cit> . therefore, for our purpose we selected isorankn, a global multiple network alignment tool that simultaneously integrates sequence information with topological properties to cluster functionally similar proteins across species. liao et al.  <cit>  demonstrated that isorankn outperformed existing algorithms for global multiple network alignment of protein interaction networks with respect to coverage and consistency.

recall our first reconstruction result on the  <dig> prokaryotic organisms . note that our phyletic classification is quite similar to the reconstruction of chang et al.  <cit> , although there are certain differences . we try to investigate the difference through a new quantitative analysis method. because networks that are similar share a greater number of common enzymes, for each kegg pathway id we computed the number of constituent enzymes associated with this id in the clusters obtained from isorankn for a pair of organisms. this method is used to evaluate functionally similar pathways between those two organisms. we applied the method to assess phylum-scale reconstruction and compared with the results of chang et al. to find more subtle phenotypic differences. with a detailed comparison of tree topologies, we then consider the instance of three organisms: caulobacter crescentus cb <dig> , mesorhizobium loti  and pseudomonas aeruginosa pao <dig> . pae is closer to mlo than to ccr in our tree . in the reconstruction of chang et al.  <cit> , however, pae is closer to ccr than to mlo . according to the statistics of the kegg pathways for the three species pairs, namely , , and , two pathways, ko <dig> and ko <dig> for the pair , show more functional similarity than those for the pairs  and  . the quantitative analysis demonstrates that pae and mlo have stronger phenotypic similarity.

as for phylogenetically closely related organisms, we then applied the same analysis to lactobacillus. for our reconstruction , we consider three pairs of organisms with high 16s rrna sequence similarity: lactobacillus gasseri  versus lactobacillus johnsonii ncc  <dig> , lactobacillus fermentum ifo  <dig>  versus lactobacillus reuteri sd <dig> , and finally lfe versus lga. the former two pairs come from the same groups, respectively, and the last pair was selected from different groups in our reconstruction. as shown in additional file  <dig>  the pair  in the homofermentation group shares more enzymes than those for the pair  from different groups according to the statistics of the kegg pathways ; similarly,  has more common enzymes than those for  . that is, lactobacillus species in the same group in our classification show more functional similarity than those species from different groups. more precisely, concerning the glycolysis/gluconeogenesis pathway, ko <dig>   and  share more constituent enzymes than those for . these results show that our reconstruction can reveal specific metabolic features.

we also analyzed species from prochlorococcus and synechococcus, which have different light-harvesting systems. for our reconstruction , we consider three pairs of organisms: prochlorococcus marinus ss <dig>  versus prochlorococcus marinus mit  <dig> , synechococcus sp. wh <dig>  versus synechococcus sp. wh <dig> , and finally pma versus syx. the former two pairs come from the same groups, respectively, and the last one was selected from different groups in our reconstruction. however, there is no obvious difference when we compare  and  with  . in such a case, the quantitative analysis cannot explicitly classify the species with high sequence similarity regarding their particular metabolic features.

in contrast, our classification by using global alignment of multiple metabolic networks can successfully determine phenotypic similarity . because our approach incorporates topology features of metabolic networks with sequence similarity, it affords a more in-depth analysis of the phyletic reconstruction.

CONCLUSIONS
most studies have focused on the classification of organisms based on structural comparison and local alignment of metabolic pathways. in contrast, global alignment of multiple metabolic networks, which compensates sequence-based phylogenetic analyses, may provide more comprehensive information. therefore, we propose a new approach that uses the global network alignment tool, isorankn, to reconstruct phyletic relationships of multiple species. our phyletic trees lie between conventional genotypic construction and phenotypic reconstruction. we demonstrated that our reconstruction has the capacity to explore more in-depth metabolic features and subtle phenotypic differences, such as light-harvesting systems, fermentation type, and sources of electrons for photosynthesis.

the growing mass of systems-level data allows our approach to find more applications to identify phenotypic variations hidden behind sequence-based classification  <cit> . in addition to metabolic network information, suthram et al.  <cit>  showed that phylogenetic relationships may be inferred from protein interaction networks. they identiﬁed conserved species-speciﬁc complexes in protein interaction networks and built a phylogenetic tree based on the complexes because interactions between proteins may imply conservation of speciﬁc groups. although false-positives exist in protein-protein interaction data, comparative analysis of protein-protein interaction networks of closely related organisms can reveal phenotypic properties  <cit> . therefore, global alignment of multiple protein-protein interaction networks may provide a high-resolution look at phyletic reconstruction. it is worthwhile to explore the phenotypic differences between global network alignment of multiple metabolic networks and protein interaction networks. in the future, better quantitative and qualitative analyses of metabolic pathways between organisms would also be of interest.

competing interests
the authors declare that they have no competing interests.

authors' contributions
cym and csl conceived, designed, and performed this study. cym conducted research under supervision of csl and cyt. cym, shl and ccl designed the experiments. cym, shl, ccl, cyt, bb and csl wrote the manuscript. all the authors read and approved the final manuscript.

declarations
this work was funded in part by the national science council of taiwan under the grants nsc100-2221-e-007-108-my <dig>  and nsc100-2221-e-126-011-my <dig> , nih grant gm <dig>  and moe grant 101n2074e <dig> . the publication costs for this article were funded by the national science council of taiwan.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2013: selected articles from the eleventh asia pacific bioinformatics conference : bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/14/s <dig> 

supplementary material
additional file 1
organisms used in this study. edges represent the reactions catalyzed by enzymes in each metabolic network. all metabolic pathways were retrieved from kegg  <cit> .

click here for file

 additional file 2
comparison of reconstructed phylogenic trees. left: reconstruction by chang et al.  <cit> . right: reconstruction by zhang et al.  <cit> . reprinted under the biomed central open license agreement .

click here for file

 additional file 3
the isorankn algorithm.

click here for file

 additional file 4
statistics for kegg pathways between three pairs of organisms: ,  and . the x axis represents kegg pathway ids, and the y axis represents the number of the constituent enzymes in the pathways. the two pathways ko <dig> and ko <dig> in the pair  contain more functional orthologs than those in the pairs  and .

click here for file

 additional file 5
statistics for kegg pathways between two pairs of organisms in lactobacillus: the x axis represents kegg pathway ids, and the y axis represents the number of the constituent enzymes in the pathways.   in obligate homofermentation, and  from different fermentation types.   in obligate heterofermentation, and  from different fermentation types.

click here for file

 additional file 6
statistics for kegg pathways between two pairs of organisms of prochlorococcus and synechococcus: the x axis represents kegg pathway ids, and the y axis represents the number of the constituent enzymes in the pathways.   from prochlorococcus, and  from prochlorococcus and synechococcus, respectively.   from synechococcus, and  from prochlorococcus and synechococcus, respectively.

click here for file

 acknowledgements
we thank masanori arita at university of tokyo for helpful comments. we are also grateful to the national center for high-performance computing for computer time and facilities. c.-s.l. acknowledgements support from sayling wen cultural and educational foundation.
