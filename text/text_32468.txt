BACKGROUND
studies using next generation sequencing or single nucleotide polymorphism’s  array data often rely on genomic coordinates from reference assemblies. however, as stated by salzberg and york  <cit> : “certainly, there might be errors at some small rate in genome sequence data generation and assembling”. these errors frequently affect analyses based on genomic data, such as genotype phasing, imputation and post hoc annotation in genome-wide association studies . therefore, systematic identification and correction of misassembled segments in a reference genome improves assembly quality locally, increases the power of analyses, decreases the rate of false positive results and ultimately permits researchers to formulate hypotheses on the basis of more correct findings.

methods relying on sequence  <cit> , in situ hybridization  <cit>  or optical mapping  <cit>  data have been used to pinpoint assembly problems in the bovine reference genome. however, as linkage disequilibrium  decays as a function of distance in a chromosome, the recent availability of a large number of bovine samples genotyped by high-density single nucleotide polymorphism  arrays offers the opportunity to exploit ld information to correct assembly mistakes. by assessing marker ld, one can identify segments in the reference genome which do not belong to their assigned locations, as well as estimate their most likely true position.

evidence of misassembly signatures in the bovine umdv <dig>  reference genome have been recently reported. bohmanova et al.  <cit> , characterizing ld in north american holstein, identified  <dig> snps  producing unexpected long distance ld. using a higher density snp array  to test imputation in fleckvieh , pausch et al.  <cit>  identified  <dig>  out of  <dig>  snps  exhibiting poor imputation performance. poor imputation accuracies of neighboring snps were also reported in bos indicus, namely nellore beef cattle  <cit>  and gyr dairy cattle  <cit> . since the imputation process depends on ld blocks to infer missing marker genotypes, an assembly error would be the main reason for poor genotype imputation  <cit> .

here, we report a heuristic approach based on ld analysis to identify misassembly signatures and estimate an approximate re-location for the missassembled segments in the umdv <dig>  bovine reference genome. furthermore, we demonstrate the effect of detecting and correcting assembly errors in two case studies: i) gwas on the polled/horned phenotype in nellore cattle and ii) imputation in nellore and italian holstein. misassembled segments directly affected gwas results and imputation performance. re-location of misassembled segments provided new insights on the so far unsolved nature of the locus controlling horn development in cattle and substantially improved imputation accuracy locally.

RESULTS
genotypes and data filtering
to minimize spurious ld patterns caused by the confounding effect of breed-specific gametic-phase disequilibrium and structural variants or epistatic loci under selection, we selected genotypes from two genetically divergent populations, one of b. taurus  and one of b. indicus  with distinct production purposes , to identify unexpected ld patterns in common regions that are likely due to genome misassembly. these breeds were chosen because the largest bulk of re-sequencing data driving the design of the high density cattle snp panel  were from holstein , and most of the b. indicus specific snps were derived from a draft genome assembly of a nellore  bull. nellore genotypes were provided by the zebu genome consortium  and italian holstein genotypes were provided by the innovagen project - “research and innovation in italian animal breeding ii”.

after data filtering,  <dig> bulls and  <dig>  autosomal snps and  <dig> bulls and  <dig>  autosomal snps were used for estimating marker-pair ld values in hol and nel, respectively. combination of the two snp lists resulted in  <dig>  markers, which covered about  <dig>  gb of the umdv <dig>  reference genome, with an average intermarker distance of  <dig>  ±  <dig>  kb. although highly important, sexual chromosomes were excluded from this analysis due to their particularly complex model of inheritance. moreover, there is not an assembly for the y chromosome, the pseudo-autosomal region of the x chromosome is not well characterized, and the use of male data only may bias ld estimates.

detection of misassemblies
we applied our pipeline  to the nel and hol datasets, and detected  <dig>  candidate misplaced markers  having unexpected ld patterns. among these,  <dig>  were found in both breeds,  <dig> only in hol, and  <dig> only in nel. a total of  <dig> ,  <dig> ,  <dig>  and  <dig>  cmms mapped on chromosomes  <dig>   <dig>   <dig> and  <dig>  respectively. these four chromosomes contained  <dig>  % of snps with unexpected ld behavior likely carrying the largest assembly errors in the umdv <dig>  reference. we found no association between chromosome length and the number of cmms . interestingly, no misplacement was found on chromosome  <dig>  which indicates a highly accurate assembly of this chromosome.fig.  <dig> flowchart of the pipeline to detect candidate misplaced markers . oval symbols denote the beginning and end of the pipeline; the hexagon indicates the beginning of a loop structure; rectangles indicate a computation; diamonds indicate the points where decisions are made; parallelograms indicate output of information. the arrows indicate the flow of the pipeline and f and t denote false and true, respectively

fig.  <dig> histogram of the number of snps with unexpected linkage disequilibrium  pattern detected by chromosome



we mapped the  <dig>  cmms against their contigs of origin and identified  <dig> candidate misassembled contigs . a graphical inspection of the ld decay of the detected cmcs allowed us to recognize three types of signatures of misassembly: i. misplaced snp ; ii. misassembled segment ; and iii. partially misassembled contig . briefly, missnps are defined as single markers showing strong ld with snps in a segment far apart  in the same or in a different chromosome and no evidence of ld with snps surrounding it. misseg comprises one or more cmcs showing markers with strong ld with snps within the segment and with snps far apart in the same or in a different chromosome, but no evidence of ld with snps in adjacent contigs. finally, a pmiscon is a special case of cmc with markers having a mixture of behaviors. a fraction of them had expected ld values with nearby markers in the region, while others show no evidence of ld at their sites but strong ld with another segment elsewhere in the genome. examples of missnp, misseg and pmiscon are shown in additional file 1: figure s <dig>  additional file 2: figure s <dig> and additional file 3: figure s <dig>  respectively.

from the total number of detected markers,  <dig>   were included in misseg,  <dig>  in pmiscon and  <dig>  in missnp. the complete list of the detected signatures of misassembly, as well as all the graphs built for the missnp, misseg and pmiscon cases, can be seen in additional file 4: table s <dig> and additional file 5: figure s <dig>  additional file 6: figure s <dig> and additional file 7: figure s <dig>  respectively. hereafter, we focus on the misseg cases as they comprised the vast majority of the signatures of misassembly. after grouping adjacent cmcs, we were able to identify  <dig> misseg, from which  <dig> were detected in both breeds,  <dig> only in hol and  <dig> only in nel. the breed-specific cases represented differences in local coverage by polymorphic snps between breeds, since markers with low minor allele frequency  were removed in the quality control. the largest misseg was found in both breeds on chromosome  <dig>  and consisted of  <dig> adjacent contigs  covering a ~ <dig>  mb segment sheltering  <dig> snps . the smallest segment was found on chromosome  <dig>  consisting of a single contig of 679 bp covered by only one marker .

the average size of cmcs included in misseg was  <dig>  ±  <dig>  kb. the vast majority of the cmcs  had length smaller than the n <dig> in umd v <dig>  . only  <dig>  % of the cmcs had length greater than the n <dig> . this suggests that smaller contigs are more prone to assembly errors, leading to scaffolding artifacts that can be detected in the form of misseg. although rare, cmcs large than the n <dig> were also found, which may represent brute force assembly of low quality and low complexity sequences  <cit> .fig.  <dig> distribution of frequencies of misassembled contig sizes. the red line represents the n <dig> of the umdv <dig>  bovine genome assembly



considering the percentage of the reference genome covered by misseg, we found that less than 1 % of the reference sequence was wrongly assembled, which confirms its robustness. at the chromosome level, we found error rates of  <dig>  % for chromosome  <dig>   <dig>  % for chromosome  <dig>   <dig>  % for chromosome  <dig> and  <dig>  % for chromosome  <dig> 

estimation of true locations
approximate locations were estimated for the detected misassembled segments using r <dig> information. note that this process can only guide the rearrangements of cmcs to their estimated true location, and that the de facto correction of these assembly errors demand consorting the ld analysis with re-alignment and re-assembly of raw reads against the targeted locations. also, due to differences in the extent of ld and allele frequencies between breeds, the locations suggested by ld analysis varied between nel and hol. in fact, differences in ld-based estimates in nel and hol ranged from  <dig> to 26 mb, with an average of 871 kb.

estimated locations for missnp, misseg and pmiscon are graphically represented in fig. 4c, a and b, respectively . interestingly, although some chromosomes presented few or no assembly errors in our ld analysis, all chromosomes acted as cmc receptors.fig.  <dig> circos plot of misassemblies. the  <dig> bovine autosomes are represented by polygons of different colors. arrows within the inner track indicate the flow of misassemblies from their current to their estimated true locations . a annotations in the outer track refer to the snp probe name in additional file 4: table s <dig>  b annotations in the outer track refer to the misseg aliases in additional file 4: table s <dig>  c annotations in the outer track refer to the contig name in additional file 4: table s1



genome-wide scan for absence of horns in nellore cattle
we found  <dig> markers significantly associated  with absence of horns in nel. these markers were divided into two different signals on chromosome  <dig> . the most significant snp in the first signal  was located at  <dig>  kb, nearby the widely known poll locus  <cit> . the most significant snp in the second signal  was located at  <dig>  mb, approximately  <dig>  mb apart from the most significant snp in the first signal.fig.  <dig> manhattan plot of -log <dig> of snps for the polled/horned  phenotypes in nellore cattle



we analyzed the ld patterns in the two regions independently to define the limits of the associated loci. next, we analyzed the ld between the two putative candidate regions and found that the most significant snps in the two signals are in very strong ld . in fact, the average r <dig> among all significant snps was  <dig>  ±  <dig> . looking carefully at the behavior of ld decay in the second signal, we noted strong ld among markers within the region but no evidence of ld with surrounding markers. indeed, the snps pertaining to the second signal are located in the r <dig> misseg  identified in our ld-based analysis of assembly errors .

imputation in italian holstein and nellore
we evaluated the impact of markers in missnp, misseg or pmiscon on the global and local performance of imputation from medium  to high density  chips.

the average genome-wide snp imputation accuracy was  <dig>  ±  <dig>  in nel and  <dig>  ±  <dig>  in hol. after excluding all putative assembly problems, accuracies increased marginally to  <dig>  ±  <dig>  in nel and  <dig>  ±  <dig>  in hol. after correcting the positions, accuracies also increased marginally to  <dig>  ±  <dig>  in nel and  <dig>  ±  <dig>  in hol. however, the local imputation performance before and after correcting snp locations were  <dig>  ±  <dig>  and  <dig>  ±  <dig>  in nel and  <dig>  ±  <dig>  and  <dig>  ±  <dig>  in hol, respectively.

in order to illustrate the local effect of correcting assembly errors, we showed the local genotype prediction accuracy before and after correcting the location of the r <dig> misseg . considering the originally assigned location of r <dig>  we obtained average accuracies of  <dig>  ±  <dig>  in nel and  <dig>  ±  <dig>  in hol. after correction, snps in r <dig> increased their imputation accuracies considerably in both nel and hol, with averages of  <dig>  ±  <dig>  and  <dig>  ±  <dig> , respectively .fig.  <dig> linkage disequilibrium  decay and snp imputation accuracies for the r <dig> segment in italian holstein  and nellore . from the top to the bottom of the picture, before  and after  correcting the segment using ld information, we plotted the ld decay of the segment in italian holstein  and nellore , the snp imputation accuracies in italian holstein  and nellore , and a magnification of the segment in italian holstein  and nellore 



discussion
assembly errors usually arise from nucleotide repeat collapse and expansion; as well as sequence rearrangements and inversions  <cit> . these two types of errors are mostly caused by repetitive dna, which increases the complexity of sequence assembly using short reads and imposes great computational challenges in contig formation  <cit> . these assembly errors are often silent in the sense that without additional data from long reads or population-level genotypes  <cit>  they remain unidentified.

evidences of assembly problems in the bovine reference have been recently published in ld and imputation studies. for instance, bohmanova et al.  <cit>  assessed the extent of ld in american holstein using a medium density snp panel, namely illumina® bovinesnp <dig>  and detected  <dig> snps with unexpected ld decay. milanesi et al.  <cit> , comparing imputation accuracies in simmental cattle using different reference genome assemblies, found segments poorly imputed in one reference assembly that in the other mapped to a different chromosome with low imputation error rates, arguing that a cluster of consecutive markers with a high percentage of imputation errors may be evidence of misassembled segments in the reference genome. also, studying strategies for genotype imputation in gyr  dairy cattle, boison and colleagues  <cit>  found poor imputation accuracies for certain segments of the genome. one of the segments ranged from  <dig>  to  <dig>  mb on chromosome  <dig>  the same segment was reported by carvalheiro et al.  <cit>  in nellore cattle, and by pausch et al.  <cit>  in fleckvieh  dairy cattle. in a more detailed analysis we could break this segment down to two segments, ranging from  <dig>  to  <dig>  mb and from  <dig>  to  <dig>  mb. overall, these studies reported the unusual ld and imputation behavior of snp markers as an incidental finding arising as a side product of their main targeted analyses and avoided a systematic mapping and interpretation of the errors, as well as an assessment of their potential impact on coordinates-dependent analyses.

here, we were able to pinpoint putative assembly errors in the umdv <dig>  bovine reference genome by using population-level ld data generated from high-density snp genotypes of two divergent breeds of cattle. our study revealed that, at least to the extent our ld analysis could detect, a small fraction  of the reference genome is inadequately assembled. also, over  <dig>  % of missassembled segments were found to be smaller than the n <dig> in umdv <dig> , reflecting that these errors largely represent low confidence small contigs. although the detected missassembled segments may not threat the global quality of the umdv <dig>  reference, locally these errors are deemed to affect applications that assume correct marker positions.

studies that are dependent on the positions of molecular markers, such as assessment of the extent of the linkage disequilibrium, imputation, synteny, genome wide association studies, detection of structural variants, runs of homozygosity, among others, can be greatly affected by local assembly errors. for instance, fadista & bendixen  <cit>  sought discrepancies of snp coordinates in commercial human arrays, and found that one significant marker in a gwas performed by macgregor et al.  <cit>  had its position misplaced in the reference genome. gene annotations for such a marker could lead to a wrong interpretation of a biological pathway and give rise to misleading hypotheses.

to illustrate the impact of assembly errors in gwas, we use the example of a genome-wide scan for absence of horns in nellore cattle . the scan revealed two significant signals separated by over 60 mb on chromosome  <dig>  without the proper care, one could assume that the two peaks are independent and proceed with functional annotation. the first peak maps to the well known poll locus in b. taurus, which shelters some candidate genes for the trait, such as olig <dig>  foxl <dig> and rxfp <dig>  <cit> . the nearest gene to the second peak is gap <dig> , located approximately 200 kb downstream of the marker. the gene is involved in innervation and development of long bones  <cit> . recently, a histological study of polled and horned bovine fetuses presented evidence of thick nerve fibers in the dermis underlying the horn bud in both polled and wild type animals  <cit> , suggesting the horn is a highly sensitive area. this finding opens a window to speculations about the participation of innervation in the horn development. given this set of evidences, the logics could suggest a role of gap <dig> in horn development.

in spite of the appealing functional candidacy of gap <dig>  the positional association is clearly wrong. the contig containing the significant marker was estimated to be located within the poll locus, and the region surrounding gap <dig> showed no evidence of assembly errors. moreover, the presence of portions of the poll locus assembled somewhere else in the genome could be an important contributor to the ongoing dispute regarding the candidate gene and causal variant underlying the trait.

we also carried out an imputation study to assess the impact of misassembled segments in genotype prediction performance in nellore and holstein. as expected, the impact of assembly errors on the average imputation accuracy was negligible . however, the correction of the positions of the markers using ld increased the local imputation accuracy substantially . these findings show that the use of ld to estimate the correct position of misassembled segments may help to improve the local quality of the assembly, as well as to increase confidence in association, phasing and imputation analyses.

although very informative, the heuristic approach adopted here has important limitations that are intrinsic to the ld analysis. ideally, one would require the candidate misassembled contigs to be detected in several breeds independently as a strategy to increase the likelihood that the observed pattern was caused by a problem in the reference assembly, rather than breed-specific linkage due to structural variants or epistatic loci under selection or gametic phase disequilibrium. however, due to heterogeneous marker coverage in different breeds, some signals of assembly problems could remain undetected in some breeds due to the effect of ascertainment bias, and in this case requiring the signal to appear in at least one breed could give rise to false positives.

khatkar et al.  <cit>  reported a  <dig>  % empirical assignment accuracy when markers had their positions predicted by pair-wise ld information. however, in the present study, we found an average difference of 871 kb when locations were estimated based on ld in italian holstein or nellore. this suggests that the extent of ld and allele frequencies in the empirical genotype data can greatly affect the estimates of true locations of misassembled segments. of note, the estimates provided here are rough approximations, and the parsimony of corrections based solely on ld information must be cross-validated by complementary analyses, such as increase in local imputation accuracies, or reinforced by additional sequence data.

finally, although some chromosomes exhibited no or few cases of assembly problems, all chromosomes acted as receptors of misassembled segments. this indicates that our estimate of percentage of errors is likely to be underestimated, as some types of assembly errors may not produce a detectable ld signature.

CONCLUSIONS
assembly errors in the umdv <dig>  bovine reference genome were pinpointed by snp ld analysis. we showed that the majority of the errors comprised small contigs that were either malformed or placed wrongly in the genome. although the incidence of errors was low, confirming the robustness of the bovine reference sequence assembly umdv <dig> , the misassembled segments were shown to largely impact local imputation performance and the interpretation of gwas results. estimation of the correct location of the misassembled segments significantly improved imputation accuracy locally and excluded a functional candidate gene as a putative determinant of horn development in polled and horned nellore cattle. our heuristic approach can be useful in refining draft assemblies already available and as a strategy to filter out markers that could largely affect interpretation of downstream analysis.

