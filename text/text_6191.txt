BACKGROUND
dna sequence motifs recognized by transcription factors are usually short  with low information content, and matching sequence elements therefore occur randomly in large numbers in the genome. the precise specificity required for correct temporal and spatial transcription during metazoan development relies on combinatorial interactions between binding sites in relatively dense clusters  <cit> . these clusters, termed cis-regulatory modules , typically contain sites  for several different transcriptional activators and repressors. crms may be unstructured, serving as "billboards" that bring dna binding proteins into proximity  <cit> . in this case, the balance of activators and repressors, rather than the order or spacing between factors, is the most important property. they may however also be highly structured, the extreme example being the "enhanceosome"-type crm, with very little flexibility in the arrangement of recognition sites  <cit> . others are more flexible, but with requirements on organizational features such as spacing, order and helical phasing between binding sites.

numerous examples demonstrate the importance of the last feature, the phase. a small modification of the distance between a pair of sites may sometimes drastically disrupt function and this is usually attributed to the turning of the dna helix. in many cases, insertion of a full helical turn of dna  between cis elements will cause functionality to be restored, as this will cause the same face of the binding protein to be exposed to cofactors and nearby dna binding factors. the phenomenon has been observed in many studies of single genes, e.g. for ap- <dig> and rd binding sites in the collagenase- <dig> promoter  <cit>  as well as for the smooth muscle α-actin promoter, where introduction of a  <dig> bp spacer caused significantly higher reporter activity than a  <dig> bp spacer  <cit> . other examples include the hpv <dig> enhancer  <cit> , lung surfactant protein b  <cit> , tnf-α  <cit>  and igamma <dig>  <cit> . in study of four coregulated drosophila developmental enhancers, a conserved shared organization with pairwise periodic distances between neighboring sites was identified  <cit> . periodic signals in distances between neighboring motif pairs have also been observed on a genomic scale in drosophila  <cit>  and other eukaryotes  <cit> .

significant effort has been put into the problem of de novo motif discovery of transcription factor binding sites  <cit> . the task, often described as a local multiple alignment problem, is difficult due to the degenerate nature of transcription factor recognition sequences. prediction may sometimes be improved by incorporating organizational features such as colocalization and order preferences into the model, and in recent years several such methods have been proposed  <cit> . the idea of incorporating helical phasing into a motif discovery tool has been suggested  <cit> , but to our knowledge no such tool has yet been devised. we propose a motif sampler which can efficiently discover ordered or unordered colocalized motif pairs de novo in dna sequences. in addition, our tool incorporates an optional periodic spacing model, and we show on simulated data that it can detect weak periodic patterns that are not easily discovered using single motif or colocalization methods.

implementation
algorithm overview
we propose a de novo method for motif discovery, helicis, which can find motif pairs separated by a distance  that varies in a periodical manner. more specifically, the distance is modeled as some fixed offset φ  plus a variable integer multiple of the period t . small deviations from exact periodic spacing may optionally be allowed. helicis detects patterns which are common to a group of sequences. a typical input would be regulatory dna from a set of assumedly coregulated genes. the motif pair is assumed to be either present or absent in each sequence and may optionally be allowed to occur on either strand. the period t is specified by the user, but the program can be provided with a range of periods to evaluate. upper and lower boundaries for the distance can be specified. the distance can be allowed to be negative, making it possible to find unordered motif pairs. our method is not limited to finding periodically distributed binding sites. the flexibility of the algorithm makes the task of finding colocalized motifs  or motifs with fixed spacing  into special cases simply achieved by choosing appropriate parameters. e.g. by setting the period to one, the model will find colocalized motifs without periodicity. examples of parameter settings for different scenarios are available on the helicis home page <cit> . the software also incorporates the possibility to take advantage of interspecies conservation by favoring motif placement in highly conserved regions.

mathematical model
let s be the set of n sequences to be analyzed. each sequence si ∈ s, of length ni,  is assumed to contain zero or one motif pair. below, we refer to motif-containing sequences as being regulated and denote this by ri = true. the position of the first and second motif in a particular sequence si is denoted ai and bi respectively. motifs are modeled as two position frequency matrices a and b, where aj and bj denotes the probability of the nucleotide l appearing in position j of motif a and b respectively. unregulated sequences are modeled as background sequence, described by an order  <dig> markov process with nucleotide frequencies θ <dig>  regulated sequences are modeled as a combination of motif and background sequence. the probability of a sequence si  can therefore be written

 p=∏jθ0
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqggoaakcqwgzbwcdawgaawcbagaemyaakgabeaakiabcyha8jabdkfasnaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemozaymaemyyaemaemibawmaem4camnaemyzaumaeiilawcccigae8hude3aasbaasqaaiabicdawaqabagccqggpaqkcqgh9aqpdaqeqaqaaiab=h7axnaabaaaleaacqaiwaamaeqaaowaamwaaeaacqwgzbwcdawgaawcbagaemyaakmaeiilawiaemoaaogabeaaaogaay5waiaaw2faaawcbagaemoaaogabeqdcqghpis1aaaa@50c8@ 

and

 p=qa⋅qb⋅∏jθ <dig> 
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqggoaakcqwgzbwcdawgaawcbagaemyaakgabeaakiabcyha8jabdkfasnaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemidaqnaemocainaemydaunaemyzaumaeiilawiaemyqaekaeiilawiaemoqaikaeiilawcccigae8hude3aasbaasqaaiabicdawaqabagccqggsaalcqwghbqydawgaawcbagaemyaakgabeaakiabcycasiabdkgainaabaaaleaacqwgpbqaaeqaaogaeiykakiaeyypa0jaemyuae1aasbaasqaaiabdgeabbqabagcdawadaqaaiabdggahnaabaaaleaacqwgpbqaaeqaaagccaglbbgaayzxaagaeyyxictaemyuae1aasbaasqaaiabdkeacbqabagcdawadaqaaiabdkgainaabaaaleaacqwgpbqaaeqaaagccaglbbgaayzxaagaeyyxic9aaebeaeaacqwf4oqcdawgaawcbagaegimaadabeaakmaadmaabagaem4cam3aasbaasqaaiabdmgapjabcycasiabdqgaqbqabaaakiaawufacagldbaaasqaaiabdqgaqbqab0gaey4diunakiabcycasaaa@6ef1@ 

where

 qa=∏k=1waakθ <dig> qb=∏k=1wbbkθ0
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbqudawgaawcbagaemyqaeeabeaakmaadmaabagaemyaakgacaglbbgaayzxaagaeyypa0zaaebmaeaadawcaaqaaiabdgeabnaabaaaleaacqwgrbwaaeqaaowaamwaaeaacqwgzbwcdawgaawcbagaegymaejaeiilawiaemyaak2aasbaawqaaiabdmgapbqabawccqghrawkcqwgrbwacqghsislcqaixaqmaeqaaagccaglbbgaayzxaaaabaaccigae8hude3aasbaasqaaiabicdawaqabagcdawadaqaaiabdohaznaabaaaleaacqaixaqmcqggsaalcqwgpbqadawgaaadbagaemyaakgabeaaliabgucariabdugarjabgkhitiabigdaxaqabaaakiaawufacagldbaaaaaaleaacqwgrbwacqgh9aqpcqaixaqmaeaacqwgxbwvdawgaaadbagaemyqaeeabeaaa0gaey4diunakiabcycasiabdgfarnaabaaaleaacqwgcbgqaeqaaowaamwaaeaacqwgpbqaaiaawufacagldbaacqgh9aqpdaqewaqaamaalaaabagaemoqai0aasbaasqaaiabdugarbqabagcdawadaqaaiabdohaznaabaaaleaacqaixaqmcqggsaalcqwgpbqadawgaaadbagaemyaakgabeaaliabgucariabdugarjabgkhitiabigdaxaqabaaakiaawufacagldbaaaeaacqwf4oqcdawgaawcbagaegimaadabeaakmaadmaabagaem4cam3aasbaasqaaiabigdaxiabcycasiabdmgapnaabaaameaacqwgpbqaaeqaasgaey4kasiaem4aasmaeyoei0iaegymaedabeaaaogaay5waiaaw2faaaaaasqaaiabdugarjabg2da9iabigdaxaqaaiabdefaxnaabaaameaacqwgcbgqaeqaaaqdcqghpis1aaaa@8766@ 

and where wa and wb are widths of the motifs. ai and bi cannot take on arbitrary values but will depend on each other, since we are looking for motif pairs where the distance between the two must follow certain criteria. we use a prior p to reflect this, described below. we also assume there is a fixed prior probability p for any sequence to be regulated. for θ <dig>  aj and bj we use dirichlet priors, with pseudocounts α proportional to the frequencies of the bases in all the sequences. our goal is to find values for r = , a =  and b =  which maximize the posterior p. to accomplish this we use an algorithm based on the gibbs sampling principle for motif discovery  <cit> , which makes use of the predictive update version of the gibbs sampler  <cit> .

given a partitioning of the sequences into motifs and background  we can calculate the total observed counts of nucleotide l in the background  and in the different positions i of motif a  and motif b . sequences where ri =  <dig> are assumed to contain only background sequence. we can then estimate a, b, and θ <dig> as the expectation of p:

 ai=ca,i+α∑lca,i+∑lα,bi=cb,i+α∑lcb,i+∑lα
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgbbqqdawgaawcbagaemyaakgabeaakmaadmaabagaemibawgacaglbbgaayzxaagaeyypa0zaasaaaeaacqwgjbwydawgaawcbagaemyqaekaeiilawiaemyaakgabeaakmaadmaabagaemibawgacaglbbgaayzxaagaey4kascccigae8xsde2aamwaaeaacqwgsbabaiaawufacagldbaaaeaadaaeqaqaaiabdogajnaabaaaleaacqwgbbqqcqggsaalcqwgpbqaaeqaaowaamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoakiabgucarmaaqababagae8xsde2aamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoaaagccqggsaalcqwgcbgqdawgaawcbagaemyaakgabeaakmaadmaabagaemibawgacaglbbgaayzxaagaeyypa0zaasaaaeaacqwgjbwydawgaawcbagaemoqaikaeiilawiaemyaakgabeaakmaadmaabagaemibawgacaglbbgaayzxaagaey4kasiae8xsde2aamwaaeaacqwgsbabaiaawufacagldbaaaeaadaaeqaqaaiabdogajnaabaaaleaacqwgcbgqcqggsaalcqwgpbqaaeqaaowaamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoakiabgucarmaaqababagae8xsde2aamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoaaaaaaa@808a@ 

 θ0=c0+α∑lc0+∑lα
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf4oqcdawgaawcbagaegimaadabeaakmaadmaabagaemibawgacaglbbgaayzxaagaeyypa0zaasaaaeaacqwgjbwydawgaawcbagaegimaadabeaakmaadmaabagaemibawgacaglbbgaayzxaagaey4kasiae8xsde2aamwaaeaacqwgsbabaiaawufacagldbaaaeaadaaeqaqaaiabdogajnaabaaaleaacqaiwaamaeqaaowaamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoakiabgucarmaaqababagae8xsde2aamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoaaaaaaa@51b2@ 

as in other gibbs motif samplers, an iterative update/sampling procedure is applied. one of the sequences, si, is removed from the alignment by setting ri =  <dig>  given values for a, b, and θ <dig> according to the formulas above, new values for ri, ai and bi are determined by sampling from p using the following steps: bayes formula on odds form gives that

 pp=pp⋅pp
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdchawnaabmaabagaemouai1aasbaasqaaiabdmgapbqabagccqgh9aqpcqwgmbgzcqwghbqycqwgsbabcqwgzbwccqwglbqzcqgg8bafcqwgzbwcdawgaawcbagaemyaakgabeaakiabcycasggaciab=h7axnaabaaaleaacqaiwaamaeqaaogaeiilawiaemyqaekaeiilawiaemoqaieacagloagaayzkaaaabagaemicaa3aaewaaeaacqwgsbgudawgaawcbagaemyaakgabeaakiabg2da9iabdsha0jabdkhayjabdwha1jabdwgaljabcyha8jabdohaznaabaaaleaacqwgpbqaaeqaaogaeiilawiae8hude3aasbaasqaaiabicdawaqabagccqggsaalcqwgbbqqcqggsaalcqwgcbgqaiaawicacaglpaaaaagaeyypa0zaasaaaeaacqwgwbacdaqadaqaaiabdohaznaabaaaleaacqwgpbqaaeqaaogaeiifawnaemouai1aasbaasqaaiabdmgapbqabagccqgh9aqpcqwgmbgzcqwghbqycqwgsbabcqwgzbwccqwglbqzcqggsaalcqwf4oqcdawgaawcbagaegimaadabeaaaogaayjkaiaawmcaaaqaaiabdchawnaabmaabagaem4cam3aasbaasqaaiabdmgapbqabagccqgg8bafcqwgsbgudawgaawcbagaemyaakgabeaakiabg2da9iabdsha0jabdkhayjabdwha1jabdwgaljabcycasiab=h7axnaabaaaleaacqaiwaamaeqaaogaeiilawiaemyqaekaeiilawiaemoqaieacagloagaayzkaaaaaiabgwsixpaalaaabagaemicaa3aaewaaeaacqwgsbgudawgaawcbagaemyaakgabeaakiabg2da9iabdagamjabdggahjabdygasjabdohazjabdwgalbgaayjkaiaawmcaaaqaaiabdchawnaabmaabagaemouai1aasbaasqaaiabdmgapbqabagccqgh9aqpcqwg0badcqwgybgccqwg1bqdcqwglbqzaiaawicacaglpaaaaaaaaa@aa0d@ 

from which we get that

 p=− <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdaqadaqaaiabdkfasnaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemidaqnaemocainaemydaunaemyzaumaeiifawnaem4cam3aasbaasqaaiabdmgapbqabagccqggsaaliigacqwf4oqcdawgaawcbagaemyaakgabeaakiabcycasiabdgeabjabcycasiabdkeacbgaayjkaiaawmcaaiabg2da9maadmaabagaegymaejaey4kasyaasaaaeaacqwgwbacdaqadaqaaiabdohaznaabaaaleaacqwgpbqaaeqaaogaeiifawnaemouai1aasbaasqaaiabdmgapbqabagccqgh9aqpcqwgmbgzcqwghbqycqwgsbabcqwgzbwccqwglbqzcqggsaalcqwf4oqcdawgaawcbagaegimaadabeaaaogaayjkaiaawmcaaaqaaiabdchawnaabmaabagaem4cam3aasbaasqaaiabdmgapbqabagccqgg8bafcqwgsbgudawgaawcbagaemyaakgabeaakiabg2da9iabdsha0jabdkhayjabdwha1jabdwgaljabcycasiabdgeabjabcycasiabdkeacjabcycasiab=h7axnaabaaaleaacqaiwaamaeqaaagccagloagaayzkaaaaaiabgwsixpaalaaabagaegymaejaeyoei0iaemicaa3aaewaaeaacqwgsbgudawgaawcbagaemyaakgabeaakiabg2da9iabdsha0jabdkhayjabdwha1jabdwgalbgaayjkaiaawmcaaaqaaiabdchawnaabmaabagaemouai1aasbaasqaaiabdmgapbqabagccqgh9aqpcqwg0badcqwgybgccqwg1bqdcqwglbqzaiaawicacaglpaaaaaaacaglbbgaayzxaawaawbaasqabeaacqghsislcqaixaqmaagccqggsaalaaa@985a@ 

which is used to sample whether ri = true. note that, using  and , we have

 pp=∑ai,bi=1nip⋅qa⋅qb.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdchawnaabmaabagaem4cam3aasbaasqaaiabdmgapbqabagccqgg8bafcqwgsbgudawgaawcbagaemyaakgabeaakiabg2da9iabdsha0jabdkhayjabdwha1jabdwgaljabcycasiabdgeabjabcycasiabdkeacjabcycasggaciab=h7axnaabaaaleaacqaiwaamaeqaaagccagloagaayzkaaaabagaemicaa3aaewaaeaacqwgzbwcdawgaawcbagaemyaakgabeaakiabcyha8jabdkfasnaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemozaymaemyyaemaemibawmaem4camnaemyzaumaeiilawiae8hude3aasbaasqaaiabicdawaqabaaakiaawicacaglpaaaaagaeyypa0zaaabcaeaacqwgwbacdaqadaqaaiabdggahnaabaaaleaacqwgpbqaaeqaaogaeiilawiaemoyai2aasbaasqaaiabdmgapbqabaaakiaawicacaglpaaaasqaaiabdggahnaabaaameaacqwgpbqaaeqaasgaeiilawiaemoyai2aasbaawqaaiabdmgapbqabawccqgh9aqpcqaixaqmaeaacqwgubgbdawgaaadbagaemyaakgabeaaa0gaeyyeiuoakiabgwsixlabdgfarnaabaaaleaacqwgbbqqaeqaaowaamwaaeaacqwghbqydawgaawcbagaemyaakgabeaaaogaay5waiaaw2faaiabgwsixlabdgfarnaabaaaleaacqwgcbgqaeqaaowaamwaaeaacqwgibgydawgaawcbagaemyaakgabeaaaogaay5waiaaw2faaiabc6cauaaa@872c@ 

we define the prior p to be proportional to an indicator function e which is zero unless ai and bi represent a pair of motif positions compatible with the assumptions that the motifs are both within the sequence, do not overlap, and have a distance conforming to the assumed periodicity and the assumed possible variation around this periodicity. as described above, the allowed distance is modeled as a fixed phase φ plus a variable integer multiple of the period t . specifically, given wa, wb, the period t, the phase φ, the allowed deviation from exact periodic distance , the length of sequence i and the minimum and maximum distances, we can for all i =  <dig> .ni find all j such that e =  <dig>  and the value of  can be calculated as

 ∑i=1ni⋅∑j:e=1qb]∑i=1ni∑j=1nie.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawccaqaamaaqahabawaamwaaeaacqwgrbqudawgaawcbagaemyqaeeabeaakmaadmaabagaemyyae2aasbaasqaaiabdmgapbqabaaakiaawufacagldbaacqghfly1daaeqbqaaiabdgfarnaabaaaleaacqwgcbgqaeqaaowaamwaaeaacqwgqbgaaiaawufacagldbaaasqaaiabdqgaqjabcqda6iabdwgaljabcicaoiabdggahnaabaaameaacqwgpbqaaeqaasgaeiilawiaemoaaomaeiykakiaeyypa0jaegymaedabeqdcqghris5aagccaglbbgaayzxaaaaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgubgbdawgaaadbagaemyaakgabeaaa0gaeyyeiuoaaoqaamaaqahabawaaabcaeaacqwglbqzcqggoaakcqwgpbqacqggsaalcqwgqbgacqggpaqkasqaaiabdqgaqjabg2da9iabigdaxaqaaiabd6gaunaabaaameaacqwgpbqaaeqaaaqdcqghris5aawcbagaemyaakmaeyypa0jaegymaedabagaemoba42aasbaawqaaiabdmgapbqabaaaniabgghildaaaogaeiola4caaa@6da4@ 

secondly, we get that p is proportional to

 qa⋅∑k∈eqb,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbqudawgaawcbagaemyqaeeabeaakmaadmaabagaemyyae2aasbaasqaaiabdmgapbqabaaakiaawufacagldbaacqghfly1daaeqbqaaiabdgfarnaabaaaleaacqwgcbgqaeqaaowaamwaaeaacqwgrbwaaiaawufacagldbaaasqaaiabdugarjabgigiolabdwgaljabcicaoiabdmgapjabcycasiabdggahnaabaaameaacqwgpbqaaeqaasgaeiykakcabeqdcqghris5aogaeiilawcaaa@49fd@ 

so if ri = true, a value for ai can be sampled by using probabilities proportional to the numbers . finally, bi can be sampled by noting that given ri = true and a value for ai, the probabilities for valid values of bi according to e are proportional to qb.

the algorithm is initiated by setting all ri = false. the update/sampling procedure described above is then performed for each sequence si, i =  <dig> ..n. when all ri, ai and bi have been updated, the alignment is scored according to

 f=log⁡pp)=∑k=1wa∑lca,klog⁡)+∑k=1wb∑lcb,klog⁡)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqaabeqaaiabdaeagjabg2da9igbcygasjabc+gavjabcegannaalaaabagaemicaa3aaewaaeaacqwgtbwucqgg8bafcqwgbbqqcqggsaalcqwgcbgqcqggsaaliigacqwf4oqcdawgaawcbagaegimaadabeaakiabcycasiabdggahjabcycasiabdkgaijabcycasiabdkfasbgaayjkaiaawmcaaaqaaiabdchawnaabmaabagaem4uamlaeiifawnae8hude3aasbaasqaaiabicdawaqabagccqggsaalcqwgsbgucqgh9aqpcqggoaakcqwgmbgzcqwghbqycqwgsbabcqwgzbwccqwglbqzcqggsaalcqgguaglcqgguaglcqgguaglcqggsaalcqwgmbgzcqwghbqycqwgsbabcqwgzbwccqwglbqzcqggpaqkaiaawicacaglpaaaaaaabagaeyypa0zaaabmaeaadaaeqaqaaiabdogajnaabaaaleaacqwgbbqqcqggsaalcqwgrbwaaeqaaowaamwaaeaacqwgsbabaiaawufacagldbaaasqaaiabdygasbqab0gaeyyeiuoakigbcygasjabc+gavjabceganjabcicaomaalaaabagaemyqae0aasbaasqaaiabdugarbqabagcdawadaqaaiabdygasbgaay5waiaaw2faaaqaaiab=h7axnaabaaaleaacqaiwaamaeqaaogaeiikagiaemibawmaeiykakcaaiabcmcapawcbagaem4aasmaeyypa0jaegymaedabagaem4vac1aasbaawqaaiabdgeabbqabaaaniabgghildgccqghrawkdaaewaqaamaaqababagaem4yam2aasbaasqaaiabdkeacjabcycasiabdugarbqabagcdawadaqaaiabdygasbgaay5waiaaw2faaawcbagaemibawgabeqdcqghris5aogagiibawmaei4ba8maei4zacmaeiikagyaasaaaeaacqwgcbgqdawgaawcbagaem4aasgabeaakmaadmaabagaemibawgacaglbbgaayzxaaaabagae8hude3aasbaasqaaiabicdawaqabagccqggoaakcqwgsbabcqggpaqkaagaeiykakcaleaacqwgrbwacqgh9aqpcqaixaqmaeaacqwgxbwvdawgaaadbagaemoqaieabeaaa0gaeyyeiuoaaaaa@b0c2@ 

we are interested in finding values which maximize p, which approximately corresponds to maximizing f above. having completed a full iteration of the update/sampling procedure, sampling continues at the first sequence. the algorithm stops when the same f has been observed several times in a row or when the maximum number of iterations is reached. to avoid getting stuck in local maxima, the algorithm is restarted several times. it is also systematically restarted with different settings of the phase φ , as this parameter is not updated during each run of the algorithm and therefore has to be determined exhaustively.

to avoid that the algorithm finds "shifted versions" of the actual motifs, a type of shift jump is introduced. each time the score f is improved, possible shifts of the motifs are found, defined by adding or subtracting some integer to all ai and bi. for each of the possible shifts , we calculate f. if a better score is encountered, the positions are updated and used as a starting point for the next update/sampling iteration.

for simplicity, we have described the case where motif pairs are assumed to occur only on the forward strand. our method optionally permits both forward and reverse strands to be searched. in this case, the sampling distribution and the calculation of the posterior probability for r is extended to included both strands. optionally, information about conservation between species can be used to favor placement of motifs in evolutionarily conserved regions. in this case, instead of single sequences, pairwise alignments of orthologous sequences are loaded into the program. gaps are removed from the "base" sequences to ensure that correct distances are maintained. the fraction of conserved bases over windows the same size as the motifs is calculated for each possible motif position. the sampling distributions are then weighted according to this vector. a similar strategy is implemented in  <cit> . the same vector is also used to exclude regions from being searched. this allows the sampler to be restarted after convergence to search for a new set of non-overlapping binding sites.

implementation and user interface
the main algorithm is implemented in matlab while time critical functions are written in the c language. these can be downloaded for local use . helicis is also available through a web interface <cit>  which provides several templates to simplify parameter setup. to make it easier to understand the function of the different parameters, these are visualized using an interactive schematic figure which is updated to reflect the current settings . the web interface is implemented in php and the source files can be made available upon request.

RESULTS
performance vs. motif information content
the performance was evaluated on synthetic sequence datasets. ordered pairs of srf  and ets binding sites, generated from raw transfac  <cit>  weight matrices , were planted into sets of  <dig> random sequences of length  <dig> bp. the choice of matrices was arbitrary, although these factors have been shown to cooperatively regulate certain genes  <cit> . one motif pair was assigned to each sequence and the distance between each pair was set to a uniformly random multiple  of the helical period  plus a  <dig> bp offset. the binding sites were thus both colocalized and periodically spaced. the transfac carg matrix is based on  <dig> occurrences and the central  <dig> bases were used when generating the test sequences . the ets matrix is  <dig> bp long and based on  <dig> occurrences. raw counts were converted into relative frequencies and bases were randomly selected according to this distribution. several sequence sets with increasingly weaker motifs were generated by varying the number of pseudocounts between  <dig> and  <dig>  the information content of the resulting matrices was calculated. evaluation sequence sets are available both as supplementary information  and for download on the helicis homepage  <cit> .

helicis with default settings for periodic spacing , helicis with colocalization settings  and helicis with single motif settings were compared to an established single motif discovery tool based on the em algorithm, meme  <cit> , and a motif discovery tool based on gibbs sampling, bioprospector  <cit> . the latter was run in "two-block" mode, searching for motif pairs with a maximum gap of  <dig> bp. all were configured to search the forward strand only with a fixed motif width of  <dig> bp, and with forced presence of a motif in each sequence . the quality of the resulting alignments was determined by calculating the fraction of correctly identified sites . results shown are average values from five independent trials where the sequence sets were regenerated each time. it should be noted that bioprospector, unlike helicis and meme, cannot be forced to detect exactly one occurrence per sequence, but will often assign several motifs per sequence. this should be taken into account when evaluating the results, as this model may be slightly disadvantageous on this dataset.

the carg motif has high information content and all tested tools performed reasonably well on this motif before pseudocounts were added. however, the sensitivity of helicis with periodic and colocalization settings was still higher, reaching  <dig> % and  <dig> % respectively, as opposed to  <dig> % for meme and bioprospector. as the information content of the motifs was lowered, the ability of the periodic model to make use of the periodicity in the data became obvious and the other methods were outperformed. when the already weak ets motif was obscured by added pseudocounts, helicis in colocalization mode quickly lost its ability to make use of this motif to improve detection of the carg box.

the ets motif was not efficiently detected using any of the single motif methods, and this is where the advantages of the helicis model were most obvious. bioprospector in two-block mode was able to draw some advantage of the proximity to the stronger carg motif and reached  <dig> % sensivity with no added pseudocounts, to be compared with ~ <dig> % for meme and helicis in single motif mode. the corresponding result for helicis in colocalization mode was  <dig> %, and the advantage was even bigger when the information content of the motifs was reduced. on the ets motif, helicis in periodic mode had considerably higher sensitivity than all the other tested methods throughout the series.

performance vs. fraction of sequences containing motifs
in a second evaluation, sets of  <dig> sequences containing artificially planted carg and ets motifs were generated as described above. however, this time the information content of the motif matrices was kept constant . instead, the fraction of sequences containing motifs was gradually reduced from 20/ <dig> to 10/ <dig>  thus making them increasingly difficult to detect. in this case, the tools were not forced to detect motifs in all sequences . other settings were as described above. to account for false positive predictions, a ppv score  was calculated, in addition to sensitivity. the results, shown in figure  <dig>  are average values from  <dig> independent trials.

again, the less informative ets motif benefited considerably from the helicis model, both with periodic and colocalization settings. this motif was only sporadically detected by meme, bioprospector and helicis with single motif settings, while helicis in periodic mode reached  <dig> % sensitivity when 16/ <dig> sequences contained the motifs. when the fraction of motif-containing sequences was high  also the carg motif was detected with higher sensitivity by helicis in periodic mode compared to the other tested tools.

in the most challenging dataset, with motifs in  <dig> out of  <dig> sequences, helicis was not able to detect any motifs. however, both meme and bioprospector could sporadically detect the carg motif with average sensitivity scores of  <dig> % and  <dig> % respectively. meme generally performed well in the ppv plots, reflecting that it was less prone to assigning false positive motifs in non-motif containing sequences. bioprospector does not have the possibility to limit the number of detected two-block motifs to maximum one per sequence. due to a larger number of false positive predictions it therefore scored unfavorably in the ppv plots. it should be noted that its two-block model was occasionally able to detect the difficult ets motif with high sensitivity, however, the average performance was still similar to the single motif methods.

discussion
we have described a novel tool for de novo discovery of regulatory dna motifs, helicis, available for local use and through a web interface <cit> . our method can efficiently detect motif pairs which are spatially colocalized in regulatory dna. it is based on a flexible probabilistic model which optionally allows de novo discovery of motif pairs with periodic spacing . a large number of experimental studies show the importance of helical phasing in regulatory regions. the ability to detect such patterns de novo without prior knowledge of recognition sequences may be useful in the study of coregulated crms.

our results show that helicis is able to efficiently take advantage of the synergistic effects of colocalization to improve sensitivity to weak dna patterns. helicis in colocalization mode was evaluated on planted ets and carg motifs which were colocalized with a spacer of random variable length. the weaker ets motif was detected with far better accuracy compared to other tested methods, and this can be attributed to the ability of our method to make use of the nearby stronger carg motif to improve sensitivity. detection of the carg motif also benefited from the ets-motif, although to a lesser extent. sensitivity was further improved in a drastic way by running helicis in periodic mode. both the carg and the ets motif benefited considerably from this reduction of the search space. importantly, this shows that the method is capable of finding weak periodic patterns which are not readily detected using a "sequential" approach, i.e. first detecting single motifs and second analyzing their spacing properties.

one limitation of our model is that the motifs widths are fixed. some gibbs sampling algorithms handle this using an alternative scoring function and restarts using several widths  <cit>  or the "fragmentation algorithm  <cit> ," while others use a fixed width  <cit> . tf binding sites are usually within the 8– <dig> bp range and we have found results to be quite robust to changes in this parameter as long as the motif width is not set too short. results were nearly identical when helicis was applied to the test sets in this paper using a  <dig> bp motif width instead of the default  <dig> bp .

helicis models the intermotif distance as a variable integer multiple of the period t plus a fixed "phase"  φ =  <dig> ..t- <dig>  the phase is determined exhaustively by restarting the sampler several times, leading execution time to be proportional to the chosen period. a desirable improvement would be to determine the phase during execution of the algorithm rather than to use restarts. if several periods other than the default  <dig> bp are to be evaluated, more restarts are required and the algorithm can become computationally demanding. however, the current implementation normally does not cause problems with sequence sets of reasonable size. with  <dig>  <dig> bp sequences, execution time with the periodic model  is typically around  <dig> minutes on a low-end processor . the execution time in each iteration theoretically scales linearly with the number of sequences, the total amount of sequence data, the motif length and the maximum motif distance. in practice, as long as each individual sequence is not to long , the number of sequences is the most important factor . some parameters in the web interface have been slightly limited to avoid overloading the server, but no such limitations are present in the downloadable version.

CONCLUSIONS
helicis is a flexible and efficient tool for de novo discovery of colocalized dna motif pairs. it incorporates structural features such as ordered or unordered colocalization and periodic spacing. our evaluations show that it can detect weak periodic patterns which cannot be easily discovered by others means. it is available both for local use and through a simple web interface.

availability and requirements
project name: helicis

project home page: 

operating system: platform independent

programming language: matlab, c

license: free for academic and non-profit researchers. contact the authors for commercial licensing.

authors' contributions
the functional specification of the method was prepared by el and pl. the mathematical model and algorithm was designed and implemented by el. the web interface was implemented by el. the manuscript was drafted by el and pm with contributions from pl. all authors read and approved the final manuscript.

supplementary material
additional file 1
matlab and c source files. this archive contains source files and instructions for compilation.

click here for file

 additional file 2
evaluation sequences. this archive contains evaluation sequence datasets and the matlab scripts used for generating them.

click here for file

 acknowledgements
prof. olle nerman is greatly acknowledged for fruitful discussions during the initial part of the project. the work was partly funded by the european commission: the sixth framework programme .
