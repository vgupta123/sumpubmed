BACKGROUND
several publications have suggested the use of cdna-microarrays for clinical diagnosis  <cit> . while today's microarrays can cover up to  <dig>  genes, only a small percentage of them is needed for diagnosis. most diagnostic microarray datasets can achieve optimal classification with no more than 5– <dig> discriminative genes  <cit> . this opens new possibilities for the design of small diagnostic microarrays used for gene expression based diagnosis.

to design such disease specific, small custom arrays differential genes are identified from a large set of potential candidate genes using genome wide expression profiling. then, only these differential genes are put onto a small custom microarray  <cit> . throughout this paper, we refer to diagnostic microarrays as small, custom microarrays for diagnostic purpose holding only few genes and large microarrays as genomewide gene expression microarrays, holding tens of thousands of genes.

with the concept of diagnostic microarrays new problems arise. a first important step in microarray analysis is normalization. the overall intensity of microarrays can vary in a large dataset. this can reflect global differential gene expression, but it is more likely due to experimental artifacts. consequently, array-to-array normalization is crucial for microarray analysis  <cit> . various methods for normalization have been suggested. one approach is to determine a set of invariant genes for normalization  <cit> . another approach recommends to replicate genes on the array and use this within-array replication for normalization  <cit> .

standard normalization protocols rely on the assumption that the majority of genes on the microarray are not differentially expressed between samples  <cit> . for large microarrays this is likely to be true, but on a diagnostic microarray the genes are selected to be differentially expressed between disease entities. consequently, for these diagnostic microarrays a fundamental assumption of microarray normalization does not hold. this has negative effects on the quality of gene expression measurements. assume that a diagnostic signature consists of  <dig> genes, all of them higher expressed in disease type a than in type b. since there are also scale differences due to experimental artifacts, the microarrays need to be normalized. normalizing them to constant average expression also eliminates the biological differences between a and b. the dilemma is that global differences can be either artifacts or the manifestation of molecular difference between the disease types. diagnostic microarrays need to be designed in a way that allows for the discrimination of these two different effects.

one way to address this problem is to include additional genes on the microarray that are exclusively used for normalization. typically, one uses housekeeping genes, which are thought to be expressed at a constant level. however, it has been found that housekeeping genes are occasionally regulated, too  <cit> .

therefore, we suggest a data driven approach to select normalization genes from the pool of all genes on the microarray. not only the diagnostic signature should be derived from the analysis of a large microarray study but we suggest that this data is also used for finding normalization genes. these are then used for normalizing the diagnostic microarrays. note that there is a conceptual difference between choosing an invariant set of genes from the data you want to normalize  <cit> , and selecting genes from one dataset  for the purpose of normalizing a second dataset . in the first scenario the variance of genes does not need to generalize to new data. in the second scenario it does.

here we address the problem of selecting normalization genes from a genome wide expression study for the purpose of designing diagnostic arrays. the goal is that the diagnostic array can then be normalized without problems. we compare two simple strategies in the context of simulation experiments as well as in real world applications. the first strategy aims to find control genes that are not influenced by the disease type and can therefore be used for normalization. the second strategy aims to find genes that complement the discriminatory genes on the diagnostic microarray in a way such that a normalization function on all genes together is not any more influenced by the diseases type. we call this novel concept balanced signatures.

the paper is organized as follows: first we demonstrate the problems occurring when standard normalization protocols are used for diagnostic microarrays. in the "methods" section we discuss alternative strategies for normalization gene selection and the concept of balanced signatures. in the "results and discussion" section we compare our methods in the setting of a controlled simulation experiment. in the "results on lung cancer and leukemia studies" section we show normalization performance on a dataset from a clinical study on leukemia and on a dataset from a clinical study on lung cancer. we close with a summary and a discussion of our findings.

RESULTS
simulated data
the two normalization methods for diagnostic microarrays described in the "methods" section need to be evaluated with respect to their power in compensating the global signal normalization effect and producing diagnostic arrays that distinguish well between two disease entities. before we evaluate our methods on real data in the next section we make use of the more transparent setting of a simulation study, in which the population differences, the biological variability among individuals and the experimental variability are modeled independently of each other.

simulated data was generated according to a multivariate normal distribution, including strong correlation of genes, a large spectrum of expression intensities and non constant expression differences between the two groups a and b.

in total we simulated expression values for  <dig> genes on  <dig> microarrays representing two groups a and b of  <dig> microarrays each. we first generated the covariance matrix Σ by randomly drawing from an inverse wishart distribution with  <dig> degrees of freedom and a  <dig> ×  <dig> identity matrix as a scale matrix. then, we generated a vector of  <dig> population means for each gene i = { <dig> ..., 3000} in each group a and b, μia
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf8oqbdaqhaawcbagaemyaakgabagaemyqaeeaaaaa@30fc@, μib
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf8oqbdaqhaawcbagaemyaakgabagaemoqaieaaaaa@30fe@ by randomly drawing from a n  normal distribution for each gene and group. the actual expression data was generated by drawing from a multivariate normal distribution with covariance matrix Σ and means μa for the first  <dig> microarrays and μb for the next  <dig> microarrays. finally, this data was perturbed by multiplying with a random scaling factor and adding a random offset both drawn from a n log-normal distribution. the generation of this data was done twice. once for a training set and once for a test set.

in this simulation with three successive randomization steps the first step of generating μa, μb and Σ corresponds to the population properties of the genes. the second step of drawing from a multivariate n distribution accounts for biological variability among individuals, while the third step of perturbing the data accounts for global experimental artifacts. the observed differences Δi display the typical continuous spectrum known from real expression data .

as we have stressed before, the expression patterns of the normalization genes need to generalize from the training set where they were found to new data in the same way as the signature patterns do. from the theoretical considerations of the "methods" section it becomes clear that small variance genes have the potential to compensate for the global signal normalization effect. but the genes need to have small variances not only on the training data but also and more importantly on the data that is generated using the diagnostic array. in general, this variance will be higher than it is on the training data. the same problem occurs for genes with small average expression differences and balanced signatures. to this end, we simulated a training and a test set with  <dig> samples. both sets have the same underlying gene means and covariance structure. to avoid overfitting, only the training data was used to select the normalization genes and only the test set was used to evaluate the normalization strategies. the diagnostic signature consists of ps =  <dig> genes with the largest difference of population means. it is unbalanced. for the purpose of normalization pn =  <dig> additional genes were picked according to the suggested methods.

using the standard normalization protocol destroys the signal completely, while using random normalization genes already recovers the signal partially . however, both versions, data based selection of normalization genes and balanced signatures, recover population differences more accurately and perform similarly to each other .

we repeated the data simulation  <dig> times and recorded for each simulation the distance between the real underlying expression differences of the signature genes and the expression differences obtained by the various normalization methods. this sum of squared error plot shows that all methods achieve significantly better normalization results compared to the standard method . the balanced signatures also perform better than the other proposed methods . in the case of "small effect normalization", "small cv", and "random" this difference is significant , while in the case of "variance normalization" significance on the  <dig>  level was not achieved .

two exemplary clinical studies
we now proceed from a simulation study to applications on real datasets. of course, in real datasets we do not know how many genes are deregulated and how many are necessary for achieving optimal classification accuracy. therefore, we ran the mcrestimate package  <cit> , that uses a nested cross validation loop to avoid biased estimators of classification performance. our own results analyzing various datasets with mcrestimate showed that most datasets can be classified optimally with a handful of genes and only very few need more than  <dig> . this is in concordance with findings from other authors  <cit> . when applying it to the leukemia study  <cit> , described in the "methods" section, we found that in this case ps =  <dig> genes reached the optimal classification accuracy of 99%. thus, we selected ps =  <dig> signature genes with the highest absolute equal variance t-score. in addition, pn =  <dig> normalization genes were determined according to the criteria from the "methods" section. for simplicity, the number pn of additional genes for normalization was set to ps. in preliminary studies this provided good results but further research on determining the optimal ps and pn simultaneously is needed.

the second dataset we analyzed was a study on  <dig> primary lung adenocarcinoma and  <dig> normal lung tissues  <cit> . here, we aimed for a classification of normal versus carcinoma. mcrestimate achieved 100% accuracy using  <dig> genes. thus, we selected ps = pn =  <dig> for this dataset.

we randomly split the whole datasets equally into a training and test set. for the training set we applied the gold standard normalization using all genes of the large microarray. then, we proceeded in the same way as described in the "methods" section. both, signature and normalization genes were derived using only the training data. for each sample in the test set a diagnostic microarray was constructed using only the raw data of the signature and the normalization genes. this diagnostic microarray was normalized using the procedure described in the "methods" section, resulting in seven different test datasets: standard protocol, affymetrix housekeeping genes, random normalization genes, low variances, small coefficient of variation, small differences and balanced signatures. on the such normalized test set we evaluated the normalization methods with respect to the diagnostic performance of a support vector machine using cross validation. for this, we used the svm from the package e <dig> in r  <cit>  with a linear kernel and default parameters. the dataset was randomly split in equally sized training and test sets. this was repeated  <dig> times and the evaluation steps were rerun for every data partitioning.

the standard protocol reduces the classification accuracy substantially, while both normalization gene selection and balanced signatures yield satisfying results. affymetrix housekeeping genes for normalization work well on the leukemia dataset, but fail on the lung dataset. balanced signatures provide the best results in both datasets.

for the leukemia dataset classification accuracy was significantly better for all our methods as compared to the standard protocol . "balanced normalization" outperformed all other normalizations , too. standard normalization was also clearly inferior in the lung dataset . when further testing "balanced normalization" against other normalizations p-values were below  <dig>  for all but "small effect normalization" and "random normalization", where significance was not reached .

CONCLUSIONS
in this paper we showed that using a standard normalization protocol from large microarrays has fatal effects. they are most pronounced when the diagnostic signature is unbalanced, containing more up- than down-regulated genes or vice versa. however, in most microarray datasets there are more significantly up- than down-regulated genes or vice versa, emphasizing the need for new normalization strategies. here, we introduced two strategies to overcome this problem: normalization gene selection and balanced signatures. both gave better results for diagnostic microarrays than the standard normalization protocol. using affymetrix housekeeping genes performs well in the analyzed leukemia dataset but does not work for the lung dataset, indicating that these genes are actively regulated in these tissues.

as standard normalization protocol we have chosen the rma procedure. of course it is not the only protocol in use. however, the global signal normalization effect is generic and not restricted to this protocol. any normalization which assumes unchanged expression for the majority of genes on the microarray is expected to suffer from the same problem. an advantage of both our methods is that the normalization genes can be selected with no additional experimental cost and little computational effort.

in recent publications it was shown that the list of differentially expressed genes are unstable and the overlap of gene lists from different analysis is small  <cit> . however, for diagnosis one is not aiming at finding a unique set of signature genes, but a unique diagnosis of future patients. there are many datasets containing man different sets of genes, which all lead to the same diagnosis. for the purpose of designing diagnostic arrays it is sufficient to find one such set.

hua et al. stressed that optimal feature size depends strongly on the classifier and feature-label distribution and that a choice of optimal feature size can greatly improve accuracy of the classification  <cit> . hence, for assessing how many genes should be used for a diagnostic microarray we used a nested cross validation for svms  <cit> . by this, we determined the number of genes making up the diagnostic signature  and set it to the number of genes needed for achieving the optimal classification accuracy.

in conclusion, balanced signatures perform well with respect to recovering the real underlying signal as well as for classification. this was verified on a simulated test dataset as well as on two real microarray datasets. their main advantage is that no space on the diagnostic microarray is wasted and all genes can be integrated in the diagnostic signature.

