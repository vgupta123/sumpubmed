BACKGROUND
microarrays have become the predominant method for studying gene expression on a genomic scale. it has been recognised, however, that probes interrogating different regions of the same mrna target show considerable variation in signal intensities  <cit> , and that the observed intensity variation is highly sequence-dependent  <cit> . this is expected because different probes vary in their tendency of forming intraand intermolecular structures that compete with the hybridization of the probe-target duplex, resulting in different hybridization efficiencies  <cit> . comparative studies have indicated that accurate thermodynamic models based on the physico-chemical parameters underlying probe-target interactions are particularly good predictors of actual probe binding behaviour and thus microarray signal intensity  <cit> . this is not only important in the design of new arrays, where specific and uniform probes need to be selected  <cit> , but also for the readout of data from established platforms, where a better comparability of signals from different genes improves quantitative modelling and the sensitive detection of subtle higher-dimensional patterns. when the effective hybridization temperature is not known, the probe-target melting temperature tm is often calculated to predict the expected thermodynamic stability of the hybridized complex  <cit> . the melting temperature is still one of the most popular measures in the evaluation of microarray probes. it gives the temperature at which half of all probes form a duplex with their target while the other half are unbound, assuming a simple two state transition, thus providing information about the probe binding behaviour at the melting temperature. it makes, however, no statement about the binding affinity at the actual hybridization temperature. probe-target dimers with the same tm can actually behave quite differently at typical reaction temperatures, which are usually considerably lower than the tm  <cit> . increasingly, general thermodynamic models of probe-target hybridization have become established in the prediction of microarray probe behaviour. these models are either based on published thermodynamic rules for nearest-neighbour base-pairing and experimentally determined parameters, or they determine model parameters from fits of the observed probe intensities  <cit> . the free energy of probe-target hybridization can so be calculated for the effective hybridization temperature.

none of the above approaches yet considers that nucleic acid sequences can form stable intramolecular structures that compete with the formation of the probe-target duplex: only freely accessible, i. e., monomeric and unfolded probe and target molecules can interact to form probe-target dimers  <cit> . more elaborate models therefore include the effects of the secondary structures of the probe  <cit>  and the target  <cit>  on the overall binding efficiency. another factor that reduces the efficiency of probe-target hybridization is the formation of probe-probe dimers  <cit> .

wei et al.  <cit>  recently examined to what degree several probe properties affect microarray signal intensities. in this work we extend this analysis by additionally determining the influence of target secondary structure, the free energy of probe-target hybridization, and the strength of probe-probe dimerization on the overall efficiency of probe-target binding on microarrays. we used a partition function approach to capture the full dynamic potential of the different inter- and intramolecular interactions  <cit> . although the stability of the probe-target duplex alone is a good first indicator of hybridization behaviour, we will show that the signal variation observed in the examined data sets can be better explained by the effective interaction energy. the effective interaction energy, which is the free energy of probe-target hybridization reduced by the free energies of probe and target secondary structures and the probe-probe duplex formation, can predict probe dependent signal intensity variation twice as well as the melting temperature tm. considering a complementary tiling array study  <cit> , we can moreover show that the higher predictive power of the effective interaction energy is independent of the typical probe length and the type of target nucleic acid  in an experiment.

methods
microarray data
we studied the sequence-dependent intensity variations for two different tiling array experiments. the first one features sets of probes targeting different regions of the same transcripts . it comprises nine tiling arrays with a resolution of  <dig> nt, each containing about  <dig>  probes interrogating the expression of  <dig>  regions throughout the genome. probe length ranged from  <dig> to  <dig> bases. chips had been manufactured with  <dig> nt thymidine linkers and had been hybridized to cdnas from undifferentiated human embryonic stem cells  by nimblegen systems  <cit> . raw expression data had been extracted using nimblescan software v <dig> . after qspline normalization, a non-linear method for controlling signal-dependent sources of variability  <cit> , data were median centred using control set probe intensities. for comparability to the original study, our analysis is based on the same preprocessed data. probe targets were identified by wu-blast  run against ucsc 'known genes' annotation  <cit>  . to efficiently identify perfect matches, wu-blast parameters were set as follows: seed alignment word size w = probe length, match score m =  <dig>  mismatch score n = - <dig>  gap penalty q =  <dig> and gap extension penalty r =  <dig>  as expected for a tiling array, many probes had no cdna target , and about half the matches were on the reverse strand. for simplicity and to avoid confounding effects, we have focussed on probes complementing the sense strand and without matches to multiple genes. for simplicity, we only included probes that showed no cross-hybridization to any mrna in the ucsc 'known genes' annotation  <cit>  in our analysis.

the second experiment used 25-mer oligonucleotides for perfectly matching  <dig> nt tiling probes of ribosomal rna  sequences from nine nematodes  <cit> . the rrna targets were generated by in vitro transcription. each rrna target was separately hybridized to the specific compartment on the 12-well nimblegen array, i. e., no interference between targets was possible. we analyse the fluorescence intensities of the probes perfectly matching the single hybridized target, giving purely specific signals with no cross-hybridization. in the hybridization reactions, an rrna concentration of  <dig> ng was used for each target  <cit> .

calculation of thermodynamic parameters and model choice
melting temperature
following the approach of wei et al.  <cit> , melting temperatures were computed by the santalucia et al.  <cit>  method, and included a helix-initiation factor and corrections for sodium ion and formamide concentrations  <cit> :  

where  =  <dig>  m is the sodium ion concentration in molar units, a is a helix initiation factor equal to - <dig>  cal/, ct the molecular concentration of the oligonucleotide strands in molar units, f the correction term for formamide, namely  <dig> °c per 1% formamide. the universal gas constant r =  <dig>  cal/. wei et al.  <cit>  estimated the oligonucleotide concentration to ct =  <dig>  * 10-17m and used a formamide concentration of 35% for hybridization . since we were interested in the sensitivity of our study to tm calculation variations, we also computed the tm for different settings of molecular concentration ct, and with or without formamide and sodium correction terms.

probe secondary structure
to facilitate a comparison of results with the original study  <cit> , the minimal free energy  of the secondary structure of the probe molecule was computed by hybrid-ss-min  <cit> , with the nucleic acid type  set to 'dna'.

multi-state thermodynamic model
many established thermodynamic models use the free energy of the most stable predicted secondary structure, i. e., the minimal free energy  structure  <cit> . the hybridization of nucleic acid molecules, however, is dynamic and each molecule exists in an ensemble of structures  <cit> . an accurate prediction of nucleotide behaviour can therefore be achieved with a partition function approach  <cit>  established in the field of statistical mechanics. for thermodynamic prediction of probe-target interaction we thus used rnaup  <cit> . rnaup calculates free energies applying the full partition function over possible inter- and intramolecular structures of a probe and its target. rnaup calculations employed the energy parameters for dna folding as distributed with d. mathews' rnastructure  <cit>  in the calculation of thermodynamic models for the data set of wei et al.  <cit> . for the data set of pozhitkov et al.  <cit>  we used the default rna folding parameters in the calculation of secondary structures of the rrna target and the dna folding parameters as distributed with d. mathews' rnastructure in the calculation of secondary structures of the dna probe and for the assessment of probe-probe dimers. in calculating the probe-target binding energy we used the rna-dna folding parameters from sugimoto et al.  <cit> . rnaup models the interaction between a probe and its target as a stepwise process. the first step of the calculation computes the free energies Δgp and Δgt that are needed to unfold the secondary structures of the probe and its binding site in the target, respectively. then the binding energy Δgh gained by hybridization of the probe to its target is calculated. the total binding energy is then given by Δgh-Δgp-Δgt. in addition we consider the free energy Δgpp, that is necessary to unfold probe-probe dimers within the same probe feature, and compute it in an independent step using rnaup. the effective interaction energy Δg is finally given by subtracting the free energies needed to open secondary structures and unfold probe dimers from the binding free energy:   

here Δgh, Δgp, Δgt, and Δgpp are always ≤  <dig>  for unstable structures, their respective contributions were zero. the final effective interaction energy Δg was stable  for all considered probe-target pairs.

target secondary structure
the probe binding site area in the target may form structural motifs with bases some distance from the probe binding site. to calculate the free energy Δgt of unfolding structures in the target we therefore consider a target fragment including the probe binding site plus parts of the flanking sequence. koehler et al.  <cit>  showed that 90% of base pairs are formed between nucleotides less than  <dig> bases apart in the primary sequence. they suggest that over 90% of the predicted structures of the full length target can be found by using a target fragment consisting of the probe binding site flanked by  <dig> bases on either side. we can thus safely use a target fragment including flanking regions of  <dig> bases on either side of the probe binding region for the calculation of the free energy Δgt that is required to unfold the probe binding site in the target.

importance ranking of thermodynamic parameters
wei et al.  <cit>  used the guide algorithm  <cit>  to rank the thermodynamic parameters in order of their importance for predicting signal intensity. guide constructs a non-linear model fit by finding an optimal partitioning of the data together with piecewise least-square regression models on each data subset, forming a so-called regression-tree. variables for the split-condition of a tree-node are selected by unbiased detection of pairwise interactions and curvature, where the split points are found by exhaustive search. over-partitioning/over-fitting of the data is avoided by limiting the size of the final regression tree by cost-complexity pruning in cross-validation, selecting the smallest tree with a mean prediction error within one standard error of the minimal prediction error achieved. the algorithm also provides importance scores, which reflect the contribution a predictor variable makes to the non-linear model. for each split-node and variable in the regression-tree, it is computed from the chi-square statistic of the interaction/curvature detection step for the underlying piecewise-constant regression model, and then weighted by the square-root of the data subset size at the split-node. the overall importance score of a predictor is obtained by summing over all split-nodes of the tree . software and further bibliography are available from http://www.stat.wisc.edu/~loh/guide.html. for direct comparability to earlier work, we also employ guide in this study. bootstrapping was used to study the robustness of relative importance and obtain error estimates for guide results: for the whole dataset of about  <dig> million probes,  <dig> random subsets of  <dig>  probes each were sampled with replacement from the original data. for the smaller subsets examined ,  <dig> random subsets were generated, each containing 90% of all probes in the respective dataset. for the guide scores separately obtained from each of the  <dig> random subsets, means and standard deviations were computed, which were finally scaled by the mean for the most important parameter to give the relative importance scores. the analysis was repeated both on the raw fluorescence intensities and on the log-intensities .

RESULTS
 <dig>  thermodynamics of microarray hybridization
we used tiling microarray data from wei et al.  <cit>  to study the influence of inter- and intramolecular structures on the efficiency of probe-target duplex formation. for this purpose, tiling arrays have the advantage that probes have been selected only by the tile start position but no probe selection to optimize hybridization efficiency or uniformity has been applied  <cit> . one therefore has a set of probes with a highly varying potential for intra- and intermolecular structure formation, which results in different binding efficiencies and thus microarray hybridization signals for the same transcript target, allowing a systematic investigation of probe specific effects.

our analysis followed the methodology of wei et al.  <cit>  yet newly introduces target-side analysis. in addition, we consider an accurate representation of the free energy of probe-target dimerization and introduce an extended model for microarray hybridization that includes probe dimerization. our approach assesses the influence of inter- and intramolecular structures that compete with probe-target duplex formation in the hybridization process. we subsequently analyse the relative contributions of the competing structures and the probe-target duplex binding strength on the measured signal intensities.

thermodynamics of non-specific hybridization
as a first step we aimed to reproduce the results of the original study and thus calculated the melting temperature tm and the minimal free energy  of probe secondary structure for each probe. we determined the relative importances of tm, the mfe of probe structure, and the probe length for the prediction of probe signal intensities according to the guide algorithm  <cit> , validated by bootstrap. the importance ranking for tm, mfe, and probe length  were in agreement with the original results of wei et al.  <cit> : for the whole dataset, tm was the best predictor of intensity variation, followed by the mfe of probe secondary structure. probe length was the least relevant parameter.

the probes in this dataset are tiling probes designed to interrogate the entire human genome. in a hybridization to cdnas, the majority  of these tiling probes do not have a transcript target. these probes reflect non-specific hybridization and they dominate the dataset. the obtained importance ranking actually did not change when only considering probes with non-specific hybridization . we therefore observe that the melting temperature tm is the best predictor of non-specific hybridization signal. 

thermodynamics of specific hybridization
consequently, it is interesting to focus on the subset of probes that target expressed genes for a complementary examination of predominantly specific hybridization signals. for this purpose, probes were selected that matched the plus strand of single genes from the ucsc 'known genes' annotation  <cit> . for the identification of clearly expressed genes, we employed a conservative strategy of keeping only targets having at least one probe with a signal higher than the mean intensity of probes targeting transcripts. 

by these criteria, we found  <dig>  clearly expressed transcripts, interrogated by  <dig>  probes, with an average of  <dig> probes per target. the intensity of probes targeting the same transcript can vary up to 300-fold, as shown in fig. 2: probe specific intensity variation was assayed as the log2-ratio of the maximal and the minimal probe intensities for each transcript. averaged over all  <dig>  transcripts, we observed a typical 18-fold max/min probe intensity variation .

considering probes for known targets now also allows an introduction of target-side modelling. for simplicity, we further focus on probes with no cross-hybridization potential . in our extended model we relate the observed binding efficiency to an effective interaction energy Δg. this is obtained by subtracting the free energies of inter- and intramolecular interactions that interfere with the formation of probe-target dimers from the free energy gained by probe-target dimer hybridization Δgh:   

where Δgp is the free energy of the probe secondary structure, Δgt the free energy of the probe binding site secondary structure in the target, and Δgpp the free energy of probe-probe dimerization within the same probe feature. for most probes and targets considered, stable alternative structures were observed , highlighting the importance of considering the effects of this competition for the binding of the probe.

the importance of alternative thermodynamic properties in a prediction of probe signal intensity according to the guide algorithm was validated by bootstrap as before. fig.  <dig> shows that the effective interaction energy Δg is by far the best predictor of signal intensity for specific hybridization, with about twice the relative importance score compared to alternative predictors like the melting temperature tm . in order to test the generic nature of this result, we also examined a complementary tiling array experiment  <cit>  that probes several ribosomal rnas  with  <dig> nt oligonucleotides. besides providing a test case with much shorter probes and a different target type , hybridization conditions were simpler in this experiment, featuring uniform target concentrations and no complex background . table  <dig> compares the two data sets. also in this very different experiment, the effective interaction energy Δg was the best predictor of signal intensity, clearly outperforming alternative predictors like tm .

a we analysed the probes perfectly matching the respective separately hybridized individual targets, ensuring no crosshybridization effects.

b we focused on probes targeting clearly expressed transcripts and showing no cross-hybridization in our analysis.

caption: this table summarizes the characteristic differences between the two datasets studied. the dataset of pozhitkov et al.  <cit>  comprises tiling probes targeting  <dig> rrna fragments. the dataset of wei et al.  <cit>  consists of tiling probes designed for high-resolution interrogation of the entire human genome. the row 'probes' shows the nucleic acid type of probes, row 'target' the nucleic acid type of targets.

the relative importance of the other predictors is most cleanly examined in a separate ranking run. the rank orders obtained for the two data sets was again very similar. although the order of Δgh and Δgt was switched, their relative important scores were separated by less than one standard deviation. we could thus conclude that Δgp, Δgh, and Δgt were all of similar importance, whereas Δgpp was considerably less influential . even though Δgpp, the free energy of probe-probe dimerization, was by itself the least descriptive parameter, its inclusion in Δg improved results by a further 10% . the similar relevance of competing intramolecular structures can be understood by considering the extreme observed variabilities of their contributions for probes of comparable Δg. table  <dig> shows the variation of the free energies of these structures for probes with typical effective interaction energies Δg ±  <dig> kcal/mol. even for probes of very uniform Δg, which was shown to be a good predictor of probe signals, the variations observed for Δgh, Δgp, and Δgt nearly match the ranges seen across all the probes for clearly expressed genes.

caption: variation of thermodynamic properties for probes of similar effective interaction energies or similar probe-target duplex binding strengths. probes similar in certain thermodynamic properties were selected from an interval of ±  <dig> of the median values of Δg , Δgh , and tm . intervals are printed in bold face. these intervals contained  <dig>   <dig> and  <dig> probe-target pairs, respectively. the last column, labelled 'all probes', shows the variation range for all probes matching clearly expressed genes. less than 2% of all probes had unstable probe-probe interactions.

in summary, the consideration of multiple inter- and intramolecular structures that compete with the formation of a probe-target duplex improves the prediction of probe signal intensity significantly, reflecting particularly the importance of probe and target accessibility for microarray hybridization.

influence of steric effects and probe synthesis yield
microarray probes are attached to the chip surface with one end, the other end protrudes into solution. this causes different reaction conditions for the two ends of a probe. in high-density microarrays the surface-attached end is less accessible than the end in solution due to steric restrictions caused by the substrate  <cit>  and crowding effects due to neighbouring probes  <cit> . therefore the end of the probe that protrudes into solution plays a larger role in hybridization than the surface-tethered end  <cit> .

to study these effects using our extended model, we removed the terminal  <dig>   <dig>  or  <dig> nucleotides from both ends of the probe sequence and reran the analysis with the shortened probes. fig.  <dig> shows the comparison of the effective interaction energies of the shortened probes to Δg of the full-length probes. while a removal of  <dig> and  <dig> bases at the surface end reduces the predictive power of Δg, the effective interaction energy of probes shortened by  <dig> nt at the surface tethered end is as good as Δg of the full length probes. this suggests that the  <dig> nt closest to the surface have only a marginal contribution to the effective interaction energy.

the influence of the terminal bases at the solution end can be limited by the synthesis yield. nimblegen's mask-less array synthesis technology has an average stepwise yield between 96% and 98%  <cit> . the probes in this study had a length range of  <dig> -  <dig> nt. even for a coupling efficiency of 98%, less than 30% of 60-mer probes reach full length  <cit> . nevertheless, we find that the effective interaction energies of probes shortened at the solution end were significantly less predictive than the values for full-length probes, even if only  <dig> nt were removed . these results are in agreement with the observations of wei et al.  <cit>  that protruding ends contribute more to signal intensity than tethered ends, confirming the dominance of steric effects over limitations from synthesis yield for this platform.

discussion
although dna microarrays have become the predominant method for gene expression profiling, the quantitative understanding of the measurement process still constitutes an active field of research. it is recognised that probe signal variation is highly probe-sequence dependent  <cit> . a recent study  <cit>  has thoroughly examined the effect of different probe properties on probe signal intensities. we have extended this work by introducing target side modelling, an accurate representation of the free energy of probe-target dimerization and an improved model for microarray hybridization that includes probe dimerization. we separately considered specific and unspecific hybridization modes.

reproducing results of wei et al.  <cit> , we obtained the melting temperature tm as the best predictor of probe signal intensity for the employed tiling array . most tiling probes hit non-exonic regions, with only 10% of the probes targeting mature mrnas. most probes therefore showed non-specific hybridization, and these dominated the dataset. indeed, working with all array probes or restricting analysis to the non-specific probes gave the same results . we thus observe that tm is the best predictor of non-specific probe signals.

in contrast, focussing on clearly expressed genes, we could show that the effective interaction energy Δg was the best predictor for specific probe signal intensity . here, we computed Δg by also considering inter- and intramolecular structures that interfere with probe-target binding, cf. eq. . this improved the prediction of signal intensity considerably, with Δg performing about twice as well as tm. probe and target secondary structure gave a similar performance for signal intensity prediction as the free energy of the probe-target duplex Δgh or the melting temperature tm . the large impact of probe secondary structure can be understood by considering how secondary structure affects probe-target binding efficiency: hybridization between two nucleic acids starts with the nucleation of a few perfectly matched bases, followed by a comparatively fast zipping reaction  <cit> . nucleation can actually be the rate limiting step for hybridization  <cit> . probe secondary structure reduces the number of available nucleation sites because bound bases cannot take part in a nucleation reaction  <cit> . moreover, probes with secondary structure fold back on themselves, with the solution ends of the probes brought into closer proximity to the microarray surface. steric effects close to the array surface are another considerable factor determining probe accessibility. all these effects reduce hybridization efficiency and thus probe signal and may explain the importance of probe secondary structure for probe signal intensity prediction. the large variation of Δgt and its strong influence on probe signal, on the other hand, can be understood by considering that bases outside the binding site can also contribute to structures interfering with probe binding, which results in an overall larger number of potentially stable relevant secondary structures in the target. finally, while the incorporation of probe and target secondary structures into an effective interaction energy, eq. , made the biggest contributions to better model performance, the consideration of probe-probe interactions also improved prediction power by a further 10%.

besides their relevance for the design of new arrays, our results have demonstrated the value of improving thermodynamic models for the read-out and interpretation of microarray signals. necessary next steps in the development of improved models include both the incorporation of intermolecular target-target interactions as well as of 'cross-hybridization' effects to unintentionally matching non-target molecules in a complex sample background. target-target interactions on one hand are particularly challenging because they involve multimers of a probe, its bound target, and another sequence that binds to the target. this other sequence can thus contribute to the measured signal intensity  <cit> . more accurate models of interactions with target sequences will also have to consider the respective target fragmentation and labelling steps of microarray protocols. models of cross-hybridization on the other hand need to address two tasks: identifying potential non-targets unintentionally matching the probe, and modelling their influence on the hybridization signal. established probe design tools already filter out non-specific probes through cross-hybridization prediction after efficient sequence-similarity based detection screens  <cit> ; similar to the filtering employed in this study. latest advances now promise sufficiently fast and more sensitive detection tools based on thermodynamic models  <cit> . while recent developments have shown how the competitive formation of probe and target secondary structures as well as probe-probe and target-target dimers affect the probability of finding the desired probe-target duplex  <cit> , these calculations still require several hours of computation time per probe-target pair, precluding their large-scale application. in approximation, the free energy contributions of competing structures can be obtained separately and effective interaction energies can be calculated  <cit> , as in eq. . a similar approach could also be taken to quantitatively consider cross-hybridization effects, as implemented in state-of-the-art probe design tools  <cit> . for this, special validation experiments that allow a separation of specific signals and cross-hybridization effects will be valuable. the results of our current study suggest that the establishment and validation of more sophisticated models can in the near future provide further improvements to our understanding and ability to quantitatively predict microarray hybridization signals in a complex sample background.

CONCLUSIONS
we have introduced an improved thermodynamic model for probe-specific signal intensity on microarrays. the hybridization efficiency between a probe and its targets is determined by the balance of the binding strength of the probe-target duplex on one hand and the competing formation of probe-probe dimers and secondary structures in either probes or targets on the other hand. consequently, the effective interaction energy between a probe and its target is modelled as the free energy gained by probe-target duplex formation reduced by the free energies needed to open alternative structures competing with probe-target binding. for specific hybridization, the effective interaction energy is a twice as powerful predictor of signal intensity variation as the melting temperature tm. we furthermore analysed the effects of the alternative competing structures in relation to probe-target binding strength, which highlighted the strong influence of intramolecular structures on specific hybridization signals. in summary, the improved model introduced here considerably enhances our ability to predict and understand sequence-specific variation of microarray signal intensities.

authors contributions
um performed the thermodynamic calculations and statistical analyses, and wrote the manuscript draft. ggl performed the sequence analyses for the identification of probe targets. ap supported um in the statistical analyses. ih supervised the thermodynamic modelling work. um and dpk were jointly responsible for the conception and design of the study. dpk supervised the statistical analysis. all authors closely collaborated in writing the final manuscript.

supplementary material
additional file 1
robustness of conclusions under scale transformation. fig. a. <dig> shows the importance ranking for thermodynamic properties of probes without cross-hybridization against known targets on different intensity scales .

click here for file

 additional file 2
dominance of non-specific probes on the chip. fig. a. <dig> shows the importance ranking of tm, the mfe of probe structure, and probe length for all probes that had no target in a mature mrna.

click here for file

 additional file 3
effect of intensity threshold. fig. a. <dig> shows the importance ranking for thermodynamic properties of probes without cross-hybridization against known targets with different signal intensity thresholds.

click here for file

 additional file 4
comparison of results with and without cross-hybridization. fig. a. <dig> shows the importance ranking for thermodynamic properties with and without cross-hybridization.

click here for file

 additional file 5
stability of probe and target structures. table a. <dig> shows basic features that differ in the two datasets, including the stability of probe and target structures.

click here for file

 additional file 6
influence of probe-probe dimers. fig. a. <dig> shows the relative importance of probe-probe dimerization for the prediction of signal intensities.

click here for file

 acknowledgements
the authors gratefully acknowledge helpful discussions with peter sykacek and ron stewart. this work was supported by the city of vienna ; the vienna science and technology fund , baxter ag, austrian research centres seibersdorf, and the austrian centre of biopharmaceutical technology ; and the austrian research promotion agency .
