BACKGROUND
in recent years there has been increasing emphasis on the use of digital data to characterise strains of bacterial species. multiple single nucleotide polymorphisms and multiple variable number tandem repeats have been used for digital strain characterisation of species that genetically are highly uniform  <cit>  and multilocus sequence typing  has been used widely for more variable species  <cit> . in mlst, the relatedness among strains is typically displayed as a dendrogram, based on differences in allelic profiles, which identifies clusters of similar strains but provides no information on ancestry and patterns of descent among the strains within the clusters. the sequences of the mlst loci can also be used to explore relationships among strains but recombination occurs frequently in many bacterial species and impacts on the ability of sequence data to discern the true relationships among strains  <cit> . consequently, new methods to explore recent evolutionary history that are less subject to distortions introduced by recombination have been developed.

one popular method, eburst, was designed for the analysis of mlst data, although it can be used with other types of digital data  <cit> . eburst incorporates a simple model of bacterial evolution in which strains increasing in frequency  diversify to form clusters of similar genotypes descended from the founding strain. in terms of mlst, isolates of an expanding founding strain  initially have the same allelic profile, but diversification results in the appearance of variants in which one of the mlst loci has changed , either as the result of mutation or recombination. further diversification generates double locus variants  and then triple locus variants  of the founding st, to result in a cluster of closely related sts descended from the founding st .

in eburst a clonal complex is defined as a group of sts in a population that share 6/ <dig> alleles with at least one other st in the group. the burst algorithm identifies these clonal complexes within bacterial populations , infers the founding st of each clonal complex, and displays the likely pattern of recent evolutionary descent of all sts within the clonal complex from this predicted founder  <cit> . founder sts are assigned as the st in an eburst group that is linked to the greatest number of slvs, with confidence in this assignment evaluated by bootstrapping  <cit> , and lines drawn between slvs  in an eburst diagram identify inferred ancestor-descendant relationships. consequently, eburst groups are typically radial, with the founder st linked to all its slvs, which may themselves be linked to dlvs of the founder and so on. the nature of the allelic change  is unimportant for discerning patterns of descent among related sts within a clonal complex and therefore, for exploring recent ancestry, eburst is uninfluenced by recombination, in contrast to most methods that use the nucleotide sequences themselves  <cit> .

the eburst program  is widely used but the reliability of the method for identifying groups of strains descended from a recent common ancestor, and patterns of recent descent, has not been evaluated. bacterial populations can vary greatly in their level of genetic diversity and in the extent to which allelic change is mediated by recombination compared to point mutation  <cit> . intuitively, eburst would be expected to perform well in cases where all allelic changes occur by point mutation , but its performance with populations in which an increasing proportion of allelic change occurs by recombination needs to be assessed. evaluating the performance of eburst is not possible using empirical data since the true evolutionary history is not known but can be carried out using simulated populations. here we use simulated populations in which the true ancestry of all strains is known to provide a quantitative assessment of the performance of eburst for populations evolving with differing rates of mutation and recombination.

RESULTS
quantitative assessment of eburst
the inferred ancestor-descendant slv links drawn by eburst were compared to the known ancestor-descendant slv links in populations simulated with different levels of recombination. the performance of eburst was evaluated by measuring the proportion of the links that it draws that are correct . as a method can be accurate but insensitive , the sensitivity of eburst was also measured, as the proportion of correct slv links that are drawn. these performance measures are summarised in figure  <dig> for clonal populations and populations with moderate  and high  levels of recombination and are shown in figure  <dig> for populations generated under clonality and for a range of values of the recombination to mutation  ratio and

as expected, the best performance of eburst was obtained under clonality, but moderate levels of recombination had little effect on the ability of eburst to assign ancestor-descendant links correctly . the accuracy was on average 86% with ρ/θ =  <dig> , which was comparable to the 90% accuracy obtained in the clonal case. increasing the ρ/θ ratio further resulted in a decline in eburst performance and for ρ/θ =  <dig> the average accuracy dropped to 61%. the sensitivity of eburst followed the same decreasing trend with increasing ρ/θ . the average sensitivity was 95% in the clonal case, 94% for ρ/θ =  <dig>  and 78% for ρ/θ =  <dig> 

comparison of eburst to true ancestry and population structure with differing levels of recombination
the population structure  was assessed for  <dig> samples of  <dig> isolates taken from populations of  <dig> isolates simulated without recombination and with moderate and high ρ/θ ratios. under clonality the population snapshots showed multiple radial eburst groups, short chains and many individual sts and the largest group contained on average 9% of the sts in the population . for moderate ρ/θ the population snapshots were similar to the clonal case and the largest eburst group included an average of 13% of the total sts. however, with a high ρ/θ ratio, the population had a noticeably different structure, typified by a single large group containing more than half the sts in the population . these large groups typically have multiple linked radial groups and long chains of linked sts connecting one end of the eburst group to the other. consequently, sts at opposite ends of the large eburst groups may have no alleles in common.

typical eburst snapshots of the complete population of  <dig> isolates are illustrated, together with the groups expected from the true ancestry under clonality , moderate ρ/θ  and high ρ/θ . there are different types of error which result in discrepancies between the eburst prediction and the true ancestry. minor errors resulted in some isolates from the same ancestry group being split into two eburst groups due to either a change at two loci in a single generation of the model, or missing  intermediate sts. major errors are defined as cases where sts that do not share a recent common ancestor are grouped into the same eburst group .

in the clonal example, eburst groups corresponded closely to the true ancestry , and there were only four minor  discrepancies out of  <dig> groups . for example, in group  <dig> there are two ancestry groups that have been placed in a single eburst group. figure 3d shows how the isolates not joined to the main part of the ancestry group  are linked to the ancestry group via their extinct parents . the changes of alleles between these isolates, their parents and common grandparent all occurred at the same locus. these changes at the same locus result in the isolates labelled with arrows being slvs of their common grandparent, which joins them into the same eburst group.

even with a moderate ρ/θ ratio the majority of errors are minor and only three out of eight discrepancies between eburst and the  <dig> ancestry groups were considered major, joining unrelated ancestry groups together . however, with the high ρ/θ ratio,  <dig> groups that do not share recent common ancestry were inappropriately linked into one large eburst group . whilst the local radial subgroups in the large eburst group corresponded in several cases to ancestry groups , these subgroups should not be joined together. further detailed description of figures  <dig>   <dig>   <dig> and examples of the types of errors that eburst may make are given in additional file  <dig> 

relationship between eburst performance and proportion of sts in the largest eburst group
there was considerable variation in eburst performance between samples obtained with the same combination of theta  and rho , which increased with increasing levels of recombination . however, there was a strong negative correlation between eburst performance and the proportion of sts in the largest eburst group that was insensitive to the variability between samples obtained with the same parameter values . when the proportion of sts in the largest eburst group was between 5–25%, the proportion of the links drawn that have an ancestor-descendant relationship  is over 90% . as the proportion of sts in the largest group increases, the accuracy and sensitvity of eburst decrease approximately linearly.

evaluating the reliability of eburst groups obtained using real mlst data
all isolates of each species represented at the two main mlst websites were displayed as population snapshots and the proportion of sts in the largest eburst group was calculated . most species fall within the region where eburst performs well  but five had between  <dig> and 59% of the sts in the largest eburst group and were thus in the region where performance is likely to be poor.

the eburst population snapshots are shown for selected species. in helicobacter pylori eburst provides no useful information on the patterns of descent among sts as there are very few pairs of slvs and no larger clusters of linked sts in this very diverse, highly recombining species  <cit> . staphylococcus aureus and haemophilus influenzae provide examples of species for which eburst performs very well and, respectively, are representative of species with low and moderate recombination to mutation ratios  <cit> . for burkholderia pseudomallei there is one very large straggly eburst group, indicating that groups of related isolates are likely to be spuriously linked into this large eburst group  <cit> . this type of population snapshot was only observed in populations simulated with high recombination to mutation ratios and, as predicted, recent evidence suggests high rates of recombination, but low allelic diversity in b. pseudomallei  <cit> . a single large straggly eburst group was also found in other species, for example enterococcus faecium and streptococcus uberis , and recombination is also predicted to be frequent relative to mutation in these populations  <cit> . the overall topologies of the population snapshots from simulations are remarkably consistent with those obtained for species with similar empirically estimated recombination to mutation ratios .

discussion
the eburst program is widely used but its ability to correctly identify clonal complexes, and to discern patterns of descent within clonal complexes, for populations with different levels of recombination, has not been assessed. there are a number of ways in which eburst could be unreliable, the most serious of which is linking together groups of sts that are not closely related. as expected, for strictly clonal populations, eburst groups corresponded very closely to the ancestry groups and the accuracy and sensitivity of eburst was on average ≥ 90%.

with occasional exceptions, where groups of strains that did not share recent ancestry were incorrectly linked into a single eburst group, the performance of eburst remained good for populations with moderate levels of recombination, but spurious linking together of clonal complexes into one large eburst group was observed in populations with high recombination to mutation ratios. as well as correctly identifying groups of related sts, the ability of eburst to identify correct ancestor-descendant links within these groups was high in clonal populations and remained high with low or moderate levels of recombination, decreasing approximately linearly with increasing ρ/θ ratios. however, at ρ/θ =  <dig> the accuracy of eburst dropped to about 60%.

the spurious linking together of clonal complexes with high rates of recombination resulted in populations that were dominated by a single large straggly eburst group, which typically include a number of radial subgroups linked through chains of slvs. the radial subgroups corresponded reasonably well with the ancestry groups , suggesting these largely reflect simple patterns of descent from their subfounder sts  <cit>  and that it is the interlinking of the radial subgroups that is incorrect. in essence, these radial subgroups approximate the real clonal complexes, which are joined together inappropriately. however, examination of figure 5d also shows multiple examples of individual sts within radial subgroups that are wrongly placed.

even in strictly clonal populations not all slvs represent true ancestor-descendant links  since two slvs of an ancestor can arise by different changes at the same locus, resulting in sts that are slvs of each other, but which do not have an ancestor-descendant relationship . it is the difficulty in deciding which of these alternative slv links represent the real pattern of descent that prevents eburst from being 100% accurate even in the absence of any recombination. as recombination becomes more frequent relative to mutation, an increasing proportion of slvs in the population do not represent ancestor-descendant links . displaying these additional undrawn slv links in a population with a high ρ/θ shows there typically are slv links that extend across the single large eburst group found in such populations . these long-range slv links occur in these populations as sts may share many alleles, not due to common ancestry, but to very frequent recombination . incorrect linking of subgroups, and of individual slvs, will occur in a large eburst group when long-range slv links are observed since, besides the slv links that are drawn by eburst, there will in some cases be alternative undrawn links between slvs far apart in the eburst group. choosing one slv link as the predicted true ancestry, rather than the alternative link, will lead to major differences in the linking of subgroups or individual sts. in eburst the algorithm is to link slvs to the st with the largest number of slvs first, then go to the st with the next highest number of slvs that have not previously been linked, and link these and so on. if two sts have the same number of slvs, the one with the largest number of dlvs is selected  <cit> . this difficulty in choosing between the large numbers of alternative slv links in populations with high rates of recombination makes accurate reconstruction of recent ancestry problematic using eburst, or any other method that uses allelic data.

methods that use the sequences rather than alleles face the challenge of identifying the true source of each piece of variable sequence as mutant or recombinant. in the case of one recent method, clonalframe  <cit> , this is sidestepped by assuming that recombination only involves importation of alleles  from outside of the dataset. however, the problem with inferring ancestry using mlst data in populations with high recombination to mutation ratios is the frequent importation ofexisting sequences from unrelated strains present in the dataset, which generates strains that are similar due to recombination rather than descent. such methods are hence unlikely to be helpful in this sort of situation.

it should be stressed that the existence of sts that share several alleles due to recombination rather than common ancestry, leading to straggly eburst groups, occurs when high levels of recombination occur in populations with relatively small numbers of alleles. if there are large numbers of alleles in the population , high rates of recombination will not generate unrelated sts that share several alleles, but a very diverse population in which there are no clonal complexes, since few isolates in the population will differ at only a single locus. h. pylori provides a good example of this type of highly diverse recombining population , which is consistent with the high rate of mutation that generates large numbers of alleles and a high rate of recombination that shuffles these alleles . as expected, populations simulated with high rates of both mutation and recombination generated populations that produce very similar population snapshots to that shown for h. pylori in figure  <dig> .

how can the reliability of eburst be judged when applied to real mlst data from a bacterial population? the proportion of sts in the largest group was identified as a robust indicator of eburst performance. this measure insensitive to variation in the performance of eburst observed between different samples obtained from the same simulation. it is also very straightforward to calculate from the analysis window within eburst and does not require any prior knowledge of the extent of recombination in the population. if the largest eburst group contains more than 25% of the sts in the population, eburst performance is likely to be suboptimal in terms of predicting ancestor-descendant links and, more importantly, may join unrelated groups of sts into the same eburst group.

the presence of a single large straggly eburst group is also a useful indicator that clonal complexes have been inappropriately linked and that there may be a high recombination to mutation ratio  within the population. further suggestive evidence for high ρ/θ can be obtained when the largest eburst group has many long-range slv links and chains of sts connecting radial subgroups. the presence of a single large eburst group in real populations of the five species in area c of figure  <dig> immediately suggests that eburst will be unreliable and that the ratio of recombination to mutation is likely to be high in these species.

the overall topologies of the eburst population snapshots for different bacterial species are consistent with those obtained in the simulations and proportion of sts in the largest group appears to be a reasonable proxy for the recombination to mutation ratio, where this has been estimated. ideally, population snapshots should be based on a large unbiased sample of the population. the population snapshots in figure  <dig> are taken from the entire mlst databases, which contain variable numbers of isolates and in many cases have biased sampling . the major consequence of oversampling is to identify large numbers of isolates of the oversampled sts and this has no effect on the structure of eburst groups. the number of sts may also increase to some extent due to oversampling, as minor variants of oversampled sts are more likely to be sampled, but these will be slvs of the oversampled sts. however, more slvs of a few clones due to oversampling is not going to make a straggly eburst group a radial group, or vice versa.

mlst databases  should be relatively large to get an indication of the reliability of eburst, or the presence of a dominant straggly group, rather than radial groups. analysis of subsets of isolates from the entire mlst databases for b. pseudomallei and e. faecium showed that a dominant straggly eburst group was observed in substantially smaller samples than the entire mlst databases. thus, the population snapshots of the first  <dig> isolates, or the second  <dig> isolates, from the b. pseudomallei and e. faecium mlst databases gave population snapshots that were similar to those in figure  <dig>  being dominated by a single large straggly eburst group. similarly, radial eburst groups were present in samples of the first  <dig> and the second  <dig> isolates taken from the s. aureus and h. influenzae mlst databases .

the ρ/θ ratio in the neutral, infinite alleles, model is not directly equivalent to the recombination/mutation  ratio obtained from mlst data using the method of feil et al  <cit> , since θ is a parameter that incorporates all processes generating new alleles , and ρ/θ values are therefore lower than r/m values. the good reliability of eburst up to values of about ρ/θ =  <dig> implies it will be reliable for species with r/m values considerably higher than 4: <dig>  and this is consistent with the predicted good performance of eburst for neisseria meningitidis and streptococcus pneumoniae , which have r/m values of about 5– <dig>  <cit> .

this initial analysis considered populations evolving under neutrality, sampled randomly at equilibrium. in experimental data there will be deviations from these simplifying assumptions, including selection, sampling bias, growing or declining populations, which may result in distinctive features in the population snapshot that have not been uncovered in this analysis. the approach used here can easily be extended to consider the reliability of eburst or similar methods under more complex evolutionary scenarios. however, for populations that are not highly biased, the > 25% guideline is a useful indicator of poor eburst performance and none of the bacteria surveyed in the mlst database were inconsistent with this assertion.

other approaches have been developed for the analysis of mlst data and a method based on minimum-spanning trees is incorporated into the bionumerics™ package  <cit> . this method incorporates the burst algorithm for closely-related sts, but links groups of related sts  to each other through hypothetical missing intermediate sts, to produce a representation of the whole population in which all sts are linked. the robustness of these linkages between clonal complexes has not been evaluated, but given that only local structure remains reliable in eburst under high rates of recombination, our experience would suggest that many of these inferred links between clonal complexes produced by postulating missing intermediates will be spurious if recombination rates are moderate or high. links between clonal complexes through postulated intermediates may also be spurious under strict clonality, since in such populations different lineages diverge without bound, and sts in different complexes may share few or no alleles. in the latter situation, analysis of the sequences rather than the allelic profiles would be expected to give a more reliable indicator of the relationships between clonal complexes, using standard phylogenetic methods. an analysis of the robustness of minimum-spanning trees using populations simulated with different levels of recombination would be worthwhile.

CONCLUSIONS
eburst provides a robust picture of bacterial populations over a wide range of ρ/θ parameters, only becoming seriously unreliable with high rates of recombination, and by focusing on identifying and exploring descent within clonal complexes is a conservative and cautious approach. we provide three simple checks which may indicate high ρ/θ and hence poor reliability . as discussed previously, eburst groups should be considered to be hypotheses about ancestry and patterns of descent among similar sts and additional data should be used to explore the validity of the inferred relationships  <cit> .

