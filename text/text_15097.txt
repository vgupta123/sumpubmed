BACKGROUND
programmed ribosomal frameshift  is a curious phenonenon, exploited especially by certain viruses, in order to translate two different protein products from the same messenger rna. the frameshift is caused by particular sequence and structural elements of the mrna which sometimes cause the ribosome to slip and readjust the reading frame, thus allowing viruses to pack more information into their genomes. since the ratio of the protein products coded in overlapping reading frames depends on the prf efficiency, which has been finely tuned by evolution, any chemical that can modify this efficiency could prove to be a useful anti-viral agent. though partcularly important for the life cycle of certain viruses, such as hiv- <dig> and hcv, programmed ribosomal frameshift can be found in all kingdoms of life  <cit> .

in hiv- <dig>  pol is obtained from a fused gag-pol polyprotein via a programmed - <dig> ribosomal frameshift, which naturally occurs with a frequency of 5–10%; moreover, an increase of ribosomal frameshift frequency is associated with a decrease in viral infectivity  <cit> . the - <dig> ribosomal frameshift is caused by two cis-acting rna elements, together known as frameshift stimulating signal :  a heptameric slippery sequence , where the gag reading frame is indicated, and  a downstream stem-loop secondary structure, often with either internal loop or right bulge. the fss from hiv- <dig> genome  is shown in fig. 1
a, where the minimum free energy  secondary structure was determined by rnafold from vienna rna package  <dig> . <dig>  <cit> . the pol reading frame is - <dig> with respect to the gag reading frame, or equivalently, the gag reading frame is + <dig> with respect to the pol reading frame  – fig. 1
b depicts the six reading frames considered in this paper. while the entire gag-pol overlap region in hiv- <dig> af <dig>  is from position  <dig> to  <dig> , the 17-mer pol  peptide coded in the  <dig> nt fss region 1631- <dig> is ffredlaflqgkarefs . moreover, we found the secondary structure from fig. 1a to be the most common mfe structure for  <dig> nt segments of the pol coding region, which begin by uuuuuua, taken from the hiv sequence database in los alamos national laboratory  available at www.hiv.lanl.gov. due to its importance, a collection of  <dig> hiv- <dig> ribosomal frameshift elements is given in the family rf <dig> in rfam  <dig>   <cit> . figure 1
c displays the sequence logo obtained from the  <dig> sequences in the seed alignment of rf <dig>  while fig. 1
d and e respectively display the sequence logos for the 17-mer pol and gag peptides coded in rf <dig> 
fig.  <dig> 
a minimum free energy  structure of the initial 52-nt gag-pol overlapping reading frame in positions 1631- <dig> of the hiv- <dig> complete genome . this frameshift stimulating signal  contains the initial slippery sequence heptamer, given by u uuu uua in the gag reading frame, as well as the displayed stem-loop secondary structure, which together promote a programmed - <dig> frameshift uuu uuu a in the pol reading frame. b depiction of all  <dig> possible reading frames – rnasamplecds samples rna sequences that code in all possible reading frames, allowing iupac sequence constraints c sequence logo for  <dig> rna hiv- <dig> frameshift signal sequences from the rf <dig> seed alignment from rfam  <dig>   <cit> . d sequence logo for the pol peptide coded by  <dig> rna hiv- <dig> frameshift signal sequences from the rf <dig> seed alignment from rfam  <dig> ; pol peptide translated from nucleotide positions 1- <dig>  e sequence logo for the gag peptide coded by  <dig> rna hiv- <dig> frameshift signal sequences from the rf <dig> seed alignment from rfam  <dig> ; gag peptide translated from nucleotide positions 2- <dig>  since some sequences from rf <dig> contained iupac codes for uncertain data, the data were disambiguated–for instance, the code b  was disambiguated by randomly assigning either c,g or u with probability 1/ <dig>  seven sequences were removed from the seed alignment of  <dig> rnas due to gaps in the alignment, and another five sequences were removed since either the pol or gag peptide contained a stop codon–resulting in  <dig> sequences for nucleotide analysis. peptide sequence logos for the  <dig> pol and gag peptides were created using weblogo  <cit> 




for decades, research in evolutionary biology has focused mostly on protein-coding regions, leading to the development of sophisticated computational tools, such as paml  <cit>  and hyphy  <cit> , to compute the ratio d
n/d
s of non-synonomous mutation rate dn to the synonomous mutation rate ds . pedersen and jenson  <cit>  extended the codon substitution model of goldman and yang  <cit>  to overlapping genes in a site-specific manner, where evolutionary constraints of both genes are taken into account. however, estimation of evolutionary parameters in this model required computationally expensive markov chain monte carlo simulations. by dropping the condition of site specificity, sabath et al.  <cit>  were able to apply a maximum likelihood method to estimate parameters in a more efficient manner. the resulting tool has been used to predict functionality of overlapping reading frames  <cit> . an evolutionary model has been developed for coding regions with conserved rna secondary structures  <cit>  as well. this approach was used to determine the effects of structural elements on nucleotide substitution in hepatitis c virus.

several methods have been developed to sample sequences using an evolutionary model derived from a given phylogeny . to the best of our knowledge, however, there is no previously published method for sampling sequences in overlapping coding regions. the program sissi  <cit>  incorporates a user-defined system of dependencies between the nucleotides; however, it is not possible using sissi to sample sequences that code in overlapping reading frames, since sissi requires that any position in an rna sequence must belong to a single codon. moreover, sissi does not allow sequence and structural dependencies to be specified simultaneously. our work in this paper is orthogonal to the foregoing computational models and tools of mathematical evolution theory and does not rely on phylogeny information. in full generality, the new software rnasamplecds supports the following. for each reading frame r∈{+ <dig> + <dig> + <dig> − <dig> − <dig> −2} illustrated in fig. 1
b, let p
r be a length n sequence in the 22-letter alphabet consisting of iupac codes for each amino acid, together with symbol x  and o . rnasamplecds computes the number of rna sequences a
 <dig> …,a
3n+ <dig> which simultaneously code protein pr′ in reading frame r, such that either pr′ is identical to p
r, or  whose blosum/pam similarity to p
r exceeds a user-specified value.  rnasamplecds can then compute the pssm and codon usage frequency for such proteins, as well as sample a user-specified number of such sequences. rnasamplecds runs in linear time and space, although if gc-content is optionally controlled, then time and space requirements are quadratic. for expository reasons, we describe the algorithms for only two proteins p,q respectively in reading frame  <dig> and 1; however, our code is general as just described – see the additional file  <dig> for details on the general algorithm. using rnasamplecds, we undertake a preliminary analysis of the gag-pol overlapping reading frame in human immunodeficiency virus  and of the triple overlapping reading frame of hepatitis c virus .

methods
rnasamplecds
let p=p
 <dig> …,p
n and q=q
 <dig> …,q
n be two peptides of equal length. in this section, we are interested in the following questions. 
which sequences a
 <dig> …,a
3n of messenger rna translate the peptide p in reading frame  <dig> and also translate the peptide q in reading frame +1?

which sequences a
 <dig> …,a
3n of messenger rna translate peptides p
′=p1′,…,p
n′ in reading frame  <dig> and peptide q
′=q1′,…,q
n′ in reading frame + <dig>  where the blosum/pam similarity of p with p
′ and q with q
′ is greater than or equal to a user-specified threshold θ?

what is the profile, or pssm, for the collection of mrnas from  and ?

what is the total number of sequences satisfying  and , and how can we sample sequences a
 <dig> …,a
3n of messenger rna in an unbiased manner, in order to satisfy either  or ?




by developing software to sample mrna sequences that code user-specified proteins in different reading frames, we can then analyze the samples with other tools to provide an estimate of the probability of satisfying a given property of interest, hence give approximate answers for questions like the following: what is the expected stem size in the minimum free energy  structure of rnas that translate peptides p
′,q
′ in reading frames  <dig> , where the blosum/pam similarity of p,p
′ and of q,q
′ is at least a user-specified threshold value of θ? as we show, it is not difficult to see that questions  are easily answered using breadth first search ; however, for large values of n, it can happen that bfs in not practical, since the number of messenger rnas can be of size exponential in n. for that reason, we describe a novel dynamic programming  algorithm to answer questions  and .

we first need a few definitions. if xyz is a trinucleotide, then let t
r denote the amino acid whose codon is xyz in the genetic code; i.e. t
r is the amino acid translated from codon xyz, unless xyz is a stop codon. if xyzu is a tetranucleotide, then let t
r
 <dig> [resp. t
r
1] denote the amino acid whose codon is xyz ; i.e. t
r
0=t
r and t
r
1=t
r. for each k= <dig> …,n, define the collection l
k of 4-tuples s=s
 <dig> s
 <dig> s
 <dig> s
 <dig> such that t
r
0=t
r=p
k and t
r
1=t
r=q
k. define two 4-tuples s=s
0
s
1
s
2
s
 <dig> and t=t
0
t
1
t
2
t
 <dig> to be compatible if s
3=t
 <dig> – i.e. the tail of s equals the head of t. note that if 4-tuples s,t are compatible, then the merge
s
 <dig> s
 <dig> s
 <dig> t
 <dig> t
 <dig> t
 <dig> t
 <dig> of s,t has the property that amino acids are translated by each of the four codons s
0
s
1
s
 <dig>  s
1
s
2
s
 <dig>  t
0
t
1
t
 <dig>  and t
1
t
2
t
 <dig> 





using our implementation of the bfs approach in algorithm  <dig>  we can easily determine that there are exactly  <dig> 52-nt rnas that translate the 17-residue pol peptide ffredlaflqgkarefs in reading frame  <dig>  and the 17-residue gag peptide flgkiwpsykgrpgnfl in reading frame + <dig>  these 17-mer peptides are those which constitute the beginning of the gag-pol overlap in the hiv- <dig> genome . the entire gag-pol overlap region is from 1631- <dig>  whereby the 68-mer pol  peptide is coded in the region 1631- <dig> . our implementation of the bfs method returns exactly  <dig> 205-nt rnas that code the pol  68-mers from hiv- <dig> .
fig.  <dig> 
a the centroid secondary structure, b
rnaalifold consensus structure, and c the corresponding mountain plot for the alignment of all  <dig> 205-nt rna sequences that code the pol and gag 68-mer peptides from hiv- <dig> 




further analysis  indicates that there is considerable variation in the low energy structures of rnas that exactly code the same 68-mer pol and gag peptides as those coded by af <dig> /1631- <dig> 

question  is an obvious generalization of , and is easy to answer by generalizing the collection l
k of 4-tuples s=s
 <dig> s
 <dig> s
 <dig> s
 <dig> such that t
r
0=t
r=p
k′ and t
r
1=t
r=q
k′, where the blosum/pam similarity of p
k,p
k′ and of q
k,q
k′ is at least a user-specified threshold θ.

it is more interesting to turn to question , which requires a different strategy, since the number of rnas returned by bfs may be exponentially large. indeed, if rna sequences are required to code peptides p  whose amino acids have blosum <dig> similarity of at least θ to those of the pol  17-mer peptide coded in reading frame  <dig>  in af <dig> /1631- <dig>  then the number of solution sequences is  <dig> ,  <dig>  ,  <dig> , <dig>  ,  <dig> e+ <dig> ,  <dig> e+ <dig> ,  <dig> e+ <dig> ,  <dig> e+ <dig> ! to address question , define the forward and backwards partition function zf, zb as follows. 

forward partition function: for integer k= <dig> …,n and nucleotide c
h∈{a,c,g,u}, define z
f to be the number of rnas a=a
 <dig> …,a
3k such that a
3k is the nucleotide ch, and a translates the peptide p
 <dig> …,p
k resp. q
 <dig> …,q
k in reading frame  <dig> resp. 1; i.e. t
r
0=p
 <dig> …,p
k and t
r
1=q
 <dig> …,q
k.


backward partition function: for integer k= <dig> …,n and nucleotide c
h∈{a,c,g,u}, define z
b to be the number of rnas a=a
3k,a
3k+ <dig> …,a
3n such that a
3k is the nucleotide ch, and a translates the peptide p
k,…,p
n resp. q
k,…,q
n in reading frame  <dig> resp. 1; i.e. t
r
0=p
k,…,p
n and t
r
1=q
k,…,q
n.








by dynamic programming, it is straightforward to compute the forward and backward partition functions in linear time and space, as done in algorithm  <dig> 

recall that the indicator function
i returns the value  <dig> if the boolean condition within its scope is true, and otherwise the value returned is  <dig> 

by appropriately redefining l
k, the recursions of algorithm  <dig> can easily be modified to instead count the number of sequences coding p1′,…,pn′ in reading frame  <dig> and q1′,…,qn′ in reading frame + <dig>  such that for each i, the blosum/pam similarity of p
i,p
i′ and of q
i,q
i′ exceeds a user-specified threshold θ, or for which the kyte-doolittle hydrobicity of p
i,p
i′ and q
i,q
i′ differ by at most a user-specified upper bound, etc. the same remark applies to all algorithms of this section, although for reasons of space, we do not explicitly mention such extensions. nevertheless, such extensions are supported by the software rnasamplecds.

by refining the definition of forward and backward partition function, algorithms  <dig> and  <dig> can be modified to keep track of the gc-content, albeit at an overhead for the space required. for an arbitrary rna sequence a, let g
c
c
o
u
n
t denote the number of gs or cs occurring in a. 

forward partition function accounting for gc-content: for integer k= <dig> …,n and nucleotide c
h∈{a,c,g,u}, define z
f
gc to be the number of rnas a=a
 <dig> …,a
3k such that a
3k is the nucleotide ch, g
c
c
o
u
n
t=x, and a translates the peptide p
 <dig> …,p
k resp. q
 <dig> …,q
k in reading frame  <dig> resp. 1; i.e. t
r
0=p
 <dig> …,p
k and t
r
1=q
 <dig> …,q
k.


backward partition function accounting for gc-content: for integer k= <dig> …,n and nucleotide c
h∈{a,c,g,u}, define z
b
gc to be the number of rnas a=a
3k,a
3k+ <dig> …,a
3n such that a
3k is the nucleotide ch, g
c
c
o
u
n
t=x, and a translates the peptide p
k,…,p
n resp. q
k,…,q
n in reading frame  <dig> resp. 1; i.e. t
r
0=p
k,…,p
n and t
r
1=q
k,…,q
n.




though not explicitly described, all the following algorithms  can be modified to account for gc-content. our program, rnasamplecds, implements all the algorithms described in this section, including versions that account for gc-content. moreover, our program supports any two or more overlapping coding regions in any of the  <dig> reading frames – i.e. reading frame  <dig> , <dig> on the plus-strand and  <dig> , <dig> on the minus-strand, as shown in fig. 1
b.

note that an easy modification of the above algorithm allows one to compute the total number of rnas of length 3n+ <dig>  which code n-mer peptides p  in reading frames  <dig> , i.e. for which neither reading frame contains a stop codon. this modification is later used to compute the probability that a random rna of length 3n+ <dig> will code in both reading frames  <dig> and  <dig>  algorithm  <dig> applies algorithm  <dig> in order to compute the exact value of the position specific scoring matrix .





the recursions can be easily modified, if the rna sequence is instead required to code p1′,…,pn′ in reading frame  <dig> and q1′,…,qn′ in reading frame + <dig>  such that for each i, the blosum/pam similarity of p
i,p
i′ and of q
i,q
i′ exceeds a user-specified threshold θ. this answers question . the resulting dp program is very fast, since the run time is linear in n, while the bfs program has run time that is exponential in n.

given a gapless alignment s of mrna sequences of length 3n+ <dig>  each of which codes a protein in reading frame  <dig> and  <dig>  define the positional codon frequency
p
c
f to be the number of occurrences of w in the kth codon position in reading frame r∈{ <dig> } of a sequence in s. if s is the collection of all mrnas that code proteins p,q respectively in reading frame  <dig> , which are identical to , then the positional codon frequency can be defined from the partition functions z
f,z
b as done in algorithm  <dig> 





next, in order to sample rna sequences that code peptides p=p
 <dig> …,p
n resp. q=q
 <dig> …,q
n in reading frames  <dig> resp.  <dig>  we construct the sampled sequence from last to first character, each time ensuring that z
f> <dig> where ch is the leading character of the current sample a
3k− <dig> a
3k,…,a
3n. this is described in done in algorithm  <dig>  where we recall that l
k denotes the collection of 4-tuples s=s
 <dig> s
 <dig> s
 <dig> s
 <dig> such that t
r
0=t
r=p
k′ and t
r
1=t
r=q
k′, and the blosum/pam similarity of p
k,p
k′ and of q
k,q
k′ is at least a user-specified threshold θ.





it is straightforward to modify the previous algorithm to sample in a weighted fashion as done in algorithm  <dig>  first, recall that l
k denotes the collection of 4-tuples s=s
 <dig> s
 <dig> s
 <dig> s
 <dig> such that t
r
0=t
r=p
k′ and t
r
1=t
r=q
k′, and the blosum/pam similarity of p
k,p
k′ and of q
k,q
k′ is at least a user-specified threshold θ. additionally, if c
h∈{a,c,g,u} then let l
k,ch denote the set of tuples t in l
k, whose last element t
 <dig> is ch.





our implementation of the algorithms described in this section allows the user to stipulate sequence constraints using any iupac nucleotide codes, for instance, designating the first  <dig> nucleotides to be the slippery sequence uuuuuua, or to consist of an alternation of purines and pyrimidines ryryryr, etc.

finally, we note that all the previous algorithms in this section can be extended to handle multiple overlapping reading frames in all six reading frames, i.e. reading frames + <dig> + <dig> + <dig> on the plus strand and reading frames - <dig> - <dig> - <dig> on the minus strand, as illustrated in fig. 1
b. for instance, in order to compute the forward partition function for reading frames  <dig> , <dig> we define z
f to be the number of rna sequences a of length 3k+ <dig> whose last two nucleotides are c
h <dig> c
h <dig>  such that t
r
0=p
 <dig> …,p
k, t
r
1=q
 <dig> …,q
k, t
r
2=r
 <dig> …,r
k, for user-specified peptides p=p
 <dig> …,p
n, q=q
 <dig> …,q
n, r=r
 <dig> …,r
n. now we define l
k to be the set of 5-tuples s=s
 <dig> …,s
 <dig> such that s
0
s
1
s
 <dig> codes residue p
k, s
1
s
2
s
 <dig> codes residue q
k, and s
2
s
3
s
 <dig> codes residue r
k. the definition of the generalization of the forward partition function z
f, analogous to that defined in algorithm  <dig>  is as follows: 

case 1:
k= <dig>  then z
f equals


∑s0s1s2s3s4∈lki



case 2:
k= <dig> …,n <dig> …,n. then z
f equals


∑s0s1s2s3s4∈lki·zf





our publicly available code rnasamplecds supports all the above described variants of algorithms 1- <dig> with possible iupac sequence constraints, stipulation of gc-content, and where the user may stipulate that particular peptides are coded in any or all of the six reading frames displayed in fig. 1
b. see additional file  <dig> for details of how we determine the run time estimate of ≈ <dig> ·l+ <dig> ·n to generate compute the partition function and generate n samples of rna sequences of length l that code any peptide in each of the six possible reading frames.

RESULTS
in this section, we use rnasamplecds to study novel aspects of human immunideficiency virus hiv- <dig> and hepatitis c virus hcv, that cannot be determined using methods other than those described in this paper.

hiv- <dig> programmed - <dig> frameshift
analysis of hiv- <dig> overlap: since hiv- <dig> and other retroviruses have a - <dig> ribosomal frameshift in the initial portion of the gag-pol overlap, this can be detected by the software fresco  <cit> , which predicts regions of excess synonymous constraint in short, deep alignments. figure 3
a displays the dn/ds ratio we obtained for hiv- <dig> af <dig>  with respect to the gag reading frame, when aligned with other hiv- <dig> genomes from the los alamos hiv database – see also additional file 1: figure s <dig>  this figure indicates that there is positive selection in the gag region before the gag-pol overlap. in contrast, starting with the beginning of the gag-pol overlap , there is purifying selection; i.e. fig. 3
a suggests the presence of an important signal starting around position  <dig>  figure 3
b displays the d
n/d
s ratio of the  <dig> nt gag-pol overlap region, for both the gag and pol reading frames, using the method of  <cit>  which computes a rate matrix for overlapping reading frames – an aspect ignored by paml and other software. since sabath’s program computes d
n/d
s from a pairwise alignment, which is wholly inappropriate for the short  <dig> nt sequences considered here, we modified the approach by first producing multiple alignments of  <dig> nt gag-pol overlap regions, and then computed the number of  synonomous and nonsynonomous mutations within the gag  reading frame, taking account for all codon pairs in the same column. we then modified sabath’s matlab program to compute d
n/d
s by maximum likelihood using counts obtained from the multiple alignments. the multiple alignments considered in fig. 3
b are from rfam family rf <dig> and from  <dig> nt rna sequences generated by the programs rnasamplecds and rnaifold  <dig> . rnasamplecds generates  <dig> nt sequences, that translate peptides in the gag  reading frame, each of whose amino acids has blosum <dig> similarity of either  <dig> or  <dig> to the corresponding amino acids in the gag  reading frame of the peptides translated by the  <dig> nt hiv- <dig> overlap region of af <dig> /1631- <dig>  rnaifold  <dig>  generates  <dig> nt sequences, that not only satisfy the same coding requirements as rnasamplecds, but which also fold into the minimum free energy secondary structure shown in fig. 1
a. in each case, rnaifold  <dig>  generates all sequences that satisfy both the coding and structure requirements, their number being substantially less than the  <dig>  sequences generated by rnasamplecds. note the presence of purifying selection for the gag reading frame, as indicated by d
n/d
s values less than  <dig> 
fig.  <dig> 
a output from the program fresco  <cit> , when run on the gag reading frame of an alignment of  <dig> sequences from the lanl hiv- <dig> database using  <dig> nt windows. note the precipitous drop in dn/ds value at the beginning of gag-pol overlap region. b values of d
n/d
s, branch length, and transition/transversion rate  for the  <dig> nt gag-pol overlap regions within a multiple alignment from rfam family rf <dig> as well as from  <dig> nt rna sequences generated by the programs rnasamplecds and rnaifold. these programs generate sequences that code peptides, each of whose amino acids has blosum <dig> similarity of either  <dig> or  <dig> to the corresponding amino acids in the gag  reading frame of the peptide translated by the  <dig> nt hiv- <dig> overlap region of  <cit>  or by genbank accession code af <dig> /1631- <dig>  the program rnasamplecds ensures only coding requirements, while rnaifold ensures both coding requirements and that the  <dig> nt rnas fold into the minimum free energy structure of the gag-pol overlap region of hiv- <dig> from  <cit>  and genbank accession code af <dig> /1631-1682





codon preference index: in this section, we generalize the notion of codon preference index   <cit>  to the context of overlapping coding regions. for rna sequence a=a
 <dig> …,a
3n which codes n-mer peptides in reading frames  <dig>   <dig>  for codon w∈ <dig> and reading frame r∈{ <dig> }, define f
 to be the number of occurrences of codon w in reading frame r of a, and for amino acid aa, define f
 to be the number of occurrences of codons coding aa in reading frame r of a. define the observed codon preference in a by pobs=∑r=01f/∑r=01f. if sis a set of mrnas of length 3n+ <dig>  each of which codes n-mer peptides in both reading frames  <dig> , then define the observed codon preference in s by pobs=∑r=01∑a∈sf/∑r=01∑a∈sf. note that p
obs is the probability that codon w will be used for amino acid aa in the collection s of overlapping coding sequences. finally, define the codon preference index
i of codon w in s by i=p
obs/p
obs, where s
′ is a control set of mrnas of length 3n+ <dig> 

with these notations, fig.  <dig> depicts a heat map for the codon preference index i, computed over  <dig>  entire gag-pol overlap regions of average length 205± <dig>  extracted from lanl hiv- <dig> database, each starting with the slippery sequence uuuuuua and terminating with the last gag codon; additionally the heat map includes gag-only and pol-only values for the same overlap region. for this figure, the control set s
′ is defined differently for each column 1− <dig>  although in all cases, each sequence in s
′ contains the initial slippery sequence uuuuuua. for column  <dig>  s
′ is the set of all mrnas that code proteins in the gag  reading frame that are coded by some sequence of s. for column  <dig>  s
′ is the set of all mrnas that code proteins p and q that are identical to proteins coded in the gag and pol reading frames of some sequence a of s. for column  <dig>  s
′ is defined as in the case for column  <dig>  except that ‘identical to’ is replaced by ‘blosum <dig> + <dig> similar to’. for column  <dig>  s
′ is the set of all mrnas that code proteins p and q that are blosum <dig> + <dig> similar to proteins coded in the gag and pol reading frames of a sequence a of s, and whose gc-content lies in the range of gc-content of a± <dig>  the heat map of fig.  <dig> shows that for serine, i<i<i≈1; for valine, i<1<i but i>1>i; for proline, i<i<i≈ <dig>  but when the control set is taken to be blosum <dig> + <dig> similar peptides to gag and pol, then i≫ <dig>  see additional file 1: figures s <dig> and s <dig> and the text from additional file  <dig> for more detailed explanation. these figures show that the codon usage bias observed at the gag-pol junction is not due to natural selection  <cit>  or to the underlying mutational bias, but rather imposed by the overlapping coding constraints.
fig.  <dig> heat map of the codon preference index  for a collection of  <dig> entire gag-pol overlap regions of average length 205± <dig> extracted from lanl hiv- <dig> database. cpi values shown at bottom right of each square. see text for additional explanation





overlapping coding and stem-loop formation: here we describe how to quantify the extent to which coding hiv- <dig> 17-mer peptides in overlapping reading frames induces a stem-loop structure. in particular, we consider the following questions. 
what is the probability that random rna forms a stem-loop structure?

what is the probability that rna forms a stem-loop structure, if it is required to code  peptides in reading frames  <dig> and 1?

what is the probability that rna forms a stem-loop structure, if it is required to code peptides in reading frames  <dig> and  <dig>  which are similar to peptides coded in the hiv- <dig> frameshift stimulating signal ?

to what extent do hiv- <dig> coding requirements in the pol-gag overlap region alone induce stem-loop formation?

what is the  probability of coding peptides in reading frames  <dig> and  <dig> if the rna forms a secondary structure similar to the fss stem-loop structure of hiv-1?




to answer question  <dig>  we generated  <dig>  52-nt rnas, where the first seven nucleotides constituted the slippery sequence uuuuuua, and each nucleotide in position  <dig> through  <dig> was randomly selected with probability  <dig>  for each of a,c,g,u. using rnashapes, cf.  <cit> , we determined the boltzmann probability that each rna sequence has shape   <cit> , i.e. p=∑sexp/rt), where the sum is taken over all stem-loop secondary structures, which may contain internal loops and bulges, but no multiloops or multiple stem-loops. throughout the sequel of the paper, the probability that a given rna sequence will form a stem-loop structure is identified with p. a finer analysis could consider type  <dig> shapes of the form _  _ ] or _ [
 _ ], corresponding to a stem loop with internal loop or right bulge, with left flanking unpaired region, but in this paper we consider only the type  <dig> stem loop shape . by mfe stem-loop structure, we mean the stem-loop secondary structure which has the minimum free energy, taken over all stem-loop structures. similarly, stem-loop mfe means the minimum free energy of all stem-loop structures. note that the stem-loop mfe is not necessarily equal to the mfe, since it is possible that a structure having two or more external loops, or containing a multiloop, could have lower energy than that of any stem-loop structure. by uniformly sampling  <dig>   <dig> nt rnas with no coding requirements, we estimate an average probability of stem-loop formation of  <dig> % with standard deviation of  <dig> %, and average stem-loop mfe was − <dig>  kcal/mol with standard deviation  <dig>  kcal/mol – again, this is for  <dig> nt rna with no constraints.

before answering question  <dig>  we first note that the conditional probability is  <dig> % that a 52-nt rna codes in both reading frames  <dig>  assuming that it begins by the slippery heptamer uuuuuua is  <dig> %, and that the conditional probability that a 52-nt rna codes in reading frame  <dig>  given that it begins by the slippery heptamer uuuuuua and that it already codes in reading frame  <dig>  <dig> % – i.e. p= <dig> , where event a is that a 52-nt rna codes in reading frame  <dig>  event b is that the 52-nt rna contains slippery heptamer uuuuuua, and event c is that reading frame  <dig> of the 52-nt rna contains no stop codon. in contrast, the conditional probability that a 52-nt rna codes in reading frame  <dig> assuming that it begins by the slippery heptamer uuuuuua is  <dig> %.

indeed, using rnasamplecds, we determine that the number x
 <dig> of 52-nt rnas beginning by uuuuuua and which code in both reading frames  <dig>  is  <dig> · <dig>  in contrast, the number x
 <dig> of 52-nt rnas beginning by uuuuuua and which code in reading frame  <dig> is x
2=16·6114·4= <dig> · <dig>  since there are  <dig> codons that begin by a, a choice of  <dig> coding codons for the remaining  <dig> residues , times  <dig> for the last nucleotide to ensure the rna length is  <dig>  the number x
 <dig> of all 52-nt rnas that begin by uuuuuua is clearly 445= <dig> · <dig>  these computations justify the previous probabilities, and suggest the potential utility of rnasamplecds when speculating about molecular evolution.

to answer question  <dig>  we used rnasamplecds to generate  <dig>  52-nt rna sequences, each of which contains the slippery sequence uuuuuua and codes 17-mer peptides in both reading frames  <dig> and  <dig>  executing rnashapes as previously described yielded an average probability of stem-loop formation of  <dig> % with standard deviation of  <dig> %, and average stem-loop mfe of − <dig>  kcal/mol with standard deviation  <dig>  kcal/mol.

to answer question  <dig>  we extracted  <dig> 52-nt pol-gag overlapping fss sequences in family rf <dig> from the rfam  <dig> , of which  <dig> sequences remained after disambiguation and removal of sequences containing gaps or stop codons. for each of the  <dig> sequences, we generated  <dig>  sequences using rnasamplecds, each of which begins by the same initial  <dig> nucleotides of the rfam sequence constituting a slippery sequence , and which code peptides p  having blosum <dig> similarity of at least + <dig> with the corresponding amino acids of the 17-mer peptide coded by the rfam sequence in frame  <dig> .

after removing two outliers , we have the following statistics for the remaining  <dig> sequences from rf <dig>  average probability of stem-loop formation for rf <dig> is  <dig> ± <dig> %, and average stem-loop mfe is − <dig> ± <dig>  kcal/mol. for the collection of  <dig>  sequences generated by rnasamplecds for each sequence from rfam family rf <dig>  coding blosum <dig> + <dig> similar peptides to those coded by the rfam sequence, the average stem-loop formation probability is is 69±12%, and average stem-loop mfe is − <dig> ± <dig>  kcal/mol. figure 5
a and b depict respectively the stem-loop formation probabilities and stem-loop minimum free energies. in contrast, a similar computational experiment using rnasamplecds shows that the average probability of stem-loop formation is  <dig> %± <dig>  if each sampled sequence is required to code exactly the same peptides as those from hiv- <dig> in rf <dig>  this answers question  <dig> 
fig.  <dig> for each of  <dig>  <dig> nt frameshift stimulating signals  from family rf <dig> from the rfam  <dig> , rnasamplecds generated  <dig>  rnas that have the same slippery sequence as the rfam sequence, and code 17-mer peptides p  in reading frame  <dig>  each of whose amino acids has blosum <dig> similarity of at least + <dig> with the corresponding amino acid in the pol  peptide coded by the rfam sequence. stem-loop formation probability, p, and stem-loop minimum free energy  were computed by rnashapes  <cit>  with the command rnashapes -q -m ‘’. a average stem-loop formation probability for  <dig>  sequences sampled from rnasamplecds for each rf <dig> sequence ; stem-loop formation probability of hiv- <dig> frameshift stimulating signals from rf <dig> . overall mean rnasamplecds samples is 69%± <dig> , while that for the rf <dig> sequences is  <dig> ± <dig>  . b average stem-loop mfe for  <dig>  sequences sampled by rnasamplecds for each rf <dig> sequence ; stem-loop minimum free energy for hiv- <dig> frameshift stimulating signals from rf <dig> . overall mean for rnasamplecds samples is  <dig> ± <dig>  kcal/mol , while that for rf <dig> sequences is − <dig> ± <dig>  kcal/mol 




the previous analysis was performed for  <dig> rfam sequences, obtained after removal of the sequences af <dig> /1455- <dig> and l <dig> /1290- <dig>  from the set of  <dig> rfam sequences obtained from  <dig> sequences in rf <dig>  after disambiguation and removal of sequences containing gaps or stop codons. these two sequence were removed as outliers, since their stem-loop formation probabilities were respectively  <dig> % and  <dig> % – far removed from the average of  <dig> ± <dig> % of the remaining sequences. genbank annotations indicate that af <dig>  is highly g to a hypermutated with very many, mostly in-frame, stop codons throughout the genome, and that the gag gene of l <dig>  has a premature termination at position residue  <dig> 

together, these results show that stem-loop formation is a consequence of the precise hiv- <dig> gag and pol 17-mer peptides, but not of blosum <dig> + <dig> similar peptides. as well, stem-loop formation probability is not statistically different  between random sequences, sequences that have no stop codon in reading frame  <dig> or  <dig>  and sequences that code peptides having blosum <dig> similarity of at least + <dig> to hiv- <dig> peptides. to determine particular nucleotide positions in the 52-nt fss that appear to be critical in stem-loop formation, we computed the position-dependent nucleotide frequency , denoted by π
 <dig>  for  <dig>  sequences generated by rnasamplecds that begin by the slippery sequence uuuuuua, and code peptides p , each of whose amino acids has blosum <dig> similarity greater than or equal to  <dig> with the corresponding amino acids of the pol  17-mer peptides ffredlafpqgkarefs  coded in af <dig> /1631- <dig>  using rnaifold  <dig> , we also computed the pssm, denoted by π
 <dig>  for all possible sequences that begin by slippery heptamer uuuuuua, and fold into the mfe structure of af <dig> /1629- <dig> shown in fig. 1
a, and which code peptides that are blosum <dig> + <dig> similar to the peptides coded by af <dig> /1631- <dig>  we then computed the position-dependent total variation distance between π
 <dig> and π
 <dig>  defined by δ=1/2·∑x∈{a,c,g,u}|π <dig> i−π <dig> i|, where π
 <dig> i resp. π
 <dig> i denotes the mononucleotide frequency at position i of the pssm for sequences generated by rnasamplecds resp. rnaifold  <dig> . with the exception of specific regions, the total variation distance is close to zero, thus pinpointing critical nucleotides necessary for stem-loop formation of the fss. figure 6
a, b display the sequence logo for the pssm π
 <dig> and π
 <dig>  and fig. 6
c and d respectively depict the position-dependent entropy and total variation distance.
fig.  <dig> 
a sequence logo from rnasamplecds for all  <dig> , <dig> sequences that code peptides p , each of whose amino acids has blosum <dig> similarity ≥+ <dig> with the corresponding amino acids of the pol  17-mer peptides ffredlafpqgkarefs  in af <dig> /1631- <dig>  the pssm is  computed by rnasamplecds with flag -pssm, and the logo plot was produced using weblogo  <cit> . the average pairwise hamming distance is  <dig> ± <dig>  , when computed with a random sample of  <dig>   <dig>  and  <dig> . b sequence logo for all  <dig> sequences determined by rnaifold  <dig>  to fold into the frameshift stimulating signal  given by the mfe structure from af <dig> /1629- <dig> and code peptides p,q, each of whose blosum <dig> similarity with the gag,pol peptides in the overlap region is greater than or equal to + <dig>  the average pairwise hamming distance is  <dig> ± <dig>  . c the position-dependent entropy is defined by h
i=−p
a lnp
a−p
c lnp
c−p
g lnp
g−p
u lnp
u for each nucleotide position i= <dig> …, <dig>  subfigure  shows the position-dependent difference
hia−hib in entropies of  minus . d position-dependent total variation distance δ=1/2·∑x∈{a,c,g,u}|π <dig> i−π <dig> i| in the  <dig> nt region of the gag-pol overlap in the hiv- <dig> genome  that contains the frameshift stimulating signal . here π
 <dig> i resp. π
 <dig> i is the mononucleotide frequency at position i of the pssm in the left resp. right panel. if total variation distance is zero, then it is suggestive that the coding constraint automatically may already entail the fss secondary structure constraint




to answer question  <dig>  we used rnaifold  <dig>  with target structure as depicted in fig. 1
a, in order to generate  <dig>  52-nt rna sequences, each containing the slippery sequence uuuuuua and each folding into the target structure. we determined that  <dig> % of these sequences have no stop codon in reading frames  <dig> or  <dig>  the percentage of sequences that have no stop codon in reading frame  <dig>  alone is somewhat higher, with value  <dig> % . we additionally determined that the average base pair distance between the mfe structure of the sampled sequences and the target fss secondary structure is  <dig>  and average ensemble defect is  <dig> .

the probability of stem-loop formation for frameshift stimulating signal  regions of hiv- <dig> is close to  <dig>  with average value of 99%± <dig> for rf <dig> as shown in fig. 5
a. this value is much larger than that of random 52-nt rnas , or 52-nt rna having no stop codons in reading frames  <dig> or  <dig> , or even 52-nt rna coding peptides in reading frames  <dig>  with blosum <dig> similarity of at least + <dig> to hiv- <dig> peptides . it follows that coding blosum <dig> + <dig> similar peptides to those of hiv- <dig> at most slightly induces stem-loop formation. yet the probability that stem-loop structures do not have a stop codon in either reading frame  <dig> or  <dig> is only about 62%, without requiring that the peptides be similar to those of hiv- <dig>  it follows that blosum <dig> + <dig> similarity to hiv- <dig> peptides cannot induce the required stem-loop fss structure, nor can the target fss structure from fig. 1
a induce blosum <dig> + <dig> similarity to hiv- <dig> peptides. we speculate that starting from a genomic region that codes a polyprotein similar to that of gag, a series of pointwise mutations could slowly induce a stem-loop fss structure and at the same time slowly create a pol-like reading frame. although speculative, it is possible to create an adaptive walk or monte carlo program to test the likelihood of this hypothesis, using intermediate sequences generated by rnasamplecds and rnaifold <dig> .

as shown in fig. 6
a, the average pairwise hamming distance of sequences generated by rnasamplecds with the overlapping coding constraint and the slippery sequence constraint is  <dig> ± <dig>  , when computed with a random sample of  <dig>   <dig>  and  <dig> . as shown in fig. 6
b, the average pairwise hamming distance of sequences generated by rnaifold with the frameshift stimulating structure  constraint, overlapping coding constraint and the slippery sequence constraint is  <dig> ± <dig>  . essentially, this means that approximately 11% of the positions  are different for rnaifold sampled sequences, compared with approximately 21% of the positions  for rnasamplecds, compared with 81% of the positions  for random rna in positions 8- <dig> . the greatest reduction in pairwise hamming distance appears to be due to overlapping coding constraints, with an additional small reduction due to the fss structural constraint.

hcv programmed − <dig> and +  <dig> frameshifts
there is both in vitro and in vivo experimental evidence for a -2/+ <dig>  and -1/+ <dig>  programmed ribosomal frameshift in the core protein of the hepatitis c virus   <cit> . the + <dig> frameshift produces a  <dig> kda protein called protein f , also designated as arfp . in addition, the + <dig> frameshift produces a  <dig>  kda protein. as measured by in vitro assays, the + <dig> ribosomal frameshift efficiency is ∼12−15%, while the + <dig> ribosoma frameshift efficiency is ∼30−45%  <cit> . figure  <dig> depicts the organization of the overlapping coding region for the hcv genome , including a double stem-loop rna structure designated as frameshift stimulating signal  depicted in fig.  <dig>  according to  <cit> , the frameshift is caused by a poly-a slippery sequence  in the triple coding region, although a mutated slippery sequence  has also been shown to cause a frameshift, but with a lower efficiency.
fig.  <dig> organization of the initially triple, then double overlapping reading frame region of hepatitis c virus  . the top gene organization map is adapted from fig. 1
a of  <cit> . all coding regions mentioned in the following include a terminal stop codon. the second line depicts the core in-frame protein, coded in nucleotides 342– <dig>  next, a  <dig>  kda protein is coded in nucleotides 344– <dig>  while protein f is coded in nucleotides 346– <dig>  the double stem-loop frameshift stimulating signal  is found at nucleotides 365-501; the fss structure is depicted in fig. 8



fig.  <dig> hcv ribosomal frameshift stimulating signal . a proposed pseudoknotted structure from  <cit> . b minimum free eneergy  structure computed by rnafold  <dig> . <dig> , with added pseudoknot . green arcs indicate common base pairs; red arcs indicate base pairs predicted by rnafold but not present in the structure from  <cit> ; blue arcs indicate pseudoknot base pairs from the model proposed by  <cit>  that are absent from the rnafold mfe structure. figures produced using jviz  <cit> 




out of  <dig>  sequence hits for the hcv <dig> frameshift signal for the lanl hcv database , we found that 94% of the sequences started with . furthermore, downstream of the slippery sequence a double stem-loop structure facilitates translational frameshifting . for this analysis, we took nucleotides 344- <dig> from the  <dig> nt hcv subtype 1a genome  <cit> , corresponding to the region starting at the triple coding region and extending to the end of double-stem loop. using rnasamplecds we computed the logo plot for all sequences that code blosum <dig> + <dig> similar peptides to those coded by the reference genome . using rnaifold  <dig>  <cit> , we generated more than  <dig> million sequences that fold into the double-stem loop structure indicated in fig.  <dig> and which have blosum <dig> similarity of at least + <dig> to the reference genome peptides . although rnaifold  <dig>  does not support pseudoknot structures, by providing structural compatibility constraints, we ensured that every sequence returned by rnaifold  <dig>  has the property that the nucleotides, which participate in the “kissing hairpin” model of fig. 1
a of  <cit> , can indeed form a base pair together. note that the set of all sequences returned by rnaifold  <dig> , which satisfy both the coding and structural requirements, forms a proper subset of the set of all sequences returned by rnasamplecds, which are required to satisfy only the coding requirements. figure 9
c depicts the total variation distance between these sequence two profiles. at positions where the total variation distance is zero, the secondary structure is likely to be induced by the overlapping coding constraints. indeed, a mutation in such positions could lead to a disruption of the double stem-loop or to a modification of the amino acid in one of the overlapping reading frames. our results from fig. 9
c agree with experimental evidence showing that modifications of nucleotides at positions  <dig>   <dig>   <dig> and  <dig> lead to detrimental mutations for the hepatitis c virus  <cit> . mutations at these positions resulted in an attenuated hcv infection in chimpanzee. according to our analysis, an introduction of mutations at positions whose variation distance is much greater than zero, should allow the disruption of the double-stem loop with minimal effects on the protein function. this hypothesis could be tested experimentally. 

to further investigate whether the overlapping coding requirement of hcv possibly induces the fss double stem-loop structure, we proceeded in a manner analogous to that for our hiv- <dig> analysis. we sampled  <dig>  rna sequences using rnasamplecds with blosum <dig> similarity of + <dig> and  <dig> to the reference peptides in each reading frame. using rnashapes, we computed the average boltzmann probability of formation of a double-stem loop with shape 
, in the sampled rna sequences as well as  <dig>  sequences from lanl database . average boltzmann probability of the double stem-loop shape 
 is 19%  for blosum <dig> similarity of + <dig> , compared with 98% probability for the sequences from lanl hcv database. in contrast, dinucleotide shuffles of sequences generated by rnasamplecds having blosum <dig> + <dig> similarity to the reference peptides have average probability of 5% of double stem-loop formation, while the probability double stem-loop formation is 6% for random rna sequences generated with probability of  <dig> for each nucleotide. additional file 1: figure s <dig> displays average double stem-loop probability and free energy results for the hcv overlapping coding region, which are analogous to results for hiv- <dig> presented in fig.  <dig> 
fig.  <dig> 
a exact sequence logo determined by rnasamplecds for all  <dig> × <dig> sequences, whose initial  <dig> nucleotides code amino acids having blosum <dig> + <dig> similarity to the corresponding amino acids from each of the three reading frames in the triple overlapping coding region 344- <dig> of the reference hcv genome, and whose remaining nucleotides code amino acids having blosum <dig> + <dig> similarity to the corresponding amino acids from each of the two reading frames in the double overlapping coding region 383- <dig> of the reference hcv genome. b sequence logo determined by rnaifold  <dig>  for the more than  <dig> million sequences that fold into the hcv fss structure depicted in fig.  <dig>  whose initial  <dig> nucleotides code blosum <dig> + <dig> amino acids having blosum <dig> + <dig> similarity to the corresponding amino acids from each of the three reading frames in the triple overlapping coding region 344- <dig> of the reference hcv genome, and whose remaining nucleotides code amino acids having blosum <dig> + <dig> similarity to the corresponding amino acids from each of the two reading frames in the double overlapping coding region 383- <dig> of the reference hcv genome. c total variation distance shown for each nucleotide position, determined by computing the total variation distance between the position-specific profiles of  and 




CONCLUSIONS
in this paper, we have developed the novel program rnasamplecds, the only existent program which computes the number of rna sequences that code user-specified peptides in one to six overlapping reading frames, as depicted in fig. 1
b. more importantly, rnasamplecds can compute  pssms and sample, in an unweighted or weighted fashion, a user-specified number of rna sequences that code the specified proteins . with extensions to rnaifold <dig>  made in this paper, rnasamplecds and rnaifold <dig>  complement each other and together allow one to analyze the hiv- <dig> gag-pol overlapping reading frame and the hcv triple overlapping reading frame in a manner that cannot be supported by any other software, thus augmenting the software arsenal available to evolutionary biologists.

additional file

additional file  <dig> supplementary information for “new tools to analyze overlapping coding regions”. 




abbreviations
arfpalternative reading frame protein

cpicodon preference index

dpdynamic programming

fssframeshift stimulating signal

hcvhepatitis c virus

hivhuman immunodeficiency virus

mfeminimum free energy

pssmposition-specific scoring matrix, also called profile

