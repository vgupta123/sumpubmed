BACKGROUND
the rapid accumulation of high-throughput genomic data provides the foundation to computationally infer previously unknown regulatory relationships between transcription factors and their target genes. dna microarrays have been widely applied to measure genome-wide mrna abundance of many organisms under different conditions. to infer regulatory relationships from gene expression data, many of the computational analysis methods developed to date focus only on the experimental dataset itself, by evaluating similarities between expression patterns using either clustering algorithms such as hierarchical clustering  <cit>  and self-organizing maps  <cit> , probabilistic graphical models  <cit> , or the context likelihood of relatedness   <cit> .

most of these methods do not take full advantage of the vast amounts of molecular interaction information accumulated by the research community, including gene-gene regulatory interactions  <cit> , dna-protein binding  <cit> , metabolic pathways  <cit>  as well as sets of genes related to diseases or cell functions  <cit> . knowledge bases collect, curate, and perform quality control of the previous findings, either manually by expert biologists  <cit>  or computationally by artificial intelligence programs  <cit> , from peer-reviewed publications  <cit>  and/or from data of high-throughput experiments  <cit> . different knowledge bases can vary in many aspects, such as the source of the original information, quality of the data curation, and the comprehensiveness of the database. recent approaches have begun to utilize prior knowledge for a variety of computational analyses of genomic data including metabolic network modeling  <cit> , inference of activities of transcription factors  <cit> , significance analysis and classification using gene sets  <cit> , and inference of transcriptional regulation relationships  <cit> . these studies demonstrate that knowledge-based methods can help uncover important biological information from high-throughput genomic data. we have developed an improved algorithm to systematically utilize information in a large collection of previously known interactions between transcription factors  and target genes  for the discovery of previously unknown gene regulation. first, we estimated the regulatory signal of a tf, mainly from the centroid expression of the known co-regulated tgs of the tf. we then built a predictor to discover new regulatory pairs based on the relationship between the regulatory signal of the tf and the expression of the candidate genes. we also used our approach to characterize the various properties of knowledge bases and investigated their performance in regulatory-pair prediction.

using the yeast proteome database , a large database created from manual curation of peer-reviewed publications by experts  <cit> , we analyzed the utility of the knowledge base in inferring new transcriptional regulations from gene expression data sets of saccharomyces cerevisiae. we show that the knowledge base provides valuable additional information to characterize pairs of genes linked by transcriptional regulations, and predictions made using prior knowledge have significantly better performance than those from experimental data alone. further, we tested prediction performance using knowledge bases of different characteristics, and show that a knowledge base with comprehensive, direct and high-quality interactions results in better performance in analysis. finally, we predicted  <dig> new regulatory pairs through genome-wide analysis, and by evaluating these pairs in a chip-chip binding dataset  <cit>  and a growth fitness data set  <cit> , we suggest that they can be reasonable candidates for further biological verification.

methods
data sources
we evaluated the usefulness of a knowledge base for finding new regulatory pairs on a well-known collection of  <dig> microarrays of yeast, described by stuart et al.  <cit> . we include in our study the  <dig>  genes which have missing data rates of less than 30%; the overall missing data rate in the resulting dataset is less than 1%.

we describe knowledge bases containing information manually curated from literature as having "direct information", and those with information extracted from high-throughput data as having "indirect information". here we assume that findings of a tf and its tgs specifically reported in peer-reviewed publications are more likely to be direct and specific regulations. in addition, we define comprehensiveness of a knowledge base to be proportional to the number of regulatory pairs in the collection. quality of a knowledge base is quantified as the number of false positive interactions for a given number of true gene interactions. the repository of gene interaction pairs of transcriptional regulation from the ypd is an example of a direct knowledge base. we extracted  <dig>  pairs of transcriptional interactions between  <dig> tfs and  <dig> tgs from the ypd for inclusion in our analysis of this direct knowledge base.

to evaluate the validity of our genome-wide predicted regulatory relations, chip-chip binding data from harbison et al.  <cit>  and a growth fitness dataset of homozygous gene deletions having growth fitness data of  <dig>  genes in  <dig> conditions  <cit>  were used as independent data sources. the growth fitness score was calculated as the log ratio of the growth rate of the gene deletion to that of the control.

representation of gene expression
let eij be the expression level for gene i of array j, and n be the total number of the arrays in our collection. the na√Øve-representation  for gene i is defined as the following.   

with a knowledge base, we can use the known co-regulated tgs to define a new representation. let si be the set of tgs regulated by gene i in the knowledge-base. we define the knowledge-based-representation  for gene i as follows:   

ni is the number of tgs regulated by the gene i in the knowledge base. the kbr represents the centroid expression of gene i and tgs that it regulates. if a gene is not a tf or there is no known tg for the gene, the kbr of the gene is equal to the nr. the kbr of a tf can also be considered as reflecting the regulatory signal for the tf.

classification methods and generation of negative sets
to evaluate the performance of prediction with knowledge-based analysis, we used two classification algorithms, correlation cutoff and support vector machine . the correlation cutoff method measures the correlation between representations of a tf and a candidate tg. pairs with a correlation value greater than a certain cutoff are called true regulatory pairs. a pearson correlation coefficient was used as a measurement of correlation. the correlation approach can be applied to both the nr and kbr for a pair of genes. the nr cutoff method uses the correlation between nrs of a tf and a tg, while the kbr cutoff method uses the correlation between kbrs. receiver-operation-characteristic  curves of cutoff methods are plotted by changing cutoff thresholds. svm uses an optimal marginal classification, which builds the decision boundary maximizing distance from the boundary to the training samples of each class in the feature space  <cit> . it has been shown to have good scalability to large data sets with high accuracy  <cit> . we can use nr and kbr to build a feature for svm. the nr svm method builds a feature vector of a regulatory pair by concatenating the nrs of the tf and the tg. the procedure for the kbr svm approach is identical except for the use of kbrs instead of nrs. the nr svm method is the same as used in qian et al.  <cit> . roc curves of svm methods are plotted by changing thresholds of prediction scores. the prediction score of an svm is defined as the distance of a tested sample from the optimal decision boundary. here, we use svm-light  <cit> , an open-source implementation of the svm algorithm, with a radial kernel function.

in order to build and evaluate predictors of cutoff and svm methods, the  <dig>  pairs of transcriptional interactions extracted from ypd served as the positive regulatory set, and the negative training and test sets in which the pairs have no regulatory interactions were randomly selected from all possible tf-tg pairs under the assumption that genome-wide regulatory relations are sparse  <cit> . in order to reflect sparseness of true regulatory relations, we chose negative sets ten times larger than positive sets, as in qian et al.  <cit> . in addition, negative sets were generated using the distribution of positive sets so that the number of false relations of a tf would be proportional to the number of true relations of the tf.

the clr and serend algorithm
software implementations of the clr and serend algorithm were obtained from their supporting websites  <cit> . the algorithms were applied to our yeast data with default parameters. the serend algorithm was performed without sequence motifs information for a fair comparison, and the expression classifier scores were used as the final prediction scores.

RESULTS
representation of gene expression using a knowledge base
there have been many studies to infer new gene regulations based on gene expression data alone. these methods are based on examining the correlation in gene expression pattern between a tf and a candidate tg under the assumption that a tf and its regulated tgs will be co-expressed and have higher correlation or richer mutual information in expression  <cit> . although this model may fit reasonably well for a subset of known tfs  <cit> , we expect that it does not hold for many others. many tfs require complex post-translational modifications to switch on the transcription of tgs; this activation process is often independent of the expression level of the tf in the absence of a self regulatory loop. therefore, expression of a tf does not necessarily imply activation and the transcription of its tgs.

to illustrate the challenge of inferring regulatory relations with only co-expression patterns, we measure correlation coefficients between expression levels of a tf and its tg in a well-known collection of  <dig> microarrays of yeast  <cit> . for the positive regulatory set, we collected a set of  <dig>  known regulatory pairs from the ypd database, while the negative regulatory sets were randomly selected from all possible tf-tg pairs minus the  <dig>  positive pairs as described in methods. as shown in figure 1a, the expression profile of a single tg did not correlate well with its tf for the true positive regulatory pairs from the knowledge base. comparing with the random negative pairs, the distribution of correlation coefficients of the true regulatory pairs showed a similar gaussian-like curve and peak position, despite of small shift. although this is a na√Øve measurement, it clearly shows the difficulty to distinguish true and false regulatory relations from gene expression data alone.

the knowledge base of gene regulations provides valuable additional information. for each of the known tfs, there is a set of confidently identified tgs that the tf regulates. we expect that tgs regulated by the same tf are likely to share similar expression profiles. to verify this, we measured correlation coefficients over the same data set as in figure 1a. for the true regulation set from the knowledge base, a correlation coefficient is calculated between the expression level of a tg and the centroid of expression levels of the other tgs regulated by the same tf. in contrast, for the random regulatory pairs, a correlation coefficient is calculated between a gene and the centroid of the known set of tgs regulated by a randomly chosen tf. these two distributions were distinct - the distribution of the true regulatory pairs exhibited higher correlation values compared to the random false pairs . therefore prior knowledge of regulatory relationships provides us unique characteristics of true regulatory pairs that are distinguishable from the false pairs. here, to reduce the noise of individual genes, we chose to use the correlation between the centroid of the set of known co-regulated genes and a candidate gene instead of individual gene correlations.

improvements in predicting transcriptional regulations using knowledge-based analysis
next, we compare methods using either na√Øve-representation  with the microarray data alone or knowledge-based-representation  that includes both the microarray data and the collection of prior knowledge, on the same gene expression data set as the previous section. the kbr was designed to include both tg expression terms which are expected to be dominant for tfs with many known tgs, and tf expression which can be informative for tfs with few or no known tgs. the true and random regulatory sets in the previous section were used as the positive and negative sets respectively, and two-fold cross-validations was performed for all tfs together. for the cross-validation, training and test sets were randomly separated and mutually exclusive, and the kbrs were encoded using information from training sets only. to evaluate the impact of the knowledge base driven analysis, we first used a simple correlation cutoff classifier; that is, if the correlation between a representation of a tf and a candidate tg was larger than a certain cutoff value, the regulatory pair was labeled a true regulation, and otherwise it was labeled false. predictions with a knowledge base show better performance than without a knowledge base . at a 10% false positive rate, the nr cutoff  corresponded to a 18% true positive rate while the kbr cutoff  had a 48% true positive rate. in addition, a svm method utilizing known regulations in a knowledge base to predict new regulations shows the best performance, a 80% true positive rate at a 10% false positive rate. this improvement is expected because while the cutoff classifier only considers information of co-regulated genes, the svm classifier includes additional information such as co-regulated genes and co-regulating tfs as well as information about false regulations.

to further evaluate the benefit of knowledge bases for other previously established methods, the nr and kbr were applied to the clr algorithm  <cit> . the clr algorithm estimates a likelihood of the mutual information score between a tf and a tg, and determines the pair to be true or false by comparing the estimated likelihood with its background distribution. in the original clr algorithm, the mutual information is obtained from gene expression profiles of a tf and a tg, which are the same as their nrs. by substituting nrs to kbrs, the performance improvement gained by incorporating prior knowledge can be measured for the clr algorithm. as before, kbrs were encoded with the positive training set, and the performance was measured over the test set. while the clr algorithm with the nrs showed reasonable predictive power for e. coli, it did not predict well for yeast, managing a 15% true positive rate at a 10% false positive rate . we suspect that the complex regulatory mechanisms of eukaryotic organisms can possibly induce such performance reduction. in contrast, the kbr clr algorithm showed a much better performance with a 42% true positive rate at the same 10% false positive rate under the same conditions. in addition, the kbr clr had comparable performance with a 50% true positive rate at 10% false positives of the serend  algorithm, which is a supervised approach using a knowledge base that previously showed a significant improvement over the nr clr for e. coli  <cit> . these results indicate that a knowledge base can help improve the prediction power and accuracy for regulatory relations, and we found that the svm method utilizing kbr showed over all the best performance .

important characteristics of knowledge bases
a knowledge base is a representation of our existing understanding of biology; therefore, it is not complete. different knowledge bases often vary on the type of original sources-direct vs. indirect evidence of regulation, the comprehensiveness and the quality of the collections. intuitively, direct, comprehensive and high quality knowledge of regulation relationships are important characteristics of a knowledge base.

to evaluate the directness of a knowledge base, we compared the ypd database  <cit>  and chip-chip data  <cit>  with p-value less than  <dig> . the ypd database includes direct knowledge of regulations collected from the literature, while chip-chip binding data provides evidence of binding between a tf and a tg. since the binding of a tf to the dna of its tg is considered a necessary but not sufficient step in transcriptional activation, chip-chip data can be considered as indirect knowledge of transcriptional regulations. we tested these two types of prior knowledge using nr svm. first, we randomly chose two sets of  <dig>  pairs among  <dig>  ypd database pairs and  <dig>  chip-chip binding pairs as positive training sets. among the rest of the  <dig>  ypd database pairs, we chose  <dig> pairs that are not included in either of the two positive training sets as a positive test set.

negative training and test sets were generated according to the distribution of the positive sets. the roc curves of the two knowledge bases show that the direct knowledge base have better performance than the indirect one . another possible explanation for the above observation is that bindings of tfs to dna were measured in only few conditions, mainly in rich media  <cit> , while the ypd knowledge base has regulatory information collected from vast number of different experiments. since the microarray expression dataset from stuart et al.  <cit>  was collected from experiments under various conditions, the chip-chip results from harbison et al.  <cit>  might not reflect the regulatory relations well across all these experiments.

to evaluate the importance of the size of a knowledge base, we tested kbr cutoff and kbr svm on several sets of knowledge of different sizes. each algorithm was applied to build classifiers trained using 1/ <dig>  1/ <dig>  1/ <dig> and 1/ <dig> of the knowledge base, and it was tested on the rest of the knowledge base. as expected, the prediction performance diminished as the size of the prior knowledge decreases . since our kbr methods explicitly utilized the averaged expression values of the known tgs to reduce the noises and identify the common signal of regulation, more comprehensive information on the known regulatory relationships lead to the improved sensitivity and accuracy of the predictions.

we analyzed the prediction performance corresponding to different knowledge base qualities by adding different amount of artificial false positive regulatory relations to the existing knowledge base. we built a positive training set with a half of the knowledge base, true positives. we then added random false positives of a half, equal and twice size of the true positives to the positive training set. the other half of knowledge base was used for a positive test set. negative training and test sets were generated as before. as shown in figure 3c, the predictions with less false positives in the knowledge base demonstrated better performance for both of kbr svm and kbr cutoff methods. since false positives in the training set perturb the predictor and add noise to the averaged expression values that we utilize here, high quality knowledge bases have more advantages in the inference of new regulatory pairs.

genome-wide inferences of new regulatory relations
finally, genome-wide predictions were performed to identify candidate novel regulatory pairs. we used the kbr svm method that showed the best performance in the cross-validation tests. the full ypd database served as the positive training set, and the negative training set was generated randomly. we tested all possible pairs of  <dig> tfs and  <dig>  genes, and discovered  <dig>  candidate regulatory relationship pairs . this cutoff threshold corresponds to ~ <dig> % of false positive rate in the cross-validation tests. among them,  <dig> pairs were found to be new regulatory relations not previously included in the ypd database. the re-discovery rate of known regulatory relations was  <dig> %  by selecting top  <dig> %  of total candidates.

while these predicted relations can be verified using individual experiments, the verification experiments are often difficult to conduct at a large scale. we therefore evaluated the predicted regulatory pairs with an independent source of high-throughput data, a well-known chip-chip binding dataset  <cit> . among  <dig> predicted pairs,  <dig> pairs were tested in the chip-chip experiment, and these pairs had a significantly lower p-value distribution in binding than randomly selected pairs . even though binding of protein to dna does not guarantee transcriptional activation, most of the transcriptional regulatory processes are expected to include binding. therefore, lower p-values of the predicted pairs imply that the predicted pairs have higher chance to be verified as true regulatory relations.  <dig> predicted pairs with prediction scores larger than  <dig>  and chip-chip binding p-values less than  <dig>  are listed in table  <dig>  some of the predicted regulatory pairs are indirectly supported by independent studies. for example, the binding of ifh <dig> to the promoter position of rps22a was observed independently through high-resolution chip  <cit> , and gcn <dig> was reported to contribute to the induction of ade <dig> from microarray experiments on wild-type and gnm <dig> mutant strains  <cit> . we also noticed that not all the  <dig> pairs of candidates had significant p-values in the chip experiment, and we suspect that this is partially because the predictions are based on gene expression data measured under many different conditions together with accumulated previous knowledge while the chip-chip experiment used for comparison was mainly under rich media. in addition, using the growth fitness dataset of homozygous yeast gene deletions under chemical genomic profiling  <cit> , we examined the phenotypic correlations of co-regulated tgs by the same tfs. as shown in figure 4b, the co-regulated genes had higher correlation with each other in phenotypes compared with random pairs. we suspect that the phenotypes of deletions of co-regulated tgs tend to have higher correlations because co-regulated tgs tend to have enriched similarity in biological functions. to test this hypothesis for the  <dig> predicted pairs, we measured the correlation between the fitness of a predicted tg and the fitness centroid of the known tgs of its predicted tf, and compared the distribution with randomly selected pairs. the predicted pairs had significantly higher correlation than the random pairs as previously known pairs . rigorous determination controlled by  <dig> % of false positive rate can induce higher correlation of the predicted pairs than known pairs. the above tests on these independent experiment datasets suggest that the predicted regulatory pairs can potentially be reasonable candidates for follow-up biological verifications.

CONCLUSIONS
in this work, we show that a knowledge-based approach significantly helps the characterization of true gene transcriptional regulatory interactions from non-regulatory random pairs. the expression patterns between co-regulated tgs were much more highly correlated compared to random pairs. in addition, predictions of transcriptional regulations using a knowledge-based approach achieved significantly better performance than using the high throughput genomic data alone. we also examined the impact of several properties of the knowledge base on prediction performance, and showed that the sensitivity and specificity increase when using a high-quality, comprehensive knowledge base with direct regulatory information. finally, we performed genome-wide prediction over all possible tf-tg pairs and determined  <dig> pairs as new candidate regulatory relations. these predicted regulatory pairs have significantly lower p-values in chip-chip binding dataset and higher correlation in growth fitness with previously known tgs. overall the results suggest that knowledge-driven analysis significantly helps the interpretation of high-throughput genomic data. several efforts are underway to build high quality, comprehensive knowledge bases from peer-reviewed publications that integrate genomic, chemical and systemic functional information, including bind, proteome, ipkb, kegg, reactome and others. these databases will enable further development of statistical and machine learning approaches for the integrative analysis of high-throughput experimental data, especially in the studies of higher organisms. we will further evaluate applying our methods to these studies.

competing interests
the authors declare that they have no competing interests.

authors' contributions
js, rd and wx conceived the project and design. js implemented the algorithms and performed the computational analysis. js and wx wrote the paper, and ak critically revised it. all authors read and approved the document.

