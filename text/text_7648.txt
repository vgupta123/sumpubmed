BACKGROUND
a common observation in the analysis of gene expression is that many genes are co-regulated <cit> . when genes are co-regulated under various biological conditions, the corresponding expression profiles may display relative similarity, or co-expression. to identify these co-expressed genes, various cluster and factor analysis methods have been applied to microarray datasets. among the most popular unsupervised clustering methods used for the analysis of gene expression data are hierarchical clustering  <cit> , k-means  <cit> , self-organizing maps   <cit> , clustering affinity search technique   <cit> , partitioning around medoids   <cit>  and click <cit> . these clustering methods, e.g. som and k-means, provide a number of cluster centroids to which genes with similar expression profiles are closely situated. however, it is well-known that the number of clusters or varying the starting seed in these cluster methods can produce very different results. in addition, these clustering methods are vulnerable to the presence of "scattered" genes  <cit>  and can lack robustness when there is little spatial separation between the clusters  <cit> . numerous alternative methods have been developed to improve the utility of k-means and som for clustering gene expression data, such as clustering based on pre-defined sets of gene expression profiles  <cit> . supervised clustering methods such as those utilizing predefined patterns  <cit> , require a priori knowledge of the underlying pattern in the data and may allow exclusion of unknown but biologically meaningful patterns.

click, a clustering algorithm based on graph theory connectivity, a probabilistic framework and fundamental statistics, does not rely on assumptions or prior knowledge about the clusters or their structure, yet identifies tight and highly similar groups  that are likely to belong to the same true cluster  <cit> . overall homogeneity , and separation of elements in clusters from each other, are two criteria that click relies on to evaluate the quality of the cluster structure. these measures are similar to the intra-compactness and inter-separation distances indices that are used to evaluate the validity of clustering solutions  <cit> .

among factor analysis methods are independent component analysis   <cit>  and partial least squares   <cit> . ica and pls approaches for analysis of gene expression data generally provide biologically meaningful patterns among the top listed components which consist of a large number of co-expressed genes. however, if a perturbation to a biological system stimulates a relatively large number of co-expressed patterns or when a pattern contains only a small number of co-expressed genes, many of them may not be revealed by these methods. we present a novel profile-based method for extracting microarray gene expression patterns and identifying co-expressed genes, designated as epig. through analysis of correlations among profiles, the magnitude of variation in gene expression within profiles, and evaluation of the profile signal-to-noise ratios, epig extracts a set of patterns representing co-expressed genes. using a simulated data set, we compared epig to click and cast to evaluate the generation of the appropriate number of patterns. in addition, we applied epig and click to a c. elegans dauer recovery and l <dig> starvation time course gene expression data set  <cit>  to compare the ability of the algorithms to extract patterns related to either dauer-specific recovery or l <dig> starvation. finally, we applied epig to a combined uv and ir treated time-series data set. through gene ontology analysis of the co-expressed genes, enriched categories provided hints to underlying co-expression, biological processes, and the molecular function of the genes.

RESULTS
to evaluate the ability of epig to extract patterns from gene expression data, we used both epig and click to analyze a simulated data set, a publicly available dauer recovery and l <dig> starvation gene expression data set from caenorhaditis elegans  <cit>  and the uv and ir treated fibroblast lines gene expression data. click was selected as the comparator because, as similar to epig, the method does not rely on any assumptions or prior knowledge about the clusters or their structure unlike that of soms or k-means. the extraction of patterns and categorization of co-expressed genes by epig is analogous to clustering the genes  by click. in other words, a pattern in epig is equivalent to the pattern extracted from the centroid of a cluster generated by click.

comparison of click and epig using simulated data
analysis of dauer recovery and l <dig> starvation gene expression from caenorhabditis elegans
a data set consisting of gene expression profiles from a c. elegans dauer recovery and l <dig> starvation time course study was obtained to compare epig's and click's ability to extract patterns/clusters the data for identification of co-expressed genes from a publicly available microarray data set. the experimental design and other details of the study can be obtained from wang et al  <cit> . applied to the data which included all the genes, epig extracted  <dig> patterns of gene expression and identified  <dig> co-expressed genes . the numbers of genes categorized to each of the patterns varied from  <dig> to  <dig> . on the other hand, click generated only  <dig> clusters of genes from the data  and magnitude of expression , including all  <dig> genes identified by epig) as shown by the patterns of the centroids in figure s <dig> in additional file  <dig>  if we applied click to the whole gene data set as what was done for epig, click produced over  <dig> clusters .

in dauer-specific processes, there were four groups of genes corresponding to the dauer recovery: transient, early, climbing and late  <cit> . table  <dig> lists the dauer recovery-specific gene expression patterns from both epig and click corresponding to the four groups of co-expressed genes along with the dauer enriched state. there were no clusters generated by click which contained genes with expression patterns related to either early or climbing states. however, there were four patterns which corresponded to the transient, late and dauer enriched states. on the other hand, the patterns of the genes extracted by epig corresponded to each of these dauer recovery response groups. for example, there were four patterns  in which expression levels of all of the genes decreased from early to late corresponding to the dauer transient state. however, these four patterns differed slightly from one another. for instance, patterns  <dig> and  <dig> have no change at the start, then the expression of the genes gradually decreases to be substantially down-regulated at the end. however, their corresponding l <dig> starvation expression levels were either down-regulated  or not changed  across all the time points. conversely, patterns  <dig> and  <dig> reflect no change at all time points in l <dig> starvation, but the response of the genes to dauer recovery were either up-regulated at the start, then gradually decreased to no change at end  or had no change at the start, were up-regulated early, then gradually decreased to no change at end . similarly, one may relate epig's patterns  <dig>   <dig> and  <dig> to the dauer recovery early state and pattern  <dig> to the climbing state. there were no clusters generated from click that contained patterns of the centroids corresponding to these two dauer-specific states . the patterns from epig and click showing similar responses between dauer recovery and l <dig> starvation were not listed in table  <dig> 

those patterns not listed below possess similar responses between dauer recovery and l <dig> starvation except the late responses.

expression patterns and co-expressed genes in response to uv- and/or ir-induced dna damage
we next applied epig to a microarray data set that combined gene expression profiles of both ionizing radiation - and ultraviolet -treated human fibroblast cells with two goals in mind: 1) to find similar and dissimilar responses between treatments and 2) to reveal differences in gene regulation upon dna damage caused by ir or uv. in each of the two treatments, the data consisted of four biological states, i.e. sham-treated,  <dig> h-,  <dig> h-, and  <dig> h post uv- or ir-treatment. a gene expression profile consists of eight inter-groups, corresponding to four states from the two treatments. each of the intra-groups contains six data points from three biological replicates and two technical replicates  for a given treatment at a given time point. as such, each gene expression profile consisted of  <dig> data points. epig analysis using the whole data as its input resulted in total of  <dig> patterns as shown in figure  <dig> with a total of  <dig> co-expressed genes being identified. each of the co-expressed genes was categorized to a particular pattern. figure  <dig> is a heat map of the  <dig> genes that are arranged in the order of pattern number from top to bottom. table  <dig> lists the number of genes in each of the patterns and denotes their over-represented gene ontology biological processes <cit> .

*includes biological processes, molecular function and cellular component.

each pattern shown in figure  <dig> includes both uv  and ir  treatments. for each treatment there are three individual cell lines . each one consists of four time-series points, i.e. sham-treated controls ,  <dig> h- ,  <dig> h- , and  <dig> h-  post uv or ir treatments. patterns  <dig> through  <dig> show uv-specific expression  with little or no changes in gene expression in ir-treated cells. uv-specific up-regulation of gene expression  happened only at early time points,  <dig> and/or  <dig> h after uv irradiation, and fully recovered to baseline levels at  <dig> h. as shown in table  <dig>  the  <dig> genes in patterns 1– <dig> were related to transcriptional regulation, rna processing and nucleic acid binding. uv-specific down-regulation of gene expression  also occurred at early time points . biological processes related to regulation of transcription were also over-represented by these genes. in addition, over  <dig> genes in pattern  <dig>  which were substantially repressed at  <dig> h post uv, contained about  <dig> biological processes over-represented including purine nucleotide binding, protein modification, ubiquitin cycle, kinase activity, and cell growth.

genes in patterns  <dig> to  <dig> responded to both uv- and ir-treatment but with different time dependencies. in pattern  <dig> expression was up-regulated at  <dig> and  <dig> h post uv-treatment and then recovered to near baseline levels at  <dig> h. genes in this pattern were minimally up-regulated at  <dig> h post ir but showed substantial down-regulation at  <dig> h and even greater down-regulation at  <dig> h. many genes that are maximally expressed in s phase were in this pattern, including cdc <dig>  fen <dig>  msh <dig>  orc6l, pcna, polg, rbm <dig>  ccne <dig> and top3a. the changes in expression of these genes were coincidental with changes in the s phase compartment of the cell cycle. s phase cells were increased over control at  <dig> and  <dig> h post-uv , but were moderately reduced relative to control at  <dig> h and markedly reduced at  <dig> h post-ir  <cit> .

patterns  <dig> and  <dig> contained  <dig> genes including the p53-target genes gdf <dig>  btg <dig>  plk <dig>  bak <dig>  plk <dig> and cdkn1a  and tp53inp <dig>  sesn <dig>  ddb <dig> and fdxr . all of these genes were up-regulated at  <dig> h after uv treatment, they peaked at  <dig> h and then returned to baseline at  <dig> h. however, they responded differently to ir. in pattern  <dig>  the genes peaked at  <dig> h post ir then decreased to a stable level at  <dig> h and  <dig> h. the genes in pattern  <dig> displayed continuous increases in expression until  <dig> h after ir.

patterns  <dig> to  <dig> contained  <dig> genes in total that were mainly regulated at the late time point after treatment . more than  <dig> genes in pattern  <dig> were down-regulated at  <dig> h post ir or uv treatment. this pattern included many cell cycle-regulated genes functioning in the g1/s and g2/m transitions, such as cdk <dig>  cdc <dig> and mcm <dig>  these genes were strongly down-regulated in ir-treated cells, but had substantially less change in uv-treated cells. both patterns  <dig> and  <dig> show late up-regulated responses, but genes in former were up-regulated after treatment with both uv and ir while those in the latter only responded to ir. the top biological process in pattern  <dig> was complement activation with lysosome and lytic vacuole being the main cellular components that the products of the genes in the patterns might be associated with or located in. finally, many genes exhibited co-expression in patterns  <dig> ,  <dig>  and  <dig>  but uv and ir treatments induced opposite changes in their gene expression.

as a comparison, we also applied click to the  <dig> genes identified as differentially expressed using the snr  and magnitude of expression  criteria. this set of genes included all  <dig> co-expressed genes identified by epig. in this case, click clustered the gene expression data into  <dig> groups . similar patterns from the centroids of the clusters were revealed in comparison to the ones extracted by epig. however, click was unable to reveal some patterns extracted by epig which we consider to have biological importance related to dna repair in responding to uv and ir treatments. among them are epig's patterns  <dig>   <dig> and  <dig> . as presented above, many of the genes in pattern  <dig> were s phase-related and the majority of genes in patterns  <dig> and  <dig> were known to be related to p53-dependent cell cycle control.

homogeneity evaluation of the patterns/clusters of gene expression profiles
it is vital that the extracted patterns and their associated genes can be inspected for their biological meaningfulness as presented above. on the other hand, it is also essential that that the extracted patterns or clusters of genes formed be validated objectively using some evaluation indicies. although there were a number of methods developed to validate clusters, each of them is suitable to some specific applications. for example, one may use the general silhouette  to measure the stability of the clustering structure  <cit> . the higher gs score indicates better formed clusters. but the gs measure seems to work best for cases where the number of clusters are small  <cit> . given the above simulated data, we obtained gs scores of  <dig>  and  <dig>  for the pattern from epig and the clusters from click, respectively. however, when we applied the gs measure to either of the above dauer recovery and l <dig> starvation or uv and ir dna damage data sets, the gs scores was deemed inappropriate to judge cluster validity due to the higher numbers of extracted clusters. other methods, for example, the gap statistic  <cit> , validate clusters depending on the number of groups in the data as determined a priori. however, both epig and click are unsupervised approaches. therefore, to objectively and appropriately compare the two methods, we calculated the overall average homogeneity  <cit>  within clusters  and the averaged correlations between clusters/extracted patterns. the overall average homogeneity measures the amount of cohesion within a cluster/pattern whereas the averaged correlation measures the amount of separation between clusters/patterns  <cit> . the results are listed in table  <dig>  as can be seen, in each of the cases of the three data sets, the overall average homogeneities from epig are consistently higher than those from click and cast  suggesting that epig has better compactness of the profiles in the patterns than the clusters of the genes generated by the other clustering algorithms. the averaged correlations for all the methods were low , indicating that the expression of the genes in the patterns were quite dissimilar each other. however, it is clear from this result that click performed better than epig and cast with respect to the between cluster correlations .

another observation is that the numbers of clusters generated by click were always lower than the number of patterns extracted by epig and the number of clusters generated by cast was about  <dig>  when different affinity threshold values were used for analysis. however, if we use the whole data set as the input data for click, as what was done for the analysis of the data with epig, click produces over  <dig> clusters in both dauer recovery/l <dig> starvation and uv/ir dna damage data sets. a figure of merit   <cit>  analysis of the either data set showed that for cases when the number of clusters were larger than  <dig>  the adjusted fom values slowly decreased. this suggests that the number of clusters of genes in the data set could be between  <dig> and  <dig>  well below the  <dig> clusters produced by click when using the entire gene expression data set .

discussion
with a pair-wise calculation of the pearson's correlation coefficient r, co-expressed profiles form discrete local clusters or mountains in a correlation topomap  <cit> . the probability is less than 10- <dig> that two arbitrary and independently generated data sets of size  <dig>  e.g. the joined uv and ir data set shown in figure  <dig>  are correlated with an r-value greater than  <dig>   <cit> . when there exist tens of thousands of gene expression profiles, many of them, which are inconsistently expressed among replicate groups or intra-groups, may appear to be similar by chance and form a correlation local cluster due to stochastic noise. unlike factor analysis methods, such as ica, or clustering methods, such as click, k-means or som, our approach called extracting patterns and identifying co-expressed genes  not only calculates the similarity among the profiles, but also evaluates each profile via signal-to-noise  ratio measurements . through a filtering procedure, epig removes profiles that don't fit into a pattern. only the profiles with high s/n ratios and desirable magnitudes of expression change are included in the formation of patterns representing co-expressed genes. with such a profile evaluation strategy, epig is able to extract patterns of co-expressed genes without predefined seeding.

in a head-to-head comparison, epig competed with click and cast in the analysis of a simulated data set by 1) extracting all of the designated patterns, 2) accurately categorizing the profiles to their appropriate patterns, and 3) generating patterns of profiles with higher homogeneity and more stability . however, it is clear that click outperformed epig and cast in terms of generating clusters/extracted patterns that are more dissimilar to each other . furthermore, given the two experimental data sets presented above , epig extracted more patterns of gene expression than click . the patterns extracted by epig which were not represented by any of the cluster centroids generated by click contained genes which related to key biological responses coupled to the experimental treatments. for example, in the case of uv and ir dna damage, the patterns extracted by epig contained p <dig> cell cycle control target genes  and many s phase genes  of the mitotic cell cycle .

* results generated with an affinity threshold value of  <dig> . two singleton profiles were not reported or included in the analysis of the homogeneity and correlation measures.

there are two main thresholds used in epig pattern extraction: the local cluster size threshold mt and the correlation threshold rt. rt determines the closeness in similarity that is allowed among the extracted patterns. depending on the sample size, one may determine rt such that the most similar patterns possess clear response differences. for example, in figure  <dig>  patterns  <dig> and  <dig> have a correlation r-value of  <dig> . but the two contain genes with expression patterns that display a clear difference in the response to uv-induced dna damage. in pattern  <dig>  gene expression was repressed only at  <dig> h post-uv while in pattern  <dig>  gene expression was repressed at both  <dig> and  <dig> h post-uv. mt is the minimum number of the genes in a local cluster needed to have a profile candidate deemed as a pattern. the value of mt affects the pattern extraction outcome. higher mt values may cause a meaningful pattern with a lower number of co-expressed genes to be concealed. on the other hand, lower mt values may lead to the extraction of some patterns lacking biological meaningfulness. to test for an optimal mt setting, we varied its values from  <dig> to  <dig> and performed epig analysis on the ir-treated gene expression data. figure  <dig> shows that the average pattern snr increased with the increase of mt, while the number of extracted patterns decreased. this result is seems plausible considering the observation that as mt increases, more correlation local clusters are filtered-out since their cluster sizes are less than mt. the fewer extracted patterns then have higher averaged snrs. however, when mt ≥  <dig>  the snr had an up-shift and the number of extracted patterns had a down-shift. this result prompted us to set mt to  <dig> in the given data set. to be precise, one should vary these thresholds empirically for a given data set to examine the outcomes. we have done just that and have concluded that, upon many sets of the gene expression data analyzed by using epig, selections of mt at  <dig> and rt at  <dig>  have worked reasonably well . incidentally, there may be some genes with profiles not similar to any other gene or their related local cluster had a size less than mt. then these "orphan" genes  will not be considered as a pattern candidate nor will they be categorized to any extracted patterns. attention certainly needs to be paid to these orphan genes, as a part of the epig analysis result, to determine if they have a unique role in the treatment response.

epig is a general method for gene expression analysis when the data consists of profiles with multiple inter-groups and multiple samples intra-groups. each intra-group has a specific biologically relevant factor. the inter groups account for the factor variations. for example, in the ir time- series data set, since the intra-group included both biological and technical replicates, the common response features among different cell lines were identified. on the other hand, if the intra-group included only the technical replicates, then one would reasonably expect to extract patterns representing idiosyncratic responses in individual cell lines. the responses to dna damage that are common among biological individuals are intriguing because they are conserved, but individual-specific responses also are of interest as they point to inter-individual variations in response to external perturbations.

the application to the joined ir and uv data set had eight inter-groups, four each  to ir and uv respectively. in this case, similar and dissimilar responses between ir- and uv- induced dna damage can be clearly observed . for example, uv-specific response patterns included genes functioning in transcription regulation, rna processing, nucleotide binding, and cell growth . the over-represented categories of gene ontology from the  <dig> genes in pattern  <dig> included purine nucleotide binding, protein modification, ubiquitin cycle, kinase activity, and cell growth. it appears that protein kinases may be generally down-regulated specifically via phosphorylation in response to uv-induced dna damage  <cit> . two early response patterns  <dig> and  <dig> in figure  <dig> showed that both uv and ir caused these genes to be up-regulated, but in different ways. many of the genes in these two patterns have been widely studied and known to be related to p53-dependent cell cycle control. the two different patterns of response to ir imply that factors other than p <dig> also influence the expression of p53-target genes. pattern  <dig> in figure  <dig> showed similar late down-regulation responses to both uv and ir treatments. there were  <dig> genes in pattern  <dig> participating in a number of important biological processes among them were mitotic cell cycle, dna replication, dna repair, cell cycle checkpoint, and g0-like status transition  <cit> .

in general, the inter-group-related factors are not limited to the time variable only. as a matter of fact, epig has been applied to many different data sets, where the variable factors include time, treatments , doses, organs , or organ sections . as such, epig is a robust, flexible and new pattern extraction method which is generally applicable to a variety of microarray data sets.

CONCLUSIONS
epig competed with click and performed better than cast in extracting patterns from simulated data. however, epig extracted more biological informative patterns and co-expressed genes from real biological data: both c. elegans and ir/uv-treated human fibroblasts. using gene ontology analysis of the genes in the patterns extracted by epig, several key biological categories related to p53-dependent cell cycle control were revealed from the ir/uv data. among them were mitotic cell cycle, dna replication, dna repair, cell cycle checkpoint, and g0-like status transition. the extraction of these biologically responsive processes by epig provides a deeper understanding of the underlying biological mechanism in the perturbed system.

