BACKGROUND
empirical scoring functions, or knowledge-based potentials, have been successfully applied to a wide variety of problems in biomolecular modeling. these scoring functions are derived from the statistics of residue or atomic interactions as observed in experimental protein structures. most such scoring functions depend on amino acid side chain conformations, either through the definition of residue contacts  <cit>  or through the dependence of the potentials on the distances between side chain atoms or residue centroids  <cit> .

another class of scoring functions, which includes the ones considered in this study, depend only on the protein backbone conformation. these scoring functions have two significant advantages:  they can be directly applied to proteins structures with unknown or uncertain side chain conformations and  they can be rapidly calculated. because they are independent of the side chain conformations, these scoring functions can be applied to proteins for which the correct side chain conformations are not available from experimental structures. in such cases, computationally expensive and potentially inaccurate side chain optimization would be necessary in order to evaluate a side chain-dependent scoring function for the protein structure. comparative modeling results have shown that although successful methods usually agree on the core backbone structure, they have considerably more difficulty in predicting correct side chain conformations  <cit> . also, because backbone-only scoring functions do not require side chain optimization they can also be used to evaluate protein structures more quickly. protein design applications require such a fast but approximate evaluation of protein stability for a large number of sequences. because of the high-dimensional search space for side chain geometry optimization, empirical scoring functions that depend only on backbone geometry offer a computationally efficient solution to these tasks. finally, even modeling problems in which a complete atomic structure of a protein is required can be efficiently accomplished using a multi-scale approach in which potential structures are first filtered using the fast backbone-only scoring function and the remaining structures then subjected to more time-consuming all-atom refinement and rescoring.

the non-uniform angular distributions of side chains about residues of different types observed in protein structures  <cit>  suggests that residue pair scores that depend on the relative position and orientation of the residues will discriminate native from non-native protein structures better than scores that depend only on the residue separation distance. some previously developed scoring functions incorporate this orientation dependence through the orientation of residue side chains  <cit> . the scoring functions derived in this study also incorporate orientation dependence but, unlike those scoring functions, they depend only on the protein backbone conformation. two previous studies have examined orientation-dependent empirical potentials for backbone structures. the study of onizuka et al.  <cit>  defined local coordinate systems centered on cα atoms and fit residue pair potentials that were either functions of their relative position  or their relative position and orientation . potentials were fit to data for different sequence separations using a truncated expansion in terms of spherical harmonics. the low-order terms included in the expansion yield a smoothed potential function that presumably eliminates sampling noise. a comparison between 1d , 3d, and 6d potentials with different expansion cutoffs showed that the 3d potential performed the best in ranking the native structure from among decoys. a later study by miyazawa and jernigan  <cit>  also used similar spherical harmonic expansions in order to derive orientation-dependent potentials that were a function of backbone coordinates. unlike onizuka et al., these were residue contact potentials and so did not have any explicit dependence on the separation distance. more importantly, the residue contact potentials in miyazawa and jernigan are not strictly backbone-only potentials since they implicitly depend on side chain conformations via a smooth contact cutoff that is a function of the distances between the geometrical centers of the two residue side chains. also, unlike onizuka et al., miyazawa and jernigan concluded that accounting for the relative orientation of residue pairs through euler angles using a 5d residue contact potential improved fold recognition performance over a 2d potential that accounts only for the relative positions of the contacting residue pairs. whereas the scoring functions in those studies were tested using folding decoys, the scoring functions considered here are designed and tested for the different modeling problem of fixed backbone protein design. the appropriate decoy structures in this case are incorrect fixed backbone threading solutions with the correct backbone structure but incorrect amino acid sequences. the scoring functions described here are optimized to detect the correct  sequence from among many incorrect  sequences for a common backbone structure.

we have developed position and orientation-dependent residue pair scoring functions that depend only on the protein backbone structure, i.e. are completely independent of side chain conformations. as discussed above, these scoring functions are expected to be useful for protein design as well as fold recognition. 6d scoring functions that depend on both the relative position and orientation of the residue pairs were compared with 3d scoring functions, which depend only on the relative position, and with 1d scoring functions, which depend only on the separation distance. also, the challenging task of estimating the high-dimensional residue pair distributions was solved using a different method, gaussian mixture models , than the spherical harmonic expansions employed in the two previous studies. one advantage of gmms is that they are able to directly estimate the 3d and 6d residue pair distributions, including off-diagonal contributions from multiple orientational variables. another advantage of the gmm formulation used in this study is that the optimal model complexity, or number of parameters, is estimated from the data using the bayes information criterion  statistic  <cit> .

the relative effectiveness of the 1d, 3d, and 6d scoring functions was evaluated by their ability to identify the correct threading solution from among a set of decoy threading solutions generated either by shuffling the native sequences or by cross-threading for a large non-redundant set of proteins. the new scoring functions were also compared with side chain-dependent empirical potentials from other studies using the same decoy set. also, in order to illustrate the utility of the new backbone-only scoring functions two computational methods that exploit their advantages over traditional side chain-dependent potentials were studied. the first method involves averaging the residue pair scores over threading solutions for homologs. because homologous proteins with significant sequence similarity usually adopt the same backbone structure such a procedure is expected to improve accuracy by combining scores for these distinct but structurally similar proteins. this method was applied to the difficult problem of predicting interactions between alpha helices in membrane proteins using fixed backbone threading and found to further improve accuracy. the second application of the new scoring functions involves using a fast approximate optimization method, called belief propagation, to estimate the optimal sequence for a given protein backbone structure. this design method was compared with one using all-atom modeling on a fixed protein backbone structure and found to be more robust to inevitable small backbone variations between the template and native protein structures.

RESULTS
overview of the backbone-only residue pair scoring functions
the new backbone-only log-odds residue pair scoring functions were derived as the logarithm of the ratio between the backbone orientational distribution of residue pairs in correct native structures and the corresponding distribution for incorrect decoy structures, which corresponds to randomly shuffled amino acid sequences for the same native backbone structures. the latter background distribution is the same as the distribution of all residue pairs in protein structures, regardless of their type. such a background decoy distribution is appropriate for the desired modeling application of fixed backbone protein design and threading but is non-optimal for other applications, such as ab initio protein folding. also only residue pairs that are at least  <dig> residues apart in the protein sequence and with cβ separations ≤  <dig> Å were included in the scores. this eliminated residue pairs that were too close in the linear sequence so that their relative position and orientation are largely determined by the local secondary structure as well as residue pairs that were too far apart and so have little orientational preference because they only interact weakly. the 1d, 3d, and 6d scoring functions were derived based on the distributions of separation distances, relative positions, and both relative positions and orientations of particular residue type pairs, respectively. while the 1d scoring functions were fit using kernel density estimation , the difficult high-dimensional density estimation for the 3d and 6d scoring functions could not be accomplished by kde so that another technique, gaussian mixture models , was employed.

prediction accuracy for individual residue type pairs
the performance of the scoring function was first evaluated for each of the  <dig> residue type pairs individually in order to find out which individual residue pairs make the largest contributions to the overall protein threading accuracy. the performance of each residue type score was assessed by the area under the receiver operating characteristic  curve  for 10-fold cross-validation results. the roc curve displays the tradeoff between sensitivity and specificity as the score cutoff is varied. higher auc values, near  <dig> , indicate better prediction performance.

the cross-validation sets were created by randomly dividing the residue pair data for the non-redundant set of proteins into  <dig> approximately equal-sized sets such that all data for a particular protein is contained within only a single set. the predictions were then made on each set using log-odds scoring functions fit to data in the other  <dig> sets. this procedure then gives an estimate of the performance on novel data since the predictions are made for residue pair data from proteins unrelated to those used to fit the scoring functions.

the residue pairs whose 6d scores have the highest accuracy are cys-cys and all paired combinations of iso, leu, and val. the high accuracy of the cys-cys score is due to the fact that a large percentage of such pairs  form conformationally constraining disulfide bonds thus making their distinctive relative orientation easier to predict. iso, leu, and val are some of the most commonly occurring residues, particularly in the protein core where they can form more contacts than residues on the surface. in fact, there is a significant correlation  between the prediction accuracy, as measured by the auc, and the number of training examples for each residue type pair. this means that generally the accuracy is better for common residue pairs than for rare ones, presumably because a large quantity of independent training examples are necessary in order to fit the high-dimensional probability densities. the median auc over all  <dig> residue pairs was  <dig> .

for comparison, the same analysis was also performed for the distance-dependent 1d scores. the results showed that some of the same residue pairs had the highest accuracy as for the 6d score, namely cys-cys as well as all combinations of iso, leu, and val. however, in addition the same-charge residue pairs glu-glu and asp-glu were among the most accurately predicted residue pairs. this is likely due to the unfavorable electrostatic energy for close separations, which is reflected in negative scores at close separations for these residue pairs. figure  <dig> shows a plot of the 1d residue pair scores for cys-cys and glu-glu and illustrates these trends as a function of inter-residue separation. the median auc for the 1d scores was  <dig> , which is lower than that for the 6d scores. as will be seen in the next section, the higher accuracy of the individual 6d residue scores translates into higher accuracy for total protein threading scores.

it is somewhat surprising that the accuracy of the individual residue pair scores was significantly correlated with the amount of training data even for the 1d scores . this implies that there is still room for improvement in both the 1d and 6d scores and that their accuracy will likely increase as new experimental structures of proteins become available and provide additional independent training data.

threading prediction accuracy on a benchmark set
the accuracies of the residue pair scores were assessed in two ways:  by their ability to identify the native sequence of a protein from among a set of  <dig> distinct decoy sequences and  cross-threading of all sequences in the benchmark set against a subset of the structures. in order to reliably estimate the prediction accuracy for novel data and to account for potential overfitting, 10-fold cross-validation was used for both test methods, thus insuring that the scoring functions were fit to a different set of protein structures than the set of proteins used to assess their accuracy. in the first test method,  <dig> decoy sequences were generated for each protein in the benchmark set by shuffling the native sequence. cross-validation predictions were then made for all  <dig> sequences  and the rank of the native sequence determined. the results for this test are shown in table  <dig>  in the second test method, all-against-all gapless cross-threading was performed for the  <dig> structures in the first cross validation set using residue pair scoring functions fit to the remaining  <dig> structures in the benchmark set. only sequences with at least as many residues as the template structure were threaded and all possible gapless alignments were considered. this resulted in a total of over  <dig> million threading solutions for all protein structures. the number of possible threading solutions varied dramatically between structures and ranged from  <dig>  for the largest template structure, to  <dig> for the smallest template structure. because of this large variation, the fractional rank of the native sequence, or ratio of the rank of the native sequence to the number of threading solutions for the particular template structure, was reported, rather than the absolute rank of the correct  sequence. these results are shown in table  <dig> 

the  <dig> threading solutions for each of the  <dig> template structures were ranked using either the 1d, 3d, or 6d residue pair scores or five different empirical potentials with available published parameters. the empirical potentials evaluated were from miyazawa and jernigan  <dig>  <cit>  , tobi and elber  <dig> , rajgaria, mcallister, and floudas  <dig>  <cit>  , and rajgaria, mcallister, and floudas  <dig>  <cit>  . the values indicate the number of protein structures for which the rank of the native sequence was within the indicated percentile. the corresponding percentage of the total structures is given in parentheses.

the number of structures for which the percentile rank of the native sequence was less than or equal to the indicated cutoffs are given in columns 2- <dig> and the median percentile rank is given in the last column. the corresponding percentage of the total structures is given in parentheses. the threading solutions were ranked using the indicated residue pair scoring function.

score accuracy improves with increasing dimension
both the results for shuffled sequences, in table  <dig>  and the results for cross-threading, in table  <dig>  show that the prediction accuracy steadily improves as the dimension of the scoring function increases from 1d to 3d to 6d. although the largest incremental improvement occurred in going from 1d to 3d potentials, the highest dimensional 6d potentials still had significantly higher accuracy than the 3d potentials in both tests. this conclusion contrasts with that of onizuka et al.  <cit> , who found that their 3d potentials achieved higher accuracy than their 6d potentials. however, this result agrees with the general conclusion of miyazawa and jernigan  <cit> , although as mentioned above, the contact potentials in that study differ from the backbone-only scoring functions considered here.

comparison with other empirical potentials
the accuracy of the backbone-only scoring functions was also compared with that of one other backbone-only potential, that of rajgaria, mcallister, and floudas  <dig>  <cit>  , as well as with several conventional side chain-dependent empirical potentials. this was accomplished by calculating the total energies for the same threading benchmark set used to evaluate the backbone-only scoring functions. the results, as evaluated by the ranks of the native sequences, are given in table  <dig>  side chain-dependent empirical potentials from the following studies were evaluated: miyazawa and jernigan  <dig>  <cit>  , tobi and elber  <dig> , and rajgaria, mcallister, and floudas  <dig>  <cit>  . these particular potentials were chosen because they all have available published parameters. the mj <dig> potential was the only residue contact potential while the other side chain-dependent potentials were a function of the side chain centroid separation distances. side chain conformations were generated for the template backbone structures using the rosetta  <dig> program  <cit> .

the results in table  <dig> show that the mj <dig> contact potential was the most accurate among the five other empirical potentials. they also indicate that this potential achieves better performance than our 1d scoring function but worse performance than our 3d and 6d scoring functions. the other four empirical potentials all had lower accuracy on the benchmark set than even the 1d scoring function. this may be due to the fact that these four potentials were originally designed for different protein modeling tasks than fixed backbone design. the te <dig> potential was optimized to discriminate correct structures from decoys generated from a combination of gapless threading and all-atom structure prediction while the other three potentials  were optimized to discriminate correct structures from among decoys generated from all-atom structure prediction. the background distribution for decoys generated by all-atom structure prediction is expected to be different from that for decoys generated by fixed-backbone threading, which is most relevant for this test. however, these results demonstrate that the 3d and 6d backbone-only scoring functions achieve accuracy that is competitive with side chain-dependent empirical potentials without requiring time-consuming prediction of side chain conformations prior to score evaluation.

examination of the difficult threading cases
the protein structures for which the most sensitive scoring function still gave poor threading results were examined in detail in order to determine common factors that may contribute to the difficulty of recognizing the correct solutions using the 6d score. for this purpose, all structures for which the 6d score assigned the native structure a rank greater than  <dig>  were examined. a total of  <dig> structures satisfied this criterion. five properties were overrepresented in these structures as compared with the other structures in the benchmark set. these distinctive characteristics of the structures were  solved by experimental methods other than x-ray diffraction ,  small protein domains,  large disordered regions,  subunit in a complex, and  few residue-residue contacts. these properties are not independent since nmr can only be used to solve relatively small proteins and also can be used to obtain structures of proteins with disordered regions, which by definition have few residue-residue contacts. a total of  <dig> of the structures were solved by nmr and one was a structure fit to electron microscopy data. this proportion of non-x-ray structures was significantly higher  than in the set of other benchmark set structures, which included 973/ <dig> non-x-ray structures. a total of  <dig> protein structures contained significant disordered regions, which also had multiple conformations in the nmr structure ensembles. in addition, five of the proteins were subunits in a structure of a protein complex and so may be unstable as monomers. finally, because many structures had little regular secondary structure , they also had relatively few residue-residue contacts compared to more structured, compact proteins. these properties are interdependent so that it is unclear whether the poor threading performance is because nmr structures may contain significant errors  <cit> , or because they have few non-local residue-residue contacts that contribute to the total score, or because the disordered regions cannot be reliably recognized by the score.

combining the residue-pair scores of homologs improves threading accuracy
proteins with significant sequence similarity usually have similar backbone structures  <cit> . this suggests an approach to improving threading accuracy by combining a potential threading solution with the corresponding solutions for homologous proteins. this can be accomplished by calculating the average over the score for the original threading solution and the scores for the homolog threading solutions, each obtained by replacing the native sequence segment with the aligned segment of a homolog sequence. this method is well suited to the backbone-only scoring functions because the scores can be quickly evaluated for the multiple homolog threading solutions. it should be noted that this procedure is applicable only to protein threading applications and not to protein design because it requires protein sequences that are evolutionarily related to the query sequence.

this procedure was tested using all-against-all cross-threading of a non-redundant set of contacting pairs of transmembrane α-helices in membrane proteins. this is a particularly challenging task for threading because of the limited number of inter-helical residue contacts, compared with the number of residue contacts in a typical complete protein structure. cross-threading was performed for a non-redundant set of  <dig> contacting tm helices, which significantly differ both in sequence and structure. the effects of three different factors on the threading accuracy were investigated by calculating the percentile rank of the correct solution among all cross-threading solutions for each tm helix pair. first, the scores calculated by averaging the threading scores over homologs were compared with the usual scores calculated for just the native sequences. second, the scores were calculated both with and without a membrane depth-dependent scoring function that reflects the propensity of each residue type to occur at a particular depth in the membrane. third, the effect of the size of the tm helix pair interface was studied by calculating prediction statistics for only the  <dig> tm helix pairs that have at least  <dig> inter-helix residue contacts . the results for all  <dig> tm helix pairs are shown in table  <dig> and the results for the large interface helix pairs are in table  <dig> 

the backbone structure of each helix pair was used as a template and the amino acid sequences of all helix pairs were threaded into the structure in both possible helix correspondences,  and , and in all possible ungapped alignments. the threading solutions for each template structure were ranked using the appropriate score and the percentile rank of the correct native sequence calculated. these results show that both including the homolog sequences and including the depth-dependent score improve the threading accuracy.

comparison with the results in table  <dig> show that the threading accuracy is higher for this subset of helix pairs with large interfaces, because of the stronger signal resulting from more inter-helix residue contacts.

the results in tables  <dig> and  <dig> show that each of the three factors have clear effects on the threading accuracy. most importantly, combining threading scores for homologs significantly improves the threading accuracy, as can be seen by the lower median percentile rank of the correct solution when homologs are included. as expected, including the depth-dependent scoring function also improves the accuracy because it provides information on the suitability of the threading solution that is independent of the residue pair score. finally, the accuracy is considerably higher for the subset of helix pairs with more residue contacts. this can be explained by the fact that additional residue contacts provide more constraints on potential threading solutions and thus lead to better discrimination of correct solutions. a more extreme example of this trend can be seen by comparing the cross-threading results for the tm helix pairs with those for complete proteins shown in table  <dig>  the much lower percentile rank of the correct threading solutions, indicating higher accuracy, for complete proteins is likely due in large part to the much greater number of residue contacts in the larger complete proteins.

calculating the optimal sequence using belief propagation
next, we demonstrate how the new backbone scoring functions can be applied to solving problems in protein design without computationally costly conformational sampling. one question that arises in the context of protein design and the study of protein folding is what amino acid sequences yield the most stable proteins with a given backbone structure. based on the boltzmann hypothesis of empirical threading potentials, which implies that the most commonly observed interactions in protein structures also have the lowest energy, this problem can be translated into finding amino acid sequences that maximize the total score for the backbone structure of interest. in this study we consider the contributions of single residues and residue pair interactions but not any higher order  residue interactions. the total score, stotal, is then   

in which ti is the type of residue i, pi are its properties , and Ωij are the relative position and orientation between residues i and j. the same amino acid sequence that maximizes stotal for a fixed backbone also maximizes its exponential   

because the objective function, , is to be optimized with respect to the amino acid sequence  for a fixed backbone, its implicit dependence on the backbone geometry, through the pi and Ωij parameters, is not shown.

the function in eq.  has the same functional form as a pairwise markov random field  model, up to a multiplicative constant 1/z, where z is the partition function. the partition function is independent of the amino acid sequence. since only the sequence that maximizes eq.  is of interest, and not its maximum value, this constant may be ignored.

the main advantage of interpreting the objective function in eq.  as a mrf is that an efficient method, called belief propagation   <cit> , can be used to solve it. there are two formulations of bp, the standard algorithm to calculate marginal distributions for a mrf and the max-product algorithm to calculate the maximum a posteriori  solution. because we would like to find the sequence that maximizes eq. , the latter max-product algorithm will be used. eq.  can also be solved as an integer linear programming problem  <cit> , however bp offers a simple and fast alternative that generally yields accurate approximate solutions  <cit> . the map problem was solved by first converting the pairwise mrf corresponding to eq.  into an equivalent factor graph and then using the max-product algorithm implemented in the libdai c++ library  <cit>  to solve it.

comparison of optimal amino acid sequences with native sequences
most protein design methods, including the one described here, assume a fixed backbone structure because accounting for backbone flexibility would dramatically increase the number of degrees of freedom to be sampled. however, x-ray crystallographic studies have shown that proteins accommodate mutations in core residues by adjustments in the backbone structure  <cit> . this raises the question of how much bias the fixed backbone approximation introduces into protein design methods and whether this bias can be partially corrected by the backbone flexibility implicit in the smooth 6d residue pair scoring functions introduced here. this was studied by comparing the sequence identity between optimal sequences for backbone structures from two homologous proteins within the same family. a test set of protein structure pairs was compiled for this purpose by randomly selecting pairs of protein structures from the same homstrad  <cit>  family. each pair was selected from a different family and the final set contained a total of  <dig> protein pairs. homstrad families contain proteins with significant sequence or structure similarity so that each pair of proteins are presumably homologous.

we also studied the related question of how similar the optimal sequence is to the native sequence and how this similarity is affected by the protein design method. a previous study by kuhlman and baker  <cit>  investigated this question using a fixed backbone design protocol that involved monte carlo sampling of both side chain conformations and residue types using all-atom energy based scoring with rosetta. the conclusion was that the sequence similarity between the optimal and native sequences is high, with identical residues for 51% of the buried core residues and 27% of all residues in the set of  <dig> backbone structures considered. however, the fixed backbone structure may lead to higher apparent sequence similarity because it is unable to accommodate as many mutations, primarily because of steric clashes in the protein core. in addition, many proteins share significant structure similarity without having any recognizable sequence similarity  <cit> . in these cases, the similarity between the optimal and native sequences must be low.

both of these questions were examined by comparing the results using the protein design method described in the previous section, involving bp optimization using the 6d residue pair scores, with the results obtained using the rosetta program  <cit> . the rosetta optimal sequences were obtained using the default fixed backbone design algorithm implemented in rosetta version  <dig> . the two questions were investigated by comparing  the similarities between the optimal sequences for each pair of proteins in the same homstrad family  and  the similarities between the optimal and native sequences for a given backbone structure , respectively. sequence similarities were calculated both for all residues and for only core residues, which were defined as in ref.  <cit>  as those residues with >  <dig> cβ atoms within  <dig> Å. separate sequence similarities were also calculated separately for high-resolution  and low-resolution  protein structures. the results are shown in table  <dig>  first, both the intrastructure and interstructure similarities were higher for the core residues. this trend agrees with that observed in ref.  <cit>  and can be explained by the fewer allowed residue substitutions in the protein core due to stricter constraints resulting from van der waals, hydrophobic, and to a lesser degree hydrogen bonding interactions  <cit> . another clear trend that is apparent from these results is that the intrastructure similarity is higher for rosetta than the bp method. however, in contrast, the median interstructure similarity for bp derived optimal sequences are almost identical to that obtained by rosetta. if these latter results are further broken down by the resolution of the protein structures then it is seen that rosetta designed sequences have higher interstructure similarities for low-resolution structures whereas the bp method has higher interstructure similarities for high-resolution structures. one interpretation of these results is that the scoring functions have a smoother dependence on the backbone structure and thus yield more consistent optimal sequences for the similar backbones of homologous proteins. this interpretation is also supported by the lower dependence of the bp method on the resolution for both the intrastructure and interstructure similarities. furthermore, the lower interstructure similarity for the bp method may be partly due to the fact that a fold is actually more permissive of different sequences once backbone flexibility is accounted for, rather than simply the expected lower accuracy of the residue pair scoring functions compared with the all-atom modeling of rosetta. in conclusion, even though both design methods rely on a fixed backbone approximation, the protein design method using the residue pair scoring functions yields optimal sequences that are more robust to the small variations in backbone structure that occur within protein families.

the similarities were calculated as percent sequence identity . the optimal sequences were calculated using the 6d residue pair scoring functions with belief propagation  and using the rosetta program. the last three rows give the number of structure pairs for which the bp sequence similarity was less than, greater than, or equal to the similarity calculated using rosetta. the calculations were performed for a total of  <dig> structure pairs, each in a different homstrad protein family.

CONCLUSIONS
the performance of 1d, 3d, and 6d residue pair scoring functions that depend only on the protein backbone structure were compared by their ability to identify correct threading solutions in a large benchmark set of proteins. the accuracy was found to improve as the dimension increased, with 6d scoring functions the most accurate. the orientation-dependent scoring functions were also found to achieve higher accuracy than several side chain-dependent empirical potentials on this benchmark set. this is remarkable since the backbone-only scoring functions do not require prediction of the side chain conformations, which is computationally demanding, particularly for many protein design applications. interestingly, a previous study  <cit>  also found that a backbone-only statistical potential outperformed a side chain-dependent potential, although the potential was derived and evaluated using decoy sets appropriate for folding rather than for fixed backbone design. we also found that averaging the threading scores for the query sequence and aligned segments of homologous sequences further improved the accuracy for protein threading applications. incidentally, because those results were obtained for membrane proteins, they also demonstrated that the scoring functions can be successfully applied to the tm regions of membrane proteins even though they were derived from a data set containing predominantly non-membrane proteins. the applicability of the scoring functions to both membrane and non-membrane proteins is likely due to the fact that most of the residue pairs involve buried residues, which are not strongly affected by the distinct physiochemical environments of these two classes of proteins. however, direct comparison between the performance of the scoring functions on membrane and non-membrane proteins is needed to conclusively confirm this hypothesis. in addition, comparisons of predicted optimal amino acid sequences for pairs of similar backbone structures within the same protein families revealed that the 6d scoring functions were more robust to the small backbone rearrangements observed between homologous proteins than fixed-backbone all-atom modeling. thus the 6d scoring functions should perform well in actual protein design applications in which the backbone structures of the designed and template proteins are expected to differ slightly.

several possible extensions of this work are possible. first, as expected by the geometrical dependence of their physical interactions, accounting for the relative position and orientation of residue side chains should improve the accuracy of empirical scoring functions that depend on side chain conformations. several previous studies have investigated such scoring functions, but with fewer relative degrees of freedom  <cit> . the same method used here for fitting 3d and 6d backbone-only scoring functions with gmms could also be applied to such side chain conformation-dependent scoring functions. one difficulty is deciding the best choice of reference coordinate systems for larger flexible side chains. second, the same methodology described here for deriving scoring functions for protein threading could be directly applied to derive similar residue pair scoring functions for other modeling tasks, such as ab initio protein structure prediction or protein-protein docking, by using the appropriate set of decoy structures. finally, as mentioned earlier, the residue pair scoring functions can be employed in a fixed-backbone protein design procedure to generate initial protein sequences that are then subjected to all-atom optimization and scoring in order to select the optimal solutions.

