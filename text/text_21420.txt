BACKGROUND
high-throughput cdna sequencing has emerged as a powerful tool to globally assess the transcriptional state of cells. however post-transcriptional processing and modification events add layers of complexity to transcriptomes that are typically not revealed by standard rna-seq technologies. for example, processed ribosomal rna  typically constitutes 95 % of the total rna in prokaryotes with only a minority of the rna corresponding to protein coding transcripts  <cit> . such rna processing confounds the identification of key transcriptional events such as the start and end of transcription and, more generally, the original composition of primary transcripts. thus, being able to decouple the primary transcriptome from processed rna is key to determining the association between the regulatory state of the genome and its phenotypic outcome. identifying the primary transcriptome depends on the ability to distinguish the initiating 5′ nucleotide incorporated by the rna polymerase from all the other 5′ ends that arise due to processing. the currently available methods do not use targeted enrichment for the 5′end of primary transcripts, but rather attempt to deplete non-targeted rna.

here we present a significant advance in transcriptomics to directly and universally target the first nucleotide that has been incorporated by the rna polymerase upon initiation of transcription. this nucleotide marks the transcription start site on the genomic sequence. our strategy consists of enzymatically labeling, with a biotin derivative, transcripts that have retained their original initiating 5′ nucleotide. only transcripts that have an intact 5′ triphosphorylated  end are biotinylated and isolated from the in-vivo processed rna. we refer to enzymatic labeling of the 5′ triphosphorylated end of rna and subsequent enrichment and high-throughput sequencing as cappable-seq.

cappable-seq has a broad range of applications, offering the ability to investigate the triphosphorylated population of rna molecules that would otherwise be masked by the overwhelming majority of their processed counterparts. by accurately anchoring the origin of the transcript to single base specific position on the genome, cappable-seq reduces sequence complexity to a unique tag per transcript. the identification of the transcription start sites  to single base resolution enables the association between the regulatory state of a genome and its transcriptome. thus, changes in transcription factor binding profiles and/or epigenetic states, notably at promoters, can be associated with changes in transcription by quantifying tss usage.

while various methods for determining prokaryotic tss have been developed, all of them attempt to circumvent the inability to directly capture the 5′ triphosphorylated ends. the most widely used method, tex relies on eliminating the processed transcripts by treating rna samples with xrn <dig> exonuclease. this exonuclease preferentially degrades rnas containing a 5′ monophosphate, therefore resulting in an apparent enrichment of primary transcripts containing 5′-triphosphates . however xrn <dig> has been previously reported to be blocked by secondary structure which could lead to incorrectly annotated tss . to increase the specificity of the tex method, a control non-xrn <dig> treated library is subtracted from the tex library. this method is referred to as differential rna-seq .

as a proof of concept, we applied cappable-seq for the precise determination of tss genome-wide in e. coli. cappable-seq was performed on total rna and a remarkable number of  <dig> tss at single base resolution were found. we show that cappable-seq is highly specific to triphosphorylated rna characteristic of tss. compared to rna-seq, cappable-seq reduces the complexity of the transcriptome, enabling digital profiling of gene expression. processed ribosomal rna are also reduced from an overwhelming majority of total rna to only 3 %, allowing a deeper sequencing of the informative transcriptome at lower cost. by applying cappable-seq to a mouse cecum sample, we demonstrate for the first time, identification of tss from a microbiome. we identified tss in species from different bacterial phyla and found novel promoter consensus regions in all phyla analyzed. leaderless transcripts account for  <dig> to 15 % of identified tss in some species of the microbiome such as akkermansia muciniphila and bifidobacterium pseudolongum. after cappable-seq, ribosomal rna represents less than 5 % of rna for the majority of species analyzed suggesting that most of the sequences represent tss of protein coding transcripts. thus, this methodology provides a unique solution for tss determination and digital profiling of gene expression of microbiomes while universally removing the contaminating ribosomal rna that constitute the major cost burden of transcriptomes and meta-transcriptomes.

RESULTS
cappable-seq captures the triphosphorylated rna and enriches for primary transcripts
cappable-seq isolates the primary transcripts by enzymatically capping of the 5′ triphosphorylated rna with a biotinylated gtp using vaccinia capping enzyme . for this purpose, we screened a number of biotinylated derivatives of gtp and found that 3′ oh modifications of ribose of gtp are acceptable substrates for vce. the biochemistry of capping and decapping are presented in supplemental note a and figures s <dig>  s <dig> and s <dig> . the reaction results in the specific labeling of 5′-di or triphosphorylated rna ends while the 5′-monophosphorylated rna ends characteristic of processed transcripts are not labeled : figures s <dig> and s4). the biotinylated rna can then be captured on streptavidin beads and isolated : figure s3).

application of cappable-seq to e. coli reveals an unprecedented number of tss
we first applied cappable-seq for the genome-wide identification of tss in the model organism e. coli mg <dig>  for this, total e. coli rna was capped with 3′-desthiobiotin-teg-guanosine 5′ triphosphate  for reversible binding to streptavidin, fragmented to an approximate size of  <dig> bases, captured on streptavidin beads and eluted to obtain the 5′ fragment of the primary transcripts . to achieve single base resolution, a cappable-seq library was generated by ligating 5′ and 3′ adaptors to the rna. in this case the labeled cap must first be removed from the rna to allow the ligation to the 5′end. we found that rpph efficiently removes the desthiobiotinylated cap structure to leave a ligatable 5′-monophosphate rna : figures s <dig> and s6).fig.  <dig> cappable-seq pipeline for tss identification. a schema of cappable-seq protocol and the associated control library. b replicate analysis. the correlation coefficient between replicate  <dig> and replicate  <dig> rrs is  <dig> . c enrichment score as a function of the mean of relative read score for the  <dig> putative tsss found in e. coli grown on minimal media. in blue are tss that are enriched in cappable-seq library. grey are positions that are depleted in cappable-seq. the removal of depleted positions eliminates  <dig> spurious tss primarily located in ribosomal loci



a non-enriched control library was prepared using identical conditions as cappable-seq except that the streptavidin capture step was omitted. both libraries were sequenced using illumina miseq yielding approximately  <dig> million single end reads. reads were mapped to the e. coli genome using bowtie <dig>  <cit> . the orientation and mapped location of the first mapped base of the sequencing read determines the genomic position of the 5′ end of the transcript at single base resolution. the number of reads at a specific position defines the relative expression level of the 5′ end of the primary transcript. we normalized this number with the total number of mapped reads to obtain a relative read score  reflecting the strength of each tss, thus defining a single quantifiable tag per transcript that can be used for digital gene expression profiling. a technical replicate generated using the same total e. coli rna preparation resulted in a correlation coefficient of  <dig>  demonstrating the high reproducibility of cappable-seq .

the ratio between the rrs from cappable-seq and the non-enriched control libraries defines the enrichment scores with enriched positions corresponding to 5′-triphosphorylated ends characteristic of tss and depleted positions corresponding to processed/degraded 5′ ends . to define tss, we selected positions on the genome with a rrs of  <dig>  and higher  and found  <dig>  positions satisfying this criteria. next, we subtracted the  <dig> positions that are depleted in the cappable-seq library when compared to the non-enriched control library . this resulted in  <dig> unique positions that we define as tss. this step reduces the number of positions by only  <dig>  %. as most of the false positive positions are located in ribosomal genes, the exclusion of positions located within those genes drops the false positive rate to only  <dig>  %. therefore the need to sequence a non-enriched rna library in order to calculate an enrichment score is not critical with cappable-seq whereas a non-enriched library is required to perform drna-seq  <cit> .

the accurate description of tss in prokaryotes relies on the differentiation of the 5′-triphosphorylated end which characterizes primary transcripts from the 5′-monophosphorylated end which characterizes processed sites. comparing the results of cappable-seq with the results of kim  <cit>  and thomason  <cit>  demonstrates the higher specificity of cappable-seq for 5′ triphosphate rna . indeed while cappable-seq correctly calls  <dig> out of  <dig> processed sites, drna-seq  <cit>  mis-annotated  <dig> of the processed sites as tss .

the higher specificity of cappable-seq for the 5′ end of primary transcripts also has the desirable property of reducing reads mapping to rrna from 85 % of total reads to only 3 % . while some remaining reads may be background noise, we identify  <dig> enriched positions within rrna genes suggesting bona-fide tss falling within the rrna genes .

genomewide position of tss suggests both precise and imprecise initiation of transcription
we and others have observed that many promoters initiate a low level of transcription from multiple positions closely surrounding the major initiation site for a given tss  <cit> . we hypothesize that those sites may have been generated from a single promoter and thus are considered dependent. we clustered all tss generated from a unique promoter event to one single position with the highest rrs resulting in  <dig> unique positions that we define as clustered tss .

while the rna polymerase initiates transcription at imprecise positions for about 60 % of the promoters, 40 % have precise positions. interestingly, the degree of precision in the initiation site is dependent on the sequence context at tss where the −  <dig> and + <dig> positions of the tss correspond to pyrimidine  and purine  respectively. the − 1 +  <dig> yr motif correlates with precise initiation events .

41 % of cappable-seq tss in e. coli are novel
to estimate how many of the tss found by cappable-seq are novel, we compiled a composite dataset of known tss consisting of the annotated regulondb tss plus tss derived from high throughput methodologies that have been done on e. coli grown in similar conditions  <cit> . the resulting  <dig> tss present in the composite dataset of known tss were compared to the cappable-seq tss with  <dig> tss found common to both datasets and  <dig> tss found to be cappable-seq specific tss  . the number of novel tss that cappable-seq identifies that have not been identified in previous studies under equivalent growth conditions is remarkable. the profile of enrichment scores is similar for both the common and cappable-seq specific sets suggesting that those novel positions are bona fide tss .

one explanation for the high number of cappable-seq specific tss is the increased sensitivity due to the higher sequencing depth, revealing novel tss that are weakly expressed. we addressed this question by looking at the distribution of expression level for both the previously annotated and novel tss and found a higher number of weak tss in the cappable-seq specific set  compared to the common set  . taken together, these results suggest that some novel tss are explained by the gain of sensitivity from a high sequencing depth.

it is conceivable that an even deeper sequencing depth with cappable-seq would reveal even more novel tss and it is unclear at what depth this trend will cease. such weakly expressed tss maybe the reflection of stochastic events resulting from the transcriptional machinery occasionally initiating transcription from non-canonical promoters. this stochastic initiation would result in an increased repertoire of transcripts conferring phenotypic diversity to an otherwise genotypically identical population of cells. analogous to the inherent mutation rate of dna polymerases as a driver for evolution  <cit> , we hypothesize that the characteristic of the rna polymerase to provide stochastic transcription starts may confer an evolutionary advantage. alternatively this stochastic initiation may be the consequence of the property of the transcription machinery to accept a range of promoter configurations yielding low and high levels of transcription.

upstream regions of tss display characteristics of known e. coli promoters
next, we analyzed the sequence conservation across related species and nucleotide bias upstream of the  <dig> cappable-seq tss. to calculate the overall conservation of the flanking regions of tss, we used the phastcon scores  <cit>  derived from the genome-wide alignment of  <dig> related bacterial species including e. coli from ucsc . as expected, the overall conservation score increased at around  <dig> and 35 bp upstream of tss and gradually increased downstream of the tss . the upstream conservation is indicative of the presence of the −  <dig> and −  <dig> promoter elements suggesting that a significant fraction of promoters upstream of the cappable-seq tss are under positive selection. the downstream conservation across the ten listed species is indicative of open reading frames likely present downstream of tss. nucleotide bias in the region upstream of the tss is in accordance with sequence conservation; there is a strong bias at −  <dig> for a motif resembling the tataat box  and a weaker bias at −  <dig> resembling the sigma factor  <dig> binding site . taken together, these results are consistent with the structure of e. coli promoters, particularly the sigma  <dig> promoters upstream of a majority of tss. we performed the same analysis with the  <dig> cappable-seq specific tss and found that the regions show similar sequence bias at around −  <dig>  and −  <dig> as that found for the entire set . interestingly, despite similar sequence bias in both cappable-seq specific tss and annotated tss, the cappable-seq specific tss show no increase of sequence conservation at −  <dig> and −  <dig> .fig.  <dig> promoter regions. characteristics of the promoter region found using cappable-seq. a the average phastcon score is plotted for each position from − <dig> bases upstream to + <dig> bases downstream of the cappable-seq tss  and the cappable-seq specific tss. b sequence logo upstream of all cappable-seq tss and cappable-seq specific tss. c over-represented motifs found in the promoter regions of cappable-seq and cappable-seq specific datasets. d fraction of promoters having the sigma 70– <dig> motifs in the composite dataset of known tss, cappable-seq tss, tss common to cappable-seq and the composite dataset of known tss, and cappable-seq specific tss



to better estimate the fraction of promoters that contains a canonical −  <dig> region, we generated a position weight matrix  corresponding to the canonical sigma 70 minus  <dig> motif from the known sigma  <dig> promoters tss dataset  <cit> . promoter regions of cappable-seq tss and composite dataset of known tss were scanned for the presence of the −  <dig> motif and compared to randomly selected regions. we found about 50 % of cappable-seq tss have a −  <dig> motif in their promoter, while this fraction is about 40 % for cappable-seq specific tss. for comparison this fraction drops to 33 % in the composite dataset of known tss. this result suggests that a significant fraction of tss in cappable-seq are bona fide tss . all cappable-seq datasets  have a higher fraction of promoters with a canonical – <dig> motif compared to the composite dataset of known tss .

furthermore we found that cappable-seq tss demonstrated an 80 % nucleotide preference for either a or g . while this finding is in agreement with previous studies  <cit> , the preference for a or g in cappable-seq tss is stronger than the preference found in annotated tss from regulondb  <cit>  . interestingly, despite motif preferences at the tss, the sequence conservation across species is not elevated suggesting there is not a strong selective pressure to conserve a specific nucleotide.fig.  <dig> nucleotide preference at tss. a sequence logo of the nucleotide bias from − <dig> to + <dig> position of tss. b distribution of the strength of the tss  as classified according to their −1 +  <dig> configuration with r being purine  and y being pyrimidine . c relative abundance of reads for each of the  <dig> possible tss − 1 +  <dig> dinucleotides. blue boxes are yr motifs, green boxes are yy or rr motifs and pink boxes are ry motifs. percentages corresponds to the percentage of tss having the aforementioned − 1 +  <dig> configuration . over-represented motifs at −  <dig> and − 10 bp upstream of tss with the-1c + 1c dinucleotide configuration



additionally, we observed a nucleotide preference at minus  <dig> position with 76 % of the nucleotides being pyrimidine . in summary, more than half of the tss  have a −  <dig>  +  <dig>  configuration with 18 % of the tss having a-1c + 1a configuration and only  <dig>  % having the-1g + 1c configuration . interestingly this pyrimidine  purine  or “yr” configuration has been previously reported to be the preferred configuration at tss in various prokaryotes and eukaryotes ranging from c. elegans, plant and human  suggesting that the yr rule is conserved across kingdoms.

there is no correlation between the − 1/+ <dig> nucleotide and the enrichment score  suggesting that the least favored configurations  are genuine tss. the strength of the tss, as defined by the rrs, has a weak correlation with the − 1/+ <dig> nucleotide configuration. indeed, yr configuration includes the most highly expressed tss while the ry configuration is the weakest tss . contrasting with this notion, the-1c + 1c  has the highest fraction of highly expressed tss  including the five most highly expressed-1c + 1c tss upstream of ribosomal genes. this observation could be the result of an alternative promoter upstream of the-1c + 1c tss. to address this question, we searched for overrepresented motifs in the  <dig> bases upstream of-1c + 1c tss class using meme  <cit>  and found the canonical tataat box at −  <dig> and sigma  <dig> motif at −  <dig> suggesting that the majority of the-1c + 1c tss class is a subset of tss from the sigma  <dig> promoter .

intragenic sense tss in e. coli have a marked preference for the first nucleotide of codons
tss identified by cappable-seq that are within protein coding genes account for 63 %  of the total tss with two-thirds of the intragenic tss in the sense orientation in relation to the gene. sense tss tend to be located at the start of the protein coding regions. we also identify a slight tendency for locating sense tss at 3′ end of protein coding genes. antisense tend to be evenly distributed within the protein coding regions . intergenic tss tend to be have higher rrs than both sense and antisense intragenic tss, suggesting that intergenic tss tend to be stronger . there is a correlation between the strength of sense intragenic tss and their position relative to the coding gene with stronger tss occurring towards the 3′end of genes . leaderless transcripts account for  <dig>  %  of tss  <cit> .fig.  <dig> intragenic tss. a distribution of the number of sense and antisense intragenic tss as a function of the position within genes. b box plot representing the distribution of the tss strength  for intergenic , sense intragenic  and antisense intragenic  tss. c distribution of intragenic sense  and antisense  tss strength as a function of their position within genes



interestingly, we found that intragenic tss have striking positional preference relative to the nucleotide triplet that defines the reading frame. we found that 45 % of the intragenic sense tss are located in the first position of codons while only 27 % of tss are located in the second and 27 % in the third position . the antisense tss show a weaker but noticeable preference for the third position rather than the first, with 43 % of tss on the third position . sense and antisense preference is distributed throughout the protein coding gene . this positional preference of the tss relative to the codon may be influenced by the nucleotide frequency at codons with a higher a and g frequency at the first base of the codon. while other datasets derived from drna-seq experiments  <cit>  show similar preferences, this observation has not been previously reported. interestingly, we found  <dig> tss at the first nucleotide of an internal in-frame aug codon. those transcripts are putative leaderless transcripts leading possibly to a truncated form of the annotated protein.fig.  <dig> positional preference of tss relative to codon. frequency of intragenic tss relative to the first, second and third position of the codon for  the sense tss and  the antisense tss. graphics on the left represent the overall frequency of tss at each codon position across the entire gene length while the graphic on the right represent the frequency of tss at each codon position as a function of the relative position within the coding gene 



tss from a microbiome
to demonstrate the applicability of our methodology on a complex mixture of bacteria, we applied cappable-seq to two c <dig> female mice cecum microbiomes . reads were mapped to the bacterial genomes from ncbi and species with more than  <dig> identified clustered tss were considered candidates and the species with the highest number of clustered tss in each phylum were further analyzed. for all species, we found that the majority of the reads mapped in either intergenic regions or in protein coding genes in accordance with the biology of transcription start sites . accordingly, reads mapping to rrna and transfer rna  represent less than 10 % of mappable reads in lactobacillus johnsonii, akkermansia muciniphila and lachnospiraceae bacterium. we hypothesize that the higher fraction of rrna reads in bifidobacterium pseudolongum  is due to the high level of rrna sequence conservation leading to the spurious mapping of rrna sequence originating from other species of bifidobacterium. taken together these data suggest that cappable-seq depletes processed transcripts such as rrna and trna from microbiomes total rna with the same efficiency as observed in e. coli. next we derived a set of highly confident tss per species and identified sequence bias in regions flanking those tss. in agreement with promoter organization/structure in bacteria, we found a strong sequence bias at  <dig> bases and  <dig> bases upstream of the tss for all analyzed species  indicative of the – <dig> element and the tataat box respectively. furthermore, the yr motif at position–1 +  <dig> can be identified in all cases, reinforcing the universality of the yr motif for tss. beyond the biological significance of these finding, these results shows that the specificity of cappable-seq for tss in a microbiome is similar to the specificity for tss in e. coli. interestingly, two of the four species analyzed  show 10 % and 15 % of the tss located at the start of the annotated protein coding genes signature of leaderless transcripts . for comparison, e. coli shows only  <dig>  % leaderless tss. this result is in agreement with a previous computational predictions  <cit>  suggesting that leaderless transcripts are widespread in a variety of bacteria. finally, we challenged the reproducibility of cappable-seq in a microbiome by analysing the tss positions and strength  in two biological replicates from two different mice and found a good reproducibility in both qualitative and quantitative  measurements of tss   <cit> . summing up, the collective results obtained using cappable-seq on the mouse gut microbiome demonstrates the utility and reproducibility of cappable-seq for meta-transcriptome analysis.fig.  <dig> tss of mouse gut microbiome. analysis of tss for four representative species across four phyla of bacteria. a igv display of read distribution in akkermansia muciniphila in both biological replicates. b promoter structures in all four species generated with weblogo . the x axis represent the distance away from the tss found by cappable-seq. y axis represent the amount of information present at every position in the sequence, measured in bits. c percentage of leaderless tss in replicate  <dig>  d read genomic distribution for replicate  <dig>  e the correlation coefficient of relative read score  of tss in the four representative species between the two biological replicate  is  <dig> 



discussion
cappable-seq is a novel method that enables direct modification and identification of the triphosphorylated rna characteristic of primary transcripts. in this study we demonstrate the ability of cappable-seq to determine tss at one base resolution genome-wide in e. coli by pairing cappable-seq with direct 5′ ligation of sequencing adaptors to the rna. despite being a very different approach for determining tss, the results are consistent with the established methodologies. indeed, a large fraction  of the tss found in e. coli by cappable-seq is coincident with annotated tss. conversely, 44 % of the annotated tss from the composite dataset are not identified by cappable-seq. the reason for this difference can be explained from subtle differences in growth conditions, primary rna isolation, analysis pipeline and parameters, sequencing depth, variation in the in vitro biochemical treatments and reagents  <cit>  and possibly false positives.

we show that cappable-seq discriminates the 5′ triphosphate end characteristic of initiating 5′ triphosphorylated nucleotide incorporated by the rna polymerases from the processed 5′ monophosphate rnas. this property can also be used to determine processed sites, rather than tss, by identifying the depleted positions in cappable-seq. we applied this analysis to our data and found approximately  <dig> processed sites in the e. coli genome . this assessment of processed sites is analogous to the method used by romero  <cit>  where the libraries have been prepared with and without tobacco acid pyrophosphatase.

cappable-seq performs well when applied to a mouse gut microbiome and provides for the first time a solution for tss determination in complex microbiome population. thus, cappable-seq can be used to derive sets of quantitative markers from which association to diseases or direct perturbation of the microbiome can be made. this technology can greatly facilitate metagenome-wide association studies by providing a signature profile of the microbiome functional state.

in prokaryotes, cappable-seq can also be used for full length primary transcriptome analysis by avoiding the fragmentation of rna. unfragmented primary rna can be enriched, effectively removing rrna. such depletion is ideally suited for microbiome studies as it should universally remove rrna and most contaminating eukaryotic host rna leaving prokaryotic transcripts intact. because one of the first steps on the degradation pathway for primary transcripts is the removal of 5′ triphosphates  <cit>  and processing of rna, this methodology does not reveal the whole transcriptome but rather focuses on the newly synthesized transcripts, which is a much more accurate description of the transcriptional activity of the cell.

applying cappable-seq directly to total eukaryotic rna would reveal the triphosphorylated transcriptome derived from pol i and iii rna polymerases and identify the tss of these transcripts. eukaryotic pol ii transcripts differ from pol i and iii transcripts by virtue of their 5′ g cap. thus, the removal of the g cap with a decapping enzyme, which leaves a recappable 5′ diphosphate at the 5′end of the pol ii mrna, would enable cappable-seq to also capture and identify pol ii transcripts. furthermore by combining 5′ end cappable-seq enrichment with 3′ polya rna selection would assure isolation of full length mrna transcripts. coupling this with long read sequencing technologies such as smrt sequencing  or nanopore sequencing  would reveal the comprehensive repertoire of splice variants. in summary, by capturing the 5′ end of primary transcripts, cappable-seq, is a profoundly unique approach to analyzing transcriptomes.

CONCLUSIONS
universally, the initiating nucleotide found at the 5′ end of primary transcripts has a distinctive triphosphorylated end that distinguishes these transcripts from all other rna species. recognizing this distinction is key to deconvoluting the primary transcriptome from the plethora of processed transcripts that confound analysis of the transcriptome. the method presented here allows for the first time capture of the 5′ end of primary transcripts. this enables a unique robust tss determination in bacteria and microbiomes. in addition to and beyond tss determination, cappable-seq depletes ribosomal rna and reduces the complexity of the transcriptome to a single quantifiable tag per transcript enabling digital profiling of gene expression in any microbiome.

