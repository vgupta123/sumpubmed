BACKGROUND
during the last decade sequencing technologies took a large leap ahead. the so called next generation sequencing  technologies  <cit>  offer a much higher amount of sequencing data in comparison to classical sanger sequencing  <cit> , while still delivering a read accuracy of over 99 %. additionally, the cost per sequenced base is drastically reduced when using ngs technologies compared to sanger sequencing  <cit> . however, ngs platforms suffer from a huge drawback: their read length is relatively short. eukaryotic genomes often contain repetitive regions significantly longer than the maximum ngs read length, and due to the repeat structures also mate pair data cannot fully resolve these regions. this results in a lot of contigs that cannot be assigned to a distinct position during scaffolding. as a consequence, many of the genome sequences that were produced recently stay “unfinished” when compared to genome sequences generated by the bac to bac approach  <cit> . to overcome this issue third generation sequencing technologies seem to be well suited, as they deliver a much longer average read length. one representative of this technology has been developed by pacific biosciences and is called smrt  sequencing  <cit> . the newest pacbio rs ii sequencer produces an average read length of  <dig> to 15 kb and a maximum read length of up to  <dig>  bp  <cit> . the price one has to pay for these long reads is accuracy: the error rate of a smrt read is about 11 % at the moment. however, in contrast to ngs technologies the errors produced by smrt sequencing are not biased, they appear randomly. this means that these errors can easily be compensated by increased sequencing coverage  <cit> . the long reads have the potential to span even long repetitive regions and hence help to get these regions integrated into an assembly. additionally, sequence motives that cannot be sequenced by ngs or even sanger technology like longer single nucleotide runs or gc-rich regions can be read by smrt sequencing  <cit> . this makes the technology a very good choice for creating de novo assemblies or for improving existing ngs assemblies given that sufficient coverage can be generated.

the dna extracted from cells not only contains the nuclear genome but also dna from organelles . reads from this dna make up a notable amount of the resulting raw reads. if the goal is the enhancement or assembly of the nuclear genome these reads are usually filtered out and discarded. however, they can also be used to assemble the organelles genome sequence. sequences originating from organellar dna usually make up a large percentage of the overall reads in relation to the organelles genome size due to higher copy numbers of organellar dna. consequently, the average coverage of organellar genomes is usually much higher than the average coverage of the nuclear genome  <cit> . this provides the opportunity to perform a complete de novo assembly of the organellar genomes only based on smrt sequencing data that have low coverage for the nuclear genome.

here we present a smrt sequencing only de novo assembly of the beta vulgaris ssp. vulgaris chloroplast genome. as previously shown by ferrarini et al.  <cit>  smrt data provide a great basis to create a high quality chloroplast genome assembly. we only used data originating from a low coverage resequencing project focussing on the nuclear genome. in contrast to other methods also based on smrt sequencing , our method is based on data that is generated as a by-product during nuclear genome sequencing and no extra data needs to be generated. the workflow established for sugar beet is described in detail and is made available. results were compared to the published sugar beet chloroplast assembly from li et al.  <cit>  which is based on the same genotype but only on illumina sequencing. the chloroplast sequence is a good example to show the power of smrt sequencing as it contains beside the large single copy region  and the small single copy region  two large inverted repeat  regions that are hard to assemble using only short reads.

methods
plant material and dna extraction
genomic dna for smrt library construction was preparated from leaf material with a modified ctab-dna extraction method followed by qiagen genomic-tip 100/g  cleaning and filtering. the sugar beet dh plants of the sequenced genotype kws <dig>  <cit>  were provided by kws saat se.

plants were grown in the greenhouse under long day conditions on soil for  <dig> weeks. reduction of starch content was performed by etiolation for  <dig> days prior to harvest. about  <dig>  g young tissue was ground under liquid nitrogen and mixed with 20 ml prewarmed modified carlson-buffer  <cit>  containing 3 % ctab, 3 μl/ml 2-me and  <dig>  mg rnase. the homogenate was incubated at 74 °c for 30 min with inverting every 5 min. the dna was than extracted with  <dig> vol. chloroform:isoamylalcohol  and centrifuged with  <dig>  rpm at rt. the aqueous phase was diluted with  <dig> vol. h2o and adjusted to ph  <dig>  prior to genomic-tip 100/g purification and precipitation. the final pellet was resuspended in 500 μl sterile distilled water, the dna concentration determined and the purity and integrity visualized on an agarose gel.

library construction and sequencing
the construction of the pacbio rs libraries with a targeted insert size of 8–12 kb and subsequent sequencing was outsourced to the sequencing provider gatc biotech ag . the raw read data originates from two different sequencing runs. the first run was performed on a pacbio rs sequencer using c <dig> chemistry and xl polymerase on  <dig> smrt-cells. the data were delivered in 04/ <dig>  the second run was performed on a pacbio rs ii using p <dig> polymerase and c <dig> chemistry on  <dig> smrt-cells. these data were delivered in 01/ <dig> 

raw sequencing data
after extracting reads from the sequencing output files with the smrt analysis  <cit>  toolkit using the “rs_subreads” pipeline with standard settings, roughly  <dig>  gbp of data were available consisting of  <dig> , <dig> subreads originating from the nuclear genome and organelle dna. additional file  <dig> shows the length distribution over all these subreads. the average subread length was 3213 bp with a n <dig> length of 4713 bp. assuming a genome size of  <dig> mbp for sugar beet this results in theoretically  <dig>  fold coverage.

extraction of potential chloroplast reads
in order to find potential chloroplast reads in the pool of all available reads, the reads were mapped to the spinach  chloroplast genome sequence  <cit> . the program blasr  <cit>  was used for mapping using a minimal identity threshold for matched reads of 80 %. to speed up the mapping process the available read data were divided into  <dig> subsets and then mapped in parallel on a compute cluster. the mapping process resulted in one sam file per subset. in a next step samtools  <cit>  was used to extract the ids of the mapped reads from each sam file providing a first white list of reads most likely originating from the chloroplast genome. the subread ids in this list were used to deduce polymerase read ids that were required for further processing . as a polymerase read might contain more than one subread it is possible that after deducing some of the ids appear multiple times. in a final step multiple polymerase read id entries were consolidated into one single entry.

the white list was now used in combination with the smrt analysis toolkit to extract the subreads from the pool of all available read data. the advantage of having a white list is that all pipelines defined in smrt analysis can be used without the need to modify a lot of settings. it is sufficient to add the white list as a parameter to the filter module that is part of all pipelines. by doing so all later analysis steps are only performed with the reads defined in the white list.

assembly
for the assembly step the sprai assembly pipeline  <cit>  was used. all reads extracted in the preceding step were used as input. sprai first performs an error correction of the smrt reads. in a second step the error corrected reads are handed over to the celera assembler  <cit>  for the final assembly step. after assembly the “check_circularity.pl” script that is also provided by the sprai authors was used to check if the resulting assembly has overlapping ends.

creation of coverage plots
in order to account for the chloroplast genome being circular, we created each coverage plot based on two mappings. the first mapping was performed against the normal cp_ <dig> sequence. since reads that span the region where the assembly was linearized  will not map properly, we created a second mapping against the cp_ <dig> sequence that was linearized at the opposite position of the chloroplast genome consensus start and end point. from this second mapping, the coverage values corresponding to the first and the last 7000 bp of the original cp_ <dig> assembly were integrated into the final coverage plots.

validating, reordering and polishing the assembly
the assembly was validated using an existing library of fosmid end sequences   <cit>  created by sanger sequencing from about  <dig>  fosmid clones of the genotype kws <dig>  to check the order of elements in the assembly a selected subset of  <dig> fes read pairs, selected for complete coverage at the clone level of the chloroplast genome, was used. the fes sequences were mapped to the chloroplast genome assemblies using bowtie <dig>  <cit>  with standard settings.

as the newly created assembly starts at an arbitrarily defined position, it was reordered to align with the established start position of chloroplast genomes. this facilitates comparison of the new smrt sequencing assembly with the earlier illumina assembly  <cit> . in a final step the assembly was polished using the quiver algorithm  <cit>  and all reads white-listed during the first step. the corresponding pipeline was provided by the smrt analysis toolkit. after polishing the smrt sequencing only assembly designated cp_ <dig> was finalized.

to preclude that nuclear dna sequences did accidentally contribute parts of the assembly, we mapped all available smrt reads against the final assembly and created a coverage plot. if a part of the assembly would be of nuclear origin only, a drastic drop in the coverage from about  <dig> fold to about  <dig> fold should be visible. such regions were not observed. however, it cannot be completely excluded that nuclear reads are included in the assembly process, because insertions of chloroplast dna into the nuclear genome are known for plants  <cit> . if a nuclear read is very similar to a region on the spinach chloroplast genome sequence, it might survive the filtering step. these reads might even show small differences to the reads really originating from this position on the chloroplast. nevertheless, these reads will represent a minority and during the polishing step they will be overruled by the vast majority of real chloroplast reads and hence they will not influence the final sequence of the assembly.

annotation of the assembly
the online service cpgavas  <cit>  was used to create an annotation for the assembly cp_ <dig>  as a reference for the annotation process, we used spinach. aside from this change, we used the standard settings provided by cpgavas.

comparing the assemblies
the cp_ <dig> assembly was compared to the already available assembly by aligning the sequences against each other to identify differences between the two. for the alignment the emboss stretcher application  <cit>  was used. to check which assembly is correct we mapped all available fes generated by sanger technology against both assemblies using bowtie <dig>  <cit> , treating them as single end reads.

changes in the annotation caused by differences of the underlying nucleotide sequence where examined using nucleotide and protein blast as well as blastx  <cit> . all blast variants where used through the ncbi web interface using standard settings. nucleotide blast was run against the “nucleotide collection ” database; protein blast and blastx were run against the “non-redundant protein sequences ” database.

RESULTS
subread extraction
the extraction of relevant chloroplast genome reads out of the whole smrt sequencing data set yielded a total of  <dig>  subreads containing  <dig> , <dig> base calls , representing  <dig>  % of the total sequence yield. the distribution of subread length from chloroplast dna is given in fig.  <dig>  based on an expected chloroplast genome size of  <dig>  bp this results in a total coverage of  <dig> fold .fig.  <dig> length distribution of white list extracted subreads. the length distribution of all the subreads extracted from the complete dataset by using smrt analysis and the white list. subread length is given in bp



result of the assembly process
the more than  <dig>  subreads were used to create the sprai assembly. the first raw assembly showed overlapping ends, indicating that it was complete. the assembly was validated using a fes library  <cit> . to check the order of elements in the assembly a selected subset of  <dig> fes read pairs  spanning the complete chloroplast genome was used. after mapping the subset of read pairs to the assembly, the distance and the orientation of the corresponding read pairs were checked . most of the read pairs mapped in a consistent way, but read pairs with one partner read in the large and the other one in the small single copy region showed inconsistent orientation and distance values . these inconsistencies indicated that the small single copy region was included in the wrong orientation. the large and small single copy region are connected by two ir regions, so their correct orientation could have only been determined by a read completely spanning one of the approximately  <dig>  bp long repeats and reaching into each single copy region. the data set only contains two reads, theoretically long enough but they do not span a repeat. based on the information we gained from the fes alignment we inverted the small single copy region , resulting in correct orientation of the former fes in question . after quality polishing using quiver the final cp_ <dig> assembly had a total length of  <dig>  bp.table  <dig> wrong fes orientation before reordering. before reordering the fes pairs with one partner in the small singe copy region  and the other one in the large single copy region  they showed a wrong orientation. position and length distances are given in bp


name
position
length
orientation
located on
accession

name
position
length
orientation
distance
located on
accession


although the coverage of  <dig> fold seems to be excessive at first, fig.  <dig> shows that the reads were not distributed equally across the cp_ <dig> assembly . to explain this distribution of the reads filtered on the basis the spinach chloroplast genome sequence, the sequence identity between the two assemblies was calculated . when comparing the two curves, a correlation between read coverage and sequence identity becomes obvious. clearly, sequence regions with a higher degree of variation distance to the sugar beet chloroplast genome yield less reads than regions with high sequence similarity. hence, a higher overall coverage is needed in comparison to a classical assembly. nevertheless, even for less well covered regions the pacific biosciences recommendations of about  <dig> to  <dig> fold coverage for a high quality assembly  <cit>  were easily reached.fig.  <dig> correlation between extracted reads an sequence identity. the figure shows the correlation between the coverage of cp_ <dig> with extracted reads  and the percentual sequence identity between cp_ <dig> and the spinach chloroplast 



to demonstrate that the true read coverage of cp_ <dig> in the original dataset is quite even, a mapping was performed with all smrt reads . this coverage was high and evenly distributed over the assembly, also indicating that no nuclear region with high sequence similarity to chloroplast sequences was accidently included. at the beginning of the first ir  a peak in the coverage was observed. we suspect that this peak is an artefact of the mapping process resulting from the repeat structure rather than a real increase of coverage.fig.  <dig> smrt read coverage of cp_ <dig>  the figure shows the smrt read coverage of cp_ <dig>  all available smrt reads were mapped against cp_ <dig> using blasr



comparison to the available sugar beet chloroplast assembly
the comparison of our cp_ <dig> assembly to the already available one revealed  <dig> differences between the assemblies:  <dig> small differences in a single position,  <dig> differences of  <dig> to 6 bp and two longer differences of  <dig> and 45 bp in length . table  <dig> shows the complete list of differences between the two assemblies. of the complete fes pool we could map  <dig> reads consisting of  <dig> ,927 bp to the illumina based reference and  <dig> reads consisting of  <dig> ,647 bp to the newly created one. this results in a coverage with sanger reads of about  <dig> fold for both assemblies. each of the  <dig> differences was examined individually. for  <dig> differences the mapped sanger reads supported the cp_ <dig> assembly. only in one case the existing assembly was proven correct by the fes. a closer examination of this position reveals that it is highly supported by smrt reads making a misassembly unlikely but still possible. the error corrected reads at this position revealed that there are indeed smrt reads supporting both versions and hence this position remains ambiguous.fig.  <dig> difference between the illumina assembly and the cp_ <dig> assembly. the figure shows one of the large differences between the illumina and the cp_ <dig> assembly. the fes reads in blue have been mapped against the cp_ <dig> assembly. they match perfectly. when the reads are mapped against the illumina assembly they show a large insertion. the illumina assembly is aligned accordingly. the fess shown are: jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy285924

fig.  <dig> wrong basecall in the illumina assembly. the figure shows a mapping of the fes reads against the illumina assembly. it is clear to see that the six “a” bases in the illumina assembly are wrong as all the fes reads show six “t” at this position. the same position in the cp_ <dig> assembly is correct and shows no difference to the fess. the fess shown are: jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy <dig>  jy393875


position cp_2320
position kj8018
type
cp_ <dig> correct with respect to fes
influenced annotation
located in

adeletion occurs in intron and does hence not influence the coding region



annotation
finally, the cp_ <dig> assembly was applied to a gene prediction and annotation approach; the result is shown in fig.  <dig>  a total of  <dig> individual genes were identified. of these,  <dig> genes encode mrna ,  <dig> rrna and  <dig> trna. nine genes are located within the ir regions which encode  <dig> mrna,  <dig> rrna and  <dig> trna. in comparison to the illumina assembly our annotation shows some differences caused by changes in the underlying sequence.fig.  <dig> annotation of the cp_ <dig> assembly. the figure gives an overview of the new annotation of the smrt sequencing only de novo assembly cp_2320



the genes psbl and ndhd show a different start codon. in the illumina assembly they start with the classical “atg” codon, whereas in cp_ <dig> they start with the codon “acg”. for psbl “acg” has been reported as an initiator codon in tobacco  and spinach. by mrna editing from c to u the “aug” initiator is formed  <cit> . this effect is also known for the ndhd gene  <cit> .

the gene accd is influenced by a deletion in the cp_ <dig> assembly causing a change in the reading frame. however, the accd domain is not influenced by this change and high scoring blast results exist for our gene annotation.

the gene cema is influenced by a two base insertion in the cp_ <dig> assembly at the beginning of the predicted gene causing our annotation to start one amino acid later with a stretch of  <dig> lysines followed by a methionine. in spinach this methionine is the start amino acid of the cema protein and it is hence likely that the real translation start is located at this position.

the gene ccsa shows the biggest change, as it is located at the side of the 45 bp insertion. the insertion causes one amino acid change followed by an insertion of  <dig> new amino acids. the new amino acid sequence can be found exactly in spinach and in almost all other blast hits.

CONCLUSIONS
smrt sequencing reads extracted from a pool of reads created for nuclear genome sequencing have been used to obtain a high quality consensus sequence of the chloroplast from sugar beet. even with a relatively small overall coverage of total genomic dna it was possible to collect more than enough reads to generate a high quality de novo assembly of the chloroplast genome. comparison to a published assembly from the same genotype generated with illumina data indicated that short read based genome sequences may contain errors. these were mostly caused by specific features of the sequences, like longer stretches of the same base . high coverage smrt sequencing turned out to be almost error-free when accepting sanger data as “golden standard”.

if the genome in question contains large repetitive elements also smrt sequencing reaches its limits. when the repeat is too long to be spanned by smrt reads these elements cannot be integrated in assemblies in a reliable way. in the case presented here, this problem was overcome with fes long-read paired end data offering about  <dig> kbp long “jumps” generated by sanger. however, when using newer versions of the pacific biosciences chemistry and size-selected libraries, even longer reads will become more common and repetitive elements might be resolved automatically during the assembly process.

availability of supporting data
the extracted smrt sequencing raw reads are available in the “short read archive” under accession id srr <dig>  the sequence and annotation of the cp_ <dig> chloroplast assembly have been submitted to genbank and are available under accession id kr <dig>  additional data sets supporting the results of this article are included within the article .

additional files
additional file 1: 
distribution of read length of all subreads. the distribution of read length of all the subreads contained in the complete smrt sequencing dataset. 

additional file 2: 
fes internal names to genbank accession ids. this file provides a translation from our internally used fes identifiers to the publically available genbank accession ids. 

additional file 3: 
fes orientation before reordering. this file contains the orientation and position of all  <dig> fes pairs used to validate the assembly. the three pairs showing a wrong orientation towards each other are marked in red. 

additional file 4: 
fes orientation after reordering. this file contains the orientation, position and distance of all  <dig> fes pairs towards each other after reordering the assembly. all pairs now show correct distance and orientation towards each other. however, there are some cases where one partner is located in a repeat region. in this case of course only one distance is correct. 



abbreviations
smrtsingle molecule, real time

ngsnext generation sequencing

irinverted repeat

fesfosmid end sequence

lscrlarge single copy region

sscrsmall single copy region

competing interests

the authors declare that they have no competing interests.

authors’ contributions

kbs performed data acquisition, sequence assembly, analysis of results, and drafted the manuscript. dh designed the concept of the study and optimized dna extraction for smrt library construction. bw supervised the research and revised the manuscript. all authors were involved in the optimization of the manuscript and approved the final version.

authors' information

not applicable.

