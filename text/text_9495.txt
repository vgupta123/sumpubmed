BACKGROUND
computational models are widely used to study biomolecular interactions due to their complexity. models which are constrained by physicochemical principles are useful because they are based on causality rather than simply correlation, and their parameters, such as molecule copy numbers and binding rates, can be measured independently  <cit> . models that enable the incorporation of site-specific details and that can overcome the problem of combinatorial complexity are also highly useful for biomolecular simulations . one technique that meets all of the above requirements is rule-based modeling. rule-based modeling is a technique for studying the site dynamics of biomolecular networks  <cit> , which involves representing biomolecular interactions as local rules. with this method, a set of rules is defined where each rule represents a bidirectional reaction. each direction of the reaction is assigned a rate law. during simulation, a reaction network is created from which a set of coupled ordinary differential equations  is derived. these equations characterize the rates of change of observables . there are several different formalisms that may be used in creating rule-based models  <cit> . one disadvantage of the traditional rule-based model is that it does not capture details of molecular geometry. the traditional rule-based model is based on a set of binding rules that only include the number of binding sites on a molecule and do not incorporate geometric information  <cit> . this limitation of the rule-based modeling approach results in models that are unable to capture the effects of molecular geometry. in this work, our goal is to develop a new, general rule-based model for molecular binding events that implicitly represents molecular geometry by using simple measurements between sections of the molecules to encode steric effects into the rules.

as a model system for our methodology, we look at the process of antigen-antibody aggregation; in particular, we study the binding of ige-fc εri antibody-receptor complexes to the antigen pen a  <dig>  a common shrimp allergen. an antigen is a substance that is capable of inducing the production of antibodies and binds to them via regions on its surface called epitopes. studying antigen-antibody aggregation and the structure of the aggregates that form during this process is important for understanding how the allergic response is initiated. the allergic response in humans is set into motion by a tyrosine kinase cascade that results from the crosslinking of ige-fc εri receptor complexes via the binding of the ige antibodies to an antigen  <cit> . antigens may have multiple possible conformations with differing geometric characteristics, which can affect the size and structure of the antigen-antibody aggregates that form. the fold of an allergen is known to play a role in the ige reactivity of its epitopes  <cit> . the development of a practical method for aggregate structure prediction based on the geometry of a particular antigen conformation could be useful not only for understanding aggregation, but also for possible manipulation of the antigen geometry to obtain a desired aggregate structure. various properties of allergens and protein complexes, such as structural stability, flexibility, and dimerization, have been studied using molecular dynamics-based methods  <cit> ; however, such methods would not be useful to study antibody aggregation due to the long timescales involved  and the large size and quantity of the aggregates that may form.

in order to obtain aggregate size distribution data on which to base our rule-based models, we employ a previously developed three-dimensional rigid-body monte carlo method  <cit> . this method can explicitly represent molecular geometry and molecular motions. a graph-based structure defines the molecular interactions; ligands and receptors are represented by vertices, and bonds between ligands and receptors are represented by edges. this structure allows for the easy maintenance of aggregation information throughout the simulation, and for the analysis of aggregate structure  <cit> . instead of all-atom molecular structures, 3d isosurface representations of the molecules are used, which reduces the simulation to a rigid-body problem and reduces the computational cost  <cit> . this method can be combined with rule-based modeling in order to quantify the steric effects between allergen binding regions that affect binding site accessibility and to represent the differences in these steric effects caused by variations in molecular curvature. steric effects in the 3d monte carlo model depend not only on molecular geometry but also on the resolution of the 3d molecular model. the resolution of the isosurface models can be reduced through polygon reduction, which has been shown to decrease the number of polygon-to-polygon comparisons that occur during the monte carlo simulation  <cit> ; consequently, the computational time of the simulation also reduces. the simulation time has been previously shown to decrease from approximately  <dig> hours per run for the original isosurface model to  <dig> hours per run for a model with a polygon reduction of  <dig> %, and two hours per run for a model with  <dig> % reduction. however, a reduction in resolution decreases the volume of the molecular models and affects the resulting aggregate size distribution  <cit> .

our previous work  <cit>  introduced our initial efforts toward using a rule-based method for modeling molecular geometry through capturing the steric effects acting on the various binding regions of the molecule. in this paper, we propose a more general rule-based method to model the geometric effects of molecular binding events. here, we extend our initial investigation presented in  <cit>  to include the impact of model resolution to the formation of molecular aggregates for all three energy-minimized pen a  <dig> conformations studied. this novel rule-based method involves the automation of rule set construction based on a few parameters that encode the steric effects between neighboring binding regions of the antigen. in particular, we apply our method to the modeling of antigen-antibody aggregation and investigate different antigen conformations. we expect that modifying the curvature of the linear pen a  <dig> antigen may result in distinct steric effects. we first demonstrate our method using three pen a  <dig> molecules with large variations in curvature. then, we use this method to model the aggregation of ige-fc εri receptor complexes with the shrimp allergen pen a  <dig> for three different energy-minimized conformations of the pen a  <dig> molecule that have small variations in curvature: native, s-shaped, and u-shaped. we compare the results of this method with the results of the aforementioned monte carlo simulations, and we analyze the differences in antigen-antibody aggregate formation for each the conformations. we also perform a resolution study in which we run monte carlo simulations for seven resolutions of the 3d model and subsequently use our novel rule-based method to analyze the variation of steric effects and quantify the change in relevant parameters.

related work
our work builds off of computational methods for modeling molecular geometry in biochemical processes, as well as experimental methods to study ige antibody binding behavior.

rule-based modeling
biological signaling systems are often comprised of macromolecules that can exist in a large number of functionally distinct states. this number scales exponentially with the amount of modification possibilities  <cit> . one problem that arises when modeling these systems is the specification problem, i.e. how to specify such a large system.

one solution is implicit specification, which involves the coarse-graining of sets of reactions and parameters into “rules”; the only explicitly specified features in a reaction rule are those which affect the reaction. rules define the conditions for molecular transformations and interactions, and are associated with rate laws  <cit> . some rules define multiple reactions, which means that all of these reactions are associated with the same rate law. the rules can usually be specified independently. rule-based specification methods include kappa-calculus  <cit> , bionetgen  <cit> , anc  <cit> , and ml-rules  <cit> . the simmune project and the ssc allow the specification of molecules within spatial regions of arbitrary geometries  <cit> .

bionetgen  <cit>  is a popular rule-based modeling software which uses graph rewriting. the biomolecules are represented by graphs, vertices represent molecular components, and edges represent bonds between these components. biomolecular complexes are represented by connected sets of graphs. rules are applied to these graphs and sets of graphs, and the graphs are changed according to the results of the biomolecular interactions specified by these rules  <cit> .

the rule-based methods can be population-based, particle-based, or hybrid. population-based methods include ode/pde numerical integration and the stochastic gillespie algorithm. in these methods, the application of a rule changes the size of one of the populations, each of which consists of all molecules that share the same state and same species. the system state space can be very large, so methods to reduce it have been introduced  <cit> .

particle-based rule evaluation involves tracking individual particles  through the simulation  <cit> . this is a network-free method; at any time point, only the existing particles, their states, and the possible reactions for the existing particles are necessary. spatial particle-based methods include an explicit specification of space, and include srsim  <cit>  and mcell  <cit> .

our method differs from traditional approaches to rule-based modeling in that the rules used in our method are constrained by steric effects induced by molecular geometry and 3d model resolution. we introduced a different rule-based method for modeling resolution in  <cit> ; this method used a single set of rules for each molecule conformation with only the rate constants associated with the rules varying with resolution. additionally, there were four different rate constants that required optimization. on the other hand, the rule-based modeling method presented in this work only requires two parameters that need to be optimized, making it more efficient than our previously developed methodological approach.

geometric molecular modeling
the spatial simulation software srsim  <cit>  is a rule-based modeling method that allows for the specification of molecule geometry. srsim integrates rule-based modeling, molecular dynamics, and a stochastic, diffusing-particle simulator. molecular geometry is provided by the user via data files. our proposed method is different in that it is a purely rule-based ode model that does not require any additional data files to run, as the molecular geometry is encoded into the rules themselves. in addition, our method only requires the bionetgen software to run.

the stochastic, particle-based meredys software  <cit>  uses brownian dynamics to simulate reaction-diffusion systems at the mesoscopic level. it requires the specification of details such as molecule positions, molecular geometry, reaction site positions, and reaction types. our rule-based method is population-based and only requires the distances between pairs of binding regions on a single antigen molecule to create the model.

computational methods for modeling two-molecule ligand-receptor docking simulate systems on a smaller scale than those studied using our method. our method uses more realistic geometric molecular models than do existing methods for self-assembly of molecular structures, such as those employing simple bead models  <cit> .

experimental methods
spatiotemporal analysis using nanoparticles have been developed to understand the process of ige antibody aggregation. methods to analyze clustered ige data include the use of ripleys and hopkins statistics  <cit>  as well as hierarchical clustering techniques which attempt to quantify the numbers of sizes of clusters  <cit> . spatial data of gold nanoparticle labeled ige have been imaged on the cell surface using transmission electron microscopy  <cit> . tracking quantum dot labeled ige has provided temporal information including diffusion rates  <cit> . while these experimental methods can measure attributes about receptor dynamics, neither provide aggregate binding pattern information, making the process of distinguishing linked from simply proximal receptors challenging.

methods
in this section, we present a rule-based model of the shrimp allergen pen a  <dig> that encodes the steric hindrances between the ige binding regions of the allergen within the set of rules. we first briefly discuss the binding sites and binding regions of the pen a  <dig> molecule. next, we outline the assumptions that were made in the development of this rule-based model. we then describe our methods for determining the steric hindrances between the binding regions, constructing a set of rules based on these steric effects, optimizing the rate constants, and implementing the rule-based simulation. we explain how the probabilities of formation of various aggregate sizes were calculated. lastly, we describe the monte carlo rigid-body model and how we compared the results of our rule-based model to that of the monte carlo simulation.

pen a  <dig> structure and valency
the pen a  <dig> allergen possesses a double-stranded coiled structure. all-atom structures of shrimp tropomyosin were obtained from the protein data bank  and the structural database of allergenic proteins   <cit> . the pen a  <dig> model used contains  <dig> amino acids and  <dig>  atoms. experimental studies have predicted that pen a  <dig> has 16- <dig> binding sites, which can be grouped into five general binding regions per strand  <cit> . the amino acid sequences of the binding sites are listed in  <cit> . the all-atom structure of the ige-fc εri receptor complex was obtained from  <cit> . it contains  <dig>  amino acids and  <dig>  atoms.

we generate  <dig> energetically feasible configurations of the pen a  <dig> antigen . we split the longest region into two binding regions  in our rule-based model such that pen a  <dig> has six binding regions per strand, with  <dig> total regions in our model . this is because the longest region is significantly larger than the other regions and contains  <dig> epitopes. due to the symmetric structure of pen a  <dig>  we allow distinct ige molecules to bind to the same region on opposite strands simultaneously.
fig.  <dig> three conformations of the all-atom molecular structure of the shrimp tropomyosin pen a  <dig> . the ige binding regions are circled. the ige binding regions  are located in five regions per strand, although for our rule-based model, we have split the longer rightmost region into two separate regions so that there are six binding regions per strand. we use the native configuration , an accentuated curve version called s-shaped , and a u-shaped configuration . in this paper, we label the regions on the native configuration  as regions a, b, c, d, e, and f



rule-based model assumptions
in order to simplify our rule-based model and to ensure that the number of rules in the rule set does not become too large for implementation, we make several practical assumptions when constructing our rule sets. firstly, we assume that an ige can only bind to a single binding region on the pen a  <dig> molecule, and that an ige cannot be bound to multiple regions simultaneously. for simplicity, and since the monte carlo data does not incorporate crosslinking, our rules forbid crosslinking pen a  <dig> molecules through ige binding. as discussed previously, we simplify our model further by assuming that there are only  <dig> total binding regions on the pen a  <dig> molecule , and that each ige can only bind to one of these  <dig> regions. finally, we assume that each of the two strands in the pen a  <dig> molecule binds independently of the other strand. an ige bound to a region on one strand does not, in any way, affect the probability of an ige receptor binding to a region on the opposite strand. figure  <dig> shows pen a  <dig> divided into strands.
fig.  <dig> rule-based modeling with steric effects. a circles represent a possible region of steric hindrance around the yellow/orange binding region where the radius of the circle represents the cutoff distance d
c. b types of curvature on the pen a  <dig> molecule, visualized split into two strands. accessibility to the regions may be affected when neighboring regions are occupied depending on either positive curvature , or negative curvature 



determining steric effects and rules for various pen a  <dig> conformations and model resolutions
the cutoff distancedc is an important parameter in this study that is used to help us automate rule set construction. in this paper, we use the term cutoff distance to specify the maximum distance separating two binding regions on a strand of pen a  <dig> at which the two regions have steric effects on each other , meaning that if one of these regions is bound to a receptor, then the probability that the other region can be bound to a receptor is reduced. the cutoff distance determines the rule set of the rule-based model. for each conformation and model resolution, the cutoff distance is varied and tested to find its optimal value, which is the value that results in a rule-based model that most accurately represents the aggregate size probability data obtained from the monte carlo simulation.

the pen a  <dig> molecule is flexible and has various possible conformations due to local energy minima. in our model, ige-fc εri receptor complexes are bound to a two-dimensional cell membrane, and the pen a  <dig> molecule is constrained to move on a 2d surface. each pen a  <dig> conformation possesses different curvature properties. in this study, we focus on native  <cit> , s-shaped, and u-shaped conformations . the conformations for our study were designed using standalone foldit  <cit>  and were energy-minimized using moil software  <cit> .

the molecular curvature around a binding region, along with the ige receptors bound to neighboring binding regions, may cause steric hindrance around the binding region, i.e., ige receptors may be prevented from binding to the region due to the region being blocked by receptors bound to neighboring regions. a neighboring region is any region that is close enough to the region under consideration to potentially block it if bound to a receptor. there are three general categories of steric effects that we consider in our model, which are illustrated in fig. 2b. firstly, if all neighboring regions are unbound, there is no steric hindrance imposed on a binding region. secondly, if the molecular curvature around a binding region is positive , receptors bound to neighboring regions are unlikely to affect the accessibility to this region since positive curvature around two regions pulls them farther apart . lastly, if the molecular curvature around a binding region is negative , receptors bound to neighboring regions may reduce the accessibility to this region since negative curvature around two regions brings them closer together .

the distances between each pair of binding regions on each strand of the pen a  <dig> molecule were measured for each pen a  <dig> conformation studied. for region pairs located in an area of negative curvature, the linear distance between the regions was measured. otherwise, the distance of a free-form path along the molecule between the two regions was used. this difference in distance measurement accounts for the variation in steric effects that results from different types of curvature. if the distance between a pair of regions is less than the specified cutoff distance, then those two regions are considered to exert steric effects on each other, and the steric hindrance is encoded into the binding rules for those regions.

for this study, the first rule construction method we tested used a simple set of rules in which every rule has the same rate constant kf <dig>  and no binding is allowed onto a region that has any steric effects exerted on it by any other region. the second method builds on the first method by allowing binding onto these regions with a reduced, but non-zero, probability set by a separate forward rate constant kf <dig> assigned to rules that specify a steric hindrance between regions.

given that r is the distance between two binding regions and dc is the cutoff distance, if one of these two binding regions is occupied and the other region is free, the binding rate constant kf for a receptor binding to the free region is assigned according to the following: 
 ifr>dc,thenkf=kf1= <dig> molecule−1s− <dig> ifr≤dc,thenkf=kf2<kf <dig>  

the rate constant kf <dig> was determined by performing an optimization and fitting the resulting aggregate size data to that of the 3d monte carlo model.

rate constant optimization
because the cutoff distance is unknown, this parameter was varied from  <dig>  nm to  <dig>  nm in  <dig>  nm increments, with the rule set being reconstructed for each cutoff distance. an optimization of kf <dig> was performed for every cutoff distance.

the forward rate constant kf <dig> for each pen a  <dig> conformation and model resolution was optimized using an adaptive algorithm based on the metropolis-hastings algorithm. this algorithm finds a minimum of the residual sum-of-squares  between the rbm data and the monte carlo data. if the σ value for a new rate constant kf2n is σn, the current σ value is σc, and the current rate constant is kf <dig>  then the rate constant is determined according to the following: 
 ifσn>σc,thenσc=σn&kf2=kf2nw/ prob.e−Δσ/t,ifσn>σc,thenσc=σc&kf2=kf2w/ prob.1−e−Δσ/t,ifσn≤σc,thenσc=σn&kf2=kf2nw/ prob. <dig>  

if σn is higher than σc, then σn  are accepted with a probability dependent on the difference between σn and σc, Δσ, and the simulated annealing temperature t. if the new value is accepted, then the rate constant is incremented according to the specified step size, and the new rate constant is tested. adaptive rate constant step sizes of  <dig> ×10− <dig> molecule −1s− <dig> and  <dig> ×10− <dig> molecule −1s− <dig> were used . however, if the new value is rejected, then the algorithm will choose a new rate constant at random from over the entire allowed range. the algorithm was allowed to search over the range  <dig>  to  <dig>  molecule −1s− <dig>  we empirically determined from previous scans of kf <dig> that σ for any value of kf <dig> greater than  <dig>  molecule −1s− <dig> would be too high to be acceptable.

rule-based model implementation
the rule-based model is specified using the bionetgen language  <cit>  and implemented with the rulebender program  <cit> . rulebender generates the odes associated with the binding rules and tracks the aggregates that are formed as the ige receptors bind to the pen a  <dig> molecules in an ode simulation. each strand of the two-stranded molecules is simulated separately. each run takes no more than  <dig> seconds to reach the steady state.

another version of the rule set with forward binding rate constants proportional to the number of binding sites in the region was also tested, but did not yield aggregate size data that fit better to the monte carlo data than the rule sets used.

aggregate size probability calculation
our model assumes that pen a  <dig> is comprised of two strands, which we refer to here as strand i and strand ii. therefore, the probability of formation of an aggregate of a certain size is calculated by combining the independent probabilities of formation of each strand. the probability p to form an aggregate of size n is given by: 
  <dig> p=∑m=0npipii, 

  <dig> p=∑m=n−66pipii, 

where pi is the independent probability of forming an aggregate of size n in strand i.

variation of rule set with curvature
in order to more clearly illustrate how the set of binding rules for a given molecule is affected by molecular curvature using our method of rule construction, we present an example of a u-shaped pen a  <dig> molecule with varying curvature. we look at three molecules: the u-shaped molecule seen in fig.  <dig>  the same molecule with its two ends rotated inward by  <dig> degrees, and the same molecule with its two ends rotated inward by  <dig> degrees . it should be noted that the latter two molecules are not energy-minimized conformations and are only presented here for the purpose of demonstrating our geometric rule construction method. the rule sets for strand i are shown for the 45-degree-rotated molecular structure , the 60-degree-rotated molecular structure , and the u-shaped pen a  <dig> molecule .
fig.  <dig> visualizations of the a u-shaped, b 45-degree-rotated, and c 60-degree-rotated molecular structures. 

t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t
t
i + ige →t


for each of these three molecules, the distances between each pair of binding regions were measured, and the rule sets for each molecule were constructed according to these distances. for the purpose of comparing how molecular curvature affects the rule set, the cutoff distance was fixed at  <dig>  nm, and the forward rate constant kf <dig> was fixed at  <dig>  molecule −1s− <dig>  the rule-based model for each molecule was simulated and the antibody aggregate size probabilities were calculated . we observe that as the degree of curvature of the molecule increases, the aggregate size distribution shifts towards smaller aggregate sizes, which corresponds to the increase in steric effects between binding regions encoded in the rule sets.
fig.  <dig> comparison of rule-based model aggregate size distributions for three curvatures. results for the u-shaped, 45-degree-rotated, and 60-degree-rotated molecular structures are shown



monte carlo geometric simulation
we compared the aggregate size distributions from our rule-based model to those of a previously developed monte carlo model  <cit>  that uses 3-d rigid body models of the antigens and receptors. initially, the molecules are randomly positioned within the bounding volume with no bonds present. then, during the simulation, at every time step, the positions of the molecules change according to a combination of random sampling and biological constraints such as molecular speeds, binding rates, and unbinding rates. also, at every time step, any two binding sites  within binding distance of each other will bind with a probability determined by the binding rate. the stability of the number of edges in the graph-based structure can be used to determine when to stop the simulation. since the simulation models activity taking place on the surface of a cell membrane, the molecules can translate on the xy plane and rotate about the z axis. aggregate size distributions are collected from packed structures after the simulation reaches a steady state.

it should be noted that experimental data pertaining to the aggregation of ige-fc εri receptor complexes onto the pen a  <dig> molecule is not readily available as of the date this work was written. therefore, we cannot compare the computational results of this work to experiment. in addition, the 3d monte carlo simulation does not include energetics, which limits our understanding of receptor binding to pen a  <dig> and is the reason why we cannot derive the forward rate constants directly from the simulation.

the 3d molecular models of the monte carlo simulation were created by generating isosurface models of the all-atom molecular structures using ucsf chimera  <cit> . since single monte carlo runs can require over  <dig> hours of computation  <cit> , it would be preferable to use lower resolution models to reduce computation time. however, lower resolution models can also introduce simulation effects that are difficult to quantify. we created 3d models with different resolutions and used our novel rule-based method to examine how steric effects vary with resolution. in order to create 3d models with a lower resolution, we performed polygon reduction using autodesk maya  <cit>  to reduce the number of polygons by  <dig> %,  <dig> %,  <dig> %,  <dig> %,  <dig> %, and  <dig> % . in our study, we also used the original isosurface models, which we refer to as having  <dig> % polygon reduction.
fig.  <dig> creation of 3d molecular models at various resolutions. isosurface models and subsequent polygon reduction are used to generate these models



calculating differences from monte carlo geometric simulation and rule-based model
in order to quantify the difference between the monte carlo and rule-based modeling aggregate sizes for each conformation and model resolution, the residual sum-of-squares  normalized by the total number of possible aggregate sizes  was calculated for each conformation and model resolution. the equation used to calculate the normalized σ is: 
  <dig> σ=∑i=1npmci−prbmi2n, 

where n is the total number of possible aggregate sizes in a histogram , pmci is the occurrence probability of the ith aggregate size of the monte carlo data, and prbmi is the occurrence probability of the ith aggregate size of the rule-based modeling data.

since the data points used in this calculation are probabilities, the maximum possible normalized σ is  <dig>  and the minimum possible normalized σ  is zero.

RESULTS
experimental setup
monte carlo simulation
the environment of the monte carlo simulations was a  <dig> nm x  <dig> nm  discrete membrane with non-periodic boundaries. for each run, one pen a  <dig> molecule and  <dig> ige-fc εri receptor complexes were simulated, such that the receptor density was ∼ <dig> receptors/ μm <dig>  sixty runs were performed for each pen a  <dig> conformation. the values of binding and unbinding rates for pen a  <dig> are currently unknown, thus we cannot determine kinetics from our simulation, only possible packing structures. in our simulations we use binding and unbinding rates that were determined for a synthetic ige antigen  <cit>  with values  <dig>  molecule −1s− <dig> and  <dig>  s − <dig> respectively. the diffusion coefficient  <dig>  μm2/s of ige-fc εri found in  <cit>  was used for all molecules. a time step of  <dig> μs was used, and every experiment was run for  <dig>  time steps, which is long enough for the simulations to reach a steady state.

the reduction in speed of aggregates as they increase in size  <cit> , which has not been fully quantified, is included in the simulation by reducing the diffusion coefficient of an aggregate such that it is inversely proportional to the size of the aggregate. for example, the diffusion coefficient of an aggregate containing five receptors would be 1/ <dig> of the original diffusion coefficient. the method of speed reduction implemented only affects aggregation kinetics and does not have a significant effect on the packing structure of aggregates at equilibrium.

the monte carlo simulation code was developed using the parasol motion planning library . the simulations were run on a supercomputer housed at the university of new mexico, utilizing single cores of intel xeon e <dig> processors with  <dig> gb of ram per processor.

rule-based modeling
the rule-based model was specified in the bionetgen language, and ode simulations were conducted on these models using rulebender  <cit> . in each experiment,  <dig> pen a  <dig> antigen molecules and  <dig> receptors were simulated. because each of the two strands was simulated individually, the total population included  <dig> strand i molecules,  <dig> strand ii molecules, and  <dig> receptors. each experiment was run for  <dig> time steps, long enough for the simulation to reach a steady state, using a time step of  <dig>  s. three pen a  <dig> conformations were used , which are made distinct in our simulations only by the distance between binding regions.

rule sets
the optimized cutoff distance corresponds to an optimal set of binding rules for each conformation of pen a  <dig> at  <dig> % polygon reduction.

the optimal rule sets were found to be the same for all three conformations, although the optimized rate constant kf <dig> varies based on conformation. these rule sets are shown for strand i  and strand ii  of the pen a  <dig> molecule.
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t
t
ii + ige →t


the forward rate constant kf <dig> and the cutoff distance range were optimized for each of the three energy-minimized conformations of pen a  <dig> at  <dig> % polygon reduction. table  <dig> displays the rate constants, cutoff distances, and σ values for the native, s-shaped, and u-shaped pen a  <dig> conformations.

k

k

k

σ


the monte carlo aggregate size probability histogram data is shown along with the optimized rule-based modeling data for the native, s-shaped, and u-shaped pen a  <dig> conformations at  <dig> % polygon reduction . the error bars for the monte carlo data were calculated by binning the  <dig> runs into  <dig> sets of six runs each and then calculating the standard error of the mean.
fig.  <dig> comparison of monte carlo  and rule-based model  aggregate size distributions. results for the native , s-shaped , and u-shaped  pen a  <dig> conformations are shown



comparing aggregate formation for each pen a  <dig> conformation
for the 3d monte carlo simulation, we observe that there is a significant difference between the aggregate size distribution of the s-shaped conformation and that of the native and u-shaped conformations. the optimal forward binding rate constant kf <dig> shows variation between conformations, particularly between the s-shaped conformation and the other two. however, the optimal set of binding rules was found to be identical for all three conformations, and the optimal cutoff distance range is similar, but not identical, for all three conformations. this indicates that the distance at or below which two binding regions exert significant steric effects on each other is not highly dependent on conformation for the three energy-minimized conformations studied.

the rate constant kf <dig> represents the probability of an ige-receptor complex binding to a region on the pen a  <dig> molecule that is under significant steric hindrance from ige-receptor complexes that are bound to neighboring binding regions. for the s-shaped molecule, the optimized kf <dig> value is approximately half of the kf <dig> value for the other two molecular geometries, indicating that the curvature of the s-shaped molecule may be reducing the probability that a binding region can bind without being blocked by receptors bound to nearby regions. this difference indicates that molecular geometry may play an important role in antibody aggregation onto the pen a  <dig> molecule and should be taken into consideration in future aggregation research.

results for resolution study
in addition to molecular geometry, the resolution of the 3d molecular models used in our monte carlo simulation also affects the aggregation data generated by the simulation. as the resolution is reduced, the volume of the 3d models is also reduced, causing a shift in aggregate size towards larger aggregates. in this study, we seek to use our novel rule-based method to better understand the effect of resolution on the steric effects between the binding regions of the pen a  <dig> molecule. we look at the probability of binding for each of the binding regions and how these probabilities vary with resolution and with molecular geometry. we also look at the variation in aggregate size distribution with resolution, and we examine the effect of model resolution reduction on the two optimized parameters used in our rule-based model: the cutoff distance and the rate constant kf <dig> 

probabilities of binding for individual binding regions
the probability of binding for each individual binding region of the pen a  <dig> molecule varies with resolution and with conformation. for each optimized rule-based model, the probability of binding versus model resolution is shown for each of the six binding regions used in our model for the native, s-shaped, and u-shaped conformations .
fig.  <dig> binding probability versus resolution rule-based modeling data for the  <dig> pen a  <dig> configurations. data for strand i  and strand ii  are shown. the letters a, b, c, d, e, and f represent the six binding regions used and the letters n, s, and u represent the configuration in the rule-based model. the x-axis is the percent reduction and the y-axis are the binding sites



from the heat map we observe that region d exhibits strong variation in binding probability with resolution for both strand i and strand ii for each of the three conformations. region c exhibits strong variation for strand ii of the u-shaped type. we also observe that certain pairs of binding regions display symmetry such that their binding probabilities have exactly the same value. for example, for the native type at  <dig> % reduced resolution, the region pairs a and f, b and e, and c and d are symmetric for both strands. this symmetry occurs due to the strong similarities between the binding rules of two or more regions; for example, the binding rules of regions in symmetric groupings encode steric effects for the same number of neighboring regions.

aggregate size histograms
the monte carlo aggregate size probability histogram data for each resolution of the monte carlo simulation is shown along with the optimized rule-based modeling data for the native , s-shaped , and u-shaped  pen a  <dig> conformations. the error bars for the monte carlo data were calculated by dividing the  <dig> runs into  <dig> sets of six runs each and then calculating the standard error of the mean. we observe that for all three conformations, the aggregate size distribution shows a general trend of shifting towards larger aggregate sizes as the resolution decreases.
fig.  <dig> aggregate size histograms for the native pen a  <dig>  a comparison of the monte carlo  and optimized rule-based model  aggregate size distributions are shown. the error bars for the monte carlo data were calculated by dividing the  <dig> runs into  <dig> sets of six runs each and then calculating the standard error of the mean

fig.  <dig> aggregate size histograms for the s-shaped pen a  <dig>  a comparison of the monte carlo  and optimized rule-based model  aggregate size distributions are shown. the error bars for the monte carlo data were calculated by dividing the  <dig> runs into  <dig> sets of six runs each and then calculating the standard error of the mean

fig.  <dig> aggregate size histograms for the u-shaped pen a  <dig>  a comparison of the monte carlo  and optimized rule-based model  aggregate size distributions are shown. the error bars for the monte carlo data were calculated by dividing the  <dig> runs into  <dig> sets of six runs each and then calculating the standard error of the mean



rate constants versus resolution
we predict that for models with the same cutoff distance range , the optimized rate constant kf <dig> should increase as the aggregate size distribution shifts toward larger aggregates. this is because higher rate constants correspond with increased binding, which results in larger aggregates. looking at the histograms in figs.  <dig>   <dig>  and  <dig>  as well as the rate constant data in table  <dig>  we do indeed observe this trend, which is most clearly seen by comparing the  <dig> %,  <dig> %, and  <dig> % reduced resolutions of the native pen a  <dig>  for these resolutions, which all have the same optimized cutoff distance range, the aggregate size distribution shifts toward larger aggregates as the reduction in resolution increases, and there is a corresponding increase in the optimized kf <dig> value with reduction in resolution. we observe a similar feature for the  <dig> % and  <dig> % resolutions of the u-shaped pen a  <dig> 
k
f1
k
f2
k
r
σ
k
f1
k
f2
k
r
σ
k
f1
k
f2
k
r
σ


it may be expected that this increase in kf <dig> with a reduction in resolution should also hold true for other resolutions with the same rule set, such as the  <dig> % and  <dig> % reduced resolutions of the native pen a  <dig>  however, looking at the histograms in fig.  <dig>  we see that the monte carlo aggregate size distribution of the  <dig> % reduced resolution is shifted toward smaller aggregate sizes than is the  <dig> % reduced resolution. given this data, the fact that kf <dig> is larger for the  <dig> % reduced resolution than for the  <dig> % reduced resolution makes sense. it should be noted that this unexpected feature of the monte carlo data may be due to the rather small number of runs  performed for each monte carlo resolution. we observe a similar feature for the  <dig> %,  <dig> %, and  <dig> % resolutions of the s-shaped pen a  <dig>  for the  <dig> % and  <dig> % resolutions of the s-shaped pen a  <dig>  and for the  <dig> % and  <dig> % resolutions of the u-shaped pen a  <dig> 

cutoff distance versus resolution
for each pen a  <dig> conformation, we plotted the optimal cutoff distance  versus the monte carlo resolution for the native, s-shaped, and u-shaped pen a  <dig> conformations . the goal of this model is to aid in understanding how the optimal cutoff distance, and hence, the steric hindrances between binding regions vary with the resolution for different conformations of pen a  <dig>  the error bars on some of the data points represent the range of possible cutoff distances that correspond to the same set of rules.
fig.  <dig> cutoff distance versus resolution data for the  <dig> pen a  <dig> conformations. the error bars on some of the data points represent the range of possible cutoff distances that includes the optimal cutoff distance



as the resolution of the monte carlo model decreases, the volume of the molecular models decreases, and consequently the steric hindrance between binding regions decreases, resulting in a shift toward larger aggregates when there is a reduction in model resolution. this is observed in fig.  <dig> for the cutoff distance range, used in this method as a measure of average steric hindrance between binding regions, which generally decreases as the resolution decreases. we also observe that some of the resolutions have the same optimized cutoff distance range. for example, the  <dig> %,  <dig> %, and  <dig> % resolutions of the native pen a  <dig> all have a cutoff distance range of  <dig> – <dig>  nm.

studying how the cutoff distance range changes with resolution provides us with useful information about how the average steric hindrance changes  with resolution. for example, from the native pen a  <dig> data, we can infer that the average steric hindrance is about the same for the  <dig> % and  <dig> % resolutions. it should be noted that some cutoff distance ranges are rather large, such as the range of  <dig> – <dig>  nm, and the exact optimized cutoff distance lies somewhere within that range. therefore, for the  <dig> %,  <dig> %, and  <dig> % resolutions, we cannot assume that the average steric hindrance is exactly the same.

comparing this data with the distances between binding regions on the pen a  <dig> molecule allows us to predict which pairs of binding regions we expect to exhibit the greatest amount of steric hindrance on each other for each resolution of the monte carlo model. the cutoff distance for the  <dig> % and  <dig> % reduced resolutions of the native type is  <dig>  nm. we can predict that any pair of binding regions with this or a smaller distance between them will exhibit a significant amount of steric hindrance on each other. in this case, these pairs of binding regions on strand i would be a and b, b and c, c and d, and e and f. on strand ii, however, these pairs of binding regions would be a and b, b and c, and e and f. this is due to differences in curvature between the two strands. the distance between binding regions c and d on strand i is  <dig>  nm, which is the cutoff distance. on strand ii, the distance between binding regions c and d is  <dig>  nm, which is outside the cutoff distance range, so we can predict that c and d do not exhibit significant steric hindrance on each other on strand ii.

we observe that there are significant differences between the plots of cutoff distance versus resolution for each of the three conformations . this is not unexpected, as the differences in curvature among the three molecules means that the distances between binding regions also vary. for example, the resolutions at which the cutoff distance range changes are not the same for the three conformations. in addition, the cutoff distances themselves vary based on conformation. these differences indicate that molecular geometry plays an important role in antibody aggregation onto the pen a  <dig> molecule and should be taken into consideration in future research.

CONCLUSIONS
we developed a novel implementation of rule-based modeling that encodes molecular geometry into the rules and associated rate constants. we studied the effects of molecular geometry on the rule sets of three u-shaped molecules of varying curvature. we also studied three energy-minimized molecular conformations of the pen a  <dig> allergen using this method combined with a 3d rigid-body monte carlo simulation at seven different resolutions of the 3d models. we analyzed the similarities and differences among the rule-based models for each geometry and resolution to determine how the steric effects between allergen binding regions vary with molecular geometry and model resolution.

in our study of the u-shaped molecule, we found that the degree of curvature of the antigen has a strong effect on the rule set constructed using our proposed method, with individual binding regions becoming dependent on a greater number of neighboring binding regions as the degree of curvature increases. in our study of the three energy-minimized pen a  <dig> conformations, we found that our proposed method of rule set construction provides a quantification of the steric effects that affect binding site accessibility and allows us to observe which neighboring binding regions most strongly affect a particular region. although the set of binding rules will not always be different for different antigen conformations, the binding rate constants associated with the rules provide another means of quantifying the variation in aggregate size distribution based on antigen conformation.

in our resolution study, we have shown that there is a downward trend in the optimal cutoff distance with a decrease in resolution for all three of the pen a  <dig> conformations. from this finding, we can conclude that the reduction in volume that results from polygon reduction of the 3d molecular models results in increased binding site accessibility. we also observed that some resolutions of the same conformation have identical optimal cutoff distances. from this data, we can extract useful information about similarities between different resolutions. we could use this data to develop models for the prediction of full-resolution aggregate size data given only lower-resolution data combined with our novel rule-based model.

we used a rod-shaped molecule in our study, but our method for measuring distances between binding sites could be modified for use with other molecular geometries. furthermore, our method could be extended to model experimental data in the future; analysis of probe positions in electron microscopy images allow for the estimation of receptor clustering.

the integration of molecular geometry with rule-based modeling to simulate molecular assembly processes produces detailed insights into binding site accessibility while overcoming the problem of combinatorial complexity. these geometric insights can provide quantitative information on the steric accessibility of binding regions, therefore providing details that were not traditionally produced from rule-based modeling. another approach to gain computational efficiency, reduced resolution models, can be used to model assembly structures in reasonable time-frames. however, the impacts of reduced resolution can be difficult to quantify. we have shown, through the integration of geometric rule-based modeling and three-dimensional reduced resolution monte carlo simulations, that this difference can both be quantified and potentially used for evaluating the quality of reduced resolution structures.

