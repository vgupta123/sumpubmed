BACKGROUND
data visualisation is important for many scientific disciplines, and this is particularly so in genetics, where the recent development of high-density, single-nucleotide polymorphism  arrays can provide information on thousands of snps and structural variants  <cit> . although some results can be recovered by sophisticated analysis, visual data can provide an extraordinary amount of useful information. several programs have been developed to assist researchers in the analysis of the huge amount of data available on genetic variations. the affymetrix software gtype and the more recent genotyping console allow raw intensity data to be analysed and provide information on genotype and intensity for each probe, which is then simple to export for analysis with other tools.

the cnag  <cit>  elaborates the raw data obtained by the affymetrix platform through a simple graphical interface, and displays information on intensity and on loss-of-heterozygosity  combined with the chromosome ideogram. another program, dchip  <cit> , analyses raw affymetrix data and displays the genotype, loh and intensity information in an array of samples  × snps  with a colour assigned to each polymorphism according to a general scheme. snpscan  <cit>  displays genotype and copy number  state information simultaneously to identify chromosomal abnormalities.

our goal was to develop a user-friendly visualisation tool that could rapidly upload, visualise and compare the huge amounts of data produced by the affymetrix genechip® human mapping chips, and integrate certain earlier software functions. the visualisation tool translates the genotype and cn information obtained by the affymetrix genechip® human mapping chips into a colour code. the software allows the user to look at whole-genome variability by visualising the genotype and normalized quantitative data of one or more individuals for millions of snps in different colours in a single window. the entire genome snps can be displayed either together or separately for each chromosome.

implementation
genotypecolour™ analyses the data produced by all of the commercially available affymetrix genechip® human mapping arrays, including the most recent  <dig>  chips.

genotypecolour™ is written in visual basic and uses the access database to store information. if the microsoft access application is not installed on a computer, the program can run after the installation of microsoft jet  <dig>  database engine and microsoft data access components   <dig>  sp <dig>  which are free to download from the microsoft web site  <cit> . at present, genotypecolour™runs only under windows with framework.net  <dig>  and has been tested on the windows  <dig>  windows xp and vista operating systems. the minimal hardware requirements for analysis of the  <dig> k arrays  are  <dig> mb of ram, and a cpu pentium  <dig>  <dig>  ghz, whereas at least  <dig> gb of ram is recommended for the analysis of  <dig>  and  <dig>  chips.

software performance was tested on a notebook computer with cpu intelcore <dig>   <dig>  ghz and  <dig> gb of ram. uploading  <dig> k probes for  <dig> samples took  <dig> minutes for the genotype data and another  <dig> minutes for the cn state information. visualisation of the data, however, took only  <dig> seconds.

the upload and visualisation of  <dig>  data took slightly longer than it did for the  <dig> k probes, requiring almost  <dig> minutes for one sample and for cn state uploading, whereas visualisation of the data took approximately  <dig>  minutes. however, since the longest time required was to upload the relative information of the probes' positions, the upload of the other samples was much faster. as an example, uploading the genotype data of the other  <dig> samples took only  <dig> minutes. once the data were uploaded, opening the files took only a few seconds.

RESULTS
software description
genotypecolour™ does not elaborate the raw data of the affymetrix human mapping chip; instead, it imports the data analysed by the affymetrix consoles and displays them in a different way. the algorithm needs two input files, one containing genotype information and the other the cn state information. both files are obtained by affymetrix gtype or genotyping console software programs. genotypecolour™ is programmed to display the genomic variation in four different ways, as described below.

visualisation of genotypes and the cn state
the algorithm reads the genotype snp calls exported by affymetrix gtype or genotypeconsole software and assigns a square  to each snp on the computer screen. all snps are displayed one after the other horizontally, from the top to the bottom of the page in a left-to-right pattern, starting from the first snp on chromosome  <dig> and ending with the last snp on chromosome x. for the  <dig>  data, snps on chromosome y and on mtdna are displayed after those on chromosome x.

the number of snps in each line can vary from  <dig> to a number depending on the software window and the computer screen. it is possible to change the way the data are visualised to generate the most informative image by changing the window size. each square is displayed with a different customised colour according to the genotype of the snp shown . in this way, the whole genotype variability of one subject can be visualised on the computer screen at the same time .

the software allows the simultaneous display of multiple samples , which are shown next to one another and are visualised as coloured columns. increasing the number of samples reduces the number of snps that can be visualised on the screen. the scrolling bar can be used to visualise all snps along the genome analysed. the genotype images can be sorted by chromosome and magnified to see the areas of interest better. by clicking on an individual snp/square, it is possible to obtain information on its name, its genome position and its proximity to genes and coding regions. the graphical visualisation of genotypes can be transformed into a table displaying the percentages of aa, bb, ab and no call for each sample in the whole genome or in a selected region, by selecting the "show statistics" option.

the use of customized colours to visualise data is very useful for the detection of particular regions. for example, in figure  <dig>  which displays a portion of the genome variability of  <dig> subjects, the attribution of the same colour  to the homozygous genotypes allows loh regions to be visualised better. to help detect these areas, it is possible to create a list of all chromosome regions with more than n  consecutive snps with/without a particular genotype. this list can be exported in an excel format.

the snp allele frequencies of european, asian and african populations as reported by the affymetrix database are memorised in the software for all chips, excluding  <dig> . after selecting a population for each subject, the software assigns a colour to each homozygous genotype according to whether it is the most frequent or the rarest homozygote in that population. the percentage of rare homozygotes is also displayed, and this may help the classification of samples.

after importing the cn state of each probe from the affymetrix cnat <dig> viewer or genotyping console, the information can be displayed immediately with the genotype information. whereas the genotype information is given by the colour of the square, the cn state  is displayed by changing the height of the squares, thus visualising genotype and cn state simultaneously . obviously, changing only the height of the squares converts them into rectangles. in this visualisation, both the polymorphic and the non-polymorphic probes are displayed for the  <dig>  chips, with the difference that the former are coloured according to genotype, whereas the latter have the same colour as the no call genotype.

this option may be useful to test the accuracy of the data. for example, the visualisation of heterozygous snps in regions with a cn state equal to  <dig> could suggest genotype error, cn miscalculation, hybridization of probes to segmental duplicated regions or mosaicism. to visualise cn alterations  and the smaller cn variations  dispersed within the genome better, it is possible to select the "show genomic variation only" option, which allows the visualisation of regions with cn states other than  <dig>  by masking all other information .

in this visualisation, the software allows the user to create a list of chromosomal regions with a cn state other than  <dig> . the cnvs are displayed in a table of samples  and cnvs . this representation helps to identify cnvs shared among samples, since overlapping cnvs appear in the same row. for each cnv, its chromosome position, the number of snps involved, the equivalent variation in the database of genomic variants  <cit>  and an active link to the ucsc human genome browser database  <cit>  are displayed. the cnv list can be exported into an excel format.

genotype comparison
the other important feature of genotypecolour™ is its sample genotype comparison function. presently, the software allows the genotype or the cn state of many individuals for thousands of snps to be depicted, and it allows comparisons to be shown.

when comparing two or more samples, for each snp the algorithm evaluates whether the samples share the same genotype, only one allele or no allele, and assigns a colour to the corresponding square on the screen. this function allows fast and simple detection of chromosomal regions of complete or partial identity among samples, and allows identification of the origin of chromosomal alteration in parent-child comparison. a list of these regions can be exported in excel format. graphical visualisation is combined with information on the percentage of snps sharing identical genotypes, only one allele or no allele.

one implementation of genotype comparison is trio comparison. when this option is selected, the software displays snps with mendelian segregation and with mendelian inconsistencies in two different colours.

cn state comparison
as well as genotype comparison, genotypecolour™ allows the user to compare the cn state of two or more samples. in this case, the algorithm compares the cn state of each snp in all samples analysed and assigns each snp a colour depending on the outcome of the comparison. for each snp, there are six possible outcomes: a diploid state in all samples; deleted or duplicated in all samples; deleted in some samples; duplicated in some samples; and deleted and duplicated in some samples .

applications
figures  <dig>   <dig> and  <dig> show the visualisation with genotypecolour™ of the human mapping chip  <dig> k data. the three figures are examples of the application of genotypecolour™ to the analysis of a trio, of a large pedigree and of  <dig> tumour specimens, respectively. in the first example, genotypecolour™ was used to look for possible cryptic alterations in a proband with an apparently normal karyotype . both parents were analysed to verify the origin of possible alterations. for the first analysis, both genotype calls were imported from the affymetrix gtype software and the cn state from the affymetrix cnatviewer. in the proband, the genotype visualisation showed a region of loh on the small arm of chromosome  <dig> 

after uploading the cn state, it became clear that the loh was due to a deletion that was not present in the parents . the genotype comparisons between the son and his parents highlighted that the chromosome with the deletion was of paternal origin . the same analysis was performed with cnat, cnag, dchip and snpscan. as shown in figure 6b–e, all software detected the deletion and showed the deletion and the region of loh graphically; however, none was able to show the immediate identification of the maternal or paternal origin of the deletion.

in the second example, simultaneous comparisons of different members of the same family were made by assigning three different customised colours to the three possible outcomes . as shown in figure  <dig>  the three colours  were displayed homogeneously when comparing unrelated subjects, whereas the colours were clustered with different patterns according to the level of kinship in all other cases. for example, in parent-child comparisons, the colour corresponding to no common allele  was virtually absent, showing that the parents always shared at least one allele with their children for each snp. the small number of yellow pixels , distributed randomly inside the genome, was compatible with the genotype error rate of the array methodology.

however, if the coloured pixels corresponding to the "aa-bb comparison" are concentrated in a particular chromosomal region, this indicates the presence of potential uniparental disomy  or cnv in one of the two samples, as in the case of figure 6a. the comparisons between brothers or sisters were characterized by wide monochromatic regions  intercalated among regions with only two colours  and narrow regions with all three colours. the black clusters correspond to regions where the brothers and sisters share the same portions of paternal and maternal chromosomes; black and red clusters correspond to regions where they share only one parental chromosome; black, red and yellow clusters correspond to regions where they inherited different chromosomes  from their parents.

in addition, the boundaries between these regions correspond to recombination breakpoints. in comparisons between grandchild-grandparent, nephew/niece-uncle or cousins, the dichromatic region intercalated between regions with all three colours identify shared inherited haplotypes. the frequency and extension of these dichromatic regions decrease as a function of the degree of kinship up to at least the third generation.

these examples highlight how the genotypecolour™ genotype comparison option can be used to detect kinship and shared haplotypes without calculations or elaborations, using only this new graphical analysis of genotype data. this tool is useful also to identify the origin of the chromosomal alterations in parent-child comparisons and for many other applications, such as linkage and association studies, and population evolution.

in the third example,  <dig> tumour specimens that belong to the dna collection of  <dig> primary lung adenocarcinoma analysed by weir et al.  <cit>  were compared to detect cnas. the raw data , freely available, were downloaded from the broad institute web site  <cit>  and analysed with genotyping console software to obtain the input files required by genotypecolour™. comparison of figures  <dig> and 8a shows how different is the visualisation outcome for  <dig> healthy subjects and  <dig> dna tumour samples, respectively.

even if the analysis was done on only  <dig> out of the  <dig> samples of the original research  <cit> , most of the large-scale cnas observed in the original work were clearly identified. it is clear simply from visual inspection that certain chromosomes, such as  <dig>   <dig>   <dig> and  <dig>  are less affected by copy number aberrations in the lung adenocarcinoma dna cell lines analysed . in all these chromosomes  the predominant colour is black, indicating regions without cna. the large areas of yellow and pink show that the distribution of deletions and duplications is usually not random and is localized on specific chromosome arms.

the chromosomal distribution of large-scale deletions and amplifications shown by genotypecolour™ agree with those shown by weir et al.,  <cit>  in figure 1b of their manuscript. near these preferentially deleted or duplicated regions, others can be seen where both events are present in different samples. these chromosomal regions are reported in green and the largest are those on chromosomes  <dig> and  <dig> 

the visualisation of the genotype and cn state of all  <dig> samples allows better definition of breakpoint regions. there is an example in figure 8b of the genotype and cn state of snps on chromosome  <dig>  in addition to the amplification on the small arm , rarer smaller aberrations can be visualised. the presence of heterozygous snp genotypes and cn states equal to state  <dig> may be an indication of cellular mosaicism for specific chromosome regions . this example highlights how the cn state comparison option can be used to analyse tumour samples and to identify chromosomal regions preferentially deleted or duplicated in different tumours. this option is also very useful for rapid identification of cn state polymorphisms or cnvs that are present only in certain individuals and might be the cause of specific phenotypes.

discussion
genotypecolour™ software represents a new and useful tool for the visualisation of genome variability. indeed, beside its distinctive features, it condenses in a unique program many of the characteristics of other available software. the main properties of genotypecolour™ are described below.

 <dig>  visualisation of the genotypes of thousands of snps in a single computer screenshot. dchip has a similar function; however, the zoom resolution that allows the visualisation of all chromosomes does not allow the visualisation of all snp genotypes. snpscan, even if it can discriminate between homozygous and heterozygous genotypes, does not allow visualising and discrimination of all snps, since many overlap. programs such as cnag and cnat do not display the genotype of each snp, even if they do highlight loh regions.

 <dig>  the simultaneous visualisation of genotype and cn state. to our knowledge, the only software allowing simultaneous visualisation of genotype and cn state is snpscan. in snpscan, each probe is plotted on a 2d graph with the  <dig> chromosomes on the x-axis and the cn state and the loh state on the y-axis. the homozygous/heterozygous state of the probe is inferred by the colour. genotypecolour™, however, in its maximum zoom-out visualisation, assigns a distinctive pixel to each snp and depicts them next to one another. this kind of plotting has the advantage of avoiding spatial overlap of probes and improves graphical visualisation. this allows the detection of very small loh or cnv regions, which can be visualised even better by the "show genomic variation only" option.

 <dig>  sample comparisons: with our software, a "consensus" image is displayed in which a different colour is assigned to each snp according to the genotype concordance of the samples compared. from these consensus images, regions of identity/diversity among samples are identified immediately. moreover, the same procedure can be applied to the cn state and to trio comparisons. the only program that can make paired and unpaired comparisons of genotypes between more than two samples is dchip; however, the algorithm used for the comparison is different from ours and at present it does not perform the cn state or trio comparisons.

 <dig>  the export of cnv and loh information in tabular format. genotypecolour™ allows us to export in a table the information of many samples simultaneously  × loh/cnv regions . this format improves the identification of chromosomal features common to more than one subject, and allows handling of information on cnv and loh for association studies.

 <dig>  the rapid comparison between control and pathologic tissues to identify cna in different chromosomal regions. this seems to be especially useful in tumours.

 <dig>  the visualisation of "no calls" in a different colour can give clear information on the quality of the procedure and on the random distribution and/or clustering of uninformative snps.

 <dig>  visualisation of population frequencies. this option could be used as a guide to the ancestry of the analysed samples.

CONCLUSIONS
in conclusion, we have created a program that does not require particular bio-computer notions and is easy to use thanks to its self-explanatory interface and detailed instruction manual. the purpose of genotypecolour™ is to provide a user-friendly tool that can rapidly upload, visualise and compare the huge amounts of data produced by the affymetrix human mapping genechips without losing the overall view of the data. indeed, a general view of results can make biological data easier to understand, followed by analysis with more specialised bioinformatic tools. only its extensive use by other research groups for specific biological problems will give a more exact view of the potential applications of this new way of visualising dna genomic data.

availability and requirements
project name: genotypecolour™

project home page: 

operating system: windows xp, windows  <dig>  windows vista.

programming language: visual basic

other requirements: mdac  <dig>  and microsoft jet  <dig>  database engine or microsoft access database

license: free non-commercial research use license

any restrictions to use by non-academics: commercial use license can be obtained by contacting the authors.

authors' contributions
sb conceived the software, carried out its design and planned and supervised the draft of the manuscript. cm participated in the planning and drafted the manuscript with contribution in the software development. sc developed the algorithm following the instructions of sb and cm. all authors have read and approved the final manuscript.

