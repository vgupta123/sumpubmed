BACKGROUND
the duplication-degeneration-complementation  model  <cit>  has been proposed to explain the unexpectedly high retention of duplicate genes  <cit> . briefly, the hypothesis proposes that, following gene duplication, redundant functions will degenerate at random from the daughter copies until their joint function matches that of the parent gene. the force for retention arises from the need to maintain ancestral functionality . originally proposed in the context of cis-regulatory elements, the model assumes regulatory elements with unique functions . in this context, each ancestral regulatory element is retained in at least one of the two daughter genes . if each gene retains at least one ancestral element, while all redundant elements degenerate, we reach a state known as subfunctionalization. perhaps the best studied example of this phenomenon involves the paralogous genes hoxa <dig> and hoxb <dig> in mouse development. hoxa <dig> is highly sensitive to retinoic acid, and is important for segment identity in rhombomere  <dig> in the hindbrain. hoxb <dig> is important for rhombomere  <dig> identity, and and is activated by hoxa <dig>  though its expression is maintained by autoregulation  <cit> . tvrdik and capecchi  <cit>  reconstructed a hypothetical ancestral form of this system composed only of hoxa <dig> with a hoxb <dig> autoregulatory element introduced into its promoter region, and found no marked disparity with wild type. these results suggest that autoregulation and high retinoic acid sensitivity have degenerated in hoxa <dig> and hoxb <dig> respectively, leading to the current state of subfunctionalization. this example illustrates how spatial subfunctionalization  is directly reflected by cis-regulatory subfunctionalization.

subfunctionalization may also be observed in the temporal expression domain . following a gene duplication event, the temporal expression pattern of the ancestral singleton gene is maintained by the duplicate daughter genes. however, degeneration of the temporal expression pattern can lead to each duplicate being expressed in distinct, though complementary, time domains. clearly, temporal subfunctionalization can occur independently, or together with, spatial subfunctionalization. indeed, reported examples of temporal subfunctionalization  <cit>  show both types coexisting.

several authors have investigated the prevalence of subfunctionalization using genomic data. here, it is often assumed that cis-regulatory binding motifs  are equivalent to the independent regulatory elements of the ddc model. this approach was taken by papp et al.  <cit> , who examined the evidence for subfunctionalization in duplicated yeast genes and found that the number of shared regulatory motifs has decreased over time, while the total number of motifs has remained unchanged, suggesting an important additional role for neofunctionalization . evangelisti and wagner  <cit>  reached similar conclusions. adopting a similar approach, he and zhang  <cit>  analyzed both protein-protein interactions in yeast and spatial gene expression in human tissue, and suggested a new model termed subneofunctionalization. under subneofunctionalization, gene duplication is followed by rapid subfunctionalization together with substantial and prolonged neofunctionalization.

here, we adopt a modeling approach that integrates both network complexity and population-level dynamics to investigate the importance of subfunctionalization following gene duplication. the model is used to examine apparent discrepancies between existing genomic studies and the ddc model. in general terms, the relationship between subfunctionalization at the regulatory level  and at the level of the product , remains unclear . this issue is also investigated using the model. the distinction we make between regulatory level and product level subfunctionalization should not be confused with genotype and phenotype respectively, since both levels  involve genotypic  differences.

broadly following the modeling framework of siegal and bergman  <cit> , we consider a finite population of m individuals, each modeled as a gene regulatory network. it is assumed that the population has recently undergone a whole genome duplication, increasing the number of genes in each individual from n to 2n, while maintaining the same number  of protein products as before the duplication. the genes i and i + n are paralogous. each genotype is represented by a 2n × n interaction matrix w, the elements wi,j ∈ {- <dig>   <dig>  +1} represent the positive, zero or negative influence of product j  on gene i.

at the network  level, we adopt a boolean model of gene regulation  <cit>  which, though simple, captures essential features such as the threshold response  <cit> , and additive regulation  <cit> . we do not assume each input can independently regulate its target, as in the ddc model, though such a scheme can indeed be represented. the phenotype corresponds to the temporal output s of a dynamical system  produced by the genotype , using initial conditions s that are assigned randomly a priori, and are kept constant throughout each simulation.

all m individuals in the initial population are identical and are copies of a randomly generated founder individual. to create the founder, we generate a n × n matrix q, with nonzero elements assigned at random with probability ci . each nonzero element is then assigned the value + <dig> or - <dig> with equal probability. the elements of q are duplicated rowwise in the 2n × n founder matrix w, such that wi,j = wi+n,j = qi,j. subsequent generations are produced by cloning random individuals from the population . here, the process is continued for  <dig> generations.

reproduction assumes mutation  at a rate μ. we make a distinction between a link deletion  and a link addition . thus defined, mutation represents a broad range of mutation classes encompassing changes in cis-regulatory elements  <cit> , alternative splicing regulation  <cit> , or trans-acting factors  <cit>  leading to link deletions or additions. focusing on the regulatory level for mutations in this way is justified by recent work recognizing the overwhelming relative importance of regulatory divergence in paralog gene evolution  <cit> . we introduce a global deletion bias parameter b ∈ , which defines a relative increase , or decrease  in probability for deletions . deletion bias is chosen according to its observed effect on cf, the connectivity in the final generation . the ddc model assumes that overall connectivity decreases as a consequence of the elimination of redundant interactions. the lower bound for connectivity under the hypothesis is cf = ci/ <dig>  since any further loss would start to eliminate non-redundant interactions. we therefore define the relative change in connectivity, d = cf/ci -  <dig>  and examine two cases: d =  <dig> , and d = - <dig>  .

we adopt a regime of strict stabilizing selection such that the phenotype, i.e. the temporal pattern of gene expression , remains identical through sucessive generations. this assumption concides with the neutrality premise of the ddc model, in that the combined behavior of each duplicated pair will be the same as that of the single ancestral gene. it also means there is no need to invoke positive selection. unless otherwise stated, we assume m =  <dig>  n =  <dig> and μ =  <dig>   <cit> .

throughout each simulation we measure connectivity, regulatory and temporal subfunctionalization and neofunctionalization . briefly, regulatory subfunctionalization is considered to exist if some ancestral inputs  are lost in each of the paralogs, but together they still complement each other to represent the original input set. neofunctionalization exists if new inputs evolve in either of the evolved paralogs. we also measure the number of shared links between two paralogs . paralogs are considered to be temporally subfunctionalized  if one is on and the other is off at a particular timepoint, and the reverse is true  at some other timepoint. we forsake spatial modeling and use only temporal modeling, focusing therefore on temporal subfunctionalization at the product level. thus construed, the model allows us, for example, to relate regulatory changes  to product-level  subfunctionalization. figure  <dig> shows a simple example of how regulatory changes  can lead through regulatory subfunctionalization, subneofunctionalization to neofunctionalization, while inducing temporal subfunctionalization at the product level.

our in silico results show that, in contrast to what is expected under the ddc model, regulatory subfunctionalization peaks and then decreases significantly, while neofunctionalization increases monotonically, eventually affecting the majority of genes. these results are in agreement with existing bioinformatics studies  <cit> . we argue that this behavior is a consequence of the high evolutionary plasticity in gene networks  <cit> . focusing on temporal subfunctionalization, we found it occurring at relatively modest frequencies, with the median not usually exceeding 20% of duplicate pairs across conditions. we compared these frequencies to a null  model with no stabilizing selection , giving us a distribution for the frequency of temporal subfunctionalization that would be expected by chance. from the comparison, we find that the actual frequencies observed are no higher than those of the null model, again contrary to expectations under the ddc model. we corroborated this finding using yeast microarray time-course data by showing that even the oldest paralogs exhibit similar frequencies of temporal subfunctionalization to what would be expected by chance. lastly, using the model, we show that regulatory subfunctionalization does not necessarily cause subfunctionalization at the product level. we find that behavior analogous to genetic dominance in duplicate gene pairs creates the potential for escaping local minima in network space, thus dramatically simplifying network structure.

RESULTS
regulatory subfunctionalization and neofunctionalization
a previous study of cis-regulatory elements in yeast  <cit> , has shown that, although the total number of regulatory motifs has remained unchanged over time , the number of shared regulatory motifs in paralogous genes has decreased. figure  <dig> shows how the model reproduces this behavior, observable in the progression of hi  for a particular set of conditions . across all conditions, we find that hi declines significantly  in agreement with previous observations  <cit> .

clearly, if hi declines and connectivity remains the same , then neofunctionalization must be playing an important role. indeed, in all cases analyzed , median neofunctionalization increases monotonically, approaching a relatively high steady state value, as the example in figure  <dig> shows. we find that the most important factor determining final  neofunctionalization appears to be the deletion bias , with greater deletion bias leading to less neofunctionalization. this makes intuitive sense since, by definition, new links are less likely to be created when the deletion bias is higher.

less intuitive is the progression of regulatory subfunctionalization. figure  <dig> shows its progress over time for a particular set of conditions . as predicted by the ddc model, the proportion of paralogous genes in a state of subfunctionalization increases following the genome duplication , as degeneration of redundant inputs occurs. under the ddc model, we expect to observe a monotonical increase in subfunctionalization, reaching some stable peak. this should be particularly true of the case where mean connectivity declines , since the theory predicts the degeneration of redundant links. however, in contradiction to the ddc model, the level of subfunctionalization peaks, and then falls to a final level significantly below this peak . furthermore, we find that final subfunctionalization is reduced as we decrease d , an unexpected result since under the ddc model, we actually expect greater subfunctionalization as we decrease d. note that under default conditions, we observe a certain amount of redundancy in the post-duplication network . generally speaking, a redundant interaction is any interaction that can be removed from the network with no phenotypic effect, i.e. without causing changes in the temporal expression pattern ; however, as the example in figure  <dig> shows, the phenotypic effect of removing a link may depend on how it is removed. if there are redundant interactions in the founder network, such interactions might be deleted in both duplicates during evolution with no phenotypic effect. in these circumstances, we would not recognize the gene as regulatory subfunctionalized according to the definition, in spite of the possibility that the remaining non-redundant interactions may in fact be subfunctionalized. in other words, if the founder network, prior to duplication, had consisted solely of non-redundant interactions, regulatory subfunctionalization would have been recognized. to minimize this unrecognized subfunctionalization, we repeated the simulations using parsimonious founder networks , in which no single interaction can be deleted without phenotypic change. we furthermore set b =  <dig>  to eliminate neofunctionalization. even in these extreme conditions, we find a significant decline in regulatory subfunctionalization in two out of three cases . since there is no neofunctionalization in this case, the result is somewhat surprising. a closer analysis shows however, that some parsimonious founder networks do indeed contain redundant interactions, albeit such that they can only be removed by two or more simultaneous deletions. after duplication, however, it may be possible for these interactions to degenerate in single steps due to a "dominance" effect, as shown in figure  <dig> 

although we enforce stabilizing selection at the level of the expression pattern , it could be argued that positive selection is not completely absent from the model, due to pressure on connectivity through the deletion bias parameter, b. this may be particularly true when d = - <dig> , since here there is pressure to reduce the number of links in the network. however, we have just shown that the main results  are qualitatively equivalent for both d =  <dig> and d = - <dig> . it could further be argued that merely by having a nonzero deletion bias b  creates some degree of positive selection, since there is, by definition, a bias in choosing link deletions compared to link additions. however, in the particular case of ci =  <dig> , both positive and negative values for deletion bias b were used , suggesting that our main results also hold across positive and negative deletion bias values.

temporal subfunctionalization
to corroborate our findings with biological data, we investigated the prevalence of temporal subfunctionalization in vivo. we proceeded by comparing paralogous genes in yeast  to determine whether their expression  fit a pattern consistent with temporal subfunctionalization. two paralogs are considered to be temporally subfunctionalized if one is on and the other is off at a particular timepoint, and if the behaviour is reversed  at some other timepoint, within a single time-course . roughly speaking, we expect two expression patterns which are negatively correlated to exhibit a temporal subfunctionalization pattern with greater probability than if they were positively correlated. figure  <dig> shows the correlation coefficient for each paralog pair in one time course  against the ks value, used here as a proxy for divergence time. each point is labeled as temporally subfunctionalized  or not .

note that the thresholds used to decide off/on states  are arbitrary, such that varying the thresholds will change the observed proportion of temporal subfunctionalization. we therefore avoid directly comparing temporal subfunctionalization for the biological data with that for the simulated data, and compare them indirectly. we proceed by considering where the observed temporal subfunctionalization lies with respect to an appropriate null distribution using a permutation analysis. the null distribution was therefore obtained from random pairings  of time-courses by means of permutation. this null distribution was then used to estimate the probability  that actual temporal subfunctionalization is less than would be expected by chance. table  <dig> shows the frequency of temporal subfunctionalization in youngest  and oldest  groups, as well as the corresponding p-values. for the youngest  ks quartile, we find that actual temporal subfunctionalization was significantly less than would be expected by chance, whereas for the oldest ks quartile, the actual value was within the distribution. most importantly, we see that, even for the oldest paralog pairs, actual temporal subfunctionalization is never greater than would be expected by chance, as was the case with the simulated data. this result contradicts the ddc model hypothesis.

frequency of temporal subfunctionalization for the youngest , and oldest  groups in each of the yeast time-course datasets. also shown is the p-value for the randomized time-courses. here, p <  <dig>  indicates the actual frequency is significantly below that expected by chance , and p >  <dig>  that it is significantly greater.

the relationship between regulatory and temporal subfunctionalization
we observed above that regulatory and temporal subfunctionalization have different temporal patterns  and 3). regulatory subfunctionalization tends to peak rapidly followed by a prolonged decline, whereas temporal subfunctionalization tends to increase monotonically at a slower rate. from this observation, it appears unlikely that all temporal subfunctionalization will be caused by regulatory subfunctionalization in normal conditions. we measured the frequency of genes with coinciding regulatory and temporal subfunctionalization . if the two types of subfunctionalization are independent of one another, we expect the coinciding frequency to equal the product of their independent frequencies. whereas if regulatory subfunctionalization causes temporal subfunctionalization, the coinciding frequency should be higher. figure  <dig> shows the two frequencies, under the same conditions as figure  <dig> , are very close. across all conditions, the coinciding frequency was not found to be significantly greater than the product of independent frequencies .

repeating this procedure using parsimonious founder networks and b =  <dig> as before, should allow us to obtain an upper bound for coinciding regulatory and temporal subfunctionalization. under these extreme conditions, we do indeed observe that the coinciding frequency is significantly greater than the product . interestingly though, even in this case, we find that temporal subfunctionalization is not always due to regulatory subfunctionalization . in these conditions, it may be hard to imagine how temporal subfunctionalization can occur without regulatory subfunctionalization. as before, we find that redundant interactions, albeit such that they can only be removed by two or more simultaneous deletions, explain this phenomenon .

CONCLUSIONS
our results confirm previous analyses revealing the coexistence of subfunctionalization and neofunctionalization in biological networks following gene duplication  <cit> . this was unexpected since we have adopted a stabilizing selection model that is expected to favor subfunctionalization alone, according to the assumptions of the ddc model. in particular, it is unnecessary to invoke positive selection to explain the high prevalence of neofunctionalization. our results can be explained in terms of evolution in neutral spaces  <cit> . previous studies of gene networks  <cit>  and rna folding  <cit>  have illustrated the prevalence in biological systems of evolutionary plasticity in combination with phenotypic neutrality  <cit> . we have shown how this evolutionary plasticity enables the coexistence of subfunctionalization and neofunctionalization, as has been observed in genomic studies.

the differences between our model and the ddc model arise from the distinct scope of each model. the scope for the ddc model is the individual  pair of genes, in which inputs are assumed to represent nonredundant functions. however, a network composed entirely of such genes would lack robustness , which contradicts available evidence  <cit> . in contrast, in our model the phenotype is a consequence of the behaviour of the entire network. here, given adequate conditions , we expect a certain amount of redundancy, and therefore robustness, to exist. indeed, such redundancy is expected as an outcome of the evolutionary process  <cit> . a recent study of divergent regulatory architectures associated with mating type in yeast  <cit>  inferred a succession of phenotypically neutral changes in which an ancestral transcription activator  was replaced by a repressor in modern s. cerevisiae, via an ancestor in which both activator and repressor were simultaneously present, illustrating the importance of redundancy in evolution. other studies have shown a widespread turnover of transcription factor binding sites in both mammals  <cit>  and insects  <cit> , and occurring even under conditions of stabilizing selection  <cit> .

clearly, in our model, if two or more genes have the same expression pattern, s, over time, then target genes can switch between these inputs with no phenotypic consequences. such a switch is likely to occur via an intermediate genotype in which both inputs are simultaneously present. from the earliest analyses of time-course data from dna microarrays  <cit> , it has been clear that many genes share very similar temporal expression patterns  <cit> , a fact that would facilitate switching of the type described. recent evidence from the segmentation clock  suggests that current models based on a small number of elements  <cit>  need to be revised in the light of findings implicating a large network of inter-related components  <cit> , all of which are regulated periodically. although we should exercise caution in comparing model gene networks with the segmentation clock , it seems likely that the presence of a greater number of periodically-expressed genes increases the opportunities for interaction turnover. recent studies have observed significant divergence of gene expression between paralogous genes  <cit> . even under the neutrality conditions of our model, any variation is tolerated so long as the expression dynamics are unaffected. this is a consequence of the threshold response of each gene, which is dependent only on the sign  of the combined inputs. thus, the fact that the threshold response is a key feature of gene regulation  <cit>  suggests an explanation for gene expression variation in both our model and observed data.

our model assumes a whole genome duplication  event. such events have made major contributions of duplicated genes in vertebrates  <cit> , plants  <cit>  and yeast  <cit> . however, we want to emphasize that our conclusions also extend to smaller scale duplications, including single gene duplications. note that, in the model, the output of each gene is unaffected by duplication. because the network outputs  remain identical throughout the simulation, each paralog pair evolves independently, irrespective of whether the other genes are duplicated or not. therefore, even if only a subset of genes are duplicated, this subset would evolve in the same way as it would following wgd. clearly though, this argument applies only to duplication events which are phenotypically neutral . many small-scale duplication events involving, for example, proteins that are active as protein complexes, may be deleterious due to dosage effects  <cit> .

we also needed to verify that the results using the yeast data apply to duplicates not originating from the wgd. for this purpose, we used a published list of gene pairs formed by wgd  <cit> , and removed these from our original dataset. to ensure we were using gene pairs in a comparable age range, we also removed those paralogs with ks values outside the range observed for the wgd dataset. we then repeated the analysis, and found the frequency of temporal subfunctionalization to be not significantly higher than would be expected by chance, as with the original dataset .

notwithstanding its convenience in terms of data availability, yeast is not optimal for studying subfunctionalization due to its large effective population size, m. following duplication, neutral  alleles take in the order of m generations to reach fixation, thus we would expect the incidence of subfunctionalization to be lower when m is large. although this effect is somewhat attenuated by the use of laboratory yeast strains , our yeast data analysis, as well as the results of previous genomic studies  <cit> , should be interpreted with certain caution for this reason. our theoretical results, on the other hand, use a relatively small population size , in which one would expect higher subfunctionalization. in spite of the different population sizes, the similarities between our theoretical results and those of genomic analyses , suggest that the overall pattern of subfunctionalization and neofunctionalization evolution following duplication is similar. as suitable data becomes available for a wider range of organisms, it will become possible to evaluate more effectively the effects of population size in this context.

although it would be fair to say that the model of gene regulation we have chosen is somewhat crude, our choice has been deliberate. our model captures essential features of gene network behavior  and emphasizes the importance of transcription regulation in evolution  <cit>  resulting in neutral space properties that apply to real gene regulatory networks  <cit> . we consider that choosing a more sophisticated model would have resulted in qualitatively equivalent results, but with reduced explanatory power. an important outcome of this investigation has been to show the substantial benefits that arise from considering the behavior of the entire network as a system, as opposed to considering the individual genes in isolation. our results suggest that subfunctionalization alone cannot explain the high retention of duplicate genes. at the same time, a more complex picture of post-duplication evolution emerges in which redundancy and neofunctionalization play important roles alongside subfunctionalization.

