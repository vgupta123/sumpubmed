BACKGROUND
the occurrence of a genetic bottleneck in hiv sexual or mother-to-infant transmissions has been well documented  <cit> . this results in about 80% of new infections being homogeneous, i.e., initiated by a single genetic strain  <cit> . due to the availability of early samples taken at multiple time points from acute hiv subjects, we now know that the viral population grows exponentially during the early phases of infection  <cit> , prior to the onset of the host immune response or significant target cell depletion. given this simple setting, our goal is to clearly distinguish infections that were initiated by a single strain  from those where multiple strains entered the host. furthermore, for those cases where we are able to determine that the infection was indeed homogenous, we seek to estimate the time since the most recent common ancestor  given a sample of genetic sequences. in contrast to coalescent and bayesian inference methods , which are based on a simulation of genealogies, we do not simulate the genealogical history of the observed sequences, but rather follow the diversity structure of the entire viral population. while in most settings a forward simulation is not attainable , our approach becomes not only feasible but extremely simple to realize when modeling a homogeneous infection within a small number of generations from the transmission bottleneck. the increased efficiency of the algorithm  facilitates the analysis of samples from a large number of subjects  <cit>  and enables the application to massive new data sets that are currently being gathered using pyrosequencing  <cit> . we have successfully tested our tool in both cases, i.e., hundreds of patients and tens of thousands of sequences. these methods are robust against violations of assumptions that do not strongly affect overall diversity. quantities like the time since the mrca, when computed by our tool, yield virtually identical results  <cit>  to those computed by the coalescent or bayesian methods, as shown in figure  <dig>  the tool is available on the lanl website  <cit> . an extensive explanation of how the tool works and how to format the input data is provided in the poisson fitter explanation link available on the tool website  <cit> .

implementation
our basic framework is that of an exponentially growing population following a narrow bottleneck, with lineage-independent mutation rates at all sites and no differential selection among the attested forms. when the resulting diversity is small, almost every change is at a distinct locus, and the pairwise differences between genetic strains, i.e., the hamming distances , follow a poisson distribution  <cit> . there is little evidence of recombination in samples from this early stage when care is taken to guard against in vitro recombination  <cit> . furthermore, when sites evolve independently starting from a homogeneous infection, homologous recombination does not change the hd distribution nor the overall amount of diversity. it does, however, affect the distribution when these assumptions are violated . the poisson fitter tool  <cit>  uses this fact to fit a poisson distribution to the pairwise hd frequency distribution obtained from the input data. because a good fit is obtained when the infection is homogeneous and free of differential selection pressure  <cit> , the tool can be used to detect large violations of one or more assumptions of the null model.

input data
the poisson fitter tool  <cit>  was originally developed to analyze genetic sequences from early hiv- <dig> infected patients . however, it can be used on any set of highly conserved sequences to test whether the observed diversity could be due to random accumulation of mutations or whether one needs to invoke alternate explanations like early onset of selection or multiple original infecting strains. the tool accepts multiple alignments, obtained through either single genome amplification  <cit>  or deep sequencing  <cit> , but they must be uploaded as one file. all alignments need to be in fasta format and always start with a consensus or reference sequence, which is assumed to be the ancestral strain. more details on how to format the input data is provided on the tool web page  <cit> .

controlling for apobec enrichment
apobec is a host enzyme. during replication it causes mutations that can introduce stop codons and inactivate the virus. these substitutions are recognizable by a g → a mutational pattern embedded in the apobec3g/f motif  <cit> , which is: grd, where r is the iupac symbol for g or a, and d for g, a or t. their occurrence is sporadic, often leading to overtly hypermutated sequences  <cit> , and thus violating our assumption of a constant mutation rate . our tool allows for two types of checks: the first method searches for hypermutated sequences, i.e., particular sequences that present a statistically significant excess of g → a mutations at apobec3g/f motifs compared to elsewhere in the sample. the test is performed using the hypermut tool  <cit>  and the user can select a p-value threshold . with the second method, an artificial sequence is created, which summarizes all mutations found across the sample, and is then tested for apobec enrichment via the hypermut tool  <cit> . when the latter is significantly enriched, it indicates enrichment across the sample for mutations embedded in the apobec motif, in which case we call the sample overall enriched  <cit> . the user can choose whether and how to correct for apobec enrichment. two correction methods are provided, which correspond to the two tests discussed above. the first option is to simply remove all sequences that yield a p-value below the threshold. because this method reduces the number of sequences, we have devised a second option which looks at all g's in the consensus sequence and removes the positions that fall within an apobec grd motif from the entire alignment. this leaves the number of sequences unchanged and provides an unbiased correction. with either option, a new corrected alignment will be created, and the tool will proceed to analyze both the uncorrected and the corrected alignments.

star phylogeny
when the samples are relatively small, under our assumed model of neutral evolution and rapid exponential growth, all sequences are likely to coalesce to the same founder or mrca  <cit> . when this happens, we say that the sample follows a star phylogeny. this has been shown in hiv- <dig> early homogenous infections  <cit> . under a star-phylogeny scenario, the pairwise hd distribution coincides with the self-convolution of the hd <dig> frequency distribution, where hd <dig> is the hamming distance from the consensus sequence. when the sequences coalesce at the founder we can use the following mathematical formulation to compute the hd frequencies  <cit> :

 yj=12∑i=0jxixj−i−12δj,j−ixi 

where δx, y is the kroenecker delta, and xi is the number of sequences that are i bases from the consensus, and yj are the number of pairs of sequences that are different at j bases. by comparing these theoretical frequencies yj to the observed ones , one can verify whether the star-phylogeny assumption is valid for the tested alignment.

fitting the poisson distribution
a poisson distribution is fitted to the observed pairwise hd distribution using a maximum likelihood method . a χ <dig> goodness of fit  is performed to test whether the hd distribution significantly diverges from a poisson . the test takes into account the non-independence of pairwise hd distances by comparing the observed frequencies to the expected ones if the sample were to follow a star phylogeny. prior to the onset of positive selection, the population is assumed to undergo a rapid expansion during which the basic reproductive number r <dig> >  <dig>  therefore, when the sample yields a gof p-value above  <dig>  , we can estimate the time since the mrca using the parameters characterizing intrahost hiv evolution. following stafford et al.  <cit> , we set r <dig> =  <dig> for acute hiv- <dig> infection samples. we assume a constant mutation rate across lineages, which we fix at an average value of ϵ =  <dig>  × 10- <dig> per site and per replication cycle. this value has been adjusted from what was originally derived for hiv- <dig> by mansky et al.  <cit>  by considering only base substitutions and ignoring insertions and deletions. however, it has not been corrected for possible extra purifying selection in vivo. using these parameters, we use the mean of the fitted poisson distribution to infer the time since the mrca  <cit> .

RESULTS
all the parameters explained in the previous section are computed and included in the output table called "log likelihood - estimated parameters." this comprises, for each sample: the number of sequences in the sample, the mean and maximum pairwise hd, the mean of the best fitting poisson distribution, the corresponding time since the mrca, and the goodness of fit p-value it is important to notice that when the sample meets our model's assumptions, the mean of the best fitting poisson distribution is in fact the mean pairwise hd of the sample. a second table, called "convolution estimates," provides the observed hd frequencies and the estimated ones calculated using equation . a more detailed explanation of the parameters is provided in the explanation file on the tool web page.

as a second example, figure  <dig> shows a sample drawn from single genome amplification sequencing  <cit> . all fifty sequences used for this example are available through accession numbers eu575084- <dig>  in this case the original alignment does not yield a good fit to the poisson distribution , but the tool detected apobec3g/f mediated hypermutation. by selecting the option to correct for apobec signatures by both methods, two more alignments are produced: one where two significantly  hypermutated sequences are removed, and one where instead the alignment position where apobec induced mutation could potentially affect results are removed. it is noteworthy that the first type of correction still does not yield a good poisson fit . this is because the sample is overall enriched for g → a. one can check this by looking at the hypermut results table and noticing that the sequence called compressedmutations yields a p =  <dig> × 10- <dig> for apobec enrichment. therefore, only when all positions with a g embedded in a apobec3g/f motif are removed, does one finally achieves a good poisson fit  and a biologically sensible  time estimate of the time since the mrca of  <dig> days, 95% ci = . this example illustrates how apobec enrichment can cause the poisson fit to fail and hence how it is necessary to isolate the apobec induced mutations in order to make sensible estimates on the timing of the infection.

unlike the example in figure  <dig>  where a logarithmic scale is used for better visualization, when the sample size is under  <dig>  the star-phylogeny is represented in the manner shown in the panels on the right: the observed pairwise hd frequency counts are shown by the blue histograms, whereas the ones computed theoretically are shown in red. for both apobec-corrected and non-corrected samples, the red lines follow the histograms faithfully, which deems both samples as star-like phylogenies.

both of the examples above obviously meet our model's assumptions of exponential growth with no selection and negligible recombination rate. when one or more assumption is not met the goodness of fit p-value lowers considerably and therefore the time since the mrca is inaccurate. there are several factors that can cause this to happen: for instance, the infection may be non-homogeneous, the sample may not be "early" enough, or one may have sampled an unlikely early random mutation that distorts the poisson distribution. when analyzing hiv- <dig> data, we recommend using samples taken within the first 2- <dig> weeks of infection, or characterized as fiebig stage i or ii  <cit> . at later fiebig stages selection and recombination are clearly observed, and the diversity is controlled by these later selective bottlenecks. the probability of an early stochastic mutation violating the model assumption is calculated in  <cit> , and is typically small.

finally, we notice that our tool can be applied to subsets of sequences sampled at later time points when there is evidence of a narrow bottleneck. for example, in fischer et al.  <cit>  we were able to isolate the escape lineages after the immune response had begun and applied the tool to estimate the timing of each lineage. the tool has been used primarily on large hiv- <dig> data sets  <cit> , though it can be used on any population that grows in a similar fashion, as appears to be the case of hcv for instance  <cit> .

CONCLUSIONS
our tool enables quantitative characterization of acute infection samples and can be usefully applied in large scale vaccine and prophylaxis studies where estimates of the time since the mrca and/or the timing of the onset of host selection can be extremely informative. the tool can rapidly detect whether the mutational distribution in a set of hiv sequences is consistent with a star phylogeny and/or a poisson model, indicative of a population evolving from a single ancestor, with lineage independent mutations under no differential selection of surviving forms. if the model is violated, the tool automatically evaluates whether this is a consequence of apobec mediated substitutions. when the model is satisfied, it can be be used to estimate times to the most recent common ancestor of the lineage, rapidly providing timing estimates that are in good accord with coalescent methods. the speed and simplicity of the algorithm enables it to be applied to massive data sets obtained through ultra-deep sequencing methods  <cit> . we have used it on tens of thousands of sequences  <cit>  to estimate the time since the mrca and also, at later time points, to estimate the timing of escape lineages, which arose after the onset of selection. the tool can be used on any other population which presents similar evolutionary patterns  <cit> .

authors' contributions
btk was the project pi, provided the apobec modeling concept, and helped draft the manuscript; bf built the web interface; ga provided codes to be included in the tool; both bf and ga helped with the web tool development and programming; asp, btk, and tb provided the theoretical frame for the study and helped drafting the manuscript; eeg provided codes for the tool, contributed to the analysis, and drafted the manuscript. all authors read and approved the final manuscript.

