BACKGROUND
network and pathway models have been frequently used to describe complex interaction patterns of genes and other types of molecules, and there is increasing recognition that such networks will facilitate a more clear understanding of cellular physiology  <cit> . developed using global expression  <cit> , proteomic  <cit> , or metabolic  <cit>  measures, the models can be used to characterize the patterns of interaction  that underlie cellular states. such models have been used to define the complex pathobiology of numerous cancer types  <cit> , neurological conditions  <cit> , and metabolic disorders  <cit> . more recently, models constructed through integration of genotype and expression data have been used to identify disease-susceptibility loci that alter network dynamics  <cit> .

though network models are fairly easy to visualize using graphs, direct comparison of two models , and quantitative measurement of the differences between networks, remains challenging. in recent years there have been growing literature of methodology for such comparisons  <cit> , either for a global scale estimation of overall network similarity  <cit> , or for measures of local difference in connectivity for nodes or modules in the network  <cit> . among the many methods used to infer gene networks are gaussian graphical models   <cit> , including the empirical bayes methods for fitting gaussian graphical models  <cit> , which performs well in inferring large-p small-n gene networks. as a probabilistic method, ggm provides posterior probabilities of gene-gene interaction for each edge in the network, a quantifiable measure of interaction that incorporates the uncertainty of the model. we recently  <cit>  applied the method to build an integrative network based on multiple data sources . we now extend this method to integrate clinical phenotypes, such as disease status, in order to facilitate identification of network modules whose connectivity patterns differ by disease status. our approach enables direct comparison of two co-expression networks and objective identification of network components that consistently exhibit differential connectivity patterns across disease states. for simplicity we will only consider dichotomous phenotypes, though this method could be extended to categorical or continuous traits as well.

methods
first we describe the ggm for gene expression data. the expression data matrix y observed here has g genes and n samples, and the model follows  <cit>  and  <cit> , where y follows a multivariate normal distribution:  

where yji represents the expression observation for jth gene in the ith sample, μ is the mean vector and Σ is the covariance matrix. the covariance matrix Σy and the partial correlation matrix Π for y are estimated based on the shrinkage estimation described in  <cit> . the partial correlation Πjk here represents the conditional dependency between gene j and gene k, i.e, Πjk =  <dig> if the two genes are independent conditional on all other expression values and Πjk ≠  <dig> if they are conditionally correlated. therefore the network estimation problem is reduced to a sequence of g/ <dig> hypothesis testing problem for Πjk =  <dig>  following the mixed model approach in  <cit>  we can calculate the empirical posterior probability that Πjk ≠  <dig> for each pair of genes  and  in figure 1). figure  <dig> shows an example of the distribution of partial correlations and their corresponding posterior probabilities. the partial correlation coefficient Πjk follows a normal distribution , but the mixed prior, which assumes that the majority of the gene pairs are not connected, effectively shrinks most of the posterior probabilities toward zero . we can see in panel  as Πjk grows away from zero the probability of a significant edge quickly approaches  <dig> and the narrow u-shape demonstrates the ability to identify significant edges for relatively small absolute values of partial correlation coefficients .

suppose we have the estimation of networks from two different disease groups. if we consider the posterior probability of an edge as a frequency, as if we could actually observe the proportion of samples in the group, then for the two disease groups c and d we can calculate the posterior odds ratio  for each edge:  

where  and  are the posterior probability estimates for the event that an edge exists between gene j and gene k, in groups c and d, respectively. if  and/or  are zero, we assign them a very small number on the same scale as the smallest non-zero posterior probability to make sure all odds ratios are well-defined. the posterior odds ratios between the disease groups provide a quantitative measure for difference between network connectivity, and the parts of the network where the postors differ from  <dig> are likely the parts most relevant to the disease state  in figure 1). panel  in figure  <dig> shows a histogram of the log posterior odds ratio, with most of the edges concentrated around zero and relatively few of them way out in the tails, which represent the edges associated with the disease states. the gap from around ± <dig> to ± <dig> roughly corresponds to the sharp climb in the posterior probability seen from panel  in figure  <dig>  this pattern has been observed in all data sets that we have analyzed, though the scales in which the extreme observations fall may vary depending on the sample size and the number of genes in the network. as the sample size increases relative to the number of genes, we observe more extreme values of log postors, in some cases going up to ± <dig> or  <dig> 

the idea of using posterior odds ratios to quantify differential connectivity can also be generalized to model more focused differential gene connectivity patterns within previously defined sets of genes, including experimentally derived gene networks and canonical pathways. for example, for a given set of genes a, we define the differential connectivity score  as the average absolute differential connectivity, measured by difference in log posterior probability, for all edges comprising set a:  

which is a good approximation of the average postors for all edges in the set, as most of the posterior probabilities ,  are close to zero. this gives a reasonable measure of the overall differential connectivity for each gene set.

RESULTS
simulation study
to assess the theoretical performance of our approach, we performed a series of simulation studies. for each simulation study we first generate two partial correlation matrices representing networks observed in two groups of samples , and then generate synthetic expression data sets from them. we then attempt to recover the network using ggm and calculate the postors for all pairs of genes. to simulate networks most closely resembling real world network data, we set out to develop a set of relatively sparse networks with few strong connections. when generating the partial correlation matrices for the "case" network we therefore follow the same approach in  <cit> , whereby we estimate a connectivity network using an expression dataset generated from peripheral blood cd4+ lymphocytes  <cit> , take the top g genes with the highest correlation, retain correlation coefficients of the top q significant edges and shrink all remaining correlation coefficients to zero. we take g =  <dig> and q =  <dig> in our simulation study, which corresponds to about  <dig> % of all possible edges . the "control" networks are from the null model, where the expression data are generated from an independent multivariate distribution and none of the genes are connected. we simulate the expression data with  <dig> samples in each group and repeat the entire procedure  <dig> times.

the left panels  and  in figure  <dig> show the histogram of the log posterior odds ratios for all edges  and for the  <dig> % edges that were truly differentiated . from the right hand side of the panel  we see that the log posterior odds ratios from the null edges goes as high as  <dig>  therefore we take ± <dig> as the threshold, which gives  <dig> % sensitivity and  <dig> % specificity for detection of a differentially connected edge. though we miss a considerable proportion of true edges , the very high specificity is particularly encouraging, as it suggests that positive findings are very reliable. note that even a small reduction in specificity  would result in identification of the thousands of spurious differential connections, given the enormous number of pairwise comparisons in any given genome-wide analysis. it is therefore essential to maintain high specificity in this context. we note that for smaller datasets , though sensitivity drops considerably , the high specificity is retained . we also considered more realistic scenarios, including situations where both networks  contain positive edges and where sample size is uneven between groups, and found very comparable results. for example, right panels  and  in figure  <dig> show an example of unbalanced data, where one set has  <dig> samples and the other has  <dig>  containing  <dig> % and 5% true positive edges, respectively. using the same threshold of posterior odds at - <dig> the sensitivity is  <dig> % and specificity is  <dig> %. figure  <dig> shows the roc curves from all three scenarios considered. we can see that the power varies depending on the sample size and number of variables, but the specificity always stays close to 100%, and the absolute postors from the null distribution rarely exceed  <dig>  therefore, we can conclude that in realistic scenarios, though we are not able to identify all truly differentially connected edges, those edges that are declared as differentially connected between states are very likely to be true findings.

alternatively, we could compare the partial correlations or pearson correlations between the "cases" and "controls", as shown in figure  <dig>  in both cases the truly differentially connected edges seem well-separated from the unconnected edges , though from the histogram of the z-statistics  we can see that the true positive edges from partial correlations separate better  than the pearson correlations, which are routinely used to infer gene networks  <cit> . notice for the correlation coefficients we still need to apply arbitrary thresholds  <cit> , as we do not have repeated measurement for the correlations for each individual edge. compared to figure  <dig> we can see that the postors from the empirical bayes method, which takes into consideration the sparsity of real gene network, allow us to effectively separate the truly differentially connected edges from others.

breast cancer study
we now demonstrate the application of our method to real data sets. the main results will be focused on the comparison between two independent gene expression data sets from breast cancer tissues of varying histological grade available through the gene expression omnibus . the gse <dig> series consists of affymetrix human genome u133a array data for  <dig> breast tumor samples from the national cancer institute database  <cit> , from which we selected  <dig> estrogen receptor-positive  samples with histological grades  <dig>  and  <dig> . the gse <dig> series contains several independent validation sets generated using affymetrix u133plus <dig> genechips and described in  <cit> , from which we used the  <dig> samples from guy's hospital, uk . these data sets were selected based on sample sizes and availability of clinical phenotypes. using the r package genefilter <cit> , we applied the non-specific gene ltering  <cit>  on both data sets. the resultant data set consisted of  <dig>  refseq-annotated genes with interquartile ranges  in the upper 50% for both data sets.

we applied our method sequentially to define, in each dataset, the differences in network connectivity patterns observed across breast cancers of different histological grades. the two datasets were analyzed separately to enable unbiased evaluation of the reproducibility of findings by our method when applied to biologically independent datasets. we observe a similar pattern to those seen in the simulation studies, with most edges concentrated around zero and relatively few in the extremes. focusing on the edges with extreme postor probabilities of differential connectivity between grades , we found significant overlap across studies. when considering genes exhibiting high degrees of connectivity - so-called hubs  <cit>  defined as genes with at least  <dig> independent edges -  <dig> of  <dig> hubs demonstrating differential connectivity patterns in dataset gse <dig> were also observed in the second dataset gse <dig> . this high degree of overlap between two independent data sets suggests that the observed differential network connectivity patterns are a reproducible property of complex biological processes such as cancer progression.

we next examined the gene content of the replicated hub genes demonstrating grade-dependent differences in network connectivity, and found that in all but one case , these hub genes have all been previously characterized in expression studies of breast cancer, with many being implicated as critical regulators or markers of metastatic potential and tumor progression . that nearly all the identified genes have been previously implicated in breast cancer biology suggests that differential connectivity mapping is exquisitely specific in the identification of biologically relevant genes. we note that the 10th gene, dhrs <dig>  though not previously implicated in studies of breast cancer, has been associated with other estrogen-responsive cancer types of the female reproductive tract, such as endometrial and ovarian cancer  <cit> , suggesting that it too is a true positive finding, and represents a novel breast cancer target.

frequency denotes the number of differentially connected edges detected in gse <dig> and gse <dig> 

in contrast to more standard statistical methods, more spurious evidence for differential connectivity might be found, paradoxically, in studies of small sample size when true connections in samples from one disease state are not detected due to low statistical power. we thus performed permutation tests to obtain a null distribution of the number of differential connections for each gene in the two disease states. with  <dig> permutations, two of the ten genes  were rarely observed in both datasets , and thus can be considered to be reliable hubs demonstrating consistent differential connectivity by histological grade that are not likely observed due to chance. we further note that although there is a strong curvilinear relationship between the total number of significant connections within a network  and the number of differential connections between states , we observe that both cxcl <dig> and mmp <dig> represent outliers in these distributions of both datasets, exhibiting a higher proportion of differential connections even when accounting for the total number of connections. therefore, they are unlikely to represent false positive results, and represent high priority targets central to breast cancer grade.

we next examined whether these same genes could be identified using more standard analytic approaches  or whether our approach provides truly independent information. when we applied traditional differential expression analysis  to the datasets, we found that only two of the  <dig> hub genes - agtr <dig> and nav <dig> - were themselves differentially expressed by histological grade . moreover, none of the  <dig> differentially connected hub genes were identified as relevant grade-related genes in the original report by  <cit> . these comparisons suggest that differential connectivity mapping can identify disease relevant genes that would not be found using more traditional approaches. the lack of differential expression for most of the hubs themselves argues that the observed differential connectivity patterns are not primarily due to primary alterations of hub gene expression, but rather due to more subtle changes in expression of numerous genes interacting with these hubs.

we also individually tested each of  <dig>  published gene sets comprising the molecular signatures database  for evidence of differential connectivity in the breast cancer data set. we considered  <dig>  msigdb gene sets that consist of  <dig> or more genes represented in the breast cancer analysis, and for each gene set we calculated the dc score. we also performed permutation tests to obtain the null distribution of dc score. dc-scores above the 99% percentile of the null distributions from  <dig> permutation sets were observed for  <dig> and  <dig> broad sets in the gse <dig> and gse <dig> breast cancer datasets, respectively, including  <dig> broad sets that exhibited differential network connectivity in both datasets. additional file  <dig>  details the  <dig> broad sets that reproducibly demonstrated such extreme differential connectivity in both datasets with at least  <dig> differential connections in each dataset. most have been implicated in tumor biology, and many of these gene sets have been implicated in breast cancer progression, including chromosomal region 1p <dig>  <cit> , matrix metalloproteinases , and sequence targets of peroxisome proliferator-activated receptor alpha  <cit> . potential therapeutic targets were also identified, including subnetworks of the polyunsaturated fatty acid synthesis pathway  <cit>  and of vegf-induced factors  <cit>  . for example, consistent differential connectivity was noted for a set of genes  upregulated in human umbilical vein endothelial cells  by vegf, a proangiogenic factors critical to tumor progression and metastasis  <cit> . the differentially connected sub-network  centers on cys2-his <dig> zinc finger transcription factors early growth response  <dig> and  <dig> . egr <dig> and egr <dig> directly regulate a series of classical tumor suppressors  <cit> , and experimental interference of their expression dramatically alter breast cancer cell growth rates  <cit> . evidence of differential connectivity was observed for numerous additional gene sets implicated in other carcinomas, though not previously with breast cancer. in response to an anonymous reviewer's suggestion, we also ran an analysis on another breast cancer set, geo series gse <dig>  <cit>  with affymetrix human genome u133a array to further confirm the reproducibility of our findings. we selected  <dig> patients with grade  <dig> breast cancer and  <dig> grade  <dig> breast cancer , and compared the networks derived from the two subsets. we found  <dig> hub genes with over  <dig> differential connections. five of them overlap with the hub list from gse <dig>  which use the same platform. three of them  overlap with both gse <dig> and gse <dig> hub lists. the other gene of interest, cxcl <dig>  also has a large number differential connections . these results show strong reproducibility in the third data set, demonstrating that the our findings are not due to platform differences.

discussion
the appeal of systems-based or interacteome mapping approaches for the study of disease is steadily increasing with the recognition that non-linear epistatic interaction underlies all but the simplest of biological processes. however, formal identification of biologically relevant interaction patterns imbedded in complex network connectivity maps has been a challenging problem. several studies have looked at global comparison of the networks based on annotated database, such as go or kegg  <cit> . unlike our method, those previous studies assume complete knowledge of the networks . in many instances, however, complete certainty is unattainable. moreover, these methods are largely global, but do not provide information regarding regional differences . without a measure of variability of the model, it is not easy to distinguish disease-related genes from those that have neutral roles. there are several methods for comparing region differential connectivity between two networks, based on pair-wise gene co-expression relationships, either at the gene cluster/module level  <cit>  or at the individual gene level  <cit> . here we have presented a novel approach that enables direct comparison of two different networks derived from gaussian graphical model. the key feature of the ggm approach is that the network inference is based on partial correlation , which distinguishes direct interactions from indirect ones  <cit> . the postors from empirical bayes approach provide an easily interpretable quantitative measure for differential connectivity, allowing search for local differential connectivity either for individual genes, gene pairs, or on a cluster/module level. the method performed well in detecting differential network connectivity in simulations of moderate sample size, compared to other simple methods with pearson correlations or partial correlations only. in fact, even though the sensitivity was modest, both the simulation studies and the real breast cancer datasets suggest that our approach detects many of the strongest associations with very high specificity.

application of differential connectivity mapping to the breast cancer data sets provides several important insights, both regarding the utility of this approach to other disease states, and with respect to the importance of network connectivity underlying disease processes such as cancer. with regard to the performance of the method, we first found substantial reproducibility  in the observed connectivity patterns across the two breast cancer datasets, then similar results were found in the third data set, suggesting network connectivity as a robust, measurable property of complex biological processes. second, many of the most compelling findings from our analysis  have been previously implicated in breast cancer or other estrogen-responsive cancers, suggesting that the approach is highly specific with regard to biologically relevant findings. third, as the hubs genes are not always expressed, the majority of the  <dig> hub genes were not detected using the traditional differential expression approach. differential connectivity mapping complements differential gene expression analysis and can be used to identify those genes.

perhaps most importantly, careful review of the specific genes identified suggests that hubs manifesting differential connectivity  may represent important candidates for therapeutic targeting. in addition to egr <dig> , of the  <dig> hub genes identified, there is experimental evidence for at least three that their targeted manipulation alters the malignant and invasive potential of breast cancer. matrix metalloprotease  <dig> , a protease that converts plasminogen to angiostatin , inhibits angiogenesis when overespressed in breast cancer tissue  <cit> . s100a <dig>  a calcium-binding protein that complexes with s100a <dig> and whose expression is suppressed by functional brca <dig>  <cit> , is induced by h-ras to promote malignant potential . contradictory reports suggest that these malignant properties are either attenuated  <cit>  or enhanced  <cit>  upon sirna-mediated knockdown of s100a8/a <dig> expression, suggesting s100a <dig> as a targetable regulator of malignant potential. similarly, agtr <dig>  is a potent inducer of invasive phenotypic properties when overexpressed in primary mammary epithelial cells  <cit> . these effects are inhibited by the agtr <dig> antagonist losartan, and fda-approved medication commonly prescribed for the management of essential hypertension. consistent with these observations, treatment of xenograft models of breast cancer with losartan reduces tumor growth in agtr1-positive, but not agtr1-negative, breast cancers  <cit> . it is intriguing to speculate whether manipulation of nav <dig>  the only other gene that displayed both properties of differential connectivity and differential expression across tissue grade, would have similar effects in altering the malignant potential of breast cancers.

CONCLUSIONS
in conclusion, we have developed a highly specific method for the identification of genes that demonstrate differential connectivity across disease states. though applied here to transcriptome data, this method can be applied more broadly to other types of biological network models, and can serve as a novel approach for the identification of high priority target nodes underlying complex biological processes.

authors' contributions
the statistical model and methodology were developed by jc based on the concept by jc and bar. jc carried out the analysis for simulation and breast cancer data with the support of vjc and rl for statistics and bioinformatics. the manuscript was written by jc and bar and all co-authors have approved the final version.

supplementary material
additional file 1
broad sets demonstrating differential connectivity by breast cancer histological grade. this table includes the  <dig> broad sets that reproducibly demonstrated significant differential connectivity in both gse <dig> and gse <dig> with at least  <dig> differential connections in each dataset.

click here for file

 acknowledgements
the authors acknowledge support of the national institutes of health through grants r <dig> hl <dig>  rc <dig> hl <dig> and r <dig> hg <dig>  the authors would also like to thank the anonymous reviewers for the helpful comments and suggestions.
