BACKGROUND
the central dogma of molecular biology "the flow of genomic information from dna to rna to protein" in multi-cellular organisms is much more complex than originally thought  <cit> . an important aspect of this complexity is the generation of multiple transcript isoforms from a single gene in a genomic locus, due to the use of alternative initiation and/or termination of transcription and alternative splicing of pre-mrnas  <cit> . although the functional consequence of differential expression of alternative isoforms for some genes has been known, the advent of massive parallel sequencing technology has facilitated the study of transcript isoforms at genome-scale. in fact, recent evidence suggests that almost all multi-exon human genes have more than one mrna isoform  <cit> . for example, the deep sequencing of cdna fragments of  <dig> human tissue and cell line transcriptomes showed that 92-94% of human genes undergo alternative splicing  <cit> . the transcript variants are differentially expressed across different tissue/cell types, developmental stages and disease conditions. moreover, for many genes, different transcript isoforms can lead to different protein isoforms with distinct functions. therefore, in order to study the gene function at isoform level, it is necessary to know the expression of each transcript in various physiological and disease conditions.

with the advent of next-generation sequencing  technologies and decreasing cost per base, mrna-seq approach has become a desirable method to get a complete view of the transcriptome and to detect rare transcripts and isoforms  <cit> . mrna-seq experiments generate millions of short sequence reads that are sequenced from expressed transcripts. the majority of these short sequence reads can be mapped to exon regions of the genome and exon-exon junction regions of a transcriptome. therefore, mrna-seq has been used for splice junction identification and alternative splicing detection  <cit> , and for novel transcript identification through transcript assembly  <cit> . the assay provides sensitive and accurate digital counts for the exon regions of expressed transcripts in a given sample. the count of short sequence reads for each exon region is the sum of counts belonging to the exon region of different transcript isoforms that are expressed in the sample. therefore, estimating the transcript-level expression from the collection of counts of short read sequences that map to exons or exon slices is a computational challenging problem, which has been recently attempted by some programs such as rseq  <cit>  based on maximum likelihood estimation, cufflinks  <cit>  extended from rseq, and rsem  <cit>  considering sequencing mapping uncertainty. bayesian analysis of splicing isoforms   <cit>  is another recent method that computes transcript levels from coverage of known exons by taking advantage of isoform-specific nucleotide positions from each transcript isoform. basis focuses on detecting the differentially expressed transcript isoforms between two conditions and cannot infer the expression levels under each condition. gpseq using a two-parameter generalized poisson  model to the position-level read counts can estimate gene/exon expression and identify differentially expressed genes/exons  <cit> . however, gpseq was not designed for estimating transcript expression levels. another recent method  <cit>  applied a linear model to estimate the ratios of known isoforms in a sample by incorporating the non-uniformity of mrna-seq read positions along the targeted transcripts as a key feature into its algorithm. however, the software is not publicly available for use.

here, we present a novel method, called isoformex, which is based on weighted non-negative least squares. we compared isoformex with some of the published methods in accurately estimating the expression levels of transcript isoforms. since cufflinks has additional function of transcript assembly to identify novel transcripts, we only used its function of transcript level estimation extended from rseq algorithm for the comparison studies. the publicly available software to estimate mrna-seq transcript expression with read mapping uncertainty  was also used in the comparison studies. for fair comparisons, we used both simulated mrna-seq data and published real mrna-seq data  <cit>  obtained from breast normal  and cancer  cell lines.

RESULTS
basic logic of isoformex
isoformex generates expression estimates both at gene and transcript levels from mapped mrna-seq reads . we illustrate the basic logic of isoformex by using the sequence reads  that map to a genomic locus with two overlapping genes  . let us denote rpkm of each transcript as θ and rpkm of the exon slice as α in figure  <dig>  a transcript block is defined as a set of transcripts overlapped in a genomic locus. we identify the exon slices that are specific to each transcript in a transcript block, and call those exon slices as 'discriminative exon slices' within a transcript block. the rpkm values of the discriminative exon slices are used as a major factor for estimating the expression levels of corresponding transcripts having the discriminative exon slices. the total number of exon slices in this transcript block with six overlapping transcripts is eight, and the approximated rpkm values of the exon slices in mcf- <dig> cell line are α ≈  <dig>  α ≈  <dig>  α ≈  <dig>  α ≈  <dig>  α ≈  <dig>  α ≈  <dig>  α ≈  <dig>  and α ≈  <dig>  where s <dig>  s <dig>  ..., and s <dig> are the first, the second, ... , and the eighth exon slices. the highest expressed last exon slice is common to the two transcripts . the basic logic of estimation is as follows . since rpkm of the discriminative exon slice of uc002qlq. <dig> transcript is α ≈  <dig>  we expect θ ≈  <dig> and θ  ≈  <dig> by using α ≈  <dig>  however, rpkm of the first slice is only α ≈  <dig>  thus, θ may be lower than  <dig>  ≈ 35), and θ may be very low or zero  ≈ 0). the rpkm of the discriminative exon slice of uc002qlo. <dig> is α ≈  <dig>  and, the rpkm of the discriminative exon slice of uc002qlp. <dig> is α ≈  <dig>  note that the seventh exon slice is common to three transcripts . since θ ≈  <dig> and θ ≈  <dig>  we expect that α is higher than  <dig>  however, actual α is only about  <dig>  thus, θ can be close to zero. as illustrated in this example, the discriminative exon slices and the concept of non-negativity are important for estimating transcript expression levels. the discriminative exon slices are highly weighted in the weighted non-negative least squares computation. since the rpkm value of very small exon slice  is not reliable for estimation , the small exon slice is lowly weighted. note that the observed rpkm values and estimated transcript expression levels should be non-negative.

performance comparison using mrna-seq simulated data
since the true expression levels of all transcript isoforms are unknown, we first designed an mrna-seq simulator to obtain artificial short sequence reads after assigning transcript expression levels. in order to mimic the distribution of transcript expression levels, we fitted an exponential decay function to the real mrna-seq data obtained from mcf- <dig> cell line, and used the fitted distribution to randomly assign expression levels to all transcripts. the assigned expression levels were therefore treated as known true expression levels in the simulated mrna-seq data for performance comparisons. in the mrna-seq simulator, the number of fragments for each transcript was determined and the transcript was randomly fragmented. the first  <dig> bp  of the fragment sequence and the first  <dig> bp of the reverse complementary sequence of the fragment were stored. single nucleotide substitutions were introduced in the sequences, which reflect the  <dig> % rate of snps in the human genome. in addition, nucleotide substitutions were introduced to account for current rate of sequencing errors . the sequencing error rate at each location of a sequence read of length  <dig> bp was obtained from mismatch information of tag mapping and phred sequence quality scores in the mcf- <dig> data  <cit> . the sequencing error rates were fitted to an exponential function and the fitted function was used for introducing sequencing errors for each sequencing cycle. the sequencing error ratios at 1-25th nucleotides were much lower than those at 26th to 32nd nucleotides. the error ratio at 26th position was about 1% of all reads. in order to simulate sampling of fragments, we randomly selected 10% of reads and stored them to a fastq file. about 93% of the simulated sequence reads were then mapped to the human genome.

to assess the performance of isoformex, we compared it with cufflinks  since it incorporated an estimation algorithm of rseq and the latest information about mrna-seq protocol. the mrna-seq reads were aligned to hg <dig> version of the human genome downloaded from the ucsc genome browser database  <cit> . the splice junction library was built from the ucsc transcriptome and sequence alignment was performed using bowtie   <cit> . the transcripts information was converted to gtf file format and cufflinks used the transcript information through the -g/--gtf option to estimate expression levels from a known transcript model. the min-isoform-fraction parameter of cufflinks was set to  <dig>  in order to recover very lowly expressed transcripts. the sequence alignment files generated from bowtie were used for estimating transcript expression levels by both isoformex and cufflinks, thus eliminating any plausible bias that could arise from different alignments files.



estimation error and correlation coefficient between estimated expression levels  and known true expression levels  for our simulated dataset when all estimated transcripts  were considered or some expressed transcripts  were only considered. ptrue  denotes the i-th element of the proportion vector of true expression values , and pest  denotes the i-th element of the proportion vector of estimated expression values . the error was defined as the mean value of absolute difference between the true proportion vector and the proportion vector of the estimated values.

performance of isoformex on real mrna-seq data and qrt-pcr experiments
to validate the estimation of transcript isoforms from the real mrna-seq data of mcf- <dig> and hme cell lines  <cit> , we performed quantitative rt-pcr  experiments on the same cell lines. we obtained qrt-pcr measurements for eight transcripts in four separate genome loci, such that each genomic locus contains two overlapping transcripts. for each of the four genomic loci, we calculated the expression ratio of one transcript over another in each cell line . similarly, the expression ratios for each transcript in mcf- <dig> relative to hme cell line were also obtained . the changes of expression  of transcripts between cell lines and within cell lines, determined by qrt-pcr measurements, are in good agreement with isoformex estimates obtained by analyzing the mrna-seq data.


fcw: log <dig>  where a and b are the second/first transcript expression within the same cell line. fcb: log <dig>  where a and b are the expression values of a transcript in mcf- <dig> and hme cell line, respectively. †fold change directions of cufflinks estimations were erroneously flipped. ‡when b =  <dig>  the fold change was computed from log2/).

the correlation coefficients between qrt-pcr measurements and values estimated with isoformex, cufflinks, and rsem were  <dig> ,  <dig> , and  <dig> , respectively. the low correlation of cufflinks and rsem was due to up/down flips of fold changes  in transcript expression for trap <dig> block and hist1h2bd block . the different estimations for hist1h2bd block was confirmed by custom wiggle track of mapped tags on the ucsc genome browser . by applying higher weight to the discriminative exon slice of uc003ngr. <dig> transcript and using the lower number of tags that mapped to the discriminative exon slice than the number of tags that map to the rest of the transcript region, isoformex estimated the expression of uc003ngr. <dig> as lower than that of the other transcript . other programs incorrectly estimated that uc003ngs. <dig> was expressed at lower level than uc00ngr. <dig> since they did not apply additional weight to the discriminative exon slice. for fair comparison, we used the same bowtie output files for isoformex and cufflinks in table  <dig>  we also tested cufflinks with default parameters. table  <dig> shows the agreement between qrt-pcr results and estimations obtained from rsem and cufflinks with default parameters. they generated two up/down flips of fcw . cufflinks did not show any substantial changes in performance with different values of the min-isoform-fraction parameter. isoformex showed the best agreement with qrt-pcr measurements without any fold change direction flips.



fcw: log <dig>  where a and b are the second/first transcript expression within the same cell line. fcb: log <dig>  where a and b are the expression values of a transcript in mcf- <dig> and hme cell line, respectively. †fold change directions of estimations were erroneously flipped. ‡when b =  <dig>  the fold change was computed from log2/).

we also compared the execution times of isoformex and other programs for reading the alignment files generated by bowtie and estimating transcript isoform levels from mrna-seq data for mcf- <dig> cell line. each execution time was measured in the same computer ,  <dig> gb memory). cufflinks only accepts sam file format  <cit>  as an input file format, whereas isoformex can handle bowtie output file format as well as sam file format. cufflinks  took about  <dig> minutes with a sam file for estimating transcript expression levels. rsem  took about five hours including mapping short reads to transcriptome and estimating transcript expression levels. isoformex  took about  <dig> minutes with two bowtie output files in order to estimate transcript expression levels of all valid transcripts and gene expression levels. although this is not rigorous comparison, the result shows the computational efficiency of isoformex.

discussion
in the current implementation, isoformex assumes a transcript model is given and the transcript model has most dominantly expressed isoforms. while isoformex addresses the problem of accurately estimating the isoform-level expression values, by assigning reads to a known set of splice-variants, cufflinks attempts to simultaneously discover novel isoforms and estimate their expression values. using user defined transcript model having novel isoform candidates would be a possible way for improving estimation accuracy. isoformex can handle overlapping genes as well as overlapping exons in transcript model for more accurate estimation of gene/transcript expression from mrna-seq data. it converts the transcript abundance estimation problem to a constrained optimization problem in order to take advantage of non-negativity in transcript expression levels. it uses the non-negative least squares algorithm which is well established optimization method based on mathematical/numerical analysis. it is numerically stable and computationally efficient. the non-negative least squares framework is simple and mathematically well defined so that additional biological knowledge can be incorporated in the framework through a weighting scheme. for example, the number of short reads in a smaller exon slice tends to be small due to the limitation of mrna-seq coverage. isoformex uses a weighting scheme for considering the small exon effect. although we suggested a reasonable weighting scheme, it would be worthwhile to study other weighting schemes. isoformex can be applied to mrna-seq data analysis not only to estimate expression levels of transcript isoforms, but also to estimate more accurate gene expression levels when different genes overlap. executable machine codes are available at http://bioinformatics.wistar.upenn.edu/isoformex.

CONCLUSIONS
we developed isoformex algorithm to estimate transcript-level expression values from mrna-seq sequence reads that were mapped to the genome. it can be applied not only to estimate isoform-level mrna expression values, but also to estimate gene-level expressions when different genes overlap. executable machine codes are available at http://bioinformatics.wistar.upenn.edu/isoformex.

