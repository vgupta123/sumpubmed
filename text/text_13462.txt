BACKGROUND
methodological advances provide transcriptomic information on dozens of individual cells in a single-cell sequencing project  to study the complex cellular states and to model dynamic biological processes  <cit> . from traditional bulk samples rna sequencing  to single-cell rna sequencing , cell-to-cell variabilities expose latent biological characteristics such as cell cyclic processes  <cit>  and transcriptional heterogeneity  <cit> , that disappears with bulk gene expression across thousands of cells. additionally, biological processes are often dynamic, while bulk rna-seq data may blur heterogeneity  <cit>  and un-synchronization  <cit>  of the transcriptional process. these features can be well represented owing to the advent of scrna-seq of sequential gene expression changes, which provides a set of time slices from individual cells sampling from different moments in the process  <cit> . developments in techniques for measuring gene expression  <cit>  make time-series expression studies more feasible with the relative database growing exponentially  <cit> . nonetheless, profiling the low amounts of mrna within individual cells leads to several experimental and computational challenges such as so-called ‘dropout’ events  <cit> , which involve the false quantification of a gene as ‘unexpressed’ because of the corresponding transcript being ‘missed’ during the reverse-transcription step  <cit> . this occurrence leads to a lack of detection during sequencing, which is observed in scrna-seq measurements with lower expression magnitudes. moreover, with different types of temporal response patterns observed in biological processes, identifying the set of genes that participates in specific response also poses a challenge for advanced computational methods  <cit> .

among others, one key objective is to define the sets of genes that best discriminate transcriptional differences by inferring the heterogeneity of cells’ unsynchronized evolution  <cit> . this strategy is important for discovering multiple cell fates stemming from a single progenitor cell type  <cit> . in essence, with each cell collected at a distinct time point, scrna-seq experiments would constitute a time series through a biological process by ordering single-cell expression profiles in multiple time points  <cit> . hence, time-course measurements with time-series gene expression data benefit researchers by capturing focused genes with transient expression changes  <cit> . we show an unsupervised approach to infer heterogeneity using time-series data derived from unsynchronized differentiation cells, rather than relying on known marker genes or experiments starting from synchronized cells within a quantitative measure of progress. then we cluster complex mixture of single cells based on these highly divergent genes to define potential cell types. in the context of bulk rna-seq, many popular tools for differential expression analysis are used . however, these methods simply compare gene expression levels between groups, a process that is not suitable to manage time-series scrna-seq data. by contrast, the key approach for scrna-seq data analysis is based on dimensional reduction. slicer  <cit>  makes use of a nonlinear dimensionality reduction algorithm to capture highly nonlinear relationships between gene expression levels. monocle  <cit>  infers a low-dimensional manifold embedded in a high-dimensional space that obtains the observed geometric relationships among the cells. other than dimensionality reduction, wanderlust  <cit>  can capture nonlinear behavior through finding the shortest paths by k−nearest neighbor graphs without dimensional reduction. critically, dimensional reduction does not make full use of the rich information provided by scrna-seq time-series data. however, the existing methods may overlook un-synchronization over the entire time series. it is a challenging problem to provide the approaches to identify the set of genes from distinct cells that are differentially expressed over time. moreover, estimating at which time periods the transcriptional heterogeneity with different cell types is present can provide additional insight into temporal gene functions.

in this article, we present an algorithm based on the dynamic time warping score   <cit>  that is used in scrna-seq time-series data to infer the potential cell types between time period the first time. dtwscore provides three significant advantages for inferring the potential cell types:  it is capable of managing unevenly and sparsely sampled time-series gene expression data without need for prior assumptions about the evenness or density of the time-series data;  the method uses dynamic time warping  algorithms to consider the similarity of pairs of vectors taken from each time series between the gene expression levels and progression through a process. the dtwscore shows the classification of potential cell types and corrects for synchronization loss;  the method is capable of maintaining the sensitivity and specificity with scrna-seq gene expression data that has been tested in various experimental designs.

RESULTS
overview of the dtwscore method to detect highly divergent genes and classify potential cell types from time-series scrna-seq data
for single-cell rna-seq data, the gene expression level of some fixed time points become more easily obtainable than traditional bulk rna-seq data  <cit> . a commonly used method for assessing the variability is the ratio of the fold-change  <cit> , calculated as the ratio between the mean expression values of samples, which illustrates its limitation in dealing with time-series data. to overcome the deficiency, we implemented dtw algorithms on synthetic and real time-series scrna-seq data. dtw was originally developed for speech recognition in the 1970s  <cit> . similar to the algorithms used for sequence comparisons, the dtw algorithm is particularly suitable for identifying highly variable genes between scrna-seq time-series data especially unsynchronized time-course data. in several time-series experiments, cells may not be synchronized over the entire time series, while these cells may be involved in the same cyclic progress. for each gene, its expression values from different time points represent the biological process. whether or not one gene is involved in the different biological processes between different cell samples or diverse tissues is essential for characterizing the heterogeneous genes. each gene is given an average dtwscore based on its time-series expression levels from all pairs of cells, and a threshold based on the distribution of all the dtwscores is set to choose the specific genes that present the significantly variable progression. cells could be clustered based on the highly divergent genes to define potential cell types. to demonstrate the performance of the dtwscore, we applied it to several simulated examples and public datasets with new biological insights.

briefly, the dtwscore focuses on detecting the cell-to-cell heterogeneity among time-period scrna-seq data and highlights the highly divergent genes that are used to define potential cell types. the input of the dtwscore is a matrix of time-series gene expression data. the rows of the matrix stand for individual genes, and the columns represent the gene expression profiles of different cells from discrete time points. the method is performed on both simulated and real datasets. in particular, if a gene expression level between different time periods is quantified through the same process function, we consider genes of this type to show non-heterogeneity across cells, while the remaining genes are deemed as highly variable genes between time series data for further analysis. a graphical representation of our method pipeline is displayed in fig.  <dig>  first, we performed the traditional filter step to filter low-quality cells. to identify poor-quality libraries from further analysis, we hold the identifiers for genes expressed in at least  <dig> percent of total cells in the data set. second, we calculated the mean dtw distance of all pair of cells as the index for detecting a specific set of genes for heterogeneity analysis. based on the dtw distance index, we normalized the dtw index values to reduce the bias toward extreme values. after normalization, the gene with the highest dtwscores are selected for further analysis and are referred to as the most significantly highly variable gene. the flexible threshold for choosing the sets of genes can be adjusted by the normal distribution of the all the average dtwscores for each gene. the output of our result could be used for classifying cells of different types. furthermore, some heterogeneous genes could serve as potential biomarkers that track some disease processes. the details of the dtwscore pipeline are described in the methods section.
fig.  <dig> overview of the dtwscore pipeline. details are described in the methods





the dtwscore identifies differentially expressed genes from time-series scrna-seq data
synthetic time-series scrnaseq data
we borrowed functions  <cit>  with a ‘process time’ parameter t to simulate gene expression patterns with four different ‘biological processes’. if the gene expression patterns are tracked during the unfolding of a biological process, the process can be conceived as some specific functions over time. four typical trajectories of gene expression are simulated graphically . heat maps are a popular way to display gene expression levels. as shown in fig.  <dig>  heat map is plotted with equal width for each time points to make an external direct-viewing impression on the time-series gene expression data. the input of the heatmap is a matrix whose rows represent the four types of process functions and columns represents the discrete time points.
fig.  <dig> simulated trajectories of gene expression levels over time. the x-axis represents time and the y-axis represents fpkm values of gene expression. the genes are represented by four types of continuous curves that highlight the dynamics of expression changes


fig.  <dig> four patterns of gene expression for each functions. a more precise overview of different gene expression process in time order. heatmap shows gene expression levels from samples that were taken at even time intervals. experiments shows four pattern of gene expression for each functions




in the simulation, two groups of scrna seq data with time are generated as follows. group one : the gene expression matrix at multiple time points is generated by the same function shown in fig.  <dig>  indicating that this gene undergoes the same biological process. group two : the gene expression matrix at multiple time points is generated by different functions shown in fig.  <dig>  indicating that this gene undergoes different biological processes. additionally, the number of time points could be the same or different, which is a good feature of dtw algorithms. more details regarding the setup can be found in the‘methods’section. to address the issue with identifying differentially expressed gene patterns in scrna-seq data and classifying different cell types, we perform the dtwscore pipeline on synthetic datasets under six conditions . the simulated dataset consists of the two groups of  <dig> gene expression levels with two time periods. in group one,  <dig> genes undergo the same biological process between two time periods and their expression values are simulated by a single family of functions. in group two,  <dig> gene’ expression values are generated from different families of functions. we compute the average dtwscore to identify genes that were from the same biological processes or heterogeneous processes, as shown in figs.  <dig> and  <dig>  after normalization for the origin dtw index, high dtwscore genes are enriched in the group of genes that are simulated by different families of process functions. figure 4
c and d show that the dtwscores are clustered from different gene sets. the dtwscore algorithm successfully identified time-series genes of non-heterogeneity versus heterogeneity. we performed dtwscore analysis on various synthetic datasets and repeated the analysis times, and the results suggest that the dtwscore performs well in the analysis . next, we evaluated the discriminative power of the dtwscore in terms of receiver operating characteristic  curves, using two simulating datasets labeled conditions  <dig> and  <dig>  in particular, for the comparison, genes are divided into a true-positive group and a true-negative group according to the simulating strategy. thereafter, roc curves were constructed by calculating the true and false positive rates for all possible thresholds . the black curve represents condition  <dig> simulated by the biological functions f
 <dig> and f
 <dig>  while the red curve represents condition  <dig> simulated by the biological functions f
 <dig> and f
 <dig> 
fig.  <dig> dtwscore identifies heterogeneous and non-heterogeneous genes from the synthetic data. a temporal patterns of gene expression from a single biological function. diamonds and crosses shows the time points at which samples were collected from the two time periods. samples were taken at uneven time intervals. b temporal patterns of gene expression from two biological functions. triangles and circles show the time point at which samples were collected from the two time periods. c jitter plot of dtwscore between non-heterogeneous genes versus heterogeneous genes, displaying clear clusters. d bins in the horizontal axis summarize changes in the overall expression group of bars corresponding to genes from simulated datasets. colored bars within each group summarize changes in dtw distance between groups. the figures show that the dtwscore is effective for identifying gene expression patterns


fig.  <dig> dtwscore identifies heterogeneous and non-heterogeneous genes from synthetic data. a temporal pattern of gene expression from a single biological function. diamonds and crosses shows the time points at which samples were collected from the two time periods. samples were taken at uneven time intervals. b temporal patterns of gene expression from two biological functions. triangles and circles show the time points at which samples were collected from the two time periods. c jitter plot of dtwscore between non-heterogeneous genes versus heterogeneous genes, displaying clear clusters. d bins in the horizontal axis summarize changes in the overall expression group of bars corresponding to genes from simulated datasets. colored bars within each group summarize changes in dtw distance between groups. the figures show that the dtwscore is effective for identifying gene expression patterns


fig.  <dig> roc curves from different conditions. the dtwscore method was applied to two different scrna-seq time series data sets. the algorithm’s performance was assessed by their sensitivity, illustrated in the roc curves, which demonstrate good performance in all cases. the black curve represents condition  <dig> simulated by the biological functions f
 <dig> and f
 <dig>  the red curve represents condition  <dig> simulated by the biological functions f
 <dig> and f
4




highly divergent genes define the potential cell types from time-series scrna-seq data
human skeletal muscle myoblasts  data
in this section, dtwscore is applied to the recently published data from human skeletal muscle myoblasts  <cit>  which were captured between single cells at four time points. the data were generated from rna from each cell, which was isolated and used to construct a single mrna-seq library per cell with a sequencing depth of ∼ <dig> million reads per library. the fragment per kb per million mapped fragments  expression profiles are provided on the gene expression omnibus  website. our goal is to classify cells from complex mixtures of multiple cell types and investigate the cell-to-cell heterogeneity between two time periods by identifying the highly variable gene expression patterns. differentiation across a set of cells proceeds at potentially different rates, relying strictly on the time points. with the collected data at different time points, we would like to determine a set of genes exhibiting variabilities across cells with the same or different time periods. our method was different from the traditional cell cluster detection methods with no need for biological prior knowledge. we sought to identify the most highly divergent genes that could be used to define potential differentiation states. all pairs of cells were chosen from this group of cells based on two time period and we calculate each genes’ average dtwscores for all pairs of cells. as shown in fig.  <dig>  the histogram displayed the density of the dtwscores which obeys a gaussian distribution. the q-q plot in fig.  <dig> compares the data generated by dtwscores on the vertical axis to a standard normal population on the horizontal axis. the linearity of the points suggests that the data are normally distributed. we could make full use of the mean and the standard deviation of the gaussian distribution to determine the highly variable genes. owing to the distribution of dtwscores, we take the  <dig> standard deviations above the mean as the threshold for identifying heterogeneous genes . three genes with the top three dtwscores  <dig> ,  <dig>  and  <dig>  show a significant difference between cell types myoblasts and fibroblasts. we plot the expression levels of these genes by boxplots and density plots , to better highlight the differences between cell states. hence, without any biological knowledge, we have selected the possible marker genes that tend to be highly informative about cell states and types. moreover, we analyzed three genes with the highest dtwscores for model-based clustering. with the two covariance structures, finite gaussian mixture model provides functions for parameter estimation via the expectation maximization  algorithm . we simply call mclust function from r package mclust  <cit>  to perform cluster analysis of the three genes respectively. receiver operating characteristic  curves for predictions  shows the good performances of our classification. we computes the confidence interval  of the sensitivity at the given specificity points. moreover, two genes or three genes might also be driving the clustering .
fig.  <dig> histogram and q-q plot of dtwscore based on hsmm datasets. the histogram plot of dtwscores shows that the distribution of values is normally distributed. the linearity of the points in the q-q plot is the best proof. meanwhile, outlier of the distribution appears on the right corner. thus, genes with dtwscore more than  <dig> standard deviations above the mean are considered heterogeneous genes


fig.  <dig> genes with the top three dtwscores. the boxplot and density represent temporal gene expression values of three highly variable genes from all pairs of cells. it is obvious that these genes should be declared as differentially expressed. the genes with highest dtwscores undergo different expression pattern and play an important role in the following clustering analysis


fig.  <dig> receiver operating characteristic  curves for prediction. receiver operating characteristic  curves for classification made by the most highly variable gene. also shown are roc curves for classification made by the other two genes chosen by the dtwsocre. this function computes the confidence interval  of the sensitivity at the given specificity points. by default, the 95% ci are computed with  <dig> stratified bootstrap replicates




comparison with other methods
in order to assess the performance of dtwscore in relation to other approaches, we run monocle and slicer on the hsmm data and compared the classification results from all the three approaches.

monocle uses independent component analysis  to reduce the dimensionality of the expression data before clustering the cells. monocle also provides algorithms on unsupervised cell clustering and semi-supervised cell clustering with known marker genes. figure 10
b shows that the cells fall into two different clusters. the cells tagged as myoblasts are marked in green, while the fibroblasts are tagged in red. unfortunately, the cells don’t cluster by type. this is not surprising because myoblasts and contaminating interstitial fibroblasts express many of the same genes in these culture conditions. while dtwscore method makes full use of the information between all pairs of cells by calculating time series dtwscores. this process help dtwscore infer the most stable marker genes for defining the potential cell types. figure  <dig> shows the roc curves for the comparison between dtwscore and monocle methods which present the better performance of dtwscore method.
fig.  <dig> slicer and monocle results from hsmm data. a cellular clustering inferred by slicer. cells colored according to the branches that slicer assigned using geodesic entropy. b cellular clustering inferred by monocle. the cells tagged as myoblasts are marked in green, while the fibroblasts are tagged in red



fig.  <dig> receiver operating characteristic  curves for comparison with monocle. genes with the top three dtwscores are chosen for cells cluster respectively. roc was performed for comparing with monocle method which shows the better performance of dtwscore method




because slicer can infer highly nonlinear trajectories and determine the location and number of branches and loops, the cells fall on more different branches. figure 10
a is the default low-dimensional k-nearest neighbor graph shows the clustering using slicer branching analysis. it appears that slicer benching analysis suggest that cells should fall on many different branches which maybe more than the real number of cell types. obviousily slicer is capable of detecting types of features but sometimes it will overfit. however, dtwscore is a model-based method to infer the potential cell types which is more flexible for diverse datasets.

discussion
we stress that our method is different from the approach that detects cell clusters and expression differences, such as those described previously  <cit> , which seek to infers cellular trajectories from scrna-seq data. in addition to identifying differentially expressed genes from the time series data, our framework allows us to identify potential cell types that undergo differetiation at each time point. such genes are of great interest. first, they represent biological heterogeneity within heterogeneous cells, implying differential regulation of response across cells. second, these genes could be used for marker genes to distinguish from mixture of cell types. finally, we hypothesize that heterogeneous genes can serve as biomarkers that track the progressive disease process. if confirmed, our study will discover and monitor disease processes prior to the onset of clinical symptoms. we also do not require dimensionality reduction with many important genes going unobserved. the real strength in our framework lies in the capacity to characterize the potential cell types by inferring differentially expressed genes, which provides the opportunity to study the extent of gene-specific expression heterogeneity within a biological condition.

the approach is limited in that only classification of cell types are feasible. a generalized dtw algorithm used for the analysis will make analyses of more than three to four cells over time possible; work in that direction is underway. finally, we note that, while the differentially expressed genes identified by the dtwscore may prove useful in downstream analysis and cellular branches and trajectories inference, extensions in this direction are also underway.

CONCLUSIONS
to date, a large amount of available high-throughput data has been measured at a single time point  <cit> . time-series expression experiments provide a wealth of information regarding the complete set of gene expression patterns  <cit> . thus, a large body of literature has integrated these temporal data sets using computational methods . meanwhile, many quantitative tools have sought to  study changes in gene expression and the potential cell states at the single-cell level. for a better understanding of the single-cell expression level combined with time-series data, we focused on the detection of genes whose biological heterogeneity varies between cells and inferring the potential cell types from complex mixtures of multiple types. this analysis is quantified with our proposed dtwscore, which is used as the basis to select highly variable genes. according to the experimental results, the dtwscore is effective with cell type clustering based on single-cell expression time-series data.

our analysis of scrna-seq time-series gene expression datasets increased the ability to study various cellular mechanism over time. first, in hsmm cells, we identified highly significantly differentially expressed genes with time-series data, indicating that the genes are marked for use in the following clustering. the expression of these genes possibly arose from the un-synchronized time-series scrna-seq experiments. second, given the various biological processes, the dtwscore for each gene was calculated using our pipeline. by combining the method to set thresholds, quantitative analysis has enabled the direct separation of heterogeneous and non-heterogeneous genes. the dtwscore can manage uneven and sparsely sampled time series gene expression data without need for prior assumptions about the evenness or density of the time-series data. moreover, all pairs of cells are calculated by dtwscore, a procedure that could result in the stability of finding important highly variable genes. finally, the dtwscore could successfully identify the potential cell types from bunch of scrna-seq data.

regarding computational future directions, recovering the genes’ heterogeneity over time in individual cells is only a fist step in understanding the complex dynamic processes that drive changes in gene expression. most scrna-seq data sets consist of hundreds  of cells that have recently allowed parallel sequencing of substantially larger numbers of cells in an effective manner, which brings additional challenges to the statistical analysis of scrna-seq data sets . we expect that developing unified computational methods with time-series single cell gene expression data will yield more biological insights. inferring the potential types and states of individual cells is thus a useful tool for studying cell differentiation and govern a much wider array of biological processes.

