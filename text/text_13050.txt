BACKGROUND
the increasing number of completely sequenced genomes has enabled gene function predictions by means of whole genome comparison. existing methods such as synbrowse  <cit> , vista  <cit> , lagan  <cit> , pipmaker  <cit>  and ensembl syntenyview  <cit>  provide visualization of conserved regions between two or more genome sequences for comparative analysis. such visualization facilitates the prediction of gene function based on comparison of genomic context information such as co-occurrence of genes  <cit>  and conservation of gene order  <cit> .

however, these methods have two major limitations. first, they rely on sequence alignment to identify corresponding genes or regions between genomes  <cit> . consequently, they cannot automatically detect homologous or functionally similar genes that share no sequence similarity, resulting in a need for manual prediction for those genes. second, these methods require the genomes being compared to be closely related. this hinders the possibility of automatically analyzing a large collection of weakly related genomes and makes it impossible to inspect a genome to which related species have not been identified.

bacteriophage genomes are one example that suffers from the above limitations. firstly, sequence alignment based methods are not fully reliable in detecting functionally similar genes within phages. this is because homologous phage genes have often diverged beyond the recognition of sequence similarity  <cit> . a key argument to explain such divergence was that the genes have a very distant common ancestry  <cit> . secondly, requiring to compare only a few related phages and to ignore the remainder can hinder the genomic analysis of the target phage. the reason is that the global phage relationships are not clearly defined phylogenetically due to an extensive amount of horizontal gene transfers   <cit> , implying that relatedness between phages often cannot be established. consequently, it is desirable to have an objective measure to automatically identify closely related genomes based on the genetic data, as opposed to depending on the user to define a set of "related species".

this work addresses the shortcomings of the existing methods and aims to provide a highly automated gene function prediction system based on whole-genome comparison. the system, named synfps, contains two automated learning units with distinct roles: a clustering technique that utilizes gene-to-gene distances to identify closely related genomes and a support vector machine  for discriminative classification on gene functions. the algorithm of synfps and the results of function prediction on phage genes will be presented in the remainder of this paper.

RESULTS
evaluation of prediction results by leave-one-out cross validation
we have attempted to perform predictions over nine common phage genes using synfps. these are major head, major tail, tape measure, prohead protease, integrase, terminase, portal, holin and lysin genes. they were selected on the basis of regular existence – they encode necessary functions not provided by their hosts, including structural and assembly genes, as well as lysis genes  <cit> . these genes were searched against the annotation database using regular expression patterns defined in table  <dig>  manual modifications of the search results have been conducted to remove ambiguous entries.

we perform leave-one-out  cross validation to evaluate the prediction performances for these genes. for each gene function, we run the cross validation in each cluster individually over a discrete range of values of the kernel parameter – σ for gaussian rbf kernel  <cit> . the σ value that gives the best accuracy is chosen and is used for all future predictions for that function. the prediction accuracies shown in table  <dig> are the averages of cross validation results across all the clusters.

k-fold cross validation may also be used to evaluate the prediction performances and it is expected that accuracies are lower with a smaller k value. for instance, the prediction accuracy for terminase is  <dig> % for k =  <dig> and  <dig> % for k =  <dig>  however, loo is more suited to our overall purpose – one primary objective of the cross validation is to find out the near optimal σ value for the gene class to perform future predictions. since most clusters contain only a very small portion of genomes that require genuine prediction, they are best simulated by loo, where only one genome is taken out for prediction testing at a time.

the prediction accuracies are averaged at ~80%. the 100% prediction accuracy of lysin can be explained by the strong context relationship between lysin and holin. since the presence of a lysin is always accompanied by the presence of a holin immediately beside it  <cit> , synfps can easily identify the lysin gene if it already knows the position of the holin. however, the converse is not true: the identification of holin genes may not depend upon the presence of lysin. consequently, the prediction accuracy for holin is not as high.

these prediction accuracies reflect the sensitivity of the system ). the specificity of the system ) on the other hand is always larger the sensitivity because of two system features. firstly, we allow only a single positive prediction for each genome . thus, the number of false negatives is always the same as the number of false positives, implying that the specificities always scale together with the sensitivities. secondly, the number of negative training data  is always larger than the number of positive training data , and consequently specificity > sensitivity. one reason for using loo cross validation accuracies to evaluate the system is the lack of benchmark for our problem. however, it may be noteworthy that other genomic-context based methods for the prediction of functional elements have similar reported accuracies ranging from 72% to 80%  <cit> .

trade-off between prediction coverage and prediction accuracy
we have examined the effect of the k-means adaptive threshold t on the prediction accuracies. the value of t ∈ . using different t values lead to a different amount of genomes that are covered by the automated prediction . genomes within the "coverage" are those for which synfps has made a classification decision; the remaining genomes are discarded or ignored by synfps. here are examples of genomes not in coverage:

• genomes not containing the gene being predicted 

• genomes that is in a cluster on their own

• within a cluster, if there are fewer than two genomes that contain the gene being predicted, then all the genomes are discarded

• genomes with genomic context different to the consensus of the group may be discarded

functions predicted to  <dig> uncharacterised genes and  <dig> sequence dissimilar genes
using the maximum coverage and the σ values optimized by loo cross validation, we have generated predictions over genomes within which certain gene functions were not already detected. the outcome of synfps is to identify which genes within those genomes correspond to the functions of our interest. the prediction outcomes are listed in table  <dig> 

three genes that we have predicted functions for have no existing functional annotation in the database . seven genes in table  <dig> exhibit sequence similarity to their reference genes, suggesting that their predicted functions are supported by both sequence similarity and the genomic context information embedded in our system, such as gene order conservation and positional coupling. for other genes that show no sequence similarity , the predicted functions are only evident by the genomic context. it is noteworthy that sequence alignment based methods would have failed in finding correspondences to these genes. other prediction results have complemented existing annotations in the database in cases where they do exist, and therefore support the validity of our approach.

CONCLUSIONS
we presented a novel genomic-context based method capable of predicting gene functions from a large collection of genomes. an adaptive k-means clustering is used to distinguish groups of related genomes based on the conservation of gene order and the conservation of gene-to-gene distances. the clustering results serve as a platform for the svm to extract training data to perform classification based predictions. nine common gene functions of bacteriophages were tested and the loo cross-validated prediction results are averaged at 80%. functional predictions are also made on  <dig> uncharacterized genes and  <dig> genes that cannot be identified by sequence alignment.

although our experimental focus is on bacteriophages, the method may be extended to other microbial genomes. for example, bacterial genomes have been observed with conserved gene order  <cit>  and conserved gene-to-gene distances   <cit> . these properties satisfy the underlying assumptions of our approach and suggest potential application of the method.

