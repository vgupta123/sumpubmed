BACKGROUND
the development of eukaryotic organisms is tightly regulated by a variety of mechanisms. the initial step of regulation is carried out by transcription factors interacting with cis-regulatory sequences, also known as transcription factor binding sites . in eukaryotes, multiple tfbs are often clustered together into cis-regulatory modules . the tfbs can be thought of as inputs into an information processing element, with the output being the level of expression of the gene controlled by the crm  <cit> .

one of the major challenges for understanding eukaryotic gene regulation is finding crms. there are two main types of crms – promoters and enhancers. promoters are located immediately upstream of a gene's transcriptional start site and often contain a variety of sequence signals such as the tata box, ccaat box, and different tfbs. these characteristics have been used in approaches for finding promoters  <cit> . in contrast, enhancers do not share these signals and operate in a manner that is relatively independent of orientation or distance from their target gene  <cit> . in fact, one enhancer, dct, has been found almost a megabase away from sox <dig>  the gene it regulates  <cit> . because of the lack of common signals and because the search for enhancers cannot be limited to the few hundred base pairs upstream of the transcriptional start site, finding enhancers is a more difficult problem.

methods for predicting crms can be classified by the type of information they use to make the predictions – known binding sites of regulatory proteins, homologous sequences, or known crms. binding sites for the first type of method are generally modeled using position weight matrices  or consensus sequences. these models are used to search for statistically significant clusters of predicted tfbs. examples of methods based on binding sites of multiple transcription factor proteins include one developed for human skeletal muscle  <cit> , a logistic regression analysis model for liver-specific transcription factors  <cit> , cis-analyst  <cit> , mcast  <cit> , ahab  <cit> , stubb  <cit> , cluster buster  <cit> , mscan  <cit> , and emcmodule  <cit> . methods based on binding sites of single transcription factors have also been developed – score  <cit> , fly enhancer  <cit> , and a method of searching for homotypic clusters  <cit> .

methods based on homologous sequences assume that areas of the dna involved in regulating gene transcription are under selective pressure and are therefore more likely to be conserved than non-functional dna  <cit> . these methods can be categorized by whether they search for conserved dna by aligning homologous regions from multiple species  <cit> , homologous regions from two species  <cit> , or homologous regions from related genes in a single species   <cit> .

methods based on locations of known crms have been rarer. methods of this type tend to look for statistical properties of dna sequence that distinguish crms from non-regulatory dna. one group has developed a statistical test called the "fluffy-tail test" that looks for differences in nucleotide composition, particularly in lists of words of various lengths  <cit> . from the related field of promoter prediction comes promfind, an algorithm for finding promoters that uses hexamer frequencies of known promoters to search for dna with similar frequencies  <cit> . because promfind was developed for promoters, the author could assume that every sequence being tested contained one promoter, and that the strand containing the promoter was known – assumptions that are not true for enhancers. another recent algorithm developed to predict crms is based on the exhaustive analysis of local word frequencies   <cit> . unlike promfind where the algorithm is based solely on hexamer words, the lwf algorithm considers the pattern of word frequencies in a sliding window.

while the lwf algorithm was shown to perform well at the task of predicting crms  <cit> , it is difficult to put a biological meaning to the results since the algorithm depends on word frequencies, not on the words themselves. in contrast, the promfind algorithm generates lists of hexamers that are important for distinguishing promoters from non-promoter sequences. in the paper describing promfind, the author analyzes the hexamers used by the algorithm for their cpg dinucleotide content and their similarity to various known promoter signals such as the sp <dig>  tata-box, and ccaat-box motifs  <cit> . this type of analysis cannot be performed on the local word frequency distributions of the lwf algorithm, due to the way it was designed.

we developed the hexdiff algorithm to solve the same problem as the lwf algorithm – predicting the location of crms – while being as biologically meaningful as the promfind algorithm. the performance of hexdiff was compared to the lwf algorithm and several other crm prediction programs using a common data set. the hexamers used by hexdiff were then examined to see if known tfbs were recovered.

RESULTS
data set
the early development of the drosophila embryo is well-studied, both biologically and computationally. data sets detailing the locations of known crms have been published by several groups  <cit> , but we chose the one compiled by schroeder et al. as it clearly defined the regulatory networks involved. in their analysis, schroeder et al. examined  <dig> genes with gap and pair-rule patterns. however, only  <dig> of those genes were associated with known crms  <cit> . therefore, we focused our study on those  <dig> genes, which contained a total of  <dig> crms. sequences for the genes were obtained from the  <dig>  release of the drosophila genome and included the  <dig> kb upstream as well as downstream of each gene . since the known crms were provided as fasta-formatted dna sequences, their positions relative to the extracted sequences were confirmed using blast .

the hexdiff algorithm
the hexdiff algorithm is designed to discriminate between crms and non-crm sequence by using hexamer frequencies. for evaluation, we use the leave-one-out cross-validation  methodology. in this case,  <dig> of the  <dig> sequences in the data set are used as a training set and the 16th sequence is used as the test set. the process is repeated  <dig> times; leaving out one sequence each time. during training, hexamers that appear more frequently in crms are selected. in order to predict crms in the test set sequence, a window is slid across the sequence and the set of selected hexamers  is used to calculate a score that is used to predict whether each position is either crm or non-crm sequence.

performance comparison
the hexdiff algorithm was compared to five other crm prediction algorithms: ahab, cluster buster, mscan, mcast, and lwf . the results for ahab were obtained from the supplementary files of schroeder et al., while cluster buster, mscan, mcast, and lwf are all available as downloadable software or public web servers. an important criterion for the inclusion of an algorithm was that it accepted user-defined sequences and pwms as input. ahab, cluster buster, mscan, and mcast are algorithms based on binding sites of known transcription factors and were given the same set of nine pwms for the transcription factors as described in schroeder et al.: the maternal factors bicoid , hunchback , caudal , the torso-response element , and stat92e , and the gap factors kruppel , knirps , giant , and tailless . lwf was given the same positive and negative training sets as hexdiff. the default parameters were used for cluster buster, mscan, mcast, and lwf. the complete list of predictions can be found in the additional materials section .

window size
free energy cutoff
gap parameter
cluster score threshold
window size
minimum hits
maximum allowed distance between adjacent hits
number of mismatches
detection window size
maximum number of channels
channels equalized
profile cutoff
peak width cutoff
as shown in table  <dig>  each algorithm was assigned a cumulative score, calculated by summing the matthews correlation coefficients for each of the sequences in the data set. the predictions made by hexdiff have the highest correlation with the known crms , followed by ahab  and cluster buster . an interesting result is that although four of the six algorithms used the same pwms, their performance varied widely – from  <dig>  to  <dig> .

while the matthews correlation coefficient was the primary performance measure for the six algorithms, a closer look at two other measures offers more information about the characteristics of the individual algorithms. table  <dig> shows sensitivities and positive predictive values  for each of the algorithms. a known crm was considered recovered if the overlap between it and a predicted crm exceeded  <dig> bp.

one caveat about the ppvs in table  <dig> is that they are not true ppvs, but estimates of the true ppvs. this is due to the fact that the  <dig> sequences in the data set may contain more crms than the  <dig> that have been characterized so far, which would mean that some of the predicted crms that are labeled as false positives could actually be true positives.

predicted crms
of the  <dig> predictions made by hexdiff,  <dig> overlapped known crms by at least  <dig> bp, leaving  <dig> potential crms. some of these may have been false positives, so to narrow down the candidates, the  <dig> potential crms were compared to predictions made by ahab, cluster buster, mscan, mcast, and lwf.  <dig> of the  <dig> matched predictions made by at least one other method, while  <dig> matched predictions made by at least two other methods,  <dig> matched predictions made by at least three other methods, and  <dig> matched predictions made by at least four other methods.

while our analysis was focused on the gap and pair-rule regulatory networks, it's possible that some of the predicted crms are actually known crms from other regulatory networks involved in the early development of drosophila. therefore, the list of  <dig> predicted crms was compared to a more comprehensive compilation of  <dig> crms  <cit> .  <dig> of the  <dig> predicted crms matched crms from the compilation, leaving  <dig> that do not correspond to any known crms. given the specificities of the individual methods and the breadth of approaches, it seems very likely that some of the  <dig> predictions listed in table  <dig> constitute novel crms.

meaning of differential hexamers
one advantage of the hexdiff algorithm is that the set of hexamers  used to distinguish between crms and non-crm sequence can be analyzed for further insights into the mechanisms of gene regulation. since the hd hexamers were selected based on their overrepresentation in crms relative to non-crm sequence, it would be reasonable to expect that some of the hexamers would be similar to gap and pair-rule regulatory sites. therefore, the top  <dig> hd hexamers and their reverse complements were compared to the list of binding sites used to build the  <dig> pwms from schroeder et al . in the  <dig> rounds of cross-validation, an average of  <dig>  hexamers was found within the binding sites.

simulations were carried out to estimate the likelihood of this result.  <dig>  random sets of  <dig> hexamers and their reverse complements were compared to the binding sites. the probability of  <dig> or more hexamers being found within the binding sites was  <dig> , indicating that the hexamers selected by hexdiff were enriched in binding sites of known regulatory proteins.

a similar study was performed using regulatory sites obtained from transfac  <cit> , but the results were not statistically significant. transfac contains binding regions obtained through a variety of biological methods. for instance, r <dig> contains the following binding region obtained using dnase i footprinting: gactttattgcagcatcttgaacaatcgtcgcagtttggtaacac. on average, transfac binding sites are much longer than the binding sites used by schroeder et al .and are therefore probably much less specific. while the transfac binding sites do contain regulatory dna, it seems that the signal is washed out by extraneous sequence.

discussion
the hexdiff algorithm is designed to solve the difficult task of distinguishing crms from non-crm sequence. it is first trained on sequences containing known crms by selecting hexamers that discriminate between the two categories. these hexamers are then applied to novel sequences to search for predicted crms. the requirements of the training process mean that hexdiff works best in a well-defined regulatory system where some crms are already known.

using a data set of  <dig> sequences containing  <dig> crms obtained from schroeder et al., we compared the hexdiff algorithm to five other algorithms: ahab, cluster buster, mscan, mcast, and lwf. hexdiff's predictions correlated best with biological knowledge, and its sensitivity and specificity were comparable to the other algorithms. this result was encouraging considering that hexdiff is a type of machine learning algorithm, which tend to do better in problems where the items being classified are separated into two roughly equal groups. in this case, the crms made up just  <dig> % of the total data set, with non-crm sequence making up the other  <dig> %. even with a data set where the negative data outweighed the positive data by a factor of  <dig>  hexdiff still performed well.

while the hexdiff algorithm has a fairly high specificity in isolation, it would still be prudent to compare its results to the predictions made by other algorithms, considering the time and effort required to biologically confirm a computational prediction. the  <dig> crms listed in table  <dig> were predicted by at least three algorithms and did not match any of the  <dig> crms provided by schroeder et al. a comparison with a more comprehensive list of  <dig> crms revealed that  <dig> of the  <dig> predicted crms corresponded to known crms from other regulatory networks involved in the early development of drosophila. the  <dig> remaining predicted crms are strong candidates for future study.

a further attempt to understand the meaning of the hd hexamers was made by comparing them to the known binding sites used to generate the  <dig> pwms provided by schroeder et al. simulations showed that the number of hd hexamers found within the binding sites was significantly more than would be expected of a randomly selected set of hexamers of the same size. while this result is not unexpected, it is a confirmation that we retrieved the binding sites of relevant regulatory proteins using only the locations of known crms.

while recovering the known binding sites is important, it is important to note that they accounted for less than half of the hexamers in the hd sets. when  <dig> hexamers were selected for hd, their reverse complements would increase the total number of hexamers to  <dig>  barring palindromes. and yet, the average number of hexamers that were found within the known binding sites was  <dig> , leaving another  <dig> hexamers whose identities are unknown. this result suggests that there are novel sequence features besides the known binding sites that are important for distinguishing between crms and non-crm sequence.

CONCLUSIONS
one of the major questions in studying eukaryotic gene regulation is how regulatory proteins with relatively degenerate binding sequences can precisely regulate many genes. the discovery of cis-regulatory modules, short stretches of dna that contain multiple binding sites for multiple proteins, has provided at least a partial explanation for the regulatory specificity observed in eukaryotes, and motivated a search for ways to predict crms computationally.

we have developed a simple and effective algorithm for predicting crms. in our study of the gap and pair-rule genes in drosophila melanogaster, the results of the hexdiff algorithm correlated best with biological knowledge, and the sensitivity and specificity of the algorithm were comparable to other algorithms. our predictions were compared to those made by other methods and resulted in a list of  <dig> putative crms with strong computational support. analysis of the hd hexamers revealed that not only were we rediscovering the known binding sites, but also discovering new signals that distinguished between crms and non-crm sequence.

