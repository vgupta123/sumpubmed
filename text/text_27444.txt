BACKGROUND
a significant challenge with affymetrix expression data is to provide an algorithm that combines the signals from the multiple perfect-match  and mismatch  probes that target each transcript into a single value that sensitively and accurately represents its concentration. mas <dig>  does this by calculating a robust average of the  pm-mm values  <cit> ; increased variation is observed at low signal strengths and is at least in part due to the extra noise generated by subtracting the mm values from their pm partners  <cit> .

a number of alternatives  have been proposed that ignore the mm values, and consequently do not suffer from this source of variation. rma successfully reduces the variance of low abundance transcripts and has been shown, using controlled datasets in which known quantities of specific mrnas have been added to a common reference pool, to better distinguish differentially expressed transcripts from those that are unchanging  <cit> . in these experiments, only a small number of spikes were added, with the consequence that the vast majority of transcripts do not vary in concentration across the arrays, and that the mm signal, which results from the combined action of many weak, partial cross-hybridizations, might be expected to remain approximately constant  <cit> . however, whilst mm probes may not have a significant effect in 'spike-in' datasets such as these, they may be more useful with real experimental data, in which many more transcripts are changing. in a recent study, sets of 100– <dig> mrnas were spiked into a known background set containing  <dig>  different rna species  <cit> . the authors found the mm probes to be of significantly more utility, and that mm probe subtraction as performed by mas <dig>  was the best background correction method of the algorithms on test. see also  <cit>  for further consideration of these data. a variant of rma, gcrma  <cit> , uses intensity-summaries generated across sets of probes to estimate non specific binding. the rationale is that hybridization signal  should at least in part be determined by binding efficiency. irrespective of the way different algorithms calculate background, the consequences of a non-varying signal should still apply; choe et al. found that the mas <dig>  mm subtraction outperformed the summary-approach of gcrma on their dataset  <cit> .

detection calls
in addition to expression summaries, the affymetrix software also generates a p-score that assesses the reliability of each expression level. this is produced by using a signed rank test to consider the significance of the difference between the pm and mm values for each probeset  <cit> . informally, mas  <dig>  can be seen to return two values, the first, an estimate of transcript concentration, and the second, a measure of how much the software 'believes' the first. of potential confusion is the fact that this value is referred to as the 'detection p-value', and is subsequently used to generate a 'detection call', which flags the transcript as 'present', 'marginal' or 'absent' . in fact, the detection p-value is closer to a reliability score – and the terms 'reliable', 'marginal' and 'unreliable' might be more appropriate. the original approach to data analysis, proposed by the manufacturer, was to use the mas <dig>  expression summary to provide an estimate of transcript concentration, alongside detection calls to filter out unreliable probesets. despite the fact that the expression summary algorithm has been shown to perform poorly on the test datasets described above, many researchers have continued to use this combined strategy to process their data. shippy et al., for example,  <cit> , use detection calls to eliminate unreliable data in a comparison between different array platforms and algorithms.

in the light of these recent findings, it is timely to revisit the performance of mas <dig> , paying particular attention to the use of detection calls. this paper describes a real-time pcr study designed to consider the differences between rma, gcrma and mas <dig> , with and without detection filtering, before revisiting the spike-in datasets described above. rma and gcrma were chosen for the study since they are widely used within the community and their behaviour is generally well understood. comparing mas <dig> to rma allows it to be placed in context alongside other algorithms.

RESULTS
differential expression in replicated cell lines
if both algorithms produced identical fold-changes, all points would be expected to lie on the diagonal. it can be seen that there is significant discrepancy between the fold changes reported by both algorithms, but that the majority of these variations are confined to probesets flagged absent on one or more arrays. when data are stratified by detection call, it can be seen that for probesets flagged present in all samples from both cell lines , rma and mas <dig>  report similar fold changes. for probesets that are flagged absent on one or more arrays, there is disagreement , with rma tending to report lower fold-changes than those found by mas <dig> . the graphs are also asymmetric. there are no probesets with high fold-changes according to rma, but low fold-changes according to mas <dig> . gcrma produced very similar results .

thus it can be seen that when data are stratified by detection call, only  <dig>  +  <dig> =  <dig>  probesets are called differently by mas <dig> and rma when a two fold cutoff is used for selection . although they represent a small proportion of the entire array, these probesets are of disproportionate interest because a substantial number of them are flagged as changing from present to absent by the detection calling algorithm, representing a change in concentration from above to below the levels of detection of the system. it is reasonable to consider the possibility that some of them, at least, are changing from 'on' to 'off'. this is a crucial subset of the data because of their potential to act as switches, invoking novel patterns of activity of phenotype.

validation by real time pcr
in order to further investigate the differences between mas <dig> and rma, a set of probesets were selected for follow up by real time pcr, which was used to provide an independent estimate of the expected 'true' values  <cit> . probesets were from taken from the pp, pa and aa sets, partitioned by fold change and selected to cover a range of fold changes . since the aim was to investigate the similarities and differences in fold change found by the different algorithms, data were stratified by fold change, not by intensity. thus, four sets of probesets were considered: pp probesets that both rma and mas <dig> identified as changing, pa probesets , aa probesets for which mas <dig> reported low confidence in the data and rma reported low fold change, and aa probesets for which rma reported a fold-change greater than two . the  <dig> assays presented here represent pp, pa, aa and aa-rma probesets across a range of fold changes. figure  <dig> shows that for the pp probesets, real time pcr confirms the differential expression found using rma, gcrma and mas <dig>  for all but one probeset . even though the aa probesets were flagged as unreliable by detection call, they still receive a fold change from all three algorithms. all selected probesets had at least 4-fold differential expression according to mas <dig>  and a low fold change reported by rma and gcrma. in every case except one , real time pcr found significant fold changes in the same direction as that found by mas <dig> .

thus, for the  <dig> aa probesets tested, all three algorithms correctly reported no change for one of the probes , and failed to correctly call fold changes for four of them .  <dig> probesets were found to have a > <dig> fold change by rma but were flagged aa by mas <dig>  .  <dig> of these were tested by real time pcr, which found significant fold changes , over all three replicates, for  <dig> of them and low fold changes for  <dig> . for three assays , real time pcr was unable to detect any expression. thus, real time pcr supported the rma and gcrma data for 69% of the aa-rma probesets.

of the  <dig>  pa probesets found to have less than 2-fold change according to rma,  <dig> were pursued further by real time. for these, where gcrma and rma consistently reports lower fold changes than mas <dig> , the mas <dig>  data were supported by the real time pcr results in all  <dig> cases, contradicting the changes reported by the other algorithms. this is interesting not least because the detection calls are identifying these probesets as having poor signal to noise ratio for the absent flagged data .

it is useful to further quantify these results. one common method is to use pearson correlation to provide a similarity metric. however, pearson correlation  must be treated with caution when comparing fold-changes. in particular, because it standardizes expression profiles, it is not appropriate if the actual magnitude of the fold-change is important, rather than simply the pattern of change across a set of samples. this is clearly demonstrated by the uncentred pearson correlations for the mas <dig> and rma data, against the real time pcr results. for the pa probesets in figure  <dig>  r =  <dig>  for mas <dig>  and  <dig>  for rma, even though rma consistently reports much lower fold-changes : rma =  <dig> ; mas <dig> =  <dig> ; log <dig> scale). correlation data for all subgroups can be found in .

an alternate metric is the concordance correlation coefficient  <cit> , rc. it is similar to pearson's correlation, but measures not only the linear correlation between data points, but also how well they match the identity line  <cit> . using rc, correlation is high for the pp probesets for both algorithms: rc =  <dig>  and  <dig>  for mas <dig> and rma, respectively. however, for the pa probesets, rc =  <dig>  for mas <dig>  and  <dig>  for rma, for the aa-rma probesets rc =  <dig>  for mas <dig> and  <dig>  for rma, and for the aa probesets, rc =  <dig>  and  <dig> , respectively. thus the concordance correlation coefficient successfully distinguishes between the cases and provides a useful quantitative metric when fold changes are of importance.

it is also useful to consider these data in terms of true- and false- positives and negatives. in order to do this, a decision must be taken as to how to treat aa flagged data. for the purposes of this analysis, aa flagged probesets that targeted truly differentially expressed transcripts  are simply considered to be false negatives. similarly, aa probesets found to represent unchanging transcripts, or probesets targeting transcripts that were undetectable by real time, are reported as true negatives. the data are summarized in table  <dig> 

tp: true positive. fp: false positive. tn: true negative. fn: false negative. for example, for the pp set, mas <dig> and rma both found  <dig> tps out of a total of  <dig> possible, and made  <dig> incorrect prediction, resulting in  <dig> fp.

it can be seen that the both algorithms behave similarly for the pp and aa probesets, and that the key source of discrepancy is for the pa and aa-rma sets. over these data, mas <dig> made correct predictions for 100% of the pa probesets, and 31% of the aa-rma ones, while rma was correct for 0% of the pa probesets, and 69% of the aa-rma ones.

four of the 'truly changing' aa flagged probesets were considered to be false negatives. it is important to appreciate that by flagging these probesets aa, the algorithm is refraining from making a call rather than explicitly calling the probeset as being unchanging . thus, although mas <dig> fails to make the right call for these data, by reporting 'don't know', it is not getting them wrong either. from this perspective, counting aa probesets as either true- or false-negatives is a somewhat restrictive interpretation, since doing so fails to recognize the algorithm's ability to avoid making a call when the data is not of sufficient quality to warrant it.

latin square data revisited
the high performance of mas <dig>  on these data is perhaps surprising, given that it has previously been reported to perform badly on the latin square datasets described above  <cit> . figures 4a and 4b show fold changes for these data, processed using mas <dig>  and rma, as found by 'affycomp' package in bioconductor  <cit> . figure 4c shows the results of filtering the mas <dig>  data by detection call . much of the low intensity variation is eliminated, significantly reducing the number of false positives  and bringing the data closer into line with rma. this can be quantified using affycomp, a tool designed to score the performance of expression summary algorithms  against a variety of criteria, and to use these scores to provide an unbiased assessment of their relative performance  <cit> . metrics are described in detail in  <cit> , and are summarized briefly in the methods. of the  <dig> metrics reported on the affycomp website, mas <dig> , when filtered as described, marginally out-performs rma on  <dig> of them and comes close on a further  <dig> .

metrics are described in detail in  and briefly in the methods. the last four rows record the number of true and false positives. perfection for the first three rows is  <dig>  and  <dig> for the next  <dig> rows. filtering by detection call significantly improves the performance of mas <dig> on the latin square data.

for these metrics its performance is similar to that of gcrma. for metrics dependent on accurate reporting of fold change, mas <dig>  outperforms rma, and is similar in performance to gcrma.  <dig> of the  <dig> metrics  in affycomp are based on roc curves, generated by considering the number of true positives  for a given number of false positive . for these, it behaves worse than either rma or gcrma. investigation of individual tp and fp rates reveals that the poor performance of mas <dig>  on the roc based metrics is due to a very high fp rate. filtering by detection call, however, does lead to significant improvements: it successfully reduces the number of fps from  <dig>  to  <dig> . when the algorithm is used alongside detection filtering  <cit> , its performance on these latin square data becomes much closer to that of its peers.

thus, when filtered by detection call, mas <dig>  performs well, not only on the spike-in datasets described above, but also on real experimental data in which many transcripts are differentially expressed. further, mas <dig> , when used alongside detection filtering correctly identifies a set of differentially expressed transcripts for which other approaches record low changes. as discussed earlier, these pa probesets are of particular interest because of their potential 'switching' behaviour.

biological validation
in total, there are  <dig> pa probesets with greater than  <dig> fold differential expression according to mas <dig> , but less than 2-fold by rma , and  <dig>  when the mas <dig>  threshold is reduced to 2-fold.

f.c.: log <dig> fold change, ± standard error. t-test: t-test p-score between replicates. mcf <dig>  mcf10a: log <dig> mean expression level. probesets marked in bold type were validated by real time pcr.

space does not permit full consideration of every one; instead we focus on those most highly over-expressed in the mcf <dig> cells. l-threonine dehydrogenase  has been identified as a transcribed pseudogene in humans  <cit> . ptger <dig>  has been shown to be involved in the activation of src signaling via prostaglandin e <dig>   <cit> , and host stromal pge2-ep <dig> signaling appears critical for tumor-associated angiogenesis and tumor growth  <cit> . the mas <dig>  data shows ptger <dig> to be upregulated in mcf <dig> w.r.t. mcf10a. c5orf <dig> has been identified as a putative tumour suppressor  <cit> , whilst znf <dig> has been shown, in vitro, using ewing sarcoma derived ew- <dig> cells, to be highly expressed in proliferating cells and down regulated in cells induced to differentiate  <cit> . treatment of ew- <dig> cells with antisense oligonucleotides complementary to znf <dig> mrna was shown to induce morphological differentiation and growth arrest, suggesting a role for znf <dig> in the maintenance of es cells in an undifferentiated state  <cit> . the mas <dig>  data shows znf <dig> to be over expressed in mcf <dig> cells with respect to mcf10a. over expression of znf <dig>  has been shown to lead to elevated smad <dig> expression in c2c <dig> cells  <cit> . smad <dig> is known to be an inhibitor of the bmp signalling pathway and over expression of both oaz and smad <dig> have been shown in pulmonary smooth muscle cells to result in inhibition of bmp <dig> mediated apoptosis  <cit> . both znf <dig> and smad <dig> are found to be over expressed in mcf <dig> w.r.t. mcf10a, and both are flagged as being present in mcf <dig>  absent in mcf10a. calcitonin receptor expression has previously been reported in mcf <dig> cell lines <cit>  and wnt7b has been previously shown to be upregulated in mcf <dig>  <cit> . thus many of pa genes identified by mas <dig>  show behaviour in agreement with previous reports in the literature.

discussion
when a simple fold-change threshold is used to define differentially expressed genes, the mas <dig>  expression summary algorithm yields a significant number of false positives, as illustrated in figure 4b. this is, at least in part, because even if the signal from both sets of replicates is low, the resultant fold change can still be high. however, as shown here, detection calls can be used to successfully filter mas <dig>  data and remove the vast majority of false positives. this is also in keeping with a recent study that found a significant improvement in false discovery rate following pre-filtering by detection call  <cit> .

detection calls also have significant utility when considering transcripts with expression levels close to the limits of detection of the platform. by selecting probesets changing consistently from present to absent, it is possible to identify a small but significant set of transcripts that have large fold changes, are positively validated by real time pcr, are consistent with previous reports in the literature, but are not reported as changing by other approaches. since detection calls aim to identify probesets with poor signal to noise ratio, it is reasonable to expect that the fold-changes calculated for these probesets will be unreliable. the relatively high degree of correspondence, for the pa probesets, between the mas <dig> data and the real time results suggests that their signal to noise ratio is still high enough to provide a relatively stable calculation of fold change. the actual magnitude of fold changes calculated using absent flagged data should, however, be treated with an appropriate degree of caution, and validation by real time pcr is clearly advisable.

in the analyses of both the real time pcr and latin square datasets described above, probesets flagged aa were treated in the same way as those that were found to be unchanging. a consequence of this is that they were reported as false negatives if subsequent validation found their target transcripts to be differentially expressed. since the aa flag is better considered as a statement of uncertainty rather than of no-change, this is a stringent interpretation of the data. it is important therefore to note that every real-time validated probesets for which mas <dig> was able to report a reliable change was positively confirmed; where discrepancies arose they were restricted to aa probesets for which, by definition, the algorithm was unable to make a reliable call.

irrespective of how false negatives are defined, no such issues arise in the definition of true- and false-positives. for these, both algorithms performed similarly, each correctly predicting changes for 8/ <dig> of the pp probesets, and both doing well on the pa and aa-rma set . note that for both algorithms, the probesets with the largest fold-changes were tested. the low-throughput nature of real time pcr meant that it was not possible to systematically explore the entire aa-rma and pa subsets of the data, by, for example generating a random sampling of these data and validating these by real time. for this reason, it was not possible to define a threshold below which reported changes were unreliable, and attention must also be paid to the possibility that regression towards the mean might have a certain influence on the correlation coefficients generated for each algorithm  <cit> . what the study does show, however, is that identifying pa probesets with large fold-changes is a useful strategy for finding differentially expressed transcripts that are not found by other approaches. overall, these data provide substantial support in favour of the use of mas <dig>  filtered by detection call, as a rational alternative for identifying differentially expressed transcripts from affymetrix microarray data.

CONCLUSIONS
the separation of the data into three sets  based on detection call offers an alternative strategy for data analysis that has the potential to reveal additional transcripts, within the pa category, that the other approaches do not find. if a relatively high false positive rate is acceptable  then it also appears reasonable to include probesets found to have a fold change > <dig> by rma and confirmed by mas <dig>  even if these data are flagged consistently unreliable by detection call.

both the mas <dig>  expression summary and detection calling algorithms have been criticized, not only for their poor performance on the latin square data described above, but also for the lack of statistical justification underpinning them. indeed, the expression summary algorithm relies on a relatively ad hoc treatment of situations where pm probes are of lower intensity than their mm counterparts. it is interesting, therefore, that despite these reservations, both algorithms perform well in practice. this underlines the importance of using real, representative datasets to assess the performance of different algorithms.

finally, a feature of the mas <dig>  algorithm is its low computational requirements. mas <dig>  considers data on a per-array basis, placing much lower demands on memory than other approaches that must access the entire dataset at once. as microarray datasets are assembled that contain thousands of arrays, computationally frugal approaches such as mas <dig>  become increasingly appealing. these data provide evidence that such advantages may not have to be taken at the expense of biological precision.

