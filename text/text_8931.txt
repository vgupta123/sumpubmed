BACKGROUND
inversions have long been known to play an important role in chromosomal evolution  <cit> . indeed, large inversions are thought to contribute to speciation through reproductive isolation caused by reduced recombination between normal and inverted chromosomes  <cit> . inversions of a wide range of sizes are abundant in mammalian lineages  <cit> . additionally, extensive study of inversions in drosophila revealed that inversions can leave genetic signatures, such as reduced nucleotide variation, within the inverted region  <cit> . more recently, many polymorphic inversions have also been found in humans  <cit> . a number of these have functional consequences; polymorphic inversions have been associated with genetic disorders  <cit> , complex disorders such as asthma  <cit>  and even positive selection  <cit> .

recent resequencing efforts of many human genomes continue to reveal the prevalence of structural variation in humans  <cit> . however, despite decreases in the cost of sequencing, genotyping microarrays remains the most cost-effective technology for analyzing entire genomes on thousands of individuals. moreover, inversions have been traditionally difficult to study using experimental techniques. the typical presence of large inverted repeats at the breakpoints is a major challenge for their detection even with current next-generation sequencing techniques. while only few inversions  have been experimentally validated  <cit> , a few studies have scanned the whole genome providing experimental evidence for a number of candidate regions. for example, levy and colleagues determined inverted regions by the whole genome assembly of one subject  <cit> , and kidd el al. used fosmid paired-end mapping in nine individuals  <cit> . as such, the ability to accurately predict new inversions and infer their status on large number of subjects would provide a valuable tool for clinical and evolutionary studies of human populations.

previous studies have used haplotype tagging to indirectly infer which chromosomes are most likely to have an inversion, assuming recombination suppression in inverted heterozygous. for instance, steffanson et al.  <cit>  showed that an inversion within 17q <dig> in the european population can be tagged with two different haplotype groups , each related to a polymorphic variant of the mapt gene. although haplotype tagging is performed on large groups, it is suitable for regions known to have inversions and known to exhibit divergence between the two arrangements. three studies  <cit> , for instance, identified two haplotype groups within a region containing the known 17q <dig> and 8p <dig> inversions, and then experimentally validated the tagging on selected samples of the hapmap population. taken together, this small group of subjects can be used to validate newly developed methods that determine the status of inversions in individuals.

using a different approach, based on differences in linkage between groups of snps, two other methods have been developed to discover the presence of inversions across the genome  <cit> . bansal et al.  <cit>  used differences in linkage disequilibrium  to determine regions likely to be inverted. however, their method requires the human reference to contain the minor allele, and does not predict which chromosomes in the population are most likely to have the inversion; a factor that is essential for association studies. more recently, sindi and raphael  <cit>  developed a probabilistic method that models the population as a mixture of normal and inverted haplotypes, and thus had increased power to detect inversions of lower frequency. although their method accurately predicts inversion frequencies, it did not yield an accurate classification of individuals into normal and inverted subpopulations. the computationally intensive search of both methods have, in particular, failed to identify inversions like the one within 17q <dig> in the ceu population, for which a clear extended ld has been shown  <cit> . in addition, both methods were developed for haplotype  data only.

one way to analyze genotype data, using this method, is to phase the entire genome and then apply it to the resulting haplotypes. this procedure is computationally demanding. for instance, it has been reported that compiled software like fastphase  <cit>  can take up to  <dig> h to analyze  <dig> subjects in a  <dig>  snps chromosome . therefore, a method that directly analyzes genotypes, incorporating the limited phasing required by inversion detection, can substantially reduce this computational load and allow the complete implementation of the methodology in a single software tool to be used in standard up-to-date machines.

in this work, we propose a new methodology to  efficiently detect inversions across the genome by directly using genotype data and  accurately classify individuals in the population according to inversion status. in addition, our generalization of the inversion model for haplotypes  <cit> , as a computational technique, allows us to treat the different problem of phasing haplotype blocks separated at any distance. our new application of the inversion model, within the analysis of polymorphic inversion from genotypes, increases the applicability of the method to current gwas, and enhances its usability by a higher computational efficiency. we provide an efficient implementation of the novel analysis of genotypes, and the new classification and search methods in the r package inversion, freely available through bioconductor  <cit>  . we also include a computationally improved version of the previous haplotype model, and the use of the bayesian information criterion  to gather statistical evidence from neighboring regions.

both prior ld studies  <cit>  tested their methods by constructing "artificial" inversions by reversing the order of snps in phased haplotypes from hapmap. we provide a more rigorous test of our method by employing a recent software tool, invertfregene  <cit> , that utilizes coalescent theory and suppression of recombination between inverted and normal chromosomes to produce artificial haplotype and genotype data. lastly, we apply our method to hapmap phase iii data, where we compare the analysis of genotypes with that for haplotypes, assess the our classification accuracy in two validated inversions and search the whole genome for inversion signals.

methods
the inversion model
the inversion model was first proposed by sindi et al.  <dig>  <cit>  to predict inversion polymorphisms from phased data. here we give a general formulation that allows us, in addition, to solve the distinct problem of phasing genotype data across inversion breakpoints, and thus reduce the computation load of phasing the whole genome.

we are given m independent observations of four random variables b <dig>  b <dig>  b <dig>  and b <dig>  ordered according to location in the reference genome. we are interested in assessing the likelihood of an inversion in the population with one breakpoint between markers b <dig> and b <dig> and the other breakpoint between markers b <dig> and b <dig>  in the case an inversion exists, we expect to observe more than one subject i for which the formation of the two pairs , b2) and , b4) is less probable than that of , b3) and , b4), within the population sample . we denote the joint random variables as b <dig> , b <dig> , b <dig>  and b <dig>  respectively.

in a sample where no individual is inverted, we assume that the probability pfwd of the observed values b <dig>  b <dig>  b <dig> and b <dig> at xi can be factored as the product between the probability of the pairs , b2) and , b4)

  pn <dig> )×pn <dig> ). 

where n <dig>  and n <dig>  indicate the respective probabilities of observations for b <dig>  and b <dig> . the likelihood of all the m independent observations is then

  l0= ∏k=1mpfwd. 

on the other hand, in a population where all observations are inverted, the probability pinv of obtaining the specific values of the xi observation is

  pr <dig> )×pr <dig> ), 

where, as before, r <dig>  and r <dig>  correspond to the probabilities of observations for b <dig>  and b <dig> .

in a real population sample, where we expect a mixture of forward and inverted individuals with mixture frequency π. in addition, given appropriate probabilities for all four joint random variables, f <dig> , f <dig>  for the forward subpopulation and r <dig> , r <dig>  for the inverted subpopulation, and ω = , the probability of observing the values of b <dig>  b <dig>  b <dig> and b <dig> for an arbitrary xi is

  pmixture=pfwd+πpinv. 

with population sample likelihood

  l1= ∏k=1mpmixture. 

an important quantity in predicting the inversion status of an individual is the relative probability that the individual belongs to the forward subpopulation:

  r <dig> i=pfwdpfwd+pinv, 

this is also called the responsibility to the forward model. similarly, the responsibility of an individual to the inversion model, r <dig> i =  <dig> - r <dig> i.

we test the hypothesis that π =  <dig>  vs. π > <dig>  with a maximum likelihood approach. we maximize the likelihood of the data under each model; that is, for the null model we use the empirical distribution of allele frequencies for the null model and for the alternative model we select the allele frequencies and inversion frequency π using the expectation-maximization  algorithm for mixtures of probability distributions. the decision to reject the null model  for the alternative model is based on a model selection test. in this work, we utilize the bayesian information criterion  to both identify candidate inversions and classify individuals carrying the polymorphic inversions.

inversion model for genotype data
in the analysis of genotype data, we apply the inversion model in two steps. in the first step, we use the inversion model to phase and pair haplotype blocks around potential breakpoints. this approach allows flexibility to phase two haplotype blocks at any distance, without phasing the whole genome or constantly re-phasing regions, when one of the breakpoints is changed. this use of block phasing is a novel application of the inversion model. the second step is the original application of the model  <cit>  to identify which individuals are likely to have a genetic inversion.

in this work, we define a candidate breakpoint as a pair of consecutive snps. a segment tested for an inversion is thus defined by two candidate breakpoints . we flank the left and right candidate breakpoints by two blocks of n snps each, and perform local haplotype phasing with haplo.stats  <cit> . as a result, an individual i has two haplotypes, l <dig> and l <dig> of 2n snps each, containing the left breakpoint in the middle, and two 2n snps haplotypes r <dig> and r <dig>  containing the right breakpoint in the middle. the first application of the inversion model is to sort out the chromosome pairing of the containing blocks, that is, we set b <dig> = l <dig>  b <dig> = r <dig>  b <dig> = r <dig>  b <dig> = l <dig> and m = ns  in the inversion model. the responsibilities for the alternative model tell us if the pairing of  in one chromosome and   in the other chromosome is more  likely than the pairing  and  , for each subject in the sample. this first process phases the genotype data between any pair of blocks, surrounding candidate breakpoints.

the second application of the inversion model is to determine the presence of genetic inversions on phased data, as originally proposed in sindi and raphael  <dig>  <cit> . in total, we have nc =  haplotype blocks phased by the former pairing. we first aggregate the data into two variables one for each breakpoint, hl) corresponds to the haplotype of subject i and chromosome j containing the left breakpoint, and hr) to the haplotype of subject i and chromosome j containing the right breakpoint. we next split the left haplotype into two n - snps blocks  = hl each of which flank the potential left breakpoint, and  = hr each of which flank the right breakpoint. in the inversion model, we set b <dig> = hll, b <dig> = hlr, b <dig> = hrl, b <dig> = hrr and m = nc, as the total number of chromosomes in the sample. the responsibilities of this model now determine for which chromosomes the pairings  and  are more  likely than the pairings  and . that is, the model determines which chromosomes are likely to be inverted between the left and right breakpoints considered.

an important consideration in our analysis is whether the initial phasing step itself is confounded by the presence of an inversion. thus, in the first step of our analysis, we perform two other  local haplotyping strategies. in the first strategy, we locally haplotype each n-snp flanking block separately with haplo.stats and then use the inversion model to phase the internal flanking blocks, i.e. those assumed to be within the inversion segment. finally we use the model again to phase the internal haplotype with each external block. a second alternative strategy is to perform the local haplotyping with haplo.stats once on the surrounding blocks following the forward population and twice following the inverted population, leaving two distinct haplotype data for each population. we compare the accuracy of each phasing strategy in the prediction of inversions on simulated data and contrast them with the accuracy of the prediction for already phased data.

inversion detection and subject classification
in addition to providing a novel method to analyze genotype data for polymorphic inversions directly, our work aims at improving the efficiency of detecting inversions, and the accuracy of classifying individuals with respect to inversion status.

previous ld methods  <cit>  considered a potential breakpoint between every pair of adjacent snps in the genome with sufficient diversity and physical distance between breakpoints. thus, the total number of segments tested for inversions was very large, o where n corresponds to the number of candidate breakpoints or snps. to reduce the computational load, we decrease the number of regions tested by using a sliding window. we tested our approach on simulated inversions from invertfregene  <cit> , and found our model still correctly identifies an inversion if the candidate segment tested is contained within the real inversion sequence and "large enough" compared to the real inversion. consequently, we scan the chromosome with trial segments of fixed length , as probes for detecting inversions with comparable length. we then reconstruct the true inversion by considering all trial segments with sufficiently large bayesian information criterion . this simplification massively reduces the number of computations to o.

in addition, prior methods for haplotype data were unable to successfully identify individuals carrying the inversion, a necessity for genome association studies. we develop an accurate classification method based on the responsibility of each individual to the normal or inverted subpopulation in overlapping windows. for a fixed window w we determine the responsibility of chromosome i, to the forward model r <dig> iw. sindi and raphael  <cit>  attempted to classify individuals based on their dominant responsibility, normal if r <dig> iw≥ <dig>  and inverted otherwise; however, this did not yield a useful classifier because the classification from any single instance of the mixture model was poor. we find that combining classifications from adjacent, overlapping windows yields a substantial improvement in classification accuracy with the true inversion. more generally, we estimate the responsibility of individual i to the inversion i by a majority vote overall overlapping segments where bic exceeds a given threshold bic > tb:

  r <dig> ii=∑whh∑wh, 

where h is the step heaviside function, h =  <dig> when z > <dig> and  <dig> otherwise. for haplotype data, we classify a chromosome i as inverted when r <dig> ki< <dig>  for a particular value of tb. for genotype data, we classify each individual as homozygous for the reference orientation, heterozygous for the inversion or homozygous for the inversion, depending on the classification obtained from the responsibilities of both chromosomes. we define the classification accuracy of our method as the number of individuals with correctly identified inversion status . in the simulation results below, we compare the classification accuracy of our method to the true known categorization of individuals as function of tb. in practice, our classification accuracy increases with tb.

datasets
we studied the power of our method, implemented as the r package inversion, to detect inversions on both haplotype and genotype data by analyzing previously known and simulated polymorphic inversions.

first, we applied our method to simulated haplotypes and genotypes to asses our performance at both detecting inversions and classifying individuals into normal and inverted subpopulations. using recently developed software, invertfregene  <cit> , we simulated inversions of varying lengths  and varying frequencies π =  <dig> - 90% in a populations of  <dig>  individuals . the software provided haplotypes, genotypes and inversion status of each chromosome in the population. parameters used in running the software, such as number of generations to achieve equilibrium, and rates of recombination and mutation, were taken without change from  <cit> . in particular, the segments simulated by invertfregne have a median fraction of heterozygous of  <dig>  and overall snp density of  <dig>  kbase/snp on a  <dig> mb segment.

to check the performance of our method on real data, we used the snp data from hapmap phase iii , totalling  <dig>  m snps on  <dig> individuals from  <dig> different populations. as a first step, we analyzed both haplotype and ceu and yri populations from chromosomes  <dig> and  <dig>  where well characterized polymorphic inversions have been found. next, we performed a region of interest analysis, where we did a detailed search around two previously identified inversions , and classified subjects for all  <dig> hapmap iii populations by predicted inversion status. we then validated the inversion genotypes on previously reported individuals. finally, for the more demanding task of scanning the whole genome, we used the snp genotype data of the joint ceu+yri population . significant regions were compared with a set of previously reported inversions. we used a first set of  <dig> well characterized and experimentally validated inversions, and then a second set of putative inversions predicted by whole genome assembly comparison  <cit>  or paired-end mapping experiments  <cit> .

implementation
some technical considerations were made in the implementation of the previously described models in the inversion r package. in analyzing genotypes, we removed snps with missing values for more than 10% of the individuals. for the remaining snps, missing values were imputed during local phasing with haplo.stats, we selected haplotypes with the highest posterior probability at each point, and did not considered the propagation of this error into the inversion model. to further limit the regions tested, we only considered breakpoints between snps where at least one had minor allele frequency ≥ 10%.

for both mixture models, we used the empirical distribution of allele frequencies as the initial condition for the em algorithm. we conjectured that this choice would be appropriate to locate the global minimum, and verified this conjecture on simulated inversions by running the em algorithm with randomly chosen initial conditions.

RESULTS
simulated data
characterization of a single inversion
we first ran our inversion model for the genotype data produced by invertfregene  <cit>  on one inversion. using a fixed window size of  <dig>  mb, and  <dig> snps flanking each potential breakpoint, inversion successfully detected the true inversion between  <dig>  -  <dig>  mb, see figure  <dig>  as expected, many segments overlapping the true inversion favor the alternative  model over null model.

because we know which chromosomes carry the inversion, we directly assess our classification accuracy . we show the median classification accuracy as function of tb  for a run of  <dig> invertfregene simulations. note that classifications for haplotype data are at the chromosome level and for genotype data are at the subject level. for some cases, using low values of tb our method identified extra or spurious regions of interest; however, in general as tb increased, the classification improved.

in figure  <dig>  we show the median classification accuracy for windows overlapping the inversion simulated in figure  <dig>  for each candidate window, we determined the responsibility of each individual, r <dig> kw, and computed the classification of individuals for increasing values of the bic threshold tb. for both haplotype and genotype data, our ability to successfully classify individuals improves with increasing threshold tb. reduced accuracy for genotype data, compared to haplotype data, is expected because of errors accumulating from local phasing and incorrect pairing of local haplotypes. in this example, for haplotype data, high accuracy is quickly obtained with perfect classification for bic ~  <dig>  for genotype data we show the results of three local phasing strategies. we see that phasings based on the forward population and internal flanking blocks have comparable accuracies which are optimized at bic ~  <dig>  the strategy of haplotyping the forward and inverted populations separately can be highly accurate  but is consistently lower than the other two. this can be due to the increased amount of computation this strategy requires. overall, we found no accuracy improvement over our initial simplified phasing strategy.

decreased accuracies for both genotype and haplotype data for the highest tb values may be attributed to fewer observations. indeed, the decay of accuracy at highest tb depicts the classification difficulties from prior methods  <cit>  that used only the single most likely predicted region to classify individuals. overall, our weighted method of classification based on bic values is more robust than selecting a classification based on a single segment with likelihood ratio of lowest p-value.

classification and detection performance
we first analyzed the ability of our model to determine simulated inversions on haplotype data with five different snp densities, matching some of those in current illumina chip technologies. figure  <dig> shows the classification accuracy of inversion status for the inversions specified in the previous sections. we can see that our method performs well at all the densities studied, with more accuracy at higher densities. at the level of the  <dig> k arrays we can still achieve high chromosome classification accuracy.

to assess the performance of our method to detect inversions and classify individuals in genotype data, we simulated samples varying the length of the inversion and its population frequency. we ran invertfregene  <dig> times for each condition, and computed classification accuracy for different tb values , segmental sensitivity of detection  and segmental false discovery rate . we used a window size of 60% of the inversion length and flanking blocks of  <dig> snps . a total a  <dig> ×  <dig> ×  <dig> =  <dig> simulations were run. figure  <dig> shows the average accuracy of each subject's inversion genotype classification for  <dig> different lengths, and a population frequency of 60%. at this frequency, high accuracies > <dig>  are achieved for lengths greater than  <dig>  mb when tb is large enough. in particular, our method is most accurate for larger inversions.

we also studied the classification accuracy at detecting inversions of all frequencies in relation to the age of the inversion, as treated in invertfregene. figure  <dig> shows the age of the inversion as function of maximum accuracy across tb for each simulated case. we see that our method achieves highest accuracy for larger lengths and at a wide range of frequencies. our method is less accurate at identifying older inversions with frequencies . particularly, we observe that inversions at 90% frequency heavily cluster in a low predictive range, indicating a critical phenomena in the simulations for frequency increments at high values.

additional file  <dig>  figures s <dig> and s <dig>  illustrates the segmental sensitivity and false discovery rate  for these simulations, showing the ability of the method to accurately identify the region containing the inversion. we see that while we have high sensitivity in a large range of bic thresholds , the fdr decreases with increasing tb. therefore, all the inversion lengths studied are detectable, and higher accuracy is achieved for inversions > <dig> mb. to assess false inversion detection, we ran simulations  with no inversions and scanned them with three different window sizes . in each case we identified the top 2% tb quantiles for which at least one region of interest  was found. histograms of for all three scans are shown in additional file  <dig>  figure s <dig>  in particular, we find that, in samples of  <dig> subjects, an fdr of  <dig>  is achieved at tb =  <dig> for scans of  <dig> mb, tb =  <dig> for  <dig> mb and tb =  <dig> for  <dig> mb.

hapmap data
genotype and haplotype  data
we analyzed the ceu and yri populations from hapmap phase iii. we initially performed a scan on chromosome  <dig> for the ceu, and chromosome  <dig> for the ceu and yri populations, to compare the results obtained for genotype and haplotype  data. we used two types of genotype data; the original genotypes before phasing and reconstructed genotypes from the phased haplotypes, with the encoding of  <dig>   <dig> and  <dig>  we examined chromosomes  <dig> and  <dig> with two window sizes , and used a bic threshold of tb =  <dig>  we computed the inversion frequency of the estimated inversion from the majority vote for each chromosome in the sample.

the segments where identified scanning the whole chromosome with window sizes  <dig>  mb and  <dig>  mb. overlapping trial segments with bic >  <dig> where selected for the final classification of chromosomes and to set the limits of the inverted sequences. keys: lbpmin: minimum left breakpoint coordinate, lbpmax: maximum left breakpoint, rbpmin: minimum right breakpoint, rbpmax: maximum right breakpoint, maxbic: maximum bic, invfreq: frequency of the inversion within the population, ns: number of overlapping segments in the inversion.

we analyzed chromosome  <dig> for both the ceu and yri populations  separately. we predict  <dig> inversions in the yri population and  <dig> in the ceu population. interestingly, the  <dig> regions in the yri population are very similar to  <dig> of the  <dig> predictions in the ceu population, but with fewer overlapping sliding windows and different predicted inversion frequencies. importantly, the remaining inversion predicted in the ceu population corresponds to a known inversion at 17q <dig>  ≈  <dig>  -  <dig>  mb with inversion frequency of 20-25% in mixed european populations, and absent from the yri hapmap sample  <cit> . to ensure the specificity of this predicted inversion to the ceu population, we reanalyzed the region  <dig> -  <dig> mb in greater detail by considering all possible segments with length ≥  <dig> mb. as expected, we did not find an inversion in the yri population, but did obtain improved information on the inversion location in the ceu population: left breakpoint = , right breakpoint = , maximum bic =  <dig> , inversion frequency =  <dig> , number of overlapping windows =  <dig>  note that this inversion was not identified by prior studies using nucleotide variation data  <cit> .

one of the ceu predictions corresponds to a known inversion at 17q <dig>  and was also found with window size  <dig> mb . consistent with experimental evidence this is a ceu specific inversion, no inversions where predicted in the yri population in this region with any window size.

subject classification for inversions within 17q <dig> and 8p23
to accurately classify individuals according to inversion status for two known inversions  we preformed extensive searches near reported breakpoints. in both cases, we obtain high accuracy at classifying individuals with known inversion status.

first, we performed an extensive search on the region between 39- <dig> mb in the chromosome  <dig> for the complete  <dig> hapmap iii populations, with tb =  <dig>  the region identified as the potential inversion had left breakpoint = , right breakpoint = , maximum bic =  <dig> , inversion frequency =  <dig>  and was identified by  <dig> overlapping windows in the scan. additional file  <dig>  figure s <dig>  shows that windows favoring the inversion model  flank gaps in the snp distribution. these gaps correspond to the segmental duplications which have been suggested to give rise to the inversion sequence that sits between them. we computed the classification of each chromosome in the sample with a bic > <dig> that was the minimum bic for which the classification was optimal for the subjects with known inversion status  <cit> . we correctly classified all  <dig> samples with known inversion status  . that is, ceu subjects na <dig>  na <dig>  na <dig> were reported as heterozygous for the inversion and all other subjects as non-inverted homozygous. the inversion status of subjects from all  <dig> populations is shown in table  <dig>  we see that the chromosomal incidence of the inversion for the ceu in the joint population analysis is 26% consistent with the single population analysis. finally, the cross tabulation in table  <dig> between the inversion and the "rs1800547" snp genotypes further validates the tagging of our inversion inference with this snp , as expected from their known relation to the h1/h <dig> haplotypes  <cit> .

hom: non-inverted homozygous, het: inverted heterozygous, and invhom: inverted homozygous. the chromosomal frequency of the inversion is highest in the european populations , see last row of the table. population key: asw: african ancestry in southwest usa, ceu: utah residents with northern and western european ancestry, chb: han chinese in beijing, chd: chinese in metropolitan denver, gih: gujarati indians in houston, jpt: japanese in tokyo, lwk: luhya in webuye, mxl: mexican ancestry in los angeles, mkk: maasai in kinyawa, tsi: toscani, yri: yoruba in ibadan.

the h <dig> and h <dig> haplotypes have been traditionally associated to the inversion status in the 17q <dig> inversion. from those haplotypes the snp "rs1800547" from the mapt gene has been used to tag the inversion in 17q <dig>  <cit> . as expected, our classification of individuals from all  <dig> hapmap populations agrees well with the their status for this snp.

we next studied the more challenging classification of the recurrent inversion at 8p <dig>  <cit> , for which no significant signal was obtained from the whole genome scan on the ceu+yri sample. we performed an detailed search between 6- <dig> mb of chromosome  <dig>  and detected a signal  within the inversion sequence. the region identified was between left breakpoint= and right breakpoint=, see additional file  <dig>  figure s <dig>  we compared our classification with the true inversion status reported for  <dig> of the individuals from  <dig> of the  <dig> hapmap populations. . we found that while the exact match of the subject genotypes is , the subject-wise identification of an inversion presence is 88%. population-wise, we see that the ceu are the best predicted with 91% accuracy, while the yri sample has only 36% accuracy. in the experimental studies all  <dig> yri subjects have an inversion,  <dig> of which are inversion heterozygous. none of the  <dig> jpt subjects in the experimental validation group have an inversion, and inversion classify them accordingly. however, we do not correctly identify any of the  <dig> chb subjects carrying the inversion.

genome-wide scan
lastly, we scanned the whole genome of the combined ceu and yri populations of hapmap iii with three window sizes  . across all chromosomes, we found  <dig> candidate regions for inversions from overlapping windows with tb =  <dig>  in additional file  <dig>  table s <dig>  we report the outer limits of the left and right break points of the inversions found. a number of inversions detected with window size of  <dig> mb are also detected with lower sizes.

although the median size of inversion reported by kidd and colleagues  <dig> is  <dig>  mb, 23% of those segments are at least above  <dig>  mb, and thus are potentially detectable with our method. we find a total of  <dig> inversions  that overlap either those found by kidd et al.  <cit>  on nine subjects or by levy and colleagues  <cit>  on one subject, providing additional evidence of their existence. a higher proportion,  <dig> inversions  are at least  <dig> mb distance from a reported inversion.

the table shows the details of  <dig> experimentally validated autosomic inversions, and their detection by a genome-wide scan on genotype data performed by inversion.

discussion
we proposed and implemented a method for detection of polymorphic inversions and classification of individuals into normal and inverted sub-populations for both phased haplotype and genotype data. we demonstrated the ability of our method to successfully detect inversions and classify individuals on simulations and showed how the performance of the method is impacted by the length and frequency of the inversion, snp density, and the value of tb, the bic threshold. our findings demonstrate that genotype data can be used to detect inversions, although power for detection remains greater for haplotype data. other approaches can be developed to perform inversion detection simultaneously with local haplotyping. in this work, we opted for a two-step strategy, which allows us to directly compare the impact of local haplotyping to inversion finding. as shown in figure  <dig>  the applicability of our approach is demonstrated by our performance tests showing, in particular, the small drop in accuracy we pay for treating genotype data, as compared to haplotype data.

our formulation has several advantages compared to previously published methods to detect polymorphic inversions from nucleotide variation data  <cit> . our work represents the first method capable of analyzing both genotype and haplotype data. importantly, ours is the first ld based method to accurately classify individuals into normal and inverted subpopulations. by leveraging information from adjacent windows, our method is able to partition individuals into normal and inverted categories with high accuracy. finally, our implementation is computationally efficient. our use of a fixed size sliding-window to analyze chromosomes greatly improves upon the search efficiency of previous methods. in addition, a relevant computational improvement is achieved by the local phasing procedure of the genotype model. we tested the local phasing step of our algorithm on  <dig> ceus  in a section of the chromosome  <dig>  with  <dig>  snps. using a  <dig>  ghz intel core  <dig> duo,  <dig> gb ram the analysis took only  <dig> minutes, which is ~  <dig> times faster than phasing the whole segment with fastphase. this shows that the load of a complete phasing of the data can be greatly reduced in the detection of genetic inversions. the overall efficiency of our method is an attractive feature for the analysis of already available data.

we illustrated the high accuracy  of our method over a wide range of inversion frequencies in principled-simulated data . we had difficulties successfully classifying individuals from invertfregene populations with inversion frequencies >80%. note that in this scenario, high frequency inversions are affected by the age of the inversion and not by a simple change of reference genome. within invertfregene, high frequency inversions tend to be older inversions, which may then present a higher within-population variability that can impact our predictions. however, the sudden drop of accuracy at high frequencies seems to indicate an additional critical behavior of the simulations at this range. thus, in relation to the age of the inversion, the parameters used to run invertfregene may have not been optimized for this scenario.

in relation to real inversions, we show that the inversion package can be used to identify the inversion genotypes of subjects within the region 17q <dig>  the high accuracies achieved for this inversion and the invertfregene simulations suggest that our method is most powerful when haplotype divergence is present. we also studied the inversion within 8p <dig>  despite of not detecting an inversion in this region in a genome-wide scan; with an extensive search, we were able to detect a signal  and classify the subjects of the ceu population to a high degree. consistently with bosh et al.  <dig>  we saw that the most accurate predictions are made for the ceu population only. the 8p <dig> region has shown a number of complexities that might affect our inference to all hapmap groups. it has been shown that the region is unstable, showing mosiac rearrangements in its vicinity  <cit> . in addition, there is a lack of long distance ld, expected for two divergent haplotypes associated to each inverted status. antonacci and colleagues suggested that this can be due to multiple inversion events. in addition, deng et al.  <dig> showed that the ceu population has an extended linkage disequilibrium in the region greater than that for the cbh+jpt and yri populations. it is possible that our method particularly favors inversions with less variability within populations. greater variability of populations within the inverted region could reduce our classification power because large groups of identical haoplotypes are harder to form. further improvements of our method in this direction could improve performance.

an important practical consideration when using inversion is the threshold bic value used to perform inversion genotyping. larger values of bic  do not always mean higher accuracy. as above, we recommend careful benchmarking of threshold bic values for assessing subject classification. in the case of inferences in large populations and when experimental data is available on few subjects, a suitable threshold can be set for the classification that maximizes the inference on those subjects. we use this approach in our analysis of the 17q <dig> region, where we conducted a detailed search in a region known to have the inversion. when experimental data is not available, the stability of inversion allele for each subject could be studied for different bic thresholds, drawing more confidence from those individuals that are consistently classified.

on a genome scale, initial scans can be conducted on several window sizes to identify regions of interest with positive bic values where, as suggested by our simulations, we have high sensitivity. in our whole genome search for the ceu+yri populations, we found recurrent inversions at different window sizes, which increases the confidence in the findings. this shows that using only three windows sizes,  <dig>  -  <dig>  -  <dig> mb, can detect inversions from  <dig>  mb to ~  <dig> mb with enrichment for detecting inversions with length  <dig>  -  <dig>  mb since more than one window have power to detect inversions in this range. the identification of recurrent inversions with different window sizes could also be used as an additional check to reduce false discoveries. in addition, these results suggest that scans with a few window sizes and as large a value of l as computationally feasible should be sufficient for a complete search for inversion signals in a given chromosome. note that the window size is a probe for the detection of the inversion, thus it should be considered a function of the length of inversions to be detected. the accuracy of our method increases with higher snp density. at the  <dig> k array density, our method can still achieve high classification accuracy. however, due to the high variability of the accuracy estimates, we recommend using imputed data in this case. to have a more accurate measure of the subject classification and length of the inversion, an extensive search for all possible lengths around the regions of interest can then be conducted.

experimental information about the existence of inversions and their status in a sample of subjects is limited, constraining an exhaustive evaluation of the true positive and negative rates of our methodology with validated inversions. inversions are difficult to characterize even with the newest sequencing data. in the study of structural variants in  <dig> genomes, durbin et al.  <dig>  <cit>  did not report inversions. large inverted repeats at the breakpoints is a current obstacle for inversion detection using next generation sequencing data, in addition to the computational capacity to analyze hundreds of individuals. however, when inversion detection algorithms for sequence data are available, a necessary future evaluation of our methodology should be performed against this new technology.

CONCLUSIONS
in this article, we have presented a methodology to detect inversion polymorphisms using nucleotide variation data from snp micro-arrays. the method, based on ld differences across break points, is able to classify individuals into their inversion genotype status, allowing the gathering of population-based evidence of known inversions. in addition, using a computationally efficient scan across the genome, it provides evidence on new candidate regions that might be present in the population from which genotyped data is collected.

authors' contributions
ac devised the application of the inversion model to genotypes, work in the implementation of the software and co-wrote the manuscript, sss formulated and implemented the inversion model for haplotypes, performed simulations, and co-wrote the manuscript, bjr work in the formulation of the inversion model and revised the manuscript, mc guided the analysis on real data, tested the model and revised the manuscript, jrg contributed to the implementation of the model, analysis strategies, revised the manuscript and coordinated the research. all authors read and approved the final manuscript.

supplementary material
additional file 1
additional figures s <dig>  s <dig>  s <dig>  s <dig>  s <dig> and tables s <dig>  s <dig>  s <dig>  s <dig> 

click here for file

 acknowledgements
we would like to thank clive hoggart for providing us with a version of invertfregene that outputs the classification of each individual chromosome, and the reviewers for their useful comments. this work has been supported by the spanish ministry of science and innovation  to jrg, the statistical genetics network  to jrg and ac. bjr is supported by the national institutes of health  and a burroughs wellcome career award at the scientific interface. mc is supported by the erc under the european union seventh research framework programme  with starting grant .
