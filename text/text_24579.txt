BACKGROUND
with the development of both the genome project and the structural genomics, large of unknown functional protein structures were deposited in pdb, these protein functions need to be annotated. in addition, because of the fast development of bioinformatics, some known structure and function proteins may also need to be re-annotated. thus, several methods of protein structural and functional prediction were developed, which can be classified as the sequence-based and the structure-based methods.

sequence-based methods, such as, blast/psi-blast <cit>  or prosite <cit> , are based on the concept of "similar protein sequences with similar function". the performance of these methods critically depends on the sequence similarity between the query structure and annotated structure. however, these methods may fail to detect the remote homologous and convergent proteins. in addition, the changes of some key residues may also result in the change of protein function, even though their sequence identities are very high. for example, vrk <dig>  a member of kinase family, have lost its function as kinase and become into regulating other kinase activity, because the key atp binding sites were mutated  <cit> . thus, sequence-based methods may also fail to annotate the functional diversified proteins.

structure-based methods contain the global and local structure comparison methods. though the global structure-based methods, such as dali  <cit> , vast  <cit> , ssm  <cit>  and ce  <cit> , can detect the remote homologue proteins, they fail to detect the functional convergence of some proteins with different fold. for example, the enzymes with different folds, the trypsins and subtilisins, can hold same function of hydrolysis  <cit> , but the global structure comparisons can not detect them each other. some proteins with similar structures can perform different functions  <cit> , but the global structure-based methods can not detect the functional divergence of some proteins with same fold.

the local structure-based methods can detect the functional convergence and predict the functional sites for those proteins with the less annotated structures, for example, fff <cit> , pints <cit> , spasm <cit> , jess <cit> , query3d  <cit> , assam  <cit> , cavbase <cit> , ef-site  <cit>  and so on. the fff can search local structural similarities by the local structural geometry characters and the contact matrix constraint by user predefined, which has been successfully applied in predicting the active sites of glutaredoxins/thioredoxins and t <dig> ribonucleases <cit> . other methods search local structural similarities by the recursive enumeration strategy <cit> . the core of this strategy is to extend initial candidate solutions <cit> . thus, the performances of these methods depend critically on the constraints that can extend the partial candidate solution quickly and accurately  <cit> . as the constraint, the max inter-distance deviation  is well applied in most of the local structure comparison algorithms  <cit> . the results of these algorithms are sorted by the rmsd or the rmsd based p-value  <cit> . however, there is no restricting relationship between the midd and the rmsd. so the midd may be larger, but the rmsd may be very small in values. to obtain the better sensitivity and accuracy, the users have to define a larger midd, but the cpu time will increase dramatically. thus, it is very difficult to balance the time cost and the performance.

in order to improve the local structure-based methods, the cmasa  has been used. the design requirements of cmasa are, as follows,  it should be not only fast but also sensitive and accurate enough for the large-scale structural annotation; . it should be flexible enough for the different applications.

to fulfil the above requirements, the steps to detect the local structure similarity in cmasa are shown in figure  <dig>   each residue in the protein structure is represented by both ca  and fa . . emulate all possible local structures that may match with the query structure by the residue substitute matrix, such as, blosum <dig>  <cit> . . most of the possible local structures are discarded by the contact matrix average deviation  rather than the midd. . the rmsd is calculated by the nelder-mead simplex method <cit> . . the rmsd-based p-value <cit>  and rank are computed.

three cmasa's databases have been generated for different applications, 1) nrcsa from catalytic sites atlas  <cit>  for predicting enzyme active sites, 2) nrpdb and nrscop database for detecting remote homologues and convergent cases.

RESULTS
overview of the cmasa
the cmasa for detecting the local structure similarity can have different applications, when different databases are used. 1) the putative functional prediction of structured proteins by active sites database . for example, the structure of 2qjw has been deposited by joint center for structural genomics , but its function is unknown yet. when the psi-blast is used, the 2qjw can hit nothing in pdb database and tens of hypothetical proteins in non-redundant  database . these results suggest that 2qjw is a protein with unknown function. when the cmasa is used, the 2qjw can hit the 1a <dig>  a haloperoxidase with the p-value of  <dig>  × 10- <dig>  and the 2qjw active sites predicted by the cmasa are s <dig>  d <dig> and h <dig>  which are same as the 1a <dig>  thus, the 2qjw may have haloperoxidase function. 2) the same catalytic sites in non-homologous proteins caused by convergent evolution can be observed by the nrpdb or nrscop. for example, the catalytic sites of 1djz  are h <dig>  e <dig> and h <dig>  1djz catalytic sites can hit 2ddr  with the ec number of ec <dig> . <dig>  by the cmasa, and the h <dig>  e <dig> and h <dig> in 1djz are corresponding to the h <dig>  d <dig> and h <dig> in the 2ddr. thus, the results suggest that the both 1djz and 2ddr should hold same transformational reaction. actually, both h <dig> and d <dig> are the catalytic residues in 2ddr <cit> , although 1djz and 2ddr hold different folds, where 1djz is belonged to tim beta/alpha-barrel fold, but 2ddr is belonged to dnase i-like fold <cit> . thus, the transformational mechanism between 1djz and 2ddr may be resulted from convergent evolution.

there are two kinds of output files after searching finished. one is the plain text file or html file similar as the blast output  <cit> , in which the results are ranked by p-value. another is a structure superposition file, where the hits below the superposition-cutoff value are superimposed. the superposition results of the protein  searching against the nrcsa database are shown in the figure 2a, and the results of the active sites of 1mct  searching against the nrpdb are shown in the figure 2b.

the running speed of cmasa is also fast. when cmasa was running on the personal computer with the intel core  <dig> duo e <dig>  <dig>  ghz cpu, a protein with  <dig> residues is as the seed to search against the nrcsa database  by the defeat settings, the time cost is about  <dig> s . when the active sites including  <dig> residues are used to search against the nrscop  by the defeat settings, the time cost is about 30~ <dig> s. the cmasa mail-based server  will reply the mails and give the searching results within  <dig> minutes if the server is not too busy.

constraint analysis of cmasa
a suitable constraint is very important for local structural alignment. for example, there are  <dig> candidates for emulating all h-d-s possible active sites in 1mct, a member of trypsin. the rmsd will have to be calculated to  <dig> times, if there is not any constraint. however, if we set the constraints of cmad  < <dig>  Å, the rmsd will be calculated just twice. as mentioned above, the cmad has been used as the constraint in the cmasa rather the midd used in other methods. in theory, cmad< = 2rmsd, but if the numbers of atoms is just two, cmad = 2rmsd. in fact, there are at least  <dig> atoms, that is,  <dig> ca and  <dig> fa atoms. to access the exact relationship between the cmad and the rmsd, we searched all the nrpdb data against the csa database and plot each pair of cmad and rmsd by the threshold of cmad <  <dig>  Å. the result  shows that almost all the cmad smaller than the rmsd with the p-value =  <dig> . however, as showed in figure 3b, the relationship between the rmsd and the midd is complex, and there is no theoretical relationship between the rmsd and the midd. so, the cmad is a suitable constraint for cmasa search. in practice,  <dig>  Å as the threshold is enough for the local structural searching.

sensitivity and accuracy of cmasa
to obtain a better performance, different amino acid presentations were compared. the trypsin-like serine proteases superfamily and subtilisin-like superfamily have been as the example to evaluate the performance of three different amino acid presentations: ca atom only, fa atom only and combining both ca and fa atoms. trypsins and subtilisins are with different folds, but they hold the same catalytic sites and similar function. there are  <dig> trypsins and subtilisins in nrscop database, in which  <dig> are trypsins and  <dig> are subtilisins. however, the catalytic sites in  <dig> enzymes of  <dig> trypsins and subtilisins have been mutated, such as, the active sites, h <dig> and s <dig>  have been mutated to s <dig> and g <dig> in 1a7s. thus, there are totally  <dig> positives . the catalytic sites  of 1mct  were used as the query to search against nrscop database, and the receiver operating characteristics  curve <cit>   is obtained. the result shows that the presentation of combining both ca and fa atoms is the best performance in these three presentations. thus, the presentation of combining both ca and fa atoms is used in the cmasa.

 <dig> csa families were selected to test the overall sensitivity and accuracy of the cmasa . for each family, two different templates were chosen to search the training set, which contains both family members' structures and a constant negative dataset. one is the master template, and another is the mean conformational template . for each template, the negative dataset is a subset of the nrpdb, where the nrcsa and nrec have been excluded.

several methods have been evaluated by roc curve <cit> , but the overall performance of cmasa is evaluated by the matthews correlation coefficient  <cit> , because mcc can clearly give the optimal threshold, which can suggest that the hit be true or false positive in large-scale active site annotation. the result  shows that the p-value threshold is  <dig>  × 10- <dig> for both master templates and mean conformational templates. we also calculated the rmsd based mcc , and got  <dig> Å as the rmsd threshold for master templates and  <dig> Å for mean conformational templates.

the mcc, sensitivity and accuracy of each family  were calculated by using the optimal threshold. because different protein homologous families have different mcc, sensitivity and accuracy, each data set was averaged. table  <dig> shows the mean mcc, mean sensitivity and mean accuracy for all the  <dig> families in different template types and in different threshold types. the mean mcc is  <dig>  with the mean sensitivity of  <dig>  and with the mean accuracy of  <dig>  by using mean conformational templates and p-value threshold. when the rmsd threshold is used, the mean mcc and sensitivity decreased about  <dig> . when mean conformational templates instead of master templates are used, the mean mcc and sensitivity can be increased about  <dig> . all the mean accuracy is above  <dig>  .

the mean mcc, mean sensitivity and mean accuracy of  <dig> families in different threshold type and in different template type. values in brackets are standard deviation.

comparison of cmasa with both sequence-based and global structure-based methods
the cmasa, sequence-based and global structure-based methods were compared by using the both trypsin-like serine proteases and subtilisin-like superfamilies. figure  <dig> shows the relationships between the cmasa rmsd, the global rmsd  and the sequence identities. the results show that the cmasa can hit both trypsins and subtilisins from noise, even though their sequence and global structure similarities  are low. the global structure-based method can hit all trypsins from noise, but it can not distinguish subtilisins from noise . the results suggest that the global structure-based method is powerful for detecting the global structural similarity, but it is weak for detecting the local structural similarity; and the sequence-based method can only hit most of trypsins , which can not distinguish some of remote homologous trypsins and subtilisins from noise. thus, the cmasa can effectively find remote homologous proteins and the active site convergence comparing to the sequence-based method or to the global structure-based methods.

comparison between cmasa and other local structure comparing methods
some local structural comparing methods have been applied in the enzyme active site annotation, such as, fff <cit> , spasm <cit> , pints <cit> , query3d <cit>  and jess <cit> . the different residue representations and different searchable databases are used in these five methods above. for example, fff only used the ca atom, jess used both ca and cb  atoms, spasm used both ca and a pseudo atom that is the geometrical centre of the residue. however, different methods have different searchable databases. thus, it is difficult to compare them in overall. so we used some examples to evaluate the advantages and disadvantages between these five methods and the cmasa.

two cases have been used to compare the performance among the fff, spasm and cmasa. one is to recognise glutaredoxins/thioredoxins by 1aaz  active residues . in nrscop database , there are  <dig> glutaredoxins/thioredoxins which have cxxc and p motif. because the fff only used geometry to predict protein function and did not calculate the rmsd or other scores for ranking, we ranked the fff matches by the rmsd based p-value to compare to the cmasa. the spasm matches are ranked by the rmsd. then, the roc curve is obtained . the results show that the cmasa is better than the spasm, and the spasm is better than the fff. another case is to find trypsins and subtilisins by 1mct active sites . the roc curve shows that all of these three methods can hold the good performance, when they are used to detect the 1mct active site similarities , but some differences can be also observed. the cmasa is remarkably better than the both spasm and fff, but the performance between the spasm and the fff is complex. when the false positive rate is small than  <dig> , the spasm can hit more true positives than the fff. but when the false positive rate is larger than  <dig> , the fff can hit more true positives than the spasm. these cases suggest that the performance difference between the spasm and the fff is complex, but the cmasa can get a better performance than the both spasm and fff.

pints have its own website, so we used 2ity  active sites to search pints scop_specials database . interestingly, only  <dig> kinase can be hit and the best hit is not kinase. on the contrast, the cmasa can hit  <dig> kinases with the false positive rate < <dig> . we also used the active sites of 1mct to search pints scop_specials database ,  <dig> of  <dig> trypsins and  <dig> of  <dig> subtilisins can be hit. but  <dig> of  <dig> trypsins and  <dig> of  <dig> subtilisins can be hit by the cmasa. thus, the sensitivity of cmasa is better than that of pints.

the query3d is powerful to find similar local structures within two proteins. but it may be weak to detect the similarity between an active site and a protein. for example, we used 1k2p  active sites to search pdb database in the qurey3d website, not any hit is shown. however, the cmasa can give more than  <dig> positives  and the reasonable rank. thus, the query3d may be not suitable for enzyme catalytic site annotation.

the jess had used csa families to evaluated the algorithm performance <cit> . so the overall performance between the cmasa and the jess were compared. the results had showed that the jess had the maximum mean mcc of  <dig>  with the mean sensitivity of  <dig>  and the mean accuracy of  <dig>   <cit> . however, the cmasa can hold the mean mcc of  <dig>  with the mean sensitivity of  <dig>  and the mean accuracy of  <dig> . thus, the accuracy of the cmasa is higher than that of the jess .

large scale annotation of enzyme catalytic sites
the above results suggest that the sensitivity and accuracy of the cmasa may be enough for doing the large scale functional annotation. so the cmasa is also tried to annotate the enzyme catalytic sites. all the proteins in nrpdb were searched against the mean conformational template  dataset  by the cmasa, and  <dig> structures has been characterized, which are not annotated by the csa <dig> . <dig> . in fact,  <dig> of  <dig> have been deposited before  <dig> . thus, these results demonstrate that at least  <dig> putative novel catalytic sites can not be annotated by csa .

cases of enzyme catalytic site prediction
two cases were used to evaluate the cmasa advantages further. the structure of 3bdv is from the joint center for structural genomics  that aims to develop high-throughput methods for protein production, crystallization, and structure determination. 3bdv is belonged to udf <dig> family with unknown function <cit> . 3bdv can hit 1jkm of a serine hydrolase  by the cmasa, and the catalytic residues of 3bdv are predicted as s <dig>  d <dig> and h <dig>  further sequence analysis shows that the whole udf <dig> family members are conserved in the sites of s <dig>  d <dig> and h <dig> , which suggest that the entire udf <dig> family members probably have a function similar as serine hydrolase with s-d-h active sites.

the catalytic sites of an arylsulfatase  have been annotated in the csa <cit> . however, the catalytic sites of its one homologue  can not be found in the csa. the psi-blast result suggested that the 1p <dig> catalytic sites mismatch result fails to be annotated, because of the low sequence identity . however, 1p <dig> can hit 1hdh with high confidence  by the cmasa, and the catalytic residues are predicted as r <dig>  k <dig>  h <dig>  h <dig>  d <dig> and k <dig> . the structural information  <cit>  convinces this prediction.

discussion
an accurate algorithm, the cmasa, has been developed to detect the local protein structural similarity, which can not only search the similar functional proteins by query the active sites, but also predict an unknown protein function, including distant homologous proteins or convergent proteins, by searching to functional active site database.

when the cmad is used as the constraint and the ca/fa atoms are used to represent the residues, the balance between sensitivity, accuracy and the time cost can be reached. the cmasa is fast by testing on pc, and maintains sensitive and highly accurate  for searching enzyme active sites. so, the cmasa may be helpful for improving the large scale annotation.

the cmasa has been compared to other methods. these methods contain the sequence-based, the global structure-based and five local structure-based methods. the results suggest that the cmasa can get better performance than all of these methods in detecting enzyme active site similarity. psi-blast <cit>  has been used to annotate the enzyme catalytic sites <cit> , but it is weak at annotating distant homologous proteins and convergent proteins. so the cmasa is an effective method to annotate the distant homologous or convergent protein/enzyme active sites.

of course, some limitations can be found in the cmasa, for example, i) the protein structures are required; ii) the structural difference of the side chains between the query and hit active residues will affect the sensitivity.

CONCLUSIONS
the cmasa is not only highly accurate but also sensitive and fast for detecting the local protein structural similarity. it can be applied in annotating the distant homologous or convergent protein/enzyme active sites. and at least putative  <dig> novel catalytic sites have been suggested by the cmasa. a mail-based server has been available.

