BACKGROUND
the study of metagenomes has provided important insights into physiological processes and into the diversity of microbial and viral communities in different environments  <cit> . metagenomic analysis is based on high-throughput dna sequencing of clone libraries of mass-isolated cells or viral particles from different ecological environments, and is strictly defined as the study of those organisms that inhabit a given biological niche. such community analysis has contributed to an improved understanding of microbial community structure, and can provide a broader perspective on microbial community composition and function than analysis of 16s rdna.

over the past decade, it has become increasingly clear that viruses are a significant component of every ecological niche in which cellular life exists. abundances ranging from  <dig> to  <dig> virus-like-particles per milliliter have been detected in virtually every aquatic environment studied  <cit> , although abundances in hot springs are generally at the lower end of this range  <cit> . estimates of viral diversity suggest that several thousand different viral types exist in a given pool, probably having a profound impact on population structure and genomic content of host populations  <cit> .

studies of viral diversity have been hampered by the absence of universal signature sequences . metagenomic analysis has provided much of the population-level insight into diversity and distribution of viruses in the environment  <cit> . the few studies addressing bacteriophage and archaeal viral assemblages have led to deeper understandings of the diversity present in these communities and may aid in the determination of how the presence of certain viruses may shape microbial communities  <cit> ; however, these studies also have highlighted the need for improved approaches in the analysis of viral metagenomes. in each of the studied viral metagenomes, a large proportion of sequences had no significant homologs identified in genbank non-redundant database  <cit> . furthermore, in a recent viral metagenome survey in thermal environments, half of the sequences had no blastx homolog in the genbank nr database  <cit> , similar to results found in marine and estuarine environments  <cit> , presumably due to the relative dearth of annotated thermophilic viral sequences in genbank. while all of the unidentified sequences in thermal virus metagenomes presumably represent bacteriophage or archaeal viruses, neither the host nor types of virus can be ascertained  <cit> . since, to date, blast alignments  <cit>  have been the predominant means of associating a viral metagenomic sequence with a likely host, the lack of significant homology between most of viral metagenomic sequences and sequences in genbank has impeded our understanding of host-virus relationships.

genome signature analysis of dna sequences measures biases in dna oligonucleotide composition rather than sequence similarity, and is studied in an alignment-independent manner  <cit> . for each genome or portion of genome with detectable differences, the genome signature for each sequence analyzed will be unique  <cit> . previous data has demonstrated that after their divergence, microbes retain patterns of genome signature reflective of their recent common ancestry similar to that of 16s rdna  <cit> . utilizing this quality of the genome signature, the technique now has been adapted to predict the ancestry of eukaryal, archaeal, and bacterial metagenomic sequences  <cit> .

the classification of viruses has traditionally been based on morphological characteristics  <cit> . this classification system is widely used for cultivated viruses, which significantly biases our view of diversity  <cit> . attempts have been made to correlate sequences and morphologies  <cit> , but these have proven less useful in extreme thermal environments. the absence of a universal signature gene has hampered classification of viral genomes based on genomic sequences recent studies of bacteriophages have identified conserved patterns of oligonucleotides used as genome signatures unique to each genome analyzed that appear to be co-evolving with their hosts  <cit> . in contrast, these patterns are shared for groups of eukaryotic viruses in a manner largely independent of their host  <cit> .

terrestrial thermal aquifers are vast ecosystems with abundances of microbes and viruses approaching those of the ocean  <cit> . at temperatures > 74째celsius, the hot springs in this study are significantly above the temperature limit for eukaryotic life, generally accepted to be around 62째c, and therefore, harbor communities strictly composed of bacteria, archaea, and their respective viruses  <cit> . while comprehensive studies of viral communities in these extreme environments are just beginning, culture-based studies have indicated the presence of bacteriophages of the bacterial genus thermus  <cit> , as well as archaeal viruses of the archaeal genera sulfolobus, pyrobaculum, acidianus, and thermoproteus  <cit> .

we sought to develop new methods based on genome signature to apply to analysis of viral communities from two separate thermal pools, bear paw and octopus springs, in yellowstone national park. our goals were to: 1) develop the technique of genome signature-based phylogenetic classification  to accurately predict the presumed host/virus relationships of known bacteriophages, 2) analyze the differences between viral metagenomes from bear paw and octopus hot springs, 3) apply the gspc technique to viral metagenomes to predict the microbial host of unknown members of the viral community, and 4) apply gspc to classify the viruses present in bear paw and octopus hot springs.

RESULTS
gspc for known bacteriophages based on a microbial database
to compare viral genome signatures with those of bacteria and archaea, we constructed a microbial database of oligonucleotide frequencies for all currently sequenced bacteria and archaea. the database contains frequencies of all dinucleotide, trinucleotide, tetranucleotide, pentanucleotide, and hexanucleotide combinations for each genome. to determine similarity between known bacteriophages and their potential hosts in the microbial database, euclidean distances based on the sum of the differences for all oligonucleotide combinations were determined for each known bacteriophage and each database genome. the resulting distance matrix was subjected to neighbor-joining analysis, and phylogenies were used to classify the known bacteriophages. in cases where the known bacteriophages were positioned monophyletically, the bacteriophages were classified based on the kingdom, phylum, class, order, family, and genus of that monophyletic group. in cases where the known bacteriophages were positioned paraphyletically, the bacteriophages were classified based on the branches deep to that paraphyletic position.

using a group of bacteriophages in which their bacterial host has been well-described , gspc was able to classify greater than 90% by phylum, 70% by class and order, and 50% by family and genus . when analyzing by specific oligonucleotide sizes, tetranucleotide-based phylogeny classifies a higher percentage of bacteriophages than trinucleotides or pentanucleotides . because of its increased sensitivity in classifying bacteriophages according to their bacterial hosts, tetranucleotide-based gspc was used for all subsequent analyses.

gspc for hot spring metagenomes based on a microbial database
we analyzed two separate hot springs, bear paw and octopus in yellowstone national park, to gain a deeper understanding of the viral populations native to each habitat. each hot spring is located within  <dig> kilometers of the other, with bear paw characterized by a surface temperature of 74째celsius, visible pigmented microbial growth at the surface, a ph near  <dig> , and estimated phage abundance from  <dig> to  <dig> particles per milliliter. the octopus hot spring is characterized by a ph near  <dig> , a surface temperature of 93째celsius, an estimated viral abundances from  <dig> to  <dig> particles per milliliter, and no visible growth at the surface  <cit> . both thermophilic bacteria and archaea previously have been identified in octopus hot spring, with thermocrinis and aquificales predominating among the sediment and filament bacteria  <cit> . due to the high temperatures, these hot springs are both devoid of eukaryotic life  <cit> .

using gspc based on a microbial database, the majority of bear paw contigs are predicted to have bacterial hosts, while few are predicted to have archaeal hosts . for bear paw contig  <dig>  its phylogenetic position supports a classification with thermus thermophilus , a thermophilic bacterium highly characteristic of hot springs of similar temperature and water chemistry  <cit> . the closest homolog identified in genbank for bear paw contig  <dig> belongs to another thermophilic bacterium aquifex aeolicus . both genera aquifex and thermus are closely related based on genome signature-based phylogeny , despite their apparent divergence based on other criteria  <cit> . the fact that gspc groups thermophilic bacteria more closely with thermophilic archaea than with mesophilic bacteria is probably related to convergent evolution specific to thermophiles  <cit> , but should not impair the predictive value of the method. gspc based on a microbial database predicts other bear paw contigs belong to host bacterial classes bacteroidetes, alphaproteobacteria, deltaproteobacteria, and spirochaetes .

when sequences from octopus hot spring were analyzed by gspc based on a microbial database, most were predicted to have archaeal hosts . for octopus contig  <dig>  its phylogenetic position supports a classification with aeropyrum pernix, a hyper-thermophilic archaeon belonging to the class thermoprotei, . based on genbank blast, the most closely related homolog of octopus contig  <dig> belongs to a virus isolated from the archaeon sulfolobus islandicus , another hyper-thermophilic archaeon belonging to the class thermoprotei. most contigs from octopus have substantial oligonucleotide similarity with the archaeal genus pyrobaculum , which also belongs to the class thermoprotei. the abundance of contigs predicted to belong to the genus pyrobaculum suggests that pyrobaculum viruses represent the most abundant viruses in octopus hot spring. this is highly consistent with a previous metagenomic study of octopus and bear paw hot springs in which homology to nearly the entire genome of pyrobaculum spherical virus was detected  <cit> . other octopus contigs are predicted to belong to bacterial classes actinobacteria, spirochaetes, and deinococci, which includes the thermophilic bacterium thermus thermophilus .

gspc analysis classifies metagenomic contigs individually based on their similarity to other microbial genomes; however, classification also can be performed on the collective metagenomes. when the bear paw metagenomic contigs were analyzed collectively, the most recent common ancestor of each contig was found within the bear paw metagenome , with the exception of contigs  <dig> and  <dig> . a similar finding is present for the octopus metagenome, where the most recent common ancestor for each contig is represented in the octopus metagenome rather than the microbial database . the collective octopus metagenome is grouped paraphyletically to the archaeal genus pyrobaculum , consistent with the findings for each individual contig .

collective analysis of bear paw and octopus hot springs
when analyzed separately, contigs from bear paw and octopus share a common genome signature with contigs from their respective metagenomes, suggesting that patterns of genome signature may be relatively specific to each environment. when metagenomes of octopus and bear paw were analyzed together based on a microbial database, many of the bear paw contigs continue to demonstrate recent ancestry within the bear paw metagenome, with similar observations for the octopus metagenome . some overlap exists between groups of octopus and bear paw contigs, suggesting the presence of shared microbial flora between the habitats , which is consistent with previous tblastx results  <cit> .

gspc for known bacteriophages based on a viral database
previous data indicates that when analyzing genome signature for diverse groups of viruses, they segregate largely according to their family designation  <cit> . furthermore, double stranded dna viruses, including bacteriophages and archaeal viruses, cluster separately from other types of viruses such as single stranded dna viruses and rna viruses. based on genome signature, bacteriophages typically segregate either according to their bacterial hosts or their family designation   <cit> .

to classify metagenomic contigs according to their respective viral families, we created a database of oligonucleotide signatures for all available sequenced viruses, and subjected a group of known bacteriophages  to gspc. because the viral database contains all currently sequenced viruses, we selected random fragments of differing sizes from these viruses to evaluate their predicted ancestry. when full-length bacteriophages were evaluated, their predicted ancestry matches their ancestry based on morphological features . for bacteriophage fragments of  <dig>  nucleotides, nearly 90% have predicted ancestry consistent with that of morphological features at the family level. most fragments of  <dig>  nucleotides are predicted to be bacteriophages, with nearly 70% predicted according to family. for fragments of  <dig>  nucleotides, most are predicted to be bacteriophages; however, many are predicted to be bacteriophages outside of the caudoviridae family .

gspc for hot spring metagenomes based on a viral database
we sought to predict the viral families present in the bear paw and octopus hot springs by subjecting contigs from both metagenomes to gspc based on a viral database. as expected, the majority of the sequences from both bear paw and octopus metagenomes are classified as double stranded dna viruses , which is a result of selection due to the library construction method. each of the common bacteriophage families, including siphoviridae, myoviridae, and podoviridae are predicted to be present in both metagenomes. the archaeal virus family globuloviridae, including thermoproteus spherical virus and pyrobaculum spherical virus, is substantially represented in octopus hot spring , consistent with the predicted archaeal virus predominance when using a microbial database . another archaeal virus family, fuselloviridae, also is predicted to have members present in the octopus metagenome . the majority of the bear paw metagenomic contigs are predicted to belong to the bacteriophage family caudoviridae , with no individual contigs predicted to belong to archaeal viruses . the predicted bacteriophage predominance in bear paw and the predicted archaeal virus predominance in octopus is consistent with the results of genbank blast, and with well described correspondence between higher temperatures and higher predominance of archaea  <cit> .

gspc based on a combination database
previous data indicates that when bacteriophages and their bacterial hosts are included in genome signature-based phylogenies, bacteriophages tend to cluster together near their bacterial hosts  <cit> . we hypothesize that this clustering represents a limitation in the ability of bacteriophages to fully ameliorate to their host genome signature, and may be necessary for the bacteriophages to maintain host range  <cit> . the metagenomes from bear paw and octopus hot springs, are limited to bacteriophages and archaeal viruses based on previous analysis of the contigs  <cit> . we constructed a database containing all sequenced archaea, bacteria, and viruses to determine if bear paw and octopus metagenomic contigs have viral signatures or microbial signatures. using gspc based on this combination database, each of the contigs from bear paw and octopus were classified similarly to their classification based on the viral database , further suggesting their origin as bacteriophages and archaeal viruses.

other methods of metagenomic classification
using genbank blast algorithms, much of the octopus metagenome has no identifiable homolog . homologs to only 23% of the octopus contigs were identified, while 86% of the bear paw contigs had identifiable homologs . most of the homologs to bear paw contigs were from bacteria, while octopus contigs had many homologs to archaea, bacteria, and eukarya. the lower proportion of identifiable homologs in octopus compared to bear paw, suggests that an identification bias might exist based on a relative paucity of thermophilic viral sequences present in the genbank database.

aindicate hits to thermophilic bacteria

another method for identification of metagenomic sequence fragments based on oligonucleotide sequence biases is the application phylopythia, which uses a support vector machine to classify sequence fragments according to its database of oligonucleotide biases that includes archaea, bacteria, and eukarya  <cit> . previous data has demonstrated that for both bacterial and archaeal dna fragments, the technique is quite robust in assigning fragments to different taxonomic classes  <cit> . while not developed specifically for bacteriophages, we applied phylopythia towards the identification of metagenomic contigs from bear paw and octopus. phylopythia classified 91% of the sequence contigs from bear paw, and 91% from octopus . many of the sequences could not be identified beyond the level of kingdom or class . some sequences were classified to eukaryotic classes , bacterial classes , and archaeal classes  . since no eukaryotes previously have been isolated at these temperatures  <cit> , their viruses are unlikely to be members of these communities.

using gspc, genbank blast, and phylopythia, many of the metagenome contigs were classified to the archaeal class thermoprotei. because of the apparent similarities in classifying contigs between each method, we used the spearman non-parametric test to determine if there was a significant correlation between the classification predictions of each methodology. because with certain methods, taxonomic classification was only possible at the level of class , we used the predicted class of each contig for further evaluation. when examining the contigs, there was a high level of agreement between contig classification by gspc based on a microbial database using either trinucleotides or tetranucleotides . when comparing gspc based on a microbial database using either criterion, both have significant agreement with those classification results of genbank. there is no significant agreement between results of genbank and phylopythia, and less agreement between gspc and phylopythia. nearly identical results were obtained using kendall tau's non-parametric test .

bold indicates correlation is significant at the <  <dig>  level .

aindicates gspc based on a microbial database

discussion and 
CONCLUSIONS
the exploration of microbial assemblages through microbiome genome analysis has provided insights into both community structure and physiology  <cit> , but also has revealed a greater need for advances in technology to identify community constituents without significant homology in genbank. viral metagenomic analysis currently is substantially less well developed than that of cellular populations, and is limited by a low proportion of viral sequences compared to cellular sequences. genome signature analysis is independent of nucleotide or amino acid alignments, and predicts relationships based on separate principles from those of blast search algorithms  <cit> .

we sought to create two separate databases based on oligonucleotide frequencies of all sequenced microbial cellular and viral genomes, respectively, to determine whether known viruses could be used for accurate prediction of host microbe or virus ancestry. our data demonstrate that when longer nucleotide sequences are available, gspc makes more accurate predictions of both host and viral ancestry . as the length of nucleotide sequences decreases, gspc accuracy also decreases . the heterogeneity of oligonucleotide signatures across certain bacteriophage genomes may explain why individual bacteriophage fragments are not always representative of their viral or host genomes  <cit> .

because previously sequenced viral metagenomes  <cit>  are comprised mostly of single reads or smaller contigs, they generally are not amenable to gspc analysis. bear paw and octopus metagenomes are less diverse and have larger contigs  <cit> , thus providing a more suitable dataset for gspc. the gspc method predicts many of the hot spring metagenomic contigs as archaeal viruses and thermophilic bacteria , a finding that is consistent with the environment from which they were recovered. when homologs to the metagenomic contigs could be identified in genbank, the presumptive hosts were generally consistent with the findings of gspc . while there was some agreement in contig prediction between gspc and phylopythia, many of the contigs were predicted to be derived from dissimilar organisms. because gspc predicts the origin of many of the contigs to be consistent with the known flora of these hot springs, while phylopythia predicts many to have eukaryotic origin, we believe gspc may provide a more specific methodology for contigs from such extreme environments.

we chose to analyze the metagenomes of two separate hot springs, bear paw and octopus in yellowstone national park. their conditions at the surface differ, suggesting there may be differences between the microbial flora present in each environment. genbank blast and gspc based on a microbial database both predict the origin of many bear paw contigs to have bacterial origin, while the viral database suggests the contigs are from bacteriophages . in contrast, genbank blast and gspc based on a microbial database predict many octopus contigs to have archaeal origin, with the viral database indicating many contigs may belong to archaeal virus families fuselloviridae and globuloviridae . in support of this finding, a previous metagenomic study of these hot springs detected homologs to nearly the entire genome of pyrobaculum spherical virus  <cit> , a member of the archaeal virus family globuloviridae. although geochemistry has a large influence on the microbial composition of hot springs, microbial populations are highly temperature dependent  <cit> . we believe the bacterial predominance in bear paw hot spring compared to octopus may be related to the lower temperature present in bear paw.

as greater numbers of viral communities are studied, new techniques for assessing metagenomic constituents are necessary. previous studies of viral metagenomes have underscored the need for new techniques, as most of the available metagenomic sequences have limited detectable similarity to sequences in genbank  <cit> . gspc provides an approach complementary to blast search algorithms, taking advantage of properties of dna patterns of nucleotide usage rather than nucleotide alignments. while not applicable to most lower temperature viral metagenomes due to the limited size of typical contigs in most studies, gspc will likely become more suitable for analysis of these environments as next generation sequencing platforms allow collection of much larger amounts of sequence data and assembly of larger contigs. this will substantially increase the sensitivity in viral metagenomic studies in both predicting the host and classifying the types of viruses in the community. gspc is a facile approach for classifying viral metagenomic sequences and inferring host relationships and is a highly complementary alternative to traditional blast searches, particularly when those searches fail to identify significant homology.

