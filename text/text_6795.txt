BACKGROUND
we are faced with a fundamental challenge of understanding how a cell’s behavior arises from protein and gene interactions. yet, the exact map of dynamic interactions between cellular network components is largely unknown for key cellular networks. even for perturbations confined to single network nodes, mapping the dynamic topology of protein and gene network interactions is not straightforward. in fact, a local perturbation that is initially confined to a node rapidly propagates through the entire network, causing widespread, global changes that mask direct connections between nodes. thus, the “reverse engineering” approaches where the connection architectures are inferred from the perturbation response data are becoming increasingly appreciated. although reverse engineering methods such as boolean networks  <cit> , bayesian networks  <cit> , dynamic bayesian networks  <cit> , multivariate regression methods  <cit> , linear programming  <cit> , genetic algorithm  <cit>  and information theoretic  <cit>  approaches have been applied to deduce the circuitry of signaling and gene networks, all currently developed methods have significant limitations. for instance, the boolean network based methods are found to be formidably slow, and their performance degrades with increasing network size  <cit> . bayesian network methods are unable to account for feedback regulation, a hallmark of signaling networks  <cit> . information theoretic approaches do not predict the directions of interactions which are important in understanding the signal flow via biological pathways  <cit> . a review of the advantages and limitations of most reverse engineering methods mentioned above can be found in  <cit> .

we previously developed a method to infer network interaction maps based on steady-state responses to systematic perturbations  <cit> . this deterministic method, termed modular response analysis  unravels the direction, strength and type of interactions between individual proteins and genes or between network modules that encompass several proteins or genes in a modular description. however, noise present in the data and a requirement to generate as many perturbation responses as there are nodes in the network constrain the practical applicability of this method  <cit> . consequently, a stochastic equivalent of the mra algorithm was developed to account for noise encountered in biological datasets  <cit> . however, this method is associated with high computational cost and it also is unable to analyze experimental data when the number of perturbation experiments is smaller than the number of network modules. more recently, another extension of mra was reported, where a maximum likelihood approach was used to infer connection coefficients from noisy perturbation data  <cit> .

here, we propose a computationally efficient method which integrates the theoretical framework of mra with a bayesian variable selection algorithm to infer functional interactions in signaling and gene networks based on noisy and incomplete perturbation response data.

RESULTS
fundamentals of the inference framework
motivation
in general, network interactions can be quantified by analyzing the direct effect of a small change in one node on the activity of another node, while keeping the remaining nodes unchanged to prevent the spread of the perturbation  <cit> . a dimensionless quantifier  of this local response is the ratio of the immediate fractional change in the activity  of node i to that of node j, , and it is called the connection coefficient or local response coefficient  <cit> , rij=∂xi∂xj, provided that all other nodes xk,k≠j are kept constant.

on the other hand, the global changes  in node i occur when the other nodes become involved in the response to the perturbed node j through multiple interactions  <cit>  and can be calculated using the following formula.

  rik≈2xik−xi0xik+xi <dig> 

where xi <dig> and xik are the steady-state activities or concentrations of node i before and after perturbing parameter pk respectively. let us select node i and consider an n-dimensional vector ri= that quantifies network connections directed to node i. if parameter pk does not directly influence node i the vector ri is orthogonal to n− <dig> vectors rk of the global response coefficients ,k≠i <cit> , i.e.

  ∑j= <dig> j≠inrijrjk=rik;i≠k;i,k=1…n 

eq.  <dig> presents a precise solution to the problem of inferring the network topology  from the steady-state perturbation responses  <cit> . it requires n independent perturbations to a network of n nodes since the matrix of global responses r must have rank n− <dig> to precisely determine connection coefficients ri <dig> …,rin of network edges directed to each node i. these relationships  also assume no noise in the data. biochemical measurements are invariably subjected to biological noise and experimental errors. therefore, a statistical approach is more suitable for estimating the connection coefficients rij from noise corrupted global responses  <cit> .

in a previous effort, total least square regression  was exploited as a method for estimating the connection coefficients rij from noisy perturbation responses  <cit> . when the data is noisy, it is necessary to estimate the uncertainties surrounding the estimated values of rij to draw reliable inference about the nature of the corresponding interactions. therefore, a monte carlo method for estimating the probability distributions of rij was proposed and successfully used to find out connection coefficients for a three-level extracellular signal-regulated kinase  cascade in a subsequent study  <cit> . in this case,  <dig> sets of random realizations of the perturbation responses were drawn from normal distributions with means and standard deviations equal to those of the experimentally measured values  <cit> . a set of connection coefficients r= was estimated from each set of perturbation responses using tlsr  <cit> . the values of rij calculated in this manner were used to estimate its probability distribution  <cit>  which provides a quantitative measure of the uncertainty surrounding its estimated values. however, this method is highly computation intensive. additionally, the proposed tlsr method  <cit>  requires large number of perturbation experiments  which are both time consuming and expensive. therefore, a computationally efficient method that can infer network structures using noisy data obtained from small number of perturbations  is required to explore cellular networks in a cost effective manner.

objective
to speed up the computation process, we refrained from inferring the distributions of the connection coefficients rij. instead, we chose to infer whether node j directly influences node i or not, i.e. if there is a network connection from node j to i. in case of the deterministic mra   <cit> , this is a straightforward task since, by definition, rij≠ <dig> represents an edge from node j to node i and rij =  <dig> indicates that there is no edge from node j to i. in case of the statistical formulation of mra  <cit> , the above objective can be achieved by performing a hypothesis test such as z-test  <cit>  on the distribution of rij to determine whether the mean value of rij is significantly different from zero. however, this requires estimating the probability distribution of rij which is computationally expensive. to avoid the process of estimating the distributions of rij, we modified the original mra equation  by introducing a new set of binary variables  which explicitly represent presence  or absence  of direct interaction between node i and j. introducing these variables into eq.  <dig> results in the following equation , which is fully equivalent to the original mra equation ,

  ∑j= <dig> j≠inaijrijrjk=rik;i=1…n,k=1…n,i≠k 

for noisy global responses , the above equality does not hold exactly. if we account for the difference between the left and right hand sides of eq.  <dig> caused by measurement noise, then the above equation  becomes,

  ∑j= <dig> j≠inaijrijrjk+∊ik=rik;i=1…n,k=1…npi,i≠k 

here, ∊ik is the difference between the left and the right hand side of eq.  <dig> and npi is the number of performed experimental perturbations which do not directly affect node i. based on the above model , we propose a bayesian variable selection algorithm  that can infer the probability of node i being directly influenced by node j ), without having to estimate the probability distributions of the connection coefficients . additionally, in the new formulation, we relax the restrictions of required number of perturbation experiments  and allow the inference of network topology from virtually any number of perturbation experiments . below, we outline the proposed bayesian algorithm, whereas further details can be found in ‘methods’ section and additional file  <dig> 

the proposed algorithm
eq.  <dig> represents a mathematical relationship between the network topology , the strength of each interaction  and the measured noisy perturbation responses  of the network components. here, the network topology , the interaction strengths  and the error  caused by measurement noise are unknown variables and can be estimated from the perturbation responses  using statistical inference algorithms. to simplify the estimation process, we first conceptually divided a network of n nodes  into n numbers of smaller subnetworks, each of which consists of a node i and its potential regulators. the unknown variables corresponding to each of these subnetworks were then estimated independently using bayesian statistics. in bayesian statistics, it is assumed that our knowledge about the unknown variables is uncertain and the uncertainties surrounding these variables  are expressed in terms of their respective probability distributions. prior to any experimental observation, these distributions are estimated based solely on our subjective assessments  and are referred to as prior distributions . the prior distributions were then updated based on experimentally observed data using the bayes theorem . the updated distributions are called posterior distributions. in this case, we are interested in the posterior distribution of the binary variables aij , which represents the posterior probability of the presence  or absence  of a direct network connection from node j to node i. however, it was not possible to analytically calculate the posterior distribution of aij, since it involves a normalization constant which requires calculating a very large integration . therefore, the posterior distributions of aij were approximated using markov chain monte carlo  sampling . finally, the topology of the network was inferred by thresholding the approximate posterior distributions of aij, i.e. if the posterior probability of aij =  <dig> is higher than a threshold value , then we assumed that node j directly influences node i. the work flow of the proposed algorithm is graphically depicted in figure  <dig>  and the source codes for a mtalab implementation of the algorithm is provided in additional file  <dig> 

performance of the proposed algorithm for simulated and real biological networks
we studied the performance of bvsa in reconstructing both simulated and real biological networks. for simulation, we considered the mitogen activated protein kinase  pathway and two gene regulatory networks  consisting of  <dig> and  <dig> genes respectively. for real biological networks we chose the erbb signaling pathway that regulates the g1/s transition in the cell cycle of human breast cancer cells  <cit> . the mapk pathway was chosen because it has many negative feedback loops which enhance robustness against perturbations  <cit> , and its reconstruction from the steady state perturbation data poses a challenging problem. the grns that were chosen for this study are part of the dream initiative,  and are widely used for benchmarking purposes by the network inference community. the erbb pathway was chosen due to its significance in life threatening diseases such as cancer. it has multiple feedback loops which operate via both transcriptional and non-transcriptional mechanisms and may cause resistance to anti-cancer drugs. identifying these feedback mechanisms may provide valuable insight in developing new therapies.

the above datasets were used not only to evaluate the performance of bvsa, but also to compare its performance with many other algorithms, e.g. stochastic mra  <cit> , sparse bayesian regression algorithm   <cit>  and levenberg marquardt optimization based maximum likelihood algorithm   <cit> . in case of the in-silico grn data, we also compared the performance of bvsa with that of the winners of the dream challenge. we chose the above algorithms for comparison due to the following reasons. stochastic mra, lmml and bvsa are three different statistical formulations of the same mra equations  <cit> . therefore, comparing these algorithms may reveal which statistical framework is more suitable for what kind of experimental data. on the other hand, sbra and bvsa are both bayesian linear regression based algorithms with different prior assumptions and network search strategies. sbra adopted a maximum likelihood approach  <cit>  for inferring the most likely network, whereas bvsa implements a model averaging approach which infers ‘expected’ or average networks based on the posterior probabilities of all possible networks. hence, comparing bvsa with sbra may also shed light on how different prior assumptions and different approaches of search strategies may affect the results.

simulation study: mitogen activated protein kinase  pathway
mapk pathways encompass central mechanisms of signal processing in many different eukaryotic species and participate in the regulation of a large number of important physiological processes, such as differentiation, proliferation, cell cycle and apoptosis  <cit> . mapk cascades have several levels, where the activated kinase of each level phosphorylates the kinase at the next level down the cascade. the kinase of the topmost level is activated by still incompletely understood mechanisms which are usually induced by specific extracellular ligands or unspecific stress signals. for our study, we considered the epidermal growth factor  induced mapk cascade ). egf binds to its receptor egfr on the outer surface of the cell membrane, resulting in its activation by means of autophosphorylation and dimerization  <cit> . activated egfr binds to and phosphorylates adapter protein shc  at the cell membrane  <cit> . phosphorylated shc forms a complex with grb <dig> and sos proteins and activates the membrane bound gtpase ras  <cit> . activated ras  triggers a mapk cascade which consists of consecutive activation and deactivation of raf , mek  and erk   <cit> . this pathway has many nested feedback loops, three of which were considered in this study. the first is a negative feedback from erk to sos. activated erk  phosphorylates sos causing its inactivation, which results in a decline in the activity of ras and subsequently raf  <cit> . the second is a negative feedback caused by pperk mediated inhibition of raf activation  <cit> , and the third is a negative feedback by pperk mediated activation of map2k  phosphatases  <cit> .

the mapk pathway was conceptually divided into six modules, where each module is a functional unit which consists of several biochemical interactions and performs one or more identifiable tasks  <cit> . from the top, these modules are  and 2): 

 <dig>  the receptor module which consists of the interactions leading to receptor  activation upon ligand stimulation

 <dig>  the adapter module which consists of the phosphorylation of shc and its complex formation with grb2sos

 <dig>  the initiator module which consists of the activation and deactivation of rasgdp

 <dig>  the map3k module which consists of the activation and deactivation of raf

 <dig>  the map2k module which consists of the activation and deactivation of mek

 <dig>  the mapk module which consists of the activation and deactivation of erk.

only a single entity of each module serves as its output  and carries the signal to the next module in the cascade. for the mapk pathway, prd , pshc-grb2sos complex, rasgtp, aaraf , ppmek and pperk were considered to be the outputs of their corresponding modules.

we developed a mathematical model to simulate the responses of different modules of the mapk pathway to a series of experimental perturbations.

computational simulation of the mapk pathway
our mathematical model consists of a set of ordinary differential equations  which describe the biochemical reactions of the mapk pathway . using this model we simulated different perturbations each affecting a single module. the receptor, adapter, initiator, map3k, map2k and mapk modules were perturbed by knocking down egfr, shc, ras, raf, mek and erk genes respectively. knockdown of a gene was simulated by reducing the expression level of its protein product, which depends on the efficiency of the knockdown. we assumed for illustration purpose that if a gene is knocked down with 80% efficiency then the expression level of its product protein is reduced to 20% of its original level. each knockdown experiment was repeated three times with 40%, 60% and 80% knockdown efficiencies. after each perturbation, the mapk pathway was allowed to reach a new steady state and the steady state responses of the output of each module was measured.

network reconstruction from simulated response of the mapk pathway
for network reconstruction, we calculated the global responses of each module to different perturbations using eq.  <dig>  these responses form the global response matrix r. the rows of this matrix represent the network modules and the columns represent the perturbations performed on the mapk pathway. r was then row standardized, i.e. each of its row was divided by its standard deviation. the standardization was performed to ensure equal variability in the responses of each module. the standardized global response matrix was then used to reconstruct the modular network of the mapk pathway using bvsa. firstly, the mapk network was conceptually divided into six subnetworks, each of which corresponds to a certain module and its potential regulators. the topology of each subnetwork  was inferred separately, by sampling from the posterior distribution ) of the corresponding binary variables  using five parallel gibbs samplers. each of these samplers produced  <dig> realizations  of ai in as many iterations. the convergence of these samplers are illustrated in additional file 4: figure s <dig>  we rejected 20% of the initial samples drawn by each sampler as burn-ins and used the rest of the samples to estimate the probabilities pij = p.

evaluating the performance of bvsa
bvsa produces a probability matrix p with the elements pij representing the posterior probability that module j directly influences module i. using the threshold probability , the performance of bvsa was evaluated for a range of pth values, starting from pth =  <dig>  gradually incremented by  <dig> , up to a maximum value of pth =  <dig>  for each value of pth, a network model was generated and compared with the true network model shown in figure  <dig>  the comparisons were performed by calculating the true positive  rate , false positive  rate  <cit>  and precision  <cit>  of the inferred networks. the tp rate is the ratio of total number of the correctly identified interactions to the total number of interactions present in the true  network  <cit> . the fp rate is the ratio of the total number of incorrectly identified interactions and the total number of possible interactions which are absent in the true network  <cit> . precision is the ratio of the total number of correctly identified interactions to the total number of interactions present in the inferred network. the curve that depicts tp rate as a function of fp rate is known as receiver operating characteristics  curve  <cit>  and the curve that depicts precision as a function of tp-rate  is known as precision-recall  curve. we calculated the areas under the roc and pr curves for each inferred network. these two quantities, denoted by auroc and aupr respectively, give us a quantitative representation of the accuracy of the inferred networks. both auroc and aupr can have values between  <dig> and  <dig>  and the closer these values are to  <dig> the better is the accuracy of the inferred networks, with auroc = <dig> and aupr = <dig> being the ideal case.

since bvsa uses a mcmc method to approximate the posterior distribution of the network structure its accuracy depends on the approximation error. hence, it is necessary to evaluate the robustness of bvsa against mcmc related approximation errors. this was done by executing bvsa  <dig> times on the same dataset. this resulted in  <dig> different probability matrices from each of which we calculated the aurocs and auprs. then we calculated the mean and standard deviations of the aurocs and auprs. the mean auroc and aupr represent the average performance of bvsa, and the standard deviation represents the uncertainty surrounding the performance estimate. for bvsa to be robust, the standard deviations of auroc and aupr must be much smaller than the corresponding means. the mean auroc and aupr were found to be ≈ <dig>  and ≈ <dig>  and the corresponding standard deviations were ≈ <dig>  and ≈ <dig>  respectively, suggesting near perfect and highly robust performance of bvsa on the simulated data.

we compared the performance of bvsa with that of stochastic mra  <cit> , sbra  <cit>  and lmml  <cit> . since the simulated perturbation responses are noise free, there are no uncertainties surrounding these responses. therefore, in case of mra, we did not perform any monte carlo simulation  <cit>  and the connection coefficients were estimated from the global response matrix r using tlsr  <cit> . the absolute values of the estimated connection coefficients represent the topology of the reconstructed mapk pathway. accordingly, the auroc and aupr values ) were calculated by thresholding the absolute values of the connection coefficients using a set of threshold values ranging from  <dig> to ∞.

similar to mra and lmml, sbra infers the interaction strengths in the form of a weight matrix w <cit> . an element wij of this matrix represents the strength with which node j influences the activity of node i. the sign of the weights were discarded from our analysis and auroc and aupr values were calculated in the same way as in the case of mra and lmml. the uncertainty surrounding the auroc and aupr values were estimated in the same way as in the case of bvsa ).

network reconstruction from noisy datasets
the perturbation responses simulated by the ode model are noise free. real biological datasets are usually contaminated with biological noises and measurement errors. we introduced biological noise and measurement errors in the mapk pathway simulations and used the resulting noisy datasets for network reconstruction. biological noise is caused by many factors, such as, random thermal fluctuations, brownian motion of the biochemical molecules, genetic variability within a cell population, etc. we developed a stochastic differential equation  model to simulate the effects of some of these factors  <cit>   on the dynamics of the mapk pathway. the sde model was simulated using stratanovich scheme and milstein method  <cit> . the effect of cell to cell variability on the perturbation responses of the mapk pathway was ignored  <cit>  to keep the analysis within tractable conditions.

furthermore, we added measurement errors to the stochastically simulated responses. measurement errors in biological datasets depend on many factors ranging from inherent biological variability to sample preparation and consistent equipment accuracy  <cit> . in almost all cases, measurement errors at least partly depend on the intensity of the signal being measured  <cit> . in many genetic and proteomic measurement systems this dependence is log-linear, i.e. linear in log scale. a simple model describing the measurement error as a function of the signal intensity is shown below  <cit> .

  σe2=αb+βsexp 

here, σe <dig> is the variance of the measurement error in log scale, αb is the signal independent or background noise, βs is signal dependent noise and y is the logarithm of the signal intensity. the background noise αb and the signal dependent noise βs vary among different measurement systems. however, in most high throughput proteomic experiments αb< <dig>  and βs< <dig>  <cit> . network inference was performed for different levels of signal dependent  and independent  measurement errors. we started with αb =  <dig> , βs =  <dig>  and generated  <dig> datasets by repeating the stochastic simulations of the perturbation experiments and then introducing random measurement errors. a network was inferred from each of these datasets using bvsa. similar to the noise free data, we used five parallel gibbs samplers for each module. in this case we used  <dig> iterations since noisy data may slow down convergence. to see whether all parallel samplers converge to the same distribution we plotted  the log) for a sample dataset. the parallel samplers generally converged rapidly to the same distribution. as before, we rejected 20% of the early samples as burn ins and the rest of the samples were used to calculate the posterior edge probabilities pij. a posterior edge probability matrix p was inferred from each of the  <dig> datasets using bvsa. a set of auroc and aupr values were calculated from each p. the mean and standard deviation of the resulting  <dig> aurocs and auprs were calculated. αb and βs were then gradually increase by intervals  <dig>  and  <dig>  respectively up to the maximum values αb =  <dig>  and βs =  <dig>  for each combination of αb and βs we repeated the above procedure and calculated the average auroc and aupr values and the corresponding standard deviations . the average auroc and aupr values were then compared with those calculated from the networks inferred by stochastic mra, sbra and lmml.

as in the case of bvsa, the performances of stochastic mra, sbra and lmml were also evaluated by generating  <dig> datasets for each noise level  and executing these algorithms on each of these data sets. the resulting connection coefficient matrices  and weight matrices  were then used to calculate the corresponding auroc and aupr values. the resulting auroc and aupr values  were compared with those calculated from the networks inferred by bvsa and two best performers, one with maximum average auroc and one with maximum average aupr, were selected  at each noise level . our analysis reveals that, bvsa has the highest average auroc in most of the cases, except a few sporadic cases where the other algorithms performed better ). by contrast, sbra has the highest average aupr in most of the cases ). this suggests that bvsa infers a larger number of interactions with reasonable accuracy, whereas sbra infers a smaller number of interactions with relatively higher precision.

network reconstruction from incomplete sets of perturbations
for real biological networks,it often is impossible to perturb each network module, separately or in combination. accordingly, the resulting datasets usually do not contain complete information for a full reconstruction of the underlying network. here we demonstrate that even in such cases bvsa can reveal salient features of network structures with better accuracy than its counterparts.

firstly, we simulated steady state responses of the mapk pathway after perturbing only five out of six modules  modules by knocking down shc, ras, raf, mek and erk one at a time. we assumed that the knockdowns were performed with 80% efficiency. the simulations were performed stochastically to account for biological noise. additionally, simulated measurement errors  were added to the perturbation responses. no repetitions of the knockdown experiments were performed. this yielded noisy steady state responses of the mapk modules to five different perturbations. classical mra  <cit> , its stochastic counterpart  <cit>  and sbra are unable to reconstruct a network from this dataset due to its rank deficiency. however, bvsa and lmml are designed to reconstruct networks in situations where the number of perturbation experiments is less than the number of network modules. we generated  <dig> datsets with five perturbations  and inferred network structures from each of these datasets using bvsa and lmml. we then calculated average auroc and aupr values for each of the inferred networks. the aurocs and aupr values, calculated from the networks inferred by bvsa algorithm were then compared with those of the lmml algorithm to determine the best performer . the procedure was repeated by perturbing only four  and three  modules out of six. this analysis revealed that the performance of bvsa was significantly better than that of the lmml algorithm when faced with incomplete perturbation data.

in the simulation study of the mapk pathway we established that bvsa can accurately infer network structures from perturbation data and it is robust against biological noises, measurement errors, and insufficient perturbation experiments. however, the above study does not demonstrate the scalability of bvsa, i.e. whether bvsa can be efficiently implemented to infer larger networks, e.g. grns consisting of hundreds or even thousands of genes. below, we address this issue by using simulated perturbation responses of a  <dig> gene and a  <dig> gene grn and compare its performance with that of  mra, sbra and lmml.

simulation study: in-silico grns
for this study we chose two in-silico gene regulatory networks which were previously provided as a part of the fourth network inference challenge of the dream consortium http://wiki.c2b <dig> columbia.edu/dream/index.php/ challenges. the chosen networks are indexed as network  <dig> in the  <dig> gene and  <dig> gene categories, respectively, in the dream- <dig> data repository . the networks were perturbed by knocking out the component genes one by one. following each perturbation the responses of the other genes in the network were measured. the knockout experiments were simulated using the genenetweaver  <cit>  software. no biological or technical replicates were simulated for the perturbation experiments. we used the normalized perturbation  responses for network inference.

we used bvsa, stochastic mra  <cit> , sbra  <cit>  and lmml  <cit>  to infer the topologies of the above networks from the perturbation data provided by the dream consortium. in case of stochastic mra, the connection coefficients were inferred using the tlsr algorithm  <cit> , but the uncertainties surrounding the estimated values of the connection coefficients could not be inferred due to the lack of replicate experiments . we executed each algorithm  <dig> times  <dig> on the same datasets and calculated:  the average auroc and the corresponding standard deviation,  the average aupr and the corresponding standard deviation,  the average time taken to finish execution for each of the four algorithms. the results of this analysis, along with the performances of the winning algorithms  in the  <dig> and  <dig> gene categories of the fourth dream challenge is shown in table  <dig> 

the results are shown in mean ± std format. the information regarding the performance of kuffner et. al.’s algorithm on the  <dig> gene dataset is not available since they did not participate in the  <dig> gene category of the dream <dig> challenge. the execution times of pinna et. al.’s amd kuffer et. al.’s algorithms were not published and therefore not available. unavailble information is shown by ‘na’ in the table.

the results  suggest that in the  <dig> genes category bvsa outperformed most of the other algorithms  except that of kuffner et. al.  in terms of accuracy. a possible reason behind the fact that kuffner et. al.’s algorithm performed better than bvsa is that their algorithm uses five different types of data, i.e. knockdown, time series, multi-factorial and double-knockout data in addition to the single knockout data for network reconstruction  <cit> , whereas bvsa uses only single knockout dataset. the heterogeneous datasets provide a wealth of additional information about the network topology which bvsa is currently unable to use and therefore does not perform as well as kuffner et. al.’s algorithm. in terms of execution time, bvsa took more time  to finish execution than sbra  but less time than lmml  in the  <dig> gene category. the execution time of kuffner et. al.’s algorithm is unavailable.

in the  <dig> genes category, bvsa outperformed most of the other algorithms  except that proposed by pinna et. al.  in terms of accuracy. kuffner et. al. did not participate in the  <dig> genes category. in terms of execution time, bvsa  outperformed both sbra  and lmml  in the  <dig> genes category. the execution time of pinna et. al’s algorithm  <cit>  is not available. in both  <dig> and  <dig> genes category stochastic mra was the fastest with execution time of  ≈  <dig>  seconds and ≈  <dig>  seconds respectively. this is due to the fact that we could not perform mcmc simulation for stochastic mra to estimate the probability distributions of the connection coefficients. instead, we calculated point estimates of the connection coefficients using the tlsr method  <cit> . however, if a mcmc simulation was performed, then the performance of the stochastic mcmc algorithm would have been considerably slower. this is demonstrated in the next section, where we used real biological data with multiple biological and technical replicates.

encouraged by the above results we used bvsa to infer the topology of the erbb regulated g1-s transition pathway in breast cancer cells from real experimental data.

real datasets: erbb regulated g1/s transition in human breast cancer cells
erbb receptors are a family of four structurally related receptor tyrosine kinases  which form homodimers, heterodimers, and possibly higher-order oligomers upon activation by growth factors such as egf, tgf- α etc. activated erbb dimers act as docking sites for a myriad of adapter proteins which simultaneously initiate many signaling cascades such as the akt pathway, mapk cascades, the jak/stat pathway etc. many of these pathways tightly regulate different phases of cell cycle in eukaryotic cells.

at the end of g <dig> phase of cell cycle when the cells reach their final stage of growth they decide whether to divide, delay division or enter a resting stage. the decision making process involves phosphorylation of the retinoblastoma protein prb by different cyclin/cdk complexes. unphosphorylated prb proteins bind to e2f family of transcription factors and inhibit its activity. upon phosphorylation, prb proteins dissociate from e2f resulting in its activation. a eukaryotic cell commits to divide and initiates dna replication  when active e2f triggers transcription of the necessary genes. the erbb regulated signaling pathways influence this mechanism by releasing cyclin/cdk complexes from their inhibitor proteins  p <dig> and p <dig>  in 20-30% of breast cancers, erbb <dig>  a member of the erbb family of receptors, is overexpressed resulting in a malfunction of control points in the cell division process and unrestricted growth. these cancers are usually treated with trastuzumab, a recombinant antibody designed to block the erbb <dig> activity. however, about two third of the erbb <dig> overexpressing breast cancer patients are found to be trastuzumab resistant ab. initio  <cit> . in these patients, the cancer cells are able to overcome the cell cycle arrest mechanisms even though erbb <dig> is blocked by trastuzumab. the mechanisms which allow the breast cancer cells to bypass cell cycle arrest is not well understood and currently under intense research.

in a notable effort, sahin et. al. systematically perturbed key components of erbb mediated signaling pathways and the g1/s transition mechanisms in trastuzumab resistant breast cancer cells to understand how the former influence the later and vice versa  <cit> . rnai was used to individually knock down the expression of the genes corresponding to erbb <dig>  erbb <dig>  erbb <dig>  akt, mek, cmyc er- α, igf1r, p <dig>  p <dig>  cdk <dig>  cdk <dig>  cyclin-d <dig>  cyclin e <dig> and prb <dig> in hcc <dig> cells  <cit> . the first seven of these proteins are part of the erbb mediated signaling pathways and the rest are part of the g1/s transition mechanism. after each knockdown, the cells were stimulated with egf for  <dig> hours and the expression levels of erbb <dig> erbb <dig>  p <dig>  p <dig>  cdk <dig>  cdk <dig>  cyclin-d <dig> and phosphorylation levels of erk, akt, prb were measured using reverse phase protein arrays  <cit> . we analyzed these measurements <dig> using bvsa,  mra, sbra and lmml to unravel the interactions among the above proteins. to estimate the accuracy of each of these algorithms, we first developed a literature based reference pathway  which represents our current knowledge about how the above proteins interact with each other to regulate g1/s transition in an erbb dependent manner. then we compared the topology of the reference pathway with those reconstructed by bvsa, mra, sbra and lmml. below we describe the results of our analysis.

in case of bvsa, we used five parallel gibbs samplers to search for the potential regulators of each protein. each sampler was allowed to sample for  <dig> iterations. the entire simulation took ≈ <dig> minutes to complete on an intel core i7-820m processor based laptop computer with  <dig> giga bytes of ram. to see whether all parallel samplers converge to the same distribution we plotted  the log-marginal log) of the samples drawn by the samplers. the parallel samplers converged rapidly to the same distribution. as before, we rejected 20% of the early samples as burn ins and the rest of the samples were used to calculate the posterior edge probabilities pij. the posterior edge probabilities were then thresholded using the thresholding scheme described above.

the inferred network ) reveals many well known mechanisms by which the erbb mediated signaling pathways regulates the g1/s transition point of cell cycle. for example, the regulation of the cdk inhibitors p <dig> and p <dig> by the erk pathway, the interplay between cyclin-cdk complexes, their inhibitors  and their target protein prb were identified. some less recognized mechanisms of cell cycle regulation were also detected. for instance, p <dig> and prb <dig> were found to be directly regulated by erbb. it was previously demonstrated that src and the jnk pathway, which are downstream to erbb  <cit> , can regulate the activity of p <dig> and prb <dig> respectively in an akt and erk independent manner  <cit> . since neither src nor the components of the jnk pathway were measured in the perturbation experiments  <cit> , the erbb mediated regulation of p <dig> and prb <dig> via these pathways were detected by bvsa as direct interactions.

similarly, erk was also found to directly regulate the activity of prb <dig> ). previous experimental results indicated that the activity of prb <dig> can be regulated by the p53/mdm <dig> pathway  <cit>  which itself is regulated by the erk pathway  <cit> . since p <dig> and mdm <dig> were not measured in the perturbation experiments  <cit> , the erk mediated regulation of prb <dig> via this pathway was inferred as a direct interaction ).

we also identified a number of potential feedback mechanisms. for instance, prb was found to feedback into its upstream kinases cdk <dig>  cdk <dig> and even further upstream, into the kinases akt and erk ). experimental studies by other researchers suggest that these feedback loops are mediated by the transcription factor e2f which is activated upon phosphorylation of prb. activated e2f directly binds to the cdk <dig>  <cit>  promoter and activates its transcription. e2f is also found to transcriptionally regulate akt <dig>  <cit>  resulting in a feedback regulation of prb. on the other hand, e2f transcriptionally activates pac <dig> which dephosphorylates erk  <cit>  thereby completing a negative feedback loop. e2f also can activate arf which upregulates the stability of the p <dig> protein  <cit> . p <dig> inhibits the translation of the cdk <dig> protein  <cit>  forming a feedback loop.

some of the feedback mechanisms identified in this analysis can potentially explain the observed trastuzumab resistance in hcc <dig> cells. in fact, our reconstructed model identified two feedback mechanisms which were experimentally proved by other researchers to cause trastuzumab resistance in erbb <dig> overexpressing breast cancer cells. these feedback loops involve akt and erk mediated regulation of erbb receptors ). previously, it was demonstrated that akt, a downstream kinase of erbb, inhibits adam <dig> which activates tgf- α, a potent ligand for erbb receptors  <cit> . inhibiting erbb <dig> using tratuzumab inhibits akt and upregulates adam <dig>  <cit> . adam <dig> activates many erbb ligands which keeps erbb pathways activated  <cit> . however, the activity of adam <dig> was not measured in the perturbation experiments  <cit>  which we considered for our analysis and the feedback regulation of erbb by akt via adam <dig> was inferred by bvsa as a direct network connection from akt to erbb.

additionally, the erk-erbb feedback loop which was also inferred by bvsa as a direct feedback from erk to erbb is in-fact mediated by egr <dig>  <cit> , a target gene of the erk pathway  <cit> .

we found credible evidence in the literature to support all but two interactions inferred by bvsa. the literature references regarding the inferred interactions are provided in the si. at the same time, a few known mechanisms involving erbb regulated signaling pathways and the g1/s checkpoints were not identified by bvsa. in figure  <dig>  we have shown the identified, unidentified and falsely identified interactions.

we also used the median probability model, i.e. pth =  <dig>   <cit> , to reconstruct the above pathway from the probability matrix p which was inferred by bvsa. the resulting network is shown in additional file 10: figure s <dig>  the inferred network shares a number of interactions with that derived by the thresholding scheme which was proposed in this paper. however, it fails to identify some well known interactions which were successfully inferred by our proposed thresholding scheme, e.g. erbb mediated regulation of erk, the roles of cyclin dependent kinase inhibitors, prb <dig> mediated feedback regulations, the autocrine loops etc.

for further comparisons, we employed mra  <cit> ], sbra [ <cit>  and lmml  <cit>  to reconstruct the erbb <dig> regulated g1/s transition network from the same dataset as above  <cit> . in case of mra,  <dig> random realizations of the steady state perturbation responses were drawn from gaussian distributions with means and standard deviations obtained from experimental data  <cit> . the connection coefficients were calculated from each realization of the perturbation responses using tlsr  <cit> . the resulting  <dig> realizations of each connection coefficient rij were used to infer the structure of the erbb regulated g1/s transition mechanism. in most cases, a few realizations  of a connection coefficient rij had very different values from the bulk of its values. these “outliers” were discarded by rejecting 1% extreme values of each rij. the connection coefficients which had high variances even after rejecting the outliers were assumed to be unidentifiable and were discarded from the analysis. the values of the remaining connection coefficients were then subjected to a z-test which calculates a p-value to determine whether its mean is close enough to  <dig>  if the p-value is less than  <dig>  then the mean of the rij is significantly different from  <dig>  i.e. in this case, rij represents a true network connection. we then used the benjamini-hochberg  <cit>  procedure to correct for multiple testing and eliminate any falsely discovered network connection. to determine whether rijrepresents an activating or inhibitory interaction we first calculated the histogram of each rij. the histograms are shown in additional file 11: figure s <dig>  if the fraction of negative realizations of rijis larger than the fraction of positive realizations then rij is assumed to represent an inhibitory interaction. otherwise, it represents an activating interaction. the above procedure took approximately  <dig> hours and  <dig> minutes to complete by the same computer which was used to implement bvsa on the erbb <dig> dataset. the network which was reconstructed this way is shown in figure  <dig>  stochastic mra inferred many well known interactions ) which take part in the erbb <dig> mediated g1/s transition control mechanism. however, it also inferred a large number of interactions ) which could not be supported by evidence from the literature. these interactions are most probably falsely identified interactions.

furthermore, we reconstructed the same pathway using sbra. sbra does not infer connection coefficients. instead, it infers a weight matrix w which represents the strength of the interactions. the sign of the elements of w represents whether the corresponding interaction is activating or inhibitory. sbra took approximately  <dig> minute and  <dig> seconds to execute as opposed to  <dig> minutes for bvsa and  <dig> hours  <dig> minutes for mra. the network structure constructed from the inferred weight matrix is shown in figure  <dig>  similar to mra, sbra also inferred a number of well known interactions along with a large number of interactions which are most likely to be false positives.

finally, we reconstructed the erbb pathway using lmml  <cit> . it took approximately  <dig> minutes and  <dig> seconds to finish executaion as opposed to  <dig> minutes for bvsa,  <dig> minutes  <dig> seconds for sbra and  <dig> hours  <dig> minutes for mra. the network inferred by lmml is shown in figure  <dig>  lmml also inferred many known interactions along with a relatively large number of interactions which could not be supported by literature evidence.

the above analysis suggests that bvsa provides an overall faster and more accurate solution to the network reconstruction problem when compared to other network inference algorithms such as mra, sbra and lmml. however, our comparison of accuracy depends on the reference erbb pathway which was constructed from literature. we selected only highly cited experimental results to construct the reference pathway. however, not all of these experiments were performed on the same cell line as the one used by sahin and colleagues  <cit> . therefore, the reference pathway  should only be treated as a plausible generic mechanism of erbb mediated g1/s transition and the result of the comparative analysis presented in this section should be treated with its fair share of scepticism.

discussion and 
CONCLUSIONS
in this paper, we propose a network inference algorithm which combines modular response analysis with bayesian variable selection techniques. this algorithm is capable of reconstructing network topologies from noisy perturbation responses of biochemical systems. it is more accurate than two previously proposed stochastic formulations of mra, one based on tls regression  <cit>  and the other based on repeated tls regressions using an mcmc sampler  <cit> . the increased accuracy of bvsa is a result of the fact that bvsa penalizes dense networks by implementing appropriate prior distributions for the unknown variables , thereby minimizing the possibilities of false positives, whereas the stochastic mra methods lack this capability due to lack of appropriate regularization techniques. the proposed bvsa algorithm is also performs better than a recently proposed levenberg-marquardt optimization based maximum likelihood  method  <cit>  and a previously developed sparse bayesian regression method   <cit> . this is most likely due to the fact that bvsa implements a model averaging technique, which determines the network topology by averaging a set of likely network models, whereas lmml and sbra implement two different model selection techniques, each of which find a single network model that maximizes a likelihood function. it was shown by many researchers  <cit> - <cit>  that model averaging performs better than model selection  which may explain why bvsa performs better than lmml and sbra. we also demonstrated that bvsa can reconstruct network topologies even when the number of perturbation experiments are not sufficient for a full network reconstruction using other algorithms such as mra  <cit>  and sbra  <cit> . it is computationally less expensive compared to many other statistical network inference algorithms, e.g. mcmc based mra  <cit> , sbra   <cit>  and lmml  <cit> . however, the capability of the bvsa algorithm is limited to inferring binary interactions, whereas mra, sbra and lmml can also infer the connection coefficients which represent the strength and type  of each interaction. such information is necessary to understand the molecular mechanisms by which a biochemical network operates. although, bvsa cannot directly estimate the connection coefficients, these quantities can be readily estimated using linear regression, once a binary network topology is inferred using bvsa algorithm. however, a more systematic approach in estimating the connection coefficients from perturbation data needs to be developed. therefore, in our future research, we plan to extend the bvsa algorithm to infer the connection coefficients of biochemical networks.

additionally, bvsa is vulnerable to collinearity in experimental data  <cit> , i.e. if perturbation responses of different network nodes are collinear then bvsa may not perform to its full potential. therefore, one must practice caution in designing the perturbation experiments and make sure that the perturbation responses of different network nodes are as orthogonal as possible.

the biggest concern of using statistical network inference algorithms to analyze biological datasets is the reliability of the predicted networks. one way of increasing reliability is to make systematic use of all existing information regarding the biochemical networks which the researcher wants to explore  <cit> . bvsa, at its current stage, incorporates only subjective knowledge regarding abstract topological properties of generic biochemical systems in its inference engine. to improve its accuracy and reliability, it should be customized to take network specific objective knowledge into account. in our future research, we plan to focus on incorporating network specific knowledge into the inferential framework of the bvsa algorithm and thereby increasing its accuracy.

