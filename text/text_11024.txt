BACKGROUND
reef-building corals support productive and diverse marine communities that provide important ecosystem services  <cit> , but are threatened throughout their global range by a variety of stressors that include increasing sea surface temperatures, pollution, ocean acidification and disease  <cit> . a major focus of contemporary coral biology is to understand the factors determining stress resilience of corals and the potential for coral populations to recover from or adapt to these stressors  <cit> . the responses of coral holobionts to heat and light stress are especially complex because of the symbiotic association between reef-building corals and algae . the effects of light and temperature stress on these intracellular symbionts have been well characterized  <cit> , but the genetic determinants of stress tolerance in the coral host, and any interaction effects between coral and zooxanthellae phenotypes, remain poorly understood  <cit> . genomic resources such as genome or transcriptome sequences would make possible the detailed studies of gene expression, genetic connectivity, and stress physiology required for addressing these questions.

the genomic sequence resources currently available for corals are limited  <cit> . about  <dig>  to  <dig>  reads from pilot shotgun sequencing projects are available at ncbi for each of three corals , but no coral genomes have been completed and to our knowledge no genome sequencing projects are underway for any coral species. a number of studies have developed est resources for corals using sanger sequencing  <cit> . the staghorn coral acropora millepora  has emerged as the most extensively sequenced scleractinian coral, with ~ <dig>  ests and ~ <dig>  shotgun genome sequences publicly available at ncbi. additional est sequencing projects using this species are ongoing but the results are not yet publicly available  <cit> . these est sequencing efforts have allowed development of small-scale microarrays for gene expression analysis in the context of coral stress physiology  <cit> , and similar studies aiming to identify stress candidates are currently underway  <cit> . these studies have highlighted the utility of cdna sequencing for candidate gene discovery in the absence of a genome sequence, but a comprehensive description of the full complement of genes expressed in corals remains unavailable.

the increased throughput of next-generation sequencing technologies such as  <dig> sequencing  <cit>  shows great potential for expanding sequence databases of corals and other emerging model organisms .  <dig> sequencing of transcriptomes for organisms with completed genomes has confirmed that the relatively short  reads produced by current versions of this technology can be effectively assembled and used for gene discovery  <cit> . these methods have not yet been widely applied to emerging model organisms, because of the lack of methods for de novo assembly and analysis in the absence of a reference genome sequence. nevertheless, the few examples published to date have successfully demonstrated the potential for discovery of genes and genetic markers in these systems  <cit> . despite their obvious potential, next-generation sequencing methods have not yet been applied to corals.

in this study, we describe improved methods for cdna library preparation and titration for de novo transcriptome sequencing of any organism using  <dig>  as well as sequence analysis and annotation procedures. the strategy outlined here does not require prior sequence knowledge, and relies exclusively on publicly available software and basic scripting tools. we applied these methods to sequence the larval transcriptome of the widely-studied coral a. millepora. the assembled, annotated sequences so produced provide a nearly complete catalog of the genes expressed in planulae larvae.

RESULTS
 <dig> sequencing, assembly, and sequence analysis
a cdna sample was prepared from coral larvae as illustrated in figure  <dig>  and sequenced using the  <dig> gs-flx platform. this single sequencing run produced  <dig>  reads, with an average sequence length of  <dig> bases . an overview of the sequencing and assembly is given in table  <dig>  after removal of adaptor sequences,  <dig>  reads remained, with an average length of  <dig> ±  <dig> bases. this comparison revealed that 99% of the reads produced contained useful sequence data. a total of  <dig> mb of raw sequence data were generated, of which  <dig> mb remained after adaptor trimming . size-selection to remove outlier reads  reduced this to  <dig> mb . the size distribution for these trimmed, size-selected reads is shown in fig 2a, revealing that 92% of trimmed reads fell between  <dig> and  <dig> bp in length.

assembly of the trimmed, size selected reads along with the publicly available est sequences  for a. millepora produced  <dig>  contigs, with  <dig>  reads remaining as singletons. contigs ranged from  <dig> to  <dig>  bp in size, with an average of  <dig> bp and an n <dig> of  <dig> bp . the size distribution for these contigs is shown in fig 2b. the assembly produced a substantial number of large contigs:  <dig>  contigs were > <dig> bp in length, and  <dig>  were > <dig> kb. sequencing coverage ranged from  <dig> to  <dig>  with an average coverage of  <dig>  as expected for a randomly fragmented transcriptome, there was a positive relationship between the length of a given contig and the number of reads assembled into that contig . the majority of assembled reads were incorporated into the top  <dig>  largest contigs, which included 74% of the bases sequenced and accounted for 47% of the total assembled length .

singleton sequences  were retained on the basis that although some singletons might represent artifacts or contaminants, others are likely fragments of transcripts present at low levels in the original sample. this interpretation is supported both by analysis of sequence similarity and by pcr validation of singletons.  <dig>  of the  <dig>  singletons had significant blast matches in the swiss-prot database, and nearly half of these top hits  were not found among the top hits from contigs in this same database. this finding suggests that singletons contain sequence information not found among contigs, consistent with the possibility that they represent unique genes expressed at levels low enough to hinder adequate sampling. to confirm that these sequences were present in our experimental material , we randomly selected  <dig> singletons for primer design. pcr analysis confirmed, for  <dig> of the  <dig> tested, that these sequences are present in the original cdna . these  <dig> primer pairs each produced a single band of the expected molecular weight, and the others gave either no product or multiple bands. a large number of cycles  were required to produce detectable products, consistent with the possibility that these sequences represent genes expressed at low levels. sanger sequencing of the eight successful pcr products confirmed the identity of five, with the other three matching poorly to the target singletons .

singleton sequences are identified by sequence identifiers for sra <dig>  with the size  and quality  of the alignment between the  <dig> sequence and the sanger sequence. scaffolds are identified by accession numbers, with sequence identity shown for the 5'-most contig and the 3'-most contig contained in that scaffold.

of the  <dig>  assembled sequences ,  <dig>  had significant matches in public protein sequence databases . these blast matches correspond to  <dig>  different unique accession numbers, of which  <dig>  were each matched by multiple queries without overlap. these  <dig>  subject sequences correspond to  <dig>  different query sequences . for each of these protein sequences, all queries matching that subject were joined together in the appropriate order and strand  to produce a scaffold, a construct intended to represent the collection of fragments originating from a single transcript. overall, the contig joining process condensed the number of sequences from  <dig>  to  <dig> . to validate the contig joining procedure, ten sets of sequences that had been joined in this fashion  were randomly selected for validation. note that because the gaps in scaffolds are of unknown length, the scaffold sequences provide minimum expectations for pcr product size. all ten scaffolds were successfully amplified by pcr . sanger sequencing of these pcr products confirmed the identity of eight scaffolds at both ends, and the other two at only one end . these findings confirm that the scaffolds produced from our contig joining procedure successfully recapitulate cdna sequences in most cases. this strategy successfully identified different parts of the same transcript for > <dig>  transcripts in our study, and should be widely applicable for other transcriptome sequencing efforts in emerging model organisms.

the preceding steps, including assembly of raw reads and contig joining, were expected to reduce redundancy among sequences . to characterize any redundancy that remained, assembled sequences were clustered using two parallel procedures based on  nucleotide sequence similarity among the assembled sequences themselves, and  protein sequence similarity among the query sequences' best blast matches. the final set of  <dig>  merged clusters was obtained from the union of these protein and nucleotide sequence clusters. excluding the large clusters matching transposable elements, sequence clusters ranged from  <dig> to  <dig> sequences in size, with most containing only 1– <dig> sequences and a small number of clusters containing more than  <dig>  the largest clusters could indicate paralogs, highly-divergent alleles, well-conserved gene families, alternative splice variants, or simply high levels of expression with correspondingly high sequencing error due to increased sampling. regardless of the biological interpretation of sequence clusters, the clustering of  <dig>  assembled sequences into  <dig>  clusters indicates that relatively little redundancy remained after assembly and joining. annotation of sequences clusters allows the rapid identification of all sequences with similarity to a particular gene of interest, facilitating studies of sequence polymorphisms and closely related genes.

functional annotation of the transcriptome
because the significance of sequence similarity depends in part on the length of the query sequence, short sequencing reads obtained from next-generation sequencing  frequently cannot be matched to known genes  <cit> . most of the  <dig>  assembled sequences analyzed here are short , and correspondingly few have significant blast matches in ncbi's nr database . the proportion of sequences with matches in public databases is greater among the longer assembled sequences, as demonstrated by applying a series of increasing minimum size cutoffs and recording the number of queries with significant matches . among sequences ≥  <dig> bp , significant matches were found in nr for 62%, and among those longer than  <dig> kb, the proportion increased to  <dig> % .

assembled sequences were assigned gene names based on the gene product and gene name annotation of the best blast match for that sequence. this procedure successfully assigned gene names for  <dig>  sequences among the entire dataset; for  <dig>  of the sequences ≥  <dig> bp in length; and for  <dig>  of the sequences ≥  <dig> kb in length . among the  <dig>  annotated best hits,  <dig>  different gene names were assigned, providing a rough estimate of the number of different genes expressed in these libraries. this is probably an underestimate because many sequences lacked matches in public sequence databases  and were therefore not assigned gene names.

analysis of protein domains revealed that  <dig>  of the assembled sequences matched profiles in ncbi's conserved domains database, corresponding to  <dig>  different domains. most domains were found in only 1– <dig> sequences, with a small number appearing more frequently. the top  <dig> most frequently detected domains include conserved domains associated with transcription factors, growth factors, and signaling pathways. the utility of domain annotation is that it allows researchers to quickly select all genes sharing a common domain; for example, selecting the  <dig> different sequences matching the domain cog <dig>  retrieves putative homologs of  <dig> different genes with known roles in development and morphogenesis .

gene ontology terms were assigned to  <dig>  assembled sequences based on sequence similarity with known proteins annotated with go terms . for each sequence, the specific annotated terms were mapped to higher-level  parent terms to provide a broad overview of the groups of genes cataloged in this transcriptome for each of the three ontology vocabularies. the hierarchical structure of these vocabularies allows the selection of sets of genes involved in a specific process at the desired level of detail. for example, go annotation revealed  <dig> sequences implicated in general stress responses, including heat shock factor binding proteins . within this set of general stress response genes, subsets of genes were associated with specific stressors , including heat stress , oxidative stress , and response to wounding . these searches were based on processes that are the focus of ongoing research in coral biology, and identified a number of genes that had not previously been investigated in the context of coral stress responses . these go annotations provide a valuable new resource for investigation of specific processes, functions, or cellular structures involved in coral stress responses.

pathways and complexes
to evaluate the completeness of our transcriptome library and the effectiveness of our annotation procedure, we searched the annotated sequences for the genes involved in a set of metabolic pathways and protein complexes shared among animal phyla. these simple text searches were based on standard gene names or synonyms. this confirmed that our data include annotated sequences for all genes in the five major pathways considered here . in a similar set of searches for components of essential protein complexes, almost all the genes were found . the presence of these essential cellular process genes suggests that these annotated sequences accounts for nearly the complete coral larval transcriptome.

to further evaluate the depth of coverage in this library, we searched the annotated sequences for sets of regulatory genes known to be present in anemone nematostella vectensis, the most closely related organism for which an assembled draft of the genome sequence is available. the rationale for these searches was that the presence of these genes in anemone suggests their presence in coral, and their successfully identification in the coral larval transcriptome would support the completeness of this sequencing effort. for a set of  <dig> genes associated with eight major intercellular signaling pathways,  <dig> were successfully identified in the transcriptome sequences . activin-like kinase was notably absent from this list, but this finding does not imply the absence of this gene in a. millepora; it could simply indicate that the gene is not expressed, or expressed at a very low level, in the developmental stages sampled in this study.

a similar search was conducted for a set of transcription factors known to be present in n. vectensis, based on conserved domains characteristic of each transcription factor family. of the  <dig> families investigated, these searches identified annotated sequences corresponding to  <dig> . these text searches were based on domain identifiers, domain descriptions, and gene names. no matches were found for two families of transcription factors: the cold-shock dna binding domain , and the paired amphipathic helix repeat . the lack of detection of these genes is not evidence that they are absent in the coral larvae; it might indicate their low expression, incomplete sequencing coverage, or inadequate annotation. nevertheless, the overall success in identifying the known sets of genes associated with these pathways and complexes indicates that the collection of sequences established in this study provides a reasonably complete description of the coral larval transcriptome.

comparisons with nematostella vectensis
sequence comparisons revealed broad similarity between the coral sequences described here and the protein sequences predicted from the anemone genome. of the  <dig>  assembled coral sequences,  <dig>  have significant matches among the anemone predicted proteins . these correspond to  <dig>  different predicted proteins. reciprocal blast searches, in which the anemone sequences were queried against the coral sequences, revealed that  <dig>  of the  <dig>  n. vectensis proteins had significant similarity with coral sequences , corresponding to  <dig>  different coral sequences. comparison of the best blast matches from these searches identified  <dig>  unambiguous orthologs between coral and anemone, based on significant reciprocal best matches. because the coral sequences represent partial transcripts, this is likely an underestimate of the true number of anemone orthologs expressed in this developmental stage.

to investigate whether the coral larval transcriptome contains "coral-specific" genes not found in the anemone, the assembled coral sequences were first compared with public databases.  <dig>  coral sequences had significant matches in nr with an e-value ≤ 10-4; these represent sequences with reasonably strong matches to previously identified proteins in other organisms. a list of all coral sequences that showed even weak similarity to anemone proteins was compiled by searching the predicted proteins  and the genome assembly , using a permissive threshold of e ≤  <dig>  . comparison of these results revealed that  <dig> coral sequences matched known genes in other organisms but had no significant similarity to anemone proteins from the draft genome. to reduce false positives stemming from the fact that many assembled sequences were not complete cdnas, the top blast match for each of these  was queried against the anemone proteins with a permissive threshold of e ≤  <dig> . after eliminating the sequences with matches in this search,  <dig> sequences remained, corresponding to  <dig> different annotated coral genes. these analyses suggest that these coral genes lack orthologs in the anemone. because the draft assembly of the anemone genome is not complete  <cit> , further experimental work would be required to verify the absence of these candidate coral-specific genes in the anemone.

snp detection and validation
using the qualitysnp program, we identified  <dig>  high quality snps and  <dig>  indels within  <dig>  cap3-assembled contigs . these predicted snps included  <dig>  transitions and  <dig>  transversions. the overall frequency of all snp types in the transcriptome, including indels, was  <dig> per  <dig> bp. these predictions provide an extensive set of genetic markers for reef-building corals that will enable future studies of genetic connectivity and genetic mapping at a previously unprecedented level of detail.

twenty of these predicted snps  were selected for validation using pcr and sanger sequencing, and  <dig> of these tests  were successful . because the genes selected for validation include several previously described stress responses genes  <cit> , the snps confirmed in these analyses may be valuable for investigating the genetic determinants of stress-gene expression. overall, the successful experimental validation of the majority of computationally predicted snps confirms the utility of mining  <dig> transcriptome sequences for genetic markers.

discussion
methodological advances for  <dig> sequencing of transcriptomes
the methods described here resolve several challenges associated with  <dig> sequencing of transcriptomes. because  <dig> sequencing does not efficiently process homopolymer regions greater than  <dig> bp in length  <cit> , the poly-a tails at the 3' ends of intact transcripts present a problem, and would be expected to result in under-representation of the 3' ends of transcripts. in our method, this is resolved by simply interrupting the poly-t region with a single c. a single copy of this 'broken-t' adaptor was found in  <dig>  of the raw reads , slightly more than the expectation  based on average read length  and assuming an average transcript size of  <dig>  bp. this comparison suggests that the 3' ends of transcripts were well-represented in our dataset, confirming the effectiveness of this solution for overcoming the homopolymer problem. another difficulty in  <dig> transcriptome sequencing is concatenation of adaptors during cdna preparation, an issue that is commonly encountered but seldom reported because concatenated adaptor fragments either fail to sequence or are removed by adaptor trimming, decreasing the final sequencing yield. our library preparation method resolves this difficulty by  sequencing all fragments from an internal end, so that any concatenated adaptors encountered will tend to be found at the end of the read; and  avoiding the over-amplification that can contribute to adaptor concatenation. the empcr titration method described in this study reflects an additional improvement on previous methods that further increases the number of usable reads obtained per run.

comparison of our results with recently published studies that employed  <dig> sequencing confirms the effectiveness of these improvements. first, 95% of the reads produced in our study passed stringent quality filters , an improvement over the 85–90% that passed similar quality filters in previous studies  <cit> . our assembly incorporated 90% of high-quality reads, improving on the 40–88% reported for assemblies in previous studies  <cit> . the average contig size, which is strongly affected by read length, was ~ <dig> bp higher in our study than in a recently published study that also used the  <dig> gs-flx sequencing platform and so began with reads of comparable length  <cit> . our assembly also included a larger proportion of long contigs  than the 8% reported in  <cit> , despite the larger number of reads  from multiple sequencing runs in that study. finally, our library preparation and titration procedures produce 2– <dig> times more reads per sequencing run than standard methods: ~ <dig>  in our study versus ~ <dig>  to ~ <dig>  in previous reports  <cit> . one possible caveat for these comparisons is that our assembly did include a small number of sanger ests , and these might be expected to improve the assembly. however, the effect of these sanger ests on the assembly was actually negligible: a separate assembly that excluded those ests produced only  <dig> % more contigs, 1% more scaffolds, and  <dig> % shorter contigs. overall, these comparisons with previous studies highlight the potential for our method to improve sequencing depth and efficiency in future transcriptome sequencing efforts.

deep sequencing of transcriptomes with  <dig> sequencing typically produces many singleton sequences that fail to assemble, representing 10% of the reads in our study and 13–60% in other recent  <dig> transcriptome assemblies  <cit> . singletons could result from sequencing errors, artifacts of cdna normalization, genes expressed at low levels in the coral, or contaminants from other sources. for example, our cdna was derived from larvae grown in non-sterile conditions and exposed to crustose coralline algae  collected from the reef, suggesting potential sources of contamination. to test for differences between cdnas that remained as singletons and those that were assembled into contigs, a subset of  <dig>  reads was randomly selected from each set. because this comparison was based on sequencing reads, which did not differ in size between the two sets, this comparison avoided the confounding effect of sequence length. contig reads and singleton reads were compared separately against nr using blastn , and the taxonomic origin of their top blast matches was recorded. this confirmed that most sequences in both sets best matched metazoan sequence records from other species, although singleton sequences contained a significantly lower proportion of metazoan matches  than contig reads  . singletons contained a significantly higher proportion of sequences that best matched proteobacteria  and amoebozoa  records than reads that assembled into contigs, suggesting that singletons were enriched in cdna from biological contaminants. however, the absolute numbers of putative contaminant hits were still very low , suggesting that the contamination level was low overall. a notable difference revealed by these comparisons is that a larger proportion of contig reads  had significant matches than singleton reads  . this suggests that a substantial fraction of singletons  were artifacts of cdna synthesis, normalization, or sequencing. despite the potential artifacts and contaminants detected among singletons,  <dig> of the total  sequences matched annotated protein sequences in the nr database, corresponding to  <dig> different genes . these findings support the inclusion of singletons in our analysis on the basis that many represent coding sequence and so could be biologically interesting despite their low expression.

estimating the number of genes expressed in larvae
one of the primary questions for transcriptome sequencing projects is the number of genes expressed, but in organisms lacking a fully-sequenced genome, addressing this question is hampered by several unknowns. first, some contigs are expected to lack matches in public databases and therefore remain as separate sequences after contig-joining. other genes present in a newly-sequenced transcriptome might be represented by fragments that match conserved regions in known genes, as well as fragments corresponding to poorly-conserved regions  that would be expected to lack matches. finally, some sequence fragments might be too short to allow for statistically meaningful matches, regardless of which transcript they were derived from. at the level of coverage obtained in a single sequencing run , sequence assembly alone is not sufficient to produce complete transcript sequences. because the contig joining procedure described here relies on protein sequences similarity, it therefore cannot act on sequences without protein matches. no obvious solutions are available for assembling the sequences from a non-model system transcriptome sequencing project into a number of contigs that precisely matches the number of genes expressed, although paired-end library sequencing might improve the situation.

to arrive at an estimate of the number of genes expressed in this library, several alternative strategies are available that take into account the sources of uncertainty described above.  gene number can be estimated based on the number of well-supported, unique sequences in the assembly as follows. the majority of sequenced bases  assembled into sequences at least  <dig> bp in length , excluding essentially all singleton sequences . the accuracy of these  <dig>  assembled sequences is well supported by their high sequencing coverage . among these high-quality sequences,  <dig>  sequence clusters  were identified, providing one estimate of the number of genes expressed in these libraries.  alternatively, gene number can be estimated based on the assembled sequences that matched known genes, as follows. among those contigs sufficiently long to allow good matches ,  <dig>  showed significant similarity to records in the nr protein database. gene names were assigned to  <dig>  of these on the basis that they matched known genes with annotated coding sequences, corresponding to a non-redundant list of  <dig>  different gene names. of course, many cnidarian genes are expected to lack matches in public databases; for example, 19% of predicted proteins from the anemone n. vectensis lack matches to other known genes  <cit> . based on the assumption that a similar proportion of coral genes would lack matches to known genes, this suggests an adjusted estimate of  <dig>  genes expressed in a. millepora larvae .  finally, gene number can be estimated based on comparisons with the anemone n. vectensis. based on blastx comparisons,  <dig>  of the assembled coral sequences matched to  <dig>  different predicted proteins from the anemone genome. because more redundancy and gaps are expected among our assembled coral sequences than in the draft anemone genome, this should approximate the number of genes expressed in our libraries. although no clear solutions are available to conclusively determine gene numbers without a fully-sequenced genome, the three estimates described suggest that ~ <dig>  different genes are expressed in larvae of a. millepora.

this estimate matches well with previous estimates of the number of genes expressed during metazoan development. about 11– <dig>  genes are expressed during sea urchin development based on whole-genome tiling arrays  <cit> . at least 6000– <dig> genes are expressed during each embryonic or larval stage of nematode development, based on sage libraries  <cit> . about  <dig>  genes are expressed in fruit fly embryos  <cit> . comparison with these previous studies that span different animal phyla and analytical techniques reveals that our estimate of  <dig>  genes expressed in coral larvae is within the expected range for metazoan development.

sequencing depth and annotation success
to evaluate whether the sequences annotated in this study includes all genes expressed in these treatments and developmental stages, we searched for a number of genes involved in metabolic pathways and macromolecular complexes involved in essential cellular processes. for these searches, the lists of genes associated with metabolic pathways were based on the biocyc database of pathways  <cit> , and gene lists for protein complexes were based on the corum database of mammalian protein complexes  <cit> . the rationale for these searches was that since those essential genes must be expressed to maintain cellular functions, any failure to find these sequences in the transcriptome would reflect either inadequate sequencing depth or ineffective annotation. for the pathways and complexes considered here, essentially all genes  were found based on these simple text searches . a caveat for these findings is that high levels of expression might be expected for of some essential 'housekeeping' genes, causing them to be well represented in even an incomplete transcriptome sequencing effort. to account for this possibility, we also searched for genes associated with intercellular signaling pathways and transcription factor genes. because of their more restricted spatial and temporal patterns of expression, these genes are not expected to be as highly expressed in whole-organism libraries as the essential 'housekeeping' genes. the query lists for these searches were based on genes and pathways conserved among primitive metazoans and cnidarians  <cit> . these searches successfully identified genes from nearly all of the pathways and transcription factor families considered . the few genes that could not be found might result from incomplete annotation, inadequate sampling of the transcriptome, or genes that are truly not expressed. regardless of the cause, the impact appears to be minimal . overall, these searches support the conclusion that the collection of annotated sequences produced in this study represents a reasonably complete description of the coral larval transcriptome.

applications for measuring gene expression
one immediate application for the annotated sequence resource developed in this study is the design of microarray probes for gene expression analysis of biological processes such as heat tolerance or innate immunity. to that end, we have selected a set of  <dig>  sequences for probe design based on the following criteria. to ensure that all sequences were sufficiently long to allow design of high-quality probes, we selected the subset of sequences ≥  <dig> bp in length . among these,  <dig>  matched annotated genes in public sequence databases, allowing unambiguous identification of the sense  strand. these included  <dig>  clusters of similar sequences; within each cluster, sequences were ranked by coverage, and the most highly-covered member of each cluster was selected. finally, based on gene name annotation, for any cases where two sequences were annotated with the same gene name, the sequence with higher coverage was selected. this produced a set of  <dig>  well-annotated sequences corresponding to known genes. these sequences have been adjusted to ensure that the sense strand is represented, based on blast matches. to bring the total to  <dig> , the remaining sequences ≥  <dig> bp in length without matches in public databases  were ranked by coverage and the  <dig>  most highly covered sequences selected. for those sequences without blast matches, the strand information  is not known. one important practical note about the use of these sequences for gene expression analysis is that probes or primers designed based on these sequences should be designed so as not to span the junctions produced by contig-joining. the set of sequences selected above provides a valuable resource for designing microarray probes, and the current widespread use of microarrays for gene expression profiling of corals  <cit>  suggests that this resource will be immediately useful.

development of genetic markers
although a. millepora is an emerging coral molecular biology model for molecular ecology studies, few genetic markers are currently available for this species  <cit> . these markers are obviously not enough for genome-wide association studies of coral physiological variation, which is the focus of ongoing projects in our laboratory addressing the molecular and evolutionary mechanisms of coral adaptation to climate change. this study, like others recent published  <cit> , shows a cost-effective way to produce a large number of gene-associated snps from transcriptome data obtained by  <dig> sequencing. qualitysnp is a newly developed program and uses a haplotype-based strategy to detect reliable snps without requiring sequence traces, quality scores, or genomic sequence data  <cit> . in our study, 70% of predicted snps were confirmed experimentally. these findings clearly demonstrate the utility of snp mining from  <dig> transcriptome sequences, and provide the most extensive genetic marker resource currently available for a. millepora.

CONCLUSIONS
in this study, we describe methods that will facilitate transcriptome sequencing for organisms that present important biological questions but lack fully-sequenced genomes. the laboratory procedures outlined here provide a rapid and cost-effective method for deep transcriptome sequencing in a single  <dig> sequencing run, improving substantially on previous methods. the analytical strategies we describe for adaptor trimming, assembly, joining, and annotation can all be accomplished using publicly available programs and basic scripting tools, and produce useful collections of annotated sequences from short reads. our findings provide a nearly complete description of the genes expressed in coral larvae, a resource that is expected to be immediately useful for measurements of gene expression in reef-building corals, in addition to a large number of genetic markers for studies of genetic connectivity and structure. the single  <dig> sequencing run employed in this study produced more than  <dig>  sequencing reads, allowing the identification of ~ <dig>  genes and ~ <dig>  snps. these findings represent a substantial contribution to the existing sequence resources for reef-building corals. application of these resources will greatly enhance our understanding of the potential for corals to adapt to increasing environmental stress during climate change.

