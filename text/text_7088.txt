BACKGROUND
one of the main reasons for the rapid growth of the field of systems biology is that it makes extensive use of mathematical modeling  <cit> . this allows for a better handling of high complexity, which is an inherent property of all living systems. using modeling, complex hypotheses can be formulated and tested in a more systematic manner than is possible using only biochemical reasoning  <cit> . however, even if one can obtain a detailed model of the system with a high predictive power, the model in itself does not automatically lead to a full understanding of the underlying biochemistry. one should for instance analyze the model to single out its essence, i.e., to identify those parts of the model that can be eliminated, while still preserving the model's crucial behavior. this latter task is referred to as model reduction, and it is the topic of this paper. there is an extensive literature available on the topic of model reduction. however, most of these studies have been done outside the field of systems biology, and since systems biology brings about new types of challenges, reduction of biochemical models is still in its early stages. traditional engineering approaches like balanced truncation have focused on preserving the input-output profile in an optimal manner, both for linear  <cit> , and for nonlinear  <cit>  systems. however, these methods are not suitable for systems biology, because the reduced model has no natural interpretation in itself . this lack of interpretation is a problem because systems biology models are usually developed to help characterizing the dominating parts and structure of the system, and not only to obtain a black-box predictor. methods have therefore been developed with traditional chemical approaches that are more centered on reducing the internal dynamics of the system. these methods are typically based on a sensitivity analysis  <cit> , on time-scale separation  <cit> , or on the lumping of state variables  <cit>  . the perhaps most widely used method is lumping. two of the main reasons for this are that an effective lumping scheme can be identified from basic properties of the model , and that lumped state variables are formed as easily interpretable pools of state variables in the original model. however, lumping does normally not come with the possibility of back-translation from the lumped state variables in the reduced model to the original state variables. in  <cit>  we provided such relations. this means that we can take the result from a simulation of a reduced model, and without performing a new simulation, directly compute the corresponding trajectories of the desired original state variables. because of this back-translation possibility, we refer to the resulting two models as two degrees of zooming of the same model. nevertheless, like in other recent model reduction papers in systems biology  <cit> , the results in  <cit>  were mainly developed with linear systems in mind. linear systems virtually only appear in the cases of mono-molecular reaction networks and for models describing the probabilistic evolution of a single protein complex  <cit> . however, already in  <cit>  we proposed that zooming may in principle also be applicable to nonlinear models, but we did not derive formulae for back-translation. note that a majority of the currently available systems biology models are in fact nonlinear.

with the method introduced in this paper, we provide the extension of the previously proposed method in  <cit>  to nonlinear models. we show that new challenges arise due to the nonlinearities, but also how these challenges can be overcome, for instance with a wise choice of state variables in the reduced model. the method is demonstrated by application to two closed models of metabolic systems.

methods
in this paper we present a more general version of the method that was introduced in  <cit> , which is applicable to nonlinear models. we start with some basic definitions and key observations that are illustrated on a small example model, before we turn to the details of the method.

basic definitions and assumptions
the method is developed for models of biochemical reaction systems on state space form that are based on nonlinear ordinary differential equations 

  ẋ=f, 

  y=h, 

where t denotes time; the dot over x in eq.  denotes derivative w.r.t. to time; the state vector x ∈ ℝn; the parameters p ∈ ℝp; the inputs u ∈ ℝm; the outputs y ∈ ℝl; and f and h are in general nonlinear functions. the state vector, whose individual elements are referred to as state variables, typically represents amounts or concentrations of chemical species, and the parameters commonly represent kinetic constants, initial conditions, or scaling factors. in this paper we are primarily interested in a comparison of the state variables between models , which means that the form of the nonlinear function in eq.  is irrelevant for the application of our method. the right-hand side of eq.  can be expressed as the stoichiometric matrix s ∈ ℝn×q times a vector of reaction rates r = r; r ∈ ℝq

 ẋ=sr. 

the existence of separate time-scales are commonly utilized for reduction of biochemical models . the typical approach is to investigate if subsets of the state variables are in steady state or in quasi-steady state . if state variable xi is in steady-state for t ≥  <dig> it holds by definition that

  ẋi= <dig>  

which implies that

 xi=xi, 

which efficiently removes the state variable from the model, since it can be substituted for constant. if on the other hand the state variable xi is in qss, there are terms on the right-hand side of the ode that are much larger than the negligible term on the left-hand side. the approximation

  fi≈ <dig>  

is then commonly used to reduce the model. we refer to a state as fast in the time interval ≤ t <dig> ≤ t <t <dig> if eq.  is valid in this time interval, and holds for the class of all considered inputs to the system. note that t <dig> = ∞ in the case that the systems remains in qss, which may for example not be the case for models with switches   <cit> .

note that eq.   necessitates that eq.   is fulfilled, but not vice versa. although qss implies that  the terms of the right-hand side of the ode are large and leaves the left-hand side  negligible, the derivative term may still be large enough for the state variable in qss to change considerably during the time-span of a simulation; the key is that these changes mainly occur on a slow manifold.

zooming of linear models
the concept of zooming was introduced in  <cit> , and a method was presented that is applicable to linear time-invariant  models, which on state space form reads:

 ℳo:ẋ=ax+buy=cx+du, 

where a ∈ ℝn × n, b ∈ ℝn × m, c ∈ ℝl × n, and d ∈ ℝl × m. the method is based on the existence of at least one subset of state variables in ℳo for which the internal dynamics is very fast with respect to the current time-scale of interest. an algorithm for automatic reduction of linear models that is based on the detection of such subsets, which are referred to as fast clusters, is presented in  <cit> . if the w state variables of a fast cluster are replaced by a single state variable xll′= ∑i=1wxli, we obtain a reduced version of the original model

 ℳr:ẋr=arxr+bruy=crxr+du, 

where xr ∈ ℝ, ar ∈ ℝ × , br ∈ ℝ × m, and cr ∈ ℝl × .

the fraction parameters, which are typically computed from qss assumptions and mass conservation relations, take the form

  ηli=xlix′ll, 

the fraction parameters are used for back-translation of the lumped state variable to the original state variables. note that the fraction parameters are functions of the model parameters only, and therefore time-invariant; as we will see, these fraction parameter properties do in general not hold for nonlinear models. by comparing the reactions of the original and reduced models, we see that

  kjl′= ∑i=1wkjiηi, 

where kjl′ is the rate parameter in the reaction from state variable xll′ to state variable xj in the reduced model, and kji is the rate parameter in the reaction from state variable xi to state variable xj in the original model.

finally, note that eqs.  and  provide a link between ℳo and ℳr, which constitute two different levels of granularity. it is this link between the models that make us consider them as two different degrees of zooming, and the primary goal of this paper is to establish such a link also for nonlinear models.

extension to nonlinear models - initial observations
we will now present some key observations that are used in the derivation of the method for zooming of nonlinear models.

first observe that the mass, which corresponds to a weighted  sum of the state variables, of a closed  nonlinear model is conserved. however, the total number of molecules is in general not conserved in such a model as it is for linear models. this is for example due to the formation and dissociation of complexes, which alters the total number of molecules in the system. for instance, the binding of a to b reduces the number of molecules, as the product ab only counts as one molecule; binding reactions cannot occur in linear models. a second, and related, observation is that another type of conservations appears in nonlinear models; conserved moieties. a moiety is a specific functional part of a molecule, and the weighted sum of the number of molecules that contain this functional part is constant in a closed system. the presence of such a conserved moiety is equivalent to the existence of a row vector m ∈ ℕn for which ms =  <dig>  which also implies that

  mẋ=msr= <dig>  

if we let the rank of s be denoted by nr, the number of linearly independent vectors for which eq.  holds is equal to n - nr, which implies the existence of a matrix m

  ms= <dig>  

where m∈ℕn-nr×n.

let us now make some remarks regarding fast state variables in a nonlinear model. let xf∈ℝnf be the vector of all fast state variables in t <dig> ≤ t <t <dig>  for simplification we will assume that there are no inputs to the system, although it would in principle be possible to incorporate inputs in the following discussion. the right-hand side of the odes for these fast state variables, if there are no inputs, can be separated into two parts. the first part contains reactions between fast state variables that are significant for the fast dynamics; rf , and the second part contains all other reactions, rs, i.e.,

  ẋf=ssrs+sfrf, 

where sf and ss are the corresponding stoichiometric matrices. let us now consider the fast stoichiometric matrix, sf, and especially the conserved moieties that are implied by sf. since these moieties are only  conserved on a fast enough time-scale, we refer to such moiety conservations as apparent conservations. let mf be a matrix with a linearly independent rows such that

  mfsf =  <dig>  

where mf∈ℕa×nf. each row of this matrix thus implies an apparent conserved moiety in the system. let the sums of state variables that correspond to apparent moiety conservations  be denoted by l, so that

  l = mfxf. 

if we differentiate l with respect to time, we get

  l°=mfẋf=mf+sfrf)≈≈mfssrs, 

where eqs.  and  were used.

it is interesting to note that the matrix mf is not unique, but that in fact any matrix m^=nmf can be used for lumping, where n ∈ ℝa×a is non-singular. this observation allows us to choose a matrix m^ for which a maximal number of rows in m^ss vanish, which results in the greatest possible reduction in the number of state variables. finally note that eq. , in the absence of inputs, gives

  ff=ff==ssrs+sfrf≈sfrf≈ <dig> 

since the term sfrf  dominates the term ssrs. note that eq.  and consequently eq.  only hold in t <dig> ≤ t <t <dig>  since the state is only known to be fast in this time span.

eq.  defines the odes of the reduced model , and eqs.  and  can in principle be used to calculate back-translation formulae, as is demonstrated with the small example model in the next section. however, as we shall see, this approach requires the explicit algebraic solution to a system of nonlinear equations, which is typically an infeasible task. furthermore, there is not a clear one-to-one mapping between the state variables of the original and reduced models as in the case of proper lumping  <cit> .

a small example model
we will now present a small example model, with three fast state variables, which is reduced with the approach discussed above. an alternative approach is then demonstrated with the advantage that it scales better to larger models.

consider the reversible formation of a complex c from a substrate a and an enzyme b

 ∙↔a+b↔k-1k1c↔∙ 

consisting of the fast state variables xf = t, where the bullets  represent the slow state variables surrounding the three fast state variables in the model. the odes for the fast state variables take the form

  ẋf=-1-11+ssrs. 

the three state variables in the model constitute a fast cluster with two apparent conserved moieties, which may be represented by the following relations

  l=l1l2=101011abc=mfxf, 

where the lumped state variables l <dig> and l <dig> are introduced. note that eq.  defines the dynamics of the lumped state variables.

the distribution of mass among the fast state variables is given by eq.  and by applying eq.  to , which results in an equation system with the three fast state variables as unknowns

  k1ab-k-1c≈ <dig>  

  a + c = l <dig>  

  b + c = l <dig>  

analytic expressions for the fast state variables a, b, and c are given by the non-negative solution to eqs. -

  a≈122-4l1l2), 

  b≈122-4l1l2), 

  c≈122-4l1l2), 

where k1=k-1k <dig> 

we can now employ eq.  to solve the odes for the lumped state variables l <dig> and l <dig>  and use eqs. - as back-translation formulae to compute the trajectories of the original state variables a, b, and c. however, note that for even slightly larger clusters of fast species than the one discussed here it would not be possible to calculate algebraic expressions of the original state variables with this approach, since it builds on the explicit solution of a system of nonlinear equations, which quickly becomes infeasible with growing problem size.

alternatively, we can take an approach to the problem that is inspired by the method for linear systems in  <cit> . the first step is to express eqs.  and  as a linear system w.r.t. the state variables a and c

  k1b-k-111ac≈0l <dig>  

the solution to eq.  w.r.t. a and c is

  a≡ηal1≈k1b+k1l <dig>  

  c≡ηcl1≈bb+k1l <dig>  

where k1=k-1k <dig>  and the fraction parameters ηa and ηc  are defined in eqs.  and , respectively. the ode for l <dig> is defined by eq. , and the ode for b can be derived by differentiation of l <dig> in eq. , which gives that

  dbdt≈2)-1-bb+k11l1dtl2dt==2)-1-bb+k11⋅⋅mfssrs, 

the reduced model consists of the two state variables l <dig> and b , and the dynamics is described by eqs.  and , respectively. note that the state variables a and c can be back-translated from the reduced model with eqs.  and . this approach is a bit more intricate than the first, but comes with the advantage that we do not need to solve a system of nonlinear equations.

a method for zooming of nonlinear models
we will now step-by-step present a method that can be used to construct zoomable nonlinear biochemical models. this involves two sub-goals: i) to identify a reduced model that shares important characteristics with the original model, ii) to derive back-translation formulae that can be used to compute the original state variables and parameters from the reduced model.

in an initialization step of the method for a model ℳo we first formulate mathematical equations for all conservation relations eq. , state variables in steady-state eq. , and quasi-steady state assumptions eq. . if additional properties of the system are known, we also formulate the corresponding equations.

step 1
the first step of the method is to identify the apparent conservation relations in the model.

definition 1: let sf be the stoichiometric matrix for the reactions rf  as defined in eq. . each subset of state variables for which the corresponding rows of sf are linearly dependent constitutes an apparent conservation relation. hence the apparent conservation relations lie in the left null space of sf and the dimension of this space is n - rank.

note that the apparent conservation relations are defined in eq. . it is trivial to identify the set of all linearly dependent rows of sf with a mathematical computing software .

step 2
the second step of the method is to define the state variables of the reduced model, which we refer to as modified lumped state variables.

definition 2: let x be a lumped state variable corresponding to a subset of the state variables in an apparent conservation relation. then x is a modified lumped state variable if the lumping scheme with respect to the state variables of the original model is proper.

note that the original state variables have a clear interpretation in the reduced model  if the lumping scheme is proper, i.e.,

  lm=mmxf 

where mm is a × nf matrix with elements equal to  <dig> or  <dig> and column sums equal to  <dig>  and lm denotes the modified lumped state variables. we typically have a large freedom in the choice of mm. the number of state variables is maximally reduced if all exact conservation relations in the model are retained as modified lumped state variables .

step 3
the third step of the method is to derive fraction parameters, which constitute the link between the reduced model and the original model. let the original state variables that constitute the k:th modified lumped state variable lmk be denoted by xmk, so that

  lmk= ∑i=1wxmki, 

a number of nm equations that are linear w.r.t. xmk, and linearly independent, are required to calculate fraction parameters. the existance of nm such equations results in an equation system

  bk = axmk, 

where both a∈rnm×nm and bk∈rnm are known, although some of the equations may in general be approximate . the matrix a is invertible since the equations are linearly independent, and we have that

  xmk=a-1bk. 

the fraction parameters can then be calculated

  ηmki=xmkilmk=xmki∑i=1nmxmki, 

where we used eq.  in the last step.

a modified lumped state variable for which an insufficient number of linear and linearly independent equations are available may still be used in the reduced model. however, the back-translation of the modified lumped state variable to the original state variables is then not possible, and step  <dig> of the method is ignored.

step 4
the fourth step of the method is to derive the rate of change of the modified lumped state variables. theorem: the dynamics of the modified lumped state variables is given by

  l°m=)-1l°==)-1mfssrs, 

where ss and rs were defined in eq. , the matrix mf is defined in eq. , and

  jij= ∑k∂gk∂lmj, 

where the matrix mm is defined in eq. , and gi≡xfi is introduced to simplify the notation.

proof:

first subtract eq.  from eq. 

 l=lm+xf=lm+g, 

and differentiate l with respect to time, which gives

  l° = l°m + jl°m = )l°m, 

where i is the identity matrix and j is the jacobian of g with respect to lm. the element jij of j is given by

 jij= ∑k∂gk∂lmj. 

from eq.  it is straight-forward to derive l°m, which takes the form

 l°m=)-1l°==)-1mfssrs, 

where eq.  was used in the last step. □

the matrix i + j is symbolically invertible, but may in general contain singularities for particular combinations of parameters values and state variable values. however, the matrix is always invertible for the models discussed in this paper, since the corresponding determinants are strictly positive.

step 5
the final step of the method is to back-translate the modified lumped state variables to the original state variables with the fraction parameters derived in step  <dig>  this allows a comparison between the predictions by the reduced model to those of the original model.

the implementation of the method is straight-forward, and we have used matlab  together with the sbtoolbox  <cit>  as computing software for the models in this paper.

RESULTS
we will now demonstrate the method through application to two example models.

enzyme kinetics model
the model below describes the process of conversion of a substrate, s, into a product, p, which is catalyzed by an enzyme, e.

 s+e↔k-1k1cs→k2cp↔k-3k3p+e 

note that the complexes cs and cp are formed by s bound to e, and p bound to e, respectively. this model is frequently occurring as part of larger models of biological systems, although the reaction from cs to cp is sometimes neglected, or reversible. the odes for the model are listed in appendix a. <dig>  where the three reactions are defined as: r <dig> = k1se - k-1cs, r <dig> = k2cs, and r <dig> = k3cp - k-3pe.

the reaction terms r <dig> and r <dig> are assumed to be dominating, and the reaction term r <dig> to be insignificant in the odes. this results in that all state variables are in qss, which gives

  k1se-k-1cs≈ <dig>  

  k3pe-k-3cp≈ <dig>  

we denote the sum of the state variables containing the enzyme by

  le=e+cs+cp, 

which is constant since the total amount of the enzyme e is conserved in the system.

reduction of the enzyme kinetics model
the first step of the method is to identify the apparent conservation relations from the matrix sf. since r <dig> is dominated by r <dig> and r <dig> the model odes can be written on the form of eq. 

 ṠĖṖcs °cp °=ssrs+sfrf==000-11r2+-10-1101100-1r1r <dig>  

a basis of the left null space of sf is given by the row vectors of mf, which is defined by

  l=lslple==100100010101011sepcscp==mfxf, 

where ls and lp are apparent conservation relations and le is an exact conservation relation.

the second step is to define the modified lumped state variables on the form of eq. . the number of state variables is maximally reduced if le is retained as a state variable in the reduced model . the vector of modified lumped state variables then is defined

 lm=sple=100000010001011sepcscp==mfxf, 

in the third step of the method we calculate fraction parameters for the modified lumped state variable le. there are five equations - and ) that are linear w.r.t. the state variables e, cs, and cp, which are lumped into the state variable le. note that only nm =  <dig> equations are required to derive fraction parameters, and we use eqs. - to formulate an equation system as in eq.  with the solution

  e=ηele≈11+m1s+m3ple≡g <dig>  

  cs=ηcsle≈m1s1+m1s+m3ple≡g <dig>  

  cp=ηcple≈m3p1+m1s+m3ple≡g <dig>  

where m1=k1k- <dig> and m3=k3k- <dig>  the two remaining modified lumped state variables correspond to s and p in the original model, so we define that lm1=s≡g <dig> and lm2=p≡g <dig> 

in the fourth step we derive the rate of change of the modified lumped state variables. eq.  gives that l°e= <dig>  which is replaced by a constant, and

  Ṡ≈-k2m1sle2+m3le)ϕ, 

  Ṗ≈k2m1sle2+m1le)ϕ. 

where

 ϕ=3+)le+m1m3le2). 

the two odes in eqs - define the dynamics of the state variables in the reduced model. we finally note that the exact conservation relation for the substrate, lt = s + p + cs + cp, together with eqs. - can be used to reduce the model further to a single state.

in the fifth step of the method we use the fraction parameters, defined in eqs. -, to back-translate the modified lumped state variables to the state variables of the original model. a comparison between predictions of the original state variables, from simulations of the original model and the reduced model, is presented in figure  <dig>  implementations of the original model , the reduced model , and a script for simulation with sbtoolbox <dig> for matlab  <cit>  , are available in additional files.

the only assumption that was used in the derivation of the reduced model is that the reaction terms r <dig> and r <dig> dominate the reaction term r <dig>  which results in that all state variables are in qss. to assess the impact of these assumptions on the reduced model we compute the relative difference between the state variables in the original and in the reduced model

 εi=|xio-xir|xio,i= <dig> …,n, 

where xio is state variable i in the original model, xir is the corresponding back-translated state variable in the reduced model, and |x| denotes the elementwise absolute values of x. the maximal mean and infinity norm of εi in eq.  over time is presented in table  <dig> for parameter values over five orders of magnitude. in general, the reduced model appears to be robust to changes in the parameter values, although slightly more sensitive to some parameters . however, note that the validity of the qss assumption may also depend on the state variables, for example the total concentration of the enzyme. interestingly, we observed that the reduced model can well approximate the original model over several order of magnitudes around the nominal enzyme concentration . it is well-known that the qss approximation is only valid for sufficiently small enzyme concentrations, and as expected the performance of the reduced model starts to decrease for immense enzyme concentrations.

the nominal parameter values  are modified by a multiplicative factor, and the maximal  time average/infinity norm of the relative difference between the original and the reduced model is presented above. note that only concentrations larger than 10- <dig> are considered in the analysis above, due to potential numerical inaccuracies.

note that all the state variables of the original model have a direct biological interpretation also in the reduced model, and that eqs. - can be used to back-translate the state variables. the reduced model may be depicted

 s+ηele↔k-1k1ηcsle→k2ηcple↔k-3k3p+ηele 

where the fraction parameters specify the distribution of the enzyme among the corresponding original state variables.

glucose transport in budding yeast
a model for the transport of glucose into a cell of baker's yeast , which constitutes the first step of glycolysis, is presented in  <cit> . the inflow of glucose is modeled as a facilitated diffusion process, in which a carrier enzyme is responsible for the transport between the inner and outer regions of the cellular membrane. it is assumed that glucose 6-phosphate  has an inhibitory role in the glucose transport process by binding to the transporter. a graphical representation of the model is shown in figure  <dig>  and the odes for the state variables are listed in appendix a. <dig> 

in  <cit>  we described how the calculation of fraction parameters, based on a set of assumptions, leads to the same reaction rates in the reduced model as were reported in  <cit> . the assumptions are that state variables participating in reactions for uptake and release of glucose and g6p across the cell membrane are in qss, that the transporter is conserved, and that the concentrations of the transporter in the inner and outer regions of the cellular membrane are constant.

the assumption that the state variables xglce,xglci,xe-g6pi, and xe-glc-g6pi, which participate in the uptake and release of g6p and glucose across the cell membrane, are in qss gives that

  k1xeexglce-k-1xe-glce≈ <dig>  

  k2xeixglci-k-2xe-glci≈ <dig>  

  k4xeixg6pi-k-4xe-g6pi≈ <dig>  

  k3xe-glcixg6pi-k-3xe-glc-g6pi≈ <dig>  

we have the following exact conservation relations in the model

  le=xe-g6pi+xe-glc-g6pi+xe-glce+…xe-glci+xee+xei, 

  lglc=xglce+xglci+xe-glc-g6pi+xe-glce+xe-glci, 

  lg6p=xg6pi+xe-g6pi+xe-glc-g6pi, 

where le, lglc, and lg6p are constant over time. the assumption in  <cit>  that the concentrations of the transporter in the inner and outer regions of the cell membrane are constant is formulated

  α+β= <dig>  

it is not clear how equations for back-translation of the state variables in the reduced model in  <cit>  can be derived. the reduced model has three state variables; external- and internal glucose and g6p, but only two differential equations for the in- and outflow of glucose, since the ode for g6p is replaced by a representative function that is inferred from the g6p data. our method does not rely on that such information is available, although it would in principle be possible to utilize data fitted functions for the state variables. also note that the equations in the reduced model describe the total influx and efflux of glucose across the membrane  <cit> , which cannot be interpreted w.r.t. the state variables of the original model. other assumptions in  <cit>  that complicates a comparison with our method are that the efflux of glucose is negligible, that the concentration of glucose in the cytosol is negligible, and that the concentrations of the transporter are constant in the inner and outer regions of the cell membrane ).

it is not possible to generate a reduced model by direct substitution of the fraction parameters that were derived in  <cit>  into the odes of the original model, since this would lead to the prediction that the state variables are constant . we will now instead illustrate how our method can be used to derive a reduced and zoomable version of the glucose transport model.

reduction of the glucose transport model
before applying our method to the glucose transport model we tried an alternative approach. eqs. - were solved w.r.t. the state variables in qss, and the resulting expressions were then substituted into the remaining odes. the details of the derivation of the reduced model are presented in appendix a. <dig>  the reduced model does not produce satisfactory predictions for any other state variable than xg6pi, which remains approximately constant during the simulation. implementations of the original model , the reduced model , and a script for simulation with sbtoolbox <dig> for matlab  <cit>  , are available in additional files.

since the first approach turned out to be insufficient for reduction of the glucose transport model we applied our method to the same model. following  <cit> , we initially assumed constant transporter concentrations in the inner and outer regions of the cellular membrane, as defined by eq. . for the details on the derivation of the reduced model we refer to appendix a. <dig>  the reduced model clearly performs better than the model resulting from the first approach, but it is still not satisfactory. however, the assumption of constant regional concentrations of the transporter may not be valid since the transport of glucose across the cell membrane is a rate limiting step in the model, and appears to be important for the state variable dynamics. we therefore decided to neglect eq.  in the reduction process.

implementations of the original model , the reduced model , and a script for simulation with sbtoolbox <dig> for matlab  <cit>  , are available in additional files. in the first step of the method we identify the following apparent conservation relations

  l=lglc1le1lglc2lg6ple2=mx==100001000000001010010100100001110000001100101x. 

we note that there are two disjoint clusters of fast reactions in the model, corresponding to the outer- and inner parts of the cell membrane.

in the second step we define the modified lumped state variables. we decide to keep the lumped state variables le <dig> and lg6p as modified lumped state variables. the choice to keep lg6p leads to the largest possible reduction in the number of state variables, since the conservation of lg6p is exact . the modified lumped state variables are defined true for any other state variable in l). the modified lumped state variables are defined

  lm=xglcele1xglcilg6ple3=mmx==100000000000001010010000000001110000000000101x, 

where

 x=xglcexglcixe-g6pixe-glc-g6pixg6pixe-glcexe-glcixeexei. 

note that two of the state variables in the original model, xglce and xglci, are also modified lumped state variables.

in the third step of the method we calculate fraction parameters for the modified lumped state variables that correspond to more than one of the original state variables . all of the modified lumped state variables satisfy the requirement that at least nm of eqs. - and eq.  are linear, and linearly independent, with respect to the corresponding original state variables. eqs.  and  form a nonlinear equation system with the solution

  xeexe-glce=ηeeηe-glcele1≈≈1k1xglcele <dig>  

let us define that g6≡xe-glce and g8≡xee. similarly, the fractions of the two carrier state variables in the inner regions of the cell to the lumped state variable le <dig> can be computed from eqs.  and  )

  xe-glcixei=ηe-glciηeile3≈≈1xglcik2le <dig>  

we define that g7≡xe-glci and g9≡xei. the fraction parameters for the g6p-state variables can be computed from eqs. - and eq.  with the solution

  xe-g6pixe-glc-g6pixg6pi=ηe-g6piηe-glc-g6piηg6pilg6p≈≈1ξk3xeik4xe-glcik3k4lg6p. 

where ξ=k3k4+k4xe-glci+k3xei. we define that g3≡xe-g6pi, g4≡xe-glc-g6pi, and g5≡xg6pi. for the two original state variables that are kept as modified lumped state variables in the reduced model we define that g1≡xglce and g2≡xglci.

the fourth step of the method is to derive rate equations for the modified lumped state variables. since the apparent conservations are separated into two disjoint clusters of fast state variables, we can treat the model for the inner and outer regions of the membrane separately. let the modified lumped state variables corresponding to the outer region of the cell membrane be denoted by lm1=t, and the variables in the inner region of the cell membrane by lm2=t. note that the state variable lg6p can be replaced by a constant in the model, since l°g6p= <dig>  the odes of the modified lumped state variables are derived with eq. . in the inner region the odes are

  l°m1=ẋglcel°e1=-1l°1==1+j11j1201-1l° <dig>  

where

  l°1=l°glc1l°e1≈≈-α-α-β. 

in the larger outer region of the cell membrane the odes take the form

  l°m2≈ẋglcil°e3=-1l°2==1+j11j12j211+j22-1l° <dig>  

where

  l°2=l°glc2l°e2≈≈-α-α-β. 

in the fifth step of the method the reduced model, which is defined by the four odes in eqs. -, is simulated. the trajectories of the state variables of the reduced model can be back-translated to the original state variables with the fraction parameters defined in eqs. , , and . the simulation results are shown in figure  <dig> and figure  <dig>  all the state variables can be back-translated properly, which shows that the model properties that are important for recovery of the state variables are retained in the reduction. implementations of the original model , the reduced model , and a script for simulation with sbtoolbox <dig> for matlab  <cit>  , are available in additional files.

if we use le <dig> instead of lg6p as a modified lumped state variable, the reduced model will have the same state variables as the reduced model in  <cit>   two additional state variables for the transporter. this gives a reduced model with five state variables, but equally many parameters as in the previous case. a comparison between the original model and the reduced model, w.r.t. the original state variables, is shown in figure  <dig> and figure  <dig>  as can be seen the comparison is very good, in fact it is even slightly better than for the reduced model with four state variables. the details of the derivation of the reduced model are presented in appendix a. <dig>  implementations of the original model , the reduced model , and a script for simulation with sbtoolbox <dig> for matlab  <cit>  , are available in additional files.

note that the only assumption used to derive the reduced model is that states that are involved in reactions at the membrane are in qss. to investigate the parameter space region in which the qss assumptions are valid we use the measure defined in eq. . the maximal mean and infinity norm of the relative difference between the original and the reduced model in eq.  over time is presented in table  <dig>  the reduced model appears to be relatively robust to changes in the parameters, although sensitive to small values of k- <dig> and to large values of k <dig>  this is mainly due to that a large proportion of the transporter e is absorbed in xe-g6pi, which leads to that some of the qss assumptions are invalid. we also observed that relative difference between the models is insensitive to the total concentration of the transporter for several orders of magnitude around the nominal value . however, note that this observation is specific to the studied model and may not be generalizable to other similar biochemical models.

the nominal parameter values  are modified by a multiplicative factor, and the maximal  time average/infinity norm of the relative difference between the original and the reduced model is presented. note that due to potential numerical inaccuracies only concentrations larger than 10- <dig> are considered in the analysis.

discussion
in this paper we have presented a novel method for reduction of biochemical models that is compatible with the concept of zooming. several methods for reduction of biochemical models already exist in the literature. however, few of these methods result in biochemically interpretable models, and to our knowledge there are no nonlinear lumping methods for which the state variables and parameters of the reduced model can be back-translated  to the original model.

the application of the qss assumption has been a commonly used tool in the modeling of biochemical networks since the late 1960s, and in chemical kinetics for more than  <dig> years  <cit> . the validity of the qss approximation is well studied both for specific biochemical mechanisms  <cit>  and for more complex models  <cit> . the resulting equations, together with conservation relations, are typically used to eliminate some of the state variables in the model . however, with the examples in this paper we have showed that such an approach is not always sufficient, and we propose to use proper lumping of state variables in combination with back-translation.

our method has several important advantages when applied to biochemical models. the most important advantage is that we end up with reduced models with a clear biological interpretation, meaning that each state variable of the original model corresponds to a fraction of exactly one of the state variables in the reduced model. a consequence is that neighboring species in the original model remain neighbors in the reduced model. hence we can consider the original and reduced models as two different degrees of zooming; a concept that we discussed in some detail in  <cit>  for linear models.

the work in this paper can be seen as an extension of the theory introduced for linear models in  <cit>  to nonlinear models. the method is based on assumptions regarding the dynamics that result in a sufficient number of equations that are linear w.r.t. the state variables to be back-translated. such equations are typically a natural result of qss assumptions and conservations relations in models based on mass action kinetics  <cit> , and in particular in models that involve transporters and enzymes . however, note that our method may also be applicable to models with other types of reaction kinetics. we also note that if too few linear relations are available for calculation of fraction parameters for a part of a model, this part can still be reduced and the reduced model can be simulated, although we cannot back-translate the corresponding modified lumped state variables since no fraction parameters are available. however, depending on the purpose of the model it may be enough to calculate fraction parameters for a subset of the state variables in the reduced model. linearization of the model around a steady state operating point may also be a feasible approach to calculate fraction parameters with the method in  <cit> .

the proposed method enables mapping of the state variables and parameters of the reduced model to those of the original model. in  <cit>  we referred to this mapping as back-translation. back-translation is of great importance, since we can directly observe how modifications to the reduced model impact the original model. it also gives the modeler an opportunity to check whether the assumptions underlying the reduction are acceptable. to illustrate the power of back-translation we provide plots for comparison of simulations of the original and reduced models, w.r.t. the original state variables, for the models to which the method is applied in this paper.

back-translation of state variables typically requires the solution of a system of nonlinear equations, which often results from the assumption of state variables in qss and conservation relations. unfortunately, analytic solutions to systems of nonlinear equations do in general not exist. an advantage with the proposed method is that such solutions are not required, since they are replaced by computation of the inverse of a matrix for each cluster of fast state variables, which is in general a more feasible task.

our method was applied to a small model with five state variables that commonly appears as part of larger biochemical models, and to a previously published model for the transport of glucose in baker's yeast   <cit> . the first model was reduced from five to one state variable, and from five to three parameters. however, note that our focus has been on the reduction of the number of state variables and not the number of parameters, which are reduced as a side-effect of the qss assumptions.

the model for glucose transport was first reduced with an approach in which the qss equations and conservation relations were directly substituted into the remaining odes. the results of this approach are not satisfactory since the reduced model gives predictions that are different from the original model for most state variables. our method was then applied to the same model both together with the assumption of equal concentration of the transporter in the inner and outer regions of the cell membrane used in  <cit> , and without any additional assumptions. the application of our method together with the assumptions used in  <cit>  results in a model with three state variables. the state dynamics is significantly better preserved than with the first approach, although still not satisfactory. we then decided to reduce the original model without the assumption regarding the localization of the transporter, with two different definitions of modified lumped state variables. while one of these definitions results in a reduced model with four state variables and gave rather accurate predictions, the other choice reduces the number of state variables to five and gives an excellent description of the state dynamics. it is therefore apparent that there is a tradeoff between accuracy and the number of state variables in the reduction process. the glucose transport model corresponds to the first part of glycolysis, in which glucose is transported into the cell. we therefore propose that it might be rewarding to carefully re-investigate the assumptions underlying the reaction rate equations in complete models of glycolysis .

we have also observed a few issues regarding the implementation of the method. the symbolic inversion of the matrix that is necessary to compute the dynamics of the modified lumped state variables may be expensive. however, this is typically only a practical limitation for large matrices, which result from large clusters of fast state variables. in our experience large clusters of fast state variables are relatively rare also in large biochemical models. another option, if it is not practically feasible to invert the symbolic matrix, is to solve the system of linear equations in eq.  numerically. we also observed that the symbolic right-hand side of the resulting differential equations may be long. however, these are usually not practical limitations for the applicability of the method, e.g., the simulations of all examples in this paper are very fast on a modern computer. available methods to reduce the analytic reaction rate expressions include sensitivity analysis w.r.t. state variables and parameters, and the method proposed in  <cit> .

there is still no consensus method for automatic identification of state variables in qss, although criteria for the detection of state variables in qss have been proposed, for example in  <cit> . a simple approach is to simulate the original model and investigate for which state variables the corresponding in- and outflow reaction rates are approximately equal. state variables for which this condition holds are then considered to be in qss. note that for the models in this paper it was already clear from the biochemical understanding of the corresponding systems which of the state variables that could be considered fast . however, an appropriate general criterion for automatic identification of state variables in qss is still lacking.

although the theory presented in this paper constitutes a great leap forward for construction of zoomable models, more research is required to make the method fully automatic. an important challenge is to define a meaningful measure for the similarity between the hierarchical model layers . another interesting, although trivial, observation that deserves further attention is that qss assumptions typically do not hold in the whole parameter space. although the reduced models in this paper appear to be robust to varying parameter values it may not be the case in general. it may therefore be revealing to compare the original model and the reduced model to characterize the parameter space regions in which the qss-assumptions are valid.

CONCLUSIONS
we have presented a novel method for reduction of biochemical models that is compatible with the concept of zooming. zooming allows the modeler to operate on different levels of model granularity, and enables a direct interpretation of how modifications to the model on one level affect the same model on other levels in the hierarchy. the proposed method is based on the application of proper lumping in combination with the identification of linear relations in nonlinear equations.

the method was applied to two example models. the first model is small and commonly occurring as a part of larger biochemical models. the second example is a model for glucose transport in baker's yeast, which constitutes the starting point for glycolysis. both models could be significantly reduced with the proposed method, and the resulting state variables could be back-translated to the original state variables. the method that is presented in this paper constitutes an extension of the method that was previously developed for linear biochemical models to its nonlinear counterpart. since most models in the systems biology community are in fact nonlinear, our method constitutes an important step towards zoomable biochemical models.

authors' contributions
ms developed the theory, most of the aspects of the method, and did the calculations within this project, which was managed by mj. ms wrote the major part of the paper, with contributions from gc and mj. all authors read and approved the final manuscript.

a appendix
a. <dig> appendix 1
the ordinary differential equations for the enzyme kinetics model take the form

 ẋ=ṠĖṖcs °cp °=-k1se+k-1cs-k1se+k-1cs+k3cp-k-3pek3cp-k-3pek1se-k-1cs-k2csk2cs-k3cp+k-3pe==-100-1010011-1001-1r1r2r3=sr, 

where r <dig> = k1se - k-1cs, r <dig> = k2cs, and r <dig> = k3cp - k-3pe.

the parameters are set to values that satisfy the assumptions of dominating and insignificant reaction terms, with k <dig> =  <dig>  k- <dig> =  <dig>  k <dig> =  <dig>  k <dig> =  <dig>  and k- <dig> =  <dig>  together with the initial conditions s = e =  <dig> and p = cs = cp =  <dig>  this gives the parameter values m <dig> =  <dig> , m <dig> =  <dig> and le =  <dig> in the reduced model. initial conditions can in general be obtained from a short simulation of the original model, until the fast state variables reach qss, but in this case eq.  gives an analytic expression of s  = 0)

 s=122-4lsle)==3- <dig>  

where m1-1=k <dig>  s = a, ls = l <dig>  and le = l <dig> 

a. <dig> appendix 2
the ordinary differential equations for the glucose transport model take the form

 dxglcedt=-k1xeexglce+k-1xe-glce,dxglcidt=-k2xeixglci+k-2xe-glci,dxe-g6pidt=k4xeixg6pi-k-4xe-g6pi,dxe-glc-g6pidt=k3xe-glcixg6pi-k-3xe-glc-g6pi,dxg6pidt=-k3xe-glcixg6pi+k-3xe-glc-g6pi-k4xeixg6pi+k-4xe-g6pi,dxe-glcedt=α+k1xeexglce-k-1xe-glce,dxe-glcidt=α-k3xe-glcixg6pi+k-3xe-glc-g6pi+k2xeixglci-k-2xe-glci,dxeedt=β-k1xeexglce+k-1xe-glce,dxeidt=β-k4xeixg6pi+k-4xe-g6pi-k2xeixglci+k-2xe-glci, 

which was introduced in  <cit> .

a. <dig> appendix 3
in this section we investigate an alternative  approach to reduce the glucose transport model. the first step is to identify state variables for which the qss assumption holds, and the mass conservation relations in the model. in the second step of this approach we then substitute the corresponding system of equations into the odes corresponding to slow state variables.

now consider the model for glucose transport in yeast. we assume that the state variables xglce, xglci, xe-g6pi and xe-glc-g6pi are in qss, which gives eqs. -. note that eqs. - indirectly imply that xg6pi is in steady state. the substitution of eqs.  -  into the odes of the original model gives

  dxe-glcedt≈α, 

  dxe-glcidt≈α, 

  dxeedt≈β, 

  dxeidt≈β. 

note that the state variables xe-glce and xe-glci are decoupled from the state variables xee and xei in eqs. -.

there are three molecules  whose mass is conserved in the model as a whole, i.e., glc, g6p, and e. however, we can not substitute any of the conservation relations into the remaining odes without re-introducing state variables that were already eliminated. so the final reduced model takes the form of eqs.  - . however, the sum of the state variables xe-glce and xe-glci, and xee and xei is conserved in the reduced model, which makes it possible to reduce the model to two state variables.

unfortunately, due to the form of the odes and the initial conditions of the state variables in the reduced model, the state variables xe-glce and xe-glci remain equal to zero at all times, and only the state variables xee and xei take non-zero values. we therefore decided to simulate the original model for a short time until the fast state variables reach qss, and to use the final state variable values as initial conditions in the reduced model.

the solution to the equation system defined by eqs. - and eq.  is

 xglce≈k1xe-glcexee,xglci≈k2xe-glcixei,xg6pi≈k3k4k4xe-glci+k3xei+k3k4lg6p,xe-g6pi≈k3xeik4xe-glci+k3xei+k3k4lg6p,xe-glc-g6pi≈k4xe-glcik4xe-glci+k3xei+k3k4lg6p, 

which can be used for back-translation of the state variables of the reduced model to those of the original model.

the predictions of the state variables of the original model, resulting from simulations of the original model and the reduced model with the parameter values set as in  <cit> , is not satisfactory for any other state variable than g6p, which remains approximately constant over time. implementations of the original model and the reduced model in sbtoolbox <dig> for matlab  <cit>  are included in additional files.

a. <dig> appendix 4
in this section we apply our method to the glucose transport model, and following  <cit>  we will assume that the concentrations of the transporter are constant in the inner and outer regions of the cellular membrane. with this assumption the distribution among the transporter state variables of the original model, which constitute the lumped state variables le, is uniquely defined.

the first step of the method is to identify the apparent conservation relations in the model. we note that g6p and the transporter e are conserved, and apparent conserved glucose  in the inner and outer regions of the membrane, respectively. the four apparent conservation relations take the form

 l=lglc1lglc2lg6ple=mx==100001000010100100001110000001101111x, 

where x=t.

in the second step of the method we define the modified lumped state variables. we decide to keep le in the reduced model since it corresponds to an exact conservation, and therefore results in the largest reduction possible . the modified lumped state variables take the form

 lm=xglcexglcixg6pile=mmx==100000000010000000000010000001101111x. 

we note that eqs. -, and  are all linear w.r.t. the state variables that constitute state le, so the requirement for the existence of at least  <dig>  linear relations is satisfied, which enables back-translation in step three of the method.

in the third step of the method we derive the fraction parameters for the lumped state variable le. eqs. -, and  form an equation system, corresponding to eq. 

  axmk=0010-xglce′000010-xglci′10000-xg6pi′010-xg6pi”0000α-αβ-β111111⋅⋅xe-g6pixe-glc-g6pixe-glcexe-glcixeexei≈00000xl′=bk, 

where xglce′=k1k-1xglce, xglci′=k2k-2xglci, xg6pi′=k2k-2xg6pi and xg6pi=k4k-4xg6pi. the solution to eq.  is given by eq. 

  xe-g6pixe-glc-g6pixe-glcexe-glcixeexei=ηe-g6piηe-glc-g6piηe-glceηe-glciηeeηeile≈≈xg6pi′ζxg6pi”xglcipζxglce′ζxglci′ζζζle 

where

  ζ= 

and where the fraction parameters were calculated with eq. . we note that the fraction parameters are functions of xglce, xglci, and xg6pi, which are state variables both in the original- and in the reduced model. in the fourth step of the method we derive differential equations for the modified lumped state variables. the ode for the fourth state is l°m4=l°e= <dig>  which is replace by a constant. the odes for the other states are

 l°m1:3=ẋglceẋglciẋg6pi=1+j11j12j13j211+j22j23j31j321+j33-1l°1: <dig> 

where lm1: <dig> denotes the first three states variables in lm. note that there are three state variables in the reduced model, which is the same number as for the reduced model in  <cit> .

in the fifth step of our method we compare predictions of the original state variables between the original and reduced models, where le is back-translated with the fraction parameters defined in eqs. -.

the simulation results are clearly more accurate than with the approach in appendix a. <dig>  although still not satifying. we refer to additional files for implementations of the original and reduced models in sbtoolbox <dig> for matlab  <cit> .

a. <dig> appendix 5
in this section we apply our method to the glucose transport model, but with an alternative definition of the modified lumped state variables. we do not use the assumption of constant regional concentrations of the transporter ).

in the first step of the method we note that the apparent conservations are given by eq. .

in the second step of our method we decide to keep state variable le <dig>  instead of lg6p, in the reduced model. this leads to the following definition of the modified lumped state variables

  lm=xglcele1xglcixg6pile2=mmx==100000000000001010010000000000010000001100101x, 

where x=t, and we note that xglce, xglci, and xg6pi are state variables both in the original and reduced models. also note that the requirement of at least nm equations, that are linear w.r.t. the original state variables and linearly independent, is satified for each of the modified lumped state variables by eqs. -.

in the third step of the method we calculate fraction parameters for the modified lumped state variables le <dig> and le <dig>  which correspond to more than one of the original state variables. the fraction parameters for state variable le <dig> are given by eq. . we can now use eqs. - and eq.  to form an equation system corresponding to eq. 

 axmk=-xglcik200-xg6pi0k400-xg6pi0k31111xeixe-glcixe-g6pixe-glc-g6pi≈≈000le2=bk, 

with the solution given by eq. 

  xeixe-glcixe-g6pixe-glc-g6pi=ηeiηe-glciηe-g6piηe-glc-g6pile2≈≈k2k3k4ξk3k4xglciξk2k3xg6piξk4xg6pixglciξle <dig>  

where

 ξ=xg6pi+k3k4xglci+k2k3k <dig> 

and the fraction parameters were calculated with eq. .

the fourth step of the method is to derive odes for the modified lumped state variables. since the apparent conservations are separated into two disjoint clusters of fast state variables, we can treat the model for the inner and outer regions of the membrane separately. the rate equations for the outer region are given by eqs. -. eq.  gives us the odes of the modified lumped state variables in the inner region

  l°m3:5=ẋglciẋg6pil°e2=-1l°==1+j33j34j35j431+j44j45001-1l°3: <dig>  

where l3: <dig> and lm3: <dig> are the last three state variables of l and lm, respectively, and

  l°3:5=l°glc2l°g6pl°e2≈≈-α0-α-β, 

in the fifth step of the method we simulate the reduced model with eqs. - and - and we then use eqs.  and  for back-translation of the state variables. a comparison between the original model and the reduced model, w.r.t. the state variables of the original model, is presented in figure  <dig> and figure  <dig>  the agreement between the models is very good. we refer to additional files for implementations of the original and reduced models in sbtoolbox <dig> for matlab  <cit> .

additional files
the original and reduced versions of the models presented in this paper, and scripts for simulation and comparison between the original and reduced versions of the models. note that the systems biology toolbox for matlab  <cit>  and the symbolic math toolbox for matlab must be installed on the system for simulation of the attached models.

supplementary material
additional file 1
model  <dig>  the original enzyme kinetics model.

click here for file

 additional file 2
model  <dig>  the reduced enzyme kinetics model.

click here for file

 additional file 3
script  <dig>  script for comparison between the original enzyme kinetics model and the reduced model.

click here for file

 additional file 4
model  <dig>  the original glucose transport model.

click here for file

 additional file 5
model  <dig>  the reduced glucose transport model with the alternative  approach.

click here for file

 additional file 6
script  <dig>  script for comparison between the original glucose transport model and the reduced model with the alternative  approach.

click here for file

 additional file 7
model  <dig>  the reduced glucose transport model with our method and the assumption of constant concentrations of the transporter in the inner and outer regions of the cellular membrane.

click here for file

 additional file 8
script  <dig>  script for comparison between the original glucose transport model and the reduced model with our method and the assumption of constant concentrations of the transporter in the inner and outer regions of the cellular membrane.

click here for file

 additional file 9
model  <dig>  the reduced glucose transport model with four state variables with our method.

click here for file

 additional file 10
script  <dig>  script for comparison between the original glucose transport model and the reduced model with four state variables with our method.

click here for file

 additional file 11
model  <dig>  the reduced glucose transport model with five state variables with our method.

click here for file

 additional file 12
script  <dig>  script for comparison between the original glucose transport model and the reduced model with five state variables with our method.

click here for file

 acknowledgements
this work was supported by grants from the european commission 6th framework programme  and 7th framework programme , systemsx.ch , the swedish foundation for strategic research through the gothenburg mathematical modelling centre, the swedish research council, and by lions. we would also like to thank john johansson for his contributions to the development of the method in his m.sc. thesis at the fraunhofer-chalmers centre.
