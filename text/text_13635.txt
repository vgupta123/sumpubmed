BACKGROUND
dna microarray technology is a powerful method for monitoring the expression level of thousands of genes, or even whole genomes, in a single experiment. in the last few years, this technique has been widely used in several contexts such as tumor profiling, drug discovery or temporal analysis of cell behavior . due to the widespread use of this high-throughput technique in the study of several biological systems, a large collection of gene expression datasets is available to the scientific community, some of which contain tens or hundreds of different experimental conditions and constitute reference databases or "compendiums" of gene expression profiles .

one of the main goals in the analysis of such datasets is to identify groups of genes, or groups experimental conditions, that exhibit similar expression patterns. several clustering techniques, such as k-means  <cit> , self-organizing maps   <cit>  or hierarchical clustering  <cit>  have been extensively applied to identify groups of similarly expressed genes or conditions from gene expression data. additionally, hierarchical clustering algorithms have been also used to perform two-way clustering analysis in order to discover sets of genes similarly expressed in subsets of experimental conditions by performing clustering on both, genes and conditions, separately . the identification of these block-structures plays a key role to get insights into the biological mechanisms associated to different physiological states as well as to define gene expression signatures, i.e., "genes that are coordinately expressed in samples related by some identifiable criterion such as cell type, differentiation state, or signaling response"  <cit> .

although standard clustering algorithms have been successfully applied in many contexts, they suffer from two well known limitations that are especially evident in the analysis of large and heterogeneous collections of gene expression data:

i) they group genes  based on global similarities in their expression profiles. however, a set of co-regulated genes might only be co-expressed in a subset of experimental conditions, and show not related, and almost independent expression patterns in the rest. in the same way, related experiments may be characterized by only a small subset of coordinately expressed genes. indeed, as wang et al. remarked, there may only be a few gene components that account for most of the response variation across experiments, and thus important relationships among them may be lost in a high dimensional gene space  <cit> .

ii) standard clustering algorithms generally assign each gene to a single cluster. nevertheless, many genes can be involved in different biological processes depending on the cellular requirements and, therefore, they might be co-expressed with different groups of genes under different experimental conditions  <cit> . clustering the genes into one and only one group might mask the interrelationships between genes that are assigned to different clusters but show local similarities in their expression patterns.

in the last few years several methods have been proposed to avoid these drawbacks  <cit> . among these methods, biclustering algorithms have been presented as an alternative approach to standard clustering techniques to identify local structures from gene expression datasets. these methods perform clustering on genes and conditions simultaneously in order to identify subsets of genes that show similar expression patterns across specific subsets of experimental conditions and vice versa. for an overview of biclustering methods see the revision of madeira and oliveira  <cit>  and tanay et al.  <cit> .

a particularly promising technique, non-negative matrix factorization , has been recently introduced to the analysis of gene expression data in two independent works  <cit> . nmf can be applied to reduce the dimensionality of the data yielding a representation of conditions as a linear combination of a reduced set of k-factors. in this context, the factors represent sets of genes that behave in a strongly correlated fashion in sub-portions of the data. kim and tidor used this method to cluster genes based on local patterns and predict functional relationships in yeast while brunet et al. focused their work on the analysis of samples projected in the reduced space, showing the usefulness of this approach for finding non-overlapping partitions of tumor samples.

in this paper, we present an extension of this technique to the analysis of gene expression data in a two-dimensional context, simultaneously clustering genes and conditions highly related in sub-portions of the data. the main purpose of this work is to show the potential of this method to identify gene expression modules, i.e. sets of genes that share local similarities in their expression patterns, as well as to identify the experimental conditions highly associated to these modules. we have used a new variant of the classical nmf model, the non-smooth non negative matrix factorization algorithm   <cit> , that it has been specially developed to produce sparse representation of the factors and encoding vectors by making use of non-smoothness constraints. the sparseness introduced by this algorithm produce more compact and localized feature representation of the data than standard nmf, as it will be presented throughout this work.

to assess the potential of our approach and to illustrate its functionality we applied it to the analysis of synthetic data as well as two large and heterogeneous gene expression datasets, one comprising expression levels for thousands of genes across a large set of diverse human tissues  <cit>  and the other containing gene expression profiles of several soft-tissue tumor types  <cit> . in all cases, the approach we propose was able to cluster sets of genes and conditions that were related in sub-parts of the data. the analysis of functional annotations that were significantly over-represented in each gene module provided meaningful insights about the biological events associated to the experimental conditions. additionally, our methodology was able to find complex and less natural patterns that could not be detected by standard clustering algorithms. additional material and figures are available at the website  <cit> .

RESULTS
the goal of this study is to determine whether the proposed methodology is able to uncover local structures from gene expression data. to this end, we have used several simulated datasets containing different types of embedded structures as well as two large and heterogeneous gene expression datasets. in the next sections we describe an overview of the methodology and the detailed results of its application to the analysis of the synthetic and real datasets.

general model for discovering local structures by nsnmf
non-smooth non negative matrix factorization, as well as the classical nmf model, can be used to approximately reproduce a gene expression matrix v of dimension m genes and n samples as a product of two matrices w and h, with dimensions mxk and kxn respectively, where k <<m. the k columns of w have the dimension of a single array  and are known as factors or "basis experiments". the columns of h are known as encoding vectors and are in one-to-one correspondence with a single experiment of the gene expression data matrix . therefore, each row of h has the dimension of a single gene  and it is denoted as "basis gene".

each factor or basis experiment yielded by nsnmf contains a relatively small set of genes with non-zero coefficients that determine a local gene expression feature. these genes behave in a strongly correlated fashion in a sub-portion of the data and constitute a gene module. in the same way, coefficients in basis genes are used to determine the set of experimental conditions highly associated to these modules. in other words, the set of genes and experimental conditions that show high values in the same basis experiment  and its corresponding basis gene  respectively are highly related in only a sub-portion of the data and constitute a gene expression bicluster.

due to differences in the initial conditions used in the factorization this procedure can generate different sets of results across different runs of the algorithm. in this work we have exploited this non-deterministic nature of the nsnmf algorithm to determine the consistency of the uncovered patterns in two different ways. first, we have used the model selection method proposed by brunet et al.  <cit>  to determine the number of factors associated to stable partitions of conditions. second, we have evaluated the consistency of the gene modules obtained at a given rank by selecting the set of genes that were more representative in each factor and evaluating their consistency across several runs of the algorithm .

synthetic data
in order to test the potential of the method and its relative performance with respect to standard two-way hierarchical clustering analysis we first applied it to the analysis of two synthetic datasets containing overlapping and non-overlapping structures. in the first dataset , we aimed at testing the capacity of nsnmf in extracting non-overlapping obvious structures. this dataset contains two block structures embedded into a  <dig> Ã—  <dig> noisy matrix. figure  <dig> depicts the structures pla  and p2a . in the rest of this document we will refer to rows as genes and columns as conditions. as it was expected, average linkage two-way hierarchical clustering correctly grouped together genes and conditions belonging to both structures. based on the cluster dendrogram, conditions can be clearly separated into two groups, each one containing the set of conditions belonging to each one of the embedded patterns and some conditions related to background noise. nevertheless, the cluster dendrogram does not seem to suggest a clear sub-structure of three or more classes .

we then applied nsnmf to this data set. based on the cophenetic correlation coefficient we found high stability of the model at ranks  <dig> and  <dig> . matrix factorization at k =  <dig> was able to correctly partition the set of genes and conditions belonging to each one of the embedded patterns. when the matrix was sorted by the values of the first basis experiment and the corresponding basis gene the set of genes and conditions belonging to pla were grouped together in upper-left corner of the array. in the same way, genes and conditions belonging to p2a were co-clustered by the second basis experiment and basis gene . as it was expected, only gene modules defined by these two factors showed a high consistency across different runs of the algorithm , while genes belonging to the gene module defined by the third factor, related to background noise, varied across different factorizations .

we also tested the potential of our method to identify overlapped structures. figure  <dig> shows the results obtained in the analysis of dataset b, which contains four embedded patterns plb, p2b, p3b and p4b of sizes  <dig> Ã—  <dig>   <dig> Ã—  <dig>   <dig> Ã—  <dig> and  <dig> Ã—  <dig> respectively. in this dataset p2b shares three columns with plb and two columns with p3b. two-way hierarchical clustering performed well at grouping conditions and genes belonging to p4b while did not succeed in correctly identifying overlapped structures. conditions that overlap their expression profiles with different sets of conditions were associated to only one cluster. for example, columns that were overlapped among plb and p2b  were co-clustered with non-overlapping columns of p2b  but not with non-overlapping columns of plb . this was not surprising because this algorithm, as well as other classical clustering techniques, groups objects into discrete clusters masking potential relationships among objects grouped into different clusters.

based on the cophenetic correlation coefficient we could attest the robustness of the model at k =  <dig>  in addition, the gene modules defined by the four factors were highly consistent and they were all found in more than 95% of the factorizations. as can be seen in figure  <dig>  when the genes and the samples were sorted by their values in each basis experiment and basis gene obtained in the factorization, the four embedded patterns were correctly identified, including p2b that overlapped with two different structures. the first basis gene and basis experiment grouped together conditions and genes belonging to p3b, the second identified plb, the third identified p4b and, finally, the fourth basis gene and basis experiment co-clustered conditions and genes belonging to p2b.

as we have mentioned previously, even if nmf has been presented and used as a method capable of finding the underlying parts-based structure of complex data, there is no explicit guarantee in the method to support this property. this was the main motivation to develop and use a new matrix factorization technique capable of producing more localized, less smooth feature representations of the data like the nsnmf model. the sparsification on both the factors  and the encodings  tends to decrease the relevance of the non-significant elements in each feature, while reinforcing at the same time the most relevant ones. this fact was illustrated by applying standard nmf and nsnmf to the analysis of dataset a . this comparative analysis shows that basis experiments and basis genes obtained by nmf are not really sparse while those yielded by nsnmf represented more compact features of the dataset. in this way, values of non-relevant conditions and genes in each local pattern were significantly reduced in the case of nsnmf, which is more pronounced when the sparseness parameter is increased. this sparsification procedure is, therefore, intrinsic to the structure of the data. similar results were obtained when standard nmf and nsnmf were applied to real gene expression data , in which nsnmf generated more compact local features than the standard nmf method.

human transcriptome dataset
this dataset contains expression levels of thousands of human genes across a panel of  <dig> human tissues and is an invaluable source of information for the analysis of the human transcriptome  <cit> . due to its size and heterogeneity, this dataset is an ideal target to identify local structures of gene expression. uncovering and linking gene expression modules to phenotypic variation of cells or tissues can provide clues about tissue-specific functions or the molecular organization of diverse cells.

we applied nsnmf with a rank value of  <dig>  value in which the model showed a marked robustness as was attested by the corresponding peak in the cophenetic correlation coefficient. three of the eight gene expression modules, those corresponding to factors  <dig>   <dig> and  <dig>  showed a noticeable consistency  and the structures related to these modules were further examined.

the fourth basis experiment clustered a set of genes mainly expressed in samples from neural and brain tissues  which were clearly partitioned by the corresponding fourth basis gene . several go annotations related to neural functions such as "neurogenesis", "synaptic transmission" or "central nervous system development" were significantly over-represented in this module , which concord with the phenotype of samples that were highly associated to this module.

similarly, the fifth basis gene and basis experiment grouped together a set of samples related to blood and lymphoid tissues  and a set of genes that were mainly involved in immune system related functions such as "inflammatory response", "cellular defense response" or "antigen representation, endogenous antigen". go annotations related to signal transduction such as "signal transduction" or "intracellular signaling cascade" were also enriched in this gene module. many of the genes annotated with these two last categories present in the module, such as ncf <dig>  lcp <dig>  itk, syk, ha- <dig>  tyrobp, trem <dig> and stat <dig>  are genes that play important roles in the immune system activation.

finally, the last basis experiment defined a set of genes mainly involved in biological functions such as "spermatogenesis", "transcription" or "mitosis". these genes were over-expressed in five testis-related tissues  which were co-clustered by the corresponding basis gene. in addition, most of the probes annotated as testis specific genes included in the analysis, such as phkg <dig>  tctel <dig>  tegt, tes, tspy <dig> or tspy <dig> showed high coefficients in the eighth basis experiment, which supports the results obtained by our approach.

therefore, the method was able to recover block-structures composed by subsets of genes that behave similarly in subsets of samples related to the same anatomic location or physiological function.

additionally, our method performed better than standard hierarchical clustering analysis to uncover relationships among genes that share local similarities in their expression profiles with different sets of genes. for example, a set of genes that were over-expressed in testis tissues were clustered in distant positions to the testis-gene cluster by standard two-way clustering analysis due to global differences in their expression profiles . in contrast, our approach did succeed in grouping these genes in the testis-specific gene module  or in very close positions.

another example was provided by a set of  <dig> genes that were expressed in neural-and testis-derived tissues. two-way hierarchical clustering grouped these genes in the same branch that the set of testis-specific genes, but their relationship with neural-expressed genes could not be inferred by the cluster dendrogram itself . these genes showed a peak in basis experiments  <dig> and  <dig> which, as we have shown before, were related to neural and testis tissues respectively. our approach clustered these genes in close positions to both, the neural and testis gene modules . among these genes were some that have been previously reported as testis and brain expressed genes such as hspa <dig>  <cit>  or bscl <dig> <cit> .

soft-tissue tumor dataset
one of the applications in which biclustering methods can provide interesting results is the analysis of cancer datasets. local structures can be used to relate genes with specific tumor types or for classifying samples. we have analyzed the tumor dataset reported by nielsen et al.  <cit> , which comprises expression profiles of  <dig> samples corresponding to five different soft-tissue tumor types;  <dig> gastrointestinal stromal tumors,  <dig> monophasic synovial sarcomas,  <dig> liposarcomas,  <dig> leiomyosarcomas,  <dig> malignant fibrous histiocytomas and  <dig> benign peripheral nerve-sheath tumors . the aim of this analysis was to determine whether the proposed approach is able to recover the main block-structures associated to different tumor types.

we applied nsnmf to analyze this dataset with a rank value of  <dig>  at which we could attest robustness of the model with a correspondingly high cophenetic coefficient. the four gene expression modules obtained at this rank showed a high consistency . the first basis gene grouped together the set of synovial sarcomas samples and the first basis experiment revealed the set of genes mainly over-expressed in this tumor cluster . functional categories such as "regulation of transcription, dna-dependent", "development" or "neurogenesis" were enriched in this set of genes . in the case of the last category, a related observation was reported by nagayama et al., who analyzing the expression profile of different soft tissue tumor types also found that many over-expressed genes in synovial sarcomas were related to neural tissues and neural differentiation and they suggested a neuroectodermal origin of synovial sarcomas  <cit> . additionally, many other genes that have been previously related to synovial sarcomas, such as the ssx <dig> gene, egfr and sall <dig>  <cit> , components of the retinoic acid pathway  as well as retinoic acid induced genes   <cit> , were also included in this module.

the second basis gene clustered together a heterogeneous group of samples, including liposarcomas, some leiomyosarcomas and malignant fibrous histiocytosarcomas. an analysis of the corresponding basis experiment revealed a set of genes that were mainly annotated as "signal transduction" and with go categories related to immune and defense response such as "immune response" or "inflammatory response". in addition, other biological processes such as "cell adhesion" or "cell-matrix adhesion" were also over-represented in this set of genes. these observations are highly consistent with the findings reported in the original paper, in which the authors found that a set of genes with fibrous and histiocytic features were related to this heterogeneous group of tumors. the histiocytic part included genes characteristically expressed by macrophages, genes of the interferon-responsive cluster and genes associated with other inflammatory processes. the fibrous part of the gene set included genes related to the extracellular matrix and angiogenesis such as many genes for collagen and collagen metabolism  <cit> .

the third basis experiment and basis gene revealed a partition of  <dig> gastrointestinal stromal tumors and the genes that are relevant to induce this partition . go categories of "signal transduction" and "protein folding" were over-represented in this set of genes. among the genes involved in signal transduction the kit gene, one of the main markers of gastrointestinal stromal tumors, showed a high coefficient in this basis experiment. other markers of this type of tumors recently identified such as the gene flj <dig>   <cit>  or protein kinase c theta  <cit>  also showed very high coefficients in the third basis experiment.

in a similar way, the last structure defined by the fourth basis gene and basis experiment revealed genes mainly over-expressed in six of the  <dig> leiomyosarcomas and one liposarcoma . we found that go categories such as "metabolism, "muscle development" or "muscle contraction" were enriched in the set of genes belonging to this module. it is clear the relationship among the biological processes over-represented in this set of genes and the tissue origin of leiomyosarcomas samples.

these results demonstrate the ability of our algorithm to identify coherent substructures composed by sets of genes mainly expressed in samples related to the same tumor type. furthermore, the proposed approach gave not only a partition of samples and genes based on these local patterns, but also an internal ranking of them within a given local structure revealing which genes are relevant to induce these partitions.

discussion
the standardization and extension of the use of microarray technology is allowing researches to generate larger and more heterogeneous gene expression datasets, some of them containing hundreds of different experimental conditions. the size and heterogeneity of these datasets has opened new challenges for the development of computational methods able to uncover local relationships among genes and conditions rather than patterns based on global similarities. this demand is supported, in part, by the fact that genes involved in the same biological process might only be co-expressed in a subset of experimental conditions and show uncorrelated expression levels in the rest of conditions.

in this paper we present an approach able to cluster genes and conditions that are highly related in sub-portions of the data. the method is based on the non negative matrix factorization technique, which has been previously applied to gene expression data analysis in a one-dimensional way  <cit> . specifically, we have introduce a variant of the standard nmf algorithm, nsnmf  <cit> , that is an attempt to improve the capacity of the classical nmf in the parts-based representation of the data by producing improved sparse components of the gene expression matrix.

we note that the local structures obtained by this approach correspond to sets of genes highly over-expressed in subsets of experimental conditions and the order vectors  indicate the relevance of genes and the experiments in each local pattern. furthermore, genes and experimental conditions that show under-expression patterns or low expression values in these sub-parts of the data will show low coefficients in the corresponding basis gene and basis experiment respectively. therefore, these genes and experiments will be placed in the upper right and bottom left corners of the array, although we can not assume that they are also sorted by their association to an under-expression pattern.

the results obtained in this study from the analysis of two large and heterogeneous gene expression datasets, as well as several synthetic datasets, illustrates the usefulness of our method. the approach was able to cluster genes and samples that showed a high consistency in their expression profiles in sub-portions of the data. samples that were clustered together were related by identifiable criteria, such as samples derived from the same tumor type or physiologically related tissues. in the same way, the set of co-clustered genes were enriched in functional annotations that were in clear agreement with respect to the known biology about particular tissues or cellular types and provided insights into the main underlying biological process. similar results were obtained from the analysis of other datasets  showing that this technique can be a useful tool to extract meaningful patterns from gene expression data.

in contrast to most of the currently available biclustering algorithms that apply greedy iterative searches to find significant patterns, imposing constraints on the size or the number of biclusters, our approach provides an alternative solution to uncover "natural" substructures that are related to the main patterns of the expression matrix. the use of matrix factorization methods in the context of biclustering is gaining attention by the bioinformatics community. kluger et al.  <cit>  suggested the use of singular value decomposition to find checkerboard patterns in gene expression matrices and more recently dueck et al.  <cit>  proposed a probabilistic sparse factorization method to discover gene expression biclusters. both methods, although different in their nature, aims at extracting gene expression modules using matrix factorization techniques. the method proposed here can be included in this area, even though the objectives and constraints that it uses differ drastically from the ones proposed before. similar to the situation that occurs when comparing different oneway clustering techniques, a fair comparison of biclustering algorithms is difficult to carry out due to the different criteria used for each technique that obviously leads to different but still valid results which might vary depending on the data and the criteria used by the methods. we conducted some empirical comparisons to illustrate this issue using other biclustering methods. results can be found in the associated web site  <cit> . in this study we have shown that nsnmf can not only be successfully used in one dimensional way  <cit> , but it can also be effectively applied to extract biological meaningful biclusters.

we consider important to mention that although some theoretical work on the properties of nmf models exist  <cit> , much of the recent increasing interest of the method comes from its empirical success in extracting meaningful features from real data sets, where there is no guarantee that the data has a unique representation in terms of positive factors. this situation, as well as the non-deterministic nature of the method, is still an open problem that need a more extended work by the pattern recognition and machine learning community on both the theoretical and practical properties of the nmf family methods. regardless of this problem, it is not an illegal practice to force-fit the nmf model to the data. quite the contrary, the decomposition can be highly meaningful. the significant interpretation of the nmf model is the main reason that has motivated a recent explosion of applications in many fields, including for example gene expression  <cit> , sequence analysis  <cit> , functional characterization of gene lists  <cit>  or text mining  <cit> . what this means is that, even if one does not know if the data at hand has a true, exact, unique, and recoverable non-negative factor structure, the model can be fitted to the data, and the extracted "parts" can be analyzed and interpreted for meaning. this is precisely the thrust of this work.

the number of extracted structures is directly related to the factorization rank. in this work we have estimated the factorization rank using the model selection method introduced by brunet et al.  <cit> , which is related to the cluster structure of samples. this estimation allows us to generate significant partitions of samples as well as identifying the set of genes that are important to induce these partitions. nevertheless, higher ranks can reveal more localized patterns that might also be biologically relevant. in this sense, other estimations of the factorization rank such as the root-mean-square based estimation proposed by kim and tidor,  <cit>  might also be interesting to be explored.

in this work we have also shown that the proposed approach was able to detect complex patterns and relationships among genes and conditions that were hidden when standard two-way clustering was used in the analysis of the expression matrix.

CONCLUSIONS
in the present work we illustrate the application of the non-smooth non-negative matrix factorization technique for discovering local structures from gene expression datasets. biclustering methods have centered the attention of many researchers in the field of gene expression data analysis due to their potentials to uncover meaningful relationships among genes and conditions. we hope this new method actively helps in the data analysis and knowledge discovery process in gene expression experiments.

