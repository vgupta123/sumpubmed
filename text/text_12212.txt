BACKGROUND
molecular phylogenies of many taxonomic groups are based on analyses of single loci. while this approach has led to important insights into the evolution of many groups of interest , it is also hampered by a number of potential difficulties. for instance, due to effects such as horizontal gene transfer, hybridisation, lineage-sorting, paralogous genes, and pseudogenes, gene trees and species trees do not always agree  <cit> .

furthermore, length and, hence, information content of individual genes is limited, sometimes causing a lack of resolution in the inferred trees. saturation is an important problem, in particular if the resolution of relationships between major groups of organisms is aimed at  <cit> . nowadays, an increasing number of completely sequenced genomes are available and a growing field of phylogenetic research deals with the question of how to infer reliable phylogenies from this large amount of data to overcome the limitations of single-gene phylogenies.

a relatively obvious approach to phylogenetic analysis of whole genomes is to extract as many genes as possible from the genome sequences, create a multiple sequence alignment from each of the genes and to concatenate all alignments. datasets in the order of  <dig>   <dig> base pairs have been compiled in this way . such datasets can be analysed using the same phylogenetic inference tools as single loci datasets.

difficulties with this approach may arise if orthologous genes cannot be identified with certainty or if the combined sequence length is still too small to give well-resolved trees. furthermore, the use of concatenated multiple sequence alignments discards information that can be utilised by other methods of phylogenetic inference. for instance, methods that infer trees based on gene content  <cit> , gene order  <cit> , or content of protein orthologs and folds  <cit> . when applied to prokaryote phylogeny, these different methodological approaches lead to quite different results  <cit> . a further loss of information in the concatenated multiple sequence alignment approach may be caused by regions which have to be discarded since they cannot be aligned with certainty  <cit> .

in contrast, a third group of methods does not require to specify genes or orthologs in advance, to create multiple sequence alignments, and to discard unalignable regions, but is able to generate a distance matrix directly from complete genome sequences. trees can then be inferred using any of the standard distance-based phylogenetic methods , even though phylogenetic networks  <cit>  may be a more powerful way to explore such distance data. some of these approaches use differences in word-count frequencies  <cit> , complexity-based measures  <cit>  or breakpoint analysis  <cit>  to derive pairwise distance functions.

the methods of particular interest to us in this paper  <cit>  rely on identification of local regions of high sequence similarity between two genomes, this is usually done with the popular tool blast  <cit> . henz et al.  <cit>  recently described the "genome blast distance phylogeny"  approach and applied it to deep prokaryote phylogeny. in brief, gbdp works by finding a set of high-scoring segment pairs  between each pair of genomes, deriving a distance function from these sets, and building a tree or a network using algorithms like upgma  <cit> , nj  <cit> , bionj  <cit>  or neighbor-net  <cit> .

statistical support of individual branches within trees inferred from multiple sequence alignments is usually assessed by bootstrapping  <cit> , which assumes a number of statistically independent individual characters. similar to some other less commonly used but valuable  phylogenetic methods such as elision  <cit> , direct optimisation  <cit> , fixed-states and search-based optimisation  <cit> , or pair-wise distances between unaligned sequences from single loci  <cit> , the above-mentioned genome distance methods cannot readily be combined with the bootstrap since the whole genome is treated as a single character.

in our view, this potential disadvantage is outweighed by the fact that distance methods may be combined with phylogenetic network techniques, which have some distinct advantages over bootstrapping . for instance, bootstrapping cannot distinguish between conflicting signal and low amount of signal, and bootstrapping cannot identify "rogue taxa" . furthermore, many evolutionary processes are better represented by networks than by trees  <cit> . network techniques are better suited than bootstrapping to detect systematic error in phylogenetic analyses, particularly in very large datasets such as genomescale data  <cit> . neighbor-net is also much faster than even neighbor-joining bootstrapping  <cit> . since distance methods such as gbdp may also directly use complete genome sequences, their combination with network techniques may be more efficient than bootstrapping of concatenated multiple sequence alignments.

the present article builds on the work of henz et al.  <cit>  and extends it in several ways. here, we apply gbdp to completely sequenced plastid and mitochondrion genomes to infer relationships of major eukaryotic groups. plastid and mitochondrion genomes are highly, sometimes extremely, reduced, and are subject to evolutionary conditions quite different from prokaryote genomes. we were thus interested in whether gbdp would perform as well as with genomes of prokaryotes  <cit> , and if so, under which conditions. completely sequenced plastid genomes have been used in a number of articles  to infer phylogenetic relationships based on sequence alignments of many concatenated genes, enabling us to directly compare the gbdp results with respect to, e.g., recovery and placement of major eukaryotic groups and location of primary and secondary endosymbiosis events.

we also examine additional modifications of gbdp. a new distance function based on sequence identity within hsps is introduced. different formulae for creating symmetric similarity scores from the asymmetric results of blast comparisons are examined, as well as two different formulae to derive distances from similarity values. we also investigate the use of protein-protein blast  instead of nucleotide-nucleotide blast  and two ways of combining the two methods of hsp search. accuracy of trees inferred from gbdp distances by three well-known  and two recently described reconstruction methods  is measured by comparison with current ncbi taxonomy based on c-scores  <cit> . the c-score is defined as the number of non-trivial splits in the phylogenetic tree under study which are compatible  <cit>  to the reference topology divided by the total number of non-trivial splits in the test tree. these compatible splits are either already included in the reference topology, or a refinement of the topology, but do not conflict with it. the c-score's denominator is useful to correct for, e.g., a different number of taxa or a different amount of resolution in the test trees. the main factors increasing or decreasing gbdp accuracy were determined by multiple regression analysis with c-score as dependent variable.

holland et al.  <cit>  described a statistical geometry approach to estimate the departure of a distance matrix from the additivity condition  <cit> , i.e., the degree to which it is not treelike, by computing so-called δ values for all quartets of taxa. a similar approach is the q criterion of guindon and gascuel  <cit> , which is also computed from taxon quartets and can be used to assess the treelikeness of a distance matrix. as most distance methods are guaranteed to infer the correct tree from completely additive distances, distance matrices with the least departure from additivity should be preferable  <cit> . an additional advantage of δ values is that they are, in contrast to, e.g., c-scores, independent of any preconceived hypothesis on how the true phylogeny looks like. we thus examined quality of each gbdp distance matrix in phylogeny reconstruction directly by measuring its mean δ value. as an empirical investigation of the approach described by holland et al.  <cit> , suitability of δ values in predicting phylogenetic accuracy could then be assessed by regression analyses.

methods
taxon selection
completely sequenced plastid and mitochondrial genomes were downloaded from ncbi  <cit>  and embl  <cit> . if more than one plastid or mitochondrial genome of the same species was available, we checked them for length differences and randomly selected one sequence representing each of the length classes found. the most recently published completely sequenced plastid genomes that could be considered were acorus calamus  <cit>  and pseudendoclonium akinetum  <cit> . we also included two completely sequenced genomes of a special kind of organelle found in apicomplexa as these "apicoplasts" have previously been shown to be most likely derived from plastids  <cit> . as outgroup specimens, we included three cyanobacteria genomes  in the dataset, resulting in a total of  <dig> genomes for the plastid analyses.

to infer the position of the root in the analyses of mitochondrial genomes, members of the α-proteobacteria genera rickettsia and wolbachia were included in the dataset. partly due to the lack of plastids in most eukaryotes and partly due to the importance of mitochondrial genes in phylogeny reconstruction in metazoa, particularly vertebrates , many more completely sequenced genomes are available for mitochondria than for plastids. we thus decided to represent the main lineages within metazoa-coelomata, e.g., arthropoda and vertebrata, by only a single taxon, respectively, and arrived at a total of  <dig> mitochondrial  sequences, which we believe to be representative. including more mitochondrial genomes in the study would have made all analyses considerably more time-consuming and would have made the plastid and mitochondrial data less comparable since mitochondrial genome availability is currently severely biased towards certain metazoan lineages. our taxon selection does not imply that the excluded mitochondrial sequences, or the application of the methods described here to these sequences, are devoid of scientific interest. rather, the related questions are beyond the scope of the present article.

variants of genome blast distance
the first step in computing any of the gbdp methods explored in the present paper is an all-against-all pairwise comparison of all genomes using blast  <cit> . a list of high-scoring segment pairs  is determined for each pair of genomes x and y including data on location, length, and significance  of the individual hsps. henz et al.  <cit>  observed that thereafter it is advantageous to determine a maximum subset of hsps which are non-overlapping in both sequences x and y, and that this can be accomplished using the greedy-with-trimming approach. this approach is described fully in  <cit> , in brief, hsps are selected in decreasing order of length, all of the hsps that have yet to be selected are trimmed of any overlap with the currently selected hsp and placed back into the sorted list of hsps still to be selected. next genome similarity values are inferred from the lists of non-overlapping hsps, this can be done in different ways.

one method relies on the concept of breakpoints  <cit> .

in short, a breakpoint occurs if a third, intervening hsp is found between two hsps in x, but not between the two corresponding hsps in y . let bx and by be the number of breakpoints in x or y, respectively, and mx and my denote the number of matched intervals  on the x genome or the y genome, respectively. we then define a breakpoint similarity function between x and y as

sbreakpoint:=1−bx+bymx+my     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbwcdawgaawcbagaemoyaimaemocainaemyzaumaemyyaemaem4aasmaemicaanaem4ba8gcbigae8xaakmae8nba4mae8hdaqhabeaakiabcicaoiabdifayjabcycasiabdmfazjabcmcapiabcqda6iabg2da9iabigdaxiabgkhitmaalaaabagaemoqai0aasbaasqaaiabdifaybqabagccqghrawkcqwgcbgqdawgaawcbagaemywakfabeaaaoqaaiabd2eannaabaaaleaacqwgybawaeqaaogaey4kasiaemyta00aasbaasqaaiabdmfazbqabaaaaogaaczcaiaaxmaadaqadiqaaiabigdaxagaayjkaiaawmcaaaaa@54a0@

a distance equivalent of this formula was presented by henz et al. ).

an entirely different approach is based on the proportion of nucleotides  found in the set of non-overlapping hsps compared to the total number of nucleotides, i.e., the length of the genome. let |xmatch| and |ymatch| be the number of base pairs covered by the selected non-overlapping hsps in x or y, respectively, and |x| and |y| be the total length of the respective genome. similarity formulae may then be defined as follows:

smatch:=|xmatch|+|ymatch||x|+|y|     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbwcdawgaawcbagaemyba0maemyyaemaemidaqnaem4yammaemiaaggabeaakiabcicaoiabdifayjabcycasiabdmfazjabcmcapiabcqda6iabg2da9maalaaabawaaqwaceaacqwgybawdawgaawcbagaemyba0maemyyaemaemidaqnaem4yammaemiaaggabeaaaogaay5bslaawia7aiabgucarmaaemgabagaemywak1aasbaasqaaiabd2gatjabdggahjabdsha0jabdogajjabdigaobqabaaakiaawea7cagliwoaaeaadaabdiqaaiabdifaybgaay5bslaawia7aiabgucarmaaemgabagaemywakfacaglhwuaayjcsdaaaiaaxmaacawljawaaewaceaacqaiyagmaiaawicacaglpaaaaaa@6127@

smcorr:=|xmatch|+|ymatch|2min⁡     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbwcdawgaawcbagaemyba0maem4yammaem4ba8maemocainaemocaihabeaakiabcicaoiabdifayjabcycasiabdmfazjabcmcapiabcqda6iabg2da9maalaaabawaaqwaceaacqwgybawdawgaawcbagaemyba0maemyyaemaemidaqnaem4yammaemiaaggabeaaaogaay5bslaawia7aiabgucarmaaemgabagaemywak1aasbaasqaaiabd2gatjabdggahjabdsha0jabdogajjabdigaobqabaaakiaawea7cagliwoaaeaacqaiyagmcyggtbqbcqggpbqacqggubgbcqggoaakdaabdiqaaiabdifaybgaay5bslaawia7aiabcycasmaaemgabagaemywakfacaglhwuaayjcsdgaeiykakcaaiaaxmaacawljawaaewaceaacqaizawmaiaawicacaglpaaaaaa@6819@

a distance equivalent of the second formula was presented by henz et al. ). they observed that it performed better than the equivalent of the first similarity function if some genomes were essentially subsets of other genomes because their evolutionary history included a considerable number of gene losses.

we now introduce a fourth similarity  function based on the proportion of identical base pairs within the set of non-overlapping hsps to the total length of this set. defining i as the sum of the number of identical base pairs over all hsps, and h := ∑h∈hsps max as the sum of the lengths of the larger interval for each hsp, we obtain

sid:=1h     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbwcdawgaawcbagaemyaakmaemizaqgabeaakiabcicaoiabdifayjabcycasiabdmfazjabcmcapiabcqda6iabg2da9maalaaabagaegymaedabagaemisageaaiaaxmaacawljawaaewaceaacqai0aanaiaawicacaglpaaaaaa@3de3@

again, this function works equivalently with tblastx instead of blastn, if we replace nucleotides by amino acids.

literature definitions of the term "similarity" usually agree that similarity values should be constrained between  <dig>  and  <dig> , a condition which holds for the formulae listed above by definition. there is, however, no unique way to define "distance" and no unique formula to derive distance values from similarity values. let d denote the distance between x and y to be computed from the similarity function. the most important options for conversion  are

d :=  <dig> - s      

and

d := -log)     

most formulae described for computing distances from multiple dna or protein alignments use a logarithmic derivation to correct for saturation effects in the sequence data . here we apply both formulae to all above-mentioned similarity functions and test their relative perfomance a posteriori.

phylogenetic methods which infer trees from pairwise distance matrices usually expect the distances to be symmetric, i.e., they require that d = d holds even if x is not equal to y. blast, however, is asymmetric by definition  <cit> . we therefore inferred symmetric genome blast distances in three ways: as the average  <cit> , minimum, or maximum value of d and d. we examined whether the quality of the distances and the inferred tree is affected by the choice of approach.

another way to modify the gbdp approach is to use tblastx instead of blastn as already proposed by henz et al.  <cit> , i.e., to search for homologies at the protein level instead of at the nucleotide level. both blast methods could also be combined. as the greedy-with-trimming approach already sorts hsps by decreasing length, one way of combining blastn and tblastx hsps is to sort them together, so that the usually longer hsps derived from tblastx suppress shorter overlapping blastn hsps. a more equally-weighted method of combination is to compute blastn and tblastx genome distance matrices separately and to determine the average of both matrices afterwards . before inferring the mean matrix, distance matrices usually need to be brought to the same scale. a reliable and generally applicable method of rescaling is the so-called ranging procedure which consists of dividing all values in one matrix by the maximum value observed in that matrix  <cit> . we examined four possibilities for performing hsp search: use of either blastn or tblastx alone, or a combination of blastn and tblastx either before or after distance matrix computation.

note that it has not been established for any of the above-mentioned gbdp methods that they will necessarily result in a distance matrix which is metric, i.e., obeys to the triangle inequality . hence, they cannot be called "distances" in a strictly mathematical sense. nevertheless, as pointed out by felsenstein  <cit> , this is also true for phylogenetic distance formulae based on multiple sequence alignments such as the jukes-cantor equation, and, more importantly, "most distance methods do not absolutely require the triangle inequality to hold".

quality assessment of distances and phylogenies
the quality of the distance formulae described above for phylogeny reconstruction was assessed in two ways. first, we compared the topology of phylogenetic trees inferred from the respective distance matrix with the topology of the ncbi taxonomy of the taxa involved  by computing the c-score. the ncbi taxonomy tree can be regarded as an estimate of the "true" phylogeny, although it is not fully resolved.

three standard distance-based phylogeny reconstruction methods were applied to the distance matrices, i.e., upgma  <cit>  and nj  <cit>  as implemented in the phylip package version  <dig>   <cit>  as well as bionj, a modification of the nj algorithm described and implemented by gascuel  <cit> . additionally, two more recently described distance methods were considered, fastme  <cit>  and shortest triplet clustering . both are said to be faster than any known nj variant and more accurate, particularly if large numbers of taxa are involved. fastme was run under the balanced minimum evolution criterion  <cit>  including balanced nni branch swapping.

compared to trees, phylogenetic networks are more general graphs and may contain conflicting branching patterns. such networks can be used to visualize hybridisation, horizontal gene transfer, recombination events or noise in the data due to finite length of sequences or inadequacy of the statistical model used to infer pairwise distances  <cit> . several methods are available to infer networks from distance data . here, the recently described agglomerative neighbour-net algorithm  <cit>  as implemented in splitstree <dig>  <cit>  was used to visualize treelikeness of and phylogenetic information contained in selected distance matrices. treelikeness cannot appropriately be visualised by means of tree reconstruction methods such as neighbor-joining since these will force every distance matrix into a tree irrespective of how treelike it actually is. neighbor-net is fast and frequently leads to greater resolution than older methods like split decomposition  <cit> . on the other hand, it would not make much sense to compute c-scores from phylogenetic networks to assess topological accuracy. since methods such as neighbor-net are designed to allow the simultaneous representation of multiple trees, or at least to display conflicting signal as well as other non-treelike aspects of the data, the c-score would clearly underestimate topological accuracy  <cit> . the latter is much better represented by the c-score of a phylogenetic tree, which most likely consists of a subset of the splits represented in a network if inferred from the same distance matrix.

holland et al.  <cit>  introduced the computation of so-called δ values for each quartet of taxa present in the whole dataset . a lower δ value indicates greater correspondence to buneman's condition of tree additivity  <cit>  which is fully satisfied, if δ approaches zero. δ values can be averaged over individual taxa; in that case, large values of δ may, e.g., indicate hybrids  <cit>  or taxa whose evolutionary history, as far as represented by its sequence data at hand, has a particularly low fit to the distance method in use. one can also compute the mean δ value of complete distance matrices which indicates suitability of the respective data or the distance function applied to these data for phylogeny reconstruction in general. a script written in the python language was used to compute δ values of the individual genomes as well as average δ values under all distance approaches considered here. 

a complete data set is available for download , containing all reconstructed phylogenetic trees and their corresponding c-scores and δ values .

regression analysis
the individual distance functions described above were recoded into their four independent components , , , or ; equation  or ; average, minimum, or maximum of asymmetric distance values; blastn, tblastx, blastn after tblastx, or matrix combination) each of which was treated as a single qualitative variable with four, two, three, or four possible states, respectively  <cit> . the phylogenetic reconstruction methods are also easily coded as a single quantitative variable with five states . two multiple linear regression approaches were used:

 <dig>  δ value as dependent on the distance components.

 <dig>  c-score as dependent on distance components and tree reconstruction methods.

all statistical analyses were carried through using the r package . r automatically recodes qualitative variables into a set of binary variables  carrying the same information and suitable for linear regression. r also provides a step-wise regression procedure to eliminate insignificant variables based on the akaike information criterion . the aic tries to achieve a balance between model simplicity  and model likelihood, in accordance with the well-known principle called ockham's razor . in each step of the procedure, a variable which, according to the aic, does not significantly improve the fit of the regression model to the data is removed and all regression parameters such as regression coefficients and t values  <cit>  are recomputed. the step-wise elimination stops when all explanatory variables left make a significant contribution.

RESULTS
which distance function is optimal?
henz et al.  <cit>  observed that breakpoint distances performed very poorly in comparing prokaryote genomes which is in accordance with the commonly held view that breakpoint methods lead to reliable results only if the genomes are sufficiently co-linear. regression analyses indicate that, if applied to plastid and mitochondrion data, breakpoint distances as based on equation  had by far the worst performance of all distance formulae with respect to δ values and c-scores. we conclude that on the taxonomic level examined here neither mitochondrion nor plastid genomes have a sufficient amount of co-linearity for the breakpoint method to be successful.

it also follows from the regression analysis that results obtained with distances based on nucleotide  identity within hsps relative to the total length of hsps ) are inferior to those obtained with the matched distance variants  and ), an observation which could be explained as follows. if two taxa are only distantly related, hsps will only be found in the most conservative parts of their genomes. it may well be that these loci are so conserved that nucleotides are mostly identical within these hsps. more closely related taxa, on the other hand, will share more hsps some of which will correspond to less conserved loci displaying more disagreement between the two sequences. if plotted against corresponding matched distance values , hsp identity distances at first appear linearly related, but decrease again for largest values of matched distance, supporting our interpretation. it could be argued that the hsp identity distance approach should be used only if genomes are not too distantly related, although in most cases it would still perform much better than breakpoint distances. with mitochondrial genomes, the tied highest c-score was achieved by one of the matched distances and one of the hsp identity distance variants.

large differences in genome length are often due to a considerable loss of genes related to particular ecological adaptations such as parasitism or mutualism  <cit> . the main difference between the two matched similarity formulae examined here is that equation  attempts to correct for presence of such genomes heavily reduced in size. interestingly, equation  performed better than the corrected one with respect to both δ value and c-score . on the other hand, formula  always led to a correct placement of the reduced genome of epifagus virginiana , whereas epifagus was wrongly located at the base of angiosperms, if equations  and  were combined . however, if formula  was used in conjunction with , the position of epifagus was correctly revealed . we suggest that formulae not corrected for genome size may usually be superior, but that the size-corrected one should be preferred in case of evidence for extreme gene loss in one or more of the genomes investigated  <cit> . it seems worth noting that use of hsp identity distances also led to epifagus misplacement at the root of angiosperms  similar to figure  <dig>  even though equation  does not refer to total genome lengths.

deriving distances from pairwise similarities as their negative logarithm ) performs worse than subtraction from  <dig> ) with respect to δ value, but has no significant effect on c-score . on the contrary, using the logarithm may improve topological accuracy with respect to taxa with extreme genome modifications like epifagus . however, the suggestion of holland et al.  <cit>  to remove those taxa with largest individual δ values would also have been of use with size-uncorrected distances derived by subtraction, as epifagus had a δ value of  <dig>  compared to the average δ of  <dig>  obtained with the distance matrix underlying figure  <dig>  we hypothesise that in most cases choosing either subtraction or negative logarithm only has an effect on scaling.

in the multiple sequence alignment setting distances are typically corrected for multiple changes, such corrections require an explicit model of nucleotide substitution  <cit> . a challenge for future research could be to relate gbdp distance functions to models of genome evolution, so that similar types of correction could be applied. however, it would also be interesting to gather more data on the behaviour of δ values when applied to multiple sequence alignments under different types of correction. possibly, p-distances sometimes result in better δ values. it may well be that the most complex model or the best model according to the maximum likelihood criterion does not result in the lowest δ values  <cit> .

we did not observe significant differences in performance between the average, maximum, or minimum value approach to conversion of asymmetric into symmetric distance values. asymmetric gbdp distance values are due to an artefact of using blast  <cit>  and have no obvious biological meaning. furthermore, numeric differences between corresponding asymmetric values were in general quite low, although they increased with increasing absolute value of their average  and thus could to some degree correspond to the variance of these distances.

which hsp search and which reconstruction method is optimal?
regression analysis  indicates that replacing blastn by tblastx leads to a small improvement in the results and that a combination of tblastx and blastn at the hsp level  works even better. combination at the distance matrix level still performs better than using blastn alone, although less significantly so than do tblastx and combination at the hsp level. we conclude that this difference is due to greater sequence conservation at the protein level, hence, tblastx gives better resolution, especially at the backbone of the phylogenetic trees. it also seems plausible that nucleotide and protein sequences, respectively, may contain different information and that combining both levels in some way is useful in extracting phylogenetic signal from the data.

on the other hand, the effect of the different methods of hsp determination and combination is much less than the effects of either choice of data type , or choice of distance function . whereas tblastx hsp search takes much longer than blastn search, trees inferred from distances based on tblastx are not considerably more accurate. computation time is no severe problem with the mitochondrial and plastid data examined here, but may be limiting if longer sequences like prokaryotic genomes  <cit>  and/or many more taxa  are examined. therefore, the use of blastn may be the more efficient method under most conditions.

with respect to tree reconstruction methods, regression results indicate that bionj  <cit>  works best overall, but that the original nj algorithm  <cit>  and the more recently described fastme method  <cit>  do not perform significantly worse. mean c-score values were  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  for bionj, fastme, nj, upgma, and stc; more importantly, the best values for each reconstruction method were  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  respectively. given that fastme has a lower time complexity than bionj and nj  <cit> , we conclude that the former method is preferable with this kind of distances, especially if large numbers of taxa are involved. the low c-scores of the upgma trees are as expected, like other clustering methods, upgma  <cit>  is known to work well only if the distances at least approximately satisfy the ultrametric condition. this condition usually only holds, if rates of evolutionary change do not vary very much between lineages . however, upgma performed surprisingly well with low-quality distances .

considering the results of vinh and von haeseler  <cit> , the relatively poor performance of shortest triplet clustering  is surprising. these authors demonstrated that with large numbers of taxa stc performs better than nj, bionj, and gme or bme . vinh and von haeseler  <cit>  also showed that these five algorithms work equally well if they are used to initially build a tree which is then improved by nni branch swapping under the balanced minimum evolution criterion . here we only used bnni in conjunction with fastme, so the performance of stc should have been worse than that of fastme, but better than that of either nj, bionj, and upgma. however, an important difference between vinh and von haeseler  <cit>  and the present study is that we included some distance data of apparently very low quality. figure  <dig> indeed shows that stc performs particularly poorly for distances with a high δ value, but that it works well on high quality distance matrices, in accordance with vinh and von haeseler  <cit> . furthermore, these authors focussed on the performance of reconstruction methods with very large  numbers of taxa. it must also be emphasised that distance quality, as measured by δ values, explains a much larger part of the variance in c-score than does the reconstruction method factor .

phylogenetic aspects
regression results indicate that plastid genomes generally performed significantly better than complete mitochondrial sequences with respect to both δ values and c-scores, i.e., correspondence of the resulting trees to current ncbi taxonomy. indeed, δ values of distance matrices ranged from  <dig>  to  <dig> , if inferred from mitochondrial genomes, but from  <dig>  to  <dig> , if inferred from plastid genomes. c-scores ranged from  <dig>  to  <dig>  for mitochondrial data, but from  <dig>  to  <dig>  for plastid data compared to a maximum of  <dig>  found by henz et al.  <cit>  when applying gbdp to  <dig> prokaryotic genomes. underlying genome data was one of the most important factors in explaining distance quality .

we conclude that mitochondrial genomes are saturated for comparisons of the members of the main eukaryotic groups. maximum values in distance matrices derived from mitochondria were generally larger than those found in corresponding distances derived from plastid genomes . consequently, the best mitochondrial phylogenies look rather unresolved .

furthermore, some major eukaryotic groups don't appear as monophyletic in the network, although they are frequently split into only a few different clusters. for instance, metazoa are divided into porifera  and zoantharia  on the one hand and bilateria , i.e., all remaining included metazoan taxa on the other hand. fungi are almost completely recovered, except cryptococcus, four chytridomycete taxa , and the highly derived allomyces, which are misplaced. some smaller taxonomic groups of similar rank are completely recovered like α-proteobacteria , rhodophyta and, although less clearly so, stramenopiles. in contrast, viridiplantae  are split into a considerable number of clusters.

however, several subclades of main eukaryotic groups are recovered. for instance, platyhelminthes  and coelomata  within metazoa as well as embryophyta  within viridiplantae appear as clusters in the phylogenetic network. we suggest that mitochondrial data are of greater use when applied within the major groups of eukaryotes, e.g., within deuterostomia, and that it would be interesting to apply gbdp to such taxon sets. other authors were indeed able to construct robust phylogenies from unaligned mitochondrial genomes within, e.g., vertebrates  <cit> .

on the other hand, we see no evidence that the low backbone resolution of our mitochondrial network is due to shortcomings of the gbdp methodology. to our knowledge, mitochondrial genome-scale analyses through concatenation of single loci and inference of trees using standard methods have not been conducted so far with a taxon sampling as comprehensive as ours. this may even be impossible, since mitochondrial genomes of diverse eukaryotic groups may not share a sufficient number of loci. an advantage of gbdp-like methods  over standard methods based on multiple sequence alignment is that the former do not assume that homology of single nucleotides or amino acids can be established throughout the loci. here, we were able to compute distance matrices and to assess resolution from the phylogenetic networks without any necessity to preprocess the genomic data.

in contrast to mitochondrial genomes, best plastid-based gbdp distances and trees were of high quality as measured by δ value as well as c-score, and are worth discussing in greater detail. a possible limitation of the c-score in assessing quality of phylogenetic trees derived from plastid genes or genomes is that the reference taxonomy, as far as it relies on molecular data, is usually based on nuclear genes. whereas it is now generally assumed that primary endosymbiosis giving rise to plant-like eukaryotes occurred only once  <cit> , events like secondary or even tertiary endosymbiosis should lead to incongruence between plastid-derived and nucleus-derived molecular phylogenies. however, we observed that splits potentially causing such conflict  are not included in current ncbi taxonomy, which is far from being completely resolved.

thus, our c-score implementation should not be affected by this potential bias, although secondary endosymbiosis events are well recovered by best gbdp trees . for instance, both odontella sinensis  and guillardia theta  cluster together with red algae . the plastids of plant-like organisms within stramenopiles as well as cryptophyta are currently assumed to be derived from red algae  <cit> . plastids of euglenozoa are also thought to have originated by secondary endosymbiosis, but by incorporation of algae of basal position within the "green" lineage, although exact placement of euglenozoa plastids within that lineage is uncertain  <cit> . in accordance with that view, the euglena genomes included in our sample show affinities to basal streptophyta.

interestingly, organelle  genomes of alveolata are placed by gbdp as sister taxon of euglenozoa. these apicoplasts have only relatively recently been demonstrated to be most probably identical to plastids  <cit> . the "chromalveolata hypothesis" states that alveolata  are closely related to stramenopiles as well as to a couple of smaller groups like cryptophyta, and that plastids found in these clades originated by a single secondary endosymbiosis event . two recent studies  <cit>  revealed that plastid-targeted gapdh enzymes of chromalveolata including toxoplasma and plasmodium  formed a distinct class unrelated to paralogous genes found in land plants, green algae, and red algae, a result which was interpreted as indicative of a single origin of plastids in chromalveolata including apicomplexa. on the other hand, one could ask whether genes belonging to the same family of plastid-targeted genes need to be targeted to the same kind of plastids. so far, studies based on plastid data themselves  <cit>  indicate a sister-group relationship of euglenozoa and apicomplexa organelles and, hence, multiple origins of plastids in chromalveolata, a hypothesis which is supported by gbdp applied to complete plastid genome sequences.

the position of the outgroup species is not in agreement with ncbi taxonomy, as cyanobacteria appear as nested within viridiplantae, the "green" plant lineage comprised of chlorophyta  and streptophyta . within green plants, streptophyta and streptophytina  are recovered. chlorophyta is also revealed as monophyletic except for nephroselmis  which shows affinities to streptophyta. on the other hand, neighbor-net reveals conflicting signal located near what is expected to be the basal node of the network indicating that gbdp does not resolve the most basal branchings of plastid evolution including the origin of the green lineage. the long branch separating cyanobacteria and plastids may be indicative of the large amount of gene loss and/or gene transfer to the nucleus which accompanied plastid creation via endosymbiosis  <cit> .

within land plants, positions of ferns , mosses , hornworts , and liverworts , are not resolved. considering the problems more traditional methods of phylogenetic inference have had in resolving basal land plant relationships, this outcome should not be regarded as due to some deficiency in gbdp. the position of mosses, hornworts, and liverworts remains controversial in the literature. the most recent studies based on plastid multi-gene multiple sequence alignment indicate that these clades form a monophyletic group, but corrections for amino acid composition bias are required to achieve that result  <cit>  .

relationships between seed plants are well recovered except for placement of epifagus. epifagus virginiana  is a reduced, achlorophyllous land plant which in the course of its adaptation to parasitism on other land plants completely lost its photosynthetic ability  <cit> . as a consequence, epifagus apparently also lost related metabolic genes, many of which would have been located within the plastid genome. total length of its plastid genome is  <dig> kb, which is  <dig> % and  <dig> % of the plastid genome length found in atropa and nicotiana, respectively. as already mentioned, epifagus gets misplaced at the base of angiosperms, if gbdp is derived according to equation  in combination with equation  . corrected distances ; not shown) as well as formula  in conjunction with formula  recover epifagus's sister-group relationship to atropa and nicotiana .

members of the grass family  seem to be misplaced near the root of the angiosperms in both plastid/neighbor-net reconstructions depicted. however, figure  <dig> also shows alternative splits indicating a sister-group relationship between acorus calamus and poaceae in accordance with monocot monophyly. the position of the monocot taxa remained controversial in analyses of multiple plastid gene alignments from a small number of selected flowering plant taxa  <cit> . agreement with studies including several hundreds of species and few genes  was only recently achieved by including a more representative set of taxa from incompletely sequence plastid genomes  <cit> . as with respect to basal land plant resolution, we conclude that these results point to problems inherent to plastid data . we see no evidence that gbdp performs less well than do more commonly used approaches based on multiple sequence alignment.

CONCLUSIONS
as a contribution to the growing field of phylogenomics, we here inferred gbdp phylogenies from completely sequenced plastid and mitochondrial genomes. in search for an optimal approach, a number of modifications of gbdp were examined. the effects of the individual distance function parameters on distance matrix quality and on the accuracy of the resulting trees were examined by multiple linear regression. such a framework can also be used in future studies to assess other phylogenetic distance methods.

it turned out that accuracy of the resulting trees is in good accordance with the treelikeness of the underlying distance matrices as measured by their δ value. as a valuable approach in general, δ values should be particularly useful in future research if a choice has to be made between different distance methods but a reference tree is unavailable or cannot be used because additional independent phylogenetic evidence is aimed at. for instance, it would be interesting to compare δ values obtained with gbdp with those obtained with other methods which infer distances directly from whole genomes . however, δ values may also be used to find the optimal substitution model for aligned nucleotide or amino acid sequences  <cit> . if trees are to be inferred using distance methods anyway, this approach may be more consistent than the more commonly used likelihood-based criteria  <cit> . if unambiguous multiple sequence alignment is difficult, it may also be useful to infer distances matrices directly from single loci . δ values could be used to compare these distance methods with each other and with distance derived from different alignments of the same sequence data. the δ approach is not restricted to sequence data but could also be used to assess other kinds of phylogenetic distance functions such as those for restriction endonuclease or immunological data  <cit>  or even distance formulae based on the distribution of parasite species on their hosts . note that the q criterion as formulated by guindon and gascuel  <cit>  is computed in almost the same way as δ; it would be interesting to compare these two quartet-based measures of treelikeness in future studies.

regarding the gbdp variants, it became obvious that distances based on breakpoints are of little use. on the other hand, distances based on the proportion of "matched" hsp length to average genome length performed best in tree estimation. furthermore, replacing blastn by tblastx in the gbdp approach led to a small increase in accuracy. combining tblastx and blastn hsp search may also be beneficial. interestingly, combination works almost equally well before and after distance computation. we showed that other factors do not have much effect on the resulting phylogenies. distance quality also had a much larger effect than reconstruction methods. if applied to high quality distance matrices, all agglomerative methods we examined performed well except for upgma. in accordance with earlier studies, neighbor-net was found to be particularly useful to visualize the results. it provides an efficient way to demonstrate the tree-likeness of the distance matrices and the amount of conflicting signal or unambiguous support for certain phylogenetic relationships in the data.

with respect to the phylogenetic outcome, we conclude that completely sequenced mitochondrial genomes suffer from saturation. application of gbdp to mitochondrial genomes may be more valuable within major eukaryotic lineages such as metazoa. in contrast, plastid gbdp led to much more accurate phylogenies if based on the most treelike distance matrices. besides recovering major plant lineages as recognised in current ncbi taxonomy, best plastid gbdp distances reveal a sister-group relationship between apicomplexa and euglenozoa plastids, indicating the plastid evolution in chromalveolata may have been more complicated than currently recognised.

authors' contributions
programming was done by afa, srh and brh. mg conceptualised the study and wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
tab delimited text file containing the characteristic parameters and the quality measures of the distance matrices used for regression analyses, as well as all trees inferred in the course of this study in newick format.

click here for file

 acknowledgements
the authors are grateful to m. turmel and v. goremykin for sending us the sequence of the pseudendoclonium and acorus plastid genome, respectively. we thank l. s. vinh and a. von haeseler for helpful comments on stc and fastme. j. dietzsch also provided useful comments. financial support provided by the deutsche forschungsgemeinschaft for afa is gratefully acknowledged.

figures and tables
