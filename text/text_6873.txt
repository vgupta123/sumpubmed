BACKGROUND
repeat-induced point mutation  is a genome defence mechanism found within filamentous ascomycete fungi that is purported to combat transposon invasion. rip mutates duplicated dna sequences during sexual reproduction, thereby inactivating genes encoded in both copies. first discovered in neurospora crassa  <cit> , rip was later demonstrated in the ascomycetes magnaporthe oryzae  <cit> , podospora anserina  <cit> , leptosphaeria maculans  <cit>  and fusarium graminearum  <cit> . putative rip events have also been detected bioinformatically in aspergillus fumigatus  <cit> , fusarium oxysporum  <cit> , aspergillus nidulans  <cit> , neurospora tetrasperma  <cit> , microbotryum violaceum  <cit> , aspergillus oryzae  <cit> , magnaporthe oryzae  <cit> , colletotrichum cereal  <cit> , aspergillus niger  <cit> , penicillium chysogenum  <cit>  and most recently in stagonospora nodorum  <cit> . given this broad distribution, it is reasonable to assume that rip is widespread across, but so far restricted to, filamentous ascomycota and basidiomycota.

the mechanism by which rip operates is yet to be fully understood, but the following observations have been made. rip involves transition mutations from c:g to t:a nucleotide base pairs in duplicated dna; this affects both copies of the repeat and occurs prior to meiosis  <cit> . in the majority of cases studied so far, there is a strong bias for the mutation of c:g nucleotide base pairs followed by a:t nucleotide base pairs  <cit> . thus cpa di-nucleotides are more frequently affected than any of the other  <dig> di-nucleotides. cpa nucleotides are converted to tpa. coincidentally, the complementary tpg di-nucleotide on the opposite strand is also converted to tpa . in n. crassa, rip requires ≥ 80% identity of duplicated dna over a length of ≥  <dig> bp  <cit> .

the derip process counts the occurrence of the contributing di-nucleotides incrementally across a multiple alignment of repeats and alters the consensus sequence at each position to the appropriate pre-rip di-nucleotide sequence.

the consequences of rip are that repeated dna segments, such as would result from the transposition of a retrotransposon, or the duplication of a gene, are mutated and inactivated. rip would be expected to operate in successive sexual cycles until the sequence identity between duplicated sequences is reduced below the minimum homology threshold required by the rip machinery. the genome would then contain a repeat family consisting of relics of the duplication event degraded to varying degrees.

the rapid increase in the number of fungal genome assemblies has created a demand for methods to detect and quantify rip. two approaches have been used; rip indices and alignment methods. rip increases the frequency of particular di-nucleotides  in affected regions of dna. thus rip can be identified by comparing ratios of di-nucleotide frequencies in pre-rip to post-rip sequences; these ratios are referred to as "rip indices"  <cit> . however, in reality rip depends upon the alignment of two similar regions of double-stranded dna  <cit>  and therefore it is more appropriate to use alignments of repeat families to identify and quantify rip. we have previously introduced a rapid, automated alignment-based procedure for the whole-genome analysis of rip mutation called ripcal  <cit> . using this procedure, we readily identified and quantified the degree of rip in all repeated dna families within the genome of the necrotrophic fungal wheat pathogen s. nodorum.

stagonospora  nodorum  is a major pathogen of wheat and is a model for the fungal class dothideomycetes, a taxon that includes many important pathogens of crops  <cit> . s. nodorum infects wheat crops in most wheat-growing areas of the world  <cit> . infection is predominantly determined by the presence of various effectors  harboured by different strains of the fungus  <cit> . the fungus is heterothallic  and the mating types are evenly distributed  <cit> . the fungus over-summers as ascospores on stubble  <cit>  and multiplies via asexual reproduction during the growing season. the pathogen displays high levels of variability as determined by genomic analyses  <cit>  and this has been exploited to determine the biogeographic history of the pathogen  <cit> . the pattern of micro-satellite markers is consistent with a pattern whereby the pathogen originated in the "golden triangle" region and spread as wheat cultivation was adopted in eurasia and north africa several thousand years ago and into north and south america, south africa and australia since european colonisation.

an initial survey of the nuclear genome sequence of a west australian isolate   <cit>  identified  <dig> repeat families which comprised  <dig> % of assembly. the role and origin of several repeat families could not be inferred by homology. we ascribed this to rip mutation, after which all copies were unrecognisable. ripcal analysis showed that the repetitive dna of sn <dig> was subject to rip-like changes  <cit> . the rdna repeat  exhibits selective susceptibility to rip mutation . rip does not affect copies located within the tandem rdna array   <cit> . one exception was found in a repeat at the array terminus, which showed evidence of rip at similar levels to those of non-rdna array repeats. rdna repeats were also found scattered throughout the genome. within the non-rdna array repeats, short repeats  did not show evidence of rip whilst the long repeats  were rip-affected  <cit> . due to the presence of both rip-affected and non-rip-affected copies, the rdna repeat was perfectly suited to be used as a test case for the validity of bioinformatic predictions of rip.

the presence and activity of transposons in s. nodorum had previously been studied using a transposon trap procedure  <cit> . several strains of s. nodorum from the united kingdom  were plated on chlorate  <cit>  to select for mutations in the nitrate reductase  structural gene. using the cloned nia <dig> gene as a probe  <cit>  several insertional mutants were identified. three insertions were cloned and sequenced  <cit> . these insertion sequences, named molly, pixie and elsa, represented intact copies of active transposons . southern blots probed with these transposons revealed large variations in copy number, band size and band intensity between strains. when the sequences of the intact copies of these transposons were compared to the genome sequence of the sn <dig> strain  <cit> , related repetitive regions were identified. however, no active  copies of these transposons were found in the sn <dig> assembly. the lack of active transposons within sn <dig> was intriguing and raises the question of the relationship of the repeat families to the active transposons in the uk isolates. this relationship is addressed here.

rip-mutated terminal rdna array repeat
blastn hits and pairwise global percent identities to non-rip-affected sequences were compared between the majority consensus and derip consensus versions.  the transposons elsa, molly and pixie of s. nodorum sn <dig> were compared to active copies of an alternate strain. in all  <dig> cases the derip sequences match best to the active transposons. this is indicated by the 'derip improvement' factor and the differences in percent identities for global alignments. derip improvement is a measure of how much better the derip consensus matched the hit compared to the majority consensus. derip improvement >  <dig> indicates that the repeat family was derived from the hit or a related homolog, but was subsequently mutated by rip.  rip-protected copies of the s. nodorum rdna repeat are located within a tandem array . rip-susceptible copies were grouped by size into long  and short  categories and compared to the rip-protected copies. homology between rip-protected repeats in rdna array and long rip-susceptible non-rdna array repeats were improved by derip. the rdna array also contains one rip-affected repeat at its terminus which shows similar levels of homology to the rdna array as the majority consensus of the long non-rdna array repeats.

building upon the ripcal procedure, we describe here a new technique to reverse the effects of rip mutation in silico: "derip". the derip process involves scanning a multiple alignment of a repeat family for rip-like polymorphism and reverting the alignment consensus to the putative pre-rip-mutated sequence. the resultant "deripped" sequence is a prediction of what a rip-mutated repeat dna may have looked like prior to rip mutation. we have applied the derip process to the repetitive dna of s. nodorum sn <dig> which has increased the number of recognisable repeat families from 65%  to 92% .

RESULTS
validating the derip process using known non-rip-affected repeats
the repetitive dna content of the s. nodorum sn <dig> nuclear genome was previously estimated to contain  <dig> families comprising  <dig> % of the assembly  <cit> . a repeat family was defined if there were  <dig> or more copies, of greater than  <dig> bp and sharing greater than 65% sequence identity. each family had been analysed by ripcal and the extent of rip measured using the cpa↔tpa dominance statistic  <cit> . rip dominance varied from  <dig>  to  <dig>  . blast comparisons predicted the origin of  <dig> out of the  <dig> repeat families.

functional and authentic transposon homologues of the repeat families molly, pixie and elsa had been previously characterized. elsa was identified as a ltr retrotransposon; molly and pixie as tc- <dig> mariner elements  <cit> . characterized sequences were derived from uk isolates of s. nodorum  <cit> . the maximum sequence identity between the proteins encoded by the active copies and matches within the sn <dig> genome assembly was approximately 66% by blastx .

to determine whether the sn <dig> repeats were derived from the active copies via rip mutation, the derip procedure was applied to the alignment of the molly, elsa and pixie-like sequences. the example shown in figure  <dig> illustrates the derip process applied to the transposon repeat molly.

molly-like repeat sequences of sn <dig> were aligned and analysed for rip mutation via ripcal  <cit>  . the alignment includes  <dig> full length copies and  <dig> incomplete copies. mismatches between individual repeats and the majority consensus are colour-coded; vertical red bars represent the cpa/tpg to tpa di-nucleotide substitution previously shown to be the predominant rip-induced change in s. nodorum  <cit> . the predominance of red changes indicates that the repeat family has been affected by rip.

the molly alignment was processed using the new derip algorithm. the process is illustrated in figure 2b in a  <dig> bp subsection of the alignment from position  <dig> to  <dig>  at position 1900- <dig> of the alignment there is a tpa di-nucleotide in  <dig> out of  <dig> copies and tpg in one copy. this set of di-nucleotides corresponds to the tpg→ tpa mutation, which is characteristic of rip . it was assumed that the tpa copies were derived from an ancestral tpg via rip. therefore while the majority consensus  was tpa at this position, the derip process changed this to the most probable pre-rip sequence - tpg. this process was extended across the length of the repeat alignment, producing a new sequence called the 'derip consensus'. this derip consensus sequence was compared to the majority consensus as well as the sequence of the active copy of molly  . in this example, derip changes were labelled as "correct" where alterations in the derip consensus agreed with the sequence of the active copy. nine such cases occurred in the highlighted section. derip changes were labelled as "errors" where the derip changes and the active copy sequence did not agree. there was one derip error in the sub-alignment at alignment position 1940- <dig>  non-derip related base differences, common between the majority and derip consensus sequences but different in the active copy sequence, occurred five times in the sub-alignment.

all the molly-like repeats, the active copy, the alignment 'majority' consensus sequence and the new derip consensus sequence were compared via raxml   <cit>  . the derip-predicted sequence was a closer match to the authentic, active copy than the majority consensus. the relative levels of sequence similarity between the active transposon and the majority and derip consensus sequences were also tested via needleman-wunsch global alignment  <cit> . the sequence identity between the active copy and majority consensus was  <dig> % whereas the identity between the active copy and the derip consensus was  <dig> % .

the derip process was applied to the other transposon repeat families with pre-existing characterized active copy sequences, pixie and elsa. table 2a summarises the results for all three previously identified active s. nodorum transposons. in the case of molly, the majority consensus by blastn had an e-value to the active copy of 7e- <dig>  whereas the derip consensus by blastn had ane-value of 3e- <dig> . these results can be summarised as a "derip improvement" of 329/ <dig> =  <dig> . derip improvement factors were  <dig>  and  <dig>  and global percent identities to the active transposons were improved  <dig> % and  <dig> % for elsa and pixie respectively . the overall improvement in maximum bit scores to active transposons indicates that the derip versions were significantly better matches to the functional transposons that were the presumed ancestors of the sequences in the australian sn <dig> strain.

the rdna repeat family y <dig> had been previously demonstrated to show differential susceptibility to rip between its various copies   <cit> . rdna repeats within a tandem rdna array were not rip-affected except for one repeat at the array terminus. non-rdna array repeats greater than  <dig> kb  showed evidence of rip, however non-rdna array repeats less than  <dig> kb  did not. after derip was applied to the consensus of long, non-rdna array repeats, the percent identity to the non-rip-affected rdna-array consensus was improved by  <dig> % - from  <dig> % to 94% and the derip improvement factor was  <dig>  . conversely, the percent identity between the non-rdna array short repeat consensus and the rdna array consensus was not improved by derip . the rip-affected terminal rdna repeat and the majority consensus of the rip-affected long non-rdna array repeats both had similar levels of homology to the rdna array .

determining the role and origin of rip-degraded repeats in s. nodorum
the derip process was extended to all repeat families of s. nodorum sn <dig> . table  <dig> summarises the copy number and size of repeat families as estimated previously  <cit> . the extent to which repeat families were affected by rip is indicated by the rip dominance scores. rip dominance  <cit>  was calculated using a variety of comparative models including: sequence of highest g:c content; alignment majority consensus and; consensus sequence predicted by derip . a rip dominance of greater than  <dig>  by comparison to the repeat with highest g:c content was considered a reliable threshold for rip  <cit> .

rip dominance, a measure of the strength of rip mutation, is reported for all  <dig> different ripcal comparison methods: versus the highest g:c content sequence; versus the alignment 'majority' consensus and; versus the derip consensus. measures of how much the predicted derip consensus of a repeat family resembles its original version, hit discovery scores and derip improvement factors, are also summarised for comparisons against ncbi nr proteins via blastx and the giri repbase database of repetitive elements via tblastx.

derip consensus-generated rip dominances correlated with the highest g:c content rip dominance scores better  than those of the majority consensus . this supports the reliability of the derip consensus as an accurate prediction of the pre-rip-mutated progenitor sequence.

in the great majority of cases the number of hits of the derip consensus matched or exceeded the number achieved by the majority consensus sequences . in two cases,  the derip sequence found a hit where none had been found before . in other cases, very substantial increases in hit number were observed . in a few cases the number of hits was reduced .

eat <dig>  hypothetical protein snog_01370
eat <dig>  hypothetical protein snog_01374
eat <dig>  hypothetical protein snog_01373
after derip analysis the predicted origin of  <dig> repeat families has been altered from that described in hane & oliver   <cit> . details of the blast hits which were most informative in re-classifying a repeat family are listed below. e-values are shown for matches to both the majority and derip consensus sequences. derip improvement is a measure of how much better the derip consensus matched the hit compared to the majority consensus. derip improvement >  <dig> indicates that the repeat family was derived from the hit or a related homolog, but was subsequently mutated by rip.

the derip improvement factor was greater than one in all cases for nr and in all but two case for repbase indicating a general increase in the confidence and significance of a hit and hence a functional assignment. the factor ranged up to  <dig>  for nr and up to  <dig>  for repbase hits . in two cases  the factor with repbase was less than  <dig>  this can occur if the hit present in the reference database had been submitted in its non-functional, rip-affected form.

blast information was used to determine the origin of several rip-degraded repeat families of s. nodorum sn <dig>  previously the probable origin of  <dig> out of  <dig> repeat families had been identified. however after derip had been applied to each repeat family,  <dig> out of  <dig> have now been categorised. in six cases  no previous homology information had been available. repeat families r <dig>  r <dig>  r <dig>  x <dig> and x <dig> were re-classified as transposons after derip analysis . the repeat family r <dig>  also previously unknown, was identified as corresponding to s. nodorum genes snog_ <dig>  snog_ <dig> and snog_ <dig> .

the previous classification of x <dig> as a gypsy class transposon remnant was confirmed after derip. the derip improvement factors for gypsy sequences were  <dig>  and  <dig>  for nr proteins and repbase sequences respectively . x <dig>  previously predicted to be a transposon remnant, was found after derip to contain regions corresponding to a telomere-associated recq helicase . r <dig> was previously classified as a putative transposon remnant. after derip, some weak homology to dna transposons was detected versus repbase but a region of homology to histone h <dig> proteins was also detected . repeat family r <dig> was thus re-classified as originating from a  endogenous gene-encoding region.

r <dig> and x <dig> were previously predicted to contain the remnants of an ubiquitin conjugating enzyme and helicase genes respectively  <cit> . derip analysis was used to predict the ancestral sequence and identified matches to nine copies of a cluster of endogenous s. nodorum genes . analysis of repeats x <dig> and r <dig> indicated that several copies of these repeat families were physically adjacent . studying the location of x <dig> and r <dig> repeats revealed that these repeats were frequently arranged in a distinctive pattern roughly corresponding to two tandem x <dig> repeats followed by a reversed r <dig> repeat . these two repeat classes were combined and renamed x3x3r <dig> 

in addition to the cluster of endogenous genes, the x3x3r <dig> derip consensus also hit known ubiquitin conjugating enzymes with greater homology than the majority consensus . homology relationships to dna excision/repair helicase regions were inferred from hits to the endogenous s. nodorum genes residing within x3x3r <dig> .

since the derip consensus is a prediction of the sequence prior to rip-mutation it can be presumed that the x3x3r <dig> repeats with functional genes are closely related to the derip consensus. the majority of repeats with predicted gene annotations were found to be highly similar to the derip consensus . current evidence supports the functionality of some or all of the genes contained in six out of these nine x3x3r <dig> repeats.

discussion
the derip algorithm was designed to reverse the affect of rip upon repeat families in-silico and thereby help determine the evolutionary history of repeated elements. the process automates the selective alteration of bases within a consensus according to a set of rules that can be determined by considering the rip machinery operating in the organism concerned. despite its validation with known non-rip-affected sequences, derip has some limitations and will not necessarily perfectly predict the ancestral sequence. derip can only choose within options provided by the aligned set of repeats. in the example given in figure  <dig> the tpa sequence at position 1900- <dig> was converted to tpg. to do this, at least one of the copies of the repeat must have the presumably ancestral di-nucleotide tpg at this site. if all extant copies had been mutated, the reversion would have no support. the derip process is therefore critically dependent on the degree of rip within a repeat. the success of derip is also dependent upon the accuracy of the alignment. a noteworthy aside is that default alignment parameters often fail to align fungal repeats correctly due to complex internal repeat structures. finally, the diagnostic metrics of derip success, derip improvement and hit discovery, are only possible to calculate if appropriate matching sequences exist in the queried databases. if a repeat sequence is truly novel, its "homology" cannot be improved until homologs are found.

ripcal uses a model sequence to compare to aligned repeats for rip-like polymorphism. selecting the repeat with the highest total count of g and c nucleotides assumes that high g:c content is representative of the least rip-affected repeat. the majority consensus model on the other hand could be representative of the least or most rip-affected repeat depending on the level of rip mutation within the repeat family. previously, we had selected the sequence with the highest g:c content as the ripcal model  <cit> . while in most cases this rationale is sound, the g:c model has several shortcomings. if a sequence with the highest total g:c content does not span the full length of its alignment, rip data from the un-covered regions would be lost. alternatively, a repeat longer than the least rip-affected repeat  may have higher total g:c content merely due to its greater length. the g:c model is also sensitive to variations in g:c content not related to rip. furthermore, rip occurs between multiple combinations of repeats over time. the g:c model sequence therefore comprises of an amalgam of pre-rip and post-rip di-nucleotides relative to the alignment as a whole.

rip mutations have directionality , so the combination of pre- and post-rip sites makes it necessary to consider rip mutation both towards and away from the g:c model sequence. in contrast, a derip consensus model, being a prediction of the pre-rip-mutated sequence, has the advantage of polarity. as such, derip mutation calculations can be restricted to one direction: proceeding from the derip consensus to the rip-affected repeat.

the prior isolation of active copies of three transposons, molly pixie and elsa, as well as the differential effect of rip on the rdna repeats, allowed a thorough test of the power of derip to reconstruct the ancestral sequence. in all four examples the predicted derip consensus of the rip-affected sequences was the best match to the active copy indicating that derip was able to accurately revert the rip-degraded repeats close to their original states. these analyses helped define the concepts of hit discovery number and derip improvements as applied more broadly in table  <dig> 

the derip process serves to highlight the effectiveness of rip as a transposon-silencing mechanism. in most observed cases, the resemblance between rip-degraded repeats and their non-rip-affected, functional counterparts is minimal . in the case of the molly, elsa and pixie transposons, functional sequences of transposon proteins were available for comparison. no viable open-reading frames could be found in any of their respective genomic matches in s. nodorum sn <dig> . some repeat families could not even be classified by homology prior to derip . the derip process is therefore an essential tool which facilitates the identification and understanding of the role and origin of fungal repetitive dna. the effectiveness of derip was such that functional assignments were improved quantitatively or qualitatively in nearly all cases. this was most clearly the case when repeat families were most clearly affected by rip .

conversely when the repeat family was not rip-affected, the derip process was not able to improve the homology assignment. an example is the transposon repeat family r <dig> which had low rip dominance  of  <dig> , indicating that r <dig> is not greatly affected by rip mutation.

the r <dig> repeat contained regions corresponding to three s. nodorum genes   which are located in separate regions of the genome assembly. the sub-telomeric repeat x <dig>  which contained telomere-associated recq helicase sequence and was subject to relatively high levels of rip mutation . recq helicase plays a critical role in genome maintenance and is essential for dna replication in eukaryotes  <cit> . twenty six putative functional copies  of recq are present within the s. nodorum genome . it is currently unclear by what mechanism function is preserved in certain copies of this highly repeated gene family, but not in others.

the repeat family x3x3r <dig>  which replaced the previously defined repeat families x <dig> and r <dig>  matched to a cluster of endogenous s. nodorum sn <dig> genes  - some of these coding for a dna repair helicase and ubiquitin conjugating enzyme . the helicase and ubiquitin conjugating enzyme genes within x3x3r <dig> were homologous to saccharomyces cerevisiae proteins rad <dig>  and rad <dig>  respectively . these proteins are involved in the post-replication repair of uv-damaged dna, the epigenetic silencing of telomeres and sporulation in yeast  <cit> .

the absence of active copies of the elsa, molly and pixie families in the australian sn <dig> isolate contrasts with the situation in the uk. rawson screened several isolates for active transposons and used a trapping process to isolate active copies  <cit> . using these transposons as probes showed great variation in copy number and band intensity amongst a collection of uk isolates. we have only looked at one australian isolate, but it appears to be devoid of active transposons . consideration of the properties of rip, the need for sexual reproduction by the fungus in mediterranean climates and the biogeography of s. nodorum, could explain the absence of transposons in the australian isolate. repeated elements over a threshold size and above a threshold identity would be subject to rip. this would inactivate all copies of a transposon during a meiotic event that appears to be necessary for survival over the hot summer  <cit> . it would not be conceivable for an active copy to be reconstituted in an asexual population derived from such an event. the survival of a transposon in a population of a sexually reproducing fungus would require mating with an isolate with an active  copy of the transposon. the invasion of s. nodorum into australia most likely occurred via the propagation of a small founder population consistent with the reduced polymorphism of populations found here  <cit> . we speculate that no active transposons have survived within any australian isolate capable of rip. screening of a larger population of australian and eurasian isolates to determine differences in frequency and distribution of active copies between the founder and derived populations would be required to confirm this.

CONCLUSIONS
in summary, we present a facile and rapid method to assist the annotation of repetitive elements of ascomycete genomes. the derip process can predict ancestral functional sequence from degraded repeat elements. analysis of the repeat families of the fungal phytopathogen stagonospora nodorum  using derip-converted sequences increased the number of recognisable repeat families from 65%  to 92% . this has enabled the characterization of many repeat families and has advanced our progress towards the goal of understanding and accounting for the evolutionary history of all regions of a genome.

