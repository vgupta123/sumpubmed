BACKGROUND
high-throughput sequencing technologies such as illumina's solexa,  <dig> life sciences' gs-flx and abi's solid platforms allow researchers to generate gigabases of sequence data in a matter of hours  <cit> . as such they are finding use in the analysis of many biological datasets, including the deep sequencing and cataloguing of non-coding small regulatory rnas . these srnas have been described as the 'dark matter of genetics'  <cit>  because they are highly abundant yet difficult to detect. they have roles in regulating gene expression via post-transcriptional and translational mechanisms in animals, fungi and plants. single-stranded silencing rnas of 21- <dig> nt in length, are created from a double stranded rna by the protein dicer. the rnas are the guide for ago nucleases that cleave the targeted rna in a sequence specific manner. cleaved rnas are degraded further or become template for rna-dependent polymerase to generate a dsrna  <cit> . the known number of classes of srnas is great and with the advent of high-throughput sequencing is getting greater. with these recent advances in sequencing technology we are in a position to find new classes of srna that have not previously been discovered. the first step in this is in the identification of parts of the genome that generate srnas. we call these regions "locales", choosing this word for the obvious similarity to the term locus from the genetic literature, which defines a distinct point or region on a genome. it is the detection of locales with which this paper is concerned. after generating the sequence the reads must be aligned to the genome. alignment is a well studied problem and is handled by a range of programs such as ssaha  <cit> , maq  <cit>  and soap  <cit>  . grouping the reads into locales that represent the place of origin of potential functional srnas is the next step.

there has been little discussion of what constitutes a srna-generating locale, with researchers sometimes relying on restrictive and arbitrary definitions  <cit> . many existing tools rely on the detection of specific classes of srna. for example, mircat  <cit>  and mirdeep  <cit>  are micro-rna  detectors. chen et al. have created a tool for predicting trans-acting sirna   <cit> . other studies have used time-series data-mining algorithms to identify genomic locales from which srnas originate with disregard to srna class  <cit> , but to date have relied on identifying only those that were statistically more 'unusual' than others according to their own measures. such a method is not necessarily useful as it would lack the sensitivity to find the majority of locales. to avoid these problems, researchers have previously used simple but functional tools for generative region detection  <cit> . thus there is a need for generally applicable, sensitive methods for determining locales from sequencing data. since the full range of different classes of srna is not yet known search strategies for potential functional locales must be general.

in this paper we propose and test a locale detection algorithm that we call nibls  which takes a graph-theoretic approach to identifying locales. a graph is a mathematical abstraction that is particularly suited to the description of relationships between entities . here a graph consists of vertices and edges that are links between the vertices. in our graphs the vertices are the srnas and the edges link srnas on the basis of proximity . we use proximity within an absolute cut-off to create edges between the srna vertices. once the edge is created the information about the distance is discarded. many graphs are composed of isolated vertex-islands, termed components, that have edges between vertices within themselves, but not with other vertex-islands. the clustering coefficient  <cit>  of a component is a measure of the degree of inter-connectivity within it . each vertex has a certain number of neighbours, and the clustering coefficient is a function of the number of edges between the neighbours and the maximum possible number of edges between them and high levels of interconnectivity equate to large clustering coefficients . our algorithm uses clustering coefficients in the graph of srnas to detect locales as individual highly clustered components, not as it may seem at first glance the density of srnas on the reference.

RESULTS
algorithm
definition and detection of locales
a locale is defined as a component of a graph g =  with vertices v and edges e that has clustering coefficient γ above a user-defined cutoff c. to create the graph we align srnas to the target genome such that s is a srna on chromosome c with start i and end j.

the vertices of g are the set of srnas,   

an edge e exists between two srnas if the overlap  is less than the minimum inclusion distance m, that is   

is an edge if   

for each connected set of srnas  the clustering coefficient γ as defined by watts and strogatz  <cit>  is the average of the ratio of the number of edges that exist between the neighbours of each vertex in the component and the number that could possibly exist. the final set of locales l comprises all components with more than one srna and γ > c. that is,   

the extent of each locale is from the lowest start  to the highest end  for each srna in the component l.

testing
sensitivity and specificity of the algorithm
to test whether our algorithm is capable of detecting biologically meaningful locales from srna data, we examined its sensitivity and specificity on publicly available high-throughput srna pyrosequencing of srnas extracted from the flowers, rosettes or entire seedlings of the higher plant arabidopsis thaliana  <cit>  and mouse embryonic stem  cells  <cit> . typically, sensitivity of an algorithm is assessed by comparison of some output against a pre-known result. however, there is no organism or tissue in which the full set of expressed srna and generative locales is known; thus it is difficult to establish a comprehensive set of true positive locales for comparison.

to address this issue the set of rfam sequences  <cit>  known for each species  was considered to be the positive control set of srnas against which the putative locales generated by our algorithm would be tested. by its nature this is a somewhat problematic control standard; the rfam database does not comprehensively include all srnas and not all rfam rnas are expressed in all tissues. this means our algorithm could detect true positive locales that do not match rfam sequences, thereby appearing to be a false positive. conversely an ncrna may not be expressed in the tissue of interest leading to a true negative that appears to be a false negative. we therefore excluded each rfam sequence that had fewer than  <dig> genomic matches aligned to it. as such, all 'real' locales under consideration stood a chance of being detected from the data. after filtering, the number of rfams remaining as potential positive control locales in each species was considerably reduced from the total possible . however, there was a large number of nucleotides to which srnas could be aligned allowing for a reasonable assessment of the number of nucleotides grouped into putative locales.

table describes the total number of rfams for each species, the number of rfams with more than  <dig> srnas that align to them in each tissue and the total number of nt that these comprise.

we tested our algorithm at a range of values of the two parameters: m the minimum inclusion distance in nucleotides at which an edge is created between them and c the minimum clustering coefficient at which a component in the graph is deemed a locale. the sensitivity and specificity of the algorithm were calculated as described in methods. exploratory runs with arabidopsis and mouse data showed that results changed little for values of m over  <dig>  so scan values were kept below this threshold . the sensitivity of the algorithm in detecting rfam locales expressed in different sets of srna sequenced from different tissues of arabidopsis can be seen in figure  <dig>  generally sensitivities, which could possibly fall in the range  <dig> to  <dig>  are good, with the maximum sensitivities in each parameter scan ranging from  <dig>  to  <dig> , indicating that the algorithm has good detection capability. in all the arabidopsis and mouse tissues tested here the algorithm had greatest sensitivity at low m. for m <  <dig> the highest sensitivities were  <dig>  in the rosette,  <dig>  for the seedling tissue,  <dig>  in the flower and  <dig>  in mouse es . sensitivity is much lower at m >  <dig> with sensitivities dropping off sharply in flowers and rosette tissues, although somewhat less so in the seedling tissue and mouse es cells. together these results suggest that the m parameter, the minimum inclusion distance, is the most important factor in the algorithm's ability to discern locales. however, the parameter c has an important modulating role and can become substantially limiting on sensitivity as it increases, especially at m >  <dig>  in the m <  <dig> region of greatest sensitivity the exact point at which c becomes limiting is different in each tissue but generally when c >  <dig>  sensitivity is less than  <dig>  a sharp cutoff is seen in the rosette and flower tissue  and a more gradual one in the seedling and mouse . interestingly the sensitivity increases slightly for m >  <dig> in seedlings and to a lesser extent in rosette . this may be due to the occasional appearance in the sequence set of low-abundance srnas that align to regions of genome that when transcribed are found on the complementary strand of a hairpin structure.

the caenorhabditis elegans srna complement includes a huge number of well known and well annotated srnas, such as the 21u-rnas, a class of rnas whose sequence begins with uracil and have length of  <dig> nt  <cit> . it could be argued that this provides an excellent test case as many of the real locales are known. however, the know loci in this case are very easy to detect, having specific mapping points on the reference genome. we added 21u-rna to our sample and carried out the analysis as described above in c.elegans. the sensitivity of the algorithm in this case was very high  and never drops to be as low as that in the other tests. at 75% of parameter values we used over 40% of loci are recovered. in this case we believe that the large number of 21u-rnas   <cit>  is skewing the result and giving a perhaps non-representative view of the efficacy of the algorithm for general use.

the specificity of the algorithm was high: greater than  <dig> in all tissues at all parameters . in part this is because it is not possible for the algorithm to detect locales where there are no srnas aligned and so it cannot spontaneously generate false positives. furthermore, for a locale to exist the definition requires that a component l of the graph should have at least two vertices. this removes all srnas separated by more than m from others, since, in redundant sequence sets, the real locales would be expected to be represented by more than one sequence. such a factor has the effect of greatly reducing the 'junk' that could be considered for inclusion in locales. together these results show clearly that the algorithm can sensitively and specifically identify srna locales in srna sequence data from evolutionarily distantly related species. in the arabidopsis and mouse sequence data tested here it seems that parameter settings for optimal sensitivity fall in the range  <dig> <m <  <dig> and  <dig> <c <  <dig> .

it is important to note the necessary differences in interpretation of the value of the clustering coefficient in the context of co-overlapping srnas and the interpretation used in the network literature, in particular the primary article of watts and strogatz  <cit> . graphs created by randomly assigning edges between nodes typically have a lower clustering coefficient than real-world networks, biological networks such as the caenorhabditis elegans neuronal network have clustering coefficients on the order of  <dig> , random networks of around  <dig>   <cit> . the high clustering coefficient implies that the nodes in the real-world networks share many neighbours with their neighbours and suggests the structure of the network is modular. in our algorithm we use the clustering coefficient simply as a measure of the co-overlapping of the srnas and if we find a sufficiently high co-overlapping pattern we have a candidate locale. the effective values are in the range  <dig> <c <  <dig>  which shows that the reads from sequencing experiments and different types of srna co-overlap in a wide variety of patterns, thus the clustering co-efficient reflects the structure of the potential locale. locales in which the srna reads overlap in a serial manner on the reference one after the other in a 'fallen domino' sort of pattern will have lower clustering coefficients, whereas locales in which srna reads are piled high on the reference, each overlapping many other srna reads more akin to the bricks in a wall will have higher clustering coefficients. the exact value of the clustering coefficient cut-off could conceivably be manipulated to narrow ranges to find locales with specific srna alignment patterns, although in this paper the aim is to retain as wide a selection as possible.

reproducibility of results at different parameter settings
in order to assess the extent to which the algorithm could generate similar results from different parameter settings for each tissue we examined the overlap on the reference genome of the sets of locales generated by the algorithm for all values of m and c used in the parameter scans. locale sets were examined in a pairwise fashion and the proportion of locales with an overlap in genomic position with a locale in the corresponding set calculated. in a situation where the total number of locales in set a is different to the total number of locales in set b the percentage of locales present in both will vary depending on which set you consider to be the reference set. consider set a contains  <dig> locales and set b contains  <dig> locales. if set b is used as a reference set and all  <dig> of set a are present in set b we will have found 50% of our reference locales. conversely if we use set a as the reference set we will find 100% of our reference locales. rather than causing a discrepancy in the analysis, this difference can tell us about the relative numbers of locales generated by different settings, so in our pairwise comparisons we used each locales set as the reference set in turn. differences in proportion of genomic position overlapping locales caused by different numbers of locales are easily identified as asymetrical regions about the top-left to bottom-right diagonal in figure  <dig>  similar parameter values generate very similar sets of locales; this is seen as the bright yellow area around the top left to bottom right diagonal in figure 3a. the algorithm shows the same reproducibility characteristics in the three different arabidopsis srna sets. the pattern is repeated in each of the large outlined boxes along the diagonal in figure 3a indicating that the characteristics of reproducibility are the same in each tissue. within each tissue, close parameter values generate very similar sets of locales. this is seen as the bright yellow colour around the top left to bottom right diagonal in each box. for m <  <dig>  reproducibilty is high then drops when  <dig> <m <  <dig> and increases again when m >  <dig>  possibly reflecting the inclusion of multiple smaller locales into larger ones by virtue of the increasing m, the minimum inclusion distance. as m increases some locales with relatively small distances can be merged into one another. for m >  <dig>  the reproducibility is high but there are differences in the number of locales in each set, visible as differences in colour above and below the diagonal in the bottom-right area of each square in figure 3a. this may be a consequence of an increased inclusion distance merging locales that are separate in one set. the number of locales in each set is similar where m <  <dig>  reproducibility remains high in this range, visible as similar colour above and below the diagonal in the top-left of each box.

to give an impression of the number of exactly identical locales that were generated at different parameter values we selected three pairs of values for m and c  that were in the sensitive and reproducible range of parameter values for both arabidopsis and mouse and calculated the number of locales with the same exact start and stop positions. the venn diagrams in figure  <dig> show that the proportion of shared identical locales varies from  <dig> % to  <dig> %. although each set had a large number of unique locales these must overlap at least one other locale on the genome in the corresponding set since there is high reproducibility over the same range. the number of shared identical locales was much higher between sets from close parameter values than the divergent ones. overall, the high reproducibility for similar parameter values across the range and the general decrease in number of locales shared as the parameter values diverge indicates that the algorithm is robust to moderate differences in parameter value.

genomic features with srna locales
we counted the number of locales that overlapped different classes of genomic feature in arabidopsis. for this analysis we used a set of locales generated with m =  <dig>  c =  <dig> . the genomic feature types most mapped over are the transposon related elements, transposons, transposable element genes and transposable fragments . although not many srna features are annotated in arabidopsis locales mapping to mirna, snorna, ncrna and snrna were found in all tissues. for example in flower, rosette and seedling tissue  <dig>   <dig> and  <dig> locales mapped to the  <dig> annotated mirnas. mrnas and exon features were also relatively well mapped over by locales, though the proportion of the total number of these elements mapped over was lower than the proportion of the transposon-related elements.

implementation
standalone perl version
our algorithm has been implemented in perl  <cit>  to provide an easy to run multi-platform package that can be incorporated easily into analysis pipelines. this implementation is limited only by local system resources. to gain optimal performance from graph analyses which can be computationally expensive, we have used the boost graph library  <cit> , implemented in c++ and available free to academic users under the boost graph license and the perl interface boost-graph module  <cit> , available under the gnu public license  <cit> . both of these pieces of software are pre-requisites for running the implementation. our implementation is released under gpl <dig>  <cit> . the perl implementation requires as input a gff format file  <cit>  describing the alignment of srnas to the reference genome. as guide to performance, with the  <dig>  mapped srnas in the arabidopsis flower data  <cit> , our perl implementation ran in  <dig> minutes on an amd <dig> ibm intellistation desktop with  <dig> gb of ram.the perl implementation can be obtained from github  <cit> .

CONCLUSIONS
we have created an algorithm that uses a graph theoretical approach to identify srna generative locales from high-throughput sequencing data. despite the huge evolutionary distance between arabidopsis and mouse the algorithm was capable of correctly identifying locales with very high sensitivity and with similar patterns of sensitivity for both of the species, suggesting that it has applicability across the plant and animal kingdoms. the sets of locales generated by the algorithm's user-definable parameters m and c are robust to small changes over the possible range whereas larger differences have greater effects indicating that the algorithm is both robust and responsive. with our stand-alone perl implementation it is possible for a user carry out a parameter scan at the start of an analysis to identify the parameter values of greatest sensitivity and specificity for their sequence set if necessary.

one difficulty all srna locus finding algorithms must deal with is the fact that not all srnas from high-throughput sequencing experiments will be 'functional' and depending on the sequencing protocol used many of the srnas could be a result of degradation processes which a researcher may not have interest in. the literature does not yet contain a consensus on what such a degradation locus may look like, making it difficult for algorithms to distinguish such locales from those of functional interest in any generally useful way at present. nonetheless in such situations our algorithm can be of use in filtering out potential non-functional locales in cases where the researcher has prior expectation of the pattern formed by degradation products. for example in the case where degradation products have a distinctive visual pattern, representative locales matching the pattern can be identified visually in a genome browser and comparing an initial run of the algorithm with positions of the pattern. the clustering coefficients of the locales can then be used as a band-filter whereby any locales lower or higher than this can be presumed not to be from the same sort of degradation process.

as our algorithm uses only positional data of aligned srnas and the clustering coefficient cut-off to identify locales it is naturally srna class agnostic which mean it can be used to identify locales of many different kinds at once as well as, potentially, previously unknown classes of locales. typically the number of locales called is many times greater than the number of locales known as rfams for a given species, for example in the m =  <dig>  c =  <dig>  set discussed in figure  <dig>  <dig>  locales are predicted. this indicates that there are a huge number of srna generative locales and srnas not yet known, fully justifying the description of them as the dark matter of genetics. undoubtedly there is much scope for many different methods for detection of srna locales. furthermore, the identification and cataloguing of srna generative locales could help the development of methods that can predict generative locales de novo from genomic sequence.

