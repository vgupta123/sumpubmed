BACKGROUND
during the last decade, a considerable number of high-throughput technologies for transcriptome profiling have been developed. these include hybridization-based technologies, such as dna microarrays  <cit> , and sequencing-based approaches like sage   <cit>  and mpss   <cit> . the power of dna microarrays lies in the simultaneous hybridization of mrna extract from biological samples to a pre-selected mrna library, which can contain up to tens of thousands of various mrna transcripts. the expression levels of each transcript are obtained by reading out intensities of hybridization signals. sequencing-based methods are based on a substantially different strategy as compared to microarray technologies. sage and mpss do not require any pre-compilation of an mrna library of sequences, but instead, they use type iis restriction endonucleases, i.e. tagging enzymes, to collect short tags  from each mrna molecule, provided a relevant recognition site exists for an anchoring enzyme. then, either by sequencing long concatamers of tags using conventional sequencer , or by performing iterative parallel sequencing using a proprietary technique , the identity of a sufficiently large amount of tags can be determined in an efficient manner. the abundance of each mrna transcript is assumed to be proportional to the count of occurrence of its representative tag.

favorable features of hybridization-based approaches include a significantly lower workload and relatively low cost. however, the probe collection on a chip, which necessarily relies on the coverage and the accuracy of both genomic sequences and clone libraries, presents a hard constraint on its detection power. in contrast, the "tag-and-count"-based methodologies require more advanced instruments that are more cost- and labor-intensive, but their capability of exhaustive transcript sampling allows the potential identification of novel mrnas.

the present co-existence of various dna microarray platforms and sequencing-based technologies offers biomedical research increased options for transcriptome profiling. it is, however, important to understand how to compare data generated by these different technologies. recent studies indicate that performance of various microarray platforms, as measured by data consistency, have been shown to be comparable  <cit> . several attempts have also been made to compare heterogeneous types of technologies, for instance, between microarray and sage  <cit> , and between microarray and mpss  <cit> . the results of these studies demonstrate moderate concordance between technologies.

in the present study, which is part of an ongoing cross-platform comparison framework  <cit> , we compare gene expression data from mpss with data from five different commercially available one-dye microarray platforms. the present study extends our previous study in three ways: 1) the inclusion of the illumina beadarrayÂ® and mpss data, 2) the inclusion of gene expression data of a second pool of mouse retina  for all microarray platforms, and 3) the investigation of variation across biological replicates, as measured over two different pools of mouse retina samples . it has been a consensus that the use of biological replicates is an important element to ensure the reliability of microarray results  <cit> . to our knowledge, this is the first study investigating the differences between microarray and mpss data on biological replicates. mpss libraries are usually constructed without technical replication and data variation across samples are generally estimated by applying a statistical model simulating the random sampling process during tag selection for sequencing  <cit> . it remains unclear whether significant variation across samples examined by mpss is comparable with those detected by microarrays. as our study included technical replicates for the microarray platforms, this provided a unique opportunity to investigate the sampling model by comparison to microarray data where technical replicates permitted a more robust statistical testing. the data sets of microarray data for the first mouse retina pool  and mouse cortex  were analyzed in our previous study, but some results on these are also included here for the sake of performing comparisons between the two mouse retina pools, as we believe the investigation of biological replicates is an important and novel aspect of this study.

in summary, our results showed that there were moderate, yet significant, correlations between microarray data and mpss data, while the data from microarray platforms, including the recently included illumina arrays, generally were well correlated. the majority of discrepant measurements between the technologies based on hybridization versus sequencing were genes with low-abundance transcripts. tag-to-gene mapping ambiguity and the absence of tagging enzyme recognition site could also explain some of the discrepancy between mpss and microarrays. using two-way anova and sam, we examined the microarray data for the magnitude of data variation introduced by biological replicates and technical replicates, and showed that biological variations are smaller than platform variations. the genes we found most susceptible to variations between biological replicates were likely to be associated with metabolic pathways, biosynthesis, and binding related pathways. due to their vulnerability to sample variation, any changes observed in these pathways and related genes should be interpreted more cautiously in biomarker discovery applications. furthermore, as demonstrated in our study, the relative affordability of array replicates makes them useful to corroborate mpss experiments where technical replicates are seldom feasible due to higher costs. for comprehensive transcriptome profiling, we suggest that complementary use of hybridization-based and sequencing-based technologies is likely to provide a better solution than pursuing a single type of technology alone.

RESULTS
characterization of mpss data
mpss libraries for mrp <dig> and mrp <dig> were generated using 'signature' mpss protocol. two alternative sequencing reactions conducted independently, i.e. two-stepper and four-stepper sequencing, provided two read-outs of tag sequences for each sample, and referred to as mpss 17-bp and mpss 20-bp, respectively.

in the 17-bp signature sequencing, a total number of  <dig>  signatures were detected for mrp <dig>  and  <dig>  signatures for mrp <dig>  the total number of signatures was obtained in the 20-bp signature sequencing was  <dig>  and  <dig> , for mrp <dig> and mrp <dig>  respectively.

the assignments of signature to gene were performed as described in the methods section. only the reliable mpss signatures were kept in the downstream analysis. in the 17-bp signature libraries,  <dig>  and  <dig>  unique unigene identifiers for mrp <dig> and mrp <dig>  respectively, were identified. this corresponds to the sum of transcript copies as  <dig>  and  <dig>  tpm . for the 20-bp tag collections, the numbers of unique unigene identifiers were slightly smaller:  <dig>  and  <dig>  for mrp <dig> and mrp <dig>  respectively, which corresponds to the sum of transcript copies as  <dig>  and  <dig>  tpm.

characterization of microarray data
all platforms showed generally good consistency among technical replicates for all samples, both in terms of cvs and correlation coefficients . these two metrics did not reveal noticeable differences between the two mouse retina mrna pools within each platform.

in order to compare data from microarray platforms, we calculated both pearson and spearman correlation coefficients for absolute expression levels and relative expression changes. to transform expression measurements from diverse platforms onto a common scale, percentile transformation was applied to absolute expressions for each array data set, and then the median of percentile transformed intensities across replicated measurements per gene was used . filtering was applied but was not observed to increase the correlations between intensities, while the correlations between log2ratios were considerably improved with filtering.

the inter-platform data agreement by measuring correlation coefficients is shown in additional file  <dig>  the correlations between illumina and the other platforms were generally lower than between other pairs of microarray platforms. this could possibly be due to the lack of technical replicates for illumina.

comparison between microarrays and mpss
statistics of overlapped genes between microarray and mpss

                                 mrp1

                                 affymetrix
                                 amersham
                                 mergen
                                 abi
                                 illumina
                                 mpss 
                                 mpss 
expression profiles of the two mouse retina pools  were obtained on five one-dye microarray platforms , as well as mpss technology. genes were matched based on mapping to unigene cluster ids. for each pair of data sets, the number of common genes with expression data after filtering is shown. the upper triangle and lower triangle represent the statistics for mrp <dig> and mrp <dig>  respectively. the upper  and lower  diagonals show the total number of genes after filtering for each data set for mrp <dig> and mrp <dig>  respectively.

correspondence between microarray and mpss
the pearson correlation coefficients of log10-transformed gene expression were used to measure the overall linearity between microarray and mpss data, since it is well known gene expression data often have a distribution close to log-normal. as shown in table  <dig>  the cross-technology data correlations, i.e. between hybridization-based data and sequencing-based data, were found to be poorer than those of within-technology comparison. taking mpss 17-bp signature data as an example, the pearson correlations of the logarithmic transformed expressions between mpss data and microarrays ranged from  <dig>   ~ <dig>   for mrp <dig>  and  <dig>   ~ <dig>   for mrp <dig>  it is expected that a 17-bp signature decoding would result in higher sensitivity, while the 20-bp one would provide better specificity, but it is unclear whether they would differ in terms of their correlation with other platforms. from our analyses, we observed that mpss 17-bp and 20-bp tag lengths have comparable correlations to microarray platforms, as shown in table  <dig> 

gene expression data after filtering  were log10-transformed prior to calculating the pearson correlations. both microarray and mpss measurements were mapped to unigene clusters. the upper and lower triangle shows pair-wise correlations for data on mrp <dig> and mrp <dig>  respectively. the numbers on the diagonal are the within-platform correlations between mrp <dig> and mrp <dig> 

next, we wanted to examine how data correspondence, both in terms of binary presence call and correlation of expression, across the two technologies varied as a function of transcript abundance. in mpss, a gene was defined as present if the copy number was higher than a given tag count threshold, otherwise, it was considered absent. these calls were combined with microarray present/absence calls to perform a chi-square test to measure the agreement of present and absent calls between the technologies. when the threshold of tag count changed from  <dig> to  <dig> at a step of  <dig> , we obtained the binary call agreements as a function of tag abundances . we observed that the technologies often have the best correspondence when copy number threshold was set around 8~ <dig>  as the threshold increases, the correspondence measure tended to drop, which probably can be attributed to the drastically reduced number of mpss measurements above the given threshold. the trend of data correspondence versus tag count thresholds for each sample was similar among all microarray platforms. similarly, we also obtained data correlations when applying different tag count thresholds . the fluctuations in data correlations were small, but overall, affymetrix had better presence-call agreement and linear correlations with mpss than the other microarray platforms.

we also investigated the relationships for highly abundant genes. based on the cat  plots  <cit>  , we observed that illumina, abi and affymetrix had higher correspondence at the high-abundance gene expression levels, whereas amersham had the lowest. for all platforms, the correspondence with mpss gradually improved and converged when the gene set at the top was increased.

furthermore, we found that  <dig> genes  were present across five microarray platforms, but were not detected by mpss, neither from the 17-bp library nor the 20-bp library. for both libraries, about 64% of these genes were filtered out in the tag-to-gene mapping procedure. a total of  <dig> genes were not detected by mpss at all , among which  <dig> were labeled "gatc"-negative. using percentile-transformed data, we found that  <dig> % of the remaining genes  were detected as having low expressions . this indicates that low-end sensitivity is the major reason for data discrepancy.

taking the whole mpss libraries as gold standard, we defined false negative detections by each microarray as the number of genes that were detected by mpss, as well as printed on the chip, but were not detected by the microarray. we found that the proportion of false negatives in the five microarray platforms ranged from  <dig> %  to  <dig> % .

evaluation of data variations in biological replicates
using sam to characterize variation in detection of expression changes across biological replicates
based on the data from the microarrays where we had technical replicates, we used sam to compare the detection of differential expression from mrp1::mc versus mrp2::mc, i.e., differential expression was investigated between the two mouse retina replicates based on a common reference of mouse cortex. as shown in figure  <dig>  the experiment groups across platforms and biological replicates, except for mrp1::mc experiments on mergen, had quite comparable performance with respect to fdr  versus delta. delta represents the cutoff outside which genes are identified as differentially expressed by having a larger modified t-statistic than expected under the null model . all platforms, except for affymetrix, showed a larger number of differentially expressed genes in mrp1::mc than in mrp2::mc. the two retina pools showed the most disparate behavior on the mergen platform, and the least on the abi platform. moreover, when looking at mrp1::mc and mrp2::mc combined, abi tended to call a higher percentage of genes as differentially expressed between mouse retina and cortex samples than the other three microarray platforms.

two-way anova to identify individual genes with significant variation
two-way anova analysis was performed to identify the contribution of platforms and samples on data consistency. we examined filtered log2ratios  after normalization matched by both rs  and rsexon  across all four platforms where technical replicates were available. only those genes that did not have missing values across the  <dig> measurements were used in this analysis. in rs- and rsexon-based matching,  <dig> and  <dig> genes, respectively, satisfied the criterion. the threshold of statistical significance was chosen as p <  <dig> .

the majority of genes did not exhibit any bias induced by neither sample replicate nor by platform. for the two matching options  <dig>  %  and  <dig> %  of the genes for rs-based and rsexon-based matching, respectively, were robust both in sample and platform variability. based on table  <dig>  it can be seen that the number of genes that were subject to platform-induced variability was larger than the sample-induced variability. the data in this table also further support that probes matched at the exon level  across platforms resulted in lower data variations than those matched at the transcript level , as previously observed  <cit> .

two-way anova was conducted for all microarray platforms that had been analyzed with technical replicates . the genes that have valid measurements after normalization and filtering procedure in all technical replicates were included for the analysis. the analysis was conducted on gene expression measurements matched across platforms based on refseq id  and refseq exon . a gene was said to have sample-related variation if the p-value of the sample effect size was significant , and similarly for platform-related variation.

comparison of data variation between microarray and mpss
from the four microarray platforms with technical replicates, we used one-way anova to identify genes with differential expression in mrp <dig> versus mrp <dig>  these results were then compared with the z-test statistic commonly used for detecting differential expression in mpss data. the microarray data used for this analysis was restricted to genes that had valid measurements for all ten technical replicates. we also excluded measurements from probes with ambiguous unigene mapping, which was used to match microarray data with mpss data. for the four microarray platforms, affymetrix, amersham, mergen, and abi, we obtained  <dig> ,  <dig> ,  <dig> , and  <dig>  unigene identifiers with corresponding p-values from one-way anova, respectively.

taking a threshold p-value of  <dig> , we summarized the concordant and discordant calls between the microarray one-way anova test and the mpss z-test, as represented in table  <dig>  the proportion of concordant calls between microarrays and mpss were very similar among various platforms and 17-bp/20-bp mpss signatures, ranging from  <dig> % ~ <dig> %. most of the discordances between microarrays and mpss were cases were differential expression was detected by mpss but not by microarrays: ~94% for affymetrix, ~89% for amersham, ~79% for abi, and ~97% for mergen. data variation between biological replicates with mpss without technical replicates may understandably be larger than with microarrays when using sufficient numbers of replicates. it is easier to obtain robust statistical testing based on replicates. also in this analysis, we observed that the statistics with mpss 17-bp results and the 20-bp results did not differ significantly, consistent with the results of previous analyses.

one-way anova was conducted for all microarray platforms that had been analyzed with technical replicates  to identify differentially expressed genes between samples, mrp <dig> and mrp <dig>  for mpss libraries, a z-test was used to identify differentially expressed genes, since technical replicates were not available. a threshold p-value of  <dig>  was used for both statistical tests to define differential expression. based on unigene cluster mapping, identification of differentially expressed genes from mpss was compared to identification of differentially expressed genes from the microarrays. for each microarray platform, a column corresponding to comparison with the 17-bp tag library and a column corresponding to the 20-bp tag library are shown. the detailed comparisons of agreement/disagreement were restricted to the common unigene clusters where there was a one-to-one correspondence with mpss tags.

gsea to summarize differences between biological replicates using biological themes
for each microarray platform, we applied gsea to generate hypotheses regarding which biological processes or pathways might be responsible for the differences between the two replicate sample pools. only the genes  which had valid values across all  <dig> chips were used, that is,  <dig>  for affymetrix,  <dig>  for amersham,  <dig>  for mergen, and  <dig>  for abi. in gsea, the go hierarchy level was set to  <dig>  and the permutation times as  <dig>  several biological themes resulted from gsea with enrichment score, but none were statistically significant. although different microarray platforms revealed different degrees of variation between mrp <dig> and mrp <dig>  the gsea analyses on the affected gene sets were similar among platforms. when considering enriched themes found in all four platforms, there were  <dig> go terms from the "biological process" category enriched in mrp <dig> compared to mrp <dig> and  <dig> go terms from the "molecular function" category. there were no terms found to be enriched in mrp <dig> common to all platforms .

discussion
with microarray technology being rapidly developed and advanced in the past decade, it has become an important tool for studying gene expression patterns. in parallel, the technologies based on the "tag-and-count" principle, such as sage and mpss, are also being used for exploring the full transcriptome. although some efforts in designing and adopting standards of microarray experiments  and data deposition  are paving the way towards data meta-analyses and integration, it remains a critical challenge to systematically compare cross-sample, cross-platform, and cross-technology data. to this end, we have established a framework which accommodates various platforms and various technologies, using quality-controlled biological samples  <cit> . several recently published studies  <cit>  have concluded that, for dna microarray technology, the reproducibility of technical replicates both within a given platform and across platforms are generally good, especially when the experimental design, protocols, and data analyses are standardized  <cit> . in this study, we have examined data correspondence and discrepancy between mpss and one-dye microarray platforms, representing sequencing-based and hybridization-based technologies, respectively. we examined whether and how the behavior of these distinct technologies would vary when challenged with biological replicates.

the main observations made in this study were that across the microarray platforms, both intra- and inter-consistency of data was generally high, but the agreement between mpss and any microarray platform was moderate, as also reported in previous studies  <cit> . the differences in signal detection between mpss and microarray platforms were observed both in terms of lower correlations and in terms of genes that were consistently found as expressed in mpss but not in microarrays and vice versa. these findings were also identified in a similar study  <cit> , where this could be the reflection of the known limitations of the mpss technology  <cit> . although mapping problems may have contributed to the observed discrepancies, it is more likely that inherent differences between hybridization-based and sequencing-based technologies caused the systematic differences in gene expression detection between mpss and microarrays. for a given microarray design, the set of genes that can be detected is pre-determined, while for mpss and similar technologies, the main limitation is that presence of a recognition site is a requirement for detection. however, when comparing the genes represented on the various microarrays to the genes detected as expressed with mpss, we found approximately 80% of the genes on the abi and illumina arrays had not been found in the mpss libraries and about half of the genes for the affymetrix, amersham and mergen arrays. this suggests that all the microarray designs were comprehensive with respect to genome coverage, and that the fixed probe sets may not have been a main limitation in this study. furthermore, in all microarray platforms there were a number of genes that were detected as present but not found in the mpss libraries. among the  <dig> such genes  common to all five microarray platforms, there were  <dig> that were found to be lacking the dpnii recognition site  and could not be expected to give any signal in mpss. for the remaining  <dig> genes, the expression measurements on the microarrays varied and included genes classified as consistently highly expressed, as well as genes classified as having consistent low expression. an investigation of the probe sequences of the most highly expressed genes in the microarray platforms did not reveal noticeable differences in the number of possible sequence matches between those found in mpss and those not found in mpss. it is nevertheless possible that some of the false-positives in microarrays relative to mpss could be caused by cross-hybridization due to suboptimal probe design. however, without a gold-standard, it is not possible to ascertain that the microarrays are overestimating the expression for these genes. for the genes identified as having lower expression in microarrays but not found in mpss, it is possible that this may have been caused by running the mpss experiments with insufficient sampling depths resulting in a less representative sampling of tags. there were also a number of genes that can be regarded as "false-negatives" on the microarrays relative to mpss, in the sense that they were represented on the microarrays and detected by mpss but not detected as expressed by the microarrays. for these genes there was less consistency across the platforms and only one gene detected by mpss was not identified as expressed by any of the microarrays where it had been represented. again, suboptimal probe design due to incomplete sequence knowledge can be a factor. other possible reasons include mpss sequencing errors  <cit> , high complexity in transcriptional activities  <cit> , heterogeneity in polyadenylation cleavage sites  <cit>  and various sequence-introduced biases  <cit> . we have however not been able to estimate the size of such contributions in this study. it has also been reported that the existence of snps  <cit>  can influence the interpretation of digital-based experimental data such as mpss or sage, but this is not expected to have been a major contributing factor in this study. the fact that the mapping to unigene ids had been based on two different versions of the unigene database is a possible confounding factor. however, this cannot explain all the discrepancies as several genes were manually checked against the latest unigene build and found to have consistent mappings.

data filtering is commonly applied both to microarray and mpss data. both in the present study and an earlier study, we have shown that data filtering considerably improves data consistency between microarray platforms, and in particular on relative expression . the low intensity signals generally corresponding to low-abundance transcripts are typically filtered as it is expected that the signal-to-noise ratio becomes too small. the comparisons between mpss and microarrays indicate that the mpss technology also has problems in detecting low-abundance transcripts. it appears that neither technology can reliably detect transcripts expressed at very low frequencies in an environment where the expression levels of all transcripts could span several orders of magnitude. this is a major problem as many transcripts have low-abundance, and there is currently a consensus that many of the corresponding genes are associated with critical regulatory roles in the cells  <cit> . for microarrays to improve the low-end sensitivity, the optimization of probe design, as well as the advances of scanning techniques, may be key issues. in sequencing-based systems, increase of library size and sequencing accuracy may increase the confidence in low-abundance transcripts identification.

recent studies have demonstrated that factors such as strain  <cit> , gender  <cit> , as well as diet  <cit>  and circadian variation,  <cit>  can influence gene expressions in various organisms and tissues. in our study we created two retina samples by randomized pooling of samples from a large number of individuals aiming to cancel out the effects of such factors. we examined the biological variability at several levels:  the influence of biological replicates on the measures of intra- and inter-platform data consistency;  the overall capability of differentially expressed gene identification by each biological replicate; and  the genes or gene sets that were most susceptible to biological variability between mrp <dig> and mrp <dig>  in general, the two pools showed very similar gene expression patterns as expected, but for some genes there was a difference between the two mouse retina pools that was consistent across the platforms and technologies. moreover, mpss also differed considerably from the microarray platforms in terms of identification of genes differentially expressed in mrp <dig> versus mrp <dig>  as is commonly done due to high instrumental complexity and cost, mpss data for each sample was collected without technical replicates, and differentially expressed genes were identified by a statistical approach. the z-test, found by man et al.  <cit>  to perform well in terms of specificity, power, and robustness for determining statistical significance in sage, detected far more differentially expressed genes than the statistical tests applied to the microarray data with technical replicates. also in terms of fold-change, mpss detected far more genes as having two-fold or larger change than the microarray platforms. in this respect, illumina data, which also did not have technical replicates, behaved similarly as the other microarray platforms, hence the lack of technical replicates alone cannot explain all of these differences. in light of the construction of the two retina pools and the good agreement between the microarray platforms, this may be a sign of caution for those who intend to use mpss for the purpose of biomarker discovery without incorporating technical replicates. until technological advances make technical replicates in mpss feasible and mpss data are further studied and confirmed using independent and complementary technologies, mpss may not be the optimal choice for identification of novel fingerprints based on differential expression.

the gsea results across the microarray platforms with technical replicates indicated some common biological themes for the differences between mrp <dig> and mrp <dig>  although the results were not statistically significant, they were very consistent across the platforms and indicated metabolism and transcriptional regulation as general biological themes describing the differences. this was also confirmed by gostat  <cit>  analysis using a list of genes consistently identified as differentially expressed when also including mpss data . based on the construction of the two retina pools, these results indicate that caution should be exercised when interpreting results of differential expression.

an earlier study  <cit> , which compared microarray data, est-based expression experimental data and sage using published data sets, reached the conclusion that the agreement between the methods was highly variable from gene to gene, and the authors advocated the need for gene-by-gene validation of important global gene expression measurements using non-global methods. the present results support a similar conclusion, and we emphasize that sequencing-based methods in general as well as hybridization-based methods have inherent technological limitations. microarrays are limited by pre-selected gene sets and possible cross-hybridization problems, as was indicated in this study. apart from the obvious limitations of restriction site presence, mpss is an open-ended system but has problems related to the mapping of tags limiting the set of genes for which it is possible to obtain reliable measurements. altogether, this suggests that exploitation of the complementarity of these technologies is a better approach for global transcriptome analysis.

CONCLUSIONS
overall, the agreement between mpss and microarrays was significant, but lower than between different microarray platforms. measurements of genes with low expression more often disagreed than highly expressed genes, as expected, but also for genes with high expression there were systematic differences in detection. we found that differences in gene expression measurements between mpss and microarrays are not only due to increased sensitivity of mpss to low abundance transcripts and the ability of mpss to measure new transcripts. further studies comparing sequencing-based and hybridization-based technologies, including both biological replicates using different types of tissue samples as well as technical replicates are warranted in order to delineate in more detail the shortcomings of these technologies. future methodological development will be necessary to maximize the information derived from the two complementary types of technology.

