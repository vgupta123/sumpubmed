BACKGROUND
in medical research, knowledge of chromosomal deletions or amplifications is of great importance. for example, it can help us better understand the genetic causes of certain diseases and as a consequence, improve the treatment and prognosis of individual patients. classic techniques for the detection of chromosomal abnormalities include karyotyping, southern blotting, fluorescent in situ hybridisation , ca-repeat analysis and quantitative micro satellite analysis by real-time pcr  <cit> . in recent years, high-throughput methods based on bac arrays, snp arrays and related techniques have gained prominence  <cit> . although these are excellent tools for whole genome analysis, these techniques are laborious, time-consuming, difficult to implement, expensive and generate large data sets. the management and interpretation of such voluminous data is not a light task. multiplex ligation-dependent probe amplification   <cit>  has been introduced as a relatively cheap and fast method to perform quantitative chromosomal analysis of up to about  <dig> genomic dna or rna sequences, which is able to distinguish sequences differing in only one nucleotide. this technique fills the gap between the methods that investigate a single locus and the techniques that interrogate thousands of loci.

mlpa is a quick and cost effective approach to testing for the presence of gene deletions or obtaining tumour profiles on multiple loci in a single tube, which can easily be applied in molecular pathology. furthermore, mlpa only requires small amounts of dna. moreover, dna obtained from formalin fixed paraffin embedded material can be used. currently, mlpa is used for the validation of array-based comparative genomic hybridisation  and snp arrays  <cit> . other applications for mlpa include methylation status determination, copy number analysis in segmentally duplicated regions, expression profiling, and transgene genotyping  <cit> . the principle of mlpa is that for each locus, two dna oligonucleotides  must hybridise to their complementary target sequences on the template dna for ligation to occur. subsequently a pcr reaction is performed on the ligated probes. after pcr, an aliquot of the pcr product is combined with an internal size marker and deionised formamide. the sample is then injected into a capillary of an automated sequencer, where after a  <dig> minutes run, the data are subsequently collected for further analysis. since, the amount of ligated probes is dependent on the number of specific primer binding sites, this method is suitable for the detection of chromosomal deletions or amplifications  <cit> 

the analysis, visualisation and data management of hundreds of samples with many different probes per reaction can be cumbersome. like in many modern techniques, the results of an mlpa analysis are delivered as lists of values that can be easily imported into spreadsheet applications. large collections of individual spreadsheets are not the best way to collect and analyse data, especially in an environment where a controlled work flow has to be guaranteed. a database system offers advantages such as the tracking of material used in the tests and consistency in the handling of test results. some of the information that needs to be managed includes: the origin of normal and test samples, the experimental setup, the identity of the probes, and the quality settings. normalisation has to be performed within and between samples and results have to be visualised and stored. sophisticated tools are needed to facilitate the reliable use of mlpa  <cit> . in this paper, we present a statistical technique for the normalisation of mlpa data and the software component that we have developed to make mlpa a simple, effective, and attractive tool. here we describe mlpainter, for mlpa interpretation, a system that stores results, instrument settings and sample descriptions in a microsoft access database. a special front-end, written in the borland delphi language, allows the user to interrogate the database, normalise data and visualise results as heat maps and specialised plots.

implementation
mlpa probe kits are obtained from mrc-holland . all assays are performed according to the manufacturers' protocols on an abi dna sequencer . mlpainter was constructed using delphi  <dig>  for the gui, and microsoft office access  <dig>  for the standalone database. the runtime requirements for the application are windows xp or newer. statistics used in mlpainter as described below, were validated in a series of oligodendroglial tumours as previously described  <cit> . the source code and a step by step protocol to use mlpainter together with showcase sample files and analysis tables can be obtained from http://code.google.com/p/mlpainter/

RESULTS
data pre-processing
mlpainter can not handle the raw electrophoresis signal and therefore requires that the mlpa amplification product peaks have already been linked to the corresponding mlpa probes of the used mlpa kit. after electrophoresis, all mlpa sample trace files should be pre-processed in standard software for basic analysis of mlpa traces. subsequently, the report files can be imported. here we used genemapper  for mlpainter, but the system can also import data from the combination genescan analysis and genotyper software . adaptations to other software programs like genemarker  should be straightforward. a step-by-step vignette for genemapper settings can be found at http://code.google.com/p/mlpainter/. briefly, the product lengths of the ligated probes are defined with an internal size standard. the peak height and area are calculated for every peak present in the trace. any undefined peaks are discarded from further analysis. data tables are then automatically generated with length, height and area of all recognised peaks. these tables are exported from the genemapper software package and imported into mlpainter for specific analysis of the raw data. protocols for linking output files from other software packages are planned for future versions.

data management
here, we developed a relational database using microsoft access to manage all pertinent information for mlpa experiments and created a front end with borland delphi to guide laboratory workflow and data analysis. characteristics such as the sample number and status, e.g., tumour or normal, dna concentration and, if available, tumour percentages that are relevant for the performance of the mlpa should be stored in a database. annotation information like the chromosomal position and gene names of the different probes in a kit should be available for the interpretation of the results in output tables, heat maps, and plots. to assist the laboratory work-flow, electronic and paper sample sheets can be prepared for the automated sequencer. the raw data of the sequencing reports are imported into the database for subsequent quality control steps and analysis.

the relational database contains three hierarchies which are interconnected. the hierarchies are mlpa kits and probes, electrophoresis results, and analyses. in the database tables, next to the specific kit information, you can find gene and probe names, as well as the physical and cytogenetic location of the probes. all probes in a particular kit are numbered from  <dig>  for the probe with the smallest product size to n, for the probe with the largest product size. every kit contains a number of probes that can be used for a quality check of the trace. the corresponding products are named based on their size in base pairs. the different kits as defined by mrc-holland, can be imported from http://www.mlpa.com.

both the mlpa run and analysis hierarchy use the samples table. this table contains clinical information like the origin of the used dna, e.g., if the dna is isolated from whole blood, fresh frozen tissue or formalin fixed paraffin embedded tissue. every sample is labelled with an n for normal, t for test or the tumour origin of the tissue. normal samples are treated differently from test samples in the normalisation and analysis steps as described in the normalisation section. an electrophoresis run typically consists of a sample plate to be processed by the sequencer. the sample, the kit, and a unique name for the plate are recorded for each position on the sample plate. different types of kits can be used within one run. from this information a sample sheet or configuration file is created for the sequencer. the resulting peak heights and peak areas of an mlpa run are imported for all of the probes in a kit and the analysis settings can be set to analyse peak heights or peak areas.

during analysis, specific mlpa runs can be combined from one or more electrophoresis runs. a group of reference probes can be copied from another analysis with the same kit, and can be adapted to suit the needs of the specific analysis. however, to avoid inter experimental differences, values from experiments performed at a different time should not be used. probes can also be excluded from the analysis. successful analysis can be finalised by authorising the results. after authorising the analysis, all options are fixed except for visualisation and sorting options.

quality control
mlpainter presents three data quality indicators, q <dig>  q <dig> and q <dig>   to assist with the decision of whether to include a trace in the analysis.

the first indicator  is the ratio between the ligation dependent peak at  <dig> base pairs and the median of the dna dependent  <dig>   <dig>   <dig> and  <dig> peaks . van dijk et al.  <cit>  state that this ratio should be greater than  <dig> to obtain good and reproducible results. nonetheless, we have observed that in some cases, lower ratios can also give reliable peak patterns .

the second quality indicator  is the median peak height of the probe signals present in the kit. if the median of the first  <dig> ligated probe peak heights is below  <dig> relative fluorescent units , the trace quality is considered low. moreover, because of the limits in the detection optics of the instrument, a median peak height over  <dig> rfu is indicative that the trace quality is low   <cit> .

for the last indicator  all analysis peaks are split in  <dig> parts based on sequence length. the value is computed as the median signal of the longest probes divided by the median signal of the shortest probes. often the longest probes show lower signals, however in high quality traces this indicator is usually over  <dig> .

other factors that are important for the assessment of quality, which can optionally be stored into the database, are the dna concentration of the sample, the tumour percentage of the tumour specimens and the intrinsic dna quality of the sample. the combination of these quality parameters allows the user to decide on inclusion or exclusion of a trace from the analysis.

normalisation
raw mlpa results are not calibrated. peak areas or heights are dependent on sample quality, hybridisation parameters and instrument settings. to analyse the mlpa traces, internal and external control loci are used for the normalisation of the data. external controls, e.g., normal tissue in tumour analysis, have to be present in every experiment for the pattern comparison. internal controls for the calibration of the samples are present in every kit and are supposed to be non-altered or reference probes in a tumour sample. these reference probes are compared to the probes where dna changes are expected.

the top trace in figure  <dig> shows a normal sample. it is evident that peak heights or areas differ between probes; and these differences have to be corrected. also the average peak areas or heights may differ from sample to sample. therefore, sample calibration and probe calibration have to be performed. consider the data as a matrix y, with columns for the probes and rows for the sample. then, we need to apply normalisation to both rows and columns. normalisation is implemented as division by row parameters ri, i =  <dig> ... m and column parameters cj, j =  <dig> ... n, such that a matrix x =  results, with xjb = yjb/. we prefer to work on the original scale instead of with logarithms because loss and gain correspond to integer ratios  on the original scale.

a simple approach would be to take row and column medians for r and c, respectively. this could work well if the number of deletions or amplifications is relatively small. however, for samples with a large number of deletions , the corresponding row median might become a number near zero and normalisation by dividing with this small number would give a completely wrong result.

to improve normalisation and obtain calibration factors, we use only a subset of the samples and probes. specifically, we use normal samples, and only a subset of the probes, where copy number changes are unlikely, even in tumour samples. we use the following algorithm:

 <dig>  to correct for the sample-to-sample variation, divide the peak heights or areas of all the probes in each sample by their median. this gives provisional row parameters, ř for the normal samples, and provisional normalisation of the normal samples.

 <dig>  to correct for systematic differences between probes, divide the peak heights or areas of all the probes within a mlpa run by their median. this results in the normalised peak areas or heights, and represents the column parameters c for all probes. the average of all probes is now close to  <dig> 

 <dig>  select the probes that have a small probability of change in copy number. call these the reference probes. the remaining probes are called the focus probes, since we look for changes in these. the description file for commercial kits includes this information, and the program uses these probes by default.

 <dig>  select the part of the data that represents the normal control or non-tumour samples and the reference probes.

 <dig>  redo steps  <dig> and  <dig> for the subsets of reference samples and reference probes.

 <dig>  determine which probes are most stable. subtract  <dig> from each normalised peak height or area and take the absolute value. compute for integrated mlpa analysis the median of these numbers for each probe. this is the median of the absolute deviations: mad.

 <dig>  the reference probes with the lowest mad are most stable. select the five probes closest to zero. these are the probes that we call the calibration probes.

 <dig>  compute the median peak height or area of the  <dig> calibration probes for each sample . divide all peak heights or areas as computed in step  <dig> in each sample by this value. this gives the final row parameters r for all samples, and their final normalisation.

reference probe selection
as in quantitative rt-pcr, the selection of reference probes is a critical element of the analysis  <cit> . mlpa kits contain about  <dig> reference probes that are includ for normalisation purposes because they are not involved in the experimental hypothesis/diagnostic question. alternatively, one can usually find a subset of probes in existing kits that are known not to be involved in the hypothesis. the procedure selects the most stable probes from the reference probes to calibrate the data. the number of calibration probes used  did not significantly influence the results . however, the number is configurable in the program. if probes show high variability between replicates or between normal samples, they should be excluded from the analysis.

visualisation
we have designed a number of visualisations to interpret the results after the normalisation and quality control of the data set. the first visualisation is a heat map that shows all of the data in an experiment. deletions and gains are colour-coded with configurable thresholds. probes can be sorted by locus names or chromosomal position. the reference and calibration probes are clearly differentiated by a grey-shade . another visualisation shows the normalised values of all replicates of one sample in a plot . technical replicates are shown in different colours. on the x-axis, the different probes are shown in the selected probe order. the y-axis is on a scale from  <dig> to  <dig> , where  <dig> stands for absent probes. ideally probes at genomic loci with loss of a single allele show values around  <dig> . unaltered probes are visualised around  <dig> . probes with dna gains have values around  <dig>  or above. in tumour samples contaminated with normal dna these values are usually not that outspoken. the researcher should keep this in mind during the interpretation. information about sample characteristics and probes used are also shown in the plots.

future developments
currently the system is suited for the analysis, visualisation and data management of mlpa. however, all of the information generated during an experiment is still not fully integrated in the data analysis. for instance, tumour percentages can be stored in the database and will be displayed, but it is up to the user to incorporate this information into the interpretation. we plan to include the tumour percentage and probably the dna index for automated identification of the allelic state of the chromosomal aberrations in the analysed sample  <cit> . another worthwhile improvement would be to remove the dependency on an external program to do the peak detection.

discussion
mlpa has a variety of applications for the detection of changes in dosage at a single locus, e.g., a subtelomeric locus, to those with multiple changes. up to  <dig> different probes  can be interrogated in one single reaction. advantages are that only small amounts of dna are needed and that dna isolated from formalin fixed paraffin embedded material can be used. as it stands, currently available software tools for mlpa analysis do not integrate data management, normalisation and visualisation, and do not always perform adequate data normalisation between and within traces. in these packages, the quality aspects of the analysis are not always taken into consideration. therefore, we have developed a method for mlpa data interpreting, mlpainter, in which sample information can be stored, and where the laboratory and analysis workflow is assisted. experiments are prepared by selecting samples and mlpa kits. then sample sheets for automated sequencers are generated, which can easily be imported in the sequencer, avoiding manual input and typing errors. analysis tables can then be imported from standard dna analysis programs. given the sensitivity and reproducibility of this methodology, the requirements for proper internal controls for normalisation have to be stringent  <cit> . for that reason, in each kit, the manufacturer has provided sets of reference probes for sample data. however, for the analysis of unpredictable  samples, these provided reference probes may be inadequate. thus, we created an algorithm that will select the  <dig> most stable reference probes and suggest that these probes be used for the normalisation of the traces. the user has full control over the settings of the analysis, and changes like including or excluding samples or designating probes as reference probes result in immediate recalculations. all calculations can be visualised in plots. by authorising the results, the analysis settings are definitively linked to the analysis and can no longer be changed.

mlpa results are, in general, very reproducible. still, we perform all tests at least in duplicate, especially in a diagnostic setting. mlpainter supports the handling of replicates in the analysis. we previously validated the statistics used for mlpainter on a series of dnas that were obtained from formalin fixed and paraffin embedded oligodendroglial tumours by correlating the results with those obtained by fluorescent in situ hybridisation . the mlpa results were reproducible in all samples in which repeated experiments were performed  <cit> .

CONCLUSIONS
we have combined the analysis, visualisation and data management for mlpa in a tool, mlpainter for mlpa interpretation, which makes use of a relational database with a delphi front end. this integrated approach helps in the automated handling of large series of mlpa data and helps to guarantee a quick and streamlined dataflow from the initiation of an experiment to the generation of authorised report. mlpainter has been successfully used in our lab for over two years to manage over  <dig> samples. moreover, different mlpa kits have been successfully used for this type of analysis, e.g., kit p <dig> and p <dig> for the analysis of oligodendrogliomas, p <dig> for cdkn2a/b and p <dig> for subtelomeric regions.

availiability and requirements
project name: mlpainter

project home page: http://code.google.com/p/mlpainter/

operating system: windows xp or higher

programming language: delphi

other requirements: no

licence: gnu gpl  <dig> 

any restrictions to use by non-academics: no

abbreviations
mlpa: multiplex legation-dependent probe amplification; rfu: relative fluorescent units; rt-pcr: real time-pcr; mad: median of the absolute deviations.

authors' contributions
rve specified mlpainter functionalities and drafted the main parts of this manuscript. phce developed the statistics for normalisation of the mlpa data. rn validated statistics on a series of oligodendrogliomas. amcj, tvw and jm participated in the study design and supervised the implementation of mlpainter in molecular diagnostics. jo developed the software and supervised the drafting of the manuscript. all authors read and approved the final manuscript.

