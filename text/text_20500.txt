BACKGROUND
up to 30% of patients with epilepsy are resistant to anti-epileptic drugs   <cit> . a subset of these patients suffers from partial epilepsy. these patients are potential candidates for the surgical removal of the epileptogenic zone , first defined as “the site of the beginning and primary organization of the epileptic seizures”  <cit> . in order to characterize the ez, clinical history and examination, medical imaging , scalp eeg, and neuropsychological data are combined in order to derive a coherent hypothesis . when non-invasive data are not sufficient, intracranial recordings may be used to define the ez. on average,  <dig> to 30% of patients suffering from partial epilepsy are candidates for intracranial investigations . stereo-electroencephalography  is a methodology developed by talairach and bancaud at hôpital sainte anne, paris  <cit> . this methodology aims to record local field potentials through stereotactically implanted intracerebral electrodes. during the post-implant long-term video-seeg monitoring, epileptologists analyze the signals recorded from within the brain and attempt to define the ez and a possible surgical resection plan. therefore, the correct anatomical localization of all the implanted contacts is mandatory in order to define where the eeg traces are recorded from and also to facilitate radio-frequency thermal brain lesions performed through seeg electrodes as a treatment option  <cit> . electrode contact segmentation is a time-consuming task, as it often involves the localization of  <dig> to  <dig> contacts per patient. this task is usually carried out manually, by visual inspection of mri or computed tomography  scans  <cit>  or using post-implant 2d photographs  <cit> ; it is often incomplete  and can be inaccurate e.g. in cases of non-planar trajectories where artefacts may merge neighboring contacts into a single group of indistinguishable voxels. in recent years, several techniques for the localization of intracranial eeg electrodes have been proposed . most of the approaches aim to simplify the manual extraction of contact coordinates for grid/strips or for deep brain stimulation  electrodes by fusing opportunely thresholded post-implant datasets with pre-implant mris  <cit> . however, these approaches are not suitable for fully automatic localization of seeg electrode contacts in complex arrangements . mostly because visual extracting channel positions with respect to anatomical regions requires the visual integration of several imaging modalities and the manual selection the segmented contact positions. this approach is only suitable for a limited amount of channels as in the case of dbs electrodes . recently, a novel algorithm has been proposed which has been specifically designed to segment seeg contacts from a thresholded post-implant ct volume  <cit> . this algorithm has been implemented in an open-source tool called deeto  <cit> . despite its robustness, the tool has several limitations and lacks some advanced features: for example, it has no graphical interface, the type of multilead electrode  cannot be changed, and the parameter settings, which may be needed for complex cases such as touching electrodes, are only accessible to computer-expert users by modifying the code.

moreover, visual inspection of post-implant data  and acquired electrophysiological signals is routinely carried out to discriminate between contacts recording from grey or white matter, and to define the most probable neuronal source of the recorded activity.

in clinical and research settings, seeg time-series are usually analysed using a bipolar  referencing scheme, where each contact is referenced to its neighbour. such approach might significantly distort the signal when bipolar contacts depict activity from neighbouring but functionally distinct areas, e.g. anterior and posterior banks of the central sulcus  <cit> .

recently it has been suggested that it may be more beneficial to use the nearby white matter contacts as ‘silent’ references to electrodes in grey matter  <cit> . this approach has been proven to alleviate the signal phase and amplitude distortion problems inherent in bipolar recordings and has allowed the characterization of phase and amplitude correlations  <cit>  and long-range temporal correlations in the human brain with spatial and temporal patterns similar to those previously reported in magneto-electroencephalograhy   <cit> . taking advantage of a sub-millimetre resolution of lead localization process, in  <cit>  authors formulated the grey-matter proximity index  which represents the distance of a given contact from the white/grey boundary and therefore discriminates between contacts recording from white or grey matter . the automatic computation of the gmpi requires ad-hoc scripts/tools that either are not freely available or need significant manual intervention in order to be included in standard clinical workflows.

on the other hand, post-implant images are usually fused with pre-implant mri in order to visually estimate the position of each contact relative to the cerebral cortex and to derive its most probable neuronal source. all these operations require the integration of many different computer assisted tools , and require significant knowledge and effort from the clinicians involved. to the best of our knowledge, such an integrated framework for post-implant processing does not exist. in this paper we present seeg assistant, a collection of tools that aim to assist neurosurgeons with the seeg workflow, focusing on the post-implant phase.

implementation
in this work we designed and implemented three modules, a graphical user interface  for each module, and integrated them in a 3dslicer extension. each module solves a specific task . the first module, contact position estimator , estimates the coordinates of the electrode contacts relative to the patient’s geometrical space by automatically detecting contact positions from a thresholded post-implant ct volume. the second module, the brain zone detector , localizes the neuronal source of the recorded activity by automatically determining each contact position within a volumetric brain atlas, e.g. destrieux  <cit> . the third one, the grey matter proximity index estimator , enables automatic classification of white and grey matter contacts by automatically computing their gmpi indices.
fig.  <dig> seeg assistant framework is composed of three interconnected elements. the figure illustrates the three modules constituting the backbone of seega module , their relations , and i/o. contact position estimator  extracts the contact positions from post-implant ct data provided the entry/target points for each implanted electrode  and several parameters. these latter consist in the implanted electrode model  and two boolean parameters. cpe outputs a fiducial file  containing all segemented channel positions in the reference image  along with contact label. in the test settings, electrodes are marked with a single capital letter  and channels are identified with increasing numbers . the next two modules namely grey matter proximity index estimator  and brain zone detector  can be used without a specific order since they do not depends on each other. the former uses the segmented channel positions and pial/white matter surfaces  and computes for each contact the distance from white/grey boundary normalized to the cortical thickness. the latter uses contact positions and a volumetric probabilitic parcellation  and estimates the probability  of given source/anatomical area to be the generator of the recorded electrophysiological activity. all these information are added to the recon file that can be saved for later usage or inspected from 3dslicer interface




seeg assistant is developed as an extension for 3d slicer  <cit> , a free and open-source software at the cutting edge of medical image analysis. it is mainly implemented in python  using vtk   <cit>  and qt libraries  <cit> . we decided to develop our tools as an extension of an existing software to exploit the vast collection of pre-processing tools available within 3d slicer. this approach leads two benefits. first it does not link the users to a pre-defined methodology but grants some degree of freedom. secondly, by addressing such specific tasks, it allows a more easy integration in existing manual/automated analysis pipeline in established clinical settings.

contact position estimator
the contact position estimator segments the contact positions of each seeg electrode in each subject’s geometrical space, requiring two inputs . the first input is a pre-processed post-implant ct volume where multilead electrodes are imaged. the preliminary processing of this dataset includes two steps and should be performed outside the proposed tool. the former aims to remove the skull, as its voxel intensities lie in the same range as contacts, by subtracting a co-registered  pre-implant ct. the latter uses a manually selected threshold of voxel intensities to enhance boundaries between contacts and the background. all voxels above the selected threshold retain their original intensities while the remaining ones are fixed to zero. the second input is the markups fiducial  list, a file that contains the planned entry and target points, defined as the most proximal and most distal points, with respect to the cortical surface, of each electrode, respectively. the file contains several lines, and each line may contain two different types of information:  comments , and  a labeled point in the 3d space with the following format: 
  <dig> l,x,y,z 


where l represents the unique electrode name and  the coordinates in millimeters of either the target or entry point referenced to the patient’s geometrical space. this file can be provided using coregistered pre-implant surgical coordinates or constructed directly using 3dslicer tool . cpe reads this information from 3dslicer memory and assumes that both the ct scan and the mf file refer to the same geometrical space. from the mf list, the module constructs a set of electrodes coupling their entry and target points using electrode label : 
  <dig> li=<ei,ti> 


where e
i is the entry point and t
i is the target point of the electrode labeled l
i. supported naming strategies are  the same capital letter or  capital letter and capital letter followed by a number  for entry and target points, respectively. afterwards, the module creates an interactive table where the user can choose, for each electrode, the manufacturer model used in the implant. the default configuration assumes that the patients have been implanted with semi-rigid seeg electrodes manufactured by dixi medical . many models of electrodes exist, with varying lengths and numbers of contacts. however, we provide a configuration file where different electrode settings can be added without the need to change the code. for each electrode the user interface  also displays two check boxes: tip and cortex. these are the geometrical points used to estimate the final axis. the tip is the most distal point on the tip of the electrode, while the cortex is the point closest to the cortical surface. tip and cortex are usually computed starting from the target and entry point of the mf file, respectively. thus, when cortex  box is checked, the cpe does not estimate its relative point but assumes the line connecting the unchecked  and checked  as the electrode axis. if a user checks one  of these boxes, he should also be sure that the targets/entries of the mf list are as accurate as possible with respect to the tip/cortex positions. 3dslicer visualizes points contained in mf list as spheres in the 3d visualization. thus, from the interface it is possible to manually adjust every point contained in the list or even add or remove any of them.

finally, once all settings have been fine tuned, the user actively triggers the computation by pressing the start segmentation button and, for each selected electrode from the mf list, the module executes an external  tool called deetos  <cit> . this tool has been implemented in c++ exploiting advanced features of the itk libraries  <cit>  which, at the time of writing the code, were not fully ported in python nor included in standard 3dslicer installation package. for this reason, deetos has been called as external tool within the ui. deetos is an open-source software that has been constructed as a branch of the tool deeto  <cit>  to ease the integration with 3dslicer. more precisely, we simplified the command line, by allowing the segmentation of one electrode at a time , but also including the option to set the type of electrode used for the segmentation. in this section we will give a general overview of the algorithm; for further detail please refer to  <cit> .

deetos takes three parameters as input:  the ct volume,  the coordinates of two points,  the parameters describing the electrode type . it then outputs a set of coordinates representing the centre of each segmented contact and saves them as markup entries along with a label formed by a unique capital letter for each electrode followed by an integer. the segmented points are then ordered alphabetically in the list, from the deepest  to the most external point  with respect to the cortical surface. the algorithm executes two main steps: electrode axis estimation and electrode contact segmentation. the electrode axis estimation relies on the knowledge of two initial points, namely the entry point and the target point, defining the planned electrode axis. the electrode axis estimation computes the final electrode axis, i.e. a line joining the cortex and tip points. the cortex point estimation is usually executed by computing the centre of mass of a region around the entry point. in a real implant, the electrode entries are far from each other, while the tips can be very close: for this reason the algorithm used to compute the cortex cannot be used to estimate the tip. indeed, the tip is usually estimated starting from the cortical entry point of the electrode and progressively computing the centre of mass of the points lying on the axis defined by the entry and target points. once cortex and tip points have been estimated, deetos proceeds with the electrode contact segmentation step. it iteratively locates each contact within a geometrical-constrained search space on the estimated axis. the search-space is defined by two strong constraints: the former represents the fixed inter-contact distance , while the latter states that the axis deviation should be less than  <dig> degrees, since those deviations can only occur within electrode cables connecting two adjacent contacts. the contact centroids are then approximated with the centre of mass of the radiological artefacts that satisfies all the strong constraints . occasionally, in some rare and complex cases with default configuration - i.e. standard electrode model and planned entry/target points, the cpe module fails to correctly segment some electrodes. simple visual inspection of the 3d scene allows identification of these cases . these errors only arise during axis estimation, and this is most frequently due to proximity with other electrodes. neighbouring electrodes can influence the centre of mass computation applied in the estimation of the real axis, since the algorithm relaxes the geometrical constraints to find a suitable solution. on the other hand, once the axis has been estimated, the search for the contact positions restores these constraints and the solution cannot diverge as the algorithm proceeds along the estimated line. thus, when the estimated axis diverges from the real one, it is possible to set it manually by checking the tip and cortex boxes in the electrode configuration table. if a check box is active, deetos does not compute the corresponding point, and thus the entry and target points represent the electrode axis.
fig.  <dig> interfaces and workflow of seega. this figure shows the interfaces designed to interact with the underlying algorithms and provides an example of the workflow. all drop-down listboxes are populated with data included in the 3dslicer scene. a initial configuration panel of cpe where a fiducial file needs to be selected. b shows the path of the deetos binary file provided within seega installation. once a fiducial file  has been selected a table is populated with recognized electrodes with valid entry/target pairs. the drop-down list next to the electrode label is used to select its specific model which univocally defines number of contacts and inter-contact distances. an example of what is shown in the 3d view panel wihtin 3dslicer is provided as inset with post-implant thresholded-ct meshes  and fiducial file shown as markups  with letters representing each electrode. c shows the bzd interface where both bzd takes a volumetric parcellation  and the recontructed data . examples of such inputs are shown below the interface. d shows gmpie interface where the five inputs are defined as left  right  pial  and white  surfaces together with segmented channel positions 


fig.  <dig> cpe out performs manual segmentation in complex and critical cases. a as an example of seeg complexity, we show mri and thresholded post-implant ct scans for one subject from our cohort. contacts are shown as groups of white voxels. this case illustrates the complexity of seeg implants with electrode shafts following non-planar directions , shafts targeting almost the same geometrical point . b cpe segments all contacts  belonging to each electrode from post-implant ct scans, represented here as red 3d meshes obtained tesselleting the thresholded data to ease visualization. c show the right pial surface with 3d post-implant thresholded-ct meshes and the cut plane used in panel d where the example of x and x’ electrodes are shown. those examples represent the case of non-planar insertion trajectories which yielded an artefactually fused electrode. cpe integrating the knowledge of the electrode model can segment the contact positions more accurately than visual inspection




brain zone locator
the brain zone locator module locates each contact with respect to the brain region it occupies. the module uses a pre-computed volumetric representation of a probabilistic atlas, such as the destrieux  <cit>  or desikan-killiany atlases  <cit>  included in freesurfer. it takes two inputs:  a volumetric parcellation co-registered with subject geometrical space, where each voxel has been tagged  with a numeric tag representing the most probable region within which it is located, and  a set of points representing lead positions. for each contact, it constructs a spherical region of interest  with  <dig> mm diameter centered in its centroid and extracts the fraction of voxels representing a given area contained within the roi. we chose  <dig> mm as diameter because contact centroids are  <dig>  mm apart. thus,  <dig>  mm on both sides of the volume ensure a partial overlap between adjacent contacts. of note, different electrode settings might require different side lengths. thus the parameter can be manually changed by the user through the interface. these values, together with the region name, are presented with the mf description and saved along with lead positions. the module assumes that the volume and lead positions lie in the same geometrical space.

gmpi estimator
to enable automatic classification between white and grey matter contacts, we included the grey matter proximity index estimation for each segmented contact. the module takes as input a set of labelled points and the meshes describing the pial and white surfaces for both hemispheres. theoretically, one investigator can use any tool that provides a brain segmentation and which outputs 3d meshes for grey and white matter boundaries. in this work we estimated cortical pial and white surfaces by means of freesurfer tools  <cit>  using standard 3d t <dig> ffe mris data and default settings . for detail about the usage of freesurfer tools, advanced parameter settings, and complete description of outputs please refer to the relevant documentation  <cit> . it should be noted that freesurfer surfaces are natively represented in a centered geometric space. thus, a simple translation is required to align the center of scanner space, where contacts are represented, to surface space.

the gmpi is defined as the distance between the contact position and the nearest vertex of the white-grey surface, scaled by the cortical thickness at that point. thickness is here estimated as the distance between the nearest pial and white-matter-grey-matter interface  vertices along the normal axis to the cortex. this measure has been proven to be reliable with respect to real cortical thickness assessed on post-surgical histological investigation of resected tissue  <cit> . gmpi can be mathematically formalised as follows: 
  <dig> gmpi=·|p−w| 


where p,w and c are the pial vertex, wmgmi vertex and contact coordinates, respectively. gmpi is an unbounded measure that can be used to automatically classify grey and white matter contact. gmpi values between zero and one indicate that the contact midpoint is located within grey matter, whereas negative values indicate that the contact midpoint is in white matter. however, electrical fields generated in grey matter spread also to nearby white matter. moreover, the electrode contact physically spans a  <dig> mm long volume with a radius of  <dig>  mm around the midpoint. thus, in  <cit>  authors suggest to use − <dig>  as the gmpi threshold for grey/white matter determination. they have also demonstrated that with this threshold none of the white matter contacts are misclassified as grey matter contacts. it should be noted that, using this formulation gmpi values relative to subcortical leads are invalid. this is due to the normalization factor . using two sides of a given subcortical structure  is strongly dependent on the insertion direction of the lead. two electrodes coming from different but converging directions to the same structures  might yield different gmpi values because of the different cutting planes. we thus decided to include the labelling of contacts in volumetric parcellation, rather than simply using surface based atlases, to automatically classify pure white matter contacts that may be used as silent references for subcortical structures. these are defined as the contacts that are surrounded by only white matter fibers in the roi used in the brain zone detector.

user interface design
each module contained in seega has its own ui that allows user interaction with the implemented algorithms and the definition of parameters . since all modules have been implemented as 3dslicer extensions, the gui for each module  is based on the qt library. the cpe interface is divided in two parts . the former, cpe-configuration, allows the definition of the deetos path, while the latter, cpe-segmentation, consists of two drop-down lists for the selection of the appropriate inputs. once the fiducial has been chosen, a table is produced , where the user can select, for each electrode, the type/model and fix the cortex/tip points. the last drop-down list allows the user to choose from the ct volumes loaded in slicer. both the brain zone detection  and the gmpi computation interfaces  provide several drop-down lists, depending on the number of mandatory inputs, and the button that triggers the algorithm execution.

modules validation
in order to test the overall quality of seeg assistant, we used the three modules to process  <dig> seeg implants comprising  <dig> electrodes and  <dig> contacts. we also performed manual segmentation, as routinely performed in the clinical setting in a subset of  <dig> patients . these implants were performed at “claudio munari” centre for epilepsy surgery. the methodology routinely adopted to implant seeg electrodes and to post-process neuroimaging datasets has been described previously  <cit> . we initially ran the cpe module using the surgically planned entry and target points and default electrode models . we confirmed correct alignment of contact centroids with respect to the post-implant imaging dataset . to do this, we visualized the estimated contact centroids as spheres  of  <dig> mm diameter in the 3d view along with 3d meshes representing radiological artefact surrounding each contact . if all markups were contained within the corresponding artefacts we defined those contacts as being correctly segmented. on the other hand, we defined a contact as being incorrectly segmented if the corresponding centroid was estimated outside of the reconstructed radiological artefact or was not lying on the same axis as its neighbours.

to quantitatively evaluate the cpe accuracy, a gold standard for contact positioning must be defined, and the distance between real and estimated coordinates computed. however, in the clinical setting the position is visually assessed on post-implant imaging. this cumbersome task might lead to errors, in particular when electrodes are implanted along the cranio-caudal axis. furthermore, the resolution of our ct scanner is lower along the z axis, thus the radiological artefacts for each contact may become merged together . thus, computing euclidean distance between estimated and visually assessed channel positions may be inaccurate. for these reasons, we assessed cpe accuracy with two metrics based on the known physical properties of the implanted electrodes. we computed the distance of each contact from its estimated axis  and the mean inter-contact distances for each electrode  using automatic  and manual  methods. these two measures give a quantitative overview of the concordance between the reconstructed and the real electrode geometries. the former should be close to  <dig> mm since contacts should all lie on the same axis. in this case, we estimated the electrode axis by means of a linear interpolation of the contact positions, since the real axis is neither known nor exactly computable from just post-implant non-invasive imaging data. the second measure should be  <dig>  mm for most commonly used electrode models.

RESULTS
in this work we present seeg assistant, a 3dslicer extension designed to assist neurosurgeons in post-implant image processing of seeg implants. the proposed extension is composed of three modules that aim to  localize the position,  estimate the most probable cortical sources of the recorded signals, and  extract gmpi and volumetric labelling to enable later classification of white-grey matter contacts.

visual validation
we assessed contact position accuracy by visual investigation of segmented marker points overlayed on ct post-implant datasets . the cpe module produced correct segmentation in  <dig> %  of the cases with default settings only, i.e. using pre-implant information and no-corrections or fixed parameters. in the remaining , more complex cases, the cpe results required some manual corrections. for example, in cases where electrodes were in close proximity , the segmentation process required manual verification of the correct target point position  and fixing the tip point by checking the corresponding box. using this approach among the remaining leads,  <dig> %  of the cases were correctly localized by checking cortex/tip or both, while in  <dig> %  of cases the target point or the entry point were missing from the mf file.

quantitative analysis
in the absence of a ground truth to test performance against, we tested whether automatically defined contact positions reconstruct real electrode geometry more accurately than manually segmented ones. we assessed this by defining two measures namely the distance from each contact to its electrode axis and the inter-contact distance . we report that 95% of the automatically segmented contacts were less than  <dig>  mm from their axes . conversely, manual segmentation yielded higher variability and several outliers ≥  <dig>  mm . moreover, we tested whether the difference between automatic and manual distances were significantly  smaller than zero ) by means of a one tailed paired wilcoxon test. we report that the difference between automatic and manual distances from axes is statistically significant.
fig.  <dig> cpe module provides more accurate results compared to manual segmentation. a contact distances from axis are on average similar between manual  and automatic  segmentation. in general automatic segmentation performs better in keeping all contacts aligned to their axis. probability distribution shows that the paired differences of automatical and manual defined contact to their axis is signficantly  smaller than zero. as expected, manual segmentation yields higher variability and a larger fraction of outliers. b inter-contact distributions show gaussian-like distributions. probability distribution of paired difference of automatic and manually defined contacts shows that our method significantly  out performs compared to the manual case in representing real inter-contact distance. finally, automatic segmentation shows a smaller variability compared to manual segmentation




the majority of the contacts in the automatic estimation are  <dig>  mm± <dig>  mm apart from each other. the variability in the manual segmentation case is greater , and has several outliers with an inter-contact distance of more than  <dig> mm . the higher variability of the manual data could be easily explained by imprecision in discriminating channels in transverse electrodes. in fact, in these cases, radiological artefacts fuse neighbouring contacts as mentioned earlier. also in this case, we assessed statistical significance using a paired wilcoxon test. we subtracted the expected mean value of  <dig>  mm  from both populations  and . we applied the same statistical approach as above, testing whether automatic method yields inter-contact distance closer to the expected value p=pr. also in this case, the inter-contact distances are significantly smaller  from those obtained manually.

finally, the mean time necessary to complete an implant segmentation was 75± <dig> min and 15± <dig> s for manual and automatic segmentation, respectively. it is important to note that we did not record the time spent preparing the scenes  or pre-processing data  for each patient, since it is equivalent for both methodologies. thus, the reported average times are relative only to the average time required to run seega tools on a standard linux workstation with i7-core and  <dig> gb ram.

automatically localized implants accurately reflect their position relative to most probable pathological areas
moreover, the brain zone locator was tested with two different atlases, namely desikan-killiany  <cit>  and destrieux  <cit> . these atlases have different spatial resolution making a direct comparison impractical. we computed the parcellation coverage as the number of recording contacts from each parcel. we represented these values on top of inflated surfaces and as histograms . using both atlases, it can be seen that the most frequently sampled regions are located in frontal and temporal regions which are known to be the major sites for focal epileptogenic zones  <cit>  while posterior parts of the brain represent more rare cases  <cit> .
fig.  <dig> bzd estimates most probable electrical sources using volumetric atlases. a number of contacts recording from each parcel is shown on top of the inflated surfaces of the cerebral cortex. color code is shown in the color bar and represents the less  to most  sampled regions. two atlases have been used to test the algorithm: desikan-killeany  and destrieux . both atlases yields a similar spatial distribution. the existing differences can be due to the different parcel resolutions. b number of contacts from each parcel for both parc <dig> and parc <dig> are shown as color bar histograms divided between cerebral lobes. here similar patterns can be seen across atlases




seeg implants yield higher spatial sampling of grey compared to white matter
seeg assistant also estimates gmpi and volumetric labelling that can be used to determine which contacts are located in grey/white matter and their associated brain regions. generally, trajectory planning aims to position as many contact as possible in close proximity to pathological cortical and subcortical regions limiting the amount of contact recording from white matter . we computed the distribution of gmpi values for all the cortical channels – i.e. excluding those targeting subcortical regions . we report that the vast majority of cortical channels have gmpi greater than − <dig>  which indicates that many channels are actually recording within  or in close proximity to  the cortical ribbon. moreover, given the limitation of using gmpi only for cortical channels, in the current cohort the index is still valid in 97% of the cases. this index along with volumetric labeled contacts, are key features used in solving the issue of finding silent references for each cortical and subcortical channel. of note, at the moment seeg assistant does not classify grey/white channels but instead estimates the parameters used to solve the classification problem.
fig.  <dig> gmpi reflects channel position relative to cerebral cortex. a an mri inset is shown with atlas  and three meshes are shown representing hippocampus  amygdala  and pial  surfaces. segmented contact positions are represented as pink spheres centered in the estimated position. b this panel shows a zoom-in on the segmented contact plane where it can be seen the contact positions, the intersection between plane and subcortical structures . cortical sheet has been marked with brown color. the axis below shows that gmpi decreases while the shaft penetrates white matter fibers with increasing distance from cortical sheet. c probability  and cumulative  distributions of gmpi values across all cortical contacts




discussion
we introduce a set of tools to aid the post-surgery assessment of seeg implants. the provided tools are built as an extension called seega and are integrated in 3d slicer exploiting its advanced medical imaging processing capabilities. our set of tools enrich the collection of extensions of 3d slicer making it a perfect tool for surgical planning and post-surgery assessment. we preferred creating an extension to an existing software rather than a new stand-alone all-in-one tool, to allow users to define their preferred set of pre-processing steps. this ensures later extensibility and, we hope, a wider adoption of our software across centres rather than limiting the usability to the test centres.

the set of algorithms have been tested both qualitatively as well as quantitatively using a cohort of  <dig> and a subset of  <dig> seeg implants, respectively. we show that the cpe module correctly reconstructs contact positions in native scanner space of each patient in the vast majority of the cases without any supervision. our localization tool accurately segments contact positions with an error less than  <dig>  mm  <cit>  which is directly comparable to the image resolution of the testing cbct scanner and in line with that reported elsewhere  <cit> . of note, hebb and colleagues reported a smaller localization error but used a standard ct scanner with higher resolution while we used a cbct intra operative mobile scanner which has been proven to provide equivalent final accuracy  <cit> .

we also demonstrate that automatically reconstructed contact positions accurately reflect real electrode geometry such as inter-contact distances and distance from estimated electrode axis. moreover, these results are significantly more accurate than those manually defined even in complex cases.

this work adds significantly to the literature. other works exist to automatically or semi-automatically assess post-implant localization in intra-cerebral electrode implants. the vast majority attempt to solve a similar problem assessing the localization of grids/strips electrodes  <cit> . only a few studies deal with depth electrodes and most are used in deep brain stimulation  <cit> . in dbs, surgeons implants at most two electrodes targeting subthalamic nuclei  in the therapy of parkinson’s disease. published method exploits the simplicity of intracerebral implantation to build a fully automated localization algorithm. this approach is not suitable for our cases due to the many  multilead electrodes implanted during seeg investigations.

another work from princich and colleagues  <cit>  advances a methodological procedure to support post-implant leads labelling in seeg. their approach aims to ease and standardize the visual localization and identification of neighbouring anatomical brain structures. we advance their approach by enabling automatic localization and anatomical labelling using the same open-source set of toolboxes, namely freesurfer and 3d slicer. indeed, we present a tool to automatically label each channel in respect to the most probable neuronal source using probabilistic atlases. using such tool we show that the most frequently sampled brain areas are located in frontal and temporal regions which are known to be the major sites for focal epileptogenic foci  <cit> , while posterior parts of the brain represent more rare cases  <cit> .

CONCLUSIONS
in this work we present seeg assistant, a piece of software specifically designed to support neurosurgeons in post-seeg implant processing. we exploit an open-source paradigm, easily accessible and integrated interface connected to 3dslicer. our tool significantly eases the seeg post-implant analysis by drastically reducing the time required for segmentation and localization. our analyses show that automatic segmentation is significantly more accurate than manually extracted coordinates. furthermore, seeg assistant provides epileptologists with segmentation methods and brain region labeling, all included in an easily extensible and user-friendly interface. this tool may aid the clinical implementation of seeg data, by facilitating the interpretation of recorded brain activity. given the growing interest in seeg methodology, in both the clinical environment and the neuroscience research community, we believe that this tool provides an interactive user interface able to sensibly reduce time in accurately assessing post-implant seeg contact positioning relatively to neighbouring anatomical structures. finally, this tool can be used on a large cohort of historical data to extract the most frequent trajectories. these in turn can be used for initialising the search space in an automatic planning software.

abbreviations
bpbipolar

bzdbrain zone detector

cpecontact position estimator

ctcomputed tomography

eegelectroencephalography

ezepileptogenic zone

gmpigrey-matter proximity index

gmpiegrey matter proximity index estimator

guigraphical user interface

mfmarkups fiducial

mrimagnetic resonance imaging

roiregion of interest

seegstereo-electroencephalography

uiuser interface

