BACKGROUND
transcription factors  form molecular complexes that bind regulatory modules  within dna. many recent experiments attempt to decipher the code for transcription regulation, but despite experimental progress, the molecular code for transcription regulation remains an active area of research. because in vitro binding experiments do not mimic in vivo concentrations and conditions, computational approaches based solely on sequence data provide reassuring checks on experimental artefacts. in addition, computation is much less expensive than experimentation.

molecular complexes of tfs can contain subcomplexes  that bind to regulatory modules  in dna to perform important functions in human gene regulation . experiments often focus on subunits with broad regulatory functions such as non-specific initiation of transcription  <cit> . subunits coordinating tf regulation in relatively narrow sets of genes may also be biologically important, but they are probably most studied in experimental systems outside humans . in any case, such subunits must interact with similarly structured regulatory modules  specific to the set of genes. figure  <dig> illustrates that to form the rm for each gene, the transcription factor binding sites  within each rm must display tightly consistent positions relative to each other. in other words, the tfbss must co-localize within the rms.fig.  <dig> co-localization of transcription factor binding sites  within regulatory modules . the dna coordinate systems near  <dig> hypothetical genes  are shown oriented from 5′ to 3′ on the plus strand, as indicated at the bottom. the genes are aligned according to their tsss . within tf molecular complexes during transcription, rna polymerase ii and non-specific tfs  interact with dna in specific positions relative to the tss, with different specific tfs interacting with the tfbss  within rms. because the rms have similar structures , their tfbss have tight positional preferences relative to each other. in other words, the tfbss must co-localize within the rms




figure  <dig> illustrates some pertinent features of rms near the the transcriptional start site . it is deliberately simplistic in understating the variability of rms, non-specific tfs, rna polymerase ii, etc. in particular, it does not display at least three important biological complications. first, a gene may have multiple tsss; second, two tfbss may overlap; and third, the tbfss within an rm may not be adjacent.  nonetheless, fig.  <dig> usefully illustrates some consequences of subunits within tf complexes, when the subunits recombine promiscuously in tf complexes like domains in proteins, to coordinate the regulation of specific sets of genes.

figure  <dig> illustrates that subunits should influence tfbs positional preferences relative to the tss near the tss itself, e.g., the rightmost subunits over lines 1– <dig> appear in a single position, whereas the leftmost subunits over lines 1– <dig> and 8– <dig> appear in two positions. subunits may also interact with rms far from the tss, but intervening subunits may perturb the position of the corresponding rms relative to the tss, e.g., the leftmost purple triangles over lines 1– <dig> and 8– <dig> appear in two different positions. thus, tight positional preferences of some tfbss may reflect their co-localization with each other and with the tss.

on one hand, experimental results already confirm that some tfbss have positional preferences. for example, chromatin immunoprecipitation and high-throughput sequencing  revealed that many transcription factors have preferred positions and orientations in gc-rich, nucleosome-depleted, and dnase i hypersensitive regions  <cit> . similarly, the transcription factor yy <dig> has distinct activating and repressing functions  <cit> , the specific function depending on position relative to tss  <cit> . moreover, the relative order and exact position of adjacent tfbss within some rms determine specific activities within some systems  <cit>  such as the interferon enhanceosome  <cit> .

on the other hand, the extent to which tfbs positional preferences near the tss reflect co-localization within rms is unknown. accordingly, this computational study locates tfbss near the tss that have tightly consistent positions relative to each other, initially locating tf motifs with positional preferences relative to the tss. some computational studies find tfbss by identifying statistically overrepresented motifs near proximal promoters  or with positional preferences , or both  <cit> . because variations in the nucleotide composition near the tss can complicate finding tfbss by positional preference, at least one sequence study used a background model accounting for variation of dinucleotide compositions across regulatory regions  <cit> . the present study therefore identifies tf motifs with positional preferences relative to tss by combining all three considerations  into a single p-value described in the methods section.

by itself, detecting tfbss with positional preferences relative to the tss does not imply that the corresponding tfbss are co-located , unless the tfbss co-regulate the same gene. if they co-regulate, however, the tfbss co-occur more than they would by chance alone . thus, the presence of an rm enriches the intersection of the gene groups corresponding to every pair of its tfbss. figure  <dig> illustrates rms enriching the intersections of gene groups. in fig.  <dig>  genes 1– <dig> are all associated with both the rightmost  <dig> green triangles and rightmost  <dig> red circles; genes 8– <dig> are all associated with the leftmost  <dig> purple triangles and leftmost  <dig> yellow rectangles. figure  <dig> also illustrates that enrichment of gene-group intersections may also occur for pairs of tfbss in different rms, but more weakly than for tfbss in the same rm, e.g., only genes 1– <dig> are associated with both the  <dig> rightmost red circles in one rm and  <dig> purple triangles in another rm.

thus, for the initial step of detecting tf motifs with positional preferences with respect to the tss, we collected promoter regions in a block alignment without gaps, with the tsss aligned in a single column. our previous studies  <cit>  examined every oligomer of length  <dig> from the alphabet {a, c, g, t} for positional preferences relative to the tss. in contrast, this study examined every human tf in the jaspar database  <cit>  to detect sets of tf motifs with a tight positional preference relative to the tss. each significant set of motifs corresponded to a group of genes  <cit> . the web tool for the gene ontology database david  at http://david.abcc.ncifcrf.gov/ validated the biological functionality of each gene group, by using a  fisher exact test to compare each gene group to gene groups with known biological functions .

as noted above, the motifs corresponding to two tfbss co-localized in an rm should co-occur more than by chance alone, i.e., the presence of an rm enriches the intersection of gene groups corresponding to the two tf motifs. to detect enrichment of the intersection of gene groups corresponding to each pair of significant sets of motifs, we performed a right-tailed fisher exact test.

as described in the results, discussion, and conclusion sections, our statistical results show that in humans, most of the tight positional preferences of tfbss near the tss entail co-localization of tfbss with each other.

RESULTS
figure  <dig> illustrates that those motifs with a positional preference relative to the tss form clusters within the alignment columns. a small p-value for a cluster suggests that it contains tfbss with positional preferences relative to the tss. the methods section details the null hypothesis  of the cluster p-value. in its essence, for any given tf, h
 <dig> preserves the number and magnitude of the observed log-odds scores, but distributes them uniformly among the alignment columns. the log-odds scores themselves are the usual logarithm of a ratio, whose numerator is the product of position-specific probabilities , and whose denominator is a 3rd-order markov background probability .fig.  <dig> a cluster . each dashed horizontal line represents a sequence within our proximal promoter  database, aligned so that all tsss are in a single column. the dotted black horizontal line at the bottom represents the column coordinates within the alignment, running from −2000 bp to +1000 bp on the plus strand, as in fig.  <dig>  for any fixed tf , each solid vertical line indicates that the tf’s position-specific scoring matrix has a positive score, corresponding to a subsequence we call a “motif”. each motif has a motif width, so for computational convenience we assigned the motif’s position and score to its 3′ base . the top sequence, e.g., displays one motif as a horizontal dotted blue line; and the motif’s positive score, by a vertical solid red line at its 3’ base. fig.  <dig> illustrates each positive score twice, once on top of its sequence, and vertically below once again on top of the column coordinates 




as illustrated in fig.  <dig>  clusters are sets of tf motifs with statistically significant positional preferences relative to the tss. to facilitate reproduction of our calculations, the results give all p-values without any multiple test correction. we applied statistical tests to the intersections of clusters we considered significant: different p-value thresholds would lead to different multiple test corrections. to account for our multiple test protocols, therefore, before giving uncorrected p-values, the text also gives the p-value thresholds required for a significance level α =  <dig>  under the bonferroni correction  <cit> . in contrast, all validating david p-values include david’s bonferroni correction, thereby accounting directly for the fixed number of biological functions that david examined.

validation of the tss position in the ppr database
our alignment appeared to anchor the tss accurately , because figure s <dig> in the results section of the additional file  <dig> shows an upward spike in tpa composition and a downward spike in transposable element density near the column of the putative tss.

significant clusters and their validation by the david
at α =  <dig> , the bonferroni correction for multiple tests on  <dig> tfs and  <dig> dna strands yields a cluster p-value threshold p =  <dig> / =  <dig>  × 10−  <dig>  of the  <dig> tfs in our jaspar database,  <dig> tfs yielded  <dig> clusters from the ppr database significant at p ≤  <dig>  × 10−  <dig>  in contrast, our negative control with the random database  yielded a single cluster with p ≤  <dig>  . the si describes another negative control with the random database with offsets, which yielded no cluster with p ≤  <dig> . at threshold p ≤  <dig> , 53 × 2 × 2 =  <dig> tests yield an expected 212 ×  <dig>  =  <dig>  false positives for a uniformly distributed p-value, indicating that with just its single false positive cluster, our cluster p-value is extremely conservative.

table  <dig> displays the  <dig> significant clusters on the plus strand; table  <dig>  the  <dig> significant clusters on the minus strand. figure  <dig> illustrates some terminology in the tables. as mentioned in fig.  <dig>  for computational reasons, fig.  <dig> assigns position and score to a motif’s 3′ base . the maximal segment at the bottom of fig.  <dig> corresponds to a motif cluster. the left red vertical segment in the cluster corresponds to position from in the tables; the right, to position to. the cluster’s spread is the difference between position from and position to plus one.  in fig.  <dig>  the bottom short-dashed red line contributes three motifs to the cluster, so it contains two multiple motifs.table  <dig> significant clusters on the plus strand





for each significant cluster, the tables give the tf and its  cluster p-value. they report the smallest david p-value for each cluster, bonferroni-corrected to account for the number of biological functions that david examined. because david p-values are only for validation, and are therefore already conditional on a multiple-test corrected cluster p-value, they require no further multiple-test correction. as indicated in tables  <dig> and  <dig>  by being bonferroni-corrected, the david p-value also provides an upper bound on the false discovery rate . each of the  <dig> significant clusters corresponds to a gene group, and david independently validated 42/ <dig>  gene groups with fdr <  <dig>  .

figure  <dig> illustrates that as a typical cluster moves away from the tss, biological noise should randomly perturb motif positions relative to the tss, thereby impairing cluster detection. in accord with this expectation, all significant clusters in the ppr database had “to” positions between − <dig> and 23 bp, near the tss.

eight tfs  had two significant clusters; three tfs  had three; and two tfs  had four. to identify clusters uniquely, we join the tf, position from, position to, and the strand  with colons. thus, nfkb1:+7:+11:– is the nfkb <dig> cluster from + <dig> to +11 bp on the minus strand. similarly, gabpa:–24:–20:+ is the gabpa cluster from − <dig> to −20 bp on the plus strand.

the si describes our measures of tfbs information content, reverse palindromic tendencies, and gc content. the only significant clusters with spreads exceeding 10 bp were e2f1:+11:+23:–, elk4:–27:+1:–, rreb1:–1:+18:–, sp1:–78:–36:+, and sp1:–106:+23:–. the corresponding transcription factors  have neither unusual information content nor unusual reverse palindromic tendencies, but the gc-content of their jaspar count matrices ranked highly among the tfs studied , suggesting their length might be an artefact of the high gc-content in proximal promoters. david p-values strongly validated the clusters’ biological functionality, however:  <dig>  × 10− <dig> ,  <dig>  × 10− <dig> ,  <dig>  × 10− <dig> ,  <dig>  × 10− <dig>  and  <dig>  × 10− <dig> . thus, although the unusually wide clusters have gc-rich count matrices, they appear biologically functional.

like composition, tandem repeats can also cause artefactually low cluster p-values, because the null hypothesis underlying the cluster p-value assumes independent motif positions. to evaluate repetitive artefacts, we examined tf logos in motifmap  <cit> , but few  displayed obvious periodicities. a sequence with n motifs contains n– <dig> multiple motifs that might contribute to repetitive artefacts, however, so beyond david’s validation, we evaluated repetitive artefacts with:  the fraction of motifs that were multiple motifs; and  cluster spreads .

other computations found homotypic clusters in human and other vertebrate genomes for all five significant clusters whose spreads exceeded 10 bp  <cit> . experiments also support the biological importance of sp <dig> homotypic clusters  <cit> . all five clusters had high multiple motif fractions, between  <dig> and 82%, consistent with a biological functionality for their homotypic clusters.

of the remaining  <dig> significant clusters, only one has a validating david p-value p >  <dig>  . e2f1:5:5:+ has spread  <dig>  so tandem repeats make no contribution to its cluster p-value. tandem repeats are therefore unlikely to have an essential influence on significant clusters having spreads of 10 bp or less.

the intersection of cluster gene-groups
as illustrated in fig.  <dig>  biological co-functionality of tfs can enrich the intersection of the corresponding gene groups. accordingly, the right-tailed fisher exact p-value tested the  <dig> *  <dig> / 2 =  <dig> intersections of pairs of the cluster gene-groups for enrichment. the left-tailed fisher exact test provided a successful negative control on the right-tailed test: no p-value was significant. surprisingly, however, only one uncorrected left-tailed p-value was less than  <dig> . the expected number of uniformly distributed p-values less than π is 903π, i.e., 903 ×  <dig>  ≈  <dig> for p ≤  <dig> . the discussion section and si conclude, however, that our ppr database has biases in the genes it contains, artefactually but harmlessly reducing the number of p-values p ≤  <dig> .

in contrast, the right-tailed p-values displayed a full range of values, from  <dig>  to  <dig> . at α =  <dig> , the bonferroni correction for multiple tests involving  <dig> pairs yields a threshold p =  <dig> /903 =  <dig>  × 10−  <dig>  under the correction, the right-sided fisher exact test declared 768/ <dig>  of the cluster-pairs significant at α =  <dig> . david validated 564/ <dig>  of the significant cluster-pairs with p ≤  <dig> .

on theoretical grounds, we suspected that our cluster p-values were very conservative. to verify the suspicion empirically, we examined a superset of the  <dig> clusters consisting of  <dig> clusters with an uncorrected cluster p-value of p ≤  <dig> , to determine the fraction of intersections with significant fisher p-values and their validation by david. at α =  <dig> , the bonferroni correction for multiple tests involving  <dig> *  <dig> / 2 =  <dig> pairs yields a threshold p =  <dig> /2145 =  <dig>  × 10−  <dig>  under the bonferroni correction, the right-sided fisher exact test declared 1374/ <dig>  of the cluster-pairs significant at α =  <dig> . david validated 869/ <dig>  of the significant cluster-pairs with p ≤  <dig> . thus, the superset of  <dig> clusters had many intersections with significant fisher p-values validated by david.

figure  <dig> summarizes qualitatively the patterns of significance and validation for the superset, given in full in additional file  <dig>  to aid experimental biologists in examining results for particular tfs, however, our results are available on the web in a user-friendly form at http://go.usa.gov/3kjsh. as noted above, our cluster p-value is extremely conservative, and validation with david p-values indicates that even some clusters with p ≈  <dig>  have biological functions. the file intersection_p-values.xlsx in the si therefore contains a complete table of right-sided fisher exact p-values for all clusters whose uncorrected cluster p-value p ≤  <dig> . because of their number, the discussion section can examine only a few intersections explicitly.fig.  <dig> a graphical summary of p-values in the si for gene-group intersections. the two matrices display the p-values for the gene-group intersections in graphical form. the matrices correspond to the two tabs in the si file intersection_p-values.xlsx . the matrices omit their upper triangle, because they are symmetric. they also omit their diagonal, because it corresponds to the intersections of each gene group with itself. in each matrix, each of the  <dig>  rows corresponds to a single gene group in the si. in the si and in fig.  <dig>  each gene-group corresponds to an uncorrected cluster p-value p ≤  <dig> .  the row order in each matrix follows the si, where the sort is primarily alphabetical on the tf and then on the p-value. the magnitudes of the fisher exact p-values for the gene-group intersections are in shades of gray: black indicates  <dig> ; white,  <dig> ; and 50% gray, the threshold for significance at α =  <dig> . for the fisher exact test p-values, the threshold is p =  <dig>  × 10−  <dig> after the present article’s multiple correction; for validating david p-values, p =  <dig> . the font for the  p-values is 50% gray, making gray on black significant; gray on white, not significant; 50% gray, borderline significant, etc. each of the  <dig> white entries in the david matrix indicates a p-value that david censored because the gene-group intersection was too small




discussion
a subunit within a tf complex interacts with dna at an rm containing tfbss with tight positional preferences with respect to one another . if the rm has a positional preference relative to the tss, the preference propagates to the tfbss in the rm. some tfbss have tight positional preferences relative to the tss, but the fraction of these tfbss associated with co-localization in rms is unknown. our methods found  <dig> significant sets of tf motifs with positional preferences relative to the tss . only five clusters lacked a tight positional preference . note that a statistical method using broad bins  <cit>  would likely be unsuitable for detecting an rm with tight positional preferences.

each motif cluster corresponded to a group of  <dig> to  <dig> genes, so each gene group contained  <dig>  to  <dig> % of the  <dig> genes in our ppr database. the corresponding numbers for tight clusters were  <dig> to  <dig> genes . when predicting tfbss with tf motifs, false positives are more common than false negatives. moreover, the methods subsection, “a cluster probably includes most tfbss within its columns as motifs,” shows that false negatives are likely rare within motif clusters. the percentages given are therefore larger than their probable true values, justifying calling at least some gene groups a “specific set of genes”.

tight positional preferences relative to the tss do not imply that two tfbss have a biologically functional tight positional preference relative to each other, unless the tfbss co-regulate the same gene. as figs.  <dig> and  <dig> illustrate, motifs corresponding to two tfs in an rm should co-occur more than by chance alone, however, enriching the intersections of the corresponding gene groups. thus, a gene-group intersection systematically enriched beyond chance alone provides evidence that the two tfs participate in an rm. using the  <dig> gene groups corresponding to the  <dig> significant clusters, a right-tailed fisher exact test found that  <dig> pairs of gene groups had significantly enriched intersections.

an analysis of gene ontology using david validated the biological functionality of many significant gene groups, sometimes with false discovery rates less than 10− <dig>  in addition, david validated many intersections of gene groups. on one hand, some tf studies have validated their results with the same experimental tf sites that contributed to the count matrices used for discovery. in contrast, david p-values validated significant clusters and their intersections, making validation here independent of discovery.

the results in the present computational study therefore incidentally  support the existence near the tss of rms coordinating the regulation of specific sets of genes. gene duplication and convergent evolution provide obvious biological mechanisms for generating the rms. to facilitate further experimental discovery of such rms, biologists can mine the user-friendly interface at http://go.usa.gov/3kjsh, to trace tf interactions corresponding to significantly enriched intersections and thereby to discover candidate rms.

many computer programs predict tfbss . some programs focus on sequence pattern , particularly early programs . several exploit combinations of motifs, but not consistent positioning . programs based on hidden markov models can discover tightly organized rms, but few such programs exist . instead, most newer programs combine phylogeny and possibly other information with tfbs patterns, either with consistent positioning  or without it . programs searching a single genome for the consistent positional preferences within rms are therefore surprisingly rare  <cit> .

notably, all our significant clusters occurred within about 40 bp of the tss. the absence of significant clusters distant from the tss tends to deny the existence of rms distant from the tss but with tight positional preferences relative to it. .

the  <dig> significant clusters yielded  <dig> pairs of gene groups with significantly enriched intersections. the present article cannot examine every significant intersection, but the narrow, scattered results below suggest that specialists might find results in the si and at the url http://go.usa.gov/3kjsh interesting. although the artefact in the previous paragraph influences left-sided fisher exact p-values, david validation of gene-group intersections indicates that the artefact had no essential effect on the right-sided fisher exact p-values.

at http://go.usa.gov/3kjsh, by clicking radio buttons for ets <dig> and gabpa, and then clicking “submit”, we find that ets1:+7:+8:– has cluster and validating david p-values of  <dig>  × 10− <dig> and  <dig>  × 10−5; gabpa:+7:+8:+, of  <dig>  × 10− <dig> and  <dig>  × 10−5; their intersection, fisher exact and validating david p-values of  <dig>  × 10− <dig> and  <dig>  × 10− <dig>  the extraordinarily small p-values indicate with remarkable surety that:  the two tf motif clusters ets1:+7:+8:– and gabpa:+7:+8:+ correspond to tfbs clusters; and  the bidirectional tfbs clusters interact biologically. in fact, the literature confirms the conclusions. gabpa redundantly occupies ets <dig> tfbss in promoters of housekeeping genes, whereas ets <dig> specifically occupies the ets <dig> tfbss in enhancers of t cell-specific genes  <cit> . moreover, a p <dig> mutant preferred binding to the bidirectional promoters if several ets <dig> and gabpa tfs were bound nearby  <cit> . interestingly, gabpa has another significant cluster on the opposite strand near gabpa:+7:+8:+: gabpa:+7:+15:– has cluster and validating david p-values of  <dig>  × 10− <dig> and  <dig>  × 10−5; the intersection of gabpa:+7:+15:– and ets1:+7:+8:–, fisher exact and validating david p-values of  <dig>  × 10− <dig> and  <dig>  × 10− <dig>  thus, the unidirectional pair gabpa:+7:+15:– and ets1:+7:+8:–, though much less striking than the bidirectional pair previously mentioned and apparently unknown, probably also has biological functions.

sp <dig> motifs provide general transcription signals near tsss. indeed, a colored table in the si highlights their enriched intersections with many other tf motif clusters, graphically displaying the striking promiscuity of the two sp <dig> motif clusters in tables  <dig> and  <dig>  our statistical methods tuned their single adjustable parameter, so that most significant motif clusters had tight positional preferences relative to the tss . the absence of broad bins  suggests that motif clusters like the sp <dig> clusters, whose spreads are unusually broad , have biological functions distinctly different from participation in an rm  <cit> .

at http://go.usa.gov/3kjsh, by clicking radio buttons for sp <dig> and e2f <dig>  and later sp <dig> and ets <dig>  we find that the sp <dig> clusters had several significant intersections with both e2f <dig> and ets <dig>  experiments supported e2f-sp <dig> interactions near: dihydrofolate reductase in chinese hamster  <cit> , dihydrofolate reductase in human osteosarcoma  <cit> , fibroblast ctp:phosphocholine cytidylyltransferase in mouse embryo  <cit> , thymidine kinase in mouse  <cit> , rip <dig> in human  <cit> , cdkn2a  <cit> , hmga <dig>  <cit> , mycn  <cit> , and cdkn2c  <cit> . they also supported ets-sp <dig> interactions near the runx <dig> p <dig> promoter  <cit> , pai- <dig>  <cit> , itga <dig>  <cit> , and npr <dig>  <cit> .

CONCLUSIONS
our statistics found  <dig> significant sets of human motifs in the jaspar tf database with positional preferences relative to the tss, with  <dig> preferences tight . each set of motifs corresponds to a group of genes. of all intersections of these  <dig> significant gene groups, 768/ ≈ 85% were significantly enriched with 564/ <dig>  intersections independently validated by david with fdr <  <dig> . the co-localization of tfbss within rms therefore likely explains much of the tight tfbs positional preferences near the tss.

methods 

fig.  <dig> an overview of the workflow in the methods. primary data sources appear as yellow boxes; the derived data, as blue boxes. the black arrows indicate the primary workflow, with bordered grey arrows indicating ancillary contributions. the pink box contains the workflow for the primary negative control; the green box, the validation workflow, with its grey arrows indicating validation steps. all p-values shown are uncorrected. the p-values on the right all retained significance at α =  <dig>  against multiple-test corrections. the materials and methods section gives details




the ppr and random databases
the publicly available database of transcriptional start sites   <cit>  provided about  <dig>  million experimentally characterized 5′-end clones from full-length human cdnas. the experimental clones corresponded to  <dig>  transcription start sites . because of alternative tsss, the experimental tsss corresponded to  <dig>  human refseq  <cit>  genes. our “ppr database” of proximal promoter regions  initially contained every refseq tss within ±1000 bp of the start of an annotated refseq gene transcript. if several refseq tsss were within ±1000 bp of the same start, we discarded all but the refseq tss closest to the experimental tss. henceforth, “tss” refers solely to the remaining refseq tss. we aligned the corresponding pprs in dbtss to the human genome .

standard nomenclature designates the two strands as “plus”  and “minus” . in the following, coordinates in bp correspond to the numbering on the plus strand, with positive bp indicating the 3′ direction from the tss; negative bp, the 5′ direction. the standard coordinate system places the tss at +1 bp; the next base in the 5′ direction on the plus strand, at −1 bp.

as in previous studies  <cit> , if a ppr mapped unambiguously, we extended it to include 3001 bp, with coordinates − <dig> to −1 bp and + <dig> to +1001 bp; otherwise, we discarded the ppr  <cit> . we also discarded replicate sequences and sequences containing nucleotides outside the unambiguous alphabet {a, c, g, t}, leaving  <dig>  sequences.

we formed a  block alignment by anchoring the 3001 bp of each of the  <dig>  ppr sequences on the corresponding tss, i.e., we placed each putative tss in alignment column  <dig>  after discounting alternative tsss and alternative splices, the  <dig>  ppr sequences corresponded to  <dig> distinct genes. as a negative control, we also extracted  <dig>  sequences from the human genome , one for each of the sequences in the ppr database. chosen independently and uniformly at random, each sequence had length 3001 bp. the corresponding  <dig>  random sequences constituted our “random database”.

the ppr database contained  <dig>  sequences but only  <dig> genes, so many of its sequences overlapped with each other. although the random database does not control for overlaps in the ppr sequences, the additional file  <dig> describes an extra, unusually elaborate negative control, the “random database with offsets”, which we constructed to rule out spuriously low p-values due to sequence overlaps.

jaspar count matrices
we then extracted  <dig> count matrices labelled “species homo sapiens” from the jaspar database of transcription factor binding sites  <cit> . the si details the following calculations, which we performed for each of the  <dig> tf matrices from jaspar.

local sum statistic for detecting tfbss with positional preferences
at each position within each sequence of the ppr database, we calculated a log-odds score for the presence of a tf motif. for the null hypothesis, we re-estimated background probabilities every  <dig> columns from a 3rd-order background markov model fitted to a window of length 50 = 23 + 21 + 3 +  <dig>  the number  <dig> is the difference between  <dig>  and a sum corresponding to the maximum length  of a jaspar count matrix , plus the letter-triples before  and after  a putative site. the letter-triples are required to calculate the site probability under a 3rd-order markov model accounting for sequence context on both sides of a site. . now, fix the tf under discussion. for the alternative hypothesis of a tfbs, we calculated model probabilities from the jaspar count matrix for the tf and a non-informative dirichlet prior . the sum of the log-odds scores within each column of the block alignment scored the column for the presence of the tf motif. negative sums were ignored by setting them to  <dig>  yielding scores x
i >  <dig> 

for consistency with previous notations, let the segment . given the “global sum” s
i = ∑j = 1i = ∑j = 1i
x
j − ig, define the “segmental sum” s
 karlin-altschul statistics  <cit>  provide p-values to evaluate the statistical significance of the local scores Ŝ
j = s
 cluster” whose score equals the sum of the contributing motif scores.  the motifs in the cluster determine a “gene group”. in fig.  <dig>  e.g., each motif in the maximal segment corresponds to a gene, namely, the sequences corresponding to short-dashed red lines.

a cluster probably includes most tfbss within its columns as motifs
this assertion fits into the flow of the discourse here, although it is important only in the discussion section. by definition, a tf motif is a subsequence with positive score x
i >  <dig>  the cluster therefore includes every tfbs with a positive score x
i >  <dig> within its columns . the log-odds scores x
i derive from jaspar count matrices; the matrices themselves derive from experimental tfbss. thus, each tfbs has a positive score x
i >  <dig>  unless it has a sequence pattern inconsistent with other, experimentally derived tfbss. by definition, such inconsistency is rare, whenever most tfbss have a consistent sequence pattern. consequently, most genes  regulated by tfbss at positions corresponding to a cluster contribute motifs to the cluster.

choice of the gap penalty g
thus far, g has been arbitrary. now, for each tf, we normalize g by the tf’s average score per column s¯=n−1sn. thus, g=ρs¯, where the factor s¯ is tf-specific, but all tfs share the arbitrary parameter ρ. the normalized gap penalty ρ then controls the spread of all tf clusters simultaneously, as follows. as in local alignment  <cit> , extreme-value statistics pertain in a logarithmic regime  . moreover, the cluster spreads decrease as ρ increases . in accord with the biological aims expressed in the legend of fig.  <dig>  to infer that a typical significant cluster corresponds to the tight positional preference of a tfbs within a rm, the typical cluster spread should be no more than  10 bp . empirically, we found that such spreads corresponded to a normalized gap penalty of about ρ =  <dig> . the si details the exploratory process leading to ρ =  <dig> . the resulting clusters were relatively robust against perturbations ρ =  <dig>  ±  <dig> .

david web tool for evaluating the biological function of a group of genes
the david web tool version  <dig>   at http://david.abcc.ncifcrf.gov/ provides a modified fisher exact test to validate the biological functionality of a gene group by comparing the gene group to gene groups with known biological functions . our “david dataset” represented each cluster’s gene group as a set of refseq np numbers, uniqued so that each gene corresponded to exactly one refseq np.

the genes in dbtss have biases  that could propagate to the ppr database and thence to our david dataset. to mitigate biases, therefore, we used the david dataset  as the universe of genes under consideration when:  david assessed our clusters’ functionality, and  the fisher exact test assessed the enrichment of the intersections of cluster gene-groups. fig.  <dig> an rm enriches the intersection of two gene groups. a hypothetical rm  is illustrated, similar to an rm in fig.  <dig>  the rm contains three tfbss, corresponding to an orange rectangle, a green triangle, and a red circle. the “red circular tf” yields motif scores  corresponding to the maximal segment and motif cluster shown in fig.  <dig>  like the red circular tf, the green triangular tf yields its own motif scores . not every “red” or “green” motif corresponds to a tfbs in the rm, but nonetheless, the rm enriches the intersection of the two cluster gene groups 




fisher exact tests of intersections of cluster gene-groups
a right-tailed fisher exact test assessed whether pairs of cluster gene-groups had an unusually large intersection, suggesting possible enrichment by an rm . we used the left-tailed test as a negative control . the results section describes our  <dig> significant clusters. because their 43 × 42/2 =  <dig> intersections are so numerous, we relegate the complete report of their right-tailed fisher exact and their david p-values  to the si. the p-values are also available through our user-friendly interface at http://go.usa.gov/3kjsh. to achieve significance level α =  <dig> , the fisher exact tests needed to yield p ≤  <dig> / =  <dig>  × 10−  <dig> 

additional files

additional file 1: contains supplementary methods, results, and discussion. 


additional file 2: contains the intersection p-values diagrammed in fig.  <dig>  




abbreviations
pprproximal promoter

rmregulatory module

tftranscription factor

tfbstranscription factor binding site

tsstranscription start site

