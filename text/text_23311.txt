BACKGROUND
gene and protein regulatory networks depict the regulatory circuitry that controls the complicated biological processes. the regulatory networks enable visualization and identification of protein and gene functions that cannot otherwise be revealed by a gene- or protein-centric approach. through revealing various system level interactions including transcription regulation, signal transductions, and metabolic reactions, regulatory networks provide insights into the molecular machinery of cell. the systems perspective also reveals global regulatory properties of cell including functional modularity and robustness to perturbation. regulatory networks are also at the heart of personalized medicine, where they serve to aid disease diagnosis and prognosis, drug target discovery, intervention, and prediction of pharmacological effects  <cit> .

reconstructing regulatory networks comprises one of the most active areas of research in computational biology. the goal of network construction is to elucidate the gene/protein interaction relationships, in an effort to obtain more realistic and predictive models of molecular regulation. this prompts us to study the complex patterns of regulatory network that depend on temporal and condition-specific context.

regulatory networks are specific to exogenous context
since gene or protein in the network can acquire different functions under different exogenous conditions or phenotypic contexts, the network constituents and interactions would be context dependent, i.e., regulatory network is composed of different genes and proteins under different conditions and their interactions are specifically determined by the context. for instance, the oncogenes such as myc, erk, and wnt are known to down-regulated in normal cells. up-regulation of oncogenes leads to a series of modification in signal transduction and transcription regulation, which interfere with the controlled cell death and eventually turn the normal cell into cancer cell. therefore, the revelation of context-specific differences of regulatory network in cancer is essential for understanding the process and mechanism of cancer. in fact, the context-dependent regulation accounts for the heterogeneity of diverse cell phenotypes.

regulatory networks are time varying according to the endogenous cell states
while the long run behaviour of regulatory networks is often stationary, the transient characteristic is intrinsically time varying for they need to respond and adapt themselves to the new exogenous condition. temporal dynamics of regulatory networks is highly prevalent to many important processes such as cell cycle, cell differentiation, apoptosis, and viral infection to account for different endogenous cellular states. even under a fixed exogenous condition, the regulation of genes and protein are carried out in a temporal, sequential manner. the cell cycle is known to have multiple stages and transitions in between and are triggered and guided by temporal changes of regulatory networks. some of the transcription factors such as fos are known to be early genes because they regulate commonly at the early stage of a biological event. it is also well recognized that the regulatory pathway does not always persist over all times. such temporal cascade of regulation is essential for elucidating the mechanism leading to different phenotypes. the two key characteristics of time-varying networks include 1) the temporal topology of regulatory networks, i.e., the network constituents and wiring could change with time, and 2) time-varying regulatory impact. it is important and necessary to understand both aspects of temporal regulation when reconstructing the time varying networks.

existing network models and approaches are insufficient for inferring context-specific time-varying networks.
reconstruction of regulatory networks based on high throughput data is currently a research focus in systems biology. in the past, a large number of different network architectures have been proposed. one of the most popular architectures is the molecular-based network architecture, where nodes are individual genes or proteins and links denote gene-gene, gene-protein, or protein-gene regulations. this architecture aims to reveal the detailed genomic interaction and is capable of uncovering transcription regulation, signalling, and metabolic pathways. however, the quality of the inferred molecular-based network is greatly restricted by the limitation of data availability and data quality; in practice, precise inference of large scale networks at a molecular level is very difficult and not robust due to the large number of the unknowns and limited and noisy genomics or proteomics data. the reconstructed networks normally have extremely high false positive links, making the subsequent analysis and interpretation at a molecular level difficult and unreliable. a common remedy to this problem is to take a global view of the networks and study the features such as scale free and modularity. although this approach has been successful in revealing global properties of molecular networks, it is still unable to identify pathways as intended by this architecture. an alternative and equally popular architecture is the module networks  <cit> . since nodes in a module network are clusters of genes, or modules, the inference task for module networks is less demanding and higher quality inference can be achieved. however, module networks cannot directly uncover functional pathways even with high quality data and thus are often difficult to interpret biologically. post-processing based on gene ontology  or pathway enrichment is required to reveal the possible functions of each modules. however, the module networks cannot reveal beyond the prediction that a set of functions of a modular would regulate another set in another module. this prediction is useful for pointing out the possible further studies to follow; it is nevertheless far from sufficient to uncover important pathways and transcription regulations. apparently, a new architecture that is robust to data noise and capable of revealing directly pathways will be much more appealing.

given a network structure, a mathematical or statistical model needs to be imposed to model the dynamics of regulation. many models have been proposed for this purpose including ordinary differential equations  <cit> ,  boolean networks  <cit> ,  <cit> , information theory based models  <cit> . however, the principled assumption underlying these models is overwhelmingly stationary; that is the dynamic models do not change over time. while the long run behaviour of regulatory networks is reasonably considered stationary, the transient characteristic is intrinsically time varying for they need to respond and adapt themselves to meet the need of varying conditions. as a result, the inferred networks based on stationary assumption conceal the intricate temporal regulatory patterns. despite the prevalent temporal nature of regulatory, limited work exists to model and infer the time varying network and they include regime state space model  <cit> , temporal hidden markov model  <cit> , the wavelet dynamic vector autoregressive method  <cit> , and context-sensitive probabilistic boolean networks  <cit> . these models all involve a high degree of parametric complexity that hinders robust reconstruction of large scale networks. for instance, context-sensitive probabilistic boolean networks in  <cit>  and regime state space model  <cit>  involved only  <dig> and  <dig> genes, respectively. alternatively, module networks were assumed in  <cit>  to increase the inference robustness but nevertheless reduce the interpretability of result. some remarkable results about systems level reconstruction of both static and transient transcription regulatory networks of yeast for different cell states were reported in  <cit>  .the networks inference utilized a large collection of prior knowledge and a simple model of differential expression in microarray. however, specific time regimes for cell states of interest need to be given; the approach cannot further uncover by itself endogenous temporal patterns within the given regime. in addition, the adopted gene networks architecture is sensitive to data noise and prone to producing false positive links.

aside from modelling network dynamics, investigation of the context-specific networks is given increasing attention, although the main body of existing work still concerns the reconstruction of context-independent networks. to this end,  <cit>  explicitly introduced a context node in the bayesian network model to model different context condition. go annotations were applied in  <cit>  to the protein-protein interaction  network of yeast to dissect the context -specific subÂ¬networks. again, in  <cit> , large scale transcription networks under different exogenous conditions were constructed for yeast. despite some success in identifying context-specific network motifs and transcription factors, the results were not robust and unreliable at the molecular scale due to the molecular-based network architecture..

to sum up, making robust statistical inference from diverse types of genomic data to discover context-specific and temporal pathways of biological function presents a formidable challenge. the current network architectures and approaches are insufficient for this goal. the main issue is that the network architecture, model, and inference approach cannot produce robust network inference that can be easily understood.

towards a pathway-centric network model and functional enrichment inference approach
to overcome the problems of existing network architecture, model, and inference approaches, we advocate a new pathway-centric network  and an enrichment inference approach. the nodes of the pathrnet are regulators such as transcription factors  ,pathways including signaling pathways and metabolic pathways, and the links bear specific functional meaning, i.e., a link going from tf to pathway defines the transcription regulation of pathway by tf and a link from signaling pathway to tf suggests signal transduction induced modification of tf. the advantages of this model architecture are in four folds. first, this network design is geared directly to biologists, who normally focus on specific pathways and regulators when designing experiments and seeking answers to phenotypic outcomes. secondly, pathrnet speaks the language of biologists and no interpretation is even needed for the results. unlike in most of gene or protein networks, where links only imply a degree of association and hence further interpretable is needed, in pathrnet, the linkage such as signaling pathway a -> tf b -| metabolic pathway c reads naturally as signaling pathway a activates tf b, which further inhibits metabolic pathway c. thirdly, past research has produced considerable data about pathways and transcription regulation, and it is prudent and necessary to understand their regulatory roles in different context before new pathways and regulations can be inferred. fourthly, pathrnet is more robust to data noise. since nodes are pathways instead of individual genes, pathrnet inherits the robustness of module networks; given these advantages, we believe that pathrnet can adequately address the aforementioned deficiency of the existing network architectures.

to robustly infer the context specific structure and its temporal dynamics of pathrnet, we propose the pathway enrichment analysis of temporal regulatory networks or pattern. the key of pattern is the method of the enrichment based time dependent clustering algorithm, ectdisa  <cit> , which identifies temporal clusters of pathways and regulated gene sets that are enriched in a context-specific time series microarray data. once again, the inference in pattern moves away from the gene-centric approach to the pathway or gene-set enrichment based concept. the gene set enrichment  concept formulated by the gsea algorithm  <cit>  has gained great success in differential analysis of gene expression data and also extended its applications to drug effect prediction and clustering of coregulated gene. the main advantages of gse approach are 1) the inference is robust to excessive noise on one or a few genes in the gene set, and 2) the result has straightforward biologically implications since gene sets are mostly pathways or coregulated genes. recalling the previously mentioned problems of current inference approaches for network reconstruction, we see that these advantages of gse are the exact answers to these problems. however, gse has not been used for network construction. it is thus our objective to develop an enrichment approach for network reconstruction. coupled with pathrnet, the gse approach will provide added robustness to inference, enabling reliable discovery of network temporal dynamics from noisy microarray data of commonly small sample size.

methods
overview of our approach
the block diagram of our approach pattern is shown in fig.  <dig>  it has a modular structure including four modules. in module  <dig>  pathway data and tf regulated gene sets data from the existing knowledge database are assembled to construct a generic pathrnet. to construct the network, only two types of directed links are allowed, i.e., a link from a signaling pathway node to a tf node is placed if tf is in the downstream of the signaling pathway and a link from a tf node to a signaling or a metabolic pathway is placed if the tf regulated gene set contains genes in the pathway. the resulting pathrnet is a generic network that represents the prior knowledge of regulation under variety of different contexts. in module  <dig>  context-specific microarray data is introduced and the context-specific pathrnet is obtained by a functional enrichment strategy. particularly, ectdisa  <cit>  is applied to determine the enrichment of each node in the generic pathrnet in the time series microarray data and the nodes that are not enriched will be deactivated. furthermore, ectdisa also determines the temporal expression pattern  of each node. in module  <dig>  regulatory pathrnet is constructed to depict the regulatory relationship of nodes based on the expression pattern obtained in module  <dig>  inference is carried out to determine the presence of links and their regulatory impact. as a result, a  regulatory pathrnet will be obtained. in module  <dig>  temporal regulatory impact of network during each time period is further analyzed, resulting in a temporal landscape of pathrnet dynamics.

we discuss next the proposed methods for implementing each module.

generic pathrnet construction
a generic pathrnet is first constructed based on the existing knowledge database. the prior knowledge databases are collected from nci-nc  <cit>  ,transfac  <cit>  and msigdb  <cit> . a generic pathrnet is constructed with each node corresponding to a signaling pathway, a transcription factor or a metabolic pathway; and an edge is placed:

a) from a signaling pathway to tfs if tfs are the downstream of the signaling pathways regulate transcription factors.

b) from a tf to signaling or metabolic pathways if tf regulated at least one genes in the pathway.

in the end, a prior network is obtained, which illustrates a generic picture of the interactions between pathways and transcription factors inside a human cell.

noted that in our approach, there are additional steps to refine the constructed generic pathrnet by removing redundant nodes and edges:

in the context-specific pathrnet construction module, all the nonfunctional nodes and their edges were removed, leaving only the enriched functional pathways /tfs and edges between them.

in the regulatory pathrnet construction module, bayesian information criterion  was applied for model selection, and all the edges that are not chosen were removed from the constructed regulatory pathrnet.

in the dynamic pathrnet construction module,  edges that indicate no or nominal contributions were further removed from the constructed temporal pathrnet.

since all the following steps remove redundant nodes/edges, we hope keep as many associations as possible when constructing the generic pathrnet to ensure a high sensitivity of reconstruction. thus, an edge is placed between a transcription factor  and a pathway as long as the tf regulates at least one gene in the pathway . however, the degree of overlapping between the pathway genes and the tf target gene set might itself indicates the strength of their association. although this information is not used in our algorithm, it is possible to include this information in further extension to better estimate the regulatory impacts of transcription factors.

context specific pathrnet construction
to capture the functional components of generic pathrnet and construct a context-specific pathrnet, expression profile is then incorporated. the goal is to identify coregulated pathways enriched by the gene expression profile and their associated time period. to this end, we apply the ectdisa  <cit>  to the microarray gene expression data. ectdisa can not only cluster the coregulated genes that are functionally most enriched by a functional annotation database such as pathway databases but also retrieve the timing of the co-regulating clusters.

particularly, when applying the ectdisa, a measurement needs to be specified to gauge the coregulation of genes. since pearson's correlation is not robust towards noise, and euclidean distance is not suitable to measure correlation, we proposed a modified euclidean distance measurement ρ to penalize smaller fold changes without losing the robustness to noise, which is defined as follows:  

where x, y are the expression profile of a functional node , and α is used to penalize smaller fold changes.

since small fold changes are more vulnerable to noise, the parameter α was chosen to penalize smaller fold change to a reasonable amount. it should not be too small or too large. an experiment is developed on real data to show the sensitivity of the parameter, and result is evaluated in terms of a score and c score, which are defined in  <cit>  for performance evaluation purpose. in general, a score indicates whether all the identified modules are corresponding to true modules; c score indicates whether all the true modules are correctly identified by clustering algorithm. since our goal is to choose a proper α to uncover all the modules from the data, we are mainly interested in acquiring the highest c score; but at the same time, a score should not be too low. the result is shown in fig.  <dig> 

it can be seen from the figures that c score reaches its peak when α =  <dig>  and at the same time a score is relatively high. this is the value we choose when the approach was applied to real data. to achieve the best result, the use of different α are recommended.

an example of clusters produced by ectdisa is shown in fig.  <dig>  a number of the most significantly enriched signaling pathways, transcription factors and metabolic pathways are selected as the functional components in the prior network, and the context specific pathrnet is constructed by retaining only the functional components.

regulatory pathrnet construction
note that for now the edges in the functional networks are still defined by the prior knowledge. with the expression data, the edges can be further refined to reflect the regulatory status including up- or down- regulation and its weight. to this end, the expression profiles of the nodes are first determined. for the real case, since even the genes in the same pathways can behave differently, i.e., some are up regulated while some others are down regulated, it possible that the same pathway are enriched in both the up-regulated module and the down-regulated module. to capture the main trend of pathway, we consider the most significantly enriched trend in a pathway by using ectdisa algorithm. specifically, for a signaling pathway or a metabolic pathway , the expression profile is estimated by averaging all the pathway genes that are most enriched in their temporal trends. since the trends of their expression profiles are very similar, the averaging expression of those genes is a good estimate of the main trend of the pathway. for example, if at  <dig> hour, the expressions of  <dig> genes that are involved in the same pathways are  <dig>   <dig> ,  <dig> ,  <dig>  -3; and the first  <dig> gene are enriched in a module identified by ectdisa, then the fold change of the corresponding pathway at  <dig> hour will be . similarly, the expression fold change at other time points can be calculated. note that, since the expression is calculated by averaging along the gene dimension, the expression fold change of different genes are acquired from exactly the same experimental condition; moreover, the microarray data has been properly normalized  <cit> 

if a pathway is enriched in a temporal transcription module, then the pathway is only active during the inferred time period that the temporal module is active; otherwise its expression is  <dig>  for a transcription factor, the expression fold change profile is inferred by averaging the expression fold changes of its encoding genes.

next, the regulatory impact is inferred based on the expression of nodes. let y denote the expression profiles of a node and x =  the expression profiles of its parent nodes. then, a linear regulatory model is introduced as:

y = x·β + ε

where β represents regulatory weights and ε is white gaussian noise. the goal is then to determine the functional parent nodes and the corresponding regulatory weights β. the problem is a variable selection problem and bic is adopted for the solution. under the assumption that the model error is normally distributed, the formula for bic is:  

where n is the number of data points in xi, k is the number of parameters to be estimated, and the residual sum of squares  is the sum of squares of residuals, which defines the discrepancy between the data and our estimation model:

rss=|| y-ŷ||2

where,  is an estimate of y calculated based on the least squares estimate:  

temporal pathrnet construction
in the last module, the dynamic regulatory network is constructed from the basal network by considering the dynamic contribution of the regulatory nodes at each sample time points. specifically, the dynamic change of the expression level of a node at a sample time t can be expressed as:  

where, xt = , and p is the number of parent nodes of y. the dynamic contribution of all the parent nodes is âˆ™β, and the dynamic contribution of a parent node from t –  <dig> to t is: . then, the dynamic regulatory networks can be obtained by refining the edges at each t. particularly, if  is small, the corresponding edge can be removed indicating no or nominal contribution. otherwise, the width and the color of the edge will be defined by  to illustrate the regulatory influence of the node onto a child node during a particular sample time period. although small regulatory contribution  does lead to edge removal and thus change of network structure, it is mainly the regulatory time period inferred by the ectdisa that defines the dynamics of the network structure.

simulation 
RESULTS
pathrnet was first validated on simulated data. the data was constructed to mimic a microarray experiment that measures the expression profiles of  <dig> genes at  <dig> sample time points.  <dig> temporal transcription modules were assumed to exist in the expression data, each of which contains  <dig> to  <dig> genes and may share the same subset of genes. genes in a module was assumed to be co-expressed and follow a coherent expression pattern  <cit> . a simple pathrnet  was devised with each node corresponding to a molecule. moreover, only nodes  <dig>   <dig>  and  <dig> were assumed functional in the simulated expression data. the function of each node and their constitute genes were defined in a simulated prior knowledge database; the database contains a set of assumed pathways and tf regulated gene sets, whose members may be the genes in the module. specifically, in the prior knowledge database, node  <dig> was assumed to be regulated by node 1- <dig>  note that only nodes  <dig> and  <dig> are functional nodes in the context-specific pathrnet that underlies the simulated expression data.

the data pattern of each module was generated according to an ar  model:

xmt =  <dig> xm+εmt, where, xmt represents the expression level of module m at time t, and εmt ~ normal. then, the expression level of gene g in module m time t, can be simulated as:  

where gm denotes the set of genes in module m and tm is the duration of module m.

in order to simulate the regulatory impact, the pattern of node  <dig> is modelled as a linear combination of the patterns of node  <dig> and 2:

x8t =β1x1t+β2x2t

where, β <dig> and β <dig> are the regulatory coefficients and follow independent standard normal distribution normal  in our experiments. since node  <dig> was known to be regulated by node 1- <dig> according to the prior knowledge, it can be equivalently expressed as:  

where, β <dig> = β <dig> = β <dig> =  <dig>  then, each expression level in a module is multiplied with a random number from normal ;this is used to simulate the difference in expression strength among genes. finally, gaussian additive noise was added and data were arranged in a matrix similar to microarray; rows of the data matrix were also shuffled to mimic real biological data.

the simulated system is similar to the one used in  <cit> , except that additional network structure was specified. the goal of pattern is to reconstruct the embedded network structure and estimate the regulatory coefficients βi given the prior knowledge and gene expression data. in the following experiments, we evaluated the impacts of noise effect and prior knowledge on the performance of proposed pattern.

in the first experiments, pattern was evaluated under different noise variance by considering whether the correct network model was recovered and the percentage of correct model prediction is calculated. a network model is considered to be correctly identified when all the nodes within the network are predicted correctly, i.e., all the functional nodes are predicted to be functional, and all the nonfunctional nodes are predicted to be nonfunctional. for instance, in the network shown in fig.  <dig>  the network structure is correctly predicted if and only if nodes  <dig>   <dig>   <dig> are predicted functional, and meanwhile node 3- <dig> are predicted to be nonfunctional. . the percentage of correct model prediction is defined as the ratio of the number of correct model predictions to the total number of experimental trials. for example, if among  <dig> trials, models are predicted correctly  <dig> times, the percentage of correct model prediction is 80%.

the result of first experiment is shown in fig. 5-. it can be seen that pattern was able to identify the network structure correctly when noise is small, and the performance decreases as noise increases. to further evaluate the ability of pattern to estimate the regulatory coefficients βi, the mean squared error of estimated βi was calculated and compared with that of a direct method. the direct approach result is computed by considering the complete model, i.e., all the nodes are functional. in the network shown in fig.  <dig>  when using direct method, all five parent nodes 1- <dig> of node  <dig> in the network are considered, and the actual regression model is: y = x1β1+ x2β <dig> + x3β <dig> + x4β <dig> + x5β <dig> + ε. the direct method mimics the common practice of the bayesian networks based reconstruction approach and infers the regulatory relationship without considering node enrichment, thus involving all the nodes in inference. the comparison is shown in fig. 5-. compared with the direct method, pattern does improve the estimation accuracy of βi greatly under all tested noise conditions, which demonstrates the capability of pattern to identify the correct network structure and accurately estimate βi.

note that in pattern the enrichment analysis serves as a model selection approach. the performance improvement of pattern over the direct method in βi estimation demonstrates the importance of model selection. as seen in this example, to recover the true network structure, we need to 1) remove the non-functional nodes 3- <dig> from network, and 2) decide whether node  <dig> and  <dig> regulates node  <dig>  in pattern, objective 1) is achieved by the enrichment analysis in the context-specific pattern construction module, and objective 2) is tackled by the bic model selection in regulatory pattern construction module. however, in the direct method, objective 1) is not tackled.

then, we evaluated the impact of annotation database on performance. even though great effort has been made to construct and improve various prior knowledge databases, the existing databases are still very noisy and often inconsistent with prior knowledge, i.e., annotation is often incomplete and contains error. this scenario was simulated by first assigning a function category only to a fraction of genes in an embedded module and leaving the rest without any annotation, and then introducing randomly selected genes into the function category. the validation result was shown in fig. 5- and . it can be seen from the figure that the ability of pattern to identify the correct network structure and estimate the coefficients was not significantly affected as long as more than 50% of coregulated genes are correctly annotated. pattern outperforms the direct method under all tested conditions. these results imply that pattern is robust to the incomplete and erroneous annotations in the prior knowledge databases. in this experiment, in order to maintain the network structure and acquire a comparable result, the annotations of genes that are shared in several pathways  are unchanged; only the annotation of remaining genes can change.

additional experiments were been conducted to test the performance of the proposed algorithm on more complicated network. the proposed algorithm was applied to a large dataset with  <dig> genes  <dig> samples where a synthetic network with  <dig> nodes  and around  <dig> random edges  was embedded, and the regulatory coefficients follow independent standard normal distribution. this size of this network mimics a rather realistic situation. the precision-recall curves of reconstruction are plotted in fig.  <dig> 

it can be seen from the figure that, the proposed algorithm pattern achieves relatively better precision and recall performance at low noise level; its performance decreases as noise variance increases. particularly, for the noise variance at  <dig> , the precisions of nodes and edges drop below  <dig> only when respective recalls are above  <dig>  and  <dig> .

to evaluate the proposed algorithm on different types of noise distributions, three different noise distributions  are compared, and the results are shown in figs  <dig> and  <dig> 

it can be seen from the figures that, when noise variance is small, the proposed algorithm pattern performs similarly on the datasets for three different noise distributions; however, when noise variance is large, pattern performs much better on the laplacian noise contaminated datasets than on the other two, which indicates that the proposed approach is more robust to heavy tail noise distributions when the standard deviation of noise is the same.

reconstruction of pathrnet for kshv infection
we applied pattern to reconstruct a pathrnet for kshv infection of human primary endothelial cells  <cit> . previous studies have shown that kshv infection of primary human umbilical vein endothelial cells  can be divided into two broad phases: entry phase and postentry phase. the entry phase is an acute event involving the binding of the virus glycoproteins to cellular receptors, delivery of virus encapsidated viral and cellular proteins and rnas, and activation of various cellular pathways. the postentry phase is composed of a series of non-acute events involving the expression of viral genes and virus replication as well as subsequent virus packaging and egress  or establishment of viral latency, all of which closely interact with different cellular pathways and the expression of cellular genes. the process of kshv infection including lytic replication and latency are known to be complicated with various cellular genes and pathways regulated during different time periods under different schemes. it is highly desirable and important to elucidate the dynamic regulations of pathways and gene expressions during infection. the detailed result of the reconstructed pathrnet for kshv infection produced by pattern is discussed next.

generic pathrnet
the generic pathrnet, as shown in fig.  <dig>  was constructed by integrating the existing knowledge derived from nci-nc, transfac and msigdb  <cit> , which includes  <dig> signaling pathways,  <dig> transcription factors, and  <dig> metabolic pathways. the constructed generic pathrnet consists of  <dig> nodes representing tfs, signaling / metabolic pathways and  <dig> linkages, illustrating a generic picture of all the known interactions between pathways and transcription factors for different human cells under various conditions.

context-specific pathrnet revealed by ectdisa
a time series microarray data of kshv infection of huvec  <cit>  was introduced and the context-specific pathrnet  for kshv infection was reconstructed. the raw data consist of a total of  <dig> features  sampled at time t =  <cit>   after infection. an intensity filter  and a variance filter  were then applied to select  <dig> differentially expressed features, which are further merged into  <dig> entrez gene database uids by taking the maximum value of all corresponding probe set ids.

ectdisa <cit>  was then applied to the time series data to obtain the coregulated gene clusters that are most enriched by the nodes of the generic pathrnet and at the same time retrieve the timing of coregulation.

starting from  <dig> initial gene sets, ectdisa identified  <dig> clusters, which were further merged into  <dig> modules according to the scheme in  <cit> , and the  <dig> identified modules are shown in fig.  <dig>  among which the 2nd module is a temporal module, whose coregulation is defined from 3rd points to the last points. the enriched or functional components are listed in table  <dig> 

many of the enriched pathways and tfs, such as s- <dig>  s- <dig>  and tf- <dig> have been shown highly related to kshv infection  <cit> . please refer to appendix for a complete list of enriched pathways and tfs.

regarding how many nodes should be kept in the context-specific pathrnet, a node is considered to be significantly enriched in a module when the enrichment log p-value is larger than a predefined threshold. the threshold is chosen to be dependent on the noise level of the data. in general, a stricter threshold may result in too few nodes, i.e., low recall, and thus misses many true network connections; a relatively loose threshold may result in too many nodes, i.e., high false positive, and includes many false connections. as experiment was developed to show the sensitivity of the threshold and the result is shown in fig.  <dig> 

specifically, pattern was applied to a simulated dataset which consists of  <dig> genes  <dig> samples. the pathrnet embedded is shown in fig.  <dig>  different p-value thresholds are applied and compared. it can be seen from fig.  <dig> that when the threshold is too strict  or too loose  the proposed algorithm cannot retrieve the true network structure. the result is better when a reasonable threshold is chosen. to this end, we used a p-value threshold of  <dig>  to keep relatively more nodes in the network.

by keeping the only enriched or functional nodes  of the generic pathrnet, the context-specific pathrnet for kshv infection was obtained. since a number of enriched nodes are independent, those nodes are removed from the network. the reconstructed pathrnet consists of  <dig> nodes and  <dig> regulations . each node corresponds to a signaling pathway , transcription factor  or a metabolic pathway . the node enriched in the same cluster is highlighted by the same color and also indicated by the class id "c#". each directed edge represents the regulatory relationship.

regulatory and temporal pathrnet
the temporal pathrnets for the kshv infection of huvec were constructed to reveal the dynamics in regulation at each sampling time of the microarray experiment.

to better illustrate the result, a sub-network of related to p <dig> mapk signaling pathway  is acquired by keeping the nodes that are within the  <dig> nodes away from s- <dig>   <dig> frames of this sub-network are shown in fig.  <dig>  please refer to fig.  <dig> for the expression profiles of the involved clusters.

first of all, the time varying nature of the network structure and regulatory impact are revealed in fig.  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  the color of the nodes indicates the expression fold changes during the time period specified in fig.  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> . a directed linkage is determined by βp in fig.  <dig>  which is the regulation coefficient, and by  in fig  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  which are the dynamic contributions of the parent nodes to the child node during the time period specified. 

in the fig  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  the gray color of the nodes and links indicates that they are not functional. as shown by these figures, the colors of nodes and links vary over time, revealing the time-dependent characteristics of the network. regarding the variation of the network structure, two aspects of the algorithm are important. first, the time-dependent module defines the start and the end of an enriched connection in the module. for instance, since p- <dig> is enriched in a temporal transcription module that is not defined between  <dig> to  <dig> h post infection , p- <dig> does not function in the first  <dig> frames of the time varying network  and thus the nodes and links are in gray. however, they become active after  <dig> hpi . secondly, when the regulatory contribution of a parent node is sufficiently small, the parent node and the link are also marked gray to indicate nominal regulation. for example, while tf- <dig> regulates p- <dig>  - <dig>  - <dig> and - <dig> at different time points; it only regulates some or even none at some instances, say, between 3- <dig> hpi, or it only regulates p- <dig> and p- <dig> at other time points. furthermore, it is easy to observe that the contributions for many nodes vary at different time points. interestingly, a positive feedback loop exists between tf- <dig> and s- <dig> 

next, interesting regulatory cascades can be revealed by incorporating the annotations with the time varying networks. in fig.  <dig> from 0-1hpi, the p <dig> mapk pathway  is up-regulated, which also induces the tf stat <dig> . this suggests that in the early stage of infection kshv activates p <dig> mapk pathway. indeed, the activation of the p <dig> mapk pathway is shown to be essential for kshv infection and inhibition of the p <dig> mapk pathway reduced kshv infectivity  <cit> . induction of stat <dig> likely indicates the activation of cellular innate immune response to viral infection  <cit> . at  <dig> hpi in fig.  <dig>  it is suggested that stat <dig> also activates smad2/ <dig> signaling , which is in agreement with the existing knowledge that activation mapk pathway enhances smad <dig> transcriptional activity  <cit> . in addition, tf creb <dig>  is also activated during both  <dig> and  <dig> hpi, which is expected since it is at the downstream of the mapk pathway. interestingly, the entire cascade from p <dig> mapk to creb <dig> becomes downregulated at  <dig> hpi. following the first wave of activation of the cascade, we have also observed a second wave of activation of the p <dig> mapk pathway and tf stat <dig> at  <dig> hpi. the signal is again transduced to smad2/ <dig> at  <dig> hpi accompanying the decay of the p <dig> mapk pathway and tf stat <dig>  before being further transduced to creb <dig> at  <dig> hpi. activation of this second wave of the p <dig> mapk pathway has indeed been described in  <cit> .

discussion
pattern is a novel approach for analyzing large scale time series gene microarray datasets to uncover dynamic regulations of pathways and gene expression. we discuss next a few distinct features of pattern.

first, pattern relies on a robust and biological driven network architecture, pathrnet, which directly utilizes the existing functional databases. the enrichment scheme in pattern enables the identification of functional components of pathrnet, which enables the subsequent network inferences to focus on the context-specific part of the network structure, and thus significantly reduces inference complexity. as shown by the validation on the simulated network, pattern is also robust to the noisy and inconsistent annotations. all of these indicate the great capability of pattern to correctly identify the functional part of network structure.

second, the time-varying network structure and dynamic temporal regulatory impacts can be inferred as a result of the ectdisa, which not only identifies coregulated functional modules but also provides their timing information. this is critical information for all the related inference tasks in the reconstruction of dynamic network structure. moreover, pattern can accurately estimate the dynamic regulatory weights.

third, since the goal of patttern is to uncover dynamic network structure, it is especially useful for analyzing non-stationary biological processes, where different regulations exist at different time periods. this is the motivation of studying kshv infection. compared with other biological processes such as cell cycles, temporal transcription patterns are more likely to exist in this dataset. in contrast, transcription patterns of cell cycle related genes are often expected to be cyclic and sinusoidal in shape, which also exist in the entire cell cycle process and are not time dependent by our definition.

fourth, the computational complexity of the proposed pattern mainly lies in the context-specific pathrnet construction module, where biologically meaningful modules are retrieved by ectdisa. the computational complexity of ectdisa is proportional to the number of genes, the number of samples , the number of initial gene sets, the window length of the dependent analysis, the number of parameters to be optimized in the enrichment step, and the number of iterations required achieving convergence. 

limitations
firstly, the performance of the proposed method partially relies on the quality of available prior knowledge. it cannot retrieve information of pathways that have not been annotated in existing knowledge databases. the absence of relatively complete and accurate prior knowledge may severely jeopardize its performance. however, as knowledge databases including go, kegg, and others continue to grow and improve, the proposed algorithm will improve its prediction performance accordingly.

secondly, the proposed method cannot capture any intra-pathway interactions including feedback loops. more intelligent approaches are required to study the dynamics of intra-pathway associations. we will explore this modeling in our future research.

CONCLUSIONS
a new paradigm that aims at reconstructing robust context-specific and time varying regulatory networks was proposed. the novelties of our approach that enable the discovery are: 1) a robust and biological driven network architecture, pathrnet, which builds upon the existing functional databases; 2) a functional enrichment based algorithm that assesses the enrichment and time span of the regulation of tfs and pathways in the context-specific time series microarray data. due to pathrnet and the enrichment algorithm, we are able to robustly infer complex time-varying and nonlinear regulatory interactions that are otherwise impossible by the existing models and approaches. the resulting network provides unequivocal interpretation of biological functions and their impacts. the proposed approach for the first time provides a dynamic perspective of pathway, tf regulations, and their interactions related to specific endogenous and exogenous conditions. this context-specific, temporal landscape of regulation will help reveal directly the functional biomarkers that result in different phenotypes and consequently are important to drug design and therapeutic targets. in addition, this algorithm framework will enable the investigation of context specificity and time variation of other types of regulatory impacts such as mirna regulation, thus capable of providing more complete knowledge of regulation.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
jm, sjg, and yh conceived the idea. jm, yc, and yh worked out the detailed algorithms and derivations. jm implemented the algorithm and performed the testing. jm, ml, sjg, and yh wrote the paper.

supplementary material
additional file 1
appendix i: annotation of the nodes for figure 5

click here for file

 acknowledgements
yufei huang is supported by an nsf grant ccf- <dig> 

shou-jiang gao is supported by nih grants ca <dig> and ca <dig> 

publication of this supplement was made possible with support from the international society of intelligent biological medicine .

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2010: the full contents of the supplement are available online at http://www.biomedcentral.com/1471-2164/11?issue=s <dig> 
