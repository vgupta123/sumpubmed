BACKGROUND
the regulation of gene expression is one of the most complex processes in living organisms  <cit> . this process is a result of interactions between core transcription factors, additional regulators and chromatin architecture  <cit> . coupling chromatin immunoprecipitation with massive parallel sequencing  has provided a breakthrough in the analysis of gene-expression machinery. chip-seq data released by the encyclopedia of dna elements consortium   <cit>  and other researchers have made it possible to analyze the functional regulatory genome on an unprecedented scale. the utilization of available chip-seq results can provide insights into multiple lines of investigation, including the search for molecular factors involved in the control of coordinated expression of a particular set of genes as well as for protein-protein interactions within peaks resulting from new chip-seq experiments. such analyses require statistically oriented software to handle large genomic data in a computationally efficient manner.

here, we present seqinspector, a bioinformatics service that utilizes up-to-date chip-seq data. our tool allows the functional enrichment of user-defined lists of genes, transcripts and chip-seq peaks. the user is not limited to a predefined set of promoter regions and can use any set of genomic coordinates. our tool provides solutions for multiple challenges that have arisen with new sequencing technologies. the first difficulty encountered in interpreting rna-seq experimental results is that the output encodes multiple novel noncoding or un-annotated transcripts that are not represented in current databases. another challenge that is often faced is the compatibility of the tool with dynamic and continuously updated genome annotations. additionally, the tool should provide users the opportunity to search for protein binding sites in regions outside of gene promoters. for example, users might want to search for specific proteins that bind to the introns of differentially spliced genes or analyze peak regions obtained from new chip-seq experiments. therefore, we eschewed the standard approach that uses gene annotations directly or converts genomic coordinates to gene annotations. instead, our tool converts gene annotations into genomic ranges. for this purpose, we developed a new strategy for data storage, raw genomic bigwig tracks instead of an sql system. these tracks are analyzed every time the user inputs a query. this method allowed us to develop a new coverage-based approach to calculate enrichment statistics.

implementation
storage of large collections of raw genomic files
next-generation sequencing generates vast amounts of data. the results are typically presented as signal information  and as discrete elements . the most useful file formats for storing chip-seq experimental results are bigwig and bigbed for signal information and discrete elements , respectively  <cit> . both formats are binary and indexed, and both can be used in the same way as tables in database systems. therefore, we developed a database core using the bigwig file format instead of the sql database system. we used a client based on the source code from the integrative genomics viewer  genome browser to navigate bigwig files  <cit> . this approach, if parallelized, allows one to browse through multiple coverage tracks in a relatively short amount of time. moreover, this strategy allows us to utilize raw data downloaded from various resources without requiring data transformation or reformatting. at the time of writing this manuscript, the data collection contains  <dig> tracks from mice and  <dig> tracks from humans. these data have been downloaded from various sources including encode  <cit> , fantom <dig>  <cit>  , gene expression omnibus   <cit>   and the short read archive  .

a statistical test for the over-representation of chip-seq defined dna features
the decision to choose a storage method between raw coverage  and peaks derived from chip-seq data  was critical to further implementing the system. despite being computationally challenging, raw coverage files were favored because they can be directly used in visual explorations. therefore, we used raw coverage files to store the data. this process required a different statistical approach than commonly implemented in over-representation analyses that assume a hypergeometric data distribution . we decided to use a parametric statistical test that allows a comparison between the coverage means  from genomic coordinates between different samples. we implemented a two-sample t-test to compare the chip-seq track coverages derived from two samples of genomic ranges that were provided by the user and the background set. by default, the background set consists of  <dig> random gene promoters and can be replaced by the user-defined set. a statistic based on the parametric z-score is used for a single-gene exploration.

seqinspector user interface
based on previous experience with developing user interfaces for bioinformatics resources  <cit> , we decided to minimize the number of possible options. the user must select the genome assembly  and the query input . the server automatically recognizes the type and identification format. some of the most popular identification types are acceptable . the user can also input a genomic range in both bed and genomic coordinate formats. moreover, it is possible to input multiple gene sets individually and use one of them as the background. the selected gene lists can be compared with the background set using the “statistics” button. as a result, the user will obtain a list of chip-seq tracks sorted by statistical enrichment. the following columns are present in the output table:  track name—internal identifier of the track containing a short name of the transcription factor;  query—average coverage in the query set;  background—average coverage of the reference set;  fold difference—fold difference between the query and reference;  p-value—the significance of the difference between the query and reference datasets ;  bonferroni—bonferroni-corrected p-value;  stack plot—stacked plots presenting the distribution of coverages in all query sets with respective p-values;  histogram– a visualization of the average coverage  for all query sets;  genes—genomic intervals in the query set, symbols for nearest genes and coverage for these intervals; and  description—description of the track.fig.  <dig> 
a output of seqinspector showing the list of dexamethasone-regulated genes , over-represented chip-seq tracks  and a stack plot with the distribution of coverages in the reference and query sets. b output of a single-gene inspection showing the chip-seq tracks over-represented at the fos gene promoter



RESULTS
common regulators of co-expressed genes
seqinspector can be used for different types of analyses. one is to study clusters of co-expressed genes to find their putative molecular regulators. to demonstrate this functionality, we utilized the results from gene expression profiling of mouse astroglial primary cultures treated with dexamethasone  <cit> . dexamethasone is an agonist of a nuclear transcription factor, the glucocorticoid receptor . the list of  <dig> gene symbols for dexamethasone-regulated transcripts was submitted to seqinspector  . the genome assembly was set as mus musculus , and the default background was used. seqinterpreter correctly identified gr  as a true-positive regulator of the genes from the list  and provided a profile of the gr binding sites for each analyzed gene.table  <dig> top five enriched chip-seq tracks in the promoters of genes regulated by dexamethasone

 <dig> 
 <dig> 
only the over-representation of gr-tracks was found statistically significant 



protein-protein interactions
seqinterpreter can be applied to study protein-protein interactions. seqinterpreter calculates the average coverage for all stored chip-seq tracks for the submitted genomic ranges. the obtained coverages are then compared with a reference dataset using a two-sample t-test followed by correction for multiple testing. to demonstrate this functionality, we utilized data from a chip-seq analysis of sp <dig> binding in gm <dig> human lymphoblastoid cells . we submitted the top  <dig> peaks  from this dataset to seqinterpreter as genomic ranges in bed format . we submitted the lowest  <dig> peaks as background. we used the homo sapiens hg <dig> assembly. the transcription factors atf <dig>  sp <dig>  nfya, nfyb, e2f <dig>  irf <dig> and srf indirectly bind to sp <dig> binding sites  <cit> . seqinspector correctly identified the enrichment of the following factors as interacting proteins:  atf <dig> ,  sp <dig> ,  nfya ,  nfyb ,  e2f <dig> ,  irf <dig>  and  srf . the tool identified also other transcription factors binding to the same sites, including irf <dig> , c-fos  and chd <dig> . all of the presented p-values are bonferroni corrected.

cell type enrichment
another straightforward application of seqinspector is the study of transcript expression in various tissue and cell types. for this purpose, tracks generated by the fantom <dig> project using cap analysis of gene expression were added to the seqinspector database . this type of analysis reveals active transcription start sites and gene variants expressed in particular cell populations. list of genes or transcripts derived from microarray or rna-seq profiling experiments can be inspected for cell-type-specific gene expression. to provide an example of this utility, we used results of gene expression profiles in different cellular compartments of the nervous system  <cit> . submission of neuron- and astrocyte-specific lists of genes  confirmed cell-type enrichment and indicated which transcriptional start sites are utilized in these two cell populations . for astrocyte-specific genes, only one significantly over-represented track was noted - the hippocampal astrocytes cage track generated by the fantom <dig> consortium . for neuron-specific genes,  <dig> over-represented tracks were noted, including  <dig> fantom <dig> tracks generated from neural tissue or isolated neurons  and one encode track for the neuron-restrictive silencer factor .fig.  <dig> identification of cell-type-specific transcript expression start site. the plots display the mean coverage for the selected gene sets in various cell types based on the cage data. the x-axis represents the genomic region around transcription start sites from 5’ to 3’. the y-axis represents the coverage that has been normalized to the number of aligned tags per million. a coverage histograms for neuron-specific  and astrocyte-specific  gene lists from zhang et al.  <cit> . the upper panel displays the mean coverage of raphe neurons cage tags, whereas the bottom histogram refers to the hippocampal astrocyte cage tags. b coverage histograms for genes up-regulated  and down-regulated  in ruptured intracranial aneurysm from pera et al.  <cit> . the upper panel presents the mean coverage of neutrophil cage tags, whereas the bottom  histogram refers to cd8+ t lymphocytes cage tags



another possible use of seqinspector is to estimate the distribution of transcriptional alterations among various cell populations, which may be estimated from results of gene expression profiling in a heterogeneous tissue. to demonstrate this functionality, we used a list of genes from expression profiling in whole-blood samples obtained from patients after ruptured intracranial aneurysms and a control group   <cit> . the lists of up-regulated and down-regulated genes were compared against each other. seqinspector identified over-representation of cd8+ t-lymphocyte-specific transcripts among the down-regulated genes  and neutrophil-specific genes among the up-regulated genes  . all of the presented p-values are bonferroni corrected.

comparison with other tools
to demonstrate the effectiveness of seqinspector, we compared this tool with available chip-seq data-based online tools  as well as tools based on in silico predicted transcription factor binding sites . for this purpose, we used the following five example sets of genes regulated by various transcriptional mechanisms. one from each tool excluding enrichr :  an example gene set provided in this paper—gr-dependent genes regulated in mouse;  a list of human genes regulated by dexamethasone from the encode chip-seq significance tool website;  bdp <dig> target gene set from the cscan website;  liver-specific gene set from the opossum  <dig>  website and  a list of genes regulated by srf from the cremag website. we converted the original lists into ensembl transcript ids and gene symbols using biomart  <cit>  to meet the tool-specific input requirements. we used the default settings for all of the tools for the comparison. as a score, we used the rank of the expected transcription factor in the obtained results, where the points one to ten were awarded with a maximum given for the first position on the list . seqinspector received the highest summary score  followed by enrichr using encode data  and opossum  <dig>  . thus, the seqinspector tool, which is based on parametric statistics for enrichment calculation, was comparable to other promoter analysis methods. all of the gene sets with the original ids, refseq numbers, promoter sequences and results are provided in additional file  <dig> fig.  <dig> comparison of seqinspector to other online tools. the heatmap presents the scores from seqinspector, enrichr, opossum, cremag, cscan and encode chip-seq significance tool  for five selected gene sets . the scores were calculated based on the rank in the results of the expected transcription factor  with ten points for first rank , nine points for second and down to one point for the tenth rank . the sum of the scores is presented at the bottom. the tools are ordered by the sum of their scores in decreasing order



discussion
comparative genomic studies suggest that  <dig> to 8 % of the sequence information in a genome is evolutionarily conserved among mammals  <cit> . earlier in silico approaches to predict transcription factor binding sites were limited to those specific regions  <cit> . however, the encode project found that the vast majority  of the genome can be annotated with rna- or chromatin-associated features . therefore, the level of potentially functional genomic regions may be significantly higher than previously thought. seqinspector provides the possibility to search for functional elements with high confidence within unconserved genomic regions, offering a significant advantage over systems based on in silico-computed transcription factor binding sites. another advantage of chip-seq–based enrichment services is the ability to search for distant enhancer transcription factors through indirect binding to promoter regions. enhancer regions can be distant  from the proximal promoter of a target gene  <cit> . to demonstrate this advantage, we assessed seqinspector using a set of genes regulated by the enhancer transcription factor gr.

a unique feature of seqinspector is that it accepts any set of genomic coordinates. therefore, the tool can be used to identify common gene expression regulators for sets of co-expressed transcripts  or for sets of chip-seq peaks to identify putative protein-protein interactions or transcriptional co-factors. our software enables the study of transcript expression in various tissues and cell types using fantom <dig> cage data. therefore, it is possible to identify the enrichment of cell-type-specific genes or transcripts. the seqinspector software package can also be used in more creative ways; for example, the user can compare the characteristics of 5’ untranslated region  histone modifications between two sets of transcripts. we are continuously adding new chip-seq experiments to the database. seqinspector is not easily outdated; any novel genomic features  can be used if their genomic positions are known. even after major assembly changes in databases, the new genomic ranges can be translated to the old versions of the genome assembly using the liftover tool. this mechanism is currently built into seqinspector for the mouse mm <dig> assembly.

CONCLUSIONS
the seqinspector tool was developed to facilitate the functional annotation and discovery of transcription factor binding sites on promoters of co-expressed transcripts, signals from chip-seq experiments and any other set of genomic coordinates sharing a common trait. the presented web resource includes a large collection of publicly available chip-seq experiments  performed on transcription factors, histone modifications, rna polymerases and insulators in humans and mice.

availability and requirements
the seqinspector tool is free, open to all users, and there is no login requirement. seqinspector is available at http://seqinspector.cremag.org. when using seqinspector in future studies, please cite this paper.

additional files
additional file 1: 
list of genes upregulated by dexamethason. 

additional file 2: 
list of  sp <dig> binding sites in gm <dig> human lymphoblastoid cells. 

additional file 3: 
lists of astroglia and neuron specific genes. 

additional file 4: 
list of genes regulated in ruptured intracranial aneurysm. 

additional file 5: 
five example sets of genes used for comparison of seqinspector to other tools. 



abbreviations
chip-seqchromatin immunoprecipitation and next-generation dna sequencing

encodeencyclopedia of dna elements consortium

grglucocorticoid receptor

competing interests

the authors declare that they have no competing interests.

authors’ contributions

mp designed the software. mp and at implemented the software. mp, at and jf prepared the chip-seq database. mp and mk performed the analysis. mp, mk and af wrote the manuscript. the final version of the manuscript has been approved by all of the authors. rp supervised the study.

