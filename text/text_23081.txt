BACKGROUND
the methylation of cpg dinucleotides is an important epigenetic modification of dna, required in mammals for embryonic development, genomic imprinting and x-chromosome inactivation  <cit> . around 80% of all cpg dinucleotides are methylated in mammal genomes. the exceptions are short stretches of cpg dinucleotides , which are predominantly hypomethylated in healthy tissues  <cit> . cgis are thought to be predominantly located in the promoter region of genes; around 70% of all genes have a cgi overlapping its promoter region. moreover, virtually all housekeeping genes are associated to cgis, while only half of the tissue specific genes show such association  <cit> . given its location in the promoters, cgis may play important roles in the regulation of gene expression. an example is the aberrant methylation of cgis observed in many cancer types  <cit> . moreover, evidence exist that the differential or tissue specific methylation of cpg islands may be involved in the regulation of tissue specific genes  <cit> .

accurate prediction tools are therefore needed and a considerable effort has been carried out over the last decade to detect cgis in mammal genomes. many different algorithms have been proposed, most of them based on the criteria of gardiner-frommer  <cit> . these authors proposed in  <dig> thresholds for the detection of cgis: gc-content , cpg observed/expected  ratio  and length . many of the published methods simply readjust these thresholds. however, it has been shown that filtering criteria-based definitions of cpg islands are mathematically incomplete and non-operational, as the sliding window methods frequently fail to identify a large percentage of subsequences that meet the filtering criteria  <cit> .

recently, methods based on the clustering of cpgs along the genome sequence detect cgis as a statistical property, thereby not relying on thresholds of gc-content, o/e ratio and length. the first algorithm published in this category was the cpgcluster method  <cit> , which detects the cgis by means of the distances between cpgs, then assigning a statistical significance to each cluster of cpg dinucleotides. subsequently, cpgcluster was followed by other methods detecting cgis by means of the cpg densities  <cit> . in the same way, many other features could also contribute to determine the boundary of individual cpg-islands, such as transcription factors and nucleosome location. the nucleosome code could be an important ingredient of future cgi models, although sequence features will probably remain as the principal component . epigenetic information may be also of help in detecting cgis by making use of contextual information  <cit> .

given the conceptual differences between sliding window algorithms  using a high parameter space and those detecting cgis as a statistical property of the cpg clustering in dna sequences, disagreement exist on the way cgis should be predicted. recently, a comparison between islands detected by the window-based takai-jones  program  <cit>  and those detected by cpgcluster was published  <cit> . the comparison evaluated mainly the co-localization of cgis and known promoters and concludes an overall advantage for the tj approach over cpgcluster.

we present here new ways to detect putative function of cgis, emphasizing the basic difference between cpgcluster and swa predictions: the statistical significance introduced by cpgcluster instead of the conventional length threshold. we show that the statistical significance assigned to each cpgcluster island is a key criterion to control the overlap with promoter regions, evolutionarily conserved elements and spurious alu elements. finally, we show that many short  islands  may be also functional, given its overlap with either promoter or evolutionary conserved regions and the absence of methylation in at least one tissue. as many of these islets are exclusively predicted by cpgcluster, this may be the algorithm of choice for experimental essays aimed to verify the function of these short islands.

RESULTS
the way sliding-window approaches and cpgcluster detect cgis are conceptually different. while swa detect regions above the thresholds of g + c, o/e, min cpg and length, cpgcluster predicts statistically significant clusters of cpgs as cgis. as a first consequence, the statistical properties of the predicted islands are different as well ; e.g. in swa approaches the distributions of important cgi properties like %g + c and o/e ratio are heavily biased towards the user thresholds.

therefore, the first part of this work is basically aimed to clarify: 1) the differences between the length threshold used by swa and the statistically significance used by cpgcluster; and 2) the consequences that the differences in the number of predicted islands and the mean length might have on the prediction quality.

prediction quality has been assigned conventionally by the percentage of overlap with promoter regions and spurious alu elements. in the original publication of cpgcluster  <cit>  we added the overlap with evolutionarily conserved elements or phastcons  <cit>  as an indicator of putative functionality. here, we add several new types of analysis to assess the prediction quality, namely the capability to distinguish between different methylation domains or different alternative transcription start sites .

cpg islands in the promoter region
since cpg islands are preferentially located in the promoter region of genes, this fact has been extensively used to assess the quality of cgi predictions  <cit> . recently, it has been claimed  <cit>  that a higher percentage of tj islands  are located within the promoter when compared to cpgcluster islands . in table  <dig>  we show a similar analysis as carried out in  <cit> , but extending the comparison to other window based programs and different prediction sets for the cpgcluster algorithm. when considering cpgcluster islands with p-value ≤ 1e- <dig> , the cgi fraction overlapping the promoter region is effectively smaller than for the other programs. however, note that the numbers of cgis predicted by window-based methods are far below the number predicted by cpgcluster. to allow for an unbiased comparison, we obtained a second, strict set of cpgcluster islands simply by increasing the required statistical significance to p-value ≤ 1e- <dig> , then obtaining a total  <dig>  cgis. this number is within the range of recent estimates for the complete human somatic cell cgi complement  <cit> . the strict, more statistically significant set of cpgcluster islands shows now the highest overlap  with the promoter region. this advantage looks even more important when considering that the genome coverage of our strict set  was the lowest one. this indicates a high specificity of cpgcluster, which strongly supports our original claim that the p-value is the most important parameter to distinguish promoter cgis from the rest of genome islands  <cit> .

*p-value ≤ 1e-5;** p-value ≤ 1e-20

a comparison of length and p-value thresholds
the main quality parameter in swa is the window size . originally, the window size was set to  <dig> bp to assure that the detected regions surpass the g + c and o/e criterion not due to chance alone  <cit> . subsequently, this threshold was increased to  <dig> bp in order to reduce the false positive rate by eliminating spurious alu elements  <cit> . this criterion was replaced in cpgcluster by the statistical significance , a more robust and reliable way to distinguish true cgis from stochastic noise, disregard island length  <cit> . note that the p-value is not just a different expression for the island length. a non-linear relation exists between the p-values and the lengths of the predicted cpgcluster islands, as the p-value depends on both the island length and the island density .

to evaluate the discrimination power of cpgcluster p-value against window size, we generated a series of island-set predictions, each one containing the same number of islands, by appropriately varying the window size or the p-value thresholds. next, we determined the overlap of the resulting islands with the promoter regions, phastcons elements  <cit>  and alu repeats. the island sets selected by p-value clearly outperformed those selected by length: a higher percentage of cpgcluster islands overlap with promoters  and phastcons elements  along the entire range of the two parameters, at the same time reducing the overlap with spurious alu elements . table  <dig> shows the correspondence between the number of predicted islands, p-value and window length.

the results in figures  <dig>   <dig>   <dig> are straightforward in comparing the relative strengths of the two main parameters involved in cgi quality . the increased stringency in the conventional parameters used by the tj program excluded contaminating alu elements, but it also reduced the number of gene promoter associated islands, suggesting that bona fide cgis were also being discarded  <cit> . however, raising the statistical significance  of cpgcluster leads to an exponential increase in the overlap with promoters or phastcons, simultaneously decreasing the overlap with alu elements. cpgcluster algorithm is, therefore, a more rational and powerful way to increase cgi prediction quality. an additional advantage is that cpgcluster p-value would be particularly useful in comparative genomics of cgis, making possible the comparison of cgis with the same statistical significance, but obtained from different species, despite variations in g + c content or cpg density.

prediction of unmethylated regions
the most important criterion to assess putative functionality of a cpg island is the absence of methylation. therefore, the comparison to experimentally verified, unmethylated regions is another important analysis type to establish prediction quality.

recently, the methylation status of  <dig> hypermethylated and  <dig>  hypomethylated promoter regions in wi <dig> primary lung fibroblast  <cit>  have been used to compare the prediction quality of tj and cpgcluster algorithms  <cit> . in this study, the prediction quality was measured in the following way: i) true positives : hypomethylated promoters containing a predicted island, ii) false positives : hypermethylated promoters containing a predicted island, iii) true negatives : hypermethylated promoters not containing a predicted island, and iv) false negatives : hypomethylated promoters not containing a predicted island.

however, in our opinion, there is an important pitfall in such an approach. it is known that the methylation state of a given region can change among different tissues; therefore, assigning a "false positive" label to a predicted island which has been shown to be methylated in a single tissue may be misleading, as the same prediction could be perfectly "true positive" if measured in a different tissue.

fortunately, weber et al.  <cit>  also determined the methylation states in sperm. analyzing fibroblast and sperm data together, we observed that  <dig>  regions are unmethylated in both tissues but  <dig>  are unmethylated in one tissue but methylated in the other one. this means that around 12% of the regions are differentially methylated; therefore, a substantial number of fps were actually tps. given these data, in our opinion, without the knowledge of the methylation state in a vast number of different tissues, the number of "false positive predictions" cannot be assessed in this way.

we therefore based our quality assessment on sensitivity, a measure not dependent on the false positive rate, as well as on the estimation of the lower bound for the positive predictive value , a measure used in the gene prediction field under the name of specificity  <cit> . we used two different experimentally validated sets of unmethylated regions  to assess the quality of the  <dig> sets of predicted islands. table  <dig> depicts the results when taking genome-wide, experimentally verified unmethylated cpg islands as reference . the table shows that the cpgcluster relaxed set shows the highest sensitivity while the strict set shows the lowest one. when considering the lower boundary of the ppv , we observed the contrary pattern, the cpgcluster strict set now shows the highest ppv, while the relaxed set shows the lowest one. table  <dig> seems to confirm this trend when using unmethylated regions which are mainly related to promoters  <cit> . these results indicate that cpgcluster is either the most sensitive or the most specific algorithm, depending on the applied p-value threshold. the finding for the relaxed set confirms the result reported by han and zhao  <cit> . note, however, that cpgcluster strict set reaches the highest specificity but the lowest sensitivity. interestingly, a recent study  <cit>  also emphasizes that the cpgcluster p-value is a key attribute for distinguishing between constitutively methylated and unmethylated cgis.

*p-value ≤ 1e-5; **p-value ≤ 1e-20

*p-value ≤ 1e-5; ** p-value ≤ 1e-20

cpg islands in the domains bound by polycomb repressive complex 2
functional clusters of cpgs are not limited to promoter regions, they are also found in other genomic locations. an example are the hyperconserved cpg domains largely overlapping the domains bound by polycomb repressive complex  <dig>   <cit> , located far from the promoter and playing an important role in transcriptional silencing during development. we determined the overlap of the cgis predicted by different finders with the domains bound by prc <dig>  table  <dig> shows that all the finders show high sensitivities and low ppvs in predicting these sites, being cpgcluster the algorithm obtaining the highest sensitivity .

*p-value ≤ 1e-5; **p-value ≤ 1e-20

functional specificity vs. length of cpg islands
one of the most striking differences between swa and the cpgcluster approach is the length of the predicted islands. swa islands are on average much longer than cpgcluster islands , or  <dig>  ). originally, cgis were estimated to be on average  <dig> kb long  <cit> . frequently, more than one cpgcluster island can be found within the promoter region and furthermore, several cpgcluster islands are often embedded within one single conventional, swa island. for instance, around 53% of all tj islands host more than one cpgcluster island .

given these facts, it might be that either conventional swa predictions erroneously merge smaller islands into longer ones, or that cpgcluster erroneously fragments longer islands into many smaller ones. next, we use alternative tsss and single cpg resolution methylation data to shed light on these questions.

alternative promoters
frequently, cpgcluster predicts more than one island within the promoter region. it has been shown  <cit>  that  <dig> % of all refseq genes have more than one cpgcluster island, while only  <dig> % have more than one tj island. following the premise "one promoter one cpg island", this observation was interpreted as a disadvantage of cpgcluster  <cit> . however, in recent years, new insights into the regulation of gene expression became available, showing among other things a frequent use of alternative tsss. the existence of alternative tsss opens the possibility that more than one island per gene might exist. therefore, the high percentage of genes with more than one cpgcluster island might instead indicate a more specific relation of cpgcluster islands to alternative promoters or tsss. to check this possibility, we used the dbtss database  <cit> . out of  <dig>  refseq genes annotated in the latest dbtss release,  <dig>   have at least one alternative tss. with such scenario, one might expect up to 52% of all promoters having more than one island in its promoter . given these numbers, the reported  <dig> % of genes with more than one cpgcluster island might look not so inadequate.

conversely, this finding might indicate that the tj algorithm artificially joins several functional islands into one single longer island. to further investigate this possibility, we estimated the number of islands simultaneously overlapping multiple tsss annotated in the dbtss database. table  <dig> shows that the cpgcluster sets, both relaxed and strict, overlap a higher fraction of unique, and a lower fraction of multiple tsss than the islands predicted by other programs, thus making cpgcluster predictions much more specific in overlapping individual tsss.

*p-value ≤ 1e-5; ** p-value ≤ 1e-20

in the human genome, there are a total of  <dig> bi-directional promoter pairs which share one long swa cgi but two separated cpgcluster cgis. the gene-pair shown in figure  <dig> may be just an example of extreme differentiation in gene-expression: while the first member of the gene-pair is a housekeeping gene, the second one is a tissue-specific gene. however, one cannot reasonably expect that this may be the rule for all the bidirectional gene-pairs. in fact, after analyzing the expression profiles in a sample of  <dig> healthy tissues, only  <dig>  gene-pairs show a completely divergent pattern of gene-expression , while  <dig>  exhibit complete coexpression . the remaining gene-pairs show intermediate values of coexpression.

on the other hand, by using single base resolution methylation data  <cit> , we also analyzed methylation differences between the cgis overlapping bi-directional promoters. we found that  <dig>  of these island-pairs in h <dig> stem cells, and  <dig>  in the imr <dig> fetal lung fibroblasts, show significant differences  in their methylation average .

heterogeneous methylation in long swa islands
a functional cpg island should show a rather homogenous methylation profile among the different cpgs and over the different tissues. for example, the existence of more than one methylation domain within a predicted island might indicate an erroneous merging of two small islands into a single longer island.

here, we used single base resolution methylation data from different sources  to decide whether cpgcluster predicts too many short islands or swa predict too many long islands. in doing so, we detect all tj islands which harbor at least two cpgcluster islands. next, we calculate the mean methylation for each cpgcluster island and the maximal difference in methylation over the different tissues. if many tj islands exist with high methylation differences inside, this might indicate an erroneously joining of different methylation domains into a single island. figure  <dig> shows a particular example from human chromosome  <dig>  the region for which hep data were available is just  <dig> bp long, showing a very pronounced change of the methylation values in embryonic liver cells. all swa programs predict a very long island in this region, including completely the interesting region where the un-methylation/methylation border occurs. only cpgcluster predicts precisely one cgi for each of the methylation domains.

cpg-islets
cpg "islets", genomic regions not conventionally classified as cgis because of their short length , but having a gc content and observed-to-expected cpg ratio characteristic of a cgi, have recently been identified in a  <dig> -mbp chromosomal region  containing a neocentromere  <cit> . some of these islets remain unmethylated, corresponding to sites of active transcription and/or boundaries that separate major chromatin sub-domains. this suggests that, as conventional islands, the islets can also participate in the maintenance of a particular genomic pattern of methylated/unmethylated cpgs, thus contributing to the differential regulation of gene expression  <cit> .

given their tiny size, islets remain undetected by swa, conventional cgi finders  <cit> , as all these programs share a length threshold above  <dig>  or even  <dig> bp. such length thresholds make conventional finders useless for the detection of cpg islets, since a relaxation of the length threshold will lead to a strong increment of false positives. however, since cpgcluster  <cit>  does not use any length threshold, it allows to identify short, but statistically significant cpg islets. a genome-wide search identifies a total of  <dig>  cpg islets in the human genome with p-value ≤ 10e- <dig>  table  <dig> shows that relatively high percentages of cpg islets overlap with different sets of promoters and evolutionarily conserved elements, thus suggesting a functional role for many of the predicted islets. noteworthy, a high proportion of these overlapping islets are exclusively predicted by cpgcluster, but not by any of the remaining finders. this indicates that: 1) many of the small islands predicted by cpgcluster are not fragments of conventional islands, and 2) given the co-localization with functional regions, the islets might be indeed functional.

using hep data  <cit>  and lister et al. methylation levels of single cytosines  <cit> , we also determined the number of unmethylated and differentially methylated cpg 'islets' . a high proportion of the sampled cpg islets were unmethylated or differentially methylated, thus again suggesting a functional role for cpg islets. this is a very important point, as differential methylation of islands/islets may be involved in the regulation of gene expression. again, the proportion of these cpg islets exclusively predicted by cpgcluster is very high.

*unmethylated: average methylation ≤  <dig> ; differentially methylated: average methylation <=  <dig>  in at least one tissue & average methylation >=  <dig>  in at least one other tissue.

**the methylation state of  <dig> cpg 'islets' from chromosomes  <dig>   <dig> and  <dig> was determined by using  <dig>  individual cpg sites . we only included cpgs which have been detected in at least  <dig> clones or in at least  <dig> different tissues.

***we used the sequence reads obtained by methylc-seq for two human cell lines  <cit> , h <dig> human embryonic stem cells and imr <dig> fetal lung fibroblasts, to get the average methylation level of single cytosines at both dna strands for these two methylomes. all islands need more than 50% of its cpgs covered. only cytosines covered by at least  <dig> reads were counted.

CONCLUSIONS
we systematically compared conventional swa for detecting cgis to a clustering method, namely the cpgcluster algorithm. we showed than both approaches perform very similar when predicting long, unmethylated regions or polycomb sites. however, we found three scenarios where the cpgcluster algorithm seems to have advantages. first, the statistical significance assigned to each cpgcluster island seems to be a better quality parameter than the window size of conventional finders, as it reduces more efficiently false positive predictions. second, we have shown that cpgcluster islands co-localize in a more specific way to alternative tsss and methylation domains. third, we have shown that many of the small islands predicted by cpgcluster might be functional, given the overlap with conserved elements or promoter regions. moreover, 30% of the differentially methylated islets are exclusively predicted by cpgcluster, which suggests this method as the option of choice for the experimental verification of islet functionality.

