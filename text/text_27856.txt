BACKGROUND
illumina beadarray platform is a microarray technology offering highly replicable measurements of gene expression in a biological sample. each probe is measured on average of thirty to sixty beads randomly distributed on the surface of the array, avoiding spatial artifacts and the reported probe intensity is the robust mean of the bead measurements. fluorescence intensity measured on each bead is subject to several sources of noise . thus the intensities produced by the microarray require a background correction in order to account measurement error. for that purpose, illumina microarray design includes a set of non specific negative control probes which provides an estimate of the background noise distribution.

in genome-wide microarrays, the observed intensity of a probe is usually modeled as the sum of a signal and a background noise. namely, let x be the observed intensity of a given probe, we assume that 

  x=s+b 

where s is the true signal which counts for the abundance of the probe complementary sequence in the target sample and is independent of the background noise b. only x is observed but the quantity of interest is the signal s. therefore, a background correction adjusting the effect of noise on the true signal is necessary to enhance the biological validity of the results. in this context the knowledge of both signal and noise distributions provides a background correction procedure: the signal s is estimated by the conditional expectation of s given the observation x=x and given the distributions of b and s. under parametric assumptions on b and s, the problem is limited to the estimation of the parameters. besides, in many experimental contexts involving measurement error the normal distribution of the noise is assumed. specific arguments for microarray data find their origins in analytical chemistry .

background correction of affymetrix and two-color microarray data has been widely developed in literature . irizarry et al <cit>  proposed a parametric model for affymetrix based on a exponential distribution of the signal, called normexp model. several estimation procedures have been developed for this model. the first parameter estimation, still popular today, is the robust multi-array average  procedure. maximum likelihood estimation , incorporating the negative controls, has been later proposed and is considered to be more sensitive to the true parameter values . these procedures can be found in bioconductora packages including limma <cit> .

illumina design differs from those of affymetrix and two-color microarrays by including a set of negative probes which do not specifically target any regular probe. aside from non specific hybridization, these negative probes do not hybridize and then have signals close to zero. thus their observed intensity is x=b. as all probes from a given array correspond to the same biological sample and are subject to the same technical steps during the analysis process, the noise is generally assumed identically distributed on an array and the negative probes provide a sample from its distribution.

the background correction implemented in illumina beadstudio software is the subtraction of the estimated mean of the negative probe distribution. however, it creates a large amount of probes with negative intensities unusable in further analysis. the deletion of these probes is considered in some studies as an opportunity to gain statistical power when the number of strongly differentially expressed genes is large, but it can lead to an important loss of information. ding et al <cit>  illustrate this phenomenon in their mice leukemia study: a large amount of corrected values are negative only in one group suggesting that the corresponding probes have discriminating ability. this issue is confirmed by dunning et al <cit>  on spike-in data.

to avoid this problem, parametric models have been used on illumina data with parameter estimations taking into account the specific design of illumina microarrays. in this context, the normexp model has been first adapted. ding et al <cit>  use the maximum likelihood estimation  based on a monte-carlo markov chain approximation and compare their method to an illumina-adapted rma procedure using an ad hoc rule of thumbs to estimate the parameters. xie et al <cit>  go into details in normexp method comparison on experimental and simulated data. lin et al <cit>  present a variance stabilizing transformation  on a model involving both additive and multiplicative noises, which simultaneously denoise and transform the data. replacing the classical log-transformation, vst produces less directly interpretable results and tends to produces very small fold changes, as underlined by shi et al <cit>  who propose an original approach to compare methods offering different bias-precision trade-off by aligning the innate offset generated by each pre-processing strategy. they conclude in favor of the normexp model with robust ’non-parametric’ parameters associated to a quantile-normalization using control and regular probes. besides, chen et al <cit>  propose a gamma parametrisation of the background noise distribution to handle with the departure from normality observed on negative probes, associated with an exponential distribution of the signal. they emphasize that gamma-exponential model can provide an improvement in terms of differential analysis, but might not be an adequate parametrisation in some cases.

the spread of each background correction among the illumina users is hard to evaluate since many authors do not mention precisely the pre-processing steps performed in their study. nevertheless, the normexp model that will be especially examined in this paper is included in several widely used packages such as lumi and limma of bioconductora.

despite its popularity the normexp model does not properly fit illumina microarray data. this issue was raised by wang and ye  <cit> , who estimate the density of the signal on an illumina microarray with a kernel-based deconvolution procedure. the shape of the estimated signal density does not present the characteristics of an exponential distribution and a gamma modeling seems more appropriate. we confirm these findings by implementing the kernel-based estimator by wang and wang  <cit>  available in the r package decon. . the signal density estimate exhibits a heavy tail which can not be fitted by an exponential distribution density. nevertheless, kernel-based density estimators does not appear efficient to recover breakpoints in the density, and presents instabilities, which limits the interpretation of the signal density estimate in the microarray context. in this paper, we emphasize that the normal-exponential model is not flexible enough to model the signal-noise decomposition on illumina microarrays by showing that the distance between the reconstructed density from the estimated parameters and the distribution of the observed intensities is large.

we propose an alternative model thereafter called “normal-gamma model” which addresses this lack of fit. in our model, the normal noise distribution is assumed and the signal on one array is assumed to be gamma distributed. as the exponential distribution is a special case of the gamma distribution, this model extends the normexp model. the potential of such generalization was already suggested by xi et al <cit>  in their discussion. we derive the necessary estimation procedure by likelihood maximization. the good quality of fit is attested on two types of illumina microarrays. the associated background correction is compared to methods based on the normexp model in terms of quality of estimation of the signal and checked for robustness on simulated data. the characteristics of the background correction procedures are compared on a set of spike-in data, and a parallel is drawn with the same characteristics studied on normal-gamma simulated data. finally, the normexp and normal-gamma background corrections are compared on two dilution data sets.

the paper is organized as follows. the experimental and simulated data sets as well as the estimation procedures are presented in section “methods”: the notations and the general model-based background correction formula are gathered in section “general model-based background correction formula”; the previous models developed for illumina microarray background correction, including the normexp model, are summarized in section “previous modelings”; section “a new modeling: the normal-gamma model” presents the proposed alternative parametric model built with normal noise and gamma distributed signal, as well as a parametric estimation procedure and its associated background correction. the performances of this new model are evaluated on simulated, spike-in and dilution data sets in section “results and discussion”. the impact of this more flexible parametrisation on background correction as well as the perspectives for further pre-processing analyses are discussed in section “conclusions”. the normal-gamma parameter estimation and the associated background correction are implemented in the r-package normalgamma. the scripts used to produce the tables and figures are available in additional file  <dig> 

methods
materials
experimental data sets
● nowac data <cit> . the gene expression profile in peripheral blood from ten controls in the norwegian woman and cancer study has been analysed on human ht- <dig> v <dig> expression beadchips. the whole probe set including  <dig>  bead types has been considered, as well as a restricted set of  <dig>  bead types according to illumina annotation files. details on laboratory experiments are given in additional file 1: section  <dig> . the data are provided in additional file  <dig> 

● leukemia mice data <cit> . total rna from samples of spleen cells from four mice have been analysed on mouse- <dig> v <dig> beadchips. experiment description and data are available in  <cit> 

● spike-in data <cit> . humanwg- <dig> v <dig> beadchips have been customized to include  <dig> bead types, refered as ’spikes’, whose corresponding target sequence is absent from the human genome in addition to the  <dig>  regular probes. the  <dig> spikes were introduced at  <dig> different concentrations  in a human biological sample. each sample corresponding to a spike concentration has been analysed on four arrays. the data are available at http://rafalab.jhsph.edu/.

● maqc data <cit> . two pure samples, universal reference rna  and human brain reference rna  were mixed in four different proportions . five replications of each sample have been analysed on humanwg- <dig> v <dig> beadchips. the data are available on geo .

● dilution data <cit> . the pure samples uhrr and hbrr were mixed at different proportions . each mixed sample has been analysed with four different starting rna quantities . six humanwg- <dig> v <dig> beadchips were used.

simulated data sets
for each data set, n= <dig> random arrays including a vector xℓof length nreg= <dig> corresponding to the regular probe intensities and a vector x <dig> ℓof length nneg= <dig> corresponding to the negative probe intensities are generated. the values of the nine parameter sets as well as the details of the simulations are given in additional file 1: section  <dig>  

● normal-gamma and normexp models. for each repetition ℓ= <dig> …,n, xℓis generated as the sum of a gamma and a normal-distributed sample, and x <dig> ℓis drawn from a normal distribution. six sets of parameters are computed from two microarrays in data sets  and , based on normexp and normal-gamma models in order to get realistic values . the normexp parameters are actually degenerated normal-gamma parameters where the shape is equal to  <dig> 

● mixture noise distribution. a mixture of normal and χ2distributions with different proportions  is considered for the background noise. these distributions model a departure from normality with a heavier right tail for larger values of p. the mixture densities are presented in additional file 1: section  <dig>  the signal is generated from a gamma distribution with parameter values from set  <dig> 

● replicates. we mimic replicate measurements from a biological sample by simulating n arrays with the same signal sample generated from a gamma distribution. the background noise and negative probe intensities are independently drawn from a normal distribution for each array. the values of the parameters are computed from the first array in  . replicates from the normal-exponential model are drawn in the same way with parameter values estimated on the same array with two normexp estimates .

● replicates with empirical background noise. similarly to , the signal drawn from a gamma distribution with parameter values from set  <dig> is identical on each array. in order to get a realistic noise distribution, the negative probe and background noise intensities are sampled from the global set of quantile-normalised negative probe intensities measured in the experimental data set .

general model-based background correction formula
notations
throughout this article, the background correction is processed on one single array corresponding to one biological sample. for a given probe j, we denote by xj the observed intensity, sj the non-observable underlying signal and bj its background noise. for a negative control probe, sjis assumed to be  <dig>  let j and j0be respectively the index of regular and negative probes on the array. we denote by fx, fs and fbthe densities of respectively the observed intensity, the unknown signal of interest and the background noise.

we denote by fμ,σ2norm the density of the normal distribution with mean μand variance σ2and by ϕand Φ the density and cumulative distribution function of the normal distribution with mean  <dig> and variance  <dig>  we denote by fαexp=exp the density of the exponential distribution with mean α and fθ,kgam=xk−1exp−x/θ/) the density of the gamma distribution with scale parameter θand shape parameter k. the exponential distribution is a special case with k= <dig> and θ=α.

given a parametric density and a procedure of estimation of its parameters, we call plug-in density, this density for the estimated parameters.

model-based background correction
the model based background correction  incorporates information from both signal and noise distributions. under the additive model  assuming independence of s and b, fx is the convolution product of fsand fb. for an observed probe intensity x, the signal s is estimated by the conditional expectation of s given the observation x=x and the densities fband fs: 

  s^=es|x=x,fb,fs=∫sfsfbfxds=∫sfsfbds/∫fsfbds. 

previous modelings
the normal model for negative probes
the design of illumina beadarrays provides a sample of the background distribution through the negative probes. we have compared the density histogram of negative probes to the plug-in normal density fμ^,σ^norm obtained by using robust estimators of the parameters on data sets  and .

the results of this comparison are presented in additional file 1: section  <dig> . as expected, the empirical distribution is essentially normal but we notice a slightly heavier right tail. it may be interpreted as intensities of wrongly designed negative probes which partially hybridize with some material present in the biological sample.

the normal-exponential model
the normexp model is a parametric model for the noise-signal decomposition on one array. we recall it briefly and refer for example to  <cit>  for more details. for every probe j, 

 xj=sj+bj,sj∼exp,ifj∈j,0ifj∈j <dig> bj∼n,sj⊥bj, 

where ⊥ denotes the independence between variables. the parameters  depend on the given array.

for computational reason, the xj’s are usually and often implicitly assumed to be independent. the existence of pathways between genes violates this assumption. nevertheless, as a small proportion of genes are involved, results are reliable. according to the convolution structure , the density of the xj’s is: 

  fμ,σ,αnexp=1αexpσ22α2−x−μαΦx¯, 

where x¯=/σ. denoting Θ = , from , the background corrected intensity for an observed intensity x is: 

  s^nexp=σx¯+ϕΦ. 

normal-exponential model fit
we consider the data sets  and . for each array, the following procedure is implemented: 

● computation of the estimators  of the normexp model with the methods described in  <cit> : 

 <dig>  maximum likelihood estimation  using both regular and negative probes,

 <dig>  robust multiarray analysis  adapted from affymetrix method,

 <dig>  np estimation obtained by the method of moments applied to negative and regular probes,

 <dig>  bayesian estimation. note that the bayesian estimation results are not presented as they are nearly identical to mle, as pointed out by xie et al <cit> .

● for each parameter estimation method, plot of the plug-in density fμ^,σ^,α^nexp.

● plot of an irregular density histogram of all regular probe intensities of the array using the r-package histogram available on the cran with default irregular setting . even though adaptive irregular histograms are not commonly used to describe microarray data, they have been proved to offer a better approximation in a general framework. moreover, they appear especially relevant to estimate microarray distributions which present high irregularities.

besides xie et al <cit>  show that the mle and the np estimation provide satisfying estimators of the parameters on normexp simulated data. thus the difference between the histogram of the observed intensities and the plug-in density does not come from a poor estimation of the parameters but results from an unsuitable parametric model.

a new modeling: the normal-gamma model
the poor fitting of the normexp model shown above, as well as the preliminary observations based on non-parametric estimation procedures, call for a more suitable parametric model for illumina beadarrays. according to section “previous modelings” the normal assumption for the negative probes appears relevant. we consider the gamma distribution as an extension of the exponential distribution to model the signal intensities. besides, as a scale mixture of exponential distributions , the gamma distribution is a natural generalization which helps to take into account different probe hybridization behaviors which could count for different exponential life times. this defines a more flexible parametric model called the normal-gamma model that we propose to apply to illumina beadarrays.

the normal-gamma model
the normal-gamma model is defined as follows. for every probe j: 

  xj=sj+bj,sj∼Γ,ifj∈j,0ifj∈j <dig> bj∼n,sj⊥bj. 

the parameters  depend on the given array. this model offers more flexibility than the normexp model but requires the estimation of one more parameter.

according to the convolution structure , the density of xj is the convolution product of the densities of sjand bj, namely: 

  fμ,σ,k,θng=∫fk,θgamfμ,σnormdt. 

this density does not have any analytic expression as the normexp density . nevertheless, good and fast numerical approximations can be computed using the fast fourier transform  and tail approximations to ensure stability. our implementation based on fft is detailed in additional file 1: section  <dig> 

parameter estimation in the normal-gamma model
the parameters  of the normal-gamma distribution are estimated by the maximum likelihood estimator : 

  =argmaxl|x,x <dig> 

where 

 l|x,x0=∏j∈jfμ,σ,k,θng·∏j∈j0fμ,σnorm 

 is the likelihood from the two sets of observations x={xj,j∈j} and x0={xj,j∈j0} measured on regular and negative probes, respectively. thanks to the fft-based approximation of fμ,σ,k,θng the maximum likelihood estimation can be numerically computed using classical minimization algorithms .

background corrected intensity for the normal-gamma model
denoting now Θ = , we derive from  the back- ground corrected intensity for an observed intensity x: 

  s^ng=∫sfk,θgamfμ,σnormdsfμ,σ,k,θng=kθfμ,σ,k+ <dig> θngfμ,σ,k,θng 

using the equality sfk,θgam=kθfk+ <dig> θgam valid for every s> <dig>  this formula allows fft-based computations for the background correction.

inference of negative probes from illumina detection p-values
most publicly available data sets do not present the negative probe intensities. nevertheless, for each regular probe, illumina provides a detection p-value equal to the proportion of negative probes which have intensities greater than that probe on a given array. following the idea from shi et al <cit>  we propose to infer the negative probe intensities from the detection p-values . for the normexp and the normal-gamma models, the estimates of the parameters and reconstructed signals obtained with the true and inferred negative probe intensities are compared on the ten arrays from . we observe that the error resulting from inference of the negative probe is negligible, with a relative error of order 10− <dig> to 10− <dig> on parameter estimation and 10−4to 10− <dig> on signal estimation .

RESULTS
fit on illumina beadarray data
similarly to section “previous modelings”, we compare the irregular density histogram of the regular probe intensities with the plug-in normexp densities using rma, mle, np methods and the plug-in normal-gamma density using a maximum likelihood estimate of  on the data sets  and . the results, similar along the arrays, are illustrated in figure  <dig> on one array from  . we do not add the mle and np plug-in density estimates for the normexp model which have already been shown not to fit the data.

thanks to the larger flexibility of the normal-gamma model, we observe that the distance between the mle plug-in normal-gamma density and the histogram of the intensities is smaller than the corresponding distance using the normexp model with any estimation procedure. this graphical result is confirmed numerically using the l1-distance between the histogram and the reconstructed density defined by 

  ℓ1=∫|f^−ĥ|dx, 

where f^ represents one plug-in density estimate using either the normexp model or the normal-gamma model and ĥ represents the irregular density histogram obtained with the r-package histogram. table  <dig> presents the mean of the relative deviation for the normexp estimators with respect to the deviation for the normal-gamma estimator: 

 meanℓ1ℓ <dig> 

 where fi^ is a normexp estimator of the regular probes density, and f^ing is the normal-gamma estimator for individual i. the mean is computed over the ten arrays from   and over the four arrays from .

average deviation between normexp reconstructed density and histogram divided by the deviation between normal-gamma reconstructed density and histogram . the fourth row gives the mean deviation of the normal-gamma estimator as a reference. the mean is computed over the ten arrays from  with  or without  the non specific binding probes and over the four arrays from  .

the mean absolute deviation is  <dig> times smaller in favor of the normal-gamma density with respect to the normexp density using the rma estimate, and  <dig> to  <dig> with respect to the normexp model using the mle or np estimates.

quality of estimation on simulated data
the quality of estimation of the normal-gamma model is assessed on the simulation data set . the first two sets of parameters are non degenerate normal-gamma parameters, more realistic for modeling illumina microarrays as shown in section “fit on illumina beadarray data”. they are used to evaluate the mle normal-gamma parameter estimation and validate the associated background correction, and to quantify the improvement brought by the new normal-gamma background correction. the last four sets are actually degenerate normal-gamma parameters where the shape parameter k is set to  <dig>  corresponding to normexp data, which enables to assess the potential loss of precision in parameter estimation brought by a more flexible modeling.

parameter estimation
for each repetition ℓ= <dig> …,n we compute the normal-gamma mle  of the parameters. table  <dig> presents the relative l1-error for each parameter β∈{μ,σ,k,θ}: 

 1n∑ℓ=1nβ−β^ℓβ. 

the parameter estimation is of excellent quality for the gaussian distribution and of good quality for the gamma distribution.

to check wether the introduction of a fourth parameter in our model leads to a loss of precision in the parameter estimation, we compare the relative l1errors of the mle parameter estimation in the normal-gamma and normexp models using the parameter sets  <dig> to  <dig>  corresponding to normexp data. the results summarized in table  <dig> indicate that the quality is unchanged for the variance parameter and that we pay a price of order  <dig> for μ and θ. nevertheless, since the relative errors in these cases have order 10− <dig>  this loss is negligible.

ratio between the relative l1errors of the mle estimation in the normal-gamma and in the normexp models for  from normexp data.

background corrected intensity
we now study the performance of the normal-gamma background correction  obtained in  with respect to the existing bgc methods in terms of quality of estimation of the signal on the simulated data set . we compare the following bgc methods, detailed in  <cit> : 

 <dig>  normal-gamma bgc in  with true parameters,

 <dig>  normal-gamma bgc in  with mle parameters,

 <dig>  normal-exponential bgc in  with mle parameters ,

 <dig>  normal-exponential bgc in  with rma parameters ,

 <dig>  normal-exponential bgc in  with np parameters ,

 <dig>  background subtraction: 

 s^sub=maxx−median{xj,j∈j0}, <dig>  

these methods are further denoted by s^ for i= <dig> …, <dig>  for methods  <dig> to  <dig>  the bgc is a two-step procedure: the parameters are estimated and then plugged respectively into  for method  <dig>  and into  for methods  <dig> to  <dig>  from a practical point of view, as the parameters are unknown, s^ is unavailable. nevertheless, as the result of a procedure with a perfect first estimation step, it allows a comparison to quantify the performance of the second step.

for each parameter set and for each bgc method s^=s^, i= <dig> …, <dig> we compute the mean absolute deviation : 

 mad=1n∑ℓ=1n1nreg∑j=1nregs^−sjℓ 

 where Θ^ℓ= denotes for each simulated array ℓthe estimated parameters corresponding to the used methods with the following conventions: 1/ Θ^ℓ is the true parameters for i=0; 2/ k^ℓ= <dig> for i= <dig> …, <dig> corresponding to the exponential distribution; 3/ Θ^ℓ represents the median over x <dig> ℓfor i= <dig>  simulation results are summarized in table  <dig> for the parameter sets 1- <dig>  the five first columns correspond to the excess risk ratio: 

  r=mad)/mad),fori= <dig> …, <dig> 

and the last column indicates the reference risk mad).

mean absolute deviation  of the background corrected intensities for methods s^, j= <dig> …, <dig> divided by the mad for the theoretical normal-gamma bgc with the true parameters ), from the simulation data set . column 1: normal-gamma, column 2: normexp-mle, column 3: normexp-rma, column 4: normexp-np, column 5: background subtraction. the mad of the theoretical normal-gamma deconvolution with the true parameters is given as reference in column  <dig> 

the normal-gamma bgc provides the same quality when the parameters are known or estimated. this holds when the data are generated either from a normal-gamma or a normexp model. normexp-np shows good behaviors when the data come from a normexp model but has a risk increase of order 60% if the data come from a normal-gamma model. normexp-mle provides good results for normal-exponential data but fails when the data come from a normal-gamma model. not surprisingly, as already pointed by xie et al <cit> , normexp-rma has a poor behavior. the background subtraction method with a maximal quality loss of 32% offers an acceptable alternative in terms of risk. indeed, most of the intensities being small, putting them to  <dig> does not affect significantly the mad value. let us recall, however, that from a practical point of view, the major disadvantage of background subtraction is the elimination of a considerable number of probes.

in practical experiments, the data are usually transformed before the analysis. to address this issue, the mad is computed on log-transformed intensities , and the excess risk ratio is displayed in table  <dig>  the normal-gamma bgc presents a smaller error of estimation than the methods based on the normexp model. the mad from normexp-mle generates the highest value, and normexp-rma and normexp-np show a a similar moderate excess risk. nevertheless the differences between the bgc methods are less pronounced than the one observed at the raw scale. however, with an excess risk ratio between 16% and 33%, the normexp methods notably under perform the bgc based on the normal-gamma model in terms of signal estimation.

mean absolute deviation  of the background corrected intensities for methods s^, j= <dig> …, <dig> divided by the mad for the theoretical normal-gamma bgc with the true parameters ), from the simulation data set . column 1: normal-gamma, column 2: normexp-mle, column 3: normexp-rma, column 4: normexp-np.

the mad computation offers a global comparison of the various bgc methods in terms of signal estimation. we refine this analysis by examining the absolute deviation  of the estimated signal for each signal intensity at the raw and log scales, respectively defined as: 

 ad=1n∑ℓ=1ns^−sjℓ 

 ad)=1n∑ℓ=1nlogs^−logsjℓ 

the first row of figure  <dig> displays the logarithm of the ad at the raw scale, as a function of the log-signal intensity. we observe that normexp-mle presents a larger ad for all values of the signal. on small intensities, the normal-gamma bgc outperforms the other methods, whereas normexp-rma and normexp-np present a smaller deviation on moderate intensities. for high values of the signal, normal-gamma shows a smaller error of estimation together with normexp-np.

the absolute deviation on log-transformed intensities is presented on the second row of figure  <dig>  the normal-gamma bgc still presents the smallest error of estimation on weak intensities, but is outperformed by the other methods on moderate intensities. the four methods present similar ad values on high intensities. besides, we observe than the error of estimation for all methods increases as the signal become weaker.

robustness
in section “previous modelings”, we have underlined the slightly heavier right tail of the negative probe distribution. to ensure that the estimation remains acceptable under the assumption of an imperfect noise parametrisation, we compare the robustness of the normal-gamma method with normexp-np, stated as the most robust by  <cit>  and which we found competitive . the errors of estimation computed from the simulation data set  are presented in additional file 1: section  <dig>  both methods are robust with respect to non-normal noise distribution, and the normal-gamma bgc still offers a better quality of estimation than normexp-np when the noise distribution departs from normality.

in conclusion, the normal-gamma background correction globally offers a better quality in signal estimation with respect to the normexp methods. nevertheless, this improvement depends on the scale considered and does not steadily hold over the range of intensities.

operating characteristics
beyond the quality of estimation of the signal, the performance of a bgc procedure in practical experiments depends on its characteristics in terms of bias and variance. in this section, we compare the operating characteristics of the normal-gamma and normexp bgc both on simulated and spike-in data. the results are gathered in figure  <dig>  the background subtraction leading to probe deletion is not further considered. the data from  are background corrected with the methods  <dig> to  <dig> described in section “background corrected intensity”. quantile normalization based on both regular and negative probe intensities is applied, followed by log-transformation. the same procedures are implemented on the simulation data sets  and .

bias-precision trade-off
the quality of a pre-processing method in microarray experiments can be characterised by its ability to distinguish between distinct values of the signal. most of the procedures underestimate the signal fold-changes. this bias in fold-change estimation, called compression, has a negative impact on differential analysis. but the efficiency of a pre-processing method also depends on its precision, characterised by the variations of the corrected intensity for a given value of the signal. the trade-off between bias and precision is an indicator of the performance of a procedure. this issue can be understood by the example of a t-test statistic for a given probe differentially expressed between two groups: an important compression attenuates the difference of average intensities between the two groups, whereas a poor precision generates a high variance term in the denominator, which reduces the value of the test statistic.

the compression and precision obtained with the four bgc methods on the data set  are presented on the first row of figure  <dig>  the first column displays the average intensity over the  <dig> spike bead types for each spike concentration. a similar saturation effect is observed for large concentrations with the four methods: for concentrations larger than 100pm, the relationship between log-intensity and log-concentration is not linear. moreover, as the concentration decreases, a compression of the signal is observed with all the methods, but is significantly less pronounced with the normal-gamma bgc.

the second column presents the average standard deviation between replicates over all spike bead types. we observe that the improvement in bias brought by the normal-gamma model is at the cost of a poorer precision. more generally, the precision increases with the compression for the four methods.

innate offset
shi et al <cit>  highlight the role played by the ”innate offset”, defined as the typical intensity assigned to the non-expressed genes by a pre-processing procedure, in the unbalanced bias-variance trade-off of the various bgc methods: the strategies which show the smallest innate offset usually generate less bias but present a poorer precision. on spike-in data sets, the innate offset is defined as the mean of the intensities measured on spike probes with concentration zero. the results displayed in table  <dig> confirm the observations from shi et al <cit> : as underlined above, the normal-gamma bgc exhibits the smallest precision associated with the smallest bias with a slope from the linear regression of intensities on log-concentrations close to  <dig>  the largest offset combined with the highest precision and the largest bias are observed for normexp-mle. 

innate offset, average standard deviation of spike replicates and slope of the linear regression of the spike average intensity on the log-concentration.

shi et al <cit>  propose to compare the pre-processing methods in a more equal way by adding an offset to the background-corrected quantile-normalised intensities before log-transformation, in order to align the innate offsets of the various pre-processing strategies. our results presented in additional file 1: section  <dig> , indicate that the characteristics between the four bgc present more similarity after equalizing the innate offsets, but a slight difference remains between normexp-mle and the other bgc methods on small intensities. nevertheless, prior to the offset equalisation, the methods studied in this paper do not present the large range of bias-precision trade-offs observed in the pre-processing strategies considered in  <cit> . in this context, the equalisation of the innate offsets does not appear sufficient to completely erase the differences between bgc methods.

operating characteristics on simulated data
in order to reinforce the validation of the normal-gamma parametrisation for the noise-signal distribution, we compare the operating characteristics obtained on spike-in data to the ones provided by the normal-gamma simulated data from set . the spike concentration, used as references to assess the bias and precision of the procedures on spike-in data, is replaced by the true value of the signal. the results are displayed on the second row of figure  <dig>  the first column presents the average intensity as a function of the signal log-intensity, and the standard deviation of the replicates is shown in the second column. the trends are very similar to the ones observed on spike-in data, with a small difference for the variance with normexp-rma. besides, we observe that the compression in small intensities generated by the four bgc methods is purely a statistical effect. however, the signal attenuation in high intensities observed on spike-in data is not present on simulated data. indeed, it has already been suggested that this phenomenon could come from saturation in light intensity on microarrays.

furthermore, we address the departure from normality observed on the negative probe distribution by simulating microarrays with a gamma distributed signal and a non-normal background noise ). in order to get a realistic noise distribution, the background noise and the negative probe intensities are sampled from the quantile-normalised negative probe intensities from all arrays in  . the operating characteristics of the four bgc methods are presented on the third row of figure  <dig>  we observe that the slight difference between normal-gamma simulations and spike-in data with normexp-rma, observed on the second row of figure  <dig>  is partially corrected by generating a non-normal background noise.

the same quantities are computed based on normal-exponential simulated data with parameter sets  <dig> and  <dig>  the results are displayed on the fourth row of figure  <dig> for set  <dig>  and on figure g in additional file  <dig> for set  <dig>  the comparison between the operating characteristics of the four bgc methods are absolutely not consistent with the observations from the spike-in data. in particular, the normal-exponential simulated data provide almost identical bias and precision curves for normal-gamma, normexp-np and normexp-mle, whereas these methods exhibit notable differences on spike-in data.

the parallel drawn between the operating characteristics of the four bgc methods on spike-in and simulated data confirms that the gamma model represents a much more accurate parametrisation for the signal distribution than the usual exponential model.

differential expression analysis
the bgc methods are compared from a practical point of view through a differential expression analysis performed on the dilution data set , based on the hierarchical linear model approach from smyth  <cit>  implemented in the limma package. this procedure provides p-values from a moderated t-statistic. a first analysis is run on the two pure samples  to define the ”true” differentially expressed  and non-differentially expressed probes. a second differential expression analysis performed on the two mixed samples  is used to assess the performance of the bgc methods. the moderated t-test statistic implemented in the limma package includes a variance term representing the variation of the gene intensity across all arrays, as well as hyperparameters computed from the whole data set intensities. therefore, in order to get independent results, the two analyses are performed on separate linear models.

the estimate proportion of de probes in pure samples computed with a convex decreasing density procedure  <cit>  is 28% for all methods. thus, in order to be conservative, we define the probes with the 20% smallest p-values as ”true de”, and the probes with the 40% highest p-values as ”true non-de”. moderated t-statistic values are then computed from the comparison of the two mixed samples. the p-values from true de and non-de probes are ordered. the area under the roc curve  is used to quantify the sensitivity of each bgc method, the largest value of the auc corresponding to the highest sensitivity. the four methods present similar auc values but the normal-gamma bgc is slightly less competitive.

a similar analysis is run with the addition of an offset prior to log-transformation. figure  <dig> displays the auc values as a function of the added offset with each bgc method. the values observed for an offset equal to zero correspond to the sensitivity when a simple log-transformation is applied. as already highlighted by shi et al <cit> , we observe that the addition of a moderate offset increases the sensitivity of all bgc methods. for any value of the offset, the normexp methods outperform the normal-gamma. the results obtained with the different normexp bgc methods are very similar, but we note that the highest sensitivity is achieved with normexp-rma for offsets smaller than  <dig>  and with normexp-mle for offsets larger than  <dig>  

the bgc methods can also be compared regarding their ability to order a set of measured intensities corresponding to increasing or decreasing probe concentrations. this framework can refer, for example, to a longitudinal study where the gene expression is repeatedly measured at different times. the correlation between the mixture proportion and the intensity is analysed on the dilution data set . for the true de probes, the intensity is expected to be increasing or decreasing with the proportion.

the dilution data sets  and  are based on the same pure biological samples. therefore, true de and non-de probes defined on  can be considered in the analysis of the data from . the beadchips used in experiments  and  are different, but some bead types are present on both devices. by mapping the annotation files from both beadchips, the sets of probes respectively defined as de and non-de on , and present on  are extracted.

for each probe, the spearman correlation coefficient is computed between the vector of mixture proportions and the observed intensities. this provides a test statistitic based on the ranking of the background corrected intensities, which allows a comparison of the bgc methods independently from the scale at which the data are analysed, provided that the transformation applied to the data is increasing. in particular, the results are not affected by the addition of an offset. the correlation coefficient is computed separately on microarrays with starting rna quantities 250ng, 100ng, 50ng and 10ng. the coefficient is expected to be close to  <dig> in absolute values for the de probes, and close to  <dig> for the non-de. the probes are ranked according to their correlation coefficient value, and the resulting aucs for each starting rna quantity are displayed in table  <dig>  we observe that the normal-gamma bgc is slightly but steadily less sensitive that the other methods. the aucs observed with the different normexp estimates are very similar and do not allow to assess the superiority of one method over the others.

auc from spearman correlation test between the proportion and the intensity in the dilution data set , for the four bgc methods, and the four rna starting concentrations.

CONCLUSIONS
in many microarray experiments, background noise correction is an important issue in order to improve the measurement precision. model-based background correction procedures have been developed as an alternative to the default background subtraction from illumina beadstudio which has proved to remove informative probes. the usual normal-exponential model considered for the noise-signal distribution has already been pointed out as inappropriate for illumina beadarrays  <cit> . our observations confirm this result by highlighting the poor fitting of the normexp reconstructed densities on observed intensities with three different parameter estimates. we propose an alternative model based on a more flexible parametrisation of the signal which is assumed to follow a gamma distribution, as well as the associated background correction. the reconstructed density offers a better fit of the distribution of the observed intensities, validating this new model as more appropriate for illumina microarrays. moreover, the estimators based on the normal-gamma model are likely to apply to other microarray technologies including affymetrix and single color agilent, as an extension of the normexp model.

we compare the performance of the background correction procedures based on the normal-gamma and normal-exponential models on simulated and experimental data sets. our simulation study indicates that the normal-gamma model brings an overall improvement in terms of signal estimation, characterised by a smaller average difference between the true signal and the background corrected intensity. but surprisingly, the differential expression analysis run on two dilution data sets shows that the improvement in terms of parametrisation does not have a positive impact on practical experiments, the normal-gamma correction exhibiting a slightly poorer sensitivity than the normexp methods. this result may be explained in two ways.

on one side, the operating characteristics of the background correction procedures are compared on a set of spike-in data, which allow to connect the probe intensity with the concentration of the target gene in the biological sample. we note that the normal-gamma model generates less bias than the normexp methods, but at the cost of a loss in precision. with the addition of an offset prior to the log-transformation, which provides balance in the bias-precision trade-off of the different methods, the operating characteristics appear similar, suggesting comparable performance.

on the other side, we examine the error in signal estimation as a function of the signal on log-scale simulated data. the normal-gamma model outperforms the other methods on small intensities, but is less competitive on moderate intensities. due to the marked compression of the recovered intensity when the signal decreases, the improvement in terms of signal estimation for the small intensities has a weak effect on the differential expression analysis. thus, the smaller average error of estimation observed with the normal-gamma background correction does not result in a higher sensitivity in practical experiments.

besides, the parallel drawn between the operating characteristics of the different background corrections obtained, on the one hand with spike-in data and on the other hand with normal-gamma simulated data, highlights high similarities. the simulations from the normal-gamma model recover subtile differences between background correction procedures, whereas simulations from the normexp model totally fail to reproduce the trends observed on spike-in data. these considerations enhance the validation of the normal-gamma model for illumina microarrays, and illustrate the potential of the normal-gamma simulations for the comparison of pre-processing procedures. furthermore, the similarities between the observations from spike-in and simulated data are increased by sampling the background noise from the empirical negative probe distribution which suggests that an improvement in modeling could be brought by a non-normal parametrisation of the background noise.

in conclusion, this paper addresses the lack of fit of the usual normal-exponential model by proposing a more flexible parametrisation of the signal distribution as well as the associated background correction. this new model proves to be considerably more accurate for illumina microarrays, but our results indicate that the improvement in terms of modeling does not lead to a higher sensitivity in differential analysis. nevertheless, this realistic modeling makes way for future investigations, in particular to examine the characteristics of pre-processing strategies.

endnote
ahttp://www.bioconductor.org

competing interests
the authors declare that they have no competing interests.

authors’ contributions
the nowac data were provided by el, principal investigator of tice project. statistical and computational aspects were developed by sp and yr. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary material  <dig> provides a description of the simulations, computing details and additional figures.

click here for file

 additional file 2
supplementary material  <dig> gathers the scripts used to produce the tables and figures.

click here for file

 additional file 3
supplementary material  <dig> is a zip file which contains three text files with the observed intensities of the ten microarrays from data set .

click here for file

 acknowledgements
the authors thank gregory nuel for fruitful discussions on numerical issue.

fundings
grant: erc-2008-adg 232997-tice “transcriptomics in cancer epidemiology”.
