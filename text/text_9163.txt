BACKGROUND
with the advent of high-throughput genotyping technologies, it is now relatively easy to obtain large-scale, genome-wide data concerning single-nucleotide polymorphisms  in humans. this allows for more thorough analyses of questions that involve population genetics. multiple snps often cover or flank functionally important genes, such as human leukocyte antigen  genes that comprise the major histocompatibility complex  in humans. the hlas localize to chromosome 6p and include mhc class i  and mhc class ii  genes. unlike bi-allelic snps, hla genes are extremely polymorphic. currently, more than  <dig> alleles for the hla loci have been identified in various populations, including  <dig> hla-b alleles according to the imgt/hla database  <dig> . <dig> version  <cit> . mismatched hla alleles can lead to graft rejection and graft-versus-host diseases  <cit> . hla genes also play critical roles in both population genetics and immune-related disease status  <cit> . furthermore, previous comparative studies have shown that immune systems are generally under strong selective pressures, which are likely driven by virus-host interactions  <cit> . because of these selective pressures, comparisons between ethnic groups reveal linkage disequilibrium and highly variable patterns of allelic distributions for hla genes  <cit> .

the taiwanese comprised the minnan and hakka people groups. the genetic profile of the taiwanese shows many affinities to southern asian populations  <cit> . hla-b* 4601/b <dig> displays higher frequencies in southern han , singaporean  and vietnamese  than in northern han   <cit> . there were a few studies that have focused on the association between hla markers and disease using southern han chinese data. most of the studies found them a homogeneous group  <cit> .

recent advances in array-based snp genotyping technologies have led to a revolution in the nature and scale of disease-association studies. these developed technologies yield economical ways to genotype one million snps across the entire genome in large-population studies. to date, direct experimental methods for typing hla genes  remain laborious, expensive, and time consuming. this has limited large-scale studies involving hlas <cit> . to reduce the cost of these studies, researchers have begun to use data from snps around the hla regions to make predictions concerning hla allele types  <cit> . leslie et al.  <cit>  developed a statistical method based on identity by descent, which uses phase-resolved genotype data  to predict hla alleles. li et al.  <cit>  proposed a complementary method for predicting hla alleles based on unphased genotype data. given a training data set of unphased genotypes and their corresponding phased hla alleles, they used a likelihood method to compute probabilities associated with all possible pairs of hla alleles and their particular haplotypes. because of high-throughput snp-genotyping technologies, the method developed by li et al.  <cit>  analyzes many less-common hla alleles. this results in more accurate predictions concerning hla alleles.

after a decade of research, hla prediction methodologies have achieved a high level of accuracy. for classical hla class i and class ii genes, there is typically a 97% accuracy when caucasian populations are analyzed  <cit> . these types of studies, however, have not been rigorously applied to other ethnic groups  <cit> . zhang et al.  <cit>  revealed that predictive accuracies were poor if hla alleles from non-caucasian subjects were used as the training data set to build predictive hla models for different ethnic groups. hence, the african-specific hla-prediction model has been developed  <cit> . unfortunately, there is very little information concerning hla allele prediction in han chinese populations. this need must be addressed before effective, ethnic-specific prediction model of hla genes can be formulated.

leslie et al.  <cit>  achieved a high level of accuracy using data from the haplotype map  project as the training data. they validated their hla-prediction model using genotypes and hla allele information from the british  <dig> birth cohort study. unfortunately, genotype datasets with densities that approach the hapmap project are not commonly available. as such, the use of chip data may represent an alternative method for constructing prediction model of hla genes that are specific for han chinese populations.

toward this goal, we applied the li et al.  <cit>  method to samples from taiwan to build ethnic-specific prediction model of hla genes for han chinese populations. this study comprised  <dig> han chinese with affymetrix  <dig>  and illumina 550 k snps, of whom  <dig> also had data on affymetrix  <dig>  snps. all individuals were hla typed at a 4-digit level resolution at  <dig> hla loci and were used for training and testing the prediction model of hla genes. to optimize these prediction models for classical hla class i and class ii genes, we addressed the following questions: 1) would there be differences in hla allele distributions and optimal flanking regions between our han chinese data set and the hapmap caucasian samples, 2) could mhc snp data generated by different platforms yield comparably accurate hla allele predictions, and 3) could imputation of untyped mhc snps improve the accuracy and robustness of the model? we provide practical recommendations concerning ethnic-specific prediction model of hla genes regarding hla gene regions, platforms, and imputation.

methods
ethics statement
blood samples from  <dig> han chinese subjects residing in taiwan were obtained from the taiwan han chinese cell and genome bank  <cit>  and were used for this analysis. this study was approved by the internal review board of academia sinica. a written informed consent was signed by every participant at his/her initial clinic visit. all individuals in this study were han chinese. all participants in this study have full han ethnicity through both maternal and paternal grandparents and familial residence in the area of taiwan for the last  <dig> generations. our data consisted of three taiwanese subgroups: minnan , hakka  and mainlanders . in one of our previous study for mhc snps in han chinese residing in taiwan, we have shown that the taiwanese population is homogeneous  <cit> .

dna samples and mhc snp data
genomic dna was extracted from blood using the puregene dna isolation kit . four hundred and thirty seven samples were genotyped using the affy  <dig>   and the illumina 550 k chips . two hundred fourteen of these samples were also genotyped using the affy  <dig>  chip. the affy  <dig>  chip contains  <dig>  snps on chromosome  <dig> among  <dig>  snps across  <dig> chromosomes. the affy  <dig>  chip contains  <dig>  snps on chromosome  <dig> among  <dig>  snps across  <dig> chromosomes. the illumina 550 k chip contains  <dig>  snps on chromosome  <dig> among  <dig>  snps across  <dig> chromosomes. the national center for genome medicine at academia sinica carried out all genotyping. all of the sample call rates were > 97%, and the mean individual-sample call rate was  <dig>  ±  <dig> %.

within the extended human mhc region, which includes ~ <dig> megabases  on chromosome 6p , the affy  <dig>  chip contains  <dig>  snps, the affy  <dig>  chip contains  <dig>  snps, and the illumina 550 k chip contains  <dig>  snps . the intra-mhc region spanning the hla-a gene at the telomeric end and the hla-dpb <dig> gene at the centromeric end actually harbors class iii genes , in addition to both class i loci  and class ii loci .

hla genotyping
hla genotypes were observed from our previous study  <cit> . briefly, six classic hla genes  to a 4-digit resolution were analyzed in the present study. among these genes, the hla-a, -b, –c, -dqb <dig>  and -drb <dig> alleles were genotyped using the dynal reli sso typing kit . in brief, both exon  <dig> and exon  <dig> of class i genes  and exon  <dig> of class ii genes  were amplified by pcr using locus-specific primer sets. after amplification, pcr products were hybridized to sequence-specific oligonucleotide  probes that had been previously fixed to a nylon membrane in a linear array. sso probes included  <dig> hla-a probes,  <dig> hla-b probes,  <dig> hla–c probes,  <dig> hla-dqb <dig> probes, and  <dig> hla-drb <dig> probes. the pattern-matching program  was used to interpret genotypes. because the dynal reli sso system lacked an hla-dpb <dig> genotyping kit, hla-dpb <dig> was genotyped using the gold ssp hla-dpb <dig> high resolution kit . this genotyping technique is based on the sequence-specific primer amplification method. the hla-dpb <dig> genotyping was based on  <dig> pcr reactions for each dna sample. the unimatch software  used the pattern of pcr amplification to interpret hla-dpb <dig> genotypes. while medium to high resolution typing results were obtained from those reverse sso typing systems, several genotype combinations produced same reaction patterns. for these conditions, allele designation were assigned according to the most common alleles  found in taiwanese populations and southern chinese populations as determined in the population studies of 13th international histocompatibility workshop or to the allele with the lowest definition number. the four digit alleles detected at each hla locus and allele frequencies in our han chinese data  were listed in additional file  <dig> 

hla prediction methodology
to build prediction model of hla genes using unphased genotypes, we adopted an estimating equation approach  <cit> . for each gene, the hla-predictive methodology was then carried out as two separate procedures. the first procedure constructed a prediction model, whereas the second procedure validated the model generated by the first procedure. in the first procedure, a set of unphased genotypes was selected to build a prediction model. this selection process was evaluated using an objective function  <cit> , which was the negative log-likelihood of the hla allele given unphased genotypes   <cit> . genotype selection was then performed using the forward-selection and backward-elimination scheme. this started with genotypes associated with an hla allele and we gradually added one genotype at a time. the second procedure validated the prediction model using an independent set of samples. for these independent samples, unphased genotypes and phased hla alleles were provided. following the parsimonious rule, the best prediction model should use the smallest possible flanking region and the fewest possible snps to generate the most accurate predictions.

scenarios
differences in hla allele frequency distributions and flanking-region sizes between ethnic groups
hla alleles and their allelic distributions differ substantially between ethnic groups, reflecting their recent evolutionary histories  <cit> . furthermore, hla genes cover different regions on chromosome 6p and include various numbers of snps  <cit> . here we explored allele frequency distributions within our han chinese samples and within caucasian samples from the hapmap project  <cit> . for each hla allele, we used chi-square and fisher’s exact tests to determine whether hla allele proportions were different between these two populations. following li et al.’s  <cit> , we assessed flanking regions that extended ±10 kb to ±400 kb to construct the prediction model of hla genes. within the han chinese population, the most appropriate flanking region for each hla gene was determined using the parsimonious rule described above. furthermore, we compared flanking-region sizes derived from our han chinese population  with flanking-region sizes from the caucasian population in li et al.’s  <cit> .

different platforms
three platforms were used in this study: 1) the affymetrix genome-wide human snp array  <dig>    <cit> , 2) the affymetrix genome-wide human snp array  <dig>  , and 3) illumina’s humanhap <dig> genotyping beadchip   <cit> . to measure the compatibility between these platforms we compared overlapping snp data from each pair of platforms. genotype data concordance was computed using cohen’s kappa coefficient  <cit> , a measurement commonly used to assess the degree of concordance between two independent groups  <cit> . values of kappa >  <dig>  generally indicate excellent reliability  <cit> . for each platform pair, genotype concordance was evaluated between all observed snps and all imputed snps. for each pair, we also compared variation between genotypes that were selected during the hla model-building process. this was done to determine whether selected genotypes were platform specific. variation was defined as ∪plati,platj−∩plati,platj∪plati,platj, where plat
i
 and plat
j
 are two different platforms, ∪ is the union of the snps for two different platforms, and ∩ is the intersection of the snps for two different platforms.

imputation
“genotype imputation” is the term used to describe the process of imputing genotypes that are not directly assayed in a sample of individuals  <cit> . genotype imputation has become a routine practice in genome-wide association studies . here we evaluated the usefulness of imputed genotypes in constructing prediction model of hla genes. for data consistency and optimal-imputation performance, we used the mach  <cit>  software and the chinese han beijing  + japanese tokyo  data set  <cit>  as a reference. this was used to impute genotypes beyond our snps, which were derived from the hapmap project. standard gwas quality-control filters  are usually sufficient before genotype imputation  <cit> . we applied these recommendations, therefore, and checked our genotype data for all snps within the mhc region. furthermore, each imputed snp that were included in this study should have an imputation posterior probability from mach >  <dig> , call rate >  <dig> , and minor-allele frequency >  <dig> . the three steps used for genotype imputation were as follows: 1) apply standard gwas quality-control filters to our mhc snps, 2) use mach software to impute genotypes beyond mhc snps that were determined in step  <dig>  and 3) check the imputation posterior probabilities from mach for the imputed snps that were determined in step  <dig> 

cross-validation
before beginning the hla prediction analysis, we divided the data into multiple partitions for cross-validation . all  <dig> individuals were hla typed at a 4-digit level resolution at  <dig> hla loci and were used for training and testing the prediction model of hla genes. we used a 10-fold cv in the study, the data set was divided into a training data set  and a testing data set . the testing accuracy was assessed according to the comparison between the original hla alleles and predictive hla alleles for each sample. if the pair of hla alleles between the original hla alleles and predictive hla alleles was the same, the predictive value was assigned  <dig>  if a half pair of hla alleles was the same, then the predictive value was assigned  <dig> , else it was assigned  <dig>  for each cv subset, the testing accuracy was calculated for the testing set and defined as tvnv , where t
v
 is the number of correctly predicted samples  in the testing set and n
v
 is the total number of samples in the testing set. the average testing accuracy is the mean of the  <dig> cv subsets and indicates how well the constructed hla model predicts the hla alleles. the hla prediction can be performed without cv, but cv execution can avoid over-fitting the prediction model and can save both time and costs associated with attaining an independent set of samples for validation  <cit> . we built prediction model of hla genes, therefore, using 10-fold cv.

confidence threshold 
for each sample within the testing data set, probability values were assigned to each possible pair of hla alleles given a particular haplotype. these values were based on the provided unphased genotypes and phased pairs of hla alleles. after assigning probabilities, we selected the pair with the maximum probability, if that probability exceeded a pre-specified ct. when ct is set to be  <dig>  it means that the call rate is 100% . if ct is set to be  <dig>  , only samples for which the maximum predictive probability exceeds ct will be used. here we set ct to be  <dig>   <dig> , or  <dig>  to evaluate the effects of ct on constructing prediction model of hla genes. if a higher ct is applied, the prediction model of hla gene results in greater prediction accuracy.

RESULTS
hla allele frequency distributions and flanking-region sizes
we calculated allele frequency distributions for the six classical hla genes using  <dig> samples that were genotyped using three different genomic platforms . analyzed samples were from han chinese subjects living in taiwan provided by the han chinese cell and genome bank  <cit> . we also analyzed  <dig> caucasian samples from the hapmap project, although hla-dpb <dig> data were not available for these samples. the caucasian samples from hapmap were ceph samples and only founders were included. the most polymorphic hla locus was hla-b. across the hla-b region, we observed  <dig> alleles in our han chinese population and  <dig> alleles in the hapmap caucasians. to address the issue of a sparse contingency table, the allele frequency for hla-a, -b, –c, -dqb <dig>  and -drb <dig> genes between caucasians and han chinese was compared using program clump   <cit> . all distribution differed significantly between the caucasians and han chinese at the adjusted 5% level using bonferroni’s correction. we confirmed the previous finding, therefore, that hla allele frequency distributions differ extensively across populations. as such, predictive hla models that are built using hla alleles from one population may generate poor predictions concerning a different ethnic population. ethnic-specific prediction model of hla genes are generally preferred  <cit> .

using the hla-predictive methodology described above, we evaluated testing accuracies given various flanking-region sizes following li et al.’s  <cit> . we assessed flanking regions that were extended from ±10 kb to ±400 kb . within the han chinese population, the most appropriate flanking region for each hla gene for prediction was determined using the parsimonious rule. for most of the prediction models , trends in the data indicated that more-accurate results were obtained when larger flanking regions were used . the number of predictive snps selected also increased with the size of the flanking region. the most dramatic effects on testing accuracy were observed for hla-drb <dig> and hla-dqb <dig>  when a ±10 kb flanking region was used, hla-drb <dig> yielded the lowest testing accuracy . this accuracy increased to >85% when the flanking region was increased to ±50 kb. for hla-dqb <dig>  testing accuracy ranged from  <dig> %  to  <dig> % . once the size of the flanking region increased to ±30 kb, the testing accuracy of hla-dqb <dig> increased to >90%. testing accuracies for hla-c  and hla-dpb <dig>  were satisfactory at ±10 kb. notably, testing accuracies for hla-a  and hla-b  were particularly low with ±10 kb flanking regions. using the size ± 150 kb, however, raised the accuracy to >80% for both genes. flanking-region results across the different genotyping platforms  are provided in additional file  <dig> 

we also compared flanking-region sizes derived from our han chinese population with those from the caucasian population described previously by li et al.’s  <cit> . hla-a gene required the largest flanking regions . for hla-c, a ±20 kb region leads to an accuracy of  <dig> % which is the best model by our definition for the han chinese, however, it was ±180 kb for the caucasian population . the size difference in the optimal flanking region was even more dramatic for hla-dqb <dig>  which was ±40 kb for the han chinese and ±300 kb for the caucasians. the comparisons of flanking region were based on affy  <dig>  chip  which was used by li et al.’s  <cit>  . d’ values was also listed in table  <dig>  the flanking region sizes from caucasian described previously by li et al.’s  <cit>  were different from ours  probably due to population stratification. from our chip data, the range of the highest d’ for the hla markers was between  <dig>  and  <dig>  without imputation. it was  <dig>  to  <dig>  with imputation. hla-c had the highest d’ regardless of imputation and platform while hla-dpb <dig> had the lowest d’. hla-a had the longest flanking region regardless imputation or not while hla-dqb <dig> had the shortest flanking region. the length of the hla gene and the ld intensity is negative. however, the ld intensity might not be related to the flanking region size for the optimized predictive models for each platform .

 <dig> 

5
1
1
1based on ncbi build  <dig> .

2flanking region for the most accurate prediction model.

3number of snps within the region that were selected for the model .

4total number of snps in the mhc and hla regions.

5hedridge’s multialleic d.

predictive accuracies without imputation
the overlapping data between each pair of platforms was quite few . affy  <dig>  had the most snps within the mhc regions, whereas affy  <dig>  had the fewest . additional file  <dig> shows kappa coefficients between paired platforms, with respect to observed genotypes. comparing the two affymetrix arrays, the kappa coefficient was as high as  <dig>  for the genotypes present on both arrays. this high level of concordance indicated high-quality genotyping, which was further supported by the determination of comparable genotypes between platforms.

in general, union generated more accurate hla-allele predictions than did each of the individual platforms. for ct =  <dig>  the average testing accuracy was  <dig> % with union, but  <dig> %,  <dig> %, and  <dig> % for affy  <dig> , affy  <dig> , and illumina 550 k, respectively . these findings were consistent with zhang et al.  <cit> , who suggested that higher snp densities increased the accuracy of hla-allele predictions.

in comparisons between the three genotyping platforms, affy  <dig>  generated the most-accurate hla-allele predictions. for example, affy  <dig>  was  <dig> % more accurate than affy  <dig>  at the hla-drb <dig> locus; and affy  <dig>  was  <dig> % more accurate than illumina 550 k at the hla-dpb <dig> locus. it was possible that affy  <dig>  did have the highest density of genotypes within the mhc region. for ct =  <dig>  the overall highest testing accuracy was obtained with affy  <dig>  and hla-dqb <dig> , whereas the lowest accuracy was from illumina 550 k and hla-b . by applying a ct of  <dig>  to the maximum probability of all possible pairs of hla alleles, the highest accuracy was increased to  <dig> % at the hla-c locus , whereas the lowest accuracy was elevated to  <dig> % at hla-b . the range of accuracies generated by illumina 550 k-based prediction models was more dramatic across hla loci than was seen with the other genotyping platforms. with ct =  <dig>  the accuracy of the illumina 550 k prediction model was only  <dig> % at the hla-b gene but was  <dig> % at hla-dqb <dig>  the affy  <dig>  predictions were  <dig> % and  <dig> % more accurate than illumina 550 k for the hla-b and hla-dpb <dig> genes, respectively. illumina 550 k predictions were  <dig> % and  <dig> % more accurate than affy  <dig>  for the hla-a and hla-drb <dig> genes, respectively . these results agreed with zhang et al.’s  <cit> , who showed that slight improvements associated with affy  <dig>  and illumina 550 k may be attributed to unique snps on these platforms. overall, accuracies of these prediction models were generally comparable across genotyping platforms. details concerning testing-accuracy results and the call rate for predictions across different platforms and different cts are provided in additional file  <dig> 

the investigation into the sufficient flanking regions  was performed. the shortest sufficient flanking region was identified at the hla-c locus using illumina 550 k . the length of hla-c was  <dig>  bp and this sufficient flanking region covered  <dig> snps, of which  <dig> were incorporated into the hla-c-prediction model . the longest sufficient flanking region was ±350 kb at hla-a when affy  <dig>  data were used . within this region, there were  <dig> snps, of which  <dig> were incorporated into the hla-a-prediction model .

for each hla gene, we further assessed between-platform overlap of the genotypes which were incorporated into the hla prediction model . the largest percentage of overlapping genotypes for data without imputed snps was  <dig> % at hla-drb <dig> when affy  <dig>  and union were compared. these findings suggest that different platforms might use unique snps to select platform-specific genotypes. these genotypes were then used to build the different prediction model of hla genes. we listed the snps that best predict the hla alleles using the genotype information currently available from different platforms  and listed the alleles of the snps that predict hla allele types .

predictive accuracies with imputation
we also performed comparisons between each pair of genotyping platforms to assess the concordance of snps with imputation. the kappa coefficients were at least  <dig>  for these measurements, which were based on the genotypes originally observed and then imputed on affy  <dig>  and illumina 550 k . these results implied high imputation quality and comparable genotypes across the platforms.

in general, union  generated more-accurate hla-allele predictions than the three individual platforms . as such, higher snp densities may increase the accuracy of genotype imputation and, therefore, the accuracy of the final prediction. these results are consistent with zhang et al.’s  <cit> . however, illumina 550 k and affy  <dig>  sometimes yielded better accuracy than the union arrays in our results. one of the possible reasons might be due to “non-concordance” among these platforms. the kappa coefficients ranged from  <dig> % to  <dig> % . it’s likely that those with low concordance genotypes might decrease imputation accuracies.

in the comparisons between the three genotyping platforms with imputation, affy  <dig>  predictions were generally more accurate for hla alleles . among these models , the hla-dqb <dig> locus had the highest testing accuracy , whereas the hla-b locus had the lowest . by applying a ct value of  <dig>  to the maximum probability of all possible pairs of hla alleles, the highest accuracy was increased to  <dig> % at the hla-c locus , and the lowest accuracy was increased to  <dig> % at the hla-a locus . besides hla-b from affy  <dig> , accuracy improvements based on this ct adjustment were most dramatic for the hla-drb <dig> gene, which rose from  <dig> % to  <dig> % when ct was changed from  <dig> to  <dig> . affy  <dig>  , however, generated a prediction that was  <dig> % more accurate than affy  <dig>  at the hla-a. besides hla-dpb <dig> , illumina 550 k generated predictions that were  <dig> %,  <dig> %,  <dig> %,  <dig> % and  <dig> % more accurate than affy  <dig>  at the hla-a, -b, -c, -dqb <dig> and -drb <dig> loci, respectively . these findings are consistent with zhang et al.’s  <cit> , which showed that prediction improvements from the affy  <dig>  and illumina 550 k array data may be attributed to snps that are exclusively represented on these platforms. details concerning testing accuracies and prediction call rates across different platforms and different cts are listed in additional file  <dig> 

for each hla locus, we also assessed the sufficient flanking region with imputation. one of the shortest flanking regions was identified by affy  <dig>  at the hla-dpb <dig> locus  . this region covered  <dig> snps, of which  <dig> were selected for the hla-dpb1-prediction model . the other shortest flanking regions were identified by affy  <dig> , illumina 550 k and union at the hla-c locus . the longest sufficient flanking region was ±200 kb at hla-a from illumina 550 k; table 1). within this region there were  <dig> snps, of which  <dig> were used in the hla-a-prediction model .

for each hla gene, the amount of overlap among genotypes used by the different prediction models was at most  <dig> % . imputation, therefore, seemed to reduce discrepancies among the different platforms.

differences in predictive accuracies with and without imputation
we performed comparisons between each pair of genotyping platform to assess overall concordance between snps with and without imputation. the lowest kappa coefficient was  <dig> , which was derived from affy  <dig>  genotypes . these results demonstrated high imputation quality, even though nearly  <dig>  snps within this 6-mb region were imputed from the affy  <dig>  chip.

comparisons of testing accuracies among prediction models with and without imputation across different platforms revealed that prediction models built with imputed snps were more accurate than those built without imputed snps . prediction improvements associated with imputation of the hla-drb <dig> alleles on affy  <dig>  were more dramatic than those seen with other hla genes across the three platforms. imputation at this locus elevated prediction accuracy from  <dig> % to  <dig> %. these results essentially agree with zhang et al.’s  <cit> , who suggested that more snps generally increased hla allele-prediction accuracy.

for ct =  <dig>  the union platform with imputation had the highest testing accuracy  for hla-dqb <dig> alleles, whereas illumina 550 k without imputation had the lowest testing accuracy  for hla-b alleles. by applying a ct of  <dig>  to the maximum probability of all possible pairs of hla alleles, the highest accuracy was elevated to  <dig> % at the hla-c locus with illumina 550 k . this ct adjustment increased the lowest accuracy to  <dig> % at the hla-b locus with affy  <dig>  .

comparing testing-prediction accuracies with and without imputation among the different platforms, indicated genotype variation generally decreased when imputed snps were used to build the prediction model of hla genes. for each hla gene among the different platforms, the percentage overlap among genotypes that were selected to build the models increased  <dig> % on average with imputation . these results may have stemmed from using a consistent set of hapmap snps, which could have minimized discrepancies among different genotyping platforms.

discussion
because classic technologies for the direct typing of hla alleles are economically infeasible, we instead applied a method developed by li et al.  <cit> , which identifies specific hla alleles based on their corresponding unphased genotypes. we used this method to build prediction model of hla genes for hla class i  and class ii  genes. we compared allele frequency distributions of hla genes between the han chinese from taiwan and the caucasian population  allele frequencies are different between our han chinese and the caucasian samples p <  <dig>  with chi-square and fisher’s exact tests. that is because some of the alleles are the same but just at different frequencies. the most polymorphic hla locus was hla-b. within the hla-b region, we identified more alleles in the han chinese population  than in the caucasian hapmap population . this allele frequency difference supports the use of the method of li et al.  <cit> , as well as the use of a taiwan-based data set to build ethnic-specific prediction model of hla genes for a han chinese population. we have built a number of models for predicting class i and class ii hla genes at a four-digit resolution and have examined critical parameters associated with these models . we found that our models accurately predict these alleles within a han chinese population. results from this study have direct implications for detailed analyses of hla-related disease associations.

hla genotypes were observed from our previous study  <cit> . briefly, six classic hla loci  to a 4-digit resolution were analyzed in the present study. we did not include dqa <dig> or drb <dig>   <dig>  and  <dig> in this study, partly because of the unavailability of genotyping kits and partly because that their ld with corresponding dqb <dig> or drb <dig> alleles would be too tight to be delineated. in some of our previous studies, we reported that hla-b*15: <dig> was highly associated with carbamazepine-induced stevens-johnson syndrome and toxic epidermal necrolysis  <cit> .

hla-b had the highest overlapping density between our han chinese and the caucasian population , the number of predictive snps was  <dig> for the former and  <dig> for the latter. among the  <dig> predictive snps, the number of the overlapping snps was  <dig>  hla-drb <dig> had the lowest overlapping density , in which, our han chinese required  <dig> predictive snps and the caucasian population required  <dig> predictive snps.

in an attempt to differentiate between the effects of the li et al.’s algorithm and the han chinese panel, we examined the hla predictive accuracies between the two algorithms proposed by li et al.  and leslie et al.  and found that the paper reported by li et al.  has shown that the hla predictive accuracies for the two algorithms were in general comparable using the british  <dig> birth cohort data. we also applied the li et al.’s method to hapmap ceu/ceph data, we compared the accuracies derived from li et al.’s method with those by leslie et al.’s we built hla-b and hla-dqb <dig> models  using leave-one-out cv adapted by leslie et al. with a ct of  <dig> , accuracy of hla-b was 100% from li et al. and 95% from leslie et al. for hla-dqb <dig>  accuracy was 99% from li et al. and 99% from leslie et al. therefore, we concluded that the prediction models were generally comparable for the two methods.

in this study, the snp genotype imputation is used as material preparation for the hla allele prediction. the imputation of the snp genotypes refers to increasing the snp density by adding snps that originally are not incorporated in the array chips but in the hapmap project data  + japanese tokyo  in our case). the hapmap project data mainly includes chinese han beijing  belonging to northern chinese han subgroup. imputation was carried out to increase the diversity of alleles covered in our training data and also help to boost the accuracy for predicting hla genotypes. the missing rate for our hla data was very low , therefore, no imputation was performed for the hla genotype data. here we determined whether a denser collection of snps would generate more-accurate hla allele predictions. the mach software, which we used to impute our chip data sets and thus build greater snp density, uses data from the hapmap project and/or the  <dig> genomes project  as references. we found that prediction model of hla genes that were built with imputation typically provided greater prediction accuracy, which underscores the positive effect of using a higher density of snps. therefore, it is possible to devise a new customized snp array that includes all of the selected snps consisting those of genotyped or imputed snps for the hla-prediction model to increase the prediction accuracy. additionally, we used our genotype data from affy  <dig>   to build hla-b and hla-dqb <dig> models  using a 2-fold cv. the imputation was carried out separately for training and testing data set. we then compared the results with those obtained by imputation simultaneously for the two data sets. the testing accuracy of hla-b for separated imputation was 90% and it was 89% for simultaneous imputation. for hla-dqb <dig>  the testing accuracies for separated imputation and for simultaneous imputation were both 96%.

by increasing ct to  <dig>  or  <dig> , levels of prediction accuracy approached 100% in our ethnic-specific prediction model of hla genes for han chinese populations . we analyzed the effect, therefore, of different reference data sets beyond our affy  <dig>  genotype data. when using the  <dig> genomes project as the reference at ct =  <dig>  we found that testing accuracy concerning the hla-c gene decreased by  <dig> % . similar trends were observed at the other five hla loci. rare snp variants within data from the  <dig> genomes project may have increased the number of mismatched genotypes under imputation.

to generate more-accurate prediction models, we varied sample sizes for both the training and testing data sets. we used our genotype data from affy  <dig>  to build prediction model of hla genes using 2-, 4-, and 10-fold cv. with ct =  <dig>  we obtained a consistent sample size for the different cvs. to eliminate the effect of sample size, therefore, we compared effects of cv at ct =  <dig>  additional file  <dig> shows the estimates for the testing accuracy that was obtained from validation analyses of prediction models built using 2-, 4-, and 10-fold cv . the hla-dqb <dig> locus with 10-fold cv had the best testing accuracy , whereas the hla-b locus with 2-fold cv had the lowest testing accuracy . at the 2-fold cv, testing accuracies ranged from  <dig> %  to  <dig> % . by increasing the cv to 10-fold, testing-accuracy levels approached  <dig> % . for hla-a, this improvement was most dramatic, as prediction models trained on the 2-fold cv had an accuracy of  <dig> %, whereas training on the 10-fold cv resulted in an  <dig> % accuracy. similar trends were observed for the other five hla loci. these trends may reflect the large size of the sample, which would include a sufficient number of hla alleles in the training data set, thereby increasing predictive accuracy. although the level of cv influenced the testing accuracy, these changes were minimal. we conclude, therefore, that our ethnic-specific prediction model of hla genes is not affected by different cvs.

for hla-b alleles, testing accuracies were generally not as high as others. one of the possible reasons was that there were large number of hla-b allele with four digit and most of them with very low frequency. hence, our training data could not sufficiently capture the variability. we also compared testing accuracies among predictive models with and without imputation across different platforms, the results revealed that predictive models built with imputed snps were more accurate than those without . therefore, proxy snps might improve testing accuracies. to generate more-useful prediction model of hla genes, therefore, one should take into account that the distribution of these rare hla alleles varies between the training and testing data sets. as such, applying the current hla-predictive method to a large population that contains relatively rare hla alleles in the training data set might improve the performance of ethnic-specific prediction model of hla genes.

the common hla typing experiment is not restricted to a single hla allele but to a group of known hla alleles having the same pattern within the common allele. therefore, it is hard to determine rare alleles. however, we feel the prediction model is a useful tool for pre-screening disease association with common hla alleles using chip data from gwas. in the case of any significant association by the model predicted common alleles, it is understood that further hla testing would be necessary. the hla allele assignment was according to the most common alleles  found in taiwanese populations and southern chinese populations as determined in the population studies of 13th international histocompatibility workshop.

as mentioned above, we focused on prediction model of hla genes that were generated using  <dig> han chinese samples from taiwan, each of which were genotyped using the affy  <dig> , affy  <dig> , and illumina 550 k chips. to assess the effect of the sample size for predicting, we analyzed prediction models generated using  <dig> han chinese samples  that were genotyped using the illumina 550 k chip. prediction model of hla genes built from  <dig> samples  performed better than that from the 214-sample  across all hla loci. as such, larger sample sizes seem to increase hla-predictive accuracy. the sample size effects was confirmed by the previous finding from jia et al.  <cit> . in our previous study  <cit> , the profiles of haplotype blocks for the caucasian and taiwanese populations were apparently different in ld structure. our hla typing experiment assignment was according to the most common alleles , but the caucasian hla data  did not filter rare alleles. inaccurate predictions might have resulted from rare hla alleles, which were defined as those appeared less than three times in the training data set  <cit> . these rare hla alleles might affect the first procedure of hla-predictive methodology  <cit> . hence, sample size, ld and configuration of allelic repertoire might be all possible reasons for the difference in the size of optimal flanking region for our han chinese and the caucasian data.

we offer a web-based service on the hla predictive models using li’s algorithm to help other researchers to predict the hla allele types and the corresponding probabilities of their subjects if the researchers provide the snps information files on the hla region to us. the link is at the following .

CONCLUSIONS
after a decade of research, many hla genes are known to have specific immunological functions. experimental methodologies that link snps to hla alleles offer considerable savings  over direct hla-typing technologies and make large-scale investigations into hla variation feasible. although hla allelic distributions differ among human populations, the majority of existing prediction model of hla genes is based on caucasian samples. by genotyping a large number of han chinese samples, we have uncovered many hla alleles that are unique to this population and have built ethnic-specific prediction model of hla genes. our training data set covers many uncommon and ethnic-specific alleles within hla loci, substantially raising predictive accuracies concerning the testing of data sets.

specific methodological parameters investigated in this study  each were factors in generating prediction model of hla genes that were specific for a han chinese population. we achieved good predictive accuracy for the hla-a, -b, -c, -drb <dig>  -dqb <dig>  and -dpb <dig> genes within our han chinese samples. using snp data from the affymetrix genome-wide human snp array  <dig> , the affymetrix genome-wide human snp array  <dig> , the illumina humanhap <dig> beadchip, or a union of these three technological platforms, we generated efficient prediction model of hla genes for determining hla alleles within a han chinese population. our novel predictive tools may help identify genetic risk factors for immune-related diseases. furthermore, these findings will enable researchers to investigate hla allelic variations among a broader range of human populations.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
arh and swc contribute equally. arh, swc, clh, ccc and csjf contributed to the statistical analysis. arh and csjf drafted the manuscript. plc, ccc and swc contributed to help to draft the manuscript with arh. plc, ccc, wsy, jyw, ytc and tcc contributed to collecting the data. all authors read and approved the final manuscript.

supplementary material
additional file 1
overlapping snps between the hapmap project and three genotyping platforms within the extended mhc region.

click here for file

 additional file 2
list of the 
hla 
alleles and allele frequencies in our han chinese data .

click here for file

 additional file 3
testing accuracies associated with different flanking-region sizes. for each of the six hla genes , testing accuracies for various flanking-region sizes are shown. data using the affy  <dig>  , illumina 550 k , and union  chip data sets are shown. .

click here for file

 additional file 4
kappa coefficients of observed or imputed snp genotypes within the mhc region.

click here for file

 additional file 5
testing accuracies and call rates from optimized models for each platform at different ct settings. for each of the six hla genes, testing accuracies and call rates are shown for the four genotyping arrays . data from ct =  <dig> , ct =  <dig>  , and ct =  <dig>   are shown. panels represent data without imputed snps  and with imputed snps .

click here for file

 additional file 6
the percentage of overlapping selected genotypes between the different genotyping platforms. for each of the six hla genes , the percentage of overlapping snps from different pairs of arrays is shown. data without imputed snps  and with imputed snps  are shown.

click here for file

 additional file 7
list of the selected snps in the final 
hla 
prediction models.

click here for file

 additional file 8
list of the snp alleles that predict 
hla 
allele types.

click here for file

 additional file 9
testing accuracies with different cv settings. for each of the six hla genes, testing accuracies associated with 10-fold cv , 4-fold cv , and 2-fold cv  are shown .

click here for file

 acknowledgements
we thank the national center for genome medicine at academia sinica, taiwan, for technical/bioinformatics support. this center was supported by grants from the national core facility program for biotechnology of national science council, taiwan. we are also grateful to national science council and institute of biomedical sciences, academia sinica of taiwan and national taiwan university hospital for their funding .
