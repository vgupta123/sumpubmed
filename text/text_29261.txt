BACKGROUND
the biological complexity of an organism does not appear to correlate with the number of protein-coding genes in that organism. this is exemplified by comparing the human with the nematode caenorhabditis elegans genome, where roughly similar numbers of genes  result in organisms with startlingly contrasting complexity  <cit> . a pervasive contributor that may in part account for this is alternative splicing of precursor messenger rna, creating transcriptomic and proteomic diversity  <cit> . a particularly remarkable example is the down syndrome cell adhesion molecule  gene in drosophila melanogaster, which can potentially generate  <dig>  mrna isoforms via mutually exclusive alternative splicing of exons that encode the ecto- and transmembrane domains  <cit> ; this number increases to  <dig>  when one considers independent alternative splicing of exons within the endodomain . the latter figure accounts for more than eleven times the number of genes in d. melanogaster's genome  <cit> . mutually exclusive alternative splicing occurs for ectodomain encoding exons  <dig>   <dig> and  <dig> and transmembrane exon  <dig> . one of twelve exon  <dig> alternatives, one of  <dig> exon  <dig> alternatives, one of  <dig> exon  <dig> alternatives and one of two exon  <dig> alternatives are present in each mrna , and endodomain exons  <dig> and  <dig> can be contained or lacking  <cit> . because of the extreme number of isoforms possible, dscam has more recently been referred to as hypervariable, dscam-hv  <cit> , a nomenclature that we also adopt in this paper, but it is noteworthy that earlier papers do not use the -hv suffix .

the dscam-hv gene is a member of the immunoglobulin  superfamily  <cit> . in d. melanogaster it plays an essential role in neuronal wiring: it is an axon guidance receptor  <cit>  and it ensures that olfactory receptor neurons synapse in the correct target  <cit> . the importance of isoform diversity in neuronal wiring and self-recognition has since been uncovered  <cit> . in  <dig> watson and co-workers  <cit>  discovered that depletion of dscam-hv impairs the ability of d. melanogaster haemocytes to phagocytose bacteria, spurring research into the immunological role that it could play in drosophila and other pancrustaceans   <cit> . it has been hypothesised that the large diversity of dscam-hv isoforms could provide specificity for antigen recognition  <cit> , however evidence to support this hypothesis is limited. dscam-hv is particularly interesting because of its versatility due to the extreme diversity that it encodes, and also because the nervous and immune systems may exert different selection pressures on this gene  <cit> .

the protein domain structure of dscam-hv in d. melanogaster  <cit>  consists of ten ig domains: the alternatively spliced exon  <dig> lies within ig <dig>  exon  <dig> within ig <dig>  and exon  <dig> comprises the whole of ig <dig> . there are also six fibronectin type iii  repeats, a transmembrane domain and a c-terminal cytoplasmic tail  <cit> . orthologs of the dscam-hv gene have been found in other pancrustaceans , including several insect  <cit>  and crustacean species  <cit> , and all have the same ectodomain protein structure as d. melanogaster. however, there is considerable variation in the total number of alternatively spliced exons in the dscam-hv genes across the pancrustacea  <cit> , and there is also variation in the number of conserved exons. therefore for simplicity, hereafter we will refer to the hypervariable exons using domain numbering as these are likely to be more conserved than exon number. the question then arises of whether one could reconstruct the history of duplications and deletions that have shaped dscam-hv evolution, and infer the ancestral set of alternatively spliced exons that were present at the base of the arthropods, pancrustaceans and insects. also, of particular importance to the question of the ubiquity of dscam-hv, it remains unclear when alternative splicing as found in dscam-hv arose  <cit> . it has been assumed that dscam-hv was already present in the genome of the common ancestor of the pancrustacea but it is not known whether it was already present in the common ancestor of the arthropods. to date the most closely related species to the pancrustaceans that has been examined for dscam-hv is the nematode c. elegans, although evidence of multiple exon variants was not found  <cit> , and brites and co-workers  <cit>  subsequently suggested that it lacks dscam altogether. similarly more distantly related taxa within protostomia, such as a platyhelminth and a mollusc, appear not to have dscam-hv  <cit> .

in addition to the hypervariable dscam-hv gene, three non-hypervariable dscam genes, so-called dscam-like genes have been described in d. melanogaster  <cit> . one such gene, dscam <dig>  has two alternatively spliced exons in ig <dig>  <cit> , whereas dscam <dig> and dscam <dig> have only one isoform each. dscam <dig> and dscam <dig> have also been ascribed neuronal roles  <cit> . the ancestor to at least one of the dscam-like genes was already present in the common ancestor of the holometabolous insects , because dscam-like genes have been predicted in the genomes of the honeybee apis mellifera , the yellow fever mosquito aedes aegypti  and the red flour beetle tribolium castaneum . a first approximation of the evolution of the insect dscam gene family including the aforementioned genes was described by brites and co-workers  <cit> , however, it is unclear whether all of these species contain orthologs to all three dscam-like genes as found in d. melanogaster, and therefore also at what point the dscam gene family diversified: were the three dscam-like genes already present in the common ancestor of the holometabolous insects, of all insects, or of the pancrustaceans?

dscam orthologs are also present in deuterostomes. unlike its pancrustacean counterpart, vertebrate dscam has only two predicted isoforms  <cit> . dscam also plays a fundamental role in, e.g., axon guidance  <cit>  and self-avoidance  <cit> , but as of yet no immune function has been suggested. a further vertebrate dscam homolog has also been identified . phylogenetic inference shows that the dscam/dscam genes in protostomes and deuterostomes cluster separately; it follows that separate duplication events may have occurred leading to the independent expansion of the dscam/dscam families in both lineages  <cit> . it seems that taxa quite distant from the bilateria  do not contain dscam orthologs  <cit> , however, it is unknown whether dscam exists in a more closely related group to the bilateria, e.g., the cnidaria.

in this paper we take a bioinformatics approach, constructing hidden markov model profiles  to search within the genomes of species for putative dscam genes and hypervariable alternatively spliced exons and then reconstruct phylogenetic relationships between these genes and exons, to examine the evolutionary history of the dscam gene family and the evolution of the three extracellularly expressed alternatively spliced exon clusters. specifically we examine i) whether dscam orthologs exist outside the bilateria, if this is the case, it would suggest the origin of the dscam gene family lies further back than previously believed, ii) whether the origin of dscam-hv could lie outside the pancrustacea, iii) when the dscam-like orthologs arose, iv) how many alternatively spliced exons of each exon cluster were present at the base of the arthropoda, pancrustacea and the insecta and v) whether the three exon clusters evolved similarly.

methods
for a general overview of the workflow followed, and extra methodological details, please see additional files  <dig> and  <dig>  respectively.

hidden markov models
the complex exon structure of dscam-like and dscam-hv genes , and the fact that the exon structure is highly variable across dscam orthologs, makes an ortholog search via the reciprocal best blast hit or the reciprocal smallest distance method  <cit>  difficult. this is because these algorithms use alignment methods to search for orthologs that cannot incorporate the large introns contained in the dscam genes, especially as they are interspersed with short exons. we therefore used profile hidden markov models   <cit>   as our technique to search for homologous dscam sequences. hmms are powerful tools often used for annotating sequences, for example domains in a protein sequence, or exons and introns in a nucletide sequence. an hmm is based on a probabilistic model, which in a biological context is usually provided by a multiple sequence alignment. from this model, probabilities are inferred for how likely it is that a certain observation in another sequence is made because the sequence fits the model, or how likely it is that the observation is made despite the sequence not fitting the model. we used hmms to annotate protein sequences, both full putative dscam proteins and individual exons, based on an alignment of already known protein sequences for the exon or protein.

genomes searched and sequences used for tree constructions
i) to examine whether dscam homologs exist outside the bilateria we included two cnidarians, hydra magnipapillata  and the starlet sea anemone nematostella vectensis .

ii) to test whether dscam-hv exists outside of the pancrustacea we searched the only arachnid  genome available to date, the deer tick, ixodes scapularis  <cit> .

iii) to estimate when the dscam-like orthologs arose we searched for dscam-like genes in i. scapularis, as well as within nine pancrustaceans: the water flea, daphnia pulex , six representative holometabolous insects, the mosquito anopheles gambiae , apis mellifera , the silk moth bombyx mori , the flies d. melanogaster  and d. mojavensis  tribolium castaneum  and two hemimetabolous insects, the pea aphid acyrthosiphon pisum  and the human body louse pediculus humanus . to infer the relationships between dscam-hv and dscam-like genes we included dscam-hv from the whiteleg shrimp litopenaeus vannamei  <cit> , as well as dscam sequences from the california purple sea urchin strongylocentrotus purpuratus, the zebra fish danio rerio, the chicken gallus gallus, the gray short-tailed opossum monodelphis domestica and the house mouse mus musculus; and dscaml <dig> sequences from the dog canis lupus familiaris and the brown rat rattus norvegicus.

iv) and v) to examine the number of alternatively spliced exons at the base of the pancrustacea and the evolutionary histories of the three exon clusters, we searched the previously annotated dscam-hv genes as well as our newly annotated dscam-hv genes from the above nine pancrustaceans and the putative dscam genes identified for i. scapularis for alternatively spliced exons and then used these in our phylogenetic analyses.

identification of, and protein predictions for, dscam-like orthologs
to identify dscam-like orthologs we constructed hmms from seven already available dscam-like sequences. from d. melanogaster this included dscam <dig> , dscam <dig> and dscam <dig>  two genes from d. mojavensis that are orthologous to dscam <dig> and dscam <dig>  and two further dscam-like orthologs from t. castaneum and a. mellifera. the protein sequences were aligned using muscle  <cit> . the exon structure of these genes is variable between species, therefore to construct the hmms  we identified ten highly conserved regions of the alignment  that did not cross exon boundaries in any of the d. melanogaster dscam <dig>  dscam <dig> or dscam <dig> genes . we translated the genomes of the arthropods a. gambiae, a. mellifera, a. pisum, b. mori, d. pulex, d. mojavensis, i. scapularis, p. humanus and t. castaneum as well as the cnidarians, h. magnipapillata and n. vectensis into six reading frames and the resulting protein sequences were searched for matches to the ten hmms using the hmmpfam algorithm. we took a conservative approach and considered the prediction as a putative dscam ortholog when six of the ten hmms matched the scaffold in the correct order  and each hmm match reached an e-value of  <dig>  or less. furthermore, we did not predict the domain structures, thus some domains may not be present for some of the dscam-like predictions. to obtain the complete sequence of the predicted proteins, the fgenesh + algorithm  <cit>  was used on the identified scaffolds, using the most closely related  available dscam-like sequence as an orthologous sequence. every predicted protein sequence was aligned to the already-annotated dscam-like sequences and manually checked for quality.

as a positive control and to explain the underlying rationale for only accepting putative dscam-like orthologs if six of the ten hmms  matched, we constructed another set of hmms without d. mojavensis dscam-like genes and ran these hmms on the translated d. mojavensis genome. dscam-hv and three dscam-like genes were found with all ten hmms showing significant hits . using this data, we started to find non-dscam genes when four of the hmms matched our criteria , but for five hmms and above we only retrieved the three dscam-like genes and dscam-hv, and from additional file  <dig> is apparent that five hmms is in the plateau phase. we therefore suggest that we are more likely to have have false negatives rather than false positives as a result of using six hmms and above as the cut-off value . as a negative control we created a random nucleotide 'genome'; this contained  <dig>  scaffolds each consisting of  <dig>  nucleotides  translated into all six reading frames. when we searched this data set with the hmms, it never yielded more than one hit per scaffold with an e-value of less than  <dig> .

identification and annotation of dscam-hv genes
to build the hmms for the dscam-hv genes, we aligned the complete dscam-hv protein sequences from a. mellifera , d. melanogaster and d. pulex using muscle and annotated all exon borders. the global alignment was divided into  <dig> smaller alignments, which covered nearly the whole gene, whilst ensuring that none of the hmms included exon borders; we then used hmmer to construct the protein hmms from these alignments . we used these hmms to annotate previously incompletely annotated dscam-hv exons from sequences that were already available from the literature for a. gambiae, b. mori and t. castaneum. the nucleotide sequences were translated into three reading frames and each hmm searched for the best two hits within these three reading frames. the best hits were then assembled into the full mrna and protein sequences. for the remaining species where dscam-hv had not been already fully annotated , the whole genomes were translated into all six reading frames. the  <dig> hmms were used to search the translated genomes and candidate genes proposed when more than  <dig> of these hmms matched well . these scaffolds were treated in the same way as the already identified sequences from a. gambiae, b. mori, and t. castaneum. for one species, a. pisum, this method was able to identify two scaffolds, one containing the first third of dscam-hv and the other that overlapped this scaffold and contained the remaining two thirds. the two scaffolds were manually edited together, resulting in the full gene sequence. we also ran the hmms over the translated h. magnipapillata and n. vectensis genomes.

identification and annotation of dscam-hv hypervariable exons
to identify and annotate the hypervariable exons in the dscam-hv orthologs of a. gambiae, a. pisum, b. mori, p. humanus and t. castaneum, and to search for hypervariable exons in i. scapularis, hmms of the previously annotated exon variants of d. melanogaster, a. mellifera, and d. pulex were constructed . not all hypervariable exons were used to build the hmms, as using many exons that are closely related could result in over-representation of these exons, and may have lead to non-detection of exon variants that are evolutionarily further away. therefore, approximate trees  were built from all available sequences for each of ig <dig>  ig <dig> and ig <dig>  and only one representative exon from each clade was used for the hmms. as a positive control, these hmms were tested against the intronic regions of species in which these exons have already been annotated and all previously annotated exon variants could be found. we focused on the exons that correspond to extracellular domains of the protein, i.e.  <dig>   <dig> and  <dig>  therefore the intronic regions between the exons homologous to d. melanogaster exons  <dig> and  <dig>   <dig> and  <dig>  and  <dig> and  <dig> of the species mentioned above, were translated into six reading frames and searched using the hmms. all six reading frames were used so that potential inversion events could also be detected. after inspecting the distribution of e-values among the matches , a cut-off of  <dig>  was chosen for the exons to be included in the rest of the analyses. nucleotide sequences of putatively alternatively spliced exons were then retrieved from the intronic sequences to use for the phylogenies.

phylogeny of the dscam gene family
an alignment of all known and newly-identified dscam-like orthologs as well as all dscam-hv genes and the deuterostoma dscam orthologs was created using several methods. first, a complete protein alignment of all  <dig> sequences was created using muscle. all ig <dig>  ig <dig>  and ig <dig> orthologous regions were removed from the alignment. the resulting  <dig>  amino acid positions-long alignment was then shortened to 47% of its original length using gblocks, allowing for gap positions  <cit>  in order to allow for a more accurate deep phylogeny without alignment mismatches obscuring these deep nodes, and to break down artifacts such as long branch attraction  <cit> . the final alignment encompassed  <dig> sequences and spanned  <dig> positions, comprising of  <dig> alignment patterns and  <dig> % gaps and undetermined positions . the lg protein substitution matrix  <cit>  was identified as the best-suited evolutionary model for our data set using prottest  <cit> . from this alignment, phylogenetic inference was performed on a maximum likelihood framework using raxml v <dig> . <dig>  <cit>  with the lg + Γ <dig> model and computing  <dig>  bootstrap replicates starting with a random tree. bayesian phylogenetic inference was performed in parallel using phylobayes  <dig>   <cit>  and lg + Γ <dig> and the cat approximation for profile mixture. three independent monte carlo markov chains were launched, allowed to reach stationary state, checked for convergence among them and the posterior distribution sampled every  <dig> values to collect  <dig>  data points. rogue taxa, as defined by pattengale and co-workers  <cit>  were identified with raxmlv <dig> . <dig> using the -f r option.

both maximum likelihood and bayesian approaches recovered sequences from arthropods and deuterostomes as being respectively monophyletic. arthropod sequences clustered into seven well-supported clades, although their relative phylogenetic relationships could not be inferred with confidence. to test different alternative hypotheses for the evolution of the dscam gene family relationships we constructed alternative topologies and performed the shimodaira-hasegawa test on them  , as implemented in raxmlv <dig> . <dig>  the sh-test allows one to compare different trees for a given alignment under a maximum likelihood framework, and to identify alternative topologies that may also be acceptable descriptions for the phylogenetic relationships among clades. the preferred tree was chosen by testing the equally good gene trees identified against the known evolutionary relationships among the corresponding organisms.

time inference for the dscam gene family was performed with phylobayes, fixing the topological relationships among clades to follow the best tree and the preferred tree , using lg + Γ <dig> and the cat approximation for profile mixture, a log normal model  <cit>  for the relaxed clock, and a birth-death prior. the following species divergence times were used as calibrations in the clades in square brackets: fruit fly - mosquito,  <dig>  -  <dig>  ma ; fruit fly - bee,  <dig>  -  <dig>  ma ; human - zebrafish,  <dig>  -  <dig>  ma ; human - cow,  <dig>  -  <dig> ma  . three monte carlo markov chains were constructed and tested for convergence.

phylogeny of dscam-hv exons
to construct the phylogenies of dscam-hv exon clusters, the protein sequences of all putative exons found for that cluster were aligned together with one representative exon of an i. scapularis gene, which was identified in the preferred dscam tree to serve as an outgroup for the arthropod genes. only one exon sequence of l. vannamei was included for each of the three exon clusters, as the rest of the exon sequences were not yet publicly available. the protein sequences were aligned using muscle, manually checked for quality and then back-translated into codon alignments using pal2nal  <cit> . at the nucleotide level the final alignments encompassed respectively for the ig <dig>  ig <dig> and ig <dig> exons,  <dig>   <dig> and  <dig> sequences;  <dig>   <dig> and  <dig> alignment patterns; and 22%, 18% and 21% gaps and completely undetermined positions . phylogenetic inference was performed with raxml v <dig> . <dig> at the nucleotide level using gtr + Γ <dig>  without partitions and also introducing three partitions corresponding to the three codon positions. two independent runs with  <dig>  bootstrap cycles were calculated, starting with a random tree. bayesian phylogenetic inference was also performed on the same alignment with phylobayes at the nucleotide level using gtr + Γ <dig> and the cat approximation for profile mixture. similar methods were used to infer relationships between the d, melanogaster and the d. mojavensis dscam-hv exons only. in this case, at the nucleotide level the final alignments encompassed respectively for the ig <dig>  ig <dig> and ig <dig> exons,  <dig>   <dig> and  <dig> sequences;  <dig>   <dig> and  <dig> alignment patterns; and  <dig> %,  <dig> % and  <dig> % gaps and completely undetermined positions .

RESULTS
we have identified novel putative members of the dscam gene family across the pancrustacea. these fell into six well-supported insect gene clades: five dscam-like and one containing the dscam-hv cluster. a seventh well-supported clade included the four dscam-related genes present in the genome of the arachnid i. scapularis, each containing a maximum of only one ig <dig>  one ig <dig> and one ig <dig> variant. these findings suggest that the dscam genes duplicated independently in the insects and an arachnid genome, which adds to the two independent dscam gene copies found in vertebrate genomes. similarly to tropomyosin genes  <cit> , a second form of gene expansion, tandem duplication, is also highly active in this gene family, and is thought to have resulted in numerous alternatively spliced exon variants. we also identified alternatively spliced exons within ig <dig>  ig <dig> and ig <dig> from various insect species, but the short sequence length and the limited amount of phylogenetic signal of the putative exons identified, precluded the reconstruction of deep relationships between the exon variants of all arthropods.

identification of, and protein predictions for, members of the dscam family
using probabilistic models  derived from multiple protein sequence alignments of dscam-like and of dscam-hv, we searched across taxa for potential members of the dscam family. using our dscam-like hmms we were unable to detect any dscam-like orthologs in either of the two cnidarian genomes . this supports the hypothesis that the ancestor of the dscam gene family appeared after the emergence of the bilateria. however, it is possible that we did not find any orthologs because of gaps in the genome sequences, so it would be informative to re-run this search when genomes of better quality are available. it is worth noting that we have chosen conservative hmm cut-offs , and we are aware that this may lead to negative results and may have excluded true orthologs if their phylogenetic signal was too weak or had been eroded.

across the arthropod genomes searched, we found  <dig> putative dscam-like genes, four of which were in i. scapularis . all insect genomes contained between two and four putative dscam-like genes. similarly to brites and co-workers  <cit> , we could not find any putative genes closely related to dscam-like in the d. pulex genome, although the authors did find two regions with homology to the dscam-like genes that contained a different domain organisation  <cit>  . we did not find any putative dscam-hv genes in the tick genome, which supports the hypothesis that dscam-hv, as found in the insects, whiteleg shrimp, and water flea, originated at the base of the pancrustacea. to test this hypothesis further, it would be essential to scan more non-pancrustacean arthropod genomes when they become available, and also to examine the tick genome when it is fully assembled. we did, however, identify dscam-hv for all of our pancrustacean species . no duplicated dscam-hv genes were found in any of the genomes searched.

phylogeny of the dscam gene family
with the newly identified sequences we aimed to reconstruct the phylogenetic relationships among the dscam-hv and dscam-like genes in arthropods, using deuterostome dscam genes as an outgroup , and to incorporate time estimates in the bayesian calculations by introducing priors with information from the fossil record. both maximum likelihood and bayesian phylogenetic reconstructions , suggested that all of the dscam-hv genes form one clade. both methods also identified five other well-supported insect clades of dscam-like genes, three of which clustered around one of the three d. melanogaster dscam-like genes, and which we therefore named as dscam <dig>  dscam <dig> and dscam <dig> according to which of the three d. melanogaster genes they were orthologous to . the sequences from the i. scapularis genome clustered together to form one clade, and are therefore co-orthologs  <cit>  with respect to the rest of dscam-hv and dscam-like clusters. although the monophyly of each of the aforementioned seven large clades was clear, the phylogenetic position of certain individual taxa within the corresponding clade could not be clearly resolved, as several alternative branching positions could be identified to attain more than  <dig>  posterior probability  <cit> . such rogue taxa included co-orthologs a and c among the dscam genes in i. scapularis, sequences from t. castaneum, b. mori, a. pisum and a. mellifera among the dscam-hv genes, and sequences from t. castaneum and a. mellifera among the dscam <dig> genes. in these instances, the inferred phylogenetic relationships among genes did not always match the evolutionary relationships among the corresponding organisms . problematic placements included b. mori , where the predicted sequences contained sizeable gaps , which could in part be due to the quality of the genome, as we indicated for our prediction of the b. mori dscam-hv gene . furthermore, there was a sizeable gap in the predicted sequence of t. castaneum dscam <dig> , the placement of which also does not match the evolutionary relationships among the organisms.

the dscam <dig>  dscam <dig> and dscam <dig> clades all had multiple insect representatives  suggesting that they may have arisen before radiation occurred within the insects. however, dscam <dig> and dscam <dig> contained representatives from only one hemimetabolous insect, p. humanus, and one holometabolous insect, a. mellifera: it seems unlikely that all of the other holometabolous insects have lost this gene. our conservative cut-off for including putative genes in our phylogeny may have resulted in us missing representatives for these two clades from some of the other species. in the absence of topological constraints, but also when enforcing monophyly separately for each of the dscam-hv and dscam-like gene clades, the dscam <dig> clade was basal to the rest of genes in the family . given the evolutionary relationships among arthropods , we hypothesised that the i. scapularis genes could be basal to those of the rest of the pancrustacea. we tested this hypothesis by reconstructing a phylogeny in which i. scapularis dscam co-orthologs were forced to be basal , the results of a sh-test showed that it was not significantly worse than the one in which the dscam <dig> genes were basal . we therefore propose that the ancestral dscam gene was present in the genomes of the ancestral arthropods. the ancestral ortholog in the i. scapularis lineages underwent duplications and generated the dscam i. scapularis co-orthologs, while the ortholog in the ancestral pancrustaceans also underwent duplication events that developed the family further. the alternative hypothesis would be that the monophyly of the four dscam i. scapularis in-paralogs is an artifact caused by long-branch attraction and/or by convergence in amino acid preferences of the four genes in the i. scapularis genome. only future research on basal arthropods will provide genomic data to test these exclusive hypotheses. regarding crustaceans, the only gene prediction for the d. pulex genome corresponded to a dscam-hv gene. this could be interpreted as the dscam-hv clade to be basal to the rest of the dscam-like ones. indeed, a phylogenetic reconstruction enforcing such topology was not significantly worse than the best-known constrained tree, with dscam <dig> being basal to the rest of pancrustacean dscam clades . the alternative hypothesis would either imply the selective loss of the dscam-like gene in the d. pulex lineage, or the inability of our approach to detect it in its present form .

to gain a deeper insight into the evolution of the dscam-like and dscam-hv clades, we dated our preferred tree using bayesian reconstruction . our preferred dated tree where the i. scapularis clade was enforced as an outgroup  estimated that the i. scapularis clade split from the rest of the arthropods between 1020- <dig> million years ago , and the best tree estimate was between 928- <dig> ma. these figures contain, but are on the edge of, pisani's  <cit>   <dig>  ma mean divergence time estimate between pancrustacea and chelicerata. our estimated date for the divergence of the deuterostomes and the protostomes  is also quite old, but falls within other estimates, which range from  <dig>  to  <dig> ma  <cit> . within the insecta, the most recent common ancestor  respectively for the main dscam-like clades  was between 919- <dig> ma . furthermore it is noteworthy that in the d. melanogaster genome, the dscam <dig> and the dscam <dig> genes, closely related according to our reconstructions, are both encoded in chromosome  <dig> l, ca.  <dig> mega base pairs apart from one each other. the two additional basal clades, dscam <dig> and dscam <dig>  appeared to have arisen from more recent duplication events . our estimate for the mrca of the dscam-hv  fits quite well with other molecular estimates for the time of divergence between these species . furthermore our estimates for the basal splits within the insects, i.e., dscam-like genes from hemimetabolous and holometabolous insects, were in the region of another estimate .

more generally, our strict criteria for including a gene prediction as a putative dscam ortholog , may have also resulted in us missing representatives from dscam-like clades other than dscam <dig> and dscam <dig>  for example, we identified no p. humanus dscam <dig> and dscam <dig> orthologs, and no dscam <dig> ortholog for either a. mellifera or t. castaneum . it is possible that orthologs to those genes exist in the corresponding genomes, or alternatively, that after duplication events of the dscam-like genes in the ancestor of the insects that these representatives were secondarily lost from some genomes. it is also unclear which mechanisms led to the generation of the copies of the ancestral dscam gene in the genome of the ancestral insects in a relatively short period of time. it is indeed difficult to envisage how the duplication of a gene such as dscam-hv, which spans almost  <dig> kilo base pairs in d. melanogaster, can be neutral and come at no cost. the conundrum about the forces driving the duplication and the advantages that condition the selection of the newly evolved genes make it difficult to classify these events according to the models of the evolution of gene duplications presented by innan and kondrashov  <cit> .

identification and annotation of dscam-hv hypervariable exons
our hmms found identical numbers of alternatively spliced exons to species where exon numbers had previously been predicted or shown to be expressed . using hmms we annotated individual hypervariable exons from four insect species . for the four putative i. scapularis dscam co-orthologs we did not find more than one ig <dig>  ig <dig> or ig <dig> ortholog within the regions of the genes searched. however, dscam co-ortholog a appeared to have no ig <dig> or ig <dig> alternatively spliced variant . we found no evidence of potential exon inversion events, i.e., putative exons were only found in three reading frames per genome.

phylogeny of dscam-hv exons
an especially interesting aspect of the evolution of the dscam-hv genes is the evolution of the alternatively spliced regions. in particular, is it possible to reconstruct how many alternatively spliced exons of each exon cluster were present at the base of the pancrustacea and the insecta, and did the three exon clusters evolved similarly? using annotated exons from the literature and those predicted from our hmms, we had  <dig> arthropod exons, ranging from  <dig> to  <dig> base pairs  in length, with which to build the ig <dig> phylogeny . the phylogenetic relationships among exons could not be resolved with confidence, neither with maximum likelihood nor with bayesian approaches . in all cases the inferred trees displayed a star-like topology, without polarity, hindering the identification of groups of taxa or of exons that could belong together and making it unfortunately not possible to estimate the number of exon variants present at the base of the arthropoda, pancrustacea and insecta. indeed, for 58%  of the sequences the position in the tree varied largely with the region analysed and showed multiple possible insertion points to reach an accumulated  <dig>  posterior probability. this is perhaps not surprising, since we were trying to resolve the relationships among  <dig> sequences with  <dig> alignment patterns. the fact that we were unable to reconstruct the deep relationships between the exon variants with confidence differs from the findings of lee and co-workers  <cit> , where they reconstructed the evolutionary history of each variable exon cluster across holometabolous insects and a crustacean species  and subsequently suggested that there were at least nine ig <dig> exons in the insect ancestor and one exon present in the common ancestor of pancrustacea. our low bootstrap support values and posterior probabilities  are likely the result of the relatively short lengths of a large number of exons combined with a long evolutionary timescale. additional factors such as accelerated evolutionary rate, subfunctionalisation and/or gene conversion, may have further contributed to the erosion of the phylogenetic signal. finally, a similar composition across non-orthologous exons due to amino acid and/or codon usage preferences  might complicate the analysis, and generate a misleading impression of monophyly. examples of this putative convergence can be observed, for example, in additional files  <dig> and  <dig>  where exons predicted in the same genome tend to flock together. one methodological explanation for the difference between our study and that of lee and co-workers  <cit>  is that we used bayesian and maximum likelihood methods whereas they used neighbour joining. however, such high resolution power for neighbour joining compared to maximum likelihood and to bayesian analysis is unexpected, especially for short, highly divergent sequences, as is the case with these sequences.

because we could not infer the relationships between the exons over such an enormous evolutionary time scale, we tested whether we could find a better resolution at a scale of around 40- <dig> million years, i.e., the estimated divergence times for d. melanogaster and d. mojavensis  <cit> . most exons from one species had clear orthologs in the other species , with no evolutionary events, whether losses or duplications, occurring since the species split. the number of rogue taxa decreased to 16% , but the position of the root and the fine relationships between orthologous pairs could not be resolved .

our ig <dig> phylogeny consisted of  <dig> arthropod exons, ranging from  <dig> to  <dig> bp in length, and the ig <dig> phylogeny consisted of  <dig> arthropod exons, ranging from  <dig> to  <dig> bp in length. it was not possible to reconstruct a likely set of ancient exons for either of these exon clusters because of the low bootstrap support and posterior probabilities, and because a large proportion of the sequences were rogue taxa . noticeably, many exons in the phylogeny are in species-specific clusters . again, it is difficult to say whether this clustering is due to multiple, parallel expansion events within a lineage, the current mainstream interpretation, because of the potentially confounding effect of codon usage variation across species  <cit>  that may hinder phylogenetic reconstruction. as mentioned above, the clusters may therefore reflect nucleotide composition and not necessarily common ancestry. similarly, lee and co-workers  <cit>  suggested limited ancestral reconstruction was possible, although they suggested that six ig <dig> exons and two ig <dig> exons were present in the insect ancestor.

while the total number of ig <dig> exon variants in d. melanogaster only differs by two from that of d. mojavensis, a closer look at the overall phylogeny  reveals that there were probably more than two duplication or deletion events in these lineages. this is in contrast to the ig <dig> phylogeny, and underlines the fact that the accumulation of diversity in the ig <dig> cluster occurred faster than in the ig <dig> cluster. the orthologous ig <dig> exons identified in d. melanogaster and d. mojavensis were consistent with one another across the two phylogenetic reconstruction methods , they showed that the first half of the alternatively spliced exon variants  corresponded almost one for one to orthologs in both species, the exons in the middle region show slightly more complex across-species relationships indicative of duplications and losses, and towards the end of the exon cluster d. melanogaster exons  <dig>  to  <dig>  and their d. mojavensis counterparts also appear to be clear orthologs of one another. however, it was still not possible to resolve the deeper relationships between the orthologs.

overall, the three hypervariable exon clusters appear to have experienced quite different evolutionary histories. while the ig <dig> cluster is comparatively more conserved , ig <dig> and ig <dig> have experienced many more recent exon duplications and deletions and most of the diversity appears to have evolved since the split of the insects. all exon clusters seem to have evolved mainly via tandem duplications, and possibly fall into category iii 'diversifying selection' according to the models of gene-duplication evolution presented by innan and kondrashov  <cit> . no duplications of more than one exon could be found in the drosophila analysis. the three exon clusters have also evolved independently of one another. the differences between the three exon clusters regarding their evolution are likely caused by different selection pressures on the exons. these could be due to different functions, for example in the nervous system versus in the immune system, but also due to their different position in the three-dimensional structure of the dscam protein  <cit> .

CONCLUSIONS
our analyses of the evolution of the dscam family in the arthropods are compatible with the following evolutionary scenario. the genome of the arthropod ancestors already contained one copy of the ancestral dscam gene. in the arachnid i. scapularis, gene duplication and diversification generated the four extant copies  of the dscam gene, which are exclusive to this lineage. in the pancrustaceans, a basal duplication event generated the ancestral dscam-hv and the ancestor of the rest of the dscam-like clades. the ancestral dscam-like gene underwent a further series of between two and four duplication events in the lineage of the insects. in the dscam-hv lineage, the expansion of alternatively spliced exons in the ig <dig>  ig <dig> and ig <dig> domains via duplication started early, or immediately after, the emergence of the ancestral dscam-hv genes in pancrustaceans, and seems to be basal to this clade. there seems thus to exist an adaptive value in this broadening of the dscam-hv transcript/protein repertoire that may have been available through neofunctionalisation after gene duplication. such new function could be related to the differentiation between self and non-self, as evidenced in their role in the nervous system and in their putative role in immunity. if it is true that the hypervariability in dscam-hv arose after the split between arachnids and insects, one may wonder whether such new roles correspond to new solutions to old problems, also faced by arachnids and solved by other means, or whether they correspond to new functions that are exclusive to insects. a future search on more genomes with better quality will help fill the evolutionary gaps and clear the oddities that remain unexplained. finally, only experimentation will enable us to solve questions about whether the putative dscam-like genes are expressed and what their functions are, and to understand more about the role of alternative splicing of the hypervariable exons in dscam-hv across the arthropods.

authors' contributions
saoa participated in the conception and design of the study, participated in analyses and drafted the manuscript. rf built the hmms, identified the putative dscam sequences, and participated in building the phylogenetic trees. jk participated in the conception of the study and helped to draft the manuscript. igb participated in the conception and design of the study, performed the phylogenetic and statistical analyses, and helped to draft the manuscript. all authors read and approved the manuscript

supplementary material
additional file 1
an overview of the workflow followed for the hmm construction and use, and for the gene predictions.

click here for file

 additional file 2
supplementary methods.

click here for file

 additional file 3
genbank  accession numbers for the known and putative dscam-hv and dscam-like genes used in the overall phylogenies.

click here for file

 additional fie 4
information regarding the hmms for the dscam-like gene search. including the hmm identities, the lengths of each of the hmms in amino acids, and the hmm amino acid start position relative to the d. melanogaster dscam <dig> sequence .

click here for file

 additional file 5
dscam-like hmm.

click here for file

 additional file 6
putative dscam-like orthologs/co-orthologs and the number of hidden markov models positively identified for each ortholog/co-ortholog. grey boxes indicate an hmm hit with an e-value ≤  <dig> . white boxes indicate an e-value greater than  <dig>  or no match. the identities of the dscam-like genes were assigned according to the phylogenetic tree in figure  <dig> 

click here for file

 additional file 7
d. mojavensis hmm results. results for the dscam-like hmms built from a. mellifera, d. melanogaster and t. castaneum and run against the translated d. mojavensis genome. for a total of five 'matching' hmms and above we found only four hits in the genome , which had hmms with significant hits in the correct order. the conservative cut-off value, which was subsequently used when searching other species for dscam-like genes, is shown as a dashed line, i.e. a minimum of six hmms had to match the sequence in the correct order and all with an e-value below  <dig> .

click here for file

 additional file 8
arthropod hmm results. number of hits for the dscam-like hmms built from a. mellifera, d. melanogaster, d. mojavensis and t. castaneum and run against the translated genomes of a. gambiae, a. mellifera, a. pisum, b. mori, d. pulex, i. scapularis, p. humanus humanus and t. castaneum. the cut-off value is shown as a dashed line.

click here for file

 additional file 9
dscam-hv hmm.

click here for file

 additional file 10
ig <dig> hmm.

click here for file

 additional file 11
ig <dig> hmm.

click here for file

 additional file 12
ig <dig> hmm.

click here for file

 additional file 13
e-value distribution among putative hypervariable exons found across all arthropod species using our hmms. the vertical dashed line marks the cut-off e-value of  <dig> .

click here for file

 additional file 14
amino acid alignment of putative dscam gene family members. the complete protein alignment of  <dig> sequences was created using muscle. all ig <dig>  ig <dig> and ig <dig> orthologous regions were removed from the alignment. the resulting alignment was shortened using gblocks.

click here for file

 additional file 15
tests of alternative tree topologies. the "best" tree  was tested against alternative hypotheses for the relationships between different dscam clades by constructing alternative topologies  and performing the shimodaira-hasegawa test. neither of the two alternative topologies was significantly worse than the "best" tree at the 1% level.

click here for file

 additional file 16
nucleotide alignment of all arthropod ig <dig> variants.

click here for file

 additional file 17
nucleotide alignment of all arthropod ig <dig> variants.

click here for file

 additional file 18
nucleotide alignment of all arthropod ig <dig> variants.

click here for file

 additional file 19
nucleotide alignment of all d. melanogaster and d. mojavensis ig <dig> variants.

click here for file

 additional file 20
nucleotide alignment of all d. melanogaster and d. mojavensis ig <dig> variants.

click here for file

 additional file 21
nucleotide alignment of all d. melanogaster and d. mojavensis ig <dig> variants.

click here for file

 additional file 22
maximum likelihood  phylogeny of the dscam/dscam gene family, resulting in the best tree . bootstrap values  are shown at the nodes. the vertical bars to the right are the same as in figures  <dig> and  <dig> and follow the taxa colour codes in figure  <dig>  the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 23
bayesian  phylogeny of the dscam/dscam gene family, resulting in the best tree . posterior probabilities are shown at the nodes. the vertical bars to the right are the same as in figures  <dig> and  <dig> and follow the taxa colour codes in figure  <dig>  the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 24
bayesian  dated phylogeny of the dscam/dscam gene family. 95% confidence intervals for divergence times  are shown next to the key nodes. the x-axis shows the time scale in millions of years. the topology follows that of the original best tree . nodes used for fossil calibrations are shown with a grey circle, for details see materials and methods. the vertical bars follow the bar colours of taxa written in black in figure  <dig> 

click here for file

 additional file 25
bayesian  phylogeny of all hypervariable ig <dig> variants across the arthropods. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 26
maxiumum likelihood  phylogeny of all hypervariable ig <dig> variants across the arthropods. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 27
maximum likelihood  phylogeny of hypervariable ig <dig> variants  from drosophila melanogaster and d. mojavensis. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 28
bayesian  phylogeny of all hypervariable ig <dig> variants across the arthropods. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 29
maxiumum likelihood  phylogeny of all hypervariable ig <dig> variants across the arthropods. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 30
bayesian  phylogeny of all hypervariable ig <dig> variants across the arthropods. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 31
maxiumum likelihood  phylogeny of all ig <dig> variants across the arthropods. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 32
bayesian  phylogeny of hypervariable ig  <dig> variants  from drosophila melanogaster and d. mojavensis. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig> substitution per site.

click here for file

 additional file 33
maximum likelihood  phylogeny of hypervariable ig <dig> variants  from drosophila melanogaster and d. mojavensis. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 additional file 34
bayesian  phylogeny of hypervariable ig <dig> variants  from drosophila melanogaster and d. mojavensis. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig> substitutions per site.

click here for file

 additional file 35
maximum likelihood  phylogeny of hypervariable ig <dig> variants  from drosophila melanogaster and d. mojavensis. a putative ixodes scapularis ig <dig> sequence is the outgroup. bootstrap values are shown at the nodes. the scale bar represents  <dig>  substitutions per site.

click here for file

 acknowledgements
we would like to thank daniela brites for access to unpublished work. this work was supported by a grant from the volkswagen stiftung for saoa  and for igb , and by the late spanish ministry for science and innovation  to igb.
