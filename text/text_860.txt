BACKGROUND
a central goal of biomedical research is to define mechanistic causes for cellular behavior and disease. high throughput technologies such as gene expression profiling provide a rich starting point to identify mechanistic causes, e.g. de novo network inference  <cit> . ideally we would like to contextualize gene expression patterns with the known biochemical processes and regulatory signaling pathways. this approach provides us with a more systems level and informative view  of the biological states that have been perturbed, which in turn allows us to identify points where we could intervene to change cellular behavior.

gene set analysis  is a widely used strategy for gene expression data analysis based on pathway knowledge  <cit> . unlike previous strategies which focus on individual or a limited number of genes, gsa focuses on sets of related genes and has demonstrated three major advantages. first, gsa methods are better able to detect biologically relevant signals and give more coherent results across different studies  <cit> . second, gsa uses all of the available gene expression data  instead of prefiltering the data for a short list of strongly differentially expressed genes .  indeed, small coordinated gene expression changes in a pathway can have a major biological effect even if these changes are not statistically significant for any individual gene  <cit> . third, gsa incorporates prior knowledge of biological pathways and other experimental results in the form of gene sets  <cit> . these gene sets are constantly updated in the literature and represent a significant repository of useful biological knowledge. although, knowledge dependency can be also considered a limitation of gsa strategy: our findings are restricted by current knowledge.

there are two categories of gsa based on the statistical tests used: sample randomization and gene randomization  <cit> . sample randomization methods test significance of gene sets based on permutation of sample labels, with gsea  <cit> , safe  <cit>  and sam-gs  <cit>  as representatives. in contrast, gene randomization methods test the significance of gene sets based on permutations of gene labels or a parametric distribution over genes, with page  <cit> , t-profiler  <cit>  and random-set  <cit>  as representatives. sample randomization maintains the correlation structure among genes but only applies to large expression datasets with multiple samples per experimental condition. for a two-state comparison, a minimum of  <dig> chips for each state is required for  <dig> balanced  permutation or  <dig> chips for  <dig> unbalanced permutation. gene randomization has no limitation on sample size, but may break the correlation structure among genes  <cit> â€“an issue that may or may not be a problem   <cit> . sample randomization and gene randomization test different but related null hypotheses, tian et al.  <cit>  and nam et al.  <cit>  proposed combinatory procedures to achieve more robust results.

all these methods established gsa as a powerful strategy for gene expression data analysis. in spite of its advantages, gsa as a whole strategy still suffers from three major limitations.

first, currently available gsa methods do not handle small datasets effectively, yet most gene expression datasets fall into this category. as mentioned above, the sample randomization strategy used by methods such as gsea is not appropriate for studies with under  <dig> gene chips per state, thus gene randomization remains to be the only feasible option  <cit> . gene randomization methods such as page have been applied to small dataset  <cit> , but these methods tend to make large number of  positive calls with extremely small p-values  <cit>  . t-profiler targets datasets with one sample pair  <cit> , however, it can't combine results from multiple paired experiments nor can it be applied to studies with non-paired studies  <cit> .

second, no gsa method currently available handles datasets with different sample sizes and experiment designs consistently. for datasets with few or no replicates, t-test statistics, signal to noise ratios, or their corresponding p-values are not robust estimates of differential expression for genes or simply not applicable. therefore, fold change  is frequently used as more versatile per gene statistics  <cit> . the use of fold change gives rise to two issues that have been largely neglected so far. first, the average fold change does not account for different experimental designs, i.e. pair-matched samples or non-paired samples. the per gene statistics such as t-test statistics may vary significantly depending on if the samples are paired or not, yet there is no difference in fold change. second, average fold change does not contain any information for the sample size. sample size largely determines the confidence or significance level of our inference, yet is dropped when using fold change. fold change makes sense in one-on-one paired comparison, as in t-profiler  <cit> . however for datasets with replicate samples, the test power or the significance of relevant gene sets would be underestimated.

third, most gsa methods only consider transcriptional regulation in one direction  in a gene set. this directional bias makes sense for experimentally derived gene sets, but not for gene sets based on canonical signaling pathways, which frequently show reciprocal gene regulation in both directions upon perturbation  <cit> . thus it is advisable to consider both cases for an inclusive analysis for regulatory mechanisms.

to address these issues, we have developed a novel method called generally applicable gene-set enrichment  . gage applies to datasets with any number of samples and is based on a parametric gene randomization procedure. similar to parametric analysis of gene set enrichment   <cit>   and t-profiler  <cit> , gage uses log-based fold changes as per gene statistics. however, gage differs from page and t-profiler in three significant ways. first, gage assumes a gene set comes from a different distribution than the background and uses two-sample t-test to account for the gene set specific variance as well as the background variance. in contrast, page assumes gene sets comes from the same distribution as the background and uses one-sample z-test that only considers the background variance  <cit> . t-profiler also employs two-sample t-test, but it is essentially a one-sample z-test since the sample size of a gene set is not comparable to its complementary set  <cit>  . second, gage adjusts for different microarray experimental designs  and sample sizes by decomposing group-on-group comparisons into one-on-one comparisons between samples from different groups. gage derives a global p-value using a meta-test on the p-values from these comparisons for each gene set. third, gage separates experimentally perturbed gene sets  and canonical pathways . experimental sets are taken as genes coregulated towards a single direction, whereas canonical pathways allowed changes in both directions. this gene set separation strategy give gage more test power in detecting relevant biological signals.

in this work, we show that gage is generally applicable to datasets with different sample sizes and experimental designs. we first apply gage to two lung cancer datasets  <cit>  and one type  <dig> diabetes dataset  <cit> , which has been analyzed by gsea  <cit>  and page  <cit>  as example cases. these are representatives for large datasets with tens of samples per condition frequently seen in large clinical or experimental studies. we then analyze a smaller, previously unpublished dataset describing mesenchymal stem cell response to bmp <dig> treatment. this is a typical small dataset with as few as two samples per condition like in most experimental studies. bmp <dig> treated samples and controls are one-on-one matched, which is a frequently used experiment design particularly for all the two-channel microarray studies. in each case, we compare gage to gsea and page. to compare the performance of gage vs gsea and page in a more controllable setting, we conducted simulation study using the type  <dig> diabetes dataset and synthetic gene sets. finally, we also detail the major strategies employed by gage.

RESULTS
application to large datasets with the gsea and page as control methods
as a test case, we applied gage, page and gsea to two lung cancer datasets  <cit>  which were originally analyzed and compared by gsea  <cit> . these two datasets were generated by two independent studies done in boston  <cit>  and michigan  <cit> , containing gene expression profiles of lung adenocarcinomas samples from patients. patients were classified as having "good" or "poor" clinical outcomes. for each dataset, we defined the control set as patient profiles with good clinic outcomes, and selected the most differentially regulated gene sets associated with poor outcomes. note that we used the updated curated gene set collection c <dig> from msigdb  <cit>  for both methods. for a fair comparison, experimental sets and the canonical pathways were separated for all three methods.

we compared the top  <dig> most significant gene sets inferred by the three methods  and identified evident differences in four aspects. first, the top experimental gene sets selected by gage and page overlapped significantly, but the canonical pathways identified by gage, page, and gsea did not . the lack of overlap for the canonical pathways is expected because gage allows perturbations in both directions in canonical pathways. second, gage derived modest p-values and numbers of significant gene sets compared to gsea and page . while others have suggested that gsea suffers from low sensitivity  <cit> , our results suggest that page is overly sensitive . third, the top  <dig> gene sets inferred by gage are more consistent between the two studies:  <dig> experimental sets and  <dig> canonical pathways are the same for gage results,  <dig> and  <dig> for page and  <dig> and  <dig> for gsea respectively . fourth, the top  <dig> gene sets inferred by gage better describe poor outcomes of lung cancer mechanistically . canonical pathways inferred by gage are by far the most indicative of tumor occurrence and metastasis. experimental sets inferred by gage and by page are similarly indicative of tumor occurrence and prognostic of metastasis or poor clinical outcomes, and both are better than those inferred by gsea.

top  <dig> most significantly enriched experimental sets and canonical pathways in poor clinical outcomes vs good outcomes were inferred by gage from two published lung adenocarcinoma data sets used in the gsea paper  <cit> . both positively and negatively regulated gene sets were collected and ranking by the p-value, and by absolute value of average t-statistics  for ties. fdr q-values were estimated to correct the p-values for the multiple testing issue. consistencies between the two data sets are shown in bold font. notes show the connections of the gene sets to cancer related topics: t for tumor related; bt for tumor metastasis and bad outcome; c for cell growth and proliferation related; and blank represents no evident connection. these annotations came from the original studies for experimental sets, or made based on more than three independent literature works for the canonical pathway.

the top  <dig> most significantly enriched experimental sets and canonical pathways in poor clinical outcomes vs good outcomes were inferred by gage, page, and gsea from two published lung adenocarcinoma data sets used in the gsea paper  <cit> . data columns are overlap between top  <dig> gene sets for the two studies, top  <dig> p-values, number of top  <dig> gene sets related to metastasis  and tumor , and numbers of significant gene sets with p-value â‰¤  <dig>  .

several major mechanistic themes predictive of poor clinical outcomes emerged from the list of top gene sets inferred by gage. these themes included g-protein coupled receptors  associated signals , thrombosis or blood coagulation activation , and hormone and cytokine . indeed, g-protein-coupled receptors, the largest family of cell-surface molecules involved in signal transmission, have emerged as crucial players in the growth and metastasis of multiple human cancers  <cit> . thrombosis or blood coagulation activation has been implicated in the disease and is an predictor for poor survival rates for lung cancer patients  <cit> . androgen level and cytokine profiles influence clinic outcomes of non-small cell lung cancer  <cit> . all these factors are likely the major causal or contributing mechanisms for non-small cell lung cancer progress and metastasis.

we also applied gage, page and gsea to another large dataset describing type  <dig> diabetes progression that was analyzed by gsea  <cit>  and page  <cit>  previously . this comparison performed similarly to the cancer study mentioned above. in particular, gage pinpointed multiple experimental sets and canonical pathways which are directly involved in type  <dig> diabetes or closely related metabolism processes.

application to small datasets with page and gsea-g  as control methods
we applied gage and page to a microarray dataset generated by our group to select the most differentially expressed gene sets in human mesenchymal stem cells  upon bmp <dig> treatment . the dataset contains a total of  <dig> gene chip measurements from duplicate experiments each with paired measurements of human msc with or without  <dig> hours bmp <dig> treatment. note that gsea by default is not applicable to this dataset because the sample size is too small for permutation based inference. however, gsea with gene labels permutation option  works. since gsea-g does not implement the sample randomization strategy recommended by the authors  <cit> , we focus on comparing gage to page here . gage conducts one-on-one comparisons, hence was applied to each of the two bmp <dig> experiments individually . for an exact comparison, page was slightly modified to enable one-on-one comparisons . the gsea software took multiple samples per condition hence not applicable to the experiments individually .

top  <dig> most significantly differentially expressed experimental sets and canonical pathways were inferred by gage from human mscs following an  <dig> hour bmp <dig> treatment. two replicate experiments were done, each with bmp <dig> treated sample and control. therefore gage was applied to each experiment and derived corresponding p-values . gene sets were ranked based on global p-values from both experiments. fdr q-values were estimated to correct the global p-values for the multiple testing issue.

the significantly enriched experimental sets and canonical pathways in human msc following  <dig> hour bmp <dig> treatment were inferred by gage, page and gsea-g . top  <dig> t-  or z-  statistics or nes  and p-values and the numbers of significant gene sets were shown with p-value â‰¤  <dig>  . note that gsea-g results shown were based on nominal p-values .

using a p-value cutoff of < <dig> , gage identified fewer gene sets than page . gage identified  <dig> significant experimental sets and  <dig> canonical pathways . there were only  <dig> significant experimental sets and  <dig> canonical pathways  after removing the redundancy among gene sets, which is reasonable number of pathways triggered by a single perturbation in a single cell line. in contrast, page called  <dig> significant experimental sets and  <dig> significant canonical pathways. most significant genes sets selected by page were not significant according to gage using the same cutoff p-value . after removing the redundancy in these sets, there were more than  <dig> and  <dig> non-redundant experimental sets and canonical pathways respectively . presumably, page made a large number of false positive calls. similar differences between gage and page were observed for the two lung cancer datasets and the type  <dig> diabetes dataset . this difference came from the different statistical tests used by gage and page, i.e. two-sample t-test vs one-sample z-test . gsea-g gave p-values and a predicted number of significant gene sets comparable to gage when nominal p-values were used .

biologically, gage gene sets were mechanistically more relevant for bmp <dig> effects compared to those sets selected by page.  <dig> out of  <dig> experimental sets inferred by gage  are directly related to interferon or stat pathway  <cit> , which is a target of bmp signaling  <cit> . the experimental sets selected by page alone have less connection to bmp . gage and page differed in  <dig> entries of the top  <dig> canonical pathways. of gage predictions , wnt signaling  <cit> , proliferation  <cit>  are all known pathways or processes regulated by bmps in msc or osteoblastic cell lineages. bmps regulate hematopoiesis and erythrocyte differentiation  <cit> . breast cancer estrogen signaling interacts with bmp signal  <cit> . none of these pathways were significant according to page . the gsea-g top experimental sets overlapped with gage, but the canonical pathways were more similar to page .

significant gene sets inferred by gage were consistent across replicate experiments and within the top  <dig> lists. the top  <dig> gene sets are almost the same if we used either one of the two experiments only . the difference between the p-values from the two experiments almost never exceeded one order of magnitude. on the other hand, the top  <dig> gene set lists inferred by the page and corresponding p-values are more different across the two experiments . there was also high level of internal consistency in the top  <dig> gene sets inferred by gage . for example,  <dig> out of  <dig> experimental sets were directly related to interferon signal. among the canonical pathways, there were two proliferation and two hematopoietic differentiation related pathways. in addition the high scoring alk pathway overlapped with tgf beta and wnt signaling pathways. in contrast, the page and gsea-g top gene sets had lower internal consistencies . these results indicate that gage is a method robust against the heterogeneity in experiments or gene set definition. notice that redundant gene sets representative of the same effect or pathway were kept here for exact comparison between methods, but they can be differentiated and combined by gage program if needed .

a microarray data based simulation study
we conducted simulation study to compare the performance of gage vs gsea and page in a more controllable setting. to minimize the potential artifact of using synthetic data, we used the type  <dig> diabetes dataset which has been analyzed in the first part of the results. we chose this large clinical dataset so that all methods including the sample randomization based gsea are applicable. also, to make the simulation tractable for gsea, we employed a sub-dataset with  <dig> randomly sampled genes from the full set of  <dig> genes. while the dataset is real microarray data, we synthesized the testing gene sets with controlled levels of differential expression . we then applied gage, page or gsea to score these testing gene sets, and evaluated whether the enrichment scores reasonably reflect the differential expression levels of these testing gene sets.

similar to the analysis results described above, while gage and gsea gave more sensible p-values in the simulation, page resulted in unrealistically small p-values on the order of 10- <dig>  . the fact that p-values started from 10- <dig>  or 10- <dig>  for gene sets with no up-regulation at all  shows that page suffers from low specificity. in other words, the extremely small p-values did not indicate high sensitivity but rather a high false positive rate for page. on the other hand, gage and gsea are selective and started from insignificant p-values for the negative control gene sets with Î² = Î± =  <dig>  compared to gsea, gage gave smaller p-value for gene sets with different levels of up-regulation . in other words, gage is more sensitive than gsea. this improvement does not come at the cost of lower specificity . note that gsea reached sensitivity cap . out of all three methods, only gage produced strictly monotonically decreasing p-value curves that closely reflected the increasing up-regulation levels of the testing gene sets with increasing Î².

we further compared the p-values inferred by these three methods under null condition by using testing gene sets with strictly no up-regulation . gage with 1-on- <dig> and grp-on-grp options and gage-r  derived null p-values closely following a uniform distribution. this further confirmed the theoretical soundness of gage, and that the improved sensitivity of gage  compared to gsea does not rely on a bias in the null distribution . the null simulation indicates that both gage and gsea are equally selective against false positive . however, simulation with different levels of up-regulated gene sets shows gage is more sensitive to true positive  . gage with the 1-on-grp option  derived null p-values that are slightly different from the uniform distribution, and is more likely to produce false positive results compared to gage with the default 1-on- <dig> option. however, the gage 1-on-grp comparison would still work reasonably well as a computationally fast option based on our results using experimental data . in contrast, page derived an extremely biased null p-value distribution. over 40% of the p-values are essentially  <dig>  another 40â€“50% are  <dig>  clearly, in consistent with all our earlier observations, page produces a high false positive rate.

top  <dig> significantly enriched experimental sets and canonical pathways in poor clinical outcomes vs good outcomes were inferred by gage using these three different comparison schemes from two published lung adenocarcinoma data sets  <cit> . data columns are overlap between top  <dig> gene sets for the two studies, top  <dig> p-values, number of top  <dig> gene sets related to metastasis  and tumor , and numbers of significant gene sets with p-value â‰¤  <dig>  .

impact of gage strategies: gene set separation, two-sample t-test, and one-on-one comparisons
compared to page and gsea, gage employs three different strategies: 1) gene set separation, 2) two-sample t-test, and 3) one-on-one comparisons between experiment and control samples. in this section, we show the impact of each of these three strategies in representative analyses, although these strategies have been consistently effective when applied to multiple datasets covered or not covered in this paper. we compare gage to page on these aspects if possible, or to gage variants which ensembles page in each one of these three aspects for exact comparison. gsea is either not or less comparable in these aspects.

gene set separation
in contrast to page and gsea, gage separates canonical pathways from experimental sets and considers potential perturbations in both directions  in canonical pathways. expression data directly showed that genes in the most relevant canonical pathways are regulated in both directions . figure 3a shows the gene expression level changes following bmp <dig> treatment in top  <dig> different significant canonical pathways inferred by gage and page . these canonical pathways inferred by gage are directly related to bmp induced osteoblast differentiation  <cit>  . figure 3b shows the gene expression level changes in the tgf beta-bmp signaling pathway following bmp <dig> treatment. this pathway is a presumable gold standard as it is the primary signal triggered directly by bmps . the changes of gene expression are not uniform. the tgf-beta pathway includes both positive effectors such as bmps, bmpr1â€“ <dig>  smad1/5/ <dig>  id1â€“ <dig>  and thbs, and negative effectors such as nog, smad2/ <dig>  and smad6/ <dig>  clearly, both types of effectors were regulated up and down. genes are regulated in both directions not only for the whole pathway but also within the sub-pathways like bmp or tgf-beta signaling branches. these results demonstrate that genes in canonical pathways are frequently up- and down-regulated simultaneously because 1) they play positive or negative roles  <cit>  and 2) homeostatic mechanisms tend to bring a certain level of balance back to the system when it is perturbed  <cit> . therefore, it is necessary to treat canonical pathways differently from experimental sets and count both up and down regulation when doing gene set analyses.

compared to the top  <dig> canonical pathways assuming one-way changes, the top  <dig> canonical pathways allowing two-way changes better described bmp induced osteoblast differentiation mechanistically . tgf beta signaling, wnt signaling and cell proliferation are all known essential signals or processes for osteoblast differentiation  <cit> , yet they are not significant in the one-way changing list . one-way assumption tends to select metabolism pathways , which are likely to be tightly coregulated as relative simple functional group. in other words, top canonical pathways with one-way changes are still interesting if they are not complicated regulatory pathways.

two-sample t-test
gage uses a two-sample t-test to compare expression level changes of a gene sets to the whole set background, whereas page uses a one-sample z-test. gage's use of a two-sample t-test has three effects. first, two-sample t-test considers the variance for both the target gene set distribution as well as the background distribution , while a one-sample z-test only considers the variance for the background distribution and ignores the effect of specific target gene set distribution . the background variance is small and often negligible compared to the within gene set variance, hence page can produce unrealistically large z-scores and small p-values  in contrast to gage . second, the two-sample t-test used by gage identifies gene sets with modest but consistent changes in gene expression level, whereas page tends to identify gene sets with a few extremely changed outliers . in other words, gage is more robust to experimental noise or variations in gene set definitions than page. many top gene sets selected by page were not significant according to gage  because the within gene set variance is too large . on the other hand, significant gene sets inferred by gage are almost always selected as significant by page . said another way, gage is as sensitive  as page, but more specific  than page . third, there is higher level of consistency within the top  <dig> gene sets inferred by gage  than by page , and between the top  <dig> gene sets across experiments . this consistency is because the two-sample t-test is more robust than one-sample z-test for gene set analysis. all these observations for page also apply to gage-z .

with the classical two-sample t-test as the default of gage, we also looked at a rank-based two-sample t-test as an alternative , which is potentially less sensitive to the violation of normal distribution assumption and expression outliers. gage-r gave similar results  in terms of the significant gene set list, the number of significant gene sets , p-values and q-values. this result further confirmed the robustness of gage method and validated two-sample t-test as the default option.

one-on-one comparisons
gage carries out one-on-one comparisons between experiments and controls, whereas page compares experiments and controls as two groups together. one-on-one comparisons are natural when the experiment samples and controls are paired. this one-on-one pairing is still preferred over group-on-group comparison even though experiments are not pair-matched for two reasons. first, multiple tests on all experiment-control pairs are more statistically powerful than single test on group averages, as the p-values  would be orders of magnitude smaller for the one-on-one comparisons versus the group comparisons . second, comparisons between two specific samples makes sense but not between two sample groups when the net effect of the whole gene set is non-additive, for instance, being expressed as mean of the absolute fold changes for canonical pathways . as expected, a one-on-one comparison approach produced more consistent and biologically meaningful results across independent studies . the enumeration of all one-on-one comparisons is not always advantageous as it can be relative slow for datasets with large number of replicates. to speed up the analysis of larger datasets, we can take the average gene expression levels for all controls as a single reference state and do gene set analysis on each experiment sample vs this reference state, because controls are often more homogenous than experiments. correspondingly, gage has the options for three-way comparison schemes specified as 1-on- <dig>  1-on-grp and grp-on-grp. the option 1-on-grp produces similar results to 1-on- <dig> but different results to grp-on-grp . the difference between these three options is better shown when the sample conditions are complicated as in the large clinical datasets above.

discussion
in this work we have presented a new gene set analysis method gage that is generally applicable to gene expression datasets of all sample sizes and experimental designs and in general performs better than two most frequently used methods. we have demonstrated gage's performance by comparing it to gsea and page extensively in the following three aspects:  consistency across parallel studies or experiments;  sensitivity and specificity of the pathway inference;  biological relevance of the pathways identified.

our results show a significant impact of separating gene sets into pathway and experimentally derived gene sets as is shown in figure  <dig>  we showed that two-way perturbations commonly occur in regulatory pathways , which would otherwise be overlooked . however, pathway derived gene sets do not always show regulation in both directions. for example, we see that metabolic pathways or functional groups such as go term categories tend to be coregulated toward one direction . strictly speaking, many of these gene sets are not signaling pathways and could be further separated from canonical signaling pathways . in response to this observation, gage provides the option for two rounds of screening on msigdb pathway sets. the first round assumes two-way regulation for regulatory signaling pathways while the second round assumes one-way for coregulated functional groups.

gage made two assumptions in conducting two sample t-tests on the log based fold changes of target gene set and control sets. the first assumption is approximate normal distribution for the mean fold change of the two sets. the central limit theorem states that the distribution of an average of sampled observations is normal regardless of the nature of parent distribution when sampling size is large enough. indeed, the mean of fold change values for gene sets with â‰¥  <dig> genes are close to normal distribution as shown by q-q plot previously  <cit> . the second assumption is that the fold changes of genes are independent and identically distributed . dependency between genes has been a concern for all gene randomization methods  <cit> . however, netwon et al  <cit>  argued that dependency is not necessarily an issue when gsa was conditioned on the differential expression analysis results . moreover, we think dependency  is rare for randomly sampled control gene sets. for most curated gene sets there is no coregulation under the specific condition of the microarray study , and the null hypothesis holds. for the few interesting gene sets where genes are coregulated, there will be a significant difference in expression between these sets and random control sets, hence the null hypothesis gets rejected. therefore, gene sets which violate the iid assumption are the few significant sets and will be captured this way  <cit> . gage results clearly showed that our arguments work. the same logic has also been quite successful in well established gene randomization methods  <cit> .

the one-on-one comparison scheme is generally applicable to datasets of all sample sizes and experiment designs. we used a meta-test to infer a global p-value for all the individual comparison p-values. the global p-values and the number of significant gene sets we derived are sensible. as in common statistical tests, these p-values tend to decrease when the sample size increases, and can become small for large datasets like the lung cancer datasets , hence the number of significant gene sets can be large especially when all the redundant gene sets are kept . this result is still sensible because large clinical datasets  are generally more heterogeneous than small experimental datasets .

there are frequently multiple significant gene sets that share multiple genes or represent the same regulatory mechanism, especially for experimental gene sets. this redundant gene sets problem has been discussed elsewhere in detail  <cit> . in response to this issue, gage has the option to combine redundant gene sets and give more concise significant gene set lists . in this work, we chose not to combine these redundant gene sets for exact comparison between methods. as a benefit of not merging these sets, we took these overlapping sets as an internal control to validate the internal consistency of the predictions.

there is also a multiple testing issue, i.e. gene sets may become significant when the gene set number is large. classical fdr procedures like benjamini-hochberg   <cit>  and bonferroni  <cit>  corrections tends to be conservative. such adjustment is further complicated when gene sets contain different numbers of genes . hence gene randomization based gsa methods like page  <cit>  and t-profiler  <cit>  do not consider this adjustment . sample randomization based gsa methods like gsea suffer from conflicting ordering between fdr q-values and nominal p-values . in gage, the one-on-one comparison and one-on-group comparison schemes not only gives us more testing power and robustness, but also provides the framework to conduct a unified and rigorous fdr procedure for gene sets of different sizes. because the meta-test on k p-values  is the same  for all gene sets despite of their different size.

CONCLUSIONS
in this work, we present a novel method gage for gene set analysis . gage is generally applicable to gene expression datasets with different sample sizes and experimental designs, hence greatly expands the applicability of gsa. in both simulation experiments and multiple microarray data analyses, gage consistently outperformed two most frequently used gsa methods, gsea and page in three major aspects:  consistency across repeated studies/experiments;  sensitivity and specificity;  biological relevance of the regulatory mechanisms inferred. gage reveals novel and relevant regulatory mechanisms from both published and previously unpublished microarray studies.

