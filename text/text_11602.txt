BACKGROUND
alternative promoter usage is known to affect more than half of all human and mouse genes, and has been proposed as a primary driver of varied transcriptional regulation in different cellular conditions or developmental stages  <cit> . numerous genes displaying complex transcriptional regulation, because of the use of alternative promoters, have been studied thoroughly  <cit> . recent annotations of the human and mouse genomes suggest that many differentiation and disease-associated genes contain alternative promoters. annotation of all human and mouse gene promoters that are differentially used during development, in different cell/tissue types or aberrantly activated in disease conditions is still incomplete and is essential for defining the transcriptome and proteome of human and mouse genomes.

the development of chromatin immunoprecipitation methods coupled with dna microarray  technology and massively parallel sequencing  has enabled genome-wide identification of promoters, using antibody against rna polymerase ii  in different cells or tissues  <cit> . the combined signatures of rna pol-ii binding and histone modification marks like h3k4me <dig>  h3k9ac obtained by these high throughput technologies are being used to identify human and mouse transcriptional units  <cit> . however, there are some challenges in predicting promoter usage based on the enrichment regions/peaks observed in these chip-chip/seq experiments. the chip-chip/seq technology requires antibodies with extremely high affinity and specificity for the target transcription factors. unfortunately, such antibodies are not available for most human transcription factors, including pol-ii, producing non-specific enrichment in the chip-chip/seq profiles. the non-specific enrichment regions could be eliminated from the analysis by performing a chip-chip/seq experiment on the same cell or tissue lacking the specific factor. however, in most cases this is not feasible and we have to rely on other methodologies like the use of non-specific igg chip-chip/seq to decrease the non-specific enrichment background. the major challenge in annotating promoters based on rna pol-ii enriched regions/peaks is the spread of the transcribing polymerase throughout the gene and as a result all genomic regions bound by rna pol-ii are enriched in these experiments, producing significantly large number of enriched peaks after the initial statistical analysis  <cit> . though the initiator form of rna polymerase ii  is enriched at a higher level in promoter region of actively transcribed genes, it is not restricted to the promoter region. moreover, the promoters with stalled rna pol-ii do not show an enrichment for the ser <dig> phosphorylated form of rna pol-ii  <cit> . similarly, the histone marks namely h3k4me <dig> and h3k9ac, which are highly enriched in promoter regions, are not exclusively present in promoter regions  <cit> . currently it is not possible to identify promoters with high confidence based on rna pol-ii chip-chip/seq enrichment data alone, thus warranting development of better classification algorithms for accurate identification of promoter related pol-ii enriched regions.

here, we developed a computational method to discriminate promoter associated rna pol-ii enriched regions of length  <dig> bp from the enrichment at other genomic regions, using the rich source of existing promoter data and associated chromatin modification signatures and various dna sequence features. we prepared a data-set consisting of  <dig>  pol-ii enriched promoters and  <dig>  pol-ii enriched non-promoter regions from our recent chip-seq experiments, using antibody against pol-ii on five mouse tissues. we systematically trained and evaluated recent ensemble classifiers on this data set, using both 10-fold cross validation and testing on independent test set, and selected bagging and random forest classifier for the final algorithm.

methods
dataset of pol-ii enriched promoters and non-promoters for training the classification models
the training set was generated from rna pol-ii chip-seq data of five mouse tissues  generated by our lab. the rna pol-ii chip-seq data was first processed and pol-ii enrichment peaks were identified at an fdr of  <dig> , by assuming that peaks in the random background would follow poisson statistics. the identified peaks were compared with tss of non-redundant gene list generated from four different sources: refseq, vega, ensembl and ucsc. the gene lists were downloaded from ucsc genome browser  <cit>  for mm <dig>  any peak that falls within - <dig> bp to + <dig> bp of known tss  were taken as promoter peak. the pol-ii peaks which are inside a gene but do not overlap with any of the known tss are candidate non-promoter peaks. for our negative set, we consider only those peaks which fall within transcripts that possess a pol-ii enriched peak at the corresponding promoter . also, any peak which falls within the promoter region of homologous gene known in other organism and within the 5' end of compiled set of non-redundant expression sequence tags  was removed from the negative set, because some of those could be undiscovered novel promoters in the mouse genome. the homologous gene track  was downloaded from ucsc genome browser. after identification of promoter and non-promoter peaks, the pol-ii peak was annotated as actual tss for the transcript in that particular tissue. for each annotated peak , sequences were generated each of length  <dig> bp . after performing this procedure for all the tissues, we again compared the records in promoter and non-promoter sets with each other and removed the overlapping records from the non-promoter set. finally, our complete dataset has  <dig>  records in the promoter set and  <dig>  records in the non-promoter set. we used  <dig>  and  <dig>  records from promoter and non-promoter sets respectively for training the classification models. in addition to 10-fold cross-validation, we used the remaining records  to test the performance of the fitted models. the data sets are available as supplementary information at  <cit> .

classification models
we tried different state-of-art ensemble and meta classifiers for identification of promoter and non-promoter classes. the weka data-mining toolbox  <cit>  was used for building the classification models. the different classifiers tested on 39-dimensional feature vector are: logitboost  <cit> , bagging  <cit> , rotational forest  <cit>  and random forest  <cit> . the detailed description of the classification methods is provided in supplementary method.

feature variables used in classification model
each sequence record  of the promoter and non-promoter set is represented by a 39-dimensional feature vector. the feature values were calculated based on  dna sequence composition;  dna physico-chemical-structural properties, and  experimental data. most of the conversion tables that are based on dna physical-chemical-structural properties were downloaded from  <cit> . the feature variables used in the classification models are briefly described below.

let a given dna sequence be: s = s1s2s3s4⋯sl-1sl, where si ∈ {a, c, g, t},  <dig> ≤ i ≤ l . let Δ <dig> ≡ {a, c, g, t}, Δ <dig> ≡ {aa, ac, ag, at, ca, cc, cg, ct, ga, gc, gg, gt, ta, tg, tc, tt}, Δ <dig> ≡ {aaa, aac, aag, aat, aca, acc, ⋯, ttt}, Δ <dig> ≡ {aaaa, aaac, aaag, aaat, aaca, aacc, ⋯, tttt} represent single, di, tri, tetra nucleotide symbol set respectively.

 properties based on dna sequence composition
we calculate  <dig> different features in this category. the first  <dig> features are calculated from single nucleotide composition. let nx represents the total number of times symbol x appeared in s and x ∈ Δ <dig> for single nucleotide features.

 <dig>  a_fraction: na/l

 <dig>  c_fraction: nc/l

 <dig>  g_fraction: ng/l

 <dig>  t_fraction: nt/l

 <dig>  purpyr_fraction: /l

 <dig>  amke_fraction: /l

 <dig>  west_fraction: /l

the remaining  <dig> features are related to cpg island. one of the features is based on di-nucleotide composition, where x ∈ Δ <dig>  and remaining  <dig> features are based on tri-nucleotide composition, where x ∈ Δ <dig>  similar cpg features were used in  <cit>  for promoter prediction.

 <dig>  cpg1: /

 <dig>  cpg2: /

 <dig>  cpg3: /

 properties based on physico-chemical-structural property of dna sequences
in this category we calculate  <dig> features. let φp represent a mapping function for a property 'p', where x ∈ Δ <dig> or x ∈ Δ <dig> or x ∈ Δ <dig> or x ∈ Δ <dig> depending upon given property. the feature value for a given sequence 's' based on property 'p' is given by , where nx represents total number of times symbol x has appeared in s. and Δ ≡ Δ <dig> or Δ ≡ Δ <dig> or Δ ≡ Δ <dig> or Δ ≡ Δ <dig> depending up on the property 'p'.

the dna sequence properties 'p' from which the features are calculated is as follow:

 <dig>  a-philicity  <cit> 

 <dig>  base-stacking  <cit> 

 <dig>  b-dna twist  <cit> 

 <dig>  dna bending stiffness  <cit> 

 <dig>  di-nucleotide flexibility energy  <cit> 

 <dig>  dna denaturation  <cit> 

 <dig>  duplex stability disrupt energy <cit> 

 <dig>  duplex stability free energy  <cit> 

 <dig>  helical rise  <cit> 

 <dig>  helical twist  <cit> 

 <dig>  helical tilt  <cit> 

 <dig>  helical roll  <cit> 

 <dig>  helical shift  <cit> 

 <dig>  helical slide  <cit> 

 <dig>  propeller twist  <cit> 

 <dig>  protein induced deformability  <cit> 

 <dig>  protein-dna twist  <cit> 

 <dig>  z-dna stabilizing energy  <cit> 

 <dig>  tri-nucleotide bendability  <cit> 

 <dig>  nucleosome position preference  <cit> 

 <dig>  tetra-nucleotide flexibility  <cit>  and

 <dig>  eiip  <cit> 

 feature variables from experimental data
in this category we calculate  <dig> features. the feature values are calculated from cage tags, rna pol ii chip-seq and h3k4me <dig> chip-seq data sets. the cage tags were downloaded from fantom <dig> project  <cit> . rna pol ii and h3k4me <dig> chip-seq datasets taken up for our study were downloaded from ncbi geo website. the accession numbers for the datasets are as follow: gse <dig>  <cit> , gse <dig>  <cit> , gse <dig>  <cit> , gsm <dig>  <cit> , gsm <dig>  <cit> , gse <dig>  <cit> . each chip-seq dataset was processed at an fdr of  <dig>  using our program for significant region identification. the tags which are part of significant regions were considered for feature value calculation. in total  <dig> different samples of h3k4me <dig> chip-seq datasets and  <dig> different samples of pol-ii  were collected. total number of cage tag count per million  that falls in  <dig> bp windows was taken as cage tag related feature. for both, h3k4me <dig> chip-seq and rna pol-ii chip-seq data we calculated the following three different features:

 <dig>  average tag count per million 

 <dig>  maximum tpm

 <dig>  maximum tpm/average tpm

the performance of the fitted models and other best performing promoter prediction programs, which are publicly available for download to run on whole chromosomes on a local computer, was tested on an independent un-seen data set. when a predicted promoter overlaps with pol-ii enriched promoter, then the respective record is counted as true positive . and when such case is missed it is termed as false negative . when a predicted promoter overlaps with pol-ii enriched non-promoter, then such case is counted as false positive . and if such case is predicted as non-promoter then it is termed as true negative . the performance of classifier is evaluated based on the promoter prediction metrics suggested by bajic et. al.  <cit> : sensitivity , positive predictive value , correlation coefficient  and true-positive cost . the equations for the performance metrics are as follow:  

RESULTS
classification models to predict promoters using chromatin modification signatures and dna sequence features
for selecting the best performing classifier, we trained four different ensemble and meta classification models on 3/4th of the dataset and tested on the remaining 1/4th of the dataset. the performance measures obtained by using 10-fold cross-validation and independent test set are presented in tables  <dig> and  <dig>  the performance measures, in terms of sensitivity and positive predictive accuracy, among the classifiers do not vary much over the four different models. bagging and random forest models are slightly better than the other two models, showing lower error rates. figure  <dig> allows for a more informative discussion on the relative predictive performance of the models. it is clear that bagging, logitboost and random forest perform more or less similar and slightly better than rotational forest, with overall positive predictive value greaten than  <dig> and correlation coefficient greaten than  <dig> . we then implemented the classification models given by bagging and random forest methods in our algorithm which, will be applied to scan all the pol-ii enriched peaks in the mouse genome.

while the classification methods used here are considered "black box" methods, with no interpretable classification model, the methods still provide useful information, such as variable importance. one of the measures of variable importance in random forest method is the mean decrease in accuracy, calculated using the out-of-bag sample. the difference between the prediction accuracy on the untouched out-of-bag sample and that on the out-of-bag sample permuted on one predictor variable is averaged over all trees in the forest and normalized by the standard error. this gives the mean decrease in accuracy of that particular predictor variable which has been permuted. thus, the importance of the predictor variables can be ranked by their mean decrease in accuracy. figure  <dig> shows the list of feature variables ranked according to mean decrease in accuracy of classification. it is interesting to note that feature variables based on experimental data such as cage tags, pol-ii enrichment, and h3k4me <dig> enrichment rank among the most discriminative variables from mean decrease in accuracy graph .

comparison with other promoter prediction programs
we compared our algorithm with some of the existing best performing promoter prediction methods  <cit> : ep <dig>  <cit> , eponine  <cit> , firstef  <cit> , prosom  <dig>   <cit> . table  <dig> and figure  <dig> show that our classification model out-performs these existing programs based on independent  test set of pol-ii enriched promoters and pol-ii enriched non-promoters.

annotation of promoters in mouse genome using pol-ii chip-seq data
although extensive promoter annotations are available from the ebi and ucsc genome servers, most annotations do not contain information about tissue or cell-type information from experimental data. to demonstrate the efficacy of our new algorithm in finding promoters and to provide the annotation of potential novel promoters, we used the pol-ii enrichment peaks obtained from seven chip-seq datasets available on in vitro adipocyte differentiation of mouse 3t3-l <dig> cells and mouse es cells, and the results are presented in table  <dig>  we applied the random forest classification model  on a sequence of length  <dig> bp around each pol-ii enriched peak  in both strands. if  <dig> bp region from both strands are predicted as peak then they are merged and counted as one promoter. for each predicted promoter region, we annotated it to a nearby gene, if the pol-ii enriched peak is located within - <dig> kbp to + <dig> bp around the corresponding gene tss. we generated a non-redundant tss file for coding genes from refseq, vega, ensembl and ucsc genes. for non-coding genes we used information available at refseq, vega, ensembl, ucsc, mirbase  <cit>  and recently discovered large non-coding rnas   <cit> . table  <dig> presents the total number of peaks predicted by the model as promoters and also the number of annotated coding and non-coding genes in each sample. we then combined the results from all seven samples of predicted promoters in order to identify alternative promoters for each gene. for protein coding gene set, we found that there are  <dig>   <dig>  and  <dig> genes with one promoter, two promoters, and three or more promoters respectively. in other words, based on these annotations,  <dig> % of the protein coding genes in mouse genome have two or more alternative promoters. for non-coding genes, we found that  <dig>   <dig>  and  <dig> genes with one promoter, two promoters, and three or more promoters respectively.

future directions
we will use this program to annotate human gene pol-ii promoters by running on all the publicly available chip-seq pol-ii enrichment profiles. our method successfully predicts  <dig> bp promoter regions  and to better localize the core-promoter regions within the predicted promoters, we will apply recently developed coreboost_hm program published by zhang laboratory at cshl  <cit> .

discussion
chromatin modification and transcription factor binding profiles in the mammalian genomes is rapidly accumulating with the advent of next generation sequencing approaches. however, computational methods to effectively integrate these profiles to identify and annotate the promoter usage in specific cell/tissue types or developmental stages, are still limited. recently, machine learning strategies have been applied to combine some of the wealth of published chip-seq data sets, such as chromatin modification signatures, to predict core promoter regions  <cit> . a logical step in analyzing the pol-ii enriched genomic regions is to scan those regions by existing promoter prediction methods to predict whether the enriched region is a promoter or non-promoter. however, we found that the performance of the existing methods is not satisfactory, and we speculate that the training set used in building the classifier was mostly responsible for their poor performance. we, therefore, build a bench-mark data set of pol-ii enriched promoters and pol-ii enriched non-promoters to train the classifiers, which shows significant improvement over the existing programs. theoretical and empirical works using classification, regression trees, variable selection in linear and non-linear regression have shown that bagging and ensemble based methods can generate substantial prediction gain. in fact, based on the evaluation of 10-fold cross validation and testing on an independent data set, we found that both bagging and random forest methods performed with highest accuracy .

CONCLUSIONS
in conclusion, we have developed a novel algorithm based on bagging and random forest based classification methods to predict pol-ii bound promoters from chip-seq profiles. the present algorithm will help the discovery of novel promoters and ongoing annotation of alternative promoters of human and mouse genes from different chip-seq experiments.

supplementary material
supplementary material is available at http://bioinfo.wistar.upenn.edu/promoterprediction/.

competing interests
the authors declare that they have no competing interests.

authors' contributions
rg designed the computational methods and performed the statistical analyses. pw performed some computational analysis, ab and fp performed database design and updates to mpromdb website. sp performed the biological experiments. rd formulated and directed the design of the study. all authors read and approved the final manuscript.

