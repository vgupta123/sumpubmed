BACKGROUND
the evolutionary information embedded in the sequences of extant biological macromolecules can be used to reconstruct their evolutionary history . methods based on the maximum likelihood  principle are quite successful in reconstructing the past of molecules and species  <cit> , but they rely on models of the evolutionary process at the molecular level. ml computations are usually carried out assuming that the sites of a protein evolve independently, a feature that is rather unrealistic, since selection for thermodynamic stability of the native state acts on all sites at the same time, introducing correlations between sites  <cit> .

incorporating selection for thermodynamic stability in a ml framework has been recently the focus of very interesting studies  <cit> . however, for large data sets ml computations become unfeasible without the assumption of independent sites. it has been also shown that modeling site-specific residue frequencies significantly improves methods for evolutionary reconstructions  <cit> .

the simplest models of molecular evolution are based only on the mutation process and do not attempt to evaluate its effect on fitness. kimura's neutral model  <cit>  uses a binary fitness function to represent purifying selection. protein sequences are considered either unviable or equivalent . in this model a fraction x of the mutations gives rise to neutral mutants and the remaining fraction  <dig> - x is eliminated by purifying selection.

in this paper, we use a binary fitness function based on the evaluation of the thermodynamic stability of the native state, in the same spirit of models first introduced in the context of rna evolution  <cit>  and subsequently extended to protein evolution  <cit> . the model that we study is a neutral evolution model with explicit stability requirements, the structurally constrained neutral  model of protein evolution  <cit> . we study the model in the limit in which the product of the population size m times the mutation rate μ is small, which means that the population is very narrowly distributed in genotype space. this limit is appropriate for animal populations. in the regime of frequent mutation, the evolutionary dynamics is different from the rare mutation regime considered here in that there is a trend towards increased mutational robustness for increasing mμ  <cit> .

stability requirements induce correlations between the sites of the macromolecule, as the free energy is a property of the system as a whole. in the present paper, we present an evolutionary model in which the sites evolve independently of each other and, in addition, are subject to structural stability. we show that the selection rules can be chosen in such a way to reproduce the evolutionary process simulated through the scn model of protein evolution, in which the stability is explicitly evaluated. in order to eliminate the correlations induced by stability requirements there is, however, a price to pay: in the mean-field model, the effective selection depends on the mutation process. as a result, sites evolve independently but selection and mutation become interrelated, whereas in real evolution sites evolve in a correlated fashion and mutation and selection are independent processes.

we simulated the scn model with different mutation schemes. the results of these simulations agree very well with the mean-field model, and show that both mutation and selection have influence on protein folding thermodynamics.

furthermore, we applied the effective evolutionary model to a non-redundant set of globular protein structures contained in the protein data bank , using several mutation schemes of increasing complexity. the mutation scheme that best reproduces the observed amino acid distributions at all sites is one that takes into account the increase of the mutation rate at cpg dinucleotides. the site-specific amino acid distributions obtained through this model reproduce quite well observed amino acid distributions.

the scn model
the scn model evaluates the "fitness" associated with a protein sequence through a model of protein folding based on an effective free energy function  in methods). we adopt two measures of protein folding stability:  with respect to the unfolded state , estimated through the effective native energy, and  with respect to misfolded states , estimated through the normalized energy gap . we use a binary fitness function that assigns fitness one if both stabilities are above predefined thresholds and zero otherwise. thus our model is neutral, since there is no fitness difference between viable proteins.

the free energy calculations introduce correlations between the sites of the protein. as a result of these dependencies, the fraction of neutral mutations x is no longer constant, as in kimura's model, but fluctuates broadly from one sequence to another. this implies that the distribution of the number of substitutions is broader than the poissonian distribution arising from the standard neutral model by kimura, i.e. the process of protein evolution is overdispersed  <cit> , in better agreement with empirical observations  <cit> .

RESULTS
optimal sequence for a protein structure
we evaluate the stability of folded states through the contact free energy function

e=∑ijciju,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrcqggoaakieqacqwfdbwqcqggsaalcqwfbbqqcqggpaqkcqgh9aqpdaaeqbqaaiabdoeadnaabaaaleaacqwgpbqacqwgqbgaaeqaaogaemyvaulaeiikagiaemyqae0aasbaasqaaiabdmgapbqabagccqggsaalcqwgbbqqdawgaawcbagaemoaaogabeaakiabcmcapiabcycasiaaxmaacawljagaeiikagiaegymaejaeiykakcaleaacqwgpbqacqwgqbgaaeqaniabgghildaaaa@4a10@

where c represents the binary contact matrix derived from the protein structure, a represents the protein sequence and u is the effective contact interaction strength between amino acids a and b, belonging to the set of twenty standard amino acids. this model of protein stability, despite its simplicity, captures several relevant features of protein folding, in particular those related with hydrophobicity. in particular, it allows to estimate the stability against unfolding and misfolding for sequence-structure pairs, in such a way that the native structure is more stable than all alternative structures for almost all protein chains in the pdb  <cit> . difference in stability between homologous proteins can be related to evolutionary and ecological variables  <cit> , and estimates of unfolding free energy are correlated with experimental measures .

a further approximation of this model allows to design analytically the optimally stable sequence for a given fold. this approximation consists in truncating the spectral decomposition of the contact interaction matrix at the first spectral component, namely u ≈ -hh, where h indicates the component of the main eigenvector of u corresponding to amino acid a, which we call the interactivity of amino acid a. it is well known that the main eigenvector of contact interaction matrices is related to hydrophobicity  <cit> . consistently, the interactivity scale is strongly correlated with empirical hydropathy scales as for instance the octanol scale derived by fauchere and pliska  <cit> .

we define the hydrophobicity profile  of a protein sequence associating at each site the interactivity value h corresponding to its amino acid. using only the first spectral component, the interaction matrix can be reconstructed to good accuracy  and -hh is r =  <dig> ). under this approximation, the energy can be written as a quadratic form of the hydrophobicity profile

e≈−∑ijcijhh.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrcqggoaakieqacqwfdbwqcqwfsaalcqwfbbqqcqwfpaqkcqghijyucqghsisldaaeqbqaaiabdoeadnaabaaaleaacqwgpbqacqwgqbgaaeqaaogaemiaaggaleaaiewacqgfpbqacqgfqbgaaeqaniabgghildgccqggoaakcqwgbbqqdawgaawcbagaemyaakgabeaakiabcmcapiabdigaojabcicaoiabdgeabnaabaaaleaacqwgqbgaaeqaaogaeiykakiaeiola4iaaczcaiaaxmaacqggoaakcqaiyagmcqggpaqkaaa@4e05@

in the following, we will use the complete contact interaction matrix u, eq. , for simulations of the scn model, and the hydrophobic energy eq.  for analytic computations. we further neglect the discretization of the hp into twenty values and consider the hi as real valued independent variables. this setting allows to solve analytically the sequence design problem of determining the optimally stable sequence for a target structure. the hp with minimal energy for a given contact matrix c and for fixed mean square <dig> ∑ihi2/n≡〈h2〉
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeqaqaaiabdigaonaadaaaleaacqwgpbqaaeaacqaiyagmaagccqggvawlcqwgobgtcqghhjiucqghpms4cqwgobaadaahaawcbeqaaiabikdayaaakiabgqyixdwcbagaemyaakgabeqdcqghris5aaaa@3da0@ is parallel to the principal eigenvector  of the contact matrix, whose components are denoted here by ci, i.e. hiopt=n〈h2〉ci
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamxvp5wqsxmqhnxajn0bkvguhdwzzbqegyvzyrwyufgarqqtubsr4rnchbgeagqia8vkikvafgielifelkfelk=iy=hhbbf9v8qqaqfr0xc9pk0xbba9q8wqffeay=bilkvclq=jhqvepeea0=as0db9vqpepesp0xe9fve9fve9gapdbaqaaegacagaaiaabeqaamqadiabaagcbagaemiaag2aa0baasqaaiabdmgapbqaagwaaiaa=9gacawfwbgaa8hdaaaakiabg2da9maakaaabagaemota4kaeyykjeuaemiaag2aawbaasqabeaacqaiyagmaagccqghqms8cqwgjbwydawgaawcbagaemyaakgabeaaaeqaaaaa@4dcd@.

however, selection in the scn model is applied not only to the native energy, which estimates stability with respect to unfolding, but also to the stability against misfolded compact structures. the relevance of molecular diseases related to misfolding and aggregation  <cit> , the importance for cell physiology and evolution of molecular chaperones preventing misfolding  <cit> , and comparative analysis of thermodynamic properties of homologous proteins  <cit>  all indicate that selection for stability against misfolding is an important selective force. in our model, this is achieved imposing a minimal allowed value for the normalized energy gap .

therefore, we set out to minimize the native energy with a large value of the normalized energy gap. the computation is reported in the methods section. the implicit analytic solution, eq. , receives its main contribution from the pe. this contribution is overwhelming in case of structures without internal modularity. therefore, we further approximate the optimal hp as the sum of the pe profile plus a term which is constant at all sites. this is equivalent to stating that the correlation coefficient between pe and hp is one, and yields

hiopt≈〈h2〉−〈h2〉+〈h〉.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobaadaqhaawcbagaemyaakgabawexlmbbxgbcf2cpn2qvrwzqf2zlnharyqqylwysbaceagaa83baiaa=bhacawf0baaaogaeyisis7aaoaaaeaadawcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjevaeyoei0iaeyykjeuaemiaag2aawbaasqabeaacqaiyagmaagccqghqms8aeaadaqadaqaaiabgmyihlabdogajnaacaaaleqabagaegomaidaaogaeyokjevaeyoei0iaeyykjeuaem4yammaeyokje=aawbaasqabeaacqaiyagmaaaakiaawicacaglpaaaaaaaleqaaogaeiikagiaem4yam2aasbaasqaaiabdmgapbqabagccqghsislcqghpms4cqwgjbwycqghqms8cqggpaqkcqghrawkcqghpms4cqwgobaacqghqms8cqgguaglcawljagaaczcaiabcicaoiabiodaziabcmcapaaa@6e46@

before ending the section, we list the approximations involved in the above equation and its limits of validity. for comparison with simulation results, see fig.  <dig> below.

 <dig>  we neglected the lower eigenvectors in the spectral expansion of the contact interaction matrix u. simulations of the scn model with equiprobable mutations show that this approximation is rather good, since one can get correlation coefficients larger than  <dig>  between the simulated optimal hp and the pe of single-domain proteins, which would not be the case if the other components of the contact interaction matrix would pose significant constraints.

 <dig>  we neglected the discretization of the hydrophobicities in twenty values corresponding to the amino acids. this approximation is usually good for values of <h> and <h2> as observed in real proteins, which are much larger than the minimum and much smaller than the maximum of the twenty hydrophobicity values, but it is violated for extreme mutation bias.

 <dig>  we used the rem approximation for the normalized energy gap  <cit> , which has been calculated through threading in the simulations. this is not a problem, since there is very good correlation between the rem estimate and the threading result at fixed sequence length. moreover, since the threading calculation overestimates the normalized energy gap for long proteins, the rem approximation may even yield a more appropriate estimate  <cit> .

 <dig>  we assumed that the lower eigenvectors contribute negligibly to the optimal hydrophobicity. this approximation is violated for multi-domain proteins, where other eigenvectors have non-negligible contributions. for single-domain proteins the corrections are usually small in the cases that we simulated.

evolutionary average of the hydrophobicity profile
in the scn model, following kimura's neutral model, all sequences having stability properties above some predetermined threshold are selectively equivalent. therefore, the optimal sequence is very unlikely to be realized during evolution. however, all viable sequences must be sufficiently stable, which implies that they must have large correlation coefficient with the optimal hp. thus, in scn simulations protein sequences are expected to move around the optimal sequence, so that the evolutionary average of the hp almost coincides with the optimal hp  <cit> . this condition can be written formally as

evol≡∑{a}πih=hiopt.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqggbbwwcqwgobaacqggoaakcqwgbbqqdawgaawcbagaemyaakgabeaakiabcmcapiabc2fadnaabaaaleaaieaacqwflbqzcqwf2bgdcqwfvbwbcqwfsbabaeqaaogaeyyyio7aaabuaeaaiigacqgfapacdawgaawcbagaemyaakgabeaakiabcicaoiabdggahjabcmcapiabdigaojabcicaoiabdggahjabcmcapiabg2da9iabdigaonaadaaaleaacqwgpbqaaeaacqwfvbwbcqwfwbaccqwf0badaagccqgguaglasqaaiabcuha7jabdggahjabc2ha9bqab0gaeyyeiuoakiaaxmaacawljagaeiikagiaeginaqjaeiykakcaaa@5a70@

the evolutionary average of the hp is indicated as evol and it is expressed as a sum over all amino acids {a} of the site specific amino acid distribution at site i resulting from the evolutionary process, πi. the average sequence so defined is closely related to the prototype sequence defined by bornberg-bauer  <cit> , which is maximally stable both thermodynamically and against mutations.

combining eq.  and , we obtain an analytic prediction of the average value of the site-specific amino acid distributions,

∑{a}πih=〈h2〉−〈h2〉+〈h〉.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeqbqaaggaciab=b8awnaabaaaleaacqwgpbqaaeqaaogaeiikagiaemyyaemaeiykakiaemiaagmaeiikagiaemyyaemaeiykakiaeyypa0zaaoaaaeaadawcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjevaeyoei0iaeyykjeuaemiaag2aawbaasqabeaacqaiyagmaagccqghqms8aeaadaqadaqaaiabgmyihlabdogajnaacaaaleqabagaegomaidaaogaeyokjevaeyoei0iaeyykjeuaem4yammaeyokje=aawbaasqabeaacqaiyagmaaaakiaawicacaglpaaaaaaaleqaaogaeiikagiaem4yam2aasbaasqaaiabdmgapbqabagccqghsislcqghpms4cqwgjbwycqghqms8cqggpaqkcqghrawkcqghpms4cqwgobaacqghqms8cqgguaglcawljagaaczcaiabcicaoiabiwda1iabcmcapawcbagaei4easnaemyyaemaeiyfa0habeqdcqghris5aaaa@6f41@

the quantities <h> and <h2> are the only parameters that we need in order to compute the average hp at all sites of the protein as a function of the pe. in the following, these parameters will be measured in the simulations.

if the correlation coefficient between the pe and the average hp would be one, then the prediction eq.  would be exact. we verified that the correlation coefficient is large  and the analytic prediction yields a good fit of the average hp. the slope of the linear relationship between average hp and pe has a typical relative root mean square error of 9% with respect to the predicted value. the intercept has a typical relative error of 34%, but the mean absolute error is very small,  <dig> , which is less than 5% of the mean hp. in the following, we further discuss the quality of the prediction reporting the correlation coefficient, which gives a strong indication of the relative error.

we plot in fig.  <dig> the correlation coefficient between the average hp and the pe for scn simulations with various mutation models characterized by different bias towards the nucleotides c+g, for lysozyme , phosphocarrier protein hpr  and myoglobin , which are three single-domain proteins, and atp synthase ε subunit , which, despite its small size of  <dig> residues, has two domains, a small beta barrel and a two-helix bundle.

except for extreme mutational bias the correlation coefficient between average hp and pe is always larger than  <dig> . lysozyme and hpr have a similar behavior, characterized by high correlation coefficient between the average hp and the pe. the decrease of the correlation at extreme mutation bias is mainly due to the finite values of the minimal and maximal hydrophobicity. the same effect is present for myoglobin and atpe, but for these proteins the correlation is lower because the contribution of other eigenvectors to the optimal hp is not negligible. nevertheless, the correlation r is close to one for all four proteins for almost all the mutation models that we simulated. we found that a good predictor of the relevance of other eigenvectors is the quantity η <dig> defined in eq. . this quantity is small  for the first two proteins and larger  for the other two and correlates strongly  with r at zero gc bias  <dig>  since simulations of atpe represents the worst case for our analytic theory, we will focus on them as an example in the rest of the paper.

effective selection model based on the principal eigenvector of the contact matrix
our aim here is to exploit the results on the average hp in order to define an effective selection model that reproduces the scn results based on explicit protein thermodynamics.

let us first consider a mutation model where mutations from any amino acid to any other one are equiprobable. this is the mutation model that we simulated in our previous studies  <cit> . in this case, we assume that eq.  is the only condition acting on the stationary amino acid distributions πi. this assumption is translated into the requirement that each πi is the distribution of maximum entropy with mean values given by eq. . as it is well known, this is an exponential, or boltzmann, distribution of the form  <cit> 

πi ∝ exp ,     

the site-specific boltzmann parameters βi can be computed analytically imposing that the average values ∑aπih
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeqaqaaggaciab=b8awnaabaaaleaaiegacqgfpbqaaeqaaogaeiikagiaemyyaemaeiykakiaemiaagmaeiikagiaemyyaemaeiykakcaleaacqwghbqyaeqaniabgghildaaaa@3a88@ are given by eq. , which depends only on the pe components ci and on the two parameters <h> and <h2>.

details on the calculation of βi are given in the methods section. βi takes both positive and negative values. through the theorem of the implicit function it is easy to see that βi is a decreasing function of ci. this has a very simple interpretation: positions with large ci are buried in the core of the protein, so they tend to have larger mean hydrophobicity, eq. , and with higher probability they are occupied by hydrophobic amino acids, thus having more negative βi. positions with small ci are exposed, tend to be hydrophilic, and have large and positive βi. this result is not surprising qualitatively, but it is remarkable that it allows to compute quantitatively the probability to observe a hydrophobic amino acid as a function of a structural indicator, the component ci of the principal eigenvector of the contact matrix, and on the two parameters <h> and <h2>.

modelling amino acid distributions using boltzmann distributions of physico-chemical properties had been previously proposed by goldstein and coworkers  <cit>  and by shaknovich and coworkers  <cit> . our approach differs from previous ones in the sense that we compute the boltzmann parameter explicitly as a function of a structural indicator, the principal eigenvector of the contact matrix.

several structural properties of proteins are found to follow boltzmann distributions as well, i.e. the frequency of a structural motif is exponentially depending on its energy. for a review and a theoretical explanation based on the random energy model, see  <cit> .

the above result allows us to define a stochastic evolution process with independent sites that reproduces the site-specific distributions obtained through the scn model where sites are interacting. the simplest site-specific transition matrices having eq.  as its equilibrium distribution and satisfying detailed balance have the form

psel
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbaacbagae83camnae8xzaumae8hbawgabagae8hkagccbigae4xaakmae8xkakcaaaaa@352f@ = min { <dig>  exp]}.     

it is possible to extend this selection model to take into account functional conservation, which is not considered in this paper.

mean-field model with selection and mutation
the condition on the site-specific average hydrophobicity, eq. , is independent of the mutation model in our analytic approximation. simulations show a weak dependence on the mutation parameters, see fig.  <dig>  for strong mutation bias, at very low gc, this dependence is a consequence of the fact that the average hydrophobicity approaches its maximum value. for intermediate bias, this dependence can be rationalized noting that the relevance of other eigenvectors depends on the parameter  <dig> - <h>/, which varies with the mutation bias. in any case, eq.  is a good approximation to scn simulations, except for extreme mutation bias.

the stochastic selection process described by eq.  imposes that the average hydrophobicity follows eq. . this effective selection process reproduces the site-specific amino acid distributions obtained through simulations of the scn model with equiprobable mutation. here we simulate the scn model with a more realistic mutation process that takes into account the genetic code and represent mutations nucleotide level. the stochastic process that corresponds to this modified scn model is the combination of two processes  <cit> :  a mutation process identical to the one simulated in the scn model;  the selection process described by eq. , which imposes that the site-specific average hp is perfectly correlated with the pe.

for implementing the nucleotide mutation model, we define the state of each site i as a codon n = {n1n2n3}. the substitution process is then decomposed into mutation and selection processes according to

p≡pμcodpsel,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaafaqabeqacaaabagaemiuaa1aawbaasqabeaacqggoaakcqwgpbqacqggpaqkaagccqggoaakieqacqwfubgbcqggsaalcuwfubgbgaqbaiabcmcapiabggmi6kabdcfaqnaadaaaleaaiigacqgf8oqbaeaacqqgdbwqcqqgpbwtcqqgebaraagccqggoaakcqwfubgbcqggsaalcuwfubgbgaqbaiabcmcapiabdcfaqnaadaaaleaacqqgzbwccqqglbqzcqqgsbabaeaacqggoaakcqwgpbqacqggpaqkaagccqggoaakimaacqqfaefqcqggbbwwcqwfubgbcqggdbqxcqggsaalcqqfaefqcqggbbwwcuwfubgbgaqbaiabc2fadjabcmcapaqaaiabcicaoiab=5gaujabgcmi5kqb=5gauzaafagaeiykakiaeiilawiaaczcaiaaxmaadaqadaqaaiabiida4agaayjkaiaawmcaaaaaaaa@6f1a@

where pμcod
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbaaccigae8hvd0gabaacbagae43qamkae43ta8kae4hraqeaaaaa@3300@ is the codon mutation matrix arising from the mutation process at the nucleotide level , the selection process is represented in eq. , and a
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@ represents the amino acid coded by the codon n. the diagonal elements are defined through the normalization condition

p=1−∑n′≠npμcodpsel.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnamxvp5wqsxmqhnxajn0bkvguhdwzzbqehyvzyrwyufgarqqtubsr4rnchbgeagqia8vkikvafgielifelkfelk=iy=hhbbf9v8qqaqfr0xc9pk0xbba9q8wqffeay=bilkvclq=jhqvepeea0=as0db9vqpepesp0xe9fve9fve9gapdbaqaaegacagaaiaabeqaamaaeiqbaagcbagaemiuaa1aawbaasqabeaacqggoaakcqwgpbqacqggpaqkaagccqggoaakiqqacawfubgaeiilawiaa8nbaiabcmcapiabg2da9iabigdaxiabgkhitmaaqafabagaemiuaa1aa0baasqaaggaciab+x7atbqaaiabboeadjabb+eapjabbseaebaaaeaacewfubgbauaacqghgjsucawfubaabeqdcqghris5aogaeiikagiaa8nbaiabcycasiqa=5gagaqbaiabcmcapiabdcfaqnaadaaaleaacqqgzbwccqqglbqzcqqgsbabaeaacqggoaakcqwgpbqacqggpaqkaagccqggoaakimaacqqfaefqcqggbbwwcawfubgaeiyxa0laeiilawiae0haxhkaei4waslab8nbayaafagaeiyxa0laeiykakiaeiola4iaaczcaiaaxmaadaqadaqaaiabimda5agaayjkaiaawmcaaaaa@7d39@

we first assume that the mutation process at the dna level satisfies detailed balance, also called reversibility in the molecular evolution literature. this means that the stationary nucleotide frequencies f satisfy the equation fpμnuc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbaaccigae8hvd0gabaacbagae4nba4mae4xdaunae43yamgaaaaa@33e0@ = fpμnuc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbaaccigae8hvd0gabaacbagae4nba4mae4xdaunae43yamgaaaaa@33e0@, where pμnuc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbaaccigae8hvd0gabaacbagae4nba4mae4xdaunae43yamgaaaaa@33e0@ is the mutation matrix at the nucleotide level.

under this hypothesis, the stationary distribution for the full substitution process can be decomposed as the product of the amino acid frequency waa expected from the mutation process without selection, which is the same for all sites, times the site-specific distributions due to the selection process, eq. ,

πi ∝ waa exp,     

waa=∑nδwcod.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaacqwg3bwddawgaawcbagaeeyqaekaeeyqaeeabeaakiabcicaoiabdggahjabcmcapiabg2da9maaqafabaaccigae8htdqmaeiikagiaemyyaemaeiilawccdagae4haxhkaei4wasfcbegae0nba4maeiyxa0laeiykakiaem4dac3aasbaasqaaiabboeadjabb+eapjabbseaebqabagccqggoaakcqqfubgbcqggpaqkasqaaiab95gaubqab0gaeyyeiuoakiabc6cauiaaxmaacawljawaaewaaeaacqaixaqmcqaixaqmaiaawicacaglpaaaaaa@5a70@

the factor waa is obtained as the sum of the expected frequencies of its codons under mutation alone, wcod = f f f, with n <dig>  n <dig>  n <dig> the three nucleotides composing the codon n, and f is the stationary frequency of nucleotide n under mutation alone. it is easy to see that the distribution eq.  satisfies detailed balance with respect to the full substitution process, eq. .

eq.  is a special case of eq. , with a constant mutation factor waa ≡  <dig> for all amino acids, consistently with the assumption that all mutations are equiprobable. combining eq.  with eq. , we obtain

∑{a}hwaaexp⁡∑{a}waaexp⁡=〈h2〉−〈h〉2/〈c〉2+〈h〉.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaamaaqababagaemiaagmaeiikagiaemyyaemaeiykakiaem4dac3aasbaasqaagqaaiab=feabjab=feabbqabagccqggoaakcqwghbqycqggpaqkcygglbqzcqgg4baecqggwbaccqggbbwwcqghsisliigacqgfyogydawgaawcbagaemyaakgabeaakiabdigaojabcicaoiabdggahjabcmcapiabc2fadbwcbagaei4easnaemyyaemaeiyfa0habeqdcqghris5aagcbawaaabeaeaacqwg3bwddawgaawcbagae8xqaekae8xqaeeabeaakiabcicaoiabdggahjabcmcapigbcwgaljabciha4jabcchawjabcufabjabgkhitiab+j7ainaabaaaleaacqwgpbqaaeqaaogaemiaagmaeiikagiaemyyaemaeiykakcaleaacqgg7bwecqwghbqycqgg9bqfaeqaniabgghildgccqggdbqxaagaeyypa0zaaoaaaeaadawcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjevaeyoei0iaeyykjeuaemiaagmaeyokje=aawbaasqabeaacqaiyagmaaaakeaadaqadaqaaiabgmyihlabdogajnaacaaaleqabagaegomaidaaogaeyokjevaeyoei0iaeyykjeuaem4yammaeyokje=aawbaasqabeaacqaiyagmaaaakiaawicacaglpaaacqggvawlcqghpms4cqwgjbwycqghqms8daahaawcbeqaaiabikdayaaaaaaabeaakmaabmaabawaasaaaeaacqwgjbwydawgaawcbagaemyaakgabeaaaoqaaiabgmyihlabdogajjabgqyixdaacqghsislcqaixaqmaiaawicacaglpaaacqghrawkcqghpms4cqwgobaacqghqms8cqgguaglcawljagaaczcaiabcicaoiabigdaxiabikdayiabcmcapaaa@a359@

this equation is the central result of this work. it allows to compute the boltzmann exponents βi, and from them the site-specific amino acid distributions as a function of the normalized pe of a protein structure, ci/<c>, which depend little on the protein length, of two hydrophobicity parameters, <h> and <h2>, and of the stationary frequencies waa of the mutation model, which must fulfill detailed balance. from this equation one sees that the boltzmann exponents βi, which define the selection process, depend on the mutation factors waa. this contrasts with the fact that in the scn model mutation and selection are two independent processes. the entanglement between selection and mutation is a consequence of the mean-field approach: we reduce an evolutionary process where sites are interrelated to a process where sites evolve independently, but under the global constraint given by eq. . because of this global constraint, the evolutionary process becomes dependent on the average properties of the amino acid chain, which in turn depend on the mutation process. hence, at the mean-field level, mutation and selection become interrelated.

scn model with genetic code
to test the mean-field model, the scn model was simulated using several mutation schemes. in a first set of simulations, we used mutation matrices that fulfil detailed balance and depend on the stationary frequencies f, n ∈ {a, t, c, g}, and on the transition-transversion ratio k . we further imposed the conditions f = f and f = f, called type  <dig> parity rule  <cit> , so that there are only two parameters in the mutation matrix.

fig.  <dig> shows the site-specific amino acid distributions obtained through scn simulations for the protein atpe , divided by the frequencies expected under mutation alone, waa. the distributions plotted in fig.  <dig> and  <dig> refer to a site with small pe component, ci/<c> =  <dig> , favoring amino acids with low hydrophobicity. we show data for two different mutational biases, one favoring gc-rich codons  + f =  <dig> ), which tend to be more hydrophylic, and one favoring gc-poor codons  + f =  <dig> ), which tend to be more hydrophobic. the exponent βi changes with the mutational bias: for large gc bias the codons coding for hydrophilic amino acids are favored at the mutation level, and the βi is almost zero, meaning that almost no purifying selection is needed at this site. the contrary holds when the mutation bias favors gc-poor codons: in this case βi is large, and the site experiences strong purifying selection.

the opposite situation is observed in fig.  <dig> and  <dig>  obtained for a site with ci/<c> =  <dig> . in this case amino acids with high hydrophobicity are preferred, and βi is almost zero when the mutational bias favors gc-poor codons, whereas it is negative and large when gc-rich codons are favored at the mutational level. in both cases, the mean-field model  fits very well the results of the scn simulations . the average over all sites of the correlation coefficients between predicted and observed amino acid distributions, for all mutational biases simulated, lies in the range <r> =  <dig>  and <r> =  <dig>  and increases as a function of the number of sequences examined .

in all cases studied, the stationary amino acid distributions only depended on the stationary nucleotide frequencies f and did not depend on the transition-transversion ratio, in agreement with eq. . we also simulated a mutation process that does not fulfil detailed balance. in this case, eq.  does not represent the stationary amino acid distribution of the process, which must be explicitly computed from the full transition matrix. also in this case, eq. , calculated with the stationary frequencies f of the pure mutation process, is a very good approximation of the stationary distribution for high gc bias, but not for low gc, because of the large frequency of stop codons, which are strongly negatively selected .

as a result of the change of the selection parameters βi with the mutation bias, the probability that a mutation is accepted depends on the mutation bias. this probability is also influenced by the transition-tranversion ratio k. the probability that a mutation is accepted, obtained from scn simulations, and analytically computed from the effective stochastic process eq.  , is plotted in fig.  <dig>  the analytical calculation is in very good agreement with simulation results. interestingly, the acceptance probability has a maximum as a function of the gc frequency, meaning that there is an optimal mutation bias that maximizes the rate of accepted mutations. this maximum is achieved at f + f >  <dig> , since stop codons, which are the most deleterious mutations, are rich in at. the acceptance probability increases with the transition to transversion ratio k, which favors more conservative mutations.

influence of the mutation bias on protein folding thermodynamics
in the scn model, mutation and selection parameters influence the properties of protein folding thermodynamics arising from simulated evolution.

in both the scn and the mean-field model, the nucleotide content at different codon positions responds differently to the mutation bias. the second position is the most difficult to mutate, whereas the third one is almost completely neutral, with gc <dig> ≈ gcmut, since most transitions at third codon position are synonymous and they are always accepted in the scn model. thymine content at second codon position is least dependent on the mutation bias. almost all codons containing t in the second position code for hydrophobic amino acids, so that the t content at second position is strongly correlated with the hydrophobicity of the coded protein and it is strongly constrained by selection for thermodynamic stability. a mutation bias towards t at the nucleotide level corresponds to a mutation bias towards more hydrophobic amino acids.

also the selection thresholds on the native energy and the normalized energy gap influence the hydrophobicity. in fact, the more hydrophobic a protein is, the more stable it is against unfolding , and the less stable it is against misfolding . stronger selection for a large normalized energy gap has thus the effect to reduce the hydrophobicity, and stronger selection for a low energy has the effect to increase it. the results presented here are obtained varying the mutation bias at constant selection thresholds, so that the differences between different simulations are due to mutation alone. we choose the selection thresholds equal to 98% of the values of the stability parameters in the pdb sequence. in this way, the pdb sequence is always selected, and we get stringent stability criteria that are as uniform as possible between different proteins.

therefore, mutation and selection parameters modify the trade-off between the two kinds of stability and influence the mean and mean square hydrophobicity, <h> and <h2>. these quantities are used as parameters to calculate the site-specific distributions in the mean-field model. unfortunately, we could not predict them analytically as a function of the mutation and selection parameters. the parameters used in the mean-field model were therefore derived from the sequences generated through scn simulations. nevertheless, using parameters <h> and <h2> that do not depend on the mutation bias in eq.  still produces a good agreement between the mean-field and simulation results.

the dependence of hydrophobicity on the mutation bias has a deep influence on protein folding thermodynamics. for all the proteins that we simulated, the mean square hydrophobicity <h2> is a decreasing function of the g+c content , causing the normalized energy gap to increase and the unfolding free energy per residue to decrease for increasing gc. we observed this effect in our scn simulations. the same qualitative influence of the mutation bias on protein folding thermodynamics was inferred through a statistical analysis of the properties of orthologous proteins in different bacterial species evolving with different mutation biases  <cit> . fig.  <dig> shows the mean hydrophobicity <h>, the effective energy per residue -e/n and the normalized energy gap α as a function of the gc content. full symbols and lines are derived from simulations of the scn model and open symbols are derived from the computational study of bacterial proteomes mentioned above  <cit> . both sets of points show a similar trend, but the dispersion of thermodynamic properties is much larger in the bacterial proteomes than in scn simulations.

there is however a qualitative difference between real and simulated data concerning mean hydrophobicity. in real sequences there is a negative correlation between the gc content of the gene and the mean hydrophobicity , as expected from the fact that t in second position codes for hydrophobic residues. in simulated sequences the correlation between gc content and mean hydrophobicity is negative in the whole gc range, but it is positive in the range of biologically observed gc values for two of the proteins simulated, atpe and myoglobin. for the other two proteins, lysozyme and hpr, the correlation is always negative. in contrast, the root mean square hydrophobicity <h2> is a monotonically decreasing function of the gc for all four proteins . interestingly, the proteins showing a positive correlation between gc content and mean hydrophobicity are those for which other eigenvectors besides the pe are relevant. this suggests that the hydrophobicity has a uneven distribution between the different modules that correspond to the relevant eigenvectors, so that, at decreasing gc mutation pressure, the mean hydrophobicity increases in one module and decreases in the other one responding to selection for stability against misfolding. the net effect is the lowering of the mean hydrophobicity while increasing its within sequence variation. it is possible that the resulting positive correlation between gc and hydrophobicity is an artifact of the scn model, but it is also possible that it is a property of modular proteins that was not detected in the study of bacterial proteomes, since in that study data from unimodular and from multi-modular proteins were averaged together. this point deserves therefore further investigation.

it should also be noted that the normalized energy gap α is much smaller in bacterial proteomes corresponding to genomes with low gc content than expected from scn simulations. as discussed in ref.  <cit> , these proteomes with very low gc content belong to obligatory intracellular bacteria, whose effective population size is severely reduced by the bottlenecks that they experience in their intracellular lifestyle. because of their reduced populations, natural selection is expected to be less effective in eliminating deleterious mutations, causing their phenotypic properties, such as the folding stability of their proteins, to be less stable than for large free living populations  <cit> .

fig.  <dig> also suggests that natural selection acts on different protein properties for different mutation bias. when the mutation bias favors gc, the normalized energy gap tend to be higher than the threshold and the unfolding free energy tend to be small. in this case, most of the mutations that are selected against are eliminated because they yield proteins too unstable against unfolding. on the contrary, when the mutation pressure favors at, most of the mutations that are eliminated yield proteins that are unstable against misfolding.

last, we note that, despite simulated and observed properties have a qualitatively similar response to the mutation bias, from a quantitative point of view simulated quantities depend much more strongly on the mutation parameters. in particular, the gc content at first and second codon position, which influences the nature of the coded amino acids, depends on the mutation bias much more strongly in simulated genes than in real genes .

site-specific amino acid distributions in the pdb
the predicted optimal hydrophobicity vector depends on the two parameters <h> and <h2>, in particular through the ratio <h>/〈h2〉
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjepaleqaaaaa@32cc@, in such a way that the optimal hp is almost parallel to the pe when <h>/〈h2〉
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjepaleqaaaaa@32cc@ is almost equal to n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabd6eaobwcbeaaaaa@2dec@<c> . before applying our model to real proteins, we measured these quantities in a non-redundant subset of the protein data bank   <cit> , containing both single-domain and multi-domain proteins, filtered to select only globular proteins.

protein sequences in this set have <h> and <h2> contained in a narrow range, with standard deviation equal to 1/ <dig> of the average value or smaller. correspondingly, τ = <h>/〈h2〉
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjepaleqaaaaa@32cc@ lies in a narrow range between  <dig>  and  <dig>  , and τ/n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabd6eaobwcbeaaaaa@2dec@<c> lies in a range between  <dig>  and  <dig>  . the largest values belong to multi-domain proteins, whose n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabd6eaobwcbeaaaaa@2dec@<c> is much smaller than for single-domain proteins. the values of τ/w1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabdeha3naabaaaleaacqaixaqmaeqaaaqabaaaaa@2f4f@ are close to one, thus supporting our approximation to neglect eigenvectors other than the pe in the computation of the average hp. the distributions are plotted in fig.  <dig>  which also shows the distribution of w1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabdeha3naabaaaleaacqaixaqmaeqaaaqabaaaaa@2f4f@ = n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabd6eaobwcbeaaaaa@2dec@<c>.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabgmyihlabdigaonaacaaaleqabagaegomaidaaogaeyokjepaleqaaaaa@32cc@ and w1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8srps0lbbf9q8wrffeuy=hhbbf9v8qqaqfr0xc9pk0xbba9q8wqffea0=yr0ryxir=jbba9q8aq0=yq=he9q8qqq8frfve9fve9ff0dmeaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqcaawaaiabdefaxpwaasbaakqagfaacqaixaqmaeqaaaqabaaaaa@2f29@ = n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabd6eaobwcbeaaaaa@2dec@<c>. all these quantities are narrowly distributed, with standard deviations of the order of less than 1/ <dig> of the average value.

in the following, we will consider only single-domain globular proteins  and assume that their optimal hp is well approximated by eq. , with the same parameters <h> and <h2> for all proteins. this is justified by the narrow distribution of these quantities. in this way, we are able to predict the average hydrophobicity for structurally equivalent positions, having the same value of ci/<c>, in all structures in the pdb, using only two parameters.

we sampled amino acid distributions at site classes characterized by the same value  of ci/<c>). these observed site-specific distributions were then compared with the distributions arising from the mean-field model with different mutation schemes.

the agreement between predicted and observed distributions was measured through their mean correlation coefficient <r>. the parameters of the mutation models were fitted optimizing this quantity . note that only the mutation parameters were fitted, whereas the selection parameters βi were calculated from the mutation model and the site-specific mean hydrophobicities given by eq. , which only involves the two parameters a and b. these were calculated from the mean and the standard deviation of the hydrophobicity in the whole set of globular proteins, without any fitting procedure.

we performed the computations described here using several hydrophobicity scales, listed in methods. for all mutation models considered, the best fit was always obtained with the ih hydrophobicity scale  <cit> , closely followed by the ch scale  <cit>  and the buriability scale  <cit> . all other scales gave considerably worse results. in the following we refer to the ih scale when not otherwise stated.

we considered the following five mutation and selection schemes:

 no selection , nucleotide mutation matrices satisfying detailed balance with the equilibrium frequencies as free parameters. this scheme is labeled as 'opt. freq. at βi ≡ 0'. because of the normalization condition, there are only three free parameters. the optimal equilibrium frequencies are  <dig> ,  <dig> ,  <dig> , and  <dig>  , and yield <r> =  <dig> .

 selection and uniform mutation probabilities at the amino acid level p  ≡  <dig> without the genetic code being taken into account, i.e. waa ≡  <dig>  this scheme is labeled as 'constant'. for this case we obtained <r> =  <dig>  without any free parameter. it appears therefore that properly considering the selection process in the mean-field model gives better results than taking into account the genetic code but disregarding the amino acid properties , as in scheme .

 independent and identical nucleotide mutation matrices satisfying detailed balance with equal equilibrium frequencies for all nucleotides, with selection from the mean-field model. this scheme is labeled as '#codons', since it holds waa = number of codons. the nucleotide frequencies are  <dig> ,  <dig>   <dig>   <dig> , and  <dig>  . in this case, both the genetic code and the selection process are considered, and we obtained <r> =  <dig> , again without any free parameter.

 independent and identical nucleotide mutation matrices satisfying detailed balance with equilibrium frequencies as free parameters, and selection taken from the mean-field model. this scheme is labeled as 'opt. freq.'. the optimal nucleotide frequencies are  <dig> ,  <dig> ,  <dig> , and  <dig>   and yield <r> =  <dig>  with three free parameters.

 same scheme as above, with an additional free parameter that expresses the enhancement of the mutation rate at cpg dinucleotides. notice that this mutation scheme does not fulfil detailed balance, and mutations at different sites in the dna sequences are not anymore independent. we only considered cpg dinucleotides within the same codon, otherwise the resulting mean-field model would not be anymore independent at different positions along the protein sequence. we label this scheme as 'cpg'. the optimal nucleotide frequencies are  <dig> ,  <dig> ,  <dig> , and  <dig>  , and the enhancement of the mutation rate at cpg is kcpg =  <dig> . these optimal parameters yield <r> =  <dig> .

fig.  <dig> shows one example of observed and predicted site-specific amino acid distributions. for illustration, we chose the class of sites with ci/<c> ∈ . these are sites with small pe component, favoring amino acids with low hydrophobicity. predictions  were derived from the mean-field model with various mutation schemes  and parameters that optimally fit the observed distributions at all site classes. observed distributions sampled from protein sequences in the pdb are shown as full circles.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamxvp5wqsxmqhnxajn0bkvguhdwzzbqegyvzyrwyufgarqqtubsr4rnchbgeagqia8vkikvafgielifelkfelk=iy=hhbbf9v8qqaqfr0xc9pk0xbba9q8wqffeay=bilkvclq=jhqvepeea0=as0db9vqpepesp0xe9fve9fve9gapdbaqaaegacagaaiaabeqaamqadiabaagcbaaccigae8hwda3aasbaasqaaiabdogajnaabaaameaacqwgpbqacqggvawlcqgh8aapcqwgjbwycqgh+agpaeqaaawcbeaaaaa@45fe@, divided by the expected frequencies under mutation alone waa, for  the mutation models  <dig> ,  mutation model  <dig> ,  mutation model  <dig> , and  mutation model  <dig> . for the theoretical models where mutation satisfies detailed balance, πci
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdawgaawcbagaem4yam2aasbaawqaaiabdmgapbqabaaaleqaaaaa@317e@/waa ∝ exp , so that the slope of the plot represents βi at this site class. for illustration, site class with ci/<c> ∈  was selected. full symbols show the observed distributions obtained from sequences in the pdb, whereas the open symbols and the lines display the mean-field model.

in order to make the plot more illustrative, the amino acid frequencies, both predicted and observed, were divided by the frequencies expected under mutation alone, waa, which depend on the mutation model considered. in this way, for the mean-field models with mutation process satisfying detailed balance , the plot represents in logarithmic scale the selection factor z-1exp  . since the horizontal scale represents the amino acid hydrophobicity h, one can directly see from the slope of the plot the boltzmann factor βi and notice that it indeed depends on the mutation model considered. the mutation scheme  <dig>  does not obey detailed balance, therefore the mean-field predictions, log /waa) , do not lay on a straight line as a function of h. nevertheless, eq. , represented as a line in the figure, is still a good approximation for the mean-field amino acid distribution.

in fig.  <dig> we show the observed frequencies πci/〈c〉obs
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdaqhaawcbagaem4yam2aasbaawqaaiabdmgapbqabawccqggvawlcqghpms4cqwgjbwycqghqms8aeaatcvaufebsjuyzl2yd9gzlbvynv2caehbwvmckfmbhbaceagaa43baiaa+jgacagfzbaaaaaa@4486@ versus the probabilities πci/〈c〉pred
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdaqhaawcbagaem4yam2aasbaawqaaiabdmgapbqabawccqggvawlcqghpms4cqwgjbwycqghqms8aeaaieaacqgfwbaccqgfybgccqgflbqzcqgfkbazaaaaaa@3ca6@ predicted through the mean-field model with optimal mutation parameters. all amino acid types and all sites are represented and, as in the previous figure, all frequencies are divided by the expected frequencies under mutation alone waa. the four frames refer to mutation schemes  <dig>   <dig>   <dig> and  <dig>  for model  <dig>  which is not shown, the predicted probabilities coincide with the mutation factors  ≡ waa), so their ratio, represented on the horizontal line, is always one, and all points would lie on a vertical line and would yield no correlation between observed and predicted data. the best fit is obtained for models  <dig> and  <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdaqhaawcbagaem4yam2aasbaawqaaiabdmgapbqabawccqggvawlcqghpms4cqwgjbwycqghqms8aeaatcvaufebsjuyzl2yd9gzlbvynv2caehbwvmckfmbhbaceagaa43baiaa+jgacagfzbaaaaaa@4486@, versus the probabilities πci/〈c〉pred
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdaqhaawcbagaem4yam2aasbaawqaaiabdmgapbqabawccqggvawlcqghpms4cqwgjbwycqghqms8aeaaieaacqgfwbaccqgfybgccqgflbqzcqgfkbazaaaaaa@3ca6@ predicted through the mean-field model with optimal mutation parameters. all amino acids and all sites are shown. observed and predicted frequencies are divided by the frequencies expected under mutation alone waa. the four frames refer to  mutation model  <dig> ,  mutation model  <dig> ,  mutation model  <dig> , and  mutation model  <dig> , respectively.

discussion
approximation used
our analytic theory is based on a model of protein folding thermodynamics where the contact energy is approximated through e ≈ - ∑ij cijhh, and the twenty parameters h can be associated with an effective hydrophobicity. the thermodynamically optimal sequence for this model, for a fixed structure c of a single-domain globular protein, is the sequence whose hp h has correlation coefficient close to one with the pe of the contact matrix c. this result also holds with very good approximation for models with contact interactions, where the contact interaction matrix u is well approximated by its main eigenvector h. this is the case of most contact interaction matrices used in protein folding studies, as for instance the miyazawa and jernigan interaction matrix  <cit> , and it is well known that the main eigenvector represents hydrophobicity  <cit> . for the case of the interaction matrix used in this study  <cit> , the correlation between the matrix elements u and hh is larger than  <dig> , therefore contributions other than hydrophobicity are not completely negligible. however, for single-domain globular proteins and for mutation models that are not extremely biased, the average hydrophobicity profile observed in scn simulations with full contact interaction matrix is practically undistinguishable from the optimal hp predicted on the basis of the reduced matrix hh, which justifies our theory a posteriori. the parameters h are obtained from the main eigenvector of the interaction matrix, therefore they should not be interpreted as hydrophobicity in a strict biochemical sense, since they also take into account other kinds of interactions. for instance, aromatic amino acids have very large h, in part due to the strength of the interactions between aromatic rings. this is perhaps why the hydrophobicity scale that we use performs, for the purpose of predicting site-specific amino acid distributions, better than empirical hydrophobicity scales.

there are other kinds of interactions that can not be well approximated in this simple contact scheme, such as electrostatic interactions or local propensities for secondary structures, although the latter could be easily incorporated in the present scheme, and we are working in this direction. the good agreement between predicted and observed distributions, however, indicates that the energy function used captures a major component of the forces stabilizing protein folding.

using the approximate free energy function, eq. , and a continuous approximation for the hydrophobicity values h, it is possible to determine analytically the sequence with minimal energy subject to the constraint of constant normalized energy gap. the hp of this optimally stable sequence is given by eq. . for single-domain globular proteins, this optimal hp is almost parallel to the main eigenvector of the contact matrix .

it may be useful to recall some properties of the pe, in order to clarify its interpretation. the pe is the vector ci which maximizes the quadratic form q = ∑ijcijcicj for fixed value of the norm ∑ici2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgjbwydaqhaawcbagaemyaakgabagaegomaidaaaaa@3075@. therefore, it can be interpreted as an effective connectivity, since positions i with large ci are in contact with as many as possible positions j with large cj. indeed, ci correlates with the number of contacts formed by site i. nevertheless, ci depends not only on the local contacts, but also on the global structure of the protein chain, for instance its modularity, and it gives a much richer information than the simple number of contacts. it has been shown that a detailed knowledge of the pe is sufficient to reconstruct the full contact matrix  <cit> , whereas different contact matrices may be associated to the same contact vector  <cit> , whose components are the number of contacts at each site.

influence of mutation on evolutionary and thermodynamic properties
it was observed several years ago that the nucleotide content at first and second codon positions, which influences the coded amino acid and the amino acid usage, is strongly correlated with the nucleotide content at third codon position, where transitions  in most cases do not modify the coded amino acid  <cit> . as a consequence, the amino acid usage in proteins of different bacterial species, which may evolve with different mutation bias, is strongly dependent on the mean nucleotide content of the genome, which is thought to reflect essentially the mutation bias. however, this dependence is not as strong as one would predict from a model based on mutation alone  <cit> , equivalent to our model  <dig> discussed in the results section. this deviation from a pure mutation model reflects, at least in part, selection at the amino acid level.

scn simulations of globular proteins, and the corresponding mean-field models, which take into account both mutation and selection, reproduce qualitatively these results. our results show that the amino acid composition, and the gc content at first and second codon position, reflecting selection at the amino acid level, depend on the mutation bias and they are strongly correlated with the gc content at third codon position, but this correlation is weaker than one would expect under a mutation model alone.

scn simulations also reveal the deep influence that the mutation process exerts on protein evolution. selection for the stability of the native state has to fulfil two partially contrasting requirements: stability against unfolding and stability against compact misfolded conformations  <cit> . the mutation bias influences the balance between these two kinds of stabilities. for fixed selection parameters, mutation processes favoring gc rich codons favor protein sequences that are less hydrophobic, and which are predicted to be more stable against misfolded states but less stable against unfolding with respect to mutation processes favoring at rich codons.

this trend of decreasing unfolding stability and increasing misfolding stability versus gc content occurs in scn simulations for all the proteins that we studied, in agreement with a previous statistical analysis of bacterial proteomes  <cit> . however, for two of the proteins that we studied, the mean hydrophobicity was not a monotonous function of the gc content.

the mutation bias also influences very strongly the fraction of mutations that are eliminated by purifying selection. the optimum acceptance rate is observed for a slight bias towards gc. the nucleotide frequencies that optimize the match between the mean-field model and the observed distributions yield a nearly optimal acceptance rate.

however, in the scn model the dependency between amino acid usage and mutation bias is significantly stronger than the one observed in the genes of different bacterial species coding for globular proteins. in particular, the gc content at the first and second codon position depends on the gc content at the third codon position more strongly in the scn model than in bacterial genes. we discuss four possible explanations for this discrepancy, that indicate possible extensions of the model.

first, and most important in our opinion, the selection criterium used in scn simulations is based on a contact free energy function, whose main contribution comes from the hydrophobicity effect and van der waals interactions. selection in protein evolution, on the other hand, also depends on functional constraints, on other stability constraints, as for instance secondary structure, and on constraints arising from protein dynamics. the ability of the mean-field model to reproduce site-specific amino acid distributions in the pdb, where these effects are averaged out, suggests that it captures important features of the selection process, but quite probably other selective forces are relevant as well.

second, in the scn simulations presented here we have considered mutation probabilities where we enforced the symmetry between nucleotides related through watson and crick pairing, f = f and f = f, called type  <dig> parity rule  <cit> . the type  <dig> parity rule holds globally in a double-stranded dna molecule. however, it is well known that the mutation process in the two dna strands is different, leading to asymmetric strand composition called gc-skew  <cit> . therefore, since the distribution of coding sequences in leading and lagging strands may be biased  <cit> , there is no strict reason why this symmetry should hold for protein coding sequences, and in fact we found that the nucleotide contents under mutation alone that optimally fit the observed amino acid distributions do not follow parity rule  <dig>  the results of the scn model, such as for instance the c+g content at different codon positions, depend also on the proportion of c with respect to g and a with respect to t, and not only on the cumulative content of c+g. therefore the results presented here, obtained imposing the type  <dig> parity rule, are only indicative of a qualitative trend and can not be compared quantitatively with bacterial genes coding for globular proteins.

as a third possible discrepancy between scn simulations and biological data, we have calculated stationary amino acid distributions when the substituion process has reached equilibrium. however, in scn simulations even for short proteins equilibrium is attained after a very long transient phase, of the order of  <dig> substitutions. this number of substitutions is far larger than the estimated number of substitutions that took place since the split of the major domains of life  <cit> . in a recent study, jordan et al.  <cit>  have proposed that the substitution process in proteins has not yet attained equilibrium, and that one can still find the fingerprint of ancestral amino acid distributions by looking at the present day evolutionary process. last, we recall that the scn simulations reported here have been performed in the rare mutation regime where the product of population size times mutation rate is mμ ≪  <dig>  in this regime, the population is genetically homogeneous. if this hypothesis does not hold, one observes a trend towards increased mutational robustness for increasing mμ  <cit> . however, this "selection" for robustness, without any explicit selective force, is expected to result in an increased correlation between the hp of selected sequences and the optimal hp. in fact, it has been observed by bornberg-bauer in simulations of neutral protein evolution that one can identify a prototype sequence that is maximally stable both thermodynamically and mutationally  <cit> . in our model, the prototype sequence coincides with the sequence with the optimal hp, which is strongly correlated with the pe. consistently, the mutational robustness increases as the hp of the sequence gets closer to the optimal hp, predicted through the pe, as we have verified in previous simulations  <cit> . therefore, we do not expect that selection for mutational robustness modifies qualitatively the results presented here, as far as equilibrium properties are concerned.

amino acid distributions in the pdb
the mean-field model developed in this paper gives a satisfactory fit of the site-specific amino acid distributions observed in single-domain globular proteins. in applying the model to a representative subset of the pdb, we assumed that:  its selection parameters, <h> and <h2>, are roughly the same for all proteins. this hypothesis is reasonable, since both quantity are narrowly distributed, with standard deviations smaller than 1/ <dig> of the average value.  the mutation process is the same for all the genes from which pdb proteins are derived. this hypothesis is clearly not valid, since mutation patterns depend on the organism considered and, within the same organism, they depend on the dna strand and on the distance from the origin of replication in bacterial genomes  <cit> , and they are thought to vary broadly within the large eukaryotic genomes.

nevertheless, the fact that our model fits well the observed distributions may suggest the existence of a general mutational pattern valid for different organisms. freeman and coworkers  <cit>  found a strong correlation between excess of coding sequences and excess of purine basis  in bacterial and, later, eukaryotic genomes. this pattern agrees quite well with the frequencies that optimal fit our models to the observed distributions, which are f =  <dig> , f =  <dig> , f =  <dig> , f =  <dig>  if the nucleotide frequencies are the only free parameters and detailed balance is assumed, and f =  <dig> , f =  <dig> , f =  <dig> , f =  <dig>  if the mutation rate is enhanced at cpg dinucleotides. in both cases, we find that the frequency of a is larger than that of t and the frequency of g is larger than that of c, i.e. the fitted parameters suggest that there is purine excess in protein coding genes.

however, for some bacterial genomes the coding excess is better correlated with the excess of g+t  than with the purine excess. this is consistent with the fact that in bacterial chromosomes there are two types of mutational patterns:  predominance of g over c  and of a over t  in the leading strand, the opposite in the lagging strand, implying purine excess in coding sequences that are overrepresented in the leading strand;  predominance of g over c  and of t over a  in the leading strand, the opposite in the lagging strand, implying keto excess in coding sequences  <cit> . in agreement with our scn simulations, these mutational bias strongly influence the amino acid frequencies for proteins coded in the two strands  <cit> . the protein sequences that we studied in this work were derived from the pdb, where nucleotide sequences are not stored. we did not find any study of nucleotide frequencies in genes coding for proteins in the pdb. therefore, we could not compare our fitted parameters to nucleotide frequencies in the genes coding for the proteins in the pdb. it would be interesting to know whether the purine excess that our study suggests is observed in these genes.

CONCLUSIONS
we have shown that an evolutionary model with independently evolving sites is able to reproduce in a quantitative way the results of simulations where conservation of the thermodynamic stability of a protein native state is explicitly enforced, and therefore sites evolve in a correlated way. this mean-field model with independent sites is also able to reproduce site-specific amino acid distributions at sites with specific values of the principal eigenvector of the contact matrix, in good agreement with the distributions observed in the whole pdb. as site-independent evolutionary models are readily amenable to computation, we expect these results to be widely applicable in the context of the reconstruction of evolutionary histories. our results also demonstrate that the mutation process has a deep influence on protein evolution. it modifies the balance between stability against the unfolded state and stability against misfolded compact conformations, and it modifies the fraction of mutations which are eliminated by purifying selection. in our mean-field model, mutations and selection are strictly interrelated, as the effective selection probabilities depend on the mutation process.

