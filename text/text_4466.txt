BACKGROUND
since the first draft sequences of the human genome were completed, much of the sequencing field has turned to the problem of identifying common genomic variations and their distributions among human populations  <cit> . these variations exist predominantly in the form of single nucleotide polymorphisms , single dna bases that take on two common alleles in the population. while most of these variants are believed to be functionally neutral, they nonetheless encode a great deal of information about the history and structure of the population from which they are sampled, as well as the molecular evolution of the local genetic region in which each occurs. many computational methods have been developed to infer properties of the molecular evolution or population genetics of a species from these snp data. examples include methods for identifying sites of frequent recombination  or gene conversion , identifying conserved haplotype sequences , finding genomic regions that have undergone selective sweeps , and detecting population substructure  and admixture .

all of these inference methods work by a common principle of superimposing a mathematical model of the evolutionary event or process to be detected on a model of neutral evolution in the absence of that process. for example, an inference of population substructure may compare whether observed snp allele frequencies in the current generation are more consistent with what we expect to find in a single population under hardy-weinberg equilibrium or what we expect to see in two genetically isolated populations evolving independently over many generations. any such inference could in principle be made more easily and accurately if we could observe not just the current generation, but also prior generations at various points in this evolutionary process. information on these past genetic sequences, commonly encoded in phylogenetic trees or networks, is not generally directly observable but it too can be computationally inferred.

our goal in this paper is to facilitate a general strategy for performing a range of statistical inferences from genetic variation data: using phylogenetic inferences from the variation data as a common starting point and treating these inferred phylogenies as the input to inferences about specific features of molecular evolution in a population. similar ideas have previously been applied on smaller scales. such phylogeny-based inferences have been developed for specific inference problems, such as the detection of likely recombination breakpoints  <cit> . in addition, genome-scale analyses of phylogenies have been conducted in bacteria. for example, filliol et al.  <cit>  examined phylogeny inference on a genomic scale for the purpose of categorizing genetic variations from geographically diverse isolates of mycobacterium tuberculosis. nonetheless, there remain substantial obstacles to the more general use of phylogeny-based inference for whole-genome analysis in eukaryotes. phylogeny inferences may proceed from a more limited model of molecular evolution than do the downstream inference algorithms and may therefore fail to represent key evolutionary events. even if the model is correct, the inferred phylogenies may be incorrect. while there is no information in the modern sequences that is not also found in the phylogenies, regardless of their accuracy, incorrect phylogenies may end up confounding our analyses.

perhaps most limiting is that intra-species phylogeny inference is a computationally demanding task that would be intractable on genomic scales by any widely-used inference method. the simplest variant of the problem is maximum parsimony   <cit> , which seeks the smallest tree capable of explaining a given data set, a method that tends to be most suitable for short time scales in which mutations are likely to have been infrequent. mp phylogeny inference has been shown to be np-hard  <cit>  and thus computationally intractable except on small problem instances. there have been some prior methods to solve mp phylogenies optimally, as well as to solve more difficult inferences, such as the inference of phylogenetic networks incorporating both mutation and recombination  <cit> . in practice, mp phylogeny inference is generally performed with fast heuristic methods that do not guarantee optimal solutions . even these methods are not sufficiently tractable to process the millions of trees one would need for inference on genomic scales. maximum likelihood  <cit>  and bayesian  <cit>  methods for phylogeny inference tend to allow for more realistic and detailed mutational models and to more accurately account for uncertainty in inferences than do mp methods, but at the cost of generally even greater computational time.

in the present work, we seek to enable widespread use of phylogeny-based inference for genome-wide analysis by creating a library of local human phylogenies across the human genome drawn from the hapmap variation data  <cit> . we create this library by applying a recently developed method for maximum parsimony phylogeny inference  <cit>  that made it possible for the first time to construct the millions of local phylogenies needed to enable whole-genome phylogeny-based inferences. we illustrate the use of this library for phylogeny-based inferences with sample applications based on a tree statistic that we call "phylogenetic imperfection." we demonstrate that imperfection shows significant regional and cross-population conservation and show that it is significantly predictive of fine-scale recombination rate.

methods
phylogeny inferences
we infer maximum parsimony phylogenies using a method developed in sridhar et al.  <cit> . the method finds maximum parsimony mutational phylogenies from matrices of binary snp variation data. the algorithm first uses a series of preprocessing steps to eliminate redundancy from an observed data set, decompose the problem into smaller sub-problems where possible, and limit the space of possible solutions to each problem. these simplified phylogeny sub-problems are then converted into an equivalent representation based on the graph-theoretic concept of multi-commodity flows. these flow problems then translate directly into a mathematical format called an integer linear program , a form of constraint satisfaction problem for which highly optimized solver programs are available. we then use the cplex  <dig>  ilp solver to find an optimal solution to the ilp, which we can then convert into a minimum-size solution to the original phylogeny problem. we refer the reader to sridhar et al.  <cit>  for details on the theory and implementation of these methods.

data sets
this study primarily uses data from the international haplotype map   <cit>  for the purpose of conducting a fine-scale genome-wide scan of human genetic variations. we use computationally phased hapmap data for this analysis. although we have developed algorithms that will infer maximum parsimony phylogenies directly from unphased data  <cit> , these algorithms are not efficient enough for use on a whole-genome scale. we restricted ourselves to the hapmap ceu population of utah residents of european ancestry and the yri population of residents of yoruba in ibadan, nigeria because these subpopulations were genotyped for parent-child trios and can thus be expected to have minimal phasing error. the other two hapmap data sets  were genotyped only for unrelated individuals and were omitted here due to the higher likelihood of phasing errors. all hapmap data sets were downloaded in phased form from the hapmap web site, where the phase program  <cit>  had been used to identify most likely phases from the trio data. this hapmap build was based on the ncbi human genome assembly build  <dig>  <cit> . snp location assignments and genomic coordinates are therefore based on ncbi build  <dig>  the resulting data contained  <dig> haplotypes from  <dig> unrelated individuals for each of the two populations typed at approximately  <dig>  million snps. phylogeny inferences were run for window sizes of five, six, seven, eight, and nine consecutive snps at each overlapping window of the given size across the  <dig> autosomal human chromosomes in each of the ceu and yri populations. the resulting library contains a total of nearly  <dig> million phylogenies, each covering 5– <dig> consecutive snps on  <dig> chromosomes. statistical analyses described below were performed using the 5-snp libraries. a subset of these analyses, described below, were performed after screening the full library to remove windows spanning predicted recombination hotspots, as assessed by the ldhot method of mcvean  <cit> .

several additional datasets were used to study correlation of imperfection with other sequence features. we retrieved the set of nonsynonymous coding snps  mapped to the build  <dig> genome using the ensemble biomart tool  <cit> , selecting all ncsnps with validated assays. fine-scale recombination rates and recombination hotspots were retrieved from the hapmap web site  <cit> . locations of all short tandem repeats in the human genome were retrieved from the ucsc genome web site  <cit> . the set of all human repeats was based on repeatmasker  <cit>  inferences and was also retrieved from the ucsc genome resources table view tool. the locations of high-scoring hits were also manually examined using the ucsc genome browser  <cit>  and the dbsnp resource at the ncbi web site  <cit>  to identify the genes and repetitive regions containing the particular snps of interest and, for coding snps, to identify their corresponding amino acid changes.

statistical analysis
phylogenetic imperfection
we illustrate the concept of phylogeny-assisted genomic analysis using a simple tree statistic that we call phylogenetic imperfection. the imperfection of a phylogeny is defined as the difference between the number of point mutations found in the tree and the number of variant sites in the data set. in a purely mutational phylogeny, imperfection corresponds to the number of recurrent mutations needed to explain the data set. figure  <dig> illustrates the concept of phylogenetic imperfection on a small hypothetical data set. imperfection can thus be expected to correlate with mutation rate of the snps in the tree. it would also be expected to correlate with the presence of recombination or gene conversion, either of which would be expected to be mis-identified as multiple point mutations in a purely mutational phylogeny. in the analysis below, we therefore examine properties of this statistic on a genomic scale, its correlation with recombination rate, and its possible use as a means of identifying sites of high historical variation in the genome.

note that computing phylogenetic imperfection is np-hard. while we do not provide a formal proof of that statement, it follows from the fact that knowing the imperfection of a dataset allows one to trivially compute the number of mutations found in the maximum parsimony tree. one could therefore use an efficient algorithm for computing imperfection to create an efficient algorithm for mp phylogeny inference. for example, one might repeatedly identify one possible node and edge on the periphery of an optimal tree whose elimination reduces the optimal parsimony score, then recurse on the remainder of the data to construct the rest of the tree.

mutual information
in order to test for regional variations in phylogenetic imperfection, we calculated mutual information between windows at varying genomic distances. we enumerated all pairs of 5-snp windows across each chromosome, excluding those with overlapping snps. each pair of windows was placed in a bucket according to the distance separating the central snps of the two windows. bucket widths of  <dig> kb and  <dig> kbs were used in separate tests. we then treated the entries in these buckets as samples from two random variables, one variable corresponding to the imperfection of the upstream element of each pair and the other to the imperfection of the downstream element of each pair. we then calculated the mutual information of these two random variables as a measure of how informative an imperfection score at any one point on the genome is about those at varying distances along the genome.

given a sequence of points x <dig> ..., xm drawn from a countable set of values {c <dig> ..., cn}, where fi represents the fraction of points with value ci, the entropy of the sequence is defined as

 h=−∑i=1nfilog⁡ 

the joint entropy of a set of paired data points , ,...,, where fij is the fraction of points with the value , is calculated by the formula

 h=−∑i=1n∑j=1nfijlog⁡ 

the mutual information of the set is then defined as h + h - h.

in order to establish statistical significance of mutual information scores, we used the fact that a mutual information score can be regarded as a log likelihood ratio statistic, which itself is approximately chi-square distributed for sufficiently large sample size. many of the data points in a given bucket will be dependent on one another, even under the null hypothesis that different windows are independent of one another, because the same window may contribute to multiple pairs within a given distance. we therefore adopted a conservative estimate of significance by taking only a subset of pairs containing at most one pair for any given window. with this approximation, the significance of any given data point can be estimated by treating it as a chi-square statistic with value im, where i is the calculated mutual information and m is the number of independent data points supporting it. we calculated this value for each window and used the minimum value of the statistic as an approximate upper bound on the p-value of the comparisons. the number of degrees of freedom is equal to the maximum observed imperfection score,  <dig> for these data.

imperfection versus recombinations
in order to compare imperfection and fine-scale recombination rates, we first identified for each window in our data set the location of the central snp in the window. we then retrieved the fine-scale recombination rate at each such snp from the hapmap-supplied data. the result was two paired lists of data points. we calculated pearson correlation coefficients for the two lists for each chromosome individually and for all chromosomes collectively. statistical significance of the correlation coefficients was assessed by permutation test, randomly permuting one data set with respect to the other for  <dig>  trials for each test reported. a curve was fit to the data points by proposing that imperfection i is related to recombination rate r by a function of the form i = a and using newton-raphson iteration to find the least-squares best fit parameters a and b. we calculated the correlation coefficients with the original data-set as well as with windows spanning recombination hotspots removed.

imperfection outliers
we selected those windows of highest imperfection by summing imperfection computed in the ceu and yri populations for common windows and selecting those with the highest sum. this analysis was performed using data from which recombination hotspots had been excluded. the analysis was run once for the set of all windows in the genome excluding hotspots and once for those windows centered on non-synonymous coding snps . ncsnps mapped to the genome were selected from biomart  <cit>  using the february  <dig> dbsnp build. we selected all those with combined imperfection at least  <dig> for the set of all windows and for combined imperfection at least  <dig> for the set of ncsnp-centered windows. the gene list generated from ncsnp outliers was run through the gostat server  <cit>  to identify overrepresented gene classes. we report only the two most significant such classes as most of the others appear to represent subcategories of those two best hits.

comparison to maximum likelihood phylogenies
one might question whether statistics drawn from our phylogeny library could be biased by systematic errors in phylogeny inference. for example, mp inference can never produce trees larger than the true phylogenies and may therefore systematically underestimate phylogeny size. while there is no known ground truth by which we might definitively test for such biases, we can compare a subset of trees to those from a more statistically sound maximum likelihood  method. because of the high run-time of ml methods, we can compare only a small subset of the windows. we examined the first  <dig> 5-snp windows from chromosome  <dig>  we constructed trees for these windows using the phylip  <cit>  ml inference code, with uniform mutation rate and constant rate variation among sites, using the speedier  processing option. we cannot directly compare geometries between the ml and mp trees because the ml approach necessarily treats individuals with the same sequence as distinct tree nodes, creating large subtrees with essentially arbitrary connectivity. we therefore post-process the ml trees by collapsing all nodes of common sequence  and relinking the resulting non-redundant node set into a minimum-cost spanning tree. we compared the average phylogeny sizes between these processed ml inferences and our mp data, quantified by the fractional difference between mean mp and mean ml tree size over the  <dig> data sets. we further quantified differences by two metrics on the geometries of the mp and processed ml trees. we first applied the robinson-foulds distance  <cit> , a widely used metric for comparison of phylogenetic trees that measures the number of bipartitions of the population that are defined by edges in one tree but not the other. second, we examined the root mean square  difference, summed over all pairs of observed haplotypes, between the separation of the pair in one tree and their separation in the other.

computer resources
the inferences were performed on a pentium workstation computer running linux. code was written in c++ and uses the cplex  <dig> ilp solver for linear programming solution. our inference algorithms and the phylogeny library are accessible through a web server at . the server provides access to the preprocessed human phylogeny library and a front-end to a server to which users can supply their own data to be solved by our methods. in addition, users can directly download a full set of phylogenies for each chromosome in dot format, a language for graph description developed for the graphviz graph rendering package. the present analyses were based on inferences of a single phylogenetic tree per window of snps examined, but the server can also infer the network produced by the union of all maximum parsimony phylogenies for any given window. source code will be provided upon request, although users must supply their own ilp solver to run it.

all other data processing and statistical computations were performed with code written in the perl language. graphics for the paper were prepared with sigmaplot version  <dig> and gnuplot version  <dig> .

RESULTS
genome-wide imperfection scan
the principle result of this study is the library of phylogenies, provided for download at . table  <dig> provides run-time information for constructing the library. the high variability in run times arises from the fact that run time can vary considerably from tree to tree for a fixed window size and total computational time therefore tends to be dominated from a small fraction of the inferred windows. we cannot directly visualize several million distinct phylogenies and we therefore instead illustrate the overall library by plotting imperfection scores of these phylogenies across the genome for the 5-snp window library, with windows spanning predicted recombination hotspots removed from the plot. the imperfection score measures the minimal number of recurrent mutations needed to explain mutation among all observed sequences from a common ancestor and therefore provides a simple way of distinguishing regions that can be explained by simple  phylogenies from those with more complicated histories. figure  <dig> presents plots for all human autosomal chromosomes, mapping each window score onto the position of the central snp in that window. the results show substantial variability in imperfection on multiple length scales. peaks of high imperfection appear to occur both in isolation and as part of regional clusters. in addition, imperfection appears in general to be higher towards the telomeres and lower towards the centromeres across chromosomes. imperfection scores around telomeres and centromeres are generally sparse because few snps were typed in those regions. although the amount of data makes it impossible to fully appreciate even the imperfection scores visually, the full set of scores is also available for download at .

in addition to providing a coarse visualization, the imperfection scores give us a statistic for assessing population conservation of the phylogenies. over all chromosomes, the ceu data shows a mean imperfection of  <dig>  and the yri a mean imperfection of  <dig> . these results may reflect the higher genetic diversity of african versus european populations. the two populations do, however, show a strong overlap in regions of high or low imperfection on the genome. for snps variant in both populations, the imperfections have a correlation coefficient of  <dig>  between the populations when examining all windows or  <dig>  when recombination hotspots are excluded. this correlation may reflect the in fluence of common histories prior to divergence of the two lineages, some inherent propensity of particular sites in the genome towards larger or smaller phylogenies, some combination of the two, or some systematic snp-specific bias.

mutual information
to further test the hypothesis that there is a conserved regional substructure to these patterns of variation, we examined the mutual information between imperfection scores at pairs of non-overlapping windows within each population. mutual information assesses the degree to which the variability between the two sets of sites treated individually exceeds their variability when considered collectively. high mutual information indicates that two sites are highly predictive of each other, while low mutual information suggests that they are nearly independent. figure  <dig> shows fine-scale dependence, plotting mutual information for distances 0– <dig> kb in  <dig> kb buckets. while both populations yield qualitatively similar results, the yri population shows in general a somewhat greater mutual information between windows than does the ceu population at all length scales. the plot shows for both populations a sharp spike for the closest windows  followed by a rapid drop and then a slow decline across the remainder of the length range. figure  <dig> plots dependence at a coarser scale of 0– <dig> mb measured in  <dig> kb buckets. the picture at the coarser scale is qualitatively similar to that at the finer scale, showing a rapid drop for both populations near the origin, followed by a more gradual decline for the remainder of the range covered. the results support the conclusion that imperfection is at least partly determined by an inherent propensity towards high or low imperfection in local regions of the genome. the decaying mutual information scores also help us interpret the observation of conservation across populations. because mutual information scores are computed in each population separately and using non-overlapping windows, the conservation between nearby windows cannot be explained by the common history of a population prior to divergence into sub-populations or by snp-specific biases . we can reasonably assume that regional genomic propensities detected by the mutual information measure at least partly explain the conservation of phylogeny sizes between populations. using the chi-square approximation of mutual information, we determined that the minimum chi-square approximation across all reported mutual information scores was  <dig> for  <dig> kb windows  and  <dig> for  <dig> kb windows . both values are highly significant . we believe this measure provides a very conservative estimate of significance, but it nonetheless establishes that the mutual information between imperfection scores cannot be attributed to chance even out to megabase distances along the genome.

imperfection as a statistic of fine-scale recombination
we next sought to demonstrate how a library of inferred phylogenies would be useful in making genome-scale predictions of genomic features that indirectly depend on local evolutionary histories. we chose the example of fine-scale recombination rate, continuing with the imperfection statistic as a hypothetical predictor of that rate. recombination rate might be expected to correlate with phylogeny size because recombination events will be misinterpreted as multiple recurrent mutation events and the imperfection statistic should therefore tend to be large where recombination has been frequent. while we do not have access to the ground truth for recombination rate, we can test our ability to predict an accepted inference of the recombination rate that was performed for the hapmap by the method of macvean et al.  <cit> . figure  <dig> illustrates the correlation between local imperfection and the previously inferred fine-scale recombination rates for chromosome  <dig>  we chose chromosome  <dig> for visualization purposes as it is small enough that fine-scale features can still be discerned in a whole-chromosome plot. the image reveals that spikes in local recombination rate do generally correspond with spikes in local phylogenetic imperfection. conversely, regions of sustained low recombination rate, such as that observed around  <dig> mb do appear to correspond to generally low imperfection. nonetheless, many peaks in phylogenetic imperfection coincide with low inferred recombination rates. figure  <dig> just examines the windows that fall outside recombination hotspots, further showing that high imperfection can occur at regions of low recombination rates. this observation suggests that the phylogenetic imperfection measure detects both recombination and other sources of large phylogenies, most likely recurrent mutation.

tables  <dig> and  <dig> show the pearson correlation coefficients between fine-scale recombination rate and phylogenetic imperfection when all windows are included and when windows overlapping recombination hotspots are excluded. permutation tests verify that the correlations are significant  for all chromosomes and for both populations. correlations are nearly identical for the two populations when all snps are examined and are slightly higher for yri when recombination hotspots are excluded. there is a significant correlation regardless of whether or not hotspots are included, but this correlation drops substantially when hotspots are excluded. these observations suggest that phylogeny size is discriminative of recombination rate even within low rates, but that a large fraction of the overall correlation does come from a strong correspondence with recombination hotspots.

 correlation coefficient in the ceu population.

 correlation coefficient in the yri population.

 correlation coefficient in the ceu population.

 correlation coefficient in the yri population.

this analysis also allows us to reconsider the issue of conservation between the populations by examining how well mutual correlation with recombination rate explains correlation of phylogeny sizes between populations. the overall pearson correlation between recombination and imperfection across all chromosomes is  <dig>  for both populations, compared to a correlation of  <dig>  between the imperfections of the two populations. these comparisons were likewise all determined to be significant with p-value < 0: <dig> by permutation tests. when hotspots are excluded, the overall correlations between imperfection and recombination rate drop to  <dig>  for both populations. the correlation between imperfection scores for the two populations drops to  <dig> . collectively, these observations confirm that the imperfection scores are significantly influenced by other local genomic properties than just recombination rates.

in order to better understand the relative sensitivity of imperfection to high versus low recombination rates, we plotted a histogram of mean imperfection versus local recombination rate. given the uneven distribution of data points, we used exponentially increasing bin sizes for recombination rates. after removing bins with fewer than  <dig> data points, the bin with the smallest rate was  and the largest was . figure  <dig> presents the results. both populations show low but non-zero mean imperfection for the smallest recombination rates, rising smoothly with increasing recombination rate before leveling off at the highest rates. the rate of increase and the height of the apparent asymptote varies between the populations, with a more rapid rise and a higher asymptote for yri  compared to ceu . we conjectured that the data could be fit by exponentially decaying curves of the form i = a. a least-squares fit to this form resulted in the parameters a = 0: <dig> and b = 1: <dig> for the ceu data and a = 1: <dig> and b = 1: <dig> for the yri data. note that best-fit curves level off below the asymptote in both cases , suggesting that a single exponential cannot provide a good fit simultaneously to the low- and high-recombination rate windows. subtracting out this best fit from the imperfection scores nonetheless reduced the correlation between imperfection and fine-scale recombination from  <dig>  to  <dig>  for ceu and from  <dig>  to  <dig>  for yri while still preserving a correlation of  <dig>  between the two populations after the fit was removed. this analysis again confirms that imperfection is strongly predictive of both recombination rate and other sequence regularities distinct from recombination rate.

imperfection by snp class
we then considered whether the imperfection statistic might be a useful predictor of dna functional context, such as whether a snp occurs in coding dna versus extragenic. we examined this question by comparing the overall distribution of phylogenetic imperfection scores across the genome for various functional classes of windows, with class defined by the sequence context of the central snp in the window. we first asked whether snps likely to be under selection showed any significant bias in imperfection scores. frequencies of scores were computed for the complete set of windows and for the set of windows centered on validated, non-synonymous coding snps, a set chosen because they are likely to be under stronger selection than snps in general. figure  <dig> shows the results for the ceu and yri populations respectively. a logarithmic scale is used to allow us to view the full range of frequencies, although this does understate the differences between the four data sets. at a gross level, all four data sets appear quite similar. each follows an approximately geometric decay in frequency with increasing imperfection. at all imperfections except zero, the fraction of windows for yri is substantially and consistently larger than that of ceu.

this result is unsurprising since africans are a more diverse and older population group than europeans. low imperfection scores account for a substantial majority of windows for all four sets and the absolute differences between the frequencies at the first few imperfection scores are small. ncsnp windows have a very slightly higher fraction of perfect phylogenies compared to all windows . while there are greater differences between ncsnps and general windows for larger imperfection scores, these could be explained by the small numbers of examples for the largest imperfection values. selection against changes in protein code therefore appears to introduce at most a modest bias in window imperfection scores.

a bias in imperfection scores might also be expected for snps found in repetitive regions of the genome. we might anticipate some excess of imperfection in this set from a greater frequency of genotyping errors or genome misassembly around repetitive elements. we might also anticipate a higher fraction of large imperfection scores due to genuine hypermutable sites, which are known to be associated with some short tandem repeat  regions  <cit> . we therefore compared the set of all windows with those whose central snp falls in any repetitive region. we also separately examined windows whose central snps overlap str regions. figures  <dig> and  <dig> show the results for ceu and yri populations. the graphs show hardly any differences between the data sets for the well-populated imperfection values. comparing all repeat windows versus all windows, we find that the frequency of perfect windows is nearly identical . str snps also do not show pronounced differences from general windows, although they are slightly less likely to be perfect . it therefore appears that repetitive elements do not lead to any dramatic systemic bias in local phylogenetic imperfection.

outlier phylogenies
we finally used the imperfection statistic to demonstrate one final value of a tree statistic in performing whole-genome analysis: identifying outlier data points. there are too many perfect windows to allow for an examination of individual cases of small imperfection, but we can examine those windows of highest imperfection. based on the preceding analysis, we would expect these outliers to correspond predominantly to windows with high historical recombination. we therefore used the data prescreened to remove recombination hotspots so as to favor outliers produced through processes other than recombination. table  <dig> lists the most extreme examples of imperfection observed across the non-hotspot windows. of the  <dig> windows,  <dig> are centered in introns of genes and  <dig> in an intergenic region. none of the top outliers occurs in the coding region of a gene.

this table identifies those windows with combined imperfection scores above  <dig> 

 refsnp id of the central snp of the window

 chromosome on which the window is found

 genomic map position of the central snp

 imperfection in the ceu population

 imperfection in the yri population

the results from the previous section suggest the absence of coding snps is more likely due to their scarcity in the full snp set rather than any bias against them and we therefore chose to examine ncsnp outliers separately. table  <dig> presents the twelve ncsnp windows yielding the highest imperfection across the genome. the top-scoring hit is to a gene prediction  that may in fact not be a functional gene. the others are each found in known proteins, but for most we know of no reason why they would be particularly disposed to high imperfection. we applied the gostat server  <cit>  to detect overrepresented gene classes among the twelve hits. the two most strongly overrepresented go classes were go: <dig>  and go: <dig> . three of the twelve proteins  are classified as negative cell cycle regulators. ten of the the twelve  are membrane-bound. although three of the twelve are neural-specific – nfasc and ngef are involved in axonal guidance and htr3e is a serotonin receptor – this does not appear to be a statistically significant observation. in addition, several of the genes have associations with human disease that might explain unusually strong selection. four of the twelve occur in genes with known relationships to cancer. mtus <dig> encodes multiple transcripts that act as inhibitors of proliferation in many tissue types and appears to be a general tumor suppressor  <cit> . hepacam is frequently downregulated in human hepatocellular carcinoma and may therefore also be a tumor suppressor  <cit> . tmc <dig> is a locus for the rare autosomal recessive disease epidermodysplasia verruciformis, which produces high susceptibility to human papillomavirus leading to high risk of skin cancers  <cit> . ppp1r15a is involved in the response to dna damage and is a prognostic factor for melanoma progression  <cit> . one other gene, prtn <dig>  is normally involved in the inflammation response  <cit>  and is an autoantigen in the autoimmune disease wegener granulomatosis  <cit> .

 refsnp id of the central snp of the window

 chromosome on which the window is found

 genomic map position of the central snp

 imperfection in the ceu population

 imperfection in the yri population

 gene containing the central snp of the window

 amino acid change produced by the snp. annexin a <dig> has two splice isoforms resulting in two possible sites of variation.

comparison to maximum likelihood phylogenies
in order to test for systematic biases in phylogenies introduced by inference from an mp method, we compared them to phylogenies inferred by a maximum likelihood  method for a subset of  <dig> 5-snp windows. we found a mean phylogeny size of  <dig>  mutations for the ml trees versus  <dig>  for the mp trees. if we regard the ml trees as a close approximation to the ground truth, then we can conclude mp trees underestimate phylogeny size by an average of  <dig> % on these data. we can therefore suggest that, while there is some systematic bias toward smaller trees with an mp method, the bias is relatively modest for small windows. the rms distance between pairs of individuals for corresponding ml and mp trees is  <dig> , suggesting that most individuals are in similar relative positions between the two trees. the robertson-foulds distance has a mean value of  <dig> , indicative of a somewhat larger average variation when comparing trees by edges rather than by individuals. this mean robertson-foulds score can be interpreted as an average of just over one inconsistent edge between each pair of trees. since we cannot guarantee the optimality of the ml trees by the ml criterion, these measures may in fact overstate the difference between the mp trees and ground truth. it is also possible, though, that the ml trees may themselves be biased relative to the ground truth and may therefore understate the bias in the mp trees. our post-processing step to collapse sub-trees with identical sequence may also bias the geometries to more closely match those of mp trees. future examination with other tree statistics or other methods of tree inference may also yield more dramatic differences than we observe here.

CONCLUSIONS
we have used recent methodological improvements in fast phylogeny algorithms to construct a genome-wide library of local mutational phylogenies in the human genome. this library provides an unprecedented view of likely sequences of mutational events in local regions of the genome that may give us new insight into mechanisms of mutation and selective pressures on genomic scales and in individual genes of interest. many forms of genomic analysis rely on indirect inferences of molecular evolution based on modern observed sequences and would likely benefit from accurate knowledge of full evolutionary histories. while we cannot observe these full histories, it is now possible to make reasonable inferences in local regions. we hope that this library will help enable a "phylogeny first" approach to whole-genome analysis tools based on the common hypothesis that good inferences of phylogenies will provide a stronger basis for statistical prediction of a broad class of genomic features than do raw variation data. we have demonstrated this approach with several sample applications of a simple tree statistic, imperfection, that measures the total size of a phylogeny.

the imperfection tree statistic is predictive of fine-scale recombination rate. it may therefore be useful as an alternative method for estimating recombination rates. moreover, it detects sequence regularities beyond the correlations for which recombination rate can account, which we conjecture is likely to include local mutation rate biases. phylogenetic imperfection in conjunction with other measures of recombination rate may be a useful way to separate these possibilities. this result may also in part reflect the fact that recombination rate and mutation rate are themselves correlated  <cit> . it is possible that other mechanisms, such as gene conversion, significantly affect observed imperfection scores. wiehe et al.  <cit>  showed that one can distinguish recombination and gene conversion by local patterns of linkage disequilibrium ; a characteristic pattern of high ld between non-consecutive snps with mutual low ld to intervening snps might similarly allow one to distinguish genuine recurrent mutation from other possible sources of high phylogenetic imperfection.

the imperfection statistic also allows us to test several hypothesis about molecular evolution on genomic scales. one such hypothesis is that there are significant regional biases in mutational propensities across the genome, beyond what can be accounted for by local signals such as recombination hotspots. consistent with the hypothesis, imperfection shows a pattern of local correlation on multiple scales, from a strong peak for nearby but non-overlapping windows on the kilobase scale to a gradual decline in correlation on even megabase scales. given that imperfection strongly correlates with recombination rate but shows significant cross-population correlation even after corrections for recombination rate, it is likely that these regional correlations reflect a combination of regional variation in recombination rate and regional variability in mutation rate. we cannot, however, yet determine the precise degree to which these two factors, or others unknown to us, might contribute to the overall regional variability. because the information calculations excluded windows sharing snps, the very strong local peak on the kilobase scale could only derive from regions extremely dense in snps. it is therefore plausible that the fine-scale peak corresponds to local correlations in imperfection due to hypermutable regions of the genome. further study of regional patterns for known sources of phylogenetic imperfection may help to separate these effects and detect any unanticipated contributing factors. by contrast, the imperfection statistic leads us to reject the hypothesis of significant variations in phylogenetic complexity between coding versus non-coding snps, or between snps in repetitive versus non-repetitive regions of the genome.

while we use imperfection in the present study as an illustration of our proposed "phylogeny first" approach, there are many other tree statistics that may be informative for particular processes. gene conversion, selective sweeps, and epistasis, among other processes, might all be anticipated to produce characteristic features of tree geometry by which they might be detected from a phylogeny library. determining which statistics are informative for particular processes and how they compare to other inference methods is a broad problem that we plan to address in future work.

authors' contributions
both authors participated in all stages of the design, execution, and analysis of the study and in the preparation of this manuscript.

