BACKGROUND
knowledge about microbial communities and the factors governing microbial community composition is fundamental for our understanding of ecology, but also for biotechnological applications such as wastewater treatment  <cit> . since isolation and cultivation is usually only successful for a fraction of the bacterial species present in an environmental sample , dna-based methods are routinely used to describe microbial communities. dna fingerprinting, gene sequencing, and in recent years, next-generation sequencing technologies enables descriptions of microbial communities at different resolution, where the latter provides an unprecedented level of detail. although fingerprinting methods, such as terminal restriction fragment polymorphism  , are trumped by next-generation sequencing technologies when it comes to describing the depth of microbial communities, numerous studies comparing the two methods have shown that the same conclusions can be drawn from both approaches, both with regard to community structure  <cit>  and dynamics  <cit>  of the community. it can also be argued that the advantage of traditional fingerprinting techniques is the ability to analyze a high number of samples at a low cost  <cit> , thus ensuring proper replication and statistical power. in conclusion, despite the continuously decreasing cost and the popularity of next-generation sequencing, fingerprinting techniques such as t-rflp are still relevant and an important tool for studies of microbial communities.

in a t-rflp analysis, the gene of interest, typically the 16s rrna gene, is amplified by pcr where one or both of the primers are labeled with a fluorescent marker. the gene is then digested by a restriction enzyme and the restriction fragments are separated by polyacrylamide or capillary gel electrophoresis. the terminal restriction fragments  are detected by an automated dna sequencer and the lengths of the t-rfs are estimated. the resulting t-rflp fingerprint of a community is a set of t-rfs, referred to as a t-rf profile. the length of a t-rf depends on the position of the restriction enzyme recognition sites and different t-rf lengths therefore represent different gene sequences.

differences in microbial community composition between samples are assessed by comparing the presence and relative abundances of t-rfs in the t-rf profiles. to be able to accurately interpret differences in t-rf profiles as differences in community composition it is important to know the variability of the method and how effective different analysis methods are in reducing variations and maintaining reproducibility. an important part of the analysis is to distinguish true t-rfs from false t-rfs derived from noise peaks or artifacts. one way to do this is by the application of a peak detection threshold , either when the peaks are detected and t-rf sizes are estimated, or afterwards, on the already generated data. in the literature, the range of applied pdts varies from low   <cit> , accepting most detected t-rfs, to high   <cit> , only considering peaks with a high fluorescence intensity. this range may be due to differences in the obtained fluorescence intensity of the peaks and background noise levels between different analytical platforms. in this study t-rflp analyses were carried out using the  <dig> dna analyzer  with a typical baseline noise level between  <dig> and  <dig> fluorescence units. here we evaluate the effect of applying an intermediate  or high  pdt on the characteristics of the t-rf profiles and on the subsequent comparisons of t-rf profiles. other important steps in the analysis of t-rflp data which affects the reproducibility is the alignment of t-rfs and the normalization of t-rf profiles, both of which we evaluate here.

alignment of t-rfs is the process by which it is determined which t-rfs that are the same in two or more samples. this may seem straightforward but due to the large variation in the estimated sizes of the t-rfs it can be both time-consuming and difficult to do in an accurate way, in particular when analyzing large datasets with high number of t-rfs. various approaches to the alignment of t-rfs have been presented in the literature  and tools for automatic alignment has been made available . however, although these methods are sound and can be rationally argued for, in our experience there are still problems with the alignment that remain unsolved, mainly due to the variation in estimated t-rf sizes. in this study we present a novel approach to evaluate and correct the alignment, which adjusts for differences in the estimated sizes of the t-rfs.

standardization, or normalization, is important to remove differences between t-rf profiles due to differences in the amount of dna that has been loaded on the gel. as for t-rf alignment, several methods for normalization have been presented . the normalization procedures, as well as the subsequent comparison of t-rf profiles, can be based on either peak height or peak area data. the use of peak areas can be motivated by the observation that peak width increases and peak height decreases with increasing migration time through the gel  <cit> . because of this, long fragments will result in broad and low peaks and will be underestimated if the relative abundances of t-rfs are based on peak heights. however, if peak areas are used, alterations in the relative abundances of the t-rfs may be produced by overlapping peaks. an evaluation also showed that the use of peak heights more accurately described the relative abundances of t-rfs derived from samples with defined amounts of different templates  <cit> . to evaluate how the definition of total fluorescence affects the outcome, in this study we use both peak height and peak area, both in the comparisons of different normalization procedures and in the comparisons of t-rf profiles.

some normalization methods have previously been evaluated. osborne et al.  <cit>  compared three different normalization methods: the constant percentage threshold procedure  <cit> , the total fluorescence normalization procedure  <cit>  and the variable percentage threshold procedure  <cit> . however, all three methods were based on peak area data and only three pairs of replicate samples were used to evaluate how well the normalization methods performed. moreover, it was not evaluated for how large variations in the amount of loaded dna the normalization methods were effective. in this study we evaluate two different normalization procedures  and variants thereof and assess how large differences in initial total fluorescence that can be adjusted for. comparisons are also made with a third method, the noise filtering method by abdo et al.  <cit> .

the aims of this study are to improve available automatic alignment procedures, to evaluate the efficiency of different normalization methods and to evaluate the effect of combinations of pdt and alignment and normalization strategies on reproducibility. furthermore, the impact of the alignment and normalization methods on the results of comparative analyses of t-rf profiles is also evaluated. do the method choices make a great difference in the general interpretations of the results, or do the methods only change the results at a finer, perhaps negligible, level?

the evaluations are done using four different datasets. a dilution series with dna concentrations from 17% to 100% is used to investigate the relation between total fluorescence and sample concentration, the effect of using single or consensus profiles and to evaluate the range of efficiency of a normalization procedure. a set of  <dig> samples loaded twice is used to evaluate the variations in t-rf size estimations and the efficiency of different normalization methods. a set of t-rf profiles derived from dna-extraction replicates and pcr replicates is used to evaluate the efficiency of different combinations of peak detection threshold, alignment correction, and normalization methods. finally, a dataset from a longitudinal study of the bacterial community in an activated sludge wastewater treatment plant  is used to evaluate the impact of different treatment combinations on subsequent comparative analyses of the t-rf profiles.

RESULTS
estimation of t-rf sizes
the estimation of t-rf sizes based on the migration time through the gel depends on the length, the nucleotide composition and the secondary structure of the t-rfs  <cit> . estimated t-rf lengths have been reported to be between one and eight bases longer or shorter than the true lengths  <cit> . here we show that there is also a run-to-run variation in the estimation of the t-rf sizes. a set of  <dig> samples was loaded twice on the capillary gel and the resulting t-rf profiles from the two loadings were compared. the differences in the estimated t-rf sizes between loading duplicates varied between  <dig> and  <dig>  bases. the same variation range was observed for t-rfs of all sizes. the average difference was  <dig>  ±  <dig>  bases and for 90% of the t-rfs the size difference between the runs was lower than  <dig> . thus, in most cases, the size variation is very low and will not affect the alignment and subsequent analyses. however, in the cases where the size difference is above  <dig> , the alignment may be affected.

alignment of t-rfs
before a comparison of two t-rf profiles can be made they need to be aligned, by comparing the sizes of the t-rfs present in the profiles. this process of comparing t-rfs is often referred to as t-rf binning, by placing t-rfs of similar sizes in alignment bins. the easiest way to bin the t-rfs would perhaps be to convert the t-rf sizes, which are given with various decimals, to integers and then place all t-rfs of the same size in the same bins. however, two t-rfs of size  <dig>  and  <dig>  bases would then be added to different bins instead of the same. to enable a more accurate and faster alignment more complex automatic binning procedures are used where t-rfs are binned together if the distance between them is smaller than a pre-defined value .

in this study, the moving average procedure described by smith et al.  <cit>  was used. for a small number of samples the automatic binning generally works well. however, for a large number of samples, with a high number of t-rfs that are close in size, binning can be problematic due to the variation in size estimations and the resulting alignment needs to be checked before further analysis. in the t-rflp data analysis work flow used in this study the alignment is evaluated by classifying the alignment bins as ambiguous or correct. alignment bins are classified as ambiguous if any of the t-rfs in the bin are within the given alignment range  of a t-rf in another alignment bin. for alignments of only two profiles, as in the comparison of loading duplicates above, ambiguous alignment bins can be easily corrected, by binning the t-rfs that are most similar in size . for the alignment of more than two profiles the same approach does not work .

for replicate profiles, as in the examples of additional file 1: tables s <dig> and s <dig>  ambiguous alignment bins can be easily corrected, since ideally, the same t-rfs should be present in all profiles. however, when the t-rf profiles are derived from different samples and the purpose of the analysis is to detect and quantify similarities or differences in community composition, the alignment of the t-rfs is harder to correct. to illustrate the alignment problems that can arise, 38 t-rf profiles generated from activated sludge samples were analyzed and automatically aligned using the moving average procedure as described by smith et al  <cit> . due to the large variation in size estimation and the high number of t-rfs with little size difference,  <dig> of  <dig> alignment bins were classified as ambiguous. figure  <dig>  shows an example of alignment bins classified as ambiguous.figure  <dig> 
example of ambiguous alignment bins and correction using the systematic shift procedure. the different symbols represent the alignment bins generated by the automatic binning procedure. panel a shows the original alignment and panel b the alignment after correction for systematic shifts in the estimation of t-rf sizes.



systematic shift correction
the differences in the size estimations of the t-rfs are often systematic, i.e. all t-rfs in one profile are estimated as a little longer than the t-rfs in another profile. for example, for the  <dig> activated sludge samples there are  <dig> possible pair-wise comparisons of t-rf profiles. of these,  <dig> comparisons, slightly more than half, showed a systematic shift in the size estimations. by adjusting the t-rf sizes and correcting for the systematic shift the alignment can be improved. figure  <dig> illustrates the concept of systematic shift correction.figure  <dig> 
concept of systematic shift correction. all t-rfs in profile  <dig> are estimated as a little longer than the t-rfs in profile  <dig> . a correction for the systematic shift facilitates the alignment .



in figure  <dig>  it can be seen how the adjustment for systematic shifts reduces the variation in t-rf sizes between samples and allows for a better binning. before the adjustment it is uncertain if there should be one or two alignment bins, and if two, where the t-rfs should be binned. the systematic shift correction removes this uncertainty. note that, as stated above, there is not a systematic shift in the size estimations for all pair-wise comparisons so the systematic shift correction is not valid for all t-rf profiles. however, in the given example in figure  <dig>  the profiles with the shortest t-rfs all display a systematic shift towards the profiles with the longest t-rfs. it should also be noted that even though corrections for systematic shifts do help in resolving many ambiguous alignment bins, it does not always succeed.

in the time series dataset there were  <dig> alignment bins in the original alignment.  <dig> of these, more than half, were determined to be ambiguous after initial inspection. by using the systematic shift correction as an aid to objectively resolve the alignment, the total number of bins was reduced to  <dig>  with only  <dig> remaining ambiguous.

total fluorescence and number of observed t-rfs
there was a large variation in total fluorescence and in the number of observed t-rfs between the  <dig> activated sludge samples in the time series dataset. the total number of t-rfs was clearly related to the total fluorescence: a high total fluorescence corresponds to a high number of t-rfs . however, division of the t-rfs into two groups, t-rfs with a relative abundance above and below 1%, showed that a high total fluorescence only increase the number of t-rfs of low relative abundance. the same pattern was observed independent if the total fluorescence was defined as the sum of peak heights or peak areas. the relation between total fluorescence and number of t-rfs has been observed previously by for example sait et al.  <cit> . however, in their data the threshold where an increase in total fluorescence no longer correlated with an increased number of t-rfs was 5%, and not 1% as for the data presented here.figure  <dig> 
number of t-rfs versus total fluorescence. the total number of t-rfs , the number of t-rfs with a relative abundance above 1%  and below 1%  are plotted against the total fluorescence of 38 t-rf profiles from activated sludge samples. total fluorescence was defined as the sum of all peak heights in a profile and the relative abundance of a t-rf was calculated as the peak height of the t-rf divided by the total fluorescence.



the analysis of a series of dilutions of the same sample showed that the total fluorescence was related to the dna concentration in the sample . osborn et al.  <cit>  also investigated the relation between total fluorescence and sample dna concentration with the same results. the experiment was repeated here to provide data that could be used to evaluate how the differences in total fluorescence affect comparisons of the t-rf profiles and the efficiency of the normalization methods.figure  <dig> 
total fluorescence versus dna concentration. total fluorescence was calculated as the sum of peak heights  or peak areas .



analysis of the loading duplicates dataset showed that differences in total fluorescence is not only dependent on concentration differences but also on the loading itself. the average difference in total fluorescence  between two duplicates, as a percentage of the highest total fluorescence, was 17 ± 7% and the maximum difference was 33%.

as the number of t-rfs in a profile depends on the total fluorescence of the profile, differences in total fluorescence can affect comparisons of t-rf profiles. the profiles in the dilution series were compared with the profiles of the undiluted sample using jaccard and bray-curtis similarities. for concentrations between 17% and 67% the similarity increased with increasing concentration . however, the profiles of the sample with concentration 83% showed lower similarities than the profiles of the 50% sample, due to the absence of several low abundance t-rfs.figure  <dig> 
similarity versus dna concentration. jaccard  and bray-curtis  similarities between the profiles of all diluted samples in the dilution series and the profile of the non-diluted sample. each sample was loaded twice on the capillary gel. filled symbols represent the first loading and empty symbols the second loading. the profiles were analyzed using a pdt of  <dig> 



in the loading duplicates dataset, the similarities decreased with increasing differences in total fluorescence when a pdt of  <dig> was applied . the relatively low similarities were due to a high number of t-rfs not observed in both loadings. generally, both profiles had t-rfs not present in the other, not only the profile with the highest total fluorescence. most t-rfs that were only observed in one duplicate were of low relative abundance, on average  <dig> % ±  <dig> %. as a result, the bray-curtis similarities, which are calculated using the relative abundances of the t-rfs, were higher than the jaccard similarities, which put equal weight on all t-rfs . the same pattern was seen when the analysis was based on peak heights as when it was based on peak areas.figure  <dig> 
similarity versus difference in total fluorescence. bray-curtis  and jaccard  similarities of  <dig> loading duplicates plotted against difference in total fluorescence  based on peak heights. the t-rf profiles were analyzed with a pdt of  <dig>  and a pdt of  <dig> .



applying a higher pdt removes the t-rfs with a low relative abundance. with a pdt of  <dig>  the average proportion of t-rfs only observed in one of the loading duplicates was reduced from 29 ± 8% to 16 ± 9% of all t-rfs in a loading duplicate pair. the similarities were also increased for  <dig> of the  <dig> profile pairs and the decrease in similarities for greater differences in total fluorescence was less marked . the same results were obtained independent if the analysis was based on peak heights or peak areas. blackwood et al.  <cit>  investigated the effect of different pdts on subsequent ordination analyses. however, contrary to the results presented here, they found that increasing the pdt from  <dig> to  <dig> or  <dig> decreased the similarity between replicates.

it is noteworthy that in the analysis using a pdt of  <dig>  one unique t-rf had a relative abundance of 43%. however, that t-rf was not observed in any of the loadings of two other pcr replicates of the same sample, and was therefore most likely an artifact.

normalization
five normalization procedures, three based on the total fluorescence normalization procedure  <cit>   and two using a fixed percentage threshold procedure  <cit>  , were evaluated using the loading duplicates dataset. the profiles were normalized pairwise and the profile pairs were then compared. the normalization procedures differed in the number of t-rfs they removed and in the resulting jaccard and bray-curtis similarities between the duplicates . before treatment the number of t-rfs increased with increasing total fluorescence. this pattern was still seen after treatment with tfn-areas and tfn-areas-lt, but not with tfn-heights, fpt-heights or fpt-areas . the tfn-areas procedures removed hardly any t-rfs and did not improve the jaccard similarities. however, the bray-curtis similarities were significantly increased. the tfn-heights treatment reduced the number of t-rfs the most but also increased both the jaccard and bray-curtis similarities the most. both of the fpt treatments reduced the number of t-rfs but for fpt-areas there was no significant difference in similarities compared to the untreated dataset. fpt-heights only improved the bray-curtis similarities. although removing more than half of the t-rfs, the tfn-heights treatment appear to be the best as it was the only treatment that increased the similarity between the duplicates, both when equal weight was given to all t-rfs  and when relative abundances were taken into account .table  <dig> 
number of t-rfs and jaccard and bray-curtis similarities of the loading duplicates dataset after a pdt of  <dig> and normalization



treatment
nt-heights
nt-areas
tfn-heights
tfn-areas
tfn-areas-lt
fpt 1% -heights
fpt 1% -areas

no of t-rfs

jaccard

bray-curtis
all values are average values ± the standard deviation. the number of t-rfs is the average for all  <dig> profiles. the jaccard and bray-curtis similarities are the averages similarities of all  <dig> duplicate pairs. the t-rf profiles were analyzed with a pdt of  <dig>  descriptions of the treatments can be found in the methods section. *denotes a significant difference from nt-heights. **denotes a significant difference from all other treatments.



with an applied pdt of  <dig> there was no significant difference between normalization treatments for number of t-rfs, jaccard or bray-curtis similarity , as many of the t-rfs not present in both profiles had already been removed. however, although the similarities of the entire dataset after treatment were not significantly different from the untreated dataset, some of the procedures did increase the similarity for many of the profiles . the tfn-heights procedure increased the similarities more than the other treatments .table  <dig> 
number of t-rfs and jaccard and bray-curtis similarities of the loading duplicates dataset after a pdt of  <dig> and normalization



treatment
nt-heights
nt-areas
tfn-heights
tfn-areas
tfn-areas-lt
fpt 1% -heights
fpt 1% -areas

no of t-rfs

jaccard

bray-curtis
all values are average values ± the standard deviation. the number of t-rfs is the average for all  <dig> profiles. the jaccard and bray-curtis similarities are the averages similarities of all  <dig> duplicate pairs. the t-rf profiles were analyzed with a pdt of  <dig>  descriptions of the treatments can be found in the methods section. there was no significant difference between the treatments. all numbers except marked with *were significantly different from the same treatment in the pdt  <dig> analysis.
count of number of duplicate pairs with increased or decreased similarity after normalization



treatment
tfn-heights
tfn-areas
tfn-areas-lt
fpt-heights
fpt-areas

increased similarity 

decreased similarity 
the t-rf profiles were analyzed with a pdt of  <dig>  the treatments are described in the methods section.
change in similarity of loading duplicates after normalization. the loading duplicate dataset was normalized using five different procedures . the jaccard and bray-curtis similarities after normalization were compared to the similarities before normalization. sum of all positive  and negative  changes in similarity after normalization are shown. the t-rf profiles were analyzed with a pdt of  <dig> 



with a pdt of  <dig>  t-rfs of low relative abundance are removed from the analysis from the start. these t-rfs may well be true t-rfs and could, although of low relative abundance, be of importance in the detection of differences between samples. however, with a pdt of  <dig> there is a higher risk of including false t-rfs and artifacts. an example is the occasional observation of false t-rfs produced by so called spectral pull-up. although the fragments of the size standard and the sample are labeled with different fluorophores, a false signal can be detected in the frequency of the sample fluorophore when there is a very strong signal from the fragments of the size standard. however, the false t-rfs produced by spectral pull-up are of low peak heights and are removed when a pdt of  <dig> is applied . the pdts used in the literature varies from low  to high , presumably depending on the wish to either preserve as many of the true t-rfs as possible or to ensure removal of false t-rfs produced by noise peaks.

based on the evaluation of the normalization treatments using the loading duplicates dataset, pdt  <dig> and the tfn-heights normalization procedure seem to be the best analysis combination. the tfn-heights normalization seem to be the best procedure because it made a higher number of duplicate profiles more similar compared to the other treatments . a pdt of  <dig> seems better than a pdt of  <dig> because it reduces the risk of including false t-rfs in the analysis. in addition, the final number of t-rfs after normalization was not significantly different between the analyses using a pdt of  <dig> or  <dig> . in other words, although applying a high pdt initially results in a loss of data, after normalization the final number of t-rfs may be the same as if a lower pdt had been applied.table  <dig> 
example of remaining number of t-rfs and total fluorescence after treatment


average no of t-rfs
average total fluorescence

after pdt 50*

after pdt 100*

after normalization**

after alignment***
average values ± the standard deviation of the number of t-rfs and total fluorescence  of the t-rf profiles of  <dig> activated sludge samples after data treatment. *replicate profiles were normalized and consensus profiles were generated from two replicate profiles only considering t-rfs present in both. **after normalization of consensus profiles. both replicate and consensus profiles were normalized using the total fluorescence normalization procedure based on peak heights. ***all t-rfs that could not be unambiguously aligned were removed.



although applying a high pdt and normalization increased the similarities, it should be noted that the resulting jaccard and bray-curtis similarity after treatment is in most cases lower than 100%. this means that the treatment cannot correct completely for the differences observed in repeated loadings of the same sample.

to evaluate how sensitive the normalization procedure is to increasing differences in total fluorescence between samples, the dilution series was analyzed, using the two loading duplicates for each dilution to create consensus profiles. a pdt of  <dig> was applied and both replicates and consensus profiles were normalized using the tfn-heights procedure. no corrections of the alignments were necessary. the differences in total fluorescence ranged from 4% to 62% . very high similarities were observed between the undiluted sample and all other concentrations . the bray-curtis similarities with the non-diluted sample were for all but one dilution higher than 98% and the jaccard similarities were all but one 100%. the profile with lower similarities, dilution 3: <dig>  had a t-rf not present in any other profile.figure  <dig> 
similarity versus difference in total fluorescence. panel a: analysis of the dilution series dataset. white columns – sample concentration. gray columns – average total fluorescence  of loading duplicate profiles before treatment as percentage of the average total fluorescence of the undiluted sample loading duplicates. circles – jaccard similarity with dilution 1: <dig>  squares – bray-curtis similarity with dilution 1: <dig>  panel b: analysis of the dna-extraction and pcr replicates dataset. columns – total fluorescence  of consensus profiles before normalization as percentage of the highest total fluorescence in the dataset. circles – jaccard similarity with sample “extr.  <dig> pcr 1&2”. squares – bray-curtis similarity with sample “extr.  <dig> pcr 1&2”.



in the dna-extraction and pcr replicate dataset the differences in total fluorescence ranged from 10% to 48% . a pdt of  <dig> was applied and both replicates and consensus profiles were normalized using the tfn-heights procedure. the alignment of the consensus profiles was corrected using the systematic shift correction procedure. after treatment the resulting jaccard and bray-curtis similarities with the profile with the highest total fluorescence were 92% as the lowest. the similarities did not decrease with increasing difference in total fluorescence . the differences between the profiles were due to the presence or absence of two t-rfs of low relative abundance and due to differences in the relative abundance of t-rfs present in all profiles .

in the loading duplicate dataset the differences in total fluorescence ranged from 3% to 36% . a pdt of  <dig> was applied and the duplicates were normalized using the tfn-heights procedure. the resulting jaccard similarities were between 60% and 100% and bray-curtis similarities ranged from 53% to 99%. for profile pairs with higher differences in total fluorescence there were greater increases in similarity after treatment compared to the similarity between non-normalized profiles than for profile pairs with little difference in total fluorescence. however, there was no apparent relation between the final similarity and the initial difference in total fluorescence .

the efficiency of the normalization procedure does not seem to be directly affected by how large the difference in total fluorescence is, at least not up to 62% differences. however, the similarities are not always increased up to 100%, which should be taken into account in comparisons of community composition.

consensus profiles
the observation of differences between loading duplicates before and after normalization, whether artifacts or due to differences in the amount of loaded dna, highlights the need to use consensus profiles of either loading, enzyme digestion or pcr duplicates instead of relying on single profiles for comparisons of different samples. as suggested by dunbar et al.  <cit>  consensus profiles can be created from replicate profiles by only including t-rfs that are observed in all replicates, and using the average values for sizes, peak heights and peak areas.

the dilution series dataset was used to evaluate the difference between comparisons of samples using single profiles or consensus profiles of loading duplicates . when consensus profiles were used both jaccard and bray-curtis similarities were slightly higher than then when single profiles were used.

data processing strategies
to further evaluate the effect of combinations of pdt, alignment correction and different normalization procedures on the comparisons of t-rf profiles, a dataset was created from two dna-extraction replicate samples, resulting in seven t-rf profile pairs. the dataset was analyzed in  <dig> different ways, including  <dig> using the normalization and alignment schemes provided in the t-rex software  <cit>  and  <dig> using the normalization procedure by abdo et al.  <cit>   combined with the alignment procedure presented in this study. the seven consensus profiles were then compared using jaccard and bray-curtis similarities . as a comparison, the six t-rf profiles that were used to create the dataset were also analyzed as single profiles, without generating consensus profiles.

the highest similarities were obtained by applying a high peak detection threshold, correcting the alignment and normalizing both duplicate profiles and all consensus profiles using the tfn-heights procedure . note that the lowest similarities using this treatment was 92%, meaning that as in the analysis of loading duplicates, the treatment cannot always correct for all differences introduced by the sample processing.

both the normalization strategies and the t-rf alignment procedure presented here can be said to be conservative in the sense that only data with a high level of certainty is used. in the normalization procedure, t-rfs are removed from the profiles with a high total fluorescence to avoid differences between profiles caused by differences in the amount of loaded dna. in the alignment procedure presented here alignment bins that remain classified as ambiguous even after correction for systematic shifts are removed from any further analysis. the reason for doing this is to avoid introducing similarities or differences between t-rf profiles based on erroneous alignment binning. the result is that a lot of information in the original data is sacrificed in order to retain a high reliability and accuracy in the comparisons of the t-rf profiles. table  <dig> shows an example of how many t-rfs and how much of the total fluorescence that are lost in the different data treatment steps.

community dynamics analysis
the time series dataset of  <dig> activated sludge samples was analyzed in nine different ways to evaluate the effect of different data treatments on the outcome of analyses of the dynamics of the community. the resulting t-rf profiles were then analyzed using jaccard and bray-curtis similarities to assess the stability  and the rate of change  of the bacterial community.figure  <dig> 
community stability: bray-curtis similarity between all profiles and the profile of the first sample in the time series. the data was treated in nine different ways before calculation of bray-curtis similarities . panel a: pdt <dig> tfn-a, b: pdt <dig> tfn-h, c: pdt  <dig> nonorm, d: pdt <dig> nonorm, noalcorr, e: pdt <dig> tfn-h, f: pdt <dig> tfn-h repnorm, g: trex-a, h: trex-h, i: trex-h round-up. the treatments are described in additional file 1: table s <dig> 
community stability: jaccard similarity between all profiles and the profile of the first sample in the time series. the data was treated in nine different ways before calculation of jaccard similarities . panel a: pdt <dig> tfn-a, b: pdt <dig> tfn-h, c: pdt  <dig> nonorm, d: pdt <dig> nonorm, noalcorr, e: pdt <dig> tfn-h, f: pdt <dig> tfn-h repnorm, g: trex-a, h: trex-h, i: trex-h round-up. the treatments are described in additional file 1: table s <dig> 



when the stability of the community was assessed by bray-curtis similarities there was little difference between most treatments . the treatments that differed were the treatments that did not include correction of the alignment: the no alignment correction, no normalization treatment and the three t-rex treatments. the t-rex treatment that used the simple round-up/down approach to alignment differed the most from the others and suggested that there were much bigger differences  between samples than any of the other treatments. notably, alignment of t-rf profiles using the round-up/down approach has been used in studies evaluating other aspects of t-rflp data analysis e.g. . as argued by others , the results presented here show that the round-up/down approach is not preferable. the other treatments without alignment correction differed the most for a number of samples in the middle of the time series. the difference is due to the erroneous alignment of several t-rfs present in the samples from that period. that the other treatments did not differ very much can be attributed to the abundance distribution of the t-rfs. for all samples the t-rf profile is dominated by a few t-rfs with a relatively high abundance. since the bray-curtis coefficient gives more weight to abundant t-rfs the removal of low abundant t-rfs by the different normalization methods or by applying a higher pdt does not affect the outcome that much. however, when the stability is assessed using jaccard similarities, which give equal weight to all t-rfs, no treatment results in the same pattern as another .

the rate of change, i.e. how much the community composition changes between each sample, was evaluated the same way as the community stability, using bray-curtis  and jaccard  similarities. likewise, in the assessment using bray-curtis similarities , all treatments except the ones without alignment correction showed similar patterns, and when jaccard similarities  were used all treatments resulted in different patterns.

ordination analysis
different treatments of the t-rf profiles will result in different clustering of samples. figure  <dig> shows the nmds ordination of untreated t-rf profiles and profiles that were treated with alignment correction and normalization of both replicates and consensus profiles. in both ordinations the samples cluster in groups corresponding to the time of sample collection. one group, samples from summer  <dig>  is spread out and overlaps the other groups in the ordination of untreated data while it clusters more tight and is separated from the other groups in the ordination based on alignment corrected and normalized data. the treatment procedures that include alignment correction all resulted in nmds ordinations with similar clustering when bray-curtis similarities were used. when the ordination was based on jaccard similarities small differences could be observed between all treatments.figure  <dig> 
impact of data treatment on ordination. nmds analysis based on bray-curtis similarities of t-rf profiles analyzed with pdt  <dig> without alignment correction or normalization  and t-rf profiles analyzed with pdt  <dig> with alignment correction using the systematic shift procedure and normalization of both replicates and consensus profiles using the tfn-heights procedure . the symbols represent the time of sample collection: filled squares – summer  <dig>  filled circles – autumn  <dig>  empty triangles – winter  <dig>  empty squares – spring/summer  <dig>  empty circles – late summer  <dig> 



correlation analysis with environmental parameters
the correction of ambiguous alignment bins and the removal of t-rfs by normalization change the dynamic pattern of t-rfs in the final alignment bins. therefore, the type of treatment affects the results of combined analyses of t-rflp data and environmental parameters. a simple analysis to detect t-rfs that are possibly affected by or might have an effect on environmental parameters is a correlation analysis using t-rf abundance data and environmental parameter data. table  <dig> shows the parameters that correlated significantly with four t-rfs after three different treatments. different conclusions regarding the possible importance of the t-rfs for sludge characteristics would have been drawn from the three different treatments. for example, with treatment a  and c  the t-rf of size  <dig> bases showed a statistically significant correlation with the effluent suspended solids, whereas with treatment b  it did not. likewise, the t-rf of size  <dig> bases showed a statistically significant correlation with the shear sensitivity after treatment a and b but not after treatment c. which t-rfs, i.e. which groups of bacteria, that would be determined to have a possible role in for example sludge settling properties or floc stability would thus depend on how the data was treated.table  <dig> 
correlations between t-rf abundances and wwtp process parameters



t-rf size
treatment
cod
p
f/m
i
h
t
fe
etoh
pd
s
sc
ess
only correlations significant at the 95% level are shown. + indicate positive correlation and – a negative correlation. treatment a: pdt  <dig>  no alignment correction, no normalization. treatment b: pdt  <dig>  alignment correction using the systematic shift correction procedure, normalization of consensus profiles using the tfn-areas procedure. treatment c: pdt  <dig>  alignment correction using the systematic shift correction procedure, normalization of both replicate and consensus profiles using the tfn-heights procedure. in all treatments consensus profiles were generated from two replicate profiles only considering t-rfs present in both. process parameters: cod - total cod going into the activated sludge tanks , p - total phosphorus concentration in primary settled wastewater , f/m - food to microorganisms ratio , i - inorganic fraction of the activated sludge , h - humic substances in the activated sludge , t - water temperature, fe - total iron dosage, etoh - ethanol dosage, pd - polymer dosage, s - shear sensitivity of activated sludge flocs, sc - carbohydrate content in the activated sludge , ess - effluent suspended solids .



CONCLUSIONS
we acknowledge that some of the conclusions presented here may be specific for the particular system that we used, since the variations in t-rf abundances and sizes are related to the dna loading and t-rf detection system. however, the discussions regarding alignment and normalization approaches are still relevant, independent of the system used.

we conclude that comparisons of single t-rf profiles from different samples are not reliable, due to variability in detection of low-abundant t-rfs and detection of false t-rfs. reproducibility can be increased by adapting a high detection threshold and by the combination of two profiles in a consensus profile before comparisons between samples. normalization of t-rf profiles, both duplicates and consensus profiles, to adjust for the variation in the amount of dna loaded on the gel, was also shown to contribute to the reproducibility. of the different normalization methods that were evaluated, all commonly used, the tfn-heights method was the most efficient. although the arguments for using peak areas as the basis of the analysis of t-rfs are valid, the evaluation presented here show that peak heights are preferred.

there can be a large variation in the estimation of t-rf sizes between samples, which affects the alignment of t-rfs and subsequent comparisons of samples. in alignments of t-rfs from a large number of samples, current automated alignment methods are not entirely reliable, as alignment errors may remain. an additional step, adjusting for systematic shifts in t-rf size estimations between t-rf profiles, was presented here and shown to improve the alignment of t-rfs.

we show that t-rflp data analysis method choices can determine the conclusions drawn from analyses comparing the community composition between samples, correlation analyses with environmental parameters and analyses of community dynamics patterns. generally, when t-rflp is used, at least one of these three analyses is the main tool to answer the proposed research question. this study shows that a conservative approach to normalization and alignment, although resulting in a loss of information, ensures that the results of the t-rflp analysis are reproducible and reliable.

