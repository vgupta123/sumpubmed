BACKGROUND
the rate of evolution at a site at one moment in time depends on the underlying mutation rate and the overlying selective constraints. both determinants of evolutionary rate may change spatially, along the genome, or temporally, in evolutionary time, to produce evolutionary rate variation. many highly important biological processes manifest in sequence data as spatial or temporal rate variation, and this signal is often harnessed to extract biological information from sampled sequences. sites in a gene with high nonsynonymous rates may be responding to positive selection , while conserved genomic sites likely carry out mission-critical biological functions . temporal shifts in evolutionary rate suggest functional change and may be used to explain the evolution of novel traits , to characterize functional innovation within gene families , and to resolve phylogenetic discrepancies .

as soon as molecular sequence data were available, evolutionary rates were observed to vary among sites. some amino acid positions seem completely invariant in proteins  <cit> , and a nucleotide model with an unknown fraction of invariant sites better approximates mitochondrial data  <cit> . this two-class, variable or invariant, site classification can generalize to any discrete distribution of rates across site  <cit> . theory and simulations suggest that phylogenetic inference is particularly sensitive to unrecognized site-to-site rate variation  <cit> . models that incorporate spatial rate variation often fit biological sequence data statistically better than models that assume a constant rate  <cit> . probably the most common model for site-to-site rate variation is the discrete approximation to gamma distributed rates  <cit> , but all these models are collectively referred to as ras models for rates across sites.

temporal rate variation, also known as heterotachy, is not so easy to observe directly, but it is a long-standing idea  <cit> . early work produced the word covarion, concomitantly variable codon, also extended to nucleotides  <cit> , to name the concept of temporal rate variation. in the original covarion model an approximately constant fraction of sites evolve, accumulating variation, but the site membership in the variable pool is continuously changing in time. the covarion model experienced very little theoretical progress until formalized as a markov model in  <dig>  <cit> . then, phylogenetic implementations followed rapidly  <cit> . recently, the covarion model was extended to allow switching between more than two site classes  <cit> . heterotachy models have largely assumed the switching rate is constant throughout time.

there is increasing evidence that heterotachy is an important evolutionary phenomenon, perhaps exceeding or superseding the importance of site-to-site rate variation  <cit> . much of this evidence is generated by testing the hypothesis of equal rates between pre-defined clades, for which many tests have been derived  <cit> . an alternative strategy attempts to detect brief spurts of evolution presumed to occur coincident with functional innovation. such episodic evolution leaves signatures on branches of phylogenetic trees, where the ratio of nonsynonymous to synonymous substitution rates exceeds one  <cit> . application of both kinds of techniques to large data sets reveals widespread heterotachy  <cit> . these tests are undoubtedly most sensitive to dramatic shifts in selection pressure, where many sites simultaneously experience an altered evolutionary rate. gene duplication, environmental changes, and niche invasion are all associated with large-scale changes in selection pressure affecting many sites in a genome. there are two questions of interest:  whether selection shifts occur, for example after gene duplication, and  when selection shifts occur in the history of sequences, e.g. to time historical niche invasion based on a sample of extant species. henceforth, we shall call the locations of these shifts divergence points in time or phylogenetic trees.

gu  <cit>  describes a maximum likelihood method for detecting divergence points associated with gene duplication. given a set of homologous genes categorized into paralogous groups separated by gene duplication and the phylogenetic trees that relate orthologs within groups, the method can identify amino acid positions that are functionally divergent between the groups. it works by hypothesizing that a fraction θ of amino acid sites  acquire independent function and thereby independent evolutionary rates in two or more of the ortholog groups. the remaining constrained sites retain function and evolve at the same dependent rate in all groups. after maximum likelihood estimation of θ, subtree branch lengths, and evolutionary parameters, bayes rule can predict functionally important residues if the estimate  is significantly bigger than zero.

the present paper extends the gu method by performing inference on a full tree without specifying a priori the branch where a divergence point is expected. i develop the method in a bayesian context for nucleotide sequences and test it using a panel of simulated sequences. i then apply the method to study divergence between human immunodeficiency virus  subtypes and hepatitis b virus  genotypes, revealing a substantial selection event sometime after separation of hiv subtypes b and c and no evidence of a selection event separating hbv genotypes f and h.

RESULTS
simulation
varying the magnitude of the selection shift
i simulate data sets assuming a single divergence point in a topology relating eight hypothetical taxa . i use a discrete gamma distribution with four rate categories and the same shape parameter α to approximate the variation in both spatial and temporal rates  <cit> . to explore the sensitivity of the method to the strength of the temporal selection shift, i vary the degree of rate variation  and the fraction of sites θ experiencing a selection shift across the divergence point. when a site is selected to shift rate, it randomly selects a new rate class from the discrete gamma distribution. all other parameters do not vary in this first set of simulations. in particular, the simulated divergence point is located at relative position l =  <dig>  on branch b =  <dig> in the topology τ of figure  <dig> with tj =  <dig>  expected mutations  per site along each branch j =  <dig> ..., <dig>  c code implementing markov chain monte carlo sampling of the posterior distribution analyzes each simulated alignment. posterior statistics of model parameters are computed along with the bayes factor bdp in favor of a divergence point somewhere in the tree. when log10bdp >  <dig>  there is strong support for a divergence point, which then allows conditional estimation of θ, l, and the bayes factor bj favoring a divergence point located specifically on branch j. all these latter statistics are based on the subset of mcmc samples that have a divergence point.

when a simulated divergence point is highly supported, the identification of the branch with the divergence point is exceptionally successful via bayes factor bj for branch j. out of  <dig> simulations with high support for the divergence point, only  <dig> failed to also identify the true branch  <dig> as highly likely  to carry that divergence point. only twice, another branch is incorrectly found to strongly favor a divergence point somewhere along its length. these results demonstrate the method can not only detect the presence of a divergence point in a phylogenetic tree, but also pinpoint the affected branch with high confidence.

whether the performance in simulation translates to real biological sequences is still questionable. previous analyses suggest that biological site-to-site rate variation falls in the range α ∈ , with nonsynonymous  rate variation tending to fall below α =  <dig>  <cit> . while there is less information about biologically relevant ranges for θ, gu  <cit>  estimates θ =  <dig>  for a study of the cyclooxygenase gene family at the amino acid level. comparison of rates between pre-defined monophyletic groups shows very high proportions of sites eventually experience heterotachy during evolution, even in functionally conserved sequences, for example, 66% of rrna sites  <cit>  or as high as 47% of the cytochrome b amino acids  <cit> . yang and nielsen  <cit>  find the proportion of codons undergoing positive selection during episodic evolution along particular lineages to be between  <dig>  and  <dig> , depending on the gene analyzed. thus, it appears that the power of this method to detect divergence points may falter near the boundary of biological relevance. in the next section, additional simulations investigate the amount of information, as measured by the sequence divergence, alignment length, and number of taxa, needed to detect divergence points.

varying the amount of data and evolution
to explore the power of the method to detect the divergence point for varying amounts and diversity of input data, i generate simulated data sets under a variety of conditions. i start by again simulating data alignments using the tree of figure  <dig>  for these simulations, i set α =  <dig>  and θ =  <dig>  and vary both the branch length  and the length of the alignment. figure  <dig> displays the results, showing that increasing diversity, as measured by the branch length, and data, as measured by the alignment length, both improve the power of the method to detect the divergence point. in particular, the divergence point is detectable for these α and θ when the branch length is above  <dig>  and the alignment length is over  <dig>  similar patterns are observed for different α and θ combinations. as long as θ ≥  <dig> , the method achieves good power at least for the simulation with tj =  <dig>  and  <dig> base pairs .

to test the impact of including more sequences, i simulate data with increasing numbers of taxa in each subtree. this time, α =  <dig> , θ =  <dig> , and all branch lengths tj =  <dig>  are selected to demonstrate a range of outcomes in resulting power. the original simulation tree of figure  <dig> has  <dig> taxa. i also simulate sequences with  <dig>   <dig>  or  <dig> taxa, maintaining the divergence point on the middle branch and adding taxa in a balanced fashion to both subtrees. because all branch lengths are held constant, any effect of adding more taxa could be a consequence of the additional taxa or the increase in total evolutionary time simulated. the power of the method to detect the divergence point increases substantially with the number of taxa in each subtree . unfortunately, the computational cost also increases substantially. roughly, based on informal observation only,  <dig> taxa take ten times as long as  <dig> taxa, and computational times double for every  <dig> additional taxa after that. finally, i also examine the probability of detecting heterotachy when the divergence point is placed on a terminal branch rather than the internal branch of figure  <dig>  this time α = θ = tj =  <dig> . not surprisingly, power of the method to detect a terminal branch divergence point is substantially compromised , indicating that balanced subtrees including many taxa provide the ideal conditions for detecting a divergence point.

comparison to existing heterotachy detection methods
hiv
as hiv spread into the human population in the last century, genetically distinct lineages arose  <cit> . these so-called subtypes have distinct geographic distributions  <cit> . in particular, subtype b dominates throughout much of the non-african and non-asian world, while subtype c dominates in southern and eastern africa, parts of the middle east, and india  <cit> . much of the geographic restriction of subtypes can be explained by the travels of a few infected individuals  <cit> , however there is also evidence of population level selection on the virus, particularly in relation to immune selection  <cit> . i hypothesize that if the virus encounters substantial population-specific selection pressures when entering a new population, a selection shift signature may be detectable on the branches of phylogenetic trees that separate subtypes.

to test the hypothesis, i align  <dig> hiv sequences, five from subtype b and five from subtype c. summaries of the marginal posterior distributions for each continuous parameter of the model are shown in table  <dig>  the reported potential scale reduction factors  <cit>  demonstrate healthy agreement between the six independent mcmc runs and all six runs are combined for statistical estimation. the bayes factor in favor of a divergence point cannot be computed because the support for a divergence point is unanimous in the posterior sample. the model clearly identifies a highly supported divergence point on the branch separating subtypes b and c, with log <dig> bbc =  <dig> , where indexing is meant to indicate the branch separating b and c. figure  <dig> shows the location of the estimated divergence point along with its 95% bayesian credible interval on the phylogeny drawn with branch lengths at their posterior means. the precise location of the divergence point along the branch is poorly estimated, but the selected branch is highly supported. considering the estimated values of α =  <dig>  and θ =  <dig> , the alignment length l =  <dig>  and the average branch length  of this data set, simulation results  suggest that the method just has enough power to detect the presence of a divergence point. it may not be possible to detect heterotachy for shorter regions of hiv.

hbv
like hiv, hbv has diverged into genetically distinct lineages with nonuniform geographic distribution around the world  <cit> . in the case of hbv, these lineages are called genotypes. although the origins of hbv are unclear, hbv is most likely to have evolved with humans since our emigration from africa  <cit> . the genotypes and their geographic distribution can thus be associated with major migration events, but it remains unclear whether the genotypes express distinct disease phenotypes  <cit> . hbv genotypes f and h are restricted to the americas, probably arriving on these continents with the first human immigrants  <cit> . genotype h is found much less frequently than f, and its origin is uncertain  <cit> . in fact, its classification as a separate genotype is controversial  <cit> . given the best estimate of hbv origins, it is not likely that the spread of hbv into new human populations has exerted recent selective pressure on the virus, however co-evolution of the virus along with the human host may create divergence points along branches where humans and viruses co-adapted to new ecological niches.

to look for divergence points related to the emergence of hbv genotypes f and h, i align seven genotype f sequences and three genotype h sequences. posterior summaries are in table  <dig>  figure  <dig> displays the estimated phylogeny relating these  <dig> sequences with the branch lengths drawn proportional to their posterior means. the number accompanying each branch is the conditional posterior probability that the divergence point lies somewhere along that branch given one exists somewhere in the tree. in contrast to the hiv results, a divergence point is not supported by the data with log <dig> bdp = - <dig> . considering only the posterior sample supporting a divergence point , no branch shows evidence of strong heterotachy, although the posterior distribution across branches is significantly different from the uniform prior . the alternative hypothesis of homotachy is substantially, but not strongly supported, and the method may simply have insufficient power to detect heterotachy in this data set. notably, because h is a poorly sampled genotype, the three representatives included here are highly similar, thereby forcing any potential genotype-associated divergence point onto what is effectively a terminal branch. table  <dig> suggests power is low under this condition, but i performed no simulations with parameters matching the hbv data, so it is unclear whether the method should have sufficient power to estimate the presence of a divergence point. evidence of site-to-site rate variation is high, with the posterior mean α =  <dig> , however the low diversity  and short alignment  sharply reduce the power of the method.

in addition, strong spatial rate variation may not translate to strong temporal rate variation in the case of hbv. normally, the magnitude of temporal rate variation is expected to approximately match the magnitude of spatial rate variation, because choosing a new function for a site is roughly equivalent to selecting a new site at random from the same protein  <cit> . the model makes this assumption by using the same rate class distribution for spatial and temporal rate variation. strong purifying selection combined with an error-prone reverse transcriptase is expected to produce highly heterogeneous rates in hbv, with widespread conservation due to overlapping reading frames interrupted by a limited number of mutation-tolerant sites  <cit> . but for a dual-coding nucleotide to temporally shift rate class, it must acquire a new function in both reading frames. this dual constraint may eliminate the possibility of divergence points in hbv and certainly reduces both the magnitude of temporal rate shifts and the number of affected sites. in short, the biology of hbv may limit both the presence of and the power to detect divergence points. increasing the number of sampled sequences per genotype may restore power, but this option is not examined further here.

CONCLUSIONS
spatial and temporal rate variation is the signature left on genomic sequences by the force of selection. although mechanistic differences can also generate evolutionary rate variation, it appears that the selection signal is stronger  <cit> . a flurry of new methods have emerged to detect and utilize this signal to inform on function  <cit> . i propose a new method for inferring the location of divergence points in phylogenies. the method joins a host of existing tests to detect selection sweeps along pre-specified branches of a phylogeny  <cit> . unlike existing methods, however, the proposed method does not require a priori branch specification.

the method is developed in a bayesian context and applied to two viral data sets. the hiv data strongly support the presence of at least one divergence point, while the hbv data fit a model with substantial site-to-site rate variation but no sudden or dramatic temporal rate shifts. heterotachy may still occur in the hbv sequences, perhaps more subtly, accumulating slowly and methodically over time as in the covarion model  <cit> . the presence of a divergence point between hiv subtypes b and c indicates a profound rate change after the split of these two subtypes. it does not prove that the divergence point occurred concurrent with the split or caused it in any way. however, it is plausible that host population differences are related to the apparent selection differences, and further testing may reveal specific cause-and-effect relationships between host differences and rate differences in the hiv genome. finally, i make no effort to detect the possible presence of other, weaker divergence points in this set of hiv data. a natural extension of the current bayesian method is to allow and estimate more than one divergence point per phylogenetic tree. interestingly, the episodic evolutionary events sought by methods that detect high nonsynonymous rates on particular branches  <cit>  consist of two divergence points appearing close to or on the same branch of a phylogeny. thus, multi-divergence point models may be better equipped to detect and quantitate temporary shifts in evolution. in the limit as the number of divergence points d increases and the proportion of diverging sites θ decreases, the model approaches the covarion model.

recombination between subtypes/genotypes is a common phenomena in both hiv  <cit>  and hbv  <cit>  that can result in a non-constant topology or branch lengths along an alignment. another oversight that could lead to non-constant branch lengths along the alignment is the fact that both data sets consist of multiple genes. while site-to-site rate variation can account for some rate variation along the alignment, it does not adequately model whole-gene shifts in rate that can result when different genes evolve according to different processes. in assuming that a fixed topology and a single set of branch lengths applies to the full alignment, i prohibit the possibility of recombination or gene effects and may force the wrong topology and or branch lengths on some sites if these assumptions are not met. forcing either an incorrect topology or incorrect branch lengths could affect inference of heterotachy. the first set of simulations and figure  <dig> demonstrate that branch length estimation can depend on the estimation of heterotachy and rate variation. the reverse must also be true, such that incorrect branch lengths and especially topology, could influence inference on θ, l, and possibly even the presence of a divergence point. to limit the possibility of such an artifact, all selected viral sequences had been previously reported as nonrecombinant or verified so using recombination detection software  <cit> . this step insures that the two subtrees are consistent throughout the alignment, however it does not guarantee that the subtree topologies are consistent. another natural extension of the current model is to include recombination models that allow topology and branch length variation along the alignment while simultaneously estimating heterotachy. both models are already computationally difficult when considered separately, and combining them obviously represents a major computational challenge.

the current approach does not estimate the phylogenetic tree, assuming that it can be derived confidently using other methods. this assumption requires serious reconsideration since heterotachy can affect phylogenetic tree estimation  <cit> . in addition, including additional taxa should improve the power of the method to detect selection and estimate θ, yet adding taxa increases the chance of topological uncertainty. the ideal solution is to simultaneously estimate phylogeny and divergence point location. unfortunately, because branches do not retain definition across different topologies, divergence points may also lose definition. presumably, however, a simultaneous estimation procedure should be able to detect strong divergence points on supported branches while allowing for topological uncertainty within clades.

a persistent question lurking behind these analyses is whether detected rate variation is actually connected to selection and function  <cit> . lopez et al.  <cit>  suggest that temporal rate variation need not relate to function because even mitochondrial cytochrome b, whose function is highly conserved among all vertebrates, tests positive for heterotachy. comparison of vertebrate α and β globins revealed a similar disconnect between significantly heterotachous sites and those sites most likely responsible for protein functional differences  <cit> , leading philippe et al.  <cit>  to conclude heterotachy may be a largely neutral evolutionary process on alternative, but viable protein conformations. in order to identify functionally important rate shifts, it may be necessary to design models that separate this neutral heterotachy, e.g. covarion-like models, from the sudden and temporary heterotachy of the type expected after gene duplication or other environmental shifts. yet even these models may be over-simpistic. protein models  <cit>  that allow amino acid sites to self-classify into highly flexible evolutionary classes, reveal that sites with different functional or structural jobs differ not only in their evolutionary rates, but also in how they mutate. the divergence point described here allows no such changes in site properties. for example, if transitions are much more likely than transversions in one rate class, they are identically skewed in all other rate classes. yet it is plausible that the skew will shrink at certain codon positions or within some amino acid contexts. despite all these caveats, a recent large-scale analysis of proteins with known function reveals that shifts in rate are good predictors of differing functional classes  <cit> .

although the role of heterotachy in evolution remains to be clearly defined, the ability to detect rate variation from sequences alone is a powerful resource provided by comparative genomics. i did not use the results to predict functionally important sites in the viral data sets, but the forward-backward algorithm can compute the most likely unobserved state, diverged or not, of each nucleotide site  <cit> . in a bayesian context, the prediction can be integrated against the mcmc-approximated posterior density to improve robustness. specific predictions can generate hypotheses and focus future biological experiment.

