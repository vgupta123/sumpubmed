BACKGROUND
modern sequencing technology allows for fast and relatively inexpensive sequencing of large amounts of dna. whole genome sequencing of genomes of single microorganisms or even whole microbial communities are now state-of-the-art and commercially available. especially the sequencing of microbial communities, in which the isolation of a single organism is no longer necessary, significantly expanded the number of known proteins in public databases.

the global ocean sampling project , still one of the largest metagenomic projects to date, was initiated by the j. craig venter institute in  <dig>  <cit> . when the ~ <dig>  million protein sequences from the gos dataset were published, it more than doubled the number of known proteins in public databases at that time  <cit> . nonetheless, already before the first metagenomic datasets were published, the functional analysis of proteins could not keep up with the speed, with which new gene sequences were discovered. thus, the functions of most proteins have been, and still are, predicted based on their homology to a much smaller number of well-characterized proteins. therefore, the function of a major part of all proteins in large data repositories, such as ncbi or embl is still unknown . in some cases, depending on the taxonomic origin, up to 80% of the gene functions of a given organism cannot be inferred from homology  <cit> . the publication of large metagenomic datasets only exacerbated this challenge.

within the vast amount of proteins of unknown or predicted function lies great biotechnological potential. biocatalysts that could be found among those proteins might help us to move away from a petrol-based economy to a more bio-based economy. however, given the sheer size of our databases, it is challenging to make this in silico knowledge of genetic sequences amenable for functional testing in the lab.

here we present our approach to tackling this challenge using the gos metagenomic dataset as an example. we leveraged the available information from public databases to classify all proteins of the gos dataset with known domains into existing families. we classified the remaining set of proteins de novo and devised an algorithm that selects a representative protein sequence from these families based on a minimal phylogenetic distance  to all other members. representatives from  <dig> families containing predicted lipolytic enzymes were functionally characterized in the lab. one protein, termed gos <dig>  contains the alpha/beta hydrolase domain pf <dig> and showed high lipase/esterase activity when expressed in escherichia coli. we demonstrate that our approach can be used to substantially reduce the number of genes from metagenomic datasets that need to be screened for functions. it thus might accelerate biocatalyst discovery.

RESULTS
the majority of gos proteins can be classified based on hmm domains from public protein family databases
the gos metagenomic project is, to date, still one of the largest publicly available metagenomic datasets. the goal of our study was to make the vast protein sequence diversity contained in this dataset amenable to protein-biochemical functional studies. in a first step, we, therefore, annotated all predicted protein sequences contained in the gos dataset based on existing hmms from public protein family databases. we chose two hmm databases: pfam, a comprehensive protein family database  <cit>  and the complementary, more bacteria-focused tigrfams  <cit> . hmm searches are fast and can find more distantly related protein family members when compared to standard homology searches such as blast  <cit> . using an e-value cutoff of ≤ 10− <dig>  we could classify, based on the combined pfam and tigrfams hmms,  <dig> , <dig> of gos’s  <dig> , <dig> protein sequences. the use of a less strict cutoff of ≤ 10− <dig> resulted in the additional annotation of less than 4% of proteins in the dataset and an increase in the theoretical number of false positive matches by  <dig> orders of magnitude. we, therefore, decided to use the more stringent significance threshold for our analysis.

for the purpose of experimental testability, we ultimately wanted to associate each protein to one, and only one class. however, many proteins matched to multiple hmms with an e-value that passed our significance threshold. such an overlap may well be significant, if it was either due to a similarity in the hmms, or due to a frequent co-occurrence of two distinct domains in proteins of the gos dataset. if either of those two cases were true, we predicted that a majority of proteins that scored above the threshold for a particular hmm should also score above the threshold for one or more of the other hmms. we, therefore, considered all proteins that were matching a certain hmm above the threshold as a distinct set. as a measure of the co-occurrence of certain hmms, we then calculated the jaccard index for each of these hmm-based sets with all other sets. if the jaccard index of two sets was above  <dig>  , we created a new classifier, which combined both hmms. in this way, we created classifiers, which were either based on one hmm  or on multiple hmms . we then took each individual protein and considered only the most significant hmm match  and assigned it to the classifier that contained this particular hmm. in this way, we could assign 72% of the proteins in the gos set to  <dig>  hmm-based classifiers, which we then considered protein families .fig.  <dig> classification of gos proteins into families based on existing hmms from pfam and tigrfams and de novo mcl clustering. a 72%  of the protein sequences in the gos dataset could be distributed into families based on existing hmms obtained from pfam and tigrfams. the remaining 28%  of protein sequences were distributed into mcl-based classes. of these classes,  <dig>   were considered bona fide families based on class size, diversity and amount of complete sequences contained therein. b to generate mcl-based de novo clusters similar to the clusters based on existing hmms, the sequences from  <dig>  randomly chosen hmm-based families were subjected to markov clustering at the indicated inflation parameter values. the hmm-based families were then compared to the resulting mcl-based clusters and the jaccard similarity coefficient  was calculated. the mcl-cluster with the highest jaccard similarity coefficient was considered the cluster corresponding to the hmm-based family. a heatmap was created, with values of the jaccard indices color-coded according to the legend. the heatmap is sorted by phylogenetic diversity of the hmm-based families. at an inflation parameter of  <dig>  the mcl-based clusters showed the highest similarity to the hmm-based families. c taxonomic distribution of mcl-based families. hmms generated from these families were compared to the refseq database and the taxonomic origin of the matching proteins was classified as either of viral, prokaryotic, or eukaryotic origin. more than  <dig>  families are specific for the gos dataset




almost 40% of gos proteins that do not contain domains recognized by known protein family hmms were classified de novo
however, 28% of gos proteins did not match hmms from pfam and tigrfams with a significant e-value ≤ 10− <dig> . thus, we clustered these remaining proteins using the markov cluster algorithm   <cit> . to obtain mcl-based classes comparable to the classes we annotated using known hmm domains, we adjusted the so-called inflation parameter of this software, which basically adjusts the diversity of the clusters created. based on a test clustering of ~15% of our hmm annotated proteins we found that an inflation parameter of  <dig>  resulted in the largest overlap of mcl-based classes with the existing hmm-based classes and thus this value was used in our subsequent analysis .

we then used the mcl algorithm on all proteins from the gos dataset that could not be annotated using hmms of known domains. thus, we distributed these proteins into  <dig>  classes containing between  <dig> and  <dig>  sequences . theoretically, non-coding dna can randomly result in open reading frames of significant size. to rule out that we included protein-sequences derived from these “random” open reading frames in our de novo classes, we only considered classes with more than  <dig> members and no less than 10% complete protein sequences  for further analysis. we argued that the presence of  <dig> homologous open reading frames excludes that these sequences are random, non-coding dna. within this set, we then tested the phylogenetic significance based on multiple sequence alignments. these alignments were generated with mafft using default parameters  <cit>  and optimized with maxalign  <cit> . classes with more than 80% gaps were then excluded, since such large numbers of gaps typically only occur in alignments of proteins with very low to no similarity  <cit> . for the remaining classes, which we considered bona fide families , we generated hidden markov models. for this purpose, seed alignments were created using mafft’s g-ini strategy with gap regions removed by gblocks  <cit> . low-quality alignments that could not be improved by gblocks running with relaxed parameters  were rejected. amino acids were considered “conserved” if they were present in at least 50% of the sequences at any given position and gaps were only considered if present in more than 50% of the sequences. multiple sequence alignments fulfilling these criteria were modified by gblocks as described and were then used as input for hmmer  <dig>  to create hmms  <cit>  . we then tested the specificity and sensitivity of these hmms with a test set containing the sequences used to build the hmm , and with  <dig>  mammalian and plant proteins, matched in size distribution to the  gos protein set . we then obtained the number of false negatives  and estimated the upper limit of false positives  to calculate the f <dig> score, a measurement of hmm performance  <cit> .

this resulted in a library of  <dig>  hmms with an f <dig> score ≥  <dig> , which contain the information of  <dig>  proteins in total . to test if the high f <dig> scores are the result of overfitting of the data, we tested our approach with a training set derived from the largest of our de novo classes. to this end, we randomly selected two thirds of the sequences contained in fumefam <dig>  which contains  <dig> sequences in total and built an hmm from this subset. we then tested the selectivity and specificity of this hmm against the complete set of proteins in fumefam <dig>  repeating this approach  <dig> times, we consistently achieved an f <dig> score of  <dig> 

we then used this set of hmms and searched for potential matches in the ncbi refseq database, a set of curated prokaryotic, viral, and eukaryotic sequence datasets  <cit> . by this approach, we found that  <dig> and  <dig> of our hmms were specific for viral or prokaryotic organisms, respectively.  <dig>  hmms did not produce any match in any of these datasets, suggesting that they are specific for the ocean metagenome .

for each family, we determined one representative sequence
with  <dig>  families based on hmms from public databases and  <dig>  novel families, we had the gos proteins subdivided into  <dig>  families in total. to be able to test these families for their biochemical function, we decided to define one protein from each family, which best represents this family. we selected this representative based on its similarity to all other proteins within its family. for this purpose, we first generated a guide tree using mafft  <cit> . we then calculated the sum of the distances in this tree of each individual member to all other members of the class. we reasoned that the member with the minimal sum of distances is the most closely related member to all other members and, therefore, best represents its class . because the representative should be testable in the lab, we considered only complete sequences . to remove bias introduced in the tree building, we randomly created subsets containing 90% of all members and recalculated the guide tree and the associated distances for these subsets  <dig> times. the member selected most often was then defined as the representative for this family. in this way, we could define one representative for all families containing at least one complete protein, giving us a total of  <dig>  representatives .fig.  <dig> definition of a representative. a-c) schematic overview. the representative of a family is calculated based on the distance in a phylogenetic tree. a the phylogenetic distance between sequences a <dig> and a <dig> is  <dig> units. b a <dig> and a <dig> are separated by  <dig> units. c since the distance between a <dig> and a <dig> amounts to  <dig> units, the sum of the distances for the three proteins to all other proteins are a1: 3 + 4 =  <dig> units, a2: 3 + 5 =  <dig> units, and a3: 4 + 5 =  <dig> units. because a <dig> has the shortest distance to all other proteins in the family, it is considered the representative protein. d to account for differences in the automatically generated phylogenetic tree, randomly selected subsets containing 90% of the sequences of a family were resampled  <dig> times. the protein that was selected in these subsets most often as the representative was defined as the representative of the family. the majority of representatives were selected more than  <dig> times. black bars represent hmm-based families, grey bars mcl-based families




representatives of lipolytic gos-proteins were tested for activity in the lab
to test the validity of those representatives, we decided to test the representatives of families matching hmms of well-characterized lipolytic protein families. lipolytic enzymes such as lipases and esterases constitute an important group of biocatalysts for biotechnological applications  <cit> . we therefore identified carboxylic ester hydrolases family  proteins from the uniprot database with the highest possible annotation score of  <dig>  after excluding enzymes from potentially pathogenic organisms, we singled out  <dig> individual proteins, which we then could match, based on homology to four of our families .table  <dig> representatives of families matching hmms of well-characterized lipolytic proteins

fumefam011958/gos54
fumefam010194/gos55
fumefam018084/gos88
fumefam012527/gos89
reviewed amino acid sequences with the maximal annotation score of  <dig> and bacterial origin were downloaded from uniprot  <cit> . based on matching hmms from pfam  we determined the  <dig> protein families with the highest homology to the well-characterized proteins from uniprot




we synthesized codon-optimized genes for the representatives of these  <dig> families and cloned them into an iptg-inducible escherichia coli expression vector. we then transformed these plasmids into e. coli and screened for lipolytic activity using plate-based activity assays. as a positive control, we decided to use lipa, a well-characterized lipase from bacillus subtilis. one of these proteins, gos <dig> showed activity on a tributyrin plate, producing a clear halo around the clone, similar to the lipa positive control, indicating the ability of this enzyme to degrade triglycerides containing short-chained fatty acids . a triolein-based plate assay showed also activity, albeit to a lesser extent . we could verify this activity and gos54’s preference for short-chained fatty acid esters in an activity assay using p-np esters of butyrate and palmitate as substrates . this indicated to us that gos <dig> is indeed a lipolytic enzyme and that we can use our representative approach to determine the function of protein classes in the gos dataset.fig.  <dig> screening of selected representatives for lipolytic activity. a strains containing empty vector  serving as negative control and expressing lipase a from bacillus subtilis serving as positive control, as well as representatives for families fumefam <dig> , fumefam <dig> , fumefam <dig> , and fumefam <dig>  were cultivated on lb agar plates containing 1% tributyrin. clear halos around the colonies indicate lipolytic activity. b the same strains on agar plates containing 1% triolein and  <dig> % rhodamin b. colonies show orange fluorescence under uv light in the presence of lipolytic activity. all plates were incubated for 2 days at 37 °c. c-d lipolytic activity of crude extracts from these strains.  <dig> biological replicates were tested. crude extract of e. coli expressing lipase a from bacillus subtilis was set to 100% activity. c crude extract of strains expressing gos <dig> was three times more active against pnp-butyrate than lipase a. d in contrast, gos <dig> was less active against pnp-palmitate as substrate. e substrate conversion over time was measured continuously over 20 min at 405 nm. e. coli with empty pcc vector served as a negative control . heterologously expressed lipase a from b. subtilis served as positive control . substrate was added as indicated by an arrow. gos <dig> hydrolyzes both pnp-butyrate and pnp-palmitate, but prefers the shorter chain-length substrate




discussion
the functional annotation of proteins from metagenomic datasets is challenging. one approach is the distribution of proteins into families based on homology to already known protein families. using this approach, truly new protein families cannot be discovered. the discovery of novel families unique to the tested dataset can be achieved by a de novo definition of protein families. a de novo definition is typically based on homology of proteins in the data set and computationally substantially slower than an approach based on known hmms. we therefore decided to use a hybrid approach, assigning families in the gos metagenomic dataset based on hmms of known protein families, where possible . from the remaining proteins that did not contain any known hmms, we defined protein families using a markov clustering approach  <cit> . categorization of the gos dataset based on hmms and using the cd-hit algorithm  <cit>  has been successfully performed before  <cit> , but the resulting data is currently unavailable. the use of the more precise mcl algorithm allowed us to create hmms based on a substantial number of our de novo-defined families.fig.  <dig> flow diagram of the classification of proteins of the gos dataset into families and representatives. first, all protein sequences were annotated using hmm-profiles obtained from pfam and tigrfams. proteins that did not match hmms with scores below the selected threshold were clustered de novo using mcl. resulting mcl-based classes of small size were excluded. for each hmm-based and mcl-based family that contained sufficient complete sequences, a representative was defined. in this way  <dig>  representatives standing in for  <dig> , <dig> proteins were assigned. this set of representatives can then be used to create a custom expression library, which can be screened for a desired target activity




based on the assumption that high homology correlates with an identical function, it should be possible to test just one protein of a family to deduce the function of all members of this family. to define a protein that represents a family in the best way possible, we devised an algorithm that determines the protein with the closest phylogenetic relationship to all other proteins in the family. this determination is based on a phylogenetic tree in which we determine the phylogenetic distance between all members and select the member with the shortest sum of distances to all other members. a similar approach has been used in the combrex project  <cit> . in this way, we could reduce  <dig> , <dig> proteins that were assigned to families to  <dig>  representatives.  <dig> , <dig> proteins are not represented by a representative, either because they were not assigned to a family or because their family contained only incomplete protein sequences. the families, their members and representatives are summarized in additional file  <dig> 

as a proof of concept of the representative approach we then tested representatives of four families for lipase activity. we selected these representatives based on their homology to well-characterized lipases, because these lipid-degrading enzymes are one of the most commonly used biocatalysts  <cit> . one representative showed esterase/lipase activity, attesting the usefulness of the representatives approach.

CONCLUSIONS
here we present a workflow to categorize large metagenomic datasets into protein families. proteins homologous to known protein families are categorized based on publicly available hmms. the residual proteins, which do not show homology to known protein families could be categorized de novo. we devised a new algorithm to select one representative from each protein family, which can then be functionally tested in the wet lab. using representatives from lipolytic families we could verify our approach, discovering the novel esterase gos <dig> 

