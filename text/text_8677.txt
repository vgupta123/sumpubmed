BACKGROUND
in the past decade microarray technology has become a popular tool for identifying differentially expressed genes  associated with a given phenotype or sample classification. the biological interpretation of transcriptomic changes is commonly revealed by gene function annotation enrichment analysis based on a list of statistically selected degs. it is also called as individual gene analysis  by nam  <cit> . however, since only the most significant portion of degs was taken into account, the small set of genes might not perfectly represent the whole transcriptomic changes  <cit> . indeed, pan et al. showed that the selections of degs significantly affected the iga results  <cit> . in addition, iga usually tests functional changes by annotation enrichment methods such as hypergeometric test. these algorithms equally count each deg so that the significance levels of gene-phenotype correlation are flattened  <cit> .

recently, gene set-based approaches have been proposed to overcome the drawbacks of iga  <cit> . in principle, these approaches measure the gene-phenotype correlations  of every gene in a predefined gene set , usually according to the gene ontology  categories or the sets of genes representing biological pathways in the cell, and then give a gs score to represent its changes associated with the phenotype  <cit> . the statistical significance of the gs score can be determined by two different null hypotheses: competitive  and self-contained . in q <dig> test, it assumes the genes in a gene set have the same level of association with the phenotype compared with the rest of the genes; in q <dig> test, it assumes no gene in the gene set is associated with the phenotype. although the gene set-based approaches are promising in deriving new information, their limitations and the underlying hypotheses have been discussed intensively. for example, q <dig> approaches are very sensitive to correlation structure in gene sets that tend to give false positives  <cit> . q <dig> approaches have low power of detection in highly varying samples such as clinical data sets  <cit> . moreover, in q <dig> test, it can be detected as significant by chance when the size of the gene set is large. another approach, called gene set enrichment analysis , which is a combination of two hypotheses  has become one of the most mentioned and used gene set-based approaches  <cit> . however, a series of reports have also shown that gsea inherited the limitations from both null hypotheses  <cit> .

although many gene set-based approaches and gene-based approaches have been developed, all of them are based on the same rationale, i.e., the detection of gene-phenotype correlation . this rationale is based on the assumption that samples with the same phenotypic change are homogenous and their gene expressions are correlated with their phenotypes. such assumption is quite applicable for many cases, such as treatment versus control cell culture studies, but perhaps not always suitable for heterogeneous clinical samples, such as tumors versus normal tissues. tumors are usually defined according to their common morphological and functional characteristics, such as abnormal growth, immortality, invasion etc. however, it is known that tumors have heterogeneous gene expression level even though they originated from the same tissue type and stage. this heterogeneity implies that those common characteristics could be regulated by various mechanisms. thus, the functional changes might not be revealed by gene-phenotype correlation tests, and most gene-/gene set-based approaches based on this rationale cannot be applied on such data sets.

here, we propose a novel method, called regulatory event-based gene set analysis , to evaluate the significantly changed functions or pathways from diverse genomic data sets. egsa is not based on the gene-phenotype correlations, but rather on gene expression regulatory events which are determined by comparing each gene expression level with the corresponding reference data set . total regulatory events in a given gene set  are counted as a gs score and then the significance of gs is tested by q <dig> null hypothesis using hypergeometric test. comparing with the approaches based on gene-phenotype correlation, we show in this study that egsa can successfully derive new functional information from gene expression profiles that are very heterogeneous in nature.

RESULTS
heterogeneity of tumor transcriptome
we collected six independent microarray data sets from two public archives  to demonstrate the heterogeneity of tumor samples. we measured sample heterogeneity by calculating the average pearson dissimilarity distance between paired samples within a sample type . we found that most tumor samples , including hepatocellular carcinoma , lung and colon tumors, were more heterogeneous than normal and precancerous tissues. even for the most initial stage of hcc , the sample heterogeneity is significantly higher than that of normal livers  or pre-cancer samples . we further used multidimensional scaling , a dimensional reduction algorithm  <cit> , to visualize the heterogeneity of tumor samples. the distance in mds plot represents the degree of pearson dissimilarity among samples. when transcriptomes of samples are similar , the samples will be closely clustered. in hcc <dig> data set , four types of non-tumor samples  are distinctly distributed in the mds plot , and those samples are closely clustered according to their clinical type. however, such clustering was not seen in hcc samples .

the limitation of gene-phenotype approaches on tumor samples
the biological interpretations of microarray experiments are often performed by gene- or gene set-based approaches according to the gene-phenotype correlations. however, such correlation is barely detectable in heterogeneous genomics data sets  so that the detection power of either approach is decreased. to illustrate the influence of sample heterogeneity on data analysis, we selected data sets from three different liver pathological stages  to present the different levels of transcriptomic changes and heterogeneity. six samples of each stage were compared with six normal liver samples to identify changes in gene expression. as shown in figure 3f, the transcriptomic changes increase along with the hcc progression. sva have the greatest changes from normal liver , indicating many genes are de-regulated. the other early stages have relatively small changes and the change levels of sci and sve are similar .

the transcriptomes of cirrhosis samples  are homogeneous and their transcriptome profiles  as well as that of normal livers  are closely self-clustered in mds plot . both very early hcc  and very advanced hcc samples  are heterogeneous and their transcriptome profiles are dispersed . we also added an extreme case,  <dig> normal liver and  <dig> normal spleen samples in the analysis. the gene expression patterns of normal tissues are tightly controlled by tissue-specific regulation. the high homogeneity is shown in figure 2c and ¤ in figure 2a. a huge transcriptome difference  can be detected between the two tissue types.

to estimate background variations for each data set, we compared the t-distributions of these four data sets  with their corresponding null data sets , which have the same sample number but their gene signals were randomly sampled from normal distribution . in such comparison, heavier tail distribution indicates more genes have significant gene-phenotype correlations, i.e., data sets with heavy tails are more readily being analyzed by conventional t value-based methods. as an extreme case, sts showed the most heavy tail distributions  among all tested data sets. we then compared two data sets with similar transcriptomic change level . the tail distributions of sci  are heavier than those of sve . even in sva , which contains over 2-fold dissimilarity than sci , the tail distributions  were still smaller than those of sci . the variation of t value is less informative in heterogeneous data sets. classical approaches are therefore more applicable to homogenous data sets, but not heterogeneous ones .

in iga, the function annotation enrichment analysis is based on the most significant de-regulated genes . these genes are selected from both ends of the t-statistic distribution, which are the most informative regions. hence, iga is expected to be a sensitive method for heterogeneous samples. however, de-regulated genes can barely be identified from heterogeneous and mild-changed samples, such as sve . the selection of thresholds presents researchers with the dilemma of obtaining accurate interpretations but only few significant degs or obtaining more degs by reducing selection threshold  to expand the scope of analysis.

in gene set-based analysis , the gs score, which is summarized from gene-phenotype correlations of all members in a gene set, is used to estimate functional changes . because gsa bypasses the threshold selection step, it can avoid the dilemma mentioned above. however, we wondered if such algorithms, based on the gene-phenotype correlation, also decrease their detection power in heterogeneous samples. we calculated the average t-statistic for each gene set  to get gs scores. the increasing or decreasing of gs score represents the degree of gene set correlation with phenotype. we compared scores distribution of all data sets in figure 3e. sts shows the most significant gs score variation , which represents the obvious function difference between liver and spleen. the score variations of sci, sve and sva are much smaller than sts since they have similar tissue background when compared with reference samples, the normal liver. although sci has the smallest transcriptomic changes , sci shows a more significant gs score variation  than the other data sets do . the result implies that the heterogeneity of tumor samples reduces the detection power of gsa too.

threshold insensitivity and robustness of egsa
recognizing the limitations of current gene- or gene set-based methods on heterogeneous samples, we alternatively analyzed transcriptomic changes by using regulatory events. regulatory event is defined as a gene signal change of a test sample compared with a reference sample pool . the distribution of regulatory event frequency in all data sets is clearly distinguishable from null data sets  and the gradual increasing of tail distributions correlates with their transcriptomic change levels . this result implies regulatory event is a better approach for analyzing heterogeneous samples. based on this observation, we designed a novel regulatory event-based strategy, which we called the regulatory event-based gene set analysis , for the exploration of significant gene sets and compensate for the insufficiency of traditional method in heterogeneous samples.

one might argue that the regulatory event determination is still under an arbitrary cut-off threshold and its results also suffer from the same dilemma of threshold selection as iga does. this argument can be partially answered by the insensitivity of regulatory event detection in different threshold values . the number of differentially expressed genes  is sensitive to the threshold selection and is dramatically decreased when a stringent threshold is applied. under a strict threshold ,  <dig> genes could be detected in homogenous data set . however, only a few differentially expressed genes could be detected in heterogeneous data sets . in contrast, even under the most stringent threshold in our test , thousands of regulatory events could be detected robustly. moreover, the event numbers of those data sets also correlated with the level of transcriptomic changes .

the threshold insensitivity of regulatory event detection also reflects the robustness of egsa. we selected the lipid metabolic process  category in the go databases as an example because both liver cirrhosis and carcinogenesis cause the defective lipid metabolism  <cit> . obvious down-regulation of this functional category is expected in all sci, sve and sva data sets . in iga, hypergeometric test p-values increase heavily toward the background values of the opposite regulation when higher threshold stringency was used in heterogeneous data set . iga even loses the detection power due to no annotated de-regulated genes . although the homogeneous data set, sci, showed higher tolerance to stringent thresholds, the p-values appeared unstable when different thresholds were selected . nevertheless, in egsa the p-values are more stable in both homogeneous and heterogeneous data set  and could be distinguished from the background values in all tested threshold values. conclusively, measuring regulatory events is insensitive to threshold selection and can be performed more robustly in hypergeometric test.

precise and broad biological interpretation of transcriptomechanges by egsa
we further compared the accuracy and analysis scope between egsa and iga. using  <dig> gene sets defined by go terms, we calculated the significance levels of gene sets based on the up-regulated genes or regulatory events. to make these two results comparable, we ranked gene sets by their p-values and then present their ranking orders in a scatter plot . for every gene set, we also calculated the ratio of up-regulated regulatory events over the total regulatory events within the gene set to indicate their regulatory directions.

in sts, the most distinctive data set , the ranking orders of gene set are highly correlated between egsa and iga , suggesting that egsa has comparable detection power to that of iga in homogeneous samples. this is due to the fact that most of the consistent gene regulations in sts can be detected by both strategies. in sve, the most indistinctive data set , the top- and bottom-ranked gene sets of iga and egsa are correlated and are aligned in the diagonal corners . this is because these gene sets represent the most consistent changes. however, egsa detected more up-regulatory gene sets that were under-estimated  or missed  by iga. this data demonstrates that egsa has a broader scope of analysis than iga. moreover, several down-regulated gss  are misidentified as up-regulated gss by iga .

we selected two extremely contradictory gene sets to demonstrate the different preferences between these two methods. the first gene set, the regulation of signal transduction , is highly-ranked in egsa  but not in iga . the second gene set, the amino acid metabolic process , is highly ranked in iga  but not in egsa . the details of both gene sets, including their differentially expressed genes, regulatory events and signal values, are shown in figure 5c and 5d. in the first gene set, regulatory event-based analysis shows that 20% of genes ) are up-regulated, which is in agreement with the observation in sample signal values. however, only 4% up-regulatory de-regulated genes can be detected due to the lack of consistency in gene expression level . this also suggests that iga may sometimes under-estimate the significance of a gene set. in the second gs, iga detects a certain number of consistently up-regulatory de-regulated genes and conclude this gene set as a significantly up-regulated one . but this doesn't perfectly present the fact that there are actually more down-regulatory  than up-regulatory  expression changes in this gene set . we conclude that for heterogeneous samples, since egsa takes into account all res in a gene set, this novel strategy can overcome certain limitations of iga.

functional patterns of very early hcc
to demonstrate the advantage of egsa, we applied egsa on the discovery of biological functions associated with liver cancer tumorigenesis. hepatocellular carcinoma  is characterized as an obvious multistage process, just like many other types of human tumors. understanding the de-regulated biological functions in early stage hcc will help to reveal the initial processes of hepatocarcinogenesis. the insights of early hcc functional changes and regulatory mechanisms are far from clear due to the lack of common oncogenes and tumor suppressors. one of the major difficulties in identifying common regulatory mechanisms is the genetic heterogeneity of hccs  <cit> . to overcome this heterogeneity issue, we applied egsa on the analysis of the initial functional changes of hcv-induced hccs   <cit> .

in the original paper of hcc <dig> only  <dig> differentially expressed genes were identified when dysplasia samples  were compared to early hccs   <cit> . the authors interpreted the biological function of early hcc based on gene functional classification. as a result, only a few gene sets were analyzed and their statistical significance had not been estimated yet. to provide a more comprehensive view on the initial processes of hepatocarcinogenesis, we applied egsa on the earliest stage of hccs . owing to the insensitivity of egsa to transcriptomic heterogeneity, we can now identify more altered biological functions with statistical significance in very early hcc. to avoid potential errors from name-space issues  <cit> , we carefully removed the gene sets containing high percentage of duplicative genes . the filtered gene sets were functionally clustered into branches of an acyclic network according to their go term relationships . the gs ranking orders are presented in a color scale . the top  <dig> up- or down-regulated gene sets are listed in additional file  <dig> 

in the egsa results, the major functional changes are basically consistent with the original observations and previous descriptions on hcc  <cit> . moreover, egsa provides new insights into the initial processes of hcc. gene sets related to major hepatic metabolisms, including cholesterol, steroid, hormone and amino acid metabolisms, are significantly down-regulated . the down-regulation of these biological functions may be due to the failure of normal hepatic functions. on the contrary, nucleoside and protein metabolisms required for rapid cell growth are significantly up-regulated. these include pyrimidine nucleoside metabolism , ubiquitin-mediated protein degradation , trna aminoacrylation  and ribosome biogenesis and assembly  .

the down-regulation of lipid metabolisms has been frequently reported in liver diseases  <cit> . in the initial stage, fatty acid metabolism , steroid biosynthesis  and sterol related metabolisms, e.g. hormone metabolism , are all down regulated since several common enzymes are shared within these metabolic processes . although lacking a consistent conclusion, several studies did report that a sterol hormone, androgen, was associated with hcc development: high level serum androgen was found as risk factor for hcc  <cit> , and androgen receptor has also been reported to promote cell growth and anti-apoptosis in hepatic cell line model  <cit> . hence, the linkages between the down-regulations of sterol metabolisms and the abnormal hormone metabolisms, and their effects on hcc initiation could be interesting and worthy of further study.

escaping and surviving from attacks by the immune system are two other significant functional changes in hcc initiation. certain immune functions, such as the inflammatory response , innate immune response  and immune effector process , are down-regulated while the survival pathway, the regulations of iκkb/nfκb cascade  <cit>  , is up-regulated . these observations are supported by many studies. for example, the number of different types of inflammatory cells are decreased in hcc tissue sections  <cit> ; the suppression of t cell-mediated immune responses is found in hcc patients and is associated with poor prognosis  <cit> . to understand the regulatory mechanisms, we analyzed the biological pathways involved in those immune-related gene sets. genes with high regulatory event frequency  were annotated with their involved kegg pathways  <cit> , and the most annotated pathways are listed in additional file  <dig>  several biological signaling pathways are highlighted, including the toll-like receptor, jak-stat, mapk and t cell receptor signaling pathway. besides, a number of immune-related processes are also highlighted, such as the cell adhesion molecules, cytokine-cytokine receptors, antigen-processing and presentation, and nk cell mediated cytotoxicity .

it is not surprising that cell cycle is up-regulated at the initial stage of hcc. however, in an advanced comparison of cell cycle phases, we identified that m phase  is the most significant phase over g <dig>  and s . m phase related gene sets, such as regulation of mitosis  and mitotic cell cycle checkpoint , are both significantly up-regulated . to further illustrate the early changes of m phase regulation, we mapped the up-regulated regulatory event frequencies of four stages  on a kegg cell cycle pathway . as shown in figure  <dig>  most g2/m key regulators  are up-regulated at the first stage . these genes appear earlier than many g1/s key regulators  . the early up-regulation of g2/m phase can also be supported by the appearance of the corresponding down-stream genes. for example, the regulators of mitosis and chromosome segregation  were frequently up-regulated at the first stage, while the regulators of dna replication  are up-regulated only at the later stages . in another sample set , although lacking in stage information, we still found that these g1/m regulators were more frequently and synchronously up-regulated . on the contrary, g1/s regulators, which are accompanied by dna synthesis, are seldom found . our findings are consistent with the previous protein and kinase activity studies. the enhancement of ccna/cdk <dig> protein expression and kinase activity are observed in early hcc stage and non-tumorous cirrhosis tissues, but not in normal livers. g1/s regulators, ccnd <dig>  ccne <dig> and cdk <dig>  are higher in poorly differentiated hcc and advanced hccs  <cit> .

ccna <dig> is considered as an important factor leading to cancer because of its dual roles in both s and m phase  <cit> . the increased expressions of ccna <dig> mrna and protein were observed in many clinical hcc studies  <cit> . however, in cell model experiments, over-expression of ccna <dig> alone could not promote cell cycle but delayed metaphase/anaphase onset  <cit> . these findings suggest that the high expression of ccna <dig> might simply reflect high tumor proliferation rate rather than promote tumorigenesis  <cit> .

in our study, ccna <dig> appears as a most frequent and earliest up-regulated cyclin at the initial stage. this strongly suggests that ccna <dig> might play a crucial role in hcc initiation. accompanying ccna <dig>  several mitosis-related regulators, such as cdc <dig>  ccnb1/ <dig> and cdc <dig>  are synchronically up-regulated , indicating that all these mitosis genes are also required for hcc initiation. however, previous individual gene studies did not test the gene combination . besides, an interesting supportive mechanism, the up-regulation of ubiquitin mediated proteolysis activity , could also potentially contribute to the rapid turn-over of cyclin and other mitosis components, and then help to complete the cell cycle .

CONCLUSIONS
the common transcriptomic heterogeneity of tumor reduces the detection power of gene-list or gene-set analysis to identify functional patterns of transcriptome profiles. we developed egsa, a novel method based on regulatory events, to overcome such limitations. egsa is insensitive to threshold bias and can provide more robust and precise results than iga. these properties make egsa an excellent approach to analyze complex tumor transcriptome profiles.

egsa overlooks the highly heterogeneous regulatory mechanisms and directly targets the question "what happened on cellular functions?". once functional issues are addressed, the regulatory event frequency can be applied to highlight potential regulatory routines in the gene network and to present their prevalent regulatory mechanisms. the identification of these regulatory routines will greatly accelerate the development of pharmaceutical targeting strategies and personalized therapy.

along with this study, we also noticed a few limitations of egsa. first, the determination of regulatory events is heavily dependent on a stable and highly correlated reference pool. this requirement cannot always be met in many cases, such as the comparison between two heterogeneous sample types. second, the biological interpretation of egsa relies heavily on the definition and composition of a gene set. several unsolved problems, such as name-space issues, imprecise or incorrect annotations, will interfere with egsa results. it still lacks an optimization process to avoid these problems so far. finally, like most gene set-based analysis, egsa counts the contribution of each gene in biological regulations equally. this equality is not always true in a cell because certain genes are more crucial in changing the whole cellular function than others. hence, an advanced weighting algorithm of gene set definition remains to be developed for more precise biological function interpretation.

