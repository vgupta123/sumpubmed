BACKGROUND
in human health research microarray comparative genomic hybridization  has become a powerful technique to investigate dna copy number variants  in healthy subjects  <cit>  and genomic aberrations associated with various diseases and syndromes  <cit> . furthermore, cgh is now frequently used to analyze the genome of strains of interest in various model organisms  <cit> . on some oligonucleotide microarray platforms individual researchers can design their own specialized microarrays for very specific experiments. basically, the only crucial requirement before starting to design an array is to have access to a sequenced reference genome for the species under investigation. the first task facing a biologist trying to design a cgh microarray is to design criteria to eliminate oligonucleotides with particular properties that are expected to reduce the data quality. some design criteria have been suggested and used for several years with little or no large-scale experimental validation  <cit> . large-scale studies of the effects of various oligonucleotide properties on microarray data quality are just starting to be published  <cit>  but few of them are designed to investigate the two-colour scheme typically used in cgh experiments. most of these studies are concerned with the human genome but it would be useful to know if some design criteria could be relaxed for smaller and less complex genomes and in general what kind of penalty one has to pay in terms of data quality when relaxing constraints on specific oligonucleotide properties.

in our research we are particularly interested in using oligonucleotide microarray cgh to detect induced deletions in the c. elegans genome  <cit> . we designed our own microarray chips but our criteria for oligonucleotide selection were arbitrary and relied more on empirical observation, that is the data quality was adequate for the task  <cit> , and was not based on experimentally testing various oligonucleotide features. optimal design criteria are expected to depend on the hybridization conditions and possibly on the complexity of the genome under investigation. in the current publication we report our findings on the effects of varying the oligonucleotide design criteria and how these alterations affect our ability to detect deletions in both the c. elegans and human genomes. considering the differences in size and complexity of these two genomes the design properties we recommend here should be applicable to many organisms with a sequenced genome provided that the hybridization conditions are not drastically different from those used in our experiments.

RESULTS
effects of various oligonucleotide properties on resolving power
the concept of resolving power we use here was introduced in a software evaluation study  <cit> . it is a useful tool to detect and quantify small variations in overall data quality when changes are made to the oligonucleotide selection process or the data analysis procedure, or even when comparing different array platforms. briefly, using the experimental distributions of the data points in the so-called normal regions and in the regions with copy number aberrations it is possible to estimate the expected p-value associated with the detection of a typical aberrant dna segment covered by a given number of probes. in the current work, the resolving power in c. elegans has been evaluated with the help of two strains with large heterozygous deletions previously found in cgh experiments  <cit> . as a human sample, a pool of male dna has been compared by cgh to a pool of female dna so that probes targeting the x chromosome could be associated with a one-copy loss in the male sample. details of the microarray design for both the human and c. elegans experiments can be found in the methods section. briefly, for both normal and deleted regions we had probes manufactured of length  <dig>   <dig>  and  <dig> nucleotides. we also used a so-called isothermal design where the oligonucleotide length is varied in an attempt to obtain an approximately constant melting temperature. the only significant constraints applied on the oligonucleotides at the design stage were the exclusion of known repeats and for the human chip the elimination of segments with known cnvs and single nucleotide polymorphisms . microarrays with shorter oligonucleotides, for example 25-mers in the case of the affymetrix platform  <cit> , can also be used to infer cnvs  <cit>  but their optimization  <cit>  is associated with different issues than longer oligonucleotide arrays and therefore they will not be considered in the current study.

each filter on oligonucleotide properties can be turned on and off independently before calculating the resolving power, except of course for the elimination of repeat sequences, which has been already applied to all the oligonucleotides present on the arrays. the effect of repeat sequences cannot be studied in the current work but this is not a significant limitation. it is true that in some cases it is possible to find sequences that are fairly unique within repeat regions, which might be of interest for some experiments especially in mammalian genomes  <cit> . however, at least in c. elegans we noticed that the cgh log2ratio signal tends to be somewhat unreliable with more non-zero bias near repeats. this type of alteration in signal is also often observed just outside deletions  <cit> . the individual effect of each of our oligonucleotide filters on resolving power is shown is figure  <dig> for both human and c. elegans one-copy deletions detected using 50-mer oligonucleotides. the effect of each filter on the resolving power is virtually identical when using oligonucleotides of length  <dig>   <dig>   <dig>  or with an isothermal design . as previously mentioned, the slope in resolving power is roughly twice as steep for c. elegans than human data, and this is also true when individual filters are applied. for the most part, each filter produces a similar gain in resolving power for both human and c. elegans data except perhaps for the elimination of non-unique 20-mers which is more effective in human than c. elegans. however, the elimination of non-unique 20-mers is obviously a more restrictive design constraint in human than c. elegans as it eliminates 59% of all the oligonucleotides on the array compared to only 20% in the c. elegans case .

it is of course possible to modify the parameters of some of our standard filters and measure the effect on the resolving power. figure  <dig> shows the effects of changing the constraints on the self-folding energy, on the length of the longest homopolymer, on the 15-mer count and on the melting temperature both for human and c. elegans data obtained with 50-mer probes. once again, the trends are very similar for human and c. elegans and for all the oligonucleotide lengths present on the arrays. as can be seen in panel a our standard use of a self-energy threshold of - <dig> kcal/mol seems optimal while panel b suggests that our standard ceiling of  <dig> for the longest homopolymer is certainly acceptable. in both human and c. elegans examples the vast majority of homopolymers are polya and polyt tracts with much fewer polyc and polyg tracts so our results are basically measurements of the effect of having polya and polyt present in a 50-mer probe. in contrast to what has been implied in a previous publication  <cit> , the presence of polya and polyt reduces the performance of our probes when attempting to detect deletions. however, since polya/polyt tracts are much more frequent than polyc/polyg tracts, selecting probes with longer homopolymers tends to reduce the average gc content within the probes and therefore the average melting temperature. in order to disentangle the melting temperature and homopolymer effects we have performed another resolving power calculation but this time at a fixed melting temperature and our conclusion is still valid, the presence of long homopolymers tends to deteriorate the performance of a probe. as can be seen in panel c of figure  <dig> filtering the probes according to their 15-mer count is a very efficient way to directly control their performance. for example, when calculating the ratio of the resolving power slopes for probes belonging to the bottom and top 10% in 15-count one obtains  <dig>  for c. elegans and  <dig>  for human. finally, panel d demonstrates that our standard range of  <dig> degrees in melting temperature is an adequate filter and reducing the width of that window only marginally improve the data quality to detect deletions. this is in contradiction with what has been previously reported for general copy-number measurements in human samples  <cit> . as demonstrated in previous work  <cit> , oligonucleotides with higher melting temperature tend to produce higher overall fluorescence intensities. however, the use of a two-colour cgh scheme coupled with our data analysis procedure appears to eliminate the need for a very uniform melting temperature design. the formula we used to calculate the melting temperature is identical to that used in reference  <cit>  with only a small difference in one of the parameters, which cannot affect our conclusion for oligonucleotides of fixed length. we have repeated the resolving power analysis but this time with a melting temperature calculation based on a nearest neighbour approach  <cit>  and once again we see only a marginal improvement in data quality when reducing the width of the window in melting temperature .

as previously mentioned and illustrated in figure  <dig> panel a, the trends we observed for the resolving power are very similar for oligonucleotides of length  <dig>   <dig>   <dig> and our isothermal design. a very small gain in performance is observed for longer probes but as can be deduced from panel b of figure  <dig> the majority of that gain is probably due to the fact that longer probes tends to have higher melting temperature.

sequence similarity
in order to quantify the best design practices with regard to minimizing potential non-specific hybridization we have introduced a series of perturbations on a pre-selected number of oligonucleotides, see methods section for details. basically, two different kinds of sequence similarity have to be considered, either the presence of a stretch of perfect identity of a given length within the oligonucleotide or a given similarity level over the whole oligonucleotide.

the red boxplot in figure  <dig> shows the difference in fluorescence intensity one is expected to observe between a 50-mer oligonucleotide mapping perfectly to the c. elegans genome and a random 50-mer oligonucleotide with the same gc content. this is the basis for comparison and oligonucleotides with sequence identity associated with a smaller difference in intensity present some level of cross-hybridization. as can be seen from the green boxplots in figure  <dig>  a stretch of perfect identity of length of about  <dig> and above in the middle of the oligonucleotide will produce some level of cross-hybridization, and of course the longer the perfectly matched sequence is the worst the effect will be on the performance of the oligonucleotide. the elimination of non-unique  <dig> mers in our standard filters seems therefore a little too conservative. however, as can be seen in figure  <dig>  the position of the stretch of perfect identity within the oligonucleotide is important. presumably due to steric effects, a stretch of perfect identity close to the slide will produce less cross-hybridization problems than a perfect stretch of identical length located at the other end of the oligonucleotide. for example, in c. elegans a perfect match of length  <dig> in the middle of the oligonucleotide will introduce similar cross-hybridization noise as a perfect match of length  <dig> close to the slide or length  <dig> at the end away from the slide. in fact, a perfect match of length  <dig> at the end away from the slide will produce a measurable fluorescence intensity above background so our standard elimination of non-unique  <dig> mers is justifiable in these instances. similar positional effects are manifest in our human data set, except that the overall amplitude of the intensity difference between original and perturbed oligonucleotides is smaller. this is because the human data is noisier and spans a smaller dynamical range. this effect is compatible with the asymmetry previously reported for experiments performed with one-colour hybridization scheme on nimblegen microarrays  <cit> . furthermore, such asymmetry could explain the difference in performance sometimes observed  <cit>  between oligonucleotides designed following the plus and minus strand templates at a given genomic location.

as expected, for c. elegans the presence of a perfect stretch of identity of a given length will produce a higher level of cross-hybridization for shorter oligonucleotides. for example, as can be seen in figure  <dig>  a perfect stretch of length  <dig> in the middle of a 60-mer oligonucleotide will produce the same intensity perturbation as a perfect stretch of length  <dig> in the middle of a 50-mer oligonucleotide, or a perfect stretch of length  <dig> in the middle of a 70-mer oligonucleotide. figure  <dig> also shows that such a trend is not quite as obvious in the human case, in particular, very little difference is seen between the curves for 60- and 70-mer oligonucleotides. it should be noted that the recommendation  <cit>  of eliminating non-unique  <dig> mers within oligonucleotides of length  <dig> is too conservative with our hybridization conditions. this is fortunate because basically no oligonucleotides would pass such a constraint for cgh in large genomes. however, as already mentioned, minimizing the 15-mer count of oligonucleotides is recommended to improve the resolving power.

oligonucleotide design recommendations
several constraints can be applied on oligonucleotide properties to improve the data quality but one should keep in mind that our design recommendations summarized in this section could easily be relaxed to improve coverage in specific genomic regions and still get useful information from the resulting data. in the current work we have only studied one-copy deletions but we expect that oligonucleotide design criteria improving the resolving power for detection of deletions should also improve the resolving power for detecting copy number gains. however, we cannot really infer that our design recommendations are necessarily optimal for experiments attempting to measure precise copy numbers where large copy numbers are expected.

we observed very little difference in data quality when varying the oligonucleotide length between  <dig>   <dig>   <dig>  and even when using a so-called isothermal design where the length of each oligonucleotide varies between  <dig> and  <dig> in an attempt to minimize the overall width of the melting temperature distribution. oligonucleotides of fixed length are simpler to work with at the design stage and it is easier to avoid unwanted genomic regions with shorter oligonucleotides. even if only for convenience we will continue to use 50-mer oligonucleotides in our own research projects and suggest that oligonucleotides of this length will suffice for most other projects.

our results demonstrate that filtering potential oligonucleotide probes according to their 15-mer count is probably the most effective way to control probe quality. in the current work repeat sequences have been eliminated right from the start and we therefore do not have a direct measurement of their effect on data quality. however, considering the effect of the 15-mer count above it is safe to assume that most types of repeats should be excluded from most cgh array designs. the quality of the data can be improved by considering the oligonucleotides self-folding tendency and the presence of homopolymers; a self-energy threshold of - <dig> kcal/mol seems optimal and the elimination of oligonucleotides with homopolymers longer than  <dig> is probably adequate in most situations. only small gain in data quality is achieved by restricting the oligonucleotides melting temperature and using a relatively wide window of 10°c centered on the median value seems an acceptable compromise between data quality and coverage.

two types of sequence similarity with multiple genomic regions have been investigated, the presence of a perfect identity over a fraction of the probe and the similarity over the whole length of the probe. our elimination of non-unique  <dig> mers within the genome when designing oligonucleotides is conservative and is really only justified when the 20-mer is located at the end away from the slide in a 50-mer probe. a stretch of perfect identity of length  <dig> in the middle of a 50-mer probe will produce measurable cross-hybridization. the same is true for a similarity level above about 80% over the full length of a probe. while the constraints on oligonucleotide design described here are good starting points, the optimal constraints to be used to eliminate cross-hybridization from both types of sequence similarity will depend on the genome under investigation and the desired coverage in a given region.

CONCLUSIONS
we have analyzed cgh experiments performed with nimblegen's microarray platform in order to assess the relationships between various oligonucleotide properties and the quality of the data as measured by the ability to detect deletions in the human and c. elegans genomes. for the most part our microarray design recommendations summarized in the previous section are very similar for both species and they could probably be used without modifications for most other species with a sequenced reference genome. as expected, the larger and more complex human genome is more difficult to study with cgh and a deletion typically needs to affect approximately twice as many probes to achieve the same level of statistical confidence as in c. elegans. all our results were obtained with the nimblegen platform with their standard hybridization protocol and of course our conclusions might not be valid for other microarray platforms or when using different hybridization conditions.

