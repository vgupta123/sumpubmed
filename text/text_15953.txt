BACKGROUND
a grand challenge of biomathematical modeling is the conversion of a biological system into a computational structure that formalizes the underlying system. an important and very challenging component of this process is the estimation of parameter values. the task is typically pursued with one of two generic approaches, namely a forward  or an inverse  method. until recently, essentially all models of metabolic pathway systems were developed according to the first strategy, that is, by characterizing model components and processes one at a time and subsequently merging all “local” information about kinetic reaction steps into one comprehensive dynamic model. although this forward approach is theoretically straightforward, implementation procedures often fail and, moreover, have intrinsic disadvantages  <cit> . for instance, the necessary information is usually obtained in vitro and from different experiments, so that there is no guarantee that it is entirely compatible and consistent.

the second, top-down approach uses data that characterize the entire system and attempts to estimate all parameter values at once with a sophisticated optimization algorithm. specifically, this type of method employs time series data that describe the full dynamic response of a pathway system to some stimulus, such as an environmental stress  or the availability of food . in contrast to the local data obtained from traditional experiments, the great appeal of using these types of “global” data is that most, if not all, measurements are taken from the same biological system under the same conditions. furthermore, these data contain enormous and essentially unadulterated information about the structure, dynamics and regulatory mechanisms that govern the biological system under investigation. the main drawback of top-down approaches is that the actual extraction and integration of this information into fully functional, explanatory models is challenging. in fact, more than one hundred articles addressing this task appeared within the past ten years. they focused on various aspects of the estimation process, but most of them were dedicated to the main issue of optimizing parameter values against the observed time series data .

whether a forward or inverse approach is used, the estimation of parameter values necessitates assumptions regarding the functions or rate laws that describe the reactions of interest. as a prominent example, the typical default for enzymatic reactions in a metabolic pathway is the michaelis-menten rate law  or one of its variations. while such assumptions are understandable, they create an immediate conundrum. namely, the true mechanisms governing a biological process are in reality unknown or at least unclear. as a result, the estimation process is from the start unguided, uncertain, or maybe even based on modestly or entirely wrong assumptions. also, descriptions of more complex enzyme mechanisms contain numerous parameters if several substrates or reactions are involved, so that the alleged functions cannot be identified from the typically sparse data  <cit> .

in addition to the troublesome issue of model selection, most proposed methods for estimation from time series data face significant problems related to the data themselves, to inefficient algorithms, and to a variety of computational issues. to complicate matters further, these issues are usually superimposed. the data may be overly noisy, incomplete, collinear with each other, or non-informative. the computational algorithms are often slow to converge, converge to a locally but not globally optimal solution, or do not converge at all. finally, there is a mathematical issue, especially for systems with many parameters, namely that a system may admit solutions that are distinctly different yet equivalent, or essentially equivalent, with respect to the residual error. this type of result, referred to as sloppiness and unidentifiability, may be due to redundancies in candidate parameter sets and has received much attention in recent times  <cit> .

a different type of sloppiness may be caused by the fact that different model structures may give essentially identical residual errors. for instance, several probability density functions often model the same data equally well  <cit> . moreover, two “wrong” structures or representations within a model may permit compensation of errors between different terms or equations  <cit> . it is not even clear whether the residual error  is always the best metric for the quality of fit  <cit> . for instance, the “best” models in terms of having the smallest sse tend to have too many parameters and therefore encounter over-fitting problems. this issue can be serious, because an over-fitted model often lacks the capacity of extrapolation and predictive power with respect to data not used in the estimation or untested conditions. therefore, it is necessary to develop tools for the evaluation of model validity and quality beyond residual errors. for instance, one should establish criteria to determine the appropriateness of the chosen mathematical representations, develop methods for assessing whether residual errors are due to idiosyncrasies or noise in the data, and develop diagnostic tools of discriminating between valid and invalid model structures.

recently we proposed a novel approach to metabolic systems estimation, called dynamic flux estimation , that ameliorates several of the issues listed above  <cit> . dfe is executed in two distinct phases. the first phase consists of an entirely model-free data analysis that requires minimal assumptions and reveals inconsistencies within the data, and between data and the alleged system topology. generally, the system is represented as a set of ordinary differential equations  so that the instant change in each metabolite  equals the sum of fluxes that enter or leave the metabolite pool:

  dxidt=x˙i=∑influxes−∑effluxes. 

the left-hand side of this ode can be interpreted as the slope of the time course of the variable xi at a given point in time. therefore, assuming that the time series data are more or less complete and smooth—or can be validly smoothed  —one can estimate the slope of the time course at each time point and substitute the slopes for the derivatives. if the system contains n equations, and if data are measured at k time points, this substitution decouples the system of n differential equations into n sets of k algebraic equations each. this system is linear in the fluxes and can be assessed with methods of linear algebra. in particular, it is easily solved at each time point if the system has full rank.

the result of this first phase of dfe is a representation of each flux as a numerically characterized function of time and as a function of all contributing metabolites. this representation is not explicit, but purely numerical and consists of points in plots of flux vs. time or flux vs. metabolites and modulators. the second phase of dfe addresses the mathematical formulation of each process in the biological system by attempting to convert these numerical plots into mathematical representations, such as a michaelis-menten or hill rate law or a power-law description. in contrast to most other methods, where a functional form had to be assumed a priori, this step allows quantitative diagnostics of whether a candidate of a mathematical formulation may be appropriate, at least within certain ranges of the contributing variables. the subsequent determination of parameter values is now much easier, because it involves explicit functions that are addressed one flux at a time.

dfe offers substantial advantages. it makes almost no assumptions and is straightforward if the right data are available. it reveals inconsistencies within the data, avoids compensation among and within equations, and permits quantitative diagnostic tools of whether the assumed mathematical formulations are appropriate or in need of improvement. in addition, since dfe identifies parameters based on explicit single-flux representations, the estimation of parameter values is much easier and more reliable than in other top-down approaches. as a result, dfe promises significantly improved extrapolation capacity toward new data or experimental conditions.

alas, dfe also has limitations and drawbacks. first, it requires more or less complete time series data that characterize the investigated system. these data are still relatively seldom, although they are being generated at an increasing rate and with rapidly improving quality. second, and arguably more limiting, a unique solution of the flux equations in the first phase of dfe is only possible if the flux system is of full rank. however, most actually pathway systems contain more fluxes than metabolites and are therefore underdetermined.

several constraint-based optimization techniques have been proposed for stoichiometric analyses of underdetermined metabolic systems  <cit> . they have become a mainstay of flux balance analysis  and work well under steady-state and pseudo-steady-state  assumptions  <cit> . mahadevan and co-workers  <cit>  extended the traditional fba to account for dynamics and presented two different formulations: the dynamic optimization approach  and the static optimization approach . doa involves optimization over the entire time period to obtain flux profiles over time, while soa involves dividing the batch time into several time intervals and solving the instantaneous optimization problem at the beginning of each time interval. these methods basically are variations of fba and need, for the determination of flux profiles at each time point, constraints and objective functions, which describe some goal the cell aims to reach. for the case of microbial systems, a reasonable objective may be maximization of the growth rate. however, determining an unbiased objective function in a eukaryotic system is often difficult.

in contrast to these methods that require objective functions, we proposed extending dfe with the infusion of additional information  <cit> . we distinguished four cases. first, the connectivity of the systems is not fully known or some of the connections are uncertain. second, some of the time series data were not measured, although it is known how the corresponding metabolites are involved in the pathway. third, the system contains “missing” metabolites which are neither known nor measured, but in actuality affect the system significantly. and fourth, the flux system is underdetermined, even though the time series of all relevant metabolites are measured.

the first issue might be ameliorated by methods developed for structure identification of unknown of ill-characterized pathways. these methods include a wide spectrum of techniques, such as perturbation methods, causality models, correlation-based approaches, or probabilistic models, some of which are based on time series data . the lack of certain data in the second case could be complemented by deducing the unknown time profiles from time series of neighboring metabolites, if the corresponding enzymatic information is available for fluxes producing and degrading a metabolite in the equation. however, this approach of using kinetic information obtained in vitro, or maybe even from different organisms, is naturally problematic due to some degree of bias and uncertainty. a possible solution strategy for the third case is to check the mass balance in the entire system throughout the time period. if significant changes in mass balance are observed, additional biological insight will be needed to check the pathway model and identify possible sources of leakage or gain of mass. if the masses are more or less balanced, it is still possible that important fluxes or metabolites are missing. however, there is currently no obvious defense in this situation. finally, to complement an underdetermined flux system, some of the fluxes need to be estimated with information from other sources. for instance, it might be possible to obtain fluxes directly from experiments, but such data are rare. as an alternative, one may assume the functional form for an enzymatic reaction, and if corresponding kinetic information is available, for instance from brenda  <cit> , parameter values may be estimated for this functional form. as a variation on this strategy, one could assume some canonical model, such as power-law functions  <cit>  or lin-log approximations  <cit> , if some of the variables and fluxes operate within relatively small ranges. clearly, this option runs counter to the model-free nature of dfe, but might be the only feasible solution. instead of using kinetic information, one could also select some of the decoupled equations and use optimization methods to fit the selected model to the time series data .

although we presented proof of concept that the different approaches described above can be used to supplement dfe, these approaches are not always optimal, because they require additional information and assumptions that are a priori not validated. the question thus arises: can we directly squeeze additional information out of the time series data, without the need of further assumptions and additional information? and if so, under what conditions is that possible? providing at least partial answers to these questions is the topic of this article.

specifically, we propose here a distinct approach to supplementing dfe with information hidden in suitable metabolic time series. extracting this information permits the determination of a sufficient subset of fluxes to execute dfe on the rest of the flux system. in contrast to all other solutions presented so far for the complementation of dfe, the method proposed here does not require any assumptions regarding the mathematical representation of the fluxes. furthermore, kinetic information or knowledge of the functional forms of the enzymatic reactions is not required. we will demonstrate in the following that the proposed method can succeed even if some of the time series data are not measured or when there is mass leakage in the pathway systems. in addition, the new method allows us to address a recurring unanswered question, namely how many time series data are needed to estimate the structure and parameters of a system.

specific details of the proposed approach are presented in the methods section. while the methodological details require some technical discussion, the concept of the proposed method may be best explained with the following simple example. suppose a metabolic system contains the equation x˙i=vi+−vi−, which is typical for a reaction between xj and xi, combined with the degradation of xi within a linear section of a pathway system:

  xj→xi→ 

suppose we have time series data, so that we can estimate x˙i for every measured time point with sufficient accuracy. suppose further that the time series data are such that we have m time points  where xi has the same value , whereas xj has a different value at each of these time points. it is reasonable to assume that vi− is a function in a strict mathematical sense, which means that vi− has one unique  value vci. if so, we have m equations of the type x˙i=vi+−vci, where the values of xj and x˙i are known directly from the data and vci always has the same value. using these quantities, the methods proposed here allow us to estimate the functional format of vi+, at least over some pertinent range of xj values. once we know vi+, we can determine vi−. thus, we now have numerically quantified two fluxes, which reduce the discrepancy between the number of equations and the number of independent fluxes. repeated application of the method allows dfe for the entire system. an illustrative vi+ example is shown in methods and other examples are presented in the results. if the function depends on more than one variable, the procedure is the same in concept but more complicated in detail .

methods
the proposed method offers a systematic strategy to extend dfe and to ameliorate its limitations. just like dfe, the proposed method starts with an optional data preprocessing step, but without any assumption regarding the functional formats of the fluxes in the system. first, the experimental data are tested for mass conservation to make sure no mass is lost or gained during the observed time period. if the data do indicate losses or gains in mass, it is useful to locate possible branches off the main pathway and to account for the changes in total mass of the metabolites in the pathway  <cit> . second, the time series data are smoothed as necessary, which makes it easier to estimate the slopes of all time courses at a given number of time points, using different numerical techniques. these established smoothing methods include splines, artificial neural networks, as well as different types of filters, such as the popular kalman, savitzky-golay, whittaker, or eilers filter . in parallel to these data preprocessing steps, the pathway structure  is used to generate a system of symbolic equations describing the dynamics of the system. the generic format for such a representation may be written as

  x˙i=∑vij+−∑vij−,i= <dig> …,n, 

where xi denotes the concentration or amount of a variable or variable pool and n is the total number of time-dependent variables in the system. the functions vi+ and vi− represent reactions or fluxes entering or leaving the quantity xi, respectively. substituting slope estimates for the differentials in this system of equations decouples the ordinary differential equations  and results in a system of fluxes that is linear at each time point t <cit> . the algebraic equations may be represented in matrix format as

  s=n×v,j= <dig> …,k, 

where s is a vector of slopes, n is the stoichiometric matrix, v is a vector of fluxes, and k is the number of time points t <dig>  t <dig> …, tj,…, tk where measurements are available.

next we check the rank of the linear set of algebraic equations in eq. . the system can be easily solved at each time step to obtain dynamic profiles of all fluxes if the system has full rank. over-determined systems may be solved by pooling fluxes, the use of pseudo-inverse methods, or regression. however, if the system is underdetermined, the solution space is infinite. to overcome this issue, some of the fluxes need to be estimated independently, until the system has full rank and can be solved uniquely. elsewhere we showed that additional information maybe used to characterize selected fluxes  <cit> . here, the goal is to estimate some fluxes directly from the time series data, without evoking other sources of information.

as an introductory example, consider a linear part of a pathway with feedback inhibition as shown in figure  <dig>  the equations that describe the system in terms of fluxes are

  x˙1=v1−v2x˙2=v2−v <dig> x˙3=v3−v <dig> 

the system could be part of a larger pathway system, but for this illustration the context is not relevant. for the illustration, fluxes were generated with a mix of power-law and hill functions, namely

  v1= <dig> x3−6v2= <dig> x <dig> v3=vmaxx23km3+x <dig> v4=2x <dig>  

where vmax =  <dig> and km =  <dig>  we use these settings to create artificial data, but subsequently assume no knowledge of the functions or parameters in eq. .


suppose time series data were measured and they are without noise ). eq.  immediately indicates that the flux system is underdetermined and therefore has infinitely many solutions. a unique solution could be obtained if one of the fluxes could be determined independently. to achieve this independent determination, one may choose any one of the three equations in the system. for ease of computation, one will typically prefer an equation that contains as few fluxes and as few substrates and modulators as possible. in this linear system, all equations have two fluxes and each of them depends on only one metabolite, so that there is no advantage to choosing one equation rather than another.

generically, we intend to solve the fluxes in the ith equation, which here happens to have only two fluxes, namely one influx  going into the pool xi, and one efflux  leaving this pool. the flux vin depends only on the precursor xin of xi and vout depends only on xi itself; to minimize confusion, we call this variable generically xout. extracting the ith equation from eq. , we thus obtain, in general terms,

  x˙i=vin−vout. 

the functional form of neither flux is assumed to be known. substitution of derivatives with slopes results in k equations of the type

  si=vin−vout,j= <dig> …,k. 

as a specific illustration, consider the second equation  in eq. , where v <dig> depends only on the precursor x <dig> and v <dig> depends only on x <dig>  we substitute the derivative x˙ <dig> with slopes that can be measured directly from the time series data, possibly upon smoothing. for a total of  <dig> time points, one thus obtains  <dig> algebraic equations of the type

  x˙2≈s2=v2−v <dig> j= <dig> …, <dig>  

it is reasonable to assume that the in- and effluxes are true functions in a mathematical sense. thus, since vin depends only on xin, vin must have one and only one value for every given value of xin. in particular, if xin assumes the same value at two different time points, vin must have the same  value at both time points as well. in the illustration example, v <dig> depends only on x <dig>  thus, for every value of x <dig> there is one and only one value of v <dig>  the proposed method therefore requires a screening of the available datasets with the goal of identifying different situations where xin has some fixed value xin_const. for all these situations, vin also has some fixed value vin_const. since we do not know the functional form of vin, we cannot directly compute this value vin_const. however, we do know that this value is very similar for all situations where xin ≈ xin_const. thus, for the set of all xin ≈ xin_const, eq.  has the form

  si=vin_const−vout. 

in the illustrative example, we screen the available data sets and search for different situations where x <dig> has the same fixed value x1c and, thus, v <dig> also has the same  value v2c. thus, for the entire set of all x <dig> ≈ x1c the second system equation has the form

  s2=v2c−v <dig>  

for instance, x <dig> has similar values  at time points  <dig>   <dig> ,  <dig> , and  <dig> , while x <dig> has different values at these time points ).


we repeat this type of screening for different sets of the same or very similar values of xin. the result is a set of sets with equal xin_const values within each set but different xin_const values for different sets. these sets form a histogram with a bin for each xin_const. if the range of each bin is small enough, we can assume every xin in the same bin to have very similar values, so that their corresponding vin_const are also very similar. henceforth, we only retain bins with at least two entries. an example in the illustrative example consists of time points  <dig>  and  <dig> , where x <dig> has again similar values. in this case, the value is ~ <dig> , which is different from the value we screened before. similarly, for time points  <dig>   <dig> , and  <dig> , x <dig> has a value of ~ <dig>  ). figure  <dig> shows many situations in the dataset where x <dig> has approximately some fixed value, and these sets of x <dig> are reflected in a “bin database of values.” within each bin, the corresponding value of v2c is very similar as well.

suppose we have identified p bins that contain at least two xin. for these bins we determine the corresponding xout values, which are typically different from each other. suppose that bin p contains q values. thus, we obtain q equations of the type

  si=vin_const−vout,p= <dig> …,p, 

where vin_const  always has the same value, but si  and vout  have different values. for our illustration we specify nine bins  ), and their corresponding values of x <dig> at the same time points are shown in figure  <dig>  the 6th of the nine bins ) contains three instances of x <dig>  therefore, we obtain three equations of the type

  s2=v2c−v <dig>  

equation  is formulated analogously for each bin p = <dig>  …, p. in each case, vout  can be represented as at least two equations of the type

  vout=vin_const−si,p= <dig> …,p. 

since we do not know the functional form of vin, we do not know the numerical value of vin_const . however, since vin_const  is a constant for each bin, the relative positions of a group of values of vout  depend on each value –si  within a given bin, and the slope values can be measured directly from the time series data. in addition, since vout  is solely determined by xout , we can characterize the relative positions of a set of xout  and their corresponding values –si . collecting these relationships, we can establish a plot of xout  versus –si . if the bin contains only two points of xout, we consider them as a pair and link them with a connecting line. if the bin contains q points of xout , we sort xout based on their values and connect every two adjacent points as a pair to form a total of q- <dig> pairs. in order to address these pairs, we use an additional index for the position of each pair in each bin, such as , –si ) for the first point and  , –si  ) for the second point, where r =  <dig>  …, q– <dig> 

to continue the illustration, the 8th bin contains two instances of x <dig> ~ <dig> . the corresponding values of x <dig> are  <dig>  and  <dig> , and the –s <dig> values are − <dig>  and  <dig> , respectively. the points in the plot of x <dig>  versus –s <dig>  are therefore represented as  and . we consider these two points as a pair and link them using a red line ). similarly, the 5th bin contains four instances of x <dig> ~ <dig> . their corresponding values of x <dig> are  <dig> ,  <dig> ,  <dig> , and  <dig> , and the –s <dig> values are  <dig> ,  <dig> ,  <dig> , and  <dig> , respectively. the points in the plot of x <dig>  versus –s <dig>  are therefore represented as , , , and . two points each are considered a pair and linked with a red line ). after the pairs of points are determined, we prune the set by neglecting pairs where the distance between xout  and xout  is below some threshold dr=xout−xout. the reason is that small line segments tend to lead to unduly high estimation errors. the default value for dr is set as  <dig>  in the examples shown in this article, but it will generally depend on the accuracy and quantity of the data. the higher the value is, the fewer pairs will remain after filtration. however, as long as the remaining pairs cover most of the spectrum in the x axis, an increase in dr might be preferable. suppose s pairs remain after this filtering. figure  <dig> shows the collective result for the illustration example.

2
 contains two differentx2values corresponding to the “blue” instances in figure
2
 forx1~ <dig> . the corresponding values of x <dig> and –s <dig>  obtained from the plot of x <dig> versus –s <dig>  are  and . these two points are considered a pair and linked with a red line.  the 5th bin of figure  <dig>  corresponding to the “red” instances in figure  <dig>  contains four instances of x <dig> ~ <dig> . their corresponding values of x <dig> and –s <dig> are , , , and . two points each are considered a pair and linked with a red line.

equation  indicates that xout  and –si  differ by a constant, since we do not know the value of vin_const . this fact translates into a constant vertical shift in the y direction for each pair of points. in other words, the relative y positions of the pair are preserved and the pair has to be shifted together by a yet unknown amount. while we do not know the size of the shift for each individual pair of points, all points collectively represent the graph of xout versus vout, and it is reasonable to assume that this graph is continuous and usually even monotonic. therefore, the next step is to merge the individual pairs by determining a proper shift for each pair.

intuitively, it is easy to see how to shift all pairs so that they are close to one continuous line. automation of the process requires an algorithm that is not quite straightforward, but can be facilitated with a graphical user interface; technical details of a possible merging process are presented in figure s <dig> of the additional file  <dig>  a pseudo-code of the merging is the following:

set each pair of points as a node

set each node as a subgraph

while the graph is not connected

 for each subgraph in the graph


  for each node in the current subgraph


   set other-subgraphs as the subgraphs; exclude the current subgraph

   calculate the distance from the current node to every node contained in other-subgraphs

  end for

  find the shortest distance and its corresponding nodes

  connect these two nodes

 end for

end while

 

when the merging is completed, all pairs of points are close to a relatively smooth line, but the overall shift of the group of pairs is not known. we do know that essentially all metabolic fluxes will have values close to zero when their substrate concentration approaches zero. thus, if sufficiently small substrate values are available in one of the bins, one easily estimates a reasonable shift. should the flux value associated with some substrate concentration be known, the shift can be determined from this information. a further alternative is the following. if the inferred trend line suggests that the flux follows some rate law, such as a hill function, the parameters of this function, together with the appropriate shift, can be obtained in a single optimization step.

finally, based on the numerical or graphical flux profile thus determined, one may test candidate functions that capture the flux-substrate relationship. for instance, the result in the illustrative example shows that the functional relationship of x2vs. v <dig> is s-shaped. it could thus be consistent with the  hill function in eq. , although the computed result itself certainly would not prove that this format is correct. if one assumes, based on the results, that a hill function is appropriate, one may fit this functional form to data to find the optimal parameter values of the flux-metabolite dependency. without making such an assumption, one may alternatively connect the dots in figure  <dig> with a continuous line and interpolate the values of fluxes using a spline or another smoothing method. the resulting trend line can be used as a “look-up” plot.

now that we have determined v <dig>  it is easy to compute v <dig> from the measured slopes of x <dig>  the plot of v <dig> is slightly curved, which is consistent with its power-law function in eq. , although again, there is no proof. the results section discusses further examples.

the parameters of any candidate functional form are easily estimated, because no differential equations are involved and the problem is of low dimension; they represent a fully parameterized kinetic model for the flux term itself and, subsequently for the differential equation. due to this simplicity, it is even possible to scan a variety of candidate functions and assess their appropriateness. if a suitable functional format can be determined with appropriate parameter values, the task is completed. if not, one may represent the flux-substrate plot with a piecewise-polynomial function, such as cubic spline. even in this non-explicit, numerical format, the result is sufficient to reduce one or two degrees of freedom in the overall dfe task. figure  <dig> presents the overall flow and concept of the method.


the procedure described above has generated one or two additional flux estimates. for the example in eq. , the determination of v <dig> and v <dig> “fills” the rank, and the system can be uniquely solved. in fact, only one of the two is needed. for examples where one or two additional fluxes are not sufficient for a unique solution, the same procedure has to be performed with other equations until enough fluxes are determined to make the flux system full rank. dfe subsequently identifies all other fluxes as plots against time or against their substrates and modulators.

in cases where fluxes contain more than one variable, the time courses have to be screened for combinations where the contributing variables have the same values. the concepts of the procedure are exactly the same as for the univariate case, but the implementation is obviously more involved . also, such combinations are rarer than in the cases described above, so that these situations require more diverse datasets for structure identification.

RESULTS
the simple linear pathway shown in the previous section illustrated the concepts of the proposed extension to dfe. this section describes applications of the proposed methods in the context of further didactic and actual examples that become increasingly more complicated. we begin with two artificial cases with distinct characteristics and conclude with the analysis of experimental observations describing trehalose metabolism in the yeast saccharomyces cerevisiae.

branched pathway with feedforward activation and feedback inhibition
consider a branched pathway with fluxes represented by various functional forms, including michaelis-menten and hill functions with inhibition and activation. the pathway, shown in figure  <dig>  can be described by the following set of ordinary differential equations  <cit> :

  x˙ <dig> = v1−v2x˙ <dig> = v2−v3−v5x˙ <dig> = v3−v4x˙ <dig> = v5−v <dig> 

the kinetic descriptions for each of the reactions are:

  v1=16×x51+x5v2=65×x <dig> ×1+ <dig> .5×x <dig> +x <dig> +x <dig> ×1+x <dig> × <dig> v3=5×x245+x24v4=8×x31+x3v5=58×x2113x2113+1+x1131+63×x113v6=8×x41+x <dig> 

as before, we use these formats to generate artificial data, but subsequently assume no knowledge of their characteristics.


the system in eq.  is not of full rank. thus, some of the fluxes need to be determined with the proposed method. for our illustration, we select the third equation in eq. , because it contains only two fluxes; also, v <dig> depends only on x <dig>  and v <dig> depends only on x <dig>  which we know from the topology of the pathway. in the previous example, all time series were oscillating and it was easy to find enough data points where one variable is fixed and other variables display different values. in the present example, each single dataset displays changes over time that show few repeated concentration values ). in such a situation, which is more typical than the earlier illustration example, one can use exactly the same method, applied to multiple datasets with different dynamic profiles, as long as one can validly assume that the functional forms are not affected by differences among the datasets.

for this illustration, we simulated multiple datasets with the initial values presented in figure  <dig>  which could easily reflect actual experimental settings. figure  <dig> shows the result of binning x <dig> by using the first four datasets in figure  <dig>  the corresponding pairs of x <dig> ) range from  <dig>  to  <dig> , which covers most of the range of x <dig> in the four datasets . the merging process of pairs is shown in figure  <dig>  with panels corresponding to those in figure  <dig>  in particular, figure  <dig> exhibits the merged points, which evidently form a sigmoidal shape where the first few points are basically flat. therefore, one can assume the flux at the smallest x <dig>  to be close to zero and shift the entire set of merged pairs up by about six units to obtain the estimates of v <dig>  indeed, this step recoups the true flux, which is shown in green, but would be unknown in a real application. once v <dig> is determined, the system of eq.  is still underdetermined and another flux needs to be estimated to make the system full rank. the most straightforward choice is v <dig>  which is directly computed from v <dig> and the measured slopes of x <dig> 


instead of v <dig>  one could also estimate an additional flux from another equation in eq.  using the same procedure, for example, by solving v <dig> and v <dig> in the fourth equation. flux v <dig> depends only on x <dig> but v <dig> depends on two variables x <dig> and x <dig>  the steps of estimating v <dig> and v <dig> are described in additional file  <dig>  we also tested the proposed method by using six datasets in figure  <dig> and the results similarly recover the true functional form .

the proposed method was also tested on a five-variable system that has been used as a benchmark problem in many articles . to demonstrate the applicability of the method, we also added artificial noise to the time series data in this example and randomly picked sub-datasets from data generated with ten conditions. the details and results are shown in additional file  <dig> 

glycolysis and trehalose production
this last example describes in a simplified fashion how the baker’s yeast saccharomyces cerevisiae converts glucose into end products and how trehalose is synthesized and degraded in a cyclic pathway . the data  <cit>  consist of actual in vivo nmr measurements of metabolic profiles that characterize how the yeast responds to heat stress in two time regimes at the genome, protein, and metabolic levels. for the illustration here we use the metabolite dynamics of normally grown cells that were then exposed to heat stress  and fed with a pulse of glucose. immediately after glucose addition, the initial metabolite pools  increase, while trehalose  increases with a short delay and begins to decrease slightly after two minutes. the end products ethanol, glycerol, and acetate gradually accumulate. the concentration data are shown as dots in figure  <dig>  together with the modeling results that are described next.

.

the model contains eight dependent variables and eight fluxes, as shown in eq. , where vext and vint represent the extracellular  and intracellular  volume of the bioreactor and the cell population, respectively. each of the fluxes is a function of some of the variables, as shown in eq. , but it is important to note that we do not make any assumptions regarding the functional forms of the fluxes. in principle, dfe seems to be directly applicable. however, the time series data contain the measurements of only five of the metabolites, namely glc , g6p , tre , fbp , and extracellularly accumulated end products . without the measurements of x <dig>  x <dig>  and x <dig>  the system in eq.  is not of full rank and, due to the experimental set-up, v <dig> and v <dig> cannot be measured or determined directly by estimating slopes.

to complement the rank of the flux system, we use the proposed method of flux estimation. first, one should note that the measurements of glc  concern extracellular glucose. thus, x <dig> is easy to measure experimentally, but it is very difficult to obtain good measurements of intracellular glucose , because it is immediately converted in to g6p . thus, the proportion of glc  is negligible in comparison to glc , and because the measured concentration of glucose is close to the sum of glc  and glc , we merge x <dig> and x <dig> into one pool, which is represented by the sum of the first two equations in eq. . furthermore, the amount of material entering the pentose phosphate pathway  is not directly measurable, but independent lab experiments had indicated that it has a value of approximately 5% of the glycolytic flux; thus v7= <dig> ×v <dig> <cit> . with these simplifications, the system can be formulated as:

  x˙1=−v1/vextx˙2=/vintx˙3=/vintx˙4=/vintx˙5=/vintx˙6=2v6/vextx˙7=v7/vintx˙8=v8/vint 

  v1=f1x <dig> x3v2=f2x2v3=f3x3v4=f4x4v5=f5x3v6=f6x5v7= <dig> ×v5v8=f8x <dig> 

to supplement the underdetermined dfe, we select the equation x˙4=/vint in eq. , since it contains only two terms and the measurements of x <dig> and x <dig> are available. as before, we fix x <dig> at some values ) and find the corresponding x <dig> and –s <dig> ). the merged pairs suggest an approximately exponential function  and the minimum of x <dig> is very close to zero. for a concentration close to zero, the value of the flux should be close to zero as well. therefore, the entire cluster of pairs is moved up around  <dig> units, and the updated functional plot is shown in figure  <dig>  the corresponding v <dig> can now be calculated accordingly and transformed to the form as fluxes versus time. after the determination of v <dig> and v <dig>  the system of eq.  becomes full rank and the rest of the fluxes at each time point can be solved with dfe even without knowledge of the times series of x <dig> and x <dig>  indeed, the time courses of x <dig> and x <dig> can be calculated via point-by-point integration of v <dig> and v <dig>  upon the determination of the concentrations of all variables, the total mass over time can be calculated, confirming no significant loss or gain of mass ).


once we have obtained the time series of all fluxes, we can generate the plots of concentrations of metabolites that are involved in the enzymatic reactions ) versus a flux. the results are shown in figure  <dig>  as a validation test, we used these numerical flux representations of each enzyme catalyzed reaction to simulate the concentration changes of metabolites. the simulation results are shown in figure  <dig> 

9
. shown are metabolite concentrations against fluxes at different time points , connected by inferred trend lines for all fluxes .

discussion
of all steps in the generic mathematical modeling process, parameter estimation and structure identification continue to be among the most severe bottlenecks for modeling biological systems. until recently, this task was typically pursued from the bottom up by using local data from individual enzymatic steps. however, modern techniques of molecular biology have provided us with a strikingly different estimation strategy, namely a top-down or inverse approach, which is based on dynamic time series data that are being generated with rapidly increasing frequency and quality. many recent articles have proposed various methods to tackle this inverse estimation problem using time series data. however, none of these methods are effective in all cases. furthermore, almost all methods have been focusing on the goodness of fit and the speed of the algorithm, but not necessarily the quality of fit in terms of the validity of the model, extrapolation ability, and predictive power with respect to data not used in the estimation. in addition, there has been little discussion of the diagnostic tools for data fits beyond the residual error. for instance, it is possible that a fit is good in terms of the residual error, but that the estimated fluxes are incorrect because of numerical compensations between terms within the model  <cit> .

dynamic flux estimation   <cit>  addresses several of these issues successfully, but only if the data are rather comprehensive. more limiting, dfe requires that the system of fluxes is of full rank. when the number of fluxes exceeds that of the dependent metabolites, either because of the stoichiometry of the pathway or due to the lack of measurements of some metabolites, dfe cannot be applied directly, because the system of fluxes is underdetermined. to supplement such a system, we recently proposed methods for supplementing dfe with other information that may be used as a substitute for unknown fluxes  <cit> . however, these methods are successful only under certain restrictive conditions, for instance, when the enzymes in the system are well characterized under pertinent conditions, sufficient kinetic information is available, and all significant metabolic time series are measured. one could also determine some of the fluxes within the system by fitting pre-selected models to time series data. however, this pre-selection requires the definition of functional forms for the reactions in question, which in truth are often unknown.

in this article we propose a model-free approach with minimal assumptions to supplement dfe with information already embedded in the time series data. the proposed method starts with the selection of a decoupled equation; preferable one that contains a minimal number of terms and contributing metabolites. within this equation, we repeatedly fix one or a few variables that have constant or very similar values within certain small ranges, and find the corresponding values of the variables that appear in another flux of the equation. the result of this step is a plot of a flux versus a metabolite, with several pairs of points showing the relative positions of the true metabolite concentration and the flux values in each pair. the position of each pair is initially subject to shifting in the y direction by an unknown amount. the correct shifting of pairs may be accomplished with an automated or manual merging process that, for instance, accounts for the fact that the flux value should be zero when the metabolite concentration is zero. one could also measure the flux value at some metabolite concentration experimentally. furthermore, if an enzymatic rate function is deemed correct and corresponding kinetic information is available, the vertical shift in the flux can be calculated. once the metabolite-flux plots are established for all fluxes, one can select a suitable mathematical representation for the entire dependency or use a piecewise approximation for different ranges of data. one could also use the metabolite-flux relationships directly as “look-up” plots.

the proposed method may appear cumbersome or even baroque. however, one should consider that it solves a problem that so far has not even been addressed—let alone solved—with any systematic approach. also, the method is presently likely to suffer from a lack of suitable data. but judging by the development of high-throughput experimental methods and the number and increasing quality of published time series over the past decade, this issue seems to be primarily a matter of time. indeed, one should expect that it will soon be feasible to generate strategically selected, multiple datasets for the identification of a system, which differ slightly in their settings. these datasets must come from experiments that do not alter the functional characteristics of the fluxes in the system but might, for instance, measure system responses under modestly different substrate or inhibitor conditions. at the same time, the data should be representative of the dynamics of the system within the pertinent ranges of its variables.

the method involves one step that is subject to bias. namely, the overall shifting of the flux-metabolite relationship requires extrapolation or some other information, unless metabolite concentrations close to zero are available. to resolve this issue, it might be possible to determine a reference point for the shift from enzymatic or kinetic information. however, in many cases, this information will have been obtained in vitro and possibly under different conditions. a more direct approach would be to measure a flux value experimentally at some point, for instance, at the steady state. such a measurement is relatively simple when the flux of interest is an input or output flux. it might also be possible to measure some fluxes directly by estimating the rate of consumption and production of the initial substrate or the end product, respectively. however, the measurements of fluxes at these locations are usually of lower interest since they are seldom associated with the underdetermined subsystems of the internal fluxes. one or more intracellular fluxes could also possibly be characterized through measurements of a suitable isotopomer distribution at steady state , but such data are still rare. finally, if one has valid reason to assume a particular format for a flux, such as a michaelis-menten or hill function, the shift may be obtained through optimization. all estimation methods are negatively affected by noise, and the proposed method is no different . however, issues of noise can be logistically separated from this method to some degree. namely, the time series data used as basis for the proposed method may  be smoothed in a preprocessing step, for instance with a filter  <cit> . this well-established step allows an assessment of the characteristics of the noise as well as the smoothing process itself. once the data are smoothed and noise is thus reduced, the proposed method is applied as if the data had been noise free.

outside these remaining details, the proposed method has several notable advantages. first, no assumptions are needed regarding the mathematical representations when determining the individual fluxes. second, the application of the method is not limited to a small range of a metabolite or its flux. instead, it allows the modeler to examine the full spectrum of the functional form, depending on how widely the available time series data cover metabolite concentrations along the x axis of the metabolite-flux plot. third, even under the condition that some of the time series are missing, the proposed method can still recover—at least to some degree—the governing flux profiles. finally, since the range of coverage depends on the available datasets, we can, arguably for the first time, estimate how many data points are necessary to identify the functional format of a flux or what values of metabolite concentrations are needed to cover the concentration range of interest. namely, if it is possible to implement the proposed method for a system at hand with sufficient reliability, then we know that we have enough data to assess the range over which the flux can be determined. if a wider range needs to be known, additional data will have to be made available in that extended range. this insight in itself will aid the design of specific experiments that can be used to generate more extensive functional plots.

CONCLUSIONS
in this article we propose a systematic strategy to supplement and ameliorate the limitations of the method of dynamic flux estimation . the proposed strategy makes no a priori assumptions regarding the model representation and uses instead information embedded in the time series data. the results demonstrate that the proposed approach successfully complements dfe in various situations. the method permits the examination of a full spectrum of functional forms, as well as a determination of whether at all, to what degree, or within what range, the available time series data can be validly represented in a particular functional flux format within a pathway model. based on these results, one can, arguably for the first time, estimate how many data points are required to identify the functional format of processes within a system model and design experiments to generate data points that genuinely add new information to the parameter estimation and structure identification tasks.

competing interests
the authors declare no competing interests.

authors’ contributions
ideas and concepts were jointly discussed among both authors. icc developed and implemented the project under the supervision of eov. both authors contributed to the writing of the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
this file contains:  details regarding the process of merging pairs of points;  the estimation procedure for a four-variable branched pathway and results of two cases where fluxes contain more than one variable; and  the results of the method for a five-variable system where different levels of artificial noise were added to the time series data and sub-datasets were randomly picked from data generated with ten sets of initial conditions. <cit> . 

click here for file

 acknowledgments
the authors are grateful to dr. luis l. fonseca for constructive discussions and for allowing us to use some of his data. they also acknowledge david fieni’s work on an automated shifting algorithm. this work was supported in part by a molecular and cellular biosciences grant  from the national science foundation, a grant from the national institutes of health , and an endowment from the georgia research alliance. the work was also in part funded by the bioenergy science center , which is a u.s. department of energy bioenergy research center supported by the office of biological and environmental research in the doe office of science. any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the sponsoring institutions.
