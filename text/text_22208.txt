BACKGROUND
molecular phylogeny at the intraspecific level has proven to be very useful for a variety of studies, such as estimating the genealogical relationships among genes, determining the common ancestor of a group of organisms, evaluating the development of drug resistance in infectious diseases, detecting positive selection for immune escape, and predicting future trends of diseases  <cit> . the sequences within a species are similar each other compared with those from different species. therefore, it is generally expected that the pairwise difference is a good approximation to the evolutionary distance, and the estimated phylogeny by existing methods   <cit> , statistical parsimony   <cit>  and maximum likelihood   <cit> ) is reliable and has little uncertainty. however, there appear sometimes abnormal phenomena in which mp picks up a prohibitive number of equally parsimonious trees  <cit> . such phenomena suggest the presence of strong evolutionary correlations among different lineages. then, a nested analysis approach  <cit>  makes a complicated network mapping in a nested analysis and makes it impossible to trace the evolutionary history. in this situation, when the approximation of the pairwise difference is well satisfied as a whole, we can expect that the above abnormal phenomena are caused by a small number of sequences in a given dataset.

recently, kitazoe et al.  <cit>  proposed multidimensional vector-space  representation in which the estimated pairwise distances can be reproduced by using pythagorean theorem. when a distance matrix is compatible with a tree structure, sequences are expressed by the composites of branch vectors that are orthogonal among others. therefore, mvs representation enables to measure the deviation from the tree structure which subsists in the initial pairwise differences. in this paper, this measured deviation serves as a unified index in the core set approach developed below.

we principally select a maximum subset  of sequences for which mp generates a single solution, by excluding sequences with large values of the deviation index, and we can uniquely determine all the node sequences of the core set tree. here, we assume that this core set tree is robust and preserved by insertion of the excluded sequences. this assumption seems to be reasonable when the number of the excluded sequences is small. the core set approach makes the reason of the exclusion clear, and therefore makes it possible to estimate the nucleotide transitions within a small range of uncertainty. indeed, we found through applications that the excluded sequences without recombination have two phylogenetic positions, respectively. a more detailed procedure of the core set approach is documented in the followings:

we first select a maximum number  set") of sequences  in methods) whose distance sub-matrix gives no deviation from additivity of evolutionary distances. existing methods  produce the same single tree as the p-core set tree. second, the excluded sequences are added on the p-core set  in methods). this insertion provides a maximum set  set") of sequences for which mp produces a single tree, and the s-core set comprises a global mainframe of the final tree structure. however, long branching attractions may sometimes prevent a further restore of the excluded sequences into the s-core set. in such a case, we divide the s-core set into several subgroups and the two procedures of exclusion and insertion are repeated in the subgroups on the additional condition of preserving the s-core set tree structure.

we apply the core set method to partial env sequences of hiv- <dig> , to demonstrate how our approach realizes reasonable tree building. we next employ the method for a phylogenetic analysis of mitochondrial sequences of anopheles dirus, which characterize a simultaneous radiation pattern. then, we perform simulation studies and confirm that our core-set is mostly a large proportion of the original dataset and that the inferred tree for the s-core set is consistent with the true tree of the whole sequences.

RESULTS
1) hiv phylogeny inference by constructing only a s-core set tree
we applied our method to partial env sequences of hiv- <dig>  that were obtained in a longitudinal study  <cit>  of many patients. we analyzed a subgroup of  <dig> nucleotide sequences from the patient- <dig>  which comprise an obvious monophyletic tree and are separated from the other subgroups in mp consensus tree. hence, there unlikely exist substitutions which make phylogenetic inference much difficult and this data set provided a good example to demonstrate the validity of our method . we first selected a p-core set of sequences, which made the total deviation index w  in methods) equal to zero by performing the procedure  in methods. the sequence number 1– <dig> in fig. 1b stands for this p-core set member. here, standard methods such as nj, mp and sp provided the same tree, because there were no multiple substitutions in the p-core set. we next tried to incorporate the excluded  <dig> sequences sequentially into the p-core set by performing the procedure  in methods. as a result, the sequence number 22– <dig> were further deposited on the p-core set tree, and a s-core set tree of the total  <dig> sequences was obtained . here, the s-core set produced the set of maximum number of sequences for which mp provides a single tree. indeed, we confirmed that there is no other subset with  <dig> sequences except for our s-core set which has a single mp tree by examining all possible combinations between  <dig>  sequences and the remaining sequences. the number of sequences in the other subsets was always less than  <dig>  we further performed the procedure  that decomposes the s-core set into subgroups. however, we found that there was no more sequence which could be added by the criterion of procedure . in this way, our final tree was constructed by only once performing the two procedures  and  in methods. we here note by investigating all possible combinations of two groups that the p-core set of  <dig> sequences is a maximum number set that satisfies the additivity but the second p-core set is given by replacing the 16th sequence by the 22th sequence. with starting this second set, however, the original s-core set of  <dig> sequences did not change.

as an extension of our core-set approach, we could add further seven sequences on the s-core set ), which could be given unique phylogenetic positions on the condition of preserving this tree by the criterion of procedure . consequently, the t-core set was constructed  in methods). here, mp method provided multiple solutions of phylogeny  . a further inclusion of sequences 35– <dig> with larger deviations  generated an explosion of topologies  with paup*. some of these patterns disrupted even the core set tree . sp tree   <cit>  inferred from the s-core set  separated two sequences  from the core set, and the inclusion of all sequences disrupted the s-core set tree . one way to address these topological uncertainties of mp and sp is to first fix the topology using ml, and then to determine the node sequences using mp  <cit> . however, ml + paup* also disrupted the core set . the topology and node sequences were calculated with ml, software package phylip   <cit>  and paup*, respectively.

2) mosquito phylogeny inference by constructing local core-set trees
the core set approach was applied to a data set of mitochondrial coi and coii dna sequences of anopheles dirus species a and d of southeast asia  <cit> . nj tree of which the outgroup was the 29th haplotype was highly distorted and many of branching lengths on the tree represented smaller numbers of single substitutions . such abnormal phenomena were due to strongly evolutionary correlations among many different branches.

we first constructed a global core set  consisting of  <dig> haplotypes by using the procedures  and  in methods . the tree structure of this core set represents a simultaneous radiation  pattern centered on the 29th haplotype. we next decomposed the global core set into subgroups by using the procedure  in methods. the subgroups obtained by this procedure are shown by the vertical bold lines of fig. 4a. here, the 29th haplotype was included in all groups as their common ancestor. the procedure  was then applied to the individual subgroups, and the total  <dig> haplotypes were added in the seven subgroups . fifty-eight of the remaining  <dig> haplotypes were inserted into each of the obtained local p-core sets by using the procedure  . the second, third, and fourth columns of table  <dig> give the haplotype numbers corresponding to the global core set, the local p-core sets, and the local s-core sets in each group, respectively. as a result, our final tree consists of  <dig> haplotypes . this tree has a finely resolved structure with definite number of substitutions on each branch, in contrast to nj tree . the asterisks denote the haplotypes of a. dirus d, whereas those of a. dirus a are unmarked. haplotypes of a. dirus species a and d are intermingled across the tree. this can be interpreted as resulting from the introgression of mtdna between the two a. dirus species. details of the biological interpretations will be reported by o'loughlin et al.  <cit> .

the second column includes the 29th haplotype. the third and forth columns give only the haplotype number additionally inserted.

since we could definitely determine the node sequences in the final tree , we estimated the frequencies of nucleotide substitutions. we counted all the nucleotide substitutions from the 29th haplotype  toward the endpoints. of the  <dig> sites,  <dig> sites showed nucleotide substitutions . of these,  <dig> sites had undergone multiple substitutions within the genealogy of the final tree. on the other hand, thirty-one sites had undergone non-synonymous changes, among which only five sites had experienced multiple substitutions. the multiplicity of the  <dig> variable sites averaged out to  <dig>  because there were  <dig> substitutions in total. however the multiplicity was not distributed homogeneously among the variable sites. the largest number of multiple substitutions at one site which we observed was  <dig> . of these  <dig> substitutions,  <dig> were transitions and  <dig> were transversions . non-synonymous changes comprised 10% of the total, and t→c and a→g transitions predominated. this feature became more obvious at small multiplicities with n <  <dig> . we finally estimated the number of nucleotide transitions by incorporating the  <dig> sequences excluded from the core set . although these sequences have two phylogenetic positions, respectively, the collection of all possible patterns provided a small fluctuation in each transition matrix, as seen in this table.

this shows that t→ c and a→ g transitions predominated , especially in the case of small numbers  of multiple substitutions .

3) efficacy of the core set approach by evolutionary simulation of random process
to examine the efficacy of the core set approach, we simulated a markov process of sequence evolution, which resulted in the same phylogenetic tree as the core-set tree derived from the  <dig> mitochondrial coi and coii dna sequences of anopheles dirus . here, the root sequences were randomly generated according to the nucleotide frequency distribution of the 29th haplotype in fig. 4a. each nucleotide substitution was randomly generated according to the weight given in table 3a. since non-synonymous substitutions were rare in the above analysis, we only changed the third codon positions. although the site heterogeneity of the evolutionary rate was neglected for simplicity, there is more chance of multiple substitutions because we kept the branch lengths. application of the core set approach to  <dig> sets of the terminal sequences retained  <dig> % of the whole sequences as the global s-core set member and did not require any local core-set trees because of random process without strong evolutionary correlations . the global s-core set produced a unique mp tree which is consistent with the simulated tree. furthermore, the estimated sequences at the internal nodes of the s-core set were perfectly identical to the true ones. figure 4b illustrates the global s-core set tree in one event . the inclusion of the remaining  <dig> % sequences allowed mp to provide a number of topologies around  <dig>  this implies that the only sequences with phylogenetic uncertainty were excluded by the core set approach.

discussion
the core set approach first determines a set of the sequences  that form the tree structure without multiple substitutions by using only the total deviation index. the approach next tries to sequentially insert the excluded sequences into the p-core set tree, according to the min-max criterion. if these sequences have the unique phylogenetic positions on the p-core set, they are incorporated into the p-core set as the s-core set. the min-max criterion is useful for determining order of the insertion. in fact, in the present demonstration of the hiv sequences , the s-core set was formed without any missing by just stopping the insertion when mp gives multiple solutions. in this way, the core-set approach takes into explicit account of the tree-building process to construct a consistent and robust tree.

a systematic analysis of the mosquito mitochondrial dna data set also showed that the maximum parsimony criterion was insufficient to produce a single tree structure. to demonstrate this lucidly, we consider only two groups,  <dig> and  <dig> in fig. 4a, which consist of nine and  <dig> haplotypes including the 29th haplotype, respectively. the  <dig> haplotypes of the two groups were analysed by using paup*. the analysis generated  <dig> different branch patterns, five of which were consistent with the branch pattern of the global core set. only one of these five trees corresponded to our result . the other trees showed very different branch patterns from ours, as illustrated in fig. 5b. using our approach, we first selected the global core set of seven sequences , then the local p-core set of  <dig> sequences , and then eight sequences  with the local s-core set. the fifteen topologies generated by paup* were the result of parallel changes between four sites and four branching pairs in the two groups . the application of paup* to all  <dig> haplotypes of fig. 4a generated more than  <dig>  topologies. in this way, the core set approach makes neighbor-joining trees robust by avoiding evolutionary correlations with other groups.

by contrast, sp reduced the topological uncertainty of paup* to a large extent. on the other hand, the network representation made it difficult to follow the evolutionary process strictly. complicated network mapping was demonstrated by applying tcs to the  <dig> haplotypes of groups  <dig> and  <dig> in fig. 4a . the reticulated pattern can be explained by parallel changes  mainly between the two groups. in fig. 6b, removal of the branches marked with asterisks and changing the dotted line to a solid one produces our result . note that paup* reproduced the same unique solution as ours. applying the tcs to all the haplotypes of fig. 4a generated a much more complicated reticulated genealogy. we applied ml + paup* to the  <dig> haplotypes in fig. 4a. the result obtained was rather different from that of the core set approach. we demonstrate a typical example of these differences using the two sub-groups 7– <dig> and 7– <dig> in fig. 4a .

of the  <dig> haplotypes,  <dig> had alternative phylogenetic positions, as discussed in methods. thirty-three haplotypes gave the one-site sharing pattern of fig. 7a, and one haplotype gave the two-site sharing pattern of fig. 7c. figure  <dig> illustrates a typical example of uncertainty whether the 15th haplotype should be inserted into the 7th haplotype  in group  <dig> or into the 72nd haplotype  in group  <dig>  this uncertainty exerts a strong influence on the phylogeny, because the 15th haplotype becomes the ancestor of the 250th, 271st, 127th, 221st, 36th, 97th, and 197th haplotypes, and the last three of these haplotypes confer a further ambiguity because the 97th haplotype produces the one-site sharing pattern.

the present core set approach implicitly assumes the condition that the global core set includes a majority of sequences and constructs a main frame of tree structure. when we cannot assume this condition, we decompose the total sequences into some groups, by using the criterion of the  <dig> % branching resolution in mp consensus tree. then, the present core set approach is applied to each group. the phylogeny among the groups is determined so that the branching lengths to connect them may be minimized. details of this subject will be discussed elsewhere.

CONCLUSIONS
the global core-set member was first selected from the complete set of sequences by the procedures  and  in methods, and comprised the mainframe for the further tree-building construction. the local core-set trees were second constructed by preserving this mainframe. only the sequences with alternative phylogenetic positions finally remained out of the tree. the core-set approach is assigned so that mp provides single trees for the global core-set and for each of local core-sets. hence, mp allows multiple solutions for our final set of sequences given by combining the local core-sets. this approach provides a definite and unique tree structure without relying upon probabilistic models of sequence evolution, by excluding the sequences casusing phylogenetic uncertainty. such a set of well-defined evolutionary pathways will provide increased power in making inferences of demographic history, and be useful in clarifying the precise mechanisms of molecular evolution. one of our next tasks is to detect definitely the sequences associated with recombination  <cit> , by systematically analysing data sets of many hiv- <dig> patients  <cit> .

