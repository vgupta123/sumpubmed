BACKGROUND
many high-throughput techniques such as dna microarray analysis, sirna screens or proteomic approaches result in extensive data. after careful statistical analysis the result of such an experiment is typically a list of candidate genes, relevant for certain biological processes, or an ordered gene list, sorted according to the significance in one or more biological processes  <cit> . the data analysis and interpretation of such lists provides a major bottleneck and a task for bioinformatics and systems biology. many approaches have been published that assess the significant over-representation of biological functions or pathways as annotated in go or pathway databases through gene set enrichment analysis  <cit> .

however, for many of the screened genes there is hardly any functional annotation available. for example, the number of human genes annotated in the kegg database  <cit>  is only about  <dig> . this contrasts the estimated number of putative protein coding genes which exceeds  <dig>    <cit> . many approaches rely on automatically inferred functional annotations  <cit> . such annotations can be assigned, for example, based on the protein sequences and predicted domains, as well as on protein interactions or co-expression. structured vocabularies such as the gene ontologies  comprise many such kinds of annotation  <cit> .

especially interesting and accessible is the functional annotation that is based on predicted protein domains, as there are already highly reliable prediction methods and databases available. of the  <dig>  genes in the ipi-human database, approximately  <dig>  have at least one interpro-domain assigned, of the  <dig>  genes in the human-kegg pathways, nearly all have at least one interpro-domain. together, these comprise approximately  <dig>  distinct interpro-domains  <cit> . protein domains very often directly correspond to some of the core biological functions, such as e.g. dna binding, kinase or phosphorylation activity, or otherwise to cellular localization. therefore, predicted protein domains are often utilized to predict these annotations, for instance in the go database. to our knowledge, however, protein-domain signatures have thus far not been used as a classifier to predict assignment of genes to pathways, which constitute the biological processes in a cell. here we want to critically assess the utility of domain information to predict pathway membership and provide a tool to utilize this information. as we deem it unlikely to reliably predict pathway memberships for individual genes, our main aim is to find relevant pathways significantly enriched in lists of genes, in particular lists from high-throughput experiments. pathways consist of a series of chemical reactions occurring within a cell. of special importance for the functioning of biological systems are the signalling pathways, in which signals or cellular stimuli are transmitted mainly through protein interaction and phosphorylation events, often leading to altered gene expression within a cell. known signalling pathways are collected within different pathway databases  <cit> . pathways thus represent functional units for collecting genes or proteins. crucial to gain hints of the function of genes is the mapping of these to one or more known pathways.

in many high-throughput experiments, we are facing the problem that we want to test for enrichment of pathways in gene lists, but the genes are often not annotated to pathways at all, or may even lack any form of functional annotation. we tried to answer this problem with the following idea: it should be possible to map a high fraction of the human genes to pathways via their protein domains. hypothesis: protein domains can be treated as functional elements of the proteins, the set of interpro-domains of the proteins of one pathway could serve as its functional fingerprint. in order to test the validity of this idea, we designed a simulation study based on the kegg database and the protein domain assignment in the ipi database. virtually removing genes from the kegg pathways, we demonstrate that we can place these genes back into the respective pathway with high accuracy. we have further applied the method to a biological dataset from a high-throughput sirna screen and demonstrate, that we are able to get biologicaly meaningful results.

RESULTS
we have developed a novel approach in order to test for the enrichment of pathways in arbitrary lists of genes. this approach is based on comparing the protein domain composition of the gene list of interest with the domain signature of the set of genes in each particular pathway. a more detailed description of this approach and a discussion of different measures of similarity, that can be utilized for this analysis, can be found in section similarity measure. we have tested the validity of this approach in a simulation study based on splitting the gene lists of known pathways from the kegg database. we demonstate that the method works well for most known pathways even in the cases of noisy gene lists and pathway mixtures, at least for gene lists that contain  <dig> or more pathway genes. we suggest an approach to assess the significance of the resulting scores based on a resampling method in section assessment of significance and test sensitivity and specificity in the assignment of pathway mixtures in section simulation of pathway mixtures. finally, we demonstrate the utility of our approach on a real biological dataset and discuss its interpretation. the method and simulation strategy is illustrated in figure  <dig> 

similarity measure
there are different approaches to derive measures of similarity between the domain signatures of two distinct sets of genes. in the simplest case this is a binary distance based on the existence of a domain in a set of genes. we can create a binary vector reporting for each possible domain, whether it is part of any gene in the set or not and compute, for example, the hamming distance between two vectors. however, this does not take into account the multiple appearances of domains in several genes of the set. in contrast, vectors of integer values reporting the number of appearance of all domains in the sets can be compared using simple euclidean distance. during the development of the simulation strategy, we tested several different similarity measures, and showed that they led to comparable results. here, we focus on a similarity measure that is more robust to deviations in the sizes of the sets, which is based on the chi-square statistic. for the two sets we count:

 <dig>  the number of intersecting domains for both sets,

 <dig>  the number of domains that are unique to set  <dig> 

 <dig>  the number of domains that are unique to set  <dig> 

 <dig>  the number of domains not part of any of the two sets.

by means of a binomial test, we compute on this contingency table the probability of over-representation of domains of set  <dig> in set  <dig> given all available domains. the negative log-transform of this probability can now be used as a measure for signature similarity. note that higher values indicate a higher similarity between the two sets.

simulation strategy
in order to assess whether interpro domains can be used as a tool for functional classification we conducted a simulation experiment. we chose the pathways represented in the kegg database as test environment, since this database is readily available. in principle, however, the method should be applicable to any kind of functional classification. assuming, that the domain structure of either a single protein or, more likely, of a group of proteins with related function should be sufficient for functional classification , we sampled different numbers of genes that are known to be part of a given kegg pathway. these genes were then removed from the pathway to construct somewhat smaller virtual pathways, which were used in the further test. in a subsequent step, we tried to recover the pathway membership of the collections of removed genes, based on the computed similarity of their domain signature to the domain signature derived from all remaining proteins of the respective pathway. to assess the significance of this score, the similarity measure of the sampled genes was compared to that of a control subset consisting of randomly chosen genes not specifically annotated to the respective pathway. we expect the latter to be less similar to the pathway signature.

simulating a single pathway
in an initial approach we chose a single non-metabolic pathway  that comprises a high number of  <dig> annotated genes. for this pathway, we randomly sampled increasing numbers of member genes and computed the similarity measure to the remaining pathway genes. in parallel, the same increasing numbers of random genes that have not been specifically annotated to hsa <dig> were sampled and the similarity was computed. for each number of genes, we repeated this procedure  <dig>  times. in order to avoid over-fitting, the sampled pathway genes were removed from the data set used to train the classifier, hence they did not contribute to the global pathway signature they were compared against. the plot in figure 2a shows the comparison of the computed similarities. while the domain signature of the random genes is not very similar to the pathway signature and stays more or less constant over different numbers of genes, we see a steady increase in similarity for increasing numbers of sampled pathway genes. based on the signature of only two pathway genes we can already distinguish between the random sample and the pathway genes. the sampling variance indicated by the error bars is extremely low.

simulating all  <dig> pathways
in a second step, we performed a similar simulation for all  <dig> kegg pathways, this time sampling sets containing from one up to ten pathway genes, each  <dig>  times. to assess how well the pathway gene similarity and the random sample similarity separate, we computed roc curves for each pathway and each sample number and, subsequently, the area under the curve  as a measure of separation. roc curves are plots of the true positive rate against the false positive rate at different cutoff levels of a binary classifier. thus, an auc of  <dig> represents an ideal classification while an auc of  <dig>  is what can be achieved by random guessing. in the box plots in figure 2b we plot the distribution of auc values for all  <dig> pathways for the different numbers of sampled genes. for most of the pathways we achieve almost complete separation with only a small number of sampled genes. already for two sampled genes, the bulk of the data lies above  <dig>  indicating low misclassification rates. sampling of five genes is sufficient to achieve complete separation for the majority of the  <dig> pathways. still, some of the pathways can not be classified at all, or only very poorly. detailed analysis of these pathways revealed that they often comprise only small numbers of proteins or that they belong to the class of metabolic pathways. in both cases, this result can be expectet: for small pathways we run into problems during the sampling process, because due to the removal of genes from the training set, we end up with sparse domain signatures based on a very small number of genes. moreover, we do not expect a good performance of our method for many of the metabolic pathways since they are based on a functional classification that may only be weakly reflected in the composition of protein domains. most of these domains are extremely unspecific, leading to a poor specificity of the overall domain signature. a detailed list of the performance of all  <dig> pathways can be found as additional file  <dig> 

simulating noisy data
in the previous sections, we based our simulations on ideal data, i.e. the gene list consisted purely of genes from a certain pathway. in a real application we will rather have to deal with gene lists that also contain 'noise genes' that do not belong to the respective pathway, or with a mixture of genes from several different pathways. in order to reflect this noise contribution, we extended our simulation strategy. along with the pathway genes, we sampled a fixed number of  <dig> random genes, that are not annotated to the pathway of interest. again, we computed similarity measures for theses sets and for random control sets and plotted the results . for the single pathway hsa <dig> we can again clearly differentiate between the random gene sets and the gene set containing pathway genes. absolute values of the similarity measures are lower compared to the 'clean' data set reflecting the noise contribution. the sample variance is again negligible. upon application to all pathways the random gene sets can again be clearly separated from pathway gene sets based on only a small number of genes. for five genes in a list containing  <dig> noise genes we can almost perfectly separate the majority of all pathways.

assessment of significance
in order to apply our method to real biological data, one has to derive a measure of significance indicating that the similarity of the gene list to a given pathway is not merely by chance. since we do not have a clear concept of probability distributions or statistical models of the highly complex pathway data, we applied a non-parametric sampling method to derive p-values for statistical significance. to this end, we sample for each pathway  <dig>  random gene lists of the same size as the gene list analysed and compute their similarities to the pathway domain signature. the p-value is defined as the fraction of data points in this empirical distribution larger than the similarity measurement of the original gene list.

simulation of pathway mixtures
further, we studied in how far this approach is applicable for gene lists that contain genes from more then one pathway in addition to noise genes. we performed a simulation study and estimated the expected sensitivity versus specificity tradeoff of our method, meaning how many of these pathways we can recover and how many are lost. to this end we simulated putative gene lists, each containing  <dig> genes from either  <dig>   <dig> and  <dig> different randomly selected pathways, and added further  <dig> noise genes â€“ so the total sizes of the simulated gene lists were  <dig>   <dig> and  <dig> genes, respectively. this procedure was repeated  <dig> times. pathways were considered over-represented when the resulting p-values from our method were below  <dig> . subsequently, we computed sensitivity and specificity percentages from the total number of false positive and false negative pathway assignments . the  <dig> pathways showing domain signatures of very low predictive power  as identified in the previous simulation were not regarded here. based on these findings, our method is able to recover pathways with high accuracy both in terms of sensitivity and specificity of more than 90%. the slightly lower specificity values may be explained by the partially hierarchical structure of kegg, with some of the pathways being part of other, more extended pathways 

application to screening data
in order to demonstrate the applicability of our approach, we tested the method on a data set generated in the department in a genome wide high-throughput screen aiming to identify modulators of cell adhesion. this screen resulted in a list of approximately  <dig>  candidate proteins. application of our method revealed a significant similarity to the domain signature of the kegg pathway hsa <dig> for glycosaminoglycan degradation. glycosaminoglycans  are linear polysaccharides built from disaccharidic units and they are covalently attached to core proteins, forming proteoglycans   <cit> . they provide mechanical links between the extracellular matrix and the cell surface, which influence signal transduction pathways and the cytoskeleton  <cit> . proteins involved in glycosaminoglycan degradation are essential components in the regulation of gag and pg functions. down-regulation of genes involved in glycosaminoglycan degradation induces loss of cell adherence, and tumor stroma contains proteoglycans and glycosaminoglycans often in higher proportion than normal tissue  <cit> . as the biological role of the kegg pathway hsa <dig> fits to the phenotype which we screened with the assay for cell detachment, we conclude that our method is suitable for application to high-throughput data, revealing relevant proteins for potentially any cellular process. furthermore, we could not detect a significant over-representation of hsa <dig> in a classical hypergeometric test based on available kegg annotations, indicating that our method adds additional information to gene lists compared to well established techniques.

CONCLUSIONS
we have established a technique to use predicted protein domains in order to test for enrichment of pathways based on the domain signatures of the gene lists of interest. in a simulation study we show that our method can reliably predict the pathway membership of genes that were previously removed from a database of known pathways. to our knowledge, this approach is unique to assign pathway membership based on sequence information. this is important for prediction of biological functions and the basis for systems biological approaches. we demonstrate the applicability of our method in the functional analysis of high-throughput sirna screening data and identify the enrichment of a biologically significant pathway in a poorly annotated gene list. this strategy will improve the field of gene set enrichment analysis and help to point out the biologically meaningful aspect of gene sets. the method is available as open source software in the bioconductor package domainsignatures  <cit> .

