BACKGROUND
the classification and comparison of the more than 50' <dig> protein structures deposited in the pdb  <cit>   is an essential step to extract valuable knowledge from protein structure data. today, the two most prominent protein structure classification schemes are scop  <cit>  and cath  <cit> . both partition proteins into domains. these domains are classified in a hierarchical manner: scop sorts protein domains into classes, folds, superfamilies and families while the four major levels of cath are class, architecture, topology and homologous superfamily. the scop database is mainly based on expert knowledge and, on the first level of the hierarchy, defines four major classes namely all α, all β, α/β as well as α + β describing the content of secondary structure elements in the domain. according to the scop authors, domains in a common fold have the same major secondary structures in the same arrangement with the same topological connections. in the same superfamily, domains share low sequence identities but their structures and, in many cases, functional features suggest that a common evolutionary origin is probable while domains clustered in the same family are likely to have a common evolutionary origin based on sequence similarity or functional evidence.

the building process of cath contains more automatic steps and less human intervention compared to scop. analogous to scop, cath starts at the class level defining three major classes of secondary structure content . the second layer, called architecture, clusters domains with common general features with respect to the overall protein-fold shape but does not take connectivity into account. the topology level is analogous to the scop fold level and groups structures that have a similar number and arrangement of secondary structure elements with the same connectivity. the last  level, homologous superfamily, clusters domains with a high structural similarity and similar functions, which suggest that they may have evolved from a common ancestor.

in the last years, scop and cath have been used to address various questions in structural biology and are further employed as training and gold-standard databases making them invaluable resources in structural bioinformatics. they have been used to study the interplay of protein structure and protein sequence evolution  <cit>  or to explore the connection between alternative splicing and protein structure evolution  <cit> .

besides those analyses, they are often used in the context of automatic protein structure classification and protein structure prediction when training and evaluating the respective methods. automatic protein structure classification  has become an important topic with the faster growing number of pdb structures in order to analyze structural and functional features of proteins. methods which are specifically suited for an accurate and automatic assignment of structures to their respective class often use scop or cath as reference and template datasets or to evaluate their performance. among those methods which heavily use scop or cath for structure prediction from the sequence are autoscop  <cit>  and pfres  <cit> . examples for methods to compute protein structure alignments and to predict similarities between structures are vorolign  <cit> , ppm  <cit> , fatcat  <cit>  or tm-align  <cit> . in the context of machine learning, various methods to discriminate between structural classes defined by scop or cath, e.g. using support vector machines  <cit> , have been published.

also, various methods which aim at the prediction of a proteins structure from the sequence  <cit>  have been developed in the last years, especially in the context of the casp experiments reviewed e.g. in  <cit>   where reference databases such as scop and cath are used in the prediction and the assessment phase. of course, differences in the reference sets will inevitably lead to differences in the assessment reflecting the performance with respect to the criteria used to construct the reference sets.

although the two hierarchies have become the gold standard in the field, their goals and the methods used to classify structures are not the same which leads to different classifications of the same protein. differences are found with respect to the domain partitioning of the protein chain, as well as in the classification of a domain into its corresponding structure class. differences and similarities between scop and cath have already been evaluated  <cit>  and those analyses allowed for valuable insights into the problems and challenges of classifying protein structures. since the most recent study  <cit>  the number of protein structures available in the pdb has more than doubled. this fact may have also increased the problem classifying all known structures in a consistent manner. in contrast to previous studies, we will focus on the extraction of consensus classifications based on the detailed comparison of the two hierarchies which should be a useful resource for gaining insights in functional and evolutionary relationsships and for  methods for protein structure classification and prediction. in more detail, we propose a new approach to compare scop and cath on the different levels of the two hierarchies using a similarity measure for sets of domains. based on an initial mapping of individual domains defined in both hierarchies and on the similarity of two sets of domains, we identify for each set from one hierarchy the corresponding overlapping set from the other hierarchy. this allows to map sets of domains on different levels of scop and cath and to analyze the differences and similarities of the two hierarchies in detail.

scop and cath are often used as 'standard of truth' datasets and inconsistencies and differences in the hierarchies unavoidably lead to problems in the training phase  as well as in the testing/benchmarking phase. proteins classified to be different by one hierarchy may indeed be similar according to the other classification leading to an overestimation of the errors made. to overcome those problems, we extract sets of pairs of protein domains from our scop-cath mapping which are consistently classified in both hierarchies. those pairs represent a novel and comprehensive benchmark  set which allows for a more consistent evaluation  of protein structure comparison and protein structure prediction methods.

finally, we utilize our mapping as orthogonal evidence in order to identify potential connections between different folds in one hierarchy which may be revealed via a connection of the two folds suggested by the respective other hierarchy. such connections between different folds  provide interesting starting points to further analyze the protein sequence-structure space.

RESULTS
datasets
for our analysis we use the most current version of scop  as well as cath version  <dig> . <dig>  which contains a similar number of proteins. the mapping containing the more recent cath version  <dig> . <dig> can be found on the supplementary website at . the website and the benchmark datasets will be updated regularly when new versions of scop and cath are released. scop  <dig>  contains 34' <dig> proteins deposited in the pdb  which are classified into  <dig> classes, 1' <dig> folds, 2' <dig> superfamilies and 3' <dig> families. cath comprises 30' <dig> pdb proteins which are partitioned into  <dig> domains and sorted into  <dig> classes,  <dig> architectures, 1' <dig> topologies and 2' <dig> homologous superfamilies. the union set of the proteins in the two classification schemes contains 36' <dig> proteins. 27' <dig> pdb proteins are classified in both hierarchies. please note that throughout this article we regard the following levels of scop and cath to correspond to each other: scop family/superfamily ↔ cath homologous superfamily, scop fold ↔ cath topology, scop class ↔ cath class.

detailed comparison of scop and cath
in the following we present the results of our analysis of similarities and differences between scop and cath. we will first discuss the results of mapping the different domain definitions of scop and cath onto each other, showing that there are surprisingly large differences between scop and cath with respect to their domain definitions. we will then use the set of mappable domains , restrict the respective hierarchies to those domains and compute the mapping of inner nodes of the two restricted hierarchies. we then analyze this mapping of inner nodes in detail which turns out to be very complex indicating many inconsistencies between scop and cath. for interesting examples see additional file  <dig>  the usefulness of the scop-cath mapping is demonstrated by two applications.

our analysis depends on whether we map scop to cath or vice versa. we present the results of the  mapping of scop → cath in the following. the results for the mapping of cath → scop are available in the supplementary material on .

domain mapping
in order to analyze the different domain definitions in scop and cath, we keep a domain defined in one hierarchy fixed and count how often one or more domains from the respective other classification are mapped onto it. a domain is mapped iff the overlap o, as defined in the methods section, is greater than  <dig>  i.e. we map all domains which have at least one residue in common with the query domain. the results are shown in table  <dig> and confirm results from previous studies  <cit>  that scop tends to define larger domains which may be represented by several, smaller domains in cath.

mapping of the domain definitions of the two hierarchies. an overlap threshold >  <dig> is used, i.e. all domains which share at least one residue are mapped onto each other. the scop row shows the number of cath domains mapped onto a single scop domain, while the cath row describes the number of scop domains mapped onto one domain defined in cath. a single domain in scop may be partitioned into up to  <dig> domains in cath. overall, about 20' <dig>  out of about 70' <dig>  scop domains map more than one cath domain while about 11' <dig>  out of about 80' <dig>  cath single domains map to more than one scop domain.

for our final mapping of domains we use a much more restrictive overlap threshold of to =  <dig> . this implies a unique and bijective mapping of domains onto each other but leaves many domains unmapped. including protein domains which overlap to only a small extent would lead to additional problems when comparing the two hierarchies, especially since domains are also classified according to their secondary structure elements and content . therefore, including secondary structure elements in the domain of one hierarchy while not including them in the other one is likely to lead to differing classifications. the strict threshold of  <dig>  assures that only domains which are defined as the same parts of the protein structures in scop and in cath are contained in the final dataset.

as shown in the following, differing domain assignments have a large impact on the resulting classification. out of the 27' <dig> proteins which are classified in both hierarchies, for only 19' <dig>  the domain definitions are similar enough leading to 56' <dig> domains in the final dataset . in scop, those domains are classified into  <dig> classes,  <dig> folds, 1' <dig> superfamilies and 2' <dig> families which means that on the other hand, for  <dig> folds,  <dig> superfamilies and 1' <dig> families already the domain definitions of scop and cath differ to such a large extent that they can not be meaningfully mapped onto each other. according to cath, the proteins belong to  <dig> classes,  <dig> architectures,  <dig> topologies and 1' <dig> homologous superfamilies. two architectures,  <dig> topologies and  <dig> superfamilies of cath remain unmapped. those values show a surprisingly large number of domains in either of the two hierarchies which are defined in a very different manner in the respective other classification scheme according to their domain boundaries and result in the fact that for only 70% of the proteins the classifications can be compared. moreover also only 70% of all scop families and cath superfamilies are retained in the mapping due to differing domain assignments.

mapping of inner nodes
given the set of mappable domains as discussed above, we computed the mapping of inner nodes of the two hierarchies as described in the methods section. the results are shown in table  <dig>  using the f-measure  we are able to identify for every inner node of scop the corresponding, i.e. best fitting, node in the cath. in such a mapping one would e.g. expect that scop superfamilies  map best to the cath homologous superfamily level.

number of inner nodes from a hierarchy level in scop mapping best to a node from some level in cath. consistent mapping are displayed in bold. two different f-measure thresholds of  <dig> and  <dig>  are shown. for example,  <dig> scop folds map best to a cath topology node given a threshold of  <dig> dropping down to  <dig> nodes for a f-measure threshold of  <dig> .

surprisingly, when using a f-measure threshold of  <dig> , the mapping of inner nodes and, therefore, the partitioning of the fold space according to scop and cath appears to be more complicated than expected and many inconsistencies can actually be observed. when we require a certain quality for a mapping, i.e. setting the f-measure threshold to  <dig> , a large number of inner nodes do not find a partner in the other hierarchy. scop and cath therefore define their sets of domains on every level of the hierarchies and for many cases very differently and a large number of unexpected mappings  can be observed. for example  <dig>  homologous superfamilies in cath can not be mapped to a corresponding scop superfamily or family for a f-measure threshold of  <dig> . the complete mapping and the observed differences between scop and cath can be interactively and comprehensively explored on .

comparison of domain pairs
in order to analyze the surprisingly large number of inconsistencies between scop and cath in more detail, we tested all pairs of domains in the set of mappable domains for their consistency in the respective other hierarchy. for example, we test if a pair from the same scop superfamily is also classified to be in the same homologous superfamily level in cath. the results of this pairwise comparison of the two hierarchies are shown in tables  <dig> and  <dig>  this analysis reveals a very large number of domain pairs which are not classified consistently in the two hierarchies. even on the family level, where the evolutionary relationship of the proteins should be clear, 98% of the pairs are consistently defined, more than 130' <dig> pairs classified into  <dig> different folds and  <dig> superfamilies are not classified in a consistent manner. more than 700' <dig> pairwise errors are observed on the superfamily and more than two million errors on the fold level. table  <dig> allows for a more detailed analysis of the mapping between the different levels of scop and cath and the errors that occur. for example  <dig> %  of the domain pairs from the same scop family are classified to be in different topologies  in cath.

shows the inconsistencies between scop and cath with respect to the levels of the scop hierarchy. the second column displays the number of consistent pairs  and the third column the number of inconsistent pairs. columns four and five display the number of distinct folds and superfamilies which account for the inconsistencies observed.

displays the detailed mappings of domain pairs in percent from scop  onto cath . columns sum up to 100% and table cells marked in bold display consistent mappings. please note that due to the very large number of pairs, even small percentage values correspond to many examples .

fortunately, many errors are contributed by a relatively small number of 'superfolds' . those fold classes also build clusters of similar folds which are further discussed in the context of interfold similarities below.

nevertheless, a large number of inconsistencies can not be explained by these well known superfolds. all inconsistent pairs can be interactively explored on . an interesting example is the pair d1bbxd_ and d1rhpa_. the domains are classified to belong to two different classes in scop  and are indeed very different on the structure level, but belong to the same homology level according to cath . a second example is the pair d1ku7a_ and d1j9ia_ . the two domains are indeed structurally similar . they are classified as different folds scop but belong to the same homology level in cath . more examples and structural superpositions of such pairs can be found in additional file  <dig> 

all inconsistencies will lead to problems when benchmarking automatic structure classification methods. also, they may lead to learning wrong concepts in the training phase of machine learning methods for protein structure classification for two reasons:  <dig> ) decision criteria are only learned with respect to one classification and  <dig> ) criteria are ignored in the learning phase because of inconsistencies.

extraction of a novel benchmark set
the pairwise comparison also allows us to extract sets of domain pairs which are consistently defined across the hierarchies and which may be used as novel benchmark sets to train and evaluate structure comparison methods. in particular, we extracted two sets of domain pairs:

• domains which are consistently defined as being similar in both hierarchies  corresponding to the consistent fold, superfamily and family pairs in table  <dig> 

• non-similar, negative domain pairs, i.e. domains in the same class, which are consistently classified into different folds.

also, to avoid an overrepresentation of very similar domains in the dataset, we clustered the domains according to their sequence similarity. all domains with a pairwise sequence identity of more than 50% were clustered together. for each cluster we retained only one representative domain in the final benchmark set . the sets can be obtained at . we also provide additional data, i.e. the details of the clustering process, which allows users to define their own benchmark sets using different sequence identity cutoffs in case that other sequence identity thresholds are appropriate for the specific application.

redfern et al. also used a consistent set between scop and cath in benchmarking their cathedral method  <cit> . our approach is designed to contain all pairs of proteins which are consistently defined between the two databases. this is an important feature for benchmarking structure classification methods in very detail on a large set of different fold topologies. in contrast, the redfern dataset, designed for a different purpose, focuses on consistently defined superfamilies whose members overlap to at least 80%. extracting protein pairs from these consistent superfamilies would lead to a large number of pairs in the benchmark set  which would be actually classified inconsistently between scop and cath.

our dataset can directly be employed for training and benchmarking novel methods developed in the field on different levels of the hierarchies and therefore different levels of structural similarity. in the following, we show that this novel benchmark set allows for a much more consistent evaluation of structure comparison methods which is not biased by inconsistencies in the different gold standards.

applications of the scop-cath mapping
in the following, we discuss the results of two applications of our detailed scop-cath comparison.

benchmarking structure-comparison methods
for benchmarking purposes, and as an examplary structure comparison method, we used the tm-align method which computes a structural alignment optimizing the tm-score  <cit> . the tm-score measures the similarity of two structures by an optimized rigid body superposition and a tm-score of above  <dig>  has been described to indicate structural similarity  <cit> . tm-align has been chosen for this study since the tm-score has already been used to discriminate between similar and non-similar proteins and should therefore allow for a good discrimination of similar and non-similar protein domains. furthermore, the method is quite fast allowing for the computation of the more than 5'000' <dig> structural alignments in reasonable time.

for our analysis, we compare the performance of tm-align on the complete benchmark set with the performance on the novel benchmark set proposed in this paper. the only difference between the two sets are the pairs being evaluated. while all pairs which are similar according to scop are evaluated in the original setting, our novel benchmark set contains only those pairs which are consistently defined to be similar or different in both scop and cath. therefore, while the domains contained in the sets are the same, the number of pairs being compared is much smaller in our novel benchmark set than in the original set .

in the following we will discuss the plots shown in figure  <dig> which evaluate the performance of tm-align on the two benchmark sets in detail.

plots  and  show the distribution of tm-scores of domain pairs within the same class/fold/superfamily/family. the distributions of the scores are very similar between both sets indicating that the main properties of the benchmark sets are similar. there is no apparent bias in the benchmark set proposed here towards domains which are easier to classify and both sets appear to be equally difficult regarding their similarity relationships.

plots  and  in row two as well as  and  in row three introduce a novel type of plot to benchmark the performance of structure comparison methods. the plots can be used for any structure comparison method to evaluate in detail the classification performance and in particular the errors made by a method. especially, they allow to estimate the performance of a method given a template database where members of the family and superfamily are missing and analyze in detail the number of domains for which problems occur in a set of domains and also quantify the dimension of the problem. plots  and  show the number of domains for which we observe problems according to the structural similarity detected by tm-align. for every query domain, we show how many domains from a different fold have a higher similarity score than the highest scoring member of the domain's own family , superfamily  or fold . on the x-axis we show all query domains for which we observe problems, while on the y-axis, the number of problematic cases for a query  is plotted. for example if there are ten domains from a different fold scoring better than the most similar member from the domain's own family a red cross ) would be plotted. similarly a blue dot is plotted if wrong proteins score better than a member of the query superfamily and a green x is plotted in the case of wrong domains scoring better than the own fold. also, domains in columns which contain blue dots would not be assigned to their correct folds in the case of missing family and superfamily members since the best hit comes from a different fold.

panels - in row three are similar to panels -, but instead of displaying the number of domains, they show the number of distinct folds  which score better than the respective own family, superfamily or fold.

comparing the plots that are computed based on the complete set of domain pairs  with the plots computed on the benchmark set of consistent domain pairs  we find that tm-score/tm-align produces errors for only half of the domains tested and the dimension of the errors  also strongly decreases.

the only difference between the two sets tested is the removal of pairs which are inconsistently defined between scop and cath. while we remove about 16% of the positive pairs  to obtain the consistent set, the number of errors observed is reduced by 53% . therefore, the removal of pairs which are inconsistently defined in scop and cath allows to over-proportionally reduce the number of errors. our conclusions are twofold: many errors reported for protein structure classification methods originate from pairs of domains which are similar to one another, but are classified differently by scop or cath. a different set of errors results from pairs that are e.g. classified in the same family but not similar enough to be distinguished from random pairs by a structure-based comparison method. using only pairs of domains consistently defined in scop and cath allows to reduce the amount of errors significantly and to separate erroneous behaviour of a method  from problems arrising due to pairs of domains for which even gold standards and experts disagree in their classification.

this figure is completed and summarized by the plots  and . to compute them, we sort the results obtained for every query domain according to their similarity scores. then, we count for every member of the query fold, how many distinct other folds score better than the respective fold member . the boxplot in - shows the errors for five specific fold members: for the best and worst scoring fold members, as well as for the fold member placed at the 25%, median and 75% positions in the sorted list. as, unfortunately, correct fold members score quite differently, this allows to assess the overall performance of fold members by showing how often wrong members score better than the selected five fold member representatives. the boxplot now simply summarizes these numbers for all queries. thus the boxplots give a summarized overview of the observed errors. by comparing the two boxplots for the comprehensive and the consensus sets we again find a substantial reduction of errors in the consensus set. while the number of errors for the best scoring fold member is generally small, the errors for the low-scoring fold members quickly increase in both sets, but much more drastically in the comprehensive set as compared to the consensus set. for example, if we look at the fold members scored in the lower quarter  of the fold members, we find  <dig> different random folds before a correct domain in the original dataset and only one fold in the novel benchmark set. this again indicates, that the number of errors as well as their quantity are significantly lower in the novel benchmark set compared to the original benchmark set.

overall, the novel benchmark set proposed here is much more consistent than the original pairwise relationships defined by scop. it results in a much smaller number of errors . due to the largely reduced inconsistencies the set should also be well suited for training novel machine learning algorithms for protein structure classification, since it may allow for learning more consistent concepts from the input data.

furthermore, we expect that the new benchmark set and also the new type of plots allow for a more instructive and objective evaluation of other structure comparison methods as well. the benchmark set has already been applied to measure the performance of ppm, vorolign and tm-align in  <cit> .

inter-fold similarities revealed by consistency checks
as a second application, we have used our mapping of the two hierarchies in order to identify similarities of different folds/topologies defined in one hierarchy which are implied by mapping them onto the same fold/topology in the respective other classification scheme. methods to detect possible interfold similarities have already been described for example by friedberg et al.  <cit>  and the cath developers  <cit> . here, we do not propose a novel approach to analyze such similarities from a structural point of view but utilize the orthogonal criteria and knowledge from two curated classification schemes to identify them. more specific, we search for folds f <dig> defined in scop which map to a topology level in cath t while this topology level in cath also maps to a second fold f <dig> in scop .

the identification of such similarities provides interesting insights into the differences and similarities of fold classifications in scop and cath and further allows to identify interesting links in the fold space. in order to propose a link we currently require the existence of at least five domains, which do not share a sequence identity of more than 50%, to support the link.

this analysis reveals a large number of singletons, i.e. folds/topologies with no link to another fold.  <dig> folds in scop as well as  <dig> topologies in cath turn out to be singletons. for relatively few folds/topologies similarities with other folds are identified which are interesting cases for further analyses in the context of protein structure and sequence evolution.

for scop, we identified  <dig> subgraphs, i.e. groups of folds which are connected via a link in cath to another fold.  <dig> of the groups represent graphs of size  <dig>  i.e pairs of folds while the other  <dig> subgraphs connect up to  <dig> different folds in scop. the largest graph contains a cluster of scop folds representing domains which are classified as rossmann fold topology  in cath but are splitted into  <dig> different folds in scop. another large cluster comprises β-sandwich proteins with greek-key topology which represent a cluster of  <dig> folds.

two further interesting examples are shown in figure  <dig>  figure 2b shows the interfold similarity of α-hairpin proteins in scop which are clustered in the same fold according to cath . part 2c shows a more complicated fold graph clustering proteins of immunoglobulin  and jelly-roll topologies  in a subgraph which also shows that those graphs do not necessarily form a clique.

CONCLUSIONS
protein structure classification is an essential step towards a deeper understanding into the interplay of protein structure and protein sequence evolution. here, we have carried out a detailed study of the similarities and differences between the two most prominent databases, namely scop and cath, which have become gold standards in the field and are used in various machine learning approaches and assessments of structure prediction and classification like the casp experiments.

we find that there are essential differences between the two classification schemes due to their way of partitioning proteins into domains . scop tends to partition domains into fewer but larger components than cath. in total, only about 70% of the domain definitions for proteins classified in scop and cath agree  and about one third of the families in scop and homologous superfamilies in cath can not be mapped on domains of the respective other hierarchy.

for the remaining set of about 20' <dig> proteins we then tested how well their classifications agreed with the classification in the respective other hierarchy. for this comparison we have used the f-measure to determine the similarity of two sets of domains on a specific level of two hierarchies. we find that both hierarchies show significant differences and often disagree in their way to partition the protein structure space also in cases of nearly identical domain definitions.

given those findings and our mapping of scop and cath hierarchy nodes, we extract a novel benchmark set of protein domain pairs which are defined consistently across both hierarchies. we show that benchmarking tm-align  on the novel benchmark set leads to a largely improved performance in comparison to the original set where the similarities as defined with respect to scop. this is due to the fact that errors  which occur due to inconsistencies are removed from the novel benchmark set. therefore, the benchmark set proposed here allows for a more objective evaluation of the performance of protein structure comparison methods as the remaining errors observed are more likely to be due to the method itself. furthermore, this set should have advantages for both, training and testing all kinds of prediction methods, especially machine learning approaches to protein structure classification since more consistent concepts may be learned in the training phase.

finally, the mapping between scop and cath provides interesting, orthogonal knowledge on the topology of the protein structure space which allows to identify non-trivial links between different folds in e.g. scop via their connection observed in cath. there are some very interesting and large  sets which may be clustered together in scop according to cath. among them are some known clusters of folds like the rossmann fold topology. but there are also several other clusters of folds which may be interesting starting points for a further analysis of their sequence-structure properties and may help to further understand the interplay of protein sequence and protein structure evolution, also in the context of alternative splicing  <cit> , as different structure classifications reflect different viewpoints and criteria on structural and evolutionary similarity.

