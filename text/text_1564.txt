BACKGROUND
expressed sequence tags  are generated by partially sequencing randomly isolated gene transcripts that have been converted into cdna. from their introduction in adams et al.  <cit> , ests have played an important role in the identification, discovery and characterization of organisms as they provide an attractive and efficient alternative to full genome sequencing. the resulting transcript sequences and their corresponding abundances are the main focus of interest providing the identification and level of expression of genes. important issues to be addressed in terms of design of a future study are:  a comparison among different cdna libraries of the same organism with the aim of detecting the least redundant library;  the determination of an "optimal" number of genes to be sequenced by the experimenter. indeed, these issues are relevant since, despite the novel advances in technology, see  <cit> , sequencing is still expensive and therefore suitable cost-effectiveness thresholds must be established. this suggests that there is the need for assessing the relative redundancy of various libraries prepared from the same organism in order to detect which one yields new genes at a higher rate. indeed, there are 'normalization' protocols which aim at making the frequencies of genes in the library more uniform thus typically improving the discovery rate. however, performing such protocols is also expensive. hence, the decision, whether to proceed with sequencing of a non-normalized library or to resort to a normalization procedure, has to balance carefully the involved costs: such a decision is necessarily based on statistical estimates of the coverage of the given sample, of the expected number of new genes in a future sample and on the future discovery rate. note that ideally one would like to sequence the smallest possible portion of the library and, based on the outcome, predict the tentative future sequencing well beyond the size of the given dataset.

the practical issues discussed above naturally translate in statistical problems which, given an initial sample of est, can be described as follows:

a) coverage: coverage can be seen as the proportion of genes in the library represented in the initial sample or, equivalently, the probability that a new read will not produce a new gene. the coverage estimate provides a first description of redundancy of the library.

b) expected number of new genes: having observed an initial sample of size n generated from the cdna library and estimated its coverage, prediction of outcomes of further reads is in order. the first question to answer is: 'how many new unique genes are expected to be detected in an additional est dataset of targeted size m?' such estimates provide, then, an overall measure of redundancy of the library with reference to a further est survey.

c) discovery rate: in addition to the expected number of genes in a future sample of size m, it is also important to establish the rate at which the probability of discovering a new gene decays as more and more reads are recorded. in other words, interest lies in determining the probability that the -th read leads to a new gene, given the observed initial sample of size n and regardless of the experimental outcome yielded by the m intermediate draws. the availability of the discovery rate as a function of the size of the future sample m, represents then a pointwise predictive measure of the evolution of redundancy as the sequencing ideally proceeds.

note that the combination of the measures under b) and c) provides a natural guideline for selecting the size of a future sample m. supposing the targeted number of new genes is j, the estimator in b) guides the selection of the minimum sample size m¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbqbgaqeaaaa@2e27@ which should lead to j new genes. then, one can resort to the discovery rate: in case it is relatively low around m¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbqbgaqeaaaa@2e27@, it may be convenient to reduce the size of the future sample in a way that the discovery rate does not fall below a threshold suggested by the problem at issue. in such a case, one obviously would not be able to achieve the targeted number j of newly observed genes: costs considerations may indeed suggest that, with such a low discovery rate, sequencing is too expensive. on the other hand, if the discovery rate around m¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbqbgaqeaaaa@2e27@ is still relatively high, one may decide to enlarge the survey size. moreover, the information conveyed by b) and c) is useful in comparing libraries and, again, it is worth considering these estimates together. indeed, suppose we have to compare two libraries and that, for a fixed size m of the additional sample, library  <dig> yields a larger expected number of new genes but a lower discovery rate in comparison with library  <dig>  if the sample size m is increased to m + m', for m' sufficiently large, the comparison between the two libraries can lead to different conclusions in the sense that a larger number of new genes is predicted for library  <dig>  this happens because library  <dig> features a lower discovery rate, which implies that, within the additional m' draws, the expected number of new genes is lower for library  <dig>  with reference to 'normalization' protocols, this means that the decision whether to carry it out or not should also depend on the foreseen sample size. for instance, the normalized mastigamoeba balamuthi data we analyze exhibit a higher discovery rate, with respect to the non-normalized one, for small m. but, since the discovery rate has a faster decay, it appears that, already for moderately large m, the effect of the 'normalization' is exhausted producing fewer number of new genes. the three questions raised above can be seen as particular instances of classical species sampling problems: indeed, in the present context each species takes on the meaning of gene and the population is given by the library. species problems appear in a variety of different applied situations such as astronomy, ecology, linguistics, machine learning, population biology. we now briefly recall well-known estimation methods which have recently been applied to est data and then outline the key ideas of our bayesian nonparametric approach.

estimation methods
the main frequentist tools, that are useful for inference on the cdna library properties described in the previous section, are based on the theory set forth in good  <cit>  and good and toulmin  <cit> , where nonparametric estimators for the sample coverage and the expected number of new species to be detected in a future sample of size m, given the initial sample, are provided. the estimator of the sample coverage in  <cit>  coincides with the proportion of distinct species represented by at least two units in the sample. good attributes the original idea to turing and this explains why it is usually referred to as turing estimator. the popular good-toulmin estimator for the number of new species to be observed in a future sample is derived in  <cit>  and, as a by-product, an evaluation of the discovery probability is achieved. recently, the interest in species sampling problems has remarkably grown, mainly due to their importance in genomics. indeed, mao  <cit>  studies various properties of the good-toulmin estimator and shows that it can be also viewed as a nonparametric empirical bayes estimator. in  <cit> , the authors suggest a parametric variation of the good-toulmin estimator. an alternative to it is presented in  <cit> , where the detection of ests from each gene in est sequencing is modeled by means of a poisson process whose intensity is governed by some unknown distribution. it is to be noted that all frequentist nonparametric approaches lead to reliable estimates for the number of new genes in an additional sample only if its size is not too large. for instance, if the size of the additional survey m is larger than the initial sample n, it is well-known that the good-toulmin predictor can become a monotone decreasing function of m: this leads to the paradox of predicting fewer new genes by enlarging the additional sample size m. even the nonparametric alternative proposed in  <cit>  yields reliable results only when m ≤ 2n. this fact is also outlined in  <cit> . hence, if one wishes to predict the number of new genes for large m, one needs to resort to a parametric framework. as we will see, the relative dimension of m with respect to n is not an issue in a bayesian nonparametric framework, and the expected number of new genes that will be discovered in m further reads is monotone increasing with respect to m.

the application of bayesian methods in this area of research is, to the authors' knowledge, quite modest even if the bayesian learning scheme is very well suited for making predictions with est data. an early contribution, based on a model for sampling from a finite population, is provided by hill  <cit>  where posterior estimates of the coverage are obtained. however, computational problems do not allow, in this approach, a direct and effective evaluation of the expected number of new species in a future sample. recently, lijoi et al.  <cit>  have proposed new bayesian nonparametric estimators for the problems a)-c) mentioned above. the prior distribution they employ is induced by a family of exchangeable gibbs random partitions. see pitman  <cit>  for an interesting review of recent advances and applications of the theory of gibbs random partitions. their application to a bayesian inferential framework is very useful since they provide a general scheme which encompasses some of the most notable nonparametric priors such as the dirichlet and the two parameter poisson-dirichlet process. in this paper, we apply the general formulas derived in  <cit>  with the two parameter poisson-dirichlet process as prior distribution. it will be seen that the resulting expressions can be evaluated exactly and do not need for any supplementary simulation scheme. moreover, such a bayesian approach does not incur in any problem for large values of m since all possible behaviors of future est data are incorporated in the probabilistic model.

RESULTS
est datasets
the datasets we analyze consist of ests samples obtained from cdna libraries from two different organisms: the amitochondriate protist mastigamoeba balamuthi  and naegleria gruberi libraries, prepared from cells grown under different culture conditions, aerobic and anaerobic. these data sets have been previously analyzed in  <cit> , where a full account of their preparation is detailed. it is worth mentioning that our approach assumes full-length cdna clones and high quality sequence reads.

therefore, possible errors associated with the clustering procedure are not considered. for the statistical identification and evaluation of types of clustering errors one may incur in est sequencing, the reader is referred to wang et al.  <cit> .

specifically, each est survey consists of n reads with k unique genes and corresponding frequencies n <dig> ...,nk, i.e. ni is the number of tags displaying the i-th gene in the initial sample of size n. clearly, ∑i=1kni=n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewaqaaiabd6gaunaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemoba4galeaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgrbwaa0gaeyyeiuoaaaa@38bf@. the reads can equivalently be clustered according to their level of expression, that is

 rl≡∑i=1ki,forl= <dig> ,...,s
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqadaaabagaemocai3aasbaasqaaiabdygasbqabagccqghhjiudaaewbqaaiabdmeajjabcicaoiabcuha7jabd6gaunaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemibawmaeiyfa0naeiykakcaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgrbwaa0gaeyyeiuoakiabcycasaqaaiabbagamjabb+gavjabbkhaybqaaiabdygasjabg2da9iabigdaxiabcycasiabikdayiabcycasiabc6cauiabc6cauiabc6cauiabcycasiabdohazbaaaaa@53b5@ 

where i is an indicator of a: i =  <dig> if a is true and  <dig> otherwise. note that s represents the maximum level of expression among unique genes in the sample and that the number of positive rl's is typically smaller than s.

source: susko and roger  <cit> 

coverage, estimation of the number of new genes and discovery rate
we applied the bayesian nonparametric method, detailed in the following section, to these datsets and obtained the following results. denote the unknown proportion of genes  belonging to the i-th class by pi. then, the coverage of the initial sample of size n is given by

 c=∑i:ni>0pi,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgdbwqcqgh9aqpdaaeqbqaaiabdchawnaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabcqda6iabd6gaunaabaaameaacqwgpbqaaeqaasgaeyopa4jaegimaadabeqdcqghris5aogaeiilawcaaa@3bf8@ 

which is precisely the proportion of unique genes represented in the initial sample. our estimates for the coverage are  <dig>  and  <dig>  for the non-normalized  and normalized  mastigamoeba, respectively. this means that, by virtue of the 'normalization', an initial sample of about half the size produces almost the same coverage. moreover, we get  <dig>  and  <dig>  for the aerobic  and anaerobic  naegleria, respectively: clearly, the tissue cultured aerobically achieves a remarkably higher coverage with an initial sample of the same size, which may lead to conclude that the sequencing of the aerobic tissue is more effective. however, such a finding could also be the consequence of a higher redundancy in the aerobic library. finally, it is worth noting that our results for the coverage match exactly the ones obtained in  <cit> , where the frequentist estimator described in  <cit>  was exploited.

turning attention to predicting the outcomes of future sequencing for the libraries at issue, we focus on the expected number of new genes in an additional sample of size m and on the discovery rate. the first index provides an overall measure of redundancy with respect to the additional sample of size m, whereas the discovery rate predicts the trend at which the discovery probability decays as more and more reads come in. if one adopts a bayesian nonparametric approach, these quantities can be estimated rigorously and exactly since such an approach is naturally designed for prediction. in contrast note that, as already anticipated, the good-toulmin estimator becomes highly variable and unstable if the size of the additional sample m is larger than the size of the initial sample n. in particular, the good-toulmin estimator often produces negative values as estimates for the number of new genes if m ∈  and almost always behaves badly for m > 2n. such a phenomenon can be seen in figure  <dig> for the two naegleria libraries. in order to overcome these problems, frequentist methods typically give up the flexibility of the nonparametric approach and resort to parametric models, whose fit can be a delicate issue. for instance, susko and roger  <cit>  resort to an approximated version of the good-toulmin estimator which assumes a parametric model for the expression levels rl.

in order to give a complete picture, it is important to accompany our point estimates with the 95% highest posterior density intervals, which represent the bayesian counterpart to frequentist confidence intervals . in tables  <dig> and  <dig> the results arising by the application of the bayesian nonparametric method are displayed.

non-normalized and normalized mastigamoeba libraries: the first column provides the size of the additional sample in % of the size of the initial sample, the second the actual size of the additional survey, the third presents the expected number of new genes and the fourth the discovery probability. the estimates in the third and fourth column are accompanied by the 95% highest posterior density intervals.

naeglaria aerobic and anaerobic libraries: the first column provides the size of the additional sample in % of the size of the initial sample, the second the actual size of the additional survey, the third presents the expected number of new genes and the fourth the discovery probability. the estimates in the third and fourth column are accompanied by the 95% highest posterior density intervals.

as for the mastigamoeba libraries, an interesting phenomenon takes place: the survey of the normalized library has achieved almost the same coverage  as the non-normalized library , but when considering an additional sample it exhibits a significantly faster decay in the discovery rate. figure  <dig> compares the discovery rate for the two libraries. it is worth pointing out that our estimates predict that the discovery rates associated to both libraries coincide for m =  <dig> yielding a discovery probability of  <dig> . for larger m the non-normalized exhibits a higher discovery rate. this implies that at some point also the estimates for the expected number of new genes in the additional sample will coincide: indeed, this is estimated to happen for m =  <dig>  for which  <dig> new genes are predicted to be identified from both libraries. hence, for m >  <dig> the expected number of new genes is systematically higher for the non-normalized library. for instance, if m =  <dig>  just  <dig> new genes are expected for the normalized library and  <dig> for the non-normalized. taking m larger, at some point even the highest posterior density intervals will not overlap anymore. such a behavior hints toward the fact that, in deciding whether to perform a 'normalization' protocol, the sizes of the samples to be drawn from the libraries is a variable to be taken into account.

as for the naegleria libraries the behavior is apparent in the sense that the anaerobic library systematically produces more new genes and the discovery probability is sensibly higher at the considered levels of m. note that the aerobic library presents a slightly slower decay rate but an extremely large m is required for matching the expected number of genes of the anaerobic one. figure  <dig> displays the estimated decay rate of the discovery probability for both libraries with the corresponding 95% highest posterior density intervals.

a bayesian nonparametric methodology
the primary aim of the bayesian approach to inference is prediction and bayesian methods are tailored for conveying the available information into prediction. in particular, for est sequencing, the main problem of frequentist methods is represented by the difficulty of incorporating not yet observed unique genes into the model. this can then produce unpleasant behaviors of estimators such as the one exhibited by the good-toulmin estimator discussed before. in contrast, the bayesian nonparametric approach naturally incorporates the fact that further sequencing will feature new unique genes and leads to consistent predictions.

in our framework we are going to consider a sample of n est data yielding kn distinct gene species with corresponding frequencies n = . clearly kn ∈ { <dig> ...,n} and ∑j=1knnj=n
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewaqaaiabd6eaonaabaaaleaacqwgqbgaaeqaaogaeyypa0jaemoba4galeaacqwgqbgacqgh9aqpcqaixaqmaeaacqwglbwsdawgaaadbagaemoba4gabeaaa0gaeyyeiuoaaaa@39d5@. our basic model is the so-called pitman's sampling formula  <cit>  which consists of a probability distribution for kn and the frequencies n of the form

 pr=∏i=1k−1n−1∏j=1knj−1
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiegacqwfqbaucqwfybgccqggbbwwcqwglbwsdawgaawcbagaemoba4gabeaakiabg2da9iabdugarjabcycasgqadiab+5eaojabg2da9iab+5gaujabc2fadjabg2da9maalaaabawaaebmaeaacqggoaakiigacqqf4oqccqghrawkcqwgpbqacqqfdpwccqggpaqkasqaaiabdmgapjabg2da9iabigdaxaqaaiabdugarjabgkhitiabigdaxaqdcqghpis1aagcbagaeiikagiae0hudenaey4kasiaegymaejaeiykakyaasbaasqaaiabd6gaujabgkhitiabigdaxaqabaaaaowaaebcaeaacqggoaakcqaixaqmcqghsislcqqfdpwccqggpaqkcqwgubgbdawgaawcbagaemoaaogabeaakiabgkhitiabigdaxawcbagaemoaaomaeyypa0jaegymaedabagaem4aasganiabg+givdaaaa@6608@ 

where σ ∈ , θ >  <dig>  n =  and n = a …  is the ascending factorial with  <dig> ≡  <dig>  formula  is a generalization of the famous ewens' sampling formula  <cit>  which can be recovered by letting σ tend to zero and it represents a important formula in modern probability theory. see  <cit> . recently, it has found many interesting applications for bacterial taxonomy  <cit> , clustering of microarray gene expression data  <cit> , mixture models  <cit> , linguistics  <cit> , among others.

in a bayesian nonparametric setting, one alternatively obtains model  by selecting the two parameter poisson-dirichlet process as a prior for the genes proportions within the library. this clearly makes the sequence of tags exchangeable, thus implying that the order of appearance of the tags does not influence probability assessments. such an assumption, which constitutes the bayesian analog of the frequentist assumption of independent and identically distributed data, is clearly reasonable in the context of est sequences. note that we implicitly assume that the sequence of tags can be extended to infinity. however, the size of the library represents an upper bound for the number of unique genes that will be observed and it is always finite: hence, all the estimates we are going to obtain will be finite.

as mentioned before, the bayesian nonparametric approach has the advantage of yielding, in a straightforward way, predictive distributions for future observations given the data. considering pitman's sampling formula, the probability of detecting a new gene from a future observation, given a sample of n tags containing k distinct genes, is

 / 

whereas the probability of re-observing the j-th unique gene coincides with

 /   j =  <dig> ...,k. 

see  <cit> . hence, the coverage coincides with

  <dig> - /. 

as already pointed out, in the analysis of ests one is also interested in evaluating:  the expected number of new genes that will be recorded in a further sample of size m and  the discovery probability, which is the probability of observing a new gene in the -th draw, given the initial sample of size n. the basis for deriving estimators for these quantities is represented by the distribution of the number of new genes to be observed in an additional sample given the initial sample. such a posterior probability, which can be seen as the predictive distribution for the outcome of additional m reads, is given by

 pm=n−1m+n−1∏i=kk+j−1σj×1j!∑i=0jiσ)m
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqadegabaaabagaemiuaa1aa0baasqaaiabd2gatbqaaiabcicaoiabdugarjabcycasiabd6gaujabcmcapaaakiabcicaoiabdqgaqjabcmcapiabg2da9maalaaabagaeiikagcccigae8hudenaey4kasiaegymaejaeiykakyaasbaasqaaiabd6gaujabgkhitiabigdaxaqabaaakeaacqggoaakcqwf4oqccqghrawkcqaixaqmcqggpaqkdawgaawcbagaemyba0maey4kasiaemoba4maeyoei0iaegymaedabeaaaagcdawcaaqaamaaradabagaeiikagiae8hudenaey4kasiaemyaakmae83wdmnaeiykakcaleaacqwgpbqacqgh9aqpcqwgrbwaaeaacqwgrbwacqghrawkcqwgqbgacqghsislcqaixaqma0gaey4diunaaoqaaiab=n8aznaabaaaleaacqwgqbgaaeqaaaaaaoqaaiabgena0oaalaaabagaegymaedabagaemoaaomaeiyiaecaamaaqahabagaeiikagiaeyoei0iaegymaejaeiykakyaawbaasqabeaacqwgpbqaaagcdaqadaqaauaabeqaceaaaeaacqwgqbgaaeaacqwgpbqaaaaacagloagaayzkaagaeiikagiaemoba4maeyoei0iaeiikagiaemyaakmaey4kasiaem4aasmaeiykakiae83wdmnaeiykakyaasbaasqaaiabd2gatbqabaaabagaemyaakmaeyypa0jaegimaadabagaemoaaoganiabgghildaaaaaa@84c8@ 

see  <cit>  for details on its derivation. from  bayes estimators  for both the expected number of new genes and the discovery probability have been obtained, within general gibbs random partition models, in  <cit> . the expected number of new genes observed in a future sample of size m coincides with

 em=∑j=1mjjm1j!∑i=0jiσ)m
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaqhaawcbagaemyba0gabagaeiikagiaem4aasmaeiilawiaemoba4maeiykakcaaogaeyypa0zaaabcaeaacqwgqbgadawcaaqaaiabcicaoiabdugarjabgucarggaciab=h7axjabc+caviab=n8azjabcmcapmaabaaaleaacqwgqbgaaeqaaagcbagaeiikagiae8hudenaey4kasiaemoba4maeiykakyaasbaasqaaiabd2gatbqabaaaaaqaaiabdqgaqjabg2da9iabigdaxaqaaiabd2gatbqdcqghris5aowaasaaaeaacqaixaqmaeaacqwgqbgacqgghaqiaawaaabcaeaadaqadaqaaiabgkhitiabigdaxagaayjkaiaawmcaamaacaaaleqabagaemyaakgaaaqaaiabdmgapjabg2da9iabicdawaqaaiabdqgaqbqdcqghris5aowaaewaaeaafaqabegabaaabagaemoaaogabagaemyaakgaaagaayjkaiaawmcaaiabcicaoiabd6gaujabgkhitiabcicaoiabdmgapjabgucariabdugarjabcmcapiab=n8azjabcmcapmaabaaaleaacqwgtbqbaeqaaaaa@6f28@ 

and the discovery probability turns out to be equal to

 d^m=θ+σθ+n+m.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgebargaqcamaadaaaleaacqwgtbqbaeaacqggoaakcqwgrbwacqggsaalcqwgubgbcqggpaqkaagccqgh9aqpdawcaaqaaggaciab=h7axjabgucarmaadmaabagaem4aasmaey4kasiaemyrau0aa0baasqaaiabd2gatbqaaiabcicaoiabdugarjabcycasiabd6gaujabcmcapaaaaogaay5waiaaw2faaiab=n8azbqaaiab=h7axjabgucariabd6gaujabgucariabd2gatbaacqgguaglaaa@4d87@ 

moreover, the highest posterior density intervals can be derived in quite a straightforward way from . the only point left to discuss concerns the specification of the parameters . in order to avoid subjective inputs in the model,  is fixed according to an empirical bayes rule which consists in choosing σ and θ that maximize  corresponding to the observed sample , i.e.

 =arg⁡max⁡∏i=1k−1n−1∏j=1knj− <dig> 
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqggoaakiigacuwfdpwcgaqcaiabcycasiqb=h7axzaajagaeiykakiaeyypa0jagiyyaemaeiocainaei4zac2aacbeaeaacyggtbqbcqgghbqycqgg4baeasqaaiabcicaoiab=n8azjabcycasiab=h7axjabcmcapaqabagcdawcaaqaamaaradabagaeiikagiae8hudenaey4kasiaemyaakmae83wdmnaeiykakcaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgrbwacqghsislcqaixaqma0gaey4diunaaoqaaiabcicaoiab=h7axjabgucariabigdaxiabcmcapmaabaaaleaacqwgubgbcqghsislcqaixaqmaeqaaaaakmaarahabagaeiikagiaegymaejaeyoei0iae83wdmnaeiykakyaasbaasqaaiabd6gaunaabaaameaacqwgqbgaaeqaasgaeyoei0iaegymaedabeaaaeaacqwgqbgacqgh9aqpcqaixaqmaeaacqwgrbwaa0gaey4diunakiabc6cauaaa@6d10@ 

it is worth pointing out how the structure of the data influences the choice of the parameters . indeed, the value of θ is linked to the number of distinct genes observed in the n-sample: the larger k/n the larger θ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf4oqcgaqcaaaa@2e79@. on the other hand, the value of σ is determined by the configuration of the frequencies n <dig> ...,nk. moreover, one may note that, for a given value of θ, the expected number of new genes in  is an increasing function of σ : as σ increases one expects that a larger number of new genes is going to be observed in a further m-sample. this is also confirmed by the behavior of em
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaqhaawcbagaemyba0gabagaeiikagiaem4aasmaeiilawiaemoba4maeiykakcaaaaa@34a5@ as σ varies. figure  <dig> suggests an almost linear increase of em
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaqhaawcbagaemyba0gabagaeiikagiaem4aasmaeiilawiaemoba4maeiykakcaaaaa@34a5@, as a function of m, and accordance with linearity is higher the closer σ is to  <dig>  in contrast, when σ is low and close to  <dig> the function is concave and em
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaqhaawcbagaemyba0gabagaeiikagiaem4aasmaeiilawiaemoba4maeiykakcaaaaa@34a5@ increases at a lower rate as σ increases.

in order to further evaluate the goodness of the estimation method, we implemented a cross-validation procedure. given a dataset of size n, this consisted in randomly drawing without replacement a sub-sample of size n/ <dig>  on the basis of this sub-sample, we have fixed, according to , the values of . then, we have computed the expected number of new genes in the remaining part of the original sample using  and checked whether the estimated number of new genes is close to the actually observed number of new genes. the outcome of such an analysis is satisfactory in the sense that, in the great majority of the performed experiments, the 95% highest posterior density intervals capture the actual number of new genes. consider first the normalized mastigamoeba library and a sub-sample of size n =  <dig> ≈  <dig>  for instance, when such a sub-sample consists of k =  <dig> distinct genes with expression levels r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  then the actual number of new genes in the remainder of the original sample is j* =  <dig>  basing on these data, the bayesian nonparametric estimator e181
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaqhaawcbagaegymaejaegioagjaegymaedabagaeiikagiaegymaejaeginaqjaeginaqjaeiilawiaegymaejaegioagjaegomaijaeiykakcaaaaa@3918@ yields an estimate of  <dig> with 95% highest posterior density interval . as for the non-normalized mastigamoeba library, sub-samples of size n/ <dig> ≈  <dig> were taken. for instance, a sub-sample consisting of k =  <dig> distinct genes with expression levels r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  r <dig> =  <dig>  implies that the remainder contains j* =  <dig> new genes, the number to be predicted. in such a case, the bayesian nonparametric estimator e357
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaqhaawcbagaeg4mamjaegynaujaeg4nacdabagaeiikagiaegomaijaegonayjaegymaejaeiilawiaeg4mamjaegynaujaegioagjaeiykakcaaaaa@392c@ predicts  <dig> new genes with 95% highest posterior density interval .

CONCLUSIONS
in this paper we have presented a bayesian nonparametric approach, which relies on pitman's sampling formula, for prediction problems arising in sequencing of est libraries. this provides a fully probabilistic model which conveys, in a statistically rigorous way, the available information into prediction. no parametric assumption is made and the prior is fixed using an empirical bayes approach. the resulting estimators are applied to four est libraries and lead to interesting and coherent predictions of the outcome of additional sequencing. the arising information is of great value for researchers providing guidelines in: establishing the quality of a certain library; deciding whether to perform a normalization protocol; choosing whether to proceed with sequencing from a certain library; determining the size of an additional est survey etc.

it is important to remark that our bayesian nonparametric approach does not feature problems usually exhibited by frequentist methods. in particular, no ad-hoc adjustments or introduction of parametric components is necessary for predicting future reads if their number is larger than the initial survey. finally, the estimators presented here can be easily adapted to take into account joint data from multiple libraries leading to bayesian analogs of the estimators set forth in  <cit> .

