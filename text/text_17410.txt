BACKGROUND
through alternative splicing at multiple sites, a single transcriptional unit may give rise to a complex array of isoforms – a 'mini transcriptome,' or single-gene transcriptome . considerable effort is being invested to assemble a genome-wide compendium of sites of transcript and peptide variations  <cit> , the guiding principle being that combinatorial splicing may profoundly expand the proteome, and consequently the phenotypic repertoire, without increasing the number of structural genes  <cit> .

such phenotypic elaboration may arise through simple combinations of individual 'modular' domains, or through cooperative effects from multiple variable domains that interact functionally  <cit> . the latter complication imposes significant regulatory demands – for the efficient selection of combinations of viable combinations – which may in part underly the expansion of the non-coding genome  <cit> . to understand gene function more fully, we must determine how all the possible alternative domains are actually combined by the rna splicing process into working molecules. this requires structural analysis of large numbers of full-length transcripts expressed from each gene, approaching numbers currently available in whole-genome full-length cdna libraries derived from whole-genomes  <cit>  to ensure adequate representation of the less abundant variants.

est, microarray, and proteomics methodologies for large-scale alternative splicing surveys share the limitation that by sampling fragments of macromolecules they cannot capture most intramolecular linkage information. that is, they primarily yield marginal splicing frequencies but not correlations. the latter are invaluable for discerning the tissue- and cell-specific functional differentiation of splice variants  <cit> . full-length cdnas, by contrast, provide diaries of intramolecular splicing choices. we have developed robust methods for production of full-length, nonrecombinant, statistically representative single-gene libraries   <cit> . an sgl is a 'vertical' sample of the transcriptome, representing its basic building block, the sgt.

initial analyses of moderate-scale sgls  <cit>  reveal fascinating developmental changes in both the extent and pattern of splicing linkage. these represent developmental changes in the regulatory programs that establish the selection rules for combining variable domains into functional ensembles, thus establishing the molecular phenotype. recent developments in production of large-scale full-length cdna libraries and high-throughput sequencing techniques  <cit>  promise to provide this information at high resolution and on a meaningful scale.

as large-scale sgt data become available, reliable statistical methods will be required to discern potentially complex splicing interactions. two features of such data have direct relevance to the present work:  high-order splicing correlations, which reflect high-order functional interactions within single molecules, and  very sparse representation of the complete configuration space, which presents a fundamental challenge to statistical analysis. data sparseness results from a they typical situation where several alternative splice loci have low-frequency variations, rendering a substantial fraction of splice combinations as simply improbable.

here we present tools for statistical analysis of high order splicing correlations in full-length sgls

a thorough statistical analysis of alternative splicing  begins with full-length cdna libraries that are unbiased, representative samples of the mrna populations,  presents a complete discussion of marginal splicing frequencies as well as correlations, including tissue-to-tissue variations in these parameters, and  employs a stochastic splicing model where the observed data is a likely outcome. we present tools for analysis of splicing correlations in full-length sgls, with careful attention to handling of sparse contingency tables. we provide simple, novel graphical visualizations that accentuate coordinated changes within groups of variable loci. the data – human low voltage-activated calcium channel gene  sgls from fetal and adult whole brain – derive from recent work  <cit> , where we discuss in detail marginal splicing frequencies and their developmental changes, as well as splicing correlations, effects on ion channel function of alternative splicing at individual alternative domains, and high-order, non-additive functional interactions among multiple alternative domains. the present work builds on that material, presenting a detailed exposition of the statistical model, which was beyond the scope of that publication, a thorough analysis of splicing correlations, and visual tools that will prove generally useful in studies of splicing linkages. since our focus is correlations, we limit our discussion of marginal frequencies to the extent to which it informs our understanding of correlations. though we employ a particular dataset and splicing model for the sake of illustration, these analytical tools are not model-specific and are generally applicable to other types of multivariate data.

methods
cacna1g gene and sgl data
table s <dig> presents the data for the present statistical analyses, listing the frequencies of full-length splice variants in whole-brain sgls from two developmental stages of expression of the human calcium channel gene cacna1g, described in reference  <dig>  marginal frequencies at the separate alternative loci calculated from this data are given in table s <dig>  and are plotted in figure s <dig> with confidence intervals. figure  <dig> is a schematized cacna1g gene structure illustrating the nine alternatively spliced exon segments  and a splicing graph depicting the ways in exons may be joined by alternative splicing. there are  <dig> distinct structures, most of which have not been observed, and in fact may not be expressed.

definitions
an alternative splice locus is a categorical variable representing a region of the primary transcript that is subject to alternative splicing . we consider alternative splicing a stochastic process, so that every alternative sequence configuration cs, of any set of loci s, is a random variable with splicing probability ps. we say that a locus j has a strong splicing bias if any pj approaches  <dig>  for a single locus j, the configuration cj may be represented by an integer between  <dig> and gj -  <dig>  where gj is the number of sequence alternatives, or multiplicity, of j. for a cassette exon, spliced in or out as a unit, it is often convenient to assign  <dig> to the insertion and  <dig> to the deletion, although the reverse may occasionally be more convenient – if the insertion is rare, for example. what defines a locus may also be flexible, depending on the purpose. an isolated cassette exon unambiguously defines a single binary locus, with multiplicity  <dig>  two adjacent alternatively spliced cassette exons, however, may be considered two loci with g =  <dig> or a single locus with g =  <dig>  if the two exons are mutually exclusive then the best representation may be as a single locus with g =  <dig>  figure  <dig> illustrates the nine alternative loci in the canca1g gene.

if splicing at separate loci is independent  <cit> , the expected frequency of each splice variant v is equal to its independent stochastic expectation

φv=∏j=1kfj,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfgpgzdawgaawcbagaemodayhabeaakiabg2da9maarahabagaemozay2aasbaasqaaiabdqgaqbqabagccqggoaakcqwg2bgdcqggpaqkcqggsaalcawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaleaacqwgqbgacqgh9aqpcqaixaqmaeaacqwgrbwaa0gaey4diunaaaa@42ac@

where fj is the marginal frequency of cj, the configuration of locus j in splice variant v. the number of possible full-length transcript variants is

nt=∏j=1kgj.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobgtdawgaawcbagaemivaqfabeaakiabg2da9maarahabagaem4zac2aasbaasqaaiabdqgaqbqabaaabagaemoaaomaeyypa0jaegymaedabagaem4aasganiabg+givdgccqgguaglcawljagaaczcamaabmaabagaegomaidacagloagaayzkaaaaaa@3ea3@

computations and illustrations were made in the r programming language  <cit> .

mutual information methods
we quantify splicing linkage between a pair of loci i and j with the mutual information i, which measures the reduction in uncertainty about the configuration of one locus when that of the other is specified  <cit> : i = h + h - h, where h + h is the expected entropy of cij given independent splicing at the observed marginal frequencies, and h = -∑ijp·log p is the observed entropy.

while mutual information is non-negative, it is useful to define a directed, or 'configuration-specific' mutual information, which may be negative. the sign gives the direction of correlation between a specific pair of configurations, called the reference configurations. for example, if we define the reference configuration at a pair of binary loci as the insertion at both loci, then a negative value means that insertion at one locus correlates with deletion at the other. the choice of reference configuration is arbitrary, and reversing the reference configuration for one locus simply reverses the sign of the configuration-specific mutual information.

the dependency, d = i/h, is the mutual information normalized to its maximum possible value, the total entropy of the 'dependent' locus, i. it measures the degree to which the independent variable is a predictor of the dependent variable: the one with lower marginal entropy has a higher dependency on the other.

the linkage change index
to quantify developmental changes in linkage we introduce the linkage change index, sd . for a given pair of loci, we define the linkage vector d = , with components x – the splicing linkage in the fetal population, and y – the adult linkage. the difference y - x is a simple measure of the developmental change in linkage: it is zero when linkage is the same  at both stages and maximal  for a complete reversal of linkage . scaling to the length of d gives
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@ = a/b, measures displacement of a point estimator x <dig> from the center of mass of a distribution p.

sd=/|d|=sin θ−cos θ=2sin φ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqaaeeqaaiabdofatnaabaaaleaacqwgebaraeqaaogaeyypa0jaeiikagiaemyeaknaeyoei0iaemieagnaeiykakiaei4la8iaeiifawnaemiraqkaeiifawhabagaeyypa0dcbigae83camnae8xaakmae8nba4maeeiiaacccigae4hudenaeyoei0iae83yammae83ba8mae83camnaeeiiaaiae4hudehabagaeyypa0zaaoaaaeaacqaiyagmasqabagccqwfzbwccqwfpbqacqwfubgbcqqggaaicqgfgpgzaaaa@52ab@

where θ is the angle between d and the x axis  and φ = θ - π/ <dig> is the angle between d and the transformed x axis, x', representing unaltered linkage. in polar coordinates, d ranges in magnitude between about  <dig> and  <dig>  times the larger of x and y, and has phase φ, the relative developmental change in linkage. note that sin φ = y'/|d|, so sd is proportional to y', the perpendicular displacement of d from the x' axis.

sd is a more straightforward index of linkage change than either φ or sin φ : sd is positive when splicing correlation becomes more positive or less negative with development , and if the correlation actually reverses direction from negative to positive, then sd exceeds  <dig> . likewise, sd <  <dig> reflects increasing negative , or decreasing positive correlation, and sd < - <dig> means the linkage reverses, from positive to negative . figure 2c plots sd as a function of the phase φ, annotated corresponding to figure 2b.

assessing higher-order linkages with log-linear models
given a table of frequencies for nt splice variants , it is natural to arrange the data in a k-dimensional contingency table with k variables  of gj categories  each. this simplifies calculation of marginal frequencies. we fit the complete contingency table to a log-linear model  <cit> , giving the log-frequency of each splice variant as a sum of coefficients us, which measure the extent of mutual correlation among a set of loci s with configuration cs. the most complete, or saturated, log-linear model is:

log p=grand meanindependencemain effects⋯order k-1u+u1+u2+⋯+uk+u12+⋯+uk− <dig> k+⋯+u <dig> ..k     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaeqacaaabaqbaegabygaaaaabaacbigae8hbawmae83ba8mae83zacmaeeiiaaiaemicaanaeiikagiaem4qam0aasbaasqaaiabigdaxiabikdayiabiodaziabc6cauiabc6cauiabc6cauiabdugarbqabagccqggpaqkaeaacqgh9aqpaeaacqqgnbwzcqqgybgccqqghbqycqqgubgbcqqgkbazcqqggaaicqqgtbqbcqqglbqzcqqghbqycqqgubgbaeaaaeaacqqgpbqacqqgubgbcqqgkbazcqqglbqzcqqgwbaccqqglbqzcqqgubgbcqqgkbazcqqglbqzcqqgubgbcqqgjbwycqqglbqzaeaaaeaacqqgtbqbcqqghbqycqqgpbqacqqgubgbcqqggaaicqqglbqzcqqgmbgzcqqgmbgzcqqglbqzcqqgjbwycqqg0badcqqgzbwcaeaaaeaacqwivlctaeaaaeaacqqgvbwbcqqgybgccqqgkbazcqqglbqzcqqgybgccqqggaaicqqgrbwacqqgtaqlcqaixaqmaeaaaaaabaqbaeaabygaaaaabaaabaaabaaabagaemydauhabagaey4kascabagaemydau3aasbaasqaaiabigdaxaqabagccqggoaakcqwgdbwqdawgaawcbagaegymaedabeaakiabcmcapiabgucariabdwha1naabaaaleaacqaiyagmaeqaaogaeiikagiaem4qam0aasbaasqaaiabikdayaqabagccqggpaqkcqghrawkcqwivlctcqghrawkcqwg1bqddawgaawcbagaem4aasgabeaakiabcicaoiabdoeadnaabaaaleaacqwgrbwaaeqaaogaeiykakcabagaey4kascabagaemydau3aasbaasqaaiabigdaxiabikdayaqabagccqggoaakcqwgdbwqdawgaawcbagaegymaejaegomaidabeaakiabcmcapiabgucariabl+uimjabgucariabdwha1naabaaaleaacqwgrbwacqghsislcqaixaqmcqggsaalcqwgrbwaaeqaaogaeiikagiaem4qam0aasbaasqaaiabdugarjabgkhitiabigdaxiabcycasiabdugarbqabagccqggpaqkaeaacqghrawkaeaacqwivlctaeaacqghrawkaeaacqwg1bqddawgaawcbagaegymaejaegomaijaeg4mamjaeiola4iaeiola4iaeiola4iaem4aasgabeaakiabcicaoiabdoeadnaabaaaleaacqaixaqmcqaiyagmcqaizawmcqgguaglcqgguaglcqgguaglcqwgrbwaaeqaaogaeiykakcaaaaacawljagaaczcamaabmaabagaeg4mamdacagloagaayzkaaaaaa@c91e@

where subscripts refer to alternative splice loci. each full-length splice variant c <dig> ..k has a unique equation , giving nt equations in all. the saturated model has a term for every possible subset of loci plus an intercept, u, with ∑j=0k
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewaqaamaabmaabaqbaeqabiqaaaqaaiabdugarbqaaiabdqgaqbaaaiaawicacaglpaaaasqaaiabdqgaqjabg2da9iabicdawaqaaiabdugarbqdcqghris5aaaa@37b0@ terms in all. with all binary loci, the saturated model has 2k equations of 2k terms each. an unsaturated model is hierarchical if the presence of a u-term for any group of loci s implies a u-term for every subset of s.

for any locus j in a set of loci s, the sum of us over all configurations of j is constrained to zero. thus, for any cs and c′s
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgdbwqgaqbamaabaaaleaacqwgtbwuaeqaaaaa@2f22@ differing only in the configuration of a binary locus j, us = -us. if all loci in s are binary, then all terms us have the same magnitude, |us|. working with all binary loci thus simplifies the analysis, but does not otherwise alter the capabilities of the method. we use normalized frequencies, rather than total counts, to allow direct comparison of populations of different sizes without rescaling

accuracy index
the 'accuracy,' a
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@, measures the extent to which a point, x <dig>  is centered within a distribution, p. this has the advantage of extreme simplicity: it is the ratio of areas a and b in figure 2d, where a is always the smaller of the two areas ∑{p: x ≤ x0} and ∑{p: x ≥ x0}. for a continuous pdf the two areas are ∫−∞x0pdx
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawdxaqaaiabdchawjabcicaoiabdiha4jabcmcapiabdsgakjabdiha4bwcbagaeyoei0iaeyohiukabagaemieag3aasbaawqaaiabicdawaqabaaaniabguiiydaaaa@3b25@ and ∫x0∞pdx
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawdxaqaaiabdchawjabcicaoiabdiha4jabcmcapiabdsgakjabdiha4bwcbagaemieag3aasbaawqaaiabicdawaqabaaaleaacqgheispa0gaey4kiipaaaa@3a43@. note that both a and b include p. this is by design, as it yields a meaningful result for any x <dig> and distribution p. in the extreme low-variance limit, for example, if the p is an impulse δ, then a
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@ =  <dig> for all x except x = c, where a
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfaefqaaa@3821@ =  <dig>  the accuracy is thus always defined, and ranges from  <dig>  when x <dig> lies completely outside the distribution, to  <dig>  when x <dig> is the median of the distribution.

supplementary figures, tables, and expressions
figures, tables and expressions with labeled beginning with 's' are in additional file  <dig> 

RESULTS
some interesting developmental splicing changes are evident simply form inspection of table s <dig>  for example, the adult brain expresses a complement of structures that is very distinct from the fetal-brain population. a large portion of the difference is attributable to a developmental switch from insertion of segment  <dig> to 25c between constitutive exons 25b and  <dig>  a broad array of other changes occur as well, most due to changes in splicing correlations. for example, the fetal brain expresses a significantly more diverse population of transcripts  than the adult brain, even though the marginal entropies of the alternative loci are highly similar and predict populations of equivalent diversity. see reference  <dig> for a detailed discussion of these matters.

clock plots
the statistical uncertainty, indicated by the dispersion around each data point in figure 3c–e, for example, is obtained from  <dig> simulated populations for each tissue, sampled by monte carlo from the empirical bayes estimate  of the distribution of splice variants in each tissue. for every pair of loci in each tissue, the mutual information  values were binned into a histogram. because splicing in the two tissues may safely be considered independent, the two-dimensional joint distribution for a pair of loci is the cartesian cross product of the resulting bin-counts vectors from the two tissues. the error ring encloses the 95% most-probable values in this case.

figures 3d and 3e allow comparison of mutual information and dependency for the same pairs of loci, in this case all pairs involving locus  <dig>  the data represent  <dig> populations sampled from the empirical bayes estimate, and error rings enclose the 95% most-proabable values for each pair of loci.

pairwise linkage grids
we have introduced the linkage change index, sd, to quantify these changes . figure 4c plots sd and |d| for those pairs of loci with nonzero sd at 99% significance or greater. the left grid shows the dynamic range of directional changes, while the right shows the overall magnitudes of the linkages involved. an interesting point of comparison is the values within the white-bordered box representing loci 25c and  <dig>  these cells are quite dim within the sd grid, whereas they are bright in the other grids. this shows that, while there is strong splicing dependency between these two loci at both stages, and there is a statistically significant change in linkage with development, the extent of change is actually not very great in comparison to that at other pairs of loci. as we noted above, though, the dependency of 25c on  <dig> undergoes a greater developmental change than the reverse dependency; this is more apparent in the plot of sd than in the other plots. other significant changes are much more obvious here as well.

spliceprints
up to this point we have considered splicing linkage between pairs of loci. it is possible for splicing to involve correlations of higher order. for example a segment may be deleted at locus  <dig> only if segments are inserted at both loci  <dig> and  <dig>  this situation necessarily entails pair-wise correlations between loci  <dig> and  <dig> as well as  <dig> and  <dig>  but a three-way linkage is more intricate than a collection of disjoint pair-wise linkages.

statistical interactions between splicing events at separate sites may be expected to relate directly to functional interactions between the alternatively spliced domains. it is only through this mechanism that alternative splicing may exert control over the function of the expressed proteins. the nature of physico-chemical interaction between domains in a protein is extremely complex, generally unpredictable, and not limited to "nearest-neighbor" effects. this means that functional interactions may be expected between arbitrarily many domains, and that functional effects of a configuration change may be highly nonlinear, depending on the complement of variable domains at other sites in the same protein. we have demonstrated highly nonlinear  functional effects, exactly of this nature, in the cacna1g ion channel electrophysiology  <cit> . thus we should not be surprised to find higher-order splicing interactions, reflecting control of domain combinations at multiple loci, and we do not expect this phenomenon to be limited to the present system.

we model multi-site alternative splicing with a log-linear model  <cit>  to quantify higher-order linkages. figure  <dig> displays the amplitudes of the log-linear coefficients from two developmental stages, for all terms of order  <dig> or higher in the saturated model. the contributing loci are not identified here, but terms for subsets of the same cardinality are grouped together between vertical rules. in each plot, values above the zero line are coefficients derived from the empirical bayes estimate of the experimental population. for comparison, traces below the midline plot mean values from  <dig> monte carlo populations. because only the magnitudes are plotted, the ordinate values increase with distance from zero both upward and downward. differential splicing regulation in the fetal and adult brain appears as different patterns in the upper and lower boxes. notice that independent splicing gives coefficients that lie on the zero line, and that the more compressed fetal pattern indicates a lower level of splicing correlations, especially at higher orders. although we focus only on the magnitudes of the log-linear coefficients in the present work, a wealth of information is present in their signs, which would admit a multidimensional extension of the clock plot analysis. also, of course, the spliceprint is not limited to log-linear coefficients, and the coefficients may be presented in any desired order on the abscissa.

minimal-linkage models
we may wish to identify the smallest set of interactions that can account for the data, within bounds of statistical significance. it may be surprising, for example, that some genes display nearly independent splicing at multiple sites, even in rather complicated tissues  <cit> . in such cases one or two pair-wise interactions may account for any deviations from independence. we may identify those by first ranking the pairs in order of decreasing mutual information, then define a hierarchical model with only the most highly correlated first-order interaction terms. a least-squares fit to this model gives coefficients for only those interactions. we then ask whether this represents a possible parent distribution for the observed population.

a simple way to do this is to sample monte carlo populations from the fitted distribution, with the same number of transcripts, n, as the experimental population. for each mc population we then calculate its likelihood of arising from a reference distribution, ρ, for example:

ρ=n!∏v=0nt−1pvnv/nv!     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfbpgccqgh9aqpcqwgobgtcqgghaqidaqewbqaaiabdchawnaadaaaleaacqwg2bgdaeaacqwgubgbdawgaaadbagaemodayhabeaaaagccqggvawlcqwgubgbdawgaawcbagaemodayhabeaakiabcgcahawcbagaemodaynaeyypa0jaegimaadabagaemota40aasbaawqaaiabdsfaubqabawccqghsislcqaixaqma0gaey4diunakiaaxmaacawljawaaewaaeaacqai0aanaiaawicacaglpaaaaaa@4a16@

this is a multinomial distribution of nt splice variant classes, v, each with expected probability pv and abundance nv in the sample: ∑nv = n. the reference distribution is in fact arbitrary: we are not interested in the exact likelihood of our data; rather, we wish to find a model that generates populations of likelihood similar to the data with a given reference distribution. the fraction of mc likelihoods not exceeding the observed value measures the evidence against the model. this approach is an approximation to the method of posterior predictive assessment of model fit of gelman et al.  <cit> . expression  constitutes their statistic t. we seek a model with sufficient departure from independence to be consistent with the observed data.

saturated models
peptide domains that interact functionally are likely to exhibit statistical correlations reflecting enrichment of productive interactions or suppression of detrimental ones. figures  <dig> and  <dig> show that many individual loci participate in pair-wise interactions with multiple other loci. where these reflect functional interactions, we anticipate two important consequences, due to the fact that they occur within a close-packed, folded protein:  they are likely to be transitive in nature – e.g., if loci a and b interact and loci b and c do, we expect that a and c will as well. furthermore, we should expect that splicing at c will have effects that depend on a and b together, i. e.  a set of loci may influence protein function as an integrated ensemble, rather than a collection of functionally separable modules. it then follows that their splicing regulation will exhibit mutual, higher-order interdependencies. unsaturated models cannot capture these correlations accurately: a low-order model, as in figure  <dig> for example, is from this perspective an oversimplification, emphasizing a few low-order interactions at the expense of a wealth of information in the higher orders. though we correctly identify the most highly correlated domain pairs, this gives no clue how pairs may link up within a molecule, i.e., evidence for ensembles of functionally interacting protein domains.

empirical bayes methodology
we are not interested in the precise values of the coefficients as much as the relative amplitudes of the same coefficients from two different populations, as compared side-to-side in figure  <dig>  for example. from this we may discern statistically significant developmental shifts in splicing linkages. this requires that we estimate the variance of the log-linear coefficients. these may be obtained from a saturated model fit to monte carlo populations sampled from an estimate of the parent distribution.

the simplest such estimate is the observed distribution itself . while this makes no assumptions about the underlying mechanism, it assigns zero probability to the unobserved splice forms, which is obviously unreasonable. increasing the experimental sample size, even by an order of magnitude, may not make the bootstrap applicable if the number of alternatively spliced loci is even moderately large : the probability space expands geometrically with the number of variables, so unless the sample is vastly larger than the number of classes the table of observed frequencies will contain a large number of zeros . this is exaggerated when splicing at any locus is strongly biased, as is common . transcripts that combine rare splice configurations at multiple loci thus have a very low expectation, though we cannot assume that any empty cells would persist if we continued data collection indefinitely.

the empirical bayes approach  <cit>  enables an estimate of the parent distribution with plausible nonzero probabilities for the unobserved classes. this estimate  incorporates the observed distribution  with our current understanding of the underlying process . we have found the 'pseudo-bayes' estimator of bishop et al.  <cit> , a linear shrinkage estimator chosen for its simplicity, to be entirely adequate. improvements may be made to the estimator – with nonlinear shrinkage, for example, but typically at the expense of added complexity. our models do exhibit sensitivity to the choice of prior distribution, however, because of the sparse representation of splice forms in the experimental data. we present a thorough examination of different priors in the supplementary information. because splicing at separate loci is approximately independent , equation  provides an excellent prior: the tissue-specific independent marginals prior. in this work we primarily use the averaged-marginals variant of this prior, obtained by averaging the fetal and adult expected frequencies.

the empirical bayes methodology is open to the criticism that including experimental results in the prior may lead to duplicate use of evidence and subsequent underestimation of uncertainty. purportedly 'uninformative' priors inadvertently introduce their own errors, however, mainly by forcing untenable splice correlations into the estimator . by making judicious use of the observed marginal frequencies in the prior we minimize this effect, and keep the focus of inference on the interactions. the present method has a major advantage in providing a simple comparison of two developmental stages by linkage order, with low computational burden.

developmental changes in higher-order linkages
the sgt is a transcriptome
though we have used actual sgt data and a detailed multivariate stochastic splicing model to present analyses of splicing correlations, our focus is on the methods themselves, which apply regardless of the dataset or details of the splicing model. only with a realistic splicing model, of course, can we make reliable statistical inferences. we present a detailed rationale for our model as a supplement . this model may be further refined, for example through computational methods of variable selection  or collection of additional data from different sources. a realistic splicing model allows us to investigate the single-gene transcriptome with established methods of transcriptome analysis. figure  <dig> presents one such approach.

the transcriptome is a highly complex assortment of gene products, but it exhibits a remarkably stable expression pattern. only a few genes are expressed at a high level, while most genes are represented by only a few copies. it is not clear that this pattern should persist at the single-gene level. different physiological inputs would affect the profile at different levels, so those aspects of gene-network topology that conspire to shape the aggregate gene expression profile, for example, may or may not be relevant to the selection of splice isoforms from a single gene in separate cells or tissues. nonetheless, the basic characteristics of the transcriptome profile are also present in its elemental building block, the sgt. figure  <dig> shows 'frequency-of-frequencies' plots for simulated sgts sampled from the tissue-specific independent-marginals distribution . the reverse-j pattern, like those obtained in genome-wide expression profiles assayed by sage  <cit> , reflects the complexity of both the transcript inventory and the tissue physiology in which this gene is expressed. the identical profile was obtained with the averaged-marginals estimator , which places a lower reliance on the observed marginal splicing frequencies in either tissue. , which we have shown to be inappropriate for a wide range of reasons yields an idiosyncratic l-shaped profile with an abrupt lower copy-number limit).

this analysis shows that the sgt exhibits a complex expression profile similar to that of the complete transcriptome, but that this is true whether or not splicing correlations are present at observed levels. splicing correlations may represent a level of organization unique to the single-gene level. alternatively, of course, analysis of correlated gene expression in the whole-genome transcriptome may reveal comparably interesting behavior.

discussion
the human genome supports in the neighborhood of  <dig>  protein coding genes  <cit> , very similar to the number found in genomes of vastly simpler organisms, such as c. elegans and drosophila  <cit> . to account for the increase in human phenotypic richness, therefore, the number of structural genes is not as important a factor as the way in which genes are used. variations in gene expression levels, changes in the timing of expression, evolutionary adaptations that rearrange gene interactions as well as evolution of the coding sequence, and increased post-transcriptional modification of primary transcripts to diversify the products of single genes all play a role  <cit> .

here we present tools to evaluate and visualize complex patterns of transcriptome variation, illustrated on populations of full-length cdna splice variants from cacna1g, the gene encoding the human cav <dig>  t-type calcium-channel α <dig> subunit. in the course of brain maturation the transcriptome of this gene undergoes a transformation that would be largely invisible to a study of gene expression levels or a microarray- or est-based splicing survey. the changes appear only in the complete structures of full-length transcripts, as alterations in splicing correlations at separate loci within the same molecule. a standard analysis of pairwise correlations, while illuminating, is incomplete in an important way. compared to the fetal transcriptome, the adult displays a marked increase in mutual information between many pairs of loci . the multivariate analysis, however, reveals two components of this increase: a modest elevation in disjoint pairwise linkages and a substantial increase in higher-order correlations that include linked pairs as a subset. overall, splicing in the adult is far more restrictive than fetal splicing. this occurs at the same time as the range of cell types in which this gene is being expressed is diversifying, not constricting. this is consistent with the notion that splicing may need to be more stringently specified in the more intricate 'wiring' of the mature brain  <cit> .

it is the grounding principle of this work, therefore, that splicing correlations will generally reflect functional interactions, and that these are likely to involve multiple domains. splicing of physically linked domains should be co-regulated to inhibit detrimental interactions as well as to enhance beneficial ones. this relates directly to the complexity of the processes that regulate selection of alternative domains, the most important factor being whether the domains are modular or functionally interactive.

modular domains may be shuttled in or out with predictable effects, independent of splicing at other loci. they may be used to conjoin functional activities – post-synaptic targeting with fast activation gating in an ion channel, for example. interactive domains, in contrast, express a shared functional effect that exists only in the context of the ensemble. a specific effect cannot be independently defined for a single interactive domain: reconfiguring one such domain 'reinterprets' the functional influences of the others.

that is, the molecular phenotype may be expressed as a linear combination of the effects of modular domains, but not so for interactive ones. as an example, deleting segment 38b of the cav <dig>  calcium channel decreases the window current magnitude when 25c is present, but increases it when  <dig> is present, and has no effect when both are absent; furthermore, it does not effect gating rates, except when  <dig>  25c and  <dig> were all absent, whereupon it speeds inactivation  <cit> . whether domains interact functionally depends on the domains, and modular and interactive qualities are not mutually exclusive.

the number of alternative molecular phenotypes is the same whether the loci are modular or interactive. in the former case, however, any given state is decomposable into identifiable subsets of phenotypes, whereas in the latter it is not. functional interactions admit the possibility of introducing completely unpredictable, qualitatively novel behavior simply by reconfiguring an existing set of domains. in the course of evolution, the simple addition of a new variable domain may reinterpret the phenotypes of existing splicing patterns, enabling a rapid expansion of functional alternatives from the ancestral gene.

non-additive functional interactions may have various causes. inserting one domain may simply block access to a binding site for a second domain, for example. another possibility is an 'allosteric' type of interaction where electrical or conformational changes communicate through the protein interior. the consequences of such interactions may become even more complex when other genes are alternatively spliced in multiple ways. current estimates of the number of alternatively spliced genes in humans range to ~76% of known genes  <cit> , with an average of  <dig>  splicing isoforms per gene  <cit> . furthermore, the frequency of alternative splicing is elevated in genes that mediate cell signaling and metabolic networks  <cit> , increasing the likelihood of nonlinear, and largely unpredictable interactions between genes with alternatively spliced products that communicate through such networks. strong intergenic interactions are of course normal where proteins contact physically, as subunits of a multi-enzyme complex, or in a multi-subunit ion channel. there are 22– <dig> such genes for voltage-dependent calcium channels, all of which may be alternatively spliced. these may assemble in up to  <dig> stoichiometric complexes, excompassing as many as  <dig> variable sites each. physiological channels may arise from as many as ~ <dig> ×  <dig> transcript combinations. this is an enormous space of possibilities, just for calcium channels, that can be exploited in the refinement of neuronal networks.

we may expect splicing correlations to cross gene boundaries in such cases, though direct physical contact may not even be necessary in general  <cit> . splicing linkage analyses in high-throughput transcriptomics may provide a valuable compliment to direct peptide interaction studies, such as yeast two-hybrid, to reveal functional interactions that do not require strong physical contacts. it is interesting, in this light, that the notion of a reconfigurable 'interactome'  <cit>  extends to variable domains within the protein interior.

the unpredictable consequences of functional interactions are amplified through ambiguity in the determinants of alternative splicing, which are not fully specified in the gene sequence. complex mammalian genes support an intrinsic uncertainty in the structure of the expressed protein which is reduced epigenetically, through information residing outside the gene, within networks of trans regulatory factors, for example  <cit> . thus, very rare splice configurations may be produced under most conditions. though any particular one may have a low probability, there is always a chance that a new form may arise, producing a protein that functions, albeit in an unusual way. a low level of such 'noise' may in fact be useful to a cell in a complex, unpredictable local environment. this certainly describes the mammalian brain, where humans have far outpaced other primates in the evolutionary divergence of phenotype. in keeping with this, the brain expresses a disproportionate diversity of alternative splicing, compared to other tissues  <cit> .

in the context of expanding complexity in alternative splicing, interactions between variable domains therefore present a challenge to the regulatory processes that select them. a set of k modular domains may be configured through k sequential yes/no choices. functional interactions, however, force a single, non decomposable, selection from 2k alternatives. the regulatory complexity thus increases exponentially with the number of loci if they interact, but only linearly if they do not. this is the cost of diversifying the proteome through combinatorial splicing. it returns a significant payoff, however, because the exponential expansion of the regulatory load is compensated by an expansion of phenotypic potential on the same scale. we have noted  <cit>  that this regulatory burden could be escaped if some mechanism were available for somatic selection during development, based on feedback from the expressed transcriptome.

CONCLUSIONS
as full-length cdna datasets become available the methods presented here will assist in defining the interaction landscape, revealing domain configurations that are selected in concert and providing insights into how domains within proteins interact functionally. additionally, however, they should adapt well to studies of clustering in the transcription of genes . a compelling application is to the class of rna transcripts that do not encode proteins  <cit> . though largely of unknown function, these ncrnas comprise a large proportion of the transcriptome, representing roughly 50% of transcriptional units and covering  <dig> times more of the genome than the protein-coding mrna, and they are elaborately processed   <cit> . they likely represent an important component of the intricate web of rna factors involved in the regulation of gene expression  <cit> , including regulated alternative splicing.

authors' contributions
me conceived the study, collected the data, designed the algorithms, code, graphics, and novel indices, with input from wsa on the linkage change index, performed the analyses and wrote the paper, with significant supporting contributions from gp. gp suggested the bayes/log-linear approach, and provided invaluable guidance, being especially receptive to "interesting" ideas. wsa provided funding and valuable consultation, and initiated work on the linkage change index. all three authors read and approve of the final manuscript.

supplementary material
additional file 1
a pdf file with a table listing the data used for these analyses , a graphical scheme illustrating how modular and interactive splicing relate to splice configuration , and a detailed exposition of the empirical bayesian approach, with an extensive analysis of sensitivity to the choice of prior distribution.

click here for file

 acknowledgements
this work was supported by nih award hl <dig> and a holden targeted research award from the epilepsy foundation to w.s.a. we thank two anonymous referees for suggesting figure  <dig> and drawing our attention to an overlooked reference.
